# Issue 11574: update M4RI to newest upstream release

archive/issues_011402.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nM4RI 20110601 changed the API, so we need to apply a patch as well, \n\ncf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601\ncf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715\n\n* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg\n* **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)\n* **Apply** [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz)\n\nDepends on #11261\nDepends on #11756\n\nCC:  @strogdon @nexttime @alexanderdreyer\n\nComponent: **packages: standard**\n\nKeywords: **sd32**\n\nAuthor: **Martin Albrecht**\n\nReviewer: **Simon King, Alexander Dreyer**\n\nMerged: **sage-4.7.2.alpha3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11574_\n\n",
    "closed_at": "2011-09-12T18:36:03Z",
    "created_at": "2011-07-04T16:37:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update M4RI to newest upstream release",
    "type": "issue",
    "updated_at": "2011-09-12T18:36:03Z",
    "url": "https://github.com/sagemath/sage/issues/11574",
    "user": "https://github.com/malb"
}
```
<div id="comment:0"></div>

M4RI 20110601 changed the API, so we need to apply a patch as well, 

cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601
cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715

* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg
* **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)
* **Apply** [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz)

Depends on #11261
Depends on #11756

CC:  @strogdon @nexttime @alexanderdreyer

Component: **packages: standard**

Keywords: **sd32**

Author: **Martin Albrecht**

Reviewer: **Simon King, Alexander Dreyer**

Merged: **sage-4.7.2.alpha3**

_Issue created by migration from https://trac.sagemath.org/ticket/11574_





---

archive/issue_events_153255.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-07-04T16:37:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153255"
}
```



---

archive/issue_events_153256.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-07-04T16:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153256"
}
```



---

archive/issue_events_153257.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-07-04T16:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153257"
}
```



---

archive/issue_events_153258.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-07-04T16:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153258"
}
```



---

archive/issue_comments_118309.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n M4RI 20110601 changed the API, so we need to apply a patch as well, \n \n cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601\n+\n+* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110601.spkg\n+* **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)\n``````\n",
    "created_at": "2011-07-04T16:39:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118309",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 M4RI 20110601 changed the API, so we need to apply a patch as well, 
 
 cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601
+
+* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110601.spkg
+* **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)
``````




---

archive/issue_events_153259.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-07-04T16:39:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153259"
}
```



---

archive/issue_comments_118310.json:
```json
{
    "body": "Dependencies: **#11261**",
    "created_at": "2011-07-04T21:02:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118310",
    "user": "https://github.com/malb"
}
```

Dependencies: **#11261**



---

archive/issue_comments_118311.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI'm a little confused.  The spkgs here and at #9562 are both libm4ri, and seem to be numbered backwards (the \"earlier\" one in the dependency is from 2011).",
    "created_at": "2011-07-05T13:55:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118311",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:3" align="right">comment:3</div>

I'm a little confused.  The spkgs here and at #9562 are both libm4ri, and seem to be numbered backwards (the "earlier" one in the dependency is from 2011).



---

archive/issue_comments_118312.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nOkay, I think I figured it out. Sorry for the noise.",
    "created_at": "2011-07-05T14:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118312",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

Okay, I think I figured it out. Sorry for the noise.



---

archive/issue_comments_118313.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI don't know what I did wrong, but I still get the problem with the ` Symbol not found: _m4ri_swap_bits` while trying to start, even after this patch.  I may have done something wrong, but at any rate I can't spend more time on this now, sorry.",
    "created_at": "2011-07-05T17:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118313",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:5" align="right">comment:5</div>

I don't know what I did wrong, but I still get the problem with the ` Symbol not found: _m4ri_swap_bits` while trying to start, even after this patch.  I may have done something wrong, but at any rate I can't spend more time on this now, sorry.



---

archive/issue_comments_118314.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,7 @@\n M4RI 20110601 changed the API, so we need to apply a patch as well, \n \n cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601\n+cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715\n \n-* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110601.spkg\n+* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg\n * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)\n``````\n",
    "created_at": "2011-07-06T16:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118314",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,7 @@
 M4RI 20110601 changed the API, so we need to apply a patch as well, 
 
 cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601
+cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715
 
-* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110601.spkg
+* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg
 * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)
``````




---

archive/issue_comments_118315.json:
```json
{
    "body": "Author: **Martin Albrecht**",
    "created_at": "2011-07-06T16:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118315",
    "user": "https://github.com/malb"
}
```

Author: **Martin Albrecht**



---

archive/issue_comments_118316.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFor the record, I tried spkg + patch on t2 and doctests pass.",
    "created_at": "2011-07-07T09:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118316",
    "user": "https://github.com/malb"
}
```

<div id="comment:7" align="right">comment:7</div>

For the record, I tried spkg + patch on t2 and doctests pass.



---

archive/issue_comments_118317.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601\n cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715\n \n-* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg\n+* **Install** https://bitbucket.org/malb/m4ri/downloads/libm4ri-20110715.spkg\n * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)\n``````\n",
    "created_at": "2011-07-11T14:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118317",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
 cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601
 cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715
 
-* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg
+* **Install** https://bitbucket.org/malb/m4ri/downloads/libm4ri-20110715.spkg
 * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)
``````




---

archive/issue_comments_118318.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\napplies & passes doctests with 4.7.1.rc2.",
    "created_at": "2011-08-15T21:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118318",
    "user": "https://github.com/malb"
}
```

<div id="comment:9" align="right">comment:9</div>

applies & passes doctests with 4.7.1.rc2.



---

archive/issue_events_153260.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-16T12:08:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153260"
}
```



---

archive/issue_events_153261.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-16T12:08:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153261"
}
```



---

archive/issue_comments_118319.json:
```json
{
    "body": "Reviewer: **Simon King**",
    "created_at": "2011-08-16T12:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118319",
    "user": "https://github.com/simon-king-jena"
}
```

Reviewer: **Simon King**



---

archive/issue_comments_118320.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nWhy is the documentation for matrices over GF(2) not part of the reference manual? I think you should use the upgrade to expose the documentation to the audience.",
    "created_at": "2011-08-16T12:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118320",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

Why is the documentation for matrices over GF(2) not part of the reference manual? I think you should use the upgrade to expose the documentation to the audience.



---

archive/issue_comments_118321.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI am not sure this documentation is much use in the reference manual since most of the interesting functions won't show up. Also, these matrices are expected to behave just as other matrices. On the other hand, there are a few - not many - special functions which are only available for GF(2). I'll take a look.",
    "created_at": "2011-08-16T12:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118321",
    "user": "https://github.com/malb"
}
```

<div id="comment:11" align="right">comment:11</div>

I am not sure this documentation is much use in the reference manual since most of the interesting functions won't show up. Also, these matrices are expected to behave just as other matrices. On the other hand, there are a few - not many - special functions which are only available for GF(2). I'll take a look.



---

archive/issue_events_153262.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-17T13:57:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153262"
}
```



---

archive/issue_events_153263.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-17T13:57:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153263"
}
```



---

archive/issue_comments_118322.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIt seems that you agreed in a different ticket (#9562) that this class doesn't need to be in the reference manual? Hence, returning to **needs review**. Feel free to change it back, though.",
    "created_at": "2011-08-17T13:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118322",
    "user": "https://github.com/malb"
}
```

<div id="comment:12" align="right">comment:12</div>

It seems that you agreed in a different ticket (#9562) that this class doesn't need to be in the reference manual? Hence, returning to **needs review**. Feel free to change it back, though.



---

archive/issue_comments_118323.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI think I can live with not including it into the references. However, currently I am getting segment faults when doctesting on mark (one of the skynet machines). I try to make sure that I properly install everything from scratch again, before reporting details.",
    "created_at": "2011-08-17T18:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118323",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

I think I can live with not including it into the references. However, currently I am getting segment faults when doctesting on mark (one of the skynet machines). I try to make sure that I properly install everything from scratch again, before reporting details.



---

archive/issue_comments_118324.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI did a forced new installation of the polybori spkg, then of the M4RI spkg, and I also installed the patches. I get on mark:\n\n```\nsage: P.<a,b,c,d,e> = PolynomialRing(GF(2), 5, order='lex')\nsage: I1 = ideal([a*b + c*d + 1, a*c*e + d*e, a*b*e + c*e, b*c + c*d*e + 1])\nsage: B.<a,b,c,d,e> = BooleanPolynomialRing(5, order='lex')\nsage: I2 = ideal([B(f) for f in I1.gens()])\nsage: I2.groebner_basis()\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/simonking/SAGE/sage-4.7.1.rc1mark/devel/sage-main/<ipython console> in <module>()\n\n/home/simonking/SAGE/sage-4.7.1.rc1mark/local/lib/python2.6/site-packages/sage/rings/polynomial/pbori.so in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (sage/rings/polynomial/pbori.cpp:26221)()\n\nRuntimeError: Segmentation fault\n```\n\nOf course, it could be that the problem comes from the polybori spkg. That would be unfortunate, since it is already merged.",
    "created_at": "2011-08-17T19:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118324",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

I did a forced new installation of the polybori spkg, then of the M4RI spkg, and I also installed the patches. I get on mark:

```
sage: P.<a,b,c,d,e> = PolynomialRing(GF(2), 5, order='lex')
sage: I1 = ideal([a*b + c*d + 1, a*c*e + d*e, a*b*e + c*e, b*c + c*d*e + 1])
sage: B.<a,b,c,d,e> = BooleanPolynomialRing(5, order='lex')
sage: I2 = ideal([B(f) for f in I1.gens()])
sage: I2.groebner_basis()
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/simonking/SAGE/sage-4.7.1.rc1mark/devel/sage-main/<ipython console> in <module>()

/home/simonking/SAGE/sage-4.7.1.rc1mark/local/lib/python2.6/site-packages/sage/rings/polynomial/pbori.so in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (sage/rings/polynomial/pbori.cpp:26221)()

RuntimeError: Segmentation fault
```

Of course, it could be that the problem comes from the polybori spkg. That would be unfortunate, since it is already merged.



---

archive/issue_comments_118325.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nNow, I tried to force re-installation of the original polybori spkg. However, that failed as well. I hope that it will not be needed to rebuild all of sage, which takes ages on mark.",
    "created_at": "2011-08-17T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118325",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

Now, I tried to force re-installation of the original polybori spkg. However, that failed as well. I hope that it will not be needed to rebuild all of sage, which takes ages on mark.



---

archive/issue_comments_118326.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI think the issue is that one needs to install stuff in the right order:\n* install new M4RI\n* install new PolyBoRi\n* apply the M4RI patch\n* touch `sage/libs/polybori/decl.pxd`\n* `sage -b`",
    "created_at": "2011-08-17T21:40:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118326",
    "user": "https://github.com/malb"
}
```

<div id="comment:16" align="right">comment:16</div>

I think the issue is that one needs to install stuff in the right order:
* install new M4RI
* install new PolyBoRi
* apply the M4RI patch
* touch `sage/libs/polybori/decl.pxd`
* `sage -b`



---

archive/issue_comments_118327.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nMeanwhile I managed to revert to the original state, and can confirm that, with vanilla sage-4.7.1.rc2 on 32-bit solaris, the segfault above does not occur.\n\nI will now try to do things in the order you suggested: In fact, originally I had installed polybori, then m4ri, then the m4ri patch, and then sage -b (without touching decl.pxd).\n\nBut how can the new polybori spkg be merged if apparently it depends on the new m4ri?",
    "created_at": "2011-08-18T07:14:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118327",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:17" align="right">comment:17</div>

Meanwhile I managed to revert to the original state, and can confirm that, with vanilla sage-4.7.1.rc2 on 32-bit solaris, the segfault above does not occur.

I will now try to do things in the order you suggested: In fact, originally I had installed polybori, then m4ri, then the m4ri patch, and then sage -b (without touching decl.pxd).

But how can the new polybori spkg be merged if apparently it depends on the new m4ri?



---

archive/issue_comments_118328.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe new installation order did the trick, the segfault has gone. I am now repeating the failing doctests.",
    "created_at": "2011-08-18T08:17:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118328",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

The new installation order did the trick, the segfault has gone. I am now repeating the failing doctests.



---

archive/issue_comments_118329.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOr actually I am repeating sage -testall.",
    "created_at": "2011-08-18T08:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118329",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:19" align="right">comment:19</div>

Or actually I am repeating sage -testall.



---

archive/issue_comments_118330.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@simon-king-jena](#comment%3A17):\n> But how can the new polybori spkg be merged if apparently it depends on the new m4ri?\n\nHi, the PolyBoRi does not depend on the new M4RI. This version of M4RI breaks binary compatibility with previous M4RI, i.e. we changed how matrices look internally. Hence, for many pieces of software linking against M4RI one needs to rebuild them to make sure they are talking to the right M4RI library in the right way. That's why M4RI and the PolyBoRi is necessary: to tell PolyBoRi to use this new version. I think we need to updated PolyBoRi as well because some macro names changed and PolyBoRi 0.7.1.p4 contains the necessary code to deal with it.",
    "created_at": "2011-08-18T09:10:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118330",
    "user": "https://github.com/malb"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@simon-king-jena](#comment%3A17):
> But how can the new polybori spkg be merged if apparently it depends on the new m4ri?

Hi, the PolyBoRi does not depend on the new M4RI. This version of M4RI breaks binary compatibility with previous M4RI, i.e. we changed how matrices look internally. Hence, for many pieces of software linking against M4RI one needs to rebuild them to make sure they are talking to the right M4RI library in the right way. That's why M4RI and the PolyBoRi is necessary: to tell PolyBoRi to use this new version. I think we need to updated PolyBoRi as well because some macro names changed and PolyBoRi 0.7.1.p4 contains the necessary code to deal with it.



---

archive/issue_comments_118331.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThe tests took 84373.7 seconds on mark, and there were a couple of timeouts. However, there was no failure. The segfault that I reported above vanished by installing everything in the right order. On my computer, all tests pass.\n\nMoreover, it is a prerequisite for working with M4RIE (#9562), which I think is a very important contribution - currently, matrices over GF(2<sup>e</sup>) are painfully slow in Sage.\n\nI think it is ok that the matrices over GF(2) do not have their own section in the reference manual, since there seems that all non-underscore methods are already present for general matrices.\n\nHence, it is a positive review.",
    "created_at": "2011-08-19T09:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118331",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:21" align="right">comment:21</div>

The tests took 84373.7 seconds on mark, and there were a couple of timeouts. However, there was no failure. The segfault that I reported above vanished by installing everything in the right order. On my computer, all tests pass.

Moreover, it is a prerequisite for working with M4RIE (#9562), which I think is a very important contribution - currently, matrices over GF(2<sup>e</sup>) are painfully slow in Sage.

I think it is ok that the matrices over GF(2) do not have their own section in the reference manual, since there seems that all non-underscore methods are already present for general matrices.

Hence, it is a positive review.



---

archive/issue_events_153264.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-19T09:19:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153264"
}
```



---

archive/issue_events_153265.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-19T09:19:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153265"
}
```



---

archive/issue_comments_118332.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWoot!",
    "created_at": "2011-08-19T10:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118332",
    "user": "https://github.com/malb"
}
```

<div id="comment:22" align="right">comment:22</div>

Woot!



---

archive/issue_events_153266.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-08-20T03:43:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153266"
}
```



---

archive/issue_events_153267.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-08-20T03:43:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153267"
}
```



---

archive/issue_comments_118333.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI'm upping the priority, since this fixes a serious mathematical bug reported on sage-support.",
    "created_at": "2011-08-20T03:43:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118333",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:23" align="right">comment:23</div>

I'm upping the priority, since this fixes a serious mathematical bug reported on sage-support.



---

archive/issue_events_153268.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T09:14:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153268"
}
```



---

archive/issue_events_153269.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T09:14:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153269"
}
```



---

archive/issue_comments_118334.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThe directory `m4ri` should be added to `.hgignore`",
    "created_at": "2011-08-22T09:14:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118334",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

The directory `m4ri` should be added to `.hgignore`



---

archive/issue_events_153270.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-22T18:08:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153270"
}
```



---

archive/issue_events_153271.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-22T18:08:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153271"
}
```



---

archive/issue_comments_118335.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nthe updated SPKG fixes this issue.",
    "created_at": "2011-08-22T18:08:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118335",
    "user": "https://github.com/malb"
}
```

<div id="comment:25" align="right">comment:25</div>

the updated SPKG fixes this issue.



---

archive/issue_comments_118336.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601\n cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715\n \n-* **Install** https://bitbucket.org/malb/m4ri/downloads/libm4ri-20110715.spkg\n+* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg\n * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)\n``````\n",
    "created_at": "2011-08-22T18:08:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118336",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
 cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110601
 cf. https://bitbucket.org/malb/m4ri/wiki/M4RI-20110715
 
-* **Install** https://bitbucket.org/malb/m4ri/downloads/libm4ri-20110715.spkg
+* **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg
 * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)
``````




---

archive/issue_events_153272.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-23T06:30:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153272"
}
```



---

archive/issue_events_153273.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-23T06:30:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153273"
}
```



---

archive/issue_comments_118337.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha2**",
    "created_at": "2011-08-23T06:30:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118337",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.2.alpha2**



---

archive/issue_events_153274.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:54:43Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153274"
}
```



---

archive/issue_comments_118338.json:
```json
{
    "body": "Changed merged from **sage-4.7.2.alpha2** to none",
    "created_at": "2011-08-24T21:54:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118338",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.2.alpha2** to none



---

archive/issue_comments_118339.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nOn some 32-bit Linux systems (for example, the buildbot machine `cicero`), this causes polybori to fail to install:\n\n```\ng++ -o groebner/src/randomset.o -c -O3 -Wno-long-long -Wreturn-type -g -fPIC -ftemplate-depth-100 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -DHAVE_GD -DHAVE_TR1_UNORDERED_MAP -DPACKED -DHAVE_M4RI -DHAVE_GD -DHAVE_IEEE_754 -DBSD -I/home/jdemeyer/sage-4.7.2.alpha1/local/include -I/home/jdemeyer/sage-4.7.2.alpha1/local/include/python2.6 -Ipolybori/include -ICudd/obj -ICudd/util -ICudd/cudd -ICudd/mtr -ICudd/st -ICudd/epd groebner/src/randomset.cc\nIn file included from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:42,\n                 from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31,\n                 from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,\n                 from groebner/src/nf.h:15,\n                 from groebner/src/randomset.cc:11:\n/usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3: error: #error \"SSE2 instruction set not enabled\"\nIn file included from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31,\n                 from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,\n                 from groebner/src/nf.h:15,\n                 from groebner/src/randomset.cc:11:\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function 'void mzd_row_add_offset(mzd_t*, rci_t, rci_t, rci_t)':\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: '__m128i' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: '__src' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: expected ';' before 'src'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742: error: '__dst' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742: error: expected ';' before 'dst'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:743: error: expected primary-expression before 'const'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:743: error: expected ';' before 'const'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:746: error: expected ';' before 'xmm1'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:747: error: 'xmm1' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:749: error: 'eof' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function 'void mzd_combine_even_in_place(mzd_t*, rci_t, wi_t, const mzd_t*, rci_t, wi_t)':\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: '__m128i' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: 'a128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: expected ';' before 'a'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191: error: 'b128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191: error: expected ';' before 'b'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192: error: expected initializer before '*' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1195: error: '_mm_xor_si128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1198: error: 'eof' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function 'void mzd_combine_even(mzd_t*, rci_t, wi_t, const mzd_t*, rci_t, wi_t, const mzd_t*, rci_t, wi_t)':\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: '__m128i' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: 'a128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: expected ';' before 'a'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275: error: 'b128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275: error: expected ';' before 'b'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276: error: 'c128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276: error: expected primary-expression before ')' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276: error: expected ';' before 'c'\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277: error: expected initializer before '*' token\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1280: error: '_mm_xor_si128' was not declared in this scope\n/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1284: error: 'eof' was not declared in this scope\nscons: *** [groebner/src/randomset.o] Error 1\nscons: building terminated because of errors.\n```",
    "created_at": "2011-08-24T21:54:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118339",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

On some 32-bit Linux systems (for example, the buildbot machine `cicero`), this causes polybori to fail to install:

```
g++ -o groebner/src/randomset.o -c -O3 -Wno-long-long -Wreturn-type -g -fPIC -ftemplate-depth-100 -O3 -Wno-long-long -Wreturn-type -g -fPIC -DNDEBUG -DHAVE_GD -DHAVE_TR1_UNORDERED_MAP -DPACKED -DHAVE_M4RI -DHAVE_GD -DHAVE_IEEE_754 -DBSD -I/home/jdemeyer/sage-4.7.2.alpha1/local/include -I/home/jdemeyer/sage-4.7.2.alpha1/local/include/python2.6 -Ipolybori/include -ICudd/obj -ICudd/util -ICudd/cudd -ICudd/mtr -ICudd/st -ICudd/epd groebner/src/randomset.cc
In file included from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:42,
                 from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31,
                 from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,
                 from groebner/src/nf.h:15,
                 from groebner/src/randomset.cc:11:
/usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3: error: #error "SSE2 instruction set not enabled"
In file included from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31,
                 from /home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,
                 from groebner/src/nf.h:15,
                 from groebner/src/randomset.cc:11:
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function 'void mzd_row_add_offset(mzd_t*, rci_t, rci_t, rci_t)':
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: '__m128i' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: '__src' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741: error: expected ';' before 'src'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742: error: '__dst' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742: error: expected ';' before 'dst'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:743: error: expected primary-expression before 'const'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:743: error: expected ';' before 'const'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:746: error: expected ';' before 'xmm1'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:747: error: 'xmm1' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:749: error: 'eof' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function 'void mzd_combine_even_in_place(mzd_t*, rci_t, wi_t, const mzd_t*, rci_t, wi_t)':
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: '__m128i' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: 'a128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190: error: expected ';' before 'a'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191: error: 'b128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191: error: expected ';' before 'b'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192: error: expected initializer before '*' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1195: error: '_mm_xor_si128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1198: error: 'eof' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function 'void mzd_combine_even(mzd_t*, rci_t, wi_t, const mzd_t*, rci_t, wi_t, const mzd_t*, rci_t, wi_t)':
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: '__m128i' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: 'a128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274: error: expected ';' before 'a'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275: error: 'b128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275: error: expected ';' before 'b'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276: error: 'c128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276: error: expected primary-expression before ')' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276: error: expected ';' before 'c'
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277: error: expected initializer before '*' token
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1280: error: '_mm_xor_si128' was not declared in this scope
/home/jdemeyer/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1284: error: 'eof' was not declared in this scope
scons: *** [groebner/src/randomset.o] Error 1
scons: building terminated because of errors.
```



---

archive/issue_events_153275.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:54:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153275"
}
```



---

archive/issue_events_153276.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:56:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153276"
}
```



---

archive/issue_events_153277.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-24T21:56:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153277"
}
```



---

archive/issue_comments_118340.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nCan you allow me to read your build on cicero (my username is malb). I don't have a copy of Sage on cicero and it would save me some time.",
    "created_at": "2011-08-24T22:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118340",
    "user": "https://github.com/malb"
}
```

<div id="comment:30" align="right">comment:30</div>

Can you allow me to read your build on cicero (my username is malb). I don't have a copy of Sage on cicero and it would save me some time.



---

archive/issue_comments_118341.json:
```json
{
    "body": "Changed keywords from none to **sd32**",
    "created_at": "2011-08-24T23:49:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118341",
    "user": "https://github.com/williamstein"
}
```

Changed keywords from none to **sd32**



---

archive/issue_comments_118342.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@malb](#comment%3A30):\n> Can you allow me to read your build on cicero (my username is malb). I don't have a copy of Sage on cicero and it would save me some time.\n\nIt's in `/home/buildbot/build/sage/cicero-1/cicero_full/build/sage-4.7.2.alpha2` (should be accessible through NFS on any Skynet machine).",
    "created_at": "2011-08-25T08:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118342",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@malb](#comment%3A30):
> Can you allow me to read your build on cicero (my username is malb). I don't have a copy of Sage on cicero and it would save me some time.

It's in `/home/buildbot/build/sage/cicero-1/cicero_full/build/sage-4.7.2.alpha2` (should be accessible through NFS on any Skynet machine).



---

archive/issue_comments_118343.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@jdemeyer](#comment%3A27):\n> On some 32-bit Linux systems (for example, the buildbot machine `cicero`), this causes polybori to fail to install:\n\n[...]\nHere on my system the old `m4ri/config.h` stays when the new libm4ri spkg is installed. Maybe something around polybori picks the outdated file?\n\nRegards,\n  Alexander",
    "created_at": "2011-08-25T13:34:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118343",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@jdemeyer](#comment%3A27):
> On some 32-bit Linux systems (for example, the buildbot machine `cicero`), this causes polybori to fail to install:

[...]
Here on my system the old `m4ri/config.h` stays when the new libm4ri spkg is installed. Maybe something around polybori picks the outdated file?

Regards,
  Alexander



---

archive/issue_comments_118344.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@alexanderdreyer](#comment%3A33):\n> Here on my system the old `m4ri/config.h` stays when the new libm4ri spkg is installed. Maybe something around polybori picks the outdated file?\n\nAs Jeroen pointed out this is not related. Unfortunately I cannot reproduce this behaviour. Is there some machine on which this occurs, which I may be granted access to?",
    "created_at": "2011-08-26T06:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118344",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@alexanderdreyer](#comment%3A33):
> Here on my system the old `m4ri/config.h` stays when the new libm4ri spkg is installed. Maybe something around polybori picks the outdated file?

As Jeroen pointed out this is not related. Unfortunately I cannot reproduce this behaviour. Is there some machine on which this occurs, which I may be granted access to?



---

archive/issue_comments_118345.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@alexanderdreyer](#comment%3A34):\n> As Jeroen pointed out this is not related. Unfortunately I cannot reproduce this behaviour. Is there some machine on which this occurs, which I may be granted access to?\n\nThe only machine which I know of is 'cicero' on skynet. We could try to get you an account there but it would take a while I guess. Right now, I cannot even log into the machine.",
    "created_at": "2011-08-26T13:23:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118345",
    "user": "https://github.com/malb"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@alexanderdreyer](#comment%3A34):
> As Jeroen pointed out this is not related. Unfortunately I cannot reproduce this behaviour. Is there some machine on which this occurs, which I may be granted access to?

The only machine which I know of is 'cicero' on skynet. We could try to get you an account there but it would take a while I guess. Right now, I cannot even log into the machine.



---

archive/issue_comments_118346.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@malb](#comment%3A35):\n> The only machine which I know of is 'cicero' on skynet. We could try to get you an account there but it would take a while I guess. Right now, I cannot even log into the machine.\n\nThis would be nice. I'm about to prepare a qemu image for Gentoo x86. But that will last for some time since I have to compile everything from scratch (It's Gentoo.)",
    "created_at": "2011-08-26T14:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118346",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@malb](#comment%3A35):
> The only machine which I know of is 'cicero' on skynet. We could try to get you an account there but it would take a while I guess. Right now, I cannot even log into the machine.

This would be nice. I'm about to prepare a qemu image for Gentoo x86. But that will last for some time since I have to compile everything from scratch (It's Gentoo.)



---

archive/issue_comments_118347.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nI think thing go south from there\n\n```\n/usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3: error: #error \"SSE2 instruction set not enabled\"\n```\nI had a x86 box without sse2 but it is now collecting dust without an OS installed. I will take a look on the closest thing I can get. Actually Steve Trogdon could have a box where this could be tested, I am copying him.",
    "created_at": "2011-08-26T22:11:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118347",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:37" align="right">comment:37</div>

I think thing go south from there

```
/usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3: error: #error "SSE2 instruction set not enabled"
```
I had a x86 box without sse2 but it is now collecting dust without an OS installed. I will take a look on the closest thing I can get. Actually Steve Trogdon could have a box where this could be tested, I am copying him.



---

archive/issue_comments_118348.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@kiwifb](#comment%3A37):\n> I think thing go south from there\n> \n> ```\n> /usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3: error: #error \"SSE2 instruction set not enabled\"\n> ```\n> I had a x86 box without sse2 but it is now collecting dust without an OS installed. I will take a look on the closest thing I can get. Actually Steve Trogdon could have a box where this could be tested, I am copying him.\n\nI get the same failure as [comment:33](#comment%3A33)\n\n```\n/storage/strogdon/gentoo/usr/lib/gcc/i686-pc-linux-gnu/4.5.2/include/emmintrin.h:32:3: error: #error \"SSE2 instruction set not enabled\"\nIn file included from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31:0,\n                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,\n                 from groebner/src/nf.h:15,\n                 from groebner/src/randomset.cc:11:\n\n...\n\nscons: *** [groebner/src/randomset.o] Error 1\nscons: building terminated because of errors.\nError building PolyBoRi.\n```",
    "created_at": "2011-08-27T02:47:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118348",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@kiwifb](#comment%3A37):
> I think thing go south from there
> 
> ```
> /usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3: error: #error "SSE2 instruction set not enabled"
> ```
> I had a x86 box without sse2 but it is now collecting dust without an OS installed. I will take a look on the closest thing I can get. Actually Steve Trogdon could have a box where this could be tested, I am copying him.

I get the same failure as [comment:33](#comment%3A33)

```
/storage/strogdon/gentoo/usr/lib/gcc/i686-pc-linux-gnu/4.5.2/include/emmintrin.h:32:3: error: #error "SSE2 instruction set not enabled"
In file included from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31:0,
                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,
                 from groebner/src/nf.h:15,
                 from groebner/src/randomset.cc:11:

...

scons: *** [groebner/src/randomset.o] Error 1
scons: building terminated because of errors.
Error building PolyBoRi.
```



---

archive/issue_comments_118349.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nM4RI *should* test for SSE2 and only include that header if it is present. Since it worked so far, I assume it still does that. However, we recently switched from `HAVE_SSE2` to `__M4RI_HAVE_SSE2` and this might be a change that PolyBoRi didn't pick up? However, it shouldn't be PolyBoRi's responsibility to check for SSE2 and hence something goes wrong when including `m4ri.h`.",
    "created_at": "2011-08-27T11:01:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118349",
    "user": "https://github.com/malb"
}
```

<div id="comment:39" align="right">comment:39</div>

M4RI *should* test for SSE2 and only include that header if it is present. Since it worked so far, I assume it still does that. However, we recently switched from `HAVE_SSE2` to `__M4RI_HAVE_SSE2` and this might be a change that PolyBoRi didn't pick up? However, it shouldn't be PolyBoRi's responsibility to check for SSE2 and hence something goes wrong when including `m4ri.h`.



---

archive/issue_comments_118350.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nFor some reason `m4ri_config.h` on cicero has\n\n```\n#define __M4RI_HAVE_SSE2                1\n```\nwhich is totally wrong! I'll investigate.",
    "created_at": "2011-08-27T11:36:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118350",
    "user": "https://github.com/malb"
}
```

<div id="comment:40" align="right">comment:40</div>

For some reason `m4ri_config.h` on cicero has

```
#define __M4RI_HAVE_SSE2                1
```
which is totally wrong! I'll investigate.



---

archive/issue_comments_118351.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nMore data on cicero:\n\n`cat /proc/cpuinfo` reports SSE2\n\n```\nflags           : fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe up pebs bts\n```\n\nbut `/usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3` complains. I assume this is because neither PolyBoRi nor Sage pass `-msse2` when linking against M4RI but `-msse2` defines `__SSE2__` which is required by `emmintrin.h`. But I don't understand yet why the previous version works.",
    "created_at": "2011-08-27T12:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118351",
    "user": "https://github.com/malb"
}
```

<div id="comment:41" align="right">comment:41</div>

More data on cicero:

`cat /proc/cpuinfo` reports SSE2

```
flags           : fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe up pebs bts
```

but `/usr/lib/gcc/i686-pc-linux-gnu/4.4.3/include/emmintrin.h:32:3` complains. I assume this is because neither PolyBoRi nor Sage pass `-msse2` when linking against M4RI but `-msse2` defines `__SSE2__` which is required by `emmintrin.h`. But I don't understand yet why the previous version works.



---

archive/issue_comments_118352.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI can confirm that passing `-msse2` fixes the issue. I guess I'll have to find a way to save the flags (to disc?) such that third parties (PolyBoRi, Sage) can re-use them? Any suggestions on how to do that?",
    "created_at": "2011-08-27T12:40:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118352",
    "user": "https://github.com/malb"
}
```

<div id="comment:42" align="right">comment:42</div>

I can confirm that passing `-msse2` fixes the issue. I guess I'll have to find a way to save the flags (to disc?) such that third parties (PolyBoRi, Sage) can re-use them? Any suggestions on how to do that?



---

archive/issue_comments_118353.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@malb](#comment%3A42):\n> I can confirm that passing `-msse2` fixes the issue. I guess I'll have to find a way to save the flags (to disc?) such that third parties (PolyBoRi, Sage) can re-use them? Any suggestions on how to do that?\n\nFor scons-bases builds (PolyBoRi as well as Sage) I should be able to provide a suitable code snipplet which checks whether  __M4RI_HAVE_SSE2 is defined in m4ri/m4ri_config.h.",
    "created_at": "2011-08-27T20:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118353",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@malb](#comment%3A42):
> I can confirm that passing `-msse2` fixes the issue. I guess I'll have to find a way to save the flags (to disc?) such that third parties (PolyBoRi, Sage) can re-use them? Any suggestions on how to do that?

For scons-bases builds (PolyBoRi as well as Sage) I should be able to provide a suitable code snipplet which checks whether  __M4RI_HAVE_SSE2 is defined in m4ri/m4ri_config.h.



---

archive/issue_comments_118354.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nWe have added some configuration for this here:\nhttps://bitbucket.org/brickenstein/polybori/changeset/e5ecbbe5a904\nI'll backport this to 0.7.1 and bundle a new spkg asap.",
    "created_at": "2011-08-27T23:49:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118354",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:44" align="right">comment:44</div>

We have added some configuration for this here:
https://bitbucket.org/brickenstein/polybori/changeset/e5ecbbe5a904
I'll backport this to 0.7.1 and bundle a new spkg asap.



---

archive/issue_comments_118355.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nPS: I'm also checking things like sse3 which m4ri might or might not use in the future.",
    "created_at": "2011-08-27T23:50:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118355",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:45" align="right">comment:45</div>

PS: I'm also checking things like sse3 which m4ri might or might not use in the future.



---

archive/issue_comments_118356.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nHi Alexander, \n\nso your plan is to parse for `__M4RI_HAVE_SSE2=1` and then pass `-msse2` manually? The only caveat I could see with that approach is that it limits us to use !GCC. For Sage this isn't really a problem. M4RI supports more compilers. How's that for PolyBoRi?\n\nIf we want to support more compilers I was thinking about dumping the CFLAGS to disk in M4RI which third party tools then can re-use. I was thinking of using the pkg-config.rc file which one can then either use via pkg-config or parse oneself.\n\nPS: Sage's main build scripts are not !Scons based, but I can certainly take care of those.",
    "created_at": "2011-08-28T11:59:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118356",
    "user": "https://github.com/malb"
}
```

<div id="comment:46" align="right">comment:46</div>

Hi Alexander, 

so your plan is to parse for `__M4RI_HAVE_SSE2=1` and then pass `-msse2` manually? The only caveat I could see with that approach is that it limits us to use !GCC. For Sage this isn't really a problem. M4RI supports more compilers. How's that for PolyBoRi?

If we want to support more compilers I was thinking about dumping the CFLAGS to disk in M4RI which third party tools then can re-use. I was thinking of using the pkg-config.rc file which one can then either use via pkg-config or parse oneself.

PS: Sage's main build scripts are not !Scons based, but I can certainly take care of those.



---

archive/issue_comments_118357.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@malb](#comment%3A46):\n> The only caveat I could see with that approach is that it limits us to use !GCC. For Sage this isn't really a problem. M4RI supports more compilers. How's that for PolyBoRi?\n\nWe support only gcc yet. In the case that we would add additional ones we'll add a mapping of non-default compiler options anyway.\n(e.g. -msse2 -> -xarch-sse2 for sun studio). But if you could export the original parameters, this would of course be better.\n\n> If we want to support more compilers I was thinking about dumping the CFLAGS to disk in M4RI which third party tools then can re-use. I was thinking of using the pkg-config.rc file which one can then either use via pkg-config or parse oneself.\n\nI would prefer if you could add a macro defining the options as a string literal to m4ri_config.h. But if you need to setup the rc file anyway, you do not have to duplicate work.",
    "created_at": "2011-08-28T19:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118357",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@malb](#comment%3A46):
> The only caveat I could see with that approach is that it limits us to use !GCC. For Sage this isn't really a problem. M4RI supports more compilers. How's that for PolyBoRi?

We support only gcc yet. In the case that we would add additional ones we'll add a mapping of non-default compiler options anyway.
(e.g. -msse2 -> -xarch-sse2 for sun studio). But if you could export the original parameters, this would of course be better.

> If we want to support more compilers I was thinking about dumping the CFLAGS to disk in M4RI which third party tools then can re-use. I was thinking of using the pkg-config.rc file which one can then either use via pkg-config or parse oneself.

I would prefer if you could add a macro defining the options as a string literal to m4ri_config.h. But if you need to setup the rc file anyway, you do not have to duplicate work.



---

archive/issue_comments_118358.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@malb](#comment%3A42):\n> I can confirm that passing `-msse2` fixes the issue. I guess I'll have to find a way to save the flags (to disc?) such that third parties (PolyBoRi, Sage) can re-use them? Any suggestions on how to do that?\n\nTake a look at GMP's / MPIR's `gmp.h` and the various libs (like e.g. MPFR) that use it:\n\n```sh\n$ egrep -B1 \"__GMP_(CC|CFLAGS)\" /usr/include/gmp.h\n/* Define CC and CFLAGS which were used to build this version of GMP */\n#define __GMP_CC \"gcc -std=gnu99\"\n#define __GMP_CFLAGS \"-march=native -g -O3\"\n```\n\nI for example use (slightly OT):\n\n```sh\n# We eventually use / add these settings (or parts of them) to \"our\" CFLAGS,\n# e.g. \"-march=...\" or \"-mcpu=...\" and \"-mtune=...\" to let gcc generate better,\n# processor-specific code, since ECM doesn't use them if we set our own:\ngmp_cc_pat='/^[ \t]*#[ \t]*define[ \t]\\+__GMP_CC[ \t]\\+/s/.*\"\\([^\"]*\\)\"/\\1/p'\ngmp_cflags_pat='/^[ \t]*#[ \t]*define[ \t]\\+__GMP_CFLAGS[ \t]\\+/s/.*\"\\([^\"]*\\)\"/\\1/p'\n\ngmp_cc=`sed -n -e \"$gmp_cc_pat\" \"$SAGE_LOCAL\"/include/gmp.h`\ngmp_cflags=`sed -n -e \"$gmp_cflags_pat\" \"$SAGE_LOCAL\"/include/gmp.h`\n\nsystem_gmp_h=\"\"\nfor incdir in /usr/include /usr/local/include; do\n    if [ -f $incdir/gmp.h ]; then\n        system_gmp_h=$incdir/gmp.h\n    fi\ndone\nif [ -n \"$system_gmp_h\" ]; then\n    system_gmp_cc=`sed -n -e \"$gmp_cc_pat\" $system_gmp_h`\n    system_gmp_cflags=`sed -n -e \"$gmp_cflags_pat\" $system_gmp_h`\nfi\n\n...\n\n    else\n        # 'native' not supported, see if GMP / MPIR provides us some CPU type:\n        for opt in $gmp_cflags; do\n            case $opt in\n                -march=*|-mcpu=*|-mtune*)\n                    echo \"Found CPU parameter in gmp.h: $opt\"\n                    cpu_params=\"$cpu_params $opt\"\n                    ;;\n                 # perhaps add other options, too (e.g. for different compilers)\n                 *) other_gmp_cflags=\"$other_gmp_cflags $opt\"\n            esac\n        done\n    fi\n    # Only add them if CFLAGS do not already contain similar:\n    if [ -n \"$cpu_params\" ] &&\n        ! (echo \"$CFLAGS\" | egrep -- '-march=|-mcpu=|-mtune=' >/dev/null);\n    then\n        echo \"Using additional host-specific CFLAGS: $cpu_params\"\n        CFLAGS=\"$cpu_params $CFLAGS\"\n    fi\n    if [ -n \"$other_gmp_cflags\" ]; then\n        echo \"Not using other CFLAGS provided by gmp.h: $other_gmp_cflags\"\n    fi\n...\n```\n\nPutting at least the *necessary* flags into `libm4ri.pc` is of course another, non-exclusive option, and even on systems that lack `pkg-config`, you could use the `.pc` file by adding a few lines of shell, Python or whatever code.\n\n\nYou can also test whether adding `-msse2` (if using SSE2 is desired) is necessary at all, or supported (for simplicity, here `gcc`-specific):\n\n```sh\n# Test whether '-msse2' is supported at all:\nif $CC -msse2 -c -x c /dev/null -o /dev/null &>/dev/null; then\n    # Ok, supported. Do we need it?\n    # [Should perhaps check whether __SSE2__ is really non-zero.]\n    if ($CC -E -dM -x c /dev/null | grep -w __SSE2__) &>/dev/null; then\n        # Fine, we don't need to pass any options to enable SSE2.\n        required_cflag=\"\"\n    else\n        required_cflag=\"-msse2\"\n    fi\n    # Check whether the flag conflicts with others, perhaps specified by the user:\n    if $CC $CFLAGS $required_cflag -c -x c /dev/null -o /dev/null &>/dev/null; then\n        # Ok, compatible and sufficient.\n    else\n        # Conflicting flags, issue error message or try something else...\n    fi\nelse\n    # Not supported, perhaps disable use of SSE2.\nfi\n```\n(The same tests can easily be performed from Python as well, e.g. in [Sage's] `setup.py` or `module_list.py`. You could also steal macros from autotools.)",
    "created_at": "2011-08-28T19:39:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118358",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@malb](#comment%3A42):
> I can confirm that passing `-msse2` fixes the issue. I guess I'll have to find a way to save the flags (to disc?) such that third parties (PolyBoRi, Sage) can re-use them? Any suggestions on how to do that?

Take a look at GMP's / MPIR's `gmp.h` and the various libs (like e.g. MPFR) that use it:

```sh
$ egrep -B1 "__GMP_(CC|CFLAGS)" /usr/include/gmp.h
/* Define CC and CFLAGS which were used to build this version of GMP */
#define __GMP_CC "gcc -std=gnu99"
#define __GMP_CFLAGS "-march=native -g -O3"
```

I for example use (slightly OT):

```sh
# We eventually use / add these settings (or parts of them) to "our" CFLAGS,
# e.g. "-march=..." or "-mcpu=..." and "-mtune=..." to let gcc generate better,
# processor-specific code, since ECM doesn't use them if we set our own:
gmp_cc_pat='/^[ 	]*#[ 	]*define[ 	]\+__GMP_CC[ 	]\+/s/.*"\([^"]*\)"/\1/p'
gmp_cflags_pat='/^[ 	]*#[ 	]*define[ 	]\+__GMP_CFLAGS[ 	]\+/s/.*"\([^"]*\)"/\1/p'

gmp_cc=`sed -n -e "$gmp_cc_pat" "$SAGE_LOCAL"/include/gmp.h`
gmp_cflags=`sed -n -e "$gmp_cflags_pat" "$SAGE_LOCAL"/include/gmp.h`

system_gmp_h=""
for incdir in /usr/include /usr/local/include; do
    if [ -f $incdir/gmp.h ]; then
        system_gmp_h=$incdir/gmp.h
    fi
done
if [ -n "$system_gmp_h" ]; then
    system_gmp_cc=`sed -n -e "$gmp_cc_pat" $system_gmp_h`
    system_gmp_cflags=`sed -n -e "$gmp_cflags_pat" $system_gmp_h`
fi

...

    else
        # 'native' not supported, see if GMP / MPIR provides us some CPU type:
        for opt in $gmp_cflags; do
            case $opt in
                -march=*|-mcpu=*|-mtune*)
                    echo "Found CPU parameter in gmp.h: $opt"
                    cpu_params="$cpu_params $opt"
                    ;;
                 # perhaps add other options, too (e.g. for different compilers)
                 *) other_gmp_cflags="$other_gmp_cflags $opt"
            esac
        done
    fi
    # Only add them if CFLAGS do not already contain similar:
    if [ -n "$cpu_params" ] &&
        ! (echo "$CFLAGS" | egrep -- '-march=|-mcpu=|-mtune=' >/dev/null);
    then
        echo "Using additional host-specific CFLAGS: $cpu_params"
        CFLAGS="$cpu_params $CFLAGS"
    fi
    if [ -n "$other_gmp_cflags" ]; then
        echo "Not using other CFLAGS provided by gmp.h: $other_gmp_cflags"
    fi
...
```

Putting at least the *necessary* flags into `libm4ri.pc` is of course another, non-exclusive option, and even on systems that lack `pkg-config`, you could use the `.pc` file by adding a few lines of shell, Python or whatever code.


You can also test whether adding `-msse2` (if using SSE2 is desired) is necessary at all, or supported (for simplicity, here `gcc`-specific):

```sh
# Test whether '-msse2' is supported at all:
if $CC -msse2 -c -x c /dev/null -o /dev/null &>/dev/null; then
    # Ok, supported. Do we need it?
    # [Should perhaps check whether __SSE2__ is really non-zero.]
    if ($CC -E -dM -x c /dev/null | grep -w __SSE2__) &>/dev/null; then
        # Fine, we don't need to pass any options to enable SSE2.
        required_cflag=""
    else
        required_cflag="-msse2"
    fi
    # Check whether the flag conflicts with others, perhaps specified by the user:
    if $CC $CFLAGS $required_cflag -c -x c /dev/null -o /dev/null &>/dev/null; then
        # Ok, compatible and sufficient.
    else
        # Conflicting flags, issue error message or try something else...
    fi
else
    # Not supported, perhaps disable use of SSE2.
fi
```
(The same tests can easily be performed from Python as well, e.g. in [Sage's] `setup.py` or `module_list.py`. You could also steal macros from autotools.)



---

archive/issue_comments_118359.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nThe attached patch manually adds `-msse -msse2` in module_list.py if `__M4RI_HAVE_SSE2`. I fully agree that M4RI should export its flags both as an .rc file and as a define like GMP and I will implement this as well.",
    "created_at": "2011-08-28T19:53:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118359",
    "user": "https://github.com/malb"
}
```

<div id="comment:50" align="right">comment:50</div>

The attached patch manually adds `-msse -msse2` in module_list.py if `__M4RI_HAVE_SSE2`. I fully agree that M4RI should export its flags both as an .rc file and as a define like GMP and I will implement this as well.



---

archive/issue_comments_118360.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nLeif, note that M4RI checks for `-msse2` like this\n\n    https://bitbucket.org/malb/m4ri/src/58007c8c739a/m4/ax_ext.m4",
    "created_at": "2011-08-28T19:56:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118360",
    "user": "https://github.com/malb"
}
```

<div id="comment:51" align="right">comment:51</div>

Leif, note that M4RI checks for `-msse2` like this

    https://bitbucket.org/malb/m4ri/src/58007c8c739a/m4/ax_ext.m4



---

archive/issue_comments_118361.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@alexanderdreyer](#comment%3A48):\n> Replying to [@malb](#comment%3A46):\n> > The only caveat I could see with that approach is that it limits us to use !GCC. For Sage this isn't really a problem. M4RI supports more compilers. How's that for PolyBoRi?\n> \n> We support only gcc yet. In the case that we would add additional ones we'll add a mapping of non-default compiler options anyway.\n\nYep. Adding such is almost trivial, at least for a fixed set of compilers (and platforms).\n\n\n\n\n> (e.g. -msse2 -> -xarch-sse2 for sun studio). But if you could export the original parameters, this would of course be better.\n\nI'd do both, and resort to the SCons method in case no (suitable) parameters are available.\n\n\n\n\n> > If we want to support more compilers I was thinking about dumping the CFLAGS to disk in M4RI which third party tools then can re-use. I was thinking of using the pkg-config.rc file which one can then either use via pkg-config or parse oneself.\n> \n> I would prefer if you could add a macro defining the options as a string literal to m4ri_config.h. But if you need to setup the rc file anyway, you do not have to duplicate work.\n\nI'd do both, but preferably use the header method. Using the `.pc` file is limited and to some extent dangerous, since `pkg-config` files lack (by default) a compiler command entry such that the flags may be invalid or insufficient for the actual compiler used. \n\n(Note that some people even put flags into `CC` rather than `CFLAGS`, and different installed GCC versions might default to different architectures as well.)\n\nYou could either define other variables there, to get parsed / interpreted \"manually\", or simply put exactly the same lines you put into your header file into the `.pc` file, since incidentally any `#define` in a `.pc` file happens to be just a comment. :-)\n\n(You'll have to use e.g. `grep` to extract them though, rather than `pkg-config`.)",
    "created_at": "2011-08-28T20:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118361",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@alexanderdreyer](#comment%3A48):
> Replying to [@malb](#comment%3A46):
> > The only caveat I could see with that approach is that it limits us to use !GCC. For Sage this isn't really a problem. M4RI supports more compilers. How's that for PolyBoRi?
> 
> We support only gcc yet. In the case that we would add additional ones we'll add a mapping of non-default compiler options anyway.

Yep. Adding such is almost trivial, at least for a fixed set of compilers (and platforms).




> (e.g. -msse2 -> -xarch-sse2 for sun studio). But if you could export the original parameters, this would of course be better.

I'd do both, and resort to the SCons method in case no (suitable) parameters are available.




> > If we want to support more compilers I was thinking about dumping the CFLAGS to disk in M4RI which third party tools then can re-use. I was thinking of using the pkg-config.rc file which one can then either use via pkg-config or parse oneself.
> 
> I would prefer if you could add a macro defining the options as a string literal to m4ri_config.h. But if you need to setup the rc file anyway, you do not have to duplicate work.

I'd do both, but preferably use the header method. Using the `.pc` file is limited and to some extent dangerous, since `pkg-config` files lack (by default) a compiler command entry such that the flags may be invalid or insufficient for the actual compiler used. 

(Note that some people even put flags into `CC` rather than `CFLAGS`, and different installed GCC versions might default to different architectures as well.)

You could either define other variables there, to get parsed / interpreted "manually", or simply put exactly the same lines you put into your header file into the `.pc` file, since incidentally any `#define` in a `.pc` file happens to be just a comment. :-)

(You'll have to use e.g. `grep` to extract them though, rather than `pkg-config`.)



---

archive/issue_comments_118362.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@malb](#comment%3A50):\n> The attached patch manually adds `-msse -msse2` in module_list.py if `__M4RI_HAVE_SSE2`. I fully agree that M4RI should export its flags both as an .rc file and as a define like GMP and I will implement this as well.\n\nShouldn't the modules also depend on `SAGE_LOCAL + \"/include/m4ri/m4ri_config.h\"`? (You should use `SAGE_INC` there, too, btw. ;-) )\n\nThis should be done in a more general or automatic way, i.e., `m4ri_extra_compile_args` (and probably `-std=c99`) should be added in `setup.py` for every module that links against `libm4ri`.\n\n(I'm adding similar for dependencies, e.g. at #8664, and other stuff, in order to make `module_list.py` more modular and less error-prone.)\n\nP.S.: SSE2 is a superset of SSE, just as `-msse2` implies `-msse`.\n\nThe patch doesn't yet check whether adding these flags is sufficient. Haven't looked at your M4RI code, but if you add something like\n\n```C\n#if defined(__M4RI_HAVE_SSE2) && __M4RI_HAVE_SSE2\n#   if !defined(__SSE2__) || !__SSE2__\n#       error Your current compiler and / or CFLAGS setting doesn't allow SSE2 code. Please change that or these to the setting(s) you used when compiling M4RI.\n#   endif\n#endif\n```\n(I wanted to post that to sage-devel a few hours ago, in response to:\n\n```\n> > If 'configure' determined the machine supports SSE2, __M4RI_HAVE_SSE2 \n> > is set to 1, but even if that's the case, you should still also test \n> > __SSE2__ when compiling code later (including code *using* the \n> > library). \n\n> Why? I want that whoever links against M4RI lives in the same world as M4RI. \n```\nfor the reasons given above.)",
    "created_at": "2011-08-28T20:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118362",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@malb](#comment%3A50):
> The attached patch manually adds `-msse -msse2` in module_list.py if `__M4RI_HAVE_SSE2`. I fully agree that M4RI should export its flags both as an .rc file and as a define like GMP and I will implement this as well.

Shouldn't the modules also depend on `SAGE_LOCAL + "/include/m4ri/m4ri_config.h"`? (You should use `SAGE_INC` there, too, btw. ;-) )

This should be done in a more general or automatic way, i.e., `m4ri_extra_compile_args` (and probably `-std=c99`) should be added in `setup.py` for every module that links against `libm4ri`.

(I'm adding similar for dependencies, e.g. at #8664, and other stuff, in order to make `module_list.py` more modular and less error-prone.)

P.S.: SSE2 is a superset of SSE, just as `-msse2` implies `-msse`.

The patch doesn't yet check whether adding these flags is sufficient. Haven't looked at your M4RI code, but if you add something like

```C
#if defined(__M4RI_HAVE_SSE2) && __M4RI_HAVE_SSE2
#   if !defined(__SSE2__) || !__SSE2__
#       error Your current compiler and / or CFLAGS setting doesn't allow SSE2 code. Please change that or these to the setting(s) you used when compiling M4RI.
#   endif
#endif
```
(I wanted to post that to sage-devel a few hours ago, in response to:

```
> > If 'configure' determined the machine supports SSE2, __M4RI_HAVE_SSE2 
> > is set to 1, but even if that's the case, you should still also test 
> > __SSE2__ when compiling code later (including code *using* the 
> > library). 

> Why? I want that whoever links against M4RI lives in the same world as M4RI. 
```
for the reasons given above.)



---

archive/issue_comments_118363.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@nexttime](#comment%3A53):\n> This should be done in a more general or automatic way, i.e., `m4ri_extra_compile_args` (and probably `-std=c99`) should be added in `setup.py` for every module that links against `libm4ri`.\n\nP.S.: I don't mean you have to do / change that *here*, as e.g. Francois is also messing around in that area of `setup.py` ;-) , such that patches were likely to conflict, so I could also change that later on another ticket, perhaps unrelated to M4RI, but dealing with `setup.py`.",
    "created_at": "2011-08-28T21:24:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118363",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@nexttime](#comment%3A53):
> This should be done in a more general or automatic way, i.e., `m4ri_extra_compile_args` (and probably `-std=c99`) should be added in `setup.py` for every module that links against `libm4ri`.

P.S.: I don't mean you have to do / change that *here*, as e.g. Francois is also messing around in that area of `setup.py` ;-) , such that patches were likely to conflict, so I could also change that later on another ticket, perhaps unrelated to M4RI, but dealing with `setup.py`.



---

archive/issue_comments_118364.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nA new PolyBoRi 0.7.1 spkg (with activated -msse2 option, when necessary) can be found here:\nhttp://sage.math.washington.edu/home/dreyer/spkg/polybori-0.7.1.p5.spkg",
    "created_at": "2011-08-29T00:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118364",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:55" align="right">comment:55</div>

A new PolyBoRi 0.7.1 spkg (with activated -msse2 option, when necessary) can be found here:
http://sage.math.washington.edu/home/dreyer/spkg/polybori-0.7.1.p5.spkg



---

archive/issue_comments_118365.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@nexttime](#comment%3A54):\n> Replying to [@nexttime](#comment%3A53):\n> > This should be done in a more general or automatic way, i.e., `m4ri_extra_compile_args` (and probably `-std=c99`) should be added in `setup.py` for every module that links against `libm4ri`.\n> \n> \n> P.S.: I don't mean you have to do / change that *here*, as e.g. Francois is also messing around in that area of `setup.py` ;-) , such that patches were likely to conflict, so I could also change that later on another ticket, perhaps unrelated to M4RI, but dealing with `setup.py`.\n> \n\nAll my changes have been merged in 4.7.2.alpha1 I don't see them getting out again. So I would say it is safe to base your patch on that.",
    "created_at": "2011-08-29T01:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118365",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@nexttime](#comment%3A54):
> Replying to [@nexttime](#comment%3A53):
> > This should be done in a more general or automatic way, i.e., `m4ri_extra_compile_args` (and probably `-std=c99`) should be added in `setup.py` for every module that links against `libm4ri`.
> 
> 
> P.S.: I don't mean you have to do / change that *here*, as e.g. Francois is also messing around in that area of `setup.py` ;-) , such that patches were likely to conflict, so I could also change that later on another ticket, perhaps unrelated to M4RI, but dealing with `setup.py`.
> 

All my changes have been merged in 4.7.2.alpha1 I don't see them getting out again. So I would say it is safe to base your patch on that.



---

archive/issue_comments_118366.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@kiwifb](#comment%3A56):\n> Replying to [@nexttime](#comment%3A54):\n> > P.S.: I don't mean you have to do / change that *here*, as e.g. Francois is also messing around in that area of `setup.py` ;-) , such that patches were likely to conflict, so I could also change that later on another ticket, perhaps unrelated to M4RI, but dealing with `setup.py`.\n> > \n> \n> \n> All my changes have been merged in 4.7.2.alpha1 I don't see them getting out again. So I would say it is safe to base your patch on that.\n\nBut **I've** to again rebase my patch from #8664 on yours... :D\n\nP.S.: Some good and bad news for #9958 coming soon...",
    "created_at": "2011-08-29T02:12:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118366",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@kiwifb](#comment%3A56):
> Replying to [@nexttime](#comment%3A54):
> > P.S.: I don't mean you have to do / change that *here*, as e.g. Francois is also messing around in that area of `setup.py` ;-) , such that patches were likely to conflict, so I could also change that later on another ticket, perhaps unrelated to M4RI, but dealing with `setup.py`.
> > 
> 
> 
> All my changes have been merged in 4.7.2.alpha1 I don't see them getting out again. So I would say it is safe to base your patch on that.

But **I've** to again rebase my patch from #8664 on yours... :D

P.S.: Some good and bad news for #9958 coming soon...



---

archive/issue_comments_118367.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nIndeed, I mothballed SAGE_DEBIAN ! I didn't notice you had a patch touching that area in #8664, it took too long to merge that one really. It has to go in.\n\nI am bracing myself for #9958, you know we already ship sage-on-gentoo with python-2.7 and it works well (#11339 excluded) on x86/amd64 linux and OS X in a prefix. But we are getting off-track.",
    "created_at": "2011-08-29T02:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118367",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:58" align="right">comment:58</div>

Indeed, I mothballed SAGE_DEBIAN ! I didn't notice you had a patch touching that area in #8664, it took too long to merge that one really. It has to go in.

I am bracing myself for #9958, you know we already ship sage-on-gentoo with python-2.7 and it works well (#11339 excluded) on x86/amd64 linux and OS X in a prefix. But we are getting off-track.



---

archive/issue_comments_118368.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThe PolyBoRi spkg has now its own ticket: #11756 It it solved the problem (it does for me on a Gentoo VM), please review.",
    "created_at": "2011-08-29T09:59:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118368",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:59" align="right">comment:59</div>

The PolyBoRi spkg has now its own ticket: #11756 It it solved the problem (it does for me on a Gentoo VM), please review.



---

archive/issue_comments_118369.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nHi,\n\nso how's this for a strategy:\n\n* we do the fixes (or something similar) that Alexander and I proposed for PolyBoRi and !Sage respectively now\n* I provide (in a new ticket) an updated M4RI which exports its !CLFAGS both in the headers and in the .rc file and also checks for __SSE2__ to fail gracefully.\n* We then update !Sage & PolyBoRi again to use these !CFLAGS?",
    "created_at": "2011-08-29T11:50:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118369",
    "user": "https://github.com/malb"
}
```

<div id="comment:60" align="right">comment:60</div>

Hi,

so how's this for a strategy:

* we do the fixes (or something similar) that Alexander and I proposed for PolyBoRi and !Sage respectively now
* I provide (in a new ticket) an updated M4RI which exports its !CLFAGS both in the headers and in the .rc file and also checks for __SSE2__ to fail gracefully.
* We then update !Sage & PolyBoRi again to use these !CFLAGS?



---

archive/issue_comments_118370.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\npolybori-0.7.1.p5.spkg does build. I applied the two indicated patches but building of sage itself fails:\n\n```\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -O3 -Wall -Wstrict-prototypes -fPIC -I/storage/sage-python2.6/sage-4.7.2.alpha1/local/include -I/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/csage -I/storage/sage-python2.6/sage-4.7\n.2.alpha1/devel/sage/sage/ext -I/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/python2.6 -c sage/matrix/matrix_integer_dense.c -o build/temp.linux-i686-2.6/sage/matrix/matrix_integer_dense.o -std=c99 -w\nIn file included from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:42:0,\n                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31,\n                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,\n                 from sage/matrix/matrix_integer_dense.c:240:\n/storage/strogdon/gentoo/usr/lib/gcc/i686-pc-linux-gnu/4.5.2/include/emmintrin.h:32:3: error: #error \"SSE2 instruction set not enabled\"\nIn file included from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31:0,\n                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,\n                 from sage/matrix/matrix_integer_dense.c:240:\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function mzd_row_add_offset:\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:5: error: __m128i undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:5: note: each undeclared identifier is reported only once for each function it appears in\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:14: error: __src undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:31: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742:14: error: __dst undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742:31: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:743:14: error: expected expression before const\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:746:15: error: expected ; before xmm1\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:747:18: error: xmm1 undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:749:21: error: eof undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function mzd_combine_even_in_place:\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190:7: error: __m128i undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190:16: error: a128 undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190:32: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191:16: error: b128 undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191:32: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192:21: error: expected =, ,, ;, asm or __attribute__ before * token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192:22: error: eof undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192:37: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function mzd_combine_even:\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274:7: error: __m128i undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274:16: error: a128 undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274:32: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275:16: error: b128 undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275:32: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276:16: error: c128 undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276:32: error: expected expression before ) token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277:21: error: expected =, ,, ;, asm or __attribute__ before * token\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277:22: error: eof undeclared (first use in this function)\n/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277:37: error: expected expression before ) token\n```",
    "created_at": "2011-08-29T14:04:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118370",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:61" align="right">comment:61</div>

polybori-0.7.1.p5.spkg does build. I applied the two indicated patches but building of sage itself fails:

```
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -O3 -Wall -Wstrict-prototypes -fPIC -I/storage/sage-python2.6/sage-4.7.2.alpha1/local/include -I/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/csage -I/storage/sage-python2.6/sage-4.7
.2.alpha1/devel/sage/sage/ext -I/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/python2.6 -c sage/matrix/matrix_integer_dense.c -o build/temp.linux-i686-2.6/sage/matrix/matrix_integer_dense.o -std=c99 -w
In file included from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:42:0,
                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31,
                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,
                 from sage/matrix/matrix_integer_dense.c:240:
/storage/strogdon/gentoo/usr/lib/gcc/i686-pc-linux-gnu/4.5.2/include/emmintrin.h:32:3: error: #error "SSE2 instruction set not enabled"
In file included from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/permutation.h:31:0,
                 from /storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/m4ri.h:50,
                 from sage/matrix/matrix_integer_dense.c:240:
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function mzd_row_add_offset:
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:5: error: __m128i undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:5: note: each undeclared identifier is reported only once for each function it appears in
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:14: error: __src undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:741:31: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742:14: error: __dst undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:742:31: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:743:14: error: expected expression before const
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:746:15: error: expected ; before xmm1
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:747:18: error: xmm1 undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:749:21: error: eof undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function mzd_combine_even_in_place:
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190:7: error: __m128i undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190:16: error: a128 undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1190:32: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191:16: error: b128 undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1191:32: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192:21: error: expected =, ,, ;, asm or __attribute__ before * token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192:22: error: eof undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1192:37: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h: In function mzd_combine_even:
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274:7: error: __m128i undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274:16: error: a128 undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1274:32: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275:16: error: b128 undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1275:32: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276:16: error: c128 undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1276:32: error: expected expression before ) token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277:21: error: expected =, ,, ;, asm or __attribute__ before * token
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277:22: error: eof undeclared (first use in this function)
/storage/sage-python2.6/sage-4.7.2.alpha1/local/include/m4ri/packedmatrix.h:1277:37: error: expected expression before ) token
```



---

archive/issue_comments_118371.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nOkay, I know what the issue is and will update the patch accordingly!",
    "created_at": "2011-08-29T14:16:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118371",
    "user": "https://github.com/malb"
}
```

<div id="comment:62" align="right">comment:62</div>

Okay, I know what the issue is and will update the patch accordingly!



---

archive/issue_comments_118372.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@malb](#comment%3A60):\n> so how's this for a strategy:\n> \n\n> * we do the fixes (or something similar) that Alexander and I proposed for PolyBoRi and !Sage respectively now \n\n> * I provide (in a new ticket) an updated M4RI which exports its !CLFAGS both in the headers and in the .rc file and also checks for __SSE2__ to fail gracefully. \n\n> * We then update !Sage & PolyBoRi again to use these !CFLAGS?\n\n!That ?sounds !reasonable!!\n\nAnd also avoids circular ticket dependencies for the follow-up(s)...",
    "created_at": "2011-08-29T14:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118372",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@malb](#comment%3A60):
> so how's this for a strategy:
> 

> * we do the fixes (or something similar) that Alexander and I proposed for PolyBoRi and !Sage respectively now 

> * I provide (in a new ticket) an updated M4RI which exports its !CLFAGS both in the headers and in the .rc file and also checks for __SSE2__ to fail gracefully. 

> * We then update !Sage & PolyBoRi again to use these !CFLAGS?

!That ?sounds !reasonable!!

And also avoids circular ticket dependencies for the follow-up(s)...



---

archive/issue_comments_118373.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\n... though you could easily add the graceful dead ''here' as well.",
    "created_at": "2011-08-29T14:58:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118373",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:64" align="right">comment:64</div>

... though you could easily add the graceful dead ''here' as well.



---

archive/issue_comments_118374.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nI wanted to add it to M4RI and so far the update to this ticket does not require a new M4RI SPKG. I'm in the process of patching M4RI and will open a new ticket for it shortly. Once that's done we can easily make that a dependency for this ticket?",
    "created_at": "2011-08-29T15:28:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118374",
    "user": "https://github.com/malb"
}
```

<div id="comment:65" align="right">comment:65</div>

I wanted to add it to M4RI and so far the update to this ticket does not require a new M4RI SPKG. I'm in the process of patching M4RI and will open a new ticket for it shortly. Once that's done we can easily make that a dependency for this ticket?



---

archive/issue_comments_118375.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nAttachment: **[trac_11574_m4ri_sse2.patch.gz](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz)**\n\nThe updated patch *should* allow the Sage build to go through. Testing on cicero now. I also added some `depends` fields as suggested by Leif.",
    "created_at": "2011-08-29T15:32:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118375",
    "user": "https://github.com/malb"
}
```

<div id="comment:66" align="right">comment:66</div>

Attachment: **[trac_11574_m4ri_sse2.patch.gz](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz)**

The updated patch *should* allow the Sage build to go through. Testing on cicero now. I also added some `depends` fields as suggested by Leif.



---

archive/issue_events_153278.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-29T15:32:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153278"
}
```



---

archive/issue_events_153279.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-29T15:32:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153279"
}
```



---

archive/issue_comments_118376.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nThe new M4RI SPKG is at #11757",
    "created_at": "2011-08-29T16:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118376",
    "user": "https://github.com/malb"
}
```

<div id="comment:67" align="right">comment:67</div>

The new M4RI SPKG is at #11757



---

archive/issue_events_153280.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-29T18:21:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153280"
}
```



---

archive/issue_events_153281.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-29T18:21:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153281"
}
```



---

archive/issue_comments_118377.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@malb](#comment%3A67):\n> The new M4RI SPKG is at #11757\n\nDoes that mean that #11757 makes this ticket a duplicate?",
    "created_at": "2011-08-29T18:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118377",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@malb](#comment%3A67):
> The new M4RI SPKG is at #11757

Does that mean that #11757 makes this ticket a duplicate?



---

archive/issue_comments_118378.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@malb](#comment%3A66):\n> The updated patch *should* allow the Sage build to go through. Testing on cicero now. I also added some `depends` fields as suggested by Leif.\n\nYes, the updated patch does allow Sage to build and there are no failing tests.",
    "created_at": "2011-08-30T04:27:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118378",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@malb](#comment%3A66):
> The updated patch *should* allow the Sage build to go through. Testing on cicero now. I also added some `depends` fields as suggested by Leif.

Yes, the updated patch does allow Sage to build and there are no failing tests.



---

archive/issue_comments_118379.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@simon-king-jena](#comment%3A68):\n> Replying to [@malb](#comment%3A67):\n> > The new M4RI SPKG is at #11757\n> \n> \n> Does that mean that #11757 makes this ticket a duplicate?\n\nI guess one could look at it this way. I'd suggest: We deal with this ticket here first and if people then still have energy and are not sick of M4RI yet we can also include #11757.",
    "created_at": "2011-08-30T10:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118379",
    "user": "https://github.com/malb"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@simon-king-jena](#comment%3A68):
> Replying to [@malb](#comment%3A67):
> > The new M4RI SPKG is at #11757
> 
> 
> Does that mean that #11757 makes this ticket a duplicate?

I guess one could look at it this way. I'd suggest: We deal with this ticket here first and if people then still have energy and are not sick of M4RI yet we can also include #11757.



---

archive/issue_events_153282.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-30T19:20:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153282"
}
```



---

archive/issue_events_153283.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-30T19:20:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153283"
}
```



---

archive/issue_comments_118380.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nSo, anybody up for reviewing this? Or are people waiting for  [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz) being ported to #11757?",
    "created_at": "2011-08-31T10:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118380",
    "user": "https://github.com/malb"
}
```

<div id="comment:72" align="right">comment:72</div>

So, anybody up for reviewing this? Or are people waiting for  [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz) being ported to #11757?



---

archive/issue_comments_118381.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nReplying to [@malb](#comment%3A72):\n> So, anybody up for reviewing this? Or are people waiting for  [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz) being ported to #11757?\n\nI should probably defer review to Simon since I got in through the backdoor. However,\nsince Sage builds here and there are no doctest failures I would give it a positive review. I do have one question. Shouldn't this ticket depend upon ticket #11756, even though that one has a positive review?",
    "created_at": "2011-09-01T01:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118381",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:73" align="right">comment:73</div>

Replying to [@malb](#comment%3A72):
> So, anybody up for reviewing this? Or are people waiting for  [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz) being ported to #11757?

I should probably defer review to Simon since I got in through the backdoor. However,
since Sage builds here and there are no doctest failures I would give it a positive review. I do have one question. Shouldn't this ticket depend upon ticket #11756, even though that one has a positive review?



---

archive/issue_comments_118382.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@strogdon](#comment%3A73):\n> Shouldn't this ticket depend upon ticket #11756, even though that one has a positive review?\n\nYep, IMHO even if #11756 had already been merged into some devel release.",
    "created_at": "2011-09-01T02:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118382",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@strogdon](#comment%3A73):
> Shouldn't this ticket depend upon ticket #11756, even though that one has a positive review?

Yep, IMHO even if #11756 had already been merged into some devel release.



---

archive/issue_comments_118383.json:
```json
{
    "body": "Changed dependencies from **#11261** to **#11261 #11756**",
    "created_at": "2011-09-01T02:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118383",
    "user": "https://github.com/nexttime"
}
```

Changed dependencies from **#11261** to **#11261 #11756**



---

archive/issue_comments_118384.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@strogdon](#comment%3A73):\n> Replying to [@malb](#comment%3A72):\n> > So, anybody up for reviewing this? Or are people waiting for  [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz) being ported to #11757?\n> \n> I should probably defer review to Simon since I got in through the backdoor.\n\nSorry, I will probably not be able to review it in the next couple of days. So, iI'd appreciate if someone was quicker than I.",
    "created_at": "2011-09-01T11:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118384",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@strogdon](#comment%3A73):
> Replying to [@malb](#comment%3A72):
> > So, anybody up for reviewing this? Or are people waiting for  [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz) being ported to #11757?
> 
> I should probably defer review to Simon since I got in through the backdoor.

Sorry, I will probably not be able to review it in the next couple of days. So, iI'd appreciate if someone was quicker than I.



---

archive/issue_comments_118385.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nanyone?",
    "created_at": "2011-09-06T15:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118385",
    "user": "https://github.com/malb"
}
```

<div id="comment:76" align="right">comment:76</div>

anyone?



---

archive/issue_comments_118386.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,4 @@\n \n * **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg\n * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)\n+* **Apply** [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz)\n``````\n",
    "created_at": "2011-09-06T15:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118386",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,4 @@
 
 * **Install** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20110715.spkg
 * **Apply** [attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)
+* **Apply** [attachment: trac_11574_m4ri_sse2.patch](https://github.com/sagemath/sage/files/ticket11574/trac_11574_m4ri_sse2.patch.gz)
``````




---

archive/issue_events_153284.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2011-09-07T09:14:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153284"
}
```



---

archive/issue_events_153285.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2011-09-07T09:14:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153285"
}
```



---

archive/issue_comments_118387.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nThe spkg builds and and installs fine. Together with the patches `sage -testall ` was run successfully on a SuSE Linux Enterprise 11 x86_64, Gentoo i486, and Mac OS X 10.5 ppc. \n\nSo, I can cordially give a positive review!",
    "created_at": "2011-09-07T09:14:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118387",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:77" align="right">comment:77</div>

The spkg builds and and installs fine. Together with the patches `sage -testall ` was run successfully on a SuSE Linux Enterprise 11 x86_64, Gentoo i486, and Mac OS X 10.5 ppc. 

So, I can cordially give a positive review!



---

archive/issue_comments_118388.json:
```json
{
    "body": "Changed reviewer from **Simon King** to **Simon King, Alexander Dreyer**",
    "created_at": "2011-09-07T09:14:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118388",
    "user": "https://github.com/alexanderdreyer"
}
```

Changed reviewer from **Simon King** to **Simon King, Alexander Dreyer**



---

archive/issue_comments_118389.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\n[attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz) has no ticket number in its commit message.",
    "created_at": "2011-09-12T06:39:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118389",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:78" align="right">comment:78</div>

[attachment: m4ri_20110601.patch](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz) has no ticket number in its commit message.



---

archive/issue_comments_118390.json:
```json
{
    "body": "rebased to 4.7.1.alpha4",
    "created_at": "2011-09-12T14:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118390",
    "user": "https://github.com/malb"
}
```

rebased to 4.7.1.alpha4



---

archive/issue_comments_118391.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nAttachment: **[m4ri_20110601.patch.gz](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)**\n\nfixed.",
    "created_at": "2011-09-12T14:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118391",
    "user": "https://github.com/malb"
}
```

<div id="comment:79" align="right">comment:79</div>

Attachment: **[m4ri_20110601.patch.gz](https://github.com/sagemath/sage/files/ticket11574/m4ri_20110601.patch.gz)**

fixed.



---

archive/issue_comments_118392.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha3**",
    "created_at": "2011-09-12T18:36:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11574#issuecomment-118392",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.2.alpha3**



---

archive/issue_events_153286.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T18:36:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153286"
}
```



---

archive/issue_events_153287.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T18:36:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11574",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11574#event-153287"
}
```
