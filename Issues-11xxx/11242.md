# Issue 11242: python spkg build fails on Ubuntu 11.04

archive/issues_011070.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-GeorgSWeber"
    ],
    "body": "I found this build failure with sage 4.6.2 on Ubuntu 11.04 64bit beta2. I believe it affects all sage versions, all arches, on Ubuntu 11.04 and higher.\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/593b9a4124f5075d\n\nReport upstream: Ubuntu already patch their python as I propose to patch the sage python with one line to build the crypt module with -lcrypt. Upstream python does not build on Ubuntu without this patch, and this one line suffices. Upstream python says this is because Ubuntu 11.04 introduced some multiarch support. More details in the google thread and the python bug referred to in that thread.\n\nFiles changed in the attached spkg:\npatches/Setup.dist\npatches/Setup.dist.patch \nspkg-install\nSPKG.txt\nchangelog\n\nThis needs testing on other releases, distros, and OSes. If it breaks building on other systems a specific check for Ubuntu can be added with [ \"x`lsb_release -d`\" == \"xDescription: Ubuntu 11.04\" (after 1 May 2011 when this release is out). Then the patch can only be applied for that specific version of Ubuntu. \n\nThis spkg can be tested with sage -f python-2.6.4.p10.spkg.\nRevert with cd SAGE_ROOT/spkg/standard; sage -f python-2.6.4.p9.spkg.\n\nThe error is obvious -- both in the python install log and when starting sage import crypt fails.\n\nKeywords: **python crypt natty**\n\nComponent: **packages: standard**\n\nReviewer: **Jan Groenewald, Leif Leonhardy**\n\nUpstream: **None of the above - read trac for reasoning.**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11242_\n\n",
    "closed_at": "2011-09-12T20:25:35Z",
    "created_at": "2011-04-23T15:31:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "python spkg build fails on Ubuntu 11.04",
    "type": "issue",
    "updated_at": "2011-09-29T13:47:56Z",
    "url": "https://github.com/sagemath/sage/issues/11242",
    "user": "https://github.com/pipedream"
}
```
I found this build failure with sage 4.6.2 on Ubuntu 11.04 64bit beta2. I believe it affects all sage versions, all arches, on Ubuntu 11.04 and higher.

http://groups.google.com/group/sage-devel/browse_thread/thread/593b9a4124f5075d

Report upstream: Ubuntu already patch their python as I propose to patch the sage python with one line to build the crypt module with -lcrypt. Upstream python does not build on Ubuntu without this patch, and this one line suffices. Upstream python says this is because Ubuntu 11.04 introduced some multiarch support. More details in the google thread and the python bug referred to in that thread.

Files changed in the attached spkg:
patches/Setup.dist
patches/Setup.dist.patch 
spkg-install
SPKG.txt
changelog

This needs testing on other releases, distros, and OSes. If it breaks building on other systems a specific check for Ubuntu can be added with [ "x`lsb_release -d`" == "xDescription: Ubuntu 11.04" (after 1 May 2011 when this release is out). Then the patch can only be applied for that specific version of Ubuntu. 

This spkg can be tested with sage -f python-2.6.4.p10.spkg.
Revert with cd SAGE_ROOT/spkg/standard; sage -f python-2.6.4.p9.spkg.

The error is obvious -- both in the python install log and when starting sage import crypt fails.

Keywords: **python crypt natty**

Component: **packages: standard**

Reviewer: **Jan Groenewald, Leif Leonhardy**

Upstream: **None of the above - read trac for reasoning.**

_Issue created by migration from https://trac.sagemath.org/ticket/11242_





---

archive/issue_events_148951.json:
```json
{
    "actor": "https://github.com/pipedream",
    "created_at": "2011-04-23T15:31:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148951"
}
```



---

archive/issue_events_148952.json:
```json
{
    "actor": "https://github.com/pipedream",
    "created_at": "2011-04-23T15:31:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148952"
}
```



---

archive/issue_events_148953.json:
```json
{
    "actor": "https://github.com/pipedream",
    "created_at": "2011-04-23T15:31:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148953"
}
```



---

archive/issue_events_148954.json:
```json
{
    "actor": "https://github.com/pipedream",
    "created_at": "2011-04-23T15:31:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148954"
}
```



---

archive/issue_events_148955.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2011-04-23T15:31:36Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "subject": "https://github.com/pipedream",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148955"
}
```



---

archive/issue_comments_112386.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHow do I delete this ticket? IT is a duplicate of 11243",
    "created_at": "2011-04-23T15:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112386",
    "user": "https://github.com/pipedream"
}
```

<div id="comment:1" align="right">comment:1</div>

How do I delete this ticket? IT is a duplicate of 11243



---

archive/issue_events_148956.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148956"
}
```



---

archive/issue_events_148957.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148957"
}
```



---

archive/issue_events_148958.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148958"
}
```



---

archive/issue_comments_112387.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis is a duplicate of #11447, #11243, fixed in the Python 2.6.4.p11 spkg.",
    "created_at": "2011-09-10T22:50:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112387",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:2" align="right">comment:2</div>

This is a duplicate of #11447, #11243, fixed in the Python 2.6.4.p11 spkg.



---

archive/issue_events_148959.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148959"
}
```



---

archive/issue_events_148960.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148960"
}
```



---

archive/issue_events_148961.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148961"
}
```



---

archive/issue_events_148962.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148962"
}
```



---

archive/issue_events_148963.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T22:50:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148963"
}
```



---

archive/issue_events_148964.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T20:25:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148964"
}
```



---

archive/issue_events_148965.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T20:25:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148965"
}
```



---

archive/issue_events_148966.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T20:25:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11242#event-148966"
}
```



---

archive/issue_comments_112388.json:
```json
{
    "body": "Merged: **sage-4.7.1.rc0**",
    "created_at": "2011-09-12T20:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112388",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.1.rc0**



---

archive/issue_comments_112389.json:
```json
{
    "body": "Changed author from **Jan Groenewald** to none",
    "created_at": "2011-09-29T02:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112389",
    "user": "https://github.com/nexttime"
}
```

Changed author from **Jan Groenewald** to none



---

archive/issue_comments_112390.json:
```json
{
    "body": "Reviewer: **Jan Groenewald, Leif Leonhardy**",
    "created_at": "2011-09-29T02:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112390",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **Jan Groenewald, Leif Leonhardy**



---

archive/issue_comments_112391.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nleif, please explain the \"merged in: sage-4.7.1.rc0\"\n\nIf this ticket is duplicate, there is nothing to merge...",
    "created_at": "2011-09-29T13:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112391",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

leif, please explain the "merged in: sage-4.7.1.rc0"

If this ticket is duplicate, there is nothing to merge...



---

archive/issue_comments_112392.json:
```json
{
    "body": "Changed merged from **sage-4.7.1.rc0** to none",
    "created_at": "2011-09-29T13:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11242#issuecomment-112392",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.1.rc0** to none
