# Issue 11481: LLL for degenerate matrices crashes

archive/issues_011309.json:
```json
{
    "body": "For zero-column matrices, LLL crashes:\n\n```\nsage: matrix(ZZ,0,2).LLL()\n^C^C^C^C^C\n```\nIts particularly annoying that keyboard interrupt does not work.\n\n\nReally, the issue is that fpLLL can't handle zero-row matrices and apparently corrupts the stack:\n\n```\nsage: from sage.libs.fplll.fplll import FP_LLL\nsage: A = matrix(ZZ, 0, 2)\nsage: fp = FP_LLL(A)\nsage: fp.fast()\n^C^C^C^C\n```\n\nThe attached patch short-circuits LLL for degenerate matrices and will make fpLLL raise a `ValueError` if the matrix has zero rows.\n\nApply [attachment:trac_11481_LLL_for_degenerate_matrices.patch]\n\nAssignee: jason, was\n\nCC:  @novoselt @jasongrout spancratz stumpc5 @rbeezer\n\nKeywords: sd31\n\nResolution: fixed\n\nAuthor: Volker Braun\n\nReviewer: Robert Bradshaw\n\nMerged: sage-4.7.1.alpha4\n\nIssue created by migration from https://trac.sagemath.org/ticket/11481\n\n",
    "closed_at": "2011-06-20T15:18:25Z",
    "created_at": "2011-06-14T15:40:16Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "LLL for degenerate matrices crashes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11481",
    "user": "https://github.com/vbraun"
}
```
For zero-column matrices, LLL crashes:

```
sage: matrix(ZZ,0,2).LLL()
^C^C^C^C^C
```
Its particularly annoying that keyboard interrupt does not work.


Really, the issue is that fpLLL can't handle zero-row matrices and apparently corrupts the stack:

```
sage: from sage.libs.fplll.fplll import FP_LLL
sage: A = matrix(ZZ, 0, 2)
sage: fp = FP_LLL(A)
sage: fp.fast()
^C^C^C^C
```

The attached patch short-circuits LLL for degenerate matrices and will make fpLLL raise a `ValueError` if the matrix has zero rows.

Apply [attachment:trac_11481_LLL_for_degenerate_matrices.patch]

Assignee: jason, was

CC:  @novoselt @jasongrout spancratz stumpc5 @rbeezer

Keywords: sd31

Resolution: fixed

Author: Volker Braun

Reviewer: Robert Bradshaw

Merged: sage-4.7.1.alpha4

Issue created by migration from https://trac.sagemath.org/ticket/11481





---

archive/issue_comments_131486.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -6,6 +6,21 @@\n \\`\\`\\`\n Its particularly annoying that keyboard interrupt does not work.\n \n+\n+Really, the issue is that fpLLL can't handle zero-row matrices and apparently corrupts the stack:\n+\n+\\`\\`\\`\n+sage: from sage.libs.fplll.fplll import FP_LLL\n+sage: A = matrix(ZZ, 0, 2)\n+sage: fp = FP_LLL(A)\n+sage: fp.fast()\n+^C^C^C^C\n+\\`\\`\\`\n+\n+The attached patch short-circuits LLL for degenerate matrices and will make fpLLL raise a \\`ValueError\\` if the matrix has zero rows.\n+\n+Apply [attachment:trac_11481_LLL_for_degenerate_matrices.patch]\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/11481\n```\n",
    "created_at": "2011-06-14T16:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131486",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -6,6 +6,21 @@
 \`\`\`
 Its particularly annoying that keyboard interrupt does not work.
 
+
+Really, the issue is that fpLLL can't handle zero-row matrices and apparently corrupts the stack:
+
+\`\`\`
+sage: from sage.libs.fplll.fplll import FP_LLL
+sage: A = matrix(ZZ, 0, 2)
+sage: fp = FP_LLL(A)
+sage: fp.fast()
+^C^C^C^C
+\`\`\`
+
+The attached patch short-circuits LLL for degenerate matrices and will make fpLLL raise a \`ValueError\` if the matrix has zero rows.
+
+Apply [attachment:trac_11481_LLL_for_degenerate_matrices.patch]
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/11481
```




---

archive/issue_comments_131487.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-06-14T16:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131487",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_131488.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-06-15T20:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131488",
    "user": "https://github.com/robertwb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131489.json:
```json
{
    "body": "<a id='comment:5'></a>Interesting.  On sage-4.7.1.alpha3, I actually get:\n\n```\nsage: matrix(ZZ,0,2).LLL()\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off(). You might\nwant to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate.\n------------------------------------------------------------------------\n```",
    "created_at": "2011-06-16T10:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131489",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Interesting.  On sage-4.7.1.alpha3, I actually get:

```
sage: matrix(ZZ,0,2).LLL()
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off(). You might
want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate.
------------------------------------------------------------------------
```



---

archive/issue_comments_131490.json:
```json
{
    "body": "<a id='comment:6'></a>In my previous post, I clearly meant *without* the patch.",
    "created_at": "2011-06-16T10:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131490",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>In my previous post, I clearly meant *without* the patch.



---

archive/issue_comments_131491.json:
```json
{
    "body": "<a id='comment:7'></a>The patch is missing a proper commit message.",
    "created_at": "2011-06-16T10:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131491",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>The patch is missing a proper commit message.



---

archive/issue_comments_131492.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-06-16T10:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131492",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_131493.json:
```json
{
    "body": "Updated patch",
    "created_at": "2011-06-16T16:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131493",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_131494.json:
```json
{
    "body": "<a id='comment:8'></a>Attachment [trac_11481_LLL_for_degenerate_matrices.patch](tarball://root/attachments/some-uuid/ticket11481/trac_11481_LLL_for_degenerate_matrices.patch) by @vbraun created at 2011-06-16 16:08:41\n\nSorry, forgot in the heat of the moment. The updated patch only adds the commit message.",
    "created_at": "2011-06-16T16:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131494",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>Attachment [trac_11481_LLL_for_degenerate_matrices.patch](tarball://root/attachments/some-uuid/ticket11481/trac_11481_LLL_for_degenerate_matrices.patch) by @vbraun created at 2011-06-16 16:08:41

Sorry, forgot in the heat of the moment. The updated patch only adds the commit message.



---

archive/issue_comments_131495.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-06-16T16:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131495",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_131496.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-06-16T16:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131496",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131497.json:
```json
{
    "body": "<a id='comment:10'></a>Small remark: for simply changing the commit message, I think there is no need for review.  You can set back positive_review directly.",
    "created_at": "2011-06-16T21:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131497",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Small remark: for simply changing the commit message, I think there is no need for review.  You can set back positive_review directly.



---

archive/issue_events_029890.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-20T15:18:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11481#event-29890"
}
```



---

archive/issue_comments_131498.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-06-20T15:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11481",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11481#issuecomment-131498",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
