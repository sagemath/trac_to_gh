# Issue 11259: LU decomposition for matrices with exact base rings

archive/issues_011087.json:
```json
{
    "body": "This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.\n\n**Apply:**\n1. [attachment:trac_11259-exact-LU-decomposition-v3.patch]\n2. [attachment:trac_11259-exact-LU-decomposition-caching.patch]\n\n\n**Assignee:** @jasongrout, @williamstein\n\n**Keywords:** sd32\n\n**Author:** Rob Beezer\n\n**Reviewer:** Martin Raum\n\n**Merged:** sage-4.7.2.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/11259\n\n",
    "closed_at": "2011-09-17T04:42:59Z",
    "created_at": "2011-04-26T22:29:50Z",
    "labels": [
        "component: linear algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "LU decomposition for matrices with exact base rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11259",
    "user": "https://github.com/rbeezer"
}
```
This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.

**Apply:**
1. [attachment:trac_11259-exact-LU-decomposition-v3.patch]
2. [attachment:trac_11259-exact-LU-decomposition-caching.patch]


**Assignee:** @jasongrout, @williamstein

**Keywords:** sd32

**Author:** Rob Beezer

**Reviewer:** Martin Raum

**Merged:** sage-4.7.2.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/11259





---

archive/issue_comments_142857.json:
```json
{
    "body": "**Author:** Rob Beezer",
    "created_at": "2011-04-26T22:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142857",
    "user": "https://github.com/rbeezer"
}
```

**Author:** Rob Beezer



---

archive/issue_comments_142858.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.\n+\n+**Apply:**\n+1. [attachment:trac_11259-exact-LU-decomposition.patch]\n+\n``````\n",
    "created_at": "2011-04-26T22:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142858",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.
+
+**Apply:**
+1. [attachment:trac_11259-exact-LU-decomposition.patch]
+
``````




---

archive/issue_comments_142859.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-04-26T22:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142859",
    "user": "https://github.com/rbeezer"
}
```

**Changing status** from new to needs_review.



---

archive/attachments_014743.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11259-exact-LU-decomposition.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11259/trac_11259-exact-LU-decomposition.patch",
    "created_at": "2011-04-26T22:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_142860.json:
```json
{
    "body": "<a id='comment:1'></a>\nPatchbot:\n\nApply trac_11259-exact-LU-decomposition.patch",
    "created_at": "2011-04-26T22:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142860",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:1'></a>
Patchbot:

Apply trac_11259-exact-LU-decomposition.patch



---

archive/attachments_014744.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11259-exact-LU-decomposition-v2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11259/trac_11259-exact-LU-decomposition-v2.patch",
    "created_at": "2011-04-27T23:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_142861.json:
```json
{
    "body": "<a id='comment:2'></a>\nv2 patch just adds in a few bits and pieces to the documentation.\n\nPatchbot:\n\nApply trac_11259-exact-LU-decomposition-v2.patch",
    "created_at": "2011-04-27T23:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142861",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:2'></a>
v2 patch just adds in a few bits and pieces to the documentation.

Patchbot:

Apply trac_11259-exact-LU-decomposition-v2.patch



---

archive/issue_comments_142862.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.\n \n **Apply:**\n-1. [attachment:trac_11259-exact-LU-decomposition.patch]\n+1. [attachment:trac_11259-exact-LU-decomposition-v2.patch]\n \n``````\n",
    "created_at": "2011-04-27T23:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142862",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.
 
 **Apply:**
-1. [attachment:trac_11259-exact-LU-decomposition.patch]
+1. [attachment:trac_11259-exact-LU-decomposition-v2.patch]
 
``````




---

archive/issue_comments_142863.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.\n \n **Apply:**\n-1. [attachment:trac_11259-exact-LU-decomposition-v2.patch]\n+1. [attachment:trac_11259-exact-LU-decomposition-v3.patch]\n \n``````\n",
    "created_at": "2011-05-21T20:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142863",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 This is an optimized implementation of the LU decomposition.  It runs at about twice the speed of the generic echelon form routine (as theory predicts), so with backsubstitution it might be the basis for a faster solver for systems of linear equations over certain fields.
 
 **Apply:**
-1. [attachment:trac_11259-exact-LU-decomposition-v2.patch]
+1. [attachment:trac_11259-exact-LU-decomposition-v3.patch]
 
``````




---

archive/issue_comments_142864.json:
```json
{
    "body": "<a id='comment:3'></a>\nCalling this from another routine suggests an \"auto\" option on the pivoting strategy to allow for a variety of base rings.  v3 patch adds that in.\n\nPatchbot:\n\nApply trac_11259-exact-LU-decomposition-v3.patch",
    "created_at": "2011-05-21T20:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142864",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:3'></a>
Calling this from another routine suggests an "auto" option on the pivoting strategy to allow for a variety of base rings.  v3 patch adds that in.

Patchbot:

Apply trac_11259-exact-LU-decomposition-v3.patch



---

archive/attachments_014745.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11259-exact-LU-decomposition-v3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11259/trac_11259-exact-LU-decomposition-v3.patch",
    "created_at": "2011-05-21T20:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_142865.json:
```json
{
    "body": "",
    "created_at": "2011-05-21T20:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142865",
    "user": "https://github.com/rbeezer"
}
```





---

archive/issue_comments_142866.json:
```json
{
    "body": "<a id='comment:4'></a>\nLet us (try to) wake up the patch buildbot\n\nApply trac_11259-exact-LU-decomposition-v3.patch",
    "created_at": "2011-06-25T07:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142866",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
Let us (try to) wake up the patch buildbot

Apply trac_11259-exact-LU-decomposition-v3.patch



---

archive/issue_comments_142867.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2011-08-17T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142867",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_142868.json:
```json
{
    "body": "<a id='comment:5'></a>\nI haven't yet tested this, but from looking at the code I find two things that I would ask you to change:\n1. the import statements should not go into the method, but rather to the header of the file\n2. the caching is utterly inefficient, when it comes to 'auto'. In case you deal with 'auto' pivots, would you mind to first convert it to either of the two normal values and than call fetch()? This won't cost much time, but it can save space and also prevents you from computing the same thing twice.\n\nYou also might want to try to use add_multiple_of_row to make the implementation either faster or more readable. Not sure whether you have already considered this, but it could be worth a try.",
    "created_at": "2011-08-17T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142868",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:5'></a>
I haven't yet tested this, but from looking at the code I find two things that I would ask you to change:
1. the import statements should not go into the method, but rather to the header of the file
2. the caching is utterly inefficient, when it comes to 'auto'. In case you deal with 'auto' pivots, would you mind to first convert it to either of the two normal values and than call fetch()? This won't cost much time, but it can save space and also prevents you from computing the same thing twice.

You also might want to try to use add_multiple_of_row to make the implementation either faster or more readable. Not sure whether you have already considered this, but it could be worth a try.



---

archive/issue_comments_142869.json:
```json
{
    "body": "<a id='comment:6'></a>\nIn the light of what we have said about imports in another ticket, I think the comment on imports is void. Just to mention it ...",
    "created_at": "2011-08-21T22:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142869",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:6'></a>
In the light of what we have said about imports in another ticket, I think the comment on imports is void. Just to mention it ...



---

archive/issue_comments_142870.json:
```json
{
    "body": "<a id='comment:7'></a>\nThanks for making that clear.  Have not looked at caching yet, but will soon.\n\nRob\n\nReplying to [mraum](#comment%3A6):\n> In the light of what we have said about imports in another ticket, I think the comment on imports is void. Just to mention it ...\n",
    "created_at": "2011-08-21T23:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142870",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:7'></a>
Thanks for making that clear.  Have not looked at caching yet, but will soon.

Rob

Replying to [mraum](#comment%3A6):
> In the light of what we have said about imports in another ticket, I think the comment on imports is void. Just to mention it ...




---

archive/issue_comments_142871.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [mraum](#comment%3A5):\n> 2. the caching is utterly inefficient, when it comes to 'auto'. In case you deal with 'auto' pivots, would you mind to first convert it to either of the two normal values and than call fetch()? This won't cost much time, but it can save space and also prevents you from computing the same thing twice.\n\n\nOK, I see now.  Pretty bad.  ;-)  I am thinking to replace 'auto' by None, and early on decide which strategy to employ, then check the cache.  Thanks for catching this one.",
    "created_at": "2011-08-22T01:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142871",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:8'></a>
Replying to [mraum](#comment%3A5):
> 2. the caching is utterly inefficient, when it comes to 'auto'. In case you deal with 'auto' pivots, would you mind to first convert it to either of the two normal values and than call fetch()? This won't cost much time, but it can save space and also prevents you from computing the same thing twice.


OK, I see now.  Pretty bad.  ;-)  I am thinking to replace 'auto' by None, and early on decide which strategy to employ, then check the cache.  Thanks for catching this one.



---

archive/attachments_014746.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11259-exact-LU-decomposition-caching.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11259/trac_11259-exact-LU-decomposition-caching.patch",
    "created_at": "2011-08-23T02:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/rbeezer"
}
```



---

archive/issue_comments_142872.json:
```json
{
    "body": "",
    "created_at": "2011-08-23T02:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142872",
    "user": "https://github.com/rbeezer"
}
```





---

archive/issue_comments_142873.json:
```json
{
    "body": "<a id='comment:9'></a>\n\"caching\" patch rearranges the code to do (what I think is) the minimum possible to determine the pivoting strategy, and *then* goes to check the cache.  It fixes the problems with the old 'auto' strategy parameter.\n\nOriginal version of this code used things like \"add_multiple_of_row()\".  It proved faster to use the \"unsafe\" methods down in the heart of the nested loops.",
    "created_at": "2011-08-23T02:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142873",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:9'></a>
"caching" patch rearranges the code to do (what I think is) the minimum possible to determine the pivoting strategy, and *then* goes to check the cache.  It fixes the problems with the old 'auto' strategy parameter.

Original version of this code used things like "add_multiple_of_row()".  It proved faster to use the "unsafe" methods down in the heart of the nested loops.



---

archive/issue_comments_142874.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-08-23T02:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142874",
    "user": "https://github.com/rbeezer"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_142875.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,5 @@\n \n **Apply:**\n 1. [attachment:trac_11259-exact-LU-decomposition-v3.patch]\n+2. [attachment:trac_11259-exact-LU-decomposition-caching.patch]\n \n``````\n",
    "created_at": "2011-08-23T02:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142875",
    "user": "https://github.com/rbeezer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,5 @@
 
 **Apply:**
 1. [attachment:trac_11259-exact-LU-decomposition-v3.patch]
+2. [attachment:trac_11259-exact-LU-decomposition-caching.patch]
 
``````




---

archive/issue_comments_142876.json:
```json
{
    "body": "**Reviewer:** Martin Raum",
    "created_at": "2011-08-24T08:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142876",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Reviewer:** Martin Raum



---

archive/issue_comments_142877.json:
```json
{
    "body": "<a id='comment:10'></a>\nThat is what I think is optimal, too. Concerning the add_multiple_of_row: Interesting, I really would have expected the contrary.",
    "created_at": "2011-08-24T08:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142877",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:10'></a>
That is what I think is optimal, too. Concerning the add_multiple_of_row: Interesting, I really would have expected the contrary.



---

archive/issue_comments_142878.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-08-24T08:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142878",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_142879.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd32\".",
    "created_at": "2011-08-25T18:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142879",
    "user": "https://github.com/rbeezer"
}
```

**Changing keywords** from "" to "sd32".



---

archive/issue_comments_142880.json:
```json
{
    "body": "**Merged:** sage-4.7.2.alpha3",
    "created_at": "2011-09-17T04:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11259#issuecomment-142880",
    "user": "https://github.com/nexttime"
}
```

**Merged:** sage-4.7.2.alpha3



---

archive/issue_events_034229.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-17T04:42:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11259",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11259#event-34229"
}
```
