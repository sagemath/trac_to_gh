# Issue 11687: Sanitize `sage-env`

archive/issues_011515.json:
```json
{
    "assignees": [
        "https://github.com/nexttime"
    ],
    "body": "There are currently a couple of issues with `sage-env`; approximately ordered by importance:\n\n* The definition of `UNAME` (currently on line 458) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n* We should save the original, unmodified `PATH` (to `SAGE_ORIG_PATH`), analoguous to `SAGE_ORIG_LD_LIBRARY_PATH` etc., and perhaps record this in `SAGE_ORIG_PATH_SET`. This should also be done close to the top, of course before modifying `PATH`. (#10202 also suggests / introduces this.)\n* There's partially useless code like\n\n```sh\nif [ \"$LDFLAGS\" = \"\" ]; then\n    LDFLAGS=\"\"          && export LDFLAGS\nfi\n```\n* *All* variables that are expected to be either \"`yes`\", \"`no`\" or empty / unset should be checked for [in]valid settings, and perhaps normalized (i.e., for example set to \"`no`\" in case they're empty or not set). \n\n  We currently only do this for `SAGE64`\n* The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.\n\n---\n\nWe should IMHO also save the original settings of `CC`, `CFLAGS`, `LD`, `LDFLAGS`, `MAKE` etc., since it is otherwise impossible for scripts (like the `spkg-install`s) to determine whether or which parts of the current settings were made by Sage, and which originate from the user (intentionally or not, e.g. from system-wide or default `.*rc` files).\n\nA better approach would be to have and use `SAGE_CC` etc. instead, but this would require changes to all spkgs and other build-related files.\n\n---\n\nSome of the rather minor issues can be fixed on their own / follow-up tickets, but it would be odd to have a dozen \"concurring\" tickets all modifying `sage-env` at the same time.\n\n\nCC:  @kini\n\nKeywords: **BUILD sage-spkg pkg-config .pc pkgconfig PKG_CONFIG_PATH SAGE_PATH Cygwin environment variables**\n\nBranch/Commit: **[`1286497`](https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **scripts**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11687_\n\n",
    "closed_at": "2015-06-18T17:57:54Z",
    "created_at": "2011-08-14T06:18:37Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Sanitize `sage-env`",
    "type": "issue",
    "updated_at": "2015-06-18T17:57:54Z",
    "url": "https://github.com/sagemath/sage/issues/11687",
    "user": "https://github.com/nexttime"
}
```
There are currently a couple of issues with `sage-env`; approximately ordered by importance:

* The definition of `UNAME` (currently on line 458) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
* We should save the original, unmodified `PATH` (to `SAGE_ORIG_PATH`), analoguous to `SAGE_ORIG_LD_LIBRARY_PATH` etc., and perhaps record this in `SAGE_ORIG_PATH_SET`. This should also be done close to the top, of course before modifying `PATH`. (#10202 also suggests / introduces this.)
* There's partially useless code like

```sh
if [ "$LDFLAGS" = "" ]; then
    LDFLAGS=""          && export LDFLAGS
fi
```
* *All* variables that are expected to be either "`yes`", "`no`" or empty / unset should be checked for [in]valid settings, and perhaps normalized (i.e., for example set to "`no`" in case they're empty or not set). 

  We currently only do this for `SAGE64`
* The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.

---

We should IMHO also save the original settings of `CC`, `CFLAGS`, `LD`, `LDFLAGS`, `MAKE` etc., since it is otherwise impossible for scripts (like the `spkg-install`s) to determine whether or which parts of the current settings were made by Sage, and which originate from the user (intentionally or not, e.g. from system-wide or default `.*rc` files).

A better approach would be to have and use `SAGE_CC` etc. instead, but this would require changes to all spkgs and other build-related files.

---

Some of the rather minor issues can be fixed on their own / follow-up tickets, but it would be odd to have a dozen "concurring" tickets all modifying `sage-env` at the same time.


CC:  @kini

Keywords: **BUILD sage-spkg pkg-config .pc pkgconfig PKG_CONFIG_PATH SAGE_PATH Cygwin environment variables**

Branch/Commit: **[`1286497`](https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565)**

Reviewer: **Jeroen Demeyer**

Author: **Frédéric Chapoton**

Component: **scripts**

_Issue created by migration from https://trac.sagemath.org/ticket/11687_





---

archive/issue_events_156825.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-14T06:18:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156825"
}
```



---

archive/issue_events_156826.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-14T06:18:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20scripts",
    "label_color": "000080",
    "label_name": "c: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156826"
}
```



---

archive/issue_events_156827.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-14T06:18:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156827"
}
```



---

archive/issue_events_156828.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-14T06:18:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156828"
}
```



---

archive/issue_events_156829.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-14T06:18:37Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "subject": "https://github.com/nexttime",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156829"
}
```



---

archive/issue_comments_120937.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWe could also define (and export) `PKG_CONFIG_TOP_BUILD_DIR`, namely to `${SAGE_ROOT}/local`, and use\n\n```\nprefix=${pc_top_builddir}\n```\nor, a bit more flexible, define it to just `${SAGE_ROOT}` and use\n\n```\nprefix=${pc_top_builddir}/local\n```\nin all `pkg-config` (`*.pc`) files, which avoids wrapping `pkg-config` just to add `--define-variable=SAGE_ROOT=\"${SAGE_ROOT}\"` to each invocation.\n\nThis is even safer than using\n\n```\nprefix=$${SAGE_ROOT}/local\n```\nthough I haven't [yet] encountered problems with the latter. (The `$$` has the same meaning as in Makefiles, i.e. escapes the `$` such that the resulting environment variable will be interpreted -- or substituted -- later, by the shell.)",
    "created_at": "2011-08-14T08:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120937",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:1" align="right">comment:1</div>

We could also define (and export) `PKG_CONFIG_TOP_BUILD_DIR`, namely to `${SAGE_ROOT}/local`, and use

```
prefix=${pc_top_builddir}
```
or, a bit more flexible, define it to just `${SAGE_ROOT}` and use

```
prefix=${pc_top_builddir}/local
```
in all `pkg-config` (`*.pc`) files, which avoids wrapping `pkg-config` just to add `--define-variable=SAGE_ROOT="${SAGE_ROOT}"` to each invocation.

This is even safer than using

```
prefix=$${SAGE_ROOT}/local
```
though I haven't [yet] encountered problems with the latter. (The `$$` has the same meaning as in Makefiles, i.e. escapes the `$` such that the resulting environment variable will be interpreted -- or substituted -- later, by the shell.)



---

archive/issue_comments_120938.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n * `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).\n * `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202).\n-* The definition of `UNAME` (currently on line 284) has to be moved up, preferably right after `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n+* The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n * The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `\"$1\" = \"-short\"`:\n \n ```sh\n@@ -10,7 +10,7 @@\n     PATH=\"$PATH:$SAGE_LOCAL/lib\" && export PATH\n fi\n ```\n-   Moreover, I think the directory should be **pre**pendend to the path, but perhaps *after* `$SAGE_ROOT/local/bin`.\n+   Moreover, I think the directory should be **pre**pendend to the path, but perhaps in a way that it is still preceded by `$SAGE_ROOT/local/bin`.\n * `SAGE_PATH` (followed by a colon) is prepended to `PYTHONPATH` even if it is empty / undefined. Some programs interpret this as if the current working directory (\"`.`\") was prepended. \n \n   It also shouldn't be set to (or contain) \"`.`\", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).\n``````\n",
    "created_at": "2011-08-14T15:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120938",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 * `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).
 * `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202).
-* The definition of `UNAME` (currently on line 284) has to be moved up, preferably right after `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
+* The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
 * The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `"$1" = "-short"`:
 
 ```sh
@@ -10,7 +10,7 @@
     PATH="$PATH:$SAGE_LOCAL/lib" && export PATH
 fi
 ```
-   Moreover, I think the directory should be **pre**pendend to the path, but perhaps *after* `$SAGE_ROOT/local/bin`.
+   Moreover, I think the directory should be **pre**pendend to the path, but perhaps in a way that it is still preceded by `$SAGE_ROOT/local/bin`.
 * `SAGE_PATH` (followed by a colon) is prepended to `PYTHONPATH` even if it is empty / undefined. Some programs interpret this as if the current working directory ("`.`") was prepended. 
 
   It also shouldn't be set to (or contain) "`.`", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).
``````




---

archive/issue_comments_120939.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSince there is already a lot of progress on #11021, can we finish that one off and have this ticket depend on that one?",
    "created_at": "2011-08-14T15:08:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120939",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

Since there is already a lot of progress on #11021, can we finish that one off and have this ticket depend on that one?



---

archive/issue_comments_120940.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -41,7 +41,7 @@\n     return 1\n fi\n ```\n-* `sage-env` has a bug w.r.t. \"guessing\" the value `SAGE_ROOT` should be set to, which leads to annoying or confusing warnings \"`Attempted to overwrite SAGE_ROOT ...`\", cf. comments at #11021.\n+* `sage-env` has a bug w.r.t. \"guessing\" the value `SAGE_ROOT` should be set to, which leads to annoying or confusing warnings \"`Attempted to overwrite SAGE_ROOT ...`\", see [comment:ticket:11021:24 this comment] at #11021; thanks to John Palmieri for tracking this down.\n * The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.\n * We could also source `~/.sagerc` (or `$DOT_SAGE/[.]sagerc`), if one of it exists, at some point in `sage-env`, to allow setting up typical variables (like e.g. `SAGE64`, perhaps depending on `hostname`, and other Sage-specific variables) automatically in a flexible and generic way.\n \n``````\n",
    "created_at": "2011-08-14T15:43:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120940",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -41,7 +41,7 @@
     return 1
 fi
 ```
-* `sage-env` has a bug w.r.t. "guessing" the value `SAGE_ROOT` should be set to, which leads to annoying or confusing warnings "`Attempted to overwrite SAGE_ROOT ...`", cf. comments at #11021.
+* `sage-env` has a bug w.r.t. "guessing" the value `SAGE_ROOT` should be set to, which leads to annoying or confusing warnings "`Attempted to overwrite SAGE_ROOT ...`", see [comment:ticket:11021:24 this comment] at #11021; thanks to John Palmieri for tracking this down.
 * The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.
 * We could also source `~/.sagerc` (or `$DOT_SAGE/[.]sagerc`), if one of it exists, at some point in `sage-env`, to allow setting up typical variables (like e.g. `SAGE64`, perhaps depending on `hostname`, and other Sage-specific variables) automatically in a flexible and generic way.
 
``````




---

archive/issue_comments_120941.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@jhpalmieri](#comment:4):\n> Since there is already a lot of progress on #11021, can we finish that one off and have this ticket depend on that one?\n\nCurrently sorting out what to fix where and in which order.\n\n#11021 doesn't change much, and I intended to attach a couple of small patches to `sage-env` here for independent issues, so that they should all apply in almost random order, with just line numbers changing.\n\nWe can then leave out individual patches here in case other tickets already fix things.\n\n---\n\nI'll hopefully return to #11021 today and [try to] finish it, though I originally planned other things... ;-)",
    "created_at": "2011-08-14T15:54:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120941",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@jhpalmieri](#comment:4):
> Since there is already a lot of progress on #11021, can we finish that one off and have this ticket depend on that one?

Currently sorting out what to fix where and in which order.

#11021 doesn't change much, and I intended to attach a couple of small patches to `sage-env` here for independent issues, so that they should all apply in almost random order, with just line numbers changing.

We can then leave out individual patches here in case other tickets already fix things.

---

I'll hopefully return to #11021 today and [try to] finish it, though I originally planned other things... ;-)



---

archive/issue_comments_120942.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@nexttime](#comment:6):\n> Replying to [@jhpalmieri](#comment:4):\n> > Since there is already a lot of progress on #11021, can we finish that one off and have this ticket depend on that one?\n\n> \n> Currently sorting out what to fix where and in which order.\n\nI think I'll also add `pkg-config`-related code *there* (to `sage-spkg`, right before `sage-make_relative` is called).",
    "created_at": "2011-08-14T17:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120942",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@nexttime](#comment:6):
> Replying to [@jhpalmieri](#comment:4):
> > Since there is already a lot of progress on #11021, can we finish that one off and have this ticket depend on that one?

> 
> Currently sorting out what to fix where and in which order.

I think I'll also add `pkg-config`-related code *there* (to `sage-spkg`, right before `sage-make_relative` is called).



---

archive/issue_comments_120943.json:
```json
{
    "body": "Replying to [ticket:11687 leif]:\n> * `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).\n\n#11765 adds a note on the necessity to always *export* variables in `sage-env`.\n\n\n\n\n> * `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202).\n\nThis is now fixed by a small patch at #11765, currently needing review.",
    "created_at": "2011-08-31T18:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120943",
    "user": "https://github.com/nexttime"
}
```

Replying to [ticket:11687 leif]:
> * `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).

#11765 adds a note on the necessity to always *export* variables in `sage-env`.




> * `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202).

This is now fixed by a small patch at #11765, currently needing review.



---

archive/issue_comments_120944.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n There are currently a couple of issues with `sage-env`; approximately ordered by importance:\n \n * `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).\n-* `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202).\n+* `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202). \n+ **#11765 addresses this issue.**\n * The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n * The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `\"$1\" = \"-short\"`:\n \n``````\n",
    "created_at": "2011-08-31T18:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120944",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,8 @@
 There are currently a couple of issues with `sage-env`; approximately ordered by importance:
 
 * `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).
-* `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202).
+* `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202). 
+ **#11765 addresses this issue.**
 * The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
 * The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `"$1" = "-short"`:
 
``````




---

archive/issue_comments_120945.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,5 @@\n There are currently a couple of issues with `sage-env`; approximately ordered by importance:\n \n-* `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).\n-* `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202). \n- **#11765 addresses this issue.**\n * The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n * The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `\"$1\" = \"-short\"`:\n \n@@ -42,9 +39,7 @@\n     return 1\n fi\n ```\n-* `sage-env` has a bug w.r.t. \"guessing\" the value `SAGE_ROOT` should be set to, which leads to annoying or confusing warnings \"`Attempted to overwrite SAGE_ROOT ...`\", see [comment:ticket:11021:24 this comment] at #11021; thanks to John Palmieri for tracking this down.\n * The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.\n-* We could also source `~/.sagerc` (or `$DOT_SAGE/[.]sagerc`), if one of it exists, at some point in `sage-env`, to allow setting up typical variables (like e.g. `SAGE64`, perhaps depending on `hostname`, and other Sage-specific variables) automatically in a flexible and generic way.\n \n (Line numbers as of Sage 4.7.1.rc2.)\n \n``````\n",
    "created_at": "2012-03-22T10:41:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120945",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,5 @@
 There are currently a couple of issues with `sage-env`; approximately ordered by importance:
 
-* `BUILD` (used by `sage-spkg`) isn't exported, which wasn't really a problem until we started to (fully) source `sage-env` only once (#10469, cf. #11021 and #4949 for the impact on `sage-spkg`).
-* `PKG_CONFIG_PATH` is only changed if it is empty / undefined. We have to *prepend* `$SAGE_ROOT/local/lib/pkgconfig` in case it is not. (Cf. #11681, #11686; #10202). 
- **#11765 addresses this issue.**
 * The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
 * The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `"$1" = "-short"`:
 
@@ -42,9 +39,7 @@
     return 1
 fi
 ```
-* `sage-env` has a bug w.r.t. "guessing" the value `SAGE_ROOT` should be set to, which leads to annoying or confusing warnings "`Attempted to overwrite SAGE_ROOT ...`", see [comment:ticket:11021:24 this comment] at #11021; thanks to John Palmieri for tracking this down.
 * The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.
-* We could also source `~/.sagerc` (or `$DOT_SAGE/[.]sagerc`), if one of it exists, at some point in `sage-env`, to allow setting up typical variables (like e.g. `SAGE64`, perhaps depending on `hostname`, and other Sage-specific variables) automatically in a flexible and generic way.
 
 (Line numbers as of Sage 4.7.1.rc2.)
 
``````




---

archive/issue_comments_120946.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nRemoved some points which is no longer relevant.",
    "created_at": "2012-03-22T10:41:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120946",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Removed some points which is no longer relevant.



---

archive/issue_comments_120947.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jdemeyer](#comment:9):\n> Removed some points which is no longer relevant.\n\nI guess you meant \"are\". ;-)\n\nProgress!  (Although I'd just add \"Fixed by #.....\", so one immediately sees where something got fixed and whether the corresponding ticket is already merged, e.g. if a problem reappears.)",
    "created_at": "2012-03-22T11:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120947",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jdemeyer](#comment:9):
> Removed some points which is no longer relevant.

I guess you meant "are". ;-)

Progress!  (Although I'd just add "Fixed by #.....", so one immediately sees where something got fixed and whether the corresponding ticket is already merged, e.g. if a problem reappears.)



---

archive/issue_events_156830.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-08T14:21:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156830"
}
```



---

archive/issue_events_156831.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-08T14:21:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156831"
}
```



---

archive/issue_events_156832.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156832"
}
```



---

archive/issue_events_156833.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156833"
}
```



---

archive/issue_comments_120948.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,17 +1,7 @@\n There are currently a couple of issues with `sage-env`; approximately ordered by importance:\n \n-* The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n-* The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `\"$1\" = \"-short\"`:\n-\n-```sh\n-if [ \"$UNAME\" = \"CYGWIN\" ]; then\n-    PATH=\"$PATH:$SAGE_LOCAL/lib\" && export PATH\n-fi\n-```\n-   Moreover, I think the directory should be **pre**pendend to the path, but perhaps in a way that it is still preceded by `$SAGE_ROOT/local/bin`.\n-* `SAGE_PATH` (followed by a colon) is prepended to `PYTHONPATH` even if it is empty / undefined. Some programs interpret this as if the current working directory (\"`.`\") was prepended. \n-\n-  It also shouldn't be set to (or contain) \"`.`\", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).\n+* The definition of `UNAME` (currently on line 458) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n+* `SAGE_PATH` (followed by a colon) shouldn't be set to (or contain) \"`.`\", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).\n * We should save the original, unmodified `PATH` (to `SAGE_ORIG_PATH`), analoguous to `SAGE_ORIG_LD_LIBRARY_PATH` etc., and perhaps record this in `SAGE_ORIG_PATH_SET`. This should also be done close to the top, of course before modifying `PATH`. (#10202 also suggests / introduces this.)\n * There's partially useless code like\n \n@@ -27,21 +17,8 @@\n   The result of such broken compiled Cython code shows up as weird import errors when starting Sage, which a user will hardly relate to a probably empty environment variable.\n * *All* variables that are expected to be either \"`yes`\", \"`no`\" or empty / unset should be checked for [in]valid settings, and perhaps normalized (i.e., for example set to \"`no`\" in case they're empty or not set). \n \n-  We currently only do this for `SAGE64`:\n-\n-```sh\n-if [ \"$SAGE64\" = \"\" ]; then\n-    SAGE64=\"no\"\n-fi \n-\n-if [ \"$SAGE64\" != \"yes\" -a \"$SAGE64\" != \"no\" ]; then\n-    echo \"The environment variable SAGE64 (=$SAGE64) must be either unset, yes or no.\"\n-    return 1\n-fi\n-```\n+  We currently only do this for `SAGE64`\n * The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.\n-\n-(Line numbers as of Sage 4.7.1.rc2.)\n \n ---\n \n``````\n",
    "created_at": "2014-01-09T09:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120948",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,17 +1,7 @@
 There are currently a couple of issues with `sage-env`; approximately ordered by importance:
 
-* The definition of `UNAME` (currently on line 284) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
-* The following (starting on line 348) has also to be moved up, since we return from `sage-env` earlier above (line 238) in case `"$1" = "-short"`:
-
-```sh
-if [ "$UNAME" = "CYGWIN" ]; then
-    PATH="$PATH:$SAGE_LOCAL/lib" && export PATH
-fi
-```
-   Moreover, I think the directory should be **pre**pendend to the path, but perhaps in a way that it is still preceded by `$SAGE_ROOT/local/bin`.
-* `SAGE_PATH` (followed by a colon) is prepended to `PYTHONPATH` even if it is empty / undefined. Some programs interpret this as if the current working directory ("`.`") was prepended. 
-
-  It also shouldn't be set to (or contain) "`.`", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).
+* The definition of `UNAME` (currently on line 458) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
+* `SAGE_PATH` (followed by a colon) shouldn't be set to (or contain) "`.`", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).
 * We should save the original, unmodified `PATH` (to `SAGE_ORIG_PATH`), analoguous to `SAGE_ORIG_LD_LIBRARY_PATH` etc., and perhaps record this in `SAGE_ORIG_PATH_SET`. This should also be done close to the top, of course before modifying `PATH`. (#10202 also suggests / introduces this.)
 * There's partially useless code like
 
@@ -27,21 +17,8 @@
   The result of such broken compiled Cython code shows up as weird import errors when starting Sage, which a user will hardly relate to a probably empty environment variable.
 * *All* variables that are expected to be either "`yes`", "`no`" or empty / unset should be checked for [in]valid settings, and perhaps normalized (i.e., for example set to "`no`" in case they're empty or not set). 
 
-  We currently only do this for `SAGE64`:
-
-```sh
-if [ "$SAGE64" = "" ]; then
-    SAGE64="no"
-fi 
-
-if [ "$SAGE64" != "yes" -a "$SAGE64" != "no" ]; then
-    echo "The environment variable SAGE64 (=$SAGE64) must be either unset, yes or no."
-    return 1
-fi
-```
+  We currently only do this for `SAGE64`
 * The *default* for `CFLAG64` (`-m64`) and similar should be set in `sage-env`, not each and every `spkg-install`.
-
-(Line numbers as of Sage 4.7.1.rc2.)
 
 ---
 
``````




---

archive/issue_comments_120949.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n There are currently a couple of issues with `sage-env`; approximately ordered by importance:\n \n * The definition of `UNAME` (currently on line 458) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.\n-* `SAGE_PATH` (followed by a colon) shouldn't be set to (or contain) \"`.`\", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).\n * We should save the original, unmodified `PATH` (to `SAGE_ORIG_PATH`), analoguous to `SAGE_ORIG_LD_LIBRARY_PATH` etc., and perhaps record this in `SAGE_ORIG_PATH_SET`. This should also be done close to the top, of course before modifying `PATH`. (#10202 also suggests / introduces this.)\n * There's partially useless code like\n \n``````\n",
    "created_at": "2014-01-09T09:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120949",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
 There are currently a couple of issues with `sage-env`; approximately ordered by importance:
 
 * The definition of `UNAME` (currently on line 458) has to be moved up, preferably right before `PATH` etc. get set / modified (currently around line 135), and `$UNAME` should be used consistently.
-* `SAGE_PATH` (followed by a colon) shouldn't be set to (or contain) "`.`", since this causes trouble with `easy_install` / distutils / `.pth` files. (Cf. #10192, #10176; the former has a patch to remove it [at least] in `spkg-install`, which isn't necessarily sufficient.).
 * We should save the original, unmodified `PATH` (to `SAGE_ORIG_PATH`), analoguous to `SAGE_ORIG_LD_LIBRARY_PATH` etc., and perhaps record this in `SAGE_ORIG_PATH_SET`. This should also be done close to the top, of course before modifying `PATH`. (#10202 also suggests / introduces this.)
 * There's partially useless code like
 
``````




---

archive/issue_comments_120950.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,11 +9,6 @@\n     LDFLAGS=\"\"          && export LDFLAGS\n fi\n ```\n-* If `CFLAGS` (as specified by the user) are non-empty, we could append `-fno-strict-aliasing`, since Cython code will break if `CFLAGS` are set but don't contain this, but this should better be done where Cython code is compiled, i.e. in `devel/sage/setup.py` and `sage.misc.cython`. \n-\n-  Note that even `export CFLAGS=\"\"` causes distutils to drop the defaults, which do contain `-fno-strict-aliasing` (which could be solved by `unset`ting `CFLAGS` if they are empty). \n-\n-  The result of such broken compiled Cython code shows up as weird import errors when starting Sage, which a user will hardly relate to a probably empty environment variable.\n * *All* variables that are expected to be either \"`yes`\", \"`no`\" or empty / unset should be checked for [in]valid settings, and perhaps normalized (i.e., for example set to \"`no`\" in case they're empty or not set). \n \n   We currently only do this for `SAGE64`\n``````\n",
    "created_at": "2014-01-09T09:56:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120950",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,11 +9,6 @@
     LDFLAGS=""          && export LDFLAGS
 fi
 ```
-* If `CFLAGS` (as specified by the user) are non-empty, we could append `-fno-strict-aliasing`, since Cython code will break if `CFLAGS` are set but don't contain this, but this should better be done where Cython code is compiled, i.e. in `devel/sage/setup.py` and `sage.misc.cython`. 
-
-  Note that even `export CFLAGS=""` causes distutils to drop the defaults, which do contain `-fno-strict-aliasing` (which could be solved by `unset`ting `CFLAGS` if they are empty). 
-
-  The result of such broken compiled Cython code shows up as weird import errors when starting Sage, which a user will hardly relate to a probably empty environment variable.
 * *All* variables that are expected to be either "`yes`", "`no`" or empty / unset should be checked for [in]valid settings, and perhaps normalized (i.e., for example set to "`no`" in case they're empty or not set). 
 
   We currently only do this for `SAGE64`
``````




---

archive/issue_comments_120951.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nSee #15652 for the `-fno-strict-aliasing` issue.",
    "created_at": "2014-01-09T10:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120951",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

See #15652 for the `-fno-strict-aliasing` issue.



---

archive/issue_events_156834.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156834"
}
```



---

archive/issue_events_156835.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156835"
}
```



---

archive/issue_events_156836.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156836"
}
```



---

archive/issue_events_156837.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156837"
}
```



---

archive/issue_events_156838.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156838"
}
```



---

archive/issue_events_156839.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156839"
}
```



---

archive/issue_comments_120952.json:
```json
{
    "body": "Branch: **[u/chapoton/11687](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/11687)**",
    "created_at": "2014-10-21T12:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120952",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/11687](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/11687)**



---

archive/issue_comments_120953.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHere is a first proposal, gathering the UNAME setting in one single place.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dd3b0eb2fb9d5a70b319389d01e8506387d3381\">2dd3b0e</a></td><td><code>trac #11687 proposal</code></td></tr></table>\n",
    "created_at": "2014-10-21T12:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120953",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

Here is a first proposal, gathering the UNAME setting in one single place.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dd3b0eb2fb9d5a70b319389d01e8506387d3381">2dd3b0e</a></td><td><code>trac #11687 proposal</code></td></tr></table>




---

archive/issue_comments_120954.json:
```json
{
    "body": "Commit: **[`2dd3b0e`](https://github.com/sagemath/sagetrac-mirror/commit/2dd3b0eb2fb9d5a70b319389d01e8506387d3381)**",
    "created_at": "2014-10-21T12:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120954",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`2dd3b0e`](https://github.com/sagemath/sagetrac-mirror/commit/2dd3b0eb2fb9d5a70b319389d01e8506387d3381)**



---

archive/issue_events_156840.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2014-10-21T12:57:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156840"
}
```



---

archive/issue_comments_120955.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7f27ebe7d0648c1df1f6c6bc059d80f95b0b5c5\">f7f27eb</a></td><td><code>trac #11687 typo</code></td></tr></table>\n",
    "created_at": "2014-10-21T12:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120955",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7f27ebe7d0648c1df1f6c6bc059d80f95b0b5c5">f7f27eb</a></td><td><code>trac #11687 typo</code></td></tr></table>




---

archive/issue_comments_120956.json:
```json
{
    "body": "Changed commit from **[`2dd3b0e`](https://github.com/sagemath/sagetrac-mirror/commit/2dd3b0eb2fb9d5a70b319389d01e8506387d3381)** to **[`f7f27eb`](https://github.com/sagemath/sagetrac-mirror/commit/f7f27ebe7d0648c1df1f6c6bc059d80f95b0b5c5)**",
    "created_at": "2014-10-21T12:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120956",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2dd3b0e`](https://github.com/sagemath/sagetrac-mirror/commit/2dd3b0eb2fb9d5a70b319389d01e8506387d3381)** to **[`f7f27eb`](https://github.com/sagemath/sagetrac-mirror/commit/f7f27ebe7d0648c1df1f6c6bc059d80f95b0b5c5)**



---

archive/issue_comments_120957.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565\">1286497</a></td><td><code>Merge branch 'u/chapoton/11687' into 6.5.b2</code></td></tr></table>\n",
    "created_at": "2014-12-09T20:52:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120957",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565">1286497</a></td><td><code>Merge branch 'u/chapoton/11687' into 6.5.b2</code></td></tr></table>




---

archive/issue_comments_120958.json:
```json
{
    "body": "Changed commit from **[`f7f27eb`](https://github.com/sagemath/sagetrac-mirror/commit/f7f27ebe7d0648c1df1f6c6bc059d80f95b0b5c5)** to **[`1286497`](https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565)**",
    "created_at": "2014-12-09T20:52:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120958",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f7f27eb`](https://github.com/sagemath/sagetrac-mirror/commit/f7f27ebe7d0648c1df1f6c6bc059d80f95b0b5c5)** to **[`1286497`](https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565)**



---

archive/issue_events_156841.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-06-17T13:58:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156841"
}
```



---

archive/issue_events_156842.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-06-17T13:58:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156842"
}
```



---

archive/issue_events_156843.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-17T14:42:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156843"
}
```



---

archive/issue_events_156844.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-17T14:42:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156844"
}
```



---

archive/issue_comments_120959.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2015-06-17T14:42:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120959",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_120960.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2015-06-17T14:42:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120960",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_156845.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-18T17:57:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156845"
}
```



---

archive/issue_events_156846.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "828cb332dd7ac6fdf3f1237c8cd07050a780b456",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-18T17:57:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11687#event-156846"
}
```



---

archive/issue_comments_120961.json:
```json
{
    "body": "Changed branch from **[u/chapoton/11687](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/11687)** to **[`1286497`](https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565)**",
    "created_at": "2015-06-18T17:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11687#issuecomment-120961",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/11687](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/11687)** to **[`1286497`](https://github.com/sagemath/sagetrac-mirror/commit/12864975d421ecbe63a536725478eadb53fb7565)**
