# Issue 11639: conductor of simple curve over Q(cube root 3) takes forever

archive/issues_011467.json:
```json
{
    "body": "```\nsage: x=var('x'); K.<a> = NumberField(x^3 - 2); EllipticCurve([0,a]).conductor()\n[[ wait forever! ]]\n```\n\nThe correct answer has norm 322486272, and should be instant:\n\n```\nsage: magma(E).Conductor()\nIdeal\nBasis:\n[864   0   0]\n[  0 864   0]\n[  0   0 432]\nsage: magma(E).Conductor().Norm()\n322486272\n```\n\nTrying with `proof.all(False)` doesn't help, by the way, so I don't think it is just some complexity issue... and yet, I just tried control-c after letting \"E.conductor()\" sit there for a while, then typed \"%debug\", then \"u\", then saw that two ideals of the integers of the cubic field were being multiplied.  I printed the gens of one ideal and got\n\n```\nipdb> u\n> /Users/wstein/sage/install/current/local/lib/python2.6/site-packages/sage/rings/ideal.py(857)__mul__()\n    856             other = self.ring().ideal(other)\n--> 857         return self.ring().ideal([x*y for x in self.gens() for y in other.gens()])\n    858 \n\nipdb> print self.gens()\n(16384, 8192*a, 8192*a, 4096*a^2, 8192*a, 4096*a^2,  ... goes on redundantly for many pages!)\n```\n\nFixed by #13958.\n\nAssignee: @JohnCremona\n\nReviewer: Jeroen Demeyer\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/11639\n\n",
    "closed_at": "2013-05-08T09:46:28Z",
    "created_at": "2011-08-01T23:44:45Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "conductor of simple curve over Q(cube root 3) takes forever",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11639",
    "user": "https://github.com/williamstein"
}
```
```
sage: x=var('x'); K.<a> = NumberField(x^3 - 2); EllipticCurve([0,a]).conductor()
[[ wait forever! ]]
```

The correct answer has norm 322486272, and should be instant:

```
sage: magma(E).Conductor()
Ideal
Basis:
[864   0   0]
[  0 864   0]
[  0   0 432]
sage: magma(E).Conductor().Norm()
322486272
```

Trying with `proof.all(False)` doesn't help, by the way, so I don't think it is just some complexity issue... and yet, I just tried control-c after letting "E.conductor()" sit there for a while, then typed "%debug", then "u", then saw that two ideals of the integers of the cubic field were being multiplied.  I printed the gens of one ideal and got

```
ipdb> u
> /Users/wstein/sage/install/current/local/lib/python2.6/site-packages/sage/rings/ideal.py(857)__mul__()
    856             other = self.ring().ideal(other)
--> 857         return self.ring().ideal([x*y for x in self.gens() for y in other.gens()])
    858 

ipdb> print self.gens()
(16384, 8192*a, 8192*a, 4096*a^2, 8192*a, 4096*a^2,  ... goes on redundantly for many pages!)
```

Fixed by #13958.

Assignee: @JohnCremona

Reviewer: Jeroen Demeyer

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/11639





---

archive/issue_comments_135052.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n-{{\n+```\n sage: x=var('x'); K.<a> = NumberField(x^3 - 2); EllipticCurve([0,a]).conductor()\n-[This is the Trac macro *wait forever! * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#wait forever! -macro)\n-}}}\n+[[ wait forever! ]]\n+```\n \n The correct answer has norm 322486272, and should be instant:\n \n``````\n",
    "created_at": "2011-08-01T23:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135052",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
-{{
+```
 sage: x=var('x'); K.<a> = NumberField(x^3 - 2); EllipticCurve([0,a]).conductor()
-[This is the Trac macro *wait forever! * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#wait forever! -macro)
-}}}
+[[ wait forever! ]]
+```
 
 The correct answer has norm 322486272, and should be instant:
 
``````




---

archive/issue_comments_135053.json:
```json
{
    "body": "<a id='comment:2'></a>This is the heart of the problem\n\n```\nsage: K.<a> = NumberField(x^3 - 2); E = EllipticCurve([0, a])\nsage: P, Q = K.prime_factors(E.discriminant())\nsage: P, P.gens()\n(Fractional ideal (a), (2, a))\nsage: P2 = P*P; P2, P2.gens()\n(Fractional ideal (a^2), (4, 2*a, 2*a, a^2))\n```\nThe conductor is computed as `P<sup>14*Q</sup>9`, which is defined by 2<sup>23</sup> (highly redundant) generators. Multiplication of ideals avoids reducing the generators, which can be time-consuming (though not in this case), but it could at least eliminate repeats.^^",
    "created_at": "2011-08-03T07:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135053",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

<a id='comment:2'></a>This is the heart of the problem

```
sage: K.<a> = NumberField(x^3 - 2); E = EllipticCurve([0, a])
sage: P, Q = K.prime_factors(E.discriminant())
sage: P, P.gens()
(Fractional ideal (a), (2, a))
sage: P2 = P*P; P2, P2.gens()
(Fractional ideal (a^2), (4, 2*a, 2*a, a^2))
```
The conductor is computed as `P<sup>14*Q</sup>9`, which is defined by 2<sup>23</sup> (highly redundant) generators. Multiplication of ideals avoids reducing the generators, which can be time-consuming (though not in this case), but it could at least eliminate repeats.^^



---

archive/issue_comments_135054.json:
```json
{
    "body": "<a id='comment:3'></a>How hard would it be to eliminate repeated gens after any ideal multiplication?  And would that make this particular example run in reasonable time?\n\nNote that in a Dedekind domain if I = (a,b) then I^n = (a<sup>n,b</sup>n) [exercise!] which is surely a special case worth catching!\n\nOtherwise I suppose we could have an option to return the conductor  in factored form.  When I compute conductors over number fields I almost always factor it right away (which is a bit silly when that poor ideal has only just been multiplied together), and take its norm and factor that;  rarely would I want to see the conductor as an ideal unless it were principal.",
    "created_at": "2011-08-03T08:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135054",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>How hard would it be to eliminate repeated gens after any ideal multiplication?  And would that make this particular example run in reasonable time?

Note that in a Dedekind domain if I = (a,b) then I^n = (a<sup>n,b</sup>n) [exercise!] which is surely a special case worth catching!

Otherwise I suppose we could have an option to return the conductor  in factored form.  When I compute conductors over number fields I almost always factor it right away (which is a bit silly when that poor ideal has only just been multiplied together), and take its norm and factor that;  rarely would I want to see the conductor as an ideal unless it were principal.



---

archive/issue_comments_135055.json:
```json
{
    "body": "<a id='comment:4'></a>> \n> Note that in a Dedekind domain if I = (a,b) then I^n = (a<sup>n,b</sup>n) [exercise!] which is surely a special case worth catching!\n\n\nThat should read: if `I = (a,b)` then `I^n = (a<sup>n,b</sup>n)`",
    "created_at": "2011-08-03T08:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135055",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>> 
> Note that in a Dedekind domain if I = (a,b) then I^n = (a<sup>n,b</sup>n) [exercise!] which is surely a special case worth catching!


That should read: if `I = (a,b)` then `I^n = (a<sup>n,b</sup>n)`



---

archive/issue_comments_135056.json:
```json
{
    "body": "<a id='comment:5'></a>This works now:\n\n```\nsage: K.<a> = NumberField(x^3 - 2)\nsage: %time EllipticCurve([0,a]).conductor().norm()\nCPU times: user 0.14 s, sys: 0.01 s, total: 0.15 s\nWall time: 0.14 s\n322486272\n```",
    "created_at": "2013-05-06T12:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135056",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>This works now:

```
sage: K.<a> = NumberField(x^3 - 2)
sage: %time EllipticCurve([0,a]).conductor().norm()
CPU times: user 0.14 s, sys: 0.01 s, total: 0.15 s
Wall time: 0.14 s
322486272
```



---

archive/issue_events_030537.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-06T12:43:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11639#event-30537"
}
```



---

archive/issue_comments_135057.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-05-06T12:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135057",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_135058.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-05-06T12:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135058",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_135059.json:
```json
{
    "body": "<a id='comment:7'></a>As there is no patch here, do we know what changed to make this work ok now?",
    "created_at": "2013-05-06T12:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135059",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>As there is no patch here, do we know what changed to make this work ok now?



---

archive/issue_comments_135060.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 cremona]:\n> As there is no patch here, do we know what changed to make this work ok now?\n\nI know the multiplication of number field ideals got improved, which was essentially the problem this ticket is about.",
    "created_at": "2013-05-06T12:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135060",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [comment:7 cremona]:
> As there is no patch here, do we know what changed to make this work ok now?

I know the multiplication of number field ideals got improved, which was essentially the problem this ticket is about.



---

archive/issue_comments_135061.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 jdemeyer]:\n> Replying to [comment:7 cremona]:\n> > As there is no patch here, do we know what changed to make this work ok now?\n\n> I know the multiplication of number field ideals got improved, which was essentially the problem this ticket is about.\n\nOK, fine.  We could add a doctest referencing this ticket.  Is that worth while?",
    "created_at": "2013-05-06T13:11:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135061",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:9'></a>Replying to [comment:8 jdemeyer]:
> Replying to [comment:7 cremona]:
> > As there is no patch here, do we know what changed to make this work ok now?

> I know the multiplication of number field ideals got improved, which was essentially the problem this ticket is about.

OK, fine.  We could add a doctest referencing this ticket.  Is that worth while?



---

archive/issue_comments_135062.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 cremona]:\n> We could add a doctest referencing this ticket.  Is that worth while?\n\nNot really, since the actual issue is fixed and doctested in #13958.",
    "created_at": "2013-05-06T13:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135062",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [comment:9 cremona]:
> We could add a doctest referencing this ticket.  Is that worth while?

Not really, since the actual issue is fixed and doctested in #13958.



---

archive/issue_comments_135063.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 jdemeyer]:\n> Replying to [comment:9 cremona]:\n> > We could add a doctest referencing this ticket.  Is that worth while?\n\n> Not really, since the actual issue is fixed and doctested in #13958.\n\nThen I am happy, especially since this cross-reference is now on this ticket!",
    "created_at": "2013-05-06T14:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135063",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:11'></a>Replying to [comment:10 jdemeyer]:
> Replying to [comment:9 cremona]:
> > We could add a doctest referencing this ticket.  Is that worth while?

> Not really, since the actual issue is fixed and doctested in #13958.

Then I am happy, especially since this cross-reference is now on this ticket!



---

archive/issue_comments_135064.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2013-05-08T09:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135064",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_events_030538.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-08T09:46:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11639#event-30538"
}
```



---

archive/issue_comments_135065.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,35 @@\n+```\n+sage: x=var('x'); K.<a> = NumberField(x^3 - 2); EllipticCurve([0,a]).conductor()\n+[[ wait forever! ]]\n+```\n \n+The correct answer has norm 322486272, and should be instant:\n+\n+```\n+sage: magma(E).Conductor()\n+Ideal\n+Basis:\n+[864   0   0]\n+[  0 864   0]\n+[  0   0 432]\n+sage: magma(E).Conductor().Norm()\n+322486272\n+```\n+\n+Trying with `proof.all(False)` doesn't help, by the way, so I don't think it is just some complexity issue... and yet, I just tried control-c after letting \"E.conductor()\" sit there for a while, then typed \"%debug\", then \"u\", then saw that two ideals of the integers of the cubic field were being multiplied.  I printed the gens of one ideal and got\n+\n+```\n+ipdb> u\n+> /Users/wstein/sage/install/current/local/lib/python2.6/site-packages/sage/rings/ideal.py(857)__mul__()\n+    856             other = self.ring().ideal(other)\n+--> 857         return self.ring().ideal([x*y for x in self.gens() for y in other.gens()])\n+    858 \n+\n+ipdb> print self.gens()\n+(16384, 8192*a, 8192*a, 4096*a^2, 8192*a, 4096*a^2,  ... goes on redundantly for many pages!)\n+```\n+\n+Fixed by #13958.\n \n Comment: 1\n \n``````\n",
    "created_at": "2013-05-08T09:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11639#issuecomment-135065",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,35 @@
+```
+sage: x=var('x'); K.<a> = NumberField(x^3 - 2); EllipticCurve([0,a]).conductor()
+[[ wait forever! ]]
+```
 
+The correct answer has norm 322486272, and should be instant:
+
+```
+sage: magma(E).Conductor()
+Ideal
+Basis:
+[864   0   0]
+[  0 864   0]
+[  0   0 432]
+sage: magma(E).Conductor().Norm()
+322486272
+```
+
+Trying with `proof.all(False)` doesn't help, by the way, so I don't think it is just some complexity issue... and yet, I just tried control-c after letting "E.conductor()" sit there for a while, then typed "%debug", then "u", then saw that two ideals of the integers of the cubic field were being multiplied.  I printed the gens of one ideal and got
+
+```
+ipdb> u
+> /Users/wstein/sage/install/current/local/lib/python2.6/site-packages/sage/rings/ideal.py(857)__mul__()
+    856             other = self.ring().ideal(other)
+--> 857         return self.ring().ideal([x*y for x in self.gens() for y in other.gens()])
+    858 
+
+ipdb> print self.gens()
+(16384, 8192*a, 8192*a, 4096*a^2, 8192*a, 4096*a^2,  ... goes on redundantly for many pages!)
+```
+
+Fixed by #13958.
 
 Comment: 1
 
``````

