# Issue 11970: r-2.10.1.p4 may fail to configure with readline (BLOCKS Sage from building on Ubuntu 11.10)

archive/issues_011798.json:
```json
{
    "assignees": [],
    "body": "I was having a hard time compiling sage on my ARM box : the R spkg, which until then hadn't given any issue, didn't even want to configure.\n\nThe reason was that if ncurses is detected, then termcap isn't searched for, and hence detecting rl_callback_read_char fails (missing -ltermacp means missing symbols) ; which means the configuration failed because --with-readline was given on the commandline, and it wasn't correctly detected.\n\nI got around it by uninstalling the libncurses5-dev package from my system.\n\nLooking at the configure.ac, I think the issue isn't ARM-specific ; perhaps that should be pushed upstream.\n\n---\n\nNew spkg:\n\n- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg)\n\n\nDepends on #12282\n\nCC:  @zimmermann6\n\nKeywords: **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project sd35.5**\n\nAuthor: **Leif Leonhardy**\n\nReviewer: **Jeroen Demeyer**\n\nMerged: **sage-4.8.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11970_\n\n",
    "closed_at": "2012-01-15T15:40:58Z",
    "created_at": "2011-10-31T14:48:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "r-2.10.1.p4 may fail to configure with readline (BLOCKS Sage from building on Ubuntu 11.10)",
    "type": "issue",
    "updated_at": "2012-01-15T15:40:58Z",
    "url": "https://github.com/sagemath/sage/issues/11970",
    "user": "https://github.com/SnarkBoojum"
}
```
I was having a hard time compiling sage on my ARM box : the R spkg, which until then hadn't given any issue, didn't even want to configure.

The reason was that if ncurses is detected, then termcap isn't searched for, and hence detecting rl_callback_read_char fails (missing -ltermacp means missing symbols) ; which means the configuration failed because --with-readline was given on the commandline, and it wasn't correctly detected.

I got around it by uninstalling the libncurses5-dev package from my system.

Looking at the configure.ac, I think the issue isn't ARM-specific ; perhaps that should be pushed upstream.

---

New spkg:

- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg)


Depends on #12282

CC:  @zimmermann6

Keywords: **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project sd35.5**

Author: **Leif Leonhardy**

Reviewer: **Jeroen Demeyer**

Merged: **sage-4.8.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/11970_





---

archive/issue_events_147899.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2011-10-31T14:48:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147899"
}
```



---

archive/issue_events_147900.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2011-10-31T14:48:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147900"
}
```



---

archive/issue_events_147901.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2011-10-31T14:48:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147901"
}
```



---

archive/issue_events_147902.json:
```json
{
    "actor": "https://github.com/SnarkBoojum",
    "created_at": "2011-10-31T14:48:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147902"
}
```



---

archive/issue_comments_129155.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nThe problem isn't really R itself, but our readline spkg.  (Cf. discussions on sage-release where this `configure` error was reported for Ubuntu 11.10 systems that have libreadline-dev installed.)\n\nHere's a preliminary new readline spkg:\n\n [http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p2.spkg](http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p2.spkg)",
    "created_at": "2011-10-31T16:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129155",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:1" align="right">Comment 1</div>

The problem isn't really R itself, but our readline spkg.  (Cf. discussions on sage-release where this `configure` error was reported for Ubuntu 11.10 systems that have libreadline-dev installed.)

Here's a preliminary new readline spkg:

 [http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p2.spkg](http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p2.spkg)



---

archive/issue_comments_129156.json:
```json
{
    "body": "Changed keywords from none to **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo**",
    "created_at": "2011-10-31T16:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129156",
    "user": "https://github.com/nexttime"
}
```

Changed keywords from none to **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo**



---

archive/issue_events_147903.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-10-31T16:19:39Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "title_is": "r-2.10.1.p4 may fail to configure with readline",
    "title_was": "r-2.10.1.p4 doesn't configure is ncurse is found",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147903"
}
```



---

archive/issue_comments_129157.json:
```json
{
    "body": "Removed assignee **@sagetrac-GeorgSWeber**",
    "created_at": "2011-10-31T16:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129157",
    "user": "https://github.com/nexttime"
}
```

Removed assignee **@sagetrac-GeorgSWeber**



---

archive/issue_events_147904.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-10-31T16:19:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147904"
}
```



---

archive/issue_events_147905.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-10-31T16:19:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147905"
}
```



---

archive/issue_comments_129158.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nP.S.: You should give more details about your configuration.\n\nOn many systems, `libtermcap.so` is (or used to be) just a symbolic link to `libncurses.so`.  On Oneiric, with `libreadline-dev` installed, `libncurses.so` is a *linker script*, which causes problems.",
    "created_at": "2011-10-31T16:29:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129158",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:3" align="right">Comment 3</div>

P.S.: You should give more details about your configuration.

On many systems, `libtermcap.so` is (or used to be) just a symbolic link to `libncurses.so`.  On Oneiric, with `libreadline-dev` installed, `libncurses.so` is a *linker script*, which causes problems.



---

archive/issue_comments_129159.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nBtw., since Sage also ships a termcap package, we should perhaps also build a *shared* library of that as well, at least if the systems lacks one.\n\nOr, if the system *does* have a \"devel version\" of libtermcap (headers, static library and an \"unversioned\" `.so`), don't build / install Sage's at all.",
    "created_at": "2011-10-31T16:47:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129159",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:4" align="right">Comment 4</div>

Btw., since Sage also ships a termcap package, we should perhaps also build a *shared* library of that as well, at least if the systems lacks one.

Or, if the system *does* have a "devel version" of libtermcap (headers, static library and an "unversioned" `.so`), don't build / install Sage's at all.



---

archive/issue_comments_129160.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nAs discussed on irc, the readline package compiled, and I'm now managing to compile R with even with the previously problematic headers installed.",
    "created_at": "2011-11-01T10:55:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129160",
    "user": "https://github.com/SnarkBoojum"
}
```

<div id="comment:5" align="right">Comment 5</div>

As discussed on irc, the readline package compiled, and I'm now managing to compile R with even with the previously problematic headers installed.



---

archive/issue_comments_129161.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@SnarkBoojum](#comment%3A5):\n> As discussed on irc, the readline package compiled, and I'm now managing to compile R with even with the previously problematic headers installed.\n\nFine.  Michael Anselmi also reported on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/0f779465055c9162/d8cb1f55c1cad522#d8cb1f55c1cad522):\n\n```\nGood news!  To have sage-4.7.2.rc1 build properly on Ubuntu 11.10, all I\nhad to do was replace $SAGE_ROOT/spkg/standard/readline-6.1.pkg with\nreadline-6.2.p2.spkg (the spkg you provided) before running `make'.\n```\n(Although he did get an apparently unrelated doctest error, related to LaTeX.)\n\nI'll commit the changes, update the spkg (in-place) and update the ticket's description later.",
    "created_at": "2011-11-01T20:02:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129161",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@SnarkBoojum](#comment%3A5):
> As discussed on irc, the readline package compiled, and I'm now managing to compile R with even with the previously problematic headers installed.

Fine.  Michael Anselmi also reported on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/0f779465055c9162/d8cb1f55c1cad522#d8cb1f55c1cad522):

```
Good news!  To have sage-4.7.2.rc1 build properly on Ubuntu 11.10, all I
had to do was replace $SAGE_ROOT/spkg/standard/readline-6.1.pkg with
readline-6.2.p2.spkg (the spkg you provided) before running `make'.
```
(Although he did get an apparently unrelated doctest error, related to LaTeX.)

I'll commit the changes, update the spkg (in-place) and update the ticket's description later.



---

archive/issue_comments_129162.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129162",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_events_147906.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:14:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147906"
}
```



---

archive/issue_events_147907.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-11-20T01:21:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147907"
}
```



---

archive/issue_comments_129163.json:
```json
{
    "body": "Changed keywords from **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo** to **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project**",
    "created_at": "2011-11-20T01:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129163",
    "user": "https://github.com/kcrisman"
}
```

Changed keywords from **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo** to **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project**



---

archive/issue_events_147908.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-14T03:26:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "title_is": "r-2.10.1.p4 may fail to configure with readline (BLOCKS Sage from building on Ubuntu 11.10)",
    "title_was": "r-2.10.1.p4 may fail to configure with readline",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147908"
}
```



---

archive/issue_comments_129164.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI just tried building the latest sage-4.8.alpha5 on the latest Ubuntu-11.10.  It includes an spkg called \"readline-6.2.p2\".  Nonetheless, the build failed with:\n\n```\n...\nchecking for history_truncate_file... no\nconfigure: error: --with-readline=yes (default) and headers/libs are not available\nError configuring R.\n************************************************************************\nError installing package r-2.14.0.p1\n************************************************************************\n```\n\nThis is a different readline-6.2.p2 than the one leif posted above.  Installing leif's package, I was then able to build R.\n\nI'm bumping the priority of this ticket up to BLOCKER, since we can't release Sage with it not even building on the current version of the most popular Linux distribution.",
    "created_at": "2011-12-14T03:26:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129164",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:9" align="right">Comment 9</div>

I just tried building the latest sage-4.8.alpha5 on the latest Ubuntu-11.10.  It includes an spkg called "readline-6.2.p2".  Nonetheless, the build failed with:

```
...
checking for history_truncate_file... no
configure: error: --with-readline=yes (default) and headers/libs are not available
Error configuring R.
************************************************************************
Error installing package r-2.14.0.p1
************************************************************************
```

This is a different readline-6.2.p2 than the one leif posted above.  Installing leif's package, I was then able to build R.

I'm bumping the priority of this ticket up to BLOCKER, since we can't release Sage with it not even building on the current version of the most popular Linux distribution.



---

archive/issue_events_147909.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-14T03:26:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147909"
}
```



---

archive/issue_events_147910.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-12-14T03:26:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147910"
}
```



---

archive/issue_comments_129165.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nI used Leif's spkg above with 4.8.alpha4, and although the build finished, Sage doesn't start; I get a segfault from IPython. I'm using Ubuntu 11.10. Is anyone else seeing this?",
    "created_at": "2011-12-14T05:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129165",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:10" align="right">Comment 10</div>

I used Leif's spkg above with 4.8.alpha4, and although the build finished, Sage doesn't start; I get a segfault from IPython. I'm using Ubuntu 11.10. Is anyone else seeing this?



---

archive/issue_comments_129166.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@dandrake](#comment%3A10):\n> I used Leif's spkg above with 4.8.alpha4, and although the build finished, Sage doesn't start; I get a segfault from IPython. I'm using Ubuntu 11.10. Is anyone else seeing this?\n\nDan, I saw exactly the same thing. I posted on sage-devel about this just now.   I was able to get around all problems and now have a seemingly functional version of Sage running on 11.10.",
    "created_at": "2011-12-14T07:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129166",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@dandrake](#comment%3A10):
> I used Leif's spkg above with 4.8.alpha4, and although the build finished, Sage doesn't start; I get a segfault from IPython. I'm using Ubuntu 11.10. Is anyone else seeing this?

Dan, I saw exactly the same thing. I posted on sage-devel about this just now.   I was able to get around all problems and now have a seemingly functional version of Sage running on 11.10.



---

archive/issue_comments_129167.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@williamstein](#comment%3A11):\n> Dan, I saw exactly the same thing. I posted on sage-devel about this just now.   I was able to get around all problems and now have a seemingly functional version of Sage running on 11.10. \n\nHmmm...in your message (https://groups.google.com/d/msg/sage-release/sXdDXME5Ds4/4CpiS04wT28J) you get a segfault from some matrix code. But I don't even get a traceback. This is what I get:\n\n```\ndrake@klee:/scratch/sage-4.8.alpha4$ ./sage\n----------------------------------------------------------------------\n| Sage Version 4.8.alpha4, Release Date: 2011-12-13                  |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nlocal/bin/sage-sage: line 305: 28355 Segmentation fault      sage-ipython \"$@\" -i\n```\n\nAlthough I see you used alpha5, and I'm using alpha4. That might be relevant, but maybe not.\n\nInterestingly, `sage -ipython` (note the space!) works fine. So my problem is somewhere in `sage-ipython` (note no space!); something with the library flags??",
    "created_at": "2011-12-14T10:48:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129167",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@williamstein](#comment%3A11):
> Dan, I saw exactly the same thing. I posted on sage-devel about this just now.   I was able to get around all problems and now have a seemingly functional version of Sage running on 11.10. 

Hmmm...in your message (https://groups.google.com/d/msg/sage-release/sXdDXME5Ds4/4CpiS04wT28J) you get a segfault from some matrix code. But I don't even get a traceback. This is what I get:

```
drake@klee:/scratch/sage-4.8.alpha4$ ./sage
----------------------------------------------------------------------
| Sage Version 4.8.alpha4, Release Date: 2011-12-13                  |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
local/bin/sage-sage: line 305: 28355 Segmentation fault      sage-ipython "$@" -i
```

Although I see you used alpha5, and I'm using alpha4. That might be relevant, but maybe not.

Interestingly, `sage -ipython` (note the space!) works fine. So my problem is somewhere in `sage-ipython` (note no space!); something with the library flags??



---

archive/issue_comments_129168.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nThe readline-6.2.p2 is from #12131, I think.\n\nLeif: Can you merge the one-line change from that readline into a .p3 and clean it up for review? Right now there are not-yet checked in changes...",
    "created_at": "2011-12-14T11:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129168",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">Comment 13</div>

The readline-6.2.p2 is from #12131, I think.

Leif: Can you merge the one-line change from that readline into a .p3 and clean it up for review? Right now there are not-yet checked in changes...



---

archive/issue_comments_129169.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@dandrake](#comment%3A12):\n> Replying to [@williamstein](#comment%3A11):\n> > Dan, I saw exactly the same thing. I posted on sage-devel about this just now.   I was able to get around all problems and now have a seemingly functional version of Sage running on 11.10. \n\n> \n> Hmmm...in your message (https://groups.google.com/d/msg/sage-release/sXdDXME5Ds4/4CpiS04wT28J) you get a segfault from some matrix code. But I don't even get a traceback. This is what I get:\n> \n> ```\n> drake@klee:/scratch/sage-4.8.alpha4$ ./sage\n> ----------------------------------------------------------------------\n> | Sage Version 4.8.alpha4, Release Date: 2011-12-13                  |\n> | Type notebook() for the GUI, and license() for information.        |\n> ----------------------------------------------------------------------\n> **********************************************************************\n> *                                                                    *\n> * Warning: this is a prerelease version, and it may be unstable.     *\n> *                                                                    *\n> **********************************************************************\n> local/bin/sage-sage: line 305: 28355 Segmentation fault      sage-ipython \"$@\" -i\n> ```\n> \n> Although I see you used alpha5, and I'm using alpha4. That might be relevant, but maybe not.\n> \n> Interestingly, `sage -ipython` (note the space!) works fine. So my problem is somewhere in `sage-ipython` (note no space!); something with the library flags??\n\nThat's the kind of output you get with the failure from matrix_modn_float if you don't start sage with \"-gdb\" see my own follow up in that thread. alpha3,4,5 is irrelevant here. And this is not related to R or readline but #4260.",
    "created_at": "2011-12-14T13:21:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129169",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@dandrake](#comment%3A12):
> Replying to [@williamstein](#comment%3A11):
> > Dan, I saw exactly the same thing. I posted on sage-devel about this just now.   I was able to get around all problems and now have a seemingly functional version of Sage running on 11.10. 

> 
> Hmmm...in your message (https://groups.google.com/d/msg/sage-release/sXdDXME5Ds4/4CpiS04wT28J) you get a segfault from some matrix code. But I don't even get a traceback. This is what I get:
> 
> ```
> drake@klee:/scratch/sage-4.8.alpha4$ ./sage
> ----------------------------------------------------------------------
> | Sage Version 4.8.alpha4, Release Date: 2011-12-13                  |
> | Type notebook() for the GUI, and license() for information.        |
> ----------------------------------------------------------------------
> **********************************************************************
> *                                                                    *
> * Warning: this is a prerelease version, and it may be unstable.     *
> *                                                                    *
> **********************************************************************
> local/bin/sage-sage: line 305: 28355 Segmentation fault      sage-ipython "$@" -i
> ```
> 
> Although I see you used alpha5, and I'm using alpha4. That might be relevant, but maybe not.
> 
> Interestingly, `sage -ipython` (note the space!) works fine. So my problem is somewhere in `sage-ipython` (note no space!); something with the library flags??

That's the kind of output you get with the failure from matrix_modn_float if you don't start sage with "-gdb" see my own follow up in that thread. alpha3,4,5 is irrelevant here. And this is not related to R or readline but #4260.



---

archive/issue_comments_129170.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@kiwifb](#comment%3A14):\n> That's the kind of output you get with the failure from matrix_modn_float if you don't start sage with \"-gdb\" see my own follow up in that thread. alpha3,4,5 is irrelevant here. And this is not related to R or readline but #4260. \n\nAh, you are right. And I can confirm that the patch you included (https://groups.google.com/d/msg/sage-release/sXdDXME5Ds4/pteQHfW2APYJ) allows 4.8.alpha4 to start and pass all doctests in sage/matrix on my Ubuntu 11.10 machine!",
    "created_at": "2011-12-15T03:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129170",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@kiwifb](#comment%3A14):
> That's the kind of output you get with the failure from matrix_modn_float if you don't start sage with "-gdb" see my own follow up in that thread. alpha3,4,5 is irrelevant here. And this is not related to R or readline but #4260. 

Ah, you are right. And I can confirm that the patch you included (https://groups.google.com/d/msg/sage-release/sXdDXME5Ds4/pteQHfW2APYJ) allows 4.8.alpha4 to start and pass all doctests in sage/matrix on my Ubuntu 11.10 machine!



---

archive/issue_comments_129171.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nThese issues with segfaults on startup are being addressed at #12157.",
    "created_at": "2011-12-16T02:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129171",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:16" align="right">Comment 16</div>

These issues with segfaults on startup are being addressed at #12157.



---

archive/issue_comments_129172.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\n**bump** Leif: Can you merge the one-line change from that readline into a .p3 (starting from #12131) and clean it up for review?",
    "created_at": "2011-12-21T09:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129172",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">Comment 17</div>

**bump** Leif: Can you merge the one-line change from that readline into a .p3 (starting from #12131) and clean it up for review?



---

archive/issue_comments_129173.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,10 @@\n I got around it by uninstalling the libncurses5-dev package from my system.\n \n Looking at the configure.ac, I think the issue isn't ARM-specific ; perhaps that should be pushed upstream.\n+\n+---\n+\n+New spkg:\n+\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg)\n+\n``````\n",
    "created_at": "2012-01-03T22:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129173",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,10 @@
 I got around it by uninstalling the libncurses5-dev package from my system.
 
 Looking at the configure.ac, I think the issue isn't ARM-specific ; perhaps that should be pushed upstream.
+
+---
+
+New spkg:
+
+- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p3.spkg)
+
``````




---

archive/issue_comments_129174.json:
```json
{
    "body": "Author: **Leif Leonhardy**",
    "created_at": "2012-01-03T22:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129174",
    "user": "https://github.com/jhpalmieri"
}
```

Author: **Leif Leonhardy**



---

archive/issue_events_147911.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-01-03T22:28:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147911"
}
```



---

archive/issue_comments_129175.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nI've posted an updated version of Leif's spkg, although without the changes to `spkg-check`.",
    "created_at": "2012-01-03T22:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129175",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:18" align="right">Comment 18</div>

I've posted an updated version of Leif's spkg, although without the changes to `spkg-check`.



---

archive/issue_comments_129176.json:
```json
{
    "body": "patch for readline spkg.  For review only.",
    "created_at": "2012-01-03T22:28:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129176",
    "user": "https://github.com/jhpalmieri"
}
```

patch for readline spkg.  For review only.



---

archive/issue_comments_129177.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nAttachment: **[trac_11970-readline.patch.gz](https://github.com/sagemath/sage/files/ticket11970/trac_11970-readline.patch.gz)**\n\nIs this one of the blockers for 4.8 release?  In which case some concerted effort to get it reviewed is surely urgent?\n\nUsing readline-6.2.p2.spkg I just helped my colleague Bruce Westbury build Sage on an old laptop on which he had installed ubuntu 11.10 (which is still building) but realised later that he was building 4.7.2 and not any 4.8.alpha.  The only ubuntu 11.10 machine I have is a slow netbook on which I built 4.7.2 before upgrading from ubuntu 11.04.  I can try this patch out on that but it may take a few days.",
    "created_at": "2012-01-05T11:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129177",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:19" align="right">Comment 19</div>

Attachment: **[trac_11970-readline.patch.gz](https://github.com/sagemath/sage/files/ticket11970/trac_11970-readline.patch.gz)**

Is this one of the blockers for 4.8 release?  In which case some concerted effort to get it reviewed is surely urgent?

Using readline-6.2.p2.spkg I just helped my colleague Bruce Westbury build Sage on an old laptop on which he had installed ubuntu 11.10 (which is still building) but realised later that he was building 4.7.2 and not any 4.8.alpha.  The only ubuntu 11.10 machine I have is a slow netbook on which I built 4.7.2 before upgrading from ubuntu 11.04.  I can try this patch out on that but it may take a few days.



---

archive/issue_comments_129178.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@JohnCremona](#comment%3A19):\n> Is this one of the blockers for 4.8 release?  In which case some concerted effort to get it reviewed is surely urgent?\n\nYes, it is.  And I certainly hope this will get fixed rather quickly.",
    "created_at": "2012-01-05T13:09:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129178",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@JohnCremona](#comment%3A19):
> Is this one of the blockers for 4.8 release?  In which case some concerted effort to get it reviewed is surely urgent?

Yes, it is.  And I certainly hope this will get fixed rather quickly.



---

archive/issue_comments_129179.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nThe spkg looks good on first sight.  I can of course not test it on every system.  So I'm willing to give it **positive_review** if somebody can confirm that it actually fixes the problem on Ubuntu 11.10.  I asked Paul Zimmermann to do this.",
    "created_at": "2012-01-05T13:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129179",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">Comment 21</div>

The spkg looks good on first sight.  I can of course not test it on every system.  So I'm willing to give it **positive_review** if somebody can confirm that it actually fixes the problem on Ubuntu 11.10.  I asked Paul Zimmermann to do this.



---

archive/issue_comments_129180.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2012-01-05T13:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129180",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_129181.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nBruce and I used readline-6.2.p2.spkg not the p3, and also used it on a fresh build of 4.7.2 (which had previously stalled building R).  So the following might not be relevant: after building, when we run Sage it gives a 2-line warning that readline is not available -- and indeed Sage has no history functions.  What did we do wrong?\n\nBruce also tells me that although he installed all the ubuntu packages listed on the installation web page, he also had to install dpkg-dev before Sage would build.",
    "created_at": "2012-01-05T14:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129181",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:22" align="right">Comment 22</div>

Bruce and I used readline-6.2.p2.spkg not the p3, and also used it on a fresh build of 4.7.2 (which had previously stalled building R).  So the following might not be relevant: after building, when we run Sage it gives a 2-line warning that readline is not available -- and indeed Sage has no history functions.  What did we do wrong?

Bruce also tells me that although he installed all the ubuntu packages listed on the installation web page, he also had to install dpkg-dev before Sage would build.



---

archive/issue_comments_129182.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@JohnCremona](#comment%3A22):\n> Bruce and I used readline-6.2.p2.spkg not the p3, and also used it on a fresh build of 4.7.2 (which had previously stalled building R).  So the following might not be relevant: after building, when we run Sage it gives a 2-line warning that readline is not available -- and indeed Sage has no history functions.  What did we do wrong?\n\nI got the same thing using the \"p3\" spkg. But the build finished and (I think) passed tests.",
    "created_at": "2012-01-06T02:08:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129182",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@JohnCremona](#comment%3A22):
> Bruce and I used readline-6.2.p2.spkg not the p3, and also used it on a fresh build of 4.7.2 (which had previously stalled building R).  So the following might not be relevant: after building, when we run Sage it gives a 2-line warning that readline is not available -- and indeed Sage has no history functions.  What did we do wrong?

I got the same thing using the "p3" spkg. But the build finished and (I think) passed tests.



---

archive/issue_comments_129183.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nI also tried the p3 spkg, and indeed the build finished, but:\n\n```\ntiramisu% ./sage\n----------------------------------------------------------------------\n| Sage Version 4.8.alpha5, Release Date: 2011-12-21                  |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nWARNING: Readline services not available on this platform.\nWARNING: The auto-indent feature requires the readline library\n```\n\nHowever I only applied the spkg, not the patch.\n\nPaul",
    "created_at": "2012-01-06T06:51:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129183",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:24" align="right">Comment 24</div>

I also tried the p3 spkg, and indeed the build finished, but:

```
tiramisu% ./sage
----------------------------------------------------------------------
| Sage Version 4.8.alpha5, Release Date: 2011-12-21                  |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
WARNING: Readline services not available on this platform.
WARNING: The auto-indent feature requires the readline library
```

However I only applied the spkg, not the patch.

Paul



---

archive/issue_comments_129184.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nOn sage.math with:\n* the new readline spkg from this ticket\n* compiled with gcc-4.2.4\n* #12263 applied\nthe following happens (and all 3 conditions above are needed):\n\n```\n$ ./sage -c True\nmnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libcsage.so(print_backtrace+0x2b)[0x7f22311cd3a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libcsage.so(sigdie+0x14)[0x7f22311cd3ce]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libcsage.so(sage_signal_handler+0x201)[0x7f22311cd031]\n/lib/libpthread.so.0[0x7f2232dd37d0]\n/lib/libc.so.6(strcmp+0x2)[0x7f2232455b42]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(tgetent+0xc4)[0x7f222bb2d18c]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(_rl_init_terminal_io+0x306)[0x7f222bb24fc6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(rl_initialize+0x87)[0x7f222bb0f5b7]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/python2.6/lib-dynload/readline.so(initreadline+0x15f)[0x7f222bd4248f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(_PyImport_LoadDynamicModule+0xc2)[0x7f22330ddc42]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbfb2]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x6452)[0x7f22330c3552]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dd018]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbfb2]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyRun_FileExFlags+0xc1)[0x7f22330e8871]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyRun_SimpleFileExFlags+0x1f9)[0x7f22330e8b49]\n/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(Py_Main+0xa71)[0x7f22330f4591]\n/lib/libc.so.6(__libc_start_main+0xf4)[0x7f22323f91c4]\npython[0x400679]\n\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off(). You might\nwant to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate.\n------------------------------------------------------------------------\nlocal/bin/sage-sage: line 766: 23516 Segmentation fault      sage-eval \"$@\"\n```",
    "created_at": "2012-01-06T09:15:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129184",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">Comment 25</div>

On sage.math with:
* the new readline spkg from this ticket
* compiled with gcc-4.2.4
* #12263 applied
the following happens (and all 3 conditions above are needed):

```
$ ./sage -c True
mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libcsage.so(print_backtrace+0x2b)[0x7f22311cd3a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libcsage.so(sigdie+0x14)[0x7f22311cd3ce]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libcsage.so(sage_signal_handler+0x201)[0x7f22311cd031]
/lib/libpthread.so.0[0x7f2232dd37d0]
/lib/libc.so.6(strcmp+0x2)[0x7f2232455b42]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(tgetent+0xc4)[0x7f222bb2d18c]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(_rl_init_terminal_io+0x306)[0x7f222bb24fc6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(rl_initialize+0x87)[0x7f222bb0f5b7]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/python2.6/lib-dynload/readline.so(initreadline+0x15f)[0x7f222bd4248f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(_PyImport_LoadDynamicModule+0xc2)[0x7f22330ddc42]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbfb2]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x6452)[0x7f22330c3552]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dd018]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbfb2]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x12a)[0x7f22330dc1ca]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ExecCodeModuleEx+0xc2)[0x7f22330d8b52]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330db368]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dba59]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330dbf2b]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyImport_ImportModuleLevel+0x169)[0x7f22330dc209]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0[0x7f22330bbdcd]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyObject_Call+0x68)[0x7f2233026f48]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_CallObjectWithKeywords+0x56)[0x7f22330bc4f6]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalFrameEx+0x214f)[0x7f22330bf24f]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCodeEx+0x891)[0x7f22330c49a1]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyEval_EvalCode+0x32)[0x7f22330c4a72]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyRun_FileExFlags+0xc1)[0x7f22330e8871]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(PyRun_SimpleFileExFlags+0x1f9)[0x7f22330e8b49]
/mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libpython2.6.so.1.0(Py_Main+0xa71)[0x7f22330f4591]
/lib/libc.so.6(__libc_start_main+0xf4)[0x7f22323f91c4]
python[0x400679]

------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off(). You might
want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate.
------------------------------------------------------------------------
local/bin/sage-sage: line 766: 23516 Segmentation fault      sage-eval "$@"
```



---

archive/issue_events_147912.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-06T11:09:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147912"
}
```



---

archive/issue_events_147913.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-06T11:09:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147913"
}
```



---

archive/issue_comments_129185.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@JohnCremona](#comment%3A22):\n> Bruce and I used readline-6.2.p2.spkg not the p3, and also used it on a fresh build of 4.7.2 (which had previously stalled building R).  \n> So the following might not be relevant: after building, when we run Sage it gives a 2-line warning that readline is not available -- and indeed Sage has no history functions.  What did we do wrong?\n\nBefore building Sage (or [re-]installing **Sage's** readline), you need to\n\n```sh\n$ sudo apt-get install libncurses5-dev libncursesw5-dev\n```\n\n(The latter depends on the former, so you actually have to specify only one of them).  You **do not** have to install any *libreadline* package, as Sage builds and uses its own -- the one we're talking about here.\n\n\n\n> Bruce also tells me that although he installed all the ubuntu packages listed on the installation web page, he also had to install dpkg-dev before Sage would build.\n\nI'm pretty sure the instructions on the web page are still outdated (and by the way have been wrong anyway), as discussed with Harald on sage-release a while ago.\n\n`dpkg-dev` is needed since Ubuntu 11.04, in order to make Python build (because the locations of some libraries were changed in Debian/Ubuntu).\n\n---\n\nI'm sorry I'm unable to work much on Sage at the moment; thanks John for providing an updated and rebased spkg of my preliminary one.",
    "created_at": "2012-01-06T21:29:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129185",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@JohnCremona](#comment%3A22):
> Bruce and I used readline-6.2.p2.spkg not the p3, and also used it on a fresh build of 4.7.2 (which had previously stalled building R).  
> So the following might not be relevant: after building, when we run Sage it gives a 2-line warning that readline is not available -- and indeed Sage has no history functions.  What did we do wrong?

Before building Sage (or [re-]installing **Sage's** readline), you need to

```sh
$ sudo apt-get install libncurses5-dev libncursesw5-dev
```

(The latter depends on the former, so you actually have to specify only one of them).  You **do not** have to install any *libreadline* package, as Sage builds and uses its own -- the one we're talking about here.



> Bruce also tells me that although he installed all the ubuntu packages listed on the installation web page, he also had to install dpkg-dev before Sage would build.

I'm pretty sure the instructions on the web page are still outdated (and by the way have been wrong anyway), as discussed with Harald on sage-release a while ago.

`dpkg-dev` is needed since Ubuntu 11.04, in order to make Python build (because the locations of some libraries were changed in Debian/Ubuntu).

---

I'm sorry I'm unable to work much on Sage at the moment; thanks John for providing an updated and rebased spkg of my preliminary one.



---

archive/issue_comments_129186.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nReplying to [@jdemeyer](#comment%3A25):\n> On sage.math with: \n\n> * the new readline spkg from this ticket \n\n> * compiled with gcc-4.2.4 \n\n> * #12263 applied \n\n> the following happens (and all 3 conditions above are needed):\n\n\n```\n...\n> /lib/libc.so.6(strcmp+0x2)[0x7f2232455b42]\n> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(tgetent+0xc4)[0x7f222bb2d18c]\n> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(_rl_init_terminal_io+0x306)[0x7f222bb24fc6]\n> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(rl_initialize+0x87)[0x7f222bb0f5b7]\n> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/python2.6/lib-dynload/readline.so(initreadline+0x15f)[0x7f222bd4248f]\n...\n```\n\n\n\n\nCan you track this further down?\n\nI tried `tgetent(NULL, NULL)` on `sage.math` (with GCC 4.2.4), which doesn't segfault but properly returns 1.  Could you try setting `TERM` to something else (rather than unsetting it) in `sage-sage`, as suggested at #12263?",
    "created_at": "2012-01-06T21:41:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129186",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:28" align="right">Comment 28</div>

Replying to [@jdemeyer](#comment%3A25):
> On sage.math with: 

> * the new readline spkg from this ticket 

> * compiled with gcc-4.2.4 

> * #12263 applied 

> the following happens (and all 3 conditions above are needed):


```
...
> /lib/libc.so.6(strcmp+0x2)[0x7f2232455b42]
> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(tgetent+0xc4)[0x7f222bb2d18c]
> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(_rl_init_terminal_io+0x306)[0x7f222bb24fc6]
> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/libreadline.so.6(rl_initialize+0x87)[0x7f222bb0f5b7]
> /mnt/usb1/scratch/jdemeyer/merger/sage-4.8.rc1/local/lib/python2.6/lib-dynload/readline.so(initreadline+0x15f)[0x7f222bd4248f]
...
```




Can you track this further down?

I tried `tgetent(NULL, NULL)` on `sage.math` (with GCC 4.2.4), which doesn't segfault but properly returns 1.  Could you try setting `TERM` to something else (rather than unsetting it) in `sage-sage`, as suggested at #12263?



---

archive/issue_comments_129187.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nHere is a first interesting data point:\n\nLet `tgetent_test.c` be following file:\n\n```\n#include <termcap.h>\n#include <stdlib.h>\n\nint main(int argc, char** argv)\n{\n    char* buf = malloc(100000);\n    tgetent(buf, \"dumb\");\n}\n```\n\nCompiling this with\n\n```\n$ gcc -ltermcap tgetent_test.c -o tgetent_test\n```\nand running it works flawlessly.\n\nHowever, the same gcc command with the Sage environment variables gives\n\n```\n$ ( source local/bin/sage-env; gcc -ltermcap tgetent_test.c -o tgetent_test )\n/tmp/ccwDi3Oi.o: In function `main':\ntgetent_test.c:(.text+0x27): undefined reference to `tgetent'\ncollect2: ld returned 1 exit status\n```\n\nWith gcc-4.5.1 (which I happen to have installed in my own $HOME directory), the compilation works fine again.",
    "created_at": "2012-01-07T21:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129187",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">Comment 29</div>

Here is a first interesting data point:

Let `tgetent_test.c` be following file:

```
#include <termcap.h>
#include <stdlib.h>

int main(int argc, char** argv)
{
    char* buf = malloc(100000);
    tgetent(buf, "dumb");
}
```

Compiling this with

```
$ gcc -ltermcap tgetent_test.c -o tgetent_test
```
and running it works flawlessly.

However, the same gcc command with the Sage environment variables gives

```
$ ( source local/bin/sage-env; gcc -ltermcap tgetent_test.c -o tgetent_test )
/tmp/ccwDi3Oi.o: In function `main':
tgetent_test.c:(.text+0x27): undefined reference to `tgetent'
collect2: ld returned 1 exit status
```

With gcc-4.5.1 (which I happen to have installed in my own $HOME directory), the compilation works fine again.



---

archive/issue_comments_129188.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nDeleting the file `$SAGE_ROOT/local/lib/libtermcap.a` solves the problem.  Somehow that static-only library confuses the linker.  Not sure whether this is a linker bug or feature.",
    "created_at": "2012-01-07T22:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129188",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">Comment 30</div>

Deleting the file `$SAGE_ROOT/local/lib/libtermcap.a` solves the problem.  Somehow that static-only library confuses the linker.  Not sure whether this is a linker bug or feature.



---

archive/issue_comments_129189.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nNote: the output of `readline-6.2.p3.log` is exactly the same whether or not `local/lib/libtermcap.a` exists.  From my observations above, I would expect the readline build to fail when `local/bin/libtermcap.a` exists.  But it doesn't, so maybe it finds a broken `tgetent()` somewhere somehow.",
    "created_at": "2012-01-07T22:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129189",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">Comment 31</div>

Note: the output of `readline-6.2.p3.log` is exactly the same whether or not `local/lib/libtermcap.a` exists.  From my observations above, I would expect the readline build to fail when `local/bin/libtermcap.a` exists.  But it doesn't, so maybe it finds a broken `tgetent()` somewhere somehow.



---

archive/issue_comments_129190.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nThat's it for now, going to sleep...",
    "created_at": "2012-01-07T22:20:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129190",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">Comment 32</div>

That's it for now, going to sleep...



---

archive/issue_comments_129191.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nReplying to [@jdemeyer](#comment%3A29):\n> Here is a first interesting data point:\n> \n> Let `tgetent_test.c` be following file:\n\n\n```\n#include <termcap.h>\n#include <stdlib.h>\n\nint main(int argc, char** argv)\n{\n    char* buf = malloc(100000);\n    tgetent(buf, \"dumb\");\n}\n```\n\nFWIW, I did `#include <term.h>` and used `-lcurses`, since termcap is part of ncurses on Ubuntu/Debian.\n\n\n  \n\n> Compiling this with\n\n\n```\n$ gcc -ltermcap tgetent_test.c -o tgetent_test\n```\n> and running it works flawlessly.\n\nLibraries should in general be specified **after** the modules that use (parts of) them.  This is (again) mandatory with newer Linux distros as you will know (cf. the Symmetrica and Singular changes for Ubuntu 11.10).\n\nSome linkers seem to make a difference w.r.t. whether they find a *static* library [only] (or depending on whether `LIBRARY_PATH` is set? -- which `sage-env` does).\n\n\n\n\n> However, the same gcc command with the Sage environment variables gives\n\n\n```\n$ ( source local/bin/sage-env; gcc -ltermcap tgetent_test.c -o tgetent_test )\n/tmp/ccwDi3Oi.o: In function `main':\ntgetent_test.c:(.text+0x27): undefined reference to `tgetent'\ncollect2: ld returned 1 exit status\n```\n\nThis problem vanishes if you\n* put `-ltermcap` last (as one would expect), or\n* `unset LIBRARY_PATH` after sourcing `sage-env` (in which case Sage's `libtermcap.a` of course isn't used), or\n* both.\n\nAnyway, I don't think this is related to our problem; Sage's readline *shouldn't*<sup>TM</sup> use *Sage's* termcap library at all; on Ubuntu, libtermcap* is a symlink to libncurses*.",
    "created_at": "2012-01-07T23:56:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129191",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:33" align="right">Comment 33</div>

Replying to [@jdemeyer](#comment%3A29):
> Here is a first interesting data point:
> 
> Let `tgetent_test.c` be following file:


```
#include <termcap.h>
#include <stdlib.h>

int main(int argc, char** argv)
{
    char* buf = malloc(100000);
    tgetent(buf, "dumb");
}
```

FWIW, I did `#include <term.h>` and used `-lcurses`, since termcap is part of ncurses on Ubuntu/Debian.


  

> Compiling this with


```
$ gcc -ltermcap tgetent_test.c -o tgetent_test
```
> and running it works flawlessly.

Libraries should in general be specified **after** the modules that use (parts of) them.  This is (again) mandatory with newer Linux distros as you will know (cf. the Symmetrica and Singular changes for Ubuntu 11.10).

Some linkers seem to make a difference w.r.t. whether they find a *static* library [only] (or depending on whether `LIBRARY_PATH` is set? -- which `sage-env` does).




> However, the same gcc command with the Sage environment variables gives


```
$ ( source local/bin/sage-env; gcc -ltermcap tgetent_test.c -o tgetent_test )
/tmp/ccwDi3Oi.o: In function `main':
tgetent_test.c:(.text+0x27): undefined reference to `tgetent'
collect2: ld returned 1 exit status
```

This problem vanishes if you
* put `-ltermcap` last (as one would expect), or
* `unset LIBRARY_PATH` after sourcing `sage-env` (in which case Sage's `libtermcap.a` of course isn't used), or
* both.

Anyway, I don't think this is related to our problem; Sage's readline *shouldn't*<sup>TM</sup> use *Sage's* termcap library at all; on Ubuntu, libtermcap* is a symlink to libncurses*.



---

archive/issue_comments_129192.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nI confirm that `-ltermcap` should be last. With gcc 4.6.1:\n\n```\ntiramisu% gcc tgetent_test.c -o tgetent_test -ltermcap\ntiramisu% gcc -ltermcap tgetent_test.c -o tgetent_test\n/tmp/ccqQuCr3.o: In function `main':\ntgetent_test.c:(.text+0x2a): undefined reference to `tgetent'\ncollect2: ld returned 1 exit status\n```\nPaul",
    "created_at": "2012-01-08T10:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129192",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:34" align="right">Comment 34</div>

I confirm that `-ltermcap` should be last. With gcc 4.6.1:

```
tiramisu% gcc tgetent_test.c -o tgetent_test -ltermcap
tiramisu% gcc -ltermcap tgetent_test.c -o tgetent_test
/tmp/ccqQuCr3.o: In function `main':
tgetent_test.c:(.text+0x2a): undefined reference to `tgetent'
collect2: ld returned 1 exit status
```
Paul



---

archive/issue_comments_129193.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nReplying to [@jdemeyer](#comment%3A25):\n> On sage.math with: \n\n> * the new readline spkg from this ticket \n\n> * compiled with gcc-4.2.4 \n\n> * #12263 applied \n\n> the following happens (and all 3 conditions above are needed) [...]\n\nAnything else that might affect this (besides #12263, which was merged into rc0), i.e., does the same happen with 4.8.alpha{5,6} + #12263 (with GCC 4.2.4 on Ubuntu 08.04 / `sage.math`), and does my change (on top of readline-6.2.p1) make the difference?\n\nMy current internet connection is quite poor, so I don't know if I can fully build Sage and experiment on `sage.math` myself.\n\nOtherwise you could try unsetting `LIBRARY_PATH` in readline's `spkg-install` (with the same configuration as above that segfaulted) and see whether that makes any difference.  I didn't know that `sage-env` sets `LIBRARY_PATH`, so didn't expect that *Sage's* libtermcap might get picked up despite us intentionally *not* using `-I$SAGE_LOCAL/include` nor `-L$SAGE_LOCAL/lib` in readline's `spkg-install`.",
    "created_at": "2012-01-08T15:59:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129193",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:35" align="right">Comment 35</div>

Replying to [@jdemeyer](#comment%3A25):
> On sage.math with: 

> * the new readline spkg from this ticket 

> * compiled with gcc-4.2.4 

> * #12263 applied 

> the following happens (and all 3 conditions above are needed) [...]

Anything else that might affect this (besides #12263, which was merged into rc0), i.e., does the same happen with 4.8.alpha{5,6} + #12263 (with GCC 4.2.4 on Ubuntu 08.04 / `sage.math`), and does my change (on top of readline-6.2.p1) make the difference?

My current internet connection is quite poor, so I don't know if I can fully build Sage and experiment on `sage.math` myself.

Otherwise you could try unsetting `LIBRARY_PATH` in readline's `spkg-install` (with the same configuration as above that segfaulted) and see whether that makes any difference.  I didn't know that `sage-env` sets `LIBRARY_PATH`, so didn't expect that *Sage's* libtermcap might get picked up despite us intentionally *not* using `-I$SAGE_LOCAL/include` nor `-L$SAGE_LOCAL/lib` in readline's `spkg-install`.



---

archive/issue_comments_129194.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nFWIW, I've made a p4 (changes not yet committed) that unsets `LIBRARY_PATH`:\n\n  http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg",
    "created_at": "2012-01-08T17:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129194",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:36" align="right">Comment 36</div>

FWIW, I've made a p4 (changes not yet committed) that unsets `LIBRARY_PATH`:

  http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg



---

archive/issue_events_147914.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2012-01-08T17:11:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147914"
}
```



---

archive/issue_events_147915.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2012-01-08T17:11:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147915"
}
```



---

archive/issue_comments_129195.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nOk, I've now successfully built Sage 4.8.**alpha6** on `sage.math` (with GCC 4.2.4); `sage -c True` works (doesn't segfault)\n\n* with the vanilla installation\n* with my new readline-6.2.p4\n* with my p4 and #12263 applied (i.e., `TERM` unset).\n\nJeroen, can you check / confirm that it also works with your 4.8.rc1?",
    "created_at": "2012-01-08T18:24:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129195",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:37" align="right">Comment 37</div>

Ok, I've now successfully built Sage 4.8.**alpha6** on `sage.math` (with GCC 4.2.4); `sage -c True` works (doesn't segfault)

* with the vanilla installation
* with my new readline-6.2.p4
* with my p4 and #12263 applied (i.e., `TERM` unset).

Jeroen, can you check / confirm that it also works with your 4.8.rc1?



---

archive/issue_comments_129196.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nThere's also a \"debug\" version which outputs some `make` variables when building the shared library (modified patch to upstream):\n\n  http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4-debug.spkg\n\n```diff\n--- src/shlib/Makefile.in\t2010-12-28 21:56:21.000000000 +0100\n+++ src/shlib/Makefile.in\t2012-01-08 18:41:05.794898031 +0100\n@@ -166,7 +166,17 @@\n \n $(SHARED_READLINE):\t$(SHARED_OBJ)\n \t$(RM) $@\n-\t$(SHOBJ_LD) ${SHOBJ_LDFLAGS} ${SHLIB_XLDFLAGS} -o $@ $(SHARED_OBJ) $(SHLIB_LIBS)\n+\t# $(SHOBJ_LD) ${SHOBJ_LDFLAGS} ${SHLIB_XLDFLAGS} -o $@ $(SHARED_OBJ) $(SHLIB_LIBS)\n+\t@echo \"**************************************************************************\"\n+\t@echo \"Sage: Shared readline library gets linked to \\\"$(TERMCAP_LIB)\\\".\"\n+\t@echo\n+\t@echo \"\\$$(SHOBJ_LD)=\"$(SHOBJ_LD)\n+\t@echo \"\\$$(SHOBJ_LDFLAGS)=\"$(SHOBJ_LDFLAGS)\n+\t@echo \"\\$$(SHOBJ_XLDFLAGS)=\"$(SHOBJ_XLDFLAGS)\n+\t@echo\n+\t@echo \"\\$$(SHLIB_LIBS)=\"$(SHLIB_LIBS)\n+\t@echo \"**************************************************************************\"\n+\t$(SHOBJ_LD) ${SHOBJ_LDFLAGS} ${SHLIB_XLDFLAGS} -o $@ $(SHARED_OBJ) $(SHLIB_LIBS) $(TERMCAP_LIB)\n \n $(SHARED_HISTORY):\t$(SHARED_HISTOBJ) xmalloc.so xfree.so\n \t$(RM) $@\n```",
    "created_at": "2012-01-08T18:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129196",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:38" align="right">Comment 38</div>

There's also a "debug" version which outputs some `make` variables when building the shared library (modified patch to upstream):

  http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4-debug.spkg

```diff
--- src/shlib/Makefile.in	2010-12-28 21:56:21.000000000 +0100
+++ src/shlib/Makefile.in	2012-01-08 18:41:05.794898031 +0100
@@ -166,7 +166,17 @@
 
 $(SHARED_READLINE):	$(SHARED_OBJ)
 	$(RM) $@
-	$(SHOBJ_LD) ${SHOBJ_LDFLAGS} ${SHLIB_XLDFLAGS} -o $@ $(SHARED_OBJ) $(SHLIB_LIBS)
+	# $(SHOBJ_LD) ${SHOBJ_LDFLAGS} ${SHLIB_XLDFLAGS} -o $@ $(SHARED_OBJ) $(SHLIB_LIBS)
+	@echo "**************************************************************************"
+	@echo "Sage: Shared readline library gets linked to \"$(TERMCAP_LIB)\"."
+	@echo
+	@echo "\$$(SHOBJ_LD)="$(SHOBJ_LD)
+	@echo "\$$(SHOBJ_LDFLAGS)="$(SHOBJ_LDFLAGS)
+	@echo "\$$(SHOBJ_XLDFLAGS)="$(SHOBJ_XLDFLAGS)
+	@echo
+	@echo "\$$(SHLIB_LIBS)="$(SHLIB_LIBS)
+	@echo "**************************************************************************"
+	$(SHOBJ_LD) ${SHOBJ_LDFLAGS} ${SHLIB_XLDFLAGS} -o $@ $(SHARED_OBJ) $(SHLIB_LIBS) $(TERMCAP_LIB)
 
 $(SHARED_HISTORY):	$(SHARED_HISTOBJ) xmalloc.so xfree.so
 	$(RM) $@
```



---

archive/issue_comments_129197.json:
```json
{
    "body": "Changed keywords from **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project** to **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project sd35.5**",
    "created_at": "2012-01-09T08:54:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129197",
    "user": "https://github.com/zimmermann6"
}
```

Changed keywords from **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project** to **Oneiric Ocelot Ubuntu 11.10 ARM libtermcap libncurses libtinfo r-project sd35.5**



---

archive/issue_events_147916.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-01-09T08:54:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147916"
}
```



---

archive/issue_events_147917.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-01-09T08:54:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147917"
}
```



---

archive/issue_comments_129198.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nI tried http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg under Ubuntu 11.10 but still get:\n\n```\ntiramisu% ./sage\n----------------------------------------------------------------------\n| Sage Version 4.8.alpha5, Release Date: 2011-12-21                  |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nWARNING: Readline services not available on this platform.\nWARNING: The auto-indent feature requires the readline library\n```\nHowever I had previously installed the previous spkg (readline-6.2.p3.spkg).\nCould it be that there was an interference between both? If so, how could I get a fresh\nSage version without starting \"make\" from scratch?\n\nPaul",
    "created_at": "2012-01-09T08:54:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129198",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:39" align="right">Comment 39</div>

I tried http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg under Ubuntu 11.10 but still get:

```
tiramisu% ./sage
----------------------------------------------------------------------
| Sage Version 4.8.alpha5, Release Date: 2011-12-21                  |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
WARNING: Readline services not available on this platform.
WARNING: The auto-indent feature requires the readline library
```
However I had previously installed the previous spkg (readline-6.2.p3.spkg).
Could it be that there was an interference between both? If so, how could I get a fresh
Sage version without starting "make" from scratch?

Paul



---

archive/issue_comments_129199.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nI think I got to the bottom of the `tgetent()` segmentation fault: it is a bug in the termcap library.  Under normal circumstances, `strcmp()` can be called with a NULL pointer argument.",
    "created_at": "2012-01-09T09:59:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129199",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">Comment 40</div>

I think I got to the bottom of the `tgetent()` segmentation fault: it is a bug in the termcap library.  Under normal circumstances, `strcmp()` can be called with a NULL pointer argument.



---

archive/issue_comments_129200.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nSee #12282 for the termcap issue.",
    "created_at": "2012-01-09T10:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129200",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">Comment 41</div>

See #12282 for the termcap issue.



---

archive/issue_events_147918.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-09T10:25:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147918"
}
```



---

archive/issue_events_147919.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-09T10:25:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147919"
}
```



---

archive/issue_comments_129201.json:
```json
{
    "body": "Dependencies: **#12282**",
    "created_at": "2012-01-09T10:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129201",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#12282**



---

archive/issue_events_147920.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-09T13:25:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147920"
}
```



---

archive/issue_events_147921.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-09T13:25:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147921"
}
```



---

archive/issue_comments_129202.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nReplying to [@zimmermann6](#comment%3A39):\n> I tried http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg under Ubuntu 11.10 but still get:\n> \n> ```\n> tiramisu% ./sage\n> ----------------------------------------------------------------------\n> | Sage Version 4.8.alpha5, Release Date: 2011-12-21                  |\n> | Type notebook() for the GUI, and license() for information.        |\n> ----------------------------------------------------------------------\n> **********************************************************************\n> *                                                                    *\n> * Warning: this is a prerelease version, and it may be unstable.     *\n> *                                                                    *\n> **********************************************************************\n> WARNING: Readline services not available on this platform.\n> WARNING: The auto-indent feature requires the readline library\n> ```\n\nJohn Cremona reports that building Sage from scratch with the new readline p3 solves this warning.",
    "created_at": "2012-01-09T13:26:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129202",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">Comment 44</div>

Replying to [@zimmermann6](#comment%3A39):
> I tried http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg under Ubuntu 11.10 but still get:
> 
> ```
> tiramisu% ./sage
> ----------------------------------------------------------------------
> | Sage Version 4.8.alpha5, Release Date: 2011-12-21                  |
> | Type notebook() for the GUI, and license() for information.        |
> ----------------------------------------------------------------------
> **********************************************************************
> *                                                                    *
> * Warning: this is a prerelease version, and it may be unstable.     *
> *                                                                    *
> **********************************************************************
> WARNING: Readline services not available on this platform.
> WARNING: The auto-indent feature requires the readline library
> ```

John Cremona reports that building Sage from scratch with the new readline p3 solves this warning.



---

archive/issue_comments_129203.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nReplying to [@jdemeyer](#comment%3A44):\n> Replying to [@zimmermann6](#comment%3A39):\n> > I tried http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg under Ubuntu 11.10 but still get:\n\n\n```\n...\nWARNING: Readline services not available on this platform.\nWARNING: The auto-indent feature requires the readline library\n```\n> John Cremona reports that building Sage from scratch with the new readline p3 solves this warning.\n\nYou just have to:\n1. `sudo apt-get install libncurses5-dev` as mentioned above\n2. (Re)install the readline spkg: \n\n   `./sage -f /path/to/readline-6.2.p{2,3,4}`\n3. **Reinstall the Python spkg:** \n\n   `./sage -f spkg/standard/python-*` (or `./sage -f python-2.6.4.p13`)",
    "created_at": "2012-01-09T19:17:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129203",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:45" align="right">Comment 45</div>

Replying to [@jdemeyer](#comment%3A44):
> Replying to [@zimmermann6](#comment%3A39):
> > I tried http://sage.math.washington.edu/home/leif/Sage/spkgs/readline-6.2.p4.spkg under Ubuntu 11.10 but still get:


```
...
WARNING: Readline services not available on this platform.
WARNING: The auto-indent feature requires the readline library
```
> John Cremona reports that building Sage from scratch with the new readline p3 solves this warning.

You just have to:
1. `sudo apt-get install libncurses5-dev` as mentioned above
2. (Re)install the readline spkg: 

   `./sage -f /path/to/readline-6.2.p{2,3,4}`
3. **Reinstall the Python spkg:** 

   `./sage -f spkg/standard/python-*` (or `./sage -f python-2.6.4.p13`)



---

archive/issue_comments_129204.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nReplying to [@jdemeyer](#comment%3A43):\n> * status changed from needs_review to positive_review\n\nWhich spkg got the positive review?\n\nI'd prefer also unsetting `LIBRARY_PATH` in readline's `spkg-install` (which the p4 does), since in any case we don't want to use Sage's static libtermcap there.",
    "created_at": "2012-01-09T19:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129204",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:46" align="right">Comment 46</div>

Replying to [@jdemeyer](#comment%3A43):
> * status changed from needs_review to positive_review

Which spkg got the positive review?

I'd prefer also unsetting `LIBRARY_PATH` in readline's `spkg-install` (which the p4 does), since in any case we don't want to use Sage's static libtermcap there.



---

archive/issue_comments_129205.json:
```json
{
    "body": "Diff between the p3 and the p4. For reference / review only.",
    "created_at": "2012-01-09T19:32:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129205",
    "user": "https://github.com/nexttime"
}
```

Diff between the p3 and the p4. For reference / review only.



---

archive/issue_comments_129206.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nAttachment: **[readline-6.2.p3-p4.diff.gz](https://github.com/sagemath/sage/files/ticket11970/readline-6.2.p3-p4.diff.gz)**\n\nI've attached a diff between the p3 and the p4; the changes aren't yet committed though.",
    "created_at": "2012-01-09T19:34:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129206",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:47" align="right">Comment 47</div>

Attachment: **[readline-6.2.p3-p4.diff.gz](https://github.com/sagemath/sage/files/ticket11970/readline-6.2.p3-p4.diff.gz)**

I've attached a diff between the p3 and the p4; the changes aren't yet committed though.



---

archive/issue_comments_129207.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nthanks Leif, I missed the last step (reinstalling the python spkg). It works now.\n\nPaul",
    "created_at": "2012-01-09T19:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129207",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:48" align="right">Comment 48</div>

thanks Leif, I missed the last step (reinstalling the python spkg). It works now.

Paul



---

archive/issue_comments_129208.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nReplying to [@nexttime](#comment%3A46):\n> Which spkg got the positive review?\n\nThe p3 version (the spkg mentioned in the ticket description).\n\n> since in any case we don't want to use Sage's static libtermcap there.\n\nWhy not?  The **fixed** one from #12282 should be fine.",
    "created_at": "2012-01-09T20:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129208",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">Comment 49</div>

Replying to [@nexttime](#comment%3A46):
> Which spkg got the positive review?

The p3 version (the spkg mentioned in the ticket description).

> since in any case we don't want to use Sage's static libtermcap there.

Why not?  The **fixed** one from #12282 should be fine.



---

archive/issue_comments_129209.json:
```json
{
    "body": "Merged: **sage-4.8.rc0**",
    "created_at": "2012-01-15T15:40:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11970#issuecomment-129209",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.8.rc0**



---

archive/issue_events_147922.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-15T15:40:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147922"
}
```



---

archive/issue_events_147923.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-15T15:40:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11970",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11970#event-147923"
}
```
