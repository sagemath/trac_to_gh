# Issue 11781: Conversion from Zmod element to padic element raises "not a power of the same prime" incorrectly, add conversion from residue_field

archive/issues_011609.json:
```json
{
    "body": "Since mpz_cmp_ui returns 0 if equality holds, wrong 'if' condition was being used to check if Zmod element was in the right characteristic. Fix this in padic_ZZ_pX_CR_element.pyx and padic_ZZ_pX_CA_element.pyx.\n\nAlso, enhancement: allow conversion from element of the residue_field of self (this really only affects unramified extensions).\n\n**Apply** [attachment:trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch]\n\nAssignee: @roed314\n\nCC:  @roed314\n\nKeywords: padics, conversion\n\nResolution: fixed\n\nAuthor: Robert Harron\n\nReviewer: David Roe\n\nMerged: sage-4.8.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/11781\n\n",
    "closed_at": "2011-11-14T17:32:04Z",
    "created_at": "2011-09-06T02:21:11Z",
    "labels": [
        "component: padics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Conversion from Zmod element to padic element raises \"not a power of the same prime\" incorrectly, add conversion from residue_field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11781",
    "user": "https://github.com/rharron"
}
```
Since mpz_cmp_ui returns 0 if equality holds, wrong 'if' condition was being used to check if Zmod element was in the right characteristic. Fix this in padic_ZZ_pX_CR_element.pyx and padic_ZZ_pX_CA_element.pyx.

Also, enhancement: allow conversion from element of the residue_field of self (this really only affects unramified extensions).

**Apply** [attachment:trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch]

Assignee: @roed314

CC:  @roed314

Keywords: padics, conversion

Resolution: fixed

Author: Robert Harron

Reviewer: David Roe

Merged: sage-4.8.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/11781





---

archive/issue_comments_138350.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-09-06T02:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138350",
    "user": "https://github.com/rharron"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_138351.json:
```json
{
    "body": "<a id='comment:2'></a>There seems to be a problem with the patch you uploaded: it just consists of the header.  How did you create it?",
    "created_at": "2011-09-06T13:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138351",
    "user": "https://github.com/roed314"
}
```

<a id='comment:2'></a>There seems to be a problem with the patch you uploaded: it just consists of the header.  How did you create it?



---

archive/issue_comments_138352.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-09-06T13:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138352",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_138353.json:
```json
{
    "body": "<a id='comment:3'></a>I followed the instructions at http://www.sagemath.org/doc/developer/walk_through.html under the section \"Creating your own patches with queues\", but I'm new to this whole thing, so I may have messed something up. Is there something specific I should do because these are cython files? I ran an hg qnew, then I edited, then I ran an hg qrefresh, then I ran an hg export tip. The sage build knows that I have updated them, but it's true that when I run hg qdiff it returns nothing. I'll try recreating the patch using the hg_sage interface, but I'll have to reclone first.\n\nReplying to [comment:2 roed]:\n\n> There seems to be a problem with the patch you uploaded: it just consists of the header.  How did you create it?",
    "created_at": "2011-09-06T14:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138353",
    "user": "https://github.com/rharron"
}
```

<a id='comment:3'></a>I followed the instructions at http://www.sagemath.org/doc/developer/walk_through.html under the section "Creating your own patches with queues", but I'm new to this whole thing, so I may have messed something up. Is there something specific I should do because these are cython files? I ran an hg qnew, then I edited, then I ran an hg qrefresh, then I ran an hg export tip. The sage build knows that I have updated them, but it's true that when I run hg qdiff it returns nothing. I'll try recreating the patch using the hg_sage interface, but I'll have to reclone first.

Replying to [comment:2 roed]:

> There seems to be a problem with the patch you uploaded: it just consists of the header.  How did you create it?



---

archive/issue_comments_138354.json:
```json
{
    "body": "<a id='comment:4'></a>Try running \"hg export qtip\" rather than \"hg export tip.\"",
    "created_at": "2011-09-06T14:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138354",
    "user": "https://github.com/roed314"
}
```

<a id='comment:4'></a>Try running "hg export qtip" rather than "hg export tip."



---

archive/issue_comments_138355.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 roed]:\n> Try running \"hg export qtip\" rather than \"hg export tip.\"\n\n\nYou should be able to do this on your existing branch.  You can then look at the patch (either before or after you upload it)  in order to check to see if it includes the changes you want.\n\nThanks for working on this!",
    "created_at": "2011-09-06T14:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138355",
    "user": "https://github.com/roed314"
}
```

<a id='comment:5'></a>Replying to [comment:4 roed]:
> Try running "hg export qtip" rather than "hg export tip."


You should be able to do this on your existing branch.  You can then look at the patch (either before or after you upload it)  in order to check to see if it includes the changes you want.

Thanks for working on this!



---

archive/issue_comments_138356.json:
```json
{
    "body": "<a id='comment:6'></a>qtip only produced the header as well.\n\nReplying to [comment:5 roed]:\n\n> Replying to [comment:4 roed]:\n> > Try running \"hg export qtip\" rather than \"hg export tip.\"\n\n> You should be able to do this on your existing branch.  You can then look at the patch (either before or after you upload it)  in order to check to see if it includes the changes you want. Thanks for working on this!",
    "created_at": "2011-09-06T14:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138356",
    "user": "https://github.com/rharron"
}
```

<a id='comment:6'></a>qtip only produced the header as well.

Replying to [comment:5 roed]:

> Replying to [comment:4 roed]:
> > Try running "hg export qtip" rather than "hg export tip."

> You should be able to do this on your existing branch.  You can then look at the patch (either before or after you upload it)  in order to check to see if it includes the changes you want. Thanks for working on this!



---

archive/issue_comments_138357.json:
```json
{
    "body": "In padics, fix bug with Zmod element conversion, add conversion from residue_field",
    "created_at": "2011-09-06T14:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138357",
    "user": "https://github.com/rharron"
}
```

In padics, fix bug with Zmod element conversion, add conversion from residue_field



---

archive/issue_comments_138358.json:
```json
{
    "body": "<a id='comment:7'></a>Attachment [trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.patch](tarball://root/attachments/some-uuid/ticket11781/trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.patch) by @rharron created at 2011-09-06 14:51:00\n\nOk, I used the hg_sage functions in sage and the patch now seems to be what it should be. Patch file updated.",
    "created_at": "2011-09-06T14:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138358",
    "user": "https://github.com/rharron"
}
```

<a id='comment:7'></a>Attachment [trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.patch](tarball://root/attachments/some-uuid/ticket11781/trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.patch) by @rharron created at 2011-09-06 14:51:00

Ok, I used the hg_sage functions in sage and the patch now seems to be what it should be. Patch file updated.



---

archive/issue_comments_138359.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-06T14:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138359",
    "user": "https://github.com/rharron"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_138360.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-09T01:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138360",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_138361.json:
```json
{
    "body": "<a id='comment:8'></a>I don't know why the testbot showed failing tests: all tests pass for me locally.\n\nLooks good.  I'm hoping to redo conversion from the residue in a different way later, but in the mean time this approach works.",
    "created_at": "2011-11-09T01:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138361",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>I don't know why the testbot showed failing tests: all tests pass for me locally.

Looks good.  I'm hoping to redo conversion from the residue in a different way later, but in the mean time this approach works.



---

archive/issue_comments_138362.json:
```json
{
    "body": "Attachment [trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch](tarball://root/attachments/some-uuid/ticket11781/trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch) by @jdemeyer created at 2011-11-09 20:37:49\n\nFix duplicate header",
    "created_at": "2011-11-09T20:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138362",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch](tarball://root/attachments/some-uuid/ticket11781/trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch) by @jdemeyer created at 2011-11-09 20:37:49

Fix duplicate header



---

archive/issue_comments_138363.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,8 @@\n Since mpz_cmp_ui returns 0 if equality holds, wrong 'if' condition was being used to check if Zmod element was in the right characteristic. Fix this in padic_ZZ_pX_CR_element.pyx and padic_ZZ_pX_CA_element.pyx.\n \n Also, enhancement: allow conversion from element of the residue_field of self (this really only affects unramified extensions).\n+\n+**Apply** [attachment:trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch]\n \n Comment: 1\n \n```\n",
    "created_at": "2011-11-09T20:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138363",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,8 @@
 Since mpz_cmp_ui returns 0 if equality holds, wrong 'if' condition was being used to check if Zmod element was in the right characteristic. Fix this in padic_ZZ_pX_CR_element.pyx and padic_ZZ_pX_CA_element.pyx.
 
 Also, enhancement: allow conversion from element of the residue_field of self (this really only affects unramified extensions).
+
+**Apply** [attachment:trac_11781_padics_conversion_Zmod_fix_and_res_field_enhance.v2.patch]
 
 Comment: 1
 
```




---

archive/issue_comments_138364.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:7 robharron]:\n> Ok, I used the hg_sage functions in sage and the patch now seems to be what it should be. Patch file updated.\n\n\nFor some reason, your patch had a double header (I don't know what you did wrong).  I removed the first and re-uploaded the patch.",
    "created_at": "2011-11-09T20:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138364",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [comment:7 robharron]:
> Ok, I used the hg_sage functions in sage and the patch now seems to be what it should be. Patch file updated.


For some reason, your patch had a double header (I don't know what you did wrong).  I removed the first and re-uploaded the patch.



---

archive/issue_comments_138365.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-14T17:32:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11781#issuecomment-138365",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_030994.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T17:32:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11781",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11781#event-30994"
}
```
