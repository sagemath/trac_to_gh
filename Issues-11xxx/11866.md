# Issue 11866: zshell prompt

archive/issues_011694.json:
```json
{
    "assignees": [],
    "body": "This sucks:\n\n```\nmalb@road:~ $ env | grep \"SHELL=\"                                                                                                                                \nSHELL=/bin/zsh\nmalb@road:~ $ sage -sh\n...\n\nBypassing shell configuration files ...\n\nSAGE_ROOT=/home/malb/Sage/current\\n(sage subshell) \\h:\\W \\u$ \n```\n\ni.e., the prompt is all wrong, compared to:\n\n```\nmalb@road:/opt/sage-4.7.2.alpha3-prerelease/local/bin $ /opt/sage-4.7.2.alpha3-prerelease/sage -sh\n\nStarting subshell with Sage environment variables set.\nBe sure to exit when you are done and do not do anything\nwith other copies of Sage!\n\nBypassing shell configuration files ...\n\nSAGE_ROOT=/opt/sage-4.7.2.alpha3-prerelease\n(sage subshell) road:/opt/sage-4.7.2.alpha3-prerelease/local/bin malb$ \n```\n\nThe attached patch fixes this.\n\n**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the scripts repository, not the normal Sage repository.\n\nComponent: **scripts**\n\nAuthor: **Martin Albrecht**\n\nReviewer: **John Palmieri**\n\nMerged: **sage-4.7.2.alpha4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11866_\n\n",
    "closed_at": "2011-10-05T07:47:20Z",
    "created_at": "2011-09-28T19:54:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "zshell prompt",
    "type": "issue",
    "updated_at": "2011-10-05T07:47:20Z",
    "url": "https://github.com/sagemath/sage/issues/11866",
    "user": "https://github.com/malb"
}
```
This sucks:

```
malb@road:~ $ env | grep "SHELL="                                                                                                                                
SHELL=/bin/zsh
malb@road:~ $ sage -sh
...

Bypassing shell configuration files ...

SAGE_ROOT=/home/malb/Sage/current\n(sage subshell) \h:\W \u$ 
```

i.e., the prompt is all wrong, compared to:

```
malb@road:/opt/sage-4.7.2.alpha3-prerelease/local/bin $ /opt/sage-4.7.2.alpha3-prerelease/sage -sh

Starting subshell with Sage environment variables set.
Be sure to exit when you are done and do not do anything
with other copies of Sage!

Bypassing shell configuration files ...

SAGE_ROOT=/opt/sage-4.7.2.alpha3-prerelease
(sage subshell) road:/opt/sage-4.7.2.alpha3-prerelease/local/bin malb$ 
```

The attached patch fixes this.

**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the scripts repository, not the normal Sage repository.

Component: **scripts**

Author: **Martin Albrecht**

Reviewer: **John Palmieri**

Merged: **sage-4.7.2.alpha4**

_Issue created by migration from https://trac.sagemath.org/ticket/11866_





---

archive/issue_events_159802.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T19:54:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159802"
}
```



---

archive/issue_events_159803.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T19:54:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20scripts",
    "label_color": "000080",
    "label_name": "c: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159803"
}
```



---

archive/issue_events_159804.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T19:54:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159804"
}
```



---

archive/issue_events_159805.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T19:54:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159805"
}
```



---

archive/issue_comments_124168.json:
```json
{
    "body": "Attachment: **[trac11866_proper_zsh_prompt.patch.gz](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz)**",
    "created_at": "2011-09-28T19:55:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124168",
    "user": "https://github.com/malb"
}
```

Attachment: **[trac11866_proper_zsh_prompt.patch.gz](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz)**



---

archive/issue_comments_124169.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,3 +25,7 @@\n SAGE_ROOT=/opt/sage-4.7.2.alpha3-prerelease\n (sage subshell) road:/opt/sage-4.7.2.alpha3-prerelease/local/bin malb$ \n ```\n+\n+The attached patch fixes this.\n+\n+**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the root/scripts directory, not the normal Sage repository.\n``````\n",
    "created_at": "2011-09-28T19:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124169",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,3 +25,7 @@
 SAGE_ROOT=/opt/sage-4.7.2.alpha3-prerelease
 (sage subshell) road:/opt/sage-4.7.2.alpha3-prerelease/local/bin malb$ 
 ```
+
+The attached patch fixes this.
+
+**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the root/scripts directory, not the normal Sage repository.
``````




---

archive/issue_events_159806.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T19:57:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159806"
}
```



---

archive/issue_comments_124170.json:
```json
{
    "body": "Author: **Martin Albrecht**",
    "created_at": "2011-09-28T19:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124170",
    "user": "https://github.com/malb"
}
```

Author: **Martin Albrecht**



---

archive/issue_comments_124171.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,4 +28,4 @@\n \n The attached patch fixes this.\n \n-**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the root/scripts directory, not the normal Sage repository.\n+**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the scripts repository, not the normal Sage repository.\n``````\n",
    "created_at": "2011-09-28T20:39:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124171",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,4 +28,4 @@
 
 The attached patch fixes this.
 
-**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the root/scripts directory, not the normal Sage repository.
+**Apply** [attachment: trac11866_proper_zsh_prompt.patch](https://github.com/sagemath/sage/files/ticket11866/trac11866_proper_zsh_prompt.patch.gz) to the scripts repository, not the normal Sage repository.
``````




---

archive/issue_comments_124172.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one.  But if you use zsh, I would be happy to hear your input on #10822.\n\nI think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.\n\n(Note that the \"scripts\" repository and the \"root\" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)",
    "created_at": "2011-09-28T20:39:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124172",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one.  But if you use zsh, I would be happy to hear your input on #10822.

I think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.

(Note that the "scripts" repository and the "root" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)



---

archive/issue_comments_124173.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2011-09-28T20:39:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124173",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_159807.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-09-28T20:39:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159807"
}
```



---

archive/issue_events_159808.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-09-28T20:39:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159808"
}
```



---

archive/issue_events_159809.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-09-28T20:39:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159809"
}
```



---

archive/issue_events_159810.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-09-28T20:39:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159810"
}
```



---

archive/issue_comments_124174.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@jhpalmieri](#comment:2):\n> This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one. \n\nOh, thanks!\n\n> But if you use zsh, I would be happy to hear your input on #10822.\n\nI'll take a look.\n\n> I think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.\n\nThanks!\n\n> (Note that the \"scripts\" repository and the \"root\" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)\n\n\nWhoops, I thought they would have been merged a while ago.",
    "created_at": "2011-09-28T21:25:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124174",
    "user": "https://github.com/malb"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@jhpalmieri](#comment:2):
> This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one. 

Oh, thanks!

> But if you use zsh, I would be happy to hear your input on #10822.

I'll take a look.

> I think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.

Thanks!

> (Note that the "scripts" repository and the "root" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)


Whoops, I thought they would have been merged a while ago.



---

archive/issue_events_159811.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-05T07:47:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159811"
}
```



---

archive/issue_events_159812.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-05T07:47:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11866#event-159812"
}
```



---

archive/issue_comments_124175.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha4**",
    "created_at": "2011-10-05T07:47:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11866#issuecomment-124175",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.2.alpha4**
