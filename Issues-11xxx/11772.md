# Issue 11772: improving error reporting of random_matrix, and bug fixing

archive/issues_011600.json:
```json
{
    "assignees": [],
    "body": "The error message of the call to random_matrix(QQ, 4, 8, rank=5) is quite cryptic.\nIt should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.\n\nA patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.\nThe cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.\n\n**Apply**:\n1.  [attachment: trac_11772.3.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)\n2.  [attachment: trac_11772-reviewer.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-reviewer.patch.gz)\n\n\nAssignee: **@jasongrout, @williamstein**\n\nCC:  @rbeezer\n\nReviewer: **Rob Beezer**\n\nAuthor: **Dmitrii Pasechnik**\n\nMerged: **sage-5.12.beta4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11772_\n\n",
    "closed_at": "2013-08-28T06:51:59Z",
    "created_at": "2011-09-01T16:11:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "improving error reporting of random_matrix, and bug fixing",
    "type": "issue",
    "updated_at": "2013-08-28T06:51:59Z",
    "url": "https://github.com/sagemath/sage/issues/11772",
    "user": "https://github.com/dimpase"
}
```
The error message of the call to random_matrix(QQ, 4, 8, rank=5) is quite cryptic.
It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.

A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.
The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.

**Apply**:
1.  [attachment: trac_11772.3.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)
2.  [attachment: trac_11772-reviewer.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-reviewer.patch.gz)


Assignee: **@jasongrout, @williamstein**

CC:  @rbeezer

Reviewer: **Rob Beezer**

Author: **Dmitrii Pasechnik**

Merged: **sage-5.12.beta4**

_Issue created by migration from https://trac.sagemath.org/ticket/11772_





---

archive/issue_events_144551.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-01T16:11:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144551"
}
```



---

archive/issue_events_144552.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-01T16:11:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144552"
}
```



---

archive/issue_events_144553.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-01T16:11:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144553"
}
```



---

archive/issue_events_144554.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-01T16:11:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144554"
}
```



---

archive/issue_events_144555.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-01T16:33:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144555"
}
```



---

archive/issue_comments_125002.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n The error message of the call to random_matrix(QQ, 4, 8, rank=5) is quite cryptic.\n It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.\n \n-(patch is coming soon)\n+A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.\n``````\n",
    "created_at": "2011-09-01T16:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125002",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
 The error message of the call to random_matrix(QQ, 4, 8, rank=5) is quite cryptic.
 It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.
 
-(patch is coming soon)
+A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.
``````




---

archive/issue_comments_125003.json:
```json
{
    "body": "Attachment: **[trac_11772-v2.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772-v2.patch.gz)**",
    "created_at": "2011-09-02T02:26:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125003",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_11772-v2.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772-v2.patch.gz)**



---

archive/issue_comments_125004.json:
```json
{
    "body": "Attachment: **[trac_11772-doctests.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772-doctests.patch.gz)**",
    "created_at": "2011-09-02T02:26:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125004",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_11772-doctests.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772-doctests.patch.gz)**



---

archive/issue_comments_125005.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,7 @@\n It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.\n \n A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.\n+\n+**Apply**:\n+1.  [attachment: trac_11772-v2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-v2.patch.gz)\n+2.  [attachment: trac_11772-doctests.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-doctests.patch.gz)\n``````\n",
    "created_at": "2011-09-02T02:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125005",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,7 @@
 It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.
 
 A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.
+
+**Apply**:
+1.  [attachment: trac_11772-v2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-v2.patch.gz)
+2.  [attachment: trac_11772-doctests.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-doctests.patch.gz)
``````




---

archive/issue_comments_125006.json:
```json
{
    "body": "Reviewer: **Rob Beezer**",
    "created_at": "2011-09-02T02:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125006",
    "user": "https://github.com/rbeezer"
}
```

Reviewer: **Rob Beezer**



---

archive/issue_comments_125007.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nv2-patch is Dima's original, but with a Trac number in the commit message.\n\nThere was one doctest failure on the subspace routine (the fly), since `None` is an allowed value for the rank, and it seems `None < 0` is `True`.  I moved a hunk of code that checks the `rank=None` case to happen early, and removed a pointless else-clause.\n\nI like doctests that exercise error-conditions, so I added 3 new doctests.  Original patch is a positive review from me, whoever wants to review my patch (Dima?) can flip this whole ticket to positive review if my patch is OK.",
    "created_at": "2011-09-02T02:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125007",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:3" align="right">Comment 3</div>

v2-patch is Dima's original, but with a Trac number in the commit message.

There was one doctest failure on the subspace routine (the fly), since `None` is an allowed value for the rank, and it seems `None < 0` is `True`.  I moved a hunk of code that checks the `rank=None` case to happen early, and removed a pointless else-clause.

I like doctests that exercise error-conditions, so I added 3 new doctests.  Original patch is a positive review from me, whoever wants to review my patch (Dima?) can flip this whole ticket to positive review if my patch is OK.



---

archive/issue_comments_125008.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nthere is at least one more problem with the code in random_echelonizable_matrix\n\n```\nsage: random_matrix( QQ, 3, 3, algorithm='echelonizable', rank=1,\n                          upper_bound=60)\n---------------------------------------------------------------------------\nUnboundLocalError                         Traceback (most recent call last)\n\n/Users/dima/<ipython console> in <module>()\n\n/usr/local/src/sage/current/local/lib/python2.6/site-packages/sage/matrix/constructor.pyc in random_matrix(ring, nrows, ncols, algorithm, *args, **kwds)\n   1250         return random_rref_matrix(parent, *args, **kwds)\n   1251     elif algorithm == 'echelonizable':\n-> 1252         return random_echelonizable_matrix(parent, *args, **kwds)\n   1253     elif algorithm == 'diagonalizable':\n   1254         return random_diagonalizable_matrix(parent, *args, **kwds)\n\n/usr/local/src/sage/current/local/lib/python2.6/site-packages/sage/matrix/constructor.pyc in random_echelonizable_matrix(parent, rank, upper_bound)\n   2995                         matrix_copy=matrix.with_added_multiple_of_row(row_index,matrix.pivot_rows()[pivots],randint(-5,5))\n   2996                         # Range for scalar multiples determined experimentally.\n-> 2997                     if max(map(abs,matrix_copy.list()))<upper_bound:\n   2998                     # Continue if the the largest entry after a row operation is within the bound.\n   2999                         matrix=matrix_copy\n\nUnboundLocalError: local variable 'matrix_copy' referenced before assignment\nsage: \n```",
    "created_at": "2011-09-02T03:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125008",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">Comment 4</div>

there is at least one more problem with the code in random_echelonizable_matrix

```
sage: random_matrix( QQ, 3, 3, algorithm='echelonizable', rank=1,
                          upper_bound=60)
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)

/Users/dima/<ipython console> in <module>()

/usr/local/src/sage/current/local/lib/python2.6/site-packages/sage/matrix/constructor.pyc in random_matrix(ring, nrows, ncols, algorithm, *args, **kwds)
   1250         return random_rref_matrix(parent, *args, **kwds)
   1251     elif algorithm == 'echelonizable':
-> 1252         return random_echelonizable_matrix(parent, *args, **kwds)
   1253     elif algorithm == 'diagonalizable':
   1254         return random_diagonalizable_matrix(parent, *args, **kwds)

/usr/local/src/sage/current/local/lib/python2.6/site-packages/sage/matrix/constructor.pyc in random_echelonizable_matrix(parent, rank, upper_bound)
   2995                         matrix_copy=matrix.with_added_multiple_of_row(row_index,matrix.pivot_rows()[pivots],randint(-5,5))
   2996                         # Range for scalar multiples determined experimentally.
-> 2997                     if max(map(abs,matrix_copy.list()))<upper_bound:
   2998                     # Continue if the the largest entry after a row operation is within the bound.
   2999                         matrix=matrix_copy

UnboundLocalError: local variable 'matrix_copy' referenced before assignment
sage: 
```



---

archive/issue_events_144556.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-02T03:14:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144556"
}
```



---

archive/issue_events_144557.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-02T03:14:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144557"
}
```



---

archive/issue_events_144558.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-02T03:14:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144558"
}
```



---

archive/issue_events_144559.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-02T03:14:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144559"
}
```



---

archive/issue_comments_125009.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@dimpase](#comment%3A4):\n> there is at least one more problem with the code in random_echelonizable_matrix\n\nI've used the function *all the time* the past year, so that is indeed a surprise.  Looks like it is just the `rank=1` case, based on very limited testing.\n\nHow would you like to proceed?",
    "created_at": "2011-09-02T03:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125009",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@dimpase](#comment%3A4):
> there is at least one more problem with the code in random_echelonizable_matrix

I've used the function *all the time* the past year, so that is indeed a surprise.  Looks like it is just the `rank=1` case, based on very limited testing.

How would you like to proceed?



---

archive/issue_comments_125010.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@rbeezer](#comment%3A6):\n> Replying to [@dimpase](#comment%3A4):\n> > there is at least one more problem with the code in random_echelonizable_matrix\n\n> \n> I've used the function *all the time* the past year, so that is indeed a surprise.  Looks like it is just the `rank=1` case, based on very limited testing.\n> \n> How would you like to proceed?\n\nthe function in question has in general quite suspiciously looking code: e.g. it has\n\n```\nif upper_bound==None:\n            upper_bound=50\n            size=False\n```\nbut then, when `size==False`, `upper_bound` is not used; that whole `size` thing can (and should, in a clearly written code) be replaced by if-else...\n\nMy understanding of the code is that it first gets `matrix` of specified `rank`, and then uses it to create the\nresult, of the same `rank`, but taking random vectors of the row space of `matrix`.\nWIth the `upper_bound` set (and `size==True`, I don't even see how it always succeeds to terminate!\nIf I set `upper_bound=4`, I run into cases that look non-terminating. E.g. try running\n\n```\n for i in range(100):\n    rk=randint(2,13)\n    print rk,i\n    m = random_matrix( QQ, 13, 13, algorithm='echelonizable', rank=rk,   upper_bound=4)\n```\nI bet it will never finish, or at least I usually see it printing only 1 row of output, and then basically going into\nan infinite loop. It seems that `matrix` itself should have well-controlled absolute values of entries, to begin with, \nbut it's not done.\n\nI'd say this has either to be re-done, or scrapped...",
    "created_at": "2011-09-02T05:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125010",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@rbeezer](#comment%3A6):
> Replying to [@dimpase](#comment%3A4):
> > there is at least one more problem with the code in random_echelonizable_matrix

> 
> I've used the function *all the time* the past year, so that is indeed a surprise.  Looks like it is just the `rank=1` case, based on very limited testing.
> 
> How would you like to proceed?

the function in question has in general quite suspiciously looking code: e.g. it has

```
if upper_bound==None:
            upper_bound=50
            size=False
```
but then, when `size==False`, `upper_bound` is not used; that whole `size` thing can (and should, in a clearly written code) be replaced by if-else...

My understanding of the code is that it first gets `matrix` of specified `rank`, and then uses it to create the
result, of the same `rank`, but taking random vectors of the row space of `matrix`.
WIth the `upper_bound` set (and `size==True`, I don't even see how it always succeeds to terminate!
If I set `upper_bound=4`, I run into cases that look non-terminating. E.g. try running

```
 for i in range(100):
    rk=randint(2,13)
    print rk,i
    m = random_matrix( QQ, 13, 13, algorithm='echelonizable', rank=rk,   upper_bound=4)
```
I bet it will never finish, or at least I usually see it printing only 1 row of output, and then basically going into
an infinite loop. It seems that `matrix` itself should have well-controlled absolute values of entries, to begin with, 
but it's not done.

I'd say this has either to be re-done, or scrapped...



---

archive/issue_comments_125011.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nReplying to [@dimpase](#comment%3A7):\n> I'd say this has either to be re-done, or scrapped...\n\nand there are sound mathematical reasons behind this, too. E.g. if you ask for a random rank k matrix of size kxn, with small entries, this already means that you need to sample in a hypercube, and I leave it for people with better working knowledge of this range of problems to figure out how to go about it.\nFor instance, if you impose upper_bound=1, you have just 3^n choices of vectors, and I don't know which proportion of k-subsets of such vectors will correspond to linearly independent ones, nor what uniformly(?) random such a subset should be...\n\nThe current code is just a dirty hack, and it should at least have a limit on the number of tries done before giving up!",
    "created_at": "2011-09-02T06:11:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125011",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">Comment 8</div>

Replying to [@dimpase](#comment%3A7):
> I'd say this has either to be re-done, or scrapped...

and there are sound mathematical reasons behind this, too. E.g. if you ask for a random rank k matrix of size kxn, with small entries, this already means that you need to sample in a hypercube, and I leave it for people with better working knowledge of this range of problems to figure out how to go about it.
For instance, if you impose upper_bound=1, you have just 3^n choices of vectors, and I don't know which proportion of k-subsets of such vectors will correspond to linearly independent ones, nor what uniformly(?) random such a subset should be...

The current code is just a dirty hack, and it should at least have a limit on the number of tries done before giving up!



---

archive/issue_comments_125012.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nReplying to [@dimpase](#comment%3A7):\n\nI agree with your reservations - this routine should have some safeguards and could probably be cleaned-up quite a bit.  I also find it very useful, even as is.  It can sometimes take a second or two to finish, but with reasonable inputs, it seems to always finish, and produce useful output.\n\nIf you ask for `upper_bound=1`, then I think you get what you deserve.  ;-)\n\n> I'd say this has either to be re-done, or scrapped...\n\nSo I would definitely like to see this feature kept - in other words, I would like to see the interface stay stable, with changes to the code.  I'd be happy with throwing an exception after some number of attempts.\n\nI'm taking a break from most Sage work for a few weeks to get caught up on other things, so won't be able to address this immediately.\n\nRob",
    "created_at": "2011-09-03T02:43:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125012",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:9" align="right">Comment 9</div>

Replying to [@dimpase](#comment%3A7):

I agree with your reservations - this routine should have some safeguards and could probably be cleaned-up quite a bit.  I also find it very useful, even as is.  It can sometimes take a second or two to finish, but with reasonable inputs, it seems to always finish, and produce useful output.

If you ask for `upper_bound=1`, then I think you get what you deserve.  ;-)

> I'd say this has either to be re-done, or scrapped...

So I would definitely like to see this feature kept - in other words, I would like to see the interface stay stable, with changes to the code.  I'd be happy with throwing an exception after some number of attempts.

I'm taking a break from most Sage work for a few weeks to get caught up on other things, so won't be able to address this immediately.

Rob



---

archive/issue_comments_125013.json:
```json
{
    "body": "cumulative for -v2, -doctests, and more changes",
    "created_at": "2011-09-04T14:52:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125013",
    "user": "https://github.com/dimpase"
}
```

cumulative for -v2, -doctests, and more changes



---

archive/issue_comments_125014.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,8 @@\n It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.\n \n A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.\n+The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.\n \n **Apply**:\n-1.  [attachment: trac_11772-v2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-v2.patch.gz)\n-2.  [attachment: trac_11772-doctests.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-doctests.patch.gz)\n+1.  [attachment: trac_11772.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.patch.gz)\n+\n``````\n",
    "created_at": "2011-09-04T14:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125014",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,8 @@
 It should be easy to check that the rank is greater than min(nrows,ncols) and throw a ValueError with a meaningful message.
 
 A patch, which also fixes a similar small fly in random_subspaces_matrix, is attached.
+The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.
 
 **Apply**:
-1.  [attachment: trac_11772-v2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-v2.patch.gz)
-2.  [attachment: trac_11772-doctests.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-doctests.patch.gz)
+1.  [attachment: trac_11772.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.patch.gz)
+
``````




---

archive/issue_comments_125015.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nAttachment: **[trac_11772.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772.patch.gz)**",
    "created_at": "2011-09-04T14:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125015",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">Comment 10</div>

Attachment: **[trac_11772.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772.patch.gz)**



---

archive/issue_events_144560.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-04T14:56:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144560"
}
```



---

archive/issue_events_144561.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-04T14:56:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144561"
}
```



---

archive/issue_events_144562.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-09-04T14:56:05Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "title_is": "improving error reporting of random_matrix, and bug fixing",
    "title_was": "improving error reporting of random_matrix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144562"
}
```



---

archive/issue_comments_125016.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@rbeezer](#comment%3A9):\n> Replying to [@dimpase](#comment%3A7):\n> \n> I agree with your reservations - this routine should have some safeguards and could probably be cleaned-up quite a bit.  I also find it very useful, even as is.  It can sometimes take a second or two to finish, but with reasonable inputs, it seems to always finish, and produce useful output.\n> \n> If you ask for `upper_bound=1`, then I think you get what you deserve.  ;-)\n\nour servers don't deserve being trashed by 120 undergrads, running never ending loops, executing seemingly innocent Sage commands. :)\n\n> \n> > I'd say this has either to be re-done, or scrapped...\n\n> \n> So I would definitely like to see this feature kept - in other words, I would like to see the interface stay stable, with changes to the code.  I'd be happy with throwing an exception after some number of attempts.\n> \n> I'm taking a break from most Sage work for a few weeks to get caught up on other things, so won't be able to address this immediately.\n> \n\nI've bitten the bullet and hopefully fixed all the shortcomings we discussed, added throwing exceptions, etc. Please review soon. :-)\n\n> Rob\n\n>",
    "created_at": "2011-09-04T15:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125016",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@rbeezer](#comment%3A9):
> Replying to [@dimpase](#comment%3A7):
> 
> I agree with your reservations - this routine should have some safeguards and could probably be cleaned-up quite a bit.  I also find it very useful, even as is.  It can sometimes take a second or two to finish, but with reasonable inputs, it seems to always finish, and produce useful output.
> 
> If you ask for `upper_bound=1`, then I think you get what you deserve.  ;-)

our servers don't deserve being trashed by 120 undergrads, running never ending loops, executing seemingly innocent Sage commands. :)

> 
> > I'd say this has either to be re-done, or scrapped...

> 
> So I would definitely like to see this feature kept - in other words, I would like to see the interface stay stable, with changes to the code.  I'd be happy with throwing an exception after some number of attempts.
> 
> I'm taking a break from most Sage work for a few weeks to get caught up on other things, so won't be able to address this immediately.
> 

I've bitten the bullet and hopefully fixed all the shortcomings we discussed, added throwing exceptions, etc. Please review soon. :-)

> Rob

>



---

archive/issue_comments_125017.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@dimpase](#comment%3A11):\n> I've bitten the bullet and hopefully fixed all the shortcomings we discussed, added throwing exceptions, etc. Please review soon. :-)\n\nDima - thanks for biting the bullet!  Long weekend here in the US, and I'm offline for a couple days, but I will get at this very soon.  First-look looks good.\n\nRob",
    "created_at": "2011-09-04T15:13:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125017",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@dimpase](#comment%3A11):
> I've bitten the bullet and hopefully fixed all the shortcomings we discussed, added throwing exceptions, etc. Please review soon. :-)

Dima - thanks for biting the bullet!  Long weekend here in the US, and I'm offline for a couple days, but I will get at this very soon.  First-look looks good.

Rob



---

archive/issue_comments_125018.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nApply trac_11772.patch\n\n(for the patchbot). Any movement on this one?",
    "created_at": "2012-03-11T11:36:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125018",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:13" align="right">Comment 13</div>

Apply trac_11772.patch

(for the patchbot). Any movement on this one?



---

archive/issue_comments_125019.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@loefflerd](#comment%3A13):\n> Apply trac_11772.patch\n> \n> (for the patchbot). Any movement on this one?\n\nIMHO the ball is in Rob's court. Rob?",
    "created_at": "2012-03-11T12:11:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125019",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@loefflerd](#comment%3A13):
> Apply trac_11772.patch
> 
> (for the patchbot). Any movement on this one?

IMHO the ball is in Rob's court. Rob?



---

archive/issue_events_144563.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-11T14:27:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144563"
}
```



---

archive/issue_events_144564.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-11T14:27:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144564"
}
```



---

archive/issue_comments_125020.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nAccording to the patchbot, the patch does not apply under either current release (4.8) or current dev (5.0.beta7).",
    "created_at": "2012-03-11T14:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125020",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:15" align="right">Comment 15</div>

According to the patchbot, the patch does not apply under either current release (4.8) or current dev (5.0.beta7).



---

archive/issue_comments_125021.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@dimpase](#comment%3A14):\n> IMHO the ball is in Rob's court. Rob?\n\nYes, ball is in my court.  So are lots of other balls.  ;-)\n\nI have not forgotten this one, but for months now have not been in a position to get too into Sage work.  I use this routine all the time, and it never fails me.  That is not an excuse, it should be fixed as Dima has noticed, but it has not been a high-priority item for me.\n\nDavid - thanks for bumping some tickets - I see I have another one to address with Sequence and I think Jeroen bumped another one on some RDF/CDF stuff a few weeks ago.\n\nRob",
    "created_at": "2012-03-11T16:58:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125021",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@dimpase](#comment%3A14):
> IMHO the ball is in Rob's court. Rob?

Yes, ball is in my court.  So are lots of other balls.  ;-)

I have not forgotten this one, but for months now have not been in a position to get too into Sage work.  I use this routine all the time, and it never fails me.  That is not an excuse, it should be fixed as Dima has noticed, but it has not been a high-priority item for me.

David - thanks for bumping some tickets - I see I have another one to address with Sequence and I think Jeroen bumped another one on some RDF/CDF stuff a few weeks ago.

Rob



---

archive/issue_comments_125022.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@rbeezer](#comment%3A16):\n> Replying to [@dimpase](#comment%3A14):\n> > IMHO the ball is in Rob's court. Rob?\n\n> \n> Yes, ball is in my court.  So are lots of other balls.  ;-)\n> \n> I have not forgotten this one, but for months now have not been in a position to get too into Sage work.  I use this routine all the time, and it never fails me.  That is not an excuse, it should be fixed as Dima has noticed, but it has not been a high-priority item for me.\n> \n\nI'll ask a student to rebase. I have negative amount of time available, it seems :)",
    "created_at": "2012-03-11T17:02:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125022",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@rbeezer](#comment%3A16):
> Replying to [@dimpase](#comment%3A14):
> > IMHO the ball is in Rob's court. Rob?

> 
> Yes, ball is in my court.  So are lots of other balls.  ;-)
> 
> I have not forgotten this one, but for months now have not been in a position to get too into Sage work.  I use this routine all the time, and it never fails me.  That is not an excuse, it should be fixed as Dima has noticed, but it has not been a high-priority item for me.
> 

I'll ask a student to rebase. I have negative amount of time available, it seems :)



---

archive/issue_comments_125023.json:
```json
{
    "body": "This patch needs work",
    "created_at": "2012-03-12T03:40:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125023",
    "user": "https://github.com/kini"
}
```

This patch needs work



---

archive/issue_comments_125024.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,5 +5,5 @@\n The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.\n \n **Apply**:\n-1.  [attachment: trac_11772.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.patch.gz)\n+1.  [attachment: trac_11772.2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.2.patch.gz)\n \n``````\n",
    "created_at": "2012-03-12T03:43:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125024",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,5 +5,5 @@
 The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.
 
 **Apply**:
-1.  [attachment: trac_11772.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.patch.gz)
+1.  [attachment: trac_11772.2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.2.patch.gz)
 
``````




---

archive/issue_comments_125025.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nAttachment: **[trac_11772.2.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772.2.patch.gz)**\n\nI couldn't find any revision onto which the patch actually applied, so I tried to rebase it manually. Please check for errors.\n\nAlso, Dima, please remove your print statements and commented out lines... the patch also needs some work in the PEP-8 department, but then again the whole file does, it looks like. I fixed what I could in the function Rob touched.",
    "created_at": "2012-03-12T03:43:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125025",
    "user": "https://github.com/kini"
}
```

<div id="comment:18" align="right">Comment 18</div>

Attachment: **[trac_11772.2.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772.2.patch.gz)**

I couldn't find any revision onto which the patch actually applied, so I tried to rebase it manually. Please check for errors.

Also, Dima, please remove your print statements and commented out lines... the patch also needs some work in the PEP-8 department, but then again the whole file does, it looks like. I fixed what I could in the function Rob touched.



---

archive/issue_events_144565.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144565"
}
```



---

archive/issue_events_144566.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144566"
}
```



---

archive/issue_comments_125026.json:
```json
{
    "body": "Attachment: **[trac_11772.3.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)**\n\nRebase on 5.11",
    "created_at": "2013-08-21T22:02:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125026",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_11772.3.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)**

Rebase on 5.11



---

archive/issue_comments_125027.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nI've made a trivial rebase for Sage 5.11 of the \".2\" consolidated patch, now named \".3\".\n\nI put Dima's name on it, since all of the significant code contributions are his.  \n\nI am working on a review and will definitely add a reviewer patch.",
    "created_at": "2013-08-21T22:04:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125027",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:20" align="right">Comment 20</div>

I've made a trivial rebase for Sage 5.11 of the ".2" consolidated patch, now named ".3".

I put Dima's name on it, since all of the significant code contributions are his.  

I am working on a review and will definitely add a reviewer patch.



---

archive/issue_comments_125028.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,5 +5,5 @@\n The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.\n \n **Apply**:\n-1.  [attachment: trac_11772.2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.2.patch.gz)\n+1.  [attachment: trac_11772.3.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)\n \n``````\n",
    "created_at": "2013-08-21T22:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125028",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,5 +5,5 @@
 The cumulative patch incorporates more doctests, the fix for rank==1 problem described in the comments, and puts a cup on the number of iterations in various while loops, so that they fail meaningfully.
 
 **Apply**:
-1.  [attachment: trac_11772.2.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.2.patch.gz)
+1.  [attachment: trac_11772.3.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)
 
``````




---

archive/issue_comments_125029.json:
```json
{
    "body": "Attachment: **[trac_11772-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772-reviewer.patch.gz)**\n\nApply on top of \".3\" patch",
    "created_at": "2013-08-21T23:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125029",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_11772-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket11772/trac_11772-reviewer.patch.gz)**

Apply on top of ".3" patch



---

archive/issue_events_144567.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2013-08-21T23:26:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144567"
}
```



---

archive/issue_events_144568.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2013-08-21T23:26:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144568"
}
```



---

archive/issue_comments_125030.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,5 @@\n \n **Apply**:\n 1.  [attachment: trac_11772.3.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)\n+2.  [attachment: trac_11772-reviewer.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-reviewer.patch.gz)\n \n``````\n",
    "created_at": "2013-08-21T23:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125030",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,5 @@
 
 **Apply**:
 1.  [attachment: trac_11772.3.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772.3.patch.gz)
+2.  [attachment: trac_11772-reviewer.patch](https://github.com/sagemath/sage/files/ticket11772/trac_11772-reviewer.patch.gz)
 
``````




---

archive/issue_comments_125031.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReviewer patch:\n\n1.  Removed debugging print statements.\n2.  Code for sanity tests on inputs from the very first \"v2\" patch were missing, so the corresponding doctests were failing.  Code has been restored, doctests function properly now.\n3.  Passed `max_tries` through the unimodular routine, since it has an `upper_bound` keyword.\n\nWeBWorK homework system can now query the Sage cell server.  The `random_matrix()` function is very appealing, but it absolutely must return every time or some poor undergrad will just get a system hang rather than a homework exercise.  So I have added three prominent warnings about requesting upper bounds.\n\nI need to fix the randomness in these functions, see #10122.  GSL is to blame, and I have a working fix.  Then the doctests will need a total overhaul, so I'm tempted to do some other things here (document `max_tries`) but want that to wait.\n\nI'm fine with Dima's code contributions.\n\nDima - I apologize for sitting on this for such a very long time.  If you like my changes/contributions, would you flip this to positive review?  If so, then I will build more onto it on other tickets.\n\nRob",
    "created_at": "2013-08-21T23:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125031",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:22" align="right">Comment 22</div>

Reviewer patch:

1.  Removed debugging print statements.
2.  Code for sanity tests on inputs from the very first "v2" patch were missing, so the corresponding doctests were failing.  Code has been restored, doctests function properly now.
3.  Passed `max_tries` through the unimodular routine, since it has an `upper_bound` keyword.

WeBWorK homework system can now query the Sage cell server.  The `random_matrix()` function is very appealing, but it absolutely must return every time or some poor undergrad will just get a system hang rather than a homework exercise.  So I have added three prominent warnings about requesting upper bounds.

I need to fix the randomness in these functions, see #10122.  GSL is to blame, and I have a working fix.  Then the doctests will need a total overhaul, so I'm tempted to do some other things here (document `max_tries`) but want that to wait.

I'm fine with Dima's code contributions.

Dima - I apologize for sitting on this for such a very long time.  If you like my changes/contributions, would you flip this to positive review?  If so, then I will build more onto it on other tickets.

Rob



---

archive/issue_comments_125032.json:
```json
{
    "body": "Author: **Dmitrii Pasechnik**",
    "created_at": "2013-08-21T23:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125032",
    "user": "https://github.com/rbeezer"
}
```

Author: **Dmitrii Pasechnik**



---

archive/issue_events_144569.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-08-22T04:02:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144569"
}
```



---

archive/issue_events_144570.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-08-22T04:02:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144570"
}
```



---

archive/issue_comments_125033.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nThanks, Dima!  You are much more conscientious than me.  ;-)\n\nI'll try to get my GSL-random-seed patch up sometime tomorrow night.  Busy all day tomorrow.\n\nRob",
    "created_at": "2013-08-22T05:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125033",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:24" align="right">Comment 24</div>

Thanks, Dima!  You are much more conscientious than me.  ;-)

I'll try to get my GSL-random-seed patch up sometime tomorrow night.  Busy all day tomorrow.

Rob



---

archive/issue_comments_125034.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nReplying to [@rbeezer](#comment%3A24):\n> Thanks, Dima!  You are much more conscientious than me.  ;-)\n\nno, if you ask me to referee a paper, I might sit on it for a year easily...\n\nGood that this patch didn't bitrot completely :\u2013)\n\nDima",
    "created_at": "2013-08-22T06:00:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125034",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">Comment 25</div>

Replying to [@rbeezer](#comment%3A24):
> Thanks, Dima!  You are much more conscientious than me.  ;-)

no, if you ask me to referee a paper, I might sit on it for a year easily...

Good that this patch didn't bitrot completely :–)

Dima



---

archive/issue_events_144571.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-28T06:51:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144571"
}
```



---

archive/issue_events_144572.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-28T06:51:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11772#event-144572"
}
```



---

archive/issue_comments_125035.json:
```json
{
    "body": "Merged: **sage-5.12.beta4**",
    "created_at": "2013-08-28T06:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11772#issuecomment-125035",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta4**
