# Issue 11851: make pybtex an optional spkg

archive/issues_011679.json:
```json
{
    "body": "See [http://pybtex.sourceforge.net/](http://pybtex.sourceforge.net/) for a description.\n\n\nShould be a standard spkg later, so that the [citation system](http://trac.sagemath.org/sage_trac/ticket/3317) can use it.\n\n---\n\nApply [attachment:trac_11851-hgignore.patch] to the scripts repo.\n\nNew optional spkg: [http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1](http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1)\n\n**Assignee:** tbd\n\n**CC:**  polybori @burcin\n\n**Keywords:** BibTeX citations\n\n**Reviewer:** John Palmieri\n\n**Author:** Niels Ranosch, Burcin Erocal\n\n**Merged:** sage-5.2.beta0\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/11851\n\n",
    "closed_at": "2012-07-02T13:00:21Z",
    "created_at": "2011-09-26T14:43:05Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.2",
    "title": "make pybtex an optional spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11851",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```
See [http://pybtex.sourceforge.net/](http://pybtex.sourceforge.net/) for a description.


Should be a standard spkg later, so that the [citation system](http://trac.sagemath.org/sage_trac/ticket/3317) can use it.

---

Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.

New optional spkg: [http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1](http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1)

**Assignee:** tbd

**CC:**  polybori @burcin

**Keywords:** BibTeX citations

**Reviewer:** John Palmieri

**Author:** Niels Ranosch, Burcin Erocal

**Merged:** sage-5.2.beta0

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/11851





---

archive/issue_comments_167353.json:
```json
{
    "body": "<a id='comment:1'></a>\nWhen I install the spkg on a Mac OS X box, I see this\n\n```\nProcessing PyYAML-3.10.zip\nRunning PyYAML-3.10/setup.py -q bdist_egg --dist-dir /var/folders/JV/JVYCpshdHd4FFoThuUgD8k+++TI/-Tmp-/easy_install-e_csNv/PyYAML-3.10/egg-dist-tmp-KAUGDh\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:2:18: error: yaml.h: No such file or directory\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c: In function \u2018main\u2019:\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: \u2018yaml_parser_t\u2019 undeclared (first use in this function)\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: (Each undeclared identifier is reported only once\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: for each function it appears in.)\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: expected \u2018;\u2019 before \u2018parser\u2019\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: \u2018yaml_emitter_t\u2019 undeclared (first use in this function)\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: expected \u2018;\u2019 before \u2018emitter\u2019\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: warning: implicit declaration of function \u2018yaml_parser_initialize\u2019\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: error: \u2018parser\u2019 undeclared (first use in this function)\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:9: warning: implicit declaration of function \u2018yaml_parser_delete\u2019\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: warning: implicit declaration of function \u2018yaml_emitter_initialize\u2019\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: error: \u2018emitter\u2019 undeclared (first use in this function)\nbuild/temp.macosx-10.6-i386-2.6/check_libyaml.c:12: warning: implicit declaration of function \u2018yaml_emitter_delete\u2019\n\nlibyaml is not found or a compiler error: forcing --without-libyaml\n(if libyaml is installed correctly, you may need to\n specify the option --include-dirs or uncomment and\n modify the parameter include_dirs in setup.cfg)\nzip_safe flag not set; analyzing archive contents...\nAdding PyYAML 3.10 to easy-install.pth file\n```\nAre these errors important?  The installation proceeds, apparently successfully, after this.\n\nSecond, would it be better to have three separate spkgs, one each for pybtex, PyYAML, and pyparsing?\n\nThird, should the file `patches/pybtex-doc_tree.patch.org` be deleted?  I see a reference to it in SPKG.txt, but why do we need it?  It might be better just to give the link to the original patch and then say that it has been rebased.  Rebasing is the only change, right?",
    "created_at": "2011-09-26T15:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167353",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
When I install the spkg on a Mac OS X box, I see this

```
Processing PyYAML-3.10.zip
Running PyYAML-3.10/setup.py -q bdist_egg --dist-dir /var/folders/JV/JVYCpshdHd4FFoThuUgD8k+++TI/-Tmp-/easy_install-e_csNv/PyYAML-3.10/egg-dist-tmp-KAUGDh
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:2:18: error: yaml.h: No such file or directory
build/temp.macosx-10.6-i386-2.6/check_libyaml.c: In function ‘main’:
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: ‘yaml_parser_t’ undeclared (first use in this function)
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: (Each undeclared identifier is reported only once
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: for each function it appears in.)
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: expected ‘;’ before ‘parser’
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: ‘yaml_emitter_t’ undeclared (first use in this function)
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: expected ‘;’ before ‘emitter’
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: warning: implicit declaration of function ‘yaml_parser_initialize’
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: error: ‘parser’ undeclared (first use in this function)
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:9: warning: implicit declaration of function ‘yaml_parser_delete’
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: warning: implicit declaration of function ‘yaml_emitter_initialize’
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: error: ‘emitter’ undeclared (first use in this function)
build/temp.macosx-10.6-i386-2.6/check_libyaml.c:12: warning: implicit declaration of function ‘yaml_emitter_delete’

libyaml is not found or a compiler error: forcing --without-libyaml
(if libyaml is installed correctly, you may need to
 specify the option --include-dirs or uncomment and
 modify the parameter include_dirs in setup.cfg)
zip_safe flag not set; analyzing archive contents...
Adding PyYAML 3.10 to easy-install.pth file
```
Are these errors important?  The installation proceeds, apparently successfully, after this.

Second, would it be better to have three separate spkgs, one each for pybtex, PyYAML, and pyparsing?

Third, should the file `patches/pybtex-doc_tree.patch.org` be deleted?  I see a reference to it in SPKG.txt, but why do we need it?  It might be better just to give the link to the original patch and then say that it has been rebased.  Rebasing is the only change, right?



---

archive/issue_comments_167354.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n-[http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg)\n+See [http://pybtex.sourceforge.net/](http://pybtex.sourceforge.net/) for a description.\n+\n \n Should be a standard spkg later, so that the [citation system](http://trac.sagemath.org/sage_trac/ticket/3317) can use it.\n+\n+---\n+\n+New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg)\n+\n``````\n",
    "created_at": "2011-09-26T15:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167354",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
-[http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg)
+See [http://pybtex.sourceforge.net/](http://pybtex.sourceforge.net/) for a description.
+
 
 Should be a standard spkg later, so that the [citation system](http://trac.sagemath.org/sage_trac/ticket/3317) can use it.
+
+---
+
+New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg)
+
``````




---

archive/issue_comments_167355.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-09-26T15:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167355",
    "user": "https://github.com/nexttime"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_036908.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "label": "component: optional packages",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11851#event-36908"
}
```



---

archive/issue_comments_167356.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"BibTeX citations\".",
    "created_at": "2011-09-26T15:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167356",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "" to "BibTeX citations".



---

archive/issue_comments_167357.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks for looking into this!\n\nReplying to [jhpalmieri](#comment%3A1):\n> When I install the spkg on a Mac OS X box, I see this\n> \n> ```\n> Processing PyYAML-3.10.zip\n> Running PyYAML-3.10/setup.py -q bdist_egg --dist-dir /var/folders/JV/JVYCpshdHd4FFoThuUgD8k+++TI/-Tmp-/easy_install-e_csNv/PyYAML-3.10/egg-dist-tmp-KAUGDh\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:2:18: error: yaml.h: No such file or directory\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c: In function \u2018main\u2019:\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: \u2018yaml_parser_t\u2019 undeclared (first use in this function)\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: (Each undeclared identifier is reported only once\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: for each function it appears in.)\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: expected \u2018;\u2019 before \u2018parser\u2019\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: \u2018yaml_emitter_t\u2019 undeclared (first use in this function)\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: expected \u2018;\u2019 before \u2018emitter\u2019\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: warning: implicit declaration of function \u2018yaml_parser_initialize\u2019\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: error: \u2018parser\u2019 undeclared (first use in this function)\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:9: warning: implicit declaration of function \u2018yaml_parser_delete\u2019\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: warning: implicit declaration of function \u2018yaml_emitter_initialize\u2019\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: error: \u2018emitter\u2019 undeclared (first use in this function)\n> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:12: warning: implicit declaration of function \u2018yaml_emitter_delete\u2019\n> \n> libyaml is not found or a compiler error: forcing --without-libyaml\n> (if libyaml is installed correctly, you may need to\n>  specify the option --include-dirs or uncomment and\n>  modify the parameter include_dirs in setup.cfg)\n> zip_safe flag not set; analyzing archive contents...\n> Adding PyYAML 3.10 to easy-install.pth file\n> ```\n> Are these errors important?  The installation proceeds, apparently successfully, after this.\n\n\nPyYAML Supports libYAML for speed reasons only, so you can ignore these messages. But I removed libYAML support from the SPKG (I will update the link soon), so that nobody gets confused.\n\n> \n> Second, would it be better to have three separate spkgs, one each for pybtex, PyYAML, and pyparsing?\n\n\nsagenb also includes its dependencies. It would be too much trouble to maintain three different SPKGs.\n\n> \n> Third, should the file `patches/pybtex-doc_tree.patch.org` be deleted?  I see a reference to it in SPKG.txt, but why do we need it?  It might be better just to give the link to the original patch and then say that it has been rebased.  Rebasing is the only change, right?\n\n\nWe don't know, if the link will change or will be unavailable some day. Burcin thought, it would probably be safer like this.",
    "created_at": "2011-09-27T15:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167357",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:3'></a>
Thanks for looking into this!

Replying to [jhpalmieri](#comment%3A1):
> When I install the spkg on a Mac OS X box, I see this
> 
> ```
> Processing PyYAML-3.10.zip
> Running PyYAML-3.10/setup.py -q bdist_egg --dist-dir /var/folders/JV/JVYCpshdHd4FFoThuUgD8k+++TI/-Tmp-/easy_install-e_csNv/PyYAML-3.10/egg-dist-tmp-KAUGDh
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:2:18: error: yaml.h: No such file or directory
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c: In function ‘main’:
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: ‘yaml_parser_t’ undeclared (first use in this function)
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: (Each undeclared identifier is reported only once
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: for each function it appears in.)
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:5: error: expected ‘;’ before ‘parser’
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: ‘yaml_emitter_t’ undeclared (first use in this function)
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:6: error: expected ‘;’ before ‘emitter’
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: warning: implicit declaration of function ‘yaml_parser_initialize’
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:8: error: ‘parser’ undeclared (first use in this function)
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:9: warning: implicit declaration of function ‘yaml_parser_delete’
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: warning: implicit declaration of function ‘yaml_emitter_initialize’
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:11: error: ‘emitter’ undeclared (first use in this function)
> build/temp.macosx-10.6-i386-2.6/check_libyaml.c:12: warning: implicit declaration of function ‘yaml_emitter_delete’
> 
> libyaml is not found or a compiler error: forcing --without-libyaml
> (if libyaml is installed correctly, you may need to
>  specify the option --include-dirs or uncomment and
>  modify the parameter include_dirs in setup.cfg)
> zip_safe flag not set; analyzing archive contents...
> Adding PyYAML 3.10 to easy-install.pth file
> ```
> Are these errors important?  The installation proceeds, apparently successfully, after this.


PyYAML Supports libYAML for speed reasons only, so you can ignore these messages. But I removed libYAML support from the SPKG (I will update the link soon), so that nobody gets confused.

> 
> Second, would it be better to have three separate spkgs, one each for pybtex, PyYAML, and pyparsing?


sagenb also includes its dependencies. It would be too much trouble to maintain three different SPKGs.

> 
> Third, should the file `patches/pybtex-doc_tree.patch.org` be deleted?  I see a reference to it in SPKG.txt, but why do we need it?  It might be better just to give the link to the original patch and then say that it has been rebased.  Rebasing is the only change, right?


We don't know, if the link will change or will be unavailable some day. Burcin thought, it would probably be safer like this.



---

archive/issue_comments_167358.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,5 +5,5 @@\n \n ---\n \n-New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg)\n+New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg)\n \n``````\n",
    "created_at": "2011-09-27T16:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167358",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,5 +5,5 @@
 
 ---
 
-New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15.spkg)
+New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg)
 
``````




---

archive/issue_comments_167359.json:
```json
{
    "body": "<a id='comment:4'></a>\nUpdated package not to support system-libYAML-bindings. Link is now [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg)\n\n`@`jhpalmieri: Would you mind to look at it again, please?\n\nThe changes are available on [https://bitbucket.org/niels_mfo/pybtex-0.15](https://bitbucket.org/niels_mfo/pybtex-0.15)",
    "created_at": "2011-09-27T16:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167359",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:4'></a>
Updated package not to support system-libYAML-bindings. Link is now [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg)

`@`jhpalmieri: Would you mind to look at it again, please?

The changes are available on [https://bitbucket.org/niels_mfo/pybtex-0.15](https://bitbucket.org/niels_mfo/pybtex-0.15)



---

archive/issue_comments_167360.json:
```json
{
    "body": "<a id='comment:5'></a>\nUpstream update. See SPKG.txt for more info.",
    "created_at": "2012-05-28T15:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167360",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:5'></a>
Upstream update. See SPKG.txt for more info.



---

archive/issue_comments_167361.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,5 +5,5 @@\n \n ---\n \n-New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg)\n+New optional spkg: [http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM](http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM)\n \n``````\n",
    "created_at": "2012-05-28T15:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167361",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,5 +5,5 @@
 
 ---
 
-New optional spkg: [http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg](http://sage.math.washington.edu/home/burcin/spkg/pybtex-0.15-r1.spkg)
+New optional spkg: [http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM](http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM)
 
``````




---

archive/issue_comments_167362.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis installed correctly, even though I disabled internet access while installing it. So that's good.\n\nRegarding SPKG.txt: surely Python is a dependency. You should make this explicit, so that if/when this becomes a standard package, people where it goes in the makefile `spkg/standard/deps`. Also, I would add a little bit to the description; for example, \n\n```diff\ndiff --git a/SPKG.txt b/SPKG.txt\n--- a/SPKG.txt\n+++ b/SPKG.txt\n@@ -2,7 +2,8 @@\n \n == Description ==\n \n-Pybtex is a drop-in replacement for BibTeX written in Python.\n+Pybtex is a drop-in replacement for BibTeX written in Python. That is,\n+you can run 'pybtex FILE' instead of 'bibtex FILE'.\n \n We use the bazaar trunk because it is less buggy and more feature-rich.\n The latest version is available through this command:\n```\nWhen I ran this on a file, I got this error message:\n\n```\namsplain.bst: %\namsplain.bst: ^^^\namsplain.bst: ERROR: Syntax error in line 333: BST command expected.\n```\nbut maybe I don't have things configured correctly...\n\nIt might be a good idea to write an spkg-check script, which does nothing if `nose` is not installed, but runs self-tests if it is. This is not very important right now, but if you have a chance...\n\nFinally, you need an attachment for the scripts repository. See attached.",
    "created_at": "2012-06-12T21:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167362",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
This installed correctly, even though I disabled internet access while installing it. So that's good.

Regarding SPKG.txt: surely Python is a dependency. You should make this explicit, so that if/when this becomes a standard package, people where it goes in the makefile `spkg/standard/deps`. Also, I would add a little bit to the description; for example, 

```diff
diff --git a/SPKG.txt b/SPKG.txt
--- a/SPKG.txt
+++ b/SPKG.txt
@@ -2,7 +2,8 @@
 
 == Description ==
 
-Pybtex is a drop-in replacement for BibTeX written in Python.
+Pybtex is a drop-in replacement for BibTeX written in Python. That is,
+you can run 'pybtex FILE' instead of 'bibtex FILE'.
 
 We use the bazaar trunk because it is less buggy and more feature-rich.
 The latest version is available through this command:
```
When I ran this on a file, I got this error message:

```
amsplain.bst: %
amsplain.bst: ^^^
amsplain.bst: ERROR: Syntax error in line 333: BST command expected.
```
but maybe I don't have things configured correctly...

It might be a good idea to write an spkg-check script, which does nothing if `nose` is not installed, but runs self-tests if it is. This is not very important right now, but if you have a chance...

Finally, you need an attachment for the scripts repository. See attached.



---

archive/issue_comments_167363.json:
```json
{
    "body": "Attachment [trac_11851-hgignore.patch](tarball://root/attachments/some-uuid/ticket11851/trac_11851-hgignore.patch) by @jhpalmieri created at 2012-06-12 21:47:34\n\nSAGE_ROOT/local/bin repo",
    "created_at": "2012-06-12T21:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167363",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_11851-hgignore.patch](tarball://root/attachments/some-uuid/ticket11851/trac_11851-hgignore.patch) by @jhpalmieri created at 2012-06-12 21:47:34

SAGE_ROOT/local/bin repo



---

archive/issue_comments_167364.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,5 +5,6 @@\n \n ---\n \n+Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.\n+\n New optional spkg: [http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM](http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM)\n-\n``````\n",
    "created_at": "2012-06-12T21:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167364",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,5 +5,6 @@
 
 ---
 
+Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.
+
 New optional spkg: [http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM](http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM)
-
``````




---

archive/issue_comments_167365.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jhpalmieri](#comment%3A6):\n> This installed correctly, even though I disabled internet access while installing it. So that's good.\n> \n> Regarding SPKG.txt: surely Python is a dependency. You should make this explicit, so that if/when this becomes a standard package, people where it goes in the makefile `spkg/standard/deps`. Also, I would add a little bit to the description; for example, [...]\n\n\nThanks for checking, updated the spkg with your suggestions.\n\n\n\n> When I ran this on a file, I got this error message:\n> \n> ```\n> amsplain.bst: %\n> amsplain.bst: ^^^\n> amsplain.bst: ERROR: Syntax error in line 333: BST command expected.\n> ```\n> but maybe I don't have things configured correctly...\n\n\nWhat exactly did you do? I cannot reproduce the error.\n\n> It might be a good idea to write an spkg-check script, which does nothing if `nose` is not installed, but runs self-tests if it is. This is not very important right now, but if you have a chance...\n\n\nI don't think that is possible. Maybe when nose becomes an [optional package](http://trac.sagemath.org/sage_trac/ticket/9921). But at the moment, when nose is installed on the system, sage can run the `nosetests` command, but python won't find nose:\n\n```\nTraceback (most recent call last):\n  File \"/usr/bin/nosetests\", line 5, in <module>\n    from pkg_resources import load_entry_point\n  File \"/home/niels/mfo/sage-5.0/local/lib/python2.7/site-packages/distribute-0.6.16-py2.7.egg/pkg_resources.py\", line 2672, in <module>\n    working_set.require(__requires__)\n  File \"/home/niels/mfo/sage-5.0/local/lib/python2.7/site-packages/distribute-0.6.16-py2.7.egg/pkg_resources.py\", line 655, in require\n    needed = self.resolve(parse_requirements(requirements))\n  File \"/home/niels/mfo/sage-5.0/local/lib/python2.7/site-packages/distribute-0.6.16-py2.7.egg/pkg_resources.py\", line 553, in resolve\n    raise DistributionNotFound(req)\npkg_resources.DistributionNotFound: nose==1.1.2\n```\nThat error occurs when running `nosetests` in `sage -sh` or `spkg-check` with nose installed on my system.\n\n> Finally, you need an attachment for the scripts repository. See attached.\n\n\nThanks, didn't know about that.",
    "created_at": "2012-06-14T09:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167365",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:8'></a>
Replying to [jhpalmieri](#comment%3A6):
> This installed correctly, even though I disabled internet access while installing it. So that's good.
> 
> Regarding SPKG.txt: surely Python is a dependency. You should make this explicit, so that if/when this becomes a standard package, people where it goes in the makefile `spkg/standard/deps`. Also, I would add a little bit to the description; for example, [...]


Thanks for checking, updated the spkg with your suggestions.



> When I ran this on a file, I got this error message:
> 
> ```
> amsplain.bst: %
> amsplain.bst: ^^^
> amsplain.bst: ERROR: Syntax error in line 333: BST command expected.
> ```
> but maybe I don't have things configured correctly...


What exactly did you do? I cannot reproduce the error.

> It might be a good idea to write an spkg-check script, which does nothing if `nose` is not installed, but runs self-tests if it is. This is not very important right now, but if you have a chance...


I don't think that is possible. Maybe when nose becomes an [optional package](http://trac.sagemath.org/sage_trac/ticket/9921). But at the moment, when nose is installed on the system, sage can run the `nosetests` command, but python won't find nose:

```
Traceback (most recent call last):
  File "/usr/bin/nosetests", line 5, in <module>
    from pkg_resources import load_entry_point
  File "/home/niels/mfo/sage-5.0/local/lib/python2.7/site-packages/distribute-0.6.16-py2.7.egg/pkg_resources.py", line 2672, in <module>
    working_set.require(__requires__)
  File "/home/niels/mfo/sage-5.0/local/lib/python2.7/site-packages/distribute-0.6.16-py2.7.egg/pkg_resources.py", line 655, in require
    needed = self.resolve(parse_requirements(requirements))
  File "/home/niels/mfo/sage-5.0/local/lib/python2.7/site-packages/distribute-0.6.16-py2.7.egg/pkg_resources.py", line 553, in resolve
    raise DistributionNotFound(req)
pkg_resources.DistributionNotFound: nose==1.1.2
```
That error occurs when running `nosetests` in `sage -sh` or `spkg-check` with nose installed on my system.

> Finally, you need an attachment for the scripts repository. See attached.


Thanks, didn't know about that.



---

archive/issue_comments_167366.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,4 +7,4 @@\n \n Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.\n \n-New optional spkg: [http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM](http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM)\n+New optional spkg: [http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm](http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm)\n``````\n",
    "created_at": "2012-06-14T09:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167366",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,4 +7,4 @@
 
 Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.
 
-New optional spkg: [http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM](http://ubuntuone.com/3IK8aG0mDDoxPopQZ5m0uM)
+New optional spkg: [http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm](http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm)
``````




---

archive/issue_comments_167367.json:
```json
{
    "body": "<a id='comment:9'></a>\nRegarding nose, I was thinking of something like this in spkg-check:\n\n```sh\nif [ -x \"$SAGE_LOCAL/bin/nosetests\" ]; then\n    # RUN TESTS HERE.\n    if [ $? -ne 0 ]; then  # REPLACE WITH SUITABLE CHECK THAT TESTS PASSED.\n        echo >&2 \"Error running tests.\"\n        exit 1\n    fi\nelse\n    echo \"Not running tests since nose is not installed.\"\nfi\n```\nOr you could replace the first line with a test for the suitable library in `$SAGE_ROOT/local/lib/python/site-packages`, say by running a little python script.",
    "created_at": "2012-06-15T17:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167367",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Regarding nose, I was thinking of something like this in spkg-check:

```sh
if [ -x "$SAGE_LOCAL/bin/nosetests" ]; then
    # RUN TESTS HERE.
    if [ $? -ne 0 ]; then  # REPLACE WITH SUITABLE CHECK THAT TESTS PASSED.
        echo >&2 "Error running tests."
        exit 1
    fi
else
    echo "Not running tests since nose is not installed."
fi
```
Or you could replace the first line with a test for the suitable library in `$SAGE_ROOT/local/lib/python/site-packages`, say by running a little python script.



---

archive/issue_comments_167368.json:
```json
{
    "body": "<a id='comment:10'></a>\nAm I missing something, or would this only make sense if nose would actually be a (at least optional) [spkg](http://trac.sagemath.org/sage_trac/ticket/9921). Sure, you could install nose into sage by hand. But that sounds a little hacky to me. I would much rather prefer to wait for the [spkg](http://trac.sagemath.org/sage_trac/ticket/9921). (Please correct me, if I'm missing something. Otherwise I feel like making (risking) more problems than solving.)",
    "created_at": "2012-06-15T18:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167368",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:10'></a>
Am I missing something, or would this only make sense if nose would actually be a (at least optional) [spkg](http://trac.sagemath.org/sage_trac/ticket/9921). Sure, you could install nose into sage by hand. But that sounds a little hacky to me. I would much rather prefer to wait for the [spkg](http://trac.sagemath.org/sage_trac/ticket/9921). (Please correct me, if I'm missing something. Otherwise I feel like making (risking) more problems than solving.)



---

archive/issue_comments_167369.json:
```json
{
    "body": "<a id='comment:11'></a>\nI still think that Python should be listed as a dependency. Otherwise, this looks okay.",
    "created_at": "2012-06-15T21:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167369",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
I still think that Python should be listed as a dependency. Otherwise, this looks okay.



---

archive/issue_comments_167370.json:
```json
{
    "body": "<a id='comment:12'></a>\nSure. Is [that](https://bitbucket.org/niels_mfo/pybtex/changeset/d488cb2b81f5) alright?",
    "created_at": "2012-06-16T08:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167370",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:12'></a>
Sure. Is [that](https://bitbucket.org/niels_mfo/pybtex/changeset/d488cb2b81f5) alright?



---

archive/issue_comments_167371.json:
```json
{
    "body": "<a id='comment:13'></a>\nI'm happy with your changes, but, sorry, I keep finding more small problems. I think the last one is this: in the `ChangeLog` section of SPKG.txt, the changes should be in the reverse order, starting with the most recent, ending with the initial version.",
    "created_at": "2012-06-17T20:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167371",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>
I'm happy with your changes, but, sorry, I keep finding more small problems. I think the last one is this: in the `ChangeLog` section of SPKG.txt, the changes should be in the reverse order, starting with the most recent, ending with the initial version.



---

archive/issue_comments_167372.json:
```json
{
    "body": "<a id='comment:14'></a>\nOh, that's right, the order needs to be reversed: [https://bitbucket.org/niels_mfo/pybtex/src/20120618/SPKG.txt](https://bitbucket.org/niels_mfo/pybtex/src/20120618/SPKG.txt)\n\nI'm really happy for any communication whatsoever, as long as we all work on improving stuff. So if there any more problems (big or small), please don't hesitate to write about them :-)",
    "created_at": "2012-06-18T11:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167372",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

<a id='comment:14'></a>
Oh, that's right, the order needs to be reversed: [https://bitbucket.org/niels_mfo/pybtex/src/20120618/SPKG.txt](https://bitbucket.org/niels_mfo/pybtex/src/20120618/SPKG.txt)

I'm really happy for any communication whatsoever, as long as we all work on improving stuff. So if there any more problems (big or small), please don't hesitate to write about them :-)



---

archive/issue_comments_167373.json:
```json
{
    "body": "<a id='comment:15'></a>\nYes, that looks good now. Regarding spkg-install, you don't really need to create and delete the directory `tmp`: I think you can just unzip and build !PyYAML-3.10.zip in place:\n\n```diff\ndiff --git a/spkg-install b/spkg-install\n--- a/spkg-install\n+++ b/spkg-install\n@@ -6,19 +6,19 @@ if [ \"x$SAGE_LOCAL\" = x ]; then\n    exit 1\n fi\n \n+CUR=`pwd`\n+\n # need to suppress confusing error messages and don't depend on system\n # libraries, so easy_install is not available\n-mkdir tmp &&\n-    unzip -o PyYAML-3.10.zip -d tmp &&\n-    cd tmp/PyYAML-3.10 &&\n+unzip -o PyYAML-3.10.zip &&\n+    cd PyYAML-3.10 &&\n     python setup.py --without-libyaml install --prefix=\"$SAGE_LOCAL\"\n if [ $? -ne 0 ]; then\n    echo \"Error installing PyYAML.\"\n    exit 1\n fi\n \n-cd ../..\n-rm -rf tmp\n+cd \"$CUR\"\n \n easy_install pyparsing-1.5.6.zip\n if [ $? -ne 0 ]; then\n```\nBut this is not very important; it works either way.\n\nSo if you upgrade the spkg to use your new version of SPKG.txt, you can switch this to \"positive review\".",
    "created_at": "2012-06-22T18:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167373",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Yes, that looks good now. Regarding spkg-install, you don't really need to create and delete the directory `tmp`: I think you can just unzip and build !PyYAML-3.10.zip in place:

```diff
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -6,19 +6,19 @@ if [ "x$SAGE_LOCAL" = x ]; then
    exit 1
 fi
 
+CUR=`pwd`
+
 # need to suppress confusing error messages and don't depend on system
 # libraries, so easy_install is not available
-mkdir tmp &&
-    unzip -o PyYAML-3.10.zip -d tmp &&
-    cd tmp/PyYAML-3.10 &&
+unzip -o PyYAML-3.10.zip &&
+    cd PyYAML-3.10 &&
     python setup.py --without-libyaml install --prefix="$SAGE_LOCAL"
 if [ $? -ne 0 ]; then
    echo "Error installing PyYAML."
    exit 1
 fi
 
-cd ../..
-rm -rf tmp
+cd "$CUR"
 
 easy_install pyparsing-1.5.6.zip
 if [ $? -ne 0 ]; then
```
But this is not very important; it works either way.

So if you upgrade the spkg to use your new version of SPKG.txt, you can switch this to "positive review".



---

archive/issue_comments_167374.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2012-06-22T18:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167374",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_comments_167375.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-06-26T14:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167375",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_167376.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,4 +7,4 @@\n \n Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.\n \n-New optional spkg: [http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm](http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm)\n+New optional spkg: [http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1](http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1)\n``````\n",
    "created_at": "2012-06-26T14:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167376",
    "user": "https://trac.sagemath.org/admin/accounts/users/ranosch"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,4 +7,4 @@
 
 Apply [attachment:trac_11851-hgignore.patch] to the scripts repo.
 
-New optional spkg: [http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm](http://ubuntuone.com/3q1Z2j3WDuucK71I0MxjAm)
+New optional spkg: [http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1](http://ubuntuone.com/6iNB5C4qYc6UZWEwaAcOx1)
``````




---

archive/issue_events_036909.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-28T07:52:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11851#event-36909"
}
```



---

archive/issue_comments_167377.json:
```json
{
    "body": "<a id='comment:18'></a>\nmoved spkg to the servers",
    "created_at": "2012-07-02T12:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167377",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:18'></a>
moved spkg to the servers



---

archive/issue_comments_167378.json:
```json
{
    "body": "**Merged:** sage-5.2.beta0",
    "created_at": "2012-07-02T13:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167378",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.2.beta0



---

archive/issue_events_036910.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-02T13:00:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11851#event-36910"
}
```



---

archive/issue_comments_167379.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2012-07-02T13:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11851#issuecomment-167379",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed
