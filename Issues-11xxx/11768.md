# Issue 11768: Get source code for parent/element classes of categories

archive/issues_011596.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nCurrently (sage-4.7.2.alpha2) one can not interactively get the source code of the parent or element classes of a category:\n\n```\nsage: C.parent_class??\nType:           DynamicMetaclass\nBase Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>\nString Form:    <class 'sage.categories.rings.Rings.parent_class'>\nNamespace:      Interactive\nFile:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/categories/rings.py\nSource:\nclass DynamicMetaclass(type):\n    \"\"\"\n    A metaclass implementing an appropriate reduce-by-construction method\n    \"\"\"\n\n    def __reduce__(self):\n        \"\"\"\n        See sage.structure.dynamic_class.dynamic_class? for non trivial tests.\n\n        TESTS::\n\n...\n```\n\nAs one can see, it gets the source file right, but can not find the class definition in it.\n\nI tried to track it down.\n\n* For a dynamic metaclass, we want to obtain the documentation and source of the base class (resp. the class that is passed too the dynamic metaclass by the `doccls` argument).\n* The module is correctly provided, and thus Python's inspect module is able to find the source file.\n* If it is a class then Python's inspect module tries to find something like `\"class \"+cls.__name__+\":\"` in the sources (they use a more sophisticated regular expression).\n* The base class is `Rings().ParentMethods`. Unfortunately, it is defined by `class ParentMethods`, but the name is differently:\n\n ```\n sage: Rings().ParentMethods.__name__\n 'Rings.ParentMethods'\n ```\n\nI do not suggest to change the name: If the name is just `'ParentMethods'` then Python's inspect module would always find the first occurence of that name, which is bad if one module defines several categories.\n\nInstead, I suggest to create a new function in `sage.misc.sageinspect` that recursively finds the sources for classes whose sources can't be found by other methods and whose name contains a dot:\n\nThe function that I plan to write does not start with the whole source file of `sage.categories.rings`, but it starts with the sources of `sage.categories.rings.Rings` and then searches `class ParentMethods` (with the regular expression from the inspect module) only in that small part of the full source file.\n\nI think \"getting sources\" belongs to the component \"misc\", even though the problem is  relevant for not getting confused by the category framework. Thus, cc to Nicolas...\n\n**__Apply__**\n\n* [attachment: trac11768_source_of_dynamic_class.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)\n\n\nCC:  @nthiery @hivert\n\nComponent: **misc**\n\nKeywords: **sources dynamic class**\n\nAuthor: **Simon King**\n\nReviewer: **Volker Braun**\n\nMerged: **sage-5.6.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11768_\n\n",
    "closed_at": "2012-12-21T09:30:48Z",
    "created_at": "2011-09-01T08:20:41Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Get source code for parent/element classes of categories",
    "type": "issue",
    "updated_at": "2012-12-21T09:30:48Z",
    "url": "https://github.com/sagemath/sage/issues/11768",
    "user": "https://github.com/simon-king-jena"
}
```
<div id="comment:0"></div>

Currently (sage-4.7.2.alpha2) one can not interactively get the source code of the parent or element classes of a category:

```
sage: C.parent_class??
Type:           DynamicMetaclass
Base Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>
String Form:    <class 'sage.categories.rings.Rings.parent_class'>
Namespace:      Interactive
File:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/categories/rings.py
Source:
class DynamicMetaclass(type):
    """
    A metaclass implementing an appropriate reduce-by-construction method
    """

    def __reduce__(self):
        """
        See sage.structure.dynamic_class.dynamic_class? for non trivial tests.

        TESTS::

...
```

As one can see, it gets the source file right, but can not find the class definition in it.

I tried to track it down.

* For a dynamic metaclass, we want to obtain the documentation and source of the base class (resp. the class that is passed too the dynamic metaclass by the `doccls` argument).
* The module is correctly provided, and thus Python's inspect module is able to find the source file.
* If it is a class then Python's inspect module tries to find something like `"class "+cls.__name__+":"` in the sources (they use a more sophisticated regular expression).
* The base class is `Rings().ParentMethods`. Unfortunately, it is defined by `class ParentMethods`, but the name is differently:

 ```
 sage: Rings().ParentMethods.__name__
 'Rings.ParentMethods'
 ```

I do not suggest to change the name: If the name is just `'ParentMethods'` then Python's inspect module would always find the first occurence of that name, which is bad if one module defines several categories.

Instead, I suggest to create a new function in `sage.misc.sageinspect` that recursively finds the sources for classes whose sources can't be found by other methods and whose name contains a dot:

The function that I plan to write does not start with the whole source file of `sage.categories.rings`, but it starts with the sources of `sage.categories.rings.Rings` and then searches `class ParentMethods` (with the regular expression from the inspect module) only in that small part of the full source file.

I think "getting sources" belongs to the component "misc", even though the problem is  relevant for not getting confused by the category framework. Thus, cc to Nicolas...

**__Apply__**

* [attachment: trac11768_source_of_dynamic_class.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)


CC:  @nthiery @hivert

Component: **misc**

Keywords: **sources dynamic class**

Author: **Simon King**

Reviewer: **Volker Braun**

Merged: **sage-5.6.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/11768_





---

archive/issue_events_156573.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T08:20:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156573"
}
```



---

archive/issue_events_156574.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T08:20:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156574"
}
```



---

archive/issue_events_156575.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T08:20:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156575"
}
```



---

archive/issue_events_156576.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-09-01T08:20:41Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "subject": "https://github.com/simon-king-jena",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156576"
}
```



---

archive/issue_comments_122617.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe patch works exactly as it is announced in the ticket description. One can now (on top of sage-4.7.2.alpha2) do:\n\n```\nsage: C = Rings()\nsage: from sage.misc.sageinspect import sage_getsource\nsage: print sage_getsource(C.parent_class)  #indirect doctest\nclass ParentMethods:\n    def is_field(self):\n        raise NotImplementedError\n<BLANKLINE>\n    def bracket(self, x, y):\n...\n```\n\nUnfortunately,\n\n```\nsage: P = JackPolynomialsP(QQ); P.rename(\"JackP\")\nsage: P.element_class??\n```\ndoes not work yet. So, the search for definitions should also include the `__base__` attribute of a class.",
    "created_at": "2011-09-01T10:08:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122617",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:1" align="right">comment:1</div>

The patch works exactly as it is announced in the ticket description. One can now (on top of sage-4.7.2.alpha2) do:

```
sage: C = Rings()
sage: from sage.misc.sageinspect import sage_getsource
sage: print sage_getsource(C.parent_class)  #indirect doctest
class ParentMethods:
    def is_field(self):
        raise NotImplementedError
<BLANKLINE>
    def bracket(self, x, y):
...
```

Unfortunately,

```
sage: P = JackPolynomialsP(QQ); P.rename("JackP")
sage: P.element_class??
```
does not work yet. So, the search for definitions should also include the `__base__` attribute of a class.



---

archive/issue_comments_122618.json:
```json
{
    "body": "Author: **Simon King**",
    "created_at": "2011-09-01T10:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122618",
    "user": "https://github.com/simon-king-jena"
}
```

Author: **Simon King**



---

archive/issue_events_156577.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T10:52:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156577"
}
```



---

archive/issue_comments_122619.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIt seems to me that things are fine now.\n\nIn particular, we have\n\n```\nsage: C = Rings()\nsage: C.parent_class??\nType:           DynamicMetaclass\nBase Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>\nString Form:    <class 'sage.categories.rings.Rings.parent_class'>\nNamespace:      Interactive\nFile:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/categories/rings.py\nSource:\n    class ParentMethods:\n        def is_field(self):\n            raise NotImplementedError\n\n        def bracket(self, x, y):\n...\nsage: P = JackPolynomialsP(QQ)\nsage: P.element_class??\nType:           DynamicMetaclass\nBase Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>\nString Form:    <class 'sage.combinat.sf.jack.JackPolynomials_p_with_category.element_class'>\nNamespace:      Interactive\nFile:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/combinat/sf/jack.py\nDefinition:     P.element_class(self, x, include=None, exclude=None)\nSource:\nclass SymmetricFunctionAlgebra_generic_Element(CombinatorialFreeModule.Element):\n    def __repr__(self):\n        \"\"\"\n        EXAMPLES::\n\n            sage: m = SFAMonomial(QQ)\n...\nsage: P.<x,y> = QQ[]\nsage: I = P*[x,y]\nsage: I??\nType:           MPolynomialIdeal\nBase Class:     <class 'sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal'>\nString Form:    Ideal (x, y) of Multivariate Polynomial Ring in x, y over Rational Field\nNamespace:      Interactive\nFile:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\nSource:\nclass MPolynomialIdeal( MPolynomialIdeal_singular_repr, \\\n                        MPolynomialIdeal_macaulay2_repr, \\\n                        MPolynomialIdeal_magma_repr, \\\n                        Ideal_generic ):\n    def __init__(self, ring, gens, coerce=True):\n        r\"\"\"\n        Create an ideal in a multivariate polynomial ring.\n...\n```\n\nAll three examples are doctested (via `sage_getsourcelines`). So, ready for review!",
    "created_at": "2011-09-01T10:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122619",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:2" align="right">comment:2</div>

It seems to me that things are fine now.

In particular, we have

```
sage: C = Rings()
sage: C.parent_class??
Type:           DynamicMetaclass
Base Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>
String Form:    <class 'sage.categories.rings.Rings.parent_class'>
Namespace:      Interactive
File:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/categories/rings.py
Source:
    class ParentMethods:
        def is_field(self):
            raise NotImplementedError

        def bracket(self, x, y):
...
sage: P = JackPolynomialsP(QQ)
sage: P.element_class??
Type:           DynamicMetaclass
Base Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>
String Form:    <class 'sage.combinat.sf.jack.JackPolynomials_p_with_category.element_class'>
Namespace:      Interactive
File:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/combinat/sf/jack.py
Definition:     P.element_class(self, x, include=None, exclude=None)
Source:
class SymmetricFunctionAlgebra_generic_Element(CombinatorialFreeModule.Element):
    def __repr__(self):
        """
        EXAMPLES::

            sage: m = SFAMonomial(QQ)
...
sage: P.<x,y> = QQ[]
sage: I = P*[x,y]
sage: I??
Type:           MPolynomialIdeal
Base Class:     <class 'sage.rings.polynomial.multi_polynomial_ideal.MPolynomialIdeal'>
String Form:    Ideal (x, y) of Multivariate Polynomial Ring in x, y over Rational Field
Namespace:      Interactive
File:           /mnt/local/king/SAGE/sage-4.7.2.alpha1/local/lib/python2.6/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py
Source:
class MPolynomialIdeal( MPolynomialIdeal_singular_repr, \
                        MPolynomialIdeal_macaulay2_repr, \
                        MPolynomialIdeal_magma_repr, \
                        Ideal_generic ):
    def __init__(self, ring, gens, coerce=True):
        r"""
        Create an ideal in a multivariate polynomial ring.
...
```

All three examples are doctested (via `sage_getsourcelines`). So, ready for review!



---

archive/issue_comments_122620.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nPerhaps it would work to get it in sage-4.7.2, not only sage-5.0?",
    "created_at": "2011-09-01T10:53:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122620",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:3" align="right">comment:3</div>

Perhaps it would work to get it in sage-4.7.2, not only sage-5.0?



---

archive/issue_events_156578.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T10:53:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156578"
}
```



---

archive/issue_events_156579.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T10:53:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156579"
}
```



---

archive/issue_comments_122621.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI just found one thing that doesn't work, yet.\n\nWith\n\n```\nsage: C = Rings()\nsage: HC = C.hom_category()\n```\nneither `HC??` nor `edit(HC,'vim')` do what one would wish.",
    "created_at": "2011-09-01T11:42:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122621",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:4" align="right">comment:4</div>

I just found one thing that doesn't work, yet.

With

```
sage: C = Rings()
sage: HC = C.hom_category()
```
neither `HC??` nor `edit(HC,'vim')` do what one would wish.



---

archive/issue_events_156580.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T11:42:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156580"
}
```



---

archive/issue_events_156581.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T11:42:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156581"
}
```



---

archive/issue_events_156582.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T12:05:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156582"
}
```



---

archive/issue_events_156583.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-01T12:05:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156583"
}
```



---

archive/issue_comments_122622.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIntrospection of `Rings().hom_category()` works and is doctested with the updated patch. Back to \"needs review\".",
    "created_at": "2011-09-01T12:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122622",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:5" align="right">comment:5</div>

Introspection of `Rings().hom_category()` works and is doctested with the updated patch. Back to "needs review".



---

archive/issue_comments_122623.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHi Simon!\n\nDefinitely +1 on the feature! Thanks! \n\nI had a quick look at the implementation, and it sounds reasonable, though I do not yet have an opinion yet. Any sageinspect expert around?",
    "created_at": "2011-09-01T19:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122623",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:6" align="right">comment:6</div>

Hi Simon!

Definitely +1 on the feature! Thanks! 

I had a quick look at the implementation, and it sounds reasonable, though I do not yet have an opinion yet. Any sageinspect expert around?



---

archive/issue_comments_122624.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI'm also +1 on the feature. I just want point out the following trap. With double class nesting the name mangling is currently incorrect (see #9107). Unfortunately, I won't have time to work on it (ping Nicolas ;-). There is a patch in combinat's queue ( trac_9107-nested_class_bug-fh.patch) which experiment on what is happening.",
    "created_at": "2011-09-02T11:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122624",
    "user": "https://github.com/hivert"
}
```

<div id="comment:7" align="right">comment:7</div>

I'm also +1 on the feature. I just want point out the following trap. With double class nesting the name mangling is currently incorrect (see #9107). Unfortunately, I won't have time to work on it (ping Nicolas ;-). There is a patch in combinat's queue ( trac_9107-nested_class_bug-fh.patch) which experiment on what is happening.



---

archive/issue_comments_122625.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHi Florent,\n\nThank you for pointing to the other ticket! #9107 seems quite mysterious to me. Clearly, in the example exposed there, my way to get to the sources would fail. Of course, the current way would fail even more...",
    "created_at": "2011-09-02T15:12:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122625",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

Hi Florent,

Thank you for pointing to the other ticket! #9107 seems quite mysterious to me. Clearly, in the example exposed there, my way to get to the sources would fail. Of course, the current way would fail even more...



---

archive/issue_comments_122626.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nFails to apply to vanilla sage-4.7.2.alpha2. Dependencies?",
    "created_at": "2011-09-19T09:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122626",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Fails to apply to vanilla sage-4.7.2.alpha2. Dependencies?



---

archive/issue_comments_122627.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@vbraun](#comment%3A9):\n> Fails to apply to vanilla sage-4.7.2.alpha2. Dependencies?\n\nActually I don't know (I don't remember that I had anything else added when I worked on the patch). But it should apply to sage-4.7.2.alpha3-prerelease.",
    "created_at": "2011-09-19T09:46:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122627",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@vbraun](#comment%3A9):
> Fails to apply to vanilla sage-4.7.2.alpha2. Dependencies?

Actually I don't know (I don't remember that I had anything else added when I worked on the patch). But it should apply to sage-4.7.2.alpha3-prerelease.



---

archive/issue_comments_122628.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nDo you really start with vanilla sage-4.7.2.alpha2? I just tested, and I have (sorry for the German):\n\n```\nking@mpc622:/mnt/local/king/SAGE/debug/sage-4.7.2.alpha2/devel/sage$ hg qimport https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz\nF\u00fcge trac11768_source_of_dynamic_class.patch zur Seriendatei hinzu\nking@mpc622:/mnt/local/king/SAGE/debug/sage-4.7.2.alpha2/devel/sage$ hg qpush\nWende trac11768_source_of_dynamic_class.patch an\njetzt bei: trac11768_source_of_dynamic_class.patch\nking@mpc622:/mnt/local/king/SAGE/debug/sage-4.7.2.alpha2/devel/sage$ hg qapplied \ntrac11768_source_of_dynamic_class.patch\n```\n\nSo, it *does* apply to vanilla sage-4.7.2.alpha2 without fuzz.",
    "created_at": "2011-09-19T09:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122628",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:11" align="right">comment:11</div>

Do you really start with vanilla sage-4.7.2.alpha2? I just tested, and I have (sorry for the German):

```
king@mpc622:/mnt/local/king/SAGE/debug/sage-4.7.2.alpha2/devel/sage$ hg qimport https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz
FÃ¼ge trac11768_source_of_dynamic_class.patch zur Seriendatei hinzu
king@mpc622:/mnt/local/king/SAGE/debug/sage-4.7.2.alpha2/devel/sage$ hg qpush
Wende trac11768_source_of_dynamic_class.patch an
jetzt bei: trac11768_source_of_dynamic_class.patch
king@mpc622:/mnt/local/king/SAGE/debug/sage-4.7.2.alpha2/devel/sage$ hg qapplied 
trac11768_source_of_dynamic_class.patch
```

So, it *does* apply to vanilla sage-4.7.2.alpha2 without fuzz.



---

archive/issue_comments_122629.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSorry, you are right. It does apply. Must have forgotten to pop all patches %-)",
    "created_at": "2011-09-19T10:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122629",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">comment:12</div>

Sorry, you are right. It does apply. Must have forgotten to pop all patches %-)



---

archive/issue_comments_122630.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWhat is the patchbot complaining about? It states that it fails to apply, but I find it is fine with 4.7.2-alpha3-prerelease.",
    "created_at": "2011-09-30T08:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122630",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

What is the patchbot complaining about? It states that it fails to apply, but I find it is fine with 4.7.2-alpha3-prerelease.



---

archive/issue_comments_122631.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAny reviewer for that ticket? I think introspection is a nice thing to have in more generality...",
    "created_at": "2011-10-26T19:08:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122631",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

Any reviewer for that ticket? I think introspection is a nice thing to have in more generality...



---

archive/issue_events_156584.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-29T06:35:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156584"
}
```



---

archive/issue_events_156585.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-29T06:35:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156585"
}
```



---

archive/issue_comments_122632.json:
```json
{
    "body": "Work Issues: **Make it independent of #11900**",
    "created_at": "2011-10-29T06:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122632",
    "user": "https://github.com/simon-king-jena"
}
```

Work Issues: **Make it independent of #11900**



---

archive/issue_comments_122633.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIt turns out that a combination of this ticket with #11900 yields a problem. I'll try to rewrite the patch here, so that it doesn't matter whether #11900 is applied or not.",
    "created_at": "2011-10-29T06:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122633",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

It turns out that a combination of this ticket with #11900 yields a problem. I'll try to rewrite the patch here, so that it doesn't matter whether #11900 is applied or not.



---

archive/issue_comments_122634.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nDone! Using the new patch, the doc tests of sage/misc/sageinspect.py pass regardless whether #11900 is applied or not.",
    "created_at": "2011-10-29T07:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122634",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Done! Using the new patch, the doc tests of sage/misc/sageinspect.py pass regardless whether #11900 is applied or not.



---

archive/issue_comments_122635.json:
```json
{
    "body": "Changed work issues from **Make it independent of #11900** to none",
    "created_at": "2011-10-29T07:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122635",
    "user": "https://github.com/simon-king-jena"
}
```

Changed work issues from **Make it independent of #11900** to none



---

archive/issue_events_156586.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-29T07:25:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156586"
}
```



---

archive/issue_events_156587.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-29T07:25:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156587"
}
```



---

archive/issue_comments_122636.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nWith the patch, one still has\n\n```\nsage: C = Algebras(ZZ).TensorProducts()\nsage: C.ParentMethods??\nError getting source: could not get source code\nType:           classobj\nString Form:    sage.categories.algebras.TensorProducts.ParentMethods\nNamespace:      Interactive\nFile:           /mnt/local/king/SAGE/rebase/sage-4.8.alpha0/local/lib/python2.6/site-packages/sage/categories/algebras.py\n```\n\nHowever, if C is the category of Z-algebras, then `C.ParentMethods??` works nicely. So, the patch isn't perfect, but it is a progress. Review, anyone?",
    "created_at": "2011-11-10T19:19:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122636",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:17" align="right">comment:17</div>

With the patch, one still has

```
sage: C = Algebras(ZZ).TensorProducts()
sage: C.ParentMethods??
Error getting source: could not get source code
Type:           classobj
String Form:    sage.categories.algebras.TensorProducts.ParentMethods
Namespace:      Interactive
File:           /mnt/local/king/SAGE/rebase/sage-4.8.alpha0/local/lib/python2.6/site-packages/sage/categories/algebras.py
```

However, if C is the category of Z-algebras, then `C.ParentMethods??` works nicely. So, the patch isn't perfect, but it is a progress. Review, anyone?



---

archive/issue_comments_122637.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIf #12876 is applied then one of the tests introduced here gives an unexpected result: We test against a particular code snipped, that changes with #12876.\n\nHence, I'll rewrite the test so that it expects only those parts of the code that do not change.",
    "created_at": "2012-05-02T19:24:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122637",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

If #12876 is applied then one of the tests introduced here gives an unexpected result: We test against a particular code snipped, that changes with #12876.

Hence, I'll rewrite the test so that it expects only those parts of the code that do not change.



---

archive/issue_comments_122638.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nWith the second patch, the doctest becomes independent of whether or not #12876 is applied.\n\nApply trac11768_source_of_dynamic_class.patch trac11768_docfix.patch",
    "created_at": "2012-05-03T10:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122638",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:19" align="right">comment:19</div>

With the second patch, the doctest becomes independent of whether or not #12876 is applied.

Apply trac11768_source_of_dynamic_class.patch trac11768_docfix.patch



---

archive/issue_comments_122639.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -43,3 +43,9 @@\n The function that I plan to write does not start with the whole source file of `sage.categories.rings`, but it starts with the sources of `sage.categories.rings.Rings` and then searches `class ParentMethods` (with the regular expression from the inspect module) only in that small part of the full source file.\n \n I think \"getting sources\" belongs to the component \"misc\", even though the problem is  relevant for not getting confused by the category framework. Thus, cc to Nicolas...\n+\n+**__Apply__**\n+\n+* [attachment: trac11768_source_of_dynamic_class.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)\n+* [attachment: trac11768_docfix.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_docfix.patch.gz)\n+\n``````\n",
    "created_at": "2012-05-03T10:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122639",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -43,3 +43,9 @@
 The function that I plan to write does not start with the whole source file of `sage.categories.rings`, but it starts with the sources of `sage.categories.rings.Rings` and then searches `class ParentMethods` (with the regular expression from the inspect module) only in that small part of the full source file.
 
 I think "getting sources" belongs to the component "misc", even though the problem is  relevant for not getting confused by the category framework. Thus, cc to Nicolas...
+
+**__Apply__**
+
+* [attachment: trac11768_source_of_dynamic_class.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)
+* [attachment: trac11768_docfix.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_docfix.patch.gz)
+
``````




---

archive/issue_comments_122640.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nCool! I just notice:\n\n```\nsage: C = Algebras(ZZ).TensorProducts()\nsage: C.ParentMethods??\nType:\t\tclassobj\nString Form:\tsage.categories.algebras.Algebras.TensorProducts.ParentMethods\nNamespace:\tInteractive\nLoaded File:\t/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib/python2.7/site-packages/sage/categories/algebras.py\nSource File:\t/mnt/local/king/SAGE/stable/sage-5.0.beta13/devel/sage/sage/categories/algebras.py\nSource:\n        class ParentMethods:\n            #def coproduct(self):\n            #    tensor products of morphisms are not yet implemented\n            #    return tensor(module.coproduct for module in self.modules)\n            pass\n```\nI don't know who solved that, but (as I stated above) that used to fail!",
    "created_at": "2012-05-03T10:06:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122640",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:20" align="right">comment:20</div>

Cool! I just notice:

```
sage: C = Algebras(ZZ).TensorProducts()
sage: C.ParentMethods??
Type:		classobj
String Form:	sage.categories.algebras.Algebras.TensorProducts.ParentMethods
Namespace:	Interactive
Loaded File:	/mnt/local/king/SAGE/stable/sage-5.0.beta13/local/lib/python2.7/site-packages/sage/categories/algebras.py
Source File:	/mnt/local/king/SAGE/stable/sage-5.0.beta13/devel/sage/sage/categories/algebras.py
Source:
        class ParentMethods:
            #def coproduct(self):
            #    tensor products of morphisms are not yet implemented
            #    return tensor(module.coproduct for module in self.modules)
            pass
```
I don't know who solved that, but (as I stated above) that used to fail!



---

archive/issue_comments_122641.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nBy the way: feel free to steal this little fix which I did take the time not push through ...:\n\nhttp://combinat.sagemath.org/patches/file/tip/sage_inspect_for_classes-nt.patch",
    "created_at": "2012-05-04T20:22:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122641",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:21" align="right">comment:21</div>

By the way: feel free to steal this little fix which I did take the time not push through ...:

http://combinat.sagemath.org/patches/file/tip/sage_inspect_for_classes-nt.patch



---

archive/issue_comments_122642.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@nthiery](#comment%3A21):\n> By the way: feel free to steal this little fix which I did take the time not push through ...:\n\n??\n\nAccording to the comments in the patch, it would *not* solve the problem addressed here:\n\n```\nNow sage_getsourcelines works similarly for old and new style classes:\n\nsage: sage_getsourcelines(Sets.ParentMethods)\nsage: sage_getsourcelines(Sets.Algebras)\n\nStill both fail, because inspect.getsourcelines (in fact\ninspect.findsource) fails on nested classes which have been renamed\nwith NestedClassMetaclass:\n...\n```\nThe point is that both *do* work with my patch:\n\n```\nsage: from sage.misc.sageinspect import sage_getsourcelines\nsage: for x in sage_getsourcelines(Sets.Algebras)[0]:             \n....:     print x,\n....:     \n    class Algebras(AlgebrasCategory):\n\n        def extra_super_categories(self):\n            \"\"\"\n            EXAMPLES::\n\n                sage: Sets().Algebras(QQ).extra_super_categories()\n                [Category of modules with basis over Rational Field]\n\n                sage: Sets().Algebras(QQ).super_categories()\n                [Category of modules with basis over Rational Field]\n\n                sage: Sets().example().algebra(ZZ).categories()\n                [Category of set algebras over Integer Ring,\n                 Category of modules with basis over Integer Ring,\n                 ...\n                 Category of objects]\n\n            \"\"\"\n            from sage.categories.modules_with_basis import ModulesWithBasis\n            return [ModulesWithBasis(self.base_ring())]\n```",
    "created_at": "2012-05-04T21:30:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122642",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@nthiery](#comment%3A21):
> By the way: feel free to steal this little fix which I did take the time not push through ...:

??

According to the comments in the patch, it would *not* solve the problem addressed here:

```
Now sage_getsourcelines works similarly for old and new style classes:

sage: sage_getsourcelines(Sets.ParentMethods)
sage: sage_getsourcelines(Sets.Algebras)

Still both fail, because inspect.getsourcelines (in fact
inspect.findsource) fails on nested classes which have been renamed
with NestedClassMetaclass:
...
```
The point is that both *do* work with my patch:

```
sage: from sage.misc.sageinspect import sage_getsourcelines
sage: for x in sage_getsourcelines(Sets.Algebras)[0]:             
....:     print x,
....:     
    class Algebras(AlgebrasCategory):

        def extra_super_categories(self):
            """
            EXAMPLES::

                sage: Sets().Algebras(QQ).extra_super_categories()
                [Category of modules with basis over Rational Field]

                sage: Sets().Algebras(QQ).super_categories()
                [Category of modules with basis over Rational Field]

                sage: Sets().example().algebra(ZZ).categories()
                [Category of set algebras over Integer Ring,
                 Category of modules with basis over Integer Ring,
                 ...
                 Category of objects]

            """
            from sage.categories.modules_with_basis import ModulesWithBasis
            return [ModulesWithBasis(self.base_ring())]
```



---

archive/issue_comments_122643.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@simon-king-jena](#comment%3A22):\n> Replying to [@nthiery](#comment%3A21):\n> > By the way: feel free to steal this little fix which I did take the time not push through ...:\n> \n> According to the comments in the patch, it would *not* solve the problem addressed here:\n> \n> ```\n> Now sage_getsourcelines works similarly for old and new style classes:\n> \n> sage: sage_getsourcelines(Sets.ParentMethods)\n> sage: sage_getsourcelines(Sets.Algebras)\n> \n> Still both fail, because inspect.getsourcelines (in fact\n> inspect.findsource) fails on nested classes which have been renamed\n> with NestedClassMetaclass:\n> ...\n> ```\n\nOh, sorry, I was unclear. I did not mean that this patch would fix\nthis ticket. Just that it fixed another little issue in a related spot\nin the code. If your patch already takes care of it, so much the\nbetter!\n\nCheers,\n\t\t\t\tNicolas",
    "created_at": "2012-05-05T07:25:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122643",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@simon-king-jena](#comment%3A22):
> Replying to [@nthiery](#comment%3A21):
> > By the way: feel free to steal this little fix which I did take the time not push through ...:
> 
> According to the comments in the patch, it would *not* solve the problem addressed here:
> 
> ```
> Now sage_getsourcelines works similarly for old and new style classes:
> 
> sage: sage_getsourcelines(Sets.ParentMethods)
> sage: sage_getsourcelines(Sets.Algebras)
> 
> Still both fail, because inspect.getsourcelines (in fact
> inspect.findsource) fails on nested classes which have been renamed
> with NestedClassMetaclass:
> ...
> ```

Oh, sorry, I was unclear. I did not mean that this patch would fix
this ticket. Just that it fixed another little issue in a related spot
in the code. If your patch already takes care of it, so much the
better!

Cheers,
				Nicolas



---

archive/issue_comments_122644.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAny review for better access to source code in the category framework?",
    "created_at": "2012-08-13T13:08:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122644",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:24" align="right">comment:24</div>

Any review for better access to source code in the category framework?



---

archive/issue_comments_122645.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nLooks good. You might want to pick classes for doctests that are not moving targets in the combinat queue, though ;-)  How about `sage/structure/sage_object.py` or something else thats buried deep down and unlikely to change.",
    "created_at": "2012-11-27T10:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122645",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

Looks good. You might want to pick classes for doctests that are not moving targets in the combinat queue, though ;-)  How about `sage/structure/sage_object.py` or something else thats buried deep down and unlikely to change.



---

archive/issue_comments_122646.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@vbraun](#comment%3A25):\n> Looks good. You might want to pick classes for doctests that are not moving targets in the combinat queue, though ;-)  How about `sage/structure/sage_object.py` or something else thats buried deep down and unlikely to change.\n\nGood idea. I can not remember why I chose `JackPolynomials` to create examples. I'll see if `SageObject.element_class` shows the same problems with introspection than `JackPolynomials.element_class`.",
    "created_at": "2012-11-27T11:10:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122646",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@vbraun](#comment%3A25):
> Looks good. You might want to pick classes for doctests that are not moving targets in the combinat queue, though ;-)  How about `sage/structure/sage_object.py` or something else thats buried deep down and unlikely to change.

Good idea. I can not remember why I chose `JackPolynomials` to create examples. I'll see if `SageObject.element_class` shows the same problems with introspection than `JackPolynomials.element_class`.



---

archive/issue_comments_122647.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI think what I need is:\n\n* A parent class whose metaclass is a sub-class of `NestedClassMetaclass` (such as `UniqueRepresentation`)\n* ... so that the `Element` attribute is given as a nested class.\n\nThese two properties hold for the `JackPolynomials` example.\n\nWhat I could do is to create a minimal example in the doc tests. Unfortunately, I need a source file to make it work -- hence, such a doc test needs to use the cython(...) function and hence needs a compiler.\n\nI did create a couple of examples of that type in other patches that got merged, but some people said it is bad practice to have examples that rely on a compiler.\n\nSo, what do you think? Shall I use the compiler, or perhaps create a new class in the Sage library just for the purpose of testing?",
    "created_at": "2012-11-27T11:22:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122647",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:27" align="right">comment:27</div>

I think what I need is:

* A parent class whose metaclass is a sub-class of `NestedClassMetaclass` (such as `UniqueRepresentation`)
* ... so that the `Element` attribute is given as a nested class.

These two properties hold for the `JackPolynomials` example.

What I could do is to create a minimal example in the doc tests. Unfortunately, I need a source file to make it work -- hence, such a doc test needs to use the cython(...) function and hence needs a compiler.

I did create a couple of examples of that type in other patches that got merged, but some people said it is bad practice to have examples that rely on a compiler.

So, what do you think? Shall I use the compiler, or perhaps create a new class in the Sage library just for the purpose of testing?



---

archive/issue_comments_122648.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI don't know yet whether my patch would fix the following example:\n\n```\nsage: class MyParent(UniqueRepresentation, Parent):\n....:    class Element:\n....:        pass\n....:     \nsage: P = MyParent(ZZ)\nsage: P.element_class??\nType:           DynamicMetaclass\nBase Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>\nString Form:    <class '__main__.MyParent.element_class'>\nNamespace:      Interactive\nLoaded File:    /home/simon/SAGE/debug/sage-5.5.rc0/local/lib/python2.7/site-packages/IPython/FakeModule.py\nSource File:    /home/simon/SAGE/debug/sage-5.5.rc0/devel/sage/IPython/FakeModule.py\nSource:\nclass DynamicMetaclass(type):\n...\n```\n\nIf I understand correctly, my patch *would* fix a corresponding example in Cython (because it then has a source file to inspect). If my patch is able to fix the example above then I'll use it.",
    "created_at": "2012-11-27T11:27:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122648",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:28" align="right">comment:28</div>

I don't know yet whether my patch would fix the following example:

```
sage: class MyParent(UniqueRepresentation, Parent):
....:    class Element:
....:        pass
....:     
sage: P = MyParent(ZZ)
sage: P.element_class??
Type:           DynamicMetaclass
Base Class:     <class 'sage.structure.dynamic_class.DynamicMetaclass'>
String Form:    <class '__main__.MyParent.element_class'>
Namespace:      Interactive
Loaded File:    /home/simon/SAGE/debug/sage-5.5.rc0/local/lib/python2.7/site-packages/IPython/FakeModule.py
Source File:    /home/simon/SAGE/debug/sage-5.5.rc0/devel/sage/IPython/FakeModule.py
Source:
class DynamicMetaclass(type):
...
```

If I understand correctly, my patch *would* fix a corresponding example in Cython (because it then has a source file to inspect). If my patch is able to fix the example above then I'll use it.



---

archive/issue_comments_122649.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nTo my surprise, the patch does *not* solve the introspection problem mentioned in my previous post, even if Cython code is used.\n\nI think to make it work interactively should be moved on a different ticket. So, for now, I suggest to create a test class in sage.misc.sageinspect.",
    "created_at": "2012-11-27T16:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122649",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:29" align="right">comment:29</div>

To my surprise, the patch does *not* solve the introspection problem mentioned in my previous post, even if Cython code is used.

I think to make it work interactively should be moved on a different ticket. So, for now, I suggest to create a test class in sage.misc.sageinspect.



---

archive/issue_comments_122650.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI have folded the two patches into one, and I replaced some occurences of `trac ticket #...` by the appropriate `:trac:` directive.\n\nAnd of course I removed the `JackPolynomial` test. Instead, the sources of a dummy class are inspected, created only for testing.\n\nIt turned out to be impossible to put the dummy class into `sage.misc.sageinspect`, since importing `UniqueRepresentation` and `Parent` in `sageinspect` seems to create an import cycle. Hence, the dummy is now in `sage.structure.parent` - which should be \n\nApply trac11768_source_of_dynamic_class.patch",
    "created_at": "2012-11-27T20:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122650",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:30" align="right">comment:30</div>

I have folded the two patches into one, and I replaced some occurences of `trac ticket #...` by the appropriate `:trac:` directive.

And of course I removed the `JackPolynomial` test. Instead, the sources of a dummy class are inspected, created only for testing.

It turned out to be impossible to put the dummy class into `sage.misc.sageinspect`, since importing `UniqueRepresentation` and `Parent` in `sageinspect` seems to create an import cycle. Hence, the dummy is now in `sage.structure.parent` - which should be 

Apply trac11768_source_of_dynamic_class.patch



---

archive/issue_comments_122651.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -47,5 +47,4 @@\n **__Apply__**\n \n * [attachment: trac11768_source_of_dynamic_class.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)\n-* [attachment: trac11768_docfix.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_docfix.patch.gz)\n \n``````\n",
    "created_at": "2012-11-27T20:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122651",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -47,5 +47,4 @@
 **__Apply__**
 
 * [attachment: trac11768_source_of_dynamic_class.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)
-* [attachment: trac11768_docfix.patch](https://github.com/sagemath/sage/files/ticket11768/trac11768_docfix.patch.gz)
 
``````




---

archive/issue_comments_122652.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nHi Simon!\n\nThanks for your work on finalizing this. What about putting the example in a new separate file.\nWhat about putting the test class in a separate file like sage.misc.sageinspect_test.py that would only be imported in the doctest?\n\nCheers,\n                       Nicolas",
    "created_at": "2012-11-27T20:58:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122652",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:31" align="right">comment:31</div>

Hi Simon!

Thanks for your work on finalizing this. What about putting the example in a new separate file.
What about putting the test class in a separate file like sage.misc.sageinspect_test.py that would only be imported in the doctest?

Cheers,
                       Nicolas



---

archive/issue_comments_122653.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@nthiery](#comment%3A31):\n> Thanks for your work on finalizing this. What about putting the example in a new separate file.\n> What about putting the test class in a separate file like sage.misc.sageinspect_test.py that would only be imported in the doctest?\n\nVolker and Florent, do you agree with Nicolas that a separate file would be better?",
    "created_at": "2012-11-28T10:16:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122653",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@nthiery](#comment%3A31):
> Thanks for your work on finalizing this. What about putting the example in a new separate file.
> What about putting the test class in a separate file like sage.misc.sageinspect_test.py that would only be imported in the doctest?

Volker and Florent, do you agree with Nicolas that a separate file would be better?



---

archive/issue_comments_122654.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nIf you can't find an appropriate class to test it with then I'm fine with an extra file. I would suggest something in `sage/tests`, though. Maybe `sage/tests/sageinspect.py`. The file can also test itself so it would really be a test (ooh my head hurts now).",
    "created_at": "2012-11-28T10:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122654",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

If you can't find an appropriate class to test it with then I'm fine with an extra file. I would suggest something in `sage/tests`, though. Maybe `sage/tests/sageinspect.py`. The file can also test itself so it would really be a test (ooh my head hurts now).



---

archive/issue_comments_122655.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@vbraun](#comment%3A33):\n> If you can't find an appropriate class to test it with then I'm fine with an extra file. I would suggest something in `sage/tests`, though. Maybe `sage/tests/sageinspect.py`. \n\nI would argue for keeping the tests or test material close to the file under test. We already have sage.misc.nested_class_test which is very similar in purpose. Actually, maybe this should just go there!\n\n> The file can also test itself so it would really be a test (ooh my head hurts now).\n\n:-)",
    "created_at": "2012-11-28T20:34:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122655",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@vbraun](#comment%3A33):
> If you can't find an appropriate class to test it with then I'm fine with an extra file. I would suggest something in `sage/tests`, though. Maybe `sage/tests/sageinspect.py`. 

I would argue for keeping the tests or test material close to the file under test. We already have sage.misc.nested_class_test which is very similar in purpose. Actually, maybe this should just go there!

> The file can also test itself so it would really be a test (ooh my head hurts now).

:-)



---

archive/issue_comments_122656.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@nthiery](#comment%3A34):\n> I would argue for keeping the tests or test material close to the file under test. We already have sage.misc.nested_class_test which is very similar in purpose. Actually, maybe this should just go there!\n\nGood idea! I plan this for tomorrow.",
    "created_at": "2012-11-28T21:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122656",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@nthiery](#comment%3A34):
> I would argue for keeping the tests or test material close to the file under test. We already have sage.misc.nested_class_test which is very similar in purpose. Actually, maybe this should just go there!

Good idea! I plan this for tomorrow.



---

archive/issue_comments_122657.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nOK, done, ready for review!\n\nNot that the coverage script complains. But I think the coverage script has a bug, since it reports:\n\n```\nsimon@linux-sqwp:~/SAGE/debug/sage-5.5.rc0/devel/sage> ../../sage -coverage sage/misc/sageinspect.py\n----------------------------------------------------------------------\nsage/misc/sageinspect.py\nERROR: Please add a `TestSuite(s).run()` doctest.\nSCORE sage/misc/sageinspect.py: 60% (26 of 43)\n\nMissing documentation:\n         * foo(x, a=')\"', b={not (2+1==3):\n         * __init__(self):\n         * tokeneater(self, type, token, srow_scol, erow_ecol, line):\n         * foo(x, a=')\"', b={(2+1):\n         * foo(x, a='\\')\"', b={not (2+1==3):\n         * dummy' + _grep_first_pair_of_parentheses(source) + ':\\n return' try: return _sage_getargspec_from_ast(proxy) except SyntaxError: # To fix trac #10860. See #11913 for more information. return None elif isinstance(obj,functools.partial):\n         * test_funct(x,y):\n         * create_set_partition_function(letter, k):\n         * __cinit__(self):\n         * object pyobject(self):\n         * __init__(self, ring, gens, coerce=True):\n         * test1(a, b=2):\n         * test3(b, # 12 a=2):\n         * __init__(self, x=None, base=0):\n         * test1(a, b=2):\n         * test3(b, # 12 a=2):\n\n\nMissing doctests:\n         * _getblock(lines):\n\n\nPossibly wrong (function name doesn't occur in doctests):\n         * dummy' + source[beg:] + '\\n return' return tuple(_sage_getargspec_from_ast(proxy)) except Exception: try: # Try to parse just the arguments as a Python argspec. proxy = 'def dummy' + _grep_first_pair_of_parentheses(source) + ':\\n return' return tuple(_sage_getargspec_from_ast(proxy)) except Exception: raise ValueError, \"Could not parse cython argspec\" def sage_getfile(obj):\n```\n\nFirst bug: It expects a `TestSuite.run()` test, but there is no class defined for which this would make sense.\n\nSecond bug: The `dummy' + source[beg:] + '\\n return' return tuple(_sage_getargspec_from_ast(proxy))...` thingy.\n\nApply trac11768_source_of_dynamic_class.patch",
    "created_at": "2012-11-29T08:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122657",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:36" align="right">comment:36</div>

OK, done, ready for review!

Not that the coverage script complains. But I think the coverage script has a bug, since it reports:

```
simon@linux-sqwp:~/SAGE/debug/sage-5.5.rc0/devel/sage> ../../sage -coverage sage/misc/sageinspect.py
----------------------------------------------------------------------
sage/misc/sageinspect.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE sage/misc/sageinspect.py: 60% (26 of 43)

Missing documentation:
         * foo(x, a=')"', b={not (2+1==3):
         * __init__(self):
         * tokeneater(self, type, token, srow_scol, erow_ecol, line):
         * foo(x, a=')"', b={(2+1):
         * foo(x, a='\')"', b={not (2+1==3):
         * dummy' + _grep_first_pair_of_parentheses(source) + ':\n return' try: return _sage_getargspec_from_ast(proxy) except SyntaxError: # To fix trac #10860. See #11913 for more information. return None elif isinstance(obj,functools.partial):
         * test_funct(x,y):
         * create_set_partition_function(letter, k):
         * __cinit__(self):
         * object pyobject(self):
         * __init__(self, ring, gens, coerce=True):
         * test1(a, b=2):
         * test3(b, # 12 a=2):
         * __init__(self, x=None, base=0):
         * test1(a, b=2):
         * test3(b, # 12 a=2):


Missing doctests:
         * _getblock(lines):


Possibly wrong (function name doesn't occur in doctests):
         * dummy' + source[beg:] + '\n return' return tuple(_sage_getargspec_from_ast(proxy)) except Exception: try: # Try to parse just the arguments as a Python argspec. proxy = 'def dummy' + _grep_first_pair_of_parentheses(source) + ':\n return' return tuple(_sage_getargspec_from_ast(proxy)) except Exception: raise ValueError, "Could not parse cython argspec" def sage_getfile(obj):
```

First bug: It expects a `TestSuite.run()` test, but there is no class defined for which this would make sense.

Second bug: The `dummy' + source[beg:] + '\n return' return tuple(_sage_getargspec_from_ast(proxy))...` thingy.

Apply trac11768_source_of_dynamic_class.patch



---

archive/issue_comments_122658.json:
```json
{
    "body": "Work Issues: **import location for nested test class**",
    "created_at": "2012-11-30T14:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122658",
    "user": "https://github.com/simon-king-jena"
}
```

Work Issues: **import location for nested test class**



---

archive/issue_events_156588.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-11-30T14:16:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156588"
}
```



---

archive/issue_events_156589.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-11-30T14:16:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156589"
}
```



---

archive/issue_comments_122659.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nOops, I just notice that in one test I still try to import the testclass from sage.structure.parent. Needs a rather trivial fix...",
    "created_at": "2012-11-30T14:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122659",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:37" align="right">comment:37</div>

Oops, I just notice that in one test I still try to import the testclass from sage.structure.parent. Needs a rather trivial fix...



---

archive/issue_comments_122660.json:
```json
{
    "body": "Attachment: **[trac11768_source_of_dynamic_class.patch.gz](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)**\n\nGet source lines of dynamic classes (e.g., parent_class of a category). Combined patch",
    "created_at": "2012-11-30T14:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122660",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment: **[trac11768_source_of_dynamic_class.patch.gz](https://github.com/sagemath/sage/files/ticket11768/trac11768_source_of_dynamic_class.patch.gz)**

Get source lines of dynamic classes (e.g., parent_class of a category). Combined patch



---

archive/issue_events_156590.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-11-30T14:50:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156590"
}
```



---

archive/issue_events_156591.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-11-30T14:50:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156591"
}
```



---

archive/issue_comments_122661.json:
```json
{
    "body": "Changed work issues from **import location for nested test class** to none",
    "created_at": "2012-11-30T14:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122661",
    "user": "https://github.com/simon-king-jena"
}
```

Changed work issues from **import location for nested test class** to none



---

archive/issue_comments_122662.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nShould now be fixed!\n\nApply trac11768_source_of_dynamic_class.patch",
    "created_at": "2012-11-30T14:50:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122662",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:38" align="right">comment:38</div>

Should now be fixed!

Apply trac11768_source_of_dynamic_class.patch



---

archive/issue_comments_122663.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nLooks good to me.\n\nThe coverage script is going crazy. But the correct fix would be to replace the regex cludge with a python lexer/parser. Definitely material for another ticket...",
    "created_at": "2012-12-01T15:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122663",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">comment:39</div>

Looks good to me.

The coverage script is going crazy. But the correct fix would be to replace the regex cludge with a python lexer/parser. Definitely material for another ticket...



---

archive/issue_events_156592.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-01T15:08:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156592"
}
```



---

archive/issue_events_156593.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-01T15:08:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156593"
}
```



---

archive/issue_comments_122664.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2012-12-01T15:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122664",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_122665.json:
```json
{
    "body": "Merged: **sage-5.6.beta1**",
    "created_at": "2012-12-21T09:30:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11768#issuecomment-122665",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.6.beta1**



---

archive/issue_events_156594.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-21T09:30:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156594"
}
```



---

archive/issue_events_156595.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-21T09:30:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11768",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11768#event-156595"
}
```
