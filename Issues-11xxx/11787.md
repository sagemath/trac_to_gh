# Issue 11787: error in creating graphics with numpy arrays

archive/issues_011615.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @kcrisman @ppurka\n\n#7570 should have been implemented by doing a len()==0 test, rather than a direct comparison to empty lists/dicts/etc.  That allows things like numpy arrays, etc.\n\nI guess technically, numpy arrays aren't documented as being supported by list_plot, for example, so this might technically be an enhancement.\n\nSee http://groups.google.com/group/sage-support/browse_thread/thread/fb53b9d908acfb4 for a discussion of this bug.\n\n---\nApply only [attachment:trac_11787-allow_numpy_arrays.2.patch] to `devel/sage`\n\nIssue created by migration from https://trac.sagemath.org/ticket/11787\n\n",
    "closed_at": "2013-12-21T18:43:51Z",
    "created_at": "2011-09-11T03:04:54Z",
    "labels": [
        "component: graphics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "error in creating graphics with numpy arrays",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11787",
    "user": "https://github.com/jasongrout"
}
```
Assignee: jason, was

CC:  @kcrisman @ppurka

#7570 should have been implemented by doing a len()==0 test, rather than a direct comparison to empty lists/dicts/etc.  That allows things like numpy arrays, etc.

I guess technically, numpy arrays aren't documented as being supported by list_plot, for example, so this might technically be an enhancement.

See http://groups.google.com/group/sage-support/browse_thread/thread/fb53b9d908acfb4 for a discussion of this bug.

---
Apply only [attachment:trac_11787-allow_numpy_arrays.2.patch] to `devel/sage`

Issue created by migration from https://trac.sagemath.org/ticket/11787





---

archive/issue_comments_130974.json:
```json
{
    "body": "S",
    "created_at": "2011-09-11T03:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130974",
    "user": "https://github.com/jasongrout"
}
```

S



---

archive/issue_comments_130975.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-11-23T13:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130975",
    "user": "https://github.com/ppurka"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_130976.json:
```json
{
    "body": "Added patch to use numpy arrays. I am not happy with having to use len() but I don't know of a better way or non-ugly way to *not* traverse the whole list of input data. Hopefully, the impact to the running time is not too high for large input lists or tuples.\n\nThe alternative to checking `len(data) == 0` was something like the following (let's say we are calling `list_plot(data)`):\n\n```python\nimport collections\nif not isinstance(data, collections.Iterable):\n    raise TypeError\nif isinstance(data, dict) and not data:\n    return Graphics()\nif not isinstance(data, dict): # check that data is not a dict, to avoid KeyError\n    try:\n        a = data[0]\n    except IndexError: # this means we have an iterable with no items\n        return Graphics()\n```\n\nIf you would like me to patch up with this ugly kludge of a code instead of the simple `len(data) == 0`, then let me know - I will put up a new patch. :)\n\n*EDIT:* forgot to check for dict before `try`.",
    "created_at": "2012-11-23T13:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130976",
    "user": "https://github.com/ppurka"
}
```

Added patch to use numpy arrays. I am not happy with having to use len() but I don't know of a better way or non-ugly way to *not* traverse the whole list of input data. Hopefully, the impact to the running time is not too high for large input lists or tuples.

The alternative to checking `len(data) == 0` was something like the following (let's say we are calling `list_plot(data)`):

```python
import collections
if not isinstance(data, collections.Iterable):
    raise TypeError
if isinstance(data, dict) and not data:
    return Graphics()
if not isinstance(data, dict): # check that data is not a dict, to avoid KeyError
    try:
        a = data[0]
    except IndexError: # this means we have an iterable with no items
        return Graphics()
```

If you would like me to patch up with this ugly kludge of a code instead of the simple `len(data) == 0`, then let me know - I will put up a new patch. :)

*EDIT:* forgot to check for dict before `try`.



---

archive/issue_comments_130977.json:
```json
{
    "body": "This will not work, the elements of the array might be arrays\n\n```\nsage: var('x,y')\n(x, y)\nsage: x1=y  \nsage: y1=-x\nsage: A=desolve_odeint([x1,y1],[-0.5,0.3],srange(0,1,0.01),[x,y])\nsage: list_plot(A,plotjoined=True)\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: unable to coerce to a ComplexNumber: <type 'numpy.ndarray'>\n```\n\nTh erecommended way for lists tuples etc. would have been\n\n```\nif not data:\n   return Grpahics()\n}}\n\nBut this does not work with ndarrays. len is O(1) for these types.",
    "created_at": "2013-03-07T19:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130977",
    "user": "https://github.com/lftabera"
}
```

This will not work, the elements of the array might be arrays

```
sage: var('x,y')
(x, y)
sage: x1=y  
sage: y1=-x
sage: A=desolve_odeint([x1,y1],[-0.5,0.3],srange(0,1,0.01),[x,y])
sage: list_plot(A,plotjoined=True)
TypeError                                 Traceback (most recent call last)
...
TypeError: unable to coerce to a ComplexNumber: <type 'numpy.ndarray'>
```

Th erecommended way for lists tuples etc. would have been

```
if not data:
   return Grpahics()
}}

But this does not work with ndarrays. len is O(1) for these types.



---

archive/issue_comments_130978.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-08T12:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130978",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_130979.json:
```json
{
    "body": "`@`lftabera Thanks for looking into this. I will put up an updated patch to take care of ndarrays.",
    "created_at": "2013-03-08T12:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130979",
    "user": "https://github.com/ppurka"
}
```

`@`lftabera Thanks for looking into this. I will put up an updated patch to take care of ndarrays.



---

archive/issue_comments_130980.json:
```json
{
    "body": "Apply to devel/sage",
    "created_at": "2013-03-09T11:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130980",
    "user": "https://github.com/ppurka"
}
```

Apply to devel/sage



---

archive/issue_comments_130981.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-09T11:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130981",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_130982.json:
```json
{
    "body": "Attachment [trac_11787-allow_numpy_arrays.patch](tarball://root/attachments/some-uuid/ticket11787/trac_11787-allow_numpy_arrays.patch) by @ppurka created at 2013-03-09 11:35:58\n\nUpdated the patch to take care of ndarrays of ndarrays, or even lists of ndarrays. The following are the tests on a corei5 `@` 2.5GHz.\n\nThere is probably a very minor but insignificant slowdown. The tests of plot.py without this patch takes 220.4s and with this patch takes 223.3s, i.e., 3 seconds more. Given that two more plots are introduced in the doctest, I believe there is no perceptible slowdown to the `list_plot` code.\n\n```\n...sage-5.8.beta4/devel/sage\u00bb ../../sage -t -long sage/plot/plot.py  ## WITH PATCH\nsage -t -long \"devel/sage-main/sage/plot/plot.py\"\n\t [223.3 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 223.4 seconds\n...sage-5.8.beta4/devel/sage\u00bb hg qser\ntrac_10508_doctest.patch\ntrac_10508_update_atlas_docs.patch\ntrac_11787-allow_numpy_arrays.patch\n...sage-5.8.beta4/devel/sage\u00bb hg qpop trac_10508_update_atlas_docs.patch\nabort: local changes found, refresh first\n...8.beta4/devel/sage [255] \u00bb hg qref\n...sage-5.8.beta4/devel/sage\u00bb hg qpop trac_10508_update_atlas_docs.patch\npopping trac_11787-allow_numpy_arrays.patch\nnow at: trac_10508_update_atlas_docs.patch\n...sage-5.8.beta4/devel/sage\u00bb ../../sage -b >& /dev/null \n...sage-5.8.beta4/devel/sage\u00bb ../../sage -t -long sage/plot/plot.py   ## WITHOUT PATCH\nsage -t -long \"devel/sage-main/sage/plot/plot.py\"\n\t [220.4 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 220.4 seconds\n```",
    "created_at": "2013-03-09T11:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130982",
    "user": "https://github.com/ppurka"
}
```

Attachment [trac_11787-allow_numpy_arrays.patch](tarball://root/attachments/some-uuid/ticket11787/trac_11787-allow_numpy_arrays.patch) by @ppurka created at 2013-03-09 11:35:58

Updated the patch to take care of ndarrays of ndarrays, or even lists of ndarrays. The following are the tests on a corei5 `@` 2.5GHz.

There is probably a very minor but insignificant slowdown. The tests of plot.py without this patch takes 220.4s and with this patch takes 223.3s, i.e., 3 seconds more. Given that two more plots are introduced in the doctest, I believe there is no perceptible slowdown to the `list_plot` code.

```
...sage-5.8.beta4/devel/sage» ../../sage -t -long sage/plot/plot.py  ## WITH PATCH
sage -t -long "devel/sage-main/sage/plot/plot.py"
	 [223.3 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 223.4 seconds
...sage-5.8.beta4/devel/sage» hg qser
trac_10508_doctest.patch
trac_10508_update_atlas_docs.patch
trac_11787-allow_numpy_arrays.patch
...sage-5.8.beta4/devel/sage» hg qpop trac_10508_update_atlas_docs.patch
abort: local changes found, refresh first
...8.beta4/devel/sage [255] » hg qref
...sage-5.8.beta4/devel/sage» hg qpop trac_10508_update_atlas_docs.patch
popping trac_11787-allow_numpy_arrays.patch
now at: trac_10508_update_atlas_docs.patch
...sage-5.8.beta4/devel/sage» ../../sage -b >& /dev/null 
...sage-5.8.beta4/devel/sage» ../../sage -t -long sage/plot/plot.py   ## WITHOUT PATCH
sage -t -long "devel/sage-main/sage/plot/plot.py"
	 [220.4 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 220.4 seconds
```



---

archive/issue_comments_130983.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-26T15:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130983",
    "user": "https://github.com/lftabera"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_130984.json:
```json
{
    "body": "The following test now provides an empty graphics\n\nlist_plot([1, I, pi + I/2, CC(.25, .25)])\n\nI would try to avoid, if possible, the import of ndarray and testing for lists, tuples etc. It seems that line and plot can deal with ndarrays and ndarrays of ndarrays without problem.",
    "created_at": "2013-03-26T15:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130984",
    "user": "https://github.com/lftabera"
}
```

The following test now provides an empty graphics

list_plot([1, I, pi + I/2, CC(.25, .25)])

I would try to avoid, if possible, the import of ndarray and testing for lists, tuples etc. It seems that line and plot can deal with ndarrays and ndarrays of ndarrays without problem.



---

archive/issue_comments_130985.json:
```json
{
    "body": "Replying to [comment:8 lftabera]:\n> The following test now provides an empty graphics\n> \n> list_plot([1, I, pi + I/2, CC(.25, .25)])\n\n\nYikes! I learn something new everyday. I tried to avoid creating yet another list internally in the function by using `enumerate`. But this is an iterator and it runs through to the end of the list on one of the calls to `line` or `point`. And then if an exception is raised from those functions, then the list appears empty while trying the CC plots.\n\n> \n> I would try to avoid, if possible, the import of ndarray and testing for lists, tuples etc. It seems that line and plot can deal with ndarrays and ndarrays of ndarrays without problem.\n\n\nIndeed line and point can handle ndarrays. But the main problem is to detect when an empty array is passed in. Both those functions can not handle an empty numpy array. All this error checking was just to handle empty arrays :-|\n\n```\nsage: line(np.array([]))\n...\nValueError: there must be at least 2 points\n\nsage: line([])  # this is fine\nsage: point([]) # this is fine\n\nsage: point(np.array([]))\n...\nAttributeError: 'int' object has no attribute '_set_extra_kwds'\n```",
    "created_at": "2013-03-26T16:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130985",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:8 lftabera]:
> The following test now provides an empty graphics
> 
> list_plot([1, I, pi + I/2, CC(.25, .25)])


Yikes! I learn something new everyday. I tried to avoid creating yet another list internally in the function by using `enumerate`. But this is an iterator and it runs through to the end of the list on one of the calls to `line` or `point`. And then if an exception is raised from those functions, then the list appears empty while trying the CC plots.

> 
> I would try to avoid, if possible, the import of ndarray and testing for lists, tuples etc. It seems that line and plot can deal with ndarrays and ndarrays of ndarrays without problem.


Indeed line and point can handle ndarrays. But the main problem is to detect when an empty array is passed in. Both those functions can not handle an empty numpy array. All this error checking was just to handle empty arrays :-|

```
sage: line(np.array([]))
...
ValueError: there must be at least 2 points

sage: line([])  # this is fine
sage: point([]) # this is fine

sage: point(np.array([]))
...
AttributeError: 'int' object has no attribute '_set_extra_kwds'
```



---

archive/issue_comments_130986.json:
```json
{
    "body": "Oh I see what you mean. I should remove the checks for numpy. You have raised some very good points.",
    "created_at": "2013-03-26T16:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130986",
    "user": "https://github.com/ppurka"
}
```

Oh I see what you mean. I should remove the checks for numpy. You have raised some very good points.



---

archive/issue_comments_130987.json:
```json
{
    "body": "Hello, I finally got some time to look at this ticket again. This time it doesn't import numpy and the main changes are in the functions line and point, along with their 3D versions.\n\nIt passes all doctests in sage/plot. Unfortunately, patchbot is down now. :(\n\nPatchbot apply trac_11787-allow_numpy_arrays.2.patch",
    "created_at": "2013-04-19T16:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130987",
    "user": "https://github.com/ppurka"
}
```

Hello, I finally got some time to look at this ticket again. This time it doesn't import numpy and the main changes are in the functions line and point, along with their 3D versions.

It passes all doctests in sage/plot. Unfortunately, patchbot is down now. :(

Patchbot apply trac_11787-allow_numpy_arrays.2.patch



---

archive/issue_comments_130988.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-04-19T16:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130988",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_130989.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-05-10T08:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130989",
    "user": "https://github.com/lftabera"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_130990.json:
```json
{
    "body": "doctest fails on sage/schemes/elliptic_curves/heegner.py using sage 5.10.beta2, please check that your code is correct of if there is a bug in the mentioned file.",
    "created_at": "2013-05-10T08:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130990",
    "user": "https://github.com/lftabera"
}
```

doctest fails on sage/schemes/elliptic_curves/heegner.py using sage 5.10.beta2, please check that your code is correct of if there is a bug in the mentioned file.



---

archive/issue_comments_130991.json:
```json
{
    "body": "It seems to be an undocumented \"feature\" of the `point` function. Strictly speaking, the point function has no direct support for plotting a complex number. This is what the `heegner` function does - it passes a complex number to point. Surprising that it worked all these years.",
    "created_at": "2013-05-10T08:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130991",
    "user": "https://github.com/ppurka"
}
```

It seems to be an undocumented "feature" of the `point` function. Strictly speaking, the point function has no direct support for plotting a complex number. This is what the `heegner` function does - it passes a complex number to point. Surprising that it worked all these years.



---

archive/issue_comments_130992.json:
```json
{
    "body": "Attachment [trac_11787-heegner.patch](tarball://root/attachments/some-uuid/ticket11787/trac_11787-heegner.patch) by @ppurka created at 2013-05-10 08:49:18\n\nApply after previous file.",
    "created_at": "2013-05-10T08:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130992",
    "user": "https://github.com/ppurka"
}
```

Attachment [trac_11787-heegner.patch](tarball://root/attachments/some-uuid/ticket11787/trac_11787-heegner.patch) by @ppurka created at 2013-05-10 08:49:18

Apply after previous file.



---

archive/issue_comments_130993.json:
```json
{
    "body": "Added a patch to heegner.\n\nPatchbot apply trac_11787-allow_numpy_arrays.2.patch trac_11787-heegner.patch",
    "created_at": "2013-05-10T08:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130993",
    "user": "https://github.com/ppurka"
}
```

Added a patch to heegner.

Patchbot apply trac_11787-allow_numpy_arrays.2.patch trac_11787-heegner.patch



---

archive/issue_comments_130994.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-05-10T08:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130994",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_130995.json:
```json
{
    "body": "I do not convinced with this solution. While it is not documented, it is a nice side feature that CDF can be ploted. I have the gut that there should be another solution. The problem here is with ndarray not behaving as nice python objects. \n\nOne idea is to check first if data is a dictionary and, if not, just simply perform data=list(data). This would simplify the code a lot.",
    "created_at": "2013-05-10T09:37:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130995",
    "user": "https://github.com/lftabera"
}
```

I do not convinced with this solution. While it is not documented, it is a nice side feature that CDF can be ploted. I have the gut that there should be another solution. The problem here is with ndarray not behaving as nice python objects. 

One idea is to check first if data is a dictionary and, if not, just simply perform data=list(data). This would simplify the code a lot.



---

archive/issue_comments_130996.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-05-10T09:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130996",
    "user": "https://github.com/lftabera"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_130997.json:
```json
{
    "body": "I don't understand. This bug has nothing to do with numpy. It is using a misfeature and unintended use of points. There are other places in the heegner file where complex points are plotted correctly by using the proper conversion to a tuple containing the real part and the imaginary part separately.",
    "created_at": "2013-05-10T10:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130997",
    "user": "https://github.com/ppurka"
}
```

I don't understand. This bug has nothing to do with numpy. It is using a misfeature and unintended use of points. There are other places in the heegner file where complex points are plotted correctly by using the proper conversion to a tuple containing the real part and the imaginary part separately.



---

archive/issue_comments_130998.json:
```json
{
    "body": "I do not agree, if point2d expect lists, it should work with objects that can be interpreted as lists. We should not asks the user to pass strictly lists to the method. http://en.wikipedia.org/wiki/Duck_typing\n\nIn my opinion, line 377 of sage/plot/point.py should read:\n\n`if not points:`\n\nAnd line 2848 of heegner should read\n\n`return point([CDF(self.tau())], **kwds)`\n\nor maybe\n\n`return point(list(CDF(self.tau())), **kwds)`\n\nIn order not to fail on CDF(0.0)",
    "created_at": "2013-05-10T10:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130998",
    "user": "https://github.com/lftabera"
}
```

I do not agree, if point2d expect lists, it should work with objects that can be interpreted as lists. We should not asks the user to pass strictly lists to the method. http://en.wikipedia.org/wiki/Duck_typing

In my opinion, line 377 of sage/plot/point.py should read:

`if not points:`

And line 2848 of heegner should read

`return point([CDF(self.tau())], **kwds)`

or maybe

`return point(list(CDF(self.tau())), **kwds)`

In order not to fail on CDF(0.0)



---

archive/issue_comments_130999.json:
```json
{
    "body": "That's not correct. point2d can be passed any iterable that consists of a tuple or list of two coordinates. There is only one exception where you can pass a single tuple or a single list consisting of two coordinates.",
    "created_at": "2013-05-10T10:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-130999",
    "user": "https://github.com/ppurka"
}
```

That's not correct. point2d can be passed any iterable that consists of a tuple or list of two coordinates. There is only one exception where you can pass a single tuple or a single list consisting of two coordinates.



---

archive/issue_comments_131000.json:
```json
{
    "body": "Well, as point2d has incomplete documentation, it does not specify its input and this is argueable. \n\nFrom the python style guide www.python.org/dev/peps/pep-0008\n\n```\nFor sequences, (strings, lists, tuples), use the fact that empty sequences are false.\n\nYes: if not seq:\n     if seq:\n\nNo: if len(seq)\n    if not len(seq)\n```",
    "created_at": "2013-05-10T10:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131000",
    "user": "https://github.com/lftabera"
}
```

Well, as point2d has incomplete documentation, it does not specify its input and this is argueable. 

From the python style guide www.python.org/dev/peps/pep-0008

```
For sequences, (strings, lists, tuples), use the fact that empty sequences are false.

Yes: if not seq:
     if seq:

No: if len(seq)
    if not len(seq)
```



---

archive/issue_comments_131001.json:
```json
{
    "body": "Replying to [comment:20 lftabera]:\n> {{{\n> For sequences, (strings, lists, tuples), use the fact that empty sequences are false.\n> \n> Yes: if not seq:\n>      if seq:\n> \n> No: if len(seq)\n>     if not len(seq)\n> }}}\n\n\nThis thing doesn't work with numpy arrays. That's why I am using `len` and that's why I had to write the ugly patch earlier.\n\nThe documentation of point2d is clear enough with regard to its input:\n\n```\nPoint takes either a single tuple of coordinates or a list of tuples.\n```\nBut the way the function is written you can pass it either a list of tuples/list or a tuple of tuples/list, or with this patch a numpy array.\n\nEDIT: I wrote in comment:19 that point2d takes any iterable. This is incorrect. It takes in any list or tuple only.",
    "created_at": "2013-05-10T11:03:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131001",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:20 lftabera]:
> {{{
> For sequences, (strings, lists, tuples), use the fact that empty sequences are false.
> 
> Yes: if not seq:
>      if seq:
> 
> No: if len(seq)
>     if not len(seq)
> }}}


This thing doesn't work with numpy arrays. That's why I am using `len` and that's why I had to write the ugly patch earlier.

The documentation of point2d is clear enough with regard to its input:

```
Point takes either a single tuple of coordinates or a list of tuples.
```
But the way the function is written you can pass it either a list of tuples/list or a tuple of tuples/list, or with this patch a numpy array.

EDIT: I wrote in comment:19 that point2d takes any iterable. This is incorrect. It takes in any list or tuple only.



---

archive/issue_comments_131002.json:
```json
{
    "body": "Just FYI, #8082 added correct plotting of complex points.  Perhaps the input documentation needs to be updated, but there is an example in the documentation of it being used.  Note also #9982 and #4838.",
    "created_at": "2013-05-10T13:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131002",
    "user": "https://github.com/kcrisman"
}
```

Just FYI, #8082 added correct plotting of complex points.  Perhaps the input documentation needs to be updated, but there is an example in the documentation of it being used.  Note also #9982 and #4838.



---

archive/issue_comments_131003.json:
```json
{
    "body": "Replying to [comment:22 kcrisman]:\n> Just FYI, #8082 added correct plotting of complex points.  Perhaps the input documentation needs to be updated, but there is an example in the documentation of it being used.  Note also #9982 and #4838.\n\nUnfortunately, neither #8082 nor #4348 adds any documentation about plotting complex numbers directly via points. Plotting them via `plot` or `list_plot` is of course well documented.\n\n<Edited out>\n\nSince the patch here does not break the code which deals with more than one instance of complex numbers, I suggest that we proceed with the patches here and deal with complex numbers in `point` or `line` in #9982. The following *undocumented* behavior is broken with this ticket\n\n```\npoint(CC(I))\n```\nbut the following works\n\n```\npoint([CC(I)])\npoint([CC(I), CC(1)])\n```",
    "created_at": "2013-05-10T16:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131003",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:22 kcrisman]:
> Just FYI, #8082 added correct plotting of complex points.  Perhaps the input documentation needs to be updated, but there is an example in the documentation of it being used.  Note also #9982 and #4838.

Unfortunately, neither #8082 nor #4348 adds any documentation about plotting complex numbers directly via points. Plotting them via `plot` or `list_plot` is of course well documented.

<Edited out>

Since the patch here does not break the code which deals with more than one instance of complex numbers, I suggest that we proceed with the patches here and deal with complex numbers in `point` or `line` in #9982. The following *undocumented* behavior is broken with this ticket

```
point(CC(I))
```
but the following works

```
point([CC(I)])
point([CC(I), CC(1)])
```



---

archive/issue_comments_131004.json:
```json
{
    "body": "I think I must have been very tired the other day to write that `xydata_from_point_list` was \"incomplete\". The output is just fine. `:-S`.\n\nI will check if the behaviour of `point(CC(I))` can be fixed easily; otherwise I would like to postpone fixing that and the documentation of `point` to #9982.",
    "created_at": "2013-05-13T11:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131004",
    "user": "https://github.com/ppurka"
}
```

I think I must have been very tired the other day to write that `xydata_from_point_list` was "incomplete". The output is just fine. `:-S`.

I will check if the behaviour of `point(CC(I))` can be fixed easily; otherwise I would like to postpone fixing that and the documentation of `point` to #9982.



---

archive/issue_comments_131005.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-05-24T09:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131005",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_131006.json:
```json
{
    "body": "I updated the numpy patch to take care of complex numbers. It works in the cases where it used to work. See #9982 for the cases where it doesn't work.\n\nPatchbot apply trac_11787-allow_numpy_arrays.2.patch\n\n*Edit:*\n1. for reviewing, the diff between the previous and this numpy patch can be [seen here](https://github.com/ppurka/sage-patches/commit/eb0e8ecb81deff15735d656f2c73fc83d3e8c45b).\n2. the heegner patch is not needed any more.",
    "created_at": "2013-05-24T09:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131006",
    "user": "https://github.com/ppurka"
}
```

I updated the numpy patch to take care of complex numbers. It works in the cases where it used to work. See #9982 for the cases where it doesn't work.

Patchbot apply trac_11787-allow_numpy_arrays.2.patch

*Edit:*
1. for reviewing, the diff between the previous and this numpy patch can be [seen here](https://github.com/ppurka/sage-patches/commit/eb0e8ecb81deff15735d656f2c73fc83d3e8c45b).
2. the heegner patch is not needed any more.



---

archive/issue_comments_131007.json:
```json
{
    "body": "Updated to remove all use of len()",
    "created_at": "2013-05-24T11:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131007",
    "user": "https://github.com/ppurka"
}
```

Updated to remove all use of len()



---

archive/issue_comments_131008.json:
```json
{
    "body": "Attachment [trac_11787-allow_numpy_arrays.2.patch](tarball://root/attachments/some-uuid/ticket11787/trac_11787-allow_numpy_arrays.2.patch) by @ppurka created at 2013-05-24 11:41:08\n\nI removed the final use of len(). The diff to previous upload can be [seen here](https://github.com/ppurka/sage-patches/commit/e81459e3905962931e7b45b2880d176ad3094cf2).",
    "created_at": "2013-05-24T11:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131008",
    "user": "https://github.com/ppurka"
}
```

Attachment [trac_11787-allow_numpy_arrays.2.patch](tarball://root/attachments/some-uuid/ticket11787/trac_11787-allow_numpy_arrays.2.patch) by @ppurka created at 2013-05-24 11:41:08

I removed the final use of len(). The diff to previous upload can be [seen here](https://github.com/ppurka/sage-patches/commit/e81459e3905962931e7b45b2880d176ad3094cf2).



---

archive/issue_events_031015.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11787#event-31015"
}
```



---

archive/issue_comments_131009.json:
```json
{
    "body": "Code looks good to me, does not import numpy by default, works on the examples I have tried, doc looks good. \n\nThere are still some rough edges with line/plot but nothing to do with this ticket.",
    "created_at": "2013-12-21T12:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131009",
    "user": "https://github.com/lftabera"
}
```

Code looks good to me, does not import numpy by default, works on the examples I have tried, doc looks good. 

There are still some rough edges with line/plot but nothing to do with this ticket.



---

archive/issue_comments_131010.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-12-21T12:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131010",
    "user": "https://github.com/lftabera"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131011.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2013-12-21T12:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131011",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_131012.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2013-12-21T12:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131012",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_131013.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-12-21T12:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131013",
    "user": "https://github.com/lftabera"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131014.json:
```json
{
    "body": "Replying to [comment:28 lftabera]:\n> Code looks good to me, does not import numpy by default, works on the examples I have tried, doc looks good. \n\n\nThanks for the review and for converting it to a git commit!\n\n> There are still some rough edges with line/plot but nothing to do with this ticket.\n\n\nCan you open a ticket with the bad examples that you have?",
    "created_at": "2013-12-21T13:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131014",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:28 lftabera]:
> Code looks good to me, does not import numpy by default, works on the examples I have tried, doc looks good. 


Thanks for the review and for converting it to a git commit!

> There are still some rough edges with line/plot but nothing to do with this ticket.


Can you open a ticket with the bad examples that you have?



---

archive/issue_events_031016.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-21T18:43:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11787#event-31016"
}
```



---

archive/issue_comments_131015.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-12-21T18:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131015",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_131016.json:
```json
{
    "body": "See #16378 for a problem this seems to have caused.",
    "created_at": "2014-05-28T00:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11787#issuecomment-131016",
    "user": "https://github.com/kcrisman"
}
```

See #16378 for a problem this seems to have caused.
