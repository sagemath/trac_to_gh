# Issue 11168: rubiks fails doctest with gcc 4.6.0 and -O2 optimisation.

archive/issues_011015.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-drkirkby"
    ],
    "body": "On a Sun Ultra 27 running OpenSolaris 06/2009, the rubiks-20070912.p12 package builds, but fails a doctest\n\n```\ndrkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\nsage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\n**********************************************************************\nFile \"/export/home/drkirkby/sage-4.7.alpha3/devel/sage/sage/interfaces/rubik.py\", line 132:\n    sage: solver = OptimalSolver() # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[4]>\", line 1, in <module>\n        solver = OptimalSolver() # long time###line 132:\n    sage: solver = OptimalSolver() # long time\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py\", line 98, in __init__\n        self.ready()\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py\", line 117, in ready\n        self.child.expect('enter cube')\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py\", line 912, in expect\n        return self.expect_list(compiled_pattern_list, timeout, searchwindowsize)\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py\", line 978, in expect_list\n        raise EOF (str(e) + '\\n' + str(self))\n    EOF: End Of File (EOF) in read_nonblocking(). Empty string style platform.\n    <pexpect.spawn instance at 0xc5367ac>\n    version: 2.0 ($Revision: 1.151 $)\n    command: /export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal\n    args: ['/export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal']\n    patterns:\n        enter cube\n    buffer (last 100 chars): \n    before (last 100 chars): olutions\n    \n    initializing transformation tables\n    \n    init_fulledge_to_edgequot : too many  edgequot's\n\n    after: <class 'pexpect.EOF'>\n    match: None\n    match_index: None\n    exitstatus: None\n    flag_eof: 1\n    pid: 10994\n    child_fd: 3\n    timeout: None\n    delimiter: <class 'pexpect.EOF'>\n    logfile: None\n    maxread: 2000\n    searchwindowsize: None\n    delaybeforesend: 0.1\n**********************************************************************\n1 items had failures:\n   1 of  12 in __main__.example_3\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /export/home/drkirkby/.sage//tmp/.doctest_rubik.py\n         [9.4 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\nTotal time for all tests: 9.4 seconds\n```\n\nHowever, if the optimisation level is changed from -O2 to -O1, the program behaves properly. \n\n```\ndrkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\nsage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\n         [26.7 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 26.7 seconds\n```\n\nSimilar problems have been observed on other platforms too. A revised package, which works around the gcc 4.6.0 bug by adding the flag -fno-ivopts:\n\n[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg)\n\nReported upstream to gcc: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)\n\nFor other gcc 4.6.0 specific problems see #11216\n\nCC:  @jhpalmieri\n\nComponent: **porting: Solaris**\n\nAuthor: **David Kirkby, Jeroen Demeyer**\n\nReviewer: **John Palmieri, David Kirkby**\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\nMerged: **sage-4.7.rc2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11168_\n\n",
    "closed_at": "2011-05-08T00:28:39Z",
    "created_at": "2011-04-10T19:21:20Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20solaris",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "rubiks fails doctest with gcc 4.6.0 and -O2 optimisation.",
    "type": "issue",
    "updated_at": "2011-06-07T07:44:50Z",
    "url": "https://github.com/sagemath/sage/issues/11168",
    "user": "https://github.com/sagetrac-drkirkby"
}
```
On a Sun Ultra 27 running OpenSolaris 06/2009, the rubiks-20070912.p12 package builds, but fails a doctest

```
drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
**********************************************************************
File "/export/home/drkirkby/sage-4.7.alpha3/devel/sage/sage/interfaces/rubik.py", line 132:
    sage: solver = OptimalSolver() # long time
Exception raised:
    Traceback (most recent call last):
      File "/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/export/home/drkirkby/sage-4.7.alpha3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[4]>", line 1, in <module>
        solver = OptimalSolver() # long time###line 132:
    sage: solver = OptimalSolver() # long time
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py", line 98, in __init__
        self.ready()
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py", line 117, in ready
        self.child.expect('enter cube')
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py", line 912, in expect
        return self.expect_list(compiled_pattern_list, timeout, searchwindowsize)
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py", line 978, in expect_list
        raise EOF (str(e) + '\n' + str(self))
    EOF: End Of File (EOF) in read_nonblocking(). Empty string style platform.
    <pexpect.spawn instance at 0xc5367ac>
    version: 2.0 ($Revision: 1.151 $)
    command: /export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal
    args: ['/export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal']
    patterns:
        enter cube
    buffer (last 100 chars): 
    before (last 100 chars): olutions
    
    initializing transformation tables
    
    init_fulledge_to_edgequot : too many  edgequot's

    after: <class 'pexpect.EOF'>
    match: None
    match_index: None
    exitstatus: None
    flag_eof: 1
    pid: 10994
    child_fd: 3
    timeout: None
    delimiter: <class 'pexpect.EOF'>
    logfile: None
    maxread: 2000
    searchwindowsize: None
    delaybeforesend: 0.1
**********************************************************************
1 items had failures:
   1 of  12 in __main__.example_3
***Test Failed*** 1 failures.
For whitespace errors, see the file /export/home/drkirkby/.sage//tmp/.doctest_rubik.py
         [9.4 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
Total time for all tests: 9.4 seconds
```

However, if the optimisation level is changed from -O2 to -O1, the program behaves properly. 

```
drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
         [26.7 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 26.7 seconds
```

Similar problems have been observed on other platforms too. A revised package, which works around the gcc 4.6.0 bug by adding the flag -fno-ivopts:

[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg)

Reported upstream to gcc: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)

For other gcc 4.6.0 specific problems see #11216

CC:  @jhpalmieri

Component: **porting: Solaris**

Author: **David Kirkby, Jeroen Demeyer**

Reviewer: **John Palmieri, David Kirkby**

Upstream: **Fixed upstream, but not in a stable release.**

Merged: **sage-4.7.rc2**

_Issue created by migration from https://trac.sagemath.org/ticket/11168_





---

archive/issue_events_148037.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-10T19:21:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "milestone_number": null,
    "milestone_title": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148037"
}
```



---

archive/issue_events_148038.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-10T19:21:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20solaris",
    "label_color": "000080",
    "label_name": "c: porting: solaris",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148038"
}
```



---

archive/issue_events_148039.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-10T19:21:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148039"
}
```



---

archive/issue_events_148040.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-10T19:21:20Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "subject": "https://github.com/sagetrac-drkirkby",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148040"
}
```



---

archive/issue_events_148041.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-10T19:48:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148041"
}
```



---

archive/issue_events_148042.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-10T19:48:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148042"
}
```



---

archive/issue_comments_111157.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -69,4 +69,18 @@\n \n However, if the optimisation level is changed from -O2 to -O1, the program behaves properly. \n \n+```\n+drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\n+sage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\n+         [26.7 s]\n+ \n+----------------------------------------------------------------------\n+All tests passed!\n+Total time for all tests: 26.7 seconds\n+```\n \n+A revised package, which reduces the optimisation level on Solaris to -O1 can be found at\n+\n+http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p13.spkg\n+\n+\n``````\n",
    "created_at": "2011-04-10T19:48:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111157",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -69,4 +69,18 @@
 
 However, if the optimisation level is changed from -O2 to -O1, the program behaves properly. 
 
+```
+drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
+sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
+         [26.7 s]
+ 
+----------------------------------------------------------------------
+All tests passed!
+Total time for all tests: 26.7 seconds
+```
 
+A revised package, which reduces the optimisation level on Solaris to -O1 can be found at
+
+http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p13.spkg
+
+
``````




---

archive/issue_comments_111158.json:
```json
{
    "body": "Author: **David Kirkby**",
    "created_at": "2011-04-10T19:48:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111158",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Author: **David Kirkby**



---

archive/issue_comments_111159.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-On a Sun Ultra 27 running OpenSolaris06/2009, the rubiks-20070912.p12 package builds \n+On a Sun Ultra 27 running OpenSolaris 06/2009, the rubiks-20070912.p12 package builds, but fails a doctest\n \n ```\n drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\n``````\n",
    "created_at": "2011-04-10T19:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111159",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-On a Sun Ultra 27 running OpenSolaris06/2009, the rubiks-20070912.p12 package builds 
+On a Sun Ultra 27 running OpenSolaris 06/2009, the rubiks-20070912.p12 package builds, but fails a doctest
 
 ```
 drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
``````




---

archive/issue_events_148043.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-04-12T21:39:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148043"
}
```



---

archive/issue_events_148044.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-04-12T21:39:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148044"
}
```



---

archive/issue_comments_111160.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe patch is very simple.  The new spkg builds on both hawk (OpenSolaris on x86, with gcc 4.5.0 and gcc 4.6.0) and t2 (Solaris on sparc, with gcc 4.5.1 and 4.6.0), and tests pass in all cases.  With the old version, tests failed on both machines using gcc 4.6.0 (but everything worked fine with the earlier version of gcc).\n\nNote: to build with gcc 4.6.0 on t2, I had to set LD_LIBRARY_PATH and unset LD_OPTIONS; I couldn't get LD_OPTIONS to work.  But I don't really know how to properly use these variables anyway...",
    "created_at": "2011-04-12T21:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111160",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

The patch is very simple.  The new spkg builds on both hawk (OpenSolaris on x86, with gcc 4.5.0 and gcc 4.6.0) and t2 (Solaris on sparc, with gcc 4.5.1 and 4.6.0), and tests pass in all cases.  With the old version, tests failed on both machines using gcc 4.6.0 (but everything worked fine with the earlier version of gcc).

Note: to build with gcc 4.6.0 on t2, I had to set LD_LIBRARY_PATH and unset LD_OPTIONS; I couldn't get LD_OPTIONS to work.  But I don't really know how to properly use these variables anyway...



---

archive/issue_comments_111161.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2011-04-12T21:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111161",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_148045.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-13T15:18:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148045"
}
```



---

archive/issue_events_148046.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-13T15:18:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148046"
}
```



---

archive/issue_comments_111162.json:
```json
{
    "body": "Merged: **sage-4.7.alpha5**",
    "created_at": "2011-04-13T15:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111162",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.alpha5**



---

archive/issue_comments_111163.json:
```json
{
    "body": "Changed merged from **sage-4.7.alpha5** to none",
    "created_at": "2011-04-19T08:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111163",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.alpha5** to none



---

archive/issue_events_148047.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-19T08:56:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148047"
}
```



---

archive/issue_comments_111164.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nMarking this as needs_work because there are more systems with the same symptom.  In particular, on the buildbot Fedora 14-32 (cicero).",
    "created_at": "2011-04-19T08:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111164",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Marking this as needs_work because there are more systems with the same symptom.  In particular, on the buildbot Fedora 14-32 (cicero).



---

archive/issue_comments_111165.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAlso, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.",
    "created_at": "2011-04-19T08:57:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111165",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.



---

archive/issue_comments_111166.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment:7):\n> Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.\n\nIn the short term, I don't see we can do anything other than just lower the optimisation. \n\nIt should be noted that there are quite a few Sage patches applied - some directly to the source code, which should not have been done, but has been done. This package has been patched 13 times already! \n\nDave",
    "created_at": "2011-04-19T21:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111166",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment:7):
> Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.

In the short term, I don't see we can do anything other than just lower the optimisation. 

It should be noted that there are quite a few Sage patches applied - some directly to the source code, which should not have been done, but has been done. This package has been patched 13 times already! 

Dave



---

archive/issue_comments_111167.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -79,7 +79,7 @@\n Total time for all tests: 26.7 seconds\n ```\n \n-A revised package, which reduces the optimisation level on Solaris to -O1 can be found at\n+Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 can be found at\n \n http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p13.spkg\n \n``````\n",
    "created_at": "2011-04-19T21:29:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111167",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -79,7 +79,7 @@
 Total time for all tests: 26.7 seconds
 ```
 
-A revised package, which reduces the optimisation level on Solaris to -O1 can be found at
+Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 can be found at
 
 http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p13.spkg
 
``````




---

archive/issue_events_148048.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-19T21:29:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148048"
}
```



---

archive/issue_events_148049.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-19T21:29:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148049"
}
```



---

archive/issue_comments_111168.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHere's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. \n\nDave",
    "created_at": "2011-04-19T21:29:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111168",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:9" align="right">comment:9</div>

Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. 

Dave



---

archive/issue_events_148050.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-19T21:31:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "title_is": "rubiks fails doctest with gcc 4.6.0 and -O2 optimisation.",
    "title_was": "rubiks fails doctest on OpenSolaris x86 with gcc 4.6.0 and -O2 optimisation.",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148050"
}
```



---

archive/issue_comments_111169.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@sagetrac-drkirkby](#comment:9):\n> Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. \n> \n> Dave \n\nThe grammar was not very good there! The point being, this patch changes the optimisation to -O1 on all platforms. \n\nDave",
    "created_at": "2011-04-19T21:31:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111169",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@sagetrac-drkirkby](#comment:9):
> Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. 
> 
> Dave 

The grammar was not very good there! The point being, this patch changes the optimisation to -O1 on all platforms. 

Dave



---

archive/issue_comments_111170.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI believe only the file src/reid/optimal.c needs to be reduced\nto -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)",
    "created_at": "2011-04-20T14:27:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111170",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:11" align="right">comment:11</div>

I believe only the file src/reid/optimal.c needs to be reduced
to -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)



---

archive/issue_comments_111171.json:
```json
{
    "body": "Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. Little or no feedback.**",
    "created_at": "2011-04-20T14:27:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111171",
    "user": "https://github.com/sagetrac-mariah"
}
```

Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. Little or no feedback.**



---

archive/issue_events_148051.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-04-20T14:27:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148051"
}
```



---

archive/issue_events_148052.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-04-20T14:27:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148052"
}
```



---

archive/issue_comments_111172.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2011-04-20T14:31:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111172",
    "user": "https://github.com/sagetrac-mariah"
}
```

Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_111173.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@sagetrac-mariah](#comment:11):\n> I believe only the file src/reid/optimal.c needs to be reduced\n> to -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)\n\nMany thanks for sorting this out!!!\n\nI'm not so sure whether it makes sense to change the optimization level for just 1 file.  Maybe the whole directory `src/reid` yes, but one file?",
    "created_at": "2011-04-20T14:46:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111173",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@sagetrac-mariah](#comment:11):
> I believe only the file src/reid/optimal.c needs to be reduced
> to -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)

Many thanks for sorting this out!!!

I'm not so sure whether it makes sense to change the optimization level for just 1 file.  Maybe the whole directory `src/reid` yes, but one file?



---

archive/issue_comments_111174.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI don't know for sure, but I don't believe any of this is going to be too time-critical. I can't somehow seeing one wanting to solve lots of rubiks cubes and given solving them takes very little time, I don't see this as very important if we lose a few clock cycles here or there. \n\ndave",
    "created_at": "2011-04-20T14:55:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111174",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:14" align="right">comment:14</div>

I don't know for sure, but I don't believe any of this is going to be too time-critical. I can't somehow seeing one wanting to solve lots of rubiks cubes and given solving them takes very little time, I don't see this as very important if we lose a few clock cycles here or there. 

dave



---

archive/issue_comments_111175.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nSince this is clearly a gcc 4.6.0 bug, I suggest to check in `spkg-install` whether we are using gcc 4.6.0 and *only* reduce the optimization level to -O1 if so.\n\nAnother annoying thing about this package is that some of the patches in `patches/` are the wrong way around (they are patches *from* the patched version *to* the original version).",
    "created_at": "2011-04-20T14:57:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111175",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Since this is clearly a gcc 4.6.0 bug, I suggest to check in `spkg-install` whether we are using gcc 4.6.0 and *only* reduce the optimization level to -O1 if so.

Another annoying thing about this package is that some of the patches in `patches/` are the wrong way around (they are patches *from* the patched version *to* the original version).



---

archive/issue_events_148053.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-23T08:55:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148053"
}
```



---

archive/issue_events_148054.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-23T08:55:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148054"
}
```



---

archive/issue_comments_111176.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI've now changed this so instead of reducing the optimisation on Solaris, it does it on all platforms with gcc 4.6.0. First it tests for gcc using `$SAGE_LOCAL/bin/testcc.sh`, then if we are using gcc, a second test is performed for gcc 4.6.0 by adding the '`dumpversion`' option to gcc. \n\nThe following is the critical bit of new code.\n\n```\nOPTIMIZATION_FLAGS=\"-O2\"\nif [ \"x`$SAGE_LOCAL/bin/testcc.sh $CC`\" = xGCC ] && [ \"x`$CC -dumpversion`\" = x4.6.0 ] ; then \n   echo \"Warning: Reducing the optimisation level to -O1 due to a bug in gcc 4.6.0\"\n   OPTIMIZATION_FLAGS=\"-O1\"\nfi\n```\n\nThere are some typos corrected too - see the attached patch. \n\nDave",
    "created_at": "2011-04-23T08:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111176",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:16" align="right">comment:16</div>

I've now changed this so instead of reducing the optimisation on Solaris, it does it on all platforms with gcc 4.6.0. First it tests for gcc using `$SAGE_LOCAL/bin/testcc.sh`, then if we are using gcc, a second test is performed for gcc 4.6.0 by adding the '`dumpversion`' option to gcc. 

The following is the critical bit of new code.

```
OPTIMIZATION_FLAGS="-O2"
if [ "x`$SAGE_LOCAL/bin/testcc.sh $CC`" = xGCC ] && [ "x`$CC -dumpversion`" = x4.6.0 ] ; then 
   echo "Warning: Reducing the optimisation level to -O1 due to a bug in gcc 4.6.0"
   OPTIMIZATION_FLAGS="-O1"
fi
```

There are some typos corrected too - see the attached patch. 

Dave



---

archive/issue_comments_111177.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -79,8 +79,8 @@\n Total time for all tests: 26.7 seconds\n ```\n \n-Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 can be found at\n+Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 if using gcc 4.6.0 can be found at\n \n-http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p13.spkg\n+http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p14.spkg\n \n \n``````\n",
    "created_at": "2011-04-23T08:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111177",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -79,8 +79,8 @@
 Total time for all tests: 26.7 seconds
 ```
 
-Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 can be found at
+Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 if using gcc 4.6.0 can be found at
 
-http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p13.spkg
+http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p14.spkg
 
 
``````




---

archive/issue_comments_111178.json:
```json
{
    "body": "Attachment: **[rubiks-optimisation-problem.patch.gz](https://github.com/sagemath/sage/files/ticket11168/rubiks-optimisation-problem.patch.gz)**\n\nPatch which changes optimisation to -O1 if using gcc 4.6.0  (for review purposes only - changes are in the .spkg)",
    "created_at": "2011-04-23T09:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111178",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Attachment: **[rubiks-optimisation-problem.patch.gz](https://github.com/sagemath/sage/files/ticket11168/rubiks-optimisation-problem.patch.gz)**

Patch which changes optimisation to -O1 if using gcc 4.6.0  (for review purposes only - changes are in the .spkg)



---

archive/issue_comments_111179.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -83,4 +83,4 @@\n \n http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p14.spkg\n \n-\n+For other gcc 4.6.0 specific problems see #11216\n``````\n",
    "created_at": "2011-04-23T09:14:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111179",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -83,4 +83,4 @@
 
 http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p14.spkg
 
-
+For other gcc 4.6.0 specific problems see #11216
``````




---

archive/issue_comments_111180.json:
```json
{
    "body": "Changed author from **David Kirkby** to **David Kirkby, Jeroen Demeyer**",
    "created_at": "2011-04-25T10:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111180",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **David Kirkby** to **David Kirkby, Jeroen Demeyer**



---

archive/issue_comments_111181.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nDavid, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):\n[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)",
    "created_at": "2011-04-25T10:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111181",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):
[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)



---

archive/issue_comments_111182.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -79,8 +79,8 @@\n Total time for all tests: 26.7 seconds\n ```\n \n-Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 if using gcc 4.6.0 can be found at\n+Similar problems have been observed on other platforms too. A revised package, which works around the gcc 4.6.0 bug by adding the flag -fno-ivopts:\n \n-http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p14.spkg\n+[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)\n \n For other gcc 4.6.0 specific problems see #11216\n``````\n",
    "created_at": "2011-04-25T10:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111182",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -79,8 +79,8 @@
 Total time for all tests: 26.7 seconds
 ```
 
-Similar problems have been observed on other platforms too. A revised package, which reduces the optimisation level to -O1 if using gcc 4.6.0 can be found at
+Similar problems have been observed on other platforms too. A revised package, which works around the gcc 4.6.0 bug by adding the flag -fno-ivopts:
 
-http://boxen.math.washington.edu/home/kirkby/patches/rubiks-20070912.p14.spkg
+[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)
 
 For other gcc 4.6.0 specific problems see #11216
``````




---

archive/issue_comments_111183.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@jdemeyer](#comment:18):\n> David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):\n> [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)\n\nI think my test\n\n```\nif [ \"x`$SAGE_LOCAL/bin/testcc.sh $CC`\" = xGCC ] && [ \"x`$CC -dumpversion`\" = x4.6.0 ] ; then  \n```\n\nfor the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, \n\nAlso, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. \n\nDave",
    "created_at": "2011-04-25T12:05:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111183",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@jdemeyer](#comment:18):
> David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):
> [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)

I think my test

```
if [ "x`$SAGE_LOCAL/bin/testcc.sh $CC`" = xGCC ] && [ "x`$CC -dumpversion`" = x4.6.0 ] ; then  
```

for the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, 

Also, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. 

Dave



---

archive/issue_comments_111184.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@sagetrac-drkirkby](#comment:19):\n> Replying to [@jdemeyer](#comment:18):\n> > David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):\n> > [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)\n\n> \n> I think my test\n> \n> ```\n> if [ \"x`$SAGE_LOCAL/bin/testcc.sh $CC`\" = xGCC ] && [ \"x`$CC -dumpversion`\" = x4.6.0 ] ; then  \n> ```\n> \n> for the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, \n> \n> Also, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. \n\nMy test *does* test for gcc in the `--version` output.\n\nIf I change the gcc test to use your original test code, would the rest of my patch get positive_review?",
    "created_at": "2011-04-25T12:13:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111184",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@sagetrac-drkirkby](#comment:19):
> Replying to [@jdemeyer](#comment:18):
> > David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):
> > [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)

> 
> I think my test
> 
> ```
> if [ "x`$SAGE_LOCAL/bin/testcc.sh $CC`" = xGCC ] && [ "x`$CC -dumpversion`" = x4.6.0 ] ; then  
> ```
> 
> for the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, 
> 
> Also, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. 

My test *does* test for gcc in the `--version` output.

If I change the gcc test to use your original test code, would the rest of my patch get positive_review?



---

archive/issue_comments_111185.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nDavid, another minor issue with your test:\nI would change <code>[ \"x\\`$CC -dumpversion\\`\" = x4.6.0 ]</code> to <code>[ \"x\\`$CC -dumpversion 2>/dev/null\\`\" = x4.6.0 ]</code> in case that `$CC` does not support `-dumpversion`.",
    "created_at": "2011-04-25T13:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111185",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

David, another minor issue with your test:
I would change <code>[ "x\`$CC -dumpversion\`" = x4.6.0 ]</code> to <code>[ "x\`$CC -dumpversion 2>/dev/null\`" = x4.6.0 ]</code> in case that `$CC` does not support `-dumpversion`.



---

archive/issue_comments_111186.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jdemeyer](#comment:21):\n> David, another minor issue with your test:\n> I would change <code>[ \"x\\`$CC -dumpversion\\`\" = x4.6.0 ]</code> to <code>[ \"x\\`$CC -dumpversion 2>/dev/null\\`\" = x4.6.0 ]</code> in case that `$CC` does not support `-dumpversion`.\n\nI need to be doing something else now (gardening), so don't have chance to do much with this, but a few quick notes. \n \n* My machine is rather busy now, doing a scrub of the disks (Google scrub and ZFS if you want). The test took 130.9 seconds, compared to the 26.7 seconds with just -O1. That's slowed down by a factor of almost 5. Perhaps the load on my machine has caused this, but can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1. \n* My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact. \n* A very minor point, but it would be worth putting a link to the gcc bug in SPKG.txt. \n\nAssuming you can confirm the new compiler option given does not cause a dramatic slowdown, and change the test, then feel free to change the ticket to positive review - don't wait for me. Issues about SPKG.txt and /dev/null are not too critical - make what changes you feel are appropriate. \n\nDave",
    "created_at": "2011-04-25T14:17:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111186",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jdemeyer](#comment:21):
> David, another minor issue with your test:
> I would change <code>[ "x\`$CC -dumpversion\`" = x4.6.0 ]</code> to <code>[ "x\`$CC -dumpversion 2>/dev/null\`" = x4.6.0 ]</code> in case that `$CC` does not support `-dumpversion`.

I need to be doing something else now (gardening), so don't have chance to do much with this, but a few quick notes. 
 
* My machine is rather busy now, doing a scrub of the disks (Google scrub and ZFS if you want). The test took 130.9 seconds, compared to the 26.7 seconds with just -O1. That's slowed down by a factor of almost 5. Perhaps the load on my machine has caused this, but can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1. 
* My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact. 
* A very minor point, but it would be worth putting a link to the gcc bug in SPKG.txt. 

Assuming you can confirm the new compiler option given does not cause a dramatic slowdown, and change the test, then feel free to change the ticket to positive review - don't wait for me. Issues about SPKG.txt and /dev/null are not too critical - make what changes you feel are appropriate. 

Dave



---

archive/issue_comments_111187.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@sagetrac-drkirkby](#comment:22):\n> can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1.\n\nOn my machine (`Linux arcanis 2.6.34-gentoo-r12 #2 SMP Mon Dec 6 17:16:04 CET 2010 x86_64 Intel(R) Core(TM)2 Duo CPU T5870 @ 2.00GHz GenuineIntel GNU/Linux`) with gcc 4.6.0, the long test `sage/interfaces/rubik.py` takes:\n1. p14 (using `-O1`): 39.9 s\n2. p15 (using `-O2 -fno-ivopts`): 37.5 s",
    "created_at": "2011-04-25T16:36:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111187",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@sagetrac-drkirkby](#comment:22):
> can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1.

On my machine (`Linux arcanis 2.6.34-gentoo-r12 #2 SMP Mon Dec 6 17:16:04 CET 2010 x86_64 Intel(R) Core(TM)2 Duo CPU T5870 @ 2.00GHz GenuineIntel GNU/Linux`) with gcc 4.6.0, the long test `sage/interfaces/rubik.py` takes:
1. p14 (using `-O1`): 39.9 s
2. p15 (using `-O2 -fno-ivopts`): 37.5 s



---

archive/issue_comments_111188.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@sagetrac-drkirkby](#comment:22):\n> * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.\n\nCan you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?",
    "created_at": "2011-04-25T16:38:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111188",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@sagetrac-drkirkby](#comment:22):
> * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.

Can you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?



---

archive/issue_comments_111189.json:
```json
{
    "body": "Attachment: **[rubiks-20070912.p14-p15.diff.gz](https://github.com/sagemath/sage/files/ticket11168/rubiks-20070912.p14-p15.diff.gz)**\n\ndiff p14 -> p15 (for reviewing only)",
    "created_at": "2011-04-25T17:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111189",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[rubiks-20070912.p14-p15.diff.gz](https://github.com/sagemath/sage/files/ticket11168/rubiks-20070912.p14-p15.diff.gz)**

diff p14 -> p15 (for reviewing only)



---

archive/issue_comments_111190.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@jdemeyer](#comment:24):\n> Replying to [@sagetrac-drkirkby](#comment:22):\n> > * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.\n\n> \n> Can you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?\n\nI think if any compiler is going to aim to be GCC compatible then it would need to support the '`-dumpversion`' option. If it does not, then I would consider that a compiler bug. The Intel compiler supports '`-dumpversion`' - see\n\nhttp://software.intel.com/sites/products/documentation/hpc/compilerpro/en-us/cpp/lin/main_cls_lin.pdf\n\nClang does too:\n\nhttps://llvm.org/viewvc/llvm-project/cfe/trunk/include/clang/Driver/Options.td?sortby=date&r1=106956&r2=106955&pathrev=106956&diff_format=s\n\n*GCC For Sun Systems* uses the gcc front end and takes the GNU options. It actually uses the GCC source code, so I assume that would take the '`-dumpversion`' option too. \n\nI'm not aware of any other GCC compatible compiler. But if they really are GCC compatible, they should take the '`-dumpversion`' option. \n\nI've just checked gcc 3.4.3, and that takes the '`-dumpversion`' option. \n\n```\ndrkirkby@hawk:~$ /usr/bin/gcc -dumpversion\n3.4.3\ndrkirkby@hawk:~$ /usr/bin/g++ -dumpversion\n3.4.3\ndrkirkby@hawk:~$ \n```\n\nJust out of interest, I checked on t2.math (a SPARC system), and that supports `-dumpversion`' too.\n\n```\nkirkby@t2:32 ~$ /usr/sfw/bin/gcc -dumpversion\n3.4.3\n```\n\nI would use more caution if it was the Fortran compiler we were testing, as the option gave a different output (same as --version) in older versions of gfortran. But that bug was fixed a year or two ago, so that now '`gfortran`' gives just the version number if given the option '`-dumpversion`'. But that test in the rubiks package only tests the C compiler, so it's immaterial what `gfortran` does. \n\nI would also note we are using the `-dumpversion`' compiler option already. The 'prereq' script uses two autoconf macros (`ax_gcc_version.m4` & `ax_gxx_version.m4`) which use the option. That is run to check the versions of gcc and g++ are the same. So I think if there was a problem using the `-dumpversion`' compiler option, we would have known about it before. \n\nDave",
    "created_at": "2011-04-26T06:56:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111190",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@jdemeyer](#comment:24):
> Replying to [@sagetrac-drkirkby](#comment:22):
> > * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.

> 
> Can you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?

I think if any compiler is going to aim to be GCC compatible then it would need to support the '`-dumpversion`' option. If it does not, then I would consider that a compiler bug. The Intel compiler supports '`-dumpversion`' - see

http://software.intel.com/sites/products/documentation/hpc/compilerpro/en-us/cpp/lin/main_cls_lin.pdf

Clang does too:

https://llvm.org/viewvc/llvm-project/cfe/trunk/include/clang/Driver/Options.td?sortby=date&r1=106956&r2=106955&pathrev=106956&diff_format=s

*GCC For Sun Systems* uses the gcc front end and takes the GNU options. It actually uses the GCC source code, so I assume that would take the '`-dumpversion`' option too. 

I'm not aware of any other GCC compatible compiler. But if they really are GCC compatible, they should take the '`-dumpversion`' option. 

I've just checked gcc 3.4.3, and that takes the '`-dumpversion`' option. 

```
drkirkby@hawk:~$ /usr/bin/gcc -dumpversion
3.4.3
drkirkby@hawk:~$ /usr/bin/g++ -dumpversion
3.4.3
drkirkby@hawk:~$ 
```

Just out of interest, I checked on t2.math (a SPARC system), and that supports `-dumpversion`' too.

```
kirkby@t2:32 ~$ /usr/sfw/bin/gcc -dumpversion
3.4.3
```

I would use more caution if it was the Fortran compiler we were testing, as the option gave a different output (same as --version) in older versions of gfortran. But that bug was fixed a year or two ago, so that now '`gfortran`' gives just the version number if given the option '`-dumpversion`'. But that test in the rubiks package only tests the C compiler, so it's immaterial what `gfortran` does. 

I would also note we are using the `-dumpversion`' compiler option already. The 'prereq' script uses two autoconf macros (`ax_gcc_version.m4` & `ax_gxx_version.m4`) which use the option. That is run to check the versions of gcc and g++ are the same. So I think if there was a problem using the `-dumpversion`' compiler option, we would have known about it before. 

Dave



---

archive/issue_comments_111191.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nDavid, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?",
    "created_at": "2011-04-26T07:40:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111191",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?



---

archive/issue_events_148055.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-26T07:40:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148055"
}
```



---

archive/issue_events_148056.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-26T07:40:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148056"
}
```



---

archive/issue_comments_111192.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@jdemeyer](#comment:26):\n> David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?\n\nSure.",
    "created_at": "2011-04-26T10:45:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111192",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@jdemeyer](#comment:26):
> David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?

Sure.



---

archive/issue_events_148057.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-26T10:45:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148057"
}
```



---

archive/issue_events_148058.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-04-26T10:45:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148058"
}
```



---

archive/issue_comments_111193.json:
```json
{
    "body": "Merged: **sage-4.7.rc1**",
    "created_at": "2011-04-26T12:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111193",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.rc1**



---

archive/issue_events_148059.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-26T12:18:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148059"
}
```



---

archive/issue_events_148060.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-26T12:18:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148060"
}
```



---

archive/issue_comments_111194.json:
```json
{
    "body": "Changed merged from **sage-4.7.rc1** to none",
    "created_at": "2011-05-03T12:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111194",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.rc1** to none



---

archive/issue_comments_111195.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -81,6 +81,6 @@\n \n Similar problems have been observed on other platforms too. A revised package, which works around the gcc 4.6.0 bug by adding the flag -fno-ivopts:\n \n-[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)\n+[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg)\n \n For other gcc 4.6.0 specific problems see #11216\n``````\n",
    "created_at": "2011-05-03T13:03:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111195",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -81,6 +81,6 @@
 
 Similar problems have been observed on other platforms too. A revised package, which works around the gcc 4.6.0 bug by adding the flag -fno-ivopts:
 
-[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)
+[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg)
 
 For other gcc 4.6.0 specific problems see #11216
``````




---

archive/issue_events_148061.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-03T13:03:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148061"
}
```



---

archive/issue_comments_111196.json:
```json
{
    "body": "Changed reviewer from **John Palmieri** to **John Palmieri, David Kirkby**",
    "created_at": "2011-05-03T13:31:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111196",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **John Palmieri** to **John Palmieri, David Kirkby**



---

archive/issue_comments_111197.json:
```json
{
    "body": "Attachment: **[rubiks-20070912.p15-p16.diff.gz](https://github.com/sagemath/sage/files/ticket11168/rubiks-20070912.p15-p16.diff.gz)**\n\nDiff for the rubiks spkg, for reviewing only",
    "created_at": "2011-05-03T15:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111197",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[rubiks-20070912.p15-p16.diff.gz](https://github.com/sagemath/sage/files/ticket11168/rubiks-20070912.p15-p16.diff.gz)**

Diff for the rubiks spkg, for reviewing only



---

archive/issue_events_148062.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-05-03T20:30:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148062"
}
```



---

archive/issue_events_148063.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-05-03T20:30:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148063"
}
```



---

archive/issue_comments_111198.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThe patch will be applied for later versions than just gcc-4.6.0.\nRecommend that the patch only be applied for gcc-4.6.0.",
    "created_at": "2011-05-03T20:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111198",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:32" align="right">comment:32</div>

The patch will be applied for later versions than just gcc-4.6.0.
Recommend that the patch only be applied for gcc-4.6.0.



---

archive/issue_comments_111199.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@sagetrac-mariah](#comment:32):\n> The patch will be applied for later versions than just gcc-4.6.0.\n> Recommend that the patch only be applied for gcc-4.6.0.  \n\nWhy?\n\nThere already exist pre-release versions of gcc 4.6.1 manifesting the same problem.\n\nI think that having the workaround for all versions 4.6.x doesn't really hurt.  It is certainly a safer alternative than applying the workaround only for gcc 4.6.0.  If at some point, this bug is fixed in a later gcc 4.6.x, then we can still change the spkg accordingly.",
    "created_at": "2011-05-04T07:31:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111199",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@sagetrac-mariah](#comment:32):
> The patch will be applied for later versions than just gcc-4.6.0.
> Recommend that the patch only be applied for gcc-4.6.0.  

Why?

There already exist pre-release versions of gcc 4.6.1 manifesting the same problem.

I think that having the workaround for all versions 4.6.x doesn't really hurt.  It is certainly a safer alternative than applying the workaround only for gcc 4.6.0.  If at some point, this bug is fixed in a later gcc 4.6.x, then we can still change the spkg accordingly.



---

archive/issue_events_148064.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-04T07:31:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148064"
}
```



---

archive/issue_events_148065.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-04T07:31:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148065"
}
```



---

archive/issue_comments_111200.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -83,4 +83,6 @@\n \n [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg)\n \n+Reported upstream to gcc: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)\n+\n For other gcc 4.6.0 specific problems see #11216\n``````\n",
    "created_at": "2011-05-04T07:49:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111200",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -83,4 +83,6 @@
 
 [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p16.spkg)
 
+Reported upstream to gcc: [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)
+
 For other gcc 4.6.0 specific problems see #11216
``````




---

archive/issue_comments_111201.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nCan somebody please review?  Thanks.",
    "created_at": "2011-05-07T11:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111201",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

Can somebody please review?  Thanks.



---

archive/issue_events_148066.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-05-07T22:27:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148066"
}
```



---

archive/issue_events_148067.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2011-05-07T22:27:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148067"
}
```



---

archive/issue_comments_111202.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@jdemeyer](#comment:35):\n> Can somebody please review?  Thanks.\n\nSure:\n\n```\ndrkirkby@hawk:~/sage-4.7.rc0$  ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\nsage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\n\t [25.5 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 25.6 seconds\n```\n\nso that option is working to resolve the bug on OpenSolaris too. This looks good to me. \n\nDave",
    "created_at": "2011-05-07T22:27:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111202",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@jdemeyer](#comment:35):
> Can somebody please review?  Thanks.

Sure:

```
drkirkby@hawk:~/sage-4.7.rc0$  ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
	 [25.5 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 25.6 seconds
```

so that option is working to resolve the bug on OpenSolaris too. This looks good to me. 

Dave



---

archive/issue_events_148068.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-08T00:28:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148068"
}
```



---

archive/issue_events_148069.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-08T00:28:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11168#event-148069"
}
```



---

archive/issue_comments_111203.json:
```json
{
    "body": "Merged: **sage-4.7.rc2**",
    "created_at": "2011-05-08T00:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111203",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.rc2**



---

archive/issue_comments_111204.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2011-06-07T07:41:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111204",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_111205.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nSee #11437 for a follow-up.",
    "created_at": "2011-06-07T07:44:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11168#issuecomment-111205",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

See #11437 for a follow-up.
