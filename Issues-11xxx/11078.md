# Issue 11078: jmol in the flask notebook

archive/issues_010955.json:
```json
{
    "body": "The attached patch solves an issue with jmol finding the right .jmol.zip file in the new flask notebook.  This patch should only be applied *after* the notebook is moved to a flask notebook.\n\nThe patch should replace the following line in `sage/plot/plot3d/base.pyx`\n\n```\nf.write('set defaultdirectory \"%s\"\\n' % archive_name)\n```\nwith\n\n```\nimport sagenb\nf.write('set defaultdirectory \"cells/%s/%s\"\\n' % (sagenb.notebook.interact.SAGE_CELL_ID, archive_name))\n```\n\n\n**Assignee:** @jasongrout, @qed777, @williamstein\n\n**CC:**  rkirov @mwhansen @kcrisman\n\n**Keywords:** sd31 sd35.5\n\n**Reviewer:** Jason Grout\n\n**Author:** William Stein, Jonathan Gutow\n\n**Merged:** sage-5.2.beta0\n\n**Dependencies:** #11080\n\nIssue created by migration from https://trac.sagemath.org/ticket/11078\n\n",
    "closed_at": "2012-07-25T06:40:59Z",
    "created_at": "2011-03-29T11:47:49Z",
    "labels": [
        "component: notebook",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.2",
    "title": "jmol in the flask notebook",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11078",
    "user": "https://github.com/jasongrout"
}
```
The attached patch solves an issue with jmol finding the right .jmol.zip file in the new flask notebook.  This patch should only be applied *after* the notebook is moved to a flask notebook.

The patch should replace the following line in `sage/plot/plot3d/base.pyx`

```
f.write('set defaultdirectory "%s"\n' % archive_name)
```
with

```
import sagenb
f.write('set defaultdirectory "cells/%s/%s"\n' % (sagenb.notebook.interact.SAGE_CELL_ID, archive_name))
```


**Assignee:** @jasongrout, @qed777, @williamstein

**CC:**  rkirov @mwhansen @kcrisman

**Keywords:** sd31 sd35.5

**Reviewer:** Jason Grout

**Author:** William Stein, Jonathan Gutow

**Merged:** sage-5.2.beta0

**Dependencies:** #11080

Issue created by migration from https://trac.sagemath.org/ticket/11078





---

archive/issue_comments_112901.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,3 +12,5 @@\n f.write('set defaultdirectory \"cells/%s/%s\"\\n' % (sagenb.notebook.interact.SAGE_CELL_ID, archive_name))\n ```\n \n+Note: I haven't actually attached a patch since I hope that we can incorporate the new Jmol in, which would conflict with the patch (but would not conflict with the actual changes on this ticket).\n+\n``````\n",
    "created_at": "2011-03-30T04:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112901",
    "user": "https://github.com/jasongrout"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,3 +12,5 @@
 f.write('set defaultdirectory "cells/%s/%s"\n' % (sagenb.notebook.interact.SAGE_CELL_ID, archive_name))
 ```
 
+Note: I haven't actually attached a patch since I hope that we can incorporate the new Jmol in, which would conflict with the patch (but would not conflict with the actual changes on this ticket).
+
``````




---

archive/issue_comments_112902.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd31\".",
    "created_at": "2011-06-14T17:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112902",
    "user": "https://github.com/williamstein"
}
```

**Changing keywords** from "" to "sd31".



---

archive/issue_comments_112903.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis week, I compiled sage-4.7.1.rc0 and installed the new flask Sage notebook following instructions from : http://code.google.com/r/rkirov-flask/. I also followed the section `Adding stock Jmol` plus the patch `trac_11078.patch`. This made Jmol to work from the notebook : Great!\n\nBut, from the command line, with the patch `trac_11078.patch` a command like `sphere()` opens Jmol but Jmol stays all black. I had to mimic the modifications done in #11503 on the same file `sage/plot/plot3d/base.pyx` to make Jmol works properly from the command line.\n\nS\u00e9bastien",
    "created_at": "2011-07-25T19:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112903",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:4'></a>
This week, I compiled sage-4.7.1.rc0 and installed the new flask Sage notebook following instructions from : http://code.google.com/r/rkirov-flask/. I also followed the section `Adding stock Jmol` plus the patch `trac_11078.patch`. This made Jmol to work from the notebook : Great!

But, from the command line, with the patch `trac_11078.patch` a command like `sphere()` opens Jmol but Jmol stays all black. I had to mimic the modifications done in #11503 on the same file `sage/plot/plot3d/base.pyx` to make Jmol works properly from the command line.

SÃ©bastien



---

archive/issue_events_088481.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-21T09:28:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88481"
}
```



---

archive/issue_events_088482.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-21T09:28:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88482"
}
```



---

archive/issue_comments_112904.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,5 +12,3 @@\n f.write('set defaultdirectory \"cells/%s/%s\"\\n' % (sagenb.notebook.interact.SAGE_CELL_ID, archive_name))\n ```\n \n-Note: I haven't actually attached a patch since I hope that we can incorporate the new Jmol in, which would conflict with the patch (but would not conflict with the actual changes on this ticket).\n-\n``````\n",
    "created_at": "2011-12-31T15:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112904",
    "user": "https://github.com/jasongrout"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,5 +12,3 @@
 f.write('set defaultdirectory "cells/%s/%s"\n' % (sagenb.notebook.interact.SAGE_CELL_ID, archive_name))
 ```
 
-Note: I haven't actually attached a patch since I hope that we can incorporate the new Jmol in, which would conflict with the patch (but would not conflict with the actual changes on this ticket).
-
``````




---

archive/issue_events_088483.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-12-31T16:38:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88483"
}
```



---

archive/issue_comments_112905.json:
```json
{
    "body": "**Author:** William Stein, Jonathan Gutow",
    "created_at": "2011-12-31T16:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112905",
    "user": "https://github.com/jasongrout"
}
```

**Author:** William Stein, Jonathan Gutow



---

archive/attachments_014518.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11078.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11078/trac_11078.patch",
    "created_at": "2011-12-31T16:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jasongrout"
}
```



---

archive/issue_comments_112906.json:
```json
{
    "body": "<a id='comment:7'></a>\nI updated the patch with the changes from #11503.  With the flask notebook, sphere() works both from the command line and from the notebook.\n\nI'm setting as needs review to have one other person double-check this patch works as intended, though I guess I might qualify as the only needed reviewer.  Basically, what I did here was just rebase the patch at #11503.",
    "created_at": "2011-12-31T16:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112906",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>
I updated the patch with the changes from #11503.  With the flask notebook, sphere() works both from the command line and from the notebook.

I'm setting as needs review to have one other person double-check this patch works as intended, though I guess I might qualify as the only needed reviewer.  Basically, what I did here was just rebase the patch at #11503.



---

archive/issue_comments_112907.json:
```json
{
    "body": "**Reviewer:** Jason Grout",
    "created_at": "2011-12-31T16:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112907",
    "user": "https://github.com/jasongrout"
}
```

**Reviewer:** Jason Grout



---

archive/issue_events_088484.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-06T03:34:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88484"
}
```



---

archive/issue_events_088485.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-01-06T03:34:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88485"
}
```



---

archive/issue_comments_112908.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis looks great to me!",
    "created_at": "2012-01-06T03:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112908",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:8'></a>
This looks great to me!



---

archive/issue_comments_112909.json:
```json
{
    "body": "**Dependencies:** #11080",
    "created_at": "2012-01-09T23:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112909",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #11080



---

archive/issue_comments_112910.json:
```json
{
    "body": "**Changing keywords** from \"sd31\" to \"sd31, sd35.5\".",
    "created_at": "2012-01-10T15:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112910",
    "user": "https://github.com/jasongrout"
}
```

**Changing keywords** from "sd31" to "sd31, sd35.5".



---

archive/issue_comments_112911.json:
```json
{
    "body": "**Changing keywords** from \"sd31, sd35.5\" to \"sd31 sd35.5\".",
    "created_at": "2012-01-10T15:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112911",
    "user": "https://github.com/jasongrout"
}
```

**Changing keywords** from "sd31, sd35.5" to "sd31 sd35.5".



---

archive/issue_events_088486.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-14T14:36:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88486"
}
```



---

archive/issue_events_088487.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-14T14:36:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88487"
}
```



---

archive/issue_events_088488.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-08T08:40:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88488"
}
```



---

archive/issue_events_088489.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-08T08:40:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88489"
}
```



---

archive/issue_events_088490.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:39:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88490"
}
```



---

archive/issue_events_088491.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:39:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88491"
}
```



---

archive/issue_events_088492.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T14:39:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88492"
}
```



---

archive/issue_events_088493.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T14:39:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88493"
}
```



---

archive/issue_events_088494.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-02T15:21:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88494"
}
```



---

archive/issue_events_088495.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-02T15:21:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88495"
}
```



---

archive/issue_comments_112912.json:
```json
{
    "body": "**Merged:** sage-5.2.beta0",
    "created_at": "2012-07-02T15:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112912",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.2.beta0



---

archive/issue_comments_112913.json:
```json
{
    "body": "<a id='comment:17'></a>\nUnmerging this from sage-5.2 due to the serious security issue at #13270.",
    "created_at": "2012-07-23T06:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112913",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
Unmerging this from sage-5.2 due to the serious security issue at #13270.



---

archive/issue_comments_112914.json:
```json
{
    "body": "**Changing merged** from \"sage-5.2.beta0\" to \"\".",
    "created_at": "2012-07-23T06:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112914",
    "user": "https://github.com/jdemeyer"
}
```

**Changing merged** from "sage-5.2.beta0" to "".



---

archive/issue_events_088496.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:50:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88496"
}
```



---

archive/issue_events_088497.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:50:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88497"
}
```



---

archive/issue_events_088498.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:51:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88498"
}
```



---

archive/issue_events_088499.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:51:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88499"
}
```



---

archive/issue_events_088500.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:51:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88500"
}
```



---

archive/issue_comments_112915.json:
```json
{
    "body": "**Merged:** sage-5.2.beta0",
    "created_at": "2012-07-25T06:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11078#issuecomment-112915",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.2.beta0



---

archive/issue_events_088501.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88501"
}
```



---

archive/issue_events_088502.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88502"
}
```



---

archive/issue_events_088503.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88503"
}
```



---

archive/issue_events_088504.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11078",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11078#event-88504"
}
```
