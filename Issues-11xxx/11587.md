# Issue 11587: update Cremona's tables for Sage

archive/issues_011415.json:
```json
{
    "assignees": [],
    "body": "John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 200k is at\nhttp://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\nfile at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-10-26.tgz \n-- not to mention at http://code.google.com/p/ecdata/ !\"\n\nThe goal of this ticket is to:\n\n(1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n\n(2) Create a new sqlite database that has the data up to level 200000, which will be an optional spkg.\n\nThis is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n\nThere is now a patch that depends upon #11642 (which depends upon #11640).\n\nYou can find updated elliptic_curve and database_cremona_ellcurve spkgs at [http://wstein.org/home/ohanar/cremona-database/](http://wstein.org/home/ohanar/cremona-database/).\n\n---\n\nNew spkg: http://sage.math.washington.edu/home/leif/Sage/spkgs/elliptic_curves-0.3.spkg\n\nApply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.\n\nApply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.\n\nApply [attachment: trac_11587-rmhardcode.proper.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz) to the Sage library.\n\nApply [attachment: trac_11587-fix_speed_regression.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-fix_speed_regression.patch.gz) to the Sage library.\n\nApply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n\n**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg)\n\nDepends on #11642\n\nAssignee: **@JohnCremona**\n\nCC:  @loefflerd\n\nKeywords: **elliptic curves ellcurve database**\n\nAuthor: **R. Andrew Ohana**\n\nReviewer: **John Cremona, Tom Boothby**\n\nMerged: **sage-4.8.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11587_\n\n",
    "closed_at": "2011-10-31T11:27:38Z",
    "created_at": "2011-07-11T18:12:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update Cremona's tables for Sage",
    "type": "issue",
    "updated_at": "2011-12-18T17:28:59Z",
    "url": "https://github.com/sagemath/sage/issues/11587",
    "user": "https://github.com/williamstein"
}
```
John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 200k is at
http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-10-26.tgz 
-- not to mention at http://code.google.com/p/ecdata/ !"

The goal of this ticket is to:

(1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.

(2) Create a new sqlite database that has the data up to level 200000, which will be an optional spkg.

This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 

There is now a patch that depends upon #11642 (which depends upon #11640).

You can find updated elliptic_curve and database_cremona_ellcurve spkgs at [http://wstein.org/home/ohanar/cremona-database/](http://wstein.org/home/ohanar/cremona-database/).

---

New spkg: http://sage.math.washington.edu/home/leif/Sage/spkgs/elliptic_curves-0.3.spkg

Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.

Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.

Apply [attachment: trac_11587-rmhardcode.proper.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz) to the Sage library.

Apply [attachment: trac_11587-fix_speed_regression.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-fix_speed_regression.patch.gz) to the Sage library.

Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.

**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg)

Depends on #11642

Assignee: **@JohnCremona**

CC:  @loefflerd

Keywords: **elliptic curves ellcurve database**

Author: **R. Andrew Ohana**

Reviewer: **John Cremona, Tom Boothby**

Merged: **sage-4.8.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/11587_





---

archive/issue_events_141649.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-07-11T18:12:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141649"
}
```



---

archive/issue_events_141650.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-07-11T18:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "component: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141650"
}
```



---

archive/issue_events_141651.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-07-11T18:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141651"
}
```



---

archive/issue_events_141652.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-07-11T18:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141652"
}
```



---

archive/issue_comments_120970.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nUpdated description to reflect the current status of the tables.",
    "created_at": "2011-07-11T22:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120970",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:1" align="right">Comment 1</div>

Updated description to reflect the current status of the tables.



---

archive/issue_comments_120971.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,12 @@\n-John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 140k is at\n+John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 160k is at\n http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\n-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-04-08.tgz\n+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-08.tgz \n -- not to mention at http://code.google.com/p/ecdata/ !\"\n \n The goal of this ticket is to:\n \n (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n \n-(2) Create a new sqlite database that has the data up to level 140000, which will be an optional spkg.\n+(2) Create a new sqlite database that has the data up to level 160000, which will be an optional spkg.\n \n This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n``````\n",
    "created_at": "2011-07-11T22:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120971",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,12 @@
-John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 140k is at
+John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 160k is at
 http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-04-08.tgz
+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-08.tgz 
 -- not to mention at http://code.google.com/p/ecdata/ !"
 
 The goal of this ticket is to:
 
 (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.
 
-(2) Create a new sqlite database that has the data up to level 140000, which will be an optional spkg.
+(2) Create a new sqlite database that has the data up to level 160000, which will be an optional spkg.
 
 This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 
``````




---

archive/issue_comments_120972.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNote: only the allgens file format has changed.",
    "created_at": "2011-07-13T09:17:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120972",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:2" align="right">Comment 2</div>

Note: only the allgens file format has changed.



---

archive/issue_comments_120973.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,14 @@\n-John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 160k is at\n+John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 170k is at\n http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\n-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-08.tgz \n+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-26.tgz \n -- not to mention at http://code.google.com/p/ecdata/ !\"\n \n The goal of this ticket is to:\n \n (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n \n-(2) Create a new sqlite database that has the data up to level 160000, which will be an optional spkg.\n+(2) Create a new sqlite database that has the data up to level 170000, which will be an optional spkg.\n \n This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n+\n+There is now a patch that depends upon #11642\n``````\n",
    "created_at": "2011-08-02T00:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120973",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,14 @@
-John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 160k is at
+John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 170k is at
 http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-08.tgz 
+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-26.tgz 
 -- not to mention at http://code.google.com/p/ecdata/ !"
 
 The goal of this ticket is to:
 
 (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.
 
-(2) Create a new sqlite database that has the data up to level 160000, which will be an optional spkg.
+(2) Create a new sqlite database that has the data up to level 170000, which will be an optional spkg.
 
 This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 
+
+There is now a patch that depends upon #11642
``````




---

archive/issue_comments_120974.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nThere are new spkgs at\nhttp://wstein.org/home/ohanar/cremona-database",
    "created_at": "2011-08-02T00:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120974",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:3" align="right">Comment 3</div>

There are new spkgs at
http://wstein.org/home/ohanar/cremona-database



---

archive/issue_events_141653.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-08-02T00:30:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141653"
}
```



---

archive/issue_comments_120975.json:
```json
{
    "body": "Reviewer: **John Cremona**",
    "created_at": "2011-08-02T09:45:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120975",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona**



---

archive/issue_comments_120976.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI have a few questions.  Also since I do not know SQLITE and do not have the time to learn it just for this, the code will need to be reviewed by someone else.\n\nThere are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?  Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?\n\nSecondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?\n\nTo test this, I assume that the following steps are necessary; please correct me if I am wrong.\n\n1. apply patches at #11642\n2. apply the patch here (trac_11587.patch)\n3. sage -b\n4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg\n5. sage -b, test everything works\n6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg\n7. sage -b, test everything still works\n\nLastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?",
    "created_at": "2011-08-02T09:45:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120976",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">Comment 5</div>

I have a few questions.  Also since I do not know SQLITE and do not have the time to learn it just for this, the code will need to be reviewed by someone else.

There are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?  Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?

Secondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?

To test this, I assume that the following steps are necessary; please correct me if I am wrong.

1. apply patches at #11642
2. apply the patch here (trac_11587.patch)
3. sage -b
4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg
5. sage -b, test everything works
6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg
7. sage -b, test everything still works

Lastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?



---

archive/issue_events_141654.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-08-02T09:45:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141654"
}
```



---

archive/issue_events_141655.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-08-02T09:45:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141655"
}
```



---

archive/issue_comments_120977.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,4 +11,6 @@\n \n This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n \n-There is now a patch that depends upon #11642\n+There is now a patch that depends upon #11642 (which depends upon #11640).\n+\n+You can find updated elliptic_curve and database_cremona_ellcurve spkgs at http://wstein.org/home/ohanar/cremona-database\n``````\n",
    "created_at": "2011-08-02T18:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120977",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,4 +11,6 @@
 
 This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 
 
-There is now a patch that depends upon #11642
+There is now a patch that depends upon #11642 (which depends upon #11640).
+
+You can find updated elliptic_curve and database_cremona_ellcurve spkgs at http://wstein.org/home/ohanar/cremona-database
``````




---

archive/issue_events_141656.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-08-02T18:17:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141656"
}
```



---

archive/issue_events_141657.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-08-02T18:17:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141657"
}
```



---

archive/issue_comments_120978.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@JohnCremona](#comment%3A5):\n\n> There are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?\n\nThe patch updates sage.databases.cremona to wrap the new SQLite databases. It provides about the same functionality as the old ZODB (there are some slight modifications to actually reflect the documentation, which wasn't respected before -- specifically the mini-database only has data from allcurves).\n\n> Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?\n\nCorrect. The elliptic_curve spkg is included every copy of sage, and includes both the mini-database, as well as a very small database of curves William finds interesting. The database_cremona_ellcurve spkg includes (most of) the data from allcurves, allgens, allbsd, and degphi for every curve that you have listed.\n \n> Secondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?\n\nCurrently the spkgs simply install pre-built SQL databases, so currently this is a once-only thing. That said, on my home system it only takes ~4mins to create the database from scratch.\n\n> To test this, I assume that the following steps are necessary; please correct me if I am wrong.\n\n1. apply patches at #11642\n2. apply the patch here (trac_11587.patch)\n3. sage -b\n4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg\n5. sage -b, test everything works\n6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg\n7. sage -b, test everything still works\n\nYes, that looks correct. The only thing to be aware of is that #11642 depends on #11640 (which is just a small patch), and that there are optional doctests you should run in step 7.\n\n> Lastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?\n\nCurrently there is simple script to rebuild everything, but (in theory) it is also possible to simply add the new files. The former:\n\n```\nrm SAGE_ROOT/data/cremona/cremona.db\nSAGE_ROOT/sage\nsage: sage.databases.cremona.build('cremona','/path/to/ecdata.tgz')\n```\nthe later should be (although I haven't tested it):\n\n```\nmake a directory that only contains the new files\nSAGE_ROOT/sage\nsage: cData = sage.databases.cremona.LargeCremonaDatabase('cremona',False)\nsage: cData._init_from_ftpdata('/path/to/said/directory')\n```\nThat said, I've marked myself as the maintainer of the database_cremona_ellcurve spkg, so I'll try to keep it up to date (of course it would help if you let me know when you update your tables of course (: ).",
    "created_at": "2011-08-02T18:17:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120978",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@JohnCremona](#comment%3A5):

> There are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?

The patch updates sage.databases.cremona to wrap the new SQLite databases. It provides about the same functionality as the old ZODB (there are some slight modifications to actually reflect the documentation, which wasn't respected before -- specifically the mini-database only has data from allcurves).

> Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?

Correct. The elliptic_curve spkg is included every copy of sage, and includes both the mini-database, as well as a very small database of curves William finds interesting. The database_cremona_ellcurve spkg includes (most of) the data from allcurves, allgens, allbsd, and degphi for every curve that you have listed.
 
> Secondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?

Currently the spkgs simply install pre-built SQL databases, so currently this is a once-only thing. That said, on my home system it only takes ~4mins to create the database from scratch.

> To test this, I assume that the following steps are necessary; please correct me if I am wrong.

1. apply patches at #11642
2. apply the patch here (trac_11587.patch)
3. sage -b
4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg
5. sage -b, test everything works
6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg
7. sage -b, test everything still works

Yes, that looks correct. The only thing to be aware of is that #11642 depends on #11640 (which is just a small patch), and that there are optional doctests you should run in step 7.

> Lastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?

Currently there is simple script to rebuild everything, but (in theory) it is also possible to simply add the new files. The former:

```
rm SAGE_ROOT/data/cremona/cremona.db
SAGE_ROOT/sage
sage: sage.databases.cremona.build('cremona','/path/to/ecdata.tgz')
```
the later should be (although I haven't tested it):

```
make a directory that only contains the new files
SAGE_ROOT/sage
sage: cData = sage.databases.cremona.LargeCremonaDatabase('cremona',False)
sage: cData._init_from_ftpdata('/path/to/said/directory')
```
That said, I've marked myself as the maintainer of the database_cremona_ellcurve spkg, so I'll try to keep it up to date (of course it would help if you let me know when you update your tables of course (: ).



---

archive/issue_comments_120979.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,13 @@\n-John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 170k is at\n+John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 180k is at\n http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\n-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-26.tgz \n+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-08-09.tgz \n -- not to mention at http://code.google.com/p/ecdata/ !\"\n \n The goal of this ticket is to:\n \n (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n \n-(2) Create a new sqlite database that has the data up to level 170000, which will be an optional spkg.\n+(2) Create a new sqlite database that has the data up to level 180000, which will be an optional spkg.\n \n This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n \n``````\n",
    "created_at": "2011-08-10T03:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120979",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,13 @@
-John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 170k is at
+John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 180k is at
 http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-07-26.tgz 
+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-08-09.tgz 
 -- not to mention at http://code.google.com/p/ecdata/ !"
 
 The goal of this ticket is to:
 
 (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.
 
-(2) Create a new sqlite database that has the data up to level 170000, which will be an optional spkg.
+(2) Create a new sqlite database that has the data up to level 180000, which will be an optional spkg.
 
 This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 
 
``````




---

archive/issue_comments_120980.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nI've updated the database_cremona_ellcurve spkg to include the latest tables, which can still be found at http://wstein.org/home/ohanar/cremona-database (the old one is still there there as well).\n\nI'm also attaching an updated patch that mainly updates the documentation to reflect the current state of the tables (upper bound of 180,000 vs 130,000), as well as the spkg version. It also limits the outputs of a few queries where only the first entry is needed.",
    "created_at": "2011-08-10T03:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120980",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:7" align="right">Comment 7</div>

I've updated the database_cremona_ellcurve spkg to include the latest tables, which can still be found at http://wstein.org/home/ohanar/cremona-database (the old one is still there there as well).

I'm also attaching an updated patch that mainly updates the documentation to reflect the current state of the tables (upper bound of 180,000 vs 130,000), as well as the spkg version. It also limits the outputs of a few queries where only the first entry is needed.



---

archive/issue_comments_120981.json:
```json
{
    "body": "fixes the broken doctest for cremona_mini",
    "created_at": "2011-08-24T23:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120981",
    "user": "https://github.com/ohanar"
}
```

fixes the broken doctest for cremona_mini



---

archive/issue_comments_120982.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nAttachment: **[trac_11587.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz)**\n\nlooks good, works good",
    "created_at": "2011-08-25T08:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120982",
    "user": "https://github.com/sagetrac-boothby"
}
```

<div id="comment:8" align="right">Comment 8</div>

Attachment: **[trac_11587.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz)**

looks good, works good



---

archive/issue_comments_120983.json:
```json
{
    "body": "Author: **Andrew Ohana**",
    "created_at": "2011-08-25T08:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120983",
    "user": "https://github.com/sagetrac-boothby"
}
```

Author: **Andrew Ohana**



---

archive/issue_events_141658.json:
```json
{
    "actor": "https://github.com/sagetrac-boothby",
    "created_at": "2011-08-25T08:51:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141658"
}
```



---

archive/issue_events_141659.json:
```json
{
    "actor": "https://github.com/sagetrac-boothby",
    "created_at": "2011-08-25T08:51:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141659"
}
```



---

archive/issue_comments_120984.json:
```json
{
    "body": "Changed reviewer from **John Cremona** to **John Cremona, Tom Boothby**",
    "created_at": "2011-08-25T08:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120984",
    "user": "https://github.com/sagetrac-boothby"
}
```

Changed reviewer from **John Cremona** to **John Cremona, Tom Boothby**



---

archive/issue_comments_120985.json:
```json
{
    "body": "Dependencies: **#11642**",
    "created_at": "2011-09-08T14:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120985",
    "user": "https://github.com/nexttime"
}
```

Dependencies: **#11642**



---

archive/issue_comments_120986.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThat's +1.4 MB, or +78% for the standard spkg.",
    "created_at": "2011-09-08T14:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120986",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:9" align="right">Comment 9</div>

That's +1.4 MB, or +78% for the standard spkg.



---

archive/issue_comments_120987.json:
```json
{
    "body": "Changed keywords from **** to **elliptic curves ellcurve database**",
    "created_at": "2011-09-08T14:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120987",
    "user": "https://github.com/nexttime"
}
```

Changed keywords from **** to **elliptic curves ellcurve database**



---

archive/issue_comments_120988.json:
```json
{
    "body": "Changed author from **Andrew Ohana** to **R. Andrew Ohana**",
    "created_at": "2011-09-08T14:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120988",
    "user": "https://github.com/nexttime"
}
```

Changed author from **Andrew Ohana** to **R. Andrew Ohana**



---

archive/issue_comments_120989.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,14 @@\n \n There is now a patch that depends upon #11642 (which depends upon #11640).\n \n-You can find updated elliptic_curve and database_cremona_ellcurve spkgs at http://wstein.org/home/ohanar/cremona-database\n+You can find updated elliptic_curve and database_cremona_ellcurve spkgs at [http://wstein.org/home/ohanar/cremona-database/](http://wstein.org/home/ohanar/cremona-database/).\n+\n+---\n+\n+New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg\n+\n+Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.\n+\n+---\n+\n+**The new *optional* spkg also has to be brought into place.** (I don't put a link here to not confuse the bots.)\n``````\n",
    "created_at": "2011-09-08T14:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120989",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,14 @@
 
 There is now a patch that depends upon #11642 (which depends upon #11640).
 
-You can find updated elliptic_curve and database_cremona_ellcurve spkgs at http://wstein.org/home/ohanar/cremona-database
+You can find updated elliptic_curve and database_cremona_ellcurve spkgs at [http://wstein.org/home/ohanar/cremona-database/](http://wstein.org/home/ohanar/cremona-database/).
+
+---
+
+New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg
+
+Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.
+
+---
+
+**The new *optional* spkg also has to be brought into place.** (I don't put a link here to not confuse the bots.)
``````




---

archive/issue_comments_120990.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@nexttime](#comment%3A9):\n> That's +1.4 MB, or +78% for the standard spkg.\n\nI can rewrite the install script to simply create the database from Cremona's text files. On my system it takes ~6sec to build it from scratch, and would probably decrease the size of the spkg to a bit over 1MB.",
    "created_at": "2011-09-09T07:47:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120990",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@nexttime](#comment%3A9):
> That's +1.4 MB, or +78% for the standard spkg.

I can rewrite the install script to simply create the database from Cremona's text files. On my system it takes ~6sec to build it from scratch, and would probably decrease the size of the spkg to a bit over 1MB.



---

archive/issue_comments_120991.json:
```json
{
    "body": "Attachment: **[trac_11587-depfix.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz)**\n\nAdds the new dependencies of the elliptic_curves spkg",
    "created_at": "2011-09-10T07:22:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120991",
    "user": "https://github.com/ohanar"
}
```

Attachment: **[trac_11587-depfix.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz)**

Adds the new dependencies of the elliptic_curves spkg



---

archive/issue_comments_120992.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies. I'm going to keep the optional spkg the same since it takes >5mins to build the database.",
    "created_at": "2011-09-10T07:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120992",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:11" align="right">Comment 11</div>

I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies. I'm going to keep the optional spkg the same since it takes >5mins to build the database.



---

archive/issue_comments_120993.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,9 +17,11 @@\n \n ---\n \n-New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg\n+New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.3.spkg\n \n Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.\n+\n+Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n ---\n \n``````\n",
    "created_at": "2011-09-10T07:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120993",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,9 +17,11 @@
 
 ---
 
-New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg
+New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.3.spkg
 
 Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.
+
+Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
 ---
 
``````




---

archive/issue_comments_120994.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@ohanar](#comment%3A11):\n> I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies.\n\nCool, thanks.\n\n> I'm going to keep the optional spkg the same since it takes >5mins to build the database.\n\nOptional is optional; I'm not aware of any size demands or restrictions there...",
    "created_at": "2011-09-10T07:55:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120994",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@ohanar](#comment%3A11):
> I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies.

Cool, thanks.

> I'm going to keep the optional spkg the same since it takes >5mins to build the database.

Optional is optional; I'm not aware of any size demands or restrictions there...



---

archive/issue_comments_120995.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@nexttime](#comment%3A12):\n> Replying to [@ohanar](#comment%3A11):\n> > I'm going to keep the optional spkg the same since it takes >5mins to build the database.\n\n> \n> Optional is optional; I'm not aware of any size demands or restrictions there...\n\nTrue, but I realized when updating the spkg that creating the database from text files more closely follows the spkg design of building libraries from source.",
    "created_at": "2011-09-10T08:01:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120995",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@nexttime](#comment%3A12):
> Replying to [@ohanar](#comment%3A11):
> > I'm going to keep the optional spkg the same since it takes >5mins to build the database.

> 
> Optional is optional; I'm not aware of any size demands or restrictions there...

True, but I realized when updating the spkg that creating the database from text files more closely follows the spkg design of building libraries from source.



---

archive/issue_comments_120996.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nMany thanks for your work on this, Andrew.  It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right?  Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?",
    "created_at": "2011-09-10T13:09:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120996",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:14" align="right">Comment 14</div>

Many thanks for your work on this, Andrew.  It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right?  Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?



---

archive/issue_comments_120997.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@JohnCremona](#comment%3A14):\n> It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? \n\nCurrently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.\n\nIf we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.\n\n> Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?\n\nThere is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.",
    "created_at": "2011-09-11T05:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120997",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@JohnCremona](#comment%3A14):
> It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? 

Currently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.

If we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.

> Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?

There is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.



---

archive/issue_comments_120998.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@ohanar](#comment%3A15):\n> Replying to [@JohnCremona](#comment%3A14):\n> > It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? \n\n> \n> Currently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.\n> \n> If we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.\n> \n> > Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?\n\n> \n> There is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.\n\nThanks for the explanation.  I agree that it is good to have the database file itself in the package and not the raw data, as long as it (the spkg) also has instructions on how to (re)create this from my raw data.  And a note of the precise things to be changed when the range is extended would also be a good idea, even if that's only a couple of places.  I'm thinking that it may not be you doing this next time!",
    "created_at": "2011-09-11T09:06:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120998",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@ohanar](#comment%3A15):
> Replying to [@JohnCremona](#comment%3A14):
> > It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? 

> 
> Currently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.
> 
> If we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.
> 
> > Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?

> 
> There is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.

Thanks for the explanation.  I agree that it is good to have the database file itself in the package and not the raw data, as long as it (the spkg) also has instructions on how to (re)create this from my raw data.  And a note of the precise things to be changed when the range is extended would also be a good idea, even if that's only a couple of places.  I'm thinking that it may not be you doing this next time!



---

archive/issue_comments_120999.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nIf 190k is almost done, I can add the upgrading instructions then.",
    "created_at": "2011-09-11T20:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-120999",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:17" align="right">Comment 17</div>

If 190k is almost done, I can add the upgrading instructions then.



---

archive/issue_comments_121000.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nI get warnings from Sphinx:\n\n```\n.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:26: (WARNING/2) Definition list ends without a blank line; unexpected unindent.\n.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:36: (WARNING/2) Definition list ends without a blank line; unexpected unindent.\n```",
    "created_at": "2011-09-12T07:33:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121000",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">Comment 18</div>

I get warnings from Sphinx:

```
.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:26: (WARNING/2) Definition list ends without a blank line; unexpected unindent.
.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:36: (WARNING/2) Definition list ends without a blank line; unexpected unindent.
```



---

archive/issue_comments_121001.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:\n\n```python\n\nTo use the database, just create a curve by giving\n\n::\n\n    sage: EllipticCurve('5077a1')\n    Elliptic Curve defined by y^2 + y = x^3 - 7*x + 6 over Rational Field\n    sage: C = CremonaDatabase() \n    sage: C.number_of_curves() #optional - cremona\n    847550\n    sage: C[37]\n    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],\n           'b1': [[0, 1, 1, -23, -50], 0, 3], ...\n    sage: C.isogeny_class('37b')\n    [Elliptic Curve defined by y^2 + y = x^3 + x^2 - 23*x - 50 \n    over Rational Field, ...]\n\n```\n\n```\nFile \".../doc/en/bordeaux_2008/elliptic_curves.rst\", line 22:\n    sage: C[37]\nExpected:\n    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],\n           'b1': [[0, 1, 1, -23, -50], 0, 3], ...\nGot:\n    {'allcurves': {'a1': [[0, 0, 1, -1, 0], 1, 1], 'b1': [[0, 1, 1, -23, -50], 0, 3], 'b2': [[0, 1, 1, -1873, -31833], 0, 1], 'b3': [[0, 1, 1, -3, 1], 0, 3]}}\n```\n\n(Just the first key differs; `a` vs. `allcurves`.)",
    "created_at": "2011-09-12T08:23:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121001",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:19" align="right">Comment 19</div>

I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:

```python

To use the database, just create a curve by giving

::

    sage: EllipticCurve('5077a1')
    Elliptic Curve defined by y^2 + y = x^3 - 7*x + 6 over Rational Field
    sage: C = CremonaDatabase() 
    sage: C.number_of_curves() #optional - cremona
    847550
    sage: C[37]
    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],
           'b1': [[0, 1, 1, -23, -50], 0, 3], ...
    sage: C.isogeny_class('37b')
    [Elliptic Curve defined by y^2 + y = x^3 + x^2 - 23*x - 50 
    over Rational Field, ...]

```

```
File ".../doc/en/bordeaux_2008/elliptic_curves.rst", line 22:
    sage: C[37]
Expected:
    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],
           'b1': [[0, 1, 1, -23, -50], 0, 3], ...
Got:
    {'allcurves': {'a1': [[0, 0, 1, -1, 0], 1, 1], 'b1': [[0, 1, 1, -23, -50], 0, 3], 'b2': [[0, 1, 1, -1873, -31833], 0, 1], 'b3': [[0, 1, 1, -3, 1], 0, 3]}}
```

(Just the first key differs; `a` vs. `allcurves`.)



---

archive/issue_events_141660.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-09-12T08:27:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141660"
}
```



---

archive/issue_events_141661.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-09-12T08:27:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141661"
}
```



---

archive/issue_comments_121002.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@nexttime](#comment%3A19):\n> I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:\n\n> (Just the first key differs; `a` vs. `allcurves`.)\n\nI'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.\nHence back to \"Needs (trivial) work\".",
    "created_at": "2011-09-12T08:27:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121002",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@nexttime](#comment%3A19):
> I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:

> (Just the first key differs; `a` vs. `allcurves`.)

I'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.
Hence back to "Needs (trivial) work".



---

archive/issue_comments_121003.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@JohnCremona](#comment%3A20):\n> Replying to [@nexttime](#comment%3A19):\n> > I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:\n\n> \n> > (Just the first key differs; `a` vs. `allcurves`.)\n\n> \n> I'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.\n\nYup, didn't test this, so a good catch (and yes, it does belong here, I made the change in key names). Also, if you run the optional test, that will fail as well (we may want to scrap it for something else, since it adds to the maintenance of the optional spkg).",
    "created_at": "2011-09-12T08:32:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121003",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@JohnCremona](#comment%3A20):
> Replying to [@nexttime](#comment%3A19):
> > I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:

> 
> > (Just the first key differs; `a` vs. `allcurves`.)

> 
> I'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.

Yup, didn't test this, so a good catch (and yes, it does belong here, I made the change in key names). Also, if you run the optional test, that will fail as well (we may want to scrap it for something else, since it adds to the maintenance of the optional spkg).



---

archive/issue_comments_121004.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@ohanar](#comment%3A17):\n> If 190k is almost done, I can add the upgrading instructions then.\n\nIt's almost done in the sense that I have everything except that 3 curves in the range are \"missing\" on account of some difficulties with modular symbols which I will now try to fix (requires revising code and testing).  Either I'll have this by the end of Thursday, or I'll be away for a week and it will take longer.",
    "created_at": "2011-09-12T08:46:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121004",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@ohanar](#comment%3A17):
> If 190k is almost done, I can add the upgrading instructions then.

It's almost done in the sense that I have everything except that 3 curves in the range are "missing" on account of some difficulties with modular symbols which I will now try to fix (requires revising code and testing).  Either I'll have this by the end of Thursday, or I'll be away for a week and it will take longer.



---

archive/issue_comments_121005.json:
```json
{
    "body": "Attachment: **[trac_11587-docfixes.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz)**\n\nApply on top to sage library. Fixes issues with documentation.",
    "created_at": "2011-09-12T23:37:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121005",
    "user": "https://github.com/ohanar"
}
```

Attachment: **[trac_11587-docfixes.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz)**

Apply on top to sage library. Fixes issues with documentation.



---

archive/issue_comments_121006.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,6 +21,8 @@\n \n Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.\n \n+Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.\n+\n Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n ---\n``````\n",
    "created_at": "2011-09-12T23:41:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121006",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,6 +21,8 @@
 
 Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.
 
+Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.
+
 Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
 ---
``````




---

archive/issue_events_141662.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-09-12T23:42:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141662"
}
```



---

archive/issue_events_141663.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-09-12T23:42:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141663"
}
```



---

archive/issue_comments_121007.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nApplying trac_11587.patch onto 4.7.2.alpha1 failed.  And before that, installing the new spkg using sage -i ended with \n\n```\n...\nThread model: posix\ngcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) \n****************************************************\n/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log \"$SAGE_LOGS/$PKG_NAME\".log\n```\nwhich looks like an error message, I am not sure.  Am I doing something wrong?",
    "created_at": "2011-09-15T13:24:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121007",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:25" align="right">Comment 25</div>

Applying trac_11587.patch onto 4.7.2.alpha1 failed.  And before that, installing the new spkg using sage -i ended with 

```
...
Thread model: posix
gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) 
****************************************************
/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log "$SAGE_LOGS/$PKG_NAME".log
```
which looks like an error message, I am not sure.  Am I doing something wrong?



---

archive/issue_comments_121008.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nReplying to [@JohnCremona](#comment%3A25):\n> Applying trac_11587.patch onto 4.7.2.alpha1 failed.\n\nDid you first apply #11640 and #11642?\n\n\n> And before that, installing the new spkg using sage -i ended with \n\n\n```\n...\nThread model: posix\ngcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) \n****************************************************\n/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log \"$SAGE_LOGS/$PKG_NAME\".log\n```\n> which looks like an error message, I am not sure.\n\nYes. No idea what might have caused that.",
    "created_at": "2011-09-15T14:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121008",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:26" align="right">Comment 26</div>

Replying to [@JohnCremona](#comment%3A25):
> Applying trac_11587.patch onto 4.7.2.alpha1 failed.

Did you first apply #11640 and #11642?


> And before that, installing the new spkg using sage -i ended with 


```
...
Thread model: posix
gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) 
****************************************************
/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log "$SAGE_LOGS/$PKG_NAME".log
```
> which looks like an error message, I am not sure.

Yes. No idea what might have caused that.



---

archive/issue_comments_121009.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@nexttime](#comment%3A26):\n> Replying to [@JohnCremona](#comment%3A25):\n> > Applying trac_11587.patch onto 4.7.2.alpha1 failed.\n\n> \n> Did you first apply #11640 and #11642?\n\nNo since I saw that they were merged already -- but now I see that they were merged in alpha3 only.",
    "created_at": "2011-09-15T14:38:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121009",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@nexttime](#comment%3A26):
> Replying to [@JohnCremona](#comment%3A25):
> > Applying trac_11587.patch onto 4.7.2.alpha1 failed.

> 
> Did you first apply #11640 and #11642?

No since I saw that they were merged already -- but now I see that they were merged in alpha3 only.



---

archive/issue_comments_121010.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nOK, with #11640 and #11642 applied first the patches to the Sage library apply fine.  Dor the deps one I just manually edited the file since I could find no trace of mercurial in $SAGE_ROOT/spkgs/standard (or at least hg gave an error message).  Then I rebuilt everything with sage -ba, and I am now doing a make ptestlong, and will report back.\n\nSmall comment, since I know that Andrew will be updating the conductor ranges anyway:  at the moment smallest_conductor() returns 1 which will surprise some people as the actual smallest is 11!",
    "created_at": "2011-09-15T14:52:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121010",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:28" align="right">Comment 28</div>

OK, with #11640 and #11642 applied first the patches to the Sage library apply fine.  Dor the deps one I just manually edited the file since I could find no trace of mercurial in $SAGE_ROOT/spkgs/standard (or at least hg gave an error message).  Then I rebuilt everything with sage -ba, and I am now doing a make ptestlong, and will report back.

Small comment, since I know that Andrew will be updating the conductor ranges anyway:  at the moment smallest_conductor() returns 1 which will surprise some people as the actual smallest is 11!



---

archive/issue_events_141664.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-09-15T15:59:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141664"
}
```



---

archive/issue_events_141665.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-09-15T15:59:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141665"
}
```



---

archive/issue_comments_121011.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nAll test pass, so I am giving this a positive review.  This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.",
    "created_at": "2011-09-15T15:59:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121011",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:29" align="right">Comment 29</div>

All test pass, so I am giving this a positive review.  This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.



---

archive/issue_comments_121012.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nReplying to [@JohnCremona](#comment%3A29):\n> All test pass, so I am giving this a positive review.\n\nI didn't expect something else. ;-)\n\n> This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.\n\nWhich will be when?\n\nCan't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?",
    "created_at": "2011-09-15T16:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121012",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:30" align="right">Comment 30</div>

Replying to [@JohnCremona](#comment%3A29):
> All test pass, so I am giving this a positive review.

I didn't expect something else. ;-)

> This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.

Which will be when?

Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?



---

archive/issue_comments_121013.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nP.S.: `deps` is part of the \"root\" repository, which is located in `$SAGE_ROOT`, so you have to apply the patch there.",
    "created_at": "2011-09-15T16:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121013",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:31" align="right">Comment 31</div>

P.S.: `deps` is part of the "root" repository, which is located in `$SAGE_ROOT`, so you have to apply the patch there.



---

archive/issue_comments_121014.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nReplying to [@nexttime](#comment%3A30):\n> Replying to [@JohnCremona](#comment%3A29):\n> > All test pass, so I am giving this a positive review.\n\n> \n> I didn't expect something else. ;-)\n> \n> > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.\n\n> \n> Which will be when?\n\nI finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.\n\n> \n> Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?\n\nNo, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).\n\nAnyway, the impression I got was that adding the additional curves published today would only take a few minutes.  If longer, then go with what is on this ticket.  But I don't know the right mechanism for changing the optional spkg.",
    "created_at": "2011-09-15T16:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121014",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:32" align="right">Comment 32</div>

Replying to [@nexttime](#comment%3A30):
> Replying to [@JohnCremona](#comment%3A29):
> > All test pass, so I am giving this a positive review.

> 
> I didn't expect something else. ;-)
> 
> > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.

> 
> Which will be when?

I finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.

> 
> Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?

No, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).

Anyway, the impression I got was that adding the additional curves published today would only take a few minutes.  If longer, then go with what is on this ticket.  But I don't know the right mechanism for changing the optional spkg.



---

archive/issue_comments_121015.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nReplying to [@JohnCremona](#comment%3A32):\n> Replying to [@nexttime](#comment%3A30):\n> > Replying to [@JohnCremona](#comment%3A29):\n> > > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.\n\n> > \n> > Which will be when?\n\n> \n> I finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.\n\nWorking on it right now.\n> \n> > \n> > Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?\n\n> \n> No, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).\n\nThe optional spkgs mentioned the description work with the new database format, but there are a few places where the version of the package is hardcoded into the sage library (so holding off may be a good idea). I am going to remove these, so that maintaining the spkg is an easier chore.",
    "created_at": "2011-09-15T21:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121015",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:33" align="right">Comment 33</div>

Replying to [@JohnCremona](#comment%3A32):
> Replying to [@nexttime](#comment%3A30):
> > Replying to [@JohnCremona](#comment%3A29):
> > > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.

> > 
> > Which will be when?

> 
> I finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.

Working on it right now.
> 
> > 
> > Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?

> 
> No, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).

The optional spkgs mentioned the description work with the new database format, but there are a few places where the version of the package is hardcoded into the sage library (so holding off may be a good idea). I am going to remove these, so that maintaining the spkg is an easier chore.



---

archive/issue_comments_121016.json:
```json
{
    "body": "Attachment: **[trac_11587-rmhardcode.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.patch.gz)**\n\nremoves the hardcoded version number from sage library",
    "created_at": "2011-09-15T22:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121016",
    "user": "https://github.com/ohanar"
}
```

Attachment: **[trac_11587-rmhardcode.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.patch.gz)**

removes the hardcoded version number from sage library



---

archive/issue_comments_121017.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nOk, I've updated the spkg, it now includes updating instructions in the spkg.txt as well. I've also added a patch that removes the hardcoded version numbers from the sage library, the instructions in the spkg are based off of this.",
    "created_at": "2011-09-15T22:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121017",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:34" align="right">Comment 34</div>

Ok, I've updated the spkg, it now includes updating instructions in the spkg.txt as well. I've also added a patch that removes the hardcoded version numbers from the sage library, the instructions in the spkg are based off of this.



---

archive/issue_comments_121018.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,6 +23,8 @@\n \n Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.\n \n+Apply [attachment: trac_11587-rmhardcode.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.patch.gz) to the Sage library.\n+\n Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n ---\n``````\n",
    "created_at": "2011-09-15T22:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121018",
    "user": "https://github.com/ohanar"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,6 +23,8 @@
 
 Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.
 
+Apply [attachment: trac_11587-rmhardcode.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.patch.gz) to the Sage library.
+
 Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
 ---
``````




---

archive/issue_comments_121019.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nAndrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for \"release\"?",
    "created_at": "2011-09-16T13:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121019",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:35" align="right">Comment 35</div>

Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for "release"?



---

archive/issue_comments_121020.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nReplying to [@nexttime](#comment%3A35):\n> Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for \"release\"?\n\nIt should be (the install script simply copies a single file)",
    "created_at": "2011-09-16T16:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121020",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:36" align="right">Comment 36</div>

Replying to [@nexttime](#comment%3A35):
> Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for "release"?

It should be (the install script simply copies a single file)



---

archive/issue_comments_121021.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha3**",
    "created_at": "2011-09-17T04:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121021",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.2.alpha3**



---

archive/issue_events_141666.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-17T04:58:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141666"
}
```



---

archive/issue_events_141667.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-17T04:58:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141667"
}
```



---

archive/issue_comments_121022.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nHad to add a changelog entry for the previous version in Sage (0.1), since otherwise Jeroen's merger3 (meanwhile) rejects it (assuming it wasn't based on the previous one in Sage).\n\nCorrected spkg at new location.",
    "created_at": "2011-09-23T04:20:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121022",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:38" align="right">Comment 38</div>

Had to add a changelog entry for the previous version in Sage (0.1), since otherwise Jeroen's merger3 (meanwhile) rejects it (assuming it wasn't based on the previous one in Sage).

Corrected spkg at new location.



---

archive/issue_comments_121023.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,7 @@\n \n ---\n \n-New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.3.spkg\n+New spkg: http://sage.math.washington.edu/home/leif/Sage/spkgs/elliptic_curves-0.3.spkg\n \n Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.\n \n``````\n",
    "created_at": "2011-09-23T04:20:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121023",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,7 @@
 
 ---
 
-New spkg: http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.3.spkg
+New spkg: http://sage.math.washington.edu/home/leif/Sage/spkgs/elliptic_curves-0.3.spkg
 
 Apply [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz) to the Sage library.
 
``````




---

archive/issue_comments_121024.json:
```json
{
    "body": "\"Proper\" Mercurial changeset replacement patch. (Adds just the \"User\" field.)",
    "created_at": "2011-09-28T17:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121024",
    "user": "https://github.com/nexttime"
}
```

"Proper" Mercurial changeset replacement patch. (Adds just the "User" field.)



---

archive/issue_comments_121025.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nAttachment: **[trac_11587-rmhardcode.proper.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz)**\n\nI've attached one replacement patch which just adds the \"`# User ...`\" line the original patch is lacking.",
    "created_at": "2011-09-28T17:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121025",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:39" align="right">Comment 39</div>

Attachment: **[trac_11587-rmhardcode.proper.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz)**

I've attached one replacement patch which just adds the "`# User ...`" line the original patch is lacking.



---

archive/issue_comments_121026.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,7 +23,7 @@\n \n Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.\n \n-Apply [attachment: trac_11587-rmhardcode.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.patch.gz) to the Sage library.\n+Apply [attachment: trac_11587-rmhardcode.proper.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz) to the Sage library.\n \n Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n``````\n",
    "created_at": "2011-09-28T17:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121026",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,7 +23,7 @@
 
 Apply [attachment: trac_11587-docfixes.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-docfixes.patch.gz) to the Sage library.
 
-Apply [attachment: trac_11587-rmhardcode.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.patch.gz) to the Sage library.
+Apply [attachment: trac_11587-rmhardcode.proper.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz) to the Sage library.
 
 Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
``````




---

archive/issue_comments_121027.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nAfter installing the optionl daatbase on top of 4.7.2.alpha3 I had a doctest failure in \ndevel/sage/doc/en/bordeaux_2008/elliptic_curves.rst .  Nothing serious, just different gens for a curve (i.e. the ones in the database are not the same as those found, for a rank 2 curve).",
    "created_at": "2011-09-29T19:15:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121027",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:40" align="right">Comment 40</div>

After installing the optionl daatbase on top of 4.7.2.alpha3 I had a doctest failure in 
devel/sage/doc/en/bordeaux_2008/elliptic_curves.rst .  Nothing serious, just different gens for a curve (i.e. the ones in the database are not the same as those found, for a rank 2 curve).



---

archive/issue_comments_121028.json:
```json
{
    "body": "Changed merged from **sage-4.7.2.alpha3** to none",
    "created_at": "2011-10-06T19:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121028",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.2.alpha3** to none



---

archive/issue_comments_121029.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nThis is the cause of a serious speed regression.  Message by Dave Loeffler:\n\nI've found the culprit: this is a side-effect of #11587. If you\nlook at [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz), then it removes a couple of lines of code\nat lines 710-712 of sage/databases/cremona.py which sets the\ngenerators to [] if the gens aren't explicitly in the database but the\nrank is known to be 0. The new version doesn't perform this little\ncheck and so we waste loads of time doing pointless 2-descents.",
    "created_at": "2011-10-06T19:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121029",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">Comment 41</div>

This is the cause of a serious speed regression.  Message by Dave Loeffler:

I've found the culprit: this is a side-effect of #11587. If you
look at [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz), then it removes a couple of lines of code
at lines 710-712 of sage/databases/cremona.py which sets the
generators to [] if the gens aren't explicitly in the database but the
rank is known to be 0. The new version doesn't perform this little
check and so we waste loads of time doing pointless 2-descents.



---

archive/issue_comments_121030.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@jdemeyer](#comment%3A41):\n> This is the cause of a serious speed regression.  Message by Dave Loeffler:\n> \n> I've found the culprit: this is a side-effect of #11587. If you\n> look at [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz), then it removes a couple of lines of code\n> at lines 710-712 of sage/databases/cremona.py which sets the\n> generators to [] if the gens aren't explicitly in the database but the\n> rank is known to be 0. The new version doesn't perform this little\n> check and so we waste loads of time doing pointless 2-descents.\n\nI was fearing something like that.\n\nWhy not open a follow-up (blocker) ticket for fixing that?\n\nalpha3 is already out...",
    "created_at": "2011-10-06T19:58:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121030",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@jdemeyer](#comment%3A41):
> This is the cause of a serious speed regression.  Message by Dave Loeffler:
> 
> I've found the culprit: this is a side-effect of #11587. If you
> look at [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz), then it removes a couple of lines of code
> at lines 710-712 of sage/databases/cremona.py which sets the
> generators to [] if the gens aren't explicitly in the database but the
> rank is known to be 0. The new version doesn't perform this little
> check and so we waste loads of time doing pointless 2-descents.

I was fearing something like that.

Why not open a follow-up (blocker) ticket for fixing that?

alpha3 is already out...



---

archive/issue_comments_121031.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nReplying to [@nexttime](#comment%3A42):\n> Why not open a follow-up (blocker) ticket for fixing that?\n\nI thought it might be easier to change an existing ticket, especially if the change is small.\n\n> alpha3 is already out...\n\nDoesn't really matter, I can re-merge the ticket in alpha4...",
    "created_at": "2011-10-06T20:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121031",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:43" align="right">Comment 43</div>

Replying to [@nexttime](#comment%3A42):
> Why not open a follow-up (blocker) ticket for fixing that?

I thought it might be easier to change an existing ticket, especially if the change is small.

> alpha3 is already out...

Doesn't really matter, I can re-merge the ticket in alpha4...



---

archive/issue_comments_121032.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nReplying to [@jdemeyer](#comment%3A41):\n> This is the cause of a serious speed regression.  Message by Dave Loeffler:\n> \n> I've found the culprit: this is a side-effect of #11587. If you\n> look at [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz), then it removes a couple of lines of code\n> at lines 710-712 of sage/databases/cremona.py which sets the\n> generators to [] if the gens aren't explicitly in the database but the\n> rank is known to be 0. The new version doesn't perform this little\n> check and so we waste loads of time doing pointless 2-descents.\n\nIt has always been rather a nuisance that the small default database differs from the large one not only in having fewer curves but in having less information about them (specifically, omits the known rank and generators).  I don't want to delay this ticket longer than necessary (and apologise for the positive review which missed this glitch) but propose a follow-up which includes all known data for the small database too.",
    "created_at": "2011-10-06T21:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121032",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:44" align="right">Comment 44</div>

Replying to [@jdemeyer](#comment%3A41):
> This is the cause of a serious speed regression.  Message by Dave Loeffler:
> 
> I've found the culprit: this is a side-effect of #11587. If you
> look at [attachment: trac_11587.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587.patch.gz), then it removes a couple of lines of code
> at lines 710-712 of sage/databases/cremona.py which sets the
> generators to [] if the gens aren't explicitly in the database but the
> rank is known to be 0. The new version doesn't perform this little
> check and so we waste loads of time doing pointless 2-descents.

It has always been rather a nuisance that the small default database differs from the large one not only in having fewer curves but in having less information about them (specifically, omits the known rank and generators).  I don't want to delay this ticket longer than necessary (and apologise for the positive review which missed this glitch) but propose a follow-up which includes all known data for the small database too.



---

archive/issue_comments_121033.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nFollow-up or on this ticket will not make a difference because I plan to unmerge this ticket anyway if it causes such massive slowdown.  So, do as you wish.",
    "created_at": "2011-10-06T21:19:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121033",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">Comment 45</div>

Follow-up or on this ticket will not make a difference because I plan to unmerge this ticket anyway if it causes such massive slowdown.  So, do as you wish.



---

archive/issue_comments_121034.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nThis will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.",
    "created_at": "2011-10-08T10:23:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121034",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">Comment 46</div>

This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.



---

archive/issue_events_141668.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-08T10:23:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141668"
}
```



---

archive/issue_events_141669.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-08T10:23:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141669"
}
```



---

archive/issue_comments_121035.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nReplying to [@jdemeyer](#comment%3A46):\n> This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.\n\nThen we should also remove [http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg](http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg) again, since it is in the new format (which only the alpha3 supports); either when alpha4 is officially released, or right before the final 4.7.2 gets out.\n\nIt shouldn't be hard to change its `spkg-install` to just install the previous version (hard-coded URL, e.g. by recursively calling `sage -i ...` or `sage-spkg`) if the Sage version present doesn't support the new format, which is reasonable for the future anyway (i.e., when this ticket gets remerged). Cf. [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/3f8a60845a477324/cc82a5faf40fe57e#cc82a5faf40fe57e).",
    "created_at": "2011-10-08T14:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121035",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:47" align="right">Comment 47</div>

Replying to [@jdemeyer](#comment%3A46):
> This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.

Then we should also remove [http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg](http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg) again, since it is in the new format (which only the alpha3 supports); either when alpha4 is officially released, or right before the final 4.7.2 gets out.

It shouldn't be hard to change its `spkg-install` to just install the previous version (hard-coded URL, e.g. by recursively calling `sage -i ...` or `sage-spkg`) if the Sage version present doesn't support the new format, which is reasonable for the future anyway (i.e., when this ticket gets remerged). Cf. [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/3f8a60845a477324/cc82a5faf40fe57e#cc82a5faf40fe57e).



---

archive/issue_comments_121036.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\n... or simply print a message instructing the user to instead do\n\n```sh\n$ ./sage -i http://sagemath.org/packages/archive/database_cremona_ellcurve-20071019.p0.spkg\n```\n\n(It should IMHO also still be in `/packages/optional/`, along with its description, but I get a 404 if I replace `archive` by `optional` above.)\n\n\n\n\nCeterum censeo we should really split the spkg metadata (or Sage part) from its \"real\" contents (data or upstream tarballs), or at least *additionally* provide it in *small* files to be processed without the need to download the full spkgs in advance...",
    "created_at": "2011-10-08T14:36:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121036",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:48" align="right">Comment 48</div>

... or simply print a message instructing the user to instead do

```sh
$ ./sage -i http://sagemath.org/packages/archive/database_cremona_ellcurve-20071019.p0.spkg
```

(It should IMHO also still be in `/packages/optional/`, along with its description, but I get a 404 if I replace `archive` by `optional` above.)




Ceterum censeo we should really split the spkg metadata (or Sage part) from its "real" contents (data or upstream tarballs), or at least *additionally* provide it in *small* files to be processed without the need to download the full spkgs in advance...



---

archive/issue_comments_121037.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nAny effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.",
    "created_at": "2011-10-09T10:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121037",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:49" align="right">Comment 49</div>

Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.



---

archive/issue_comments_121038.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nReplying to [@JohnCremona](#comment%3A49):\n> Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.\n\nI fully agree, but unfortunately it's relatively easy to \"unmerge\" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).",
    "created_at": "2011-10-09T15:17:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121038",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:50" align="right">Comment 50</div>

Replying to [@JohnCremona](#comment%3A49):
> Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.

I fully agree, but unfortunately it's relatively easy to "unmerge" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).



---

archive/issue_comments_121039.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 180k is at\n+John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 190k is at\n http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\n file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-08-09.tgz \n -- not to mention at http://code.google.com/p/ecdata/ !\"\n@@ -7,7 +7,7 @@\n \n (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n \n-(2) Create a new sqlite database that has the data up to level 180000, which will be an optional spkg.\n+(2) Create a new sqlite database that has the data up to level 190000, which will be an optional spkg.\n \n This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n \n``````\n",
    "created_at": "2011-10-09T16:25:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121039",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 180k is at
+John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 190k is at
 http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
 file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-08-09.tgz 
 -- not to mention at http://code.google.com/p/ecdata/ !"
@@ -7,7 +7,7 @@
 
 (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.
 
-(2) Create a new sqlite database that has the data up to level 180000, which will be an optional spkg.
+(2) Create a new sqlite database that has the data up to level 190000, which will be an optional spkg.
 
 This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 
 
``````




---

archive/issue_comments_121040.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nReplying to [@nexttime](#comment%3A50):\n> Replying to [@JohnCremona](#comment%3A49):\n> > Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.\n\n> \n> I fully agree, but unfortunately it's relatively easy to \"unmerge\" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).\n\nOf course -- I just meant that you should do the absolute minimum and not spend effort making the old system more clever. And I just have not had time to fix the patch.",
    "created_at": "2011-10-09T16:25:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121040",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:51" align="right">Comment 51</div>

Replying to [@nexttime](#comment%3A50):
> Replying to [@JohnCremona](#comment%3A49):
> > Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.

> 
> I fully agree, but unfortunately it's relatively easy to "unmerge" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).

Of course -- I just meant that you should do the absolute minimum and not spend effort making the old system more clever. And I just have not had time to fix the patch.



---

archive/issue_comments_121041.json:
```json
{
    "body": "apply over previous patches",
    "created_at": "2011-10-16T18:41:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121041",
    "user": "https://github.com/loefflerd"
}
```

apply over previous patches



---

archive/issue_comments_121042.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nAttachment: **[trac_11587-fix_speed_regression.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-fix_speed_regression.patch.gz)**",
    "created_at": "2011-10-16T18:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121042",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:52" align="right">Comment 52</div>

Attachment: **[trac_11587-fix_speed_regression.patch.gz](https://github.com/sagemath/sage/files/ticket11587/trac_11587-fix_speed_regression.patch.gz)**



---

archive/issue_comments_121043.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,6 +25,8 @@\n \n Apply [attachment: trac_11587-rmhardcode.proper.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz) to the Sage library.\n \n+Apply [attachment: trac_11587-fix_speed_regression.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-fix_speed_regression.patch.gz) to the Sage library.\n+\n Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n ---\n``````\n",
    "created_at": "2011-10-16T18:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121043",
    "user": "https://github.com/loefflerd"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,6 +25,8 @@
 
 Apply [attachment: trac_11587-rmhardcode.proper.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-rmhardcode.proper.patch.gz) to the Sage library.
 
+Apply [attachment: trac_11587-fix_speed_regression.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-fix_speed_regression.patch.gz) to the Sage library.
+
 Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
 ---
``````




---

archive/issue_events_141670.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2011-10-16T18:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141670"
}
```



---

archive/issue_comments_121044.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nReplying to [@loefflerd](#comment%3A52):\n\nNot tested but David's patch looks perfect and I believe his comment.  Better if someone else test this as David and I use the same machine.\n\nIf this is not merged soon it will become out of date since I have currently reached 198800 and expect to release an extension up to 200k within a week!",
    "created_at": "2011-10-16T19:23:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121044",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:53" align="right">Comment 53</div>

Replying to [@loefflerd](#comment%3A52):

Not tested but David's patch looks perfect and I believe his comment.  Better if someone else test this as David and I use the same machine.

If this is not merged soon it will become out of date since I have currently reached 198800 and expect to release an extension up to 200k within a week!



---

archive/issue_events_141671.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-10-30T00:51:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141671"
}
```



---

archive/issue_events_141672.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2011-10-30T00:51:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141672"
}
```



---

archive/issue_comments_121045.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nEverything works as expected.\n\n@loefflerd \nI don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).\n\n@JohnCremona\nI've posted a new spkg with your expanded tables, same location as before.",
    "created_at": "2011-10-30T00:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121045",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:54" align="right">Comment 54</div>

Everything works as expected.

@loefflerd 
I don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).

@JohnCremona
I've posted a new spkg with your expanded tables, same location as before.



---

archive/issue_comments_121046.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nReplying to [@ohanar](#comment%3A54):\n> Everything works as expected.\n> \n> @loefflerd \n> I don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).\n> \n> @JohnCremona\n> I've posted a new spkg with your expanded tables, same location as before.\n\nMany thanks to all.  As predicted, the database was updated to go up to 200k a few days ago.",
    "created_at": "2011-10-30T11:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121046",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:55" align="right">Comment 55</div>

Replying to [@ohanar](#comment%3A54):
> Everything works as expected.
> 
> @loefflerd 
> I don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).
> 
> @JohnCremona
> I've posted a new spkg with your expanded tables, same location as before.

Many thanks to all.  As predicted, the database was updated to go up to 200k a few days ago.



---

archive/issue_events_141673.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-31T11:27:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141673"
}
```



---

archive/issue_events_141674.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-31T11:27:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141674"
}
```



---

archive/issue_comments_121047.json:
```json
{
    "body": "Merged: **sage-4.7.3.alpha0**",
    "created_at": "2011-10-31T11:27:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121047",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.3.alpha0**



---

archive/issue_comments_121048.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -29,6 +29,4 @@\n \n Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n----\n-\n-**The new *optional* spkg also has to be brought into place.** (I don't put a link here to not confuse the bots.)\n+**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg)\n``````\n",
    "created_at": "2011-11-03T13:15:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121048",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -29,6 +29,4 @@
 
 Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
----
-
-**The new *optional* spkg also has to be brought into place.** (I don't put a link here to not confuse the bots.)
+**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg)
``````




---

archive/issue_comments_121049.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nI just updated the description to reflect the fact that the optional db now goes up to 200k.",
    "created_at": "2011-11-03T13:55:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121049",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:58" align="right">Comment 58</div>

I just updated the description to reflect the fact that the optional db now goes up to 200k.



---

archive/issue_comments_121050.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,13 @@\n-John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 190k is at\n+John Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 200k is at\n http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\n-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-08-09.tgz \n+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-10-26.tgz \n -- not to mention at http://code.google.com/p/ecdata/ !\"\n \n The goal of this ticket is to:\n \n (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n \n-(2) Create a new sqlite database that has the data up to level 190000, which will be an optional spkg.\n+(2) Create a new sqlite database that has the data up to level 200000, which will be an optional spkg.\n \n This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. \n \n``````\n",
    "created_at": "2011-11-03T13:55:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121050",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,13 @@
-John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 190k is at
+John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 200k is at
 http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
-file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-08-09.tgz 
+file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-10-26.tgz 
 -- not to mention at http://code.google.com/p/ecdata/ !"
 
 The goal of this ticket is to:
 
 (1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.
 
-(2) Create a new sqlite database that has the data up to level 190000, which will be an optional spkg.
+(2) Create a new sqlite database that has the data up to level 200000, which will be an optional spkg.
 
 This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat. 
 
``````




---

archive/issue_comments_121051.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -29,4 +29,4 @@\n \n Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.\n \n-**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg)\n+**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg)\n``````\n",
    "created_at": "2011-11-03T14:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121051",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -29,4 +29,4 @@
 
 Apply [attachment: trac_11587-depfix.patch](https://github.com/sagemath/sage/files/ticket11587/trac_11587-depfix.patch.gz) to Sage root.
 
-**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg)
+**Optional spkg**: [http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111029.spkg)
``````




---

archive/issue_comments_121052.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nReplying to [@ohanar](#comment%3A54):\n> I've posted a new spkg with your expanded tables, same location as before.\n\nNot really same location as before, I updated the ticket description.",
    "created_at": "2011-11-03T14:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121052",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">Comment 59</div>

Replying to [@ohanar](#comment%3A54):
> I've posted a new spkg with your expanded tables, same location as before.

Not really same location as before, I updated the ticket description.



---

archive/issue_events_141675.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:14:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141675"
}
```



---

archive/issue_comments_121053.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121053",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_comments_121054.json:
```json
{
    "body": "Changed merged from **sage-4.7.3.alpha0** to **sage-4.8.alpha0**",
    "created_at": "2011-11-03T16:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121054",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.3.alpha0** to **sage-4.8.alpha0**



---

archive/issue_events_141676.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:17:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11587#event-141676"
}
```



---

archive/issue_comments_121055.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nI've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).\n\nI noticed that I never put in a way to install the old spkg for old copies of sage, so I added a recursive `sage -i` for now, until we have a standard that frees the user from downloading two different versions of an spkg. It should work for any version of sage released within the last year, although I haven't tested it super thoroughly (it works with stable 4.7.x, 4.8.alpha3, and 4.3.3.alpha0).",
    "created_at": "2011-11-27T11:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121055",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:62" align="right">Comment 62</div>

I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).

I noticed that I never put in a way to install the old spkg for old copies of sage, so I added a recursive `sage -i` for now, until we have a standard that frees the user from downloading two different versions of an spkg. It should work for any version of sage released within the last year, although I haven't tested it super thoroughly (it works with stable 4.7.x, 4.8.alpha3, and 4.3.3.alpha0).



---

archive/issue_comments_121056.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nReplying to [@ohanar](#comment%3A62):\n> I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).\n\nPlease make a new ticket for making this an optional spkg (this ticket is closed).",
    "created_at": "2011-11-27T20:44:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121056",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">Comment 63</div>

Replying to [@ohanar](#comment%3A62):
> I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).

Please make a new ticket for making this an optional spkg (this ticket is closed).



---

archive/issue_comments_121057.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nReplying to [@jdemeyer](#comment%3A63):\n> Please make a new ticket for making this an optional spkg (this ticket is closed).\n\nSure, my only reason for posting it in this ticket was due to the unaddressed issue of dealing with old copies of Sage.",
    "created_at": "2011-11-28T02:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121057",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:64" align="right">Comment 64</div>

Replying to [@jdemeyer](#comment%3A63):
> Please make a new ticket for making this an optional spkg (this ticket is closed).

Sure, my only reason for posting it in this ticket was due to the unaddressed issue of dealing with old copies of Sage.



---

archive/issue_comments_121058.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nDoing a full test after installing the new optional database (onto 4.8.alpha4) I find one doctest failure in devel/sage/doc/en/bordeaux_2008/elliptic_curves.rst:\n\n```\n    sage: E = EllipticCurve([1,2,5,7,17])\n    sage: E.conductor()       # not in the Tables\n    154907\n    sage: E.gens()            # a few seconds\n    [(1 : 3 : 1), (67/4 : 507/8 : 1)]\n```\nsince that curve is now in the database and the listed generators are different.  I suggest instead \n\n```\nsage: E = EllipticCurve([0,0,1,-19,60])\nsage: E.conductor()        # not in the Tables\n1129211\nsage: E.gens()             # a few seconds\n[(-5 : 5 : 1), (-4 : 8 : 1), (-15/4 : 67/8 : 1), (-3 : 9 : 1)]\n```\n\nShould the ticket be reopened -- this is not an issue in testing without the optional db installed?",
    "created_at": "2011-12-14T14:54:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121058",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:65" align="right">Comment 65</div>

Doing a full test after installing the new optional database (onto 4.8.alpha4) I find one doctest failure in devel/sage/doc/en/bordeaux_2008/elliptic_curves.rst:

```
    sage: E = EllipticCurve([1,2,5,7,17])
    sage: E.conductor()       # not in the Tables
    154907
    sage: E.gens()            # a few seconds
    [(1 : 3 : 1), (67/4 : 507/8 : 1)]
```
since that curve is now in the database and the listed generators are different.  I suggest instead 

```
sage: E = EllipticCurve([0,0,1,-19,60])
sage: E.conductor()        # not in the Tables
1129211
sage: E.gens()             # a few seconds
[(-5 : 5 : 1), (-4 : 8 : 1), (-15/4 : 67/8 : 1), (-3 : 9 : 1)]
```

Should the ticket be reopened -- this is not an issue in testing without the optional db installed?



---

archive/issue_comments_121059.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nReplying to [@JohnCremona](#comment%3A65):\n\n> \n> Should the ticket be reopened -- this is not an issue in testing without the optional db installed?\n\nSee #12184",
    "created_at": "2011-12-18T17:28:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11587",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11587#issuecomment-121059",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:66" align="right">Comment 66</div>

Replying to [@JohnCremona](#comment%3A65):

> 
> Should the ticket be reopened -- this is not an issue in testing without the optional db installed?

See #12184
