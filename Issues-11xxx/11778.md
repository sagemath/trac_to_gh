# Issue 11778: p_iter_fork doesn't flush stdout properly

archive/issues_011606.json:
```json
{
    "assignees": [],
    "body": "The following code\n\n```\nfrom sage.parallel.use_fork import p_iter_fork\n\ndef f(n):\n    print \"Entering f with n=%s\" % n \n    X = p_iter_fork(1, verbose=True)\n    iter_result = X(g, [((n,), {})])\n    result = list(iter_result)[0][1]\n    print \"Leaving f with n=%s\" % n\n    return result  # Which is just n\n    \ndef g(n):\n    print \"Inside g with n=%s\" % n\n    return n\n    \ndef test():\n    X = p_iter_fork(2, verbose=True)\n    inputs = [((n,), {}) for n in range(5)]\n    iter_result = X(f, inputs)\n    for n in iter_result:\n        pass  \n\ntest()\n```\ngives this output (perhaps in a different order):\n\n```\nEntering f with n=1\nEntering f with n=1\nInside g with n=1\nLeaving f with n=1\nEntering f with n=0\nEntering f with n=0\nInside g with n=0\nLeaving f with n=0\nEntering f with n=2\nEntering f with n=2\nInside g with n=2\nLeaving f with n=2\nEntering f with n=3\nEntering f with n=3\nInside g with n=3\nLeaving f with n=3\nEntering f with n=4\nEntering f with n=4\nInside g with n=4\nLeaving f with n=4\n```\nThe point is that stdout isn't flushed before the process is forked and therefore its contents are copied to the child process as well and thus lives in 2 processes.\n\n---\n\nApply\n1. [attachment: 11778_flush_before_fork.patch](https://github.com/sagemath/sage/files/ticket11778/11778_flush_before_fork.patch.gz)\n2. [attachment: trac_11778-flush_output_of_print_stmts.reviewer.patch](https://github.com/sagemath/sage/files/ticket11778/trac_11778-flush_output_of_print_stmts.reviewer.patch.gz)\nto the Sage library.\n\n\nKeywords: **parallel fork stdout**\n\nComponent: **misc**\n\nAuthor: **Johan Bosman**\n\nReviewer: **Leif Leonhardy**\n\nMerged: **sage-4.7.2.alpha3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11778_\n\n",
    "closed_at": "2011-09-13T07:50:38Z",
    "created_at": "2011-09-05T12:05:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "p_iter_fork doesn't flush stdout properly",
    "type": "issue",
    "updated_at": "2011-09-13T07:50:38Z",
    "url": "https://github.com/sagemath/sage/issues/11778",
    "user": "https://github.com/sagetrac-johanbosman"
}
```
The following code

```
from sage.parallel.use_fork import p_iter_fork

def f(n):
    print "Entering f with n=%s" % n 
    X = p_iter_fork(1, verbose=True)
    iter_result = X(g, [((n,), {})])
    result = list(iter_result)[0][1]
    print "Leaving f with n=%s" % n
    return result  # Which is just n
    
def g(n):
    print "Inside g with n=%s" % n
    return n
    
def test():
    X = p_iter_fork(2, verbose=True)
    inputs = [((n,), {}) for n in range(5)]
    iter_result = X(f, inputs)
    for n in iter_result:
        pass  

test()
```
gives this output (perhaps in a different order):

```
Entering f with n=1
Entering f with n=1
Inside g with n=1
Leaving f with n=1
Entering f with n=0
Entering f with n=0
Inside g with n=0
Leaving f with n=0
Entering f with n=2
Entering f with n=2
Inside g with n=2
Leaving f with n=2
Entering f with n=3
Entering f with n=3
Inside g with n=3
Leaving f with n=3
Entering f with n=4
Entering f with n=4
Inside g with n=4
Leaving f with n=4
```
The point is that stdout isn't flushed before the process is forked and therefore its contents are copied to the child process as well and thus lives in 2 processes.

---

Apply
1. [attachment: 11778_flush_before_fork.patch](https://github.com/sagemath/sage/files/ticket11778/11778_flush_before_fork.patch.gz)
2. [attachment: trac_11778-flush_output_of_print_stmts.reviewer.patch](https://github.com/sagemath/sage/files/ticket11778/trac_11778-flush_output_of_print_stmts.reviewer.patch.gz)
to the Sage library.


Keywords: **parallel fork stdout**

Component: **misc**

Author: **Johan Bosman**

Reviewer: **Leif Leonhardy**

Merged: **sage-4.7.2.alpha3**

_Issue created by migration from https://trac.sagemath.org/ticket/11778_





---

archive/issue_events_158346.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-09-05T12:05:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158346"
}
```



---

archive/issue_events_158347.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-09-05T12:05:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158347"
}
```



---

archive/issue_events_158348.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-09-05T12:05:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158348"
}
```



---

archive/issue_comments_122951.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe attached patch fixes the problem, but it probably still needs a doctest.",
    "created_at": "2011-09-05T12:18:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122951",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:1" align="right">comment:1</div>

The attached patch fixes the problem, but it probably still needs a doctest.



---

archive/issue_comments_122952.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHow about `stderr`?",
    "created_at": "2011-09-05T12:32:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122952",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:2" align="right">comment:2</div>

How about `stderr`?



---

archive/issue_events_158349.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-05T12:32:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158349"
}
```



---

archive/issue_comments_122953.json:
```json
{
    "body": "Author: **Johan Bosman**",
    "created_at": "2011-09-05T12:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122953",
    "user": "https://github.com/nexttime"
}
```

Author: **Johan Bosman**



---

archive/issue_comments_122954.json:
```json
{
    "body": "Reviewer: **Leif Leonhardy**",
    "created_at": "2011-09-05T12:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122954",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **Leif Leonhardy**



---

archive/issue_comments_122955.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIn general I'd move the `flush`(s) out of the loop.",
    "created_at": "2011-09-05T12:39:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122955",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:4" align="right">comment:4</div>

In general I'd move the `flush`(s) out of the loop.



---

archive/issue_comments_122956.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@nexttime](#comment:4):\n> In general I'd move the `flush`(s) out of the loop.\n\nOkay. ;)",
    "created_at": "2011-09-05T12:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122956",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@nexttime](#comment:4):
> In general I'd move the `flush`(s) out of the loop.

Okay. ;)



---

archive/issue_comments_122957.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[11778_flush_before_fork.patch.gz](https://github.com/sagemath/sage/files/ticket11778/11778_flush_before_fork.patch.gz)**\n\nAnd now stderr as well.",
    "created_at": "2011-09-05T12:57:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122957",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[11778_flush_before_fork.patch.gz](https://github.com/sagemath/sage/files/ticket11778/11778_flush_before_fork.patch.gz)**

And now stderr as well.



---

archive/issue_comments_122958.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@sagetrac-johanbosman](#comment:6):\n> And now stderr as well.\n\nSorry, not your problem here, but IMHO the output should also be flushed after every `print` statement (in verbose mode), e.g. when processes get killed.",
    "created_at": "2011-09-05T13:27:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122958",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@sagetrac-johanbosman](#comment:6):
> And now stderr as well.

Sorry, not your problem here, but IMHO the output should also be flushed after every `print` statement (in verbose mode), e.g. when processes get killed.



---

archive/issue_comments_122959.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOh, actually not just verbose mode.",
    "created_at": "2011-09-05T13:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122959",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:8" align="right">comment:8</div>

Oh, actually not just verbose mode.



---

archive/issue_comments_122960.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOkay, so you're saying this stderr flush can be left out?  Flushing is time consuming so it'd be better to flush as little as possible.",
    "created_at": "2011-09-05T15:01:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122960",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:9" align="right">comment:9</div>

Okay, so you're saying this stderr flush can be left out?  Flushing is time consuming so it'd be better to flush as little as possible.



---

archive/issue_comments_122961.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@sagetrac-johanbosman](#comment:9):\n> Okay, so you're saying this stderr flush can be left out?\n\nNo. The subprocesses shouldn't inherit an unflushed buffer.\n\nI can add a reviewer patch for flushing the output of the `print` statements, unless you want to change your patch.",
    "created_at": "2011-09-05T15:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122961",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@sagetrac-johanbosman](#comment:9):
> Okay, so you're saying this stderr flush can be left out?

No. The subprocesses shouldn't inherit an unflushed buffer.

I can add a reviewer patch for flushing the output of the `print` statements, unless you want to change your patch.



---

archive/issue_comments_122962.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOkay, go ahead; I don't want to change this patch. ;).",
    "created_at": "2011-09-05T15:06:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122962",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:11" align="right">comment:11</div>

Okay, go ahead; I don't want to change this patch. ;).



---

archive/issue_comments_122963.json:
```json
{
    "body": "Sage library patch. Also flushs the output of further `print` statements in the parent process. Apply on top of Johan's patch.",
    "created_at": "2011-09-05T15:34:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122963",
    "user": "https://github.com/nexttime"
}
```

Sage library patch. Also flushs the output of further `print` statements in the parent process. Apply on top of Johan's patch.



---

archive/issue_comments_122964.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAttachment: **[trac_11778-flush_output_of_print_stmts.reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket11778/trac_11778-flush_output_of_print_stmts.reviewer.patch.gz)**\n\nReplying to [@sagetrac-johanbosman](#comment:11):\n> Okay, go ahead; I don't want to change this patch. ;).\n\nGone.\n\nIf you're ok with my additional changes, we have a positive review.",
    "created_at": "2011-09-05T15:37:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122964",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Attachment: **[trac_11778-flush_output_of_print_stmts.reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket11778/trac_11778-flush_output_of_print_stmts.reviewer.patch.gz)**

Replying to [@sagetrac-johanbosman](#comment:11):
> Okay, go ahead; I don't want to change this patch. ;).

Gone.

If you're ok with my additional changes, we have a positive review.



---

archive/issue_comments_122965.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThere's a typo (which was already there):\nIn \"Killing subprocess %s with input %s which took too long\" there should be a comma between the second %s and \"which\".\n\nOkay, that was \"mierenneuken\" (you may want to look up that word); I'll have a more serious look it later on (don't have much time right now).",
    "created_at": "2011-09-05T15:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122965",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:13" align="right">comment:13</div>

There's a typo (which was already there):
In "Killing subprocess %s with input %s which took too long" there should be a comma between the second %s and "which".

Okay, that was "mierenneuken" (you may want to look up that word); I'll have a more serious look it later on (don't have much time right now).



---

archive/issue_comments_122966.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@sagetrac-johanbosman](#comment:13):\n> There's a typo (which was already there):\n> In \"Killing subprocess %s with input %s which took too long\" there should be a comma between the second %s and \"which\".\n\nI'd say a comma there isn't absolutely necessary, but I should have added periods... (I saw that of course<sup>TM</sup> *after* I had committed my changes.)\n\n> Okay, that was \"mierenneuken\" (you may want to look up that word).\n\n*\"De pagina \"mierenneuken\" aanmaken op deze wiki.\"*\n\nGuessing nit-picking.\n\n\n\n\n> I'll have a more serious look it later on (don't have much time right now).\n\nGo ahead... ;-)",
    "created_at": "2011-09-05T16:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122966",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@sagetrac-johanbosman](#comment:13):
> There's a typo (which was already there):
> In "Killing subprocess %s with input %s which took too long" there should be a comma between the second %s and "which".

I'd say a comma there isn't absolutely necessary, but I should have added periods... (I saw that of course<sup>TM</sup> *after* I had committed my changes.)

> Okay, that was "mierenneuken" (you may want to look up that word).

*"De pagina "mierenneuken" aanmaken op deze wiki."*

Guessing nit-picking.




> I'll have a more serious look it later on (don't have much time right now).

Go ahead... ;-)



---

archive/issue_comments_122967.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@nexttime](#comment:14):\n> I'd say a comma there isn't absolutely necessary, but I should have added periods... (I saw that of course<sup>TM</sup> *after* I had committed my changes.)\n\nHave a look at http://en.wikipedia.org/wiki/Comma#Separation_of_clauses ;).",
    "created_at": "2011-09-05T16:17:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122967",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@nexttime](#comment:14):
> I'd say a comma there isn't absolutely necessary, but I should have added periods... (I saw that of course<sup>TM</sup> *after* I had committed my changes.)

Have a look at http://en.wikipedia.org/wiki/Comma#Separation_of_clauses ;).



---

archive/issue_comments_122968.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@sagetrac-johanbosman](#comment:15):\n> Replying to [@nexttime](#comment:14):\n> > I'd say a comma there isn't absolutely necessary, but I should have added periods... (I saw that of course<sup>TM</sup> *after* I had committed my changes.)\n\n> Have a look at http://en.wikipedia.org/wiki/Comma#Separation_of_clauses ;).\n\nWell, since \"which\" refers to a single subprocess, it is unambiguous.\n\n(But you're in principle right, omitting the comma might be considered a bit sloppy, as the clause is non-restrictive from a *grammatical* point of view. I'd say it *is* restrictive, or constraining, from a logical point of view though, as the subprocess wouldn't have been killed in that situation otherwise, i.e. if it had not taken too long.)\n\nWe could also change \"*which* took too long\" to \"*because* it took too long\"... :)",
    "created_at": "2011-09-05T16:56:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122968",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@sagetrac-johanbosman](#comment:15):
> Replying to [@nexttime](#comment:14):
> > I'd say a comma there isn't absolutely necessary, but I should have added periods... (I saw that of course<sup>TM</sup> *after* I had committed my changes.)

> Have a look at http://en.wikipedia.org/wiki/Comma#Separation_of_clauses ;).

Well, since "which" refers to a single subprocess, it is unambiguous.

(But you're in principle right, omitting the comma might be considered a bit sloppy, as the clause is non-restrictive from a *grammatical* point of view. I'd say it *is* restrictive, or constraining, from a logical point of view though, as the subprocess wouldn't have been killed in that situation otherwise, i.e. if it had not taken too long.)

We could also change "*which* took too long" to "*because* it took too long"... :)



---

archive/issue_events_158350.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-09-06T16:45:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158350"
}
```



---

archive/issue_events_158351.json:
```json
{
    "actor": "https://github.com/sagetrac-johanbosman",
    "created_at": "2011-09-06T16:45:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158351"
}
```



---

archive/issue_comments_122969.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@nexttime](#comment:12):\n> Replying to [@sagetrac-johanbosman](#comment:11):\n> > Okay, go ahead; I don't want to change this patch. ;).\n\n> \n> Gone.\n> \n> If you're ok with my additional changes, we have a positive review.\n\nI'm okay with it.  Let's not worry about the comma, which is mierenneuken anyway (the word is explained at http://en.wikipedia.org/wiki/Dutch_profanity) ;).",
    "created_at": "2011-09-06T16:45:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122969",
    "user": "https://github.com/sagetrac-johanbosman"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@nexttime](#comment:12):
> Replying to [@sagetrac-johanbosman](#comment:11):
> > Okay, go ahead; I don't want to change this patch. ;).

> 
> Gone.
> 
> If you're ok with my additional changes, we have a positive review.

I'm okay with it.  Let's not worry about the comma, which is mierenneuken anyway (the word is explained at http://en.wikipedia.org/wiki/Dutch_profanity) ;).



---

archive/issue_comments_122970.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -49,3 +49,11 @@\n Leaving f with n=4\n ```\n The point is that stdout isn't flushed before the process is forked and therefore its contents are copied to the child process as well and thus lives in 2 processes.\n+\n+---\n+\n+Apply\n+1. [attachment: 11778_flush_before_fork.patch](https://github.com/sagemath/sage/files/ticket11778/11778_flush_before_fork.patch.gz)\n+2. [attachment: trac_11778-flush_output_of_print_stmts.reviewer.patch](https://github.com/sagemath/sage/files/ticket11778/trac_11778-flush_output_of_print_stmts.reviewer.patch.gz)\n+to the Sage library.\n+\n``````\n",
    "created_at": "2011-09-08T04:37:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122970",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -49,3 +49,11 @@
 Leaving f with n=4
 ```
 The point is that stdout isn't flushed before the process is forked and therefore its contents are copied to the child process as well and thus lives in 2 processes.
+
+---
+
+Apply
+1. [attachment: 11778_flush_before_fork.patch](https://github.com/sagemath/sage/files/ticket11778/11778_flush_before_fork.patch.gz)
+2. [attachment: trac_11778-flush_output_of_print_stmts.reviewer.patch](https://github.com/sagemath/sage/files/ticket11778/trac_11778-flush_output_of_print_stmts.reviewer.patch.gz)
+to the Sage library.
+
``````




---

archive/issue_comments_122971.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha3**",
    "created_at": "2011-09-13T07:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11778#issuecomment-122971",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.2.alpha3**



---

archive/issue_events_158352.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T07:50:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158352"
}
```



---

archive/issue_events_158353.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T07:50:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11778",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11778#event-158353"
}
```
