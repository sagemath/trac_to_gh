# Issue 11121: Set up good defaults for sage's mercurial

archive/issues_010982.json:
```json
{
    "assignees": [],
    "body": "Apply:\n\n- [attachment: trac_11121-hgrc.data-extcode.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz) to data/extcode\n- [attachment: trac_11121-hgrc.devel-sage.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz) to Sage library\n- [attachment: trac_11121-hgrc.devel-sagenb.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz) to sagenb\n- [attachment: trac_11121-hgrc.local-bin-mode0755.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin-mode0755.patch.gz) to scripts repo\n- [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo\n- [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository\n\n---\n\nAs above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n\nThis would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).\n\nDepends on #10594\n\nCC:  @gvol\n\nKeywords: **mercurial git diff patches sd31**\n\nAuthor: **Keshav Kini, John Palmieri**\n\nReviewer: **John Palmieri, Keshav Kini**\n\nMerged: **sage-4.7.2.alpha2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11121_\n\n",
    "closed_at": "2011-08-22T17:34:02Z",
    "created_at": "2011-04-04T08:45:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Set up good defaults for sage's mercurial",
    "type": "issue",
    "updated_at": "2011-08-23T13:47:50Z",
    "url": "https://github.com/sagemath/sage/issues/11121",
    "user": "https://github.com/kini"
}
```
Apply:

- [attachment: trac_11121-hgrc.data-extcode.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz) to data/extcode
- [attachment: trac_11121-hgrc.devel-sage.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz) to Sage library
- [attachment: trac_11121-hgrc.devel-sagenb.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz) to sagenb
- [attachment: trac_11121-hgrc.local-bin-mode0755.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin-mode0755.patch.gz) to scripts repo
- [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo
- [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository

---

As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).

This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).

Depends on #10594

CC:  @gvol

Keywords: **mercurial git diff patches sd31**

Author: **Keshav Kini, John Palmieri**

Reviewer: **John Palmieri, Keshav Kini**

Merged: **sage-4.7.2.alpha2**

_Issue created by migration from https://trac.sagemath.org/ticket/11121_





---

archive/issue_events_134597.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:45:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134597"
}
```



---

archive/issue_events_134598.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:45:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134598"
}
```



---

archive/issue_events_134599.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:45:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134599"
}
```



---

archive/issue_events_134600.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:45:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134600"
}
```



---

archive/issue_events_134601.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T09:33:18Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "title_is": "Sage should use git-style diffs everywhere possible.",
    "title_was": "Mercurial spkg should install an hgrc which turns on git-style diffs",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134601"
}
```



---

archive/issue_comments_112517.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n+\n+This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).\n``````\n",
    "created_at": "2011-04-04T09:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112517",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).
+
+This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).
``````




---

archive/issue_comments_112518.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nThese patches set the default diff format to git's new diffs (as opposed to the default which is the old unified diff spec) and add some (IMHO) very useful extensions to the default hgrc. Any comments / suggestions?",
    "created_at": "2011-04-04T11:30:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112518",
    "user": "https://github.com/kini"
}
```

<div id="comment:2" align="right">Comment 2</div>

These patches set the default diff format to git's new diffs (as opposed to the default which is the old unified diff spec) and add some (IMHO) very useful extensions to the default hgrc. Any comments / suggestions?



---

archive/issue_comments_112519.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n \n This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).\n+\n+Apply trac_11121-hgrc.local-bin.patch to local/bin\n+\n+Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg\n``````\n",
    "created_at": "2011-04-04T11:30:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112519",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
 As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).
 
 This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).
+
+Apply trac_11121-hgrc.local-bin.patch to local/bin
+
+Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg
``````




---

archive/issue_events_134602.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T11:30:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134602"
}
```



---

archive/issue_events_134603.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T11:32:31Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "title_is": "Set up good defaults for sage's mercurial",
    "title_was": "Sage should use git-style diffs everywhere possible.",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134603"
}
```



---

archive/issue_comments_112520.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,10 @@\n Apply trac_11121-hgrc.local-bin.patch to local/bin\n \n Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg\n+\n+Put the following lines in $SAGE_ROOT/.hg/hgrc in the distribution tarball:\n+\n+```\n+[diff]\n+git = true\n+```\n``````\n",
    "created_at": "2011-04-04T11:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112520",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,10 @@
 Apply trac_11121-hgrc.local-bin.patch to local/bin
 
 Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg
+
+Put the following lines in $SAGE_ROOT/.hg/hgrc in the distribution tarball:
+
+```
+[diff]
+git = true
+```
``````




---

archive/issue_comments_112521.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nBy the way, I also added a comment to the top of $SAGE_LOCAL/bin/sage-spkg-install explaining what it's for, and changed its file permissions to make it non-executable (it becomes executable when turning into spkg-install in the various SPKGs it's a template installer for, anyway).",
    "created_at": "2011-04-04T15:00:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112521",
    "user": "https://github.com/kini"
}
```

<div id="comment:5" align="right">Comment 5</div>

By the way, I also added a comment to the top of $SAGE_LOCAL/bin/sage-spkg-install explaining what it's for, and changed its file permissions to make it non-executable (it becomes executable when turning into spkg-install in the various SPKGs it's a template installer for, anyway).



---

archive/issue_comments_112522.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\n1. Dumb question: Isn't this patch going to make it so every time one installs the mercurial spkg, \n\n```\n[diff]\ngit = true\n```\ngets appended to $TARGET/.hg/hgrc?    If one upgrades, hence install mercurial multiple times, this seems very bad.\n\n2. Same remark about $SAGE_LOCAL/etc/mercurial/hgrc.",
    "created_at": "2011-04-04T17:09:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112522",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:6" align="right">Comment 6</div>

1. Dumb question: Isn't this patch going to make it so every time one installs the mercurial spkg, 

```
[diff]
git = true
```
gets appended to $TARGET/.hg/hgrc?    If one upgrades, hence install mercurial multiple times, this seems very bad.

2. Same remark about $SAGE_LOCAL/etc/mercurial/hgrc.



---

archive/issue_events_134604.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-04-04T17:09:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134604"
}
```



---

archive/issue_events_134605.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-04-04T17:09:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134605"
}
```



---

archive/issue_comments_112523.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nNope, it's `>` rather than `>>` so it overwrites the file rather than appending.",
    "created_at": "2011-04-04T17:21:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112523",
    "user": "https://github.com/kini"
}
```

<div id="comment:7" align="right">Comment 7</div>

Nope, it's `>` rather than `>>` so it overwrites the file rather than appending.



---

archive/issue_comments_112524.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nWere there any other work issues? If not I'll set this back to \"needs review\" but of course feel free to revert it again...",
    "created_at": "2011-04-04T18:58:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112524",
    "user": "https://github.com/kini"
}
```

<div id="comment:8" align="right">Comment 8</div>

Were there any other work issues? If not I'll set this back to "needs review" but of course feel free to revert it again...



---

archive/issue_events_134606.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T18:58:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134606"
}
```



---

archive/issue_events_134607.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T18:58:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134607"
}
```



---

archive/issue_events_134608.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-04-04T19:54:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134608"
}
```



---

archive/issue_events_134609.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-04-04T19:54:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134609"
}
```



---

archive/issue_comments_112525.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI don't think the patch to the `$SAGE_ROOT/local/bin` is doing what you want.  The file being patched there is just the spkg-install file for the scripts repository; it's not a template for general spkg-install files.  (So if nothing else, your new comment at the top of the file should be changed or deleted.) If you want to patch other spkg-install files, you'll have to patch each repository -- the Sage library, extcode, and sagenb -- individually.",
    "created_at": "2011-04-04T19:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112525",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">Comment 9</div>

I don't think the patch to the `$SAGE_ROOT/local/bin` is doing what you want.  The file being patched there is just the spkg-install file for the scripts repository; it's not a template for general spkg-install files.  (So if nothing else, your new comment at the top of the file should be changed or deleted.) If you want to patch other spkg-install files, you'll have to patch each repository -- the Sage library, extcode, and sagenb -- individually.



---

archive/issue_comments_112526.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nWow, I'm not sure how I screwed that one up so badly... d'oh. You are absolutely right. I'll upload new patches tomorrow - thanks for the pointer!",
    "created_at": "2011-04-04T20:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112526",
    "user": "https://github.com/kini"
}
```

<div id="comment:10" align="right">Comment 10</div>

Wow, I'm not sure how I screwed that one up so badly... d'oh. You are absolutely right. I'll upload new patches tomorrow - thanks for the pointer!



---

archive/issue_comments_112527.json:
```json
{
    "body": "Attachment: **[trac_11121-hgrc.data-extcode.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz)**\n\napply to $SAGE_ROOT/data/extcode",
    "created_at": "2011-04-05T08:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112527",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_11121-hgrc.data-extcode.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz)**

apply to $SAGE_ROOT/data/extcode



---

archive/issue_comments_112528.json:
```json
{
    "body": "Attachment: **[trac_11121-hgrc.devel-sagenb.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz)**\n\napply to $SAGE_ROOT/devel/sagenb",
    "created_at": "2011-04-05T08:13:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112528",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_11121-hgrc.devel-sagenb.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz)**

apply to $SAGE_ROOT/devel/sagenb



---

archive/issue_comments_112529.json:
```json
{
    "body": "Attachment: **[trac_11121-hgrc.local-bin.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz)**\n\napply to $SAGE_ROOT/local/bin",
    "created_at": "2011-04-05T08:13:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112529",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_11121-hgrc.local-bin.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz)**

apply to $SAGE_ROOT/local/bin



---

archive/issue_comments_112530.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,12 @@\n As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n \n This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).\n+\n+Apply trac_11121-hgrc.data-extcode.patch to data/extcode\n+\n+Apply trac_11121-hgrc.devel-sage.patch to devel/sage\n+\n+Apply trac_11121-hgrc.devel-sagenb.patch to devel/sagenb\n \n Apply trac_11121-hgrc.local-bin.patch to local/bin\n \n``````\n",
    "created_at": "2011-04-05T08:14:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112530",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,12 @@
 As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).
 
 This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).
+
+Apply trac_11121-hgrc.data-extcode.patch to data/extcode
+
+Apply trac_11121-hgrc.devel-sage.patch to devel/sage
+
+Apply trac_11121-hgrc.devel-sagenb.patch to devel/sagenb
 
 Apply trac_11121-hgrc.local-bin.patch to local/bin
 
``````




---

archive/issue_comments_112531.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nnothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.",
    "created_at": "2011-04-05T10:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112531",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">Comment 12</div>

nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.



---

archive/issue_comments_112532.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\n... OK, I very apparently don't know what I'm doing. I'll do some more poking around and learning before marking this needs_review again... sorry for the email spam.",
    "created_at": "2011-04-05T11:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112532",
    "user": "https://github.com/kini"
}
```

<div id="comment:13" align="right">Comment 13</div>

... OK, I very apparently don't know what I'm doing. I'll do some more poking around and learning before marking this needs_review again... sorry for the email spam.



---

archive/issue_comments_112533.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@dimpase](#comment%3A12):\n> nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.\n\n`$SAGE_ROOT/local/bin` is the Sage scripts repo, so it's fine to patch it.  Or maybe I don't understand your complaint.\n\nKini, do you also want to patch the Sage root repo?  Its spkg-install file is `SAGE_ROOT/spkg/root-spkg-install`.",
    "created_at": "2011-04-05T14:08:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112533",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@dimpase](#comment%3A12):
> nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.

`$SAGE_ROOT/local/bin` is the Sage scripts repo, so it's fine to patch it.  Or maybe I don't understand your complaint.

Kini, do you also want to patch the Sage root repo?  Its spkg-install file is `SAGE_ROOT/spkg/root-spkg-install`.



---

archive/issue_comments_112534.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@jhpalmieri](#comment%3A14):\n> Replying to [@dimpase](#comment%3A12):\n> > nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.\n\n> \n> `$SAGE_ROOT/local/bin` is the Sage scripts repo, so it's fine to patch it.  Or maybe I don't understand your complaint.\n> \n\nmy bad, I didn't know that some parts of local/bin are actually in the scripts spkg...",
    "created_at": "2011-04-05T14:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112534",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@jhpalmieri](#comment%3A14):
> Replying to [@dimpase](#comment%3A12):
> > nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.

> 
> `$SAGE_ROOT/local/bin` is the Sage scripts repo, so it's fine to patch it.  Or maybe I don't understand your complaint.
> 

my bad, I didn't know that some parts of local/bin are actually in the scripts spkg...



---

archive/issue_comments_112535.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@jhpalmieri](#comment%3A14):\n> Replying to [@dimpase](#comment%3A12):\n> > nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.\n\n> \n> `$SAGE_ROOT/local/bin` is the Sage scripts repo, so it's fine to patch it.  Or maybe I don't understand your complaint.\n> \n> Kini, do you also want to patch the Sage root repo?  Its spkg-install file is `SAGE_ROOT/spkg/root-spkg-install`.\n\nGot it. Yes, I'll do that...",
    "created_at": "2011-04-06T17:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112535",
    "user": "https://github.com/kini"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@jhpalmieri](#comment%3A14):
> Replying to [@dimpase](#comment%3A12):
> > nothing must be done to local/bin in your patches, which doesn't even exist in a source distribution. You need to patch the source instead.

> 
> `$SAGE_ROOT/local/bin` is the Sage scripts repo, so it's fine to patch it.  Or maybe I don't understand your complaint.
> 
> Kini, do you also want to patch the Sage root repo?  Its spkg-install file is `SAGE_ROOT/spkg/root-spkg-install`.

Got it. Yes, I'll do that...



---

archive/issue_comments_112536.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,3 @@\n-As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n-\n-This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).\n-\n Apply trac_11121-hgrc.data-extcode.patch to data/extcode\n \n Apply trac_11121-hgrc.devel-sage.patch to devel/sage\n@@ -10,11 +6,12 @@\n \n Apply trac_11121-hgrc.local-bin.patch to local/bin\n \n-Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg\n+Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg (or download [this ready-made SPKG file](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11121 and #11120)\n \n-Put the following lines in $SAGE_ROOT/.hg/hgrc in the distribution tarball:\n+Apply trac_11121-hgrc.sage.patch to the root repository\n \n-```\n-[diff]\n-git = true\n-```\n+---\n+\n+As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n+\n+This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).\n``````\n",
    "created_at": "2011-04-06T17:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112536",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,3 @@
-As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).
-
-This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).
-
 Apply trac_11121-hgrc.data-extcode.patch to data/extcode
 
 Apply trac_11121-hgrc.devel-sage.patch to devel/sage
@@ -10,11 +6,12 @@
 
 Apply trac_11121-hgrc.local-bin.patch to local/bin
 
-Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg
+Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg (or download [this ready-made SPKG file](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11121 and #11120)
 
-Put the following lines in $SAGE_ROOT/.hg/hgrc in the distribution tarball:
+Apply trac_11121-hgrc.sage.patch to the root repository
 
-```
-[diff]
-git = true
-```
+---
+
+As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).
+
+This would involve making the Mercurial spkg install an hgrc at $SAGE_LOCAL/etc/mercurial/hgrc as well as adding lines to .hg/hgrc in the major repositories in the sage distribution (`.`, `data/extcode`, `devel/sage/`, `devel/sagenb/`, and `local/bin/`). I exclude `examples` and `spkg/base` because they are scheduled to be gotten rid of (#7494 and #11073 respectively).
``````




---

archive/issue_comments_112537.json:
```json
{
    "body": "Attachment: **[trac_11121-hgrc.sage.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.sage.patch.gz)**\n\napply to $SAGE_ROOT",
    "created_at": "2011-04-06T17:25:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112537",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_11121-hgrc.sage.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.sage.patch.gz)**

apply to $SAGE_ROOT



---

archive/issue_comments_112538.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nTrying out `sage-sdist` I find that making `hg diff` go to a pager by default might screw up some of the scripts (or at the very least cause them to become interactive when they shouldn't be). This is bad, but should I make `hg diff` not go to a pager by default, or just stick a `--pager=` on any usages of `hg diff` in scripts? Paging diffs is a really nice feature that I think should be standard, but on the other hand it seems a bit intrusive to have to explicitly specify `--pager=` in a script.\n\nThen again, why are we even running `hg diff` in scripts? All the examples of this I could find were either just standalone lines running `hg diff`, or, in one case, `local/bin/sage-pkg`, an attempt to figure out whether uncommitted changes existed in the directory (which could just as easily be done by searching `$(hg summary)` for \"(clean)\", if I'm not mistaken.\n\nAny comments?",
    "created_at": "2011-04-06T19:08:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112538",
    "user": "https://github.com/kini"
}
```

<div id="comment:17" align="right">Comment 17</div>

Trying out `sage-sdist` I find that making `hg diff` go to a pager by default might screw up some of the scripts (or at the very least cause them to become interactive when they shouldn't be). This is bad, but should I make `hg diff` not go to a pager by default, or just stick a `--pager=` on any usages of `hg diff` in scripts? Paging diffs is a really nice feature that I think should be standard, but on the other hand it seems a bit intrusive to have to explicitly specify `--pager=` in a script.

Then again, why are we even running `hg diff` in scripts? All the examples of this I could find were either just standalone lines running `hg diff`, or, in one case, `local/bin/sage-pkg`, an attempt to figure out whether uncommitted changes existed in the directory (which could just as easily be done by searching `$(hg summary)` for "(clean)", if I'm not mistaken.

Any comments?



---

archive/issue_comments_112539.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nI'm a little wary of changing the default behavior in so many ways.  In general, wouldn't it be good enough to point to the [Mercurial extensions page](http://mercurial.selenic.com/wiki/UsingExtensions) and let people pick for themselves?  Or we could recommend some good choices.  We could do this in the developer's guide, when we discuss using Mercurial.  I guess it seems that enabling these extensions reflects the opinions of a few people, and it might be safer to just implement a few important changes (like git=true).  Anyway, here are some of my questions and opinions:\n\n```\n[trusted] \nusers = $USER     is this necessary?  what happens if we leave this out?\n\n[diff] \ngit = true        seems like a good idea\n\n[extensions] \ncolor =           innocuous\ngraphlog =        innocuous, but should it be \"hgext.graphlog=\"?  That's what the docs say.\nmq =              useful, keep it\npager =           see my comments below.\nprogress =        innocuous\npurge =           should this be \"hgext.purge=\"?  provides a potentially useful, but potentially dangerous, command\nrebase =          seems okay, but I've never used it\nrecord =          \"hgext.record=\"?\nrelink =          seems okay, but never used it\ntransplant =      seems okay, but never used it\n```\nRegarding \"pager\": first, should we follow the [Mercurial suggestions](http://mercurial.selenic.com/wiki/PagerExtension) and do\n\n```\n[pager]\npager = LESS='FSRX' less\n```\nSecond, if we use the pager extension, will it interfere with Sage functions like `hg_sage.diff()`?  These are defined in SAGE_ROOT/devel/sage/sage/misc/hg.py, and they call a pager already, a different one depending on whether working from the command-line or in the notebook.",
    "created_at": "2011-04-06T19:58:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112539",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:18" align="right">Comment 18</div>

I'm a little wary of changing the default behavior in so many ways.  In general, wouldn't it be good enough to point to the [Mercurial extensions page](http://mercurial.selenic.com/wiki/UsingExtensions) and let people pick for themselves?  Or we could recommend some good choices.  We could do this in the developer's guide, when we discuss using Mercurial.  I guess it seems that enabling these extensions reflects the opinions of a few people, and it might be safer to just implement a few important changes (like git=true).  Anyway, here are some of my questions and opinions:

```
[trusted] 
users = $USER     is this necessary?  what happens if we leave this out?

[diff] 
git = true        seems like a good idea

[extensions] 
color =           innocuous
graphlog =        innocuous, but should it be "hgext.graphlog="?  That's what the docs say.
mq =              useful, keep it
pager =           see my comments below.
progress =        innocuous
purge =           should this be "hgext.purge="?  provides a potentially useful, but potentially dangerous, command
rebase =          seems okay, but I've never used it
record =          "hgext.record="?
relink =          seems okay, but never used it
transplant =      seems okay, but never used it
```
Regarding "pager": first, should we follow the [Mercurial suggestions](http://mercurial.selenic.com/wiki/PagerExtension) and do

```
[pager]
pager = LESS='FSRX' less
```
Second, if we use the pager extension, will it interfere with Sage functions like `hg_sage.diff()`?  These are defined in SAGE_ROOT/devel/sage/sage/misc/hg.py, and they call a pager already, a different one depending on whether working from the command-line or in the notebook.



---

archive/issue_comments_112540.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nActually, let me revise one comment: the \"color\" extension is not innocuous: when it's enabled, the output from \"hg_sage.status()\" in the notebook has stray characters, presumably coming from the ASCII color-changing codes.  It looks like this:\n\n```\nGetting status of modified or unknown files:\ncd \"/Applications/sage/devel/sage\" && hg status\n[0;34;1mM sage/algebras/steenrod_algebra_bases.py[0m\n```\nThe last line should be\n\n```\nM sage/algebras/steenrod_algebra_bases.py\n```\nOn the other hand, with the color extension enabled, the output looks good from the command line.  So if we want to use color, we should have separate hgrc files, one for the notebook and one for the command-line. \n\nI'm a little suspicious of enabling some of the others of these in the notebook, for example \"progress\".  On the bright side, enabling \"pager\" doesn't seem to have any detrimental effect in the notebook.",
    "created_at": "2011-04-06T20:29:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112540",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">Comment 19</div>

Actually, let me revise one comment: the "color" extension is not innocuous: when it's enabled, the output from "hg_sage.status()" in the notebook has stray characters, presumably coming from the ASCII color-changing codes.  It looks like this:

```
Getting status of modified or unknown files:
cd "/Applications/sage/devel/sage" && hg status
[0;34;1mM sage/algebras/steenrod_algebra_bases.py[0m
```
The last line should be

```
M sage/algebras/steenrod_algebra_bases.py
```
On the other hand, with the color extension enabled, the output looks good from the command line.  So if we want to use color, we should have separate hgrc files, one for the notebook and one for the command-line. 

I'm a little suspicious of enabling some of the others of these in the notebook, for example "progress".  On the bright side, enabling "pager" doesn't seem to have any detrimental effect in the notebook.



---

archive/issue_comments_112541.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nSee #11142 for a way to deal with the \"pager\" and \"color\" issues.  With the patch there, we should definitely turn on the pager extension, and we can turn on the color extension without breaking anything in the notebook.",
    "created_at": "2011-04-06T22:41:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112541",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">Comment 20</div>

See #11142 for a way to deal with the "pager" and "color" issues.  With the patch there, we should definitely turn on the pager extension, and we can turn on the color extension without breaking anything in the notebook.



---

archive/issue_comments_112542.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nJohn, thanks for your comments, and your fast work on #11142! I agree with you that most of the defaults set in my patch are just personal preference, but I did try to add all extensions that seemed relevant. Let me go down the list:\n\n* `users = $USER` is put there on the assumption that whoever is installing the mercurial SPKG will also be the owner of the files in the sage installation. All the other patches are applied towards creating .hgrc files in [repository root]`/.hg/hgrc`, which is not parsed when using mercurial unless the file is either owned by the same person as the person who is invoking `hg`, or the owner of [repository root]`/.hg/hgrc` is listed as a trusted user in some other hgrc file which HAS been read (such as this one, `$SAGE_ROOT/local/etc/mercurial/hgrc`.\n* `git = true` was the original point of this ticket :)\n* Prepending `hgext.` is apparently unnecessary in newer versions of Mercurial, says `#mercurial` on freenode. I was even invited to submit a patch to the man page for hgrc...\n  * `color` is nice on the commandline.\n  * `graphlog` is indispensable (imho) for seeing what exactly is going on with the history of a particular mercurial repository.\n  * `mq` is of course useful.\n  * `pager` is useful.\n  * `progress` is not really necessary - if it interferes with the notebook I guess it's better to get rid of it.\n  * `purge` is not all that important, but since it only adds a new command it shouldn't screw up anything else.\n  * `rebase` is great for rebasing mq patches on new versions of sage, something I'll need in order to fix #10988, I think.\n  * `record` is useful.\n  * `relink` seems nice for people who use `sage -clone`, though I don't use either myself.\n  * `transplant` seems to be useful in some way, but I've never used it either (maybe not that great of an idea to include, then.)\n* The suggestions for parameters to `less` given on the Mercurial wiki are also a matter of personal preference. By default, `less` doesn't leave anything in the terminal after it exits (it restores whatever was on the screen before you called it), but the `X` option disables this behavior. The `F` option also disables this behavior, in a sense, by acting like `cat` when the screen is large enough to take the entire output. The `S` option truncates long lines instead of wrapping them. The `R` option (which is in my patch) displays (ANSI) terminal color codes. My preference is still to just keep `R` of these four, but whoever wrote the Mercurial wiki article disagrees. It's not really possible to be that objective about this, I think...\n\nI'll go take a look at #11142.",
    "created_at": "2011-04-07T04:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112542",
    "user": "https://github.com/kini"
}
```

<div id="comment:21" align="right">Comment 21</div>

John, thanks for your comments, and your fast work on #11142! I agree with you that most of the defaults set in my patch are just personal preference, but I did try to add all extensions that seemed relevant. Let me go down the list:

* `users = $USER` is put there on the assumption that whoever is installing the mercurial SPKG will also be the owner of the files in the sage installation. All the other patches are applied towards creating .hgrc files in [repository root]`/.hg/hgrc`, which is not parsed when using mercurial unless the file is either owned by the same person as the person who is invoking `hg`, or the owner of [repository root]`/.hg/hgrc` is listed as a trusted user in some other hgrc file which HAS been read (such as this one, `$SAGE_ROOT/local/etc/mercurial/hgrc`.
* `git = true` was the original point of this ticket :)
* Prepending `hgext.` is apparently unnecessary in newer versions of Mercurial, says `#mercurial` on freenode. I was even invited to submit a patch to the man page for hgrc...
  * `color` is nice on the commandline.
  * `graphlog` is indispensable (imho) for seeing what exactly is going on with the history of a particular mercurial repository.
  * `mq` is of course useful.
  * `pager` is useful.
  * `progress` is not really necessary - if it interferes with the notebook I guess it's better to get rid of it.
  * `purge` is not all that important, but since it only adds a new command it shouldn't screw up anything else.
  * `rebase` is great for rebasing mq patches on new versions of sage, something I'll need in order to fix #10988, I think.
  * `record` is useful.
  * `relink` seems nice for people who use `sage -clone`, though I don't use either myself.
  * `transplant` seems to be useful in some way, but I've never used it either (maybe not that great of an idea to include, then.)
* The suggestions for parameters to `less` given on the Mercurial wiki are also a matter of personal preference. By default, `less` doesn't leave anything in the terminal after it exits (it restores whatever was on the screen before you called it), but the `X` option disables this behavior. The `F` option also disables this behavior, in a sense, by acting like `cat` when the screen is large enough to take the entire output. The `S` option truncates long lines instead of wrapping them. The `R` option (which is in my patch) displays (ANSI) terminal color codes. My preference is still to just keep `R` of these four, but whoever wrote the Mercurial wiki article disagrees. It's not really possible to be that objective about this, I think...

I'll go take a look at #11142.



---

archive/issue_comments_112543.json:
```json
{
    "body": "Attachment: **[trac_11121-hgrc.devel-sage.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz)**\n\napply to $SAGE_ROOT/devel/sage",
    "created_at": "2011-06-14T00:27:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112543",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_11121-hgrc.devel-sage.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz)**

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_112544.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nI'm going to upgrade Mercurial to 1.8.4 and incorporate this and #11120 into the new spkg.",
    "created_at": "2011-06-14T00:27:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112544",
    "user": "https://github.com/kini"
}
```

<div id="comment:23" align="right">Comment 23</div>

I'm going to upgrade Mercurial to 1.8.4 and incorporate this and #11120 into the new spkg.



---

archive/issue_comments_112545.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nBefore you put too much effort into upgrading Mercurial, read [this comment](https://github.com/sagemath/sage/issues/10594#comment:13).  Unless there is a strong argument for it, it looks like a new version of Mercurial isn't likely to get merged.",
    "created_at": "2011-06-14T00:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112545",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">Comment 24</div>

Before you put too much effort into upgrading Mercurial, read [this comment](https://github.com/sagemath/sage/issues/10594#comment:13).  Unless there is a strong argument for it, it looks like a new version of Mercurial isn't likely to get merged.



---

archive/issue_comments_112546.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nReplying to [@jhpalmieri](#comment%3A24):\n> Before you put too much effort into upgrading Mercurial, read [this comment](https://github.com/sagemath/sage/issues/10594#comment:13).  Unless there is a strong argument for it, it looks like a new version of Mercurial isn't likely to get merged.\n\nThanks for the heads up. I've packaged it already without any obvious trouble. I hope this doesn't mean we're going to be stuck with 1.6.4 forever? Surely we need to upgrade eventually. We're already two versions behind, soon to be three, a couple of weeks from now.",
    "created_at": "2011-06-14T01:07:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112546",
    "user": "https://github.com/kini"
}
```

<div id="comment:25" align="right">Comment 25</div>

Replying to [@jhpalmieri](#comment%3A24):
> Before you put too much effort into upgrading Mercurial, read [this comment](https://github.com/sagemath/sage/issues/10594#comment:13).  Unless there is a strong argument for it, it looks like a new version of Mercurial isn't likely to get merged.

Thanks for the heads up. I've packaged it already without any obvious trouble. I hope this doesn't mean we're going to be stuck with 1.6.4 forever? Surely we need to upgrade eventually. We're already two versions behind, soon to be three, a couple of weeks from now.



---

archive/issue_comments_112547.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nReplying to [@kini](#comment%3A21):\n> John, thanks for your comments, and your fast work on #11142! I agree with you that most of the defaults set in my patch are just personal preference, but I did try to add all extensions that seemed relevant. Let me go down the list:\n\n>\n\nI'm confused.  So does that mean that now anyone without a .hgrc file will automatically have all this?  \n\nIn that case, I agree that maybe just the things that are necessary should be fixed, and the rest left optional but well documented in the devel manual.",
    "created_at": "2011-06-14T03:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112547",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:26" align="right">Comment 26</div>

Replying to [@kini](#comment%3A21):
> John, thanks for your comments, and your fast work on #11142! I agree with you that most of the defaults set in my patch are just personal preference, but I did try to add all extensions that seemed relevant. Let me go down the list:

>

I'm confused.  So does that mean that now anyone without a .hgrc file will automatically have all this?  

In that case, I agree that maybe just the things that are necessary should be fixed, and the rest left optional but well documented in the devel manual.



---

archive/issue_comments_112548.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nYeah, I'll just leave git diffs, color and pager for #11142, and rebase and relink because they will be useful in automated scripts in the future.",
    "created_at": "2011-06-14T03:53:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112548",
    "user": "https://github.com/kini"
}
```

<div id="comment:27" align="right">Comment 27</div>

Yeah, I'll just leave git diffs, color and pager for #11142, and rebase and relink because they will be useful in automated scripts in the future.



---

archive/issue_comments_112549.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nEr, sorry, and mq, of course.",
    "created_at": "2011-06-14T03:53:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112549",
    "user": "https://github.com/kini"
}
```

<div id="comment:28" align="right">Comment 28</div>

Er, sorry, and mq, of course.



---

archive/issue_comments_112550.json:
```json
{
    "body": "Attachment: **[trac_11121-hgrc.mercurial-spkg.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.mercurial-spkg.patch.gz)**\n\ndon't use this, I'll upload a full spkg",
    "created_at": "2011-06-14T03:55:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112550",
    "user": "https://github.com/kini"
}
```

Attachment: **[trac_11121-hgrc.mercurial-spkg.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.mercurial-spkg.patch.gz)**

don't use this, I'll upload a full spkg



---

archive/issue_comments_112551.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nOK, assuming I didn't forget anything, [this spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg) should obviate trac_11121-hgrc.mercurial-spkg.patch and make this ticket ready for review.",
    "created_at": "2011-06-14T06:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112551",
    "user": "https://github.com/kini"
}
```

<div id="comment:29" align="right">Comment 29</div>

OK, assuming I didn't forget anything, [this spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg) should obviate trac_11121-hgrc.mercurial-spkg.patch and make this ticket ready for review.



---

archive/issue_comments_112552.json:
```json
{
    "body": "Author: **Keshav Kini**",
    "created_at": "2011-06-14T06:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112552",
    "user": "https://github.com/kini"
}
```

Author: **Keshav Kini**



---

archive/issue_comments_112553.json:
```json
{
    "body": "Changed keywords from **mercurial, git, diff, patches** to **mercurial git diff patches sd31**",
    "created_at": "2011-06-14T06:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112553",
    "user": "https://github.com/kini"
}
```

Changed keywords from **mercurial, git, diff, patches** to **mercurial git diff patches sd31**



---

archive/issue_comments_112554.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,7 +6,7 @@\n \n Apply trac_11121-hgrc.local-bin.patch to local/bin\n \n-Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg (or download [this ready-made SPKG file](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11121 and #11120)\n+Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well\n \n Apply trac_11121-hgrc.sage.patch to the root repository\n \n``````\n",
    "created_at": "2011-06-14T06:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112554",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,7 +6,7 @@
 
 Apply trac_11121-hgrc.local-bin.patch to local/bin
 
-Apply trac_11121-hgrc.mercurial-spkg.patch to . in mercurial-1.6.4.p0.spkg (or download [this ready-made SPKG file](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11121 and #11120)
+Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well
 
 Apply trac_11121-hgrc.sage.patch to the root repository
 
``````




---

archive/issue_events_134610.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-06-14T06:28:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134610"
}
```



---

archive/issue_events_134611.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-06-14T06:28:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134611"
}
```



---

archive/issue_comments_112555.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nI disagree with\n\n```\n[pager] \npager = less -R \nattend = annotate, cat, diff, log, glog, qdiff \n```\n\nThis looks too much like pushing your own personal preferences.",
    "created_at": "2011-06-14T21:00:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112555",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">Comment 30</div>

I disagree with

```
[pager] 
pager = less -R 
attend = annotate, cat, diff, log, glog, qdiff 
```

This looks too much like pushing your own personal preferences.



---

archive/issue_comments_112556.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nI would be happy with\n\n```\n[pager]\npager = LESS='FSRX' less\n```\nsince this is what is recommended on [the Mercurial web page](http://mercurial.selenic.com/wiki/PagerExtension).  (The \"attend\" setting above is almost the same, so I actually don't think that's a big deal, but it may be safest to just use what Mercurial advertises.  That's as close to an official standard as we can get.)",
    "created_at": "2011-06-14T21:27:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112556",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">Comment 31</div>

I would be happy with

```
[pager]
pager = LESS='FSRX' less
```
since this is what is recommended on [the Mercurial web page](http://mercurial.selenic.com/wiki/PagerExtension).  (The "attend" setting above is almost the same, so I actually don't think that's a big deal, but it may be safest to just use what Mercurial advertises.  That's as close to an official standard as we can get.)



---

archive/issue_comments_112557.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nNote that that page is a wiki and anyone can change it (indeed I just fixed a typo on it). In fact there are even people arguing about these LESS options (and even suggesting that people install the plan 9 pager!) at the end of the page. The official standard would be to not set any variables in .hgrc at all, but this ticket is all about not doing that.\n\nNevertheless I'll change the options to reflect what is written there since you insist.",
    "created_at": "2011-06-14T21:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112557",
    "user": "https://github.com/kini"
}
```

<div id="comment:32" align="right">Comment 32</div>

Note that that page is a wiki and anyone can change it (indeed I just fixed a typo on it). In fact there are even people arguing about these LESS options (and even suggesting that people install the plan 9 pager!) at the end of the page. The official standard would be to not set any variables in .hgrc at all, but this ticket is all about not doing that.

Nevertheless I'll change the options to reflect what is written there since you insist.



---

archive/issue_comments_112558.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nI would suggest not to put any `pager` variables at all.",
    "created_at": "2011-06-14T21:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112558",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">Comment 33</div>

I would suggest not to put any `pager` variables at all.



---

archive/issue_comments_112559.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\n>       Setting pager.attend to an empty value will cause all commands to be paged.\n\nOr so says the hg man page. This seems more intrusive of a change than setting the `attend` variable. I guess choosing the pager itself is not necessary, so I'll skip it (#11142 sets it manually anyway).",
    "created_at": "2011-06-14T22:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112559",
    "user": "https://github.com/kini"
}
```

<div id="comment:34" align="right">Comment 34</div>

>       Setting pager.attend to an empty value will cause all commands to be paged.

Or so says the hg man page. This seems more intrusive of a change than setting the `attend` variable. I guess choosing the pager itself is not necessary, so I'll skip it (#11142 sets it manually anyway).



---

archive/issue_comments_112560.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nOK, changed.",
    "created_at": "2011-06-14T22:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112560",
    "user": "https://github.com/kini"
}
```

<div id="comment:35" align="right">Comment 35</div>

OK, changed.



---

archive/issue_comments_112561.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nIn the patch for the mercurial spkg, the hgrc file doesn't quite do what I would like.  In particular, if there are no lines like\n\n```\n[pager]\npager = LESS='FSRX' less\n```\nthen the pager extension doesn't do anything, so for example running \"hg log\" just scrolls through the whole log without pausing.  Is that what you intended?",
    "created_at": "2011-06-22T00:08:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112561",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:36" align="right">Comment 36</div>

In the patch for the mercurial spkg, the hgrc file doesn't quite do what I would like.  In particular, if there are no lines like

```
[pager]
pager = LESS='FSRX' less
```
then the pager extension doesn't do anything, so for example running "hg log" just scrolls through the whole log without pausing.  Is that what you intended?



---

archive/issue_comments_112562.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nIt is what I intended, because it is what Jeroen suggested I do. If you suggest I do otherwise, then in the interest of expediency I will follow the suggestion of whoever promises to review this first :P I have my own `~/.hgrc` with `pager = less -R` in it anyway, so it doesn't much matter to me. As you said earlier, the most important thing here is to get \"git=true\" in there.\n\nOne benefit I can think of for not putting `pager = LESS='FSRX' less` in the `hgrc` is that the various scripts which (unwisely, in my opinion) call mercurial commands such as `diff`, `log`, `status`, etc. during build processes which are supposed to be unattended can be guaranteed not to halt waiting for someone to exit `less`, whereas at the moment, I, at least, have not vetted all such scripts to make sure this doesn't happen.",
    "created_at": "2011-06-22T00:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112562",
    "user": "https://github.com/kini"
}
```

<div id="comment:37" align="right">Comment 37</div>

It is what I intended, because it is what Jeroen suggested I do. If you suggest I do otherwise, then in the interest of expediency I will follow the suggestion of whoever promises to review this first :P I have my own `~/.hgrc` with `pager = less -R` in it anyway, so it doesn't much matter to me. As you said earlier, the most important thing here is to get "git=true" in there.

One benefit I can think of for not putting `pager = LESS='FSRX' less` in the `hgrc` is that the various scripts which (unwisely, in my opinion) call mercurial commands such as `diff`, `log`, `status`, etc. during build processes which are supposed to be unattended can be guaranteed not to halt waiting for someone to exit `less`, whereas at the moment, I, at least, have not vetted all such scripts to make sure this doesn't happen.



---

archive/issue_comments_112563.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nOkay, that makes sense.  Let's leave it the way you have it.  (I have \"pager= LESS ...\" in my own .hgrc file, and I've never noticed any problems with Sage pausing during a build, but I think it's fine to leave it unset in the default hgrc file.)",
    "created_at": "2011-06-22T01:34:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112563",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:38" align="right">Comment 38</div>

Okay, that makes sense.  Let's leave it the way you have it.  (I have "pager= LESS ..." in my own .hgrc file, and I've never noticed any problems with Sage pausing during a build, but I think it's fine to leave it unset in the default hgrc file.)



---

archive/issue_comments_112564.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nSince the file SAGE_LOCAL/etc/mercurial/hgrc sets \"git=true\", do we also need to set it for each repository individually?  That is, do we need all of these patches, or just the one present in the new spkg in #10594?",
    "created_at": "2011-06-22T01:41:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112564",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:39" align="right">Comment 39</div>

Since the file SAGE_LOCAL/etc/mercurial/hgrc sets "git=true", do we also need to set it for each repository individually?  That is, do we need all of these patches, or just the one present in the new spkg in #10594?



---

archive/issue_comments_112565.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nReplying to [@jhpalmieri](#comment%3A36):\n> In the patch for the mercurial spkg, the hgrc file doesn't quite do what I would like.  In particular, if there are no lines like\n> \n> ```\n> [pager]\n> pager = LESS='FSRX' less\n> ```\n> then the pager extension doesn't do anything, so for example running \"hg log\" just scrolls through the whole log without pausing.  Is that what you intended?\n\nSo if someone doesn't have this set, then what would \n\n```\nhg_sage.log()\n```\ndo?  I tremble to think of the brand-new developer, who is not sure how to set up hg as an alias, trying this and being deluged by thousands of changes... At any rate, hg_sage.[tab] things should continue behaving as they have in this respect, using either 'more' or 'less' as the default (I don't know which it is, though).  If the pager option breaks this, it should be a no-go in my opinion.",
    "created_at": "2011-06-22T02:04:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112565",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:40" align="right">Comment 40</div>

Replying to [@jhpalmieri](#comment%3A36):
> In the patch for the mercurial spkg, the hgrc file doesn't quite do what I would like.  In particular, if there are no lines like
> 
> ```
> [pager]
> pager = LESS='FSRX' less
> ```
> then the pager extension doesn't do anything, so for example running "hg log" just scrolls through the whole log without pausing.  Is that what you intended?

So if someone doesn't have this set, then what would 

```
hg_sage.log()
```
do?  I tremble to think of the brand-new developer, who is not sure how to set up hg as an alias, trying this and being deluged by thousands of changes... At any rate, hg_sage.[tab] things should continue behaving as they have in this respect, using either 'more' or 'less' as the default (I don't know which it is, though).  If the pager option breaks this, it should be a no-go in my opinion.



---

archive/issue_comments_112566.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nkcrisman: Review #11142 then! :)\n\njhpalmieri: The other patches ensure that the user will produce git patches from sage repositories even if they are simultaneously 1) using their system's Mercurial instead of `sage -hg` and 2) not using git diffs globally in their system's Mercurial.",
    "created_at": "2011-06-22T02:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112566",
    "user": "https://github.com/kini"
}
```

<div id="comment:41" align="right">Comment 41</div>

kcrisman: Review #11142 then! :)

jhpalmieri: The other patches ensure that the user will produce git patches from sage repositories even if they are simultaneously 1) using their system's Mercurial instead of `sage -hg` and 2) not using git diffs globally in their system's Mercurial.



---

archive/issue_comments_112567.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nkcrisman: Oops, you already are reviewing it. Sorry! :) Then to answer what I guess your actual question is, it won't make any difference as jhpalmieri's patch for #11142 manually uses `less` rather than relying on the `hgrc` file.",
    "created_at": "2011-06-22T02:29:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112567",
    "user": "https://github.com/kini"
}
```

<div id="comment:42" align="right">Comment 42</div>

kcrisman: Oops, you already are reviewing it. Sorry! :) Then to answer what I guess your actual question is, it won't make any difference as jhpalmieri's patch for #11142 manually uses `less` rather than relying on the `hgrc` file.



---

archive/issue_comments_112568.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nSo you're saying that \n\n```\nreturn '--config pager.pager=\"LESS=\\'FSRX\\' less\"'\n```\nwould keep the current behavior?  I don't understand that part of it.  What is `FSRX`?\n\nSo in principle, if one *only* merged this ticket, behavior would change, but if one then also merges #11142, it's ok.  Is that right?",
    "created_at": "2011-06-22T14:27:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112568",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:43" align="right">Comment 43</div>

So you're saying that 

```
return '--config pager.pager="LESS=\'FSRX\' less"'
```
would keep the current behavior?  I don't understand that part of it.  What is `FSRX`?

So in principle, if one *only* merged this ticket, behavior would change, but if one then also merges #11142, it's ok.  Is that right?



---

archive/issue_comments_112569.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nI think if you only merge this ticket, behavior would stay the same, because the paging in commands coming from \"hg_sage\" (etc.) are done by hand in hg.py.  For example, hg_sage.log() runs \"sage -hg log | less\", so it doesn't matter whether any hgrc file has a pager set.\n\n`FSRX` are flags for the \"less\" command:\n\n- F exits automatically if the output fits on one screen\n- S truncates long lines\n- R preserves any color specification (and mercurial can use color in logs, diffs, etc.)\n- X doesn't clear the screen when you're done",
    "created_at": "2011-06-22T15:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112569",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">Comment 44</div>

I think if you only merge this ticket, behavior would stay the same, because the paging in commands coming from "hg_sage" (etc.) are done by hand in hg.py.  For example, hg_sage.log() runs "sage -hg log | less", so it doesn't matter whether any hgrc file has a pager set.

`FSRX` are flags for the "less" command:

- F exits automatically if the output fits on one screen
- S truncates long lines
- R preserves any color specification (and mercurial can use color in logs, diffs, etc.)
- X doesn't clear the screen when you're done



---

archive/issue_comments_112570.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nThanks, John.  I think I see that all now.  And the flags are exactly the current behavior - convenient!\n\nI won't be reviewing much until my normal computer comes back from the doctor, but then #11142 sounds like it will likely be good - once you do the things I suggest there ;) - and maybe this one too.",
    "created_at": "2011-06-22T15:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112570",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:45" align="right">Comment 45</div>

Thanks, John.  I think I see that all now.  And the flags are exactly the current behavior - convenient!

I won't be reviewing much until my normal computer comes back from the doctor, but then #11142 sounds like it will likely be good - once you do the things I suggest there ;) - and maybe this one too.



---

archive/issue_comments_112571.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nI'm not sure how they are \"exactly the current behavior\" - perhaps they are the defaults for `less` on your system? The `less` man page on my system at least explicitly says that `-S` is non-default behavior. And if we're going to stick to the manpage, it should technically be `LESS='-FSRX'`, not `LESS='FSRX'`. Also, none of those four flags are in the POSIX spec for `more`. But no matter, since this is not going into the spkg anyway :)",
    "created_at": "2011-06-22T15:30:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112571",
    "user": "https://github.com/kini"
}
```

<div id="comment:46" align="right">Comment 46</div>

I'm not sure how they are "exactly the current behavior" - perhaps they are the defaults for `less` on your system? The `less` man page on my system at least explicitly says that `-S` is non-default behavior. And if we're going to stick to the manpage, it should technically be `LESS='-FSRX'`, not `LESS='FSRX'`. Also, none of those four flags are in the POSIX spec for `more`. But no matter, since this is not going into the spkg anyway :)



---

archive/issue_comments_112572.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nI have one new concern: the new notebook (the flask version) comes with a file `.hg/hgrc`, so I don't think we should overwrite it.  It contains just this:\n\n```\n[paths]\ndefault = https://rkirov-flask.googlecode.com/hg/\n```",
    "created_at": "2011-07-01T18:30:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112572",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:47" align="right">Comment 47</div>

I have one new concern: the new notebook (the flask version) comes with a file `.hg/hgrc`, so I don't think we should overwrite it.  It contains just this:

```
[paths]
default = https://rkirov-flask.googlecode.com/hg/
```



---

archive/issue_comments_112573.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nNo, `.hg/hgrc` is not transferred across clones or pulls. Rather the file you are seeing was created by your local Mercurial when you did `hg clone https://rkirov-flask.googlecode.com/hg/`, to make it so that `hg pull` would by default pull from `https://rkirov-flask.googlecode.com/hg/`. When the flask notebook is distributed with sage, this `hgrc` file will not exist (or should not exist, otherwise our distribution tools are misusing Mercurial).",
    "created_at": "2011-07-01T20:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112573",
    "user": "https://github.com/kini"
}
```

<div id="comment:48" align="right">Comment 48</div>

No, `.hg/hgrc` is not transferred across clones or pulls. Rather the file you are seeing was created by your local Mercurial when you did `hg clone https://rkirov-flask.googlecode.com/hg/`, to make it so that `hg pull` would by default pull from `https://rkirov-flask.googlecode.com/hg/`. When the flask notebook is distributed with sage, this `hgrc` file will not exist (or should not exist, otherwise our distribution tools are misusing Mercurial).



---

archive/issue_comments_112574.json:
```json
{
    "body": "Attachment: **[trac_11121-root-repo.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz)**\n\napply to $SAGE_ROOT",
    "created_at": "2011-07-02T05:40:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112574",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_11121-root-repo.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz)**

apply to $SAGE_ROOT



---

archive/issue_comments_112575.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nI tried applying the patches, then running \"sage -sdist ...\", and then building from the resulting tar ball.  The patch for the root repo isn't working; I think the spkg-install script is exiting before the part which creates the hgrc file.  The code to create the hgrc file might have to appear several times in that file, since there are several places it can successfully exit.  Maybe try [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) instead.",
    "created_at": "2011-07-02T05:41:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112575",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:49" align="right">Comment 49</div>

I tried applying the patches, then running "sage -sdist ...", and then building from the resulting tar ball.  The patch for the root repo isn't working; I think the spkg-install script is exiting before the part which creates the hgrc file.  The code to create the hgrc file might have to appear several times in that file, since there are several places it can successfully exit.  Maybe try [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) instead.



---

archive/issue_comments_112576.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nWhoops, yes, you're right. Thanks for the patch.",
    "created_at": "2011-07-02T06:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112576",
    "user": "https://github.com/kini"
}
```

<div id="comment:50" align="right">Comment 50</div>

Whoops, yes, you're right. Thanks for the patch.



---

archive/issue_comments_112577.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \n Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well\n \n-Apply trac_11121-hgrc.sage.patch to the root repository\n+Apply trac_11121-root-repo.patch to the root repository\n \n ---\n \n``````\n",
    "created_at": "2011-07-02T06:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112577",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 
 Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well
 
-Apply trac_11121-hgrc.sage.patch to the root repository
+Apply trac_11121-root-repo.patch to the root repository
 
 ---
 
``````




---

archive/issue_comments_112578.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nOne small issue: as you said, .hg/hgrc is not transferred during clones, so if you \"sage -clone ...\", the \"git\" setting is lost for that repo.  If people don't work with clones, or if they use the version of Mercurial distributed with Sage, or if they have \"git=1\" in their own .hgrc file, this won't affect them.  I suppose we could rewrite the file in the sage-clone script, but I don't know if it's worth it.  Opinions?\n\nFor the root repo, my patch works for me.  Can someone else check it? Pending opinions on modifying sage-clone, everything else gets a positive review from me.",
    "created_at": "2011-07-02T20:31:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112578",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:51" align="right">Comment 51</div>

One small issue: as you said, .hg/hgrc is not transferred during clones, so if you "sage -clone ...", the "git" setting is lost for that repo.  If people don't work with clones, or if they use the version of Mercurial distributed with Sage, or if they have "git=1" in their own .hgrc file, this won't affect them.  I suppose we could rewrite the file in the sage-clone script, but I don't know if it's worth it.  Opinions?

For the root repo, my patch works for me.  Can someone else check it? Pending opinions on modifying sage-clone, everything else gets a positive review from me.



---

archive/issue_comments_112579.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2011-07-02T20:31:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112579",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_comments_112580.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nReplying to [@jhpalmieri](#comment%3A51):\n> One small issue: as you said, `.hg/hgrc` is not transferred during clones, so if you \"sage -clone ...\", the \"git\" setting is lost for that repo.  If people don't work with clones, or if they use the version of Mercurial distributed with Sage, or if they have \"git=1\" in their own `.hgrc` file, this won't affect them.  I suppose we could rewrite the file in the `sage-clone` script, but I don't know if it's worth it.  Opinions?\n\nAs this falls into the category of surprising (if not annoying) \"features\", I'd say `sage-clone` should then copy it over.\n\nDisclaimer: Doesn't affect me personally. ;-)",
    "created_at": "2011-07-03T20:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112580",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:52" align="right">Comment 52</div>

Replying to [@jhpalmieri](#comment%3A51):
> One small issue: as you said, `.hg/hgrc` is not transferred during clones, so if you "sage -clone ...", the "git" setting is lost for that repo.  If people don't work with clones, or if they use the version of Mercurial distributed with Sage, or if they have "git=1" in their own `.hgrc` file, this won't affect them.  I suppose we could rewrite the file in the `sage-clone` script, but I don't know if it's worth it.  Opinions?

As this falls into the category of surprising (if not annoying) "features", I'd say `sage-clone` should then copy it over.

Disclaimer: Doesn't affect me personally. ;-)



---

archive/issue_comments_112581.json:
```json
{
    "body": "Attachment: **[trac_11121-scripts-sage-clone.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz)**\n\nscripts repo",
    "created_at": "2011-07-05T21:53:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112581",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_11121-scripts-sage-clone.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz)**

scripts repo



---

archive/issue_comments_112582.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nOkay, here's a patch to sage-clone which appends \"git=true\" to devel/sage/.hg/hgrc.",
    "created_at": "2011-07-05T21:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112582",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:53" align="right">Comment 53</div>

Okay, here's a patch to sage-clone which appends "git=true" to devel/sage/.hg/hgrc.



---

archive/issue_comments_112583.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,14 +1,13 @@\n-Apply trac_11121-hgrc.data-extcode.patch to data/extcode\n+Apply:\n \n-Apply trac_11121-hgrc.devel-sage.patch to devel/sage\n-\n-Apply trac_11121-hgrc.devel-sagenb.patch to devel/sagenb\n-\n-Apply trac_11121-hgrc.local-bin.patch to local/bin\n+- [attachment: trac_11121-hgrc.data-extcode.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz) to data/extcode\n+- [attachment: trac_11121-hgrc.devel-sage.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz) to Sage library\n+- [attachment: trac_11121-hgrc.devel-sagenb.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz) to sagenb\n+- [attachment: trac_11121-hgrc.local-bin.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz) to scripts repo\n+- [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo\n+- [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository\n \n Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well\n-\n-Apply trac_11121-root-repo.patch to the root repository\n \n ---\n \n``````\n",
    "created_at": "2011-07-05T21:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112583",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,14 +1,13 @@
-Apply trac_11121-hgrc.data-extcode.patch to data/extcode
+Apply:
 
-Apply trac_11121-hgrc.devel-sage.patch to devel/sage
-
-Apply trac_11121-hgrc.devel-sagenb.patch to devel/sagenb
-
-Apply trac_11121-hgrc.local-bin.patch to local/bin
+- [attachment: trac_11121-hgrc.data-extcode.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz) to data/extcode
+- [attachment: trac_11121-hgrc.devel-sage.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz) to Sage library
+- [attachment: trac_11121-hgrc.devel-sagenb.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz) to sagenb
+- [attachment: trac_11121-hgrc.local-bin.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz) to scripts repo
+- [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo
+- [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository
 
 Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well
-
-Apply trac_11121-root-repo.patch to the root repository
 
 ---
 
``````




---

archive/issue_comments_112584.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nReplying to [@jhpalmieri](#comment%3A53):\n> Okay, here's a patch to sage-clone which appends \"git=true\" to devel/sage/.hg/hgrc.\n\nDo I read correctly that the things remaining to review are \n* the patch to the root repo\n* the patch to the sage-clone script\nAnd that we only want to have these have `git=True`, and not enable queues or add a username or anything like that?  It doesn't look like it appends to anything - I thought, based on the above, that this file is created at that time.  (Is that, presumably, after `devel/sage` is changed to point to `sage-newbranch`?)\n\nSorry if these questions are dumb, just trying to help get this reviewed.",
    "created_at": "2011-08-18T02:28:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112584",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:54" align="right">Comment 54</div>

Replying to [@jhpalmieri](#comment%3A53):
> Okay, here's a patch to sage-clone which appends "git=true" to devel/sage/.hg/hgrc.

Do I read correctly that the things remaining to review are 
* the patch to the root repo
* the patch to the sage-clone script
And that we only want to have these have `git=True`, and not enable queues or add a username or anything like that?  It doesn't look like it appends to anything - I thought, based on the above, that this file is created at that time.  (Is that, presumably, after `devel/sage` is changed to point to `sage-newbranch`?)

Sorry if these questions are dumb, just trying to help get this reviewed.



---

archive/issue_comments_112585.json:
```json
{
    "body": "Changed author from **Keshav Kini** to **Keshav Kini, John Palmieri**",
    "created_at": "2011-08-18T02:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112585",
    "user": "https://github.com/kcrisman"
}
```

Changed author from **Keshav Kini** to **Keshav Kini, John Palmieri**



---

archive/issue_comments_112586.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nReplying to [@kcrisman](#comment%3A54):\n> Do I read correctly that the things remaining to review are \n> * the patch to the root repo\n\nI'll vouch for that (is that allowed?)\n\n> * the patch to the sage-clone script\n\nLooks good to me too, but again, I am a co-author on this ticket.\n\n> And that we only want to have these have `git=True`, and not enable queues or add a username or anything like that?  It doesn't look like it appends to anything - I thought, based on the above, that this file is created at that time.  (Is that, presumably, after `devel/sage` is changed to point to `sage-newbranch`?)\n\nYes, see [this comment](#comment%3A41). All that extra stuff (besides `git=True`) is put in the file `$SAGE_ROOT/local/etc/mercurial/hgrc` by the installer of `mercurial-1.8.4.spkg` from #10594. Indeed, the file in John's patch to `sage-clone` could just as well open the `.hg/hgrc` file with mode `'w'` rather than `'a'`, I think.",
    "created_at": "2011-08-18T11:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112586",
    "user": "https://github.com/kini"
}
```

<div id="comment:56" align="right">Comment 56</div>

Replying to [@kcrisman](#comment%3A54):
> Do I read correctly that the things remaining to review are 
> * the patch to the root repo

I'll vouch for that (is that allowed?)

> * the patch to the sage-clone script

Looks good to me too, but again, I am a co-author on this ticket.

> And that we only want to have these have `git=True`, and not enable queues or add a username or anything like that?  It doesn't look like it appends to anything - I thought, based on the above, that this file is created at that time.  (Is that, presumably, after `devel/sage` is changed to point to `sage-newbranch`?)

Yes, see [this comment](#comment%3A41). All that extra stuff (besides `git=True`) is put in the file `$SAGE_ROOT/local/etc/mercurial/hgrc` by the installer of `mercurial-1.8.4.spkg` from #10594. Indeed, the file in John's patch to `sage-clone` could just as well open the `.hg/hgrc` file with mode `'w'` rather than `'a'`, I think.



---

archive/issue_comments_112587.json:
```json
{
    "body": "Changed reviewer from **John Palmieri** to **John Palmieri, Keshav Kini**",
    "created_at": "2011-08-18T12:14:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112587",
    "user": "https://github.com/kcrisman"
}
```

Changed reviewer from **John Palmieri** to **John Palmieri, Keshav Kini**



---

archive/issue_comments_112588.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nYeah, it's okay to review a coauthor's changes as long as you don't review your *own* changes.  There are *many* tickets where precisely this happens.  Otherwise we would never get things reviewed. \n\nWell, either way on the write mode, as long as you review it works.",
    "created_at": "2011-08-18T12:14:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112588",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:57" align="right">Comment 57</div>

Yeah, it's okay to review a coauthor's changes as long as you don't review your *own* changes.  There are *many* tickets where precisely this happens.  Otherwise we would never get things reviewed. 

Well, either way on the write mode, as long as you review it works.



---

archive/issue_comments_112589.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nReplying to [@kini](#comment%3A56):\n> Yes, see [this comment](#comment%3A41). All that extra stuff (besides `git=True`) is put in the file `$SAGE_ROOT/local/etc/mercurial/hgrc` by the installer of `mercurial-1.8.4.spkg` from #10594. Indeed, the file in John's patch to `sage-clone` could just as well open the `.hg/hgrc` file with mode `'w'` rather than `'a'`, I think.\n\nWell, when you make a clone, a new .hgrc file is written, saying something like\n\n```\n[paths]\ndefault = .../devel/sage\n```\nI'm not sure of the purpose of this, but I thought we should append to it, not overwrite it.",
    "created_at": "2011-08-18T15:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112589",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:58" align="right">Comment 58</div>

Replying to [@kini](#comment%3A56):
> Yes, see [this comment](#comment%3A41). All that extra stuff (besides `git=True`) is put in the file `$SAGE_ROOT/local/etc/mercurial/hgrc` by the installer of `mercurial-1.8.4.spkg` from #10594. Indeed, the file in John's patch to `sage-clone` could just as well open the `.hg/hgrc` file with mode `'w'` rather than `'a'`, I think.

Well, when you make a clone, a new .hgrc file is written, saying something like

```
[paths]
default = .../devel/sage
```
I'm not sure of the purpose of this, but I thought we should append to it, not overwrite it.



---

archive/issue_comments_112590.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nReplying to [@kcrisman](#comment%3A54):\n> Replying to [@jhpalmieri](#comment%3A53):\n> > Okay, here's a patch to sage-clone which appends \"git=true\" to devel/sage/.hg/hgrc.\n\n> Do I read correctly that the things remaining to review are \n> * the patch to the root repo\n> * the patch to the sage-clone script\n\nThat's right, I gave a positive review to everything else.  Since I wrote those two, anyone else can review them.",
    "created_at": "2011-08-18T15:55:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112590",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:59" align="right">Comment 59</div>

Replying to [@kcrisman](#comment%3A54):
> Replying to [@jhpalmieri](#comment%3A53):
> > Okay, here's a patch to sage-clone which appends "git=true" to devel/sage/.hg/hgrc.

> Do I read correctly that the things remaining to review are 
> * the patch to the root repo
> * the patch to the sage-clone script

That's right, I gave a positive review to everything else.  Since I wrote those two, anyone else can review them.



---

archive/issue_events_134612.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-08-18T16:00:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134612"
}
```



---

archive/issue_events_134613.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-08-18T16:00:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134613"
}
```



---

archive/issue_comments_112591.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nWell, Keshav just did!",
    "created_at": "2011-08-18T16:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112591",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:60" align="right">Comment 60</div>

Well, Keshav just did!



---

archive/issue_comments_112592.json:
```json
{
    "body": "Dependencies: **#10594**",
    "created_at": "2011-08-18T22:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112592",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#10594**



---

archive/issue_comments_112593.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,8 +7,6 @@\n - [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo\n - [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository\n \n-Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well\n-\n ---\n \n As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).\n``````\n",
    "created_at": "2011-08-18T22:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112593",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,8 +7,6 @@
 - [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo
 - [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository
 
-Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg), which fixes #11120 and #10594 as well
-
 ---
 
 As above. See some discussion at [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e).
``````




---

archive/issue_comments_112594.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha2**",
    "created_at": "2011-08-22T17:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112594",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.2.alpha2**



---

archive/issue_events_134614.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T17:34:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134614"
}
```



---

archive/issue_events_134615.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-22T17:34:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11121#event-134615"
}
```



---

archive/issue_comments_112595.json:
```json
{
    "body": "Same as [attachment: trac_11121-hgrc.local-bin.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz) but keeping the file mode 0755",
    "created_at": "2011-08-23T13:43:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112595",
    "user": "https://github.com/jdemeyer"
}
```

Same as [attachment: trac_11121-hgrc.local-bin.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz) but keeping the file mode 0755



---

archive/issue_comments_112596.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n - [attachment: trac_11121-hgrc.data-extcode.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz) to data/extcode\n - [attachment: trac_11121-hgrc.devel-sage.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz) to Sage library\n - [attachment: trac_11121-hgrc.devel-sagenb.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz) to sagenb\n-- [attachment: trac_11121-hgrc.local-bin.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz) to scripts repo\n+- [attachment: trac_11121-hgrc.local-bin-mode0755.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin-mode0755.patch.gz) to scripts repo\n - [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo\n - [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository\n \n``````\n",
    "created_at": "2011-08-23T13:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112596",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 - [attachment: trac_11121-hgrc.data-extcode.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.data-extcode.patch.gz) to data/extcode
 - [attachment: trac_11121-hgrc.devel-sage.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sage.patch.gz) to Sage library
 - [attachment: trac_11121-hgrc.devel-sagenb.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.devel-sagenb.patch.gz) to sagenb
-- [attachment: trac_11121-hgrc.local-bin.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin.patch.gz) to scripts repo
+- [attachment: trac_11121-hgrc.local-bin-mode0755.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin-mode0755.patch.gz) to scripts repo
 - [attachment: trac_11121-scripts-sage-clone.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-scripts-sage-clone.patch.gz) also to scripts repo
 - [attachment: trac_11121-root-repo.patch](https://github.com/sagemath/sage/files/ticket11121/trac_11121-root-repo.patch.gz) to root repository
 
``````




---

archive/issue_comments_112597.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nAttachment: **[trac_11121-hgrc.local-bin-mode0755.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin-mode0755.patch.gz)**",
    "created_at": "2011-08-23T13:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11121",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11121#issuecomment-112597",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">Comment 63</div>

Attachment: **[trac_11121-hgrc.local-bin-mode0755.patch.gz](https://github.com/sagemath/sage/files/ticket11121/trac_11121-hgrc.local-bin-mode0755.patch.gz)**
