# Issue 11432: PARI qfminim bug on 32-bit systems (Sage 4.7 and 4.6.2)

archive/issues_011432.json:
```json
{
    "body": "Assignee: @williamstein\n\nCC:  @jdemeyer\n\nKeywords: pari, qfminim, ZM_lll, large matrix, ArchLinux, PARI/GP\n\nIn Sage 4.7, when calling the function\n\npari('qfminim(%s,2,0)'%(A._pari_()))\n\nwith certain matrix, I get the following:\n\n```\nsage: A=Matrix(ZZ,4,4,[32982266684193100, 1368614777139719, 224591013270052693 , 276460184982223238,1368614777139719,   56791380087354, 9319512049770279, 11471848267545007,224591013270052693 , 9319512049770279 ,1529340971891522140, 1882541434053596358,276460184982223238 ,  11471848267545007, 1882541434053596358, 2317313350044091414])\nsage: pari('qfminim(%s,2,0)'%(A._pari_()))\n  ***   at top-level: qfminim([32982266684\n  ***                 ^--------------------\n  *** qfminim: bug in ZM_lll, please report\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/float/<ipython console> in <module>()\n\n/home/float/sage/local/lib/python2.6/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.PariInstance.__call__ (sage/libs/pari/gen.c:43438)()\n\nRuntimeError: evaluating PARI string\n\n```\n\nThis is [PARI bug 1154](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1154), fixed by #11130, this ticket simply adds a doctest.\n\n**Apply** [attachment:11604_doctest.patch]\n\nIssue created by migration from https://trac.sagemath.org/ticket/11604\n\n",
    "closed_at": "2011-11-07T10:11:55Z",
    "created_at": "2011-07-16T09:49:26Z",
    "labels": [
        "component: number theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "PARI qfminim bug on 32-bit systems (Sage 4.7 and 4.6.2)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11432",
    "user": "https://github.com/mmasdeu"
}
```
Assignee: @williamstein

CC:  @jdemeyer

Keywords: pari, qfminim, ZM_lll, large matrix, ArchLinux, PARI/GP

In Sage 4.7, when calling the function

pari('qfminim(%s,2,0)'%(A._pari_()))

with certain matrix, I get the following:

```
sage: A=Matrix(ZZ,4,4,[32982266684193100, 1368614777139719, 224591013270052693 , 276460184982223238,1368614777139719,   56791380087354, 9319512049770279, 11471848267545007,224591013270052693 , 9319512049770279 ,1529340971891522140, 1882541434053596358,276460184982223238 ,  11471848267545007, 1882541434053596358, 2317313350044091414])
sage: pari('qfminim(%s,2,0)'%(A._pari_()))
  ***   at top-level: qfminim([32982266684
  ***                 ^--------------------
  *** qfminim: bug in ZM_lll, please report
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/float/<ipython console> in <module>()

/home/float/sage/local/lib/python2.6/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.PariInstance.__call__ (sage/libs/pari/gen.c:43438)()

RuntimeError: evaluating PARI string

```

This is [PARI bug 1154](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1154), fixed by #11130, this ticket simply adds a doctest.

**Apply** [attachment:11604_doctest.patch]

Issue created by migration from https://trac.sagemath.org/ticket/11604





---

archive/issue_comments_127291.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2011-07-16T11:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127291",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_127292.json:
```json
{
    "body": "Which version of Sage are you using?\n\nWorks for me in both PARI (version 2.4.3 development svn-12623 as shipped with Sage, i.e. `./sage -gp`) and from within Sage, version 4.7 (cf. [this SAGENB worksheet](http://sagenb.org/home/pub/2918)) as well as version 4.7.1.alpha2. (Haven't yet tried with 4.7.1.rc0 though.)",
    "created_at": "2011-07-16T11:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127292",
    "user": "https://github.com/nexttime"
}
```

Which version of Sage are you using?

Works for me in both PARI (version 2.4.3 development svn-12623 as shipped with Sage, i.e. `./sage -gp`) and from within Sage, version 4.7 (cf. [this SAGENB worksheet](http://sagenb.org/home/pub/2918)) as well as version 4.7.1.alpha2. (Haven't yet tried with 4.7.1.rc0 though.)



---

archive/issue_comments_127293.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-07-16T11:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127293",
    "user": "https://github.com/mmasdeu"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_127294.json:
```json
{
    "body": "I am using Sage Version 4.7, Release Date: 2011-05-23.\n\nI tried the worksheet you attached and it doesn't work for me. I also tried the sage -gp (I didn't know about it before) and it also fails, so I change my opinion on it being a problem with interfaces...\n\nWhen asked about pari version (in sage -gp) I get 2.4.3... I am running Linux kernel 2.6.39, and compiled Sage from source on a 32bit machine, if that is of any use.\n\nIs there any other info that might be relevant?\n\nThank you,\n\nmarc.\n\nReplying to [comment:1 leif]:\n> Which version of Sage are you using?\n> \n> Works for me in both PARI (version 2.4.3 development svn-12623 as shipped with Sage, i.e. `./sage -gp`) and from within Sage, version 4.7 (cf. [this SAGENB worksheet](http://sagenb.org/home/pub/2918)) as well as version 4.7.1.alpha2. (Haven't yet tried with 4.7.1.rc0 though.)",
    "created_at": "2011-07-16T11:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127294",
    "user": "https://github.com/mmasdeu"
}
```

I am using Sage Version 4.7, Release Date: 2011-05-23.

I tried the worksheet you attached and it doesn't work for me. I also tried the sage -gp (I didn't know about it before) and it also fails, so I change my opinion on it being a problem with interfaces...

When asked about pari version (in sage -gp) I get 2.4.3... I am running Linux kernel 2.6.39, and compiled Sage from source on a 32bit machine, if that is of any use.

Is there any other info that might be relevant?

Thank you,

marc.

Replying to [comment:1 leif]:
> Which version of Sage are you using?
> 
> Works for me in both PARI (version 2.4.3 development svn-12623 as shipped with Sage, i.e. `./sage -gp`) and from within Sage, version 4.7 (cf. [this SAGENB worksheet](http://sagenb.org/home/pub/2918)) as well as version 4.7.1.alpha2. (Haven't yet tried with 4.7.1.rc0 though.)



---

archive/issue_comments_127295.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-07-16T12:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127295",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_127296.json:
```json
{
    "body": "Replying to [comment:3 mmasdeu]:\n> I am using Sage Version 4.7, Release Date: 2011-05-23.\n> \n> I am running Linux kernel 2.6.39, and compiled Sage from source on a 32bit machine, if that is of any use.\n> \n> Is there any other info that might be relevant?\n\n\nMaybe the Linux distribution you are using, the processor type (`cat /proc/cpuinfo`) / architecture (`uname -a`) and last but not least the version of GCC (`gcc -v`).\n\nIf you haven't yet run Sage's test suite, you could at least run a subset of it:\n\n```sh\n/home/float/sage$ ./sage -t -long devel/sage/sage/libs/pari/\n...\n/home/float/sage$ ./sage -t -long devel/sage/sage/interfaces/gp.py\n...\n```\n(Both together should *at most* take a few minutes on a slow machine; the second one doesn't make much sense if the error also occurs in plain PARI/GP as you said.)\n\nProbably more important, as this seems to be an upstream bug, you can run *PARI's* test suite, which unfortunately requires rebuilding PARI, and hence will take much more time (up to 30 minutes I think, depending on your machine):\n\n```sh\n/home/float/sage$ env SAGE_CHECK=yes ./sage -f -s pari-2.4.3.alpha.p5 2>&1 | tee pari-test.log\n```\n(This reinstalls the package unless PARI's test suite fails, and logs the output to `pari-test.log`. If you end up with a broken Sage installation because the test suite didn't pass, you can reinstall it by almost the same command, simply omitting the `env SAGE_CHECK=yes` and optionally `-s`, i.e. `./sage -f pari-2.4.3.alpha.p5`.)",
    "created_at": "2011-07-16T12:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127296",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:3 mmasdeu]:
> I am using Sage Version 4.7, Release Date: 2011-05-23.
> 
> I am running Linux kernel 2.6.39, and compiled Sage from source on a 32bit machine, if that is of any use.
> 
> Is there any other info that might be relevant?


Maybe the Linux distribution you are using, the processor type (`cat /proc/cpuinfo`) / architecture (`uname -a`) and last but not least the version of GCC (`gcc -v`).

If you haven't yet run Sage's test suite, you could at least run a subset of it:

```sh
/home/float/sage$ ./sage -t -long devel/sage/sage/libs/pari/
...
/home/float/sage$ ./sage -t -long devel/sage/sage/interfaces/gp.py
...
```
(Both together should *at most* take a few minutes on a slow machine; the second one doesn't make much sense if the error also occurs in plain PARI/GP as you said.)

Probably more important, as this seems to be an upstream bug, you can run *PARI's* test suite, which unfortunately requires rebuilding PARI, and hence will take much more time (up to 30 minutes I think, depending on your machine):

```sh
/home/float/sage$ env SAGE_CHECK=yes ./sage -f -s pari-2.4.3.alpha.p5 2>&1 | tee pari-test.log
```
(This reinstalls the package unless PARI's test suite fails, and logs the output to `pari-test.log`. If you end up with a broken Sage installation because the test suite didn't pass, you can reinstall it by almost the same command, simply omitting the `env SAGE_CHECK=yes` and optionally `-s`, i.e. `./sage -f pari-2.4.3.alpha.p5`.)



---

archive/issue_comments_127297.json:
```json
{
    "body": "P.S.: In case PARI's test suite fails, you can attach (upload) the log file `pari-test.log` to this ticket.",
    "created_at": "2011-07-16T13:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127297",
    "user": "https://github.com/nexttime"
}
```

P.S.: In case PARI's test suite fails, you can attach (upload) the log file `pari-test.log` to this ticket.



---

archive/issue_comments_127298.json:
```json
{
    "body": "I have run all tests you suggested and everything seems ok. I have also tried to run the code in another machine that has Sage installed (that is an Intel Xeon with 8 cores, so quite different to my '06 laptop). That one is running Sage 4.6.2 (2011-02-25). And got the same error.\n\nHere is the data about my laptop (in which it is easiest for me to experiment):\n\nDistribution: Arch Linux updated a few hours ago (but I have seen the bug weeks ago).\n\nCpuinfo:\n\n```\nprocessor\t: 0\nvendor_id\t: GenuineIntel\ncpu family\t: 6\nmodel\t\t: 13\nmodel name\t: Intel(R) Pentium(R) M processor 1.50GHz\nstepping\t: 8\ncpu MHz\t\t: 1496.431\ncache size\t: 2048 KB\nfdiv_bug\t: no\nhlt_bug\t\t: no\nf00f_bug\t: no\ncoma_bug\t: no\nfpu\t\t: yes\nfpu_exception\t: yes\ncpuid level\t: 2\nwp\t\t: yes\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov clflush dts acpi mmx fxsr sse sse2 ss tm pbe up bts est tm2\nbogomips\t: 2994.56\nclflush size\t: 64\ncache_alignment\t: 64\naddress sizes\t: 32 bits physical, 32 bits virtual\npower management:\n```\n\nArchitecture (uname -a): Linux tablarch 2.6.39-ARCH #1 SMP PREEMPT Sat Jul 9 15:31:04 CEST 2011 i686 Intel(R) Pentium(R) M processor 1.50GHz GenuineIntel GNU/Linux\n\nGCC:\n\n```\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/i686-pc-linux-gnu/4.6.1/lto-wrapper\nTarget: i686-pc-linux-gnu\nConfigured with: /build/src/gcc-4.6.1/configure --prefix=/usr --libdir=/usr/lib --libexecdir=/usr/lib --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=https://bugs.archlinux.org/ --enable-languages=c,c++,ada,fortran,go,lto,objc,obj-c++ --enable-shared --enable-threads=posix --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-clocale=gnu --enable-gnu-unique-object --enable-linker-build-id --with-ppl --enable-cloog-backend=isl --enable-lto --enable-gold --enable-ld=default --enable-plugin --with-plugin-ld=ld.gold --disable-multilib --disable-libstdcxx-pch --enable-checking=release\nThread model: posix\ngcc version 4.6.1 (GCC)\n```\n\nThanks again,\n\nmarc.\n\n\nReplying to [comment:4 leif]:\n> Replying to [comment:3 mmasdeu]:\n> > I am using Sage Version 4.7, Release Date: 2011-05-23.\n> > \n> > I am running Linux kernel 2.6.39, and compiled Sage from source on a 32bit machine, if that is of any use.\n> > \n> > Is there any other info that might be relevant?\n\n> \n> Maybe the Linux distribution you are using, the processor type (`cat /proc/cpuinfo`) / architecture (`uname -a`) and last but not least the version of GCC (`gcc -v`).\n> \n> If you haven't yet run Sage's test suite, you could at least run a subset of it:\n> \n> ```\n> #!sh\n> /home/float/sage$ ./sage -t -long devel/sage/sage/libs/pari/\n> ...\n> /home/float/sage$ ./sage -t -long devel/sage/sage/interfaces/gp.py\n> ...\n> ```\n> (Both together should *at most* take a few minutes on a slow machine; the second one doesn't make much sense if the error also occurs in plain PARI/GP as you said.)\n> \n> Probably more important, as this seems to be an upstream bug, you can run *PARI's* test suite, which unfortunately requires rebuilding PARI, and hence will take much more time (up to 30 minutes I think, depending on your machine):\n> \n> ```\n> #!sh\n> /home/float/sage$ env SAGE_CHECK=yes ./sage -f -s pari-2.4.3.alpha.p5 2>&1 | tee pari-test.log\n> ```\n> (This reinstalls the package unless PARI's test suite fails, and logs the output to `pari-test.log`. If you end up with a broken Sage installation because the test suite didn't pass, you can reinstall it by almost the same command, simply omitting the `env SAGE_CHECK=yes` and optionally `-s`, i.e. `./sage -f pari-2.4.3.alpha.p5`.)",
    "created_at": "2011-07-16T13:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127298",
    "user": "https://github.com/mmasdeu"
}
```

I have run all tests you suggested and everything seems ok. I have also tried to run the code in another machine that has Sage installed (that is an Intel Xeon with 8 cores, so quite different to my '06 laptop). That one is running Sage 4.6.2 (2011-02-25). And got the same error.

Here is the data about my laptop (in which it is easiest for me to experiment):

Distribution: Arch Linux updated a few hours ago (but I have seen the bug weeks ago).

Cpuinfo:

```
processor	: 0
vendor_id	: GenuineIntel
cpu family	: 6
model		: 13
model name	: Intel(R) Pentium(R) M processor 1.50GHz
stepping	: 8
cpu MHz		: 1496.431
cache size	: 2048 KB
fdiv_bug	: no
hlt_bug		: no
f00f_bug	: no
coma_bug	: no
fpu		: yes
fpu_exception	: yes
cpuid level	: 2
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov clflush dts acpi mmx fxsr sse sse2 ss tm pbe up bts est tm2
bogomips	: 2994.56
clflush size	: 64
cache_alignment	: 64
address sizes	: 32 bits physical, 32 bits virtual
power management:
```

Architecture (uname -a): Linux tablarch 2.6.39-ARCH #1 SMP PREEMPT Sat Jul 9 15:31:04 CEST 2011 i686 Intel(R) Pentium(R) M processor 1.50GHz GenuineIntel GNU/Linux

GCC:

```
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/i686-pc-linux-gnu/4.6.1/lto-wrapper
Target: i686-pc-linux-gnu
Configured with: /build/src/gcc-4.6.1/configure --prefix=/usr --libdir=/usr/lib --libexecdir=/usr/lib --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=https://bugs.archlinux.org/ --enable-languages=c,c++,ada,fortran,go,lto,objc,obj-c++ --enable-shared --enable-threads=posix --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-clocale=gnu --enable-gnu-unique-object --enable-linker-build-id --with-ppl --enable-cloog-backend=isl --enable-lto --enable-gold --enable-ld=default --enable-plugin --with-plugin-ld=ld.gold --disable-multilib --disable-libstdcxx-pch --enable-checking=release
Thread model: posix
gcc version 4.6.1 (GCC)
```

Thanks again,

marc.


Replying to [comment:4 leif]:
> Replying to [comment:3 mmasdeu]:
> > I am using Sage Version 4.7, Release Date: 2011-05-23.
> > 
> > I am running Linux kernel 2.6.39, and compiled Sage from source on a 32bit machine, if that is of any use.
> > 
> > Is there any other info that might be relevant?

> 
> Maybe the Linux distribution you are using, the processor type (`cat /proc/cpuinfo`) / architecture (`uname -a`) and last but not least the version of GCC (`gcc -v`).
> 
> If you haven't yet run Sage's test suite, you could at least run a subset of it:
> 
> ```
> #!sh
> /home/float/sage$ ./sage -t -long devel/sage/sage/libs/pari/
> ...
> /home/float/sage$ ./sage -t -long devel/sage/sage/interfaces/gp.py
> ...
> ```
> (Both together should *at most* take a few minutes on a slow machine; the second one doesn't make much sense if the error also occurs in plain PARI/GP as you said.)
> 
> Probably more important, as this seems to be an upstream bug, you can run *PARI's* test suite, which unfortunately requires rebuilding PARI, and hence will take much more time (up to 30 minutes I think, depending on your machine):
> 
> ```
> #!sh
> /home/float/sage$ env SAGE_CHECK=yes ./sage -f -s pari-2.4.3.alpha.p5 2>&1 | tee pari-test.log
> ```
> (This reinstalls the package unless PARI's test suite fails, and logs the output to `pari-test.log`. If you end up with a broken Sage installation because the test suite didn't pass, you can reinstall it by almost the same command, simply omitting the `env SAGE_CHECK=yes` and optionally `-s`, i.e. `./sage -f pari-2.4.3.alpha.p5`.)



---

archive/issue_comments_127299.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-07-16T14:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127299",
    "user": "https://github.com/mmasdeu"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_127300.json:
```json
{
    "body": "Hmmm, anything in common with the other machine (e.g. distro, compiler, special build options)?\n\nDid you also try `./sage -gp` there?",
    "created_at": "2011-07-16T14:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127300",
    "user": "https://github.com/nexttime"
}
```

Hmmm, anything in common with the other machine (e.g. distro, compiler, special build options)?

Did you also try `./sage -gp` there?



---

archive/issue_comments_127301.json:
```json
{
    "body": "Replying to [comment:8 leif]:\n> Hmmm, anything in common with the other machine (e.g. distro, compiler, special build options)?\n\n\nDon't think so. The other machine is my math department. What I know about it is that everything is compiled from scratch (so no distro), gcc is 4.2.4. My guess is that Sage has been built with the default options, but I can't confirm at this moment.\n\n> \n> Did you also try `./sage -gp` there?\n\n\nYes, I did.\n\nAlso, I have tried on a third machine with same results. Do you have access to other Sage installs on different types of machines? It might be that it only affects precompiled versions and 32 bit ones?\n\nI am running out of ideas, but since two Sage installs in different math departments (and in different continents, for that matter) give the same error, it shouldn't be hard to find other installations with the same problem...\n\nmarc.",
    "created_at": "2011-07-16T14:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127301",
    "user": "https://github.com/mmasdeu"
}
```

Replying to [comment:8 leif]:
> Hmmm, anything in common with the other machine (e.g. distro, compiler, special build options)?


Don't think so. The other machine is my math department. What I know about it is that everything is compiled from scratch (so no distro), gcc is 4.2.4. My guess is that Sage has been built with the default options, but I can't confirm at this moment.

> 
> Did you also try `./sage -gp` there?


Yes, I did.

Also, I have tried on a third machine with same results. Do you have access to other Sage installs on different types of machines? It might be that it only affects precompiled versions and 32 bit ones?

I am running out of ideas, but since two Sage installs in different math departments (and in different continents, for that matter) give the same error, it shouldn't be hard to find other installations with the same problem...

marc.



---

archive/issue_comments_127302.json:
```json
{
    "body": "Replying to [comment:9 mmasdeu]:\n> Replying to [comment:8 leif]:\n> > Did you also try `./sage -gp` there?\n\n> \n> Yes, I did.\n\n\nHow does the error look like there? (Sage may somewhat obscure PARI's error message when you use PARI from the Sage prompt, `sage:`.)\n\n\n\n\n> Also, I have tried on a third machine with same results. Do you have access to other Sage installs on different types of machines? It might be that it only affects precompiled versions and 32 bit ones?\n\n\nDid you also build your *working* PARI/GP versions from scratch / source?\n\n\n\n\n> I am running out of ideas, but since two Sage installs in different math departments (and in different continents, for that matter) give the same error, it shouldn't be hard to find other installations with the same problem...\n\n\nI'll try to find some where I can reproduce this...\n\nDid you make any changes in `$SAGE_ROOT/local/lib/` (i.e. create symbolic links to system libraries as replacements for Sage's versions, e.g. `libreadline*`)?\n\n`readline` is currently my top candidate, as we already had quite a lot of trouble with it and in fact do use the system's version (without user intervention) instead of building Sage's one on some platforms (including ArchLinux and openSUSE), also depending on the version found.\n\nYou could\n* take a look at your `$SAGE_ROOT/spkg/logs/readline*` to see if just a symbolic link was created (or the system version got *copied*) by Sage,\n* look for symbolic links in `$SAGE_ROOT/local/lib/` that point **outside** the Sage tree, i.e. start with `/lib/...`, `/usr/lib/...` or alike.",
    "created_at": "2011-07-16T18:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127302",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:9 mmasdeu]:
> Replying to [comment:8 leif]:
> > Did you also try `./sage -gp` there?

> 
> Yes, I did.


How does the error look like there? (Sage may somewhat obscure PARI's error message when you use PARI from the Sage prompt, `sage:`.)




> Also, I have tried on a third machine with same results. Do you have access to other Sage installs on different types of machines? It might be that it only affects precompiled versions and 32 bit ones?


Did you also build your *working* PARI/GP versions from scratch / source?




> I am running out of ideas, but since two Sage installs in different math departments (and in different continents, for that matter) give the same error, it shouldn't be hard to find other installations with the same problem...


I'll try to find some where I can reproduce this...

Did you make any changes in `$SAGE_ROOT/local/lib/` (i.e. create symbolic links to system libraries as replacements for Sage's versions, e.g. `libreadline*`)?

`readline` is currently my top candidate, as we already had quite a lot of trouble with it and in fact do use the system's version (without user intervention) instead of building Sage's one on some platforms (including ArchLinux and openSUSE), also depending on the version found.

You could
* take a look at your `$SAGE_ROOT/spkg/logs/readline*` to see if just a symbolic link was created (or the system version got *copied*) by Sage,
* look for symbolic links in `$SAGE_ROOT/local/lib/` that point **outside** the Sage tree, i.e. start with `/lib/...`, `/usr/lib/...` or alike.



---

archive/issue_comments_127303.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-07-16T18:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127303",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_127304.json:
```json
{
    "body": "We so far **couldn't** reproduce the error on\n* ArchLinux (kernel 2.6.39-ARCH) with Sage 4.7 built from source, Core i5 M (x86_64), where the system's version of `libreadline` gets copied,\n* openSUSE 11.4 with Sage 4.7, built on SLES where apparently Sage's `libreadline` was built and is used,\n* (not really surprising) some Ubuntus (x86_64) with Sage 4.7 and 4.7.1.alpha2.\n\nMore to come... ;-)",
    "created_at": "2011-07-16T18:54:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127304",
    "user": "https://github.com/nexttime"
}
```

We so far **couldn't** reproduce the error on
* ArchLinux (kernel 2.6.39-ARCH) with Sage 4.7 built from source, Core i5 M (x86_64), where the system's version of `libreadline` gets copied,
* openSUSE 11.4 with Sage 4.7, built on SLES where apparently Sage's `libreadline` was built and is used,
* (not really surprising) some Ubuntus (x86_64) with Sage 4.7 and 4.7.1.alpha2.

More to come... ;-)



---

archive/issue_comments_127305.json:
```json
{
    "body": "P.S.: What operating system / distribution does the Xeon run?",
    "created_at": "2011-07-16T19:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127305",
    "user": "https://github.com/nexttime"
}
```

P.S.: What operating system / distribution does the Xeon run?



---

archive/issue_comments_127306.json:
```json
{
    "body": "Changing keywords from \"pari, qfminim, ZM_lll, large matrix\" to \"pari, qfminim, ZM_lll, large matrix, ArchLinux, PARI/GP\".",
    "created_at": "2011-07-16T19:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127306",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "pari, qfminim, ZM_lll, large matrix" to "pari, qfminim, ZM_lll, large matrix, ArchLinux, PARI/GP".



---

archive/issue_comments_127307.json:
```json
{
    "body": "Changing component from interfaces to packages.",
    "created_at": "2011-07-16T19:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127307",
    "user": "https://github.com/nexttime"
}
```

Changing component from interfaces to packages.



---

archive/issue_comments_127308.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-07-16T19:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127308",
    "user": "https://github.com/mmasdeu"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_127309.json:
```json
{
    "body": "Replying to [comment:10 leif]:\n\n> How does the error look like there? (Sage may somewhat obscure PARI's error message when you use PARI from the Sage prompt, `sage:`.)\n\n\n? A\n%2 = \n[32982266684193100 1368614777139719 224591013270052693 276460184982223238]\n\n[1368614777139719 56791380087354 9319512049770279 11471848267545007]\n\n[224591013270052693 9319512049770279 1529340971891522140 1882541434053596358]\n\n[276460184982223238 11471848267545007 1882541434053596358 2317313350044091414]\n\n? qfminim(A,2,0)\n  ***   at top-level: qfminim(A,2,0)\n  ***                 ^--------------\n  *** qfminim: bug in ZM_lll, please report\n  ***   Break loop: type 'break' to go back to GP\n\n\n> \n> Did you also build your *working* PARI/GP versions from scratch / source?\n> \n\n\nYes. For the stable version I used the PKGBUILDs from the ArchUserRepo, which grabs the code and build it. For the devel version, I downloaded myself the source from the PARI website and compiled it.\n\n> I'll try to find some where I can reproduce this...\n> \n> Did you make any changes in `$SAGE_ROOT/local/lib/` (i.e. create symbolic links to system libraries as replacements for Sage's versions, e.g. `libreadline*`)?\n\n\nWhen I compiled it in my machine I there was an issue with libppl. I followed some advice from the web and linked it to my system version.\n\n\n> You could\n> * take a look at your `$SAGE_ROOT/spkg/logs/readline*` to see if just a symbolic link was created (or the system version got *copied*) by Sage,\n> * look for symbolic links in `$SAGE_ROOT/local/lib/` that point **outside** the Sage tree, i.e. start with `/lib/...`, `/usr/lib/...` or alike.\n\n\nOK, apart from libppl (which points to the system version), the readline lib seems to be also copied from my system. This library has been updated afterwards (ArchLinus is rolling release, right?). I have just trying copying again the library from my system over there, but I still get the same error.\n\nI noticed in the log file you mentioned this error at the end of the file. Hopefully it's harmless...\n\n```\n...\nMaking Sage/Python scripts relocatable...\n  File \"./sage-make_relative\", line 5\n    print \"Making script relocatable\"\n                                    ^\nSyntaxError: invalid syntax\n```",
    "created_at": "2011-07-16T19:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127309",
    "user": "https://github.com/mmasdeu"
}
```

Replying to [comment:10 leif]:

> How does the error look like there? (Sage may somewhat obscure PARI's error message when you use PARI from the Sage prompt, `sage:`.)


? A
%2 = 
[32982266684193100 1368614777139719 224591013270052693 276460184982223238]

[1368614777139719 56791380087354 9319512049770279 11471848267545007]

[224591013270052693 9319512049770279 1529340971891522140 1882541434053596358]

[276460184982223238 11471848267545007 1882541434053596358 2317313350044091414]

? qfminim(A,2,0)
  ***   at top-level: qfminim(A,2,0)
  ***                 ^--------------
  *** qfminim: bug in ZM_lll, please report
  ***   Break loop: type 'break' to go back to GP


> 
> Did you also build your *working* PARI/GP versions from scratch / source?
> 


Yes. For the stable version I used the PKGBUILDs from the ArchUserRepo, which grabs the code and build it. For the devel version, I downloaded myself the source from the PARI website and compiled it.

> I'll try to find some where I can reproduce this...
> 
> Did you make any changes in `$SAGE_ROOT/local/lib/` (i.e. create symbolic links to system libraries as replacements for Sage's versions, e.g. `libreadline*`)?


When I compiled it in my machine I there was an issue with libppl. I followed some advice from the web and linked it to my system version.


> You could
> * take a look at your `$SAGE_ROOT/spkg/logs/readline*` to see if just a symbolic link was created (or the system version got *copied*) by Sage,
> * look for symbolic links in `$SAGE_ROOT/local/lib/` that point **outside** the Sage tree, i.e. start with `/lib/...`, `/usr/lib/...` or alike.


OK, apart from libppl (which points to the system version), the readline lib seems to be also copied from my system. This library has been updated afterwards (ArchLinus is rolling release, right?). I have just trying copying again the library from my system over there, but I still get the same error.

I noticed in the log file you mentioned this error at the end of the file. Hopefully it's harmless...

```
...
Making Sage/Python scripts relocatable...
  File "./sage-make_relative", line 5
    print "Making script relocatable"
                                    ^
SyntaxError: invalid syntax
```



---

archive/issue_comments_127310.json:
```json
{
    "body": "Replying to [comment:12 leif]:\n> P.S.: What operating system / distribution does the Xeon run?\n\n\nIt's running Linux, but I once asked the sysadmin in my department about the distribution, and he told me that everything is compiled from scratch. So I guess the \"distro\" would be LFS :).\n\nmarc.\n\nPS: thanks for the help and promptness in tracking this down, I really appreciate it!",
    "created_at": "2011-07-16T19:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127310",
    "user": "https://github.com/mmasdeu"
}
```

Replying to [comment:12 leif]:
> P.S.: What operating system / distribution does the Xeon run?


It's running Linux, but I once asked the sysadmin in my department about the distribution, and he told me that everything is compiled from scratch. So I guess the "distro" would be LFS :).

marc.

PS: thanks for the help and promptness in tracking this down, I really appreciate it!



---

archive/issue_comments_127311.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-16T20:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127311",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_127312.json:
```json
{
    "body": "**Success! ** ;-)\n\nI could reproduce the error on Ubuntu 9.04 x86 (Pentium4 Prescott) with Sage 4.7, both from the Sage prompt and in GP (`sage -gp`), which raises the question if the Sage version running on the Xeon was perhaps also built as a 32-bit application.\n\nGuess it'll take some time to track this down though.",
    "created_at": "2011-07-16T20:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127312",
    "user": "https://github.com/nexttime"
}
```

**Success! ** ;-)

I could reproduce the error on Ubuntu 9.04 x86 (Pentium4 Prescott) with Sage 4.7, both from the Sage prompt and in GP (`sage -gp`), which raises the question if the Sage version running on the Xeon was perhaps also built as a 32-bit application.

Guess it'll take some time to track this down though.



---

archive/issue_comments_127313.json:
```json
{
    "body": "Replying to [comment:15 leif]:\n> **Success! ** ;-)\n> \n> I could reproduce the error on Ubuntu 9.04 x86 (Pentium4 Prescott) with Sage 4.7, both from the Sage prompt and in GP (`sage -gp`), which raises the question if the Sage version running on the Xeon was perhaps also built as a 32-bit application.\n\n\nYes, I checked and even in the Xeon machine Sage was built for i686! Thanks, and hope that this gets resolved soon...",
    "created_at": "2011-07-16T20:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127313",
    "user": "https://github.com/mmasdeu"
}
```

Replying to [comment:15 leif]:
> **Success! ** ;-)
> 
> I could reproduce the error on Ubuntu 9.04 x86 (Pentium4 Prescott) with Sage 4.7, both from the Sage prompt and in GP (`sage -gp`), which raises the question if the Sage version running on the Xeon was perhaps also built as a 32-bit application.


Yes, I checked and even in the Xeon machine Sage was built for i686! Thanks, and hope that this gets resolved soon...



---

archive/issue_comments_127314.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-17T04:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127314",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_030434.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-07-17T04:50:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30434"
}
```



---

archive/issue_comments_127315.json:
```json
{
    "body": "I've made an spkg that fixes the (btw. upstream) bug.\n\nPlease test & report back / review!",
    "created_at": "2011-07-17T04:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127315",
    "user": "https://github.com/nexttime"
}
```

I've made an spkg that fixes the (btw. upstream) bug.

Please test & report back / review!



---

archive/issue_comments_127316.json:
```json
{
    "body": "Diff between the p7 (#11605) and the p8. For reference / review.",
    "created_at": "2011-07-17T05:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127316",
    "user": "https://github.com/nexttime"
}
```

Diff between the p7 (#11605) and the p8. For reference / review.



---

archive/issue_comments_127317.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-07-17T07:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127317",
    "user": "https://github.com/mmasdeu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_127318.json:
```json
{
    "body": "Attachment [pari-2.4.3.alpha.p7-p8.diff](tarball://root/attachments/some-uuid/ticket11604/pari-2.4.3.alpha.p7-p8.diff) by @mmasdeu created at 2011-07-17 07:59:53\n\nWorked for me. I will do more tests that used to fail and see if it is solid...\n\nThanks!",
    "created_at": "2011-07-17T07:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127318",
    "user": "https://github.com/mmasdeu"
}
```

Attachment [pari-2.4.3.alpha.p7-p8.diff](tarball://root/attachments/some-uuid/ticket11604/pari-2.4.3.alpha.p7-p8.diff) by @mmasdeu created at 2011-07-17 07:59:53

Worked for me. I will do more tests that used to fail and see if it is solid...

Thanks!



---

archive/issue_comments_127319.json:
```json
{
    "body": "So far the bug seems fixed by the above spkg (I didn't apply the patch you attached).",
    "created_at": "2011-07-17T10:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127319",
    "user": "https://github.com/mmasdeu"
}
```

So far the bug seems fixed by the above spkg (I didn't apply the patch you attached).



---

archive/issue_comments_127320.json:
```json
{
    "body": "Replying to [comment:19 mmasdeu]:\n> So far the bug seems fixed by the above spkg (I didn't apply the patch you attached).\n\n\nAll changes are to the spkg; the diff is just for documentation purposes.\n\nYou can add yourself to http://trac.sagemath.org/sage_trac/wiki#AccountNamesmappedtoRealNames, and put your (real / full) name into the *Reviewer(s)* field of the ticket.",
    "created_at": "2011-07-17T15:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127320",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:19 mmasdeu]:
> So far the bug seems fixed by the above spkg (I didn't apply the patch you attached).


All changes are to the spkg; the diff is just for documentation purposes.

You can add yourself to http://trac.sagemath.org/sage_trac/wiki#AccountNamesmappedtoRealNames, and put your (real / full) name into the *Reviewer(s)* field of the ticket.



---

archive/issue_comments_127321.json:
```json
{
    "body": "There are too many PARI spkgs floating around, I suggest this patch simply gets added to #11130.",
    "created_at": "2011-07-17T15:30:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127321",
    "user": "https://github.com/jdemeyer"
}
```

There are too many PARI spkgs floating around, I suggest this patch simply gets added to #11130.



---

archive/issue_events_030435.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-17T15:30:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30435"
}
```



---

archive/issue_events_030436.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-17T15:30:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30436"
}
```



---

archive/issue_comments_127322.json:
```json
{
    "body": "Replying to [comment:21 jdemeyer]:\n> There are too many PARI spkgs floating around, I suggest this patch simply gets added to #11130.\n\n\n#11130 seems far from ready to get merged, and it will be based on svn revision 13228, such that this PARI bug fix (from svn 12825) will be included anyway.\n\nUntil we have a working PARI 2.5.0.whatever, I think we should still add a few fixes to our more stable 2.4.3 series, to get merged in reasonable time.\n\n---\n\nP.S.: I've tested the p8 here on Ubuntu 9.04 x86 (Pentium4 Prescott) and Ubuntu 10.04 x86_64 (Core2), Sage 4.7 and 4.7.1.alpha2 respectively, running PARI's test suite as well as a full `ptestlong` on both.\n\nAs far as I can see, there've also been no follow-up reports regarding this change (of January 14th) on the PARI site.",
    "created_at": "2011-07-17T16:16:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127322",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:21 jdemeyer]:
> There are too many PARI spkgs floating around, I suggest this patch simply gets added to #11130.


#11130 seems far from ready to get merged, and it will be based on svn revision 13228, such that this PARI bug fix (from svn 12825) will be included anyway.

Until we have a working PARI 2.5.0.whatever, I think we should still add a few fixes to our more stable 2.4.3 series, to get merged in reasonable time.

---

P.S.: I've tested the p8 here on Ubuntu 9.04 x86 (Pentium4 Prescott) and Ubuntu 10.04 x86_64 (Core2), Sage 4.7 and 4.7.1.alpha2 respectively, running PARI's test suite as well as a full `ptestlong` on both.

As far as I can see, there've also been no follow-up reports regarding this change (of January 14th) on the PARI site.



---

archive/issue_comments_127323.json:
```json
{
    "body": "For the record, a bit more readable, this is the patch for PARI bug 1154:\n\n```patch\n--- src/basemath/lll.c\t2011-07-17 02:01:36.000000000 +0200\n+++ src/basemath/lll.c\t2011-07-17 01:35:55.000000000 +0200\n@@ -1,4 +1,4 @@\n-/* $Id: lll.c 12380 2010-06-03 12:32:58Z bill $\n+/* $Id: lll.c 12825 2011-01-14 23:09:00Z bill $\n \n Copyright (C) 2008  The PARI group.\n \n@@ -533,36 +533,25 @@\n   return U? U: B;\n }\n \n-static long\n-good_prec(long d, double delta, double eta)\n-{\n-  double t = eta+1, rho = t*t / (delta - eta*eta);\n-  long goodprec = (ulong) (7.0 + 0.2*d + d*log2(rho)\n-      +  2.0 * log ((double) d) - log2( (eta-0.5)*(1.0-delta) ));\n-  return nbits2prec(goodprec);\n-}\n-\n /* Assume x a ZM, if ptB != NULL, set it to Gram-Schmidt (squared) norms */\n GEN\n ZM_lll_norms(GEN x, double DELTA, long flag, GEN *B)\n {\n   pari_sp ltop = avma;\n   const double ETA = 0.51;\n-  long p,prec, d, n = lg(x)-1;\n+  long p, d, n = lg(x)-1;\n   GEN U;\n   if (n <= 1) return lll_trivial(x, flag);\n   d = lg(gel(x,1))-1;\n-  prec = good_prec(d,DELTA,ETA);\n   x = RgM_shallowcopy(x);\n   U = (flag & LLL_INPLACE)? NULL: matid(n);\n-  for (p = minss(3,prec); p <= prec; p++)\n+  for (p = 3; ; p++)\n   {\n     GEN m = fplll(&x, &U, B, DELTA, ETA, flag, p);\n     if (m) return m;\n     gerepileall(ltop, U? 2: 1, &x, &U);\n   }\n-  pari_err(bugparier,\"ZM_lll\");\n-  return NULL;\n+  return NULL; /* NOT REACHED */\n }\n \n /********************************************************************/\n```",
    "created_at": "2011-07-17T16:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127323",
    "user": "https://github.com/nexttime"
}
```

For the record, a bit more readable, this is the patch for PARI bug 1154:

```patch
--- src/basemath/lll.c	2011-07-17 02:01:36.000000000 +0200
+++ src/basemath/lll.c	2011-07-17 01:35:55.000000000 +0200
@@ -1,4 +1,4 @@
-/* $Id: lll.c 12380 2010-06-03 12:32:58Z bill $
+/* $Id: lll.c 12825 2011-01-14 23:09:00Z bill $
 
 Copyright (C) 2008  The PARI group.
 
@@ -533,36 +533,25 @@
   return U? U: B;
 }
 
-static long
-good_prec(long d, double delta, double eta)
-{
-  double t = eta+1, rho = t*t / (delta - eta*eta);
-  long goodprec = (ulong) (7.0 + 0.2*d + d*log2(rho)
-      +  2.0 * log ((double) d) - log2( (eta-0.5)*(1.0-delta) ));
-  return nbits2prec(goodprec);
-}
-
 /* Assume x a ZM, if ptB != NULL, set it to Gram-Schmidt (squared) norms */
 GEN
 ZM_lll_norms(GEN x, double DELTA, long flag, GEN *B)
 {
   pari_sp ltop = avma;
   const double ETA = 0.51;
-  long p,prec, d, n = lg(x)-1;
+  long p, d, n = lg(x)-1;
   GEN U;
   if (n <= 1) return lll_trivial(x, flag);
   d = lg(gel(x,1))-1;
-  prec = good_prec(d,DELTA,ETA);
   x = RgM_shallowcopy(x);
   U = (flag & LLL_INPLACE)? NULL: matid(n);
-  for (p = minss(3,prec); p <= prec; p++)
+  for (p = 3; ; p++)
   {
     GEN m = fplll(&x, &U, B, DELTA, ETA, flag, p);
     if (m) return m;
     gerepileall(ltop, U? 2: 1, &x, &U);
   }
-  pari_err(bugparier,"ZM_lll");
-  return NULL;
+  return NULL; /* NOT REACHED */
 }
 
 /********************************************************************/
```



---

archive/issue_comments_127324.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-07-19T10:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127324",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_events_030437.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-19T10:06:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30437"
}
```



---

archive/issue_events_030438.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-19T10:06:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30438"
}
```



---

archive/issue_comments_127325.json:
```json
{
    "body": "Attachment [11604_doctest.patch](tarball://root/attachments/some-uuid/ticket11604/11604_doctest.patch) by @jdemeyer created at 2011-07-19 10:07:34\n\nDoctest for the bug",
    "created_at": "2011-07-19T10:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127325",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [11604_doctest.patch](tarball://root/attachments/some-uuid/ticket11604/11604_doctest.patch) by @jdemeyer created at 2011-07-19 10:07:34

Doctest for the bug



---

archive/issue_comments_127326.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-19T10:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127326",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_127327.json:
```json
{
    "body": "For the impatient: A new spkg fixing this for Sage versions 4.6.x, 4.7 and 4.7.1 is still available at http://spkg-upload.googlecode.com/files/pari-2.4.3.alpha.p8.spkg .",
    "created_at": "2011-07-19T15:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127327",
    "user": "https://github.com/nexttime"
}
```

For the impatient: A new spkg fixing this for Sage versions 4.6.x, 4.7 and 4.7.1 is still available at http://spkg-upload.googlecode.com/files/pari-2.4.3.alpha.p8.spkg .



---

archive/issue_comments_127328.json:
```json
{
    "body": "The attached doctest obviously catches the error reported here.",
    "created_at": "2011-07-19T15:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127328",
    "user": "https://github.com/nexttime"
}
```

The attached doctest obviously catches the error reported here.



---

archive/issue_comments_127329.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-07-19T15:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127329",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_030439.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-22T12:53:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30439"
}
```



---

archive/issue_events_030440.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-22T12:53:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30440"
}
```



---

archive/issue_comments_127330.json:
```json
{
    "body": "Changing component from packages to number theory.",
    "created_at": "2011-09-28T07:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127330",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from packages to number theory.



---

archive/issue_events_030441.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-06T08:23:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30441"
}
```



---

archive/issue_events_030442.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-22T16:49:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30442"
}
```



---

archive/issue_events_030443.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T09:10:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30443"
}
```



---

archive/issue_comments_127331.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127331",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_comments_127332.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-07T10:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11432#issuecomment-127332",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_030444.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30444"
}
```



---

archive/issue_events_030445.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11432",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11432#event-30445"
}
```
