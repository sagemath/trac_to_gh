# Issue 11694: zshell prompt

archive/issues_011694.json:
```json
{
    "body": "This sucks:\n\n```\nmalb@road:~ $ env | grep \"SHELL=\"                                                                                                                                \nSHELL=/bin/zsh\nmalb@road:~ $ sage -sh\n...\n\nBypassing shell configuration files ...\n\nSAGE_ROOT=/home/malb/Sage/current\\n(sage subshell) \\h:\\W \\u$ \n```\n\ni.e., the prompt is all wrong, compared to:\n\n```\nmalb@road:/opt/sage-4.7.2.alpha3-prerelease/local/bin $ /opt/sage-4.7.2.alpha3-prerelease/sage -sh\n\nStarting subshell with Sage environment variables set.\nBe sure to exit when you are done and do not do anything\nwith other copies of Sage!\n\nBypassing shell configuration files ...\n\nSAGE_ROOT=/opt/sage-4.7.2.alpha3-prerelease\n(sage subshell) road:/opt/sage-4.7.2.alpha3-prerelease/local/bin malb$ \n```\n\nThe attached patch fixes this.\n\n**Apply** [attachment:trac11866_proper_zsh_prompt.patch] to the scripts repository, not the normal Sage repository.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11866\n\n",
    "closed_at": "2011-10-05T07:47:20Z",
    "created_at": "2011-09-28T19:54:22Z",
    "labels": [
        "component: scripts",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "zshell prompt",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11694",
    "user": "https://github.com/malb"
}
```
This sucks:

```
malb@road:~ $ env | grep "SHELL="                                                                                                                                
SHELL=/bin/zsh
malb@road:~ $ sage -sh
...

Bypassing shell configuration files ...

SAGE_ROOT=/home/malb/Sage/current\n(sage subshell) \h:\W \u$ 
```

i.e., the prompt is all wrong, compared to:

```
malb@road:/opt/sage-4.7.2.alpha3-prerelease/local/bin $ /opt/sage-4.7.2.alpha3-prerelease/sage -sh

Starting subshell with Sage environment variables set.
Be sure to exit when you are done and do not do anything
with other copies of Sage!

Bypassing shell configuration files ...

SAGE_ROOT=/opt/sage-4.7.2.alpha3-prerelease
(sage subshell) road:/opt/sage-4.7.2.alpha3-prerelease/local/bin malb$ 
```

The attached patch fixes this.

**Apply** [attachment:trac11866_proper_zsh_prompt.patch] to the scripts repository, not the normal Sage repository.

Issue created by migration from https://trac.sagemath.org/ticket/11866





---

archive/issue_comments_131993.json:
```json
{
    "body": "Attachment [trac11866_proper_zsh_prompt.patch](tarball://root/attachments/some-uuid/ticket11866/trac11866_proper_zsh_prompt.patch) by @malb created at 2011-09-28 19:55:48",
    "created_at": "2011-09-28T19:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131993",
    "user": "https://github.com/malb"
}
```

Attachment [trac11866_proper_zsh_prompt.patch](tarball://root/attachments/some-uuid/ticket11866/trac11866_proper_zsh_prompt.patch) by @malb created at 2011-09-28 19:55:48



---

archive/issue_comments_131994.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-09-28T19:57:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131994",
    "user": "https://github.com/malb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_131995.json:
```json
{
    "body": "This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one.  But if you use zsh, I would be happy to hear your input on #10822.\n\nI think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.\n\n(Note that the \"scripts\" repository and the \"root\" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)",
    "created_at": "2011-09-28T20:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131995",
    "user": "https://github.com/jhpalmieri"
}
```

This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one.  But if you use zsh, I would be happy to hear your input on #10822.

I think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.

(Note that the "scripts" repository and the "root" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)



---

archive/issue_comments_131996.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-09-28T20:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131996",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131997.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2011-09-28T20:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131997",
    "user": "https://github.com/jhpalmieri"
}
```

Changing priority from major to minor.



---

archive/issue_comments_131998.json:
```json
{
    "body": "Replying to [comment:2 jhpalmieri]:\n> This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one. \n\n\nOh, thanks!\n\n> But if you use zsh, I would be happy to hear your input on #10822.\n\n\nI'll take a look.\n\n> I think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.\n\n\nThanks!\n\n> (Note that the \"scripts\" repository and the \"root\" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)\n\n\n\nWhoops, I thought they would have been merged a while ago.",
    "created_at": "2011-09-28T21:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131998",
    "user": "https://github.com/malb"
}
```

Replying to [comment:2 jhpalmieri]:
> This looks good and it works in my (brief) testing.  See #10822 and #11790 for patches which already include this particular fix. It's probably easiest to get this one merged, and then rebase the others with respect to this one. 


Oh, thanks!

> But if you use zsh, I would be happy to hear your input on #10822.


I'll take a look.

> I think that since it seems to work, and since we came up with the same change completely independently, this can be given a positive review.


Thanks!

> (Note that the "scripts" repository and the "root" repository are different.  This should be applied to the scripts repository.  I've changed the ticket description to clarify this.)



Whoops, I thought they would have been merged a while ago.



---

archive/issue_events_031349.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-05T07:47:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11694#event-31349"
}
```



---

archive/issue_comments_131999.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-10-05T07:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11694#issuecomment-131999",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
