# Issue 11736: Linear time implementation of lex_BFS()

archive/issues_011564.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/nathanncohen",
        "https://github.com/rlmill"
    ],
    "body": "The current implementation of lex_BFS() is quadratic, which is not optimal. The usual way to do it in linear time is through a clever use of doubly linked lists, but in (1) there is a way with static arrays, which I coded in Python.\n\nThere is one thing, though: in (2) there is a new algorithm for is_interval() that avoids PQ-trees, and just uses various passes of lex_BFS() (implemented with doubly linked lists).\nSo maybe in the long run it would be better to do it with doubly linked lists in Cython.\n\n(1) Habib, McConnell, Paul and Viennot. Lex-BFS and Partition Refinement, with Applications to Transitive Orientation, Interval Graph Recognition and Consecutive Ones Testing. TCS 234, 2000.\n\n(2) Corneil, Olariu and Stewart. The LBFS Structure and Recognition of Interval Graphs. SIAMDM 23(4), 2009.\n\nCC:  @dcoudert @kliem @orlitzky\n\nKeywords: **lexbfs**\n\nBranch/Commit: **[`332fb8b`](https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26)**\n\nReviewer: **Michael Orlitzky**\n\nAuthor: **Diego de Estrada, David Coudert**\n\nComponent: **graph theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11736_\n\n",
    "closed_at": "2020-09-15T22:00:55Z",
    "created_at": "2011-08-24T14:17:20Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Linear time implementation of lex_BFS()",
    "type": "issue",
    "updated_at": "2020-09-15T22:00:55Z",
    "url": "https://github.com/sagemath/sage/issues/11736",
    "user": "https://github.com/diegode"
}
```
The current implementation of lex_BFS() is quadratic, which is not optimal. The usual way to do it in linear time is through a clever use of doubly linked lists, but in (1) there is a way with static arrays, which I coded in Python.

There is one thing, though: in (2) there is a new algorithm for is_interval() that avoids PQ-trees, and just uses various passes of lex_BFS() (implemented with doubly linked lists).
So maybe in the long run it would be better to do it with doubly linked lists in Cython.

(1) Habib, McConnell, Paul and Viennot. Lex-BFS and Partition Refinement, with Applications to Transitive Orientation, Interval Graph Recognition and Consecutive Ones Testing. TCS 234, 2000.

(2) Corneil, Olariu and Stewart. The LBFS Structure and Recognition of Interval Graphs. SIAMDM 23(4), 2009.

CC:  @dcoudert @kliem @orlitzky

Keywords: **lexbfs**

Branch/Commit: **[`332fb8b`](https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26)**

Reviewer: **Michael Orlitzky**

Author: **Diego de Estrada, David Coudert**

Component: **graph theory**

_Issue created by migration from https://trac.sagemath.org/ticket/11736_





---

archive/issue_events_156057.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-08-24T14:17:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156057"
}
```



---

archive/issue_events_156058.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-08-24T14:17:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156058"
}
```



---

archive/issue_events_156059.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-08-24T14:17:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156059"
}
```



---

archive/issue_events_156060.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-08-24T14:17:20Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156060"
}
```



---

archive/issue_events_156061.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-08-24T14:17:20Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156061"
}
```



---

archive/issue_events_156062.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-08-24T14:17:20Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156062"
}
```



---

archive/issue_events_156063.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-08-24T14:19:15Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156063"
}
```



---

archive/issue_events_156064.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-08-24T14:19:15Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156064"
}
```



---

archive/issue_events_156065.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-08-24T14:19:15Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156065"
}
```



---

archive/issue_events_156066.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-08-24T14:19:15Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156066"
}
```



---

archive/issue_events_156067.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-08-24T14:19:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156067"
}
```



---

archive/issue_events_156068.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-08-24T14:20:44Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156068"
}
```



---

archive/issue_events_156069.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-08-24T14:20:44Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156069"
}
```



---

archive/issue_events_156070.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-08-24T14:20:44Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156070"
}
```



---

archive/issue_events_156071.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-08-24T14:20:44Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "subject": "https://github.com/diegode",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156071"
}
```



---

archive/issue_comments_121909.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,8 @@\n-The current implementation of lex_BFS() is quadratic, which is not optimal. The usual way to do it in linear time is through a clever use of doubly linked lists, but in [1] there is a way with static arrays, which I coded in Python.\n+The current implementation of lex_BFS() is quadratic, which is not optimal. The usual way to do it in linear time is through a clever use of doubly linked lists, but in (1) there is a way with static arrays, which I coded in Python.\n \n-There is one thing, though: in [2] there is a new algorithm for is_interval() that avoids PQ-trees, and just uses various passes of lex_BFS() (implemented with doubly linked lists).\n+There is one thing, though: in (2) there is a new algorithm for is_interval() that avoids PQ-trees, and just uses various passes of lex_BFS() (implemented with doubly linked lists).\n So maybe in the long run it would be better to do it with doubly linked lists in Cython.\n \n-[1] Habib, McConnell, Paul and Viennot. Lex-BFS and Partition Refinement, with Applications to Transitive Orientation, Interval Graph Recognition and Consecutive Ones Testing. TCS 234, 2000.\n-[2] Corneil, Olariu and Stewart. The LBFS Structure and Recognition of Interval Graphs. SIAMDM 23(4), 2009.\n+(1) Habib, McConnell, Paul and Viennot. Lex-BFS and Partition Refinement, with Applications to Transitive Orientation, Interval Graph Recognition and Consecutive Ones Testing. TCS 234, 2000.\n+\n+(2) Corneil, Olariu and Stewart. The LBFS Structure and Recognition of Interval Graphs. SIAMDM 23(4), 2009.\n``````\n",
    "created_at": "2011-08-24T14:21:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121909",
    "user": "https://github.com/diegode"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,8 @@
-The current implementation of lex_BFS() is quadratic, which is not optimal. The usual way to do it in linear time is through a clever use of doubly linked lists, but in [1] there is a way with static arrays, which I coded in Python.
+The current implementation of lex_BFS() is quadratic, which is not optimal. The usual way to do it in linear time is through a clever use of doubly linked lists, but in (1) there is a way with static arrays, which I coded in Python.
 
-There is one thing, though: in [2] there is a new algorithm for is_interval() that avoids PQ-trees, and just uses various passes of lex_BFS() (implemented with doubly linked lists).
+There is one thing, though: in (2) there is a new algorithm for is_interval() that avoids PQ-trees, and just uses various passes of lex_BFS() (implemented with doubly linked lists).
 So maybe in the long run it would be better to do it with doubly linked lists in Cython.
 
-[1] Habib, McConnell, Paul and Viennot. Lex-BFS and Partition Refinement, with Applications to Transitive Orientation, Interval Graph Recognition and Consecutive Ones Testing. TCS 234, 2000.
-[2] Corneil, Olariu and Stewart. The LBFS Structure and Recognition of Interval Graphs. SIAMDM 23(4), 2009.
+(1) Habib, McConnell, Paul and Viennot. Lex-BFS and Partition Refinement, with Applications to Transitive Orientation, Interval Graph Recognition and Consecutive Ones Testing. TCS 234, 2000.
+
+(2) Corneil, Olariu and Stewart. The LBFS Structure and Recognition of Interval Graphs. SIAMDM 23(4), 2009.
``````




---

archive/issue_events_156072.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-02T09:06:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156072"
}
```



---

archive/issue_comments_121910.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHello Diego !!!\n\nSame comment (see #11738) for this patch about the \"build/\" folder. I also expect that this patch breaks doctests in Sage's library, so please check it too, correcting the doctests themselves if it makes sense `:-)`\n\nNathann",
    "created_at": "2011-09-02T09:06:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121910",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">comment:4</div>

Hello Diego !!!

Same comment (see #11738) for this patch about the "build/" folder. I also expect that this patch breaks doctests in Sage's library, so please check it too, correcting the doctests themselves if it makes sense `:-)`

Nathann



---

archive/issue_events_156073.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-02T09:06:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156073"
}
```



---

archive/issue_events_156074.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-02T09:06:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156074"
}
```



---

archive/issue_comments_121911.json:
```json
{
    "body": "Attachment: **[linear_lex_bfs.patch.gz](https://github.com/sagemath/sage/files/ticket11736/linear_lex_bfs.patch.gz)**",
    "created_at": "2011-09-06T07:11:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121911",
    "user": "https://github.com/diegode"
}
```

Attachment: **[linear_lex_bfs.patch.gz](https://github.com/sagemath/sage/files/ticket11736/linear_lex_bfs.patch.gz)**



---

archive/issue_comments_121912.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@nathanncohen](#comment:4):\nThank you! Here I fixed the \"build/\" thing, but I'm having trouble running the tests (in OSX 10.7 and Ubuntu 11.04), so expect it to break some of them. I'm sorry.",
    "created_at": "2011-09-06T07:25:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121912",
    "user": "https://github.com/diegode"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@nathanncohen](#comment:4):
Thank you! Here I fixed the "build/" thing, but I'm having trouble running the tests (in OSX 10.7 and Ubuntu 11.04), so expect it to break some of them. I'm sorry.



---

archive/issue_events_156075.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-09-06T07:25:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156075"
}
```



---

archive/issue_events_156076.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-09-06T07:25:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156076"
}
```



---

archive/issue_comments_121913.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n> Thank you! Here I fixed the \"build/\" thing, but I'm having trouble running the tests (in OSX 10.7 and Ubuntu 11.04), so expect it to break some of them. I'm sorry.\n\nPerhaps I can help you with this test problem ? The thing is that right now the patch does not seem to work :\n\n```\nsage: graphs.RandomInterval(30).is_interval()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/home/ncohen/sage/devel/sage-3/sage/graphs/<ipython console> in <module>()\n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_interval(self, certificate)\n   9606         # by the way :-)\n   9607 \n-> 9608         if not self.is_chordal():\n   9609             return False\n   9610 \n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_chordal(self, certificate)\n   9492         for v in peo:\n   9493 \n-> 9494             if t_peo.out_degree(v)>0:\n   9495 \n   9496                 x = t_peo.neighbor_out_iterator(v).next()\n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree(self, vertices, labels)\n   1176             return di\n   1177         else:\n-> 1178             return list(self.out_degree_iterator(vertices, labels=labels))\n   1179 \n   1180     def out_degree_iterator(self, vertices=None, labels=False):\n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree_iterator(self, vertices, labels)\n   1221                 yield (v, d)\n   1222         else:\n-> 1223             for v in vertices:\n   1224                 d = 0\n   1225                 for e in self.outgoing_edge_iterator(v):\n\nTypeError: 'int' object is not iterable\nsage: graphs.RandomInterval(30).is_interval()\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n\n/home/ncohen/sage/devel/sage-3/sage/graphs/<ipython console> in <module>()\n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_interval(self, certificate)\n   9606         # by the way :-)\n   9607 \n-> 9608         if not self.is_chordal():\n   9609             return False\n   9610 \n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_chordal(self, certificate)\n   9484                 return all( gg.is_chordal() for gg in self.connected_components_subgraphs() )\n   9485 \n-> 9486         peo,t_peo = self.lex_BFS(tree=True)\n   9487 \n   9488         g = self.copy()\n\n/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in lex_BFS(self, reverse, tree, initial_vertex)\n  11617                 if subslice[a] < old_k:\n  11618                     subslice[a] = k\n> 11619                     slice_head[k] = l\n  11620                     k += 1\n  11621                 slice_of[l] = subslice[a]\n\nIndexError: list assignment index out of range\n```\n\nOn random interval graphs sometimes the is_interval function works, sometimes it does not... `^^;` \n\nI tested you patch after having applied #11738 and #11735 but I do not think this is where the bug comes from. Could you also add some comments to your code, along with a reference to the paper you are following for this implementation ? `:-)`\n\nNathann",
    "created_at": "2011-09-11T13:57:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121913",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:7" align="right">comment:7</div>

> Thank you! Here I fixed the "build/" thing, but I'm having trouble running the tests (in OSX 10.7 and Ubuntu 11.04), so expect it to break some of them. I'm sorry.

Perhaps I can help you with this test problem ? The thing is that right now the patch does not seem to work :

```
sage: graphs.RandomInterval(30).is_interval()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/ncohen/sage/devel/sage-3/sage/graphs/<ipython console> in <module>()

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_interval(self, certificate)
   9606         # by the way :-)
   9607 
-> 9608         if not self.is_chordal():
   9609             return False
   9610 

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_chordal(self, certificate)
   9492         for v in peo:
   9493 
-> 9494             if t_peo.out_degree(v)>0:
   9495 
   9496                 x = t_peo.neighbor_out_iterator(v).next()

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree(self, vertices, labels)
   1176             return di
   1177         else:
-> 1178             return list(self.out_degree_iterator(vertices, labels=labels))
   1179 
   1180     def out_degree_iterator(self, vertices=None, labels=False):

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree_iterator(self, vertices, labels)
   1221                 yield (v, d)
   1222         else:
-> 1223             for v in vertices:
   1224                 d = 0
   1225                 for e in self.outgoing_edge_iterator(v):

TypeError: 'int' object is not iterable
sage: graphs.RandomInterval(30).is_interval()
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)

/home/ncohen/sage/devel/sage-3/sage/graphs/<ipython console> in <module>()

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_interval(self, certificate)
   9606         # by the way :-)
   9607 
-> 9608         if not self.is_chordal():
   9609             return False
   9610 

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_chordal(self, certificate)
   9484                 return all( gg.is_chordal() for gg in self.connected_components_subgraphs() )
   9485 
-> 9486         peo,t_peo = self.lex_BFS(tree=True)
   9487 
   9488         g = self.copy()

/home/ncohen/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in lex_BFS(self, reverse, tree, initial_vertex)
  11617                 if subslice[a] < old_k:
  11618                     subslice[a] = k
> 11619                     slice_head[k] = l
  11620                     k += 1
  11621                 slice_of[l] = subslice[a]

IndexError: list assignment index out of range
```

On random interval graphs sometimes the is_interval function works, sometimes it does not... `^^;` 

I tested you patch after having applied #11738 and #11735 but I do not think this is where the bug comes from. Could you also add some comments to your code, along with a reference to the paper you are following for this implementation ? `:-)`

Nathann



---

archive/issue_events_156077.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-11T13:57:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156077"
}
```



---

archive/issue_events_156078.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-11T13:57:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156078"
}
```



---

archive/issue_comments_121914.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@nathanncohen](#comment:7):\nHello Nathann, I think the bug is now fixed (it was a very simple mistake). I added the reference, but the comments are still missing.\nThanks!",
    "created_at": "2011-09-14T03:44:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121914",
    "user": "https://github.com/diegode"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@nathanncohen](#comment:7):
Hello Nathann, I think the bug is now fixed (it was a very simple mistake). I added the reference, but the comments are still missing.
Thanks!



---

archive/issue_events_156079.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-09-14T03:44:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156079"
}
```



---

archive/issue_events_156080.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2011-09-14T03:44:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156080"
}
```



---

archive/issue_events_156081.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-28T19:10:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156081"
}
```



---

archive/issue_events_156082.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2011-09-28T19:10:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156082"
}
```



---

archive/issue_comments_121915.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHello !!\n\nThis patch still produces many errors when running the doctests...\n\n```\nsage -t  \"devel/sage-3/sage/graphs/generic_graph.py\"        \nIBM ILOG License Manager: \"IBM ILOG Optimization Suite for Academic Initiative\" is accessing CPLEX 12 with option(s): \"e m b q \".\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py\", line 9412:\n    sage: (2*g).is_chordal()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/ncohen/.Sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_137[6]>\", line 1, in <module>\n        (Integer(2)*g).is_chordal()###line 9412:\n    sage: (2*g).is_chordal()\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 9474, in is_chordal\n        return all( gg.is_chordal() for gg in self.connected_components_subgraphs() )\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 9474, in <genexpr>\n        return all( gg.is_chordal() for gg in self.connected_components_subgraphs() )\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 9488, in is_chordal\n        if t_peo.out_degree(v)>0 and g.neighbors(v) not in neighbors_subsets[t_peo.neighbor_out_iterator(v).next()]:\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/digraph.py\", line 1178, in out_degree\n        return list(self.out_degree_iterator(vertices, labels=labels))\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/digraph.py\", line 1223, in out_degree_iterator\n        for v in vertices:\n    TypeError: 'int' object is not iterable\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py\", line 9436:\n    sage: hole\nExpected:\n    Subgraph of (Petersen graph): Graph on 5 vertices\nGot:\n    Subgraph of (Petersen graph): Graph on 4 vertices\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py\", line 9438:\n    sage: hole.is_isomorphic(graphs.CycleGraph(5))\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py\", line 9554:\n    sage: g.is_interval()\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py\", line 9562:\n    sage: d = g.is_interval(certificate = True)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n...\n```\n\nPerhaps we can help with your problem running doctests ? It something does not work on this side, it is another bug of Sage's ! `;-)`\n\nNathann",
    "created_at": "2011-09-28T19:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121915",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:9" align="right">comment:9</div>

Hello !!

This patch still produces many errors when running the doctests...

```
sage -t  "devel/sage-3/sage/graphs/generic_graph.py"        
IBM ILOG License Manager: "IBM ILOG Optimization Suite for Academic Initiative" is accessing CPLEX 12 with option(s): "e m b q ".
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py", line 9412:
    sage: (2*g).is_chordal()
Exception raised:
    Traceback (most recent call last):
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_137[6]>", line 1, in <module>
        (Integer(2)*g).is_chordal()###line 9412:
    sage: (2*g).is_chordal()
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 9474, in is_chordal
        return all( gg.is_chordal() for gg in self.connected_components_subgraphs() )
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 9474, in <genexpr>
        return all( gg.is_chordal() for gg in self.connected_components_subgraphs() )
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 9488, in is_chordal
        if t_peo.out_degree(v)>0 and g.neighbors(v) not in neighbors_subsets[t_peo.neighbor_out_iterator(v).next()]:
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/digraph.py", line 1178, in out_degree
        return list(self.out_degree_iterator(vertices, labels=labels))
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/digraph.py", line 1223, in out_degree_iterator
        for v in vertices:
    TypeError: 'int' object is not iterable
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py", line 9436:
    sage: hole
Expected:
    Subgraph of (Petersen graph): Graph on 5 vertices
Got:
    Subgraph of (Petersen graph): Graph on 4 vertices
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py", line 9438:
    sage: hole.is_isomorphic(graphs.CycleGraph(5))
Expected:
    True
Got:
    False
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py", line 9554:
    sage: g.is_interval()
Expected:
    True
Got:
    False
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-3/sage/graphs/generic_graph.py", line 9562:
    sage: d = g.is_interval(certificate = True)
Exception raised:
    Traceback (most recent call last):
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
...
```

Perhaps we can help with your problem running doctests ? It something does not work on this side, it is another bug of Sage's ! `;-)`

Nathann



---

archive/issue_comments_121916.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI was ready to help with the doctests issues, but I'm unable to install the patch on sage-5.0.beta9.",
    "created_at": "2012-03-26T16:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121916",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:10" align="right">comment:10</div>

I was ready to help with the doctests issues, but I'm unable to install the patch on sage-5.0.beta9.



---

archive/issue_comments_121917.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@dcoudert](#comment:10):\n> I was ready to help with the doctests issues, but I'm unable to install the patch on sage-5.0.beta9.\n\nHello! I'm sorry I disappeared. I will fix this in the next few days.",
    "created_at": "2012-03-26T18:01:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121917",
    "user": "https://github.com/diegode"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@dcoudert](#comment:10):
> I was ready to help with the doctests issues, but I'm unable to install the patch on sage-5.0.beta9.

Hello! I'm sorry I disappeared. I will fix this in the next few days.



---

archive/issue_comments_121918.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAttachment: **[linear_lex_bfs_fixed.patch.gz](https://github.com/sagemath/sage/files/ticket11736/linear_lex_bfs_fixed.patch.gz)**",
    "created_at": "2012-03-27T06:12:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121918",
    "user": "https://github.com/diegode"
}
```

<div id="comment:12" align="right">comment:12</div>

Attachment: **[linear_lex_bfs_fixed.patch.gz](https://github.com/sagemath/sage/files/ticket11736/linear_lex_bfs_fixed.patch.gz)**



---

archive/issue_events_156083.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2012-03-27T06:12:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156083"
}
```



---

archive/issue_events_156084.json:
```json
{
    "actor": "https://github.com/diegode",
    "created_at": "2012-03-27T06:12:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156084"
}
```



---

archive/issue_comments_121919.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI think this patch is working now and passes all the doctests. I'm sure the errors I get while doctesting are bugs of Sage 4.8 (for example, on both Ubuntu 10.10 and OS X 10.7 I get an error in line 15146 of generic_graph.py: \"ValueError: Database has no tablegraph_data.\").",
    "created_at": "2012-03-27T23:59:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121919",
    "user": "https://github.com/diegode"
}
```

<div id="comment:14" align="right">comment:14</div>

I think this patch is working now and passes all the doctests. I'm sure the errors I get while doctesting are bugs of Sage 4.8 (for example, on both Ubuntu 10.10 and OS X 10.7 I get an error in line 15146 of generic_graph.py: "ValueError: Database has no tablegraph_data.").



---

archive/issue_comments_121920.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nHelloooooo Diego !!\n\nI'm sorry but your patch can not be applied on top of the latest release of Sage, that is sage-5.0-beta11 (https://groups.google.com/d/topic/sage-release/XnyN3tx4Bow/discussion). Plenty of stuff has been added in the 5.0-beta? series, and that is probably the explanation `:-)`\n\nAbout your path, though : it removes the old code that computed (more slowly) a BFS ordering for the vertices. This being said, I think this code could still be useful to ... check that the new algorithm actually returns a correct BFS ordering ! Of course, as it is slower, this ordering should not be checked by default, but it would be nice to be able to run doctests which check for each computation of BFS ordering whether this ordering is indeed correct. This can be done by actually checking in turn that each vertex of the ordering is maximal at the moment when it is removed.\n\nDo you think it could be possible to comment your code a bit more ? As it is, reading the paper to understand what happens seems to be the only alternative `:-)`\n\nNathann",
    "created_at": "2012-03-30T22:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121920",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:15" align="right">comment:15</div>

Helloooooo Diego !!

I'm sorry but your patch can not be applied on top of the latest release of Sage, that is sage-5.0-beta11 (https://groups.google.com/d/topic/sage-release/XnyN3tx4Bow/discussion). Plenty of stuff has been added in the 5.0-beta? series, and that is probably the explanation `:-)`

About your path, though : it removes the old code that computed (more slowly) a BFS ordering for the vertices. This being said, I think this code could still be useful to ... check that the new algorithm actually returns a correct BFS ordering ! Of course, as it is slower, this ordering should not be checked by default, but it would be nice to be able to run doctests which check for each computation of BFS ordering whether this ordering is indeed correct. This can be done by actually checking in turn that each vertex of the ordering is maximal at the moment when it is removed.

Do you think it could be possible to comment your code a bit more ? As it is, reading the paper to understand what happens seems to be the only alternative `:-)`

Nathann



---

archive/issue_events_156085.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-03-30T22:22:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156085"
}
```



---

archive/issue_events_156086.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-03-30T22:22:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156086"
}
```



---

archive/issue_events_156087.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156087"
}
```



---

archive/issue_events_156088.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156088"
}
```



---

archive/issue_events_156089.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156089"
}
```



---

archive/issue_events_156090.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156090"
}
```



---

archive/issue_events_156091.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156091"
}
```



---

archive/issue_events_156092.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156092"
}
```



---

archive/issue_events_156093.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156093"
}
```



---

archive/issue_events_156094.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156094"
}
```



---

archive/issue_comments_121921.json:
```json
{
    "body": "Branch: **[public/11736](https://github.com/sagemath/sagetrac-mirror/tree/public/11736)**",
    "created_at": "2015-03-14T13:26:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121921",
    "user": "https://github.com/dcoudert"
}
```

Branch: **[public/11736](https://github.com/sagemath/sagetrac-mirror/tree/public/11736)**



---

archive/issue_comments_121922.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/588c43140644c9d43cfae2e27e116566eda9ac54\"><code>588c431</code></a></td><td><code>trac #11736: convert hg patch to git</code></td></tr></table>\n",
    "created_at": "2015-03-14T13:29:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121922",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/588c43140644c9d43cfae2e27e116566eda9ac54"><code>588c431</code></a></td><td><code>trac #11736: convert hg patch to git</code></td></tr></table>




---

archive/issue_comments_121923.json:
```json
{
    "body": "Commit: **[`588c431`](https://github.com/sagemath/sagetrac-mirror/commit/588c43140644c9d43cfae2e27e116566eda9ac54)**",
    "created_at": "2015-03-14T13:29:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121923",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`588c431`](https://github.com/sagemath/sagetrac-mirror/commit/588c43140644c9d43cfae2e27e116566eda9ac54)**



---

archive/issue_comments_121924.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nHello,\n\nThis patch has been sleeping for very very long time.\n\nI did a first git version of the patch with some corrections. This is far from final version and we have currently 2 implementations to ease tests. To use the new version, you need to set parameter `new_version=True`.\n\nSince the code has no comments, it is hard to know whats going on. I have corrected at least one bug (a missing `j = l`), but I have the following issue:\n\n```\nsage: g = graphs.PathGraph(3).lexicographic_product(graphs.CompleteGraph(2))\nsage: g.lex_BFS(reverse=True)\n[(2, 1), (2, 0), (1, 1), (1, 0), (0, 1), (0, 0)]\nsage: g.lex_BFS(reverse=True, new_version=True)\n[(2, 1), (2, 0), (1, 1), (1, 0), (0, 1), (0, 0)]\nsage: g.lex_BFS(reverse=False)\n[(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1)]\nsage: g.lex_BFS(reverse=False, new_version=True)\n[(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1)]\n```\n\nThe new version is more consistant (and also way faster). Furthermore, on this example, both reverse orderings are correct. \nHowever, when making the new version the default one, many tests for `is_chordal` and `is_interval` are broken.\n\nAny help is welcome.\n\nDavid.",
    "created_at": "2015-03-14T13:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121924",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:22" align="right">comment:22</div>

Hello,

This patch has been sleeping for very very long time.

I did a first git version of the patch with some corrections. This is far from final version and we have currently 2 implementations to ease tests. To use the new version, you need to set parameter `new_version=True`.

Since the code has no comments, it is hard to know whats going on. I have corrected at least one bug (a missing `j = l`), but I have the following issue:

```
sage: g = graphs.PathGraph(3).lexicographic_product(graphs.CompleteGraph(2))
sage: g.lex_BFS(reverse=True)
[(2, 1), (2, 0), (1, 1), (1, 0), (0, 1), (0, 0)]
sage: g.lex_BFS(reverse=True, new_version=True)
[(2, 1), (2, 0), (1, 1), (1, 0), (0, 1), (0, 0)]
sage: g.lex_BFS(reverse=False)
[(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1)]
sage: g.lex_BFS(reverse=False, new_version=True)
[(0, 0), (0, 1), (1, 0), (1, 1), (2, 0), (2, 1)]
```

The new version is more consistant (and also way faster). Furthermore, on this example, both reverse orderings are correct. 
However, when making the new version the default one, many tests for `is_chordal` and `is_interval` are broken.

Any help is welcome.

David.



---

archive/issue_events_156095.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2015-03-14T13:45:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156095"
}
```



---

archive/issue_events_156096.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2015-03-14T13:45:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156096"
}
```



---

archive/issue_comments_121925.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12fdf755595a2a19a333e7928e8d1ef6d2e3f649\"><code>12fdf75</code></a></td><td><code>Merge branch 'public/11736' in 7.5.b1</code></td></tr></table>\n",
    "created_at": "2016-11-03T19:39:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121925",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12fdf755595a2a19a333e7928e8d1ef6d2e3f649"><code>12fdf75</code></a></td><td><code>Merge branch 'public/11736' in 7.5.b1</code></td></tr></table>




---

archive/issue_comments_121926.json:
```json
{
    "body": "Changed commit from **[`588c431`](https://github.com/sagemath/sagetrac-mirror/commit/588c43140644c9d43cfae2e27e116566eda9ac54)** to **[`12fdf75`](https://github.com/sagemath/sagetrac-mirror/commit/12fdf755595a2a19a333e7928e8d1ef6d2e3f649)**",
    "created_at": "2016-11-03T19:39:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121926",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`588c431`](https://github.com/sagemath/sagetrac-mirror/commit/588c43140644c9d43cfae2e27e116566eda9ac54)** to **[`12fdf75`](https://github.com/sagemath/sagetrac-mirror/commit/12fdf755595a2a19a333e7928e8d1ef6d2e3f649)**



---

archive/issue_comments_121927.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/906438689c7b8b32756c8799fb410682b0c1dea8\"><code>9064386</code></a></td><td><code>trac 11736 pep8</code></td></tr></table>\n",
    "created_at": "2016-11-03T20:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121927",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/906438689c7b8b32756c8799fb410682b0c1dea8"><code>9064386</code></a></td><td><code>trac 11736 pep8</code></td></tr></table>




---

archive/issue_comments_121928.json:
```json
{
    "body": "Changed commit from **[`12fdf75`](https://github.com/sagemath/sagetrac-mirror/commit/12fdf755595a2a19a333e7928e8d1ef6d2e3f649)** to **[`9064386`](https://github.com/sagemath/sagetrac-mirror/commit/906438689c7b8b32756c8799fb410682b0c1dea8)**",
    "created_at": "2016-11-03T20:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121928",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`12fdf75`](https://github.com/sagemath/sagetrac-mirror/commit/12fdf755595a2a19a333e7928e8d1ef6d2e3f649)** to **[`9064386`](https://github.com/sagemath/sagetrac-mirror/commit/906438689c7b8b32756c8799fb410682b0c1dea8)**



---

archive/issue_comments_121929.json:
```json
{
    "body": "Changed commit from **[`9064386`](https://github.com/sagemath/sagetrac-mirror/commit/906438689c7b8b32756c8799fb410682b0c1dea8)** to **[`89af4c2`](https://github.com/sagemath/sagetrac-mirror/commit/89af4c2dc2f6a39f1d009c02feb945c00500cd28)**",
    "created_at": "2020-08-11T18:35:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121929",
    "user": "https://github.com/dcoudert"
}
```

Changed commit from **[`9064386`](https://github.com/sagemath/sagetrac-mirror/commit/906438689c7b8b32756c8799fb410682b0c1dea8)** to **[`89af4c2`](https://github.com/sagemath/sagetrac-mirror/commit/89af4c2dc2f6a39f1d009c02feb945c00500cd28)**



---

archive/issue_events_156097.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-11T18:35:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156097"
}
```



---

archive/issue_events_156098.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-11T18:35:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156098"
}
```



---

archive/issue_events_156099.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-11T18:35:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156099"
}
```



---

archive/issue_events_156100.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-11T18:35:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156100"
}
```



---

archive/issue_comments_121930.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nNew branch based on 9.2.beta8 with:\n- corrected (hope so) version of previous trials for implementing the algorithm of Habib et al 2000. \n- several improvements of the existing code\n\nPlease test it extensively !\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89af4c2dc2f6a39f1d009c02feb945c00500cd28\"><code>89af4c2</code></a></td><td><code>trac #11736: new version</code></td></tr></table>\n",
    "created_at": "2020-08-11T18:35:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121930",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:25" align="right">comment:25</div>

New branch based on 9.2.beta8 with:
- corrected (hope so) version of previous trials for implementing the algorithm of Habib et al 2000. 
- several improvements of the existing code

Please test it extensively !

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89af4c2dc2f6a39f1d009c02feb945c00500cd28"><code>89af4c2</code></a></td><td><code>trac #11736: new version</code></td></tr></table>




---

archive/issue_comments_121931.json:
```json
{
    "body": "Changed branch from **[public/11736](https://github.com/sagemath/sagetrac-mirror/tree/public/11736)** to **[public/graphs/11736_lex_bfs](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/11736_lex_bfs)**",
    "created_at": "2020-08-11T18:35:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121931",
    "user": "https://github.com/dcoudert"
}
```

Changed branch from **[public/11736](https://github.com/sagemath/sagetrac-mirror/tree/public/11736)** to **[public/graphs/11736_lex_bfs](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/11736_lex_bfs)**



---

archive/issue_comments_121932.json:
```json
{
    "body": "Author: **Diego de Estrada, David Coudert**",
    "created_at": "2020-08-11T18:35:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121932",
    "user": "https://github.com/dcoudert"
}
```

Author: **Diego de Estrada, David Coudert**



---

archive/issue_events_156101.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-12T09:02:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156101"
}
```



---

archive/issue_events_156102.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-12T09:02:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156102"
}
```



---

archive/issue_comments_121933.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nsomething wrong :(\n\n```\nFile \"src/sage/graphs/generic_graph.py\", line 13620, in sage.graphs.generic_graph.GenericGraph.is_interval\nFailed example:\n    [sum(1 for g in graphs(i) if g.is_interval()) for i in range(8)]  # long time\nExpected:\n    [1, 1, 2, 4, 10, 27, 92, 369]\nGot:\n    [1, 1, 2, 4, 10, 27, 91, 374]\n```\n\nAt least this graph is not recognized as interval graph (actually, not chordal) when using the new version: `Graph(\"ETzw\")`.",
    "created_at": "2020-08-12T09:02:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121933",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:26" align="right">comment:26</div>

something wrong :(

```
File "src/sage/graphs/generic_graph.py", line 13620, in sage.graphs.generic_graph.GenericGraph.is_interval
Failed example:
    [sum(1 for g in graphs(i) if g.is_interval()) for i in range(8)]  # long time
Expected:
    [1, 1, 2, 4, 10, 27, 92, 369]
Got:
    [1, 1, 2, 4, 10, 27, 91, 374]
```

At least this graph is not recognized as interval graph (actually, not chordal) when using the new version: `Graph("ETzw")`.



---

archive/issue_comments_121934.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/90d266e73f1f84d8fbae9b64a7ade43b459c80d6\"><code>90d266e</code></a></td><td><code>trac #11736: fix memory allocation and add documentation</code></td></tr></table>\n",
    "created_at": "2020-08-12T13:32:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121934",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/90d266e73f1f84d8fbae9b64a7ade43b459c80d6"><code>90d266e</code></a></td><td><code>trac #11736: fix memory allocation and add documentation</code></td></tr></table>




---

archive/issue_comments_121935.json:
```json
{
    "body": "Changed commit from **[`89af4c2`](https://github.com/sagemath/sagetrac-mirror/commit/89af4c2dc2f6a39f1d009c02feb945c00500cd28)** to **[`90d266e`](https://github.com/sagemath/sagetrac-mirror/commit/90d266e73f1f84d8fbae9b64a7ade43b459c80d6)**",
    "created_at": "2020-08-12T13:32:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121935",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`89af4c2`](https://github.com/sagemath/sagetrac-mirror/commit/89af4c2dc2f6a39f1d009c02feb945c00500cd28)** to **[`90d266e`](https://github.com/sagemath/sagetrac-mirror/commit/90d266e73f1f84d8fbae9b64a7ade43b459c80d6)**



---

archive/issue_comments_121936.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThe error was a side effect of wrong memory allocation. Should be OK now.",
    "created_at": "2020-08-12T13:33:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121936",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:28" align="right">comment:28</div>

The error was a side effect of wrong memory allocation. Should be OK now.



---

archive/issue_events_156103.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-12T13:33:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156103"
}
```



---

archive/issue_events_156104.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2020-08-12T13:33:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156104"
}
```



---

archive/issue_comments_121937.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nIs it feasible to generate a small random graph, feed it to both algorithms, and check that their outputs agree in a doctest? That would go a long way towards ensuring that the newer implementation is correct (or at least as correct as the old one).",
    "created_at": "2020-09-03T15:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121937",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:30" align="right">comment:30</div>

Is it feasible to generate a small random graph, feed it to both algorithms, and check that their outputs agree in a doctest? That would go a long way towards ensuring that the newer implementation is correct (or at least as correct as the old one).



---

archive/issue_comments_121938.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe difficulty is that we may have several valid orderings, even with same initial vertex, and that the 2 algorithms may produce different orderings\nFor instance:\n\n```\nsage: for i in range(100): \n....:     G = graphs.RandomChordalGraph(10) \n....:     F = G.lex_BFS(initial_vertex=0, algorithm=\"fast\") \n....:     S = G.lex_BFS(initial_vertex=0, algorithm=\"slow\") \n....:     print(i, \"fast\", F) \n....:     print(i, \"slow\", S) \n....:     if S != F: \n....:         print(G.graph6_string()) \n....:         break \n....:                                                                                                                               \n0 fast [0, 1, 5, 9, 6, 4, 7, 2, 8, 3]\n0 slow [0, 1, 5, 9, 6, 4, 7, 2, 8, 3]\n1 fast [0, 1, 4, 8, 2, 7, 9, 6, 3, 5]\n1 slow [0, 1, 4, 8, 2, 7, 9, 6, 3, 5]\n2 fast [0, 6, 7, 9, 8, 5, 1, 3, 2, 4]\n2 slow [0, 6, 7, 9, 8, 1, 3, 5, 2, 4]\nIAHSCEA_w\n```\nIn this example, the last graph is not connected, but it's the same with connected graphs.\nFor instance, take a star with center 0. Then any permutation of the leaves lead to a valid lex BFS ordering.\n\nOne option could be to make an indirect doctest using `is_chordal` on a random chordal graph, but for that me must be able to specify the lex BFS algorithm to use in `is_chordal`. Not sure it's the best way.\n\nBut may be there is an other way to check that a lex BFS ordering is valid ?",
    "created_at": "2020-09-03T16:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121938",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:31" align="right">comment:31</div>

The difficulty is that we may have several valid orderings, even with same initial vertex, and that the 2 algorithms may produce different orderings
For instance:

```
sage: for i in range(100): 
....:     G = graphs.RandomChordalGraph(10) 
....:     F = G.lex_BFS(initial_vertex=0, algorithm="fast") 
....:     S = G.lex_BFS(initial_vertex=0, algorithm="slow") 
....:     print(i, "fast", F) 
....:     print(i, "slow", S) 
....:     if S != F: 
....:         print(G.graph6_string()) 
....:         break 
....:                                                                                                                               
0 fast [0, 1, 5, 9, 6, 4, 7, 2, 8, 3]
0 slow [0, 1, 5, 9, 6, 4, 7, 2, 8, 3]
1 fast [0, 1, 4, 8, 2, 7, 9, 6, 3, 5]
1 slow [0, 1, 4, 8, 2, 7, 9, 6, 3, 5]
2 fast [0, 6, 7, 9, 8, 5, 1, 3, 2, 4]
2 slow [0, 6, 7, 9, 8, 1, 3, 5, 2, 4]
IAHSCEA_w
```
In this example, the last graph is not connected, but it's the same with connected graphs.
For instance, take a star with center 0. Then any permutation of the leaves lead to a valid lex BFS ordering.

One option could be to make an indirect doctest using `is_chordal` on a random chordal graph, but for that me must be able to specify the lex BFS algorithm to use in `is_chordal`. Not sure it's the best way.

But may be there is an other way to check that a lex BFS ordering is valid ?



---

archive/issue_comments_121939.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOk, I see the problem. The paper \"LexBFS-orderings and powers of graphs\" (doi:10.1007/3-540-62559-3_15) has a characterization of LBFS orderings in Lemma 1 that looks pretty easy to implement. What do you think about an `_is_lbfs(graph, order)` function that could be used to test the outputs of the fast/slow algorithms? Both would return `True` when fed to `_is_lbfs`, I expect.",
    "created_at": "2020-09-03T19:16:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121939",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:32" align="right">comment:32</div>

Ok, I see the problem. The paper "LexBFS-orderings and powers of graphs" (doi:10.1007/3-540-62559-3_15) has a characterization of LBFS orderings in Lemma 1 that looks pretty easy to implement. What do you think about an `_is_lbfs(graph, order)` function that could be used to test the outputs of the fast/slow algorithms? Both would return `True` when fed to `_is_lbfs`, I expect.



---

archive/issue_comments_121940.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nMinor comment outside of the scope of the ticket: You might be able to do this for a bit more speed:\n\n```diff\n-        def l_func(x):\n-            return code[x]\n \n         # The initial_vertex is at position 0 and so named 0 in sd\n         code[0].append(n + 1)\n         now = 1\n         while vertices:\n-            v = max(vertices, key=l_func)\n+            v = max(vertices, key=code.__getitem__)\n```",
    "created_at": "2020-09-03T23:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121940",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:33" align="right">comment:33</div>

Minor comment outside of the scope of the ticket: You might be able to do this for a bit more speed:

```diff
-        def l_func(x):
-            return code[x]
 
         # The initial_vertex is at position 0 and so named 0 in sd
         code[0].append(n + 1)
         now = 1
         while vertices:
-            v = max(vertices, key=l_func)
+            v = max(vertices, key=code.__getitem__)
```



---

archive/issue_comments_121941.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9a3ec81ec3343ca94c2b2ea4e6701b5873af715\"><code>b9a3ec8</code></a></td><td><code>trac #11736: merge with 9.2.beta11</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7609c669194ad947ad7203cb01f65f98d2c15f93\"><code>7609c66</code></a></td><td><code>trac #11736: add method to check validity of lexBFS ordering</code></td></tr></table>\n",
    "created_at": "2020-09-04T15:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121941",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9a3ec81ec3343ca94c2b2ea4e6701b5873af715"><code>b9a3ec8</code></a></td><td><code>trac #11736: merge with 9.2.beta11</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7609c669194ad947ad7203cb01f65f98d2c15f93"><code>7609c66</code></a></td><td><code>trac #11736: add method to check validity of lexBFS ordering</code></td></tr></table>




---

archive/issue_comments_121942.json:
```json
{
    "body": "Changed commit from **[`90d266e`](https://github.com/sagemath/sagetrac-mirror/commit/90d266e73f1f84d8fbae9b64a7ade43b459c80d6)** to **[`7609c66`](https://github.com/sagemath/sagetrac-mirror/commit/7609c669194ad947ad7203cb01f65f98d2c15f93)**",
    "created_at": "2020-09-04T15:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121942",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`90d266e`](https://github.com/sagemath/sagetrac-mirror/commit/90d266e73f1f84d8fbae9b64a7ade43b459c80d6)** to **[`7609c66`](https://github.com/sagemath/sagetrac-mirror/commit/7609c669194ad947ad7203cb01f65f98d2c15f93)**



---

archive/issue_comments_121943.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI have added a method to check that a lexBFS ordering is valid in (directed) graphs.\nI'm not yet 100% convinced that it is enough to check this property, so if you are aware of other tests, let me know.",
    "created_at": "2020-09-04T15:09:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121943",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:35" align="right">comment:35</div>

I have added a method to check that a lexBFS ordering is valid in (directed) graphs.
I'm not yet 100% convinced that it is enough to check this property, so if you are aware of other tests, let me know.



---

archive/issue_comments_121944.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nWe're working on getting rid of this, but for now, you have to call `set_random_seed()` at the beginning of every doctest where randomness is required (i.e. the ones you've just added). Otherwise the random number generator isn't actually random, and you'll wind up testing the same example every time the tests are run.",
    "created_at": "2020-09-04T20:28:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121944",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:36" align="right">comment:36</div>

We're working on getting rid of this, but for now, you have to call `set_random_seed()` at the beginning of every doctest where randomness is required (i.e. the ones you've just added). Otherwise the random number generator isn't actually random, and you'll wind up testing the same example every time the tests are run.



---

archive/issue_comments_121945.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nExample:\n\n```\nThe nonnegative orthant is a proper cone::\n\n    sage: set_random_seed()\n    sage: ambient_dim = ZZ.random_element(10)\n    sage: K = cones.nonnegative_orthant(ambient_dim)\n    sage: K.is_proper()\n    True\n```",
    "created_at": "2020-09-04T20:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121945",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:37" align="right">comment:37</div>

Example:

```
The nonnegative orthant is a proper cone::

    sage: set_random_seed()
    sage: ambient_dim = ZZ.random_element(10)
    sage: K = cones.nonnegative_orthant(ambient_dim)
    sage: K.is_proper()
    True
```



---

archive/issue_comments_121946.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52c355e8d8aef1faee2ca5ed17da485e999279b9\"><code>52c355e</code></a></td><td><code>trac #11736: set random seed</code></td></tr></table>\n",
    "created_at": "2020-09-04T22:34:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121946",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52c355e8d8aef1faee2ca5ed17da485e999279b9"><code>52c355e</code></a></td><td><code>trac #11736: set random seed</code></td></tr></table>




---

archive/issue_comments_121947.json:
```json
{
    "body": "Changed commit from **[`7609c66`](https://github.com/sagemath/sagetrac-mirror/commit/7609c669194ad947ad7203cb01f65f98d2c15f93)** to **[`52c355e`](https://github.com/sagemath/sagetrac-mirror/commit/52c355e8d8aef1faee2ca5ed17da485e999279b9)**",
    "created_at": "2020-09-04T22:34:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121947",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7609c66`](https://github.com/sagemath/sagetrac-mirror/commit/7609c669194ad947ad7203cb01f65f98d2c15f93)** to **[`52c355e`](https://github.com/sagemath/sagetrac-mirror/commit/52c355e8d8aef1faee2ca5ed17da485e999279b9)**



---

archive/issue_comments_121948.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThank you. I didn't know that.",
    "created_at": "2020-09-04T22:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121948",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:39" align="right">comment:39</div>

Thank you. I didn't know that.



---

archive/issue_comments_121949.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI've been playing around with this, here are a few more suggestions:\n\n1. You could use `ZZ.random_element(G.num_verts())` instead of always `0` for the initial vertex in your random tests; that would improve coverage a bit.\n\n2. The documentation for the `cdef` method isn't appearing in the reference manual for me (does anyone know if that's expected?). Since you put a lot of work into the docs for `lex_BFS_fast_short_digraph`, maybe you want to move them into the main `lex_BFS` docstring?\n\n3. (Unrelated to this ticket) While you're in there, please add an extra `:` to the end of `TESTS:` in `maximum_cardinality_search()`. Right now sage doesn't recognize it as a doctest.",
    "created_at": "2020-09-06T12:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121949",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:40" align="right">comment:40</div>

I've been playing around with this, here are a few more suggestions:

1. You could use `ZZ.random_element(G.num_verts())` instead of always `0` for the initial vertex in your random tests; that would improve coverage a bit.

2. The documentation for the `cdef` method isn't appearing in the reference manual for me (does anyone know if that's expected?). Since you put a lot of work into the docs for `lex_BFS_fast_short_digraph`, maybe you want to move them into the main `lex_BFS` docstring?

3. (Unrelated to this ticket) While you're in there, please add an extra `:` to the end of `TESTS:` in `maximum_cardinality_search()`. Right now sage doesn't recognize it as a doctest.



---

archive/issue_comments_121950.json:
```json
{
    "body": "<div id=\"comment:41\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15a041920a74a2268e98e787cf8da3200562ecc0\"><code>15a0419</code></a></td><td><code>trac #11736: review comments</code></td></tr></table>\n",
    "created_at": "2020-09-06T13:27:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121950",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:41"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15a041920a74a2268e98e787cf8da3200562ecc0"><code>15a0419</code></a></td><td><code>trac #11736: review comments</code></td></tr></table>




---

archive/issue_comments_121951.json:
```json
{
    "body": "Changed commit from **[`52c355e`](https://github.com/sagemath/sagetrac-mirror/commit/52c355e8d8aef1faee2ca5ed17da485e999279b9)** to **[`15a0419`](https://github.com/sagemath/sagetrac-mirror/commit/15a041920a74a2268e98e787cf8da3200562ecc0)**",
    "created_at": "2020-09-06T13:27:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121951",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`52c355e`](https://github.com/sagemath/sagetrac-mirror/commit/52c355e8d8aef1faee2ca5ed17da485e999279b9)** to **[`15a0419`](https://github.com/sagemath/sagetrac-mirror/commit/15a041920a74a2268e98e787cf8da3200562ecc0)**



---

archive/issue_comments_121952.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI have implemented your suggestions. For the algorithm, I made a copy of the description without suppressing it from the cdef method. I think it is easier this way for someone interested in this code to understand it.",
    "created_at": "2020-09-06T13:28:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121952",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:42" align="right">comment:42</div>

I have implemented your suggestions. For the algorithm, I made a copy of the description without suppressing it from the cdef method. I think it is easier this way for someone interested in this code to understand it.



---

archive/issue_comments_121953.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nThanks! Here are two more small things:\n\nFirst, in the documentation for `lex_BFS_fast_short_digraph` (and now `lex_BFS`), there's a LaTeX typo at\n\n```\nS = `{u | i \\leq \\sigma(u) \\leq j\\}\n```\nThe opening curly brace isn't escaped, so the formula isn't showing up.\n\nSecond, in `_is_valid_lex_BFS_order`, it looks to me like you've figured out the correct directions for the edges to make things work with a digraph, namely `ca`, `cb`, `da`, and `db`. However the docs still have some of them in a different order from when the result was stated for an undirected graph:\n\n```\nif `a < b < c` and `ac \\in E` and `bc \\not\\in E`, then there exists `d\\in V`                                                                                             \nsuch that `c < d`, `bd \\in E` and `ad \\not\\in E`.\n```",
    "created_at": "2020-09-06T19:04:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121953",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:43" align="right">comment:43</div>

Thanks! Here are two more small things:

First, in the documentation for `lex_BFS_fast_short_digraph` (and now `lex_BFS`), there's a LaTeX typo at

```
S = `{u | i \leq \sigma(u) \leq j\}
```
The opening curly brace isn't escaped, so the formula isn't showing up.

Second, in `_is_valid_lex_BFS_order`, it looks to me like you've figured out the correct directions for the edges to make things work with a digraph, namely `ca`, `cb`, `da`, and `db`. However the docs still have some of them in a different order from when the result was stated for an undirected graph:

```
if `a < b < c` and `ac \in E` and `bc \not\in E`, then there exists `d\in V`                                                                                             
such that `c < d`, `bd \in E` and `ad \not\in E`.
```



---

archive/issue_comments_121954.json:
```json
{
    "body": "Changed commit from **[`15a0419`](https://github.com/sagemath/sagetrac-mirror/commit/15a041920a74a2268e98e787cf8da3200562ecc0)** to **[`332fb8b`](https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26)**",
    "created_at": "2020-09-06T20:18:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121954",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`15a0419`](https://github.com/sagemath/sagetrac-mirror/commit/15a041920a74a2268e98e787cf8da3200562ecc0)** to **[`332fb8b`](https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26)**



---

archive/issue_comments_121955.json:
```json
{
    "body": "<div id=\"comment:44\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26\"><code>332fb8b</code></a></td><td><code>trac #11736: fix documentation</code></td></tr></table>\n",
    "created_at": "2020-09-06T20:18:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121955",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26"><code>332fb8b</code></a></td><td><code>trac #11736: fix documentation</code></td></tr></table>




---

archive/issue_comments_121956.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\ngood catch. Hope it will be ok this time.",
    "created_at": "2020-09-06T20:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121956",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:45" align="right">comment:45</div>

good catch. Hope it will be ok this time.



---

archive/issue_events_156105.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-09-07T00:14:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156105"
}
```



---

archive/issue_events_156106.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2020-09-07T00:14:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156106"
}
```



---

archive/issue_comments_121957.json:
```json
{
    "body": "Reviewer: **Michael Orlitzky**",
    "created_at": "2020-09-07T00:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121957",
    "user": "https://github.com/orlitzky"
}
```

Reviewer: **Michael Orlitzky**



---

archive/issue_comments_121958.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nThis looks good to me now, unless anyone else wants to comment. I've checked the implementation of `_is_valid_lex_BFS_order`. It's \"obviously correct\" for undirected graphs, and probably for directed graphs too although I haven't been able to find the corresponding theorem for digraphs written down.\n\nThe implementation of `lex_BFS_fast_short_digraph` is less scrutable but looks reasonable now that I understand how the algorithm works. I trust the doctests more than I trust myself in any case. Since you've been working on this for 8 years I'm inclined to say let's get it over with.",
    "created_at": "2020-09-07T00:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121958",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:46" align="right">comment:46</div>

This looks good to me now, unless anyone else wants to comment. I've checked the implementation of `_is_valid_lex_BFS_order`. It's "obviously correct" for undirected graphs, and probably for directed graphs too although I haven't been able to find the corresponding theorem for digraphs written down.

The implementation of `lex_BFS_fast_short_digraph` is less scrutable but looks reasonable now that I understand how the algorithm works. I trust the doctests more than I trust myself in any case. Since you've been working on this for 8 years I'm inclined to say let's get it over with.



---

archive/issue_comments_121959.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nThank you for your help.\n\nTo understand the fast algorithm, you need to understand that a slice is nothing else than a label. When creating a subslice of a slice from position p to position q, you place the vertices of the sub slice on positions p...p+I, and the remaining vertices of the original slice at positions p+I+1...q. So the vertices in the sub slice have a larger label than the other vertices of the original slice. The tricks are to associate a position with the current slice name, to maintain the head (left most vertex of a slice) of each slice, and give a name to each  newly created subslice.\n\nTo check the property on directed graphs, its more tricky, but I'm convinced it is correct. An alternative to check the validity is to modify the slow algorith. That is, instead of selecting a vertex with largest label, we identify all candidates (vertices with same largest label), and check that the next vertex in the given order is in this pool of candidates, then select it, update labels of its neighbors and continue.\nWe can add that if needed in a future ticket.",
    "created_at": "2020-09-07T06:10:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121959",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:47" align="right">comment:47</div>

Thank you for your help.

To understand the fast algorithm, you need to understand that a slice is nothing else than a label. When creating a subslice of a slice from position p to position q, you place the vertices of the sub slice on positions p...p+I, and the remaining vertices of the original slice at positions p+I+1...q. So the vertices in the sub slice have a larger label than the other vertices of the original slice. The tricks are to associate a position with the current slice name, to maintain the head (left most vertex of a slice) of each slice, and give a name to each  newly created subslice.

To check the property on directed graphs, its more tricky, but I'm convinced it is correct. An alternative to check the validity is to modify the slow algorith. That is, instead of selecting a vertex with largest label, we identify all candidates (vertices with same largest label), and check that the next vertex in the given order is in this pool of candidates, then select it, update labels of its neighbors and continue.
We can add that if needed in a future ticket.



---

archive/issue_comments_121960.json:
```json
{
    "body": "Description changed:\n``````diff\n\n``````\n",
    "created_at": "2020-09-08T01:21:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121960",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff

``````




---

archive/issue_comments_121961.json:
```json
{
    "body": "Changed branch from **[public/graphs/11736_lex_bfs](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/11736_lex_bfs)** to **[`332fb8b`](https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26)**",
    "created_at": "2020-09-15T22:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11736#issuecomment-121961",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/graphs/11736_lex_bfs](https://github.com/sagemath/sagetrac-mirror/tree/public/graphs/11736_lex_bfs)** to **[`332fb8b`](https://github.com/sagemath/sagetrac-mirror/commit/332fb8bf3acb23d8cb1a376744665cd25c680c26)**



---

archive/issue_events_156107.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-09-15T22:00:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156107"
}
```



---

archive/issue_events_156108.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0192e3a95c399aa93b46738fda09763eec265cc5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-09-15T22:00:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11736",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11736#event-156108"
}
```
