# Issue 11622: Add some targets to the top-level Makefile

archive/issues_011450.json:
```json
{
    "body": "This perhaps just gets a meta-ticket to collect various additions (or changes), to be discussed and implemented on their own tickets.\n\nThere are a few things I would like to have a `make` target for, partially just for convenience (at the moment random choice / incomplete, random order):\n* `build-check`, perhaps also `all-check`, as an \"alias\" for\n\n```sh\nenv SAGE_CHECK=yes make build\n```\n* `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing\n* similar things for `doc` and `all`\n\n**Assignee:** @nexttime\n\n**CC:**  @kiwifb @jdemeyer @jhpalmieri\n\n**Keywords:** make upgrade documentation rebuild parallel sequential SAGE_CHECK SAGE_PARALLEL_SPKG_BUILD\n\n**Resolution:** invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/11622\n\n",
    "closed_at": "2021-09-02T18:48:47Z",
    "created_at": "2011-07-24T21:56:36Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Add some targets to the top-level Makefile",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11622",
    "user": "https://github.com/nexttime"
}
```
This perhaps just gets a meta-ticket to collect various additions (or changes), to be discussed and implemented on their own tickets.

There are a few things I would like to have a `make` target for, partially just for convenience (at the moment random choice / incomplete, random order):
* `build-check`, perhaps also `all-check`, as an "alias" for

```sh
env SAGE_CHECK=yes make build
```
* `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing
* similar things for `doc` and `all`

**Assignee:** @nexttime

**CC:**  @kiwifb @jdemeyer @jhpalmieri

**Keywords:** make upgrade documentation rebuild parallel sequential SAGE_CHECK SAGE_PARALLEL_SPKG_BUILD

**Resolution:** invalid

Issue created by migration from https://trac.sagemath.org/ticket/11622





---

archive/issue_comments_161931.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,7 +14,9 @@\n ```\n * `build-check-ignore` once we support `SAGE_CHECK=ignore` to (build and) run all test suites without treating failed tests as fatal errors (since e.g. the Python test suite fails on many systems)\n * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing\n-* `build-sequential` in case we one day default to a parallel build\n+* `build-sequential` in case we one day default to a parallel build \n+\n+  **Note:** #11959 now enables parallel spkg building by default, and adds a target `build-serial`.\n * similar things for `doc` (see below) and `all`\n * perhaps `library` as an alias for `./sage -b`\n * ...\n``````\n",
    "created_at": "2011-11-04T00:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161931",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,7 +14,9 @@
 ```
 * `build-check-ignore` once we support `SAGE_CHECK=ignore` to (build and) run all test suites without treating failed tests as fatal errors (since e.g. the Python test suite fails on many systems)
 * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing
-* `build-sequential` in case we one day default to a parallel build
+* `build-sequential` in case we one day default to a parallel build 
+
+  **Note:** #11959 now enables parallel spkg building by default, and adds a target `build-serial`.
 * similar things for `doc` (see below) and `all`
 * perhaps `library` as an alias for `./sage -b`
 * ...
``````




---

archive/issue_comments_161932.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -58,7 +58,10 @@\n     time make -f standard/deps $1\n fi\n ```\n- So we do no longer clear `MAKEFLAGS`, but not using `$MAKE` there remains. (And this won't prevent a parallel build invoked through `-j` without a number of jobs.) Note that `MAKE` will always be set at that point, unless some user tries to call `spkg/install` directly (or doesn't use GNU `make`), which is an error condition by itself, to be catched separately.\n+ So we do no longer clear `MAKEFLAGS`, but not using `$MAKE` there remains. (And this won't prevent a parallel build invoked through `-j` without a number of jobs.) Note that `MAKE` will always be set at that point, unless some user tries to call `spkg/install` directly (or doesn't use GNU `make`), which is an error condition by itself, to be catched separately. \n+\n+\n+   **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.\n \n \n * The sequence top-level Makefile (`make`) -> `spkg/install` (shell script) -> `spkg/standard/deps`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `spkg/standard/deps` (ill name for a Makefile that isn't included by another one) itself. \n``````\n",
    "created_at": "2011-11-04T00:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161932",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -58,7 +58,10 @@
     time make -f standard/deps $1
 fi
 ```
- So we do no longer clear `MAKEFLAGS`, but not using `$MAKE` there remains. (And this won't prevent a parallel build invoked through `-j` without a number of jobs.) Note that `MAKE` will always be set at that point, unless some user tries to call `spkg/install` directly (or doesn't use GNU `make`), which is an error condition by itself, to be catched separately.
+ So we do no longer clear `MAKEFLAGS`, but not using `$MAKE` there remains. (And this won't prevent a parallel build invoked through `-j` without a number of jobs.) Note that `MAKE` will always be set at that point, unless some user tries to call `spkg/install` directly (or doesn't use GNU `make`), which is an error condition by itself, to be catched separately. 
+
+
+   **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.
 
 
 * The sequence top-level Makefile (`make`) -> `spkg/install` (shell script) -> `spkg/standard/deps`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `spkg/standard/deps` (ill name for a Makefile that isn't included by another one) itself. 
``````




---

archive/issue_comments_161933.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere are some changes to the top-level `Makefile` at #11969, needs_review.",
    "created_at": "2011-11-04T09:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161933",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
There are some changes to the top-level `Makefile` at #11969, needs_review.



---

archive/issue_events_036091.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36091"
}
```



---

archive/issue_events_036092.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36092"
}
```



---

archive/issue_events_036093.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36093"
}
```



---

archive/issue_events_036094.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36094"
}
```



---

archive/issue_events_036095.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36095"
}
```



---

archive/issue_events_036096.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36096"
}
```



---

archive/issue_events_036097.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36097"
}
```



---

archive/issue_events_036098.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-16T08:26:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36098"
}
```



---

archive/issue_events_036099.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-16T08:26:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36099"
}
```



---

archive/issue_comments_161934.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,12 +1,6 @@\n This perhaps just gets a meta-ticket to collect various additions (or changes), to be discussed and implemented on their own tickets.\n \n There are a few things I would like to have a `make` target for, partially just for convenience (at the moment random choice / incomplete, random order):\n-* `rebuild` as a short-cut (or, more precisely, the user interface) to the currently (intentionally) undocumented\n-\n-```sh\n-env SAGE_UPGRADING=yes make build\n-```\n-   which builds new / updated spkgs copied to `spkg/standard/` and also forces the rebuild of all dependent packages.\n * `build-check`, perhaps also `all-check`, as an \"alias\" for\n \n ```sh\n``````\n",
    "created_at": "2015-09-16T08:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161934",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,12 +1,6 @@
 This perhaps just gets a meta-ticket to collect various additions (or changes), to be discussed and implemented on their own tickets.
 
 There are a few things I would like to have a `make` target for, partially just for convenience (at the moment random choice / incomplete, random order):
-* `rebuild` as a short-cut (or, more precisely, the user interface) to the currently (intentionally) undocumented
-
-```sh
-env SAGE_UPGRADING=yes make build
-```
-   which builds new / updated spkgs copied to `spkg/standard/` and also forces the rebuild of all dependent packages.
 * `build-check`, perhaps also `all-check`, as an "alias" for
 
 ```sh
``````




---

archive/issue_comments_161935.json:
```json
{
    "body": "Replying to [ticket:11622 leif]:\n>  * `build-check-ignore` once we support `SAGE_CHECK=ignore` to (build and) run all test suites without treating failed tests as fatal errors (since e.g. the Python test suite fails on many systems)\n \nWe don't have `SAGE_CHECK=ignore` yet, so this isn't applicable.\n\n>  * `build-sequential` in case we one day default to a parallel build\n \nWell, we don't build in parallel by default.\n\n>  * perhaps `library` as an alias for `./sage -b`\n \nVery bad idea. We shouldn't encourage `./sage -b`, just run `make` or `make build` or `make sagelib` if needed.",
    "created_at": "2015-09-16T08:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161935",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:11622 leif]:
>  * `build-check-ignore` once we support `SAGE_CHECK=ignore` to (build and) run all test suites without treating failed tests as fatal errors (since e.g. the Python test suite fails on many systems)
 
We don't have `SAGE_CHECK=ignore` yet, so this isn't applicable.

>  * `build-sequential` in case we one day default to a parallel build
 
Well, we don't build in parallel by default.

>  * perhaps `library` as an alias for `./sage -b`
 
Very bad idea. We shouldn't encourage `./sage -b`, just run `make` or `make build` or `make sagelib` if needed.



---

archive/issue_comments_161936.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,18 +6,9 @@\n ```sh\n env SAGE_CHECK=yes make build\n ```\n-* `build-check-ignore` once we support `SAGE_CHECK=ignore` to (build and) run all test suites without treating failed tests as fatal errors (since e.g. the Python test suite fails on many systems)\n * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing\n-* `build-sequential` in case we one day default to a parallel build \n-\n-  **Note:** #11959 now enables parallel spkg building by default, and adds a target `build-serial`.\n+* `build-sequential` in case we one day default to a parallel build\n * similar things for `doc` (see below) and `all`\n-* perhaps `library` as an alias for `./sage -b`\n-* ...\n-\n-I could imagine to also have\n-* different targets to build the documentation sequentially or in parallel (cf. #6495),\n-* ...\n \n **Please add further suggestions (and the tickets implementing them).**\n \n``````\n",
    "created_at": "2015-09-16T08:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161936",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,18 +6,9 @@
 ```sh
 env SAGE_CHECK=yes make build
 ```
-* `build-check-ignore` once we support `SAGE_CHECK=ignore` to (build and) run all test suites without treating failed tests as fatal errors (since e.g. the Python test suite fails on many systems)
 * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing
-* `build-sequential` in case we one day default to a parallel build 
-
-  **Note:** #11959 now enables parallel spkg building by default, and adds a target `build-serial`.
+* `build-sequential` in case we one day default to a parallel build
 * similar things for `doc` (see below) and `all`
-* perhaps `library` as an alias for `./sage -b`
-* ...
-
-I could imagine to also have
-* different targets to build the documentation sequentially or in parallel (cf. #6495),
-* ...
 
 **Please add further suggestions (and the tickets implementing them).**
 
``````




---

archive/issue_comments_161937.json:
```json
{
    "body": "Replying to [ticket:11622 leif]:\n>  It's perhaps discussable whether we should do that in *all* test receipts\n\nIt is done in all test targets.",
    "created_at": "2015-09-16T08:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161937",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:11622 leif]:
>  It's perhaps discussable whether we should do that in *all* test receipts

It is done in all test targets.



---

archive/issue_comments_161938.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,9 +15,6 @@\n ---\n \n Related:\n-\n-* As of Sage 4.7.1.rc0, running `./sage -b` before running tests is currently not performed consistently. It's perhaps discussable whether we should do that in *all* test receipts or none of them, or provide *separate* targets which do that (which is a trivial task except for the choice of names).\n-\n \n * The current behaviour of `devel/sage/setup.py` w.r.t. to parallel building is IMHO undesirable or sub-optimal:\n   * It uses the number of hardware threads even if `MAKE` isn't set (*of course<sup>TM</sup>* regardless of the system load). (If `MAKE` is set to e.g. `make -j`, which means an \"unlimited\" number of jobs, it uses twice the number of hardware threads.) \n``````\n",
    "created_at": "2015-09-16T08:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161938",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,9 +15,6 @@
 ---
 
 Related:
-
-* As of Sage 4.7.1.rc0, running `./sage -b` before running tests is currently not performed consistently. It's perhaps discussable whether we should do that in *all* test receipts or none of them, or provide *separate* targets which do that (which is a trivial task except for the choice of names).
-
 
 * The current behaviour of `devel/sage/setup.py` w.r.t. to parallel building is IMHO undesirable or sub-optimal:
   * It uses the number of hardware threads even if `MAKE` isn't set (*of course<sup>TM</sup>* regardless of the system load). (If `MAKE` is set to e.g. `make -j`, which means an "unlimited" number of jobs, it uses twice the number of hardware threads.) 
``````




---

archive/issue_comments_161939.json:
```json
{
    "body": "Replying to [ticket:11622 leif]:\n>  * The current behaviour of `devel/sage/setup.py` w.r.t. to parallel building is IMHO undesirable or sub-optimal:\n>    * It uses the number of hardware threads even if `MAKE` isn't set (*of course<sup>TM</sup>* regardless of the system load). (If `MAKE` is set to e.g. `make -j`, which means an \"unlimited\" number of jobs, it uses twice the number of hardware threads.) \n\n\n>      One can of course circumvent that by setting `MAKE` to `make -j1`, but that's IMHO kind of odd.\n\n>    * It complains about an *\"impossibly large number of threads\"* if the number of jobs (`-j...`) found in `$MAKE` exceeds twice the number of hardware threads, where the number of hardware threads is equal to the number of cores on processors without what Intel calls Hyper-Threading (HT), then falling back to (at most) the number of hardware threads.\n\nNeither of this is still true.",
    "created_at": "2015-09-16T08:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161939",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:11622 leif]:
>  * The current behaviour of `devel/sage/setup.py` w.r.t. to parallel building is IMHO undesirable or sub-optimal:
>    * It uses the number of hardware threads even if `MAKE` isn't set (*of course<sup>TM</sup>* regardless of the system load). (If `MAKE` is set to e.g. `make -j`, which means an "unlimited" number of jobs, it uses twice the number of hardware threads.) 


>      One can of course circumvent that by setting `MAKE` to `make -j1`, but that's IMHO kind of odd.

>    * It complains about an *"impossibly large number of threads"* if the number of jobs (`-j...`) found in `$MAKE` exceeds twice the number of hardware threads, where the number of hardware threads is equal to the number of cores on processors without what Intel calls Hyper-Threading (HT), then falling back to (at most) the number of hardware threads.

Neither of this is still true.



---

archive/issue_comments_161940.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -15,13 +15,6 @@\n ---\n \n Related:\n-\n-* The current behaviour of `devel/sage/setup.py` w.r.t. to parallel building is IMHO undesirable or sub-optimal:\n-  * It uses the number of hardware threads even if `MAKE` isn't set (*of course<sup>TM</sup>* regardless of the system load). (If `MAKE` is set to e.g. `make -j`, which means an \"unlimited\" number of jobs, it uses twice the number of hardware threads.) \n-\n-    One can of course circumvent that by setting `MAKE` to `make -j1`, but that's IMHO kind of odd.\n-  * It complains about an *\"impossibly large number of threads\"* if the number of jobs (`-j...`) found in `$MAKE` exceeds twice the number of hardware threads, where the number of hardware threads is equal to the number of cores on processors without what Intel calls Hyper-Threading (HT), then falling back to (at most) the number of hardware threads.\n-\n \n * We should stop unsetting `MAKEFLAGS` and setting `MAKE` to `make` whenever `SAGE_PARALLEL_SPKG_BUILD!=yes` in `spkg/install`, which is simply wrong for a couple of reasons:\n   * It invalidates e.g. `MAKE=gmake`.\n``````\n",
    "created_at": "2015-09-16T08:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161940",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -15,13 +15,6 @@
 ---
 
 Related:
-
-* The current behaviour of `devel/sage/setup.py` w.r.t. to parallel building is IMHO undesirable or sub-optimal:
-  * It uses the number of hardware threads even if `MAKE` isn't set (*of course<sup>TM</sup>* regardless of the system load). (If `MAKE` is set to e.g. `make -j`, which means an "unlimited" number of jobs, it uses twice the number of hardware threads.) 
-
-    One can of course circumvent that by setting `MAKE` to `make -j1`, but that's IMHO kind of odd.
-  * It complains about an *"impossibly large number of threads"* if the number of jobs (`-j...`) found in `$MAKE` exceeds twice the number of hardware threads, where the number of hardware threads is equal to the number of cores on processors without what Intel calls Hyper-Threading (HT), then falling back to (at most) the number of hardware threads.
-
 
 * We should stop unsetting `MAKEFLAGS` and setting `MAKE` to `make` whenever `SAGE_PARALLEL_SPKG_BUILD!=yes` in `spkg/install`, which is simply wrong for a couple of reasons:
   * It invalidates e.g. `MAKE=gmake`.
``````




---

archive/issue_comments_161941.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -39,7 +39,7 @@\n    **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.\n \n \n-* The sequence top-level Makefile (`make`) -> `spkg/install` (shell script) -> `spkg/standard/deps`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `spkg/standard/deps` (ill name for a Makefile that isn't included by another one) itself. \n+* The sequence top-level Makefile (`make`) -> `build/make/install` (shell script) -> `build/make/Makefile`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `build/make/Makefile` itself. \n \n   Changing this is of course a bigger task. (We have to keep the two-stage make procedure, i.e. two separate Makefiles, to support upgrading at least, which I think isn't bad since it is more modular.)\n \n``````\n",
    "created_at": "2015-09-16T08:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161941",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -39,7 +39,7 @@
    **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.
 
 
-* The sequence top-level Makefile (`make`) -> `spkg/install` (shell script) -> `spkg/standard/deps`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `spkg/standard/deps` (ill name for a Makefile that isn't included by another one) itself. 
+* The sequence top-level Makefile (`make`) -> `build/make/install` (shell script) -> `build/make/Makefile`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `build/make/Makefile` itself. 
 
   Changing this is of course a bigger task. (We have to keep the two-stage make procedure, i.e. two separate Makefiles, to support upgrading at least, which I think isn't bad since it is more modular.)
 
``````




---

archive/issue_comments_161942.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -38,12 +38,6 @@\n \n    **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.\n \n-\n-* The sequence top-level Makefile (`make`) -> `build/make/install` (shell script) -> `build/make/Makefile`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `build/make/Makefile` itself. \n-\n-  Changing this is of course a bigger task. (We have to keep the two-stage make procedure, i.e. two separate Makefiles, to support upgrading at least, which I think isn't bad since it is more modular.)\n-\n ---\n \n In case we disagree or have contrary opinions on / suggestions for some changes or in design, we can move the discussion of *individual aspects* to `sage-devel` (or `sage-release` :-) ) threads, but we IMHO shouldn't move the *whole* discussion there. There'll certainly be follow-up or \"real\" (non-meta) tickets anyway, so it should be possible to not mix up different aspects in a single thread.\n-\n``````\n",
    "created_at": "2015-09-16T08:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161942",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -38,12 +38,6 @@
 
    **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.
 
-
-* The sequence top-level Makefile (`make`) -> `build/make/install` (shell script) -> `build/make/Makefile`, another Makefile run by a *different* `make` instance is IMHO bad and not necessary anyway, since it is possible to set all environment (or `make`) variables in `build/make/Makefile` itself. 
-
-  Changing this is of course a bigger task. (We have to keep the two-stage make procedure, i.e. two separate Makefiles, to support upgrading at least, which I think isn't bad since it is more modular.)
-
 ---
 
 In case we disagree or have contrary opinions on / suggestions for some changes or in design, we can move the discussion of *individual aspects* to `sage-devel` (or `sage-release` :-) ) threads, but we IMHO shouldn't move the *whole* discussion there. There'll certainly be follow-up or "real" (non-meta) tickets anyway, so it should be possible to not mix up different aspects in a single thread.
-
``````




---

archive/issue_comments_161943.json:
```json
{
    "body": "Replying to [ticket:11622 leif]:\n> it is possible to set all environment variables in `build/make/Makefile` itself.\n\nI don't think so (or at least, I don't know how to do it). In any case, I don't see the point of *repeating* all environment variables in `build/make/Makefile`, what's wrong with keeping the use of `sage-env`?",
    "created_at": "2015-09-16T08:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161943",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:11622 leif]:
> it is possible to set all environment variables in `build/make/Makefile` itself.

I don't think so (or at least, I don't know how to do it). In any case, I don't see the point of *repeating* all environment variables in `build/make/Makefile`, what's wrong with keeping the use of `sage-env`?



---

archive/issue_events_036100.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "rename": {
        "from": "Add some targets to the top-level Makefile (and other make-related issues)",
        "to": "Add some targets to the top-level Makefile"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36100"
}
```



---

archive/issue_comments_161944.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,35 +9,3 @@\n * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing\n * `build-sequential` in case we one day default to a parallel build\n * similar things for `doc` (see below) and `all`\n-\n-**Please add further suggestions (and the tickets implementing them).**\n-\n----\n-\n-Related:\n-\n-* We should stop unsetting `MAKEFLAGS` and setting `MAKE` to `make` whenever `SAGE_PARALLEL_SPKG_BUILD!=yes` in `spkg/install`, which is simply wrong for a couple of reasons:\n-  * It invalidates e.g. `MAKE=gmake`.\n-  * It clears all flags passed to `make` on the command line as well as those eventually added in `MAKE` (or to `MAKEFLAGS`), e.g. `-d`, `-k` (`--keep-going`), and even `-n` (`--dry-run`) and `-q`. \n-\n-\n- It should instead (if at all) just add `-j1` to `MAKE` if `SAGE_PARALLEL_SPKG_BUILD!=yes`. \n-\n-\n- Oh, just noticed this has meanwhile slightly changed (but don't want to rewrite all the above):\n-\n-```sh\n-if [ \"$SAGE_PARALLEL_SPKG_BUILD\" = \"yes\" ] && [ -n \"$MAKE\" ]; then\n-    time $MAKE -f standard/deps $1\n-else\n-    time make -f standard/deps $1\n-fi\n-```\n- So we do no longer clear `MAKEFLAGS`, but not using `$MAKE` there remains. (And this won't prevent a parallel build invoked through `-j` without a number of jobs.) Note that `MAKE` will always be set at that point, unless some user tries to call `spkg/install` directly (or doesn't use GNU `make`), which is an error condition by itself, to be catched separately. \n-\n-\n-   **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.\n-\n----\n-\n-In case we disagree or have contrary opinions on / suggestions for some changes or in design, we can move the discussion of *individual aspects* to `sage-devel` (or `sage-release` :-) ) threads, but we IMHO shouldn't move the *whole* discussion there. There'll certainly be follow-up or \"real\" (non-meta) tickets anyway, so it should be possible to not mix up different aspects in a single thread.\n``````\n",
    "created_at": "2015-09-16T08:41:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161944",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,35 +9,3 @@
 * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing
 * `build-sequential` in case we one day default to a parallel build
 * similar things for `doc` (see below) and `all`
-
-**Please add further suggestions (and the tickets implementing them).**
-
----
-
-Related:
-
-* We should stop unsetting `MAKEFLAGS` and setting `MAKE` to `make` whenever `SAGE_PARALLEL_SPKG_BUILD!=yes` in `spkg/install`, which is simply wrong for a couple of reasons:
-  * It invalidates e.g. `MAKE=gmake`.
-  * It clears all flags passed to `make` on the command line as well as those eventually added in `MAKE` (or to `MAKEFLAGS`), e.g. `-d`, `-k` (`--keep-going`), and even `-n` (`--dry-run`) and `-q`. 
-
-
- It should instead (if at all) just add `-j1` to `MAKE` if `SAGE_PARALLEL_SPKG_BUILD!=yes`. 
-
-
- Oh, just noticed this has meanwhile slightly changed (but don't want to rewrite all the above):
-
-```sh
-if [ "$SAGE_PARALLEL_SPKG_BUILD" = "yes" ] && [ -n "$MAKE" ]; then
-    time $MAKE -f standard/deps $1
-else
-    time make -f standard/deps $1
-fi
-```
- So we do no longer clear `MAKEFLAGS`, but not using `$MAKE` there remains. (And this won't prevent a parallel build invoked through `-j` without a number of jobs.) Note that `MAKE` will always be set at that point, unless some user tries to call `spkg/install` directly (or doesn't use GNU `make`), which is an error condition by itself, to be catched separately. 
-
-
-   **Note:** This is meanwhile also fixed by #11959, i.e. `${MAKE:-make}` is now consistently used.
-
----
-
-In case we disagree or have contrary opinions on / suggestions for some changes or in design, we can move the discussion of *individual aspects* to `sage-devel` (or `sage-release` :-) ) threads, but we IMHO shouldn't move the *whole* discussion there. There'll certainly be follow-up or "real" (non-meta) tickets anyway, so it should be possible to not mix up different aspects in a single thread.
``````




---

archive/issue_comments_161945.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n ```\n * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing\n * `build-sequential` in case we one day default to a parallel build\n-* similar things for `doc` (see below) and `all`\n+* similar things for `doc` and `all`\n``````\n",
    "created_at": "2015-09-16T08:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161945",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 ```
 * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing
 * `build-sequential` in case we one day default to a parallel build
-* similar things for `doc` (see below) and `all`
+* similar things for `doc` and `all`
``````




---

archive/issue_comments_161946.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,5 +7,4 @@\n env SAGE_CHECK=yes make build\n ```\n * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing\n-* `build-sequential` in case we one day default to a parallel build\n * similar things for `doc` and `all`\n``````\n",
    "created_at": "2015-09-16T08:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161946",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,5 +7,4 @@
 env SAGE_CHECK=yes make build
 ```
 * `build-parallel` or something like that to build Sage in parallel with a default number of jobs (preferably the number of cores or hardware threads), or at least (currently just) setting `SAGE_PARALLEL_SPKG_BUILD=yes` and doing the usual thing
-* `build-sequential` in case we one day default to a parallel build
 * similar things for `doc` and `all`
``````




---

archive/issue_comments_161947.json:
```json
{
    "body": "Replying to [ticket:11622 leif]:\n>  * `build-sequential` in case we one day default to a parallel build\n \nWe still don't do that by default.",
    "created_at": "2015-09-16T08:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161947",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:11622 leif]:
>  * `build-sequential` in case we one day default to a parallel build
 
We still don't do that by default.



---

archive/issue_comments_161948.json:
```json
{
    "body": "<a id='comment:17'></a>\nI propose to use `pbuild` and `pall` as target names, by analogy to `ptest(long)`.\n\nI don't see the need for a target `pdoc` (I never need to run `make doc`, I just run `make` which is mostly the same anyway).",
    "created_at": "2015-09-16T08:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161948",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
I propose to use `pbuild` and `pall` as target names, by analogy to `ptest(long)`.

I don't see the need for a target `pdoc` (I never need to run `make doc`, I just run `make` which is mostly the same anyway).



---

archive/issue_events_036101.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-26T19:08:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36101"
}
```



---

archive/issue_events_036102.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-26T19:08:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36102"
}
```



---

archive/issue_comments_161949.json:
```json
{
    "body": "<a id='comment:18'></a>\nOutdated, should close",
    "created_at": "2021-08-26T19:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161949",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Outdated, should close



---

archive/issue_comments_161950.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2021-08-26T19:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161950",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_161951.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-08-26T21:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161951",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_161952.json:
```json
{
    "body": "<a id='comment:19'></a>\nThere might be something with some validity here, but we can always open a new ticket with a more clear focus.",
    "created_at": "2021-08-26T21:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161952",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
There might be something with some validity here, but we can always open a new ticket with a more clear focus.



---

archive/issue_events_036103.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-02T18:48:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11622#event-36103"
}
```



---

archive/issue_comments_161953.json:
```json
{
    "body": "**Resolution:** invalid",
    "created_at": "2021-09-02T18:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11622",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11622#issuecomment-161953",
    "user": "https://github.com/mkoeppe"
}
```

**Resolution:** invalid
