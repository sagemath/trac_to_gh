# Issue 11917: Memory leaks with LP Solvers

archive/issues_011745.json:
```json
{
    "body": "As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.\n\nThis patch solves it !\n\nNathann\n\nReported by Peter Mueller on [sage-support](http://groups.google.com/forum/?#!topic/sage-support/QZZfhz4Kogs).\n\n---\n\nApply: [attachment:trac_11917.patch]\n\n(Based on Sage 4.7.2.alpha3 / #11588.)\n\n\nAssignee: tbd\n\nResolution: fixed\n\nDependencies: #11588\n\nAuthor: Nathann Cohen\n\nReviewer: Peter M\u00fcller, Paul Zimmermann\n\nMerged: sage-4.8.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/11917\n\n",
    "closed_at": "2011-10-22T20:54:28Z",
    "created_at": "2011-10-12T14:17:17Z",
    "labels": [
        "component: linear programming",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Memory leaks with LP Solvers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11917",
    "user": "https://github.com/nathanncohen"
}
```
As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.

This patch solves it !

Nathann

Reported by Peter Mueller on [sage-support](http://groups.google.com/forum/?#!topic/sage-support/QZZfhz4Kogs).

---

Apply: [attachment:trac_11917.patch]

(Based on Sage 4.7.2.alpha3 / #11588.)


Assignee: tbd

Resolution: fixed

Dependencies: #11588

Author: Nathann Cohen

Reviewer: Peter MÃ¼ller, Paul Zimmermann

Merged: sage-4.8.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/11917





---

archive/issue_comments_141137.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-10-12T14:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141137",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_141138.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [trac_11917.patch](tarball://root/attachments/some-uuid/ticket11917/trac_11917.patch) by @nathanncohen created at 2011-10-12 14:19:03",
    "created_at": "2011-10-12T14:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141138",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>Attachment [trac_11917.patch](tarball://root/attachments/some-uuid/ticket11917/trac_11917.patch) by @nathanncohen created at 2011-10-12 14:19:03



---

archive/issue_comments_141139.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -6,6 +6,8 @@\n \n Reported by Peter Mueller on :\n https://groups.google.com/forum/?hl=fr#!topic/sage-support/QZZfhz4Kogs\n+\n+Apply : [attachment:trac_11917.patch]\n \n Author: Nathann Cohen\n \n```\n",
    "created_at": "2011-10-12T14:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141139",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
```diff
--- 
+++ 
@@ -6,6 +6,8 @@
 
 Reported by Peter Mueller on :
 https://groups.google.com/forum/?hl=fr#!topic/sage-support/QZZfhz4Kogs
+
+Apply : [attachment:trac_11917.patch]
 
 Author: Nathann Cohen
 
```




---

archive/issue_comments_141140.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to linear programming.",
    "created_at": "2011-10-12T16:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141140",
    "user": "https://github.com/nathanncohen"
}
```

Changing component from PLEASE CHANGE to linear programming.



---

archive/issue_comments_141141.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2011-10-12T18:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141141",
    "user": "https://github.com/zimmermann6"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_141142.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-10-12T18:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141142",
    "user": "https://github.com/zimmermann6"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_141143.json:
```json
{
    "body": "<a id='comment:4'></a>the patch fails to apply to 4.7.1:\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nLoading Sage library. Current Mercurial branch is: 11917\nsage: hg_sage.import_patch(\"/tmp/trac_11917.patch\")\ncd \"/usr/local/sage-4.7.1/sage/devel/sage\" && hg status\ncd \"/usr/local/sage-4.7.1/sage/devel/sage\" && hg status\ncd \"/usr/local/sage-4.7.1/sage/devel/sage\" && hg import   \"/tmp/trac_11917.patch\"\napplying /tmp/trac_11917.patch\npatching file sage/numerical/backends/coin_backend.pxd\nHunk #1 FAILED at 97\n1 out of 1 hunks FAILED -- saving rejects to file sage/numerical/backends/coin_backend.pxd.rej\npatching file sage/numerical/backends/coin_backend.pyx\nHunk #3 FAILED at 986\n1 out of 3 hunks FAILED -- saving rejects to file sage/numerical/backends/coin_backend.pyx.rej\nabort: patch failed to apply\n```\nPaul",
    "created_at": "2011-10-12T18:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141143",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:4'></a>the patch fails to apply to 4.7.1:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Sage library. Current Mercurial branch is: 11917
sage: hg_sage.import_patch("/tmp/trac_11917.patch")
cd "/usr/local/sage-4.7.1/sage/devel/sage" && hg status
cd "/usr/local/sage-4.7.1/sage/devel/sage" && hg status
cd "/usr/local/sage-4.7.1/sage/devel/sage" && hg import   "/tmp/trac_11917.patch"
applying /tmp/trac_11917.patch
patching file sage/numerical/backends/coin_backend.pxd
Hunk #1 FAILED at 97
1 out of 1 hunks FAILED -- saving rejects to file sage/numerical/backends/coin_backend.pxd.rej
patching file sage/numerical/backends/coin_backend.pyx
Hunk #3 FAILED at 986
1 out of 3 hunks FAILED -- saving rejects to file sage/numerical/backends/coin_backend.pyx.rej
abort: patch failed to apply
```
Paul



---

archive/issue_comments_141144.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 zimmerma]:\n> the patch fails to apply to 4.7.1:\n\n\nThat's most probably due to #11588, merged into Sage 4.7.2.alpha3.",
    "created_at": "2011-10-12T19:59:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141144",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>Replying to [comment:4 zimmerma]:
> the patch fails to apply to 4.7.1:


That's most probably due to #11588, merged into Sage 4.7.2.alpha3.



---

archive/issue_comments_141145.json:
```json
{
    "body": "<a id='comment:6'></a>> That's most probably due to #11588, merged into Sage 4.7.2.alpha3.\n\n\nif so it should be clearly indicated to which version the patch applies.\n\nPaul",
    "created_at": "2011-10-12T20:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141145",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:6'></a>> That's most probably due to #11588, merged into Sage 4.7.2.alpha3.


if so it should be clearly indicated to which version the patch applies.

Paul



---

archive/issue_comments_141146.json:
```json
{
    "body": "<a id='comment:7'></a>Patch also applies clean to Sage 4.7.2.alpha4.\n\nIMHO all patches should in general be based on the latest *devel* release (or at least still apply to it); an attachment comment stating on which version a patch is based is of course not bad, especially as time goes by.\n\nI really don't understand why the patchbot still uses 4.7.1; as such, it is almost useless.  Worse, it reports failures for patches that apply (and work) well.  (And often hangs such that the HTTP connections for trac pages are kept open...)",
    "created_at": "2011-10-12T20:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141146",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>Patch also applies clean to Sage 4.7.2.alpha4.

IMHO all patches should in general be based on the latest *devel* release (or at least still apply to it); an attachment comment stating on which version a patch is based is of course not bad, especially as time goes by.

I really don't understand why the patchbot still uses 4.7.1; as such, it is almost useless.  Worse, it reports failures for patches that apply (and work) well.  (And often hangs such that the HTTP connections for trac pages are kept open...)



---

archive/issue_comments_141147.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,16 @@\n+As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.\n+\n+This patch solves it !\n+\n+Nathann\n+\n+Reported by Peter Mueller on [sage-support](http://groups.google.com/forum/?hl=fr#!topic/sage-support/QZZfhz4Kogs).\n+\n+---\n+\n+Apply: [attachment:trac_11917.patch]\n+\n+(Based on Sage 4.7.2.alpha3 / #11588.)\n \n \n Author: Nathann Cohen\n```\n",
    "created_at": "2011-10-12T20:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141147",
    "user": "https://github.com/nexttime"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,16 @@
+As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.
+
+This patch solves it !
+
+Nathann
+
+Reported by Peter Mueller on [sage-support](http://groups.google.com/forum/?hl=fr#!topic/sage-support/QZZfhz4Kogs).
+
+---
+
+Apply: [attachment:trac_11917.patch]
+
+(Based on Sage 4.7.2.alpha3 / #11588.)
 
 
 Author: Nathann Cohen
```




---

archive/issue_comments_141148.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-10-12T20:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141148",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_141149.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,16 @@\n+As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.\n+\n+This patch solves it !\n+\n+Nathann\n+\n+Reported by Peter Mueller on [sage-support](http://groups.google.com/forum/?#!topic/sage-support/QZZfhz4Kogs).\n+\n+---\n+\n+Apply: [attachment:trac_11917.patch]\n+\n+(Based on Sage 4.7.2.alpha3 / #11588.)\n \n \n Author: Nathann Cohen\n```\n",
    "created_at": "2011-10-12T21:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141149",
    "user": "https://github.com/nexttime"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,16 @@
+As reported on sage-support, there is(was) something dead wrong with the LP classes : they did not free some of the memory they used.
+
+This patch solves it !
+
+Nathann
+
+Reported by Peter Mueller on [sage-support](http://groups.google.com/forum/?#!topic/sage-support/QZZfhz4Kogs).
+
+---
+
+Apply: [attachment:trac_11917.patch]
+
+(Based on Sage 4.7.2.alpha3 / #11588.)
 
 
 Author: Nathann Cohen
```




---

archive/issue_comments_141150.json:
```json
{
    "body": "<a id='comment:9'></a>Passes all (long) tests in `sage/numerical/`, and Peter Mueller's example (at first glance) doesn't eat up memory as it did before.\n\nHaven't looked at the code though.",
    "created_at": "2011-10-12T21:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141150",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>Passes all (long) tests in `sage/numerical/`, and Peter Mueller's example (at first glance) doesn't eat up memory as it did before.

Haven't looked at the code though.



---

archive/issue_comments_141151.json:
```json
{
    "body": "<a id='comment:10'></a>The patch installed fine in sage-4.7.2alpha, and passed all the tests in sage/numerical/\n\nI ran my original program again which goes through thousands of different small ilp problems. The memory usage was basically constant, so the memory leak apparently is fixed.\n\nAs this patch just fixed a bug and didn't add new features, I guess it is save to close the ticket.\n\n- Peter Mueller",
    "created_at": "2011-10-17T13:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141151",
    "user": "https://github.com/ypfmde"
}
```

<a id='comment:10'></a>The patch installed fine in sage-4.7.2alpha, and passed all the tests in sage/numerical/

I ran my original program again which goes through thousands of different small ilp problems. The memory usage was basically constant, so the memory leak apparently is fixed.

As this patch just fixed a bug and didn't add new features, I guess it is save to close the ticket.

- Peter Mueller



---

archive/issue_comments_141152.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-10-17T13:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141152",
    "user": "https://github.com/ypfmde"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_141153.json:
```json
{
    "body": "<a id='comment:11'></a>Thaaaaaaaaaaaaaaaaaanks ! `:-)`\n\nNathann",
    "created_at": "2011-10-17T13:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141153",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:11'></a>Thaaaaaaaaaaaaaaaaaanks ! `:-)`

Nathann



---

archive/issue_comments_141154.json:
```json
{
    "body": "<a id='comment:13'></a>why did the milestone change? Is 4.7.2 already out? I don't see it on sagemath.org.\n\nPaul",
    "created_at": "2011-10-17T13:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141154",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:13'></a>why did the milestone change? Is 4.7.2 already out? I don't see it on sagemath.org.

Paul



---

archive/issue_comments_141155.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 zimmerma]:\n> Is 4.7.2 already out?\n\nNot yet, but it should be *almost* out.  A release candidate is in preparation.",
    "created_at": "2011-10-17T13:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141155",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:13 zimmerma]:
> Is 4.7.2 already out?

Not yet, but it should be *almost* out.  A release candidate is in preparation.



---

archive/issue_comments_141156.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 jdemeyer]:\n> Replying to [comment:13 zimmerma]:\n> > Is 4.7.2 already out?\n\n> Not yet, but it should be *almost* out.  A release candidate is in preparation.\n\nSo a small patch only fixing a memory leak isn't worth getting into the final?",
    "created_at": "2011-10-18T05:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141156",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>Replying to [comment:14 jdemeyer]:
> Replying to [comment:13 zimmerma]:
> > Is 4.7.2 already out?

> Not yet, but it should be *almost* out.  A release candidate is in preparation.

So a small patch only fixing a memory leak isn't worth getting into the final?



---

archive/issue_comments_141157.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-10-22T20:54:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141157",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_031508.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-22T20:54:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11917#event-31508"
}
```



---

archive/issue_comments_141158.json:
```json
{
    "body": "<a id='comment:17'></a>I wonder why you already work on sage-4.7.3, since 4.7.2 is not yet available (even in source\nform) on sagemath.org...\n\nPaul",
    "created_at": "2011-10-22T20:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141158",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:17'></a>I wonder why you already work on sage-4.7.3, since 4.7.2 is not yet available (even in source
form) on sagemath.org...

Paul



---

archive/issue_comments_141159.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11917#issuecomment-141159",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_events_031509.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:19:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11917",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11917#event-31509"
}
```
