# Issue 11882: update readline to 6.2

archive/issues_011710.json:
```json
{
    "body": "readline 6.2 is available.  Upgrade Sage to use this version.  This also includes [a fix](https://trac.macports.org/browser/trunk/dports/devel/readline/files/patch-shobj-conf.diff) so it builds on OS X 10.7 Lion.\n\nThe home base for this ticket is the Lion ticket #11881.\n\n**Apply** [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)\n\n**CC:**  @kini @nexttime @nathanncohen @jdemeyer gostrc alexander dreyer\n\n**Keywords:** readline upgrade spkg lion Darwin 11 MacOS X 10.7\n\n**Author:** John Palmieri\n\n**Reviewer:** Leif Leonhardy, Alexander Dreyer\n\n**Merged:** sage-4.8.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/11882\n\n",
    "closed_at": "2011-10-16T16:11:24Z",
    "created_at": "2011-09-30T17:06:41Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "update readline to 6.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11882",
    "user": "https://github.com/jhpalmieri"
}
```
readline 6.2 is available.  Upgrade Sage to use this version.  This also includes [a fix](https://trac.macports.org/browser/trunk/dports/devel/readline/files/patch-shobj-conf.diff) so it builds on OS X 10.7 Lion.

The home base for this ticket is the Lion ticket #11881.

**Apply** [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)

**CC:**  @kini @nexttime @nathanncohen @jdemeyer gostrc alexander dreyer

**Keywords:** readline upgrade spkg lion Darwin 11 MacOS X 10.7

**Author:** John Palmieri

**Reviewer:** Leif Leonhardy, Alexander Dreyer

**Merged:** sage-4.8.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/11882





---

archive/issue_comments_156922.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-09-30T17:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156922",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_156923.json:
```json
{
    "body": "**Changing keywords** from \"readline lion\" to \"readline upgrade spkg lion Darwin 11 MacOS X 10.7\".",
    "created_at": "2011-09-30T20:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156923",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "readline lion" to "readline upgrade spkg lion Darwin 11 MacOS X 10.7".



---

archive/issue_comments_156924.json:
```json
{
    "body": "<a id='comment:4'></a>\nAccording to the attached spkg patch, the version in the changelog entry heading doesn't match the package's one, i.e., the `.p0` is missing.",
    "created_at": "2011-09-30T20:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156924",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
According to the attached spkg patch, the version in the changelog entry heading doesn't match the package's one, i.e., the `.p0` is missing.



---

archive/issue_comments_156925.json:
```json
{
    "body": "<a id='comment:5'></a>\nOops, sorry.  Updated now.",
    "created_at": "2011-09-30T20:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156925",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Oops, sorry.  Updated now.



---

archive/issue_comments_156926.json:
```json
{
    "body": "<a id='comment:6'></a>\nWhile you're at it:\n\n* `chmod +x spkg-check`\n\n* The following\n\n```sh\n   CFLAGS=\"$CFLAGS -g -O2\"\n```\n   should be\n\n```sh\n   CFLAGS=\"-g -O2 $CFLAGS\"\n```\n   (This is IMHO a regression from my previous spkg.)",
    "created_at": "2011-09-30T22:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156926",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>
While you're at it:

* `chmod +x spkg-check`

* The following

```sh
   CFLAGS="$CFLAGS -g -O2"
```
   should be

```sh
   CFLAGS="-g -O2 $CFLAGS"
```
   (This is IMHO a regression from my previous spkg.)



---

archive/issue_comments_156927.json:
```json
{
    "body": "<a id='comment:7'></a>\ns/IMHO/IIRC/ :)",
    "created_at": "2011-09-30T22:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156927",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
s/IMHO/IIRC/ :)



---

archive/issue_comments_156928.json:
```json
{
    "body": "<a id='comment:8'></a>\nAnd presumably the same for `CFLAGS=\"$CFLAGS -g -O0\"`?",
    "created_at": "2011-09-30T22:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156928",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
And presumably the same for `CFLAGS="$CFLAGS -g -O0"`?



---

archive/issue_comments_156929.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jhpalmieri](#comment%3A8):\n> And presumably the same for `CFLAGS=\"$CFLAGS -g -O0\"`?\n\n\nNope. In that case, we want to override a user's setting.",
    "created_at": "2011-09-30T22:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156929",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>
Replying to [jhpalmieri](#comment%3A8):
> And presumably the same for `CFLAGS="$CFLAGS -g -O0"`?


Nope. In that case, we want to override a user's setting.



---

archive/attachments_015775.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11882-readline.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11882/trac_11882-readline.patch",
    "created_at": "2011-09-30T22:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_156930.json:
```json
{
    "body": "patch for readline spkg, for review only",
    "created_at": "2011-09-30T22:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156930",
    "user": "https://github.com/jhpalmieri"
}
```

patch for readline spkg, for review only



---

archive/issue_comments_156931.json:
```json
{
    "body": "<a id='comment:10'></a>\nOkay, the spkg has been updated.",
    "created_at": "2011-09-30T22:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156931",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>
Okay, the spkg has been updated.



---

archive/issue_comments_156932.json:
```json
{
    "body": "**Reviewer:** Leif Leonhardy",
    "created_at": "2011-10-07T20:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156932",
    "user": "https://github.com/nexttime"
}
```

**Reviewer:** Leif Leonhardy



---

archive/issue_comments_156933.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2011-10-07T20:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156933",
    "user": "https://github.com/nexttime"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_156934.json:
```json
{
    "body": "<a id='comment:11'></a>\nThe files (*mostly* Sage's, including the root directory) have weird permissions; run\n\n```sh\n$ chmod -R +rX . .hg* *\n```\n\n\n\n\nCopy-paste accident:\n\n```sh\n$ sed -n -e '/^== readline-.* ==$/s/==/===/gp' SPKG.txt \n### readline-6.2.p0 (John Palmieri, 30 Sept 2011)\n### readline-6.1 (David Kirkby, 11th November 2010)\n```\n\n(Btw., a new spkg sanity check in Jeroen's merger3 might reject the spkg otherwise, or at least later versions of it. :-) )\n\n\n\n\ns/`## Readline 6.1`/`## Readline 6.2`/ in `spkg-install`, or just remove the three lines.\n\nMore important,\n\n```sh\n  DYLIB_NAME=\"$SAGE_LOCAL\"/lib/libreadline.so.6.1  # Untested. David Kirkby, 11th November 2010 \n```\nshould now be\n\n```sh\n  DYLIB_NAME=\"$SAGE_LOCAL\"/lib/libreadline.so.6.2  # Untested. David Kirkby, 11th November 2010 \n```\n\nI guess the Arch Linux and OpenSUSE 11.x fixes are no longer necessary with readline 6.2, but unless *Sage* breaks (with the system's libreadline), we may keep them at the moment. In principle we should really check the versions and decide based on these.\n\n\n\n\nWe should only delete Sage's previous version upon a *successful* build.\n\n---\n\nIf one day `make check` is supported, we *may* have to set up `CFLAGS` et al. in `spkg-check` as well. Perhaps add a comment on that.\n\n---\n\n## Optionally:\n\nWe should replace the ugly\n\n```sh\nif [ \"x$CFLAG64\" = x ] ; then\n   CFLAG64=-m64\nfi\n```\nby\n\n```sh\n: ${CFLAG64=-m64} # Only sets it to '-m64' if it's not set at all, not even to \"\".\n```\nwhich is shorter and faster (and maybe safer ;-) ); otherwise I'd use `[ -z \"$CFLAG64\" ]` or `[This is the Trac macro *-z $CFLAG64 * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#-z $CFLAG64 -macro)` (see below; we could use the latter also for `$SAGE_LOCAL`).\n\nYou could also use\n\n```sh\n   ...\n   CFLAGS=\"$CFLAGS ${CFLAG64=-m64}\"\n   # The above *sets* CFLAG64 in case it is undefined,\n   # so it's sufficient to use just $CFLAG64 in the following assignments.\n   ...\n```\nand omit the whole `if [ -z \"$CFLAG64\" ] ...` (or whatever) block.\n\n\n\n\n```sh\nif [ \"x$SAGE64\" = xyes ] ; then\n...\n```\ncould be\n\n```sh\nif [ \"${SAGE64:-no}\" = yes ]; then\n...\n```\nor, perhaps more readable, and even better, using the safe (and faster) shell built-in version of `test`:\n\n```sh\nif [[ $SAGE64 = yes ]]; then\n...\n```\n\n(Same for `$SAGE_DEBUG`.)\n\n---\n\n\"Naturally\", I haven't yet tested the new spkg at all... (And I won't be able to test it on Lion and other strange OSs or Linux distributions either. ;-) )",
    "created_at": "2011-10-07T20:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156934",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
The files (*mostly* Sage's, including the root directory) have weird permissions; run

```sh
$ chmod -R +rX . .hg* *
```




Copy-paste accident:

```sh
$ sed -n -e '/^== readline-.* ==$/s/==/===/gp' SPKG.txt 
### readline-6.2.p0 (John Palmieri, 30 Sept 2011)
### readline-6.1 (David Kirkby, 11th November 2010)
```

(Btw., a new spkg sanity check in Jeroen's merger3 might reject the spkg otherwise, or at least later versions of it. :-) )




s/`## Readline 6.1`/`## Readline 6.2`/ in `spkg-install`, or just remove the three lines.

More important,

```sh
  DYLIB_NAME="$SAGE_LOCAL"/lib/libreadline.so.6.1  # Untested. David Kirkby, 11th November 2010 
```
should now be

```sh
  DYLIB_NAME="$SAGE_LOCAL"/lib/libreadline.so.6.2  # Untested. David Kirkby, 11th November 2010 
```

I guess the Arch Linux and OpenSUSE 11.x fixes are no longer necessary with readline 6.2, but unless *Sage* breaks (with the system's libreadline), we may keep them at the moment. In principle we should really check the versions and decide based on these.




We should only delete Sage's previous version upon a *successful* build.

---

If one day `make check` is supported, we *may* have to set up `CFLAGS` et al. in `spkg-check` as well. Perhaps add a comment on that.

---

## Optionally:

We should replace the ugly

```sh
if [ "x$CFLAG64" = x ] ; then
   CFLAG64=-m64
fi
```
by

```sh
: ${CFLAG64=-m64} # Only sets it to '-m64' if it's not set at all, not even to "".
```
which is shorter and faster (and maybe safer ;-) ); otherwise I'd use `[ -z "$CFLAG64" ]` or `[This is the Trac macro *-z $CFLAG64 * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#-z $CFLAG64 -macro)` (see below; we could use the latter also for `$SAGE_LOCAL`).

You could also use

```sh
   ...
   CFLAGS="$CFLAGS ${CFLAG64=-m64}"
   # The above *sets* CFLAG64 in case it is undefined,
   # so it's sufficient to use just $CFLAG64 in the following assignments.
   ...
```
and omit the whole `if [ -z "$CFLAG64" ] ...` (or whatever) block.




```sh
if [ "x$SAGE64" = xyes ] ; then
...
```
could be

```sh
if [ "${SAGE64:-no}" = yes ]; then
...
```
or, perhaps more readable, and even better, using the safe (and faster) shell built-in version of `test`:

```sh
if [[ $SAGE64 = yes ]]; then
...
```

(Same for `$SAGE_DEBUG`.)

---

"Naturally", I haven't yet tested the new spkg at all... (And I won't be able to test it on Lion and other strange OSs or Linux distributions either. ;-) )



---

archive/issue_comments_156935.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-10-07T20:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156935",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_156936.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [leif](#comment%3A11):\n> The files (*mostly* Sage's, including the root directory) have weird permissions; \n\n\nThat's strange.  Looks like that was true for the 6.1 spkg, too.  Easy enough to fix.\n\n> Copy-paste accident:\n\n\nAlso from the last spkg, but easy to fix.\n\n> s/`## Readline 6.1`/`## Readline 6.2`/ in `spkg-install`, or just remove the three lines.\n\n\nRemoved.\n\n> More important,\n\n\n```sh\n  DYLIB_NAME=\"$SAGE_LOCAL\"/lib/libreadline.so.6.1  # Untested. David Kirkby, 11th November 2010 \n```\n\nfixed.\n\n> I guess the Arch Linux and OpenSUSE 11.x fixes are no longer necessary with readline 6.2, but unless *Sage* breaks (with the system's libreadline), we may keep them at the moment. In principle we should really check the versions and decide based on these.\n\n\nRight.  I don't access to any machines running those operating systems, so it feels safest to leave things as they are.\n\n> We should only delete Sage's previous version upon a *successful* build.\n\n\nDone.\n\n> If one day `make check` is supported, we *may* have to set up `CFLAGS` et al. in `spkg-check` as well. Perhaps add a comment on that.\n\n\nDone.\n\n> == Optionally: ==\n\n\nI replaced all of tests with the `[This is the Trac macro *blah * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#blah -macro)` version.",
    "created_at": "2011-10-07T20:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156936",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
Replying to [leif](#comment%3A11):
> The files (*mostly* Sage's, including the root directory) have weird permissions; 


That's strange.  Looks like that was true for the 6.1 spkg, too.  Easy enough to fix.

> Copy-paste accident:


Also from the last spkg, but easy to fix.

> s/`## Readline 6.1`/`## Readline 6.2`/ in `spkg-install`, or just remove the three lines.


Removed.

> More important,


```sh
  DYLIB_NAME="$SAGE_LOCAL"/lib/libreadline.so.6.1  # Untested. David Kirkby, 11th November 2010 
```

fixed.

> I guess the Arch Linux and OpenSUSE 11.x fixes are no longer necessary with readline 6.2, but unless *Sage* breaks (with the system's libreadline), we may keep them at the moment. In principle we should really check the versions and decide based on these.


Right.  I don't access to any machines running those operating systems, so it feels safest to leave things as they are.

> We should only delete Sage's previous version upon a *successful* build.


Done.

> If one day `make check` is supported, we *may* have to set up `CFLAGS` et al. in `spkg-check` as well. Perhaps add a comment on that.


Done.

> == Optionally: ==


I replaced all of tests with the `[This is the Trac macro *blah * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#blah -macro)` version.



---

archive/attachments_015776.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11882-readline.v2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11882/trac_11882-readline.v2.patch",
    "created_at": "2011-10-07T20:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_156937.json:
```json
{
    "body": "patch for readline spkg, for review only",
    "created_at": "2011-10-07T20:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156937",
    "user": "https://github.com/jhpalmieri"
}
```

patch for readline spkg, for review only



---

archive/issue_comments_156938.json:
```json
{
    "body": "<a id='comment:13'></a>\nP.S.:\n\nOn Silius, we get (with the current 6.1 spkg):\n\n```\n...\nOpenSuSE detected\n... but not OpenSuSE 11 -> building Sage's version of libreadline.\n...\n```\nwhich is wrong, because it runs SLES, but -- just luckily I think -- `grep -q 11\\\\. /etc/SuSE-release` yields false because we there have\n\n```\nSUSE Linux Enterprise Server 11 (ppc64)\nVERSION = 11\nPATCHLEVEL = 1\n```\n\n(`/bin/bash` is dynamically linked against libreadline there, too, but it only has `libreadline.so.5[.2]` and no devel version installed.)",
    "created_at": "2011-10-07T20:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156938",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
P.S.:

On Silius, we get (with the current 6.1 spkg):

```
...
OpenSuSE detected
... but not OpenSuSE 11 -> building Sage's version of libreadline.
...
```
which is wrong, because it runs SLES, but -- just luckily I think -- `grep -q 11\\. /etc/SuSE-release` yields false because we there have

```
SUSE Linux Enterprise Server 11 (ppc64)
VERSION = 11
PATCHLEVEL = 1
```

(`/bin/bash` is dynamically linked against libreadline there, too, but it only has `libreadline.so.5[.2]` and no devel version installed.)



---

archive/issue_comments_156939.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jhpalmieri](#comment%3A12):\n> Replying to [leif](#comment%3A11):\n> [...]\n\n\n(Ok.)\n\n> > I guess the Arch Linux and OpenSUSE 11.x fixes are no longer necessary with readline 6.2, but unless *Sage* breaks (with the system's libreadline), we may keep them at the moment. In principle we should really check the versions and decide based on these.\n\n> \n> Right.  I don't access to any machines running those operating systems, so it feels safest to leave things as they are.\n\n\nIIRC Nathann Cohen is our OpenSUSE master...\n\n> [...] \n> > If one day `make check` is supported, we *may* have to set up `CFLAGS` et al. in `spkg-check` as well. Perhaps add a comment on that.\n\n> \n> Done.\n\n\nI was thinking of *\"Special Update/Build Instructions\"* as well.\n\n\n> > == Optionally: ==\n\n> \n> I replaced all of tests with the `[This is the Trac macro *blah * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#blah -macro)` version.\n\n\nOk. By the way, this is also supported by MacOS X 10.4's outdated `bash` 2.04.",
    "created_at": "2011-10-07T21:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156939",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [jhpalmieri](#comment%3A12):
> Replying to [leif](#comment%3A11):
> [...]


(Ok.)

> > I guess the Arch Linux and OpenSUSE 11.x fixes are no longer necessary with readline 6.2, but unless *Sage* breaks (with the system's libreadline), we may keep them at the moment. In principle we should really check the versions and decide based on these.

> 
> Right.  I don't access to any machines running those operating systems, so it feels safest to leave things as they are.


IIRC Nathann Cohen is our OpenSUSE master...

> [...] 
> > If one day `make check` is supported, we *may* have to set up `CFLAGS` et al. in `spkg-check` as well. Perhaps add a comment on that.

> 
> Done.


I was thinking of *"Special Update/Build Instructions"* as well.


> > == Optionally: ==

> 
> I replaced all of tests with the `[This is the Trac macro *blah * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#blah -macro)` version.


Ok. By the way, this is also supported by MacOS X 10.4's outdated `bash` 2.04.



---

archive/issue_comments_156940.json:
```json
{
    "body": "<a id='comment:15'></a>\nJust for fun, I thought I would actually test out the spkg, instead of just creating one which theoretically ought to work.  It builds successfully on the following machines, and it seems to run successfully on all of the ones where I can actually run Sage (that is, all of them except silius and OS X 10.7):\n\n- Mac OS X 10.6 box\n- Mac OS X 10.7 box\n- sage.math\n- redhawk (why is the clock on that machine off by 5 minutes?)\n- cicero\n- cleo\n- eno\n- iras\n- mark, mark2\n- silius\n- taurus\n\nI couldn't log in to the other skynet machines (except for sextus2, where I now have a build starting from scratch, and for which this spkg claims to have built successfully).  I also couldn't log in to David Kirkby's machine hawk. So I haven't been able to test on OpenSolaris yet.",
    "created_at": "2011-10-07T21:12:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156940",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Just for fun, I thought I would actually test out the spkg, instead of just creating one which theoretically ought to work.  It builds successfully on the following machines, and it seems to run successfully on all of the ones where I can actually run Sage (that is, all of them except silius and OS X 10.7):

- Mac OS X 10.6 box
- Mac OS X 10.7 box
- sage.math
- redhawk (why is the clock on that machine off by 5 minutes?)
- cicero
- cleo
- eno
- iras
- mark, mark2
- silius
- taurus

I couldn't log in to the other skynet machines (except for sextus2, where I now have a build starting from scratch, and for which this spkg claims to have built successfully).  I also couldn't log in to David Kirkby's machine hawk. So I haven't been able to test on OpenSolaris yet.



---

archive/issue_comments_156941.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-10-09T15:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156941",
    "user": "https://github.com/nexttime"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_156942.json:
```json
{
    "body": "<a id='comment:16'></a>\nOk, I'm mostly happy with the new spkg (I'll eventually upload a reviewer patch / spkg with minor changes, but that's not very likely), so **positive review** from me, modulo testing on Arch Linux and OpenSUSE, perhaps also OpenSolaris, none of which I'm currently able to.\n\nJeroen should decide whether we can merge this without having tested it on some of the mentioned platforms.\n\n\n\n\nAlso someone who had problems with readline and R on Ubuntu 11.10 could test whether this fixes the issue; I'm not aware of any detailed report regarding that, and others did not have such problems when building Sage on Oneiric Ocelot.\n\nMy new R spkg (see #9906) *might* by the way also fix such issues; haven't investigated that.",
    "created_at": "2011-10-09T15:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156942",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
Ok, I'm mostly happy with the new spkg (I'll eventually upload a reviewer patch / spkg with minor changes, but that's not very likely), so **positive review** from me, modulo testing on Arch Linux and OpenSUSE, perhaps also OpenSolaris, none of which I'm currently able to.

Jeroen should decide whether we can merge this without having tested it on some of the mentioned platforms.




Also someone who had problems with readline and R on Ubuntu 11.10 could test whether this fixes the issue; I'm not aware of any detailed report regarding that, and others did not have such problems when building Sage on Oneiric Ocelot.

My new R spkg (see #9906) *might* by the way also fix such issues; haven't investigated that.



---

archive/issue_comments_156943.json:
```json
{
    "body": "**Work_Issues:** Test on OpenSUSE, OpenSolaris, perhaps also Arch Linux.",
    "created_at": "2011-10-09T15:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156943",
    "user": "https://github.com/nexttime"
}
```

**Work_Issues:** Test on OpenSUSE, OpenSolaris, perhaps also Arch Linux.



---

archive/issue_comments_156944.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [leif](#comment%3A16):\n> Also someone who had problems with readline and R on Ubuntu 11.10 could test whether this fixes the issue; I'm not aware of any detailed report regarding that, and others did not have such problems when building Sage on Oneiric Ocelot. \n\n\n> \n\n\n> My new R spkg (see #9906) *might* by the way also fix such issues; haven't investigated that.\n\n\nDoesn't look like it would change anything regarding that, i.e., our current R spkg already properly configures R with `--with-readline=...`, prepends Sage's include directory to `CPPFLAGS` etc., and prepends `-L$SAGE_LOCAL/lib` to `LDFLAGS`.\n\nI was just guessing that might have been the issue.",
    "created_at": "2011-10-09T16:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156944",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'></a>
Replying to [leif](#comment%3A16):
> Also someone who had problems with readline and R on Ubuntu 11.10 could test whether this fixes the issue; I'm not aware of any detailed report regarding that, and others did not have such problems when building Sage on Oneiric Ocelot. 


> 


> My new R spkg (see #9906) *might* by the way also fix such issues; haven't investigated that.


Doesn't look like it would change anything regarding that, i.e., our current R spkg already properly configures R with `--with-readline=...`, prepends Sage's include directory to `CPPFLAGS` etc., and prepends `-L$SAGE_LOCAL/lib` to `LDFLAGS`.

I was just guessing that might have been the issue.



---

archive/issue_comments_156945.json:
```json
{
    "body": "<a id='comment:18'></a>\nI can try merging it in sage-4.7.3.alpha0 and see if people complain...",
    "created_at": "2011-10-09T20:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156945",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
I can try merging it in sage-4.7.3.alpha0 and see if people complain...



---

archive/issue_comments_156946.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [jdemeyer](#comment%3A18):\n> I can try merging it in sage-4.7.3.alpha0 and see if people complain...\n\n\nWell, or into a (Sage 4.7.2) release *candidate*; that's what they're for... ;-)\n\n\n\n\nI'm still curious whether we get trouble on Oneiric Ocelot with our *current* readline (and R, as mentioned above).",
    "created_at": "2011-10-09T22:25:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156946",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:19'></a>
Replying to [jdemeyer](#comment%3A18):
> I can try merging it in sage-4.7.3.alpha0 and see if people complain...


Well, or into a (Sage 4.7.2) release *candidate*; that's what they're for... ;-)




I'm still curious whether we get trouble on Oneiric Ocelot with our *current* readline (and R, as mentioned above).



---

archive/issue_comments_156947.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jdemeyer](#comment%3A18):\n> I can try merging it in sage-4.7.3.alpha0 and see if people complain...\n\n\nI think that's fine.  Is it likely to cause problems?  If so, you could mention it particularly in the release announcement.",
    "created_at": "2011-10-09T23:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156947",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>
Replying to [jdemeyer](#comment%3A18):
> I can try merging it in sage-4.7.3.alpha0 and see if people complain...


I think that's fine.  Is it likely to cause problems?  If so, you could mention it particularly in the release announcement.



---

archive/issue_comments_156948.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [leif](#comment%3A16):\n> Jeroen should decide whether we can merge this without having tested it on some of the mentioned platforms.\n\n\nAbsolutely!  I really want to support giving tickets positive_review without testing on all systems.  I don't want to give the author nor the reviewer the burden of too much testing.  We do have automated buildbots, we do have Sage developers using more different systems than you can imagine, let's use their power.  Of course, *some* reasonable testing needs to be done, but that was clearly the case here.  Also, there is nothing that can go catastrophically wrong with this ticket.  I mean, Sage is not going to answer \"1 + 1 = 3\" because of a readline update.",
    "created_at": "2011-10-10T20:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156948",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Replying to [leif](#comment%3A16):
> Jeroen should decide whether we can merge this without having tested it on some of the mentioned platforms.


Absolutely!  I really want to support giving tickets positive_review without testing on all systems.  I don't want to give the author nor the reviewer the burden of too much testing.  We do have automated buildbots, we do have Sage developers using more different systems than you can imagine, let's use their power.  Of course, *some* reasonable testing needs to be done, but that was clearly the case here.  Also, there is nothing that can go catastrophically wrong with this ticket.  I mean, Sage is not going to answer "1 + 1 = 3" because of a readline update.



---

archive/issue_comments_156949.json:
```json
{
    "body": "<a id='comment:22'></a>\nRegarding the build on Arch Linux, someone (h/t csousa) on the IRC pointed me to this:\n\n[http://projects.archlinux.org/svntogit/community.git/plain/trunk/PKGBUILD?h=packages/sage-mathematics](http://projects.archlinux.org/svntogit/community.git/plain/trunk/PKGBUILD?h=packages/sage-mathematics)\n\n```sh\n...\nbuild() {\n  cd sage-${pkgver}\n\n  # modularization of sage, sort of :)\n  # fixes the following error:\n  # bash: symbol lookup error: bash: undefined symbol: rl_filename_rewrite_hook\n  # remove this hack when sage uses a readline 6.1 or greater, or when sage uses its own internal bash\n  # this is for people who have custom kernels (sage works this around by checking uname -r)\n  #mkdir -p spkg/installed\n  #touch spkg/installed/readline-6.1\n...\n```\n\nSo readline 6.2 is likely to work as well, unless they meanwhile have an even newer version in Arch.\n\nThus we should change\n\n```sh\nif [ -f /etc/arch-release ]; then\n    ...\nfi\n```\nto\n\n```sh\nif false && [ -f /etc/arch-release ]; then\n    ...\nfi\n```\n\nOr leave the Arch Linux *detection* and just print a message that we're building Sage's readline since we assume it to work...\n\n(I wouldn't delete the whole stuff yet.)",
    "created_at": "2011-10-10T21:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156949",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:22'></a>
Regarding the build on Arch Linux, someone (h/t csousa) on the IRC pointed me to this:

[http://projects.archlinux.org/svntogit/community.git/plain/trunk/PKGBUILD?h=packages/sage-mathematics](http://projects.archlinux.org/svntogit/community.git/plain/trunk/PKGBUILD?h=packages/sage-mathematics)

```sh
...
build() {
  cd sage-${pkgver}

  # modularization of sage, sort of :)
  # fixes the following error:
  # bash: symbol lookup error: bash: undefined symbol: rl_filename_rewrite_hook
  # remove this hack when sage uses a readline 6.1 or greater, or when sage uses its own internal bash
  # this is for people who have custom kernels (sage works this around by checking uname -r)
  #mkdir -p spkg/installed
  #touch spkg/installed/readline-6.1
...
```

So readline 6.2 is likely to work as well, unless they meanwhile have an even newer version in Arch.

Thus we should change

```sh
if [ -f /etc/arch-release ]; then
    ...
fi
```
to

```sh
if false && [ -f /etc/arch-release ]; then
    ...
fi
```

Or leave the Arch Linux *detection* and just print a message that we're building Sage's readline since we assume it to work...

(I wouldn't delete the whole stuff yet.)



---

archive/issue_comments_156950.json:
```json
{
    "body": "<a id='comment:23'></a>\nShould we \"comment out\" both the !OpenSUSE and Arch Linux checks (`if false && ...`) and ask people to test it in the upcoming 4.7.3.alpha0?  The cleaner the spkg, the better, so this might let us know whether we need the fixes anymore.",
    "created_at": "2011-10-10T22:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156950",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
Should we "comment out" both the !OpenSUSE and Arch Linux checks (`if false && ...`) and ask people to test it in the upcoming 4.7.3.alpha0?  The cleaner the spkg, the better, so this might let us know whether we need the fixes anymore.



---

archive/issue_comments_156951.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jhpalmieri](#comment%3A23):\n> Should we \"comment out\" both the !OpenSUSE and Arch Linux checks (`if false && ...`) and ask people to test it in the upcoming 4.7.3.alpha0?  The cleaner the spkg, the better, so this might let us know whether we need the fixes anymore.\n\n\nI think so.  We can keep the detection, such that we see whether that still works appropriately, but I would disable using the system's libreadline completely.\n\n\nI just asked Alexander Dreyer to test this, since he apparently has access to an [Open?]SuSE 11 system.",
    "created_at": "2011-10-10T23:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156951",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:24'></a>
Replying to [jhpalmieri](#comment%3A23):
> Should we "comment out" both the !OpenSUSE and Arch Linux checks (`if false && ...`) and ask people to test it in the upcoming 4.7.3.alpha0?  The cleaner the spkg, the better, so this might let us know whether we need the fixes anymore.


I think so.  We can keep the detection, such that we see whether that still works appropriately, but I would disable using the system's libreadline completely.


I just asked Alexander Dreyer to test this, since he apparently has access to an [Open?]SuSE 11 system.



---

archive/issue_comments_156952.json:
```json
{
    "body": "<a id='comment:25'></a>\nOkay, a new version is up, with accompanying patch here.",
    "created_at": "2011-10-11T02:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156952",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>
Okay, a new version is up, with accompanying patch here.



---

archive/issue_comments_156953.json:
```json
{
    "body": "<a id='comment:26'></a>\nThe differences: in SPKG.txt, record the new changes, and also put in a note about self tests and modifying CFLAGS etc. in spkg-check.   In spkg-install, turn off both the Arch Linux and OpenSuSE tests with \"if false && ...\".",
    "created_at": "2011-10-11T02:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156953",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>
The differences: in SPKG.txt, record the new changes, and also put in a note about self tests and modifying CFLAGS etc. in spkg-check.   In spkg-install, turn off both the Arch Linux and OpenSuSE tests with "if false && ...".



---

archive/attachments_015777.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11882-readline.v3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11882/trac_11882-readline.v3.patch",
    "created_at": "2011-10-11T02:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_156954.json:
```json
{
    "body": "patch for readline spkg, for review only",
    "created_at": "2011-10-11T02:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156954",
    "user": "https://github.com/jhpalmieri"
}
```

patch for readline spkg, for review only



---

archive/issue_comments_156955.json:
```json
{
    "body": "<a id='comment:27'></a>\nYep, patch looks good. (Now also prints \"Arch Linux detected\"; I had just reviewed the intermediate version. :) )\n\n[X] leave as positive_review",
    "created_at": "2011-10-11T02:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156955",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>
Yep, patch looks good. (Now also prints "Arch Linux detected"; I had just reviewed the intermediate version. :) )

[X] leave as positive_review



---

archive/issue_comments_156956.json:
```json
{
    "body": "**Changing work_issues** from \"Test on OpenSUSE, OpenSolaris, perhaps also Arch Linux.\" to \"Test on OpenSolaris, perhaps also Arch Linux.\".",
    "created_at": "2011-10-11T09:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156956",
    "user": "https://github.com/alexanderdreyer"
}
```

**Changing work_issues** from "Test on OpenSUSE, OpenSolaris, perhaps also Arch Linux." to "Test on OpenSolaris, perhaps also Arch Linux.".



---

archive/issue_comments_156957.json:
```json
{
    "body": "<a id='comment:28'></a>\nThe spkg installs fine on OpenSuSE 11, so side effects on runtime visible.",
    "created_at": "2011-10-11T09:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156957",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:28'></a>
The spkg installs fine on OpenSuSE 11, so side effects on runtime visible.



---

archive/issue_comments_156958.json:
```json
{
    "body": "**Changing reviewer** from \"Leif Leonhardy\" to \"Leif Leonhardy, Alexander Dreyer\".",
    "created_at": "2011-10-11T09:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156958",
    "user": "https://github.com/alexanderdreyer"
}
```

**Changing reviewer** from "Leif Leonhardy" to "Leif Leonhardy, Alexander Dreyer".



---

archive/issue_comments_156959.json:
```json
{
    "body": "**Merged:** sage-4.7.3.alpha0",
    "created_at": "2011-10-12T07:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156959",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.3.alpha0



---

archive/issue_events_036629.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-12T07:35:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11882#event-36629"
}
```



---

archive/issue_comments_156960.json:
```json
{
    "body": "<a id='comment:30'></a>\nI've tested new readline-6.2.p0.spkg in an updated Arch Linux with Sage 4.7.1. Everything seems ok.\n\nI was not completely sure of what should be tested, but sage, sage --sh and sage --notebook run ok.",
    "created_at": "2011-10-13T16:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156960",
    "user": "https://trac.sagemath.org/admin/accounts/users/cdsousa"
}
```

<a id='comment:30'></a>
I've tested new readline-6.2.p0.spkg in an updated Arch Linux with Sage 4.7.1. Everything seems ok.

I was not completely sure of what should be tested, but sage, sage --sh and sage --notebook run ok.



---

archive/issue_comments_156961.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [cdsousa](#comment%3A30):\n> I've tested new readline-6.2.p0.spkg in an updated Arch Linux with Sage 4.7.1. Everything seems ok.\n> \n> I was not completely sure of what should be tested, but sage, sage --sh and sage --notebook run ok.\n\n\nOk, thanks.",
    "created_at": "2011-10-13T18:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156961",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:31'></a>
Replying to [cdsousa](#comment%3A30):
> I've tested new readline-6.2.p0.spkg in an updated Arch Linux with Sage 4.7.1. Everything seems ok.
> 
> I was not completely sure of what should be tested, but sage, sage --sh and sage --notebook run ok.


Ok, thanks.



---

archive/issue_comments_156962.json:
```json
{
    "body": "**Changing work_issues** from \"Test on OpenSolaris, perhaps also Arch Linux.\" to \"\".",
    "created_at": "2011-10-13T18:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156962",
    "user": "https://github.com/nexttime"
}
```

**Changing work_issues** from "Test on OpenSolaris, perhaps also Arch Linux." to "".



---

archive/issue_comments_156963.json:
```json
{
    "body": "<a id='comment:32'></a>\nI'm considering modifying the spkg with the following patch:\n\n```diff\ndiff --git a/SPKG.txt b/SPKG.txt\n--- a/SPKG.txt\n+++ b/SPKG.txt\n@@ -32,13 +32,17 @@ Website: http://tiswww.case.edu/php/chet\n  * Deleted some files from the doc directory from the standard distro,\n    since it took tons of space; didn't delete anything else.\n  * Work around some MacOSX dynamic lib flags\n-* TODO: When we add self-tests, we may have to set up variables like\n+ * TODO: in #11882, we turned off the fixes for Arch Linux and\n+   OpenSuSE by changing various tests in spkg-install from \"if ...\"\n+   to \"if false && ...\".  After further testing, these sections of\n+   spkg-install should be removed completely.\n+ * TODO: When we add self-tests, we may have to set up variables like\n    CFLAGS in spkg-check.\n \n == Changelog ==\n \n === readline-6.2.p0 (John Palmieri, 30 Sept 2011) ===\n- * Update to version 6.2.\n+ * Update to version 6.2 (trac #11882).\n  * Fix for Mac OS X 10.7 Lion.  This fix is taken from\n    https://trac.macports.org/browser/trunk/dports/devel/readline/files/patch-sh\n  * spkg-install: Turn off all hacks and fixes for Arch Linux and OpenSuSE.\n```\nIs this a good idea?\n\nJeroen: if I did this, would you be able to use a new version in 4.7.3.alpha0?\n\nOr should I create a \".p1\" version of the spkg with changes like these?",
    "created_at": "2011-10-13T18:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156963",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>
I'm considering modifying the spkg with the following patch:

```diff
diff --git a/SPKG.txt b/SPKG.txt
--- a/SPKG.txt
+++ b/SPKG.txt
@@ -32,13 +32,17 @@ Website: http://tiswww.case.edu/php/chet
  * Deleted some files from the doc directory from the standard distro,
    since it took tons of space; didn't delete anything else.
  * Work around some MacOSX dynamic lib flags
-* TODO: When we add self-tests, we may have to set up variables like
+ * TODO: in #11882, we turned off the fixes for Arch Linux and
+   OpenSuSE by changing various tests in spkg-install from "if ..."
+   to "if false && ...".  After further testing, these sections of
+   spkg-install should be removed completely.
+ * TODO: When we add self-tests, we may have to set up variables like
    CFLAGS in spkg-check.
 
 == Changelog ==
 
 === readline-6.2.p0 (John Palmieri, 30 Sept 2011) ===
- * Update to version 6.2.
+ * Update to version 6.2 (trac #11882).
  * Fix for Mac OS X 10.7 Lion.  This fix is taken from
    https://trac.macports.org/browser/trunk/dports/devel/readline/files/patch-sh
  * spkg-install: Turn off all hacks and fixes for Arch Linux and OpenSuSE.
```
Is this a good idea?

Jeroen: if I did this, would you be able to use a new version in 4.7.3.alpha0?

Or should I create a ".p1" version of the spkg with changes like these?



---

archive/issue_comments_156964.json:
```json
{
    "body": "**Changing status** from closed to new.",
    "created_at": "2011-10-13T19:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156964",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from closed to new.



---

archive/issue_comments_156965.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [jhpalmieri](#comment%3A32):\n> Is this a good idea?\n\nProbably yes, but I will leave it up to others to judge.  But maybe we should be bold and simply *remove* the \"if false\" code and then we don't need the comment.  Adding the ticket number in the spkg is also a very good idea.\n\n> Jeroen: if I did this, would you be able to use a new version in 4.7.3.alpha0?\n\nYes, especially if the change won't affect the functionality of the spkg.  Just don't wait too long please.\n\n> Or should I create a \".p1\" version of the spkg with changes like these?\n\nAs you wish, .p0 or .p1 doesn't matter for me.",
    "created_at": "2011-10-13T19:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156965",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
Replying to [jhpalmieri](#comment%3A32):
> Is this a good idea?

Probably yes, but I will leave it up to others to judge.  But maybe we should be bold and simply *remove* the "if false" code and then we don't need the comment.  Adding the ticket number in the spkg is also a very good idea.

> Jeroen: if I did this, would you be able to use a new version in 4.7.3.alpha0?

Yes, especially if the change won't affect the functionality of the spkg.  Just don't wait too long please.

> Or should I create a ".p1" version of the spkg with changes like these?

As you wish, .p0 or .p1 doesn't matter for me.



---

archive/issue_comments_156966.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [jdemeyer](#comment%3A33):\n> Replying to [jhpalmieri](#comment%3A32):\n> > Is this a good idea?\n\n> Probably yes, but I will leave it up to others to judge.  But maybe we should be bold and simply *remove* the \"if false\" code and then we don't need the comment.  Adding the ticket number in the spkg is also a very good idea.\n\nIt is likely that we'll have to reenable the code (with slight changes) when Arch or SuSE again have newer versions (with new symbols), so I wouldn't delete it.\n\nIt could be smarter or more generic of course, but I wouldn't make such changes here and now.\n\n\n\n \n> > Jeroen: if I did this, would you be able to use a new version in 4.7.3.alpha0?\n\n> Yes, especially if the change won't affect the functionality of the spkg.  Just don't wait too long please.\n> \n> > Or should I create a \".p1\" version of the spkg with changes like these?\n\n> As you wish, .p0 or .p1 doesn't matter for me.\n\nIn general I'd prefer a p1 to avoid confusion, but there are no changes to the code, and as long as its location is the same I won't mind having the changes made to the p0.",
    "created_at": "2011-10-14T03:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156966",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:34'></a>
Replying to [jdemeyer](#comment%3A33):
> Replying to [jhpalmieri](#comment%3A32):
> > Is this a good idea?

> Probably yes, but I will leave it up to others to judge.  But maybe we should be bold and simply *remove* the "if false" code and then we don't need the comment.  Adding the ticket number in the spkg is also a very good idea.

It is likely that we'll have to reenable the code (with slight changes) when Arch or SuSE again have newer versions (with new symbols), so I wouldn't delete it.

It could be smarter or more generic of course, but I wouldn't make such changes here and now.



 
> > Jeroen: if I did this, would you be able to use a new version in 4.7.3.alpha0?

> Yes, especially if the change won't affect the functionality of the spkg.  Just don't wait too long please.
> 
> > Or should I create a ".p1" version of the spkg with changes like these?

> As you wish, .p0 or .p1 doesn't matter for me.

In general I'd prefer a p1 to avoid confusion, but there are no changes to the code, and as long as its location is the same I won't mind having the changes made to the p0.



---

archive/issue_comments_156967.json:
```json
{
    "body": "<a id='comment:35'></a>\n... so I'd change your suggested `SPKG.txt` phrase accordingly.\n\nAlso, *\"When we add self-tests ...\"* should read *\"If **upstream** adds self-tests ...\"*, since we already run `make check`, but that's currently a no-op.",
    "created_at": "2011-10-14T03:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156967",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:35'></a>
... so I'd change your suggested `SPKG.txt` phrase accordingly.

Also, *"When we add self-tests ..."* should read *"If **upstream** adds self-tests ..."*, since we already run `make check`, but that's currently a no-op.



---

archive/issue_comments_156968.json:
```json
{
    "body": "<a id='comment:36'></a>\nI've uploaded \"p1\" version of the spkg; the only difference is some comments in SPKG.txt.  If the new version is acceptable, feel free to remove the link to the \"p0\" version from the ticket description.",
    "created_at": "2011-10-14T18:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156968",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'></a>
I've uploaded "p1" version of the spkg; the only difference is some comments in SPKG.txt.  If the new version is acceptable, feel free to remove the link to the "p0" version from the ticket description.



---

archive/issue_comments_156969.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2011-10-14T18:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156969",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_156970.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,4 +3,5 @@\n New spkg available for testing:\n \n - [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg)\n+- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)\n \n``````\n",
    "created_at": "2011-10-14T18:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156970",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,4 +3,5 @@
 New spkg available for testing:
 
 - [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg)
+- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)
 
``````




---

archive/issue_comments_156971.json:
```json
{
    "body": "<a id='comment:37'></a>\nTwo minor comments:\n1. The date of the p1 is \"14 Oct Sept 2011\"\n2. Also add the ticket number to the p1 in `SPKG.txt`",
    "created_at": "2011-10-14T18:10:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156971",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>
Two minor comments:
1. The date of the p1 is "14 Oct Sept 2011"
2. Also add the ticket number to the p1 in `SPKG.txt`



---

archive/issue_comments_156972.json:
```json
{
    "body": "<a id='comment:38'></a>\nOkay, fixed.",
    "created_at": "2011-10-14T18:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156972",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'></a>
Okay, fixed.



---

archive/attachments_015778.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11882-readline.p1.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11882/trac_11882-readline.p1.patch",
    "created_at": "2011-10-14T18:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_156973.json:
```json
{
    "body": "diff between p0 and p1",
    "created_at": "2011-10-14T18:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156973",
    "user": "https://github.com/jhpalmieri"
}
```

diff between p0 and p1



---

archive/issue_comments_156974.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,3 +5,4 @@\n - [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg)\n - [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)\n \n+The home base for this ticket is the Lion ticket #11881.\n``````\n",
    "created_at": "2011-10-14T18:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156974",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,3 +5,4 @@
 - [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg)
 - [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)
 
+The home base for this ticket is the Lion ticket #11881.
``````




---

archive/issue_events_036630.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-16T16:11:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11882#event-36630"
}
```



---

archive/issue_comments_156975.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,5 @@\n readline 6.2 is available.  Upgrade Sage to use this version.  This also includes [a fix](https://trac.macports.org/browser/trunk/dports/devel/readline/files/patch-shobj-conf.diff) so it builds on OS X 10.7 Lion.\n \n-New spkg available for testing:\n+The home base for this ticket is the Lion ticket #11881.\n \n-- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg)\n-- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)\n-\n-The home base for this ticket is the Lion ticket #11881.\n+**Apply** [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)\n``````\n",
    "created_at": "2011-10-16T16:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156975",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,5 @@
 readline 6.2 is available.  Upgrade Sage to use this version.  This also includes [a fix](https://trac.macports.org/browser/trunk/dports/devel/readline/files/patch-shobj-conf.diff) so it builds on OS X 10.7 Lion.
 
-New spkg available for testing:
+The home base for this ticket is the Lion ticket #11881.
 
-- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p0.spkg)
-- [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)
-
-The home base for this ticket is the Lion ticket #11881.
+**Apply** [http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/readline-6.2.p1.spkg)
``````




---

archive/issue_comments_156976.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156976",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_comments_156977.json:
```json
{
    "body": "**Changing merged** from \"sage-4.7.3.alpha0\" to \"sage-4.8.alpha0\".",
    "created_at": "2011-11-03T16:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11882#issuecomment-156977",
    "user": "https://github.com/jdemeyer"
}
```

**Changing merged** from "sage-4.7.3.alpha0" to "sage-4.8.alpha0".



---

archive/issue_events_036631.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:18:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11882",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11882#event-36631"
}
```
