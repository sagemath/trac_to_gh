# Issue 11230: Define our own PariOUT

archive/issues_011058.json:
```json
{
    "body": "Instead of changing `defaultOut` in `sage/libs/pari/gen.pyx`, we should instead define our own `PariOUT` structure and use that.\n\nAssignee: @williamstein\n\nKeywords: pari\n\nResolution: fixed\n\nAuthor: Jeroen Demeyer\n\nReviewer: Robert Bradshaw, John Cremona\n\nMerged: sage-4.7.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/11230\n\n",
    "closed_at": "2011-04-26T09:05:40Z",
    "created_at": "2011-04-21T08:52:14Z",
    "labels": [
        "component: interfaces",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "Define our own PariOUT",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11230",
    "user": "https://github.com/jdemeyer"
}
```
Instead of changing `defaultOut` in `sage/libs/pari/gen.pyx`, we should instead define our own `PariOUT` structure and use that.

Assignee: @williamstein

Keywords: pari

Resolution: fixed

Author: Jeroen Demeyer

Reviewer: Robert Bradshaw, John Cremona

Merged: sage-4.7.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/11230





---

archive/issue_comments_146677.json:
```json
{
    "body": "Attachment [11230_pariout.patch](tarball://root/attachments/some-uuid/ticket11230/11230_pariout.patch) by @jdemeyer created at 2011-04-21 08:56:43",
    "created_at": "2011-04-21T08:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146677",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [11230_pariout.patch](tarball://root/attachments/some-uuid/ticket11230/11230_pariout.patch) by @jdemeyer created at 2011-04-21 08:56:43



---

archive/issue_comments_146678.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-21T09:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146678",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_146679.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-23T04:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146679",
    "user": "https://github.com/robertwb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_146680.json:
```json
{
    "body": "<a id='comment:2'></a>LGTM, pending adding the trac number to the ticket description. \n\nWhy in the world did we define `__x` to do `ctypedef __x pariout_t`?",
    "created_at": "2011-04-23T04:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146680",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:2'></a>LGTM, pending adding the trac number to the ticket description. 

Why in the world did we define `__x` to do `ctypedef __x pariout_t`?



---

archive/issue_comments_146681.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 robertwb]:\n> LGTM, pending adding the trac number to the ticket description. \n\nThis is no longer necessary (see [http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e/a3c2af4a7700bca3](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e/a3c2af4a7700bca3))\n\n> Why in the world did we define `__x` to do `ctypedef __x pariout_t`?\n\nI didn't write that code, but probably to work around some limitation/bug in an earlier version of Cython?",
    "created_at": "2011-04-24T18:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146681",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>Replying to [comment:2 robertwb]:
> LGTM, pending adding the trac number to the ticket description. 

This is no longer necessary (see [http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e/a3c2af4a7700bca3](http://groups.google.com/group/sage-devel/browse_thread/thread/f5a9c012f6299a9e/a3c2af4a7700bca3))

> Why in the world did we define `__x` to do `ctypedef __x pariout_t`?

I didn't write that code, but probably to work around some limitation/bug in an earlier version of Cython?



---

archive/issue_comments_146682.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Robert Bradshaw\"",
    "created_at": "2011-04-24T18:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146682",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Robert Bradshaw"



---

archive/issue_comments_146683.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2011-04-25T11:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146683",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_146684.json:
```json
{
    "body": "<a id='comment:4'></a>I know this has a positive review from the omnipotent testbot, but when I apply this to a freshly-rolled 4.7.alpha5 and do a full test I get two failures in sage/misc/sagedoc.py:\n\n```\nFile \"/home/jec/sage-4.7.alpha5.pari/devel/sage-main/sage/misc/sagedoc.py\", line 874:\n    sage: len(search_doc('tree', interact=False).splitlines()) > 2500  # long time\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/jec/sage-4.7.alpha5.pari/devel/sage-main/sage/misc/sagedoc.py\", line 489:\n    sage: 'abvar/homology' in _search_src_or_doc('doc', 'homology', 'variety', interact=False)\nExpected:\n    True\nGot:\n    False\n```\nI built Sage with \"make build\" rather than \"make\", in case that is relevant.  Meanwhile I switched the tag to \"needs info\" but will continue with this applied and go on to #11130.",
    "created_at": "2011-04-25T11:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146684",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>I know this has a positive review from the omnipotent testbot, but when I apply this to a freshly-rolled 4.7.alpha5 and do a full test I get two failures in sage/misc/sagedoc.py:

```
File "/home/jec/sage-4.7.alpha5.pari/devel/sage-main/sage/misc/sagedoc.py", line 874:
    sage: len(search_doc('tree', interact=False).splitlines()) > 2500  # long time
Expected:
    True
Got:
    False
**********************************************************************
File "/home/jec/sage-4.7.alpha5.pari/devel/sage-main/sage/misc/sagedoc.py", line 489:
    sage: 'abvar/homology' in _search_src_or_doc('doc', 'homology', 'variety', interact=False)
Expected:
    True
Got:
    False
```
I built Sage with "make build" rather than "make", in case that is relevant.  Meanwhile I switched the tag to "needs info" but will continue with this applied and go on to #11130.



---

archive/issue_comments_146685.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 cremona]:\n> I built Sage with \"make build\" rather than \"make\", in case that is relevant.  \n\nProbably it is, because the doctest failures you mention are related to the **documentation**.  So I would guess that `make doc-html` would solve those problems.",
    "created_at": "2011-04-25T11:48:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146685",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Replying to [comment:4 cremona]:
> I built Sage with "make build" rather than "make", in case that is relevant.  

Probably it is, because the doctest failures you mention are related to the **documentation**.  So I would guess that `make doc-html` would solve those problems.



---

archive/issue_comments_146686.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 jdemeyer]:\n> Replying to [comment:4 cremona]:\n> > I built Sage with \"make build\" rather than \"make\", in case that is relevant.  \n\n> Probably it is, because the doctest failures you mention are related to the **documentation**.  So I would guess that `make doc-html` would solve those problems.\n\nI guessed so, so am about to try again after sage -docbuild all html has finished...",
    "created_at": "2011-04-25T11:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146686",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'></a>Replying to [comment:5 jdemeyer]:
> Replying to [comment:4 cremona]:
> > I built Sage with "make build" rather than "make", in case that is relevant.  

> Probably it is, because the doctest failures you mention are related to the **documentation**.  So I would guess that `make doc-html` would solve those problems.

I guessed so, so am about to try again after sage -docbuild all html has finished...



---

archive/issue_comments_146687.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-04-25T13:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146687",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_146688.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 cremona]:\n> Replying to [comment:5 jdemeyer]:\n> > Replying to [comment:4 cremona]:\n> > > I built Sage with \"make build\" rather than \"make\", in case that is relevant.  \n\n> > Probably it is, because the doctest failures you mention are related to the **documentation**.  So I would guess that `make doc-html` would solve those problems.\n> \n> I guessed so, so am about to try again after sage -docbuild all html has finished... \n\n\nAs expected, the problem went away.  I suppose it was silly to base the full test on devel/sage and not devel/sage/sage given that I had not built the docs.",
    "created_at": "2011-04-25T13:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146688",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>Replying to [comment:6 cremona]:
> Replying to [comment:5 jdemeyer]:
> > Replying to [comment:4 cremona]:
> > > I built Sage with "make build" rather than "make", in case that is relevant.  

> > Probably it is, because the doctest failures you mention are related to the **documentation**.  So I would guess that `make doc-html` would solve those problems.
> 
> I guessed so, so am about to try again after sage -docbuild all html has finished... 


As expected, the problem went away.  I suppose it was silly to base the full test on devel/sage and not devel/sage/sage given that I had not built the docs.



---

archive/issue_comments_146689.json:
```json
{
    "body": "Changing reviewer from \"Robert Bradshaw\" to \"Robert Bradshaw, John Cremona\"",
    "created_at": "2011-04-25T13:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146689",
    "user": "https://github.com/JohnCremona"
}
```

Changing reviewer from "Robert Bradshaw" to "Robert Bradshaw, John Cremona"



---

archive/issue_comments_146690.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-25T13:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146690",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_146691.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.7.1.alpha0\"",
    "created_at": "2011-04-26T09:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146691",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.7.1.alpha0"



---

archive/issue_events_029084.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-26T09:05:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11230#event-29084"
}
```



---

archive/issue_comments_146692.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-04-26T09:05:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11230",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11230#issuecomment-146692",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
