# Issue 11786: Maxima fails to build if $HOME is not accessible

archive/issues_011614.json:
```json
{
    "assignees": [],
    "body": "\n```\n...\n;;; Loading \"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p0/src/src/../lisp-utils/defsystem.lisp\"\n;;; Loading \"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p0/src/src/maxima-package.lisp\"\n;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=0\n;;;\n;;; End of Pass 1.\n;;; Note:\n;;;   Invoking external command:\n;;;   gcc -I. -I/tmp/leif/sage-4.7.2.alpha2/local/include/ -march=native -O3 -g -DHONORS_CPPFLAGS -I/tmp/leif/sage-4.7.2.alpha2/local/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -g -O2 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -g -DHONORS_CFLAGS -fPIC -Dlinux -O2 -w -c /tmp/ecl001Oj22KE.c -o /tmp/ecl001Oj22KE.o \nAn error occurred during initialization:\nFilesystem error with pathname #P\"/home/\".\nEither\n 1) the file does not exist, or\n 2) we are not allow to access the file, or\n 3) the pathname points to a broken symbolic link..\n;;; Note:\n;;;   Invoking external command:\n;;;   gcc -o /tmp/ecl001Oj22KE.fas -L/tmp/leif/sage-4.7.2.alpha2/local/lib/ /tmp/ecl001Oj22KE.o -Wl,--rpath,/tmp/leif/sage-4.7.2.alpha2/local/lib/ -shared -L/tmp/leif/sage-4.7.2.alpha2/local/lib -L/tmp/leif/sage-4.7.2.alpha2/local/lib -lecl -lgmp -lgc -ldl -lm \ninstalling Maxima library as /tmp/leif/sage-4.7.2.alpha2/local/lib/ecl//maxima.fas\ncp: cannot stat `maxima.fasb': No such file or directory\n***********************************************************\nFailed to install maxima.fasb as a library\n***********************************************************\n\nreal 4m43.367s\nuser 4m56.150s\nsys 0m47.370s\nsage: An error occurred while installing maxima-5.23.2.p0\n...\n```\nThis happened because `HOME` was set to `/home/leif`, but `/home` wasn't mounted (on the machine I was building on).\n\nThe first error message is quite precise, but the failure seems odd.\n\nI have no idea (at the moment) why Maxima tries to access (or at least checks the validity of) `$HOME` at all.\n\n\n**CC:**  @vbraun @dimpase @slel\n\n**Keywords:** maxima.fasb error\n\n**Reviewer:** Samuel Leli\u00e8vre\n\nIssue created by migration from https://trac.sagemath.org/ticket/11786\n\n",
    "closed_at": "2021-08-26T02:08:43Z",
    "created_at": "2011-09-10T01:38:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Maxima fails to build if $HOME is not accessible",
    "type": "issue",
    "updated_at": "2021-08-26T02:08:43Z",
    "url": "https://github.com/sagemath/sage/issues/11786",
    "user": "https://github.com/nexttime"
}
```

```
...
;;; Loading "/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p0/src/src/../lisp-utils/defsystem.lisp"
;;; Loading "/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p0/src/src/maxima-package.lisp"
;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=0
;;;
;;; End of Pass 1.
;;; Note:
;;;   Invoking external command:
;;;   gcc -I. -I/tmp/leif/sage-4.7.2.alpha2/local/include/ -march=native -O3 -g -DHONORS_CPPFLAGS -I/tmp/leif/sage-4.7.2.alpha2/local/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -g -O2 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -g -DHONORS_CFLAGS -fPIC -Dlinux -O2 -w -c /tmp/ecl001Oj22KE.c -o /tmp/ecl001Oj22KE.o 
An error occurred during initialization:
Filesystem error with pathname #P"/home/".
Either
 1) the file does not exist, or
 2) we are not allow to access the file, or
 3) the pathname points to a broken symbolic link..
;;; Note:
;;;   Invoking external command:
;;;   gcc -o /tmp/ecl001Oj22KE.fas -L/tmp/leif/sage-4.7.2.alpha2/local/lib/ /tmp/ecl001Oj22KE.o -Wl,--rpath,/tmp/leif/sage-4.7.2.alpha2/local/lib/ -shared -L/tmp/leif/sage-4.7.2.alpha2/local/lib -L/tmp/leif/sage-4.7.2.alpha2/local/lib -lecl -lgmp -lgc -ldl -lm 
installing Maxima library as /tmp/leif/sage-4.7.2.alpha2/local/lib/ecl//maxima.fas
cp: cannot stat `maxima.fasb': No such file or directory
***********************************************************
Failed to install maxima.fasb as a library
***********************************************************

real 4m43.367s
user 4m56.150s
sys 0m47.370s
sage: An error occurred while installing maxima-5.23.2.p0
...
```
This happened because `HOME` was set to `/home/leif`, but `/home` wasn't mounted (on the machine I was building on).

The first error message is quite precise, but the failure seems odd.

I have no idea (at the moment) why Maxima tries to access (or at least checks the validity of) `$HOME` at all.


**CC:**  @vbraun @dimpase @slel

**Keywords:** maxima.fasb error

**Reviewer:** Samuel Leli√®vre

Issue created by migration from https://trac.sagemath.org/ticket/11786





---

archive/issue_events_133669.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T01:38:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "08517b",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133669"
}
```



---

archive/issue_events_133670.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T01:38:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133670"
}
```



---

archive/issue_events_133671.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T01:38:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133671"
}
```



---

archive/issue_events_133672.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-10T01:38:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "008080",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133672"
}
```



---

archive/issue_comments_125243.json:
```json
{
    "body": "<a id='comment:1'></a>\nIt is very odd indeed. I am expecting that it just check the existence of HOME and doesn't write anything there. We would have sandbox violation while building maxima in Gentoo otherwise (outside of sage that is).",
    "created_at": "2011-09-10T02:35:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125243",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
It is very odd indeed. I am expecting that it just check the existence of HOME and doesn't write anything there. We would have sandbox violation while building maxima in Gentoo otherwise (outside of sage that is).



---

archive/issue_comments_125244.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [@kiwifb](#comment%3A1):\n> It is very odd indeed. I am expecting that it just check the existence of HOME and doesn't write anything there. We would have sandbox violation while building maxima in Gentoo otherwise (outside of sage that is).\n\nMaybe you don't have `HOME` set there at all?\n\nOTOH Sage always sets `HOME` if it isn't already.\n\nStill weird that the file `cp` wants to copy apparently doesn't get built (or renamed / copied / whatever to the proper one) in this case. We've seen the same error on other(?) occasions already...",
    "created_at": "2011-09-10T03:54:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125244",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>
Replying to [@kiwifb](#comment%3A1):
> It is very odd indeed. I am expecting that it just check the existence of HOME and doesn't write anything there. We would have sandbox violation while building maxima in Gentoo otherwise (outside of sage that is).

Maybe you don't have `HOME` set there at all?

OTOH Sage always sets `HOME` if it isn't already.

Still weird that the file `cp` wants to copy apparently doesn't get built (or renamed / copied / whatever to the proper one) in this case. We've seen the same error on other(?) occasions already...



---

archive/issue_comments_125245.json:
```json
{
    "body": "<a id='comment:3'></a>\nI confirm the failure.\n\nIn `spkg-install` I changed the following command sequence:\n\n```\n#build maxima as a lisp library\n#and install it in the ecl library directory\n\ncd src\necho \"building Maxima as an ecl library\"\nmkdir ./lisp-cache \n\nexport HOME=/does/not/exist ### I added this line\n\necl \\\n  -eval '(require `asdf)' \\\n  -eval '(setf asdf::*user-cache* (truename \"./lisp-cache\"))' \\\n  -eval '(load \"maxima-build.lisp\")' \\\n  -eval '(asdf:make-build :maxima :type :fasl :move-here \".\")' \\\n  -eval '(quit)' \n```\nas a consequence, the call to `asdf:make-build` fails with a complaint about \"/\" not existing (whereas of course it's \"/does\" that does not exist, just as in the reported case where the mount point \"/home\" probably does exist). Apparently, asdf feels the need to resolve the path in \"$HOME\". asdf is the \"make/build\" tool for common lisp and is quite complex. Note that `asdf::*user-cache*` normally points to a directory in \"$HOME\".\n\nThere are very few people who grok asdf and fewer who are familiar with ecl's implementation specifics. It might be that asdf has other business in $HOME than just *user-cache* and that this is causing the path resolution request.\n\nYou could consider reporting upstream but I'm not sure that the observed behaviour should be considered a bug.\n\nThe fact that spkg-install fails on the cp and not on ecl is that I am not sure that a failed build results in an error code from ecl. The present approach is plainly phenomenological: If \"maxima.fasb\" is present then obviously the build succeeded. If it isn't the copy will fail and trigger an appropriate check-error.\n\n(\".fasb\" is produced by asdf to not clash with ecl's \"native\" build system that produces \".fas\". The file is the same format and renaming to \".fas\" is safe. I think ecl is increasingly embracing asdf as the build-tool of choice)",
    "created_at": "2011-09-10T04:41:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125245",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:3'></a>
I confirm the failure.

In `spkg-install` I changed the following command sequence:

```
#build maxima as a lisp library
#and install it in the ecl library directory

cd src
echo "building Maxima as an ecl library"
mkdir ./lisp-cache 

export HOME=/does/not/exist ### I added this line

ecl \
  -eval '(require `asdf)' \
  -eval '(setf asdf::*user-cache* (truename "./lisp-cache"))' \
  -eval '(load "maxima-build.lisp")' \
  -eval '(asdf:make-build :maxima :type :fasl :move-here ".")' \
  -eval '(quit)' 
```
as a consequence, the call to `asdf:make-build` fails with a complaint about "/" not existing (whereas of course it's "/does" that does not exist, just as in the reported case where the mount point "/home" probably does exist). Apparently, asdf feels the need to resolve the path in "$HOME". asdf is the "make/build" tool for common lisp and is quite complex. Note that `asdf::*user-cache*` normally points to a directory in "$HOME".

There are very few people who grok asdf and fewer who are familiar with ecl's implementation specifics. It might be that asdf has other business in $HOME than just *user-cache* and that this is causing the path resolution request.

You could consider reporting upstream but I'm not sure that the observed behaviour should be considered a bug.

The fact that spkg-install fails on the cp and not on ecl is that I am not sure that a failed build results in an error code from ecl. The present approach is plainly phenomenological: If "maxima.fasb" is present then obviously the build succeeded. If it isn't the copy will fail and trigger an appropriate check-error.

(".fasb" is produced by asdf to not clash with ecl's "native" build system that produces ".fas". The file is the same format and renaming to ".fas" is safe. I think ecl is increasingly embracing asdf as the build-tool of choice)



---

archive/issue_comments_125246.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [@nbruin](#comment%3A3):\n> \n\n```sh\n...\necl \\\n  -eval '(require `asdf)' \\\n  -eval '(setf asdf::*user-cache* (truename \"./lisp-cache\"))' \\\n  -eval '(load \"maxima-build.lisp\")' \\\n  -eval '(asdf:make-build :maxima :type :fasl :move-here \".\")' \\\n  -eval '(quit)'\n...\n```\n\n> [...] You could consider reporting upstream but I'm not sure that the observed behaviour should be considered a bug. \n\n> \n\n> The fact that spkg-install fails on the cp and not on ecl is that I am not sure that a failed build results in an error code from ecl.\n\n\n\nWith `HOME=/does/not/exist`, I get:\n\n```\n...\n;;;   Invoking external command:\n;;;   gcc -I. -I/tmp/leif/sage-4.7.2.alpha2/local/include/ -march=native -O3 -g -DHONORS_CPPFLAGS -I/tmp/leif/sage-4.7.2.alpha2/local/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -g -O2 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -g -DHONORS_CFLAGS -fPIC -Dlinux -O2 -w -c /tmp/ecl001SW4Wdt.c -o /tmp/ecl001SW4Wdt.o \nAn error occurred during initialization:\nFilesystem error with pathname #P\"/\".\nEither\n 1) the file does not exist, or\n 2) we are not allow to access the file, or\n 3) the pathname points to a broken symbolic link..\n;;; Note:\n;;;   Invoking external command:\n;;;   gcc -o /tmp/ecl001SW4Wdt.fas -L/tmp/leif/sage-4.7.2.alpha2/local/lib/ /tmp/ecl001SW4Wdt.o -Wl,--rpath,/tmp/leif/sage-4.7.2.alpha2/local/lib/ -shared -L/tmp/leif/sage-4.7.2.alpha2/local/lib -L/tmp/leif/sage-4.7.2.alpha2/local/lib -lecl -lgmp -lgc -ldl -lm\n\necl ... asdf:make-build :maxima ... returned 1\n```\n(Just added an `echo \"... $?\"`.)\n\nSo certainly the exit code should be checked in `spkg-install`.\n\nIt's funny though that first an error message is printed, but apparently *afterwards* an \"external command\" still gets invoked. Perhaps just the output streams aren't in sync, or asdf does some kind of parallel make. So this *might* be a (minor) bug.\n\n\n\n\nFWIW,\n\n```sh\n$ (unset HOME; ./sage -f spkg/standard/maxima-5.23.2.p0.spkg)\n```\nworks.\n\nSo we may unset it in `spkg-install`, perhaps only if it really doesn't exist (or isn't readable / `cd`'able; `test -d`, `-r`, `-x`).",
    "created_at": "2011-09-10T06:02:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125246",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
Replying to [@nbruin](#comment%3A3):
> 

```sh
...
ecl \
  -eval '(require `asdf)' \
  -eval '(setf asdf::*user-cache* (truename "./lisp-cache"))' \
  -eval '(load "maxima-build.lisp")' \
  -eval '(asdf:make-build :maxima :type :fasl :move-here ".")' \
  -eval '(quit)'
...
```

> [...] You could consider reporting upstream but I'm not sure that the observed behaviour should be considered a bug. 

> 

> The fact that spkg-install fails on the cp and not on ecl is that I am not sure that a failed build results in an error code from ecl.



With `HOME=/does/not/exist`, I get:

```
...
;;;   Invoking external command:
;;;   gcc -I. -I/tmp/leif/sage-4.7.2.alpha2/local/include/ -march=native -O3 -g -DHONORS_CPPFLAGS -I/tmp/leif/sage-4.7.2.alpha2/local/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -g -O2 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -g -DHONORS_CFLAGS -fPIC -Dlinux -O2 -w -c /tmp/ecl001SW4Wdt.c -o /tmp/ecl001SW4Wdt.o 
An error occurred during initialization:
Filesystem error with pathname #P"/".
Either
 1) the file does not exist, or
 2) we are not allow to access the file, or
 3) the pathname points to a broken symbolic link..
;;; Note:
;;;   Invoking external command:
;;;   gcc -o /tmp/ecl001SW4Wdt.fas -L/tmp/leif/sage-4.7.2.alpha2/local/lib/ /tmp/ecl001SW4Wdt.o -Wl,--rpath,/tmp/leif/sage-4.7.2.alpha2/local/lib/ -shared -L/tmp/leif/sage-4.7.2.alpha2/local/lib -L/tmp/leif/sage-4.7.2.alpha2/local/lib -lecl -lgmp -lgc -ldl -lm

ecl ... asdf:make-build :maxima ... returned 1
```
(Just added an `echo "... $?"`.)

So certainly the exit code should be checked in `spkg-install`.

It's funny though that first an error message is printed, but apparently *afterwards* an "external command" still gets invoked. Perhaps just the output streams aren't in sync, or asdf does some kind of parallel make. So this *might* be a (minor) bug.




FWIW,

```sh
$ (unset HOME; ./sage -f spkg/standard/maxima-5.23.2.p0.spkg)
```
works.

So we may unset it in `spkg-install`, perhaps only if it really doesn't exist (or isn't readable / `cd`'able; `test -d`, `-r`, `-x`).



---

archive/issue_comments_125247.json:
```json
{
    "body": "<a id='comment:5'></a>\nMore detailed output:\n\n```\n...\nlstat(\"/tmp\", {st_mode=S_IFDIR|S_ISVTX|0777, st_size=69632, ...}) = 0\nlstat(\"/tmp/ecl001OMGuRc.fas\", {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0\nopen(\"/tmp/ecl001OMGuRc.fas\", O_RDONLY) = 4\nread(4, \"\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0>\\0\\1\\0\\0\\0@\\7\\0\\0\\0\\0\\0\\0\"..., 832) = 832\nfstat(4, {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0\nmmap(NULL, 2101328, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 4, 0) = 0x7f36a2ea8000\nmprotect(0x7f36a2ea9000, 2093056, PROT_NONE) = 0\nmmap(0x7f36a30a8000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 4, 0) = 0x7f36a30a8000\nclose(4)                                = 0\nmprotect(0x7f36a30a8000, 4096, PROT_READ) = 0\nstat(\"/tmp/ecl001OMGuRc.fas\", {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0\ngetcwd(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src\", 128) = 64\nlstat(\"/tmp\", {st_mode=S_IFDIR|S_ISVTX|0777, st_size=69632, ...}) = 0\nlstat(\"/tmp/ecl001OMGuRc.fas\", {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0\nunlink(\"/tmp/ecl001OMGuRc.fas\")         = 0\nrt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0\nstat(\"/tmp/ecl001OMGuRc.c\", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/ecl001OMGuRc.h\", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/ecl001OMGuRc.fas\", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/ecl001OMGuRc.tmp\", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)\nread(3, \"\", 8192)                       = 0\nclose(3)                                = 0\nstat(\"/tmp/leif/sage-4.7.2.alpha2/local/lib/ecl/maxima.asd\", 0x7fff24de6e20) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src/\", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0\ngetcwd(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src\", 128) = 64\nlstat(\"/tmp\", {st_mode=S_IFDIR|S_ISVTX|0777, st_size=69632, ...}) = 0\nlstat(\"/tmp/leif\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src\", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0\nlstat(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src/\", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0\ngetcwd(\"/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src\", 128) = 64\nlstat(\"/does\", 0x7fff24de3df0)          = -1 ENOENT (No such file or directory)\nwrite(2, \"A\", 1A)                        = 1\nwrite(2, \"n\", 1n)                        = 1\nwrite(2, \" \", 1 )                        = 1\nwrite(2, \"e\", 1e)                        = 1\nwrite(2, \"r\", 1r)                        = 1\nwrite(2, \"r\", 1r)                        = 1\nwrite(2, \"o\", 1o)                        = 1\nwrite(2, \"r\", 1r)                        = 1\nwrite(2, \" \", 1 )                        = 1\nwrite(2, \"o\", 1o)                        = 1\nwrite(2, \"c\", 1c)                        = 1\nwrite(2, \"c\", 1c)                        = 1\nwrite(2, \"u\", 1u)                        = 1\nwrite(2, \"r\", 1r)                        = 1\nwrite(2, \"r\", 1r)                        = 1\nwrite(2, \"e\", 1e)                        = 1\nwrite(2, \"d\", 1d)                        = 1\nwrite(2, \" \", 1 )                        = 1\n\n... a few hundred lines deleted ...\n\nwrite(2, \"b\", 1b)                        = 1\nwrite(2, \"r\", 1r)                        = 1\nwrite(2, \"o\", 1o)                        = 1\nwrite(2, \"k\", 1k)                        = 1\nwrite(2, \"e\", 1e)                        = 1\nwrite(2, \"n\", 1n)                        = 1\nwrite(2, \" \", 1 )                        = 1\nwrite(2, \"s\", 1s)                        = 1\nwrite(2, \"y\", 1y)                        = 1\nwrite(2, \"m\", 1m)                        = 1\nwrite(2, \"b\", 1b)                        = 1\nwrite(2, \"o\", 1o)                        = 1\nwrite(2, \"l\", 1l)                        = 1\nwrite(2, \"i\", 1i)                        = 1\nwrite(2, \"c\", 1c)                        = 1\nwrite(2, \" \", 1 )                        = 1\nwrite(2, \"l\", 1l)                        = 1\nwrite(2, \"i\", 1i)                        = 1\nwrite(2, \"n\", 1n)                        = 1\nwrite(2, \"k\", 1k)                        = 1\nwrite(2, \".\", 1.)                        = 1\nwrite(2, \".\", 1.)                        = 1\nwrite(2, \"\\n\", 1\n)                       = 1\nmunmap(0x7f36a2ea8000, 2101328)         = 0\nmunmap(0x7f36a30aa000, 2981152)         = 0\nmunmap(0x7f36a3382000, 2406024)         = 0\nwrite(1, \";;; Note:\\n;;;   Invoking externa\"..., 304;;; Note:\n;;;   Invoking external command:\n;;;   gcc -o /tmp/ecl001OMGuRc.fas -L/tmp/leif/sage-4.7.2.alpha2/local/lib/ /tmp/ecl001OMGuRc.o -Wl,--rpath,/tmp/leif/sage-4.7.2.alpha2/local/lib/ -shared -L/tmp/leif/sage-4.7.2.alpha2/local/lib -L/tmp/leif/sage-4.7.2.alpha2/local/lib -lecl -lgmp -lgc -ldl -lm ) = 304\nexit_group(1)                           = ?\n\necl ... asdf:make-build :maxima ... returned 1\n```\n\n:)",
    "created_at": "2011-09-10T06:36:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125247",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
More detailed output:

```
...
lstat("/tmp", {st_mode=S_IFDIR|S_ISVTX|0777, st_size=69632, ...}) = 0
lstat("/tmp/ecl001OMGuRc.fas", {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0
open("/tmp/ecl001OMGuRc.fas", O_RDONLY) = 4
read(4, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0@\7\0\0\0\0\0\0"..., 832) = 832
fstat(4, {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0
mmap(NULL, 2101328, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 4, 0) = 0x7f36a2ea8000
mprotect(0x7f36a2ea9000, 2093056, PROT_NONE) = 0
mmap(0x7f36a30a8000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 4, 0) = 0x7f36a30a8000
close(4)                                = 0
mprotect(0x7f36a30a8000, 4096, PROT_READ) = 0
stat("/tmp/ecl001OMGuRc.fas", {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0
getcwd("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src", 128) = 64
lstat("/tmp", {st_mode=S_IFDIR|S_ISVTX|0777, st_size=69632, ...}) = 0
lstat("/tmp/ecl001OMGuRc.fas", {st_mode=S_IFREG|0755, st_size=22499, ...}) = 0
unlink("/tmp/ecl001OMGuRc.fas")         = 0
rt_sigprocmask(SIG_BLOCK, NULL, [], 8)  = 0
stat("/tmp/ecl001OMGuRc.c", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)
stat("/tmp/ecl001OMGuRc.h", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)
stat("/tmp/ecl001OMGuRc.fas", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)
stat("/tmp/ecl001OMGuRc.tmp", 0x7fff24de7eb0) = -1 ENOENT (No such file or directory)
read(3, "", 8192)                       = 0
close(3)                                = 0
stat("/tmp/leif/sage-4.7.2.alpha2/local/lib/ecl/maxima.asd", 0x7fff24de6e20) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src/", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0
getcwd("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src", 128) = 64
lstat("/tmp", {st_mode=S_IFDIR|S_ISVTX|0777, st_size=69632, ...}) = 0
lstat("/tmp/leif", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2/spkg", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2/spkg/build", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0
lstat("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src/", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0
getcwd("/tmp/leif/sage-4.7.2.alpha2/spkg/build/maxima-5.23.2.p1/src/src", 128) = 64
lstat("/does", 0x7fff24de3df0)          = -1 ENOENT (No such file or directory)
write(2, "A", 1A)                        = 1
write(2, "n", 1n)                        = 1
write(2, " ", 1 )                        = 1
write(2, "e", 1e)                        = 1
write(2, "r", 1r)                        = 1
write(2, "r", 1r)                        = 1
write(2, "o", 1o)                        = 1
write(2, "r", 1r)                        = 1
write(2, " ", 1 )                        = 1
write(2, "o", 1o)                        = 1
write(2, "c", 1c)                        = 1
write(2, "c", 1c)                        = 1
write(2, "u", 1u)                        = 1
write(2, "r", 1r)                        = 1
write(2, "r", 1r)                        = 1
write(2, "e", 1e)                        = 1
write(2, "d", 1d)                        = 1
write(2, " ", 1 )                        = 1

... a few hundred lines deleted ...

write(2, "b", 1b)                        = 1
write(2, "r", 1r)                        = 1
write(2, "o", 1o)                        = 1
write(2, "k", 1k)                        = 1
write(2, "e", 1e)                        = 1
write(2, "n", 1n)                        = 1
write(2, " ", 1 )                        = 1
write(2, "s", 1s)                        = 1
write(2, "y", 1y)                        = 1
write(2, "m", 1m)                        = 1
write(2, "b", 1b)                        = 1
write(2, "o", 1o)                        = 1
write(2, "l", 1l)                        = 1
write(2, "i", 1i)                        = 1
write(2, "c", 1c)                        = 1
write(2, " ", 1 )                        = 1
write(2, "l", 1l)                        = 1
write(2, "i", 1i)                        = 1
write(2, "n", 1n)                        = 1
write(2, "k", 1k)                        = 1
write(2, ".", 1.)                        = 1
write(2, ".", 1.)                        = 1
write(2, "\n", 1
)                       = 1
munmap(0x7f36a2ea8000, 2101328)         = 0
munmap(0x7f36a30aa000, 2981152)         = 0
munmap(0x7f36a3382000, 2406024)         = 0
write(1, ";;; Note:\n;;;   Invoking externa"..., 304;;; Note:
;;;   Invoking external command:
;;;   gcc -o /tmp/ecl001OMGuRc.fas -L/tmp/leif/sage-4.7.2.alpha2/local/lib/ /tmp/ecl001OMGuRc.o -Wl,--rpath,/tmp/leif/sage-4.7.2.alpha2/local/lib/ -shared -L/tmp/leif/sage-4.7.2.alpha2/local/lib -L/tmp/leif/sage-4.7.2.alpha2/local/lib -lecl -lgmp -lgc -ldl -lm ) = 304
exit_group(1)                           = ?

ecl ... asdf:make-build :maxima ... returned 1
```

:)



---

archive/issue_comments_125248.json:
```json
{
    "body": "<a id='comment:6'></a>\n... and this is what ECL (I think) does in `$HOME`:\n\n```\nstat(\"/tmp/leif/home/.ecl.fas\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.fasl\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.fasb\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.lsp\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.lisp\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.LSP\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.LISP\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.fasb\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl.FASB\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.ecl\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.fas\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.fasl\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.fasb\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.lsp\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.lisp\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.LSP\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.LISP\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.fasb\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc.FASB\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nstat(\"/tmp/leif/home/.eclrc\", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/.config/common-lisp/\", 0x7fff93cc5180) = -1 ENOENT (No such file or directory)\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/.config/common-lisp/\", 0x7fff93cc4360) = -1 ENOENT (No such file or directory)\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/.local/share/\", 0x7fff93cc1900) = -1 ENOENT (No such file or directory)\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/.config/common-lisp/\", 0x7fff93cc2720) = -1 ENOENT (No such file or directory)\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nlstat(\"/tmp/leif/home/\", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\nstat(\"/tmp/leif/home/.config/common-lisp/\", 0x7fff93cc1900) = -1 ENOENT (No such file or directory)\n```\n\nSo I'd say it's a bug that not being able to `stat` `$HOME` is treated as a fatal error.\n\nThe truncated error message (\"`/ does not exist`\") is of course a bug.",
    "created_at": "2011-09-10T07:03:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125248",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>
... and this is what ECL (I think) does in `$HOME`:

```
stat("/tmp/leif/home/.ecl.fas", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.fasl", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.fasb", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.lsp", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.lisp", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.LSP", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.LISP", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.fasb", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl.FASB", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.ecl", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.fas", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.fasl", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.fasb", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.lsp", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.lisp", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.LSP", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.LISP", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.fasb", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc.FASB", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
stat("/tmp/leif/home/.eclrc", 0x7fff93cc9ee0) = -1 ENOENT (No such file or directory)
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/.config/common-lisp/", 0x7fff93cc5180) = -1 ENOENT (No such file or directory)
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/.config/common-lisp/", 0x7fff93cc4360) = -1 ENOENT (No such file or directory)
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/.local/share/", 0x7fff93cc1900) = -1 ENOENT (No such file or directory)
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/.config/common-lisp/", 0x7fff93cc2720) = -1 ENOENT (No such file or directory)
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat("/tmp/leif/home/", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
stat("/tmp/leif/home/.config/common-lisp/", 0x7fff93cc1900) = -1 ENOENT (No such file or directory)
```

So I'd say it's a bug that not being able to `stat` `$HOME` is treated as a fatal error.

The truncated error message ("`/ does not exist`") is of course a bug.



---

archive/issue_comments_125249.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [@nexttime](#comment%3A2):\n> Replying to [@kiwifb](#comment%3A1):\n> > It is very odd indeed. I am expecting that it just check the existence of HOME and doesn't write anything there. We would have sandbox violation while building maxima in Gentoo otherwise (outside of sage that is).\n\n> \n> Maybe you don't have `HOME` set there at all?\n> \n\nBy default it is /root. All lisp pull an external version of asdf in Gentoo but I have no idea if it is in fact used. I concur that it is a bug to treat not being able to stat $HOME as a fatal error. I am unconvinced that you should ever need to do something in $HOME from a building perspective.",
    "created_at": "2011-09-10T23:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125249",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Replying to [@nexttime](#comment%3A2):
> Replying to [@kiwifb](#comment%3A1):
> > It is very odd indeed. I am expecting that it just check the existence of HOME and doesn't write anything there. We would have sandbox violation while building maxima in Gentoo otherwise (outside of sage that is).

> 
> Maybe you don't have `HOME` set there at all?
> 

By default it is /root. All lisp pull an external version of asdf in Gentoo but I have no idea if it is in fact used. I concur that it is a bug to treat not being able to stat $HOME as a fatal error. I am unconvinced that you should ever need to do something in $HOME from a building perspective.



---

archive/issue_comments_125250.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@kiwifb](#comment%3A7):\n> I concur that it is a bug to treat not being able to stat $HOME as a fatal error. I am unconvinced that you should ever need to do something in $HOME from a building perspective.\n\nYep. I'm still not sure whether this is due to Maxima or ECL (or asdf).\n\nFrom ECL's perspective, it is pretty ok, or even desirable, to look for some user files below `$HOME`. Raising a fatal error if this fails is of course not, unless some files from there were really needed.\n\nAnd the crippled error message (the truncated directory name) remains.\n\nI wonder how much time ECL overall spends re-stating the same files again and again, and in system calls writing strings one by one character... m)",
    "created_at": "2011-09-11T00:14:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125250",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>
Replying to [@kiwifb](#comment%3A7):
> I concur that it is a bug to treat not being able to stat $HOME as a fatal error. I am unconvinced that you should ever need to do something in $HOME from a building perspective.

Yep. I'm still not sure whether this is due to Maxima or ECL (or asdf).

From ECL's perspective, it is pretty ok, or even desirable, to look for some user files below `$HOME`. Raising a fatal error if this fails is of course not, unless some files from there were really needed.

And the crippled error message (the truncated directory name) remains.

I wonder how much time ECL overall spends re-stating the same files again and again, and in system calls writing strings one by one character... m)



---

archive/issue_comments_125251.json:
```json
{
    "body": "<a id='comment:9'></a>\necl upstream is fairly good with our requests and reports. Should someone ask them about it?\nFor info I got HOME wrong for root (it is \"/\" really) and reproduced the problem with maxima-5.25.1 and an external asdf (it is definitely used) on Gentoo. Of course ecl could read configuration in $HOME, I guess I overstated that it shouldn't write.\n\nI am guessing the error is really that ecl cannot enter the directory, it has no problem with the files not existing so it has to be getting to the folder.",
    "created_at": "2011-09-12T00:44:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125251",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
ecl upstream is fairly good with our requests and reports. Should someone ask them about it?
For info I got HOME wrong for root (it is "/" really) and reproduced the problem with maxima-5.25.1 and an external asdf (it is definitely used) on Gentoo. Of course ecl could read configuration in $HOME, I guess I overstated that it shouldn't write.

I am guessing the error is really that ecl cannot enter the directory, it has no problem with the files not existing so it has to be getting to the folder.



---

archive/issue_events_133673.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133673"
}
```



---

archive/issue_events_133674.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133674"
}
```



---

archive/issue_events_133675.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133675"
}
```



---

archive/issue_events_133676.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133676"
}
```



---

archive/issue_comments_125252.json:
```json
{
    "body": "<a id='comment:12'></a>\nMy changes from ticket:16178 *might* help solve this issue here as well. It does get rid of asdf, so if that is the only problem here, things should work out fine.",
    "created_at": "2014-04-17T11:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125252",
    "user": "https://github.com/gagern"
}
```

<a id='comment:12'></a>
My changes from ticket:16178 *might* help solve this issue here as well. It does get rid of asdf, so if that is the only problem here, things should work out fine.



---

archive/issue_comments_125253.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [@gagern](#comment%3A12):\n> My changes from ticket:16178 *might* help solve this issue here as well. It does get rid of asdf, so if that is the only problem here, things should work out fine.\n\nHaven't looked at those, but IIRC the `$HOME` issue is also solved by (always) invoking `ecl` with `--norc` (strongly suggested by upstream a while ago).  I don't recall whether we fixed that at some point, but I did leave comments on that on tickets dealing with the Maxima package to that time.",
    "created_at": "2014-04-20T10:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125253",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
Replying to [@gagern](#comment%3A12):
> My changes from ticket:16178 *might* help solve this issue here as well. It does get rid of asdf, so if that is the only problem here, things should work out fine.

Haven't looked at those, but IIRC the `$HOME` issue is also solved by (always) invoking `ecl` with `--norc` (strongly suggested by upstream a while ago).  I don't recall whether we fixed that at some point, but I did leave comments on that on tickets dealing with the Maxima package to that time.



---

archive/issue_comments_125254.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [@nexttime](#comment%3A13):\n> IIRC the `$HOME` issue is also solved by (always) invoking `ecl` with `--norc` (strongly suggested by upstream a while ago).  I don't recall whether we fixed that at some point [...]\n\nOh, apparently not.  Unless I missed something...",
    "created_at": "2014-04-20T10:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125254",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [@nexttime](#comment%3A13):
> IIRC the `$HOME` issue is also solved by (always) invoking `ecl` with `--norc` (strongly suggested by upstream a while ago).  I don't recall whether we fixed that at some point [...]

Oh, apparently not.  Unless I missed something...



---

archive/issue_events_133677.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133677"
}
```



---

archive/issue_events_133678.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133678"
}
```



---

archive/issue_events_133679.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133679"
}
```



---

archive/issue_events_133680.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133680"
}
```



---

archive/issue_comments_125255.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -24,9 +24,9 @@\n Failed to install maxima.fasb as a library\n ***********************************************************\n \n-real\t4m43.367s\n-user\t4m56.150s\n-sys\t0m47.370s\n+real 4m43.367s\n+user 4m56.150s\n+sys 0m47.370s\n sage: An error occurred while installing maxima-5.23.2.p0\n ...\n ```\n``````\n",
    "created_at": "2015-09-06T17:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125255",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -24,9 +24,9 @@
 Failed to install maxima.fasb as a library
 ***********************************************************
 
-real	4m43.367s
-user	4m56.150s
-sys	0m47.370s
+real 4m43.367s
+user 4m56.150s
+sys 0m47.370s
 sage: An error occurred while installing maxima-5.23.2.p0
 ...
 ```
``````




---

archive/issue_events_133681.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T16:38:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133681"
}
```



---

archive/issue_comments_125256.json:
```json
{
    "body": "<a id='comment:18'></a>\nOutdated spkg or build system ticket, should be closed",
    "created_at": "2020-08-17T16:38:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125256",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Outdated spkg or build system ticket, should be closed



---

archive/issue_events_133682.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T16:38:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133682"
}
```



---

archive/issue_events_133683.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-08-19T22:16:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133683"
}
```



---

archive/issue_events_133684.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-08-19T22:16:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133684"
}
```



---

archive/issue_comments_125257.json:
```json
{
    "body": "**Reviewer:** Samuel Leli\u00e8vre",
    "created_at": "2021-08-19T22:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125257",
    "user": "https://github.com/slel"
}
```

**Reviewer:** Samuel Leli√®vre



---

archive/issue_comments_125258.json:
```json
{
    "body": "<a id='comment:19'></a>\nLet's close this.",
    "created_at": "2021-08-19T22:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11786#issuecomment-125258",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>
Let's close this.



---

archive/issue_events_133685.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-26T02:08:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133685"
}
```



---

archive/issue_events_133686.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-26T02:08:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11786",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11786#event-133686"
}
```
