# Issue 11215: Periods for Modular Forms

archive/issues_011043.json:
```json
{
    "body": "This ticket implements a `period(g)` method for cusp forms of weight 2 for `Gamma0(n)`.  It currently accepts only elements `g` in `Gamma0(n)` as input.\n\n```\nsage: f = Newforms(15, 2)[0]\nsage: g = Gamma0(15)(matrix([[-4, -3], [15, 11]]))\nsage: f.period(g)\n2.17298044293747e-16 - 1.59624222213178*I\n```\n\nIn the future we should have functions which allow for pairing of the following:\n\n-cuspidal modular symbols for Gamma0(N) with cusp forms for Gamma0(N)\n\n-cusp forms for Gamma0(N) with cusp forms for Gamma0(N) (Petersson inner product)\n\n\nAssignee: @craigcitro\n\nCC:  @JohnCremona\n\nKeywords: modular form\n\nBranch/Commit: 14231c961633db1b20e992357aae69191fdef49e\n\nReviewer: Aly Deines, Peter Bruin, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Taylor Dupuy, Fr\u00e9d\u00e9ric Chapoton, Peter Bruin\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/11215\n\n",
    "closed_at": "2014-06-06T18:07:58Z",
    "created_at": "2011-04-18T21:52:15Z",
    "labels": [
        "component: modular forms",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Periods for Modular Forms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11215",
    "user": "https://github.com/tdupu"
}
```
This ticket implements a `period(g)` method for cusp forms of weight 2 for `Gamma0(n)`.  It currently accepts only elements `g` in `Gamma0(n)` as input.

```
sage: f = Newforms(15, 2)[0]
sage: g = Gamma0(15)(matrix([[-4, -3], [15, 11]]))
sage: f.period(g)
2.17298044293747e-16 - 1.59624222213178*I
```

In the future we should have functions which allow for pairing of the following:

-cuspidal modular symbols for Gamma0(N) with cusp forms for Gamma0(N)

-cusp forms for Gamma0(N) with cusp forms for Gamma0(N) (Petersson inner product)


Assignee: @craigcitro

CC:  @JohnCremona

Keywords: modular form

Branch/Commit: 14231c961633db1b20e992357aae69191fdef49e

Reviewer: Aly Deines, Peter Bruin, Frédéric Chapoton

Author: Taylor Dupuy, Frédéric Chapoton, Peter Bruin

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/11215





---

archive/issue_comments_146376.json:
```json
{
    "body": "Attachment [pairing.patch](tarball://root/attachments/some-uuid/ticket11215/pairing.patch) by @tdupu created at 2011-04-18 21:54:00\n\npairing for S2(Gamma0(N)) and Gamma0(N)",
    "created_at": "2011-04-18T21:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146376",
    "user": "https://github.com/tdupu"
}
```

Attachment [pairing.patch](tarball://root/attachments/some-uuid/ticket11215/pairing.patch) by @tdupu created at 2011-04-18 21:54:00

pairing for S2(Gamma0(N)) and Gamma0(N)



---

archive/issue_comments_146377.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,4 +19,4 @@\n \n I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???\n \n-\n+Apply [attachment:trac_11215_pairing_redone.patch]\n``````\n",
    "created_at": "2013-08-08T10:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146377",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,4 +19,4 @@
 
 I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???
 
-
+Apply [attachment:trac_11215_pairing_redone.patch]
``````




---

archive/issue_comments_146378.json:
```json
{
    "body": "<a id='comment:2'></a>Attachment [trac_11215_pairing_redone.patch](tarball://root/attachments/some-uuid/ticket11215/trac_11215_pairing_redone.patch) by @fchapoton created at 2013-08-08 10:09:56\n\nhere is a clean version of the previous patch\n\nfor the bot: apply only trac_11215_pairing_redone.patch\u200b",
    "created_at": "2013-08-08T10:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146378",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>Attachment [trac_11215_pairing_redone.patch](tarball://root/attachments/some-uuid/ticket11215/trac_11215_pairing_redone.patch) by @fchapoton created at 2013-08-08 10:09:56

here is a clean version of the previous patch

for the bot: apply only trac_11215_pairing_redone.patch​



---

archive/issue_comments_146379.json:
```json
{
    "body": "<a id='comment:3'></a>As you suggest, it would be alot better to use the fact that f will be an eigenform for the Fricke involution, since that replaces the N in the denominator of the negative exponential with sqrt(N).  The necessary formulas are in the same place....!\n\nAnother improvement would be ta take the precision as in put rather than the number of terms, and compute the necessary number of terms.\n\nAll this is implemented in eclib, for forms of weight 2, trivial character *and rational Fourier coefficients only* so (not for the first time) I am wishing for an interface to all that additional functionality.  Anyway, here we can be more general since there need be no requirement of rationality.",
    "created_at": "2013-08-08T11:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146379",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>As you suggest, it would be alot better to use the fact that f will be an eigenform for the Fricke involution, since that replaces the N in the denominator of the negative exponential with sqrt(N).  The necessary formulas are in the same place....!

Another improvement would be ta take the precision as in put rather than the number of terms, and compute the necessary number of terms.

All this is implemented in eclib, for forms of weight 2, trivial character *and rational Fourier coefficients only* so (not for the first time) I am wishing for an interface to all that additional functionality.  Anyway, here we can be more general since there need be no requirement of rationality.



---

archive/issue_comments_146380.json:
```json
{
    "body": "Attachment [trac_11215_pairing_with_atkin_lehner.patch](tarball://root/attachments/some-uuid/ticket11215/trac_11215_pairing_with_atkin_lehner.patch) by @fchapoton created at 2013-08-08 13:25:12",
    "created_at": "2013-08-08T13:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146380",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_11215_pairing_with_atkin_lehner.patch](tarball://root/attachments/some-uuid/ticket11215/trac_11215_pairing_with_atkin_lehner.patch) by @fchapoton created at 2013-08-08 13:25:12



---

archive/issue_comments_146381.json:
```json
{
    "body": "<a id='comment:4'></a>here is a version using the Atkin-Lehner eigenvalue and the faster converging series\n\nfor the bot: apply only trac_11215_pairing_with_atkin_lehner.patch",
    "created_at": "2013-08-08T13:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146381",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>here is a version using the Atkin-Lehner eigenvalue and the faster converging series

for the bot: apply only trac_11215_pairing_with_atkin_lehner.patch



---

archive/issue_comments_146382.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,4 +19,4 @@\n \n I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???\n \n-Apply [attachment:trac_11215_pairing_redone.patch]\n+Apply [attachment:trac_11215_pairing_with_atkin_lehner.patch]\n``````\n",
    "created_at": "2013-08-08T13:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146382",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,4 +19,4 @@
 
 I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???
 
-Apply [attachment:trac_11215_pairing_redone.patch]
+Apply [attachment:trac_11215_pairing_with_atkin_lehner.patch]
``````




---

archive/issue_comments_146383.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2014-01-05T10:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146383",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_146384.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/11215\"",
    "created_at": "2014-01-05T10:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146384",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/11215"



---

archive/issue_comments_146385.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-01-05T10:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146385",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_146386.json:
```json
{
    "body": "Changing commit from \"\" to \"565db93a00b34026408e5eae8d306b54b92408e4\"",
    "created_at": "2014-01-05T10:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146386",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "565db93a00b34026408e5eae8d306b54b92408e4"



---

archive/issue_comments_146387.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-01-07T04:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146387",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_146388.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Aly Deines\"",
    "created_at": "2014-01-07T04:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146388",
    "user": "https://github.com/adeines"
}
```

Changing reviewer from "" to "Aly Deines"



---

archive/issue_comments_146389.json:
```json
{
    "body": "<a id='comment:6'></a>It looks good, works, tests pass, but the last line could be broken into an extra line or two that would make this more readable.  If you do that I'll give you a positive review.  Also, could you add comments to explain what M.a(), M.b() and M.c() are?",
    "created_at": "2014-01-07T04:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146389",
    "user": "https://github.com/adeines"
}
```

<a id='comment:6'></a>It looks good, works, tests pass, but the last line could be broken into an extra line or two that would make this more readable.  If you do that I'll give you a positive review.  Also, could you add comments to explain what M.a(), M.b() and M.c() are?



---

archive/issue_comments_146390.json:
```json
{
    "body": "Changing commit from \"565db93a00b34026408e5eae8d306b54b92408e4\" to \"1450c838371e6c563e9539fe0721ca111c65ddab\"",
    "created_at": "2014-01-07T08:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "565db93a00b34026408e5eae8d306b54b92408e4" to "1450c838371e6c563e9539fe0721ca111c65ddab"



---

archive/issue_comments_146391.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-07T08:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_146392.json:
```json
{
    "body": "<a id='comment:8'></a>Here is a new commit, where I tried to make it more readable.\n\nI have also changed the ValueError test, that looked wrong\n\nI have added a comment about M.a() etc",
    "created_at": "2014-01-07T08:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146392",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>Here is a new commit, where I tried to make it more readable.

I have also changed the ValueError test, that looked wrong

I have added a comment about M.a() etc



---

archive/issue_comments_146393.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-01-08T08:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146393",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_146394.json:
```json
{
    "body": "<a id='comment:9'></a>I have made the suggested changes, hopefully. Is there something else to do ?",
    "created_at": "2014-01-08T08:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146394",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>I have made the suggested changes, hopefully. Is there something else to do ?



---

archive/issue_comments_146395.json:
```json
{
    "body": "Changing author from \"\" to \"tdupu, Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2014-01-08T20:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146395",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "tdupu, Frédéric Chapoton"



---

archive/issue_comments_146396.json:
```json
{
    "body": "<a id='comment:11'></a>Ping ? Could somebody please have a look ?",
    "created_at": "2014-02-11T17:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146396",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>Ping ? Could somebody please have a look ?



---

archive/issue_comments_146397.json:
```json
{
    "body": "<a id='comment:12'></a>Ping again. This needs review, anybody out there to have a look ?",
    "created_at": "2014-03-11T20:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146397",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>Ping again. This needs review, anybody out there to have a look ?



---

archive/issue_comments_146398.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-09T20:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_146399.json:
```json
{
    "body": "Changing commit from \"1450c838371e6c563e9539fe0721ca111c65ddab\" to \"192e83a3b91207460353830e0ea8817cfbfe2cc2\"",
    "created_at": "2014-05-09T20:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146399",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1450c838371e6c563e9539fe0721ca111c65ddab" to "192e83a3b91207460353830e0ea8817cfbfe2cc2"



---

archive/issue_comments_146400.json:
```json
{
    "body": "<a id='comment:14'></a>I think this needs to be improved a bit.  In particular the new code is only really useful if we can specify the desired precision (of the output), see comment:3.  I'm trying to do this now.",
    "created_at": "2014-05-09T20:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146400",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:14'></a>I think this needs to be improved a bit.  In particular the new code is only really useful if we can specify the desired precision (of the output), see comment:3.  I'm trying to do this now.



---

archive/issue_comments_146401.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-09T20:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146401",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_146402.json:
```json
{
    "body": "<a id='comment:15'></a>Also, it seems to me that the name `pair` for this method is too generic.  Since this pairing is commonly known as the period pairing, would anyone object to renaming the method to `period`?",
    "created_at": "2014-05-09T21:07:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146402",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:15'></a>Also, it seems to me that the name `pair` for this method is too generic.  Since this pairing is commonly known as the period pairing, would anyone object to renaming the method to `period`?



---

archive/issue_comments_146403.json:
```json
{
    "body": "Changing commit from \"192e83a3b91207460353830e0ea8817cfbfe2cc2\" to \"f03cb122f8dafcf52767f75fee7075067367bea4\"",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146403",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "192e83a3b91207460353830e0ea8817cfbfe2cc2" to "f03cb122f8dafcf52767f75fee7075067367bea4"



---

archive/issue_comments_146404.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,22 +1,15 @@\n-We should have a functions/functions which allow for pairing of the following\n+This ticket implements a `period(g)` method for cusp forms of weight 2 for `Gamma0(n)`.  It currently accepts only elements `g` in `Gamma0(n)` as input.\n+\n+```\n+sage: f = Newforms(15, 2)[0]\n+sage: g = Gamma0(15)(matrix([[-4, -3], [15, 11]]))\n+sage: f.period(g)\n+2.17298044293747e-16 - 1.59624222213178*I\n+```\n+\n+In the future we should have functions which allow for pairing of the following:\n \n -cuspidal modular symbols for Gamma0(N) with cusp forms for Gamma0(N)\n \n--cusp forms for Gamma0(N) with cusp forms Gamma0(N) (petersson inner product)\n+-cusp forms for Gamma0(N) with cusp forms for Gamma0(N) (Petersson inner product)\n \n--group elements of Gamma0(N) with cusp forms for Gamma0(N)\n-\n-Once this is done what works for cusp forms should be extended to Meromorphic Differentials of the second kind. \n-They should be implemented so that things like\n-\n-```\n-sage: f = CuspForm(15,2).basis()[0]\n-sage: g = Gamma0(15).random_element()\n-sage: f.pair(g)\n---some number--\n-```\n-should work. Observe that Gamma0(15).random_element() is not implemented. A reference for this is chapter 2 of Cremona. \n-\n-I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???\n-\n-Apply [attachment:trac_11215_pairing_with_atkin_lehner.patch]\n``````\n",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146404",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,22 +1,15 @@
-We should have a functions/functions which allow for pairing of the following
+This ticket implements a `period(g)` method for cusp forms of weight 2 for `Gamma0(n)`.  It currently accepts only elements `g` in `Gamma0(n)` as input.
+
+```
+sage: f = Newforms(15, 2)[0]
+sage: g = Gamma0(15)(matrix([[-4, -3], [15, 11]]))
+sage: f.period(g)
+2.17298044293747e-16 - 1.59624222213178*I
+```
+
+In the future we should have functions which allow for pairing of the following:
 
 -cuspidal modular symbols for Gamma0(N) with cusp forms for Gamma0(N)
 
--cusp forms for Gamma0(N) with cusp forms Gamma0(N) (petersson inner product)
+-cusp forms for Gamma0(N) with cusp forms for Gamma0(N) (Petersson inner product)
 
--group elements of Gamma0(N) with cusp forms for Gamma0(N)
-
-Once this is done what works for cusp forms should be extended to Meromorphic Differentials of the second kind. 
-They should be implemented so that things like
-
-```
-sage: f = CuspForm(15,2).basis()[0]
-sage: g = Gamma0(15).random_element()
-sage: f.pair(g)
---some number--
-```
-should work. Observe that Gamma0(15).random_element() is not implemented. A reference for this is chapter 2 of Cremona. 
-
-I'm going to attach some code which doesn't work very well and can be improved by looking at Fricke involutions but at least it's a start. Maybe some people already have some code for this???
-
-Apply [attachment:trac_11215_pairing_with_atkin_lehner.patch]
``````




---

archive/issue_comments_146405.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146405",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_146406.json:
```json
{
    "body": "Changing author from \"tdupu, Fr\u00e9d\u00e9ric Chapoton\" to \"Taylor Dupuy, Fr\u00e9d\u00e9ric Chapoton, Peter Bruin\"",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146406",
    "user": "https://github.com/pjbruin"
}
```

Changing author from "tdupu, Frédéric Chapoton" to "Taylor Dupuy, Frédéric Chapoton, Peter Bruin"



---

archive/issue_comments_146407.json:
```json
{
    "body": "Changing reviewer from \"Aly Deines\" to \"Aly Deines, Peter Bruin\"",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146407",
    "user": "https://github.com/pjbruin"
}
```

Changing reviewer from "Aly Deines" to "Aly Deines, Peter Bruin"



---

archive/issue_comments_146408.json:
```json
{
    "body": "Changing branch from \"u/chapoton/11215\" to \"u/pbruin/11215-ModularForm_period\"",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146408",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "u/chapoton/11215" to "u/pbruin/11215-ModularForm_period"



---

archive/issue_comments_146409.json:
```json
{
    "body": "<a id='comment:16'></a>The new commit renames the method to `period`, and adds a `prec` argument and a line of code to deduce a bound on the number of terms of the series from that.  I don't have a reference for this bound; I just computed a slightly rough but hopefully correct one and put the basic idea in a comment.\n\nThere are various other changes.  All computations are now done in `RealField(prec)` and the associated `ComplexField`.  The method now also checks its input more carefully.\n\nI guess this does not really qualify as a reviewer patch anymore, but it is probably still OK if one of the existing authors reviews these changes instead of a \"disinterested third party\".",
    "created_at": "2014-05-09T23:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146409",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:16'></a>The new commit renames the method to `period`, and adds a `prec` argument and a line of code to deduce a bound on the number of terms of the series from that.  I don't have a reference for this bound; I just computed a slightly rough but hopefully correct one and put the basic idea in a comment.

There are various other changes.  All computations are now done in `RealField(prec)` and the associated `ComplexField`.  The method now also checks its input more carefully.

I guess this does not really qualify as a reviewer patch anymore, but it is probably still OK if one of the existing authors reviews these changes instead of a "disinterested third party".



---

archive/issue_events_029050.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-05-09T23:52:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11215#event-29050"
}
```



---

archive/issue_comments_146410.json:
```json
{
    "body": "<a id='comment:17'></a>you should add doctests for the new raise statements",
    "created_at": "2014-05-10T06:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146410",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>you should add doctests for the new raise statements



---

archive/issue_comments_146411.json:
```json
{
    "body": "<a id='comment:18'></a>I think period is a good name for this.  Can the docstring cross-reference the fact that for f associated to an elliptic curve E there is also the method E.modular_symbol() which gives exact rational output, namely the coordinates of the complex period with respect to the real and imaginary periods?",
    "created_at": "2014-05-10T08:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146411",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:18'></a>I think period is a good name for this.  Can the docstring cross-reference the fact that for f associated to an elliptic curve E there is also the method E.modular_symbol() which gives exact rational output, namely the coordinates of the complex period with respect to the real and imaginary periods?



---

archive/issue_comments_146412.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-10T13:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_146413.json:
```json
{
    "body": "Changing commit from \"f03cb122f8dafcf52767f75fee7075067367bea4\" to \"d2c04c30a114e81be0d2ead49b5f93f3d5a6b8bd\"",
    "created_at": "2014-05-10T13:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146413",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f03cb122f8dafcf52767f75fee7075067367bea4" to "d2c04c30a114e81be0d2ead49b5f93f3d5a6b8bd"



---

archive/issue_comments_146414.json:
```json
{
    "body": "<a id='comment:20'></a>Thanks, Peter -- great example!",
    "created_at": "2014-05-10T13:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146414",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:20'></a>Thanks, Peter -- great example!



---

archive/issue_comments_146415.json:
```json
{
    "body": "<a id='comment:21'></a>OK, I made some small corrections and added documentation and examples.",
    "created_at": "2014-05-10T13:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146415",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:21'></a>OK, I made some small corrections and added documentation and examples.



---

archive/issue_comments_146416.json:
```json
{
    "body": "Changing commit from \"d2c04c30a114e81be0d2ead49b5f93f3d5a6b8bd\" to \"d274045bc4cccde6b6f85432d54d21ade52e9a16\"",
    "created_at": "2014-05-10T17:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146416",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d2c04c30a114e81be0d2ead49b5f93f3d5a6b8bd" to "d274045bc4cccde6b6f85432d54d21ade52e9a16"



---

archive/issue_comments_146417.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-10T17:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_146418.json:
```json
{
    "body": "<a id='comment:23'></a>ok, this looks good to me and the bot is happy. positive review",
    "created_at": "2014-06-04T19:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146418",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>ok, this looks good to me and the bot is happy. positive review



---

archive/issue_comments_146419.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-04T19:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146419",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_146420.json:
```json
{
    "body": "Changing keywords from \"\" to \"modular form\".",
    "created_at": "2014-06-04T19:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146420",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "modular form".



---

archive/issue_comments_146421.json:
```json
{
    "body": "Changing reviewer from \"Aly Deines, Peter Bruin\" to \"Aly Deines, Peter Bruin, Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2014-06-04T19:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146421",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "Aly Deines, Peter Bruin" to "Aly Deines, Peter Bruin, Frédéric Chapoton"



---

archive/issue_comments_146422.json:
```json
{
    "body": "<a id='comment:24'></a>Conflicts, please merge in the latest beta",
    "created_at": "2014-06-05T12:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146422",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>Conflicts, please merge in the latest beta



---

archive/issue_comments_146423.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-06-05T12:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146423",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_146424.json:
```json
{
    "body": "Changing commit from \"d274045bc4cccde6b6f85432d54d21ade52e9a16\" to \"14231c961633db1b20e992357aae69191fdef49e\"",
    "created_at": "2014-06-05T15:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d274045bc4cccde6b6f85432d54d21ade52e9a16" to "14231c961633db1b20e992357aae69191fdef49e"



---

archive/issue_comments_146425.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-05T15:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_146426.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-06-05T15:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146426",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_146427.json:
```json
{
    "body": "<a id='comment:27'></a>Merged development branch, all tests pass.",
    "created_at": "2014-06-05T15:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146427",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:27'></a>Merged development branch, all tests pass.



---

archive/issue_events_029051.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-06T18:07:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11215#event-29051"
}
```



---

archive/issue_comments_146428.json:
```json
{
    "body": "Changing branch from \"u/pbruin/11215-ModularForm_period\" to \"14231c961633db1b20e992357aae69191fdef49e\"",
    "created_at": "2014-06-06T18:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146428",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/pbruin/11215-ModularForm_period" to "14231c961633db1b20e992357aae69191fdef49e"



---

archive/issue_comments_146429.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-06T18:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11215#issuecomment-146429",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
