# Issue 11751: make free_module_generic_pid also work for pid's other than integers

archive/issues_011579.json:
```json
{
    "body": "Before this patch the following code would fail\n\n```\nsage: R.<x> = QQ[]\nsage: L = R^1\nsage: M = L.span([[1/x]])\nsage: M([1/x])\n```\n\n---\n\nApply\n1. [attachment:11751_free_module_generic_pid-fix.patch]\n2. [attachment:trac_11751_free_module_generic_pid-review.patch]\n3. [attachment:trac_11751_whitespace.patch]\nto the Sage library.\n\n\n**Assignee:** @jasongrout, @williamstein\n\n**Reviewer:** Julian Rueth, Maarten Derickx\n\n**Author:** Maarten Derickx, Julian Rueth\n\n**Merged:** sage-4.7.2.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/11751\n\n",
    "closed_at": "2011-09-27T17:42:32Z",
    "created_at": "2011-08-26T21:05:12Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "make free_module_generic_pid also work for pid's other than integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11751",
    "user": "https://github.com/koffie"
}
```
Before this patch the following code would fail

```
sage: R.<x> = QQ[]
sage: L = R^1
sage: M = L.span([[1/x]])
sage: M([1/x])
```

---

Apply
1. [attachment:11751_free_module_generic_pid-fix.patch]
2. [attachment:trac_11751_free_module_generic_pid-review.patch]
3. [attachment:trac_11751_whitespace.patch]
to the Sage library.


**Assignee:** @jasongrout, @williamstein

**Reviewer:** Julian Rueth, Maarten Derickx

**Author:** Maarten Derickx, Julian Rueth

**Merged:** sage-4.7.2.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/11751





---

archive/attachments_015558.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "11751_free_module_generic_pid-fix.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11751/11751_free_module_generic_pid-fix.patch",
    "created_at": "2011-09-01T02:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/koffie"
}
```



---

archive/issue_comments_125960.json:
```json
{
    "body": "<a id='comment:1'></a>\n",
    "created_at": "2011-09-01T02:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125960",
    "user": "https://github.com/koffie"
}
```

<a id='comment:1'></a>




---

archive/issue_comments_125961.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,18 @@\n+Before this patch the following code would fail horribly\n \n+sage: R.<x>=QQ[] \n+sage: L=R^1 \n+sage: a=L.span([(1/x,)]) \n+sage: a \n+Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field \n+Echelon basis matrix: \n+[1/x] \n+sage: b=L.span([(1/x,)]) \n+sage: a(b.gens()[0]) \n+(1/x) \n+sage: L2 = R^2 \n+sage: L2.span([[(x<sup>2+x)/(x</sup>2-3*x+2),1/5],[(x<sup>2+2*x)/(x</sup>2-4*x+3),x]]) \n+Free module of degree 2 and rank 2 over Univariate Polynomial Ring in x over Rational Field \n+Echelon basis matrix: \n+[x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] \n+[                         0 x^3 - 11/5*x^2 - 3*x + 4/5] \n``````\n",
    "created_at": "2011-09-01T02:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125961",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,18 @@
+Before this patch the following code would fail horribly
 
+sage: R.<x>=QQ[] 
+sage: L=R^1 
+sage: a=L.span([(1/x,)]) 
+sage: a 
+Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field 
+Echelon basis matrix: 
+[1/x] 
+sage: b=L.span([(1/x,)]) 
+sage: a(b.gens()[0]) 
+(1/x) 
+sage: L2 = R^2 
+sage: L2.span([[(x<sup>2+x)/(x</sup>2-3*x+2),1/5],[(x<sup>2+2*x)/(x</sup>2-4*x+3),x]]) 
+Free module of degree 2 and rank 2 over Univariate Polynomial Ring in x over Rational Field 
+Echelon basis matrix: 
+[x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] 
+[                         0 x^3 - 11/5*x^2 - 3*x + 4/5] 
``````




---

archive/issue_comments_125962.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,6 @@\n Before this patch the following code would fail horribly\n \n+```\n sage: R.<x>=QQ[] \n sage: L=R^1 \n sage: a=L.span([(1/x,)]) \n@@ -11,8 +12,9 @@\n sage: a(b.gens()[0]) \n (1/x) \n sage: L2 = R^2 \n-sage: L2.span([[(x<sup>2+x)/(x</sup>2-3*x+2),1/5],[(x<sup>2+2*x)/(x</sup>2-4*x+3),x]]) \n+sage: L2.span([[(x^2+x)/(x^2-3*x+2),1/5],[(x^2+2*x)/(x^2-4*x+3),x]]) \n Free module of degree 2 and rank 2 over Univariate Polynomial Ring in x over Rational Field \n Echelon basis matrix: \n [x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] \n [                         0 x^3 - 11/5*x^2 - 3*x + 4/5] \n+```\n``````\n",
    "created_at": "2011-09-01T02:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125962",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,6 @@
 Before this patch the following code would fail horribly
 
+```
 sage: R.<x>=QQ[] 
 sage: L=R^1 
 sage: a=L.span([(1/x,)]) 
@@ -11,8 +12,9 @@
 sage: a(b.gens()[0]) 
 (1/x) 
 sage: L2 = R^2 
-sage: L2.span([[(x<sup>2+x)/(x</sup>2-3*x+2),1/5],[(x<sup>2+2*x)/(x</sup>2-4*x+3),x]]) 
+sage: L2.span([[(x^2+x)/(x^2-3*x+2),1/5],[(x^2+2*x)/(x^2-4*x+3),x]]) 
 Free module of degree 2 and rank 2 over Univariate Polynomial Ring in x over Rational Field 
 Echelon basis matrix: 
 [x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] 
 [                         0 x^3 - 11/5*x^2 - 3*x + 4/5] 
+```
``````




---

archive/issue_comments_125963.json:
```json
{
    "body": "<a id='comment:3'></a>\nChanging the is into == is needed to make the example in the description work but in introduced some other strange bugs:\n\n\n\tsage -t  devel/sage-main/sage/modules/quotient_module.py # 1 doctests failed\n\tsage -t  devel/sage-main/sage/modules/fg_pid/fgp_element.py # 3 doctests failed\n\tsage -t  devel/sage-main/sage/modules/free_module_element.pyx # 3 doctests failed",
    "created_at": "2011-09-01T02:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125963",
    "user": "https://github.com/koffie"
}
```

<a id='comment:3'></a>
Changing the is into == is needed to make the example in the description work but in introduced some other strange bugs:


	sage -t  devel/sage-main/sage/modules/quotient_module.py # 1 doctests failed
	sage -t  devel/sage-main/sage/modules/fg_pid/fgp_element.py # 3 doctests failed
	sage -t  devel/sage-main/sage/modules/free_module_element.pyx # 3 doctests failed



---

archive/issue_comments_125964.json:
```json
{
    "body": "<a id='comment:4'></a>\nA full output of the errors is shown in http://pastebin.com/4B4xmRDZ",
    "created_at": "2011-09-01T02:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125964",
    "user": "https://github.com/koffie"
}
```

<a id='comment:4'></a>
A full output of the errors is shown in http://pastebin.com/4B4xmRDZ



---

archive/issue_comments_125965.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt seems that the line `entries = [R(x) for x in entries]` in *coerce.pyx* (roughly line 3540) is wrong. The components of a element in a free R module may not be in R at all. I'm working on a fix for that.",
    "created_at": "2011-09-02T07:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125965",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:5'></a>
It seems that the line `entries = [R(x) for x in entries]` in *coerce.pyx* (roughly line 3540) is wrong. The components of a element in a free R module may not be in R at all. I'm working on a fix for that.



---

archive/issue_events_096119.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2011-09-05T14:22:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11751#event-96119"
}
```



---

archive/issue_comments_125966.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe patch looks good :). Didn't try it yet how it works with doctests and  yet but at least the code looks reasonable.\n\nIf this passes all test, then at least I want something like the following as a doctest:\n\n```\nsage: L=K^2\nsage: R=L.span([[x,1/x]])\nsage: R.basis()[0][0]\nx\nsage: R.basis()[0][0].parent()\nFraction Field of Univariate Polynomial Ring in x over Rational Field\nsage: R=L.span([[x,x^2]])\nsage: R.basis()[0][0].parent()\nUnivariate Polynomial Ring in x over Rational Field\n```\nSince if we are going to look at the parent of one specific element, then we certainly want that it depends in the right way of the other elements. \n\nA neater way to do this would be to actually store \"coefficient_ring\" in the parent, since I think that \n\n```\nparent.basis()[0][0].parent()\n```\nIs way to many steps removed from parent to actually directly acces from the code. But this is just nitpicking. \n\nI'm now doctesting your patch.",
    "created_at": "2011-09-05T19:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125966",
    "user": "https://github.com/koffie"
}
```

<a id='comment:7'></a>
The patch looks good :). Didn't try it yet how it works with doctests and  yet but at least the code looks reasonable.

If this passes all test, then at least I want something like the following as a doctest:

```
sage: L=K^2
sage: R=L.span([[x,1/x]])
sage: R.basis()[0][0]
x
sage: R.basis()[0][0].parent()
Fraction Field of Univariate Polynomial Ring in x over Rational Field
sage: R=L.span([[x,x^2]])
sage: R.basis()[0][0].parent()
Univariate Polynomial Ring in x over Rational Field
```
Since if we are going to look at the parent of one specific element, then we certainly want that it depends in the right way of the other elements. 

A neater way to do this would be to actually store "coefficient_ring" in the parent, since I think that 

```
parent.basis()[0][0].parent()
```
Is way to many steps removed from parent to actually directly acces from the code. But this is just nitpicking. 

I'm now doctesting your patch.



---

archive/attachments_015559.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11751_free_module_generic_pid-review.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11751/trac_11751_free_module_generic_pid-review.patch",
    "created_at": "2011-09-10T20:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/koffie"
}
```



---

archive/issue_comments_125967.json:
```json
{
    "body": "fixes the failing doctests",
    "created_at": "2011-09-10T20:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125967",
    "user": "https://github.com/koffie"
}
```

fixes the failing doctests



---

archive/issue_comments_125968.json:
```json
{
    "body": "<a id='comment:8'></a>\nI added a new patch, since we should also fix sparse modules (they suffer from the exact same bug). Running doctests now.",
    "created_at": "2011-09-10T20:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125968",
    "user": "https://github.com/koffie"
}
```

<a id='comment:8'></a>
I added a new patch, since we should also fix sparse modules (they suffer from the exact same bug). Running doctests now.



---

archive/issue_comments_125969.json:
```json
{
    "body": "<a id='comment:9'></a>\nAll tests pass so this again needs a review for the added sparse code.",
    "created_at": "2011-09-10T20:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125969",
    "user": "https://github.com/koffie"
}
```

<a id='comment:9'></a>
All tests pass so this again needs a review for the added sparse code.



---

archive/issue_comments_125970.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,3 +18,6 @@\n [x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] \n [                         0 x^3 - 11/5*x^2 - 3*x + 4/5] \n ```\n+\n+First apply: http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/11751_free_module_generic_pid-fix.patch\n+and then http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/trac_11751_free_module_generic_pid-review.patch\n``````\n",
    "created_at": "2011-09-10T20:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125970",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,3 +18,6 @@
 [x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] 
 [                         0 x^3 - 11/5*x^2 - 3*x + 4/5] 
 ```
+
+First apply: http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/11751_free_module_generic_pid-fix.patch
+and then http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/trac_11751_free_module_generic_pid-review.patch
``````




---

archive/issue_comments_125971.json:
```json
{
    "body": "**Author:** Maarten Derickx, Julian Rueth",
    "created_at": "2011-09-19T12:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125971",
    "user": "https://github.com/saraedum"
}
```

**Author:** Maarten Derickx, Julian Rueth



---

archive/issue_comments_125972.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,23 +1,19 @@\n-Before this patch the following code would fail horribly\n+Before this patch the following code would fail\n \n ```\n sage: R.<x>=QQ[] \n sage: L=R^1 \n-sage: a=L.span([(1/x,)]) \n-sage: a \n-Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field \n-Echelon basis matrix: \n-[1/x] \n-sage: b=L.span([(1/x,)]) \n-sage: a(b.gens()[0]) \n-(1/x) \n-sage: L2 = R^2 \n-sage: L2.span([[(x^2+x)/(x^2-3*x+2),1/5],[(x^2+2*x)/(x^2-4*x+3),x]]) \n-Free module of degree 2 and rank 2 over Univariate Polynomial Ring in x over Rational Field \n-Echelon basis matrix: \n-[x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] \n-[                         0 x^3 - 11/5*x^2 - 3*x + 4/5] \n+sage: L.span([(1/x,)]) \n+TypeError\n ```\n \n-First apply: http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/11751_free_module_generic_pid-fix.patch\n-and then http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/trac_11751_free_module_generic_pid-review.patch\n+Now it works\n+\n+```\n+sage: R.<x>=QQ[] \n+sage: L=R^1 \n+sage: L.span([(1/x,)])\n+Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field\n+Echelon basis matrix:\n+[1/x]\n+```\n``````\n",
    "created_at": "2011-09-19T12:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125972",
    "user": "https://github.com/saraedum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,23 +1,19 @@
-Before this patch the following code would fail horribly
+Before this patch the following code would fail
 
 ```
 sage: R.<x>=QQ[] 
 sage: L=R^1 
-sage: a=L.span([(1/x,)]) 
-sage: a 
-Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field 
-Echelon basis matrix: 
-[1/x] 
-sage: b=L.span([(1/x,)]) 
-sage: a(b.gens()[0]) 
-(1/x) 
-sage: L2 = R^2 
-sage: L2.span([[(x^2+x)/(x^2-3*x+2),1/5],[(x^2+2*x)/(x^2-4*x+3),x]]) 
-Free module of degree 2 and rank 2 over Univariate Polynomial Ring in x over Rational Field 
-Echelon basis matrix: 
-[x/(x^3 - 6*x^2 + 11*x - 6)  2/15*x^2 - 17/75*x - 1/75] 
-[                         0 x^3 - 11/5*x^2 - 3*x + 4/5] 
+sage: L.span([(1/x,)]) 
+TypeError
 ```
 
-First apply: http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/11751_free_module_generic_pid-fix.patch
-and then http://trac.sagemath.org/sage_trac/raw-attachment/ticket/11751/trac_11751_free_module_generic_pid-review.patch
+Now it works
+
+```
+sage: R.<x>=QQ[] 
+sage: L=R^1 
+sage: L.span([(1/x,)])
+Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field
+Echelon basis matrix:
+[1/x]
+```
``````




---

archive/issue_events_096120.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2011-09-19T12:24:05Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "rename": {
        "from": "make free_module_generic_pid also work for pid's other then integers",
        "to": "make free_module_generic_pid also work for pid's other than integers"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11751#event-96120"
}
```



---

archive/issue_comments_125973.json:
```json
{
    "body": "**Reviewer:** Maarten Derickx, Julian Rueth",
    "created_at": "2011-09-19T12:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125973",
    "user": "https://github.com/saraedum"
}
```

**Reviewer:** Maarten Derickx, Julian Rueth



---

archive/issue_events_096121.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2011-09-19T13:12:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11751#event-96121"
}
```



---

archive/issue_events_096122.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2011-09-19T13:12:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11751#event-96122"
}
```



---

archive/issue_comments_125974.json:
```json
{
    "body": "<a id='comment:12'></a>\nthe patches apply to 4.7.2.alpha2 and all doctests pass.",
    "created_at": "2011-09-19T13:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125974",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:12'></a>
the patches apply to 4.7.2.alpha2 and all doctests pass.



---

archive/issue_comments_125975.json:
```json
{
    "body": "<a id='comment:13'></a>\napply: 11751_free_module_generic_pid-fix.patch, trac_11751_free_module_generic_pid-review.patch and trac_11751_whitespace.patch",
    "created_at": "2011-09-19T13:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125975",
    "user": "https://github.com/koffie"
}
```

<a id='comment:13'></a>
apply: 11751_free_module_generic_pid-fix.patch, trac_11751_free_module_generic_pid-review.patch and trac_11751_whitespace.patch



---

archive/issue_comments_125976.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -17,3 +17,5 @@\n Echelon basis matrix:\n [1/x]\n ```\n+\n+apply: 11751_free_module_generic_pid-fix.patch, trac_11751_free_module_generic_pid-review.patch and trac_11751_whitespace.patch\n``````\n",
    "created_at": "2011-09-19T13:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125976",
    "user": "https://github.com/koffie"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -17,3 +17,5 @@
 Echelon basis matrix:
 [1/x]
 ```
+
+apply: 11751_free_module_generic_pid-fix.patch, trac_11751_free_module_generic_pid-review.patch and trac_11751_whitespace.patch
``````




---

archive/issue_comments_125977.json:
```json
{
    "body": "**Changing reviewer** from \"Maarten Derickx, Julian Rueth\" to \"Julian Rueth, Maarten Derickx\".",
    "created_at": "2011-09-19T15:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125977",
    "user": "https://github.com/nexttime"
}
```

**Changing reviewer** from "Maarten Derickx, Julian Rueth" to "Julian Rueth, Maarten Derickx".



---

archive/issue_comments_125978.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,4 +18,11 @@\n [1/x]\n ```\n \n-apply: 11751_free_module_generic_pid-fix.patch, trac_11751_free_module_generic_pid-review.patch and trac_11751_whitespace.patch\n+---\n+\n+Apply\n+1. [attachment:11751_free_module_generic_pid-fix.patch]\n+2. [attachment:trac_11751_free_module_generic_pid-review.patch]\n+3. [attachment:trac_11751_whitespace.patch]\n+to the Sage library.\n+\n``````\n",
    "created_at": "2011-09-19T15:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125978",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,4 +18,11 @@
 [1/x]
 ```
 
-apply: 11751_free_module_generic_pid-fix.patch, trac_11751_free_module_generic_pid-review.patch and trac_11751_whitespace.patch
+---
+
+Apply
+1. [attachment:11751_free_module_generic_pid-fix.patch]
+2. [attachment:trac_11751_free_module_generic_pid-review.patch]
+3. [attachment:trac_11751_whitespace.patch]
+to the Sage library.
+
``````




---

archive/issue_events_096123.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-27T17:42:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11751#event-96123"
}
```



---

archive/issue_events_096124.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-27T17:42:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11751#event-96124"
}
```



---

archive/issue_comments_125979.json:
```json
{
    "body": "**Merged:** sage-4.7.2.alpha3",
    "created_at": "2011-09-27T17:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125979",
    "user": "https://github.com/nexttime"
}
```

**Merged:** sage-4.7.2.alpha3



---

archive/issue_comments_125980.json:
```json
{
    "body": "small review patch to fix some whitespace and doc issues",
    "created_at": "2011-10-04T10:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125980",
    "user": "https://github.com/jdemeyer"
}
```

small review patch to fix some whitespace and doc issues



---

archive/attachments_015560.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11751_whitespace.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11751/trac_11751_whitespace.patch",
    "created_at": "2014-12-29T09:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_125981.json:
```json
{
    "body": "<a id='comment:16'></a>\nI really don't like the way how this was fixed. First of all, why is this even a bug? If you need fractions, I think you should use the fraction field from the beginning.\n\nSecond, it causes the computation of a basis(!) every time that `vector()` is called.\n\nI am working on initialization of vectors in #17561 and I would actually like to revert this fix and make\n\n```\nsage: R.<x> = QQ[] \nsage: L = R^1 \nsage: L.span([(1/x,)]) \n```\na `TypeError` again.",
    "created_at": "2014-12-29T09:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125981",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
I really don't like the way how this was fixed. First of all, why is this even a bug? If you need fractions, I think you should use the fraction field from the beginning.

Second, it causes the computation of a basis(!) every time that `vector()` is called.

I am working on initialization of vectors in #17561 and I would actually like to revert this fix and make

```
sage: R.<x> = QQ[] 
sage: L = R^1 
sage: L.span([(1/x,)]) 
```
a `TypeError` again.



---

archive/issue_comments_125982.json:
```json
{
    "body": "<a id='comment:17'></a>\nok, I get it now. The issue is more complex than what the description shows.",
    "created_at": "2014-12-29T09:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125982",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
ok, I get it now. The issue is more complex than what the description shows.



---

archive/issue_comments_125983.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,21 +1,10 @@\n Before this patch the following code would fail\n \n ```\n-sage: R.<x>=QQ[] \n-sage: L=R^1 \n-sage: L.span([(1/x,)]) \n-TypeError\n-```\n-\n-Now it works\n-\n-```\n-sage: R.<x>=QQ[] \n-sage: L=R^1 \n-sage: L.span([(1/x,)])\n-Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field\n-Echelon basis matrix:\n-[1/x]\n+sage: R.<x> = QQ[]\n+sage: L = R^1\n+sage: M = L.span([[1/x]])\n+sage: M([1/x])\n ```\n \n ---\n``````\n",
    "created_at": "2014-12-29T09:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125983",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,21 +1,10 @@
 Before this patch the following code would fail
 
 ```
-sage: R.<x>=QQ[] 
-sage: L=R^1 
-sage: L.span([(1/x,)]) 
-TypeError
-```
-
-Now it works
-
-```
-sage: R.<x>=QQ[] 
-sage: L=R^1 
-sage: L.span([(1/x,)])
-Free module of degree 1 and rank 1 over Univariate Polynomial Ring in x over Rational Field
-Echelon basis matrix:
-[1/x]
+sage: R.<x> = QQ[]
+sage: L = R^1
+sage: M = L.span([[1/x]])
+sage: M([1/x])
 ```
 
 ---
``````




---

archive/issue_comments_125984.json:
```json
{
    "body": "<a id='comment:18'></a>\nAnyway, I'm fixing the `basis()` issue by adding a new method `basis_ring()` to free modules.",
    "created_at": "2014-12-29T09:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11751",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11751#issuecomment-125984",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Anyway, I'm fixing the `basis()` issue by adding a new method `basis_ring()` to free modules.
