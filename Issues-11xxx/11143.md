# Issue 11143: define symbolic functions for exponential integrals

archive/issues_011000.json:
```json
{
    "body": "We're missing some conversions from Maxima.  Like exponential integrals of various kinds.\n\n```\nsage: f(x) = e^(-x) * log(x+1)\nsage: uu = integral(f,x,0,oo)\nsage: uu\nx |--> e*expintegral_e(1, 1)\n```\nSee [this ask.sagemath post](http://ask.sagemath.org/question/488/calculating-integral) for some details.\n\n## Current symbol conversion table\nFrom `sage.symbolic.pynac.symbol_table['maxima']` as of Sage-4.7\n\n```\nMaxima ---> Sage\n\n%gamma ---> euler_gamma\n%pi ---> pi\n(1+sqrt(5))/2 ---> golden_ratio\nacos ---> arccos\nacosh ---> arccosh\nacot ---> arccot\nacoth ---> arccoth\nacsc ---> arccsc\nacsch ---> arccsch\nasec ---> arcsec\nasech ---> arcsech\nasin ---> arcsin\nasinh ---> arcsinh\natan ---> arctan\natan2 ---> arctan2\natanh ---> arctanh\nbinomial ---> binomial\nbrun ---> brun\ncatalan ---> catalan\nceiling ---> ceil\ncos ---> cos\ndelta ---> dirac_delta\nelliptic_e ---> elliptic_e\nelliptic_ec ---> elliptic_ec\nelliptic_eu ---> elliptic_eu\nelliptic_f ---> elliptic_f\nelliptic_kc ---> elliptic_kc\nelliptic_pi ---> elliptic_pi\nexp ---> exp\nexpintegral_e ---> En\nfactorial ---> factorial\ngamma_incomplete ---> gamma\nglaisher ---> glaisher\nimagpart ---> imag_part\ninf ---> +Infinity\ninfinity ---> Infinity\nkhinchin ---> khinchin\nkron_delta ---> kronecker_delta\nli[2] ---> dilog\nlog ---> log\nlog(2) ---> log2\nmertens ---> mertens\nminf ---> -Infinity\npsi[0] ---> psi\nrealpart ---> real_part\nsignum ---> sgn\nsin ---> sin\ntwinprime ---> twinprime\n```\n\n# Summary of missing conversions\n\n## Special functions defined in Maxima\n(http://maxima.sourceforge.net/docs/manual/en/maxima_16.html#SEC56)\n\n```\nbessel_j (index, expr)         Bessel function, 1st kind\nbessel_y (index, expr)         Bessel function, 2nd kind\nbessel_i (index, expr)         Modified Bessel function, 1st kind\nbessel_k (index, expr)         Modified Bessel function, 2nd kind\n```\n\n* Notes: bessel_I, bessel_J, etc. are functions in Sage for numerical evaluation. There is also the `Bessel` class, but no conversions from Maxima's bessel_i etc. to Sage.\n\n```\nhankel_1 (v,z)                 Hankel function of the 1st kind\nhankel_2 (v,z)                 Hankel function of the 2nd kind\nstruve_h (v,z)                 Struve H function\nstruve_l (v,z)                 Struve L function\n```\n\n* Notes: None of these functions are currently exposed at the top level in Sage. Evaluation is possible using mpmath.\n\n```\nassoc_legendre_p[v,u] (z)      Legendre function of degree v and order u \nassoc_legendre_q[v,u] (z)      Legendre function, 2nd kind\n```\n\n* Notes: In Sage we have `legendre_P(n, x)` and `legendre_Q(n, x)` both described as Legendre functions. It's not clear to me how there are related to Maxima's versions since the number of arguments differs.\n\n```\n%f[p,q] ([], [], expr)         Generalized Hypergeometric function\nhypergeometric(l1, l2, z)      Hypergeometric function\nslommel\n%m[u,k] (z)                    Whittaker function, 1st kind\n%w[u,k] (z)                    Whittaker function, 2nd kind\n```\n\n* Notes: `hypergeometric(l1, l2, z)` needs a conversion to Sage's `hypergeometric_U`. The others can be evaluated using mpmath. `slommel` is presumably mpmath's `lommels1()` or `lommels2()` (or both?). This isn't well documented in Maxima.\n\n```\nexpintegral_e (v,z)            Exponential integral E\nexpintegral_e1 (z)             Exponential integral E1\nexpintegral_ei (z)             Exponential integral Ei\nexpintegral_li (z)             Logarithmic integral Li\nexpintegral_si (z)             Exponential integral Si\nexpintegral_ci (z)             Exponential integral Ci\nexpintegral_shi (z)            Exponential integral Shi\nexpintegral_chi (z)            Exponential integral Chi\nerfc (z)                       Complement of the erf function\n```\n\n* Notes: The exponential integral functions `expintegral_e1` and `expintegral_ei (z)` are called `exponential_integral_1` and `Ei` resp. in Sage. They both need conversions. The rest need `BuiltinFunction` classes defined for them with evaluation handled by mpmath and the symbol table conversion added. Also, `erfc` is called `error_fcn`, so also needs a conversion.\n\n```\nkelliptic (z)                  Complete elliptic integral of the first \n                               kind (K)\nparabolic_cylinder_d (v,z)     Parabolic cylinder D function\n```\n\n* Notes: `kelliptic(z)` needs a conversion to `elliptic_kc` in Sage and `parabolic_cylinder_d (v,z)` does not seem to be exposed at top level. It can be evaluated by mpmath.\n\n---\n\nApply to the Sage library:\n1. [attachment:trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)\n2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n\nDepends on #13109\n\n**Assignee:** @benjaminfjones\n\n**Keywords:** ei Ei special function maxima sd32 sd40.5\n\n**Reviewer:** Burcin Erocal, Karl-Dieter Crisman, William Stein\n\n**Author:** Benjamin Jones, Volker Braun\n\n**Merged:** sage-5.3.beta2\n\nIssue created by migration from https://trac.sagemath.org/ticket/11143\n\n",
    "closed_at": "2012-08-14T07:02:21Z",
    "created_at": "2011-04-07T01:50:23Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.3",
    "title": "define symbolic functions for exponential integrals",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/11143",
    "user": "https://github.com/kcrisman"
}
```
We're missing some conversions from Maxima.  Like exponential integrals of various kinds.

```
sage: f(x) = e^(-x) * log(x+1)
sage: uu = integral(f,x,0,oo)
sage: uu
x |--> e*expintegral_e(1, 1)
```
See [this ask.sagemath post](http://ask.sagemath.org/question/488/calculating-integral) for some details.

## Current symbol conversion table
From `sage.symbolic.pynac.symbol_table['maxima']` as of Sage-4.7

```
Maxima ---> Sage

%gamma ---> euler_gamma
%pi ---> pi
(1+sqrt(5))/2 ---> golden_ratio
acos ---> arccos
acosh ---> arccosh
acot ---> arccot
acoth ---> arccoth
acsc ---> arccsc
acsch ---> arccsch
asec ---> arcsec
asech ---> arcsech
asin ---> arcsin
asinh ---> arcsinh
atan ---> arctan
atan2 ---> arctan2
atanh ---> arctanh
binomial ---> binomial
brun ---> brun
catalan ---> catalan
ceiling ---> ceil
cos ---> cos
delta ---> dirac_delta
elliptic_e ---> elliptic_e
elliptic_ec ---> elliptic_ec
elliptic_eu ---> elliptic_eu
elliptic_f ---> elliptic_f
elliptic_kc ---> elliptic_kc
elliptic_pi ---> elliptic_pi
exp ---> exp
expintegral_e ---> En
factorial ---> factorial
gamma_incomplete ---> gamma
glaisher ---> glaisher
imagpart ---> imag_part
inf ---> +Infinity
infinity ---> Infinity
khinchin ---> khinchin
kron_delta ---> kronecker_delta
li[2] ---> dilog
log ---> log
log(2) ---> log2
mertens ---> mertens
minf ---> -Infinity
psi[0] ---> psi
realpart ---> real_part
signum ---> sgn
sin ---> sin
twinprime ---> twinprime
```

# Summary of missing conversions

## Special functions defined in Maxima
(http://maxima.sourceforge.net/docs/manual/en/maxima_16.html#SEC56)

```
bessel_j (index, expr)         Bessel function, 1st kind
bessel_y (index, expr)         Bessel function, 2nd kind
bessel_i (index, expr)         Modified Bessel function, 1st kind
bessel_k (index, expr)         Modified Bessel function, 2nd kind
```

* Notes: bessel_I, bessel_J, etc. are functions in Sage for numerical evaluation. There is also the `Bessel` class, but no conversions from Maxima's bessel_i etc. to Sage.

```
hankel_1 (v,z)                 Hankel function of the 1st kind
hankel_2 (v,z)                 Hankel function of the 2nd kind
struve_h (v,z)                 Struve H function
struve_l (v,z)                 Struve L function
```

* Notes: None of these functions are currently exposed at the top level in Sage. Evaluation is possible using mpmath.

```
assoc_legendre_p[v,u] (z)      Legendre function of degree v and order u 
assoc_legendre_q[v,u] (z)      Legendre function, 2nd kind
```

* Notes: In Sage we have `legendre_P(n, x)` and `legendre_Q(n, x)` both described as Legendre functions. It's not clear to me how there are related to Maxima's versions since the number of arguments differs.

```
%f[p,q] ([], [], expr)         Generalized Hypergeometric function
hypergeometric(l1, l2, z)      Hypergeometric function
slommel
%m[u,k] (z)                    Whittaker function, 1st kind
%w[u,k] (z)                    Whittaker function, 2nd kind
```

* Notes: `hypergeometric(l1, l2, z)` needs a conversion to Sage's `hypergeometric_U`. The others can be evaluated using mpmath. `slommel` is presumably mpmath's `lommels1()` or `lommels2()` (or both?). This isn't well documented in Maxima.

```
expintegral_e (v,z)            Exponential integral E
expintegral_e1 (z)             Exponential integral E1
expintegral_ei (z)             Exponential integral Ei
expintegral_li (z)             Logarithmic integral Li
expintegral_si (z)             Exponential integral Si
expintegral_ci (z)             Exponential integral Ci
expintegral_shi (z)            Exponential integral Shi
expintegral_chi (z)            Exponential integral Chi
erfc (z)                       Complement of the erf function
```

* Notes: The exponential integral functions `expintegral_e1` and `expintegral_ei (z)` are called `exponential_integral_1` and `Ei` resp. in Sage. They both need conversions. The rest need `BuiltinFunction` classes defined for them with evaluation handled by mpmath and the symbol table conversion added. Also, `erfc` is called `error_fcn`, so also needs a conversion.

```
kelliptic (z)                  Complete elliptic integral of the first 
                               kind (K)
parabolic_cylinder_d (v,z)     Parabolic cylinder D function
```

* Notes: `kelliptic(z)` needs a conversion to `elliptic_kc` in Sage and `parabolic_cylinder_d (v,z)` does not seem to be exposed at top level. It can be evaluated by mpmath.

---

Apply to the Sage library:
1. [attachment:trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)
2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)

Depends on #13109

**Assignee:** @benjaminfjones

**Keywords:** ei Ei special function maxima sd32 sd40.5

**Reviewer:** Burcin Erocal, Karl-Dieter Crisman, William Stein

**Author:** Benjamin Jones, Volker Braun

**Merged:** sage-5.3.beta2

Issue created by migration from https://trac.sagemath.org/ticket/11143





---

archive/issue_comments_112929.json:
```json
{
    "body": "<a id='comment:1'></a>\nAs far as I can tell, the general `exponential_e` function isn't available directly in Sage or in PARI (which is used to evaluate the `exponential_integral_1` function in Sage). \n\nAlso, it's possible to get maxima to rewrite the exponential integrals in terms of gamma functions like so: \n\n```python\nsage: maxima.eval('expintrep:gamma_incomplete')\n'gamma_incomplete'\nsage: maxima.integrate(exp(-x)*log(x+1), x, 0, oo)\n%e*gamma_incomplete(0,1)\nsage: N(e*gamma(0,1), digits=18)\n0.596347362323194074\n```\n\nBut as you see, `gamma_incomplete` isn't defined in Sage either, but the table `sage.symbolic.pynac.symbol_table['maxima']` lists the Sage equivalent `gamma`. Anyway, it should be possible to have the maxima interface (with the help of maxima itself) rewrite any exponential integral that Sage doesn't have in terms of gamma functions. \n\nBy the way, the owner on the ticket is @burcin, does that mean they are working on it currently?",
    "created_at": "2011-04-20T20:13:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112929",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:1'></a>
As far as I can tell, the general `exponential_e` function isn't available directly in Sage or in PARI (which is used to evaluate the `exponential_integral_1` function in Sage). 

Also, it's possible to get maxima to rewrite the exponential integrals in terms of gamma functions like so: 

```python
sage: maxima.eval('expintrep:gamma_incomplete')
'gamma_incomplete'
sage: maxima.integrate(exp(-x)*log(x+1), x, 0, oo)
%e*gamma_incomplete(0,1)
sage: N(e*gamma(0,1), digits=18)
0.596347362323194074
```

But as you see, `gamma_incomplete` isn't defined in Sage either, but the table `sage.symbolic.pynac.symbol_table['maxima']` lists the Sage equivalent `gamma`. Anyway, it should be possible to have the maxima interface (with the help of maxima itself) rewrite any exponential integral that Sage doesn't have in terms of gamma functions. 

By the way, the owner on the ticket is @burcin, does that mean they are working on it currently?



---

archive/issue_comments_112930.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [benjaminfjones](#comment%3A1):\n> As far as I can tell, the general `exponential_e` function isn't available directly in Sage or in PARI (which is used to evaluate the `exponential_integral_1` function in Sage). \n\nThat's unfortunate.  However, [mpmath seems to have it](http://mpmath.googlecode.com/svn/trunk/doc/build/functions/expintegrals.html#mpmath.expint).  So we could create a symbolic version and have the `_eval_` method call mpmath, which we seem to be moving to.\n> Also, it's possible to get maxima to rewrite the exponential integrals in terms of gamma functions like so: \n> \n> ```python\n> sage: maxima.eval('expintrep:gamma_incomplete')\n> 'gamma_incomplete'\n> sage: maxima.integrate(exp(-x)*log(x+1), x, 0, oo)\n> %e*gamma_incomplete(0,1)\n> sage: N(e*gamma(0,1), digits=18)\n> 0.596347362323194074\n> ```\n\n\nInteresting.\n\n> But as you see, `gamma_incomplete` isn't defined in Sage either, but the table `sage.symbolic.pynac.symbol_table['maxima']` lists the Sage equivalent `gamma`. \n\nThat should be ok; the whole point of the table is to convert into the Sage equivalent.\n> \n> By the way, the owner on the ticket is @burcin, does that mean they are working on it currently? \n\nNo, that is an automatic thing that happens.  It is possible to be designated an 'owner' of a ticket in a given component, which basically means you automatically get updates.  If you want to 'own' it, please do!  We really have plenty of special functions in Sage, but they are not always well exposed at the top level.\n\nIncidentally, once you comment on a ticket, I believe the default is to copy you in on all replies.  So you didn't have to cc: yourself specially :)",
    "created_at": "2011-04-20T20:42:29Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112930",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
Replying to [benjaminfjones](#comment%3A1):
> As far as I can tell, the general `exponential_e` function isn't available directly in Sage or in PARI (which is used to evaluate the `exponential_integral_1` function in Sage). 

That's unfortunate.  However, [mpmath seems to have it](http://mpmath.googlecode.com/svn/trunk/doc/build/functions/expintegrals.html#mpmath.expint).  So we could create a symbolic version and have the `_eval_` method call mpmath, which we seem to be moving to.
> Also, it's possible to get maxima to rewrite the exponential integrals in terms of gamma functions like so: 
> 
> ```python
> sage: maxima.eval('expintrep:gamma_incomplete')
> 'gamma_incomplete'
> sage: maxima.integrate(exp(-x)*log(x+1), x, 0, oo)
> %e*gamma_incomplete(0,1)
> sage: N(e*gamma(0,1), digits=18)
> 0.596347362323194074
> ```


Interesting.

> But as you see, `gamma_incomplete` isn't defined in Sage either, but the table `sage.symbolic.pynac.symbol_table['maxima']` lists the Sage equivalent `gamma`. 

That should be ok; the whole point of the table is to convert into the Sage equivalent.
> 
> By the way, the owner on the ticket is @burcin, does that mean they are working on it currently? 

No, that is an automatic thing that happens.  It is possible to be designated an 'owner' of a ticket in a given component, which basically means you automatically get updates.  If you want to 'own' it, please do!  We really have plenty of special functions in Sage, but they are not always well exposed at the top level.

Incidentally, once you comment on a ticket, I believe the default is to copy you in on all replies.  So you didn't have to cc: yourself specially :)



---

archive/issue_comments_112931.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [benjaminfjones](#comment%3A1):\n> But as you see, `gamma_incomplete` isn't defined in Sage either, but the table `sage.symbolic.pynac.symbol_table['maxima']` lists the Sage equivalent `gamma`. Anyway, it should be possible to have the maxima interface (with the help of maxima itself) rewrite any exponential integral that Sage doesn't have in terms of gamma functions. \n\n\nIncomplete gamma is defined in Sage. You can access it directly though `incomplete_gamma()` or `gamma_inc()`. The top level function `gamma()` behaves like incomplete gamma if you give it two arguments. IIRC, this is similar to maple.\n\n> By the way, the owner on the ticket is @burcin, does that mean they are working on it currently? \n\n\nI am not working on it. The ticket status `assigned` is supposed to indicate that the owner is working on the problem, but we don't use that much either.",
    "created_at": "2011-04-21T08:10:47Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112931",
    "user": "https://github.com/burcin"
}
```

<a id='comment:4'></a>
Replying to [benjaminfjones](#comment%3A1):
> But as you see, `gamma_incomplete` isn't defined in Sage either, but the table `sage.symbolic.pynac.symbol_table['maxima']` lists the Sage equivalent `gamma`. Anyway, it should be possible to have the maxima interface (with the help of maxima itself) rewrite any exponential integral that Sage doesn't have in terms of gamma functions. 


Incomplete gamma is defined in Sage. You can access it directly though `incomplete_gamma()` or `gamma_inc()`. The top level function `gamma()` behaves like incomplete gamma if you give it two arguments. IIRC, this is similar to maple.

> By the way, the owner on the ticket is @burcin, does that mean they are working on it currently? 


I am not working on it. The ticket status `assigned` is supposed to indicate that the owner is working on the problem, but we don't use that much either.



---

archive/issue_comments_112932.json:
```json
{
    "body": "<a id='comment:5'></a>\nI guess the point of this ticket is to define symbolic function in Sage to represent exponential integrals, etc. The symbolic function class handles adding stuff to the conversion table automatically.\n\nCan we replace this ticket with several beginner tickets? One for each function we are missing.",
    "created_at": "2011-05-25T19:15:01Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112932",
    "user": "https://github.com/burcin"
}
```

<a id='comment:5'></a>
I guess the point of this ticket is to define symbolic function in Sage to represent exponential integrals, etc. The symbolic function class handles adding stuff to the conversion table automatically.

Can we replace this ticket with several beginner tickets? One for each function we are missing.



---

archive/issue_comments_112933.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [burcin](#comment%3A5):\n> I guess the point of this ticket is to define symbolic function in Sage to represent exponential integrals, etc. The symbolic function class handles adding stuff to the conversion table automatically.\n> \n> Can we replace this ticket with several beginner tickets? One for each function we are missing.\n\n\nWell, that would be nice.  But we could also presumably do it directly, if that would solve this problem for now.    Well, either is fine as long as it were to happen.  If you do split this, be sure to give a good template (I mean a link to the template, not write it yourself).",
    "created_at": "2011-06-01T03:09:58Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112933",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
Replying to [burcin](#comment%3A5):
> I guess the point of this ticket is to define symbolic function in Sage to represent exponential integrals, etc. The symbolic function class handles adding stuff to the conversion table automatically.
> 
> Can we replace this ticket with several beginner tickets? One for each function we are missing.


Well, that would be nice.  But we could also presumably do it directly, if that would solve this problem for now.    Well, either is fine as long as it were to happen.  If you do split this, be sure to give a good template (I mean a link to the template, not write it yourself).



---

archive/issue_comments_112934.json:
```json
{
    "body": "<a id='comment:7'></a>\nI'm attempting to write a template for the `expintegral_e` function (denoted E_n(z) in A&S). As I'm looking through the code, I see several models used for the functions and classes in `sage/functions/special.py` and `sage/functions/transcendental.py`\n\n* Functions like `Function_exp_integral` (also called `Ei`) are defined as classes that inherit from `BuiltInFunction` and call the mpmath implementation when evaluated. The function `DickmanRho` also does this and includes other nice methods for approximating values and power series.\n* Functions like `EllipticE` inherit from `MaximaFunction` which handles evaluation, etc. through Maxima. It seems there is an advantage to the mpmath implementation because presumably the interface is faster and the precision is arbitrary (whereas Maxima is limited to 53 bits).\n* Functions like `Li` and `error_fcn` are simply wrapper functions that try to evaluate the input symbolically or numerically depending on context.\n* In `sage/functions/trig.py` there is a mixture of classes that derive from `GinacFunction` (and include information in their `__init__` methods about conversions to other systems like Maxima or Mathematica) and also functions that derive from `BuiltinFunction`. It's not clear to me why some functions are Ginac and some are Builtin.\n\nQuestions: \n\n* For the purposes of this ticket, what is recommended? @kcrisman 's comment leads me to believe that inheriting from the `BuiltinFunction` class and using `mpmath` for evaluation is preferable. \n* Where should the various exponential integral special functions that we are missing go? `sage/functions/special.py`, `sage/functions/transcendental.py`, or somewhere else?",
    "created_at": "2011-06-08T20:27:05Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112934",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:7'></a>
I'm attempting to write a template for the `expintegral_e` function (denoted E_n(z) in A&S). As I'm looking through the code, I see several models used for the functions and classes in `sage/functions/special.py` and `sage/functions/transcendental.py`

* Functions like `Function_exp_integral` (also called `Ei`) are defined as classes that inherit from `BuiltInFunction` and call the mpmath implementation when evaluated. The function `DickmanRho` also does this and includes other nice methods for approximating values and power series.
* Functions like `EllipticE` inherit from `MaximaFunction` which handles evaluation, etc. through Maxima. It seems there is an advantage to the mpmath implementation because presumably the interface is faster and the precision is arbitrary (whereas Maxima is limited to 53 bits).
* Functions like `Li` and `error_fcn` are simply wrapper functions that try to evaluate the input symbolically or numerically depending on context.
* In `sage/functions/trig.py` there is a mixture of classes that derive from `GinacFunction` (and include information in their `__init__` methods about conversions to other systems like Maxima or Mathematica) and also functions that derive from `BuiltinFunction`. It's not clear to me why some functions are Ginac and some are Builtin.

Questions: 

* For the purposes of this ticket, what is recommended? @kcrisman 's comment leads me to believe that inheriting from the `BuiltinFunction` class and using `mpmath` for evaluation is preferable. 
* Where should the various exponential integral special functions that we are missing go? `sage/functions/special.py`, `sage/functions/transcendental.py`, or somewhere else?



---

archive/issue_comments_112935.json:
```json
{
    "body": "<a id='comment:8'></a>\nThose are good questions.  \n\nI think the most important thing is to make sure that whatever is implemented has\n\n* good numerical evaluation (perhaps via mpmath)\n* translates back and forth to Maxima properly (for integration and limits)\n\nMy sense is that BuiltinFunction would be best.  GinacFunction probably is only good for things that in fact evaluate in Ginac.  This explains trig.py.  [This Ginac page](http://www.ginac.de/tutorial/Built_002din-functions.html) shows that the ones which are GinacFunctions are exactly the ones which Ginac in fact has.      I don't think it has most of these other functions.\n\nAs for MaximaFunction, it seems to inherit from BuiltinFunction and lives in the special functions file.  This dates from the days when Sage had very few options for symbolic stuff and evaluation, and so it just does a few extra things.  If we moved to mpmath for a given function, we would probably use BuiltinFunction and then add evaluation options for Maxima and add to the conversion dictionary as needed.  \n\nIn fact, it wouldn't be a bad idea to have two different eval procedures if possible...\n\n\n---\n\nAs for where such things go, probably it would make sense to separate a lot of these special functions out into a separate file.  The distinction between transcendental and special is not totally obvious, for instance :)\n\n---\n\n\nBy the way, we certainly want fewer of the wrapper functions!  But that will take a lot of tedious work.",
    "created_at": "2011-06-08T20:45:13Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112935",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
Those are good questions.  

I think the most important thing is to make sure that whatever is implemented has

* good numerical evaluation (perhaps via mpmath)
* translates back and forth to Maxima properly (for integration and limits)

My sense is that BuiltinFunction would be best.  GinacFunction probably is only good for things that in fact evaluate in Ginac.  This explains trig.py.  [This Ginac page](http://www.ginac.de/tutorial/Built_002din-functions.html) shows that the ones which are GinacFunctions are exactly the ones which Ginac in fact has.      I don't think it has most of these other functions.

As for MaximaFunction, it seems to inherit from BuiltinFunction and lives in the special functions file.  This dates from the days when Sage had very few options for symbolic stuff and evaluation, and so it just does a few extra things.  If we moved to mpmath for a given function, we would probably use BuiltinFunction and then add evaluation options for Maxima and add to the conversion dictionary as needed.  

In fact, it wouldn't be a bad idea to have two different eval procedures if possible...


---

As for where such things go, probably it would make sense to separate a lot of these special functions out into a separate file.  The distinction between transcendental and special is not totally obvious, for instance :)

---


By the way, we certainly want fewer of the wrapper functions!  But that will take a lot of tedious work.



---

archive/issue_comments_112936.json:
```json
{
    "body": "<a id='comment:9'></a>\nBy the way, adding this will really be a great help.  Sage has so many of the things almost anybody needs, but if you have to use mpmath or GSL or R or something else directly, it sort of makes Sage a moot point.  The idea is having a one-stop shop.",
    "created_at": "2011-06-08T20:46:40Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112936",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
By the way, adding this will really be a great help.  Sage has so many of the things almost anybody needs, but if you have to use mpmath or GSL or R or something else directly, it sort of makes Sage a moot point.  The idea is having a one-stop shop.



---

archive/issue_comments_112937.json:
```json
{
    "body": "<a id='comment:10'></a>\nI've uploaded a first shot at a template for the functions we want to add in this ticket. The patch exposes the general complex exponential integral function `En` also called `Function_exp_integral_En` by adding a class to `sage/functions/special.py` (I can change where it goes later on if needed / desired). Numerical evaluation is handled by mpmath and symbolics are handled by Sage (e.g. the derivative) and Maxima (e.g. the antiderivative).\n\nOne of the docstring examples shows that the integral of `e^(-x) * log(x+1)` from the ticket description is now evaluated properly. \n\nAny comments or suggestions?",
    "created_at": "2011-06-12T07:07:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112937",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:10'></a>
I've uploaded a first shot at a template for the functions we want to add in this ticket. The patch exposes the general complex exponential integral function `En` also called `Function_exp_integral_En` by adding a class to `sage/functions/special.py` (I can change where it goes later on if needed / desired). Numerical evaluation is handled by mpmath and symbolics are handled by Sage (e.g. the derivative) and Maxima (e.g. the antiderivative).

One of the docstring examples shows that the integral of `e^(-x) * log(x+1)` from the ticket description is now evaluated properly. 

Any comments or suggestions?



---

archive/issue_comments_112938.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,7 +8,120 @@\n ```\n See [this ask.sagemath post](http://ask.sagemath.org/question/488/calculating-integral) for some details.\n \n+## Current symbol conversion table\n+From `sage.symbolic.pynac.symbol_table['maxima']` as of Sage-4.7\n+\n ```\n-sage: sage.symbolic.pynac.symbol_table['maxima']\n-{'elliptic_e': elliptic_e, 'imagpart': imag_part, 'acsch': arccsch, 'glaisher': glaisher, 'asinh': arcsinh, 'minf': -Infinity, 'elliptic_f': elliptic_f, '(1+sqrt(5))/2': golden_ratio, 'inf': +Infinity, 'log(2)': log2, 'kron_delta': kronecker_delta, 'asin': arcsin, 'log': log, 'atanh': arctanh, 'brun': brun, '%pi': pi, 'acosh': arccosh, 'sin': sin, 'mertens': mertens, 'ceiling': ceil, 'infinity': Infinity, 'elliptic_ec': elliptic_ec, 'atan': arctan, 'factorial': factorial, 'twinprime': twinprime, 'khinchin': khinchin, 'catalan': catalan, 'signum': sgn, 'binomial': binomial, 'delta': dirac_delta, 'asec': arcsec, 'elliptic_kc': elliptic_kc, '%gamma': euler_gamma, 'realpart': real_part, 'elliptic_eu': elliptic_eu, 'cos': cos, 'acoth': arccoth, 'gamma_incomplete': gamma, 'li[2]': dilog, 'atan2': arctan2, 'exp': exp, 'psi[0]': psi, 'asech': arcsech, 'acos': arccos, 'acot': arccot, 'acsc': arccsc, 'elliptic_pi': elliptic_pi}\n+Maxima ---> Sage\n+\n+%gamma ---> euler_gamma\n+%pi ---> pi\n+(1+sqrt(5))/2 ---> golden_ratio\n+acos ---> arccos\n+acosh ---> arccosh\n+acot ---> arccot\n+acoth ---> arccoth\n+acsc ---> arccsc\n+acsch ---> arccsch\n+asec ---> arcsec\n+asech ---> arcsech\n+asin ---> arcsin\n+asinh ---> arcsinh\n+atan ---> arctan\n+atan2 ---> arctan2\n+atanh ---> arctanh\n+binomial ---> binomial\n+brun ---> brun\n+catalan ---> catalan\n+ceiling ---> ceil\n+cos ---> cos\n+delta ---> dirac_delta\n+elliptic_e ---> elliptic_e\n+elliptic_ec ---> elliptic_ec\n+elliptic_eu ---> elliptic_eu\n+elliptic_f ---> elliptic_f\n+elliptic_kc ---> elliptic_kc\n+elliptic_pi ---> elliptic_pi\n+exp ---> exp\n+expintegral_e ---> En\n+factorial ---> factorial\n+gamma_incomplete ---> gamma\n+glaisher ---> glaisher\n+imagpart ---> imag_part\n+inf ---> +Infinity\n+infinity ---> Infinity\n+khinchin ---> khinchin\n+kron_delta ---> kronecker_delta\n+li[2] ---> dilog\n+log ---> log\n+log(2) ---> log2\n+mertens ---> mertens\n+minf ---> -Infinity\n+psi[0] ---> psi\n+realpart ---> real_part\n+signum ---> sgn\n+sin ---> sin\n+twinprime ---> twinprime\n ```\n+\n+# Summary of missing conversions\n+\n+## Special functions defined in Maxima\n+(http://maxima.sourceforge.net/docs/manual/en/maxima_16.html#SEC56)\n+\n+```\n+bessel_j (index, expr)         Bessel function, 1st kind\n+bessel_y (index, expr)         Bessel function, 2nd kind\n+bessel_i (index, expr)         Modified Bessel function, 1st kind\n+bessel_k (index, expr)         Modified Bessel function, 2nd kind\n+```\n+\n+* Notes: bessel_I, bessel_J, etc. are functions in Sage for numerical evaluation. There is also the `Bessel` class, but no conversions from Maxima's bessel_i etc. to Sage.\n+\n+```\n+hankel_1 (v,z)                 Hankel function of the 1st kind\n+hankel_2 (v,z)                 Hankel function of the 2nd kind\n+struve_h (v,z)                 Struve H function\n+struve_l (v,z)                 Struve L function\n+```\n+\n+* Notes: None of these functions are currently exposed at the top level in Sage. Evaluation is possible using mpmath.\n+\n+```\n+assoc_legendre_p[v,u] (z)      Legendre function of degree v and order u \n+assoc_legendre_q[v,u] (z)      Legendre function, 2nd kind\n+```\n+\n+* Notes: In Sage we have `legendre_P(n, x)` and `legendre_Q(n, x)` both described as Legendre functions. It's not clear to me how there are related to Maxima's versions since the number of arguments differs.\n+\n+```\n+%f[p,q] ([], [], expr)         Generalized Hypergeometric function\n+hypergeometric(l1, l2, z)      Hypergeometric function\n+slommel\n+%m[u,k] (z)                    Whittaker function, 1st kind\n+%w[u,k] (z)                    Whittaker function, 2nd kind\n+```\n+\n+* Notes: `hypergeometric(l1, l2, z)` needs a conversion to Sage's `hypergeometric_U`. The others can be evaluated using mpmath. `slommel` is presumably mpmath's `lommels1()` or `lommels2()` (or both?). This isn't well documented in Maxima.\n+\n+```\n+expintegral_e (v,z)            Exponential integral E\n+expintegral_e1 (z)             Exponential integral E1\n+expintegral_ei (z)             Exponential integral Ei\n+expintegral_li (z)             Logarithmic integral Li\n+expintegral_si (z)             Exponential integral Si\n+expintegral_ci (z)             Exponential integral Ci\n+expintegral_shi (z)            Exponential integral Shi\n+expintegral_chi (z)            Exponential integral Chi\n+erfc (z)                       Complement of the erf function\n+```\n+\n+* Notes: The exponential integral functions `expintegral_e1` and `expintegral_ei (z)` are called `exponential_integral_1` and `Ei` resp. in Sage. They both need conversions. The rest need `BuiltinFunction` classes defined for them with evaluation handled by mpmath and the symbol table conversion added. Also, `erfc` is called `error_fcn`, so also needs a conversion.\n+\n+```\n+kelliptic (z)                  Complete elliptic integral of the first \n+                               kind (K)\n+parabolic_cylinder_d (v,z)     Parabolic cylinder D function\n+```\n+\n+* Notes: `kelliptic(z)` needs a conversion to `elliptic_kc` in Sage and `parabolic_cylinder_d (v,z)` does not seem to be exposed at top level. It can be evaluated by mpmath.\n``````\n",
    "created_at": "2011-06-13T02:10:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112938",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,7 +8,120 @@
 ```
 See [this ask.sagemath post](http://ask.sagemath.org/question/488/calculating-integral) for some details.
 
+## Current symbol conversion table
+From `sage.symbolic.pynac.symbol_table['maxima']` as of Sage-4.7
+
 ```
-sage: sage.symbolic.pynac.symbol_table['maxima']
-{'elliptic_e': elliptic_e, 'imagpart': imag_part, 'acsch': arccsch, 'glaisher': glaisher, 'asinh': arcsinh, 'minf': -Infinity, 'elliptic_f': elliptic_f, '(1+sqrt(5))/2': golden_ratio, 'inf': +Infinity, 'log(2)': log2, 'kron_delta': kronecker_delta, 'asin': arcsin, 'log': log, 'atanh': arctanh, 'brun': brun, '%pi': pi, 'acosh': arccosh, 'sin': sin, 'mertens': mertens, 'ceiling': ceil, 'infinity': Infinity, 'elliptic_ec': elliptic_ec, 'atan': arctan, 'factorial': factorial, 'twinprime': twinprime, 'khinchin': khinchin, 'catalan': catalan, 'signum': sgn, 'binomial': binomial, 'delta': dirac_delta, 'asec': arcsec, 'elliptic_kc': elliptic_kc, '%gamma': euler_gamma, 'realpart': real_part, 'elliptic_eu': elliptic_eu, 'cos': cos, 'acoth': arccoth, 'gamma_incomplete': gamma, 'li[2]': dilog, 'atan2': arctan2, 'exp': exp, 'psi[0]': psi, 'asech': arcsech, 'acos': arccos, 'acot': arccot, 'acsc': arccsc, 'elliptic_pi': elliptic_pi}
+Maxima ---> Sage
+
+%gamma ---> euler_gamma
+%pi ---> pi
+(1+sqrt(5))/2 ---> golden_ratio
+acos ---> arccos
+acosh ---> arccosh
+acot ---> arccot
+acoth ---> arccoth
+acsc ---> arccsc
+acsch ---> arccsch
+asec ---> arcsec
+asech ---> arcsech
+asin ---> arcsin
+asinh ---> arcsinh
+atan ---> arctan
+atan2 ---> arctan2
+atanh ---> arctanh
+binomial ---> binomial
+brun ---> brun
+catalan ---> catalan
+ceiling ---> ceil
+cos ---> cos
+delta ---> dirac_delta
+elliptic_e ---> elliptic_e
+elliptic_ec ---> elliptic_ec
+elliptic_eu ---> elliptic_eu
+elliptic_f ---> elliptic_f
+elliptic_kc ---> elliptic_kc
+elliptic_pi ---> elliptic_pi
+exp ---> exp
+expintegral_e ---> En
+factorial ---> factorial
+gamma_incomplete ---> gamma
+glaisher ---> glaisher
+imagpart ---> imag_part
+inf ---> +Infinity
+infinity ---> Infinity
+khinchin ---> khinchin
+kron_delta ---> kronecker_delta
+li[2] ---> dilog
+log ---> log
+log(2) ---> log2
+mertens ---> mertens
+minf ---> -Infinity
+psi[0] ---> psi
+realpart ---> real_part
+signum ---> sgn
+sin ---> sin
+twinprime ---> twinprime
 ```
+
+# Summary of missing conversions
+
+## Special functions defined in Maxima
+(http://maxima.sourceforge.net/docs/manual/en/maxima_16.html#SEC56)
+
+```
+bessel_j (index, expr)         Bessel function, 1st kind
+bessel_y (index, expr)         Bessel function, 2nd kind
+bessel_i (index, expr)         Modified Bessel function, 1st kind
+bessel_k (index, expr)         Modified Bessel function, 2nd kind
+```
+
+* Notes: bessel_I, bessel_J, etc. are functions in Sage for numerical evaluation. There is also the `Bessel` class, but no conversions from Maxima's bessel_i etc. to Sage.
+
+```
+hankel_1 (v,z)                 Hankel function of the 1st kind
+hankel_2 (v,z)                 Hankel function of the 2nd kind
+struve_h (v,z)                 Struve H function
+struve_l (v,z)                 Struve L function
+```
+
+* Notes: None of these functions are currently exposed at the top level in Sage. Evaluation is possible using mpmath.
+
+```
+assoc_legendre_p[v,u] (z)      Legendre function of degree v and order u 
+assoc_legendre_q[v,u] (z)      Legendre function, 2nd kind
+```
+
+* Notes: In Sage we have `legendre_P(n, x)` and `legendre_Q(n, x)` both described as Legendre functions. It's not clear to me how there are related to Maxima's versions since the number of arguments differs.
+
+```
+%f[p,q] ([], [], expr)         Generalized Hypergeometric function
+hypergeometric(l1, l2, z)      Hypergeometric function
+slommel
+%m[u,k] (z)                    Whittaker function, 1st kind
+%w[u,k] (z)                    Whittaker function, 2nd kind
+```
+
+* Notes: `hypergeometric(l1, l2, z)` needs a conversion to Sage's `hypergeometric_U`. The others can be evaluated using mpmath. `slommel` is presumably mpmath's `lommels1()` or `lommels2()` (or both?). This isn't well documented in Maxima.
+
+```
+expintegral_e (v,z)            Exponential integral E
+expintegral_e1 (z)             Exponential integral E1
+expintegral_ei (z)             Exponential integral Ei
+expintegral_li (z)             Logarithmic integral Li
+expintegral_si (z)             Exponential integral Si
+expintegral_ci (z)             Exponential integral Ci
+expintegral_shi (z)            Exponential integral Shi
+expintegral_chi (z)            Exponential integral Chi
+erfc (z)                       Complement of the erf function
+```
+
+* Notes: The exponential integral functions `expintegral_e1` and `expintegral_ei (z)` are called `exponential_integral_1` and `Ei` resp. in Sage. They both need conversions. The rest need `BuiltinFunction` classes defined for them with evaluation handled by mpmath and the symbol table conversion added. Also, `erfc` is called `error_fcn`, so also needs a conversion.
+
+```
+kelliptic (z)                  Complete elliptic integral of the first 
+                               kind (K)
+parabolic_cylinder_d (v,z)     Parabolic cylinder D function
+```
+
+* Notes: `kelliptic(z)` needs a conversion to `elliptic_kc` in Sage and `parabolic_cylinder_d (v,z)` does not seem to be exposed at top level. It can be evaluated by mpmath.
``````




---

archive/issue_comments_112939.json:
```json
{
    "body": "**Changing keywords** from \"ei Ei\" to \"ei Ei special function maxima\".",
    "created_at": "2011-06-13T02:10:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112939",
    "user": "https://github.com/benjaminfjones"
}
```

**Changing keywords** from "ei Ei" to "ei Ei special function maxima".



---

archive/issue_comments_112940.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe patch looks great. Thanks for the template. A few suggestions:\n\n* The function name should be more explicit. I suggest `exp_integral_e`.\n* In the top level name space `En` can be an alias for this function (though I'd prefer not to take up a two letter name), but we should have the long name available. It is easier to find all these functions by `exp_integral<tab>` than `E<tab>`.\n* See [_eval_ method of sage.functions.other.Function_gamma_inc](http://hg.sagemath.org/sage-main/file/tip/sage/functions/other.py#l680) for an example of how to find a common parent for the arguments\n* The call to mpmath does not require the prec parameter any more. If you pass a Sage element to mpmath it handles the precision correctly. You can delete the code for this in `_evalf_()`.\n* You should remove the `__call__()` method altogether. The only purpose of that is to display the deprecation notice. Since you are implementing a new function here, there is nothing being deprecated.\n* In `_derivative_()` the call to this function should be `exp_integral_e(n-1, z)`, assuming you change the function name accordingly.\n\nI changed the ticket description to limit this to implementing symbolic functions for exponential integrals. We can use [the wiki page](symbolics-functions) for a general overview of the progress on symbolic functions.",
    "created_at": "2011-06-13T20:20:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112940",
    "user": "https://github.com/burcin"
}
```

<a id='comment:12'></a>
The patch looks great. Thanks for the template. A few suggestions:

* The function name should be more explicit. I suggest `exp_integral_e`.
* In the top level name space `En` can be an alias for this function (though I'd prefer not to take up a two letter name), but we should have the long name available. It is easier to find all these functions by `exp_integral<tab>` than `E<tab>`.
* See [_eval_ method of sage.functions.other.Function_gamma_inc](http://hg.sagemath.org/sage-main/file/tip/sage/functions/other.py#l680) for an example of how to find a common parent for the arguments
* The call to mpmath does not require the prec parameter any more. If you pass a Sage element to mpmath it handles the precision correctly. You can delete the code for this in `_evalf_()`.
* You should remove the `__call__()` method altogether. The only purpose of that is to display the deprecation notice. Since you are implementing a new function here, there is nothing being deprecated.
* In `_derivative_()` the call to this function should be `exp_integral_e(n-1, z)`, assuming you change the function name accordingly.

I changed the ticket description to limit this to implementing symbolic functions for exponential integrals. We can use [the wiki page](symbolics-functions) for a general overview of the progress on symbolic functions.



---

archive/issue_events_087127.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2011-06-13T20:20:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "rename": {
        "from": "Add various Maxima special functions to symbol table",
        "to": "define symbolic functions for exponential integrals"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87127"
}
```



---

archive/issue_comments_112941.json:
```json
{
    "body": "**Author:** Benjamin Jones",
    "created_at": "2011-06-13T20:20:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112941",
    "user": "https://github.com/burcin"
}
```

**Author:** Benjamin Jones



---

archive/issue_events_087128.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2011-06-13T20:20:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87128"
}
```



---

archive/issue_comments_112942.json:
```json
{
    "body": "**Reviewer:** Burcin Erocal",
    "created_at": "2011-06-13T20:20:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112942",
    "user": "https://github.com/burcin"
}
```

**Reviewer:** Burcin Erocal



---

archive/issue_comments_112943.json:
```json
{
    "body": "<a id='comment:13'></a>\nThanks for the feedback, Burcin! I feel like I'm developing an understanding for how symbolic functions are handled in Sage now. \n\nTo your suggestions:\n\n* I agree, the changed the name of the class to `Function_exp_integral_e` and the global function name to `exp_integral_e`. I think it would make sense as part of this ticket to add an alias of `exp_integral_1` for the existing `exponential_integral_1` to be consistent.\n* Good point, I didn't think of that.\n* The function now correctly coerces the two arguments to the same parent. I also added automatic evaluation of some special cases (n=0 or z=0) as in the `gamma_inc` function.\n* I played around with removing the prec argument, but didn't get the results I expected. I found that passing the parent explicitly works. The common parent is determined in `_eval_` (as in the `gamma_inc` function).\n* Done.\n* Done.\n\nLet me know what you think. Once we've agreed on a good template for this one function, I will implement the rest of the exponential integral functions that are now listed on the wiki and upload to this ticket.",
    "created_at": "2011-06-15T00:44:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112943",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:13'></a>
Thanks for the feedback, Burcin! I feel like I'm developing an understanding for how symbolic functions are handled in Sage now. 

To your suggestions:

* I agree, the changed the name of the class to `Function_exp_integral_e` and the global function name to `exp_integral_e`. I think it would make sense as part of this ticket to add an alias of `exp_integral_1` for the existing `exponential_integral_1` to be consistent.
* Good point, I didn't think of that.
* The function now correctly coerces the two arguments to the same parent. I also added automatic evaluation of some special cases (n=0 or z=0) as in the `gamma_inc` function.
* I played around with removing the prec argument, but didn't get the results I expected. I found that passing the parent explicitly works. The common parent is determined in `_eval_` (as in the `gamma_inc` function).
* Done.
* Done.

Let me know what you think. Once we've agreed on a good template for this one function, I will implement the rest of the exponential integral functions that are now listed on the wiki and upload to this ticket.



---

archive/issue_comments_112944.json:
```json
{
    "body": "<a id='comment:14'></a>\nPerfect! I can only nitpick about documentation. :)\n\n* lines should be < 80 characters long. This helps when viewing help in a terminal.\n* I don't know how testing for 0 in `_eval_` effects performance. This is a hard problem. See the `_eval_` methods in `sage/functions/generalized.py` for a workaround if this is too slow.\n\nYou're right, we should add an alias `exp_integral_1`.\n\nThanks for working on this.",
    "created_at": "2011-06-15T03:59:16Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112944",
    "user": "https://github.com/burcin"
}
```

<a id='comment:14'></a>
Perfect! I can only nitpick about documentation. :)

* lines should be < 80 characters long. This helps when viewing help in a terminal.
* I don't know how testing for 0 in `_eval_` effects performance. This is a hard problem. See the `_eval_` methods in `sage/functions/generalized.py` for a workaround if this is too slow.

You're right, we should add an alias `exp_integral_1`.

Thanks for working on this.



---

archive/issue_comments_112945.json:
```json
{
    "body": "<a id='comment:15'></a>\nThe tests similar to `if z == 0` in `_eval_` do make a big difference. I guess this is well known, but I didn't realize how big the speed difference is. \n\nI made a little table below of some timings. In the first table , `_eval_` includes tests `if z == 0 and n > 1` and `if n == 0`. In the second table, there are no such if statements (so the special cases are not implemented). In the third table, the special cases are implementes as in `sage/functions/generalized.py` where an approximation of `z` (or `n`) is produced and checked instead of the symbol.\n\n```rst\nwith ``if z == 0``\n\n=============================================\t========\n  Test\t\t\t\t\t\t\t\t\t\t\t Time\n=============================================\t========\nsage: timeit(\"f = exp_integral_e(n,z)\")\t\t\t 1.44 ms\nsage: timeit(\"f = exp_integral_e(n,0)\")\t\t\t 929 \u00b5s\nsage: timeit(\"f = exp_integral_e(0,z)\")\t\t\t 1.41 ms\nsage: timeit(\"f = exp_integral_e(1.0,1.0)\")\t\t 158 \u00b5s\n=============================================\t========\n\nwithout ``if z == 0``\n\n=============================================\t======\n  Test\t\t\t\t\t\t\t\t\t\t\t Time\n=============================================\t======\nsage: timeit(\"f = exp_integral_e(n,z)\")\t\t\t541 \u00b5s\nsage: timeit(\"f = exp_integral_e(n,0)\")\t\t\t300 \u00b5s\nsage: timeit(\"f = exp_integral_e(0,z)\")\t\t\t299 \u00b5s\nsage: timeit(\"f = exp_integral_e(1.0,1.0)\")\t\t161 \u00b5s\n=============================================\t======\n\nwith:\n\n.. code-block:: python\n\n\ttry:\n\t    approx_z = ComplexIntervalField()(z)\n\t    # if z is zero and n > 1\n\t    if bool(approx_z.imag() == 0) and bool(approx_z.real() == 0):\n\t        if n > 1:\n\t            return 1/(n-1)\n\texcept: # z is symbolic\n\t    pass\n\t# if n is zero\n\ttry:\n\t    approx_n = ComplexIntervalField()(n)\n\t    if bool(approx_n.imag() == 0) and bool(approx_n.real() == 0):\n\t        return exp(-z)/z\n\texcept: # n is symbolic\n\t    pass\n\n=============================================\t======\n  Test\t\t\t\t\t\t\t\t\t\t\t Time\n=============================================\t======\nsage: timeit(\"f = exp_integral_e(n,z)\")\t\t\t570 \u00b5s\nsage: timeit(\"f = exp_integral_e(n,0)\")\t\t\t576 \u00b5s\nsage: timeit(\"f = exp_integral_e(0,z)\")\t\t\t1.05 ms\nsage: timeit(\"f = exp_integral_e(1.0,1.0)\")\t\t160 \u00b5s\n=============================================\t======\n```\n\nTimings in tables 2 and 3 are close except in the case where ``exp(-z)/z`` is\nreturned, whereas table 1 is anywhere from a factor of 3 to 5 slower than in table 2 when a symbolic argument is passed. Anyway, I thought I'd include the above for other beginners such as myself.\n\n---\n\nAnother thing I discovered is that these two special cases that I was\nimplementing are known to Maxima:\n\n```\nsage: f = exp_integral_e(0,x)\nsage: f\nexp_integral_e(0,x)\nsage: f.simplify()\ne^(-x)/x\n\nsage: nn = var('nn')\nsage: assume(nn > 1)\nsage: f = exp_integral_e(nn, 0)\nsage: f\nexp_integral_e(nn, 0)\nsage: f.simplify()\n1/(nn - 1)\n```\n\t\nSo I think in the interest of speedy evaluation it's best to leave the special\ncases out, but point out in the documentation that Maxima knows about them.\n\nI've uploaded a new patch. I'll start implementing the other exponential integrals using this as a template.",
    "created_at": "2011-06-16T20:30:10Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112945",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:15'></a>
The tests similar to `if z == 0` in `_eval_` do make a big difference. I guess this is well known, but I didn't realize how big the speed difference is. 

I made a little table below of some timings. In the first table , `_eval_` includes tests `if z == 0 and n > 1` and `if n == 0`. In the second table, there are no such if statements (so the special cases are not implemented). In the third table, the special cases are implementes as in `sage/functions/generalized.py` where an approximation of `z` (or `n`) is produced and checked instead of the symbol.

```rst
with ``if z == 0``

=============================================	========
  Test											 Time
=============================================	========
sage: timeit("f = exp_integral_e(n,z)")			 1.44 ms
sage: timeit("f = exp_integral_e(n,0)")			 929 µs
sage: timeit("f = exp_integral_e(0,z)")			 1.41 ms
sage: timeit("f = exp_integral_e(1.0,1.0)")		 158 µs
=============================================	========

without ``if z == 0``

=============================================	======
  Test											 Time
=============================================	======
sage: timeit("f = exp_integral_e(n,z)")			541 µs
sage: timeit("f = exp_integral_e(n,0)")			300 µs
sage: timeit("f = exp_integral_e(0,z)")			299 µs
sage: timeit("f = exp_integral_e(1.0,1.0)")		161 µs
=============================================	======

with:

.. code-block:: python

	try:
	    approx_z = ComplexIntervalField()(z)
	    # if z is zero and n > 1
	    if bool(approx_z.imag() == 0) and bool(approx_z.real() == 0):
	        if n > 1:
	            return 1/(n-1)
	except: # z is symbolic
	    pass
	# if n is zero
	try:
	    approx_n = ComplexIntervalField()(n)
	    if bool(approx_n.imag() == 0) and bool(approx_n.real() == 0):
	        return exp(-z)/z
	except: # n is symbolic
	    pass

=============================================	======
  Test											 Time
=============================================	======
sage: timeit("f = exp_integral_e(n,z)")			570 µs
sage: timeit("f = exp_integral_e(n,0)")			576 µs
sage: timeit("f = exp_integral_e(0,z)")			1.05 ms
sage: timeit("f = exp_integral_e(1.0,1.0)")		160 µs
=============================================	======
```

Timings in tables 2 and 3 are close except in the case where ``exp(-z)/z`` is
returned, whereas table 1 is anywhere from a factor of 3 to 5 slower than in table 2 when a symbolic argument is passed. Anyway, I thought I'd include the above for other beginners such as myself.

---

Another thing I discovered is that these two special cases that I was
implementing are known to Maxima:

```
sage: f = exp_integral_e(0,x)
sage: f
exp_integral_e(0,x)
sage: f.simplify()
e^(-x)/x

sage: nn = var('nn')
sage: assume(nn > 1)
sage: f = exp_integral_e(nn, 0)
sage: f
exp_integral_e(nn, 0)
sage: f.simplify()
1/(nn - 1)
```
	
So I think in the interest of speedy evaluation it's best to leave the special
cases out, but point out in the documentation that Maxima knows about them.

I've uploaded a new patch. I'll start implementing the other exponential integrals using this as a template.



---

archive/issue_comments_112946.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe timings are really instructive, we should link to them from [wiki page](symbolics-functions). Thank you for this careful study.\n\nReplying to [benjaminfjones](#comment%3A15):\n>\n> So I think in the interest of speedy evaluation it's best to leave the special\n> cases out, but point out in the documentation that Maxima knows about them.\n\n\nI think your timings show that using the CIF approximation is not such a big penalty. Note that your timings also reflect the construction of the result and not just including that change. It is better if Sage can do the evaluation automatically without having to pass through a `simplify()` call. I'd like them in, with the approximation approach.\n\nSince this approximation is being called so often, we should make it a method of symbolic expressions. I opened a new ticket for this: #11513. This ticket should depend on that.\n\nI will provide a preliminary patch for #11513 soon.",
    "created_at": "2011-06-16T22:41:05Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112946",
    "user": "https://github.com/burcin"
}
```

<a id='comment:16'></a>
The timings are really instructive, we should link to them from [wiki page](symbolics-functions). Thank you for this careful study.

Replying to [benjaminfjones](#comment%3A15):
>
> So I think in the interest of speedy evaluation it's best to leave the special
> cases out, but point out in the documentation that Maxima knows about them.


I think your timings show that using the CIF approximation is not such a big penalty. Note that your timings also reflect the construction of the result and not just including that change. It is better if Sage can do the evaluation automatically without having to pass through a `simplify()` call. I'd like them in, with the approximation approach.

Since this approximation is being called so often, we should make it a method of symbolic expressions. I opened a new ticket for this: #11513. This ticket should depend on that.

I will provide a preliminary patch for #11513 soon.



---

archive/issue_comments_112947.json:
```json
{
    "body": "<a id='comment:17'></a>\nI attached a very simple patch to #11513. Now we can write the check for zero as:\n\n```\ndef is_zero(z):\n    if isinstance(z, Expression):\n        return z._is_numerically_zero()\n    else:\n        return not z\n```\n\nIt would be nice if we could simplify this further, but I need to go and do other things now. :)",
    "created_at": "2011-06-17T00:22:30Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112947",
    "user": "https://github.com/burcin"
}
```

<a id='comment:17'></a>
I attached a very simple patch to #11513. Now we can write the check for zero as:

```
def is_zero(z):
    if isinstance(z, Expression):
        return z._is_numerically_zero()
    else:
        return not z
```

It would be nice if we could simplify this further, but I need to go and do other things now. :)



---

archive/issue_comments_112948.json:
```json
{
    "body": "<a id='comment:18'></a>\nThe patch now depends on #11513\n\nHere are new timings for the ``_eval_`` method with ``_is_numerically_zero()``:\n\n```rst\n.. code-block:: python\n\n    # special case: *quickly* test if (z == 0 and n > 1)\n    if isinstance(z, Expression):\n        if z._is_numerically_zero():\n            z_zero = True # for later\n            if n > 1:\n                return 1/(n-1)\n        else:\n            if not z: \n                z_zero = True\n                if n > 1:\n                    return 1/(n-1)\n\n======================================================  =======\n  Test                                                   Time\n======================================================  =======\nsage: timeit(\"f = exp_integral_e(n,z)\")                 535 \u00b5s\nsage: timeit(\"f = exp_integral_e(n,0)\")                 482 \u00b5s\nsage: assume(n > 1); timeit(\"f = exp_integral_e(n,0)\")  3.56 ms\nsage: timeit(\"f = exp_integral_e(0,z)\")                 968 \u00b5s\nsage: timeit(\"f = exp_integral_e(1.0,1.0)\")             160 \u00b5s\n======================================================  =======\n```\n\nI realized that in row 2 of the previous timings I neglected to assume n > 1 so those timings aren't giving much information since the expression is left unevaluated like in row 1. The new row 3 includes that assumption so that the simplified result ``1/(n-1)`` is created and returned. \n\nI'll update the timings above and move these tables to the wiki.",
    "created_at": "2011-06-20T18:24:21Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112948",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:18'></a>
The patch now depends on #11513

Here are new timings for the ``_eval_`` method with ``_is_numerically_zero()``:

```rst
.. code-block:: python

    # special case: *quickly* test if (z == 0 and n > 1)
    if isinstance(z, Expression):
        if z._is_numerically_zero():
            z_zero = True # for later
            if n > 1:
                return 1/(n-1)
        else:
            if not z: 
                z_zero = True
                if n > 1:
                    return 1/(n-1)

======================================================  =======
  Test                                                   Time
======================================================  =======
sage: timeit("f = exp_integral_e(n,z)")                 535 µs
sage: timeit("f = exp_integral_e(n,0)")                 482 µs
sage: assume(n > 1); timeit("f = exp_integral_e(n,0)")  3.56 ms
sage: timeit("f = exp_integral_e(0,z)")                 968 µs
sage: timeit("f = exp_integral_e(1.0,1.0)")             160 µs
======================================================  =======
```

I realized that in row 2 of the previous timings I neglected to assume n > 1 so those timings aren't giving much information since the expression is left unevaluated like in row 1. The new row 3 includes that assumption so that the simplified result ``1/(n-1)`` is created and returned. 

I'll update the timings above and move these tables to the wiki.



---

archive/attachments_015138.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143_En.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143_En.patch",
    "created_at": "2011-06-20T18:27:24Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143_En.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112949.json:
```json
{
    "body": "**Attachment:** [trac_11143_En.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_En.patch)\n\nadded the symbolic function `exp_integral_e`",
    "created_at": "2011-06-20T18:27:24Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112949",
    "user": "https://github.com/benjaminfjones"
}
```

**Attachment:** [trac_11143_En.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_En.patch)

added the symbolic function `exp_integral_e`



---

archive/issue_comments_112950.json:
```json
{
    "body": "<a id='comment:19'></a>\nIn the patch, I'm added a function to `sage/functions/special.py`. But with the six new functions, this is going to be *a lot* of code in the one file. \n\nI was thinking of moving the six new functions to a new file `sage/functions/exp_integral.py`. Any thoughts? If that seems like a good idea, does it also make sense to move the exp integrals that already exist in Sage to the same place (e.g. `exponential_integral_1` lives now in `sage/functions/transcendental.py`.",
    "created_at": "2011-07-02T20:59:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112950",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:19'></a>
In the patch, I'm added a function to `sage/functions/special.py`. But with the six new functions, this is going to be *a lot* of code in the one file. 

I was thinking of moving the six new functions to a new file `sage/functions/exp_integral.py`. Any thoughts? If that seems like a good idea, does it also make sense to move the exp integrals that already exist in Sage to the same place (e.g. `exponential_integral_1` lives now in `sage/functions/transcendental.py`.



---

archive/issue_comments_112951.json:
```json
{
    "body": "**Changing assignee** from @burcin to @benjaminfjones.",
    "created_at": "2011-07-02T20:59:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112951",
    "user": "https://github.com/benjaminfjones"
}
```

**Changing assignee** from @burcin to @benjaminfjones.



---

archive/issue_comments_112952.json:
```json
{
    "body": "<a id='comment:20'></a>\n> I was thinking of moving the six new functions to a new file `sage/functions/exp_integral.py`. Any thoughts? If that seems like a good idea, does it also make sense to move the exp integrals that already exist in Sage to the same place (e.g. `exponential_integral_1` lives now in `sage/functions/transcendental.py`.\n\n\nYes, absolutely.  The functions/ folder needs to be reorganized, though obviously this is lower priority.  Make sure that it still shows up in the reference manual, that all imports work fine, etc.  But these functions are all supposed to be accessed through the top level namespace anyway, so this is a great idea to make it easier to organize.",
    "created_at": "2011-07-03T03:18:24Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112952",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>
> I was thinking of moving the six new functions to a new file `sage/functions/exp_integral.py`. Any thoughts? If that seems like a good idea, does it also make sense to move the exp integrals that already exist in Sage to the same place (e.g. `exponential_integral_1` lives now in `sage/functions/transcendental.py`.


Yes, absolutely.  The functions/ folder needs to be reorganized, though obviously this is lower priority.  Make sure that it still shows up in the reference manual, that all imports work fine, etc.  But these functions are all supposed to be accessed through the top level namespace anyway, so this is a great idea to make it easier to organize.



---

archive/issue_comments_112953.json:
```json
{
    "body": "<a id='comment:21'></a>\nI've uploaded a new partial patch for the ticket. I wanted to post this now before I finish the patch so people can comment on the consolidation of exponential functions in the new file `sage/functions/exp_integral.py`  and/or anything else. \n\nIf the basic organisation looks good, I'll finish up adding the remaining exponential integrals and upload a new patch.",
    "created_at": "2011-08-23T03:25:23Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112953",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:21'></a>
I've uploaded a new partial patch for the ticket. I wanted to post this now before I finish the patch so people can comment on the consolidation of exponential functions in the new file `sage/functions/exp_integral.py`  and/or anything else. 

If the basic organisation looks good, I'll finish up adding the remaining exponential integrals and upload a new patch.



---

archive/issue_comments_112954.json:
```json
{
    "body": "**Changing reviewer** from \"Burcin Erocal\" to \"Burcin Erocal, Karl-Dieter Crisman\".",
    "created_at": "2011-08-23T16:58:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112954",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Burcin Erocal" to "Burcin Erocal, Karl-Dieter Crisman".



---

archive/issue_comments_112955.json:
```json
{
    "body": "**Dependencies:** #11513",
    "created_at": "2011-08-23T16:58:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112955",
    "user": "https://github.com/kcrisman"
}
```

**Dependencies:** #11513



---

archive/issue_comments_112956.json:
```json
{
    "body": "<a id='comment:22'></a>\nA few comment:\n* This will conflict (slightly) with #11043, I think.  You can help their cause by doing \n\n```\nfrom sage.plot.all import plot\n```\n   I believe.  The point is making sure we don't import numpy and other things like that on startup.  It's possible that some of the other imports will have this problem, but hopefully not (?).\n* I don't really understand coercion, so I'm reluctant to comment on the coercion stuff in `_eval_`, though I'd be glad if you explained that (I don't recall seeing it in these types of functions before).\n* This seems to depend on #11513 still, so I'm adding that.  But that still does not have positive review.  Just pointing it out.\n* Line 260: `           raise NotImplementedError(\"The derivative of is only implemented for n = 1, 2, 3, ...\") ` seems to be missing something.\n\nOn a cursory reading, this looks really nice.   Certainly you should go ahead with the full reorganization, that will help a lot.",
    "created_at": "2011-08-23T16:58:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112956",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'></a>
A few comment:
* This will conflict (slightly) with #11043, I think.  You can help their cause by doing 

```
from sage.plot.all import plot
```
   I believe.  The point is making sure we don't import numpy and other things like that on startup.  It's possible that some of the other imports will have this problem, but hopefully not (?).
* I don't really understand coercion, so I'm reluctant to comment on the coercion stuff in `_eval_`, though I'd be glad if you explained that (I don't recall seeing it in these types of functions before).
* This seems to depend on #11513 still, so I'm adding that.  But that still does not have positive review.  Just pointing it out.
* Line 260: `           raise NotImplementedError("The derivative of is only implemented for n = 1, 2, 3, ...") ` seems to be missing something.

On a cursory reading, this looks really nice.   Certainly you should go ahead with the full reorganization, that will help a lot.



---

archive/issue_comments_112957.json:
```json
{
    "body": "**Changing keywords** from \"ei Ei special function maxima\" to \"ei Ei special function maxima sd32\".",
    "created_at": "2011-08-25T18:04:34Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112957",
    "user": "https://github.com/benjaminfjones"
}
```

**Changing keywords** from "ei Ei special function maxima" to "ei Ei special function maxima sd32".



---

archive/issue_comments_112958.json:
```json
{
    "body": "<a id='comment:24'></a>\nTrying to finish up the patch, I've run into a problem evaluating any of my new functions at python floats. For example, apply the patch and try:\n\n```\nsage: exp_integral_e1(float(1))\nERROR: An unexpected error occurred while tokenizing input\nThe following traceback may be corrupted or invalid\nThe error message is: ('EOF in multi-line statement', (690, 0))\n\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/Users/jonesbe/sage/sage-4.7.2.alpha2/devel/sage-test/sage/<ipython console> in <module>()\n\n/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:4599)()\n\n/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/functions/exp_integral.pyc in _eval_(self, z)\n    335         \"\"\"\n    336         if not isinstance(z, Expression) and is_inexact(z):\n--> 337             return self._evalf_(z, parent(z))\n    338 \n    339         return None # leaves the expression unevaluated\n\n/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/functions/exp_integral.pyc in _evalf_(self, z, parent)\n    350         \"\"\"\n    351         import mpmath\n--> 352         return mpmath_utils.call(mpmath.e1, z, parent=parent)\n    353 \n    354     def _derivative_(self, z, diff_param=None):\n\n/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/mpmath/utils.c:5277)()\n\nAttributeError: type object 'float' has no attribute 'prec'\n```\n\nYou also get the error if you try to plot any of the exponential integral functions as they are written unless you wrap the input with `RDF` or something similar.\n\nThe error is being raised inside the `call` function in `sage/libs/mpmath/util.pyx`. I've looked through that code and thought about what would happen if the `prec` option is not specified (as in my code) and the parent is `None` (as when a python float is passed), but I can't figure out why it doesn't work to pass a float.\n\nOn the other hand, changing the lines in the `_evalf` method\n\n```\nimport mpmath\nreturn mpmath_utils.call(mpmath.e1, z, parent=parent)\n```\n\nto \n\n```\nimport mpmath\nif isinstance(parent, Parent) and hasattr(parent, 'prec'):\n    prec = parent.prec()\nelse:\n    prec = 53\nreturn mpmath_utils.call(mpmath.si, z, prec=prec)\n```\n\nfixes the error. \n\nWhat do people think? Is this a bug in the `call` function (which claims it will accept any type that mpmath handles natively like python floats) or is there something wrong with my code?",
    "created_at": "2011-09-22T01:06:23Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112958",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:24'></a>
Trying to finish up the patch, I've run into a problem evaluating any of my new functions at python floats. For example, apply the patch and try:

```
sage: exp_integral_e1(float(1))
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (690, 0))

---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/Users/jonesbe/sage/sage-4.7.2.alpha2/devel/sage-test/sage/<ipython console> in <module>()

/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:4599)()

/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/functions/exp_integral.pyc in _eval_(self, z)
    335         """
    336         if not isinstance(z, Expression) and is_inexact(z):
--> 337             return self._evalf_(z, parent(z))
    338 
    339         return None # leaves the expression unevaluated

/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/functions/exp_integral.pyc in _evalf_(self, z, parent)
    350         """
    351         import mpmath
--> 352         return mpmath_utils.call(mpmath.e1, z, parent=parent)
    353 
    354     def _derivative_(self, z, diff_param=None):

/Users/jonesbe/sage/latest/local/lib/python2.6/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/mpmath/utils.c:5277)()

AttributeError: type object 'float' has no attribute 'prec'
```

You also get the error if you try to plot any of the exponential integral functions as they are written unless you wrap the input with `RDF` or something similar.

The error is being raised inside the `call` function in `sage/libs/mpmath/util.pyx`. I've looked through that code and thought about what would happen if the `prec` option is not specified (as in my code) and the parent is `None` (as when a python float is passed), but I can't figure out why it doesn't work to pass a float.

On the other hand, changing the lines in the `_evalf` method

```
import mpmath
return mpmath_utils.call(mpmath.e1, z, parent=parent)
```

to 

```
import mpmath
if isinstance(parent, Parent) and hasattr(parent, 'prec'):
    prec = parent.prec()
else:
    prec = 53
return mpmath_utils.call(mpmath.si, z, prec=prec)
```

fixes the error. 

What do people think? Is this a bug in the `call` function (which claims it will accept any type that mpmath handles natively like python floats) or is there something wrong with my code?



---

archive/issue_comments_112959.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [benjaminfjones](#comment%3A24):\n\n> What do people think? Is this a bug in the `call` function (which claims it will accept any type that mpmath handles natively like python floats) or is there something wrong with my code?\n\n\nIt would be better to fix the `mpmath_call()` function. This is called from many places and duplicating the code to check if `parent` has a `prec()` method everywhere is error prone.\n\nThanks for your work on this so far. I will try to come up with an acceptable implementation for #11513 next week. I hope it doesn't hold this up for long.",
    "created_at": "2011-09-22T09:33:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112959",
    "user": "https://github.com/burcin"
}
```

<a id='comment:25'></a>
Replying to [benjaminfjones](#comment%3A24):

> What do people think? Is this a bug in the `call` function (which claims it will accept any type that mpmath handles natively like python floats) or is there something wrong with my code?


It would be better to fix the `mpmath_call()` function. This is called from many places and duplicating the code to check if `parent` has a `prec()` method everywhere is error prone.

Thanks for your work on this so far. I will try to come up with an acceptable implementation for #11513 next week. I hope it doesn't hold this up for long.



---

archive/issue_comments_112960.json:
```json
{
    "body": "<a id='comment:26'></a>\nOk, I've created a new ticket #11885 to fix the issue with `mpmath.utils.call` and uploaded a patch there. I'll upload the finished patch for #11143 that depends on it later this afternoon.",
    "created_at": "2011-09-30T19:11:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112960",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:26'></a>
Ok, I've created a new ticket #11885 to fix the issue with `mpmath.utils.call` and uploaded a patch there. I'll upload the finished patch for #11143 that depends on it later this afternoon.



---

archive/issue_comments_112961.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -125,3 +125,9 @@\n ```\n \n * Notes: `kelliptic(z)` needs a conversion to `elliptic_kc` in Sage and `parabolic_cylinder_d (v,z)` does not seem to be exposed at top level. It can be evaluated by mpmath.\n+\n+---\n+\n+Depends on #11513 and #11885.\n+\n+Apply [attachment:trac_11143.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch) to the Sage library.\n``````\n",
    "created_at": "2011-10-06T04:02:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112961",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -125,3 +125,9 @@
 ```
 
 * Notes: `kelliptic(z)` needs a conversion to `elliptic_kc` in Sage and `parabolic_cylinder_d (v,z)` does not seem to be exposed at top level. It can be evaluated by mpmath.
+
+---
+
+Depends on #11513 and #11885.
+
+Apply [attachment:trac_11143.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch) to the Sage library.
``````




---

archive/issue_comments_112962.json:
```json
{
    "body": "<a id='comment:28'></a>\nThe patch just uploaded should be feature complete. I've checked the documentation, checked that the doctests pass, and checked that ``make ptestlong`` completes without errors on Mac OS X 10.6.8 and also debian linux squeeze. The patch is based on sage-4.7.2.alpha3.",
    "created_at": "2011-10-06T04:12:24Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112962",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:28'></a>
The patch just uploaded should be feature complete. I've checked the documentation, checked that the doctests pass, and checked that ``make ptestlong`` completes without errors on Mac OS X 10.6.8 and also debian linux squeeze. The patch is based on sage-4.7.2.alpha3.



---

archive/issue_events_087129.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2011-10-06T04:12:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87129"
}
```



---

archive/attachments_015139.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143.patch",
    "created_at": "2011-10-06T15:39:27Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112963.json:
```json
{
    "body": "**Attachment:** [trac_11143.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch)\n\nadds sage/functions/exp_integral.py",
    "created_at": "2011-10-06T15:39:27Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112963",
    "user": "https://github.com/benjaminfjones"
}
```

**Attachment:** [trac_11143.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch)

adds sage/functions/exp_integral.py



---

archive/issue_comments_112964.json:
```json
{
    "body": "<a id='comment:29'></a>\nThere were a few doctests failing in sage/misc/sagedoc.py that I missed. The patch just uploaded now *really* doesn't break anything according to `make ptestlong`.\n\nThere are some strange doctests in sagedoc.py, especially the recursive ones. I fixed doctests that need changing when a pynac function is added to the Sage library and then, because I changed a docstring in that file, another doctest failed. Phew..",
    "created_at": "2011-10-06T15:42:56Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112964",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:29'></a>
There were a few doctests failing in sage/misc/sagedoc.py that I missed. The patch just uploaded now *really* doesn't break anything according to `make ptestlong`.

There are some strange doctests in sagedoc.py, especially the recursive ones. I fixed doctests that need changing when a pynac function is added to the Sage library and then, because I changed a docstring in that file, another doctest failed. Phew..



---

archive/issue_comments_112965.json:
```json
{
    "body": "**Changing dependencies** from \"#11513\" to \"#11513, 11885\".",
    "created_at": "2011-10-09T01:29:49Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112965",
    "user": "https://github.com/kcrisman"
}
```

**Changing dependencies** from "#11513" to "#11513, 11885".



---

archive/issue_comments_112966.json:
```json
{
    "body": "<a id='comment:30'></a>\nImpressive work.  No guarantees that I'll be able to look through this long patch with a fine-tooth comb anytime soon, but this will be a great addition - I really like `Ci` and `Si` being in.  \n\n```\n    \\operatorname{li}(x) = \\int_0^z \\frac{dt}{\\ln(t)} = \\operatorname{Ei}(\\ln(x)) \n```\n?? What happened to the x in the middle?  \n\nAlso, what relation does this function bear to `Li` (I assume it's the `\\int_0` as opposed to `\\int_2`, if I recall correctly), and why is that not mentioned?  See #7357.  I have to say that the names of the functions are ... very long.  Is there a problem with the fairly standard `Li` and `li`?\n\nSee also #3401, though I don't know if that is *directly* relevant for this particular set of functions.",
    "created_at": "2011-10-09T01:29:49Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112966",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:30'></a>
Impressive work.  No guarantees that I'll be able to look through this long patch with a fine-tooth comb anytime soon, but this will be a great addition - I really like `Ci` and `Si` being in.  

```
    \operatorname{li}(x) = \int_0^z \frac{dt}{\ln(t)} = \operatorname{Ei}(\ln(x)) 
```
?? What happened to the x in the middle?  

Also, what relation does this function bear to `Li` (I assume it's the `\int_0` as opposed to `\int_2`, if I recall correctly), and why is that not mentioned?  See #7357.  I have to say that the names of the functions are ... very long.  Is there a problem with the fairly standard `Li` and `li`?

See also #3401, though I don't know if that is *directly* relevant for this particular set of functions.



---

archive/issue_comments_112967.json:
```json
{
    "body": "**Changing dependencies** from \"#11513, 11885\" to \"#11513, #11885\".",
    "created_at": "2011-10-09T01:30:38Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112967",
    "user": "https://github.com/kcrisman"
}
```

**Changing dependencies** from "#11513, 11885" to "#11513, #11885".



---

archive/issue_comments_112968.json:
```json
{
    "body": "<a id='comment:32'></a>\n@kcrisman - Yes, thanks, I just spotted that typo in the docstring for `exp_integral_li` while I was commenting on the other tickets you cc'd me on.\n\nThe function names are long. I wanted to choose a common prefix for all the exponential integrals. I think burcin suggested `exp_integral` originally. I think the problem with `li` and `Li`, or `En` and `Ei`, etc.. is that the name is very short and not very informative unless you are familiar with all the different varieties of standard exponential integrals. Also, I think the short two-letter names would be easy to mix up, especially `li` and `Li`. Yes, you're right, the difference between those logarithmic integrals is the constant `\\int_0^2 1/log(t) dt`.\n\nI made some comments on #7357 and #3401. Basically, I think it makes sense to roll the issues in those two tickets into this one since this one is an overhaul of the exponential integral functions with the aim to make them all symbolic and organize them in the same module.",
    "created_at": "2011-10-09T02:02:02Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112968",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:32'></a>
@kcrisman - Yes, thanks, I just spotted that typo in the docstring for `exp_integral_li` while I was commenting on the other tickets you cc'd me on.

The function names are long. I wanted to choose a common prefix for all the exponential integrals. I think burcin suggested `exp_integral` originally. I think the problem with `li` and `Li`, or `En` and `Ei`, etc.. is that the name is very short and not very informative unless you are familiar with all the different varieties of standard exponential integrals. Also, I think the short two-letter names would be easy to mix up, especially `li` and `Li`. Yes, you're right, the difference between those logarithmic integrals is the constant `\int_0^2 1/log(t) dt`.

I made some comments on #7357 and #3401. Basically, I think it makes sense to roll the issues in those two tickets into this one since this one is an overhaul of the exponential integral functions with the aim to make them all symbolic and organize them in the same module.



---

archive/issue_comments_112969.json:
```json
{
    "body": "<a id='comment:33'></a>\nSorry for the double comment. I remembered the rational for the common prefix. Burcin point out that once a user knows about one exponential integral function, they can type:`exp_integral<tab>` and see the list of all of them. That wouldn't be possible if the names are just the standard mathematical notation li, Li, En, Ei, etc..",
    "created_at": "2011-10-09T02:04:14Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112969",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:33'></a>
Sorry for the double comment. I remembered the rational for the common prefix. Burcin point out that once a user knows about one exponential integral function, they can type:`exp_integral<tab>` and see the list of all of them. That wouldn't be possible if the names are just the standard mathematical notation li, Li, En, Ei, etc..



---

archive/issue_comments_112970.json:
```json
{
    "body": "<a id='comment:34'></a>\nThat second comment about tab-completion makes sense.  I just think it would be helpful to have easy-to-find aliases as well.  [Here](http://reference.wolfram.com/mathematica/guide/ErrorAndExponentialIntegralFunctions.html) are Mathematica's names.  I understand the concern about the standard notation, but it *is* standard, and I would never think to look for log integral under `exp_integral<tab>`, if you catch my drift - and I do know it can be written as one. \n\nSorry about the comments on the other tickets about naming conventions - feel free to ignore those, I read this update last.",
    "created_at": "2011-10-10T02:21:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112970",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:34'></a>
That second comment about tab-completion makes sense.  I just think it would be helpful to have easy-to-find aliases as well.  [Here](http://reference.wolfram.com/mathematica/guide/ErrorAndExponentialIntegralFunctions.html) are Mathematica's names.  I understand the concern about the standard notation, but it *is* standard, and I would never think to look for log integral under `exp_integral<tab>`, if you catch my drift - and I do know it can be written as one. 

Sorry about the comments on the other tickets about naming conventions - feel free to ignore those, I read this update last.



---

archive/issue_comments_112971.json:
```json
{
    "body": "<a id='comment:35'></a>\nI see your point. How about the following names:\n\n* `exp_integral_e`\n* `exp_integral_e1`\n* `exp_integral_ei`\n* `log_integral` (for li)\n* `log_integral_offset` for (Li)\n* `cos_integral`\n* `sin_integral`\n* `sinh_integral`\n* `cosh_integral`\n\n... and maybe aliases for the usual mathematical names: `li, Li, En, Ei, E1, si, ci, shi, chi` ? Perhaps that would be too many new names in the global name space?",
    "created_at": "2011-10-11T22:25:01Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112971",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:35'></a>
I see your point. How about the following names:

* `exp_integral_e`
* `exp_integral_e1`
* `exp_integral_ei`
* `log_integral` (for li)
* `log_integral_offset` for (Li)
* `cos_integral`
* `sin_integral`
* `sinh_integral`
* `cosh_integral`

... and maybe aliases for the usual mathematical names: `li, Li, En, Ei, E1, si, ci, shi, chi` ? Perhaps that would be too many new names in the global name space?



---

archive/issue_comments_112972.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [benjaminfjones](#comment%3A35):\n> I see your point. How about the following names:\n> \n> * `exp_integral_e`\n> * `exp_integral_e1`\n> * `exp_integral_ei`\n> * `log_integral` (for li)\n> * `log_integral_offset` for (Li)\n> * `cos_integral`\n> * `sin_integral`\n> * `sinh_integral`\n> * `cosh_integral`\n\n\nThis could work, and is easier to understand.  Maybe `exp_integral<tab>` could also bring up some command which gave general help for this whole module... ?\n\n> ... and maybe aliases for the usual mathematical names: `li, Li, En, Ei, E1, si, ci, shi, chi` ? Perhaps that would be too many new names in the global name space?\n\n\nYou're right that it's a lot.  On the other hand, `Si` and `li/Li` are fairly standard... I think it might be worth asking on sage-devel as to how many of these would be useful.  I definitely think that things which are global in both Mma and Maple should be okay.  See [Maple help](http://www.maplesoft.com/support/help/Maple/view.aspx?path=Ci) and e.g. [this Mathematica help](http://functions.wolfram.com/GammaBetaErf/SinIntegral/).  Seems like Maple is more likely to support the standard notation as a shortcut.  But at the very least your ideas above are better than the initial one.  \n\nI'll put this as 'needs work' for this reason.  \n\n---\n\nThank you so much for the hard work and at times surely boring work improving this.  There are so many things *already in Sage* which we just need to make easier for the end user.",
    "created_at": "2011-10-12T01:40:38Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112972",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:36'></a>
Replying to [benjaminfjones](#comment%3A35):
> I see your point. How about the following names:
> 
> * `exp_integral_e`
> * `exp_integral_e1`
> * `exp_integral_ei`
> * `log_integral` (for li)
> * `log_integral_offset` for (Li)
> * `cos_integral`
> * `sin_integral`
> * `sinh_integral`
> * `cosh_integral`


This could work, and is easier to understand.  Maybe `exp_integral<tab>` could also bring up some command which gave general help for this whole module... ?

> ... and maybe aliases for the usual mathematical names: `li, Li, En, Ei, E1, si, ci, shi, chi` ? Perhaps that would be too many new names in the global name space?


You're right that it's a lot.  On the other hand, `Si` and `li/Li` are fairly standard... I think it might be worth asking on sage-devel as to how many of these would be useful.  I definitely think that things which are global in both Mma and Maple should be okay.  See [Maple help](http://www.maplesoft.com/support/help/Maple/view.aspx?path=Ci) and e.g. [this Mathematica help](http://functions.wolfram.com/GammaBetaErf/SinIntegral/).  Seems like Maple is more likely to support the standard notation as a shortcut.  But at the very least your ideas above are better than the initial one.  

I'll put this as 'needs work' for this reason.  

---

Thank you so much for the hard work and at times surely boring work improving this.  There are so many things *already in Sage* which we just need to make easier for the end user.



---

archive/issue_events_087130.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-10-12T01:40:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87130"
}
```



---

archive/issue_events_087131.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-10-12T01:40:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87131"
}
```



---

archive/attachments_015140.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143_v2.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143_v2.patch",
    "created_at": "2012-02-22T22:16:05Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112973.json:
```json
{
    "body": "**Attachment:** [trac_11143_v2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch)\n\nrenamed functions according to trac comments and rebased to 5.0.beta5",
    "created_at": "2012-02-22T22:16:05Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112973",
    "user": "https://github.com/benjaminfjones"
}
```

**Attachment:** [trac_11143_v2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch)

renamed functions according to trac comments and rebased to 5.0.beta5



---

archive/issue_events_087132.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-02-22T22:21:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87132"
}
```



---

archive/issue_events_087133.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-02-22T22:21:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87133"
}
```



---

archive/issue_comments_112974.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -130,4 +130,4 @@\n \n Depends on #11513 and #11885.\n \n-Apply [attachment:trac_11143.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch) to the Sage library.\n+Apply [attachment:trac_11143_v2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch) to the Sage library.\n``````\n",
    "created_at": "2012-02-22T22:21:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112974",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -130,4 +130,4 @@
 
 Depends on #11513 and #11885.
 
-Apply [attachment:trac_11143.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143.patch) to the Sage library.
+Apply [attachment:trac_11143_v2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch) to the Sage library.
``````




---

archive/issue_comments_112975.json:
```json
{
    "body": "<a id='comment:37'></a>\nSince all the dependencies have been merged I thought I would rebase this ticket and make the outstanding changes from the last comment. I've changed the names of the functions in the new module `sage/functions/exp_integral.py` according to my proposal in comment [comment:36] and added top-level aliases `li, si, ci, shi, chi`.",
    "created_at": "2012-02-22T22:21:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112975",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:37'></a>
Since all the dependencies have been merged I thought I would rebase this ticket and make the outstanding changes from the last comment. I've changed the names of the functions in the new module `sage/functions/exp_integral.py` according to my proposal in comment [comment:36] and added top-level aliases `li, si, ci, shi, chi`.



---

archive/issue_comments_112976.json:
```json
{
    "body": "<a id='comment:38'></a>\n> Since all the dependencies have been merged I thought I would rebase this ticket and make the outstanding changes from the last comment. I've changed the names of the functions in the new module `sage/functions/exp_integral.py` according to my proposal in comment [comment:36] and added top-level aliases `li, si, ci, shi, chi`.\n\n\nThis came up while preparing for a Sage talk today - I tried \n\n```\nsage: integrate(log(x-1)*e^x,x)\ne*expintegral_e(1, -x + 1) + e^x*log(x - 1)\n```\nand of course it doesn't LaTeX very nicely.  \n\nI'll try to look at this soon.  I already know that we would need to make `si` into `Si`, etc., because that *is* the standard notation (first letter capitalized, see all the references above), but I can make a reviewer patch which does this.  But it sounds like this should be finally ready to go.  Sorry for the long process here!",
    "created_at": "2012-03-09T20:14:27Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112976",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:38'></a>
> Since all the dependencies have been merged I thought I would rebase this ticket and make the outstanding changes from the last comment. I've changed the names of the functions in the new module `sage/functions/exp_integral.py` according to my proposal in comment [comment:36] and added top-level aliases `li, si, ci, shi, chi`.


This came up while preparing for a Sage talk today - I tried 

```
sage: integrate(log(x-1)*e^x,x)
e*expintegral_e(1, -x + 1) + e^x*log(x - 1)
```
and of course it doesn't LaTeX very nicely.  

I'll try to look at this soon.  I already know that we would need to make `si` into `Si`, etc., because that *is* the standard notation (first letter capitalized, see all the references above), but I can make a reviewer patch which does this.  But it sounds like this should be finally ready to go.  Sorry for the long process here!



---

archive/issue_comments_112977.json:
```json
{
    "body": "<a id='comment:39'></a>\nI can fix the latex issues if you haven't started already. I have the afternoon off.",
    "created_at": "2012-03-09T20:54:30Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112977",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:39'></a>
I can fix the latex issues if you haven't started already. I have the afternoon off.



---

archive/issue_comments_112978.json:
```json
{
    "body": "<a id='comment:40'></a>\nI don't know that there *are* any LaTeX issues; the example above was with Sage 4.8!  I suppose you can try that example with this patch to see.  \n\nI only commented to remind myself that we should have `Si` and not `si`, in line with Maple and with Mathematica's documentation on the 'usual' name for this function (though not its command).   It keeps this patch on my mind.  If there is something wrong, though, you can definitely fix it!",
    "created_at": "2012-03-09T20:57:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112978",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:40'></a>
I don't know that there *are* any LaTeX issues; the example above was with Sage 4.8!  I suppose you can try that example with this patch to see.  

I only commented to remind myself that we should have `Si` and not `si`, in line with Maple and with Mathematica's documentation on the 'usual' name for this function (though not its command).   It keeps this patch on my mind.  If there is something wrong, though, you can definitely fix it!



---

archive/issue_comments_112979.json:
```json
{
    "body": "<a id='comment:41'></a>\nApply trac_11143_v2.patch\n\n(for patchbot)",
    "created_at": "2012-03-26T15:31:55Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112979",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:41'></a>
Apply trac_11143_v2.patch

(for patchbot)



---

archive/issue_events_087134.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-26T18:06:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87134"
}
```



---

archive/issue_events_087135.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-26T18:06:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87135"
}
```



---

archive/issue_comments_112980.json:
```json
{
    "body": "**Work Issues:** rebase to 5.0.beta10",
    "created_at": "2012-03-26T18:06:48Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112980",
    "user": "https://github.com/loefflerd"
}
```

**Work Issues:** rebase to 5.0.beta10



---

archive/issue_comments_112981.json:
```json
{
    "body": "<a id='comment:42'></a>\nThis patch doesn't apply to the current Sage beta -- see patchbot logs.",
    "created_at": "2012-03-26T18:06:48Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112981",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:42'></a>
This patch doesn't apply to the current Sage beta -- see patchbot logs.



---

archive/issue_comments_112982.json:
```json
{
    "body": "rebase to 5.0.beta10",
    "created_at": "2012-03-26T20:07:39Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112982",
    "user": "https://github.com/benjaminfjones"
}
```

rebase to 5.0.beta10



---

archive/attachments_015141.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143_v2.2.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143_v2.2.patch",
    "created_at": "2012-03-26T20:08:39Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.2.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112983.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Attachment:** [trac_11143_v2.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.2.patch)\n\nReplying to [davidloeffler](#comment%3A42):\n> This patch doesn't apply to the current Sage beta -- see patchbot logs.\n\n\nThanks for updating the ticket description. I've rebased my patch to 5.0.beta10.",
    "created_at": "2012-03-26T20:08:39Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112983",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:43'></a>
**Attachment:** [trac_11143_v2.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.2.patch)

Replying to [davidloeffler](#comment%3A42):
> This patch doesn't apply to the current Sage beta -- see patchbot logs.


Thanks for updating the ticket description. I've rebased my patch to 5.0.beta10.



---

archive/issue_events_087136.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-26T20:14:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87136"
}
```



---

archive/issue_events_087137.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-26T20:14:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87137"
}
```



---

archive/issue_comments_112984.json:
```json
{
    "body": "<a id='comment:45'></a>\nHi guys. I don't know if this even applies, because I discovered this behaviour on version 4.8, with the patch applied (And it seems to apply to limit rather than anything else.)\nHowever, if I enter the following code:\n\n```\ndef fracintegral(func,n, xsub=x,a=0):\n    t = var('t')\n    assume(t > a)\n    assume(x > a)\n    return integrate(((x-t)^(n-1))*func(t),t,a,x)/gamma(n)\na = fracintegral(sin(x),1/2);a\n```\n\nI get the following returned:\n\n```\n-1/2*(sqrt(x)*sin(x)*exp_integral_e(1/2, -I*x) +\nsqrt(x)*sin(x)*exp_integral_e(1/2, I*x) +\nI*sqrt(x)*cos(x)*exp_integral_e(1/2, -I*x) -\nI*sqrt(x)*cos(x)*exp_integral_e(1/2, I*x) -\n2*limit(1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, -I*t) +\n1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, I*t) -\n1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +\n1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, I*t), t, 0, minus))/sqrt(pi)\n```\n\nIf I copy/paste this into a new sage notebook cell, I get the following error:\n\n```\nTraceback (most recent call last):    1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +\n  File \"\", line 1, in <module>\n    \n  File \"/tmp/tmpbIxhPU/___code___.py\", line 10, in <module>\n    _sage_const_1 /_sage_const_2 *I*sqrt(-t)*cos(x)*exp_integral_e(_sage_const_1 /_sage_const_2 , I*t), t, _sage_const_0 , minus))/sqrt(pi)\nNameError: name 'minus' is not defined\n```\n\nIf I fix up the minus by doing this,\n\n```\n-1/2*(sqrt(x)*sin(x)*exp_integral_e(1/2, -I*x) +\nsqrt(x)*sin(x)*exp_integral_e(1/2, I*x) +\nI*sqrt(x)*cos(x)*exp_integral_e(1/2, -I*x) -\nI*sqrt(x)*cos(x)*exp_integral_e(1/2, I*x) -\n2*limit(1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, -I*t) +\n1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, I*t) -\n1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +\n1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, I*t), t, 0, 'minus'))/sqrt(pi)\n```\n\nI get this error:\n\n```\nTraceback (most recent call last):    1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +\n  File \"\", line 1, in <module>\n    \n  File \"/tmp/tmpI2jAGB/___code___.py\", line 10, in <module>\n    _sage_const_1 /_sage_const_2 *I*sqrt(-t)*cos(x)*exp_integral_e(_sage_const_1 /_sage_const_2 , I*t), t, _sage_const_0 , 'minus'))/sqrt(pi)\n  File \"/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/calculus/calculus.py\", line 1131, in limit\n    raise ValueError, \"call the limit function like this, e.g. limit(expr, x=2).\"\nValueError: call the limit function like this, e.g. limit(expr, x=2).\n```\n\nThen if I write it up in correct limit syntax like so:\n\n```\nb = 2*limit(1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, -I*t) +\n1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, I*t) -\n1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +\n1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, I*t), t=0, dir='minus'); b\n```\n\nI get literally nothing from the notebook cell. If I then enter b and evaluate in the next cell I get this:\n\n```\n2*limit(1/2*I*sqrt(t)*sin(x)*exp_integral_e(1/2, -I*t) +\n1/2*I*sqrt(t)*sin(x)*exp_integral_e(1/2, I*t) +\n1/2*sqrt(t)*cos(x)*exp_integral_e(1/2, -I*t) -\n1/2*sqrt(t)*cos(x)*exp_integral_e(1/2, I*t), t, 0, minus)\n```\n\n\nThis is all with Pretty Printing turned off. If I turn on Pretty Printing, then the reply from the fracintegral call (on trig functions and exponents) is this:\n\n```\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"_sage_input_35.py\", line 10, in <module>\n    exec compile(u'open(\"___code___.py\",\"w\").write(\"# -*- coding: utf-8 -*-\\\\n\" + _support_.preparse_worksheet_cell(base64.b64decode(\"YSA9IGZyYWNpbnRlZ3JhbChzaW4oeCksMS8yKTth\"),globals())+\"\\\\n\"); execfile(os.path.abspath(\"___code___.py\"))\n  File \"\", line 1, in <module>\n    \n  File \"/tmp/tmpOvxXQw/___code___.py\", line 3, in <module>\n    exec compile(u'a = fracintegral(sin(x),_sage_const_1 /_sage_const_2 );a\n  File \"\", line 1, in <module>\n    \n  File \"/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py\", line 2243, in pretty_print\n    view(object)\n  File \"/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py\", line 1969, in view\n    s = _latex_file_(objects, title=title, sep=sep, tiny=tiny, debug=debug, **latex_options)\n  File \"/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py\", line 1624, in _latex_file_\n    L = latex(x)\n  File \"/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py\", line 875, in __call__\n    return LatexExpr(x._latex_())\n  File \"expression.pyx\", line 667, in sage.symbolic.expression.Expression._latex_ (sage/symbolic/expression.cpp:4121)\n  File \"ring.pyx\", line 596, in sage.symbolic.ring.SymbolicRing._latex_element_ (sage/symbolic/ring.cpp:6461)\n  File \"pynac.pyx\", line 433, in sage.symbolic.pynac.py_latex_function (sage/symbolic/pynac.cpp:4702)\n  File \"pynac.pyx\", line 407, in sage.symbolic.pynac.py_latex_function_pystring (sage/symbolic/pynac.cpp:4328)\nTypeError: _limit_latex_() takes exactly 4 arguments (5 given)\n```\n\nLet me know if I should put this into another ticket for limit, but kcrisman asked me to put this up here first.",
    "created_at": "2012-03-28T23:40:11Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112984",
    "user": "https://trac.sagemath.org/admin/accounts/users/JoalHeagney"
}
```

<a id='comment:45'></a>
Hi guys. I don't know if this even applies, because I discovered this behaviour on version 4.8, with the patch applied (And it seems to apply to limit rather than anything else.)
However, if I enter the following code:

```
def fracintegral(func,n, xsub=x,a=0):
    t = var('t')
    assume(t > a)
    assume(x > a)
    return integrate(((x-t)^(n-1))*func(t),t,a,x)/gamma(n)
a = fracintegral(sin(x),1/2);a
```

I get the following returned:

```
-1/2*(sqrt(x)*sin(x)*exp_integral_e(1/2, -I*x) +
sqrt(x)*sin(x)*exp_integral_e(1/2, I*x) +
I*sqrt(x)*cos(x)*exp_integral_e(1/2, -I*x) -
I*sqrt(x)*cos(x)*exp_integral_e(1/2, I*x) -
2*limit(1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, -I*t) +
1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, I*t) -
1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +
1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, I*t), t, 0, minus))/sqrt(pi)
```

If I copy/paste this into a new sage notebook cell, I get the following error:

```
Traceback (most recent call last):    1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +
  File "", line 1, in <module>
    
  File "/tmp/tmpbIxhPU/___code___.py", line 10, in <module>
    _sage_const_1 /_sage_const_2 *I*sqrt(-t)*cos(x)*exp_integral_e(_sage_const_1 /_sage_const_2 , I*t), t, _sage_const_0 , minus))/sqrt(pi)
NameError: name 'minus' is not defined
```

If I fix up the minus by doing this,

```
-1/2*(sqrt(x)*sin(x)*exp_integral_e(1/2, -I*x) +
sqrt(x)*sin(x)*exp_integral_e(1/2, I*x) +
I*sqrt(x)*cos(x)*exp_integral_e(1/2, -I*x) -
I*sqrt(x)*cos(x)*exp_integral_e(1/2, I*x) -
2*limit(1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, -I*t) +
1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, I*t) -
1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +
1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, I*t), t, 0, 'minus'))/sqrt(pi)
```

I get this error:

```
Traceback (most recent call last):    1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +
  File "", line 1, in <module>
    
  File "/tmp/tmpI2jAGB/___code___.py", line 10, in <module>
    _sage_const_1 /_sage_const_2 *I*sqrt(-t)*cos(x)*exp_integral_e(_sage_const_1 /_sage_const_2 , I*t), t, _sage_const_0 , 'minus'))/sqrt(pi)
  File "/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/calculus/calculus.py", line 1131, in limit
    raise ValueError, "call the limit function like this, e.g. limit(expr, x=2)."
ValueError: call the limit function like this, e.g. limit(expr, x=2).
```

Then if I write it up in correct limit syntax like so:

```
b = 2*limit(1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, -I*t) +
1/2*sqrt(-t)*sin(x)*exp_integral_e(1/2, I*t) -
1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, -I*t) +
1/2*I*sqrt(-t)*cos(x)*exp_integral_e(1/2, I*t), t=0, dir='minus'); b
```

I get literally nothing from the notebook cell. If I then enter b and evaluate in the next cell I get this:

```
2*limit(1/2*I*sqrt(t)*sin(x)*exp_integral_e(1/2, -I*t) +
1/2*I*sqrt(t)*sin(x)*exp_integral_e(1/2, I*t) +
1/2*sqrt(t)*cos(x)*exp_integral_e(1/2, -I*t) -
1/2*sqrt(t)*cos(x)*exp_integral_e(1/2, I*t), t, 0, minus)
```


This is all with Pretty Printing turned off. If I turn on Pretty Printing, then the reply from the fracintegral call (on trig functions and exponents) is this:

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_35.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("YSA9IGZyYWNpbnRlZ3JhbChzaW4oeCksMS8yKTth"),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/tmp/tmpOvxXQw/___code___.py", line 3, in <module>
    exec compile(u'a = fracintegral(sin(x),_sage_const_1 /_sage_const_2 );a
  File "", line 1, in <module>
    
  File "/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py", line 2243, in pretty_print
    view(object)
  File "/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py", line 1969, in view
    s = _latex_file_(objects, title=title, sep=sep, tiny=tiny, debug=debug, **latex_options)
  File "/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py", line 1624, in _latex_file_
    L = latex(x)
  File "/home/joal/bin/sage-4.8-linux-64bit-ubuntu_10.04.3_lts-x86_64-Linux/local/lib/python2.6/site-packages/sage/misc/latex.py", line 875, in __call__
    return LatexExpr(x._latex_())
  File "expression.pyx", line 667, in sage.symbolic.expression.Expression._latex_ (sage/symbolic/expression.cpp:4121)
  File "ring.pyx", line 596, in sage.symbolic.ring.SymbolicRing._latex_element_ (sage/symbolic/ring.cpp:6461)
  File "pynac.pyx", line 433, in sage.symbolic.pynac.py_latex_function (sage/symbolic/pynac.cpp:4702)
  File "pynac.pyx", line 407, in sage.symbolic.pynac.py_latex_function_pystring (sage/symbolic/pynac.cpp:4328)
TypeError: _limit_latex_() takes exactly 4 arguments (5 given)
```

Let me know if I should put this into another ticket for limit, but kcrisman asked me to put this up here first.



---

archive/attachments_015142.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143_v2.3.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143_v2.3.patch",
    "created_at": "2012-04-06T18:50:24Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112985.json:
```json
{
    "body": "**Attachment:** [trac_11143_v2.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch)\n\nremoved trailing whitespace",
    "created_at": "2012-04-06T18:50:24Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112985",
    "user": "https://github.com/benjaminfjones"
}
```

**Attachment:** [trac_11143_v2.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch)

removed trailing whitespace



---

archive/issue_comments_112986.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -128,6 +128,4 @@\n \n ---\n \n-Depends on #11513 and #11885.\n-\n-Apply [attachment:trac_11143_v2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch) to the Sage library.\n+Apply [attachment:trac_11143_v2.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch) to the Sage library.\n``````\n",
    "created_at": "2012-04-06T18:51:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112986",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -128,6 +128,4 @@
 
 ---
 
-Depends on #11513 and #11885.
-
-Apply [attachment:trac_11143_v2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.patch) to the Sage library.
+Apply [attachment:trac_11143_v2.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch) to the Sage library.
``````




---

archive/issue_comments_112987.json:
```json
{
    "body": "**Changing dependencies** from \"#11513, #11885\" to \"\".",
    "created_at": "2012-04-06T18:51:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112987",
    "user": "https://github.com/benjaminfjones"
}
```

**Changing dependencies** from "#11513, #11885" to "".



---

archive/issue_comments_112988.json:
```json
{
    "body": "<a id='comment:47'></a>\nwhile looking in the sources for the old name `expintegral_e` I found the following\ninstance:\n\n```\nsage: search_src(\"expintegral_e\")\nfunctions/exp_integral.py:393:        x*log_integral(x) - expintegral_ei(2*log(x))\nsage: expintegral_ei?\nObject `expintegral_ei` not found.\n```\nThat should be fixed too.\n\nPaul\n\nPS: the patch applied cleanly to 5.0, thus I removed the \"rebase to 5.0.beta10\" work issue",
    "created_at": "2012-05-25T09:03:18Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112988",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:47'></a>
while looking in the sources for the old name `expintegral_e` I found the following
instance:

```
sage: search_src("expintegral_e")
functions/exp_integral.py:393:        x*log_integral(x) - expintegral_ei(2*log(x))
sage: expintegral_ei?
Object `expintegral_ei` not found.
```
That should be fixed too.

Paul

PS: the patch applied cleanly to 5.0, thus I removed the "rebase to 5.0.beta10" work issue



---

archive/issue_events_087138.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-05-25T09:03:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87138"
}
```



---

archive/issue_events_087139.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-05-25T09:03:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87139"
}
```



---

archive/issue_comments_112989.json:
```json
{
    "body": "**Changing work issues** from \"rebase to 5.0.beta10\" to \"define expintegral_ei\".",
    "created_at": "2012-05-25T09:03:18Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112989",
    "user": "https://github.com/zimmermann6"
}
```

**Changing work issues** from "rebase to 5.0.beta10" to "define expintegral_ei".



---

archive/attachments_015143.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143_v2.4.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143_v2.4.patch",
    "created_at": "2012-05-25T17:57:48Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.4.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112990.json:
```json
{
    "body": "<a id='comment:48'></a>\n**Attachment:** [trac_11143_v2.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.4.patch)\n\nGood catch, I've added the maxima conversion for `expintegral_ei` in the new patch. I've also changed the top level aliases `si` -> `Si`, `ci` -> `Ci`, etc.. to match standard notation. The added file `exp_integral.py` passes all tests, I'm running the full test suite now.\n\nPatchbot: apply [This is the Trac macro *attachment:trac_11143_v2.4.patch * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_11143_v2.4.patch -macro)",
    "created_at": "2012-05-25T17:57:48Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112990",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:48'></a>
**Attachment:** [trac_11143_v2.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.4.patch)

Good catch, I've added the maxima conversion for `expintegral_ei` in the new patch. I've also changed the top level aliases `si` -> `Si`, `ci` -> `Ci`, etc.. to match standard notation. The added file `exp_integral.py` passes all tests, I'm running the full test suite now.

Patchbot: apply [This is the Trac macro *attachment:trac_11143_v2.4.patch * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_11143_v2.4.patch -macro)



---

archive/issue_comments_112991.json:
```json
{
    "body": "**Changing work issues** from \"define expintegral_ei\" to \"\".",
    "created_at": "2012-05-25T17:57:48Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112991",
    "user": "https://github.com/benjaminfjones"
}
```

**Changing work issues** from "define expintegral_ei" to "".



---

archive/issue_events_087140.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-05-25T17:57:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87140"
}
```



---

archive/issue_events_087141.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-05-25T17:57:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87141"
}
```



---

archive/issue_comments_112992.json:
```json
{
    "body": "**Changing keywords** from \"ei Ei special function maxima sd32\" to \"ei Ei special function maxima sd32 sd40.5\".",
    "created_at": "2012-05-25T18:09:29Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112992",
    "user": "https://github.com/benjaminfjones"
}
```

**Changing keywords** from "ei Ei special function maxima sd32" to "ei Ei special function maxima sd32 sd40.5".



---

archive/issue_comments_112993.json:
```json
{
    "body": "<a id='comment:50'></a>\nLooks good!  A few quirks I've noticed:\n\n(1) li behaves a little differently with respect to autoevaluation at 0:\n\n```\nsage: Si(0)\n0\nsage: Shi(0)\n0\nsage: li(0)\nlog_integral(0)\nsage: li(0).simplify()\n0\nsage: li(0).n()\n0.000000000000000\n```\n\n(2) In the (probably semi-deprecated; it works with Python floats) exponential_integral_1, we should special-case 0:\n\n```\nsage: exp_integral_e1(0.01)\n4.03792957653811\nsage: exponential_integral_1(0.01)\n4.037929576538114\nsage: exp_integral_e1(0)\nexp_integral_e1(0)\nsage: exp_integral_e1(0).n()\n+infinity\nsage: exponential_integral_1(0)\n---------------------------------------------------------------------------\nPariError                                 Traceback (most recent call last)\n\n/Users/mcneil/sagedev/sage-5.1.beta0/devel/sage-hack/sage/<ipython console> in <module>()\n\n/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/functions/exp_integral.pyc in exponential_integral_1(x, n)\n   1327     from sage.libs.pari.all import pari\n   1328     if n <= 0:\n-> 1329         return float(pari(x).eint1())\n   1330     else:\n   1331         return [float(z) for z in pari(x).eint1(n)]\n\n/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen._pari_trap (sage/libs/pari/gen.c:49907)()\n\nPariError:  (5)\n```\n\n(3) There's something going on with integration I don't understand:\n\n```\n\nsage: integrate(sinh_integral(x), x)\nx*sinh_integral(x) - cosh(x)\nsage: integrate(sinh_integral(x), x, 0, 1/2)\n-cosh(1/2) + 1/2*sinh_integral(1/2) + 1\nsage: integrate(sinh_integral(x), x, 0, 1/2).n()\n0.125872409703453\nsage: \nsage: integrate(sinh_integral(x), x, 0.0, 0.5)\n0.125872409703 + 1.57079632679*I\n\n```\n\nIOW, somehow we pick up a pi/2 I, and it probably happens on our side:\n\n```\n\nIn [7]: quad(lambda x: shi(x), [0, 0.5])\nOut[7]: mpf('0.12587240970345281')\n\n```",
    "created_at": "2012-05-26T17:18:13Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112993",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

<a id='comment:50'></a>
Looks good!  A few quirks I've noticed:

(1) li behaves a little differently with respect to autoevaluation at 0:

```
sage: Si(0)
0
sage: Shi(0)
0
sage: li(0)
log_integral(0)
sage: li(0).simplify()
0
sage: li(0).n()
0.000000000000000
```

(2) In the (probably semi-deprecated; it works with Python floats) exponential_integral_1, we should special-case 0:

```
sage: exp_integral_e1(0.01)
4.03792957653811
sage: exponential_integral_1(0.01)
4.037929576538114
sage: exp_integral_e1(0)
exp_integral_e1(0)
sage: exp_integral_e1(0).n()
+infinity
sage: exponential_integral_1(0)
---------------------------------------------------------------------------
PariError                                 Traceback (most recent call last)

/Users/mcneil/sagedev/sage-5.1.beta0/devel/sage-hack/sage/<ipython console> in <module>()

/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/functions/exp_integral.pyc in exponential_integral_1(x, n)
   1327     from sage.libs.pari.all import pari
   1328     if n <= 0:
-> 1329         return float(pari(x).eint1())
   1330     else:
   1331         return [float(z) for z in pari(x).eint1(n)]

/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen._pari_trap (sage/libs/pari/gen.c:49907)()

PariError:  (5)
```

(3) There's something going on with integration I don't understand:

```

sage: integrate(sinh_integral(x), x)
x*sinh_integral(x) - cosh(x)
sage: integrate(sinh_integral(x), x, 0, 1/2)
-cosh(1/2) + 1/2*sinh_integral(1/2) + 1
sage: integrate(sinh_integral(x), x, 0, 1/2).n()
0.125872409703453
sage: 
sage: integrate(sinh_integral(x), x, 0.0, 0.5)
0.125872409703 + 1.57079632679*I

```

IOW, somehow we pick up a pi/2 I, and it probably happens on our side:

```

In [7]: quad(lambda x: shi(x), [0, 0.5])
Out[7]: mpf('0.12587240970345281')

```



---

archive/issue_comments_112994.json:
```json
{
    "body": "<a id='comment:51'></a>\nThis is really great.  I've checked a number of things against Wolfram Alpha, doc has lots of great examples, excellent work.  Great catches, Doug.\n\nWe can now completely remove `exp_int`, because it was deprecated over two years ago.\n\nSee #3401 for making the offset log integral symbolic as well.  William would really like this.",
    "created_at": "2012-05-26T17:26:33Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112994",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:51'></a>
This is really great.  I've checked a number of things against Wolfram Alpha, doc has lots of great examples, excellent work.  Great catches, Doug.

We can now completely remove `exp_int`, because it was deprecated over two years ago.

See #3401 for making the offset log integral symbolic as well.  William would really like this.



---

archive/issue_comments_112995.json:
```json
{
    "body": "<a id='comment:52'></a>\nOkay, I've reported the issue with Maxima using the wrong branch for `Shi` at [this bug tracker ticket](https://sourceforge.net/tracker/?func=detail&aid=3529992&group_id=4933&atid=104933).\n\n```\n(%i30) float(expintegral_shi(1/2));\n(%o30) 3.141592653589793*%i+0.506996749819667\n```",
    "created_at": "2012-05-26T18:07:51Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112995",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:52'></a>
Okay, I've reported the issue with Maxima using the wrong branch for `Shi` at [this bug tracker ticket](https://sourceforge.net/tracker/?func=detail&aid=3529992&group_id=4933&atid=104933).

```
(%i30) float(expintegral_shi(1/2));
(%o30) 3.141592653589793*%i+0.506996749819667
```



---

archive/issue_comments_112996.json:
```json
{
    "body": "<a id='comment:53'></a>\nThanks, kcrisman.  Since after real-world discussions it appears that the integration difficulty is another Maxima quirk, I don't think we should hold up approving this, especially because it can be worked around.  I do think it's worth warning the user, and the example will serve as a reminder to us that it can be removed when we update to a version of Maxima which finally fixes it, 'cause the doctest will fail.\n\nSo I propose adding the following to EXAMPLES for sinh_integral:\n\n```\n\n    Note that due to some problems with the way Maxima handles these\n    expressions, definite integrals can sometimes give unexpected\n    results (typically when using inexact endpoints) due to\n    inconsistent branching::\n\n        sage: integrate(sinh_integral(x), x, 0, 1/2)\n        -cosh(1/2) + 1/2*sinh_integral(1/2) + 1\n        sage: integrate(sinh_integral(x), x, 0, 1/2).n() # right\n        0.125872409703453\n        sage: integrate(sinh_integral(x), x, 0, 0.5).n() # wrong!\n        0.125872409703453 + 1.57079632679490*I\n\n```",
    "created_at": "2012-05-26T18:11:35Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112996",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

<a id='comment:53'></a>
Thanks, kcrisman.  Since after real-world discussions it appears that the integration difficulty is another Maxima quirk, I don't think we should hold up approving this, especially because it can be worked around.  I do think it's worth warning the user, and the example will serve as a reminder to us that it can be removed when we update to a version of Maxima which finally fixes it, 'cause the doctest will fail.

So I propose adding the following to EXAMPLES for sinh_integral:

```

    Note that due to some problems with the way Maxima handles these
    expressions, definite integrals can sometimes give unexpected
    results (typically when using inexact endpoints) due to
    inconsistent branching::

        sage: integrate(sinh_integral(x), x, 0, 1/2)
        -cosh(1/2) + 1/2*sinh_integral(1/2) + 1
        sage: integrate(sinh_integral(x), x, 0, 1/2).n() # right
        0.125872409703453
        sage: integrate(sinh_integral(x), x, 0, 0.5).n() # wrong!
        0.125872409703453 + 1.57079632679490*I

```



---

archive/issue_comments_112997.json:
```json
{
    "body": "addresses log_integral(0) -> 0, exponential_integral_1(0) -> Infinity, sinh_integral issues, etc..",
    "created_at": "2012-05-26T20:10:32Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112997",
    "user": "https://github.com/benjaminfjones"
}
```

addresses log_integral(0) -> 0, exponential_integral_1(0) -> Infinity, sinh_integral issues, etc..



---

archive/attachments_015144.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143_v2.5.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143_v2.5.patch",
    "created_at": "2012-05-26T20:14:05Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_112998.json:
```json
{
    "body": "<a id='comment:54'></a>\n**Attachment:** [trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)\n\nThe new patch should take care of dsm's (1), (2), (3) and kcrisman's `exp_int` removal. Please test the new automatic simplification code in `log_integral` and `exponential_integral_1`.\n\nPatchbot: apply [This is the Trac macro *attachment:trac_11143_v2.5.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_11143_v2.5.patch-macro)",
    "created_at": "2012-05-26T20:14:05Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112998",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:54'></a>
**Attachment:** [trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)

The new patch should take care of dsm's (1), (2), (3) and kcrisman's `exp_int` removal. Please test the new automatic simplification code in `log_integral` and `exponential_integral_1`.

Patchbot: apply [This is the Trac macro *attachment:trac_11143_v2.5.patch* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_11143_v2.5.patch-macro)



---

archive/issue_comments_112999.json:
```json
{
    "body": "<a id='comment:55'></a>\nI don't like this.\n\n```\nsage: li(0)\n0\nsage: type(li(0))\n<type 'sage.rings.integer.Integer'>\nsage: Si(0)\n0\nsage: type(Si(0))\n<type 'sage.rings.integer.Integer'>\n```\nThe reason is \n\n```\n        # special case: z = 0 \n\t        if isinstance(z, Expression): \n\t            if z.is_trivial_zero(): \n\t                return z \n\t        else: \n\t            if not z: \n\t                return z \n```\ntype code, because of course the zero `z` we input is not an expression, but is `not z`, so we return the **Integer** zero instead of the **symbolic** zero.\n\nOf course, we're inconsistent here:\n\n```\nsage: sin(0)\n0\nsage: type(sin(0))\n<type 'int'>\n```\nOops.  But under the philosophy of\n\n```\nsage: f(x) = x^2\nsage: f(0)\n0\nsage: type(f(0))\n<type 'sage.symbolic.expression.Expression'>\n```\nI think we should return an `Expression`.",
    "created_at": "2012-05-26T20:57:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-112999",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:55'></a>
I don't like this.

```
sage: li(0)
0
sage: type(li(0))
<type 'sage.rings.integer.Integer'>
sage: Si(0)
0
sage: type(Si(0))
<type 'sage.rings.integer.Integer'>
```
The reason is 

```
        # special case: z = 0 
	        if isinstance(z, Expression): 
	            if z.is_trivial_zero(): 
	                return z 
	        else: 
	            if not z: 
	                return z 
```
type code, because of course the zero `z` we input is not an expression, but is `not z`, so we return the **Integer** zero instead of the **symbolic** zero.

Of course, we're inconsistent here:

```
sage: sin(0)
0
sage: type(sin(0))
<type 'int'>
```
Oops.  But under the philosophy of

```
sage: f(x) = x^2
sage: f(0)
0
sage: type(f(0))
<type 'sage.symbolic.expression.Expression'>
```
I think we should return an `Expression`.



---

archive/issue_comments_113000.json:
```json
{
    "body": "<a id='comment:56'></a>\nFor the record, I think we should try as much as possible to return outputs with the same parent as the input (whenever this makes sense). For `li(int(0))` we should get `int(0)`, for `li(Integer(0))` we should get `Integer(0)`, etc..",
    "created_at": "2012-05-27T02:08:20Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113000",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:56'></a>
For the record, I think we should try as much as possible to return outputs with the same parent as the input (whenever this makes sense). For `li(int(0))` we should get `int(0)`, for `li(Integer(0))` we should get `Integer(0)`, etc..



---

archive/issue_comments_113001.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -128,4 +128,4 @@\n \n ---\n \n-Apply [attachment:trac_11143_v2.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch) to the Sage library.\n+Apply [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch) to the Sage library.\n``````\n",
    "created_at": "2012-05-27T04:27:03Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113001",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -128,4 +128,4 @@
 
 ---
 
-Apply [attachment:trac_11143_v2.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.3.patch) to the Sage library.
+Apply [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch) to the Sage library.
``````




---

archive/issue_comments_113002.json:
```json
{
    "body": "**Changing reviewer** from \"Burcin Erocal, Karl-Dieter Crisman\" to \"Burcin Erocal, Karl-Dieter Crisman, William Stein\".",
    "created_at": "2012-05-28T19:34:36Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113002",
    "user": "https://github.com/williamstein"
}
```

**Changing reviewer** from "Burcin Erocal, Karl-Dieter Crisman" to "Burcin Erocal, Karl-Dieter Crisman, William Stein".



---

archive/issue_events_087142.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-28T19:34:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87142"
}
```



---

archive/issue_events_087143.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2012-05-28T19:34:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87143"
}
```



---

archive/issue_comments_113003.json:
```json
{
    "body": "<a id='comment:58'></a>\nLooks good to me.  I've attached a little referee patch.",
    "created_at": "2012-05-28T19:34:36Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113003",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:58'></a>
Looks good to me.  I've attached a little referee patch.



---

archive/issue_comments_113004.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -128,4 +128,6 @@\n \n ---\n \n-Apply [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch) to the Sage library.\n+Apply to the Sage library:\n+1. [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)\n+2. [attachment:trac-11143-ref.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch)\n``````\n",
    "created_at": "2012-05-28T20:18:07Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113004",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -128,4 +128,6 @@
 
 ---
 
-Apply [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch) to the Sage library.
+Apply to the Sage library:
+1. [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)
+2. [attachment:trac-11143-ref.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch)
``````




---

archive/issue_comments_113005.json:
```json
{
    "body": "<a id='comment:59'></a>\nThanks! I'll update the ticket description.",
    "created_at": "2012-05-28T20:18:07Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113005",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:59'></a>
Thanks! I'll update the ticket description.



---

archive/issue_comments_113006.json:
```json
{
    "body": "<a id='comment:60'></a>\nThe reviewer patch introduces an erroneous hunk with a backtick in a random line.",
    "created_at": "2012-05-28T20:31:58Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113006",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:60'></a>
The reviewer patch introduces an erroneous hunk with a backtick in a random line.



---

archive/attachments_015145.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-11143-ref.2.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac-11143-ref.2.patch",
    "created_at": "2012-05-28T20:36:20Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_113007.json:
```json
{
    "body": "**Attachment:** [trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)",
    "created_at": "2012-05-28T20:36:20Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113007",
    "user": "https://github.com/benjaminfjones"
}
```

**Attachment:** [trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)



---

archive/issue_comments_113008.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -130,4 +130,4 @@\n \n Apply to the Sage library:\n 1. [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)\n-2. [attachment:trac-11143-ref.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch)\n+2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n``````\n",
    "created_at": "2012-05-28T20:37:10Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113008",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -130,4 +130,4 @@
 
 Apply to the Sage library:
 1. [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)
-2. [attachment:trac-11143-ref.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch)
+2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
``````




---

archive/attachments_015146.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-11143-ref.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac-11143-ref.patch",
    "created_at": "2012-05-28T20:38:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch",
    "user": "https://github.com/williamstein"
}
```



---

archive/issue_comments_113009.json:
```json
{
    "body": "**Attachment:** [trac-11143-ref.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch)\n\nfixed",
    "created_at": "2012-05-28T20:38:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113009",
    "user": "https://github.com/williamstein"
}
```

**Attachment:** [trac-11143-ref.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.patch)

fixed



---

archive/issue_comments_113010.json:
```json
{
    "body": "<a id='comment:62'></a>\nWith the patches applied to 5.0, my fractional integral code works on sine functions, but I still get the following error if pretty printing is on. Is there a trac post for this?\n\n```\ndef fracintegral(func,xsub,n,a=0):\n    t = var('t')\n    assume(t > a)\n    assume(x > a)\n    return integrate((x-t)^(n-1)*func.subs({xsub:t}),t,a,x)/gamma(n)\na = fracintegral(sin(x),x,1/2)\na\n\n```\nReturns this on the call to a (but not on the assignment of a =):\n\n```\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"_sage_input_19.py\", line 10, in <module>\n    exec compile(u'open(\"___code___.py\",\"w\").write(\"# -*- coding: utf-8 -*-\\\\n\" + _support_.preparse_worksheet_cell(base64.b64decode(\"YQ==\"),globals())+\"\\\\n\"); execfile(os.path.abspath(\"___code___.py\"))\n  File \"\", line 1, in <module>\n    \n  File \"/tmp/tmpJfuEaN/___code___.py\", line 2, in <module>\n    exec compile(u'a\n  File \"\", line 1, in <module>\n    \n  File \"/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 2280, in pretty_print\n    view(object)\n  File \"/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 2006, in view\n    s = _latex_file_(objects, title=title, sep=sep, tiny=tiny, debug=debug, **latex_options)\n  File \"/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 1661, in _latex_file_\n    L = latex(x)\n  File \"/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py\", line 909, in __call__\n    return LatexExpr(x._latex_())\n  File \"expression.pyx\", line 815, in sage.symbolic.expression.Expression._latex_ (sage/symbolic/expression.cpp:4898)\n  File \"ring.pyx\", line 605, in sage.symbolic.ring.SymbolicRing._latex_element_ (sage/symbolic/ring.cpp:6658)\n  File \"pynac.pyx\", line 433, in sage.symbolic.pynac.py_latex_function (sage/symbolic/pynac.cpp:4817)\n  File \"pynac.pyx\", line 407, in sage.symbolic.pynac.py_latex_function_pystring (sage/symbolic/pynac.cpp:4443)\nTypeError: _limit_latex_() takes exactly 4 arguments (5 given)\n```",
    "created_at": "2012-06-09T05:26:35Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113010",
    "user": "https://trac.sagemath.org/admin/accounts/users/JoalHeagney"
}
```

<a id='comment:62'></a>
With the patches applied to 5.0, my fractional integral code works on sine functions, but I still get the following error if pretty printing is on. Is there a trac post for this?

```
def fracintegral(func,xsub,n,a=0):
    t = var('t')
    assume(t > a)
    assume(x > a)
    return integrate((x-t)^(n-1)*func.subs({xsub:t}),t,a,x)/gamma(n)
a = fracintegral(sin(x),x,1/2)
a

```
Returns this on the call to a (but not on the assignment of a =):

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_19.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("YQ=="),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/tmp/tmpJfuEaN/___code___.py", line 2, in <module>
    exec compile(u'a
  File "", line 1, in <module>
    
  File "/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py", line 2280, in pretty_print
    view(object)
  File "/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py", line 2006, in view
    s = _latex_file_(objects, title=title, sep=sep, tiny=tiny, debug=debug, **latex_options)
  File "/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py", line 1661, in _latex_file_
    L = latex(x)
  File "/home/joal/bin/sage-5.0/local/lib/python2.7/site-packages/sage/misc/latex.py", line 909, in __call__
    return LatexExpr(x._latex_())
  File "expression.pyx", line 815, in sage.symbolic.expression.Expression._latex_ (sage/symbolic/expression.cpp:4898)
  File "ring.pyx", line 605, in sage.symbolic.ring.SymbolicRing._latex_element_ (sage/symbolic/ring.cpp:6658)
  File "pynac.pyx", line 433, in sage.symbolic.pynac.py_latex_function (sage/symbolic/pynac.cpp:4817)
  File "pynac.pyx", line 407, in sage.symbolic.pynac.py_latex_function_pystring (sage/symbolic/pynac.cpp:4443)
TypeError: _limit_latex_() takes exactly 4 arguments (5 given)
```



---

archive/issue_events_087144.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:35:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87144"
}
```



---

archive/issue_events_087145.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T13:35:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87145"
}
```



---

archive/issue_comments_113011.json:
```json
{
    "body": "<a id='comment:64'></a>\nThis doesn't apply cleanly to sage-5.1.beta6:\n\n```\napplying /release/merger/patches/trac_11143_v2.5.patch\npatching file sage/functions/all.py\nHunk #1 succeeded at 25 with fuzz 1 (offset 0 lines).\npatching file sage/interfaces/maxima_lib.py\nHunk #1 FAILED at 1354\n1 out of 1 hunks FAILED -- saving rejects to file sage/interfaces/maxima_lib.py.rej\nabort: patch failed to apply\n```",
    "created_at": "2012-06-28T08:32:06Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113011",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:64'></a>
This doesn't apply cleanly to sage-5.1.beta6:

```
applying /release/merger/patches/trac_11143_v2.5.patch
patching file sage/functions/all.py
Hunk #1 succeeded at 25 with fuzz 1 (offset 0 lines).
patching file sage/interfaces/maxima_lib.py
Hunk #1 FAILED at 1354
1 out of 1 hunks FAILED -- saving rejects to file sage/interfaces/maxima_lib.py.rej
abort: patch failed to apply
```



---

archive/issue_events_087146.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-28T08:32:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87146"
}
```



---

archive/issue_events_087147.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-28T08:32:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87147"
}
```



---

archive/issue_comments_113012.json:
```json
{
    "body": "<a id='comment:65'></a>\nThis is a tiny thing due to the Lambert W function, #11888.  I'll upload a clean one to beta6 momentarily.",
    "created_at": "2012-06-28T13:17:56Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113012",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:65'></a>
This is a tiny thing due to the Lambert W function, #11888.  I'll upload a clean one to beta6 momentarily.



---

archive/issue_comments_113013.json:
```json
{
    "body": "Rebased to 5.1.beta6",
    "created_at": "2012-06-28T13:22:25Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113013",
    "user": "https://github.com/kcrisman"
}
```

Rebased to 5.1.beta6



---

archive/issue_events_087148.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-28T13:24:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87148"
}
```



---

archive/issue_events_087149.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-28T13:24:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87149"
}
```



---

archive/issue_comments_113014.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -129,5 +129,5 @@\n ---\n \n Apply to the Sage library:\n-1. [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)\n+1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n``````\n",
    "created_at": "2012-06-28T13:24:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113014",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -129,5 +129,5 @@
 ---
 
 Apply to the Sage library:
-1. [attachment:trac_11143_v2.5.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143_v2.5.patch)
+1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
``````




---

archive/attachments_015147.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143-v2.5-rebased.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143-v2.5-rebased.patch",
    "created_at": "2012-06-28T13:24:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_113015.json:
```json
{
    "body": "<a id='comment:66'></a>\n**Attachment:** [trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n\nPatchbot:\n\nApply to the Sage library:\n1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n\nThis should be fine.",
    "created_at": "2012-06-28T13:24:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113015",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:66'></a>
**Attachment:** [trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)

Patchbot:

Apply to the Sage library:
1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)

This should be fine.



---

archive/issue_events_087150.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-28T16:15:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87150"
}
```



---

archive/issue_events_087151.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-28T16:15:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87151"
}
```



---

archive/issue_comments_113016.json:
```json
{
    "body": "<a id='comment:67'></a>\nHmm, I get an error here.  This is on 5.1.beta6 with these patches only in addition.\n\n```\n\n$ ../../sage -t sage/symbolic/pynac.pyx\nsage -t  \"devel/sage-main/sage/symbolic/pynac.pyx\"          \n**********************************************************************\nFile \"/Users/.../sage-5.1.beta6/devel/sage-main/sage/symbolic/pynac.pyx\", line 544:\n    sage: get_sfunction_from_serial(i) == foo\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/Users/.../sage-5.1.beta6/devel/sage-main/sage/symbolic/pynac.pyx\", line 546:\n    sage: py_latex_fderivative(i, (0, 1, 0, 1), (x, y^z))\nExpected:\n    D[0, 1, 0, 1]func_with_args(x, y^z)\nGot:\n    D[0, 1, 0, 1]\\left({\\rm foo}\\right)\\left(x, y^{z}\\right)\n**********************************************************************\n1 items had failures:\n   2 of  19 in __main__.example_18\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /Users/.../.sage//tmp/pynac_4902.py\n\t [5.7 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t  \"devel/sage-main/sage/symbolic/pynac.pyx\"\nTotal time for all tests: 5.7 seconds\n```",
    "created_at": "2012-06-28T16:15:56Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113016",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:67'></a>
Hmm, I get an error here.  This is on 5.1.beta6 with these patches only in addition.

```

$ ../../sage -t sage/symbolic/pynac.pyx
sage -t  "devel/sage-main/sage/symbolic/pynac.pyx"          
**********************************************************************
File "/Users/.../sage-5.1.beta6/devel/sage-main/sage/symbolic/pynac.pyx", line 544:
    sage: get_sfunction_from_serial(i) == foo
Expected:
    True
Got:
    False
**********************************************************************
File "/Users/.../sage-5.1.beta6/devel/sage-main/sage/symbolic/pynac.pyx", line 546:
    sage: py_latex_fderivative(i, (0, 1, 0, 1), (x, y^z))
Expected:
    D[0, 1, 0, 1]func_with_args(x, y^z)
Got:
    D[0, 1, 0, 1]\left({\rm foo}\right)\left(x, y^{z}\right)
**********************************************************************
1 items had failures:
   2 of  19 in __main__.example_18
***Test Failed*** 2 failures.
For whitespace errors, see the file /Users/.../.sage//tmp/pynac_4902.py
	 [5.7 s]
 
----------------------------------------------------------------------
The following tests failed:


	sage -t  "devel/sage-main/sage/symbolic/pynac.pyx"
Total time for all tests: 5.7 seconds
```



---

archive/issue_comments_113017.json:
```json
{
    "body": "<a id='comment:68'></a>\nI am not sure what is going on here.  Testing this by hand works, testing it in the doctest doesn't.  It's definitely the main patch that causes this.\n\nI had a few semi-educated guesses, but they didn't seem to work.  I'll keep digging.",
    "created_at": "2012-06-28T17:32:21Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113017",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:68'></a>
I am not sure what is going on here.  Testing this by hand works, testing it in the doctest doesn't.  It's definitely the main patch that causes this.

I had a few semi-educated guesses, but they didn't seem to work.  I'll keep digging.



---

archive/issue_comments_113018.json:
```json
{
    "body": "<a id='comment:69'></a>\n> Okay, I've reported the issue with Maxima using the wrong branch for `Shi` at [this bug tracker ticket](https://sourceforge.net/tracker/?func=detail&aid=3529992&group_id=4933&atid=104933).\n> \n> ```\n> (%i30) float(expintegral_shi(1/2));\n> (%o30) 3.141592653589793*%i+0.506996749819667\n> ```\n\n\n\nIncidentally, this is apparently now fixed.  Is this something we should test for (not in this ticket) as well, since we use mpmath for it?  I really hate how there is no link on the Maxima bugtracker as to the actual change in the code.  Makes it harder for new folks to jump in.",
    "created_at": "2012-06-28T17:39:22Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113018",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:69'></a>
> Okay, I've reported the issue with Maxima using the wrong branch for `Shi` at [this bug tracker ticket](https://sourceforge.net/tracker/?func=detail&aid=3529992&group_id=4933&atid=104933).
> 
> ```
> (%i30) float(expintegral_shi(1/2));
> (%o30) 3.141592653589793*%i+0.506996749819667
> ```



Incidentally, this is apparently now fixed.  Is this something we should test for (not in this ticket) as well, since we use mpmath for it?  I really hate how there is no link on the Maxima bugtracker as to the actual change in the code.  Makes it harder for new folks to jump in.



---

archive/issue_comments_113019.json:
```json
{
    "body": "<a id='comment:70'></a>\nAagh!  It *was* what I originally thought - that we just have too many serials now.  But I kept on testing the wrong occurrences of this code.\n\nPatch coming up should fix this *and* at least postpone the agony the next time we add functions...",
    "created_at": "2012-06-28T17:58:20Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113019",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:70'></a>
Aagh!  It *was* what I originally thought - that we just have too many serials now.  But I kept on testing the wrong occurrences of this code.

Patch coming up should fix this *and* at least postpone the agony the next time we add functions...



---

archive/issue_events_087152.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-28T18:06:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87152"
}
```



---

archive/issue_events_087153.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-28T18:06:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87153"
}
```



---

archive/issue_comments_113020.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -131,3 +131,4 @@\n Apply to the Sage library:\n 1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n+3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n``````\n",
    "created_at": "2012-06-28T18:06:16Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113020",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -131,3 +131,4 @@
 Apply to the Sage library:
 1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
+3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
``````




---

archive/attachments_015148.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143-pynac-serials.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143-pynac-serials.patch",
    "created_at": "2012-06-28T18:06:16Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_113021.json:
```json
{
    "body": "<a id='comment:71'></a>\n**Attachment:** [trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n\nPatchbot:\n\nApply to the Sage library:\n1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n\n---\n\nI feel like the latest patch is from an obscure enough piece of code that it could need review.  On the other hand, it is a pretty trivial patch in other ways and only changes doctests.  I'll put positive review for now, but feel free to change it back if you feel otherwise, Jeroen; I'm sure burcin or benjaminfjones would be able to sign off on it pretty quickly otherwise.",
    "created_at": "2012-06-28T18:06:16Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113021",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:71'></a>
**Attachment:** [trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)

Patchbot:

Apply to the Sage library:
1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)

---

I feel like the latest patch is from an obscure enough piece of code that it could need review.  On the other hand, it is a pretty trivial patch in other ways and only changes doctests.  I'll put positive review for now, but feel free to change it back if you feel otherwise, Jeroen; I'm sure burcin or benjaminfjones would be able to sign off on it pretty quickly otherwise.



---

archive/issue_comments_113022.json:
```json
{
    "body": "<a id='comment:72'></a>\nThe patch to the doctests in `sage/symbolic/pnyac.pyx` look (and tests) fine. I suspected it would be something like this, but didn't have the time earlier to track it down. Thanks!",
    "created_at": "2012-06-29T02:30:12Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113022",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:72'></a>
The patch to the doctests in `sage/symbolic/pnyac.pyx` look (and tests) fine. I suspected it would be something like this, but didn't have the time earlier to track it down. Thanks!



---

archive/issue_comments_113023.json:
```json
{
    "body": "<a id='comment:73'></a>\nReplying to [JoalHeagney](#comment%3A62):\n> With the patches applied to 5.0, my fractional integral code works on sine functions, but I still get the following error if pretty printing is on. Is there a trac post for this?\n\n\nSorry not to get to this earlier, Joal.  I have to admit that I haven't got a clue on this one yet, but don't have time to track it down quickly, since this is your own custom code thus far (though perhaps someday it might be useful for Sage?).  Why don't you open a ticket for it, saying something about a pretty print error (as opposed to about fractional integrals).  Then at least it has its own place, and you can document exactly what does and doesn't work.",
    "created_at": "2012-06-29T02:36:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113023",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:73'></a>
Replying to [JoalHeagney](#comment%3A62):
> With the patches applied to 5.0, my fractional integral code works on sine functions, but I still get the following error if pretty printing is on. Is there a trac post for this?


Sorry not to get to this earlier, Joal.  I have to admit that I haven't got a clue on this one yet, but don't have time to track it down quickly, since this is your own custom code thus far (though perhaps someday it might be useful for Sage?).  Why don't you open a ticket for it, saying something about a pretty print error (as opposed to about fractional integrals).  Then at least it has its own place, and you can document exactly what does and doesn't work.



---

archive/issue_comments_113024.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [kcrisman](#comment%3A69):\n\n```\n> > (%i30) float(expintegral_shi(1/2));\n> > (%o30) 3.141592653589793*%i+0.506996749819667\n```\n> Is this something we should test for?\n\n\nyes please!\n\nPaul",
    "created_at": "2012-06-29T15:31:34Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113024",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:74'></a>
Replying to [kcrisman](#comment%3A69):

```
> > (%i30) float(expintegral_shi(1/2));
> > (%o30) 3.141592653589793*%i+0.506996749819667
```
> Is this something we should test for?


yes please!

Paul



---

archive/issue_comments_113025.json:
```json
{
    "body": "<a id='comment:75'></a>\n> \n> ```\n> > > (%i30) float(expintegral_shi(1/2));\n> > > (%o30) 3.141592653589793*%i+0.506996749819667\n> ```\n> > Is this something we should test for?\n\n> \n> yes please!\n\n\nKeep in mind this is a Maxima output, not one we currently can even easily access without using Maxima, since this ticket uses mpmath to evaluate these functions, and we don't (yet) have different algorithm parameters for all these special functions.  We *do* test a fair number of values of the \"Sage\" versions of these functions in this ticket!",
    "created_at": "2012-06-29T15:45:04Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113025",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:75'></a>
> 
> ```
> > > (%i30) float(expintegral_shi(1/2));
> > > (%o30) 3.141592653589793*%i+0.506996749819667
> ```
> > Is this something we should test for?

> 
> yes please!


Keep in mind this is a Maxima output, not one we currently can even easily access without using Maxima, since this ticket uses mpmath to evaluate these functions, and we don't (yet) have different algorithm parameters for all these special functions.  We *do* test a fair number of values of the "Sage" versions of these functions in this ticket!



---

archive/issue_comments_113026.json:
```json
{
    "body": "**Dependencies:** #13109",
    "created_at": "2012-06-30T18:49:26Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113026",
    "user": "https://github.com/vbraun"
}
```

**Dependencies:** #13109



---

archive/issue_events_087154.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-30T18:49:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87154"
}
```



---

archive/issue_events_087155.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-30T18:49:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87155"
}
```



---

archive/issue_comments_113027.json:
```json
{
    "body": "<a id='comment:76'></a>\nSwitching the deprecation to the new syntax.",
    "created_at": "2012-06-30T18:49:26Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113027",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:76'></a>
Switching the deprecation to the new syntax.



---

archive/issue_comments_113028.json:
```json
{
    "body": "**Changing author** from \"Benjamin Jones\" to \"Benjamin Jones, Volker Braun\".",
    "created_at": "2012-06-30T19:02:47Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113028",
    "user": "https://github.com/vbraun"
}
```

**Changing author** from "Benjamin Jones" to "Benjamin Jones, Volker Braun".



---

archive/issue_comments_113029.json:
```json
{
    "body": "<a id='comment:77'></a>\nThe new patch is just rediffed to apply on top of #13109. Switching back to positive review.",
    "created_at": "2012-06-30T19:02:47Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113029",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:77'></a>
The new patch is just rediffed to apply on top of #13109. Switching back to positive review.



---

archive/issue_events_087156.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-30T19:02:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87156"
}
```



---

archive/issue_events_087157.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-06-30T19:02:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87157"
}
```



---

archive/issue_comments_113030.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -129,6 +129,6 @@\n ---\n \n Apply to the Sage library:\n-1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n+1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n``````\n",
    "created_at": "2012-06-30T19:02:47Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113030",
    "user": "https://github.com/vbraun"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -129,6 +129,6 @@
 ---
 
 Apply to the Sage library:
-1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
+1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
``````




---

archive/issue_events_087158.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87158"
}
```



---

archive/issue_events_087159.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:51:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87159"
}
```



---

archive/attachments_015149.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143-v2.5-rebased.2.2.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143-v2.5-rebased.2.2.patch",
    "created_at": "2012-07-08T11:35:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.2.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_113031.json:
```json
{
    "body": "**Attachment:** [trac_11143-v2.5-rebased.2.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.2.patch)\n\nRediffed patch",
    "created_at": "2012-07-08T11:35:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113031",
    "user": "https://github.com/vbraun"
}
```

**Attachment:** [trac_11143-v2.5-rebased.2.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.2.patch)

Rediffed patch



---

archive/issue_comments_113032.json:
```json
{
    "body": "<a id='comment:79'></a>\nThe authors of #11475 thought its a good idea to remove trailing whitespace in random places, which broke this patch. Rediffed for sage-5.2.beta1.",
    "created_at": "2012-07-08T11:37:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113032",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:79'></a>
The authors of #11475 thought its a good idea to remove trailing whitespace in random places, which broke this patch. Rediffed for sage-5.2.beta1.



---

archive/issue_comments_113033.json:
```json
{
    "body": "<a id='comment:80'></a>\nWhat is this pending?  If #11475 has been unmerged, then is there an appropriate patch that can be merged in Sage 5.3, since 5.2.rc0 is out?",
    "created_at": "2012-07-19T20:29:14Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113033",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:80'></a>
What is this pending?  If #11475 has been unmerged, then is there an appropriate patch that can be merged in Sage 5.3, since 5.2.rc0 is out?



---

archive/issue_comments_113034.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -129,6 +129,6 @@\n ---\n \n Apply to the Sage library:\n-1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)\n+1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n``````\n",
    "created_at": "2012-07-20T02:11:10Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113034",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -129,6 +129,6 @@
 ---
 
 Apply to the Sage library:
-1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)
+1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
``````




---

archive/issue_comments_113035.json:
```json
{
    "body": "<a id='comment:81'></a>\nAND the patchbot says it doesn't work.  So there.  Let's see if this works:\n\nApply to the Sage library:\n1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)",
    "created_at": "2012-07-20T02:11:10Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113035",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:81'></a>
AND the patchbot says it doesn't work.  So there.  Let's see if this works:

Apply to the Sage library:
1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)



---

archive/issue_comments_113036.json:
```json
{
    "body": "<a id='comment:82'></a>\nAll tests in sage/calculus, sage/symbolic, and sage/functions pass against 5.2.beta1.  If patchbot later says it's ok, then I think this is ok.  Puttting to Sage 5.3.",
    "created_at": "2012-07-20T02:18:20Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113036",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:82'></a>
All tests in sage/calculus, sage/symbolic, and sage/functions pass against 5.2.beta1.  If patchbot later says it's ok, then I think this is ok.  Puttting to Sage 5.3.



---

archive/issue_events_087160.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-07-20T02:18:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "milestone": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87160"
}
```



---

archive/issue_events_087161.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-07-20T02:18:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87161"
}
```



---

archive/issue_comments_113037.json:
```json
{
    "body": "<a id='comment:83'></a>\nIt was put to sage-pending because of #13109 (which is now merged).",
    "created_at": "2012-07-20T06:41:06Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113037",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:83'></a>
It was put to sage-pending because of #13109 (which is now merged).



---

archive/issue_comments_113038.json:
```json
{
    "body": "<a id='comment:84'></a>\nOh great.  Unfortunately, Volker apparently replaced the patch based on #13109 with one based on #11475, and the previous rebase was before #13109, so I don't think there is any patch that would currently apply...  this is silliness.  I thought that #13109 had been delayed because of the sage-combinat issue, but apparently not?",
    "created_at": "2012-07-20T12:00:14Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113038",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:84'></a>
Oh great.  Unfortunately, Volker apparently replaced the patch based on #13109 with one based on #11475, and the previous rebase was before #13109, so I don't think there is any patch that would currently apply...  this is silliness.  I thought that #13109 had been delayed because of the sage-combinat issue, but apparently not?



---

archive/issue_comments_113039.json:
```json
{
    "body": "<a id='comment:85'></a>\nHey Ben, question.  Which `Li/li` is Maxima using with its conversion?  I think that `expintegral_li` actually correspond to `Li` (#3401), not the `li` provided here, though the integral of `log_integral` does seem right...  Also, while looking at this I noticed that\n\n```\n\\operatorname{li}(x) = \\int_0^z \\frac{dt}{\\ln(t)} = \\operatorname{Ei}(\\ln(x))\n```\nprobably should have a `x` not a `z` in the integral bound.",
    "created_at": "2012-07-27T20:22:19Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113039",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:85'></a>
Hey Ben, question.  Which `Li/li` is Maxima using with its conversion?  I think that `expintegral_li` actually correspond to `Li` (#3401), not the `li` provided here, though the integral of `log_integral` does seem right...  Also, while looking at this I noticed that

```
\operatorname{li}(x) = \int_0^z \frac{dt}{\ln(t)} = \operatorname{Ei}(\ln(x))
```
probably should have a `x` not a `z` in the integral bound.



---

archive/issue_events_087162.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:31:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87162"
}
```



---

archive/issue_events_087163.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:31:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87163"
}
```



---

archive/issue_comments_113040.json:
```json
{
    "body": "<a id='comment:86'></a>\nReplying to [kcrisman](#comment%3A84):\n> Oh great.  Unfortunately, Volker apparently replaced the patch based on #13109 with one based on #11475, and the previous rebase was before #13109, so I don't think there is any patch that would currently apply...\n\n\nIndeed, this needs to be rebased to sage-5.2.rc1.",
    "created_at": "2012-07-27T20:31:08Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113040",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:86'></a>
Replying to [kcrisman](#comment%3A84):
> Oh great.  Unfortunately, Volker apparently replaced the patch based on #13109 with one based on #11475, and the previous rebase was before #13109, so I don't think there is any patch that would currently apply...


Indeed, this needs to be rebased to sage-5.2.rc1.



---

archive/attachments_015150.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143-v2.5-rebased.2.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143-v2.5-rebased.2.patch",
    "created_at": "2012-07-28T03:59:23Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_113041.json:
```json
{
    "body": "**Attachment:** [trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)\n\nRebased patch",
    "created_at": "2012-07-28T03:59:23Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113041",
    "user": "https://github.com/vbraun"
}
```

**Attachment:** [trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)

Rebased patch



---

archive/issue_events_087164.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-07-28T04:00:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87164"
}
```



---

archive/issue_events_087165.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-07-28T04:00:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87165"
}
```



---

archive/issue_comments_113042.json:
```json
{
    "body": "<a id='comment:87'></a>\nThe rebased patch applies on sage-5.2.rc1. Switching this back to positive review",
    "created_at": "2012-07-28T04:00:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113042",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:87'></a>
The rebased patch applies on sage-5.2.rc1. Switching this back to positive review



---

archive/issue_comments_113043.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -129,6 +129,6 @@\n ---\n \n Apply to the Sage library:\n-1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)\n+1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n``````\n",
    "created_at": "2012-07-28T04:00:53Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113043",
    "user": "https://github.com/vbraun"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -129,6 +129,6 @@
 ---
 
 Apply to the Sage library:
-1. [attachment:trac_11143-v2.5-rebased.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.patch)
+1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
``````




---

archive/issue_events_087166.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:07:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87166"
}
```



---

archive/issue_events_087167.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-01T12:07:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87167"
}
```



---

archive/issue_comments_113044.json:
```json
{
    "body": "<a id='comment:88'></a>\nThere is a trivial doctest failure on 32-bit i386 systems (possibly other systems too):\n\n```\nsage -t  --long -force_lib devel/sage/sage/functions/exp_integral.py\n**********************************************************************\nFile \"/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.3.beta1/devel/sage-main/sage/functions/exp_integral.py\", line 1297:\n    sage: w = exponential_integral_1(2,4); w\nExpected:\n    [0.04890051070806112, 0.0037793524098489067, 0.00036008245216265873, 3.7665622843924751e-05] \nGot:\n    [0.04890051070806112, 0.0037793524098489067, 0.00036008245216265873, 3.766562284392475e-05]\n**********************************************************************\n```",
    "created_at": "2012-08-01T12:07:23Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113044",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:88'></a>
There is a trivial doctest failure on 32-bit i386 systems (possibly other systems too):

```
sage -t  --long -force_lib devel/sage/sage/functions/exp_integral.py
**********************************************************************
File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.3.beta1/devel/sage-main/sage/functions/exp_integral.py", line 1297:
    sage: w = exponential_integral_1(2,4); w
Expected:
    [0.04890051070806112, 0.0037793524098489067, 0.00036008245216265873, 3.7665622843924751e-05] 
Got:
    [0.04890051070806112, 0.0037793524098489067, 0.00036008245216265873, 3.766562284392475e-05]
**********************************************************************
```



---

archive/attachments_015151.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143-v2.5-rebased.3.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143-v2.5-rebased.3.patch",
    "created_at": "2012-08-03T05:20:07Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_113045.json:
```json
{
    "body": "**Attachment:** [trac_11143-v2.5-rebased.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch)\n\nfixed failing doctest",
    "created_at": "2012-08-03T05:20:07Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113045",
    "user": "https://github.com/benjaminfjones"
}
```

**Attachment:** [trac_11143-v2.5-rebased.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch)

fixed failing doctest



---

archive/issue_comments_113046.json:
```json
{
    "body": "<a id='comment:89'></a>\nFixed the failing doctest (for the reviewer: this only changed lines 1300--1301 in `sage/functions/exp_integral.py`).",
    "created_at": "2012-08-03T05:22:54Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113046",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:89'></a>
Fixed the failing doctest (for the reviewer: this only changed lines 1300--1301 in `sage/functions/exp_integral.py`).



---

archive/issue_comments_113047.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -129,6 +129,6 @@\n ---\n \n Apply to the Sage library:\n-1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)\n+1. [attachment:trac_11143-v2.5-rebased.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n``````\n",
    "created_at": "2012-08-03T05:22:54Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113047",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -129,6 +129,6 @@
 ---
 
 Apply to the Sage library:
-1. [attachment:trac_11143-v2.5-rebased.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.2.patch)
+1. [attachment:trac_11143-v2.5-rebased.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
``````




---

archive/issue_events_087168.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-08-03T05:22:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87168"
}
```



---

archive/issue_events_087169.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-08-03T05:22:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87169"
}
```



---

archive/issue_events_087170.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-10T20:46:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87170"
}
```



---

archive/issue_events_087171.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-10T20:46:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87171"
}
```



---

archive/issue_comments_113048.json:
```json
{
    "body": "<a id='comment:90'></a>\nWouldn't a *relative* tolerance be better than an absolute one?  With the absolute tolerance, the fourth value can essentially be anything.",
    "created_at": "2012-08-10T20:46:34Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113048",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:90'></a>
Wouldn't a *relative* tolerance be better than an absolute one?  With the absolute tolerance, the fourth value can essentially be anything.



---

archive/issue_comments_113049.json:
```json
{
    "body": "<a id='comment:91'></a>\nYes, you're right. I'll change that.",
    "created_at": "2012-08-11T02:08:57Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113049",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:91'></a>
Yes, you're right. I'll change that.



---

archive/issue_comments_113050.json:
```json
{
    "body": "changed `abs tol` to `rel tol`",
    "created_at": "2012-08-11T03:34:29Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113050",
    "user": "https://github.com/benjaminfjones"
}
```

changed `abs tol` to `rel tol`



---

archive/issue_comments_113051.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -129,6 +129,6 @@\n ---\n \n Apply to the Sage library:\n-1. [attachment:trac_11143-v2.5-rebased.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch)\n+1. [attachment:trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)\n 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\n``````\n",
    "created_at": "2012-08-11T03:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113051",
    "user": "https://github.com/benjaminfjones"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -129,6 +129,6 @@
 ---
 
 Apply to the Sage library:
-1. [attachment:trac_11143-v2.5-rebased.3.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.3.patch)
+1. [attachment:trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)
 2. [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
 3. [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
``````




---

archive/attachments_015152.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11143-v2.5-rebased.4.patch",
    "asset_url": "tarball://root/attachments/ticket11143/trac_11143-v2.5-rebased.4.patch",
    "created_at": "2012-08-11T03:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch",
    "user": "https://github.com/benjaminfjones"
}
```



---

archive/issue_comments_113052.json:
```json
{
    "body": "<a id='comment:92'></a>\n**Attachment:** [trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)",
    "created_at": "2012-08-11T03:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113052",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:92'></a>
**Attachment:** [trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)



---

archive/issue_events_087172.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-08-11T03:35:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87172"
}
```



---

archive/issue_events_087173.json:
```json
{
    "actor": "https://github.com/benjaminfjones",
    "created_at": "2012-08-11T03:35:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87173"
}
```



---

archive/issue_comments_113053.json:
```json
{
    "body": "<a id='comment:93'></a>\nPatchbot, please kindly apply:\n* [attachment:trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)\n* [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)\n* [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)\nto the Sage library.\n\nThank you in advance.",
    "created_at": "2012-08-12T23:31:13Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113053",
    "user": "https://github.com/benjaminfjones"
}
```

<a id='comment:93'></a>
Patchbot, please kindly apply:
* [attachment:trac_11143-v2.5-rebased.4.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-v2.5-rebased.4.patch)
* [attachment:trac-11143-ref.2.patch](https://github.com/sagemath/sage/files/ticket11143/trac-11143-ref.2.patch)
* [attachment:trac_11143-pynac-serials.patch](https://github.com/sagemath/sage/files/ticket11143/trac_11143-pynac-serials.patch)
to the Sage library.

Thank you in advance.



---

archive/issue_comments_113054.json:
```json
{
    "body": "<a id='comment:94'></a>\nI'm happy with the changes to that line.  I haven't re-checked the whole patch again, but I thrust that you didn't change anything else.",
    "created_at": "2012-08-13T10:15:07Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113054",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:94'></a>
I'm happy with the changes to that line.  I haven't re-checked the whole patch again, but I thrust that you didn't change anything else.



---

archive/issue_events_087174.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-13T19:48:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87174"
}
```



---

archive/issue_events_087175.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-13T19:48:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87175"
}
```



---

archive/issue_comments_113055.json:
```json
{
    "body": "**Merged:** sage-5.3.beta2",
    "created_at": "2012-08-14T07:02:21Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113055",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.3.beta2



---

archive/issue_events_087176.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-14T07:02:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87176"
}
```



---

archive/issue_events_087177.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-14T07:02:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11143#event-87177"
}
```



---

archive/issue_comments_113056.json:
```json
{
    "body": "<a id='comment:97'></a>\nSee #14766 for a followup.",
    "created_at": "2013-06-18T17:38:51Z",
    "issue": "https://github.com/sagemath/sage/issues/11143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11143#issuecomment-113056",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:97'></a>
See #14766 for a followup.
