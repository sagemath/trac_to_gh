# Issue 11856: Raise an overflow error if the exponent of a multivariate polynomial flows over

archive/issues_011684.json:
```json
{
    "body": "The following happens at least since sage-4.6.2 and was detected in #4539 by a new doctest:\n\n```\nsage: P.<x,y> = QQ[]\nsage: y^2^30\ny^1073741824\nsage: P.<x,y,z> = QQ[]\nsage: y^2^30\n0\n```\n\nAccording to Hans, the maximal exponent of a variable in a monomial does depend on the number of variables in the ring. There is no function that returns that maximal exponent, but it is stored in the `bitmask` attribute of a ring. The Singular interpreter actually only tests whether the *total* degree is below what is provided by bitmask; in theory, *any* exponent (not only the totall degree) can go up to that bound.\n\nHere is the corresponding code in Singular's `iparith.cc`:\n\n```\nstatic BOOLEAN jjTIMES_P(leftv res, leftv u, leftv v)\n{\n  poly a;\n  poly b;\n  int dummy;\n  if (v->next==NULL)\n  {\n    a=(poly)u->CopyD(POLY_CMD); // works also for VECTOR_CMD\n    if (u->next==NULL)\n    {\n      b=(poly)v->CopyD(POLY_CMD); // works also for VECTOR_CMD\n      if ((a!=NULL) && (b!=NULL)\n      && (pTotaldegree(a)+pTotaldegree(b)>si_max((long)rVar(currRing),(long)currRing->bitmask)))\n      {\n        Werror(\"OVERFLOW in mult(d=%ld, d=%ld, max=%ld)\",\n          pTotaldegree(a),pTotaldegree(b),currRing->bitmask);\n        pDelete(&a);\n        pDelete(&b);\n        return TRUE;\n...\n```\n\nApply\n\n* [attachment:trac11856_exponent_overflow.patch]\n* [attachment:trac11856_fix_docs_32bit.patch]\n\n**Assignee:** @malb\n\n**CC:**  @malb @burcin @alexanderdreyer jakobkroeker\n\n**Keywords:** exponent overflow\n\n**Reviewer:** Martin Albrecht, Alexander Dreyer\n\n**Author:** Simon King\n\n**Merged:** sage-4.7.2.alpha4\n\n**Dependencies:** #10903\n\nIssue created by migration from https://trac.sagemath.org/ticket/11856\n\n",
    "closed_at": "2011-10-07T19:11:31Z",
    "created_at": "2011-09-27T14:37:52Z",
    "labels": [
        "component: commutative algebra",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "Raise an overflow error if the exponent of a multivariate polynomial flows over",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11856",
    "user": "https://github.com/simon-king-jena"
}
```
The following happens at least since sage-4.6.2 and was detected in #4539 by a new doctest:

```
sage: P.<x,y> = QQ[]
sage: y^2^30
y^1073741824
sage: P.<x,y,z> = QQ[]
sage: y^2^30
0
```

According to Hans, the maximal exponent of a variable in a monomial does depend on the number of variables in the ring. There is no function that returns that maximal exponent, but it is stored in the `bitmask` attribute of a ring. The Singular interpreter actually only tests whether the *total* degree is below what is provided by bitmask; in theory, *any* exponent (not only the totall degree) can go up to that bound.

Here is the corresponding code in Singular's `iparith.cc`:

```
static BOOLEAN jjTIMES_P(leftv res, leftv u, leftv v)
{
  poly a;
  poly b;
  int dummy;
  if (v->next==NULL)
  {
    a=(poly)u->CopyD(POLY_CMD); // works also for VECTOR_CMD
    if (u->next==NULL)
    {
      b=(poly)v->CopyD(POLY_CMD); // works also for VECTOR_CMD
      if ((a!=NULL) && (b!=NULL)
      && (pTotaldegree(a)+pTotaldegree(b)>si_max((long)rVar(currRing),(long)currRing->bitmask)))
      {
        Werror("OVERFLOW in mult(d=%ld, d=%ld, max=%ld)",
          pTotaldegree(a),pTotaldegree(b),currRing->bitmask);
        pDelete(&a);
        pDelete(&b);
        return TRUE;
...
```

Apply

* [attachment:trac11856_exponent_overflow.patch]
* [attachment:trac11856_fix_docs_32bit.patch]

**Assignee:** @malb

**CC:**  @malb @burcin @alexanderdreyer jakobkroeker

**Keywords:** exponent overflow

**Reviewer:** Martin Albrecht, Alexander Dreyer

**Author:** Simon King

**Merged:** sage-4.7.2.alpha4

**Dependencies:** #10903

Issue created by migration from https://trac.sagemath.org/ticket/11856





---

archive/issue_comments_126213.json:
```json
{
    "body": "**Author:** Simon King",
    "created_at": "2011-09-27T15:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126213",
    "user": "https://github.com/simon-king-jena"
}
```

**Author:** Simon King



---

archive/issue_events_095149.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-09-27T15:57:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95149"
}
```



---

archive/issue_comments_126214.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe attached patch seems to solve the problem. It wraps the attribute `bitmask` of Singular's rings. Moreover, it detects exponent overflow in the same way as Singular does (see ticket description). `rVar` is in fact a macro that simply returns the `ring->N` attribute.\n\nWith the patch, I get (as a new doctest):\n\n```\nsage: P.<x,y> = QQ[]\nsage: y^2^30\ny^1073741824\nsage: P.<x,y,z> = QQ[]\nsage: y^2^30\nTraceback (most recent call last):\n...\nOverflowError: Exponent overflow (1073741824).\n```\n\nI did not run the doc tests yet, but I think a reviewer can already have a look on it.\n\nI wonder, though, whether the speed will be fine: I use the `max` function with the arguments being an unsigned long and a long. I can only hope that it is fast enough in Cython.",
    "created_at": "2011-09-27T15:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126214",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
The attached patch seems to solve the problem. It wraps the attribute `bitmask` of Singular's rings. Moreover, it detects exponent overflow in the same way as Singular does (see ticket description). `rVar` is in fact a macro that simply returns the `ring->N` attribute.

With the patch, I get (as a new doctest):

```
sage: P.<x,y> = QQ[]
sage: y^2^30
y^1073741824
sage: P.<x,y,z> = QQ[]
sage: y^2^30
Traceback (most recent call last):
...
OverflowError: Exponent overflow (1073741824).
```

I did not run the doc tests yet, but I think a reviewer can already have a look on it.

I wonder, though, whether the speed will be fine: I use the `max` function with the arguments being an unsigned long and a long. I can only hope that it is fast enough in Cython.



---

archive/issue_comments_126215.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt seems `max_exponent_size` should be removed since it's not needed any more?",
    "created_at": "2011-09-27T16:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126215",
    "user": "https://github.com/malb"
}
```

<a id='comment:2'></a>
It seems `max_exponent_size` should be removed since it's not needed any more?



---

archive/issue_comments_126216.json:
```json
{
    "body": "<a id='comment:3'></a>\nI did some tests with Cython functions either testing whether (for cdefined a,b,c) we have `a>max(b,c)` or `a>b and a>c`. The execution time was about the same. So, the patch should be fine as it is (modulo doctests, of course).\n\nI don't know whether max_exponent_size is used somewhere else.",
    "created_at": "2011-09-27T16:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126216",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>
I did some tests with Cython functions either testing whether (for cdefined a,b,c) we have `a>max(b,c)` or `a>b and a>c`. The execution time was about the same. So, the patch should be fine as it is (modulo doctests, of course).

I don't know whether max_exponent_size is used somewhere else.



---

archive/issue_comments_126217.json:
```json
{
    "body": "<a id='comment:4'></a>\nVery tricky. Singular correctly computes `x<sup>2</sup>30*x<sup>2</sup>30`, but it does not print it correctly, because when printing the exponent then it is converted in a different format:\n\n```\nsage: P.<x,y> = QQ[]\nsage: (x^2^30*x^2^30)\nx^-2147483648\nsage: (x^2^30*x^2^30).degree()\n2147483648\n```\nSo, *internally* the degree is correct.\n\nEven more tricky: In the case of `x<sup>2</sup>31`, Singular believes that the result is zero. The `degree()` method first tests whether it is (believed to be) zero, and acts accordingly:\n\n```\nsage: (x^2^31).degree()\n-1\nsage: (x^2^31)\n0\n```\n\nThat happens when I remove the max_exponent_size. I suppose I shouldd revert that removal...",
    "created_at": "2011-09-27T17:11:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126217",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>
Very tricky. Singular correctly computes `x<sup>2</sup>30*x<sup>2</sup>30`, but it does not print it correctly, because when printing the exponent then it is converted in a different format:

```
sage: P.<x,y> = QQ[]
sage: (x^2^30*x^2^30)
x^-2147483648
sage: (x^2^30*x^2^30).degree()
2147483648
```
So, *internally* the degree is correct.

Even more tricky: In the case of `x<sup>2</sup>31`, Singular believes that the result is zero. The `degree()` method first tests whether it is (believed to be) zero, and acts accordingly:

```
sage: (x^2^31).degree()
-1
sage: (x^2^31)
0
```

That happens when I remove the max_exponent_size. I suppose I shouldd revert that removal...



---

archive/issue_comments_126218.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe latest patch version checks *both* whether the exponent exceeds max_exponent_size (which avoids some bugs that occur in Singular) *and* whether it is illegal in Singular (which avoids the bugs in Sage that led to the creation of this ticket).\n\nWe now have\n\n```\n        sage: x^2^30*x^2^30\n        Traceback (most recent call last):\n        ...\n        OverflowError: Exponent overflow (2147483648).\n```\n\nI wonder whether the test, that became more expensive, led to an inacceptable speed regression. That should be investigated.\n\nThe tests in sage/rings/polynomial pass for me. I don't know about the rest. Needs review!",
    "created_at": "2011-09-27T17:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126218",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>
The latest patch version checks *both* whether the exponent exceeds max_exponent_size (which avoids some bugs that occur in Singular) *and* whether it is illegal in Singular (which avoids the bugs in Sage that led to the creation of this ticket).

We now have

```
        sage: x^2^30*x^2^30
        Traceback (most recent call last):
        ...
        OverflowError: Exponent overflow (2147483648).
```

I wonder whether the test, that became more expensive, led to an inacceptable speed regression. That should be investigated.

The tests in sage/rings/polynomial pass for me. I don't know about the rest. Needs review!



---

archive/issue_comments_126219.json:
```json
{
    "body": "<a id='comment:6'></a>\nCode looks okay. So modulo the possible speed regression and doctests passing this should get a positive review.",
    "created_at": "2011-09-27T20:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126219",
    "user": "https://github.com/malb"
}
```

<a id='comment:6'></a>
Code looks okay. So modulo the possible speed regression and doctests passing this should get a positive review.



---

archive/issue_comments_126220.json:
```json
{
    "body": "<a id='comment:7'></a>\nHere are some timings.\n\nWith the patch:\n\n```\nsage: P.<x,y,z> = QQ[]\nsage: p = x+y\nsage: %timeit q=p^20\n625 loops, best of 3: 6.93 \u00b5s per loop\nsage: p = x+y+z\nsage: %timeit q=p^25\n625 loops, best of 3: 418 \u00b5s per loop\nsage: %timeit q=x^2^10\n625 loops, best of 3: 2.1 \u00b5s per loop\n```\n\nWithout the patch:\n\n```\nsage: P.<x,y,z> = QQ[]\nsage: p = x+y\nsage: %timeit q=p^20\n625 loops, best of 3: 7.08 \u00b5s per loop\nsage: p = x+y+z\nsage: %timeit q=p^25\n625 loops, best of 3: 419 \u00b5s per loop\nsage: %timeit q=x^2^10\n625 loops, best of 3: 2.14 \u00b5s per loop\n```\n\nThese are only few data points, but they seem to show that the overhead is sufficiently small.",
    "created_at": "2011-09-27T21:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126220",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:7'></a>
Here are some timings.

With the patch:

```
sage: P.<x,y,z> = QQ[]
sage: p = x+y
sage: %timeit q=p^20
625 loops, best of 3: 6.93 µs per loop
sage: p = x+y+z
sage: %timeit q=p^25
625 loops, best of 3: 418 µs per loop
sage: %timeit q=x^2^10
625 loops, best of 3: 2.1 µs per loop
```

Without the patch:

```
sage: P.<x,y,z> = QQ[]
sage: p = x+y
sage: %timeit q=p^20
625 loops, best of 3: 7.08 µs per loop
sage: p = x+y+z
sage: %timeit q=p^25
625 loops, best of 3: 419 µs per loop
sage: %timeit q=x^2^10
625 loops, best of 3: 2.14 µs per loop
```

These are only few data points, but they seem to show that the overhead is sufficiently small.



---

archive/issue_events_095150.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T06:51:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95150"
}
```



---

archive/issue_events_095151.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-09-28T06:51:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95151"
}
```



---

archive/issue_comments_126221.json:
```json
{
    "body": "**Reviewer:** Martin Albrecht",
    "created_at": "2011-09-28T20:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126221",
    "user": "https://github.com/loefflerd"
}
```

**Reviewer:** Martin Albrecht



---

archive/issue_events_095152.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-01T12:04:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95152"
}
```



---

archive/issue_events_095153.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-01T12:04:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95153"
}
```



---

archive/issue_comments_126222.json:
```json
{
    "body": "<a id='comment:10'></a>\nAlexander found (while reviewing #4539) that the patch from here results in two doctest errors on 32-bit machines (reasonable, since an overflow error will occur earlier on 32 bit than on 64 bit).\n\nHe provided a fix at #4539, but actually I think it should be included here. What do people think?",
    "created_at": "2011-10-01T12:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126222",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:10'></a>
Alexander found (while reviewing #4539) that the patch from here results in two doctest errors on 32-bit machines (reasonable, since an overflow error will occur earlier on 32 bit than on 64 bit).

He provided a fix at #4539, but actually I think it should be included here. What do people think?



---

archive/issue_comments_126223.json:
```json
{
    "body": "**Work_Issues:** 32bit doctests",
    "created_at": "2011-10-01T12:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126223",
    "user": "https://github.com/simon-king-jena"
}
```

**Work_Issues:** 32bit doctests



---

archive/issue_comments_126224.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [SimonKing](#comment%3A10):\n> He provided a fix at #4539, but actually I think it should be included here. What do people think?\n\nIndeed, I also had to apply http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch here for 32-bit systems. So, I think, it is necessary.\n\nBTW: it seems that this ticket depends on #11115.",
    "created_at": "2011-10-01T22:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126224",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:12'></a>
Replying to [SimonKing](#comment%3A10):
> He provided a fix at #4539, but actually I think it should be included here. What do people think?

Indeed, I also had to apply http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch here for 32-bit systems. So, I think, it is necessary.

BTW: it seems that this ticket depends on #11115.



---

archive/issue_comments_126225.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [AlexanderDreyer](#comment%3A12):\n> Replying to [SimonKing](#comment%3A10):\n> BTW: it seems that this ticket depends on #11115.\n\n\nWhat ticket are you referring to by \"this\"? If \"this\" is #4539: #4539 depends on #11068, which depends on #11115. But if \"this\" is #11856 then I don't see a dependency. What do you mean? Is there fuzz when applying my or your patch? Does it not work without #11115?",
    "created_at": "2011-10-02T06:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126225",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:13'></a>
Replying to [AlexanderDreyer](#comment%3A12):
> Replying to [SimonKing](#comment%3A10):
> BTW: it seems that this ticket depends on #11115.


What ticket are you referring to by "this"? If "this" is #4539: #4539 depends on #11068, which depends on #11115. But if "this" is #11856 then I don't see a dependency. What do you mean? Is there fuzz when applying my or your patch? Does it not work without #11115?



---

archive/issue_comments_126226.json:
```json
{
    "body": "<a id='comment:14'></a>\nI just tested: [attachment:trac11856_exponent_overflow.patch] followed by [trac4539_fix_docs_32bit.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch) cleanly applies to sage-4.7.2.alpha3-prerelease.\n\nThus, if Alexander finds that [trac4539_fix_docs_32bit.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch) fixes the problem on 32-bit (I can not test it, myself), then I suggest that Alexander's patch should be moved from #4539 to here and turned into a reviewer patch; and if Alexander says that it is fixed, then we should return to a positive review.",
    "created_at": "2011-10-02T08:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126226",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:14'></a>
I just tested: [attachment:trac11856_exponent_overflow.patch] followed by [trac4539_fix_docs_32bit.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch) cleanly applies to sage-4.7.2.alpha3-prerelease.

Thus, if Alexander finds that [trac4539_fix_docs_32bit.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch) fixes the problem on 32-bit (I can not test it, myself), then I suggest that Alexander's patch should be moved from #4539 to here and turned into a reviewer patch; and if Alexander says that it is fixed, then we should return to a positive review.



---

archive/issue_events_095154.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-02T08:36:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95154"
}
```



---

archive/issue_events_095155.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-02T08:36:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95155"
}
```



---

archive/issue_comments_126227.json:
```json
{
    "body": "<a id='comment:15'></a>\nIndeed, I thought that #11856 would depend on #11115. But it turned out, that my Sage becomes corrupted when popping the patches of. #11115. So starting with a brand new clone of devel/sage-main does the trick. \n\nSo I can confirm, http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch fixes the problem on 23 Bit platforms.",
    "created_at": "2011-10-02T21:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126227",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:15'></a>
Indeed, I thought that #11856 would depend on #11115. But it turned out, that my Sage becomes corrupted when popping the patches of. #11115. So starting with a brand new clone of devel/sage-main does the trick. 

So I can confirm, http://trac.sagemath.org/sage_trac/attachment/ticket/4539/trac4539_fix_docs_32bit.patch fixes the problem on 23 Bit platforms.



---

archive/issue_events_095156.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2011-10-02T21:02:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95156"
}
```



---

archive/issue_events_095157.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2011-10-02T21:02:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95157"
}
```



---

archive/issue_comments_126228.json:
```json
{
    "body": "**Changing reviewer** from \"Martin Albrecht\" to \"Martin Albrecht, Alexander Dreyer\".",
    "created_at": "2011-10-02T21:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126228",
    "user": "https://github.com/alexanderdreyer"
}
```

**Changing reviewer** from "Martin Albrecht" to "Martin Albrecht, Alexander Dreyer".



---

archive/issue_comments_126229.json:
```json
{
    "body": "<a id='comment:16'></a>\n..32 Bit ... ;-)",
    "created_at": "2011-10-02T21:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126229",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:16'></a>
..32 Bit ... ;-)



---

archive/attachments_015737.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac11856_fix_docs_32bit.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11856/trac11856_fix_docs_32bit.patch",
    "created_at": "2011-10-02T22:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/simon-king-jena"
}
```



---

archive/issue_comments_126230.json:
```json
{
    "body": "Alexander 's reviewer patch",
    "created_at": "2011-10-02T22:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126230",
    "user": "https://github.com/simon-king-jena"
}
```

Alexander 's reviewer patch



---

archive/issue_comments_126231.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -36,3 +36,7 @@\n ...\n ```\n \n+Apply\n+\n+* [attachment:trac11856_exponent_overflow.patch]\n+* [attachment:trac11856_fix_docs_32bit.patch Reviewer patch]\n``````\n",
    "created_at": "2011-10-02T22:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126231",
    "user": "https://github.com/simon-king-jena"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -36,3 +36,7 @@
 ...
 ```
 
+Apply
+
+* [attachment:trac11856_exponent_overflow.patch]
+* [attachment:trac11856_fix_docs_32bit.patch Reviewer patch]
``````




---

archive/issue_comments_126232.json:
```json
{
    "body": "<a id='comment:17'></a>\nLet's try to sort things out:\n\nThe patch that Alexander posted at #4539 should better be a reviewer patch here. Thus, I copied his patch, added a commit message, and posted it here under a new name reflecting the ticket number. The positive review can be kept (I hope we  agree on that), and:\n\nApply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch",
    "created_at": "2011-10-02T22:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126232",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:17'></a>
Let's try to sort things out:

The patch that Alexander posted at #4539 should better be a reviewer patch here. Thus, I copied his patch, added a commit message, and posted it here under a new name reflecting the ticket number. The positive review can be kept (I hope we  agree on that), and:

Apply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch



---

archive/issue_comments_126233.json:
```json
{
    "body": "**Changing work_issues** from \"32bit doctests\" to \"\".",
    "created_at": "2011-10-04T08:06:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126233",
    "user": "https://github.com/jdemeyer"
}
```

**Changing work_issues** from "32bit doctests" to "".



---

archive/issue_comments_126234.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -39,4 +39,4 @@\n Apply\n \n * [attachment:trac11856_exponent_overflow.patch]\n-* [attachment:trac11856_fix_docs_32bit.patch Reviewer patch]\n+* [attachment:trac11856_fix_docs_32bit.patch]\n``````\n",
    "created_at": "2011-10-04T08:06:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126234",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -39,4 +39,4 @@
 Apply
 
 * [attachment:trac11856_exponent_overflow.patch]
-* [attachment:trac11856_fix_docs_32bit.patch Reviewer patch]
+* [attachment:trac11856_fix_docs_32bit.patch]
``````




---

archive/issue_comments_126235.json:
```json
{
    "body": "<a id='comment:19'></a>\nThis seems to conflict with #11339.",
    "created_at": "2011-10-04T08:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126235",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
This seems to conflict with #11339.



---

archive/issue_events_095158.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-04T08:51:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95158"
}
```



---

archive/issue_events_095159.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-04T08:51:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95159"
}
```



---

archive/issue_comments_126236.json:
```json
{
    "body": "**Work_Issues:** Conflict with #11339",
    "created_at": "2011-10-04T08:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126236",
    "user": "https://github.com/jdemeyer"
}
```

**Work_Issues:** Conflict with #11339



---

archive/issue_events_095160.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-04T09:09:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95160"
}
```



---

archive/issue_events_095161.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-04T09:09:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95161"
}
```



---

archive/issue_comments_126237.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe first patch has been rebased on top of #11339. The patch from #11339 did some cosmetic changes, such as replacing `p_Delete(&p,r)` by `p_Delete(&p, r)`. Therefore, one of the hunks from the first patch here did not apply.\n\nSince it is a very simple editorial change, without changing the code, I am directly reinstating the positive review.\n\nApply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch",
    "created_at": "2011-10-04T09:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126237",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:20'></a>
The first patch has been rebased on top of #11339. The patch from #11339 did some cosmetic changes, such as replacing `p_Delete(&p,r)` by `p_Delete(&p, r)`. Therefore, one of the hunks from the first patch here did not apply.

Since it is a very simple editorial change, without changing the code, I am directly reinstating the positive review.

Apply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch



---

archive/issue_comments_126238.json:
```json
{
    "body": "**Dependencies:** #11339",
    "created_at": "2011-10-04T09:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126238",
    "user": "https://github.com/simon-king-jena"
}
```

**Dependencies:** #11339



---

archive/issue_comments_126239.json:
```json
{
    "body": "**Changing work_issues** from \"Conflict with #11339\" to \"\".",
    "created_at": "2011-10-04T09:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126239",
    "user": "https://github.com/simon-king-jena"
}
```

**Changing work_issues** from "Conflict with #11339" to "".



---

archive/issue_comments_126240.json:
```json
{
    "body": "<a id='comment:23'></a>\nI had rebased my patch against #11339, but it turns out that #11339 needs work -- it creates some doctest errors with sage-4.7.2.alpha3-prerelease. So, I guess it would be better to return to the original patch version, which unfortunately is now lost.",
    "created_at": "2011-10-04T11:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126240",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:23'></a>
I had rebased my patch against #11339, but it turns out that #11339 needs work -- it creates some doctest errors with sage-4.7.2.alpha3-prerelease. So, I guess it would be better to return to the original patch version, which unfortunately is now lost.



---

archive/issue_comments_126241.json:
```json
{
    "body": "**Changing dependencies** from \"#11339\" to \"\".",
    "created_at": "2011-10-04T11:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126241",
    "user": "https://github.com/simon-king-jena"
}
```

**Changing dependencies** from "#11339" to "".



---

archive/issue_comments_126242.json:
```json
{
    "body": "**Work_Issues:** Rebase without #11339",
    "created_at": "2011-10-04T11:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126242",
    "user": "https://github.com/simon-king-jena"
}
```

**Work_Issues:** Rebase without #11339



---

archive/issue_events_095162.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-04T11:52:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95162"
}
```



---

archive/issue_events_095163.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-04T11:52:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95163"
}
```



---

archive/issue_events_095164.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-04T12:32:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95164"
}
```



---

archive/issue_events_095165.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-10-04T12:32:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95165"
}
```



---

archive/issue_comments_126243.json:
```json
{
    "body": "**Changing work_issues** from \"Rebase without #11339\" to \"\".",
    "created_at": "2011-10-04T12:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126243",
    "user": "https://github.com/simon-king-jena"
}
```

**Changing work_issues** from "Rebase without #11339" to "".



---

archive/issue_comments_126244.json:
```json
{
    "body": "<a id='comment:24'></a>\nSince this ticket fixes a critical bug, I think it would be good to merge it in sage-4.7.2, rather than waiting for 4.7.3. Since #11339 seems to need work, I returned to the original first patch and hope that it is ok to renew Martin's and Alexander's positive review.\n\nApply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch",
    "created_at": "2011-10-04T12:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126244",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:24'></a>
Since this ticket fixes a critical bug, I think it would be good to merge it in sage-4.7.2, rather than waiting for 4.7.3. Since #11339 seems to need work, I returned to the original first patch and hope that it is ok to renew Martin's and Alexander's positive review.

Apply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch



---

archive/issue_comments_126245.json:
```json
{
    "body": "Mimmick Singular's exponent overflow check but still avoids some bugs that Singular provides",
    "created_at": "2011-10-04T13:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126245",
    "user": "https://github.com/simon-king-jena"
}
```

Mimmick Singular's exponent overflow check but still avoids some bugs that Singular provides



---

archive/issue_comments_126246.json:
```json
{
    "body": "**Dependencies:** #10903",
    "created_at": "2011-10-04T13:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126246",
    "user": "https://github.com/simon-king-jena"
}
```

**Dependencies:** #10903



---

archive/attachments_015738.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac11856_exponent_overflow.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11856/trac11856_exponent_overflow.patch",
    "created_at": "2011-10-04T13:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/simon-king-jena"
}
```



---

archive/issue_comments_126247.json:
```json
{
    "body": "<a id='comment:25'></a>\nIt seems that I should not have rebased my ticket wrt #11339, but wrt #10903 (which in turn has #11339 as a dependency).\n\nNamely, #11339 only works *together* with #10903.\n\nSolution: Both #11339 and #10903 have a positive review. Hence, it is fine to make #10903 (and thus #11339 by transitivity) a dependency.\n\nRunning doctests now, again.\n\nApply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch",
    "created_at": "2011-10-04T13:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126247",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:25'></a>
It seems that I should not have rebased my ticket wrt #11339, but wrt #10903 (which in turn has #11339 as a dependency).

Namely, #11339 only works *together* with #10903.

Solution: Both #11339 and #10903 have a positive review. Hence, it is fine to make #10903 (and thus #11339 by transitivity) a dependency.

Running doctests now, again.

Apply trac11856_exponent_overflow.patch trac11856_fix_docs_32bit.patch



---

archive/issue_comments_126248.json:
```json
{
    "body": "<a id='comment:26'></a>\nFWIW: The doctests are fine. So, it is justified to keep the positive review of Martin and Alexander.",
    "created_at": "2011-10-04T14:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126248",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:26'></a>
FWIW: The doctests are fine. So, it is justified to keep the positive review of Martin and Alexander.



---

archive/issue_events_095166.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-07T19:11:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95166"
}
```



---

archive/issue_events_095167.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-07T19:11:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11856#event-95167"
}
```



---

archive/issue_comments_126249.json:
```json
{
    "body": "**Merged:** sage-4.7.2.alpha4",
    "created_at": "2011-10-07T19:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11856",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11856#issuecomment-126249",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.2.alpha4
