# Issue 11311: engine="pdflatex" in view is ignored

archive/issues_011139.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/williamstein"
    ],
    "body": "The view command states that the pdflatex argument is deprecated and that one should use the engine argument instead.\n\nBut if one sets engine=\"pdflatex\", it is overwritten, and so one currently needs to use the deprecated pdflatex option.\n\n---\n\nApply [attachment: trac_11311-5.0.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-5.0.patch.gz).\n\nCC:  @jhpalmieri\n\nComponent: **graphics**\n\nKeywords: **latex, pdflatex, days30**\n\nAuthor: **Franco Saliola, John Palmieri**\n\nReviewer: **Karl-Dieter Crisman, Franco Saliola, John Palmieri**\n\nMerged: **sage-5.1.beta4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11311_\n\n",
    "closed_at": "2012-06-14T06:38:04Z",
    "created_at": "2011-05-08T03:40:16Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "engine=\"pdflatex\" in view is ignored",
    "type": "issue",
    "updated_at": "2012-06-14T06:38:04Z",
    "url": "https://github.com/sagemath/sage/issues/11311",
    "user": "https://github.com/saliola"
}
```
The view command states that the pdflatex argument is deprecated and that one should use the engine argument instead.

But if one sets engine="pdflatex", it is overwritten, and so one currently needs to use the deprecated pdflatex option.

---

Apply [attachment: trac_11311-5.0.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-5.0.patch.gz).

CC:  @jhpalmieri

Component: **graphics**

Keywords: **latex, pdflatex, days30**

Author: **Franco Saliola, John Palmieri**

Reviewer: **Karl-Dieter Crisman, Franco Saliola, John Palmieri**

Merged: **sage-5.1.beta4**

_Issue created by migration from https://trac.sagemath.org/ticket/11311_





---

archive/issue_events_148577.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-05-08T03:40:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148577"
}
```



---

archive/issue_events_148578.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-05-08T03:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148578"
}
```



---

archive/issue_events_148579.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-05-08T03:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148579"
}
```



---

archive/issue_events_148580.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-05-08T03:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148580"
}
```



---

archive/issue_events_148581.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2011-05-08T03:40:16Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "subject": "https://github.com/saliola",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148581"
}
```



---

archive/issue_events_148582.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-05-08T03:40:16Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "subject": "https://github.com/saliola",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148582"
}
```



---

archive/issue_events_148583.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-05-08T04:33:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148583"
}
```



---

archive/issue_comments_113530.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_11311_engine_pdflatex_view-fs.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.patch.gz)**",
    "created_at": "2011-05-08T04:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113530",
    "user": "https://github.com/saliola"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_11311_engine_pdflatex_view-fs.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.patch.gz)**



---

archive/issue_comments_113531.json:
```json
{
    "body": "Changed keywords from **latex, pdflatex** to **latex, pdflatex, days30**",
    "created_at": "2011-05-08T18:29:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113531",
    "user": "https://github.com/saliola"
}
```

Changed keywords from **latex, pdflatex** to **latex, pdflatex, days30**



---

archive/issue_comments_113532.json:
```json
{
    "body": "Author: **Franco Saliola**",
    "created_at": "2011-05-08T19:41:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113532",
    "user": "https://github.com/saliola"
}
```

Author: **Franco Saliola**



---

archive/issue_comments_113533.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYou should modify the header of your patch : replace\n\ntrac_11311: fix view to not overwrite engine=\"pdflatex\"\n\nby\n\n#11311: fix view to not overwrite engine=\"pdflatex\"\n\nThen the buildbot will be more happy.",
    "created_at": "2011-06-01T13:34:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113533",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

You should modify the header of your patch : replace

trac_11311: fix view to not overwrite engine="pdflatex"

by

#11311: fix view to not overwrite engine="pdflatex"

Then the buildbot will be more happy.



---

archive/issue_comments_113534.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[trac_11311_engine_pdflatex_view-fs.2.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz)**\n\nThanks for catching this. I corrected this in the new patch.",
    "created_at": "2011-06-01T15:49:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113534",
    "user": "https://github.com/saliola"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[trac_11311_engine_pdflatex_view-fs.2.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz)**

Thanks for catching this. I corrected this in the new patch.



---

archive/issue_comments_113535.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The view command states that the pdflatex argument is deprecated and that one should use the engine argument instead.\n \n But if one sets engine=\"pdflatex\", it is overwritten, and so one currently needs to use the deprecated pdflatex option.\n+\n+Apply trac_11311_engine_pdflatex_view-fs.2.patch\n``````\n",
    "created_at": "2011-06-01T15:49:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113535",
    "user": "https://github.com/saliola"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The view command states that the pdflatex argument is deprecated and that one should use the engine argument instead.
 
 But if one sets engine="pdflatex", it is overwritten, and so one currently needs to use the deprecated pdflatex option.
+
+Apply trac_11311_engine_pdflatex_view-fs.2.patch
``````




---

archive/issue_comments_113536.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nApply [attachment: trac_11311_engine_pdflatex_view-fs.2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz).",
    "created_at": "2011-06-16T03:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113536",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:7" align="right">comment:7</div>

Apply [attachment: trac_11311_engine_pdflatex_view-fs.2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz).



---

archive/issue_comments_113537.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n But if one sets engine=\"pdflatex\", it is overwritten, and so one currently needs to use the deprecated pdflatex option.\n \n-Apply trac_11311_engine_pdflatex_view-fs.2.patch\n+---\n+\n+Apply [attachment: trac_11311_engine_pdflatex_view-fs.2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz).\n``````\n",
    "created_at": "2011-06-16T03:44:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113537",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 But if one sets engine="pdflatex", it is overwritten, and so one currently needs to use the deprecated pdflatex option.
 
-Apply trac_11311_engine_pdflatex_view-fs.2.patch
+---
+
+Apply [attachment: trac_11311_engine_pdflatex_view-fs.2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz).
``````




---

archive/issue_comments_113538.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFranco, you need to rebase this against your own patch at #11315 which was recently merged :)\n\nI may do this if the patch behaves as promised.",
    "created_at": "2011-06-16T03:48:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113538",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:8" align="right">comment:8</div>

Franco, you need to rebase this against your own patch at #11315 which was recently merged :)

I may do this if the patch behaves as promised.



---

archive/issue_comments_113539.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nQuestion:  when I do\n\n```\nsage: view(2,engine='pdflatex')\n```\nit opens in my pdf viewer, not in my TeX program.  This seems wrong, based on the current doc, but I could be wrong. \n\nI'm also attaching a rebased patch.",
    "created_at": "2011-06-16T04:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113539",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:9" align="right">comment:9</div>

Question:  when I do

```
sage: view(2,engine='pdflatex')
```
it opens in my pdf viewer, not in my TeX program.  This seems wrong, based on the current doc, but I could be wrong. 

I'm also attaching a rebased patch.



---

archive/issue_comments_113540.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2011-06-16T04:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113540",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_events_148584.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-06-16T04:11:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148584"
}
```



---

archive/issue_events_148585.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-06-16T04:11:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148585"
}
```



---

archive/issue_comments_113541.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAttachment: **[trac_11311-rebased.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz)**\n\nApply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).",
    "created_at": "2011-06-16T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113541",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:10" align="right">comment:10</div>

Attachment: **[trac_11311-rebased.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz)**

Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).



---

archive/issue_comments_113542.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n ---\n \n-Apply [attachment: trac_11311_engine_pdflatex_view-fs.2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz).\n+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).\n``````\n",
    "created_at": "2011-06-16T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113542",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 ---
 
-Apply [attachment: trac_11311_engine_pdflatex_view-fs.2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311_engine_pdflatex_view-fs.2.patch.gz).
+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).
``````




---

archive/issue_comments_113543.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nApply trac_11311-rebased.patch",
    "created_at": "2011-06-22T08:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113543",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">comment:11</div>

Apply trac_11311-rebased.patch



---

archive/issue_comments_113544.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWith the current patch, we have a little code duplication, so we could make the following change:\n\n```diff\ndiff --git a/sage/misc/latex.py b/sage/misc/latex.py\n--- a/sage/misc/latex.py\n+++ b/sage/misc/latex.py\n@@ -1851,6 +1851,10 @@ def view(objects, title='SAGE', debug=Fa\n         else:\n             latex_options = {}\n         s = _latex_file_(objects, title=title, sep=sep, tiny=tiny, debug=debug, **latex_options)\n+    if engine is None:\n+        engine = _Latex_prefs._option[\"engine\"]\n+    if pdflatex or (viewer == \"pdf\" and engine == \"latex\"):\n+        engine = \"pdflatex\"\n     # notebook\n     if EMBEDDED_MODE and viewer is None:\n         jsMath_okay = True\n@@ -1862,10 +1866,6 @@ def view(objects, title='SAGE', debug=Fa\n         if jsMath_okay:\n             print JSMath().eval(objects, mode=mode)  # put comma at end of line?\n         else:\n-            if engine is None:\n-                engine = _Latex_prefs._option[\"engine\"]\n-            if pdflatex or (viewer == \"pdf\" and engine == \"latex\"):\n-                engine = \"pdflatex\"\n             base_dir = os.path.abspath(\"\")\n             png_file = graphics_filename(ext='png')\n             png_link = \"cell://\" + png_file\n@@ -1874,10 +1874,6 @@ def view(objects, title='SAGE', debug=Fa\n             print '<html><img src=\"%s\"></html>'%png_link  # put comma at end of line?\n         return\n     # command line or notebook with viewer\n-    if engine is None:\n-        engine = _Latex_prefs._option[\"engine\"]\n-    if pdflatex or (viewer == \"pdf\" and engine == \"latex\"):\n-        engine = \"pdflatex\"\n     tmp = tmp_dir('sage_viewer')\n     tex_file = os.path.join(tmp, \"sage.tex\")\n     open(tex_file,'w').write(s)\n```\nOtherwise, I think it looks good.\n\nAs far as opening in a pdf viewer rather than in a TeX program, hasn't that been the behavior for a while?  (Sage basically opens up the file, blah.pdf or blah.dvi, using some sensible default depending on the OS -- see the file misc/viewer.py.  On OS X, for example, this just calls \"open blah.pdf\" or \"open blah.dvi\", depending on which file is produced.)",
    "created_at": "2011-06-29T21:32:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113544",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">comment:12</div>

With the current patch, we have a little code duplication, so we could make the following change:

```diff
diff --git a/sage/misc/latex.py b/sage/misc/latex.py
--- a/sage/misc/latex.py
+++ b/sage/misc/latex.py
@@ -1851,6 +1851,10 @@ def view(objects, title='SAGE', debug=Fa
         else:
             latex_options = {}
         s = _latex_file_(objects, title=title, sep=sep, tiny=tiny, debug=debug, **latex_options)
+    if engine is None:
+        engine = _Latex_prefs._option["engine"]
+    if pdflatex or (viewer == "pdf" and engine == "latex"):
+        engine = "pdflatex"
     # notebook
     if EMBEDDED_MODE and viewer is None:
         jsMath_okay = True
@@ -1862,10 +1866,6 @@ def view(objects, title='SAGE', debug=Fa
         if jsMath_okay:
             print JSMath().eval(objects, mode=mode)  # put comma at end of line?
         else:
-            if engine is None:
-                engine = _Latex_prefs._option["engine"]
-            if pdflatex or (viewer == "pdf" and engine == "latex"):
-                engine = "pdflatex"
             base_dir = os.path.abspath("")
             png_file = graphics_filename(ext='png')
             png_link = "cell://" + png_file
@@ -1874,10 +1874,6 @@ def view(objects, title='SAGE', debug=Fa
             print '<html><img src="%s"></html>'%png_link  # put comma at end of line?
         return
     # command line or notebook with viewer
-    if engine is None:
-        engine = _Latex_prefs._option["engine"]
-    if pdflatex or (viewer == "pdf" and engine == "latex"):
-        engine = "pdflatex"
     tmp = tmp_dir('sage_viewer')
     tex_file = os.path.join(tmp, "sage.tex")
     open(tex_file,'w').write(s)
```
Otherwise, I think it looks good.

As far as opening in a pdf viewer rather than in a TeX program, hasn't that been the behavior for a while?  (Sage basically opens up the file, blah.pdf or blah.dvi, using some sensible default depending on the OS -- see the file misc/viewer.py.  On OS X, for example, this just calls "open blah.pdf" or "open blah.dvi", depending on which file is produced.)



---

archive/issue_comments_113545.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI'm attaching a referee patch which removes the code duplication referred to above.\n\nKarl-Dieter: the program \"sage-open\", as defined in sage/misc/viewer.py, should be used to open the output file.  Before the patch here, it was called with `output_file` set to \"sage.dvi\" or something like that.  After the patch, it is called with `output_file` set to \"sage.pdf\".  So any difference in what program is being used is because this is producing a pdf file, not a dvi file.\n\nI'd like to change this from \"needs info\" to \"positive review\".   Is that okay?",
    "created_at": "2011-10-26T21:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113545",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:13" align="right">comment:13</div>

I'm attaching a referee patch which removes the code duplication referred to above.

Karl-Dieter: the program "sage-open", as defined in sage/misc/viewer.py, should be used to open the output file.  Before the patch here, it was called with `output_file` set to "sage.dvi" or something like that.  After the patch, it is called with `output_file` set to "sage.pdf".  So any difference in what program is being used is because this is producing a pdf file, not a dvi file.

I'd like to change this from "needs info" to "positive review".   Is that okay?



---

archive/issue_comments_113546.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n ---\n \n-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).\n+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz), [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz).\n``````\n",
    "created_at": "2011-10-26T21:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113546",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 ---
 
-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).
+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz), [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz).
``````




---

archive/issue_events_148586.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-10-26T21:30:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148586"
}
```



---

archive/issue_events_148587.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-10-26T21:30:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148587"
}
```



---

archive/issue_comments_113547.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nLooks good to me.",
    "created_at": "2011-10-26T21:30:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113547",
    "user": "https://github.com/saliola"
}
```

<div id="comment:14" align="right">comment:14</div>

Looks good to me.



---

archive/issue_events_148588.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-10-26T21:30:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148588"
}
```



---

archive/issue_events_148589.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2011-10-26T21:30:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148589"
}
```



---

archive/issue_events_148590.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-27T08:10:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148590"
}
```



---

archive/issue_events_148591.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-27T08:10:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148591"
}
```



---

archive/issue_comments_113548.json:
```json
{
    "body": "Changed author from **Franco Saliola** to **Franco Saliola, John Palmieri**",
    "created_at": "2011-10-27T15:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113548",
    "user": "https://github.com/kcrisman"
}
```

Changed author from **Franco Saliola** to **Franco Saliola, John Palmieri**



---

archive/issue_comments_113549.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Franco Saliola**",
    "created_at": "2011-10-27T15:28:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113549",
    "user": "https://github.com/kcrisman"
}
```

Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Franco Saliola**



---

archive/issue_comments_113550.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman, Franco Saliola** to **Karl-Dieter Crisman, Franco Saliola, John Palmieri**",
    "created_at": "2011-10-27T16:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113550",
    "user": "https://github.com/jhpalmieri"
}
```

Changed reviewer from **Karl-Dieter Crisman, Franco Saliola** to **Karl-Dieter Crisman, Franco Saliola, John Palmieri**



---

archive/issue_comments_113551.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113551",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_events_148592.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:14:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148592"
}
```



---

archive/issue_events_148593.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148593"
}
```



---

archive/issue_events_148594.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148594"
}
```



---

archive/issue_events_148595.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148595"
}
```



---

archive/issue_comments_113552.json:
```json
{
    "body": "Merged: **sage-4.8.alpha1**",
    "created_at": "2011-11-07T10:11:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113552",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.8.alpha1**



---

archive/issue_events_148596.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-08T15:02:47Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148596"
}
```



---

archive/issue_comments_113553.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI get doctest failures on a system which does not have `latex` installed:\n\n```\nsage -t  -long -force_lib devel/sage/sage/misc/latex.py\n**********************************************************************\nFile \"/Users/jdemeyer/sage-4.8.alpha1/devel/sage-main/sage/misc/latex.py\", line 1877:\n    sage: view(4, engine=\"garbage\")\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Unsupported LaTeX engine.\nGot:\n    Error: XeLaTeX does not seem to be installed.  Download it from\n    ctan.org and try again.\n    Latex error\n**********************************************************************\nFile \"/Users/jdemeyer/sage-4.8.alpha1/devel/sage-main/sage/misc/latex.py\", line 1882:\n    sage: view(4, engine=\"garbage\", viewer=\"pdf\")\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: Unsupported LaTeX engine.\nGot:\n    Error: XeLaTeX does not seem to be installed.  Download it from\n    ctan.org and try again.\n    Latex error\n**********************************************************************\n```\n\nFixing this would mean adding \"# optional - latex\" to the doctest.\n\nBut it also makes me wonder: why check the existence of XeLaTeX when `engine=\"garbage\"`?  This doesn't make much sense to me.",
    "created_at": "2011-11-08T15:02:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113553",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

I get doctest failures on a system which does not have `latex` installed:

```
sage -t  -long -force_lib devel/sage/sage/misc/latex.py
**********************************************************************
File "/Users/jdemeyer/sage-4.8.alpha1/devel/sage-main/sage/misc/latex.py", line 1877:
    sage: view(4, engine="garbage")
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Unsupported LaTeX engine.
Got:
    Error: XeLaTeX does not seem to be installed.  Download it from
    ctan.org and try again.
    Latex error
**********************************************************************
File "/Users/jdemeyer/sage-4.8.alpha1/devel/sage-main/sage/misc/latex.py", line 1882:
    sage: view(4, engine="garbage", viewer="pdf")
Expected:
    Traceback (most recent call last):
    ...
    ValueError: Unsupported LaTeX engine.
Got:
    Error: XeLaTeX does not seem to be installed.  Download it from
    ctan.org and try again.
    Latex error
**********************************************************************
```

Fixing this would mean adding "# optional - latex" to the doctest.

But it also makes me wonder: why check the existence of XeLaTeX when `engine="garbage"`?  This doesn't make much sense to me.



---

archive/issue_comments_113554.json:
```json
{
    "body": "Changed merged from **sage-4.8.alpha1** to none",
    "created_at": "2011-11-08T15:02:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113554",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.8.alpha1** to none



---

archive/issue_comments_113555.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThis seems to have been introduced (or expanded, at least) in #8486.\n\n```\n    if engine and not have_pdflatex() and not have_xelatex(): \n \t        print \"Error: %s does not seem to be installed.  Download it from\" % _Latex_prefs._option[\"engine_name\"] \n```\nso `engine` is certainly `True` since it's nonempty, and we definitely don't have any of those things.  And it first checks whether one has LaTeX, before it checks the engines.  \n\nNow we have \n\n```\nsage: sage.misc.latex._Latex_prefs._option\n{'engine': 'latex', 'matrix_delimiters': ['(', ')'], 'jsmath_avoid': [], 'engine_name': 'LaTeX', 'blackboard_bold': False, 'macros': '', 'vector_delimiters': ['(', ')'], 'preamble': ''}\n```\nin a regular install.  The question is whether there is anywhere `engine` gets reset...  \n\nAha!  [Line 1404](http://hg.sagemath.org/sage-main/file/9e29a3d84c48/sage/misc/latex.py#l1404) (of the current 4.7.2) shows that this is set to `xelatex` and then not reset.   Apparently the doctest framework doesn't clear this, I'm not sure exactly where this all lives.\n\nSolution should be:\n* Fix the reset of the engine\n* Leave the error message and `# random` it.   Or even include both error messages so that the documentation shows exactly what we expect with and without a working LaTeX installation.\n\nWhat do you think?",
    "created_at": "2011-11-08T16:00:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113555",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:22" align="right">comment:22</div>

This seems to have been introduced (or expanded, at least) in #8486.

```
    if engine and not have_pdflatex() and not have_xelatex(): 
 	        print "Error: %s does not seem to be installed.  Download it from" % _Latex_prefs._option["engine_name"] 
```
so `engine` is certainly `True` since it's nonempty, and we definitely don't have any of those things.  And it first checks whether one has LaTeX, before it checks the engines.  

Now we have 

```
sage: sage.misc.latex._Latex_prefs._option
{'engine': 'latex', 'matrix_delimiters': ['(', ')'], 'jsmath_avoid': [], 'engine_name': 'LaTeX', 'blackboard_bold': False, 'macros': '', 'vector_delimiters': ['(', ')'], 'preamble': ''}
```
in a regular install.  The question is whether there is anywhere `engine` gets reset...  

Aha!  [Line 1404](http://hg.sagemath.org/sage-main/file/9e29a3d84c48/sage/misc/latex.py#l1404) (of the current 4.7.2) shows that this is set to `xelatex` and then not reset.   Apparently the doctest framework doesn't clear this, I'm not sure exactly where this all lives.

Solution should be:
* Fix the reset of the engine
* Leave the error message and `# random` it.   Or even include both error messages so that the documentation shows exactly what we expect with and without a working LaTeX installation.

What do you think?



---

archive/issue_comments_113556.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@kcrisman](#comment%3A22):\n> What do you think?\n\nI think we should try to find a solution which leaves all doctests as they are (including the new ones on this ticket): change the code, not the tests.\n\nMaybe the code should be more like:\n\n```\nif engine is None:\n    engine = \"latex\"\nif (engine==\"latex\" and not have_latex()) or (engine==\"pdflatex\" and not have_pdflatex()) or (engine==\"xelatex\" and not have_xelatex):\n    raise RuntimeError,...\n```",
    "created_at": "2011-11-08T17:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113556",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@kcrisman](#comment%3A22):
> What do you think?

I think we should try to find a solution which leaves all doctests as they are (including the new ones on this ticket): change the code, not the tests.

Maybe the code should be more like:

```
if engine is None:
    engine = "latex"
if (engine=="latex" and not have_latex()) or (engine=="pdflatex" and not have_pdflatex()) or (engine=="xelatex" and not have_xelatex):
    raise RuntimeError,...
```



---

archive/issue_comments_113557.json:
```json
{
    "body": "Attachment: **[trac_11311-ref.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz)**\n\napply on top of other patch",
    "created_at": "2011-11-23T22:18:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113557",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_11311-ref.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz)**

apply on top of other patch



---

archive/issue_comments_113558.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nHere's a new referee patch.  This just moves the code which checks the value of 'engine' earlier, so if 'engine' is set to a bad value, then that error gets caught first.  For me, on an OS X box (with a pretty good TeX installation), on sage.math (with a mediocre TeX installation (no xetex or xelatex), and on the skynet machine eno (no TeX at all), the following passes all tests, repeatedly:\n\n```\nsage -t  --randorder devel/sage/sage/misc/latex.py\n```\n(The patch also adds a line to one example to reset the latex preamble, so that tests pass when the order of the tests is randomized.)",
    "created_at": "2011-11-23T22:24:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113558",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

Here's a new referee patch.  This just moves the code which checks the value of 'engine' earlier, so if 'engine' is set to a bad value, then that error gets caught first.  For me, on an OS X box (with a pretty good TeX installation), on sage.math (with a mediocre TeX installation (no xetex or xelatex), and on the skynet machine eno (no TeX at all), the following passes all tests, repeatedly:

```
sage -t  --randorder devel/sage/sage/misc/latex.py
```
(The patch also adds a line to one example to reset the latex preamble, so that tests pass when the order of the tests is randomized.)



---

archive/issue_events_148597.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-11-23T22:24:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148597"
}
```



---

archive/issue_comments_113559.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nHere's an alternate version, which just consolidates some code (while checking whether `engine == 'pdflatex'`, check whether pdflatex is installed, for example).",
    "created_at": "2011-11-23T22:33:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113559",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

Here's an alternate version, which just consolidates some code (while checking whether `engine == 'pdflatex'`, check whether pdflatex is installed, for example).



---

archive/issue_comments_113560.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n ---\n \n-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz), [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz).\n+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).  Then apply either [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz) or [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).\n``````\n",
    "created_at": "2011-11-23T22:33:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113560",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 ---
 
-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz), [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz).
+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).  Then apply either [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz) or [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).
``````




---

archive/issue_comments_113561.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n ---\n \n-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).  Then apply either [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz) or [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).\n+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz) and [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).\n``````\n",
    "created_at": "2012-04-26T07:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113561",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 ---
 
-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz).  Then apply either [attachment: trac_11311-ref.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.patch.gz) or [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).
+Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz) and [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).
``````




---

archive/issue_comments_113562.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nTrying to help the buildbot ...",
    "created_at": "2012-04-26T07:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113562",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:26" align="right">comment:26</div>

Trying to help the buildbot ...



---

archive/issue_comments_113563.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n**ping**\n\nWhat is the status of this patch ?\n\nThe bot has not understood which patch to apply. Let us try again.\n\nApply trac_11311-rebased.patch  and trac_11311-ref.v2.patch",
    "created_at": "2012-05-10T19:30:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113563",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:27" align="right">comment:27</div>

**ping**

What is the status of this patch ?

The bot has not understood which patch to apply. Let us try again.

Apply trac_11311-rebased.patch  and trac_11311-ref.v2.patch



---

archive/issue_comments_113564.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nHere is a rebased version of the \"v2\" patch.",
    "created_at": "2012-05-10T20:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113564",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:28" align="right">comment:28</div>

Here is a rebased version of the "v2" patch.



---

archive/issue_comments_113565.json:
```json
{
    "body": "apply on top of rebased patch",
    "created_at": "2012-05-10T20:08:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113565",
    "user": "https://github.com/jhpalmieri"
}
```

apply on top of rebased patch



---

archive/issue_comments_113566.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nAttachment: **[trac_11311-ref.v2.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz)**\n\nThanks for the review patch. Positive review.",
    "created_at": "2012-05-20T23:18:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113566",
    "user": "https://github.com/saliola"
}
```

<div id="comment:29" align="right">comment:29</div>

Attachment: **[trac_11311-ref.v2.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz)**

Thanks for the review patch. Positive review.



---

archive/issue_events_148598.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2012-05-20T23:18:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148598"
}
```



---

archive/issue_events_148599.json:
```json
{
    "actor": "https://github.com/saliola",
    "created_at": "2012-05-20T23:18:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148599"
}
```



---

archive/issue_comments_113567.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI just noticed that randomizing the doctests fails sometimes, with errors of the following form:\n\n```\nsage -t  --randorder devel/sage/sage/misc/latex.py\n...\nFile \"/Users/saliola/Applications/sage-5.0/devel/sage/sage/misc/latex.py\", line 221:\n    sage: builtin_constant_function(NotImplemented)\nExpected:\n    '\\\\mbox{\\\\rm NotImplemented}'\nGot:\n    '{\\\\rm NotImplemented}'\n...\n```\nSince this isn't cause by this patch (in fact, this patch improves things), I created a new ticket #12986 for this.",
    "created_at": "2012-05-21T00:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113567",
    "user": "https://github.com/saliola"
}
```

<div id="comment:30" align="right">comment:30</div>

I just noticed that randomizing the doctests fails sometimes, with errors of the following form:

```
sage -t  --randorder devel/sage/sage/misc/latex.py
...
File "/Users/saliola/Applications/sage-5.0/devel/sage/sage/misc/latex.py", line 221:
    sage: builtin_constant_function(NotImplemented)
Expected:
    '\\mbox{\\rm NotImplemented}'
Got:
    '{\\rm NotImplemented}'
...
```
Since this isn't cause by this patch (in fact, this patch improves things), I created a new ticket #12986 for this.



---

archive/issue_events_148600.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-21T22:33:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148600"
}
```



---

archive/issue_events_148601.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-21T22:33:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148601"
}
```



---

archive/issue_comments_113568.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe patch only applies with fuzz 2 and therefore should be rebased to sage-5.1.beta0.",
    "created_at": "2012-05-21T22:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113568",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

The patch only applies with fuzz 2 and therefore should be rebased to sage-5.1.beta0.



---

archive/issue_comments_113569.json:
```json
{
    "body": "Attachment: **[trac_11311-5.0.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-5.0.patch.gz)**\n\nrebased to Sage 5.0",
    "created_at": "2012-05-22T01:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113569",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_11311-5.0.patch.gz](https://github.com/sagemath/sage/files/ticket11311/trac_11311-5.0.patch.gz)**

rebased to Sage 5.0



---

archive/issue_events_148602.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-05-22T01:52:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148602"
}
```



---

archive/issue_events_148603.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-05-22T01:52:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148603"
}
```



---

archive/issue_comments_113570.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n ---\n \n-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz) and [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).\n+Apply [attachment: trac_11311-5.0.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-5.0.patch.gz).\n``````\n",
    "created_at": "2012-05-22T01:52:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113570",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 ---
 
-Apply [attachment: trac_11311-rebased.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-rebased.patch.gz) and [attachment: trac_11311-ref.v2.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-ref.v2.patch.gz).
+Apply [attachment: trac_11311-5.0.patch](https://github.com/sagemath/sage/files/ticket11311/trac_11311-5.0.patch.gz).
``````




---

archive/issue_comments_113571.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nHere's a rebased patch (combining the old two patches).  (Despite its name and my comment when I attached it, it was actually rebased to Sage 5.1.beta0.)",
    "created_at": "2012-05-22T01:52:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113571",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

Here's a rebased patch (combining the old two patches).  (Despite its name and my comment when I attached it, it was actually rebased to Sage 5.1.beta0.)



---

archive/issue_comments_113572.json:
```json
{
    "body": "Merged: **sage-5.1.beta1**",
    "created_at": "2012-05-23T21:33:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113572",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.1.beta1**



---

archive/issue_events_148604.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:33:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148604"
}
```



---

archive/issue_events_148605.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:33:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148605"
}
```



---

archive/issue_comments_113573.json:
```json
{
    "body": "Changed merged from **sage-5.1.beta1** to none",
    "created_at": "2012-05-23T21:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113573",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-5.1.beta1** to none



---

archive/issue_events_148606.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:35:02Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148606"
}
```



---

archive/issue_comments_113574.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nNothing against this patch, just didn't mean to merge it now (probably next beta).",
    "created_at": "2012-05-23T21:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113574",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Nothing against this patch, just didn't mean to merge it now (probably next beta).



---

archive/issue_events_148607.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:35:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148607"
}
```



---

archive/issue_events_148608.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:35:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148608"
}
```



---

archive/issue_events_148609.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-23T21:35:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148609"
}
```



---

archive/issue_events_148610.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-14T06:38:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148610"
}
```



---

archive/issue_events_148611.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-14T06:38:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11311#event-148611"
}
```



---

archive/issue_comments_113575.json:
```json
{
    "body": "Merged: **sage-5.1.beta4**",
    "created_at": "2012-06-14T06:38:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11311#issuecomment-113575",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.1.beta4**
