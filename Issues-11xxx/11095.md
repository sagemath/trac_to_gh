# Issue 11095: Add BMSS algorithm for isogenies of elliptic curves

archive/issues_010964.json:
```json
{
    "assignees": [
        "https://github.com/JohnCremona"
    ],
    "body": "Add the algorithm by Bostan, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.\n\nReferences:\n\n[BMSS08] Alin Bostan, Fran\u00e7ois Morain, Bruno Salvy, and \u00c9ric Schost, Fast algorithms for computing isogenies between elliptic curves, Mathematics of Computation 77 (2008), 1755\u20131778.\n\nApply: [attachment: trac_11095_isogenies_char_0_v3.patch\u200b](https://github.com/sagemath/sage/files/ticket11095/0e2630fbe9449c551f50bca100e732dd.gz)\n\nCC:  @categorie @jpflori @pjbruin\n\nKeywords: **isogenies ecc2011**\n\nBranch/Commit: **[public/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/11095) @ [`59417df`](https://github.com/sagemath/sagetrac-mirror/commit/59417df5c944443f91d51d996d1d825f144ab734)**\n\nWork Issues: **merge conflicts**\n\nReviewer: **John Cremona, Marco Streng**\n\nAuthor: **Luca De Feo**\n\nComponent: **elliptic curves**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11095_\n\n",
    "created_at": "2011-03-30T13:33:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add BMSS algorithm for isogenies of elliptic curves",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/11095",
    "user": "https://github.com/defeo"
}
```
Add the algorithm by Bostan, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.

References:

[BMSS08] Alin Bostan, François Morain, Bruno Salvy, and Éric Schost, Fast algorithms for computing isogenies between elliptic curves, Mathematics of Computation 77 (2008), 1755–1778.

Apply: [attachment: trac_11095_isogenies_char_0_v3.patch​](https://github.com/sagemath/sage/files/ticket11095/0e2630fbe9449c551f50bca100e732dd.gz)

CC:  @categorie @jpflori @pjbruin

Keywords: **isogenies ecc2011**

Branch/Commit: **[public/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/11095) @ [`59417df`](https://github.com/sagemath/sagetrac-mirror/commit/59417df5c944443f91d51d996d1d825f144ab734)**

Work Issues: **merge conflicts**

Reviewer: **John Cremona, Marco Streng**

Author: **Luca De Feo**

Component: **elliptic curves**

_Issue created by migration from https://trac.sagemath.org/ticket/11095_





---

archive/issue_events_147110.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-03-30T13:33:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147110"
}
```



---

archive/issue_events_147111.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-03-30T13:33:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147111"
}
```



---

archive/issue_events_147112.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-03-30T13:33:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147112"
}
```



---

archive/issue_events_147113.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-03-30T13:33:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147113"
}
```



---

archive/issue_events_147114.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-03-30T13:33:43Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "subject": "https://github.com/defeo",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147114"
}
```



---

archive/issue_comments_109801.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Add the algorithm by Bostain, Morain, Salvy and Schost for normalized cyclic isogenies in characteristic 0 or large enough.\n+Add the algorithm by Bostain, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.\n \n References:\n \n``````\n",
    "created_at": "2011-05-03T16:52:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109801",
    "user": "https://github.com/defeo"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Add the algorithm by Bostain, Morain, Salvy and Schost for normalized cyclic isogenies in characteristic 0 or large enough.
+Add the algorithm by Bostain, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.
 
 References:
 
``````




---

archive/issue_events_147115.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-05-03T16:52:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147115"
}
```



---

archive/issue_comments_109802.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nBesides implementing BMSS, I cleaned a bit `ell_curve_isogeny`, moving the algorithms that do not work in any characteristic to a new module `ell_isogeny_char_zero`. In my view, only the `EllipticCurveIsogeny` class and V\u00e9lu/Kohel formulae should remain in ell_curve_isogeny` in the end.\n\nBMSS runs significantly faster than Stark's, and works for slightly larger characteristics, I thus set it as the default choice. I haven't produced any serious benchmarks, but I will if the reviewers ask me to.",
    "created_at": "2011-05-03T16:52:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109802",
    "user": "https://github.com/defeo"
}
```

<div id="comment:2" align="right">comment:2</div>

Besides implementing BMSS, I cleaned a bit `ell_curve_isogeny`, moving the algorithms that do not work in any characteristic to a new module `ell_isogeny_char_zero`. In my view, only the `EllipticCurveIsogeny` class and Vélu/Kohel formulae should remain in ell_curve_isogeny` in the end.

BMSS runs significantly faster than Stark's, and works for slightly larger characteristics, I thus set it as the default choice. I haven't produced any serious benchmarks, but I will if the reviewers ask me to.



---

archive/issue_comments_109803.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI like this a lot, and it is a good idea to start moving stuff out of the huge isogenies file.  I am planning to do the same for the isogenies of small degree code --currently the genus 0 prime degrees 2,3,5,7,13 and the others which can occur over Q.  Kimi Tsukazaki and I are working on extending that to all the ell for which `X_0(ell)^+` has genus 0.\n\nI tested this against 4.7.rc1 and had some doctest failures.  I expect these will be easy to fix.\n\n```\nsage -t  sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\n// ** nInitExp failed: using Z/2^2\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 165:\n    sage: isogeny_Stark(E1pr, E2pr, 11)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_2[7]>\", line 1, in <module>\n        isogeny_Stark(E1pr, E2pr, Integer(11))###line 165:\n    sage: isogeny_Stark(E1pr, E2pr, 11)\n    NameError: name 'E1pr' is not defined\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 334:\n    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[23]>\", line 1, in <module>\n        kernel = isogeny_BMSS(E1pr, E2pr, Integer(9))###line 334:\n    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)\n    NameError: name 'E1pr' is not defined\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 335:\n    sage: kernel\nExpected:\n    x^8 + 36*x^7 + 95*x^6 + 84*x^4 + 16*x^3 + 70*x^2 + 12*x + 78\nGot:\n    x^4 + 14*x^3 + x^2 + 34*x + 21\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 337:\n    sage: kernel.is_square()\nExpected:\n    False\nGot:\n    True\n**********************************************************************\nFile \"/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py\", line 339:\n    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm=\"bmss\")\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: The two curves are not linked by a normalized isogeny of degree 9\nGot:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-current/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[26]>\", line 1, in <module>\n        isogeny_kernel(E1pr, E2pr, Integer(9), algorithm=\"bmss\")###line 339:\n    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm=\"bmss\")\n    NameError: name 'E1pr' is not defined\n**********************************************************************\n2 items had failures:\n   1 of  22 in __main__.example_2\n   4 of  28 in __main__.example_3\n***Test Failed*** 5 failures.\nFor whitespace errors, see the file /home/jec/.sage//tmp/.doctest_ell_isogeny_char_zero.py\n\t [3.8 s]\n```",
    "created_at": "2011-05-03T17:25:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109803",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:3" align="right">comment:3</div>

I like this a lot, and it is a good idea to start moving stuff out of the huge isogenies file.  I am planning to do the same for the isogenies of small degree code --currently the genus 0 prime degrees 2,3,5,7,13 and the others which can occur over Q.  Kimi Tsukazaki and I are working on extending that to all the ell for which `X_0(ell)^+` has genus 0.

I tested this against 4.7.rc1 and had some doctest failures.  I expect these will be easy to fix.

```
sage -t  sage/schemes/elliptic_curves/ell_isogeny_char_zero.py
// ** nInitExp failed: using Z/2^2
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 165:
    sage: isogeny_Stark(E1pr, E2pr, 11)
Exception raised:
    Traceback (most recent call last):
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_2[7]>", line 1, in <module>
        isogeny_Stark(E1pr, E2pr, Integer(11))###line 165:
    sage: isogeny_Stark(E1pr, E2pr, 11)
    NameError: name 'E1pr' is not defined
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 334:
    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)
Exception raised:
    Traceback (most recent call last):
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[23]>", line 1, in <module>
        kernel = isogeny_BMSS(E1pr, E2pr, Integer(9))###line 334:
    sage: kernel = isogeny_BMSS(E1pr, E2pr, 9)
    NameError: name 'E1pr' is not defined
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 335:
    sage: kernel
Expected:
    x^8 + 36*x^7 + 95*x^6 + 84*x^4 + 16*x^3 + 70*x^2 + 12*x + 78
Got:
    x^4 + 14*x^3 + x^2 + 34*x + 21
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 337:
    sage: kernel.is_square()
Expected:
    False
Got:
    True
**********************************************************************
File "/home/jec/sage-4.7.rc1/devel/sage-main/sage/schemes/elliptic_curves/ell_isogeny_char_zero.py", line 339:
    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm="bmss")
Expected:
    Traceback (most recent call last):
    ...
    ValueError: The two curves are not linked by a normalized isogeny of degree 9
Got:
    Traceback (most recent call last):
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-current/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[26]>", line 1, in <module>
        isogeny_kernel(E1pr, E2pr, Integer(9), algorithm="bmss")###line 339:
    sage: isogeny_kernel(E1pr, E2pr, 9, algorithm="bmss")
    NameError: name 'E1pr' is not defined
**********************************************************************
2 items had failures:
   1 of  22 in __main__.example_2
   4 of  28 in __main__.example_3
***Test Failed*** 5 failures.
For whitespace errors, see the file /home/jec/.sage//tmp/.doctest_ell_isogeny_char_zero.py
	 [3.8 s]
```



---

archive/issue_comments_109804.json:
```json
{
    "body": "Reviewer: **John Cremona**",
    "created_at": "2011-05-03T17:25:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109804",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona**



---

archive/issue_events_147116.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-05-03T17:25:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147116"
}
```



---

archive/issue_events_147117.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-05-03T17:25:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147117"
}
```



---

archive/issue_events_147118.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-05-03T17:25:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147118"
}
```



---

archive/issue_events_147119.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-05-03T17:25:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147119"
}
```



---

archive/issue_events_147120.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-05-03T19:22:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147120"
}
```



---

archive/issue_events_147121.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-05-03T19:22:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147121"
}
```



---

archive/issue_comments_109805.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nOoops! I had made some last minute change to the doctest and must have tested the wrong file afterwards. The new patch passes all tests, including -testall -long",
    "created_at": "2011-05-03T19:22:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109805",
    "user": "https://github.com/defeo"
}
```

<div id="comment:4" align="right">comment:4</div>

Ooops! I had made some last minute change to the doctest and must have tested the wrong file afterwards. The new patch passes all tests, including -testall -long



---

archive/issue_events_147122.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-05-13T13:32:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147122"
}
```



---

archive/issue_events_147123.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-05-13T13:32:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147123"
}
```



---

archive/issue_comments_109806.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI realized that my code for BMSS fails when the isogeny has strictly positive valuation at x, which happens for example when the origin is a point of order 2 and the isogeny has odd degree as in the code below\n\n```\nsage: from sage.schemes.elliptic_curves.ell_isogeny_char_zero import *\nsage: E = EllipticCurve([-1,0])\nsage: E2 = EllipticCurve([-3^4,0])\nsage: E.isogeny(kernel=None, codomain=E2, degree=9)\nTraceback (most recent call last)\n...\nValueError: The two curves are not linked by a normalized isogeny of degree 9\nsage: isogeny_Stark(E,E2,9)\nx^8 - 4*x^6 + 10/3*x^4 + 4/3*x^2 + 1/9\nsage: isogeny_BMSS(E,E2,9)\nx^7 - 4*x^5 + 10/3*x^3 + 4/3*x\n```\n\nThe fix is easy, I hope I'll have time to send a revised patch next week.",
    "created_at": "2011-05-13T13:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109806",
    "user": "https://github.com/defeo"
}
```

<div id="comment:6" align="right">comment:6</div>

I realized that my code for BMSS fails when the isogeny has strictly positive valuation at x, which happens for example when the origin is a point of order 2 and the isogeny has odd degree as in the code below

```
sage: from sage.schemes.elliptic_curves.ell_isogeny_char_zero import *
sage: E = EllipticCurve([-1,0])
sage: E2 = EllipticCurve([-3^4,0])
sage: E.isogeny(kernel=None, codomain=E2, degree=9)
Traceback (most recent call last)
...
ValueError: The two curves are not linked by a normalized isogeny of degree 9
sage: isogeny_Stark(E,E2,9)
x^8 - 4*x^6 + 10/3*x^4 + 4/3*x^2 + 1/9
sage: isogeny_BMSS(E,E2,9)
x^7 - 4*x^5 + 10/3*x^3 + 4/3*x
```

The fix is easy, I hope I'll have time to send a revised patch next week.



---

archive/issue_events_147124.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-06-10T17:58:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147124"
}
```



---

archive/issue_events_147125.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2011-06-10T17:58:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147125"
}
```



---

archive/issue_comments_109807.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_11095_isogenies_char_0.patch.gz](https://github.com/sagemath/sage/files/ticket11095/trac_11095_isogenies_char_0.patch.gz)**\n\nFinally, here's the easy fix! I hope it will be ok now.",
    "created_at": "2011-06-10T17:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109807",
    "user": "https://github.com/defeo"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_11095_isogenies_char_0.patch.gz](https://github.com/sagemath/sage/files/ticket11095/trac_11095_isogenies_char_0.patch.gz)**

Finally, here's the easy fix! I hope it will be ok now.



---

archive/issue_comments_109808.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOn sage 4.7.1.alpha3 with this patch:\n\n```\nsage -t -long devel/sage/sage/interfaces/ecm.py\n*** *** Error: TIMED OUT! PROCESS KILLED! *** ***\n\n         [1800.5 s]\n```",
    "created_at": "2011-07-01T16:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109808",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:8" align="right">comment:8</div>

On sage 4.7.1.alpha3 with this patch:

```
sage -t -long devel/sage/sage/interfaces/ecm.py
*** *** Error: TIMED OUT! PROCESS KILLED! *** ***

         [1800.5 s]
```



---

archive/issue_events_147126.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-07-01T16:49:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147126"
}
```



---

archive/issue_events_147127.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-07-01T16:49:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147127"
}
```



---

archive/issue_comments_109809.json:
```json
{
    "body": "Changed reviewer from **John Cremona** to **John Cremona, Marco Streng**",
    "created_at": "2011-07-01T16:49:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109809",
    "user": "https://github.com/mstreng"
}
```

Changed reviewer from **John Cremona** to **John Cremona, Marco Streng**



---

archive/issue_comments_109810.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.\n\nI tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?",
    "created_at": "2011-07-06T21:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109810",
    "user": "https://github.com/defeo"
}
```

<div id="comment:9" align="right">comment:9</div>

Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.

I tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?



---

archive/issue_comments_109811.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@defeo](#comment:9):\n> Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.\n> \n> I tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?\n\nI'll see if I can reproduce it, and will let you know tomorrow.",
    "created_at": "2011-07-06T21:23:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109811",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@defeo](#comment:9):
> Thanks for testing, Marco. This is wierd: I can't seem to reproduce the error; besides, I don't see how the ecm.py module interacts with the elliptic_curve package.
> 
> I tested on sage 4.7.1.alpha4 with and without the patch and I have no failure in any case. Does anyone understand what's going on? Can anyone confirm the bug?

I'll see if I can reproduce it, and will let you know tomorrow.



---

archive/issue_comments_109812.json:
```json
{
    "body": "Changed reviewer from **John Cremona, Marco Streng** to **John Cremona**",
    "created_at": "2011-07-06T21:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109812",
    "user": "https://github.com/mstreng"
}
```

Changed reviewer from **John Cremona, Marco Streng** to **John Cremona**



---

archive/issue_comments_109813.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@mstreng](#comment:10):\n> I'll see if I can reproduce it, and will let you know tomorrow.\n\nThe problem vanished. Sorry for the trouble.",
    "created_at": "2011-07-06T21:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109813",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@mstreng](#comment:10):
> I'll see if I can reproduce it, and will let you know tomorrow.

The problem vanished. Sorry for the trouble.



---

archive/issue_events_147128.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-07-06T21:33:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147128"
}
```



---

archive/issue_events_147129.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-07-06T21:33:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147129"
}
```



---

archive/issue_comments_109814.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAdded depracation warnings, as suggested by Marco. Apply second patch only (is this going to confuse the patchbot?).",
    "created_at": "2011-07-11T00:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109814",
    "user": "https://github.com/defeo"
}
```

<div id="comment:12" align="right">comment:12</div>

Added depracation warnings, as suggested by Marco. Apply second patch only (is this going to confuse the patchbot?).



---

archive/issue_comments_109815.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n1. I'm confused by the `ValueErrors` raised by `isogeny_kernel`.\n\n```\nValueError, \"The two curves are not linked by a normalized isogeny of degree %s\"%ell\n```\n\nFirst of all, the comment \"or a non-sense polynomial if no such isogeny exists\" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?\n\nSecond, the test \"`ker_poly.degree() != ell-1`\" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)\n\nThird, why is the test \"`not check`\" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?\n\n2. The word \"separable\" seems to be missing from the `ValueErrors`\n\n3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals \"Stark\", \"stark\", \"Starks\", or \"starks\", before detecting that it actually equals \"BMSS\". It may speed things up by epsilon to put the most-used case first. (this is not the reason for \"needs work\")\n\nps. The patch bot seems to have understood that you only want the second patch.",
    "created_at": "2011-07-27T16:23:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109815",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:13" align="right">comment:13</div>

1. I'm confused by the `ValueErrors` raised by `isogeny_kernel`.

```
ValueError, "The two curves are not linked by a normalized isogeny of degree %s"%ell
```

First of all, the comment "or a non-sense polynomial if no such isogeny exists" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?

Second, the test "`ker_poly.degree() != ell-1`" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)

Third, why is the test "`not check`" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?

2. The word "separable" seems to be missing from the `ValueErrors`

3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals "Stark", "stark", "Starks", or "starks", before detecting that it actually equals "BMSS". It may speed things up by epsilon to put the most-used case first. (this is not the reason for "needs work")

ps. The patch bot seems to have understood that you only want the second patch.



---

archive/issue_events_147130.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-07-27T16:23:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147130"
}
```



---

archive/issue_events_147131.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-07-27T16:23:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147131"
}
```



---

archive/issue_comments_109816.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOver a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.  For ordinary curves the set of degrees is the set of all positive integers represented by a ceratin positive definite quadratic form;  for supersingular curves every degree except a finite number are possible (see Kohel's thesis).",
    "created_at": "2011-07-27T16:45:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109816",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:14" align="right">comment:14</div>

Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.  For ordinary curves the set of degrees is the set of all positive integers represented by a ceratin positive definite quadratic form;  for supersingular curves every degree except a finite number are possible (see Kohel's thesis).



---

archive/issue_comments_109817.json:
```json
{
    "body": "Changed reviewer from **John Cremona** to **John Cremona, Marco Streng**",
    "created_at": "2011-07-27T19:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109817",
    "user": "https://github.com/mstreng"
}
```

Changed reviewer from **John Cremona** to **John Cremona, Marco Streng**



---

archive/issue_comments_109818.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@JohnCremona](#comment:14):\n> Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.\n\nThe word \"normalized\" is important here. That should limit the possibilities.",
    "created_at": "2011-07-27T19:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109818",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@JohnCremona](#comment:14):
> Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.

The word "normalized" is important here. That should limit the possibilities.



---

archive/issue_comments_109819.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@mstreng](#comment:15):\n> Replying to [@JohnCremona](#comment:14):\n> > Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.\n\n> \n> The word \"normalized\" is important here. That should limit the possibilities.\n\nNot if you do not mind replacing the codomain with an isomorphic curve, since composing with a scaling map ([u,r,s,t]=[u,0,0,0]) multiplies the constant by u (or maybe `u^-1`) so u can always be chosen to make the isogeny normalised!",
    "created_at": "2011-07-27T19:24:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109819",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@mstreng](#comment:15):
> Replying to [@JohnCremona](#comment:14):
> > Over a finite field theer are always *lots* of isogeny degrees between any two isogenous curves.

> 
> The word "normalized" is important here. That should limit the possibilities.

Not if you do not mind replacing the codomain with an isomorphic curve, since composing with a scaling map ([u,r,s,t]=[u,0,0,0]) multiplies the constant by u (or maybe `u^-1`) so u can always be chosen to make the isogeny normalised!



---

archive/issue_comments_109820.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@JohnCremona](#comment:16):\n> Not if you do not mind replacing the codomain with an isomorphic curve\n\nI don't mind, but the code in this patch does mind.",
    "created_at": "2011-07-27T19:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109820",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@JohnCremona](#comment:16):
> Not if you do not mind replacing the codomain with an isomorphic curve

I don't mind, but the code in this patch does mind.



---

archive/issue_comments_109821.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mstreng](#comment:13):\n> \n> First of all, the comment \"or a non-sense polynomial if no such isogeny exists\" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?\n\nI fixed the docs to be more explicit on this, hope it is clear now.\n\n> \n> Second, the test \"`ker_poly.degree() != ell-1`\" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)\n\nMarco is right: the \"normalized\" requirement is very strong. Indeed if two isogenies are normalized for the same models, then they are solution to the same differential equation with the same initial conditions. In characteristic 0, this means that their power series expansion at infinity is the same, which I think should be enough to prove that there is only one such isogeny.\n\nIn positive characteristic, this means that the power series are equal at least up to the (p-1)/2-th term (which is the limit up to which the BMSS algorithm can compute the solution). I am less sure about unicity in this case, but I am inclined to think that only one isogeny of degree less than p/4 will satisfy the condition (this is true for multiplication-by-m maps, at least).\n\nAs an example, take the multiplication maps by 1 and by p-1 on a curve E: they are both normalized for the models (E,E), which implies that the expansion at infinity of the multiplication-by-(p-1) map is x + O(x^((p-1)/2)). Of course the BMSS algorithm will refuse to compute the second map, because it has degree (p-1)^2 > p/4.\n\nAs a final remark, if we know the right (u,r,s,t) we can normalize the models, as John suggests. But, except for the case of scalar multiplication maps, computing such an isomorphisms is very expensive. I'm working on this in another patch.\n\n> Third, why is the test \"`not check`\" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?\n\nMaybe not, but these algorithms all tend to have some special cases which were not considered in the literature and which yield false answers. So why not test as long as the test comes for free (we have to compute the square root anyway).\n\n> 2. The word \"separable\" seems to be missing from the `ValueErrors`\n\nThe constraints on the degree imply that if such an error is returned, then p does not divide `ell` (otherwise a `ZeroDivisionError` is returned instead), thus no unseparable isogeny of degree `ell` exists either.\n\n> 3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals \"Stark\", \"stark\", \"Starks\", or \"starks\", before detecting that it actually equals \"BMSS\". It may speed things up by epsilon to put the most-used case first. (this is not the reason for \"needs work\")\n\ndone\n\n> ps. The patch bot seems to have understood that you only want the second patch.\n\nYes, but it also used to mention a failure that I was not able to reproduce. It seems to be down now, anyway.",
    "created_at": "2011-07-28T00:53:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109821",
    "user": "https://github.com/defeo"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mstreng](#comment:13):
> 
> First of all, the comment "or a non-sense polynomial if no such isogeny exists" (line 110) is inconsistent with the documentation of `isogeny_BMSS`. Which of the two is correct?

I fixed the docs to be more explicit on this, hope it is clear now.

> 
> Second, the test "`ker_poly.degree() != ell-1`" (line 113) implicitly assumes that there is only one possible degree for a normalized isogeny. It would help future developers to have a comment explaining that this is always the case (it is, isn't it?)

Marco is right: the "normalized" requirement is very strong. Indeed if two isogenies are normalized for the same models, then they are solution to the same differential equation with the same initial conditions. In characteristic 0, this means that their power series expansion at infinity is the same, which I think should be enough to prove that there is only one such isogeny.

In positive characteristic, this means that the power series are equal at least up to the (p-1)/2-th term (which is the limit up to which the BMSS algorithm can compute the solution). I am less sure about unicity in this case, but I am inclined to think that only one isogeny of degree less than p/4 will satisfy the condition (this is true for multiplication-by-m maps, at least).

As an example, take the multiplication maps by 1 and by p-1 on a curve E: they are both normalized for the models (E,E), which implies that the expansion at infinity of the multiplication-by-(p-1) map is x + O(x^((p-1)/2)). Of course the BMSS algorithm will refuse to compute the second map, because it has degree (p-1)^2 > p/4.

As a final remark, if we know the right (u,r,s,t) we can normalize the models, as John suggests. But, except for the case of scalar multiplication maps, computing such an isomorphisms is very expensive. I'm working on this in another patch.

> Third, why is the test "`not check`" there in the Stark case (line 100)? Could `isogeny_Stark` return non-sense polynomials just like you say `isogeny_BMSS` does? Does a non-sense polynomial always imply that no normalized isogeny exist?

Maybe not, but these algorithms all tend to have some special cases which were not considered in the literature and which yield false answers. So why not test as long as the test comes for free (we have to compute the square root anyway).

> 2. The word "separable" seems to be missing from the `ValueErrors`

The constraints on the degree imply that if such an error is returned, then p does not divide `ell` (otherwise a `ZeroDivisionError` is returned instead), thus no unseparable isogeny of degree `ell` exists either.

> 3. I noticed that (with the default options) the function `isogeny_kernel` will first test if algorithm equals "Stark", "stark", "Starks", or "starks", before detecting that it actually equals "BMSS". It may speed things up by epsilon to put the most-used case first. (this is not the reason for "needs work")

done

> ps. The patch bot seems to have understood that you only want the second patch.

Yes, but it also used to mention a failure that I was not able to reproduce. It seems to be down now, anyway.



---

archive/issue_comments_109822.json:
```json
{
    "body": "Attachment: **[trac_11095_isogenies_char_0.2.patch.gz](https://github.com/sagemath/sage/files/ticket11095/trac_11095_isogenies_char_0.2.patch.gz)**",
    "created_at": "2011-07-30T05:45:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109822",
    "user": "https://github.com/defeo"
}
```

Attachment: **[trac_11095_isogenies_char_0.2.patch.gz](https://github.com/sagemath/sage/files/ticket11095/trac_11095_isogenies_char_0.2.patch.gz)**



---

archive/issue_comments_109823.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nwhat are the work issues for that ticket?\n\nPaul",
    "created_at": "2011-09-16T13:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109823",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:19" align="right">comment:19</div>

what are the work issues for that ticket?

Paul



---

archive/issue_comments_109824.json:
```json
{
    "body": "Changed keywords from **isogenies** to **isogenies ecc2011**",
    "created_at": "2011-09-16T13:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109824",
    "user": "https://github.com/zimmermann6"
}
```

Changed keywords from **isogenies** to **isogenies ecc2011**



---

archive/issue_comments_109825.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Add the algorithm by Bostain, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.\n+Add the algorithm by Bostan, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.\n \n References:\n \n``````\n",
    "created_at": "2011-09-16T13:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109825",
    "user": "https://github.com/zimmermann6"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Add the algorithm by Bostain, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.
+Add the algorithm by Bostan, Morain, Salvy and Schost for normalized isogenies in characteristic 0 or large enough.
 
 References:
 
``````




---

archive/issue_events_147132.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147132"
}
```



---

archive/issue_events_147133.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147133"
}
```



---

archive/issue_comments_109826.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nhere is a patch rebased on 5.12.beta4\n\nfor the bot : \n\napply only trac_11095_isogenies_char_0_v3.patch\u200b",
    "created_at": "2013-09-03T19:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109826",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

here is a patch rebased on 5.12.beta4

for the bot : 

apply only trac_11095_isogenies_char_0_v3.patch​



---

archive/issue_comments_109827.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,4 @@\n \n [BMSS08] Alin Bostan, Fran\u00e7ois Morain, Bruno Salvy, and \u00c9ric Schost, Fast algorithms for computing isogenies between elliptic curves, Mathematics of Computation 77 (2008), 1755\u20131778.\n \n+Apply: [attachment: trac_11095_isogenies_char_0_v3.patch\u200b](https://github.com/sagemath/sage/files/ticket11095/0e2630fbe9449c551f50bca100e732dd.gz)\n``````\n",
    "created_at": "2013-09-03T19:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109827",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,4 @@
 
 [BMSS08] Alin Bostan, François Morain, Bruno Salvy, and Éric Schost, Fast algorithms for computing isogenies between elliptic curves, Mathematics of Computation 77 (2008), 1755–1778.
 
+Apply: [attachment: trac_11095_isogenies_char_0_v3.patch​](https://github.com/sagemath/sage/files/ticket11095/0e2630fbe9449c551f50bca100e732dd.gz)
``````




---

archive/issue_comments_109828.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\napply only trac_11095_isogenies_char_0_v3.patch",
    "created_at": "2013-09-03T19:19:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109828",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

apply only trac_11095_isogenies_char_0_v3.patch



---

archive/issue_comments_109829.json:
```json
{
    "body": "Attachment: **[trac_11095_isogenies_char_0_v3.patch.gz](https://github.com/sagemath/sage/files/ticket11095/trac_11095_isogenies_char_0_v3.patch.gz)**",
    "created_at": "2013-09-03T19:25:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109829",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_11095_isogenies_char_0_v3.patch.gz](https://github.com/sagemath/sage/files/ticket11095/trac_11095_isogenies_char_0_v3.patch.gz)**



---

archive/issue_comments_109830.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\napply only trac_11095_isogenies_char_0_v3.patch",
    "created_at": "2013-09-03T19:26:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109830",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">comment:23</div>

apply only trac_11095_isogenies_char_0_v3.patch



---

archive/issue_comments_109831.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThis is going to conflict with #13615 -- can we agree on an order to do them in?",
    "created_at": "2013-09-03T19:34:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109831",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:24" align="right">comment:24</div>

This is going to conflict with #13615 -- can we agree on an order to do them in?



---

archive/issue_comments_109832.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nOh, definitely #13615 first. \n\nThis ticket has been bitrotting for years, although I've never abandoned it and I still use the code from time to time. The new git workflow might be the occasion to go back to it... maybe. In the meantime, I'll put the milestone to sage-pending.",
    "created_at": "2013-09-03T21:23:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109832",
    "user": "https://github.com/defeo"
}
```

<div id="comment:25" align="right">comment:25</div>

Oh, definitely #13615 first. 

This ticket has been bitrotting for years, although I've never abandoned it and I still use the code from time to time. The new git workflow might be the occasion to go back to it... maybe. In the meantime, I'll put the milestone to sage-pending.



---

archive/issue_events_147134.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2013-09-03T21:23:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147134"
}
```



---

archive/issue_events_147135.json:
```json
{
    "actor": "https://github.com/defeo",
    "created_at": "2013-09-03T21:23:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147135"
}
```



---

archive/issue_comments_109833.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI converted the latest patch into a Git branch; there were some conflicts that I hopefully resolved correctly, and all doctests pass.\n\nWould it make sense to call the new module `isogeny_char_zero` instead of `ell_isogeny_char_zero`?  There is also `isogeny_small_degree`; it would be nice if we could avoid having modules with three different prefixes (`isogeny*`, `ell_isogeny*` and `ell_curve_isogeny*`)...",
    "created_at": "2014-04-12T13:31:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109833",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:27" align="right">comment:27</div>

I converted the latest patch into a Git branch; there were some conflicts that I hopefully resolved correctly, and all doctests pass.

Would it make sense to call the new module `isogeny_char_zero` instead of `ell_isogeny_char_zero`?  There is also `isogeny_small_degree`; it would be nice if we could avoid having modules with three different prefixes (`isogeny*`, `ell_isogeny*` and `ell_curve_isogeny*`)...



---

archive/issue_events_147136.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-12T13:31:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147136"
}
```



---

archive/issue_events_147137.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-12T13:31:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147137"
}
```



---

archive/issue_comments_109834.json:
```json
{
    "body": "Branch: **[u/pbruin/11095-isogeny_char_zero](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/11095-isogeny_char_zero)**",
    "created_at": "2014-04-12T13:31:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109834",
    "user": "https://github.com/pjbruin"
}
```

Branch: **[u/pbruin/11095-isogeny_char_zero](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/11095-isogeny_char_zero)**



---

archive/issue_comments_109835.json:
```json
{
    "body": "Commit: **[`12d8a9c`](https://github.com/sagemath/sagetrac-mirror/commit/12d8a9cefc51a11787f77fd8b7e63fc3e1e02723)**",
    "created_at": "2014-04-12T13:31:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109835",
    "user": "https://github.com/pjbruin"
}
```

Commit: **[`12d8a9c`](https://github.com/sagemath/sagetrac-mirror/commit/12d8a9cefc51a11787f77fd8b7e63fc3e1e02723)**



---

archive/issue_comments_109836.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nGood point about naming of modules.  there are 14 with names starting ell_ in the directory called elliptic_curves and the ell_ prefix could be removed from all of them!  (There is also lseries_ell).  But doing so would cause a lot of problems for any other branches affecting any of those files...",
    "created_at": "2014-04-12T16:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109836",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:28" align="right">comment:28</div>

Good point about naming of modules.  there are 14 with names starting ell_ in the directory called elliptic_curves and the ell_ prefix could be removed from all of them!  (There is also lseries_ell).  But doing so would cause a lot of problems for any other branches affecting any of those files...



---

archive/issue_comments_109837.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cae4a71b0836ee6ed2e5607ff3040a0cd538923\"><code>8cae4a7</code></a></td><td><code>Trac 11095: rename ell_isogeny_char_zero to isogeny_char_zero</code></td></tr></table>\n",
    "created_at": "2014-04-24T22:47:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109837",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cae4a71b0836ee6ed2e5607ff3040a0cd538923"><code>8cae4a7</code></a></td><td><code>Trac 11095: rename ell_isogeny_char_zero to isogeny_char_zero</code></td></tr></table>




---

archive/issue_comments_109838.json:
```json
{
    "body": "Changed commit from **[`12d8a9c`](https://github.com/sagemath/sagetrac-mirror/commit/12d8a9cefc51a11787f77fd8b7e63fc3e1e02723)** to **[`8cae4a7`](https://github.com/sagemath/sagetrac-mirror/commit/8cae4a71b0836ee6ed2e5607ff3040a0cd538923)**",
    "created_at": "2014-04-24T22:47:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109838",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`12d8a9c`](https://github.com/sagemath/sagetrac-mirror/commit/12d8a9cefc51a11787f77fd8b7e63fc3e1e02723)** to **[`8cae4a7`](https://github.com/sagemath/sagetrac-mirror/commit/8cae4a71b0836ee6ed2e5607ff3040a0cd538923)**



---

archive/issue_comments_109839.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nSince John and I are for it and nobody seems to be against it, I removed the `ell_` prefix from `isogeny_char_zero`.  (For existing files that would of course be too drastic to do here.)",
    "created_at": "2014-04-24T22:51:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109839",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:30" align="right">comment:30</div>

Since John and I are for it and nobody seems to be against it, I removed the `ell_` prefix from `isogeny_char_zero`.  (For existing files that would of course be too drastic to do here.)



---

archive/issue_events_147138.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-24T22:51:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147138"
}
```



---

archive/issue_events_147139.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-24T22:51:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147139"
}
```



---

archive/issue_comments_109840.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThanks Peter for resurrecting this old ticket of mine. I have no objections to the file renaming.\n\nBack in 2011 Marco Streng and I bypassed Trac and discussed this ticket via mail. I feel I must make an update to explain why the ticket was set to needs work back then.\n\nEssentially, Marco was unhappy about the documentation for two reasons.\n\n1. It wasn't clear whether Stark's algorithm could fail silently. I just had a look at it. It can. I'm commiting the necessary modifications to the docs.\n\n2. The docstring talks about THE normalized isogeny of degree at most `degree`, but it wasn't immediately clear that this isogeny should be unique. Marco himself gave the proof of unicity. This is explained in the note in the docstring of `isogeny_BMSS`.\n\nI can't find any other issue in my mail logs, so it is good to go for me.",
    "created_at": "2014-04-26T03:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109840",
    "user": "https://github.com/defeo"
}
```

<div id="comment:31" align="right">comment:31</div>

Thanks Peter for resurrecting this old ticket of mine. I have no objections to the file renaming.

Back in 2011 Marco Streng and I bypassed Trac and discussed this ticket via mail. I feel I must make an update to explain why the ticket was set to needs work back then.

Essentially, Marco was unhappy about the documentation for two reasons.

1. It wasn't clear whether Stark's algorithm could fail silently. I just had a look at it. It can. I'm commiting the necessary modifications to the docs.

2. The docstring talks about THE normalized isogeny of degree at most `degree`, but it wasn't immediately clear that this isogeny should be unique. Marco himself gave the proof of unicity. This is explained in the note in the docstring of `isogeny_BMSS`.

I can't find any other issue in my mail logs, so it is good to go for me.



---

archive/issue_comments_109841.json:
```json
{
    "body": "Changed branch from **[u/pbruin/11095-isogeny_char_zero](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/11095-isogeny_char_zero)** to **[u/defeo/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/u/defeo/ticket/11095)**",
    "created_at": "2014-04-26T03:08:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109841",
    "user": "https://github.com/defeo"
}
```

Changed branch from **[u/pbruin/11095-isogeny_char_zero](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/11095-isogeny_char_zero)** to **[u/defeo/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/u/defeo/ticket/11095)**



---

archive/issue_events_147140.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-26T11:24:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147140"
}
```



---

archive/issue_events_147141.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-04-26T11:24:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147141"
}
```



---

archive/issue_comments_109842.json:
```json
{
    "body": "Changed commit from **[`8cae4a7`](https://github.com/sagemath/sagetrac-mirror/commit/8cae4a71b0836ee6ed2e5607ff3040a0cd538923)** to **[`3c978f8`](https://github.com/sagemath/sagetrac-mirror/commit/3c978f82831b9b91dfbb6ea675387e4411e7fcb2)**",
    "created_at": "2014-04-26T11:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109842",
    "user": "https://github.com/pjbruin"
}
```

Changed commit from **[`8cae4a7`](https://github.com/sagemath/sagetrac-mirror/commit/8cae4a71b0836ee6ed2e5607ff3040a0cd538923)** to **[`3c978f8`](https://github.com/sagemath/sagetrac-mirror/commit/3c978f82831b9b91dfbb6ea675387e4411e7fcb2)**



---

archive/issue_comments_109843.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nOK.  I cannot review it right now, so I just changed the milestone to \"undiscourage\" people from reviewing it.\n  \n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c978f82831b9b91dfbb6ea675387e4411e7fcb2\"><code>3c978f8</code></a></td><td><code>Modifed docstrings and error messages</code></td></tr></table>\n",
    "created_at": "2014-04-26T11:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109843",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:33" align="right">comment:33</div>

OK.  I cannot review it right now, so I just changed the milestone to "undiscourage" people from reviewing it.
  
---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c978f82831b9b91dfbb6ea675387e4411e7fcb2"><code>3c978f8</code></a></td><td><code>Modifed docstrings and error messages</code></td></tr></table>




---

archive/issue_events_147142.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147142"
}
```



---

archive/issue_events_147143.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147143"
}
```



---

archive/issue_comments_109844.json:
```json
{
    "body": "Changed commit from **[`3c978f8`](https://github.com/sagemath/sagetrac-mirror/commit/3c978f82831b9b91dfbb6ea675387e4411e7fcb2)** to **[`8257108`](https://github.com/sagemath/sagetrac-mirror/commit/825710898d20ba257240bd3cbb45f9c194cb6c01)**",
    "created_at": "2014-05-24T09:26:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109844",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`3c978f8`](https://github.com/sagemath/sagetrac-mirror/commit/3c978f82831b9b91dfbb6ea675387e4411e7fcb2)** to **[`8257108`](https://github.com/sagemath/sagetrac-mirror/commit/825710898d20ba257240bd3cbb45f9c194cb6c01)**



---

archive/issue_comments_109845.json:
```json
{
    "body": "Changed branch from **[u/defeo/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/u/defeo/ticket/11095)** to **[public/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/11095)**",
    "created_at": "2014-05-24T09:26:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109845",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/defeo/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/u/defeo/ticket/11095)** to **[public/ticket/11095](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/11095)**



---

archive/issue_comments_109846.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI have made a few minor changes, including:\n\n- put new raise statements into python3 syntax\n- alignement changes in doc\n \n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f71709a7808e244e958730c4c5998a6b401fb34\"><code>9f71709</code></a></td><td><code>Merge branch 'u/defeo/ticket/11095' of ssh://trac.sagemath.org:22/sage into 11095</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/825710898d20ba257240bd3cbb45f9c194cb6c01\"><code>8257108</code></a></td><td><code>trac #11095 minor details (doc formatting and python3 raise syntax)</code></td></tr></table>\n",
    "created_at": "2014-05-24T09:26:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109846",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:35" align="right">comment:35</div>

I have made a few minor changes, including:

- put new raise statements into python3 syntax
- alignement changes in doc
 
---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f71709a7808e244e958730c4c5998a6b401fb34"><code>9f71709</code></a></td><td><code>Merge branch 'u/defeo/ticket/11095' of ssh://trac.sagemath.org:22/sage into 11095</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/825710898d20ba257240bd3cbb45f9c194cb6c01"><code>8257108</code></a></td><td><code>trac #11095 minor details (doc formatting and python3 raise syntax)</code></td></tr></table>




---

archive/issue_comments_109847.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nI've been experimenting a bit and it seems to work well.  Would it be possible to make `EllipticCurve.isogeny()` and `EllipticCurveIsogeny` accept `algorithm='bmss'`?  In the following example I wanted to compute a 20-isogeny between two elliptic curves over a quadratic field (knowing a priori that such an isogeny exists).  Trying `E.isogeny()` gives a `NotImplementedError` and it seems that I have to import `isogeny_kernel`:\n\n```\nsage: K.<a> = NumberField(x^2 - 17*x - 120)\nsage: E = EllipticCurve([0, 1, 0, -89423170640*a + 1999987182576, 87486176701141216*a - 1956665490639249900])\nsage: E_isog = EllipticCurve([0, 0, 0, 1/3*(6255584200920576*a - 139908796923911440), 1/27*(-5210907833850999276681216*a + 116544166379886781944583040)])\nsage: E.isogeny(kernel=None, codomain=E_isog, degree=20)\n...\nNotImplementedError: For basic Kohel's algorithm, if the kernel degree is even then the kernel must be contained in the two torsion.\nsage: from sage.schemes.elliptic_curves.isogeny_char_zero import isogeny_kernel \nsage: isogeny_kernel(E, E_isog, 20)\nx^10 + (-2152280*a + 48136659)*x^9 + (-148051244547864/5*a + 3311228950404238/5)*x^8 + (-129467694651804753040*a + 2895599965960126731024)*x^7 + (-131438756167338709694710304*a + 2939683593714796730731625088)*x^6 + (196151384137228169247793952562368*a - 4387008996787386307912516668742368)*x^5 + (211127593344837320952211060140401067136*a - 4721958274971357551356075375634080673472)*x^4 + (-676089273725371340027412364537916253836377856/5*a + 15121023690506428142245429629695675550575584512/5)*x^3 + (-58033791954670621184885097803503676816467494405632*a + 1297950399599077493253508317741911096974395766973184)*x^2 + (26614381917191620756309912883562400685500952121788824576*a - 595241952679626281929246822605533328842111805768309632256)*x + 665314371570672918992258944764049661423822960574864980480000*a - 14880038428536031844363469294864157021058877011246176591280640\n```\nBy the way, in this example Stark's algorithm fails; I haven't checked exactly why.\n\n```\nsage: isogeny_kernel(E, E_isog, 20, algorithm='stark')\n...\nRuntimeError: Stark's algorithm returned an unexpected result. Please report this bug.\n```",
    "created_at": "2014-05-24T15:20:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109847",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:36" align="right">comment:36</div>

I've been experimenting a bit and it seems to work well.  Would it be possible to make `EllipticCurve.isogeny()` and `EllipticCurveIsogeny` accept `algorithm='bmss'`?  In the following example I wanted to compute a 20-isogeny between two elliptic curves over a quadratic field (knowing a priori that such an isogeny exists).  Trying `E.isogeny()` gives a `NotImplementedError` and it seems that I have to import `isogeny_kernel`:

```
sage: K.<a> = NumberField(x^2 - 17*x - 120)
sage: E = EllipticCurve([0, 1, 0, -89423170640*a + 1999987182576, 87486176701141216*a - 1956665490639249900])
sage: E_isog = EllipticCurve([0, 0, 0, 1/3*(6255584200920576*a - 139908796923911440), 1/27*(-5210907833850999276681216*a + 116544166379886781944583040)])
sage: E.isogeny(kernel=None, codomain=E_isog, degree=20)
...
NotImplementedError: For basic Kohel's algorithm, if the kernel degree is even then the kernel must be contained in the two torsion.
sage: from sage.schemes.elliptic_curves.isogeny_char_zero import isogeny_kernel 
sage: isogeny_kernel(E, E_isog, 20)
x^10 + (-2152280*a + 48136659)*x^9 + (-148051244547864/5*a + 3311228950404238/5)*x^8 + (-129467694651804753040*a + 2895599965960126731024)*x^7 + (-131438756167338709694710304*a + 2939683593714796730731625088)*x^6 + (196151384137228169247793952562368*a - 4387008996787386307912516668742368)*x^5 + (211127593344837320952211060140401067136*a - 4721958274971357551356075375634080673472)*x^4 + (-676089273725371340027412364537916253836377856/5*a + 15121023690506428142245429629695675550575584512/5)*x^3 + (-58033791954670621184885097803503676816467494405632*a + 1297950399599077493253508317741911096974395766973184)*x^2 + (26614381917191620756309912883562400685500952121788824576*a - 595241952679626281929246822605533328842111805768309632256)*x + 665314371570672918992258944764049661423822960574864980480000*a - 14880038428536031844363469294864157021058877011246176591280640
```
By the way, in this example Stark's algorithm fails; I haven't checked exactly why.

```
sage: isogeny_kernel(E, E_isog, 20, algorithm='stark')
...
RuntimeError: Stark's algorithm returned an unexpected result. Please report this bug.
```



---

archive/issue_comments_109848.json:
```json
{
    "body": "Changed commit from **[`8257108`](https://github.com/sagemath/sagetrac-mirror/commit/825710898d20ba257240bd3cbb45f9c194cb6c01)** to **[`c7f35aa`](https://github.com/sagemath/sagetrac-mirror/commit/c7f35aa4654898f3d5e8f4c2b03d6c6d6a8a218a)**",
    "created_at": "2014-05-25T14:16:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109848",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8257108`](https://github.com/sagemath/sagetrac-mirror/commit/825710898d20ba257240bd3cbb45f9c194cb6c01)** to **[`c7f35aa`](https://github.com/sagemath/sagetrac-mirror/commit/c7f35aa4654898f3d5e8f4c2b03d6c6d6a8a218a)**



---

archive/issue_comments_109849.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7f35aa4654898f3d5e8f4c2b03d6c6d6a8a218a\"><code>c7f35aa</code></a></td><td><code>Merge branch 'develop' into ticket/11095-isogeny_char_zero</code></td></tr></table>\n",
    "created_at": "2014-05-25T14:16:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109849",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7f35aa4654898f3d5e8f4c2b03d6c6d6a8a218a"><code>c7f35aa</code></a></td><td><code>Merge branch 'develop' into ticket/11095-isogeny_char_zero</code></td></tr></table>




---

archive/issue_events_147144.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147144"
}
```



---

archive/issue_events_147145.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147145"
}
```



---

archive/issue_comments_109850.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThe merge conflicts appear to result from #11327.",
    "created_at": "2014-08-22T21:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109850",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:39" align="right">comment:39</div>

The merge conflicts appear to result from #11327.



---

archive/issue_comments_109851.json:
```json
{
    "body": "Work Issues: **merge conflicts**",
    "created_at": "2014-08-22T21:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109851",
    "user": "https://github.com/pjbruin"
}
```

Work Issues: **merge conflicts**



---

archive/issue_events_147146.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-08-22T21:02:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147146"
}
```



---

archive/issue_events_147147.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-08-22T21:02:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147147"
}
```



---

archive/issue_comments_109852.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@pjbruin](#comment:39):\n> The merge conflicts appear to result from #11327.\n\nIf so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.",
    "created_at": "2014-08-24T17:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109852",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@pjbruin](#comment:39):
> The merge conflicts appear to result from #11327.

If so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.



---

archive/issue_comments_109853.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@JohnCremona](#comment:40):\n> Replying to [@pjbruin](#comment:39):\n> > The merge conflicts appear to result from #11327.\n\n> \n> If so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.\n\nI apologise in return: this particular conflict could have been avoided if I had finished my review instead of wondering about adding an extra bit of functionality (comment:36) and leaving it there.",
    "created_at": "2014-08-25T13:52:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109853",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@JohnCremona](#comment:40):
> Replying to [@pjbruin](#comment:39):
> > The merge conflicts appear to result from #11327.

> 
> If so (and it seems likely) I apologise, as the author of #11327, and hope I have not annoyed people.  I'll try to remedy that myself to make up for it, but there are several isogeny-related branches being worked on at the moment and so conflicts are unavoidable.

I apologise in return: this particular conflict could have been avoided if I had finished my review instead of wondering about adding an extra bit of functionality (comment:36) and leaving it there.



---

archive/issue_comments_109854.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nNo big deal. I'm back from conferences+vacation and I'm going to have a look at these conflicts and other isogeny related code in the next few days.",
    "created_at": "2014-08-25T13:55:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109854",
    "user": "https://github.com/defeo"
}
```

<div id="comment:42" align="right">comment:42</div>

No big deal. I'm back from conferences+vacation and I'm going to have a look at these conflicts and other isogeny related code in the next few days.



---

archive/issue_comments_109855.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nThe conflict seems to me to be not so easy to solve. What do you think ?",
    "created_at": "2015-01-27T16:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109855",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:43" align="right">comment:43</div>

The conflict seems to me to be not so easy to solve. What do you think ?



---

archive/issue_comments_109856.json:
```json
{
    "body": "Changed commit from **[`c7f35aa`](https://github.com/sagemath/sagetrac-mirror/commit/c7f35aa4654898f3d5e8f4c2b03d6c6d6a8a218a)** to **[`d882174`](https://github.com/sagemath/sagetrac-mirror/commit/d88217455f757053cd032671ccfb3688fea5dc31)**",
    "created_at": "2015-02-09T20:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109856",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c7f35aa`](https://github.com/sagemath/sagetrac-mirror/commit/c7f35aa4654898f3d5e8f4c2b03d6c6d6a8a218a)** to **[`d882174`](https://github.com/sagemath/sagetrac-mirror/commit/d88217455f757053cd032671ccfb3688fea5dc31)**



---

archive/issue_comments_109857.json:
```json
{
    "body": "<div id=\"comment:44\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c750f70bd9c452c7bf26236dea396dc12c62733c\"><code>c750f70</code></a></td><td><code>Merge branch 'public/ticket/11095' into 6.5.rc1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d88217455f757053cd032671ccfb3688fea5dc31\"><code>d882174</code></a></td><td><code>trac #11095 tentative of rebasing, needs to be checked</code></td></tr></table>\n",
    "created_at": "2015-02-09T20:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109857",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c750f70bd9c452c7bf26236dea396dc12c62733c"><code>c750f70</code></a></td><td><code>Merge branch 'public/ticket/11095' into 6.5.rc1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d88217455f757053cd032671ccfb3688fea5dc31"><code>d882174</code></a></td><td><code>trac #11095 tentative of rebasing, needs to be checked</code></td></tr></table>




---

archive/issue_comments_109858.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nFor this part of the last commit\n\n```diff\n--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n@@ -3441,13 +3436,14 @@ class EllipticCurveIsogeny(Morphism):\n aut = [a for a in auts if a.u == sc]\n if len(aut) != 1:\n     raise ValueError(\"There is a bug in dual().\")\n+ # PROBLEM HERE BELOW IN THE CODE : E0 not defined !\n phi_hat.set_post_isomorphism(WeierstrassIsomorphism(E0,aut[0],E0))\n self.__dual = phi_hat\n \n```\nsee #17293, where I also noticed this problem; the correct line is\n\n```\nphi_hat.set_post_isomorphism(aut[0])\n```",
    "created_at": "2015-02-09T20:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109858",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:45" align="right">comment:45</div>

For this part of the last commit

```diff
--- a/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
+++ b/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
@@ -3441,13 +3436,14 @@ class EllipticCurveIsogeny(Morphism):
 aut = [a for a in auts if a.u == sc]
 if len(aut) != 1:
     raise ValueError("There is a bug in dual().")
+ # PROBLEM HERE BELOW IN THE CODE : E0 not defined !
 phi_hat.set_post_isomorphism(WeierstrassIsomorphism(E0,aut[0],E0))
 self.__dual = phi_hat
 
```
see #17293, where I also noticed this problem; the correct line is

```
phi_hat.set_post_isomorphism(aut[0])
```



---

archive/issue_comments_109859.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOk. anyway, the merge I did here was not perfectly clean : the functions moved to isogeny_char_zero are pretty much in their state dating from before #11327\n\nthis is rather annoying..",
    "created_at": "2015-02-09T20:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109859",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:46" align="right">comment:46</div>

Ok. anyway, the merge I did here was not perfectly clean : the functions moved to isogeny_char_zero are pretty much in their state dating from before #11327

this is rather annoying..



---

archive/issue_comments_109860.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00f6e5257a4afdfe95f4c33c7c088323d3689ac0\"><code>00f6e52</code></a></td><td><code>trac #11095 removed line corrected in another ticket</code></td></tr></table>\n",
    "created_at": "2015-02-09T20:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109860",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00f6e5257a4afdfe95f4c33c7c088323d3689ac0"><code>00f6e52</code></a></td><td><code>trac #11095 removed line corrected in another ticket</code></td></tr></table>




---

archive/issue_comments_109861.json:
```json
{
    "body": "Changed commit from **[`d882174`](https://github.com/sagemath/sagetrac-mirror/commit/d88217455f757053cd032671ccfb3688fea5dc31)** to **[`00f6e52`](https://github.com/sagemath/sagetrac-mirror/commit/00f6e5257a4afdfe95f4c33c7c088323d3689ac0)**",
    "created_at": "2015-02-09T20:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109861",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d882174`](https://github.com/sagemath/sagetrac-mirror/commit/d88217455f757053cd032671ccfb3688fea5dc31)** to **[`00f6e52`](https://github.com/sagemath/sagetrac-mirror/commit/00f6e5257a4afdfe95f4c33c7c088323d3689ac0)**



---

archive/issue_comments_109862.json:
```json
{
    "body": "Changed commit from **[`00f6e52`](https://github.com/sagemath/sagetrac-mirror/commit/00f6e5257a4afdfe95f4c33c7c088323d3689ac0)** to **[`59417df`](https://github.com/sagemath/sagetrac-mirror/commit/59417df5c944443f91d51d996d1d825f144ab734)**",
    "created_at": "2015-02-11T20:22:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109862",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`00f6e52`](https://github.com/sagemath/sagetrac-mirror/commit/00f6e5257a4afdfe95f4c33c7c088323d3689ac0)** to **[`59417df`](https://github.com/sagemath/sagetrac-mirror/commit/59417df5c944443f91d51d996d1d825f144ab734)**



---

archive/issue_comments_109863.json:
```json
{
    "body": "<div id=\"comment:48\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59417df5c944443f91d51d996d1d825f144ab734\"><code>59417df</code></a></td><td><code>trac #11095 some cleanup in the new file isogeny_char_zero</code></td></tr></table>\n",
    "created_at": "2015-02-11T20:22:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11095#issuecomment-109863",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:48"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59417df5c944443f91d51d996d1d825f144ab734"><code>59417df</code></a></td><td><code>trac #11095 some cleanup in the new file isogeny_char_zero</code></td></tr></table>




---

archive/issue_events_147148.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11095",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11095#event-147148"
}
```
