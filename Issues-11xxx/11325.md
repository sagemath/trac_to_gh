# Issue 11325: Twisted won't build on Cygwin - sometimes

archive/issues_011325.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  @mwhansen @dimpase @williamstein\n\nHere's a new one: Cygwin fails on Twisted.  Note that this has been observed once, on an XP virtual machine.  Not on all XP instances, weirdly.\n\nThe error looks like errors linking `_pmap_set` and `_pmap_unset`.\n\n---\nSpkg at [http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg](http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg)\n \n\nIssue created by migration from https://trac.sagemath.org/ticket/11497\n\n",
    "closed_at": "2012-01-05T13:29:54Z",
    "created_at": "2011-06-16T02:49:50Z",
    "labels": [
        "component: porting: cygwin",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Twisted won't build on Cygwin - sometimes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11325",
    "user": "https://github.com/kcrisman"
}
```
Assignee: tbd

CC:  @mwhansen @dimpase @williamstein

Here's a new one: Cygwin fails on Twisted.  Note that this has been observed once, on an XP virtual machine.  Not on all XP instances, weirdly.

The error looks like errors linking `_pmap_set` and `_pmap_unset`.

---
Spkg at [http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg](http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg)
 

Issue created by migration from https://trac.sagemath.org/ticket/11497





---

archive/issue_comments_124854.json:
```json
{
    "body": "The internet (e.g. [this patch](http://twistedmatrix.com/trac/attachment/ticket/1820/runner-setup-2.patch)) says that the problem is in twisted/runner/topfiles/setup.py.\n\nThe fix is to add the rpc library like in the [original fix](http://twistedmatrix.com/trac/ticket/1820) to that Twisted ticket.",
    "created_at": "2011-06-16T02:54:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124854",
    "user": "https://github.com/kcrisman"
}
```

The internet (e.g. [this patch](http://twistedmatrix.com/trac/attachment/ticket/1820/runner-setup-2.patch)) says that the problem is in twisted/runner/topfiles/setup.py.

The fix is to add the rpc library like in the [original fix](http://twistedmatrix.com/trac/ticket/1820) to that Twisted ticket.



---

archive/issue_comments_124855.json:
```json
{
    "body": "See also the twisted upgrade ticket - #8741.",
    "created_at": "2011-06-23T03:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124855",
    "user": "https://github.com/kcrisman"
}
```

See also the twisted upgrade ticket - #8741.



---

archive/issue_comments_124856.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-06-24T15:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124856",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_124857.json:
```json
{
    "body": "Okay, spkg ready for testing at [http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg](http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg)",
    "created_at": "2011-06-24T15:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124857",
    "user": "https://github.com/kcrisman"
}
```

Okay, spkg ready for testing at [http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg](http://sage.math.washington.edu/home/kcrisman/twisted-9.0.p3.spkg)



---

archive/issue_comments_124858.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-06-25T12:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124858",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124859.json:
```json
{
    "body": "I must have messed something up in the syntax - I forgot a comma.   Don't try this yet.",
    "created_at": "2011-06-25T12:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124859",
    "user": "https://github.com/kcrisman"
}
```

I must have messed something up in the syntax - I forgot a comma.   Don't try this yet.



---

archive/issue_comments_124860.json:
```json
{
    "body": "Okay, hopefully this fixed it.  Sorry not to have posted a patch yet - no time now.  Same location.",
    "created_at": "2011-06-25T13:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124860",
    "user": "https://github.com/kcrisman"
}
```

Okay, hopefully this fixed it.  Sorry not to have posted a patch yet - no time now.  Same location.



---

archive/issue_comments_124861.json:
```json
{
    "body": "Okay, this is now correct - I fixed the comma, and it worked.\n\nLet's say this ticket is just for XP, for now, since Win7 seems to have so many other troubles.  Hopefully that will make it easier to review.",
    "created_at": "2011-06-27T18:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124861",
    "user": "https://github.com/kcrisman"
}
```

Okay, this is now correct - I fixed the comma, and it worked.

Let's say this ticket is just for XP, for now, since Win7 seems to have so many other troubles.  Hopefully that will make it easier to review.



---

archive/issue_comments_124862.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-06-27T18:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124862",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124863.json:
```json
{
    "body": "But it works on XP as well.",
    "created_at": "2011-06-28T16:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124863",
    "user": "https://github.com/kcrisman"
}
```

But it works on XP as well.



---

archive/issue_comments_124864.json:
```json
{
    "body": "Replying to [comment:8 kcrisman]:\n> But it works on XP as well.\n\nBy which I meant Win 7 as well.",
    "created_at": "2011-06-29T01:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124864",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:8 kcrisman]:
> But it works on XP as well.

By which I meant Win 7 as well.



---

archive/issue_comments_124865.json:
```json
{
    "body": "User \"RegB\" was able to use this successfully for this - see [this sage-windows thread](http://groups.google.com/group/sage-windows/browse_thread/thread/b7d6ed4902914726).  \n\nSo this just needs someone to look at the actual spkg.",
    "created_at": "2011-07-29T15:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124865",
    "user": "https://github.com/kcrisman"
}
```

User "RegB" was able to use this successfully for this - see [this sage-windows thread](http://groups.google.com/group/sage-windows/browse_thread/thread/b7d6ed4902914726).  

So this just needs someone to look at the actual spkg.



---

archive/issue_comments_124866.json:
```json
{
    "body": "That is, this needs someone *other than me* to look at the actual spkg and its construction :) - should be very easy.",
    "created_at": "2011-07-29T19:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124866",
    "user": "https://github.com/kcrisman"
}
```

That is, this needs someone *other than me* to look at the actual spkg and its construction :) - should be very easy.



---

archive/issue_comments_124867.json:
```json
{
    "body": "Replying to [comment:10 kcrisman]:\n> User \"RegB\" was able to use this successfully for this - see [this sage-windows thread](http://groups.google.com/group/sage-windows/browse_thread/thread/b7d6ed4902914726).  \n\n\nThat was on Vista, just FYI.  Maybe we need another XP reviewer for this?",
    "created_at": "2011-07-29T19:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124867",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:10 kcrisman]:
> User "RegB" was able to use this successfully for this - see [this sage-windows thread](http://groups.google.com/group/sage-windows/browse_thread/thread/b7d6ed4902914726).  


That was on Vista, just FYI.  Maybe we need another XP reviewer for this?



---

archive/issue_comments_124868.json:
```json
{
    "body": "somehow I don't need this spkg for Win 7 - what comes with Sage 4.7.2 installs OK.",
    "created_at": "2011-11-27T15:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124868",
    "user": "https://github.com/dimpase"
}
```

somehow I don't need this spkg for Win 7 - what comes with Sage 4.7.2 installs OK.



---

archive/issue_comments_124869.json:
```json
{
    "body": "Replying to [comment:14 dimpase]:\n\nWelcome back!\n\n> somehow I don't need this spkg for Win 7 - what comes with Sage 4.7.2 installs OK.\n\nYes, this was only ever an XP problem, as far as I know.\n\nIf you can verify this spkg doesn't cause problems on Win 7, then I think that would be enough to positively review and merge. You are right that XP is less and less important in the long run, of course.",
    "created_at": "2011-11-28T13:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124869",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:14 dimpase]:

Welcome back!

> somehow I don't need this spkg for Win 7 - what comes with Sage 4.7.2 installs OK.

Yes, this was only ever an XP problem, as far as I know.

If you can verify this spkg doesn't cause problems on Win 7, then I think that would be enough to positively review and merge. You are right that XP is less and less important in the long run, of course.



---

archive/issue_comments_124870.json:
```json
{
    "body": "Is this superseded by the Twisted 11.0 spkg at #11847?",
    "created_at": "2011-12-13T17:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124870",
    "user": "https://github.com/jasongrout"
}
```

Is this superseded by the Twisted 11.0 spkg at #11847?



---

archive/issue_comments_124871.json:
```json
{
    "body": "> Is this superseded by the Twisted 11.0 spkg at #11847?\n\nAlmost certainly not - the devels on the link above seemed not to care too much - the last change was 18 months ago, and they didn't want to do anything without a Cygwin slave.  I can try to see whether the new package applies sometime tonight, but I doubt that it's in upstream.  And of course this was only ever on XP.\n\nStill, if you can apply this without too much trouble on yours, with a patch applied only in case of Cygwin, I think that would be a good idea.",
    "created_at": "2011-12-13T18:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124871",
    "user": "https://github.com/kcrisman"
}
```

> Is this superseded by the Twisted 11.0 spkg at #11847?

Almost certainly not - the devels on the link above seemed not to care too much - the last change was 18 months ago, and they didn't want to do anything without a Cygwin slave.  I can try to see whether the new package applies sometime tonight, but I doubt that it's in upstream.  And of course this was only ever on XP.

Still, if you can apply this without too much trouble on yours, with a patch applied only in case of Cygwin, I think that would be a good idea.



---

archive/issue_comments_124872.json:
```json
{
    "body": "You mean #11874, of course!",
    "created_at": "2011-12-14T01:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124872",
    "user": "https://github.com/kcrisman"
}
```

You mean #11874, of course!



---

archive/issue_comments_124873.json:
```json
{
    "body": "For reference only",
    "created_at": "2011-12-14T02:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124873",
    "user": "https://github.com/kcrisman"
}
```

For reference only



---

archive/issue_comments_124874.json:
```json
{
    "body": "Attachment [trac_11497.diff](tarball://root/attachments/some-uuid/ticket11497/trac_11497.diff) by @kcrisman created at 2011-12-14 02:18:01\n\nAfter testing on the newest Cygwin on XP, I think this issue may have been an older Cygwin issue, not an XP issue per se.  I have no problems building the current p2, the p3 on this ticket, or Twisted 11 on #11874.  Setting to sage-invalid, keeping Reg as a reviewer for checking this worked on Vista and Dima for checking on Win 7 this wasn't necessary.\n\n---\nI've added [attachment:trac_11497.diff] for reference in case we need to apply this in the future for some reason.",
    "created_at": "2011-12-14T02:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124874",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_11497.diff](tarball://root/attachments/some-uuid/ticket11497/trac_11497.diff) by @kcrisman created at 2011-12-14 02:18:01

After testing on the newest Cygwin on XP, I think this issue may have been an older Cygwin issue, not an XP issue per se.  I have no problems building the current p2, the p3 on this ticket, or Twisted 11 on #11874.  Setting to sage-invalid, keeping Reg as a reviewer for checking this worked on Vista and Dima for checking on Win 7 this wasn't necessary.

---
I've added [attachment:trac_11497.diff] for reference in case we need to apply this in the future for some reason.



---

archive/issue_events_029952.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-12-14T02:18:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11325#event-29952"
}
```



---

archive/issue_comments_124875.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-14T02:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124875",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_029953.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-05T13:29:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11325#event-29953"
}
```



---

archive/issue_comments_124876.json:
```json
{
    "body": "Resolution: worksforme",
    "created_at": "2012-01-05T13:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11325#issuecomment-124876",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: worksforme
