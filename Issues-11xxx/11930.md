# Issue 11930: disallow non-smooth hyperelliptic curves, and let hyperelliptic curves know they are not singular

archive/issues_011758.json:
```json
{
    "assignees": [
        "https://github.com/JohnCremona"
    ],
    "body": "Hyperelliptic curves are smooth curves mathematically. These patches add a check for this to the constructor and implement `is_singular` to always return `False`\n\nExample\n\n```\nsage: R.<x> = PolynomialRing(GF(3))\nsage: H=HyperellipticCurve(x^5+1)\nsage: H.is_singular()\n# used to return True, now returns False\nsage: H.is_smooth()\n# used to return False, now returns True\nsage: HyperellipticCurve(x^5)\n# used to return a curve y^2 = x^5, now raises an error\n```\n\nApply\n\n* [attachment: 11930d.patch](https://github.com/sagemath/sage/files/ticket11930/11930d.patch.gz)\n* [attachment: 11930_is_singular2.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)\n\nCC:  D.Testa@warwick.ac.uk @jpflori @sagetrac-davideklund\n\nComponent: **elliptic curves**\n\nKeywords: **hyperelliptic curve singular smooth sd35**\n\nAuthor: **Daniel Krenn, Marco Streng, Damiano Testa**\n\nReviewer: **Marco Streng, Damiano Testa, David Eklund**\n\nMerged: **sage-5.1.beta2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11930_\n\n",
    "closed_at": "2012-06-02T12:10:15Z",
    "created_at": "2011-10-17T14:12:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "disallow non-smooth hyperelliptic curves, and let hyperelliptic curves know they are not singular",
    "type": "issue",
    "updated_at": "2012-06-02T12:10:15Z",
    "url": "https://github.com/sagemath/sage/issues/11930",
    "user": "https://github.com/dkrenn"
}
```
Hyperelliptic curves are smooth curves mathematically. These patches add a check for this to the constructor and implement `is_singular` to always return `False`

Example

```
sage: R.<x> = PolynomialRing(GF(3))
sage: H=HyperellipticCurve(x^5+1)
sage: H.is_singular()
# used to return True, now returns False
sage: H.is_smooth()
# used to return False, now returns True
sage: HyperellipticCurve(x^5)
# used to return a curve y^2 = x^5, now raises an error
```

Apply

* [attachment: 11930d.patch](https://github.com/sagemath/sage/files/ticket11930/11930d.patch.gz)
* [attachment: 11930_is_singular2.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)

CC:  D.Testa@warwick.ac.uk @jpflori @sagetrac-davideklund

Component: **elliptic curves**

Keywords: **hyperelliptic curve singular smooth sd35**

Author: **Daniel Krenn, Marco Streng, Damiano Testa**

Reviewer: **Marco Streng, Damiano Testa, David Eklund**

Merged: **sage-5.1.beta2**

_Issue created by migration from https://trac.sagemath.org/ticket/11930_





---

archive/issue_events_159444.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2011-10-17T14:12:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159444"
}
```



---

archive/issue_events_159445.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2011-10-17T14:12:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159445"
}
```



---

archive/issue_events_159446.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2011-10-17T14:12:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159446"
}
```



---

archive/issue_events_159447.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2011-10-17T14:12:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159447"
}
```



---

archive/issue_events_159448.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-10-17T14:12:59Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "subject": "https://github.com/dkrenn",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159448"
}
```



---

archive/issue_comments_125966.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis is a good idea.  When we implemented the one-line test for nonsingularity of general curves over finite fields last year (after discovering to our surprise that it was not implemented) we did not think of this special case.  The generic is_singular() method is defined in sage/schemes/plane_curves/projective_curve.py as a method of class ProjectiveCurve_generic.  Your H is of a derived class, so it would be possible to write a different is_singular() method for that subclass.",
    "created_at": "2011-10-17T15:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125966",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:1" align="right">comment:1</div>

This is a good idea.  When we implemented the one-line test for nonsingularity of general curves over finite fields last year (after discovering to our surprise that it was not implemented) we did not think of this special case.  The generic is_singular() method is defined in sage/schemes/plane_curves/projective_curve.py as a method of class ProjectiveCurve_generic.  Your H is of a derived class, so it would be possible to write a different is_singular() method for that subclass.



---

archive/issue_events_159449.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2011-11-02T14:49:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159449"
}
```



---

archive/issue_comments_125967.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[trac_11930_is_singular_hec.patch.gz](https://github.com/sagemath/sage/files/ticket11930/trac_11930_is_singular_hec.patch.gz)**",
    "created_at": "2011-11-02T14:49:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125967",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[trac_11930_is_singular_hec.patch.gz](https://github.com/sagemath/sage/files/ticket11930/trac_11930_is_singular_hec.patch.gz)**



---

archive/issue_comments_125968.json:
```json
{
    "body": "Author: **dkrenn**",
    "created_at": "2011-11-04T17:25:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125968",
    "user": "https://github.com/dkrenn"
}
```

Author: **dkrenn**



---

archive/issue_comments_125969.json:
```json
{
    "body": "Changed author from **dkrenn** to **Daniel Krenn**",
    "created_at": "2011-11-04T17:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125969",
    "user": "https://github.com/dkrenn"
}
```

Changed author from **dkrenn** to **Daniel Krenn**



---

archive/issue_comments_125970.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe cause is of course the computationally convenient, but mathematically inaccurate, ambient space. The curve is smooth and projective, but not in `P^2`:\n\n```\nsage: R.<x> = GF(3)[]\nsage: H = HyperellipticCurve(x^5+1)\nsage: H.ambient_space()\nProjective Space of dimension 2 over Finite Field of size 3\n```",
    "created_at": "2011-12-17T15:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125970",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:5" align="right">comment:5</div>

The cause is of course the computationally convenient, but mathematically inaccurate, ambient space. The curve is smooth and projective, but not in `P^2`:

```
sage: R.<x> = GF(3)[]
sage: H = HyperellipticCurve(x^5+1)
sage: H.ambient_space()
Projective Space of dimension 2 over Finite Field of size 3
```



---

archive/issue_comments_125971.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThere is a much faster way to get the same answer for fields of characteristic not 2:\n\n```\nsage: R.<x> = GF(3)[]\nsage: H = HyperellipticCurve(x^5+1)\nsage: timeit('H.is_singular()')\n125 loops, best of 3: 5.14 ms per loop\nsage: timeit('H.hyperelliptic_polynomials()[0].discriminant()!=0')\n625 loops, best of 3: 266 \u00b5s per loop\n```",
    "created_at": "2011-12-17T15:37:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125971",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:6" align="right">comment:6</div>

There is a much faster way to get the same answer for fields of characteristic not 2:

```
sage: R.<x> = GF(3)[]
sage: H = HyperellipticCurve(x^5+1)
sage: timeit('H.is_singular()')
125 loops, best of 3: 5.14 ms per loop
sage: timeit('H.hyperelliptic_polynomials()[0].discriminant()!=0')
625 loops, best of 3: 266 µs per loop
```



---

archive/issue_comments_125972.json:
```json
{
    "body": "Changed keywords from **hyperelliptic curve, singular** to **hyperelliptic curve, singular, sd35**",
    "created_at": "2011-12-18T15:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125972",
    "user": "https://github.com/mstreng"
}
```

Changed keywords from **hyperelliptic curve, singular** to **hyperelliptic curve, singular, sd35**



---

archive/issue_events_159450.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-12-18T15:16:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "title_is": "function to check if hyperelliptic curve is singular in the sense of hyperelliptic curves",
    "title_was": "function to check if hyperelliptitc curve is singular in the sense of hyperelliptic curves",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159450"
}
```



---

archive/issue_comments_125973.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nDisagreement with Magma, there should still be some condition at infinity for this to be a nice hyperelliptic curve. We are now figuring out what that condition should be.\n\n```\nsage: P.<x> = GF(2)[]\nsage: H = HyperellipticCurve(x^6+1, 1)\nsage: H.is_singular()\nFalse\nsage: magma(H)\nTypeError: Error evaluating Magma code.\nRuntime error in 'HyperellipticCurve': Curve is singular at infinity\n```\n\nAlso, it seems from the code in HyperellipticCurve that some partial check for singularity is performed there. Should that be a full check or no check at all?",
    "created_at": "2011-12-18T15:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125973",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:7" align="right">comment:7</div>

Disagreement with Magma, there should still be some condition at infinity for this to be a nice hyperelliptic curve. We are now figuring out what that condition should be.

```
sage: P.<x> = GF(2)[]
sage: H = HyperellipticCurve(x^6+1, 1)
sage: H.is_singular()
False
sage: magma(H)
TypeError: Error evaluating Magma code.
Runtime error in 'HyperellipticCurve': Curve is singular at infinity
```

Also, it seems from the code in HyperellipticCurve that some partial check for singularity is performed there. Should that be a full check or no check at all?



---

archive/issue_events_159451.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-12-18T15:16:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159451"
}
```



---

archive/issue_events_159452.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-12-18T15:16:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159452"
}
```



---

archive/issue_comments_125974.json:
```json
{
    "body": "Reviewer: **Marco Streng, Damiano Testa**",
    "created_at": "2011-12-18T15:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125974",
    "user": "https://github.com/mstreng"
}
```

Reviewer: **Marco Streng, Damiano Testa**



---

archive/issue_comments_125975.json:
```json
{
    "body": "Attachment: **[11930_singular_hyperelliptic.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930_singular_hyperelliptic.patch.gz)**\n\nchange the constructor of hyperelliptic curve to check if the input makes sense",
    "created_at": "2011-12-18T20:35:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125975",
    "user": "https://github.com/mstreng"
}
```

Attachment: **[11930_singular_hyperelliptic.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930_singular_hyperelliptic.patch.gz)**

change the constructor of hyperelliptic curve to check if the input makes sense



---

archive/issue_comments_125976.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,8 +6,11 @@\n sage: H.is_singular()\n True\n ```\n-but `H` is a non-singular hyperelliptic curve. Although this is **not** an error, since all hyperelliptic curves, where the degree of the defining polynomial is at least 5, have a singularity at infinity. \n+but `H` is a non-singular hyperelliptic curve.\n \n-The term non-singular hyperelliptic curve is used to say that all finite points are non-singular. Therefore it would be nice to have a function that returns the (non-)singularity of the finite points of an hyperelliptic curve.\n+Hyperelliptic curves are smooth curves mathematically. In Sage, they are implemented as plane curves with a singularity at infinity, but that singularity can always be resolved.\n \n+Apply\n \n+* [attachment: 11930_singular_hyperelliptic.patch](https://github.com/sagemath/sage/files/ticket11930/11930_singular_hyperelliptic.patch.gz)\n+* [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)\n``````\n",
    "created_at": "2011-12-18T22:00:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125976",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,8 +6,11 @@
 sage: H.is_singular()
 True
 ```
-but `H` is a non-singular hyperelliptic curve. Although this is **not** an error, since all hyperelliptic curves, where the degree of the defining polynomial is at least 5, have a singularity at infinity. 
+but `H` is a non-singular hyperelliptic curve.
 
-The term non-singular hyperelliptic curve is used to say that all finite points are non-singular. Therefore it would be nice to have a function that returns the (non-)singularity of the finite points of an hyperelliptic curve.
+Hyperelliptic curves are smooth curves mathematically. In Sage, they are implemented as plane curves with a singularity at infinity, but that singularity can always be resolved.
 
+Apply
 
+* [attachment: 11930_singular_hyperelliptic.patch](https://github.com/sagemath/sage/files/ticket11930/11930_singular_hyperelliptic.patch.gz)
+* [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)
``````




---

archive/issue_comments_125977.json:
```json
{
    "body": "Changed author from **Daniel Krenn** to **Daniel Krenn, Marco Streng, Damiano Testa**",
    "created_at": "2011-12-18T22:00:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125977",
    "user": "https://github.com/mstreng"
}
```

Changed author from **Daniel Krenn** to **Daniel Krenn, Marco Streng, Damiano Testa**



---

archive/issue_comments_125978.json:
```json
{
    "body": "Work Issues: **add singular examples to the documentation of the constructor, do some tests**",
    "created_at": "2011-12-18T22:00:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125978",
    "user": "https://github.com/mstreng"
}
```

Work Issues: **add singular examples to the documentation of the constructor, do some tests**



---

archive/issue_comments_125979.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nApply 11930_singular_hyperelliptic.patch and 11930_is_singular.patch\n\nThe first of these patches (written by Damiano and I) adds tests to the HyperellipticCurve constructor. It tests whether the input polynomials f(x) and h(x) really make sense. In other words, it checks if there is some g such that, when f and h are homogenized wrt x to degrees 2g+2 and g+1 respectively, one gets a smooth projective curve. We compared it with the independent implementation in Magma, and the test turns out to be equivalent to Magma's test for all input polynomials over GF(2) and GF(3) where deg(f) is 5 or 6 and deg(h) <= 3.\n\nThe second patch is Daniel's function, but with a simpler algorithm that uses the fact that only smooth curves are constructed.",
    "created_at": "2011-12-18T22:00:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125979",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:8" align="right">comment:8</div>

Apply 11930_singular_hyperelliptic.patch and 11930_is_singular.patch

The first of these patches (written by Damiano and I) adds tests to the HyperellipticCurve constructor. It tests whether the input polynomials f(x) and h(x) really make sense. In other words, it checks if there is some g such that, when f and h are homogenized wrt x to degrees 2g+2 and g+1 respectively, one gets a smooth projective curve. We compared it with the independent implementation in Magma, and the test turns out to be equivalent to Magma's test for all input polynomials over GF(2) and GF(3) where deg(f) is 5 or 6 and deg(h) <= 3.

The second patch is Daniel's function, but with a simpler algorithm that uses the fact that only smooth curves are constructed.



---

archive/issue_comments_125980.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSee also #11800 and #11980",
    "created_at": "2011-12-18T22:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125980",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:9" align="right">comment:9</div>

See also #11800 and #11980



---

archive/issue_comments_125981.json:
```json
{
    "body": "Attachment: **[11930b.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930b.patch.gz)**\n\nnew version, fixes doctests",
    "created_at": "2011-12-20T16:35:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125981",
    "user": "https://github.com/mstreng"
}
```

Attachment: **[11930b.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930b.patch.gz)**

new version, fixes doctests



---

archive/issue_comments_125982.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,5 +12,5 @@\n \n Apply\n \n-* [attachment: 11930_singular_hyperelliptic.patch](https://github.com/sagemath/sage/files/ticket11930/11930_singular_hyperelliptic.patch.gz)\n+* [attachment: 11930b.patch](https://github.com/sagemath/sage/files/ticket11930/11930b.patch.gz)\n * [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)\n``````\n",
    "created_at": "2011-12-20T16:36:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125982",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,5 +12,5 @@
 
 Apply
 
-* [attachment: 11930_singular_hyperelliptic.patch](https://github.com/sagemath/sage/files/ticket11930/11930_singular_hyperelliptic.patch.gz)
+* [attachment: 11930b.patch](https://github.com/sagemath/sage/files/ticket11930/11930b.patch.gz)
 * [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)
``````




---

archive/issue_comments_125983.json:
```json
{
    "body": "Changed work issues from **add singular examples to the documentation of the constructor, do some tests** to **make resultants work for more general fields**",
    "created_at": "2011-12-20T16:36:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125983",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **add singular examples to the documentation of the constructor, do some tests** to **make resultants work for more general fields**



---

archive/issue_comments_125984.json:
```json
{
    "body": "Attachment: **[resultant.py.gz](https://github.com/sagemath/sage/files/ticket11930/resultant.py.gz)**",
    "created_at": "2011-12-20T16:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125984",
    "user": "https://github.com/mstreng"
}
```

Attachment: **[resultant.py.gz](https://github.com/sagemath/sage/files/ticket11930/resultant.py.gz)**



---

archive/issue_comments_125985.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\napply 11930b.patch and 11930_is_singular.patch",
    "created_at": "2011-12-20T16:38:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125985",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:11" align="right">comment:11</div>

apply 11930b.patch and 11930_is_singular.patch



---

archive/issue_comments_125986.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nMarco, I tried to apply this patch to 4.7.2 (this is needed to check #11800).\nHowever the example in the description still fails:\n\n```\n----------------------------------------------------------------------\n| Sage Version 4.7.2, Release Date: 2011-10-29                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nLoading Sage library. Current Mercurial branch is: 11800\nsage: R.<x> = PolynomialRing(GF(3))\nsage: H=HyperellipticCurve(x^5+1)\nsage: H.is_singular()\nTrue\n```\nPaul",
    "created_at": "2011-12-24T11:37:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125986",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:12" align="right">comment:12</div>

Marco, I tried to apply this patch to 4.7.2 (this is needed to check #11800).
However the example in the description still fails:

```
----------------------------------------------------------------------
| Sage Version 4.7.2, Release Date: 2011-10-29                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
Loading Sage library. Current Mercurial branch is: 11800
sage: R.<x> = PolynomialRing(GF(3))
sage: H=HyperellipticCurve(x^5+1)
sage: H.is_singular()
True
```
Paul



---

archive/issue_comments_125987.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nOops, sorry, yes. I wrote \"True\" in [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz) where it should have been \"False\".",
    "created_at": "2011-12-26T13:28:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125987",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:13" align="right">comment:13</div>

Oops, sorry, yes. I wrote "True" in [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz) where it should have been "False".



---

archive/issue_comments_125988.json:
```json
{
    "body": "Changed work issues from **make resultants work for more general fields** to **make resultants work for more general fields or (better) implement gcd for polynomial rings over fields and use that**",
    "created_at": "2011-12-27T13:51:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125988",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **make resultants work for more general fields** to **make resultants work for more general fields or (better) implement gcd for polynomial rings over fields and use that**



---

archive/issue_comments_125989.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI can finish this, but not in the next couple of weeks. If anyone wants to work on this, post to this ticket first.",
    "created_at": "2011-12-27T13:51:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125989",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:14" align="right">comment:14</div>

I can finish this, but not in the next couple of weeks. If anyone wants to work on this, post to this ticket first.



---

archive/issue_comments_125990.json:
```json
{
    "body": "disallow non-smooth hyperelliptic curves",
    "created_at": "2012-01-07T22:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125990",
    "user": "https://github.com/mstreng"
}
```

disallow non-smooth hyperelliptic curves



---

archive/issue_comments_125991.json:
```json
{
    "body": "Attachment: **[11930c.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)**\n\nis_singular always returns False for hyperelliptic curves",
    "created_at": "2012-01-07T22:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125991",
    "user": "https://github.com/mstreng"
}
```

Attachment: **[11930c.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)**

is_singular always returns False for hyperelliptic curves



---

archive/issue_comments_125992.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,17 @@\n-We have\n+Hyperelliptic curves are smooth curves mathematically. These patches add a check for this to the constructor and implement `is_singular` to always return `False`\n+\n+Example\n \n ```\n sage: R.<x> = PolynomialRing(GF(3))\n sage: H=HyperellipticCurve(x^5+1)\n sage: H.is_singular()\n-True\n+# used to return True, now returns False\n+sage: H=HyperellipticCurve(x^5)\n+# used to return a curve y^2 = x^5, now raises an error\n ```\n-but `H` is a non-singular hyperelliptic curve.\n-\n-Hyperelliptic curves are smooth curves mathematically. In Sage, they are implemented as plane curves with a singularity at infinity, but that singularity can always be resolved.\n \n Apply\n \n-* [attachment: 11930b.patch](https://github.com/sagemath/sage/files/ticket11930/11930b.patch.gz)\n+* [attachment: 11930c.patch](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)\n * [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)\n``````\n",
    "created_at": "2012-01-07T22:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125992",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,17 @@
-We have
+Hyperelliptic curves are smooth curves mathematically. These patches add a check for this to the constructor and implement `is_singular` to always return `False`
+
+Example
 
 ```
 sage: R.<x> = PolynomialRing(GF(3))
 sage: H=HyperellipticCurve(x^5+1)
 sage: H.is_singular()
-True
+# used to return True, now returns False
+sage: H=HyperellipticCurve(x^5)
+# used to return a curve y^2 = x^5, now raises an error
 ```
-but `H` is a non-singular hyperelliptic curve.
-
-Hyperelliptic curves are smooth curves mathematically. In Sage, they are implemented as plane curves with a singularity at infinity, but that singularity can always be resolved.
 
 Apply
 
-* [attachment: 11930b.patch](https://github.com/sagemath/sage/files/ticket11930/11930b.patch.gz)
+* [attachment: 11930c.patch](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)
 * [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)
``````




---

archive/issue_events_159453.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159453"
}
```



---

archive/issue_events_159454.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159454"
}
```



---

archive/issue_events_159455.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "title_is": "disallow non-smooth hyperelliptic curves, and let hyperelliptic curves know they are not singular",
    "title_was": "function to check if hyperelliptic curve is singular in the sense of hyperelliptic curves",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159455"
}
```



---

archive/issue_comments_125993.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[11930_is_singular.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)**",
    "created_at": "2012-01-07T22:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125993",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[11930_is_singular.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)**



---

archive/issue_events_159456.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159456"
}
```



---

archive/issue_events_159457.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159457"
}
```



---

archive/issue_events_159458.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159458"
}
```



---

archive/issue_events_159459.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-01-07T22:34:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159459"
}
```



---

archive/issue_comments_125994.json:
```json
{
    "body": "Changed work issues from **make resultants work for more general fields or (better) implement gcd for polynomial rings over fields and use that** to none",
    "created_at": "2012-01-07T22:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125994",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **make resultants work for more general fields or (better) implement gcd for polynomial rings over fields and use that** to none



---

archive/issue_comments_125995.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nTo check whether a polynomial has repeated roots, this patch uses both GCDs and resultants. It tries the GCD first, because that is fastest. If that fails, it tries the resultant.\n\nThe reason for needing both gcds and resultants is actually quite funny: Qp has no gcd currently implemented in Sage, while extensions of Qp have no resultants in Sage!\n\nWith 4.8.alpha4, I get\n\n```\nsage: P.<x> = Qp(5,7)[]\nsage: x.gcd(x)\n# AttributeError: 'Polynomial_padic_capped_relative_dense' object has no attribute 'gcd'\nsage: x.resultant(x)\n# 0\nsage: K.<a> = Qp(5,7).extension(x^2-5)\nsage: P.<x> = K[]\nsage: x.gcd(x)\n# (1 + O(a^14))*x\nsage: x.resultant(x)\n# TypeError: no conversion of this ring to a Singular ring defined\n```",
    "created_at": "2012-01-07T22:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125995",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:17" align="right">comment:17</div>

To check whether a polynomial has repeated roots, this patch uses both GCDs and resultants. It tries the GCD first, because that is fastest. If that fails, it tries the resultant.

The reason for needing both gcds and resultants is actually quite funny: Qp has no gcd currently implemented in Sage, while extensions of Qp have no resultants in Sage!

With 4.8.alpha4, I get

```
sage: P.<x> = Qp(5,7)[]
sage: x.gcd(x)
# AttributeError: 'Polynomial_padic_capped_relative_dense' object has no attribute 'gcd'
sage: x.resultant(x)
# 0
sage: K.<a> = Qp(5,7).extension(x^2-5)
sage: P.<x> = K[]
sage: x.gcd(x)
# (1 + O(a^14))*x
sage: x.resultant(x)
# TypeError: no conversion of this ring to a Singular ring defined
```



---

archive/issue_comments_125996.json:
```json
{
    "body": "Changed keywords from **hyperelliptic curve, singular, sd35** to **hyperelliptic curve singular smooth sd35**",
    "created_at": "2012-01-07T22:46:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125996",
    "user": "https://github.com/mstreng"
}
```

Changed keywords from **hyperelliptic curve, singular, sd35** to **hyperelliptic curve singular smooth sd35**



---

archive/issue_comments_125997.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nPatch was written on top of 4.8.alpha4.\nApply 11930c.patch and 11930_is_singular.patch",
    "created_at": "2012-01-07T22:46:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125997",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:18" align="right">comment:18</div>

Patch was written on top of 4.8.alpha4.
Apply 11930c.patch and 11930_is_singular.patch



---

archive/issue_comments_125998.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI'm not happy with this:\n\n```\n \t51\t    .. NOTE:: \n \t52\t \n \t53\t        The words \"hyperelliptic curve\" are normally only used for curves of \n \t54\t        genus at least two, but this class allows more general smooth double \n \t55\t        covers of the projective line (conics and elliptic curves), even though \n \t56\t        the class is not meant for those and some outputs may be incorrect.\n```\nI don't think we can merge this if we know or suspect that it gives incorrect results! We should either raise an error in these cases, or check that the results that are returned are correct.",
    "created_at": "2012-03-13T00:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125998",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:19" align="right">comment:19</div>

I'm not happy with this:

```
 	51	    .. NOTE:: 
 	52	 
 	53	        The words "hyperelliptic curve" are normally only used for curves of 
 	54	        genus at least two, but this class allows more general smooth double 
 	55	        covers of the projective line (conics and elliptic curves), even though 
 	56	        the class is not meant for those and some outputs may be incorrect.
```
I don't think we can merge this if we know or suspect that it gives incorrect results! We should either raise an error in these cases, or check that the results that are returned are correct.



---

archive/issue_events_159460.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-13T00:02:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159460"
}
```



---

archive/issue_events_159461.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-13T00:02:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159461"
}
```



---

archive/issue_comments_125999.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@loefflerd](#comment%3A19):\n> I'm not happy with this:\n\n...\n\n> I don't think we can merge this if we know or suspect that it gives incorrect results! We should either raise an error in these cases, or check that the results that are returned are correct.\n\nHi David,\n\nThis \"NOTE\" is just a warning that we added about the code as it was. It is not about a change that we are making. We decided to leave support for conics and elliptic curves intact, as people may be running a loop over general double covers, or not care too much.\n\nRemoving support for conics and elliptic curves would be something for a discussion on sage-nt, and then a new ticket. I can remove this note if you'd like, and leave the rest of the patch as it is. Would that be an improvement?\n\nMarco",
    "created_at": "2012-03-13T06:40:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-125999",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@loefflerd](#comment%3A19):
> I'm not happy with this:

...

> I don't think we can merge this if we know or suspect that it gives incorrect results! We should either raise an error in these cases, or check that the results that are returned are correct.

Hi David,

This "NOTE" is just a warning that we added about the code as it was. It is not about a change that we are making. We decided to leave support for conics and elliptic curves intact, as people may be running a loop over general double covers, or not care too much.

Removing support for conics and elliptic curves would be something for a discussion on sage-nt, and then a new ticket. I can remove this note if you'd like, and leave the rest of the patch as it is. Would that be an improvement?

Marco



---

archive/issue_events_159462.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-03-20T06:55:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159462"
}
```



---

archive/issue_events_159463.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2012-03-20T06:55:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159463"
}
```



---

archive/issue_comments_126000.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI tested this on Sage 4.8.\n\nThere is a method is_smooth() which can be applied to a hyperelliptic curve. With the patches applied:\n\n```\nsage: R.<x> = PolynomialRing(GF(3))\nsage: H=HyperellipticCurve(x^5+1)\nsage: H.is_singular()\nFalse\nsage: H.is_smooth()\nFalse\n```\n\nMaybe these two methods should give consistent results. The is_smooth() method seems to be defined in the class AlgebraicScheme_subscheme_projective in algebraic_scheme.py.",
    "created_at": "2012-05-04T22:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126000",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:22" align="right">comment:22</div>

I tested this on Sage 4.8.

There is a method is_smooth() which can be applied to a hyperelliptic curve. With the patches applied:

```
sage: R.<x> = PolynomialRing(GF(3))
sage: H=HyperellipticCurve(x^5+1)
sage: H.is_singular()
False
sage: H.is_smooth()
False
```

Maybe these two methods should give consistent results. The is_smooth() method seems to be defined in the class AlgebraicScheme_subscheme_projective in algebraic_scheme.py.



---

archive/issue_comments_126001.json:
```json
{
    "body": "Changed reviewer from **Marco Streng, Damiano Testa** to **Marco Streng, Damiano Testa, David Eklund**",
    "created_at": "2012-05-04T22:57:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126001",
    "user": "https://github.com/sagetrac-davideklund"
}
```

Changed reviewer from **Marco Streng, Damiano Testa** to **Marco Streng, Damiano Testa, David Eklund**



---

archive/issue_comments_126002.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A22):\n> Maybe these two methods should give consistent results.\n\nyes (go ahead)",
    "created_at": "2012-05-05T08:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126002",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@sagetrac-davideklund](#comment%3A22):
> Maybe these two methods should give consistent results.

yes (go ahead)



---

archive/issue_comments_126003.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@mstreng](#comment%3A23):\n> Replying to [@sagetrac-davideklund](#comment%3A22):\n> > Maybe these two methods should give consistent results.\n\n> \n> yes (go ahead)\n\n(to elaborate on this: I don't have time now, but yes, it would be good if is_smooth() always returns True for these curves)",
    "created_at": "2012-05-05T08:25:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126003",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@mstreng](#comment%3A23):
> Replying to [@sagetrac-davideklund](#comment%3A22):
> > Maybe these two methods should give consistent results.

> 
> yes (go ahead)

(to elaborate on this: I don't have time now, but yes, it would be good if is_smooth() always returns True for these curves)



---

archive/issue_comments_126004.json:
```json
{
    "body": "use this instead of 11930_is_singular.patch",
    "created_at": "2012-05-11T12:05:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126004",
    "user": "https://github.com/mstreng"
}
```

use this instead of 11930_is_singular.patch



---

archive/issue_comments_126005.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nAttachment: **[11930_is_singular2.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)**",
    "created_at": "2012-05-11T12:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126005",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:25" align="right">comment:25</div>

Attachment: **[11930_is_singular2.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)**



---

archive/issue_comments_126006.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,11 +7,13 @@\n sage: H=HyperellipticCurve(x^5+1)\n sage: H.is_singular()\n # used to return True, now returns False\n-sage: H=HyperellipticCurve(x^5)\n+sage: H.is_smooth()\n+# used to return False, now returns True\n+sage: HyperellipticCurve(x^5)\n # used to return a curve y^2 = x^5, now raises an error\n ```\n \n Apply\n \n * [attachment: 11930c.patch](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)\n-* [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)\n+* [attachment: 11930_is_singular2.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)\n``````\n",
    "created_at": "2012-05-11T12:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126006",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,11 +7,13 @@
 sage: H=HyperellipticCurve(x^5+1)
 sage: H.is_singular()
 # used to return True, now returns False
-sage: H=HyperellipticCurve(x^5)
+sage: H.is_smooth()
+# used to return False, now returns True
+sage: HyperellipticCurve(x^5)
 # used to return a curve y^2 = x^5, now raises an error
 ```
 
 Apply
 
 * [attachment: 11930c.patch](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)
-* [attachment: 11930_is_singular.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular.patch.gz)
+* [attachment: 11930_is_singular2.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)
``````




---

archive/issue_comments_126007.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A22):\n> Maybe these two methods should give consistent results.\n\nThanks, they do now. So the ticket needs review again.",
    "created_at": "2012-05-11T21:43:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126007",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@sagetrac-davideklund](#comment%3A22):
> Maybe these two methods should give consistent results.

Thanks, they do now. So the ticket needs review again.



---

archive/issue_comments_126008.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@mstreng](#comment%3A26):\n> Replying to [@sagetrac-davideklund](#comment%3A22):\n> > Maybe these two methods should give consistent results.\n\n> \n> Thanks, they do now. So the ticket needs review again.\n\nOk, nice. I'm on it!",
    "created_at": "2012-05-13T16:04:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126008",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@mstreng](#comment%3A26):
> Replying to [@sagetrac-davideklund](#comment%3A22):
> > Maybe these two methods should give consistent results.

> 
> Thanks, they do now. So the ticket needs review again.

Ok, nice. I'm on it!



---

archive/issue_comments_126009.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nApply 11930c.patch and 11930_is_singular2.patch",
    "created_at": "2012-05-13T16:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126009",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:28" align="right">comment:28</div>

Apply 11930c.patch and 11930_is_singular2.patch



---

archive/issue_comments_126010.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThese patches look good. I'll be back in a few days after having looked a bit more on the details.\n\nIn the meantime, here is a question/issue: when I apply 11930c.patch using Sage 5.0 (on OS X lion 10.7.3) I get the following:\n\n`patching file sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py`\\\\\n`Hunk #8 succeeded at 653 with fuzz 1 (offset 95 lines).`\n\nI'm not sure what this means or how to get rid off the fuzz.",
    "created_at": "2012-05-17T20:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126010",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:29" align="right">comment:29</div>

These patches look good. I'll be back in a few days after having looked a bit more on the details.

In the meantime, here is a question/issue: when I apply 11930c.patch using Sage 5.0 (on OS X lion 10.7.3) I get the following:

`patching file sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py`\\
`Hunk #8 succeeded at 653 with fuzz 1 (offset 95 lines).`

I'm not sure what this means or how to get rid off the fuzz.



---

archive/issue_comments_126011.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A29):\n> I'm not sure what this means or how to get rid off the fuzz.\n\nWhen applying the patch, mercurial will look for a certain block of code and replace it by another. The code to look for also has three surrounding unchanged lines on each side. Fuzz means that there is a slight mismatch in the surrounding code, due to changes in Sage between after I wrote the patch. More precisely, fuzz n means that a block can only be matched if the outermost n lines of the surrounding code are ignored. I've seen patches be rejected because of fuzz 2, but I think fuzz 1 is fine: there are still 2 lines unchanged around every patched line.\n\nIn this particular case, it means that a doctest nearby one of the changed doctests in hyperelliptic_finite_field.py has changed since I wrote the patch.\n\nTo get rid of the fuzz, the patch can be rebased (apply to latest version, then qrefresh and export), but I don't think it is necessary with fuzz 1.",
    "created_at": "2012-05-18T08:28:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126011",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@sagetrac-davideklund](#comment%3A29):
> I'm not sure what this means or how to get rid off the fuzz.

When applying the patch, mercurial will look for a certain block of code and replace it by another. The code to look for also has three surrounding unchanged lines on each side. Fuzz means that there is a slight mismatch in the surrounding code, due to changes in Sage between after I wrote the patch. More precisely, fuzz n means that a block can only be matched if the outermost n lines of the surrounding code are ignored. I've seen patches be rejected because of fuzz 2, but I think fuzz 1 is fine: there are still 2 lines unchanged around every patched line.

In this particular case, it means that a doctest nearby one of the changed doctests in hyperelliptic_finite_field.py has changed since I wrote the patch.

To get rid of the fuzz, the patch can be rebased (apply to latest version, then qrefresh and export), but I don't think it is necessary with fuzz 1.



---

archive/issue_comments_126012.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@mstreng](#comment%3A30):\n\nOk. Thank you for that explanation.\n\n> Replying to [@sagetrac-davideklund](#comment%3A29):\n> > I'm not sure what this means or how to get rid off the fuzz.\n\n> \n> When applying the patch, mercurial will look for a certain block of code and replace it by another. The code to look for also has three surrounding unchanged lines on each side. Fuzz means that there is a slight mismatch in the surrounding code, due to changes in Sage between after I wrote the patch. More precisely, fuzz n means that a block can only be matched if the outermost n lines of the surrounding code are ignored. I've seen patches be rejected because of fuzz 2, but I think fuzz 1 is fine: there are still 2 lines unchanged around every patched line.\n> \n> In this particular case, it means that a doctest nearby one of the changed doctests in hyperelliptic_finite_field.py has changed since I wrote the patch.\n> \n> To get rid of the fuzz, the patch can be rebased (apply to latest version, then qrefresh and export), but I don't think it is necessary with fuzz 1.\n\n>",
    "created_at": "2012-05-18T16:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126012",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@mstreng](#comment%3A30):

Ok. Thank you for that explanation.

> Replying to [@sagetrac-davideklund](#comment%3A29):
> > I'm not sure what this means or how to get rid off the fuzz.

> 
> When applying the patch, mercurial will look for a certain block of code and replace it by another. The code to look for also has three surrounding unchanged lines on each side. Fuzz means that there is a slight mismatch in the surrounding code, due to changes in Sage between after I wrote the patch. More precisely, fuzz n means that a block can only be matched if the outermost n lines of the surrounding code are ignored. I've seen patches be rejected because of fuzz 2, but I think fuzz 1 is fine: there are still 2 lines unchanged around every patched line.
> 
> In this particular case, it means that a doctest nearby one of the changed doctests in hyperelliptic_finite_field.py has changed since I wrote the patch.
> 
> To get rid of the fuzz, the patch can be rebased (apply to latest version, then qrefresh and export), but I don't think it is necessary with fuzz 1.

>



---

archive/issue_comments_126013.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nHere are two more beginner questions related to these patches: \n\nI have a recurring doc-test failure (Sage 5.0 on Mac OS lion) so I can't really doc-test these patches locally without failures. But I interpret what the patch-bot has done on this ticket as sufficient for a positive review as far as doc-testing goes (it seems that all tests pass). Sounds reasonable?\n\nThe patch-bot's blue blob and the \"plug-in failed\" I believe is only about trailing white space, and therefore harmless. Sounds reasonable?",
    "created_at": "2012-05-18T16:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126013",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:32" align="right">comment:32</div>

Here are two more beginner questions related to these patches: 

I have a recurring doc-test failure (Sage 5.0 on Mac OS lion) so I can't really doc-test these patches locally without failures. But I interpret what the patch-bot has done on this ticket as sufficient for a positive review as far as doc-testing goes (it seems that all tests pass). Sounds reasonable?

The patch-bot's blue blob and the "plug-in failed" I believe is only about trailing white space, and therefore harmless. Sounds reasonable?



---

archive/issue_comments_126014.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A32):\n> Here are two more beginner questions related to these patches: \n\nIt may be better to ask these in email or on the mailing lists, but I'll just answer them anyway.\n\n>\n> I have a recurring doc-test failure (Sage 5.0 on Mac OS lion) so I can't really doc-test these patches locally without failures. But I interpret what the patch-bot has done on this ticket as sufficient for a positive review as far as doc-testing goes (it seems that all tests pass). Sounds reasonable?\n\nI'm not sure whether just using the patchbot is ok. According to the [developer's guide](http://www.sagemath.org/doc/developer/walk_through.html#reviewing-a-patch), you are supposed to run the tests marked \"#long\" as well, and I don't see where the patchbot does this.\n\nAs for your failing tests, any tests that fail on an unpatched Sage can be safely ignored, they are not due to the patch.\n\n>\n> The patch-bot's blue blob and the \"plug-in failed\" I believe is only about trailing white space, and therefore harmless. Sounds reasonable?\n\nIn this particular case, it is ok.\n\nIn detail: it seems that many people are very annoyed by trailing whitespaces on non-empty lines (see [here](http://groups.google.com/group/sage-devel/browse_thread/thread/f6a783b3a52bfa5d/30809dba7cfb13dd)), hence don't want any new ones to be introduced. That's probably where the plugin came from in the first place. In any case, I just checked and this patch does not introduce any new trailing whitespaces on non-empty lines. I did change two lines that already had trailing whitespaces, which I didn't notice, so I did not remove them. That's where the plugin warning comes from.",
    "created_at": "2012-05-18T16:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126014",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@sagetrac-davideklund](#comment%3A32):
> Here are two more beginner questions related to these patches: 

It may be better to ask these in email or on the mailing lists, but I'll just answer them anyway.

>
> I have a recurring doc-test failure (Sage 5.0 on Mac OS lion) so I can't really doc-test these patches locally without failures. But I interpret what the patch-bot has done on this ticket as sufficient for a positive review as far as doc-testing goes (it seems that all tests pass). Sounds reasonable?

I'm not sure whether just using the patchbot is ok. According to the [developer's guide](http://www.sagemath.org/doc/developer/walk_through.html#reviewing-a-patch), you are supposed to run the tests marked "#long" as well, and I don't see where the patchbot does this.

As for your failing tests, any tests that fail on an unpatched Sage can be safely ignored, they are not due to the patch.

>
> The patch-bot's blue blob and the "plug-in failed" I believe is only about trailing white space, and therefore harmless. Sounds reasonable?

In this particular case, it is ok.

In detail: it seems that many people are very annoyed by trailing whitespaces on non-empty lines (see [here](http://groups.google.com/group/sage-devel/browse_thread/thread/f6a783b3a52bfa5d/30809dba7cfb13dd)), hence don't want any new ones to be introduced. That's probably where the plugin came from in the first place. In any case, I just checked and this patch does not introduce any new trailing whitespaces on non-empty lines. I did change two lines that already had trailing whitespaces, which I didn't notice, so I did not remove them. That's where the plugin warning comes from.



---

archive/issue_comments_126015.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nAll tests pass except one which fails on an unaltered Sage 5.0 (on OS X 10.7.3). \n\nThe failure was with \"rings/polynomial/pbori.pyx\" and the tests are not flagged # long time and so are covered by the tests run by the patchbot on this ticket.",
    "created_at": "2012-05-19T22:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126015",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:34" align="right">comment:34</div>

All tests pass except one which fails on an unaltered Sage 5.0 (on OS X 10.7.3). 

The failure was with "rings/polynomial/pbori.pyx" and the tests are not flagged # long time and so are covered by the tests run by the patchbot on this ticket.



---

archive/issue_comments_126016.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThis all looks good. If the other reviewers agree, we can change the status to positive review.\n\nI only have two small comments on the patches:\n\nAbout the example beginning with \"A hyperelliptic curve should not be given by polynomials of degree greater than `2g+2`, where `g` is the genus.\" I'm not sure I understand what this means. The genus of what? It is slightly unclear since I gather that in this example there is no hyperelliptic curve whose genus we could be referring to. Is it the genus of the desingularization of the corresponding plane curve? The way I view this, the equation `y^2+hy=f`, where `h=x^100` and `f=x<sup>6+1-h</sup>2/4` (appropriately homogenized with `z`) defines a curve in weighted projected space `P(1,100,1)` but that curve is singular at the point `(x,y,z)=(1,-1/2,0)`.\n\nAbout the example beginning \"Input with integer coefficients creates objects with the integers as base ring, but only checks smoothness over `QQ`, not `ZZ`\". Is this to be interpreted as saying that the example provided is not smooth as a scheme over `Spec(ZZ)`?",
    "created_at": "2012-05-20T04:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126016",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:35" align="right">comment:35</div>

This all looks good. If the other reviewers agree, we can change the status to positive review.

I only have two small comments on the patches:

About the example beginning with "A hyperelliptic curve should not be given by polynomials of degree greater than `2g+2`, where `g` is the genus." I'm not sure I understand what this means. The genus of what? It is slightly unclear since I gather that in this example there is no hyperelliptic curve whose genus we could be referring to. Is it the genus of the desingularization of the corresponding plane curve? The way I view this, the equation `y^2+hy=f`, where `h=x^100` and `f=x<sup>6+1-h</sup>2/4` (appropriately homogenized with `z`) defines a curve in weighted projected space `P(1,100,1)` but that curve is singular at the point `(x,y,z)=(1,-1/2,0)`.

About the example beginning "Input with integer coefficients creates objects with the integers as base ring, but only checks smoothness over `QQ`, not `ZZ`". Is this to be interpreted as saying that the example provided is not smooth as a scheme over `Spec(ZZ)`?



---

archive/issue_comments_126017.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A35):\n> I only have two small comments on the patches:\n\nI don't want the documentation to be confusing, so I'll address your comments and post a new patch.\n\n> \n> About the example beginning with \"A hyperelliptic curve should not be given by polynomials of degree greater than `2g+2`, where `g` is the genus.\" I'm not sure I understand what this means. The genus of what? It is slightly unclear since I gather that in this example there is no hyperelliptic curve whose genus we could be referring to. Is it the genus of the desingularization of the corresponding plane curve?\n\nYes, I will explain that better.\n\n> The way I view this, the equation `y^2+hy=f`, where `h=x^100` and `f=x<sup>6+1-h</sup>2/4` (appropriately homogenized with `z`) defines a curve in weighted projected space `P(1,100,1)` but that curve is singular at the point `(x,y,z)=(1,-1/2,0)`.\n\nYes, and we should not allow that.\n\n> About the example beginning \"Input with integer coefficients creates objects with the integers as base ring, but only checks smoothness over `QQ`, not `ZZ`\". Is this to be interpreted as saying that the example provided is not smooth as a scheme over `Spec(ZZ)`?\n\nYes. But I see that Spec(ZZ) may confuse or scare people, so I will clarify this.",
    "created_at": "2012-05-21T08:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126017",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@sagetrac-davideklund](#comment%3A35):
> I only have two small comments on the patches:

I don't want the documentation to be confusing, so I'll address your comments and post a new patch.

> 
> About the example beginning with "A hyperelliptic curve should not be given by polynomials of degree greater than `2g+2`, where `g` is the genus." I'm not sure I understand what this means. The genus of what? It is slightly unclear since I gather that in this example there is no hyperelliptic curve whose genus we could be referring to. Is it the genus of the desingularization of the corresponding plane curve?

Yes, I will explain that better.

> The way I view this, the equation `y^2+hy=f`, where `h=x^100` and `f=x<sup>6+1-h</sup>2/4` (appropriately homogenized with `z`) defines a curve in weighted projected space `P(1,100,1)` but that curve is singular at the point `(x,y,z)=(1,-1/2,0)`.

Yes, and we should not allow that.

> About the example beginning "Input with integer coefficients creates objects with the integers as base ring, but only checks smoothness over `QQ`, not `ZZ`". Is this to be interpreted as saying that the example provided is not smooth as a scheme over `Spec(ZZ)`?

Yes. But I see that Spec(ZZ) may confuse or scare people, so I will clarify this.



---

archive/issue_comments_126018.json:
```json
{
    "body": "replaces 11930c.patch: rebased on top of 5.0.beta14, removed trailing whitespaces, clarified examples",
    "created_at": "2012-05-21T09:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126018",
    "user": "https://github.com/mstreng"
}
```

replaces 11930c.patch: rebased on top of 5.0.beta14, removed trailing whitespaces, clarified examples



---

archive/issue_comments_126019.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,5 +15,5 @@\n \n Apply\n \n-* [attachment: 11930c.patch](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)\n+* [attachment: 11930d.patch](https://github.com/sagemath/sage/files/ticket11930/11930d.patch.gz)\n * [attachment: 11930_is_singular2.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)\n``````\n",
    "created_at": "2012-05-21T09:40:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126019",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,5 +15,5 @@
 
 Apply
 
-* [attachment: 11930c.patch](https://github.com/sagemath/sage/files/ticket11930/11930c.patch.gz)
+* [attachment: 11930d.patch](https://github.com/sagemath/sage/files/ticket11930/11930d.patch.gz)
 * [attachment: 11930_is_singular2.patch](https://github.com/sagemath/sage/files/ticket11930/11930_is_singular2.patch.gz)
``````




---

archive/issue_comments_126020.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nAttachment: **[11930d.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930d.patch.gz)**\n\nHere's a diff between the c and d patches, excluding changed line numbers and hashes:\n\n```\n< +    This class also allows curves of genus zero or one, which are stricly\n> +    This class also allows curves of genus zero or one, which are strictly\n126,127c126,130\n< +    A hyperelliptic curve should not be given by polynomials of degree greater\n< +    than `2g+2`, where `g` is the genus.::\n> +    The input for a (smooth) hyperelliptic curve of genus `g` should not\n> +    contain polynomials of degree greater than `2g+2`. In the following\n> +    example, the hyperelliptic curve has genus 2 and there exists a model\n> +    `y^2 = F` of degree 6, so the model `y^2 + yh = f` of degree 200 is not\n> +    allowed.::\n137c140\n< +        \n> +\n152c155,157\n< +    as base ring, but only checks smoothness over `QQ`, not `ZZ`::\n---\n> +    as base ring, but only checks smoothness over `\\QQ`, not over Spec(`\\ZZ`).\n> +    In other words, it is checked that the discriminant is non-zero, but it is\n> +    not checked whether the discriminant is a unit in `\\ZZ^*`.::\n155,156c160,161\n< +        sage: HyperellipticCurve(4*x^7+8*x+8)\n< +        Hyperelliptic Curve over Integer Ring defined by y^2 = 4*x^7 + 8*x + 8\n> +        sage: HyperellipticCurve(3*x^7+6*x+6)\n> +        Hyperelliptic Curve over Integer Ring defined by y^2 = 3*x^7 + 6*x + 6\n264c269\n< +            ValueError: curve is not smooth    \n> +            ValueError: curve is not smooth\n273c278\n< +            raise ValueError, \"curve is not smooth\"   \n> +            raise ValueError, \"curve is not smooth\"\n308c313\n<          #checking first that Cartier matrix is not already cached. Since it can be called by either Hasse_Witt or a_number\n>          #checking first that Cartier matrix is not already cached. Since\n```\n\nApply 11930d.patch and then 11930_is_singular2.patch",
    "created_at": "2012-05-21T09:40:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126020",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:37" align="right">comment:37</div>

Attachment: **[11930d.patch.gz](https://github.com/sagemath/sage/files/ticket11930/11930d.patch.gz)**

Here's a diff between the c and d patches, excluding changed line numbers and hashes:

```
< +    This class also allows curves of genus zero or one, which are stricly
> +    This class also allows curves of genus zero or one, which are strictly
126,127c126,130
< +    A hyperelliptic curve should not be given by polynomials of degree greater
< +    than `2g+2`, where `g` is the genus.::
> +    The input for a (smooth) hyperelliptic curve of genus `g` should not
> +    contain polynomials of degree greater than `2g+2`. In the following
> +    example, the hyperelliptic curve has genus 2 and there exists a model
> +    `y^2 = F` of degree 6, so the model `y^2 + yh = f` of degree 200 is not
> +    allowed.::
137c140
< +        
> +
152c155,157
< +    as base ring, but only checks smoothness over `QQ`, not `ZZ`::
---
> +    as base ring, but only checks smoothness over `\QQ`, not over Spec(`\ZZ`).
> +    In other words, it is checked that the discriminant is non-zero, but it is
> +    not checked whether the discriminant is a unit in `\ZZ^*`.::
155,156c160,161
< +        sage: HyperellipticCurve(4*x^7+8*x+8)
< +        Hyperelliptic Curve over Integer Ring defined by y^2 = 4*x^7 + 8*x + 8
> +        sage: HyperellipticCurve(3*x^7+6*x+6)
> +        Hyperelliptic Curve over Integer Ring defined by y^2 = 3*x^7 + 6*x + 6
264c269
< +            ValueError: curve is not smooth    
> +            ValueError: curve is not smooth
273c278
< +            raise ValueError, "curve is not smooth"   
> +            raise ValueError, "curve is not smooth"
308c313
<          #checking first that Cartier matrix is not already cached. Since it can be called by either Hasse_Witt or a_number
>          #checking first that Cartier matrix is not already cached. Since
```

Apply 11930d.patch and then 11930_is_singular2.patch



---

archive/issue_comments_126021.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A35):\n> This all looks good. If the other reviewers agree, we can change the status to positive review.\n\nThe other reviewers are the authors of the current version, so you don't need to consult us (we are the ones who set this to \"needs review\" in the first place). If you agree with the new patch, you can set it to \"positive review\" yourself.",
    "created_at": "2012-05-21T09:42:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126021",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@sagetrac-davideklund](#comment%3A35):
> This all looks good. If the other reviewers agree, we can change the status to positive review.

The other reviewers are the authors of the current version, so you don't need to consult us (we are the ones who set this to "needs review" in the first place). If you agree with the new patch, you can set it to "positive review" yourself.



---

archive/issue_comments_126022.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nNice! Those extra comments in the examples really clarified things (for me at least).",
    "created_at": "2012-05-22T00:34:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126022",
    "user": "https://github.com/sagetrac-davideklund"
}
```

<div id="comment:39" align="right">comment:39</div>

Nice! Those extra comments in the examples really clarified things (for me at least).



---

archive/issue_events_159464.json:
```json
{
    "actor": "https://github.com/sagetrac-davideklund",
    "created_at": "2012-05-22T00:34:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159464"
}
```



---

archive/issue_events_159465.json:
```json
{
    "actor": "https://github.com/sagetrac-davideklund",
    "created_at": "2012-05-22T00:34:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159465"
}
```



---

archive/issue_comments_126023.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@sagetrac-davideklund](#comment%3A39).\n\nThanks!",
    "created_at": "2012-05-22T08:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126023",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@sagetrac-davideklund](#comment%3A39).

Thanks!



---

archive/issue_comments_126024.json:
```json
{
    "body": "Merged: **sage-5.1.beta2**",
    "created_at": "2012-06-02T12:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11930#issuecomment-126024",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.1.beta2**



---

archive/issue_events_159466.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:10:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159466"
}
```



---

archive/issue_events_159467.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:10:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11930",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11930#event-159467"
}
```
