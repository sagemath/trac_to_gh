# Issue 11072: In python-2.7 deprecation warnings are not shown to the user by default

archive/issues_011072.json:
```json
{
    "body": "Assignee: jason\n\nCC:  kini\n\nIn python 2.7 deprecation warnings are a developer only feature. Which mean that sage's deprecation warnings are not shown either. A previous patch in #9958 only re-enable deprecation warnings in doctests but not in regular sage sessions.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11244\n\n",
    "created_at": "2011-04-24T03:36:56Z",
    "labels": [
        "misc",
        "major",
        "bug"
    ],
    "title": "In python-2.7 deprecation warnings are not shown to the user by default",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11072",
    "user": "fbissey"
}
```
Assignee: jason

CC:  kini

In python 2.7 deprecation warnings are a developer only feature. Which mean that sage's deprecation warnings are not shown either. A previous patch in #9958 only re-enable deprecation warnings in doctests but not in regular sage sessions.

Issue created by migration from https://trac.sagemath.org/ticket/11244





---

archive/issue_comments_120824.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-24T03:46:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120824",
    "user": "fbissey"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_120825.json:
```json
{
    "body": "Attachment [trac_11244_reenable_deprecationwarnings_in_python27.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_reenable_deprecationwarnings_in_python27.patch) by fbissey created at 2011-04-24 03:52:02\n\nnew patch to restore deprecation warnings in python 2.7 (now in git format)",
    "created_at": "2011-04-24T03:52:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120825",
    "user": "fbissey"
}
```

Attachment [trac_11244_reenable_deprecationwarnings_in_python27.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_reenable_deprecationwarnings_in_python27.patch) by fbissey created at 2011-04-24 03:52:02

new patch to restore deprecation warnings in python 2.7 (now in git format)



---

archive/issue_comments_120826.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-24T04:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120826",
    "user": "fbissey"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120827.json:
```json
{
    "body": "There is an issue with\n\n```\nsage -t -force_lib \"devel/sage-main/sage/combinat/partition.py\"\n**********************************************************************\nFile \"/usr/share/sage/devel/sage-main/sage/combinat/partition.py\", line 2511:\n    sage: RestrictedPartitions(5,[3,2,1])\nExpected:\n    doctest:...: DeprecationWarning: RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.\n    doctest:...: DeprecationWarning: RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.\n    Partitions of 5 restricted to the values [1, 2, 3]\nGot:\n    doctest:260: DeprecationWarning: RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.\n    Partitions of 5 restricted to the values [1, 2, 3] \n```\n\nBut clearly I am not sure why the original code should give both a warning and a deprecation warning. Of course my patch only let sage display the later.",
    "created_at": "2011-04-24T04:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120827",
    "user": "fbissey"
}
```

There is an issue with

```
sage -t -force_lib "devel/sage-main/sage/combinat/partition.py"
**********************************************************************
File "/usr/share/sage/devel/sage-main/sage/combinat/partition.py", line 2511:
    sage: RestrictedPartitions(5,[3,2,1])
Expected:
    doctest:...: DeprecationWarning: RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.
    doctest:...: DeprecationWarning: RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.
    Partitions of 5 restricted to the values [1, 2, 3]
Got:
    doctest:260: DeprecationWarning: RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.
    Partitions of 5 restricted to the values [1, 2, 3] 
```

But clearly I am not sure why the original code should give both a warning and a deprecation warning. Of course my patch only let sage display the later.



---

archive/issue_comments_120828.json:
```json
{
    "body": "The code in question\n\n```\n    import warnings\n    warnings.warn('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)\n    from sage.misc.misc import deprecation\n    deprecation('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.')\n    return RestrictedPartitions_nsk(n, S, k)\n```\n",
    "created_at": "2011-04-24T04:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120828",
    "user": "fbissey"
}
```

The code in question

```
    import warnings
    warnings.warn('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)
    from sage.misc.misc import deprecation
    deprecation('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.')
    return RestrictedPartitions_nsk(n, S, k)
```




---

archive/issue_comments_120829.json:
```json
{
    "body": "I see that in fact there are are two related functions being deprecated and this is a way to warn for both at the same time.",
    "created_at": "2011-04-24T23:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120829",
    "user": "fbissey"
}
```

I see that in fact there are are two related functions being deprecated and this is a way to warn for both at the same time.



---

archive/issue_comments_120830.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-25T00:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120830",
    "user": "fbissey"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120831.json:
```json
{
    "body": "Patch to reenable extra deprecation warning in sage/combinat/partition.py.",
    "created_at": "2011-04-25T01:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120831",
    "user": "fbissey"
}
```

Patch to reenable extra deprecation warning in sage/combinat/partition.py.



---

archive/issue_comments_120832.json:
```json
{
    "body": "Attachment [trac_11244_fix_combinatpartition_warnings.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_fix_combinatpartition_warnings.patch) by fbissey created at 2011-04-25 01:16:11\n\nFixing my mistaken assumptions about warnings in general.",
    "created_at": "2011-04-25T01:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120832",
    "user": "fbissey"
}
```

Attachment [trac_11244_fix_combinatpartition_warnings.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_fix_combinatpartition_warnings.patch) by fbissey created at 2011-04-25 01:16:11

Fixing my mistaken assumptions about warnings in general.



---

archive/issue_comments_120833.json:
```json
{
    "body": "There are more deprecation warnings issued by the standard python mechanism rather than sage's mechanism\n\n```\nsage-4.7.alpha1 $ grep -r DeprecationWarning\\,\\ stacklevel *\nsage/matrix/constructor.py:                    warnings.warn(\"invocation of block_matrix with just a list whose length is a perfect square is deprecated. See the documentation for details.\", DeprecationWarning, stacklevel=2)\nsage/combinat/partition.py:    warnings.warn('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)\nsage/combinat/partition.py:        warnings.warn('RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)\nsage/groups/perm_gps/permgroup.py:        warnings.warn('quotient_group() is deprecated; use quotient() instead.', DeprecationWarning, stacklevel=2)\nsage/graphs/base/graph_backends.py:                    DeprecationWarning, stacklevel=2)\nsage/graphs/base/graph_backends.py:                    DeprecationWarning, stacklevel=2)\nsage/misc/misc.py:    warn(message, DeprecationWarning, stacklevel=3)\n```\n",
    "created_at": "2011-04-25T01:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120833",
    "user": "fbissey"
}
```

There are more deprecation warnings issued by the standard python mechanism rather than sage's mechanism

```
sage-4.7.alpha1 $ grep -r DeprecationWarning\,\ stacklevel *
sage/matrix/constructor.py:                    warnings.warn("invocation of block_matrix with just a list whose length is a perfect square is deprecated. See the documentation for details.", DeprecationWarning, stacklevel=2)
sage/combinat/partition.py:    warnings.warn('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)
sage/combinat/partition.py:        warnings.warn('RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)
sage/groups/perm_gps/permgroup.py:        warnings.warn('quotient_group() is deprecated; use quotient() instead.', DeprecationWarning, stacklevel=2)
sage/graphs/base/graph_backends.py:                    DeprecationWarning, stacklevel=2)
sage/graphs/base/graph_backends.py:                    DeprecationWarning, stacklevel=2)
sage/misc/misc.py:    warn(message, DeprecationWarning, stacklevel=3)
```




---

archive/issue_comments_120834.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-25T01:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120834",
    "user": "fbissey"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120835.json:
```json
{
    "body": "3 more files fixed. double messaging removed in two of them. [rebased on 4.7.alpha5]",
    "created_at": "2011-04-25T11:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120835",
    "user": "fbissey"
}
```

3 more files fixed. double messaging removed in two of them. [rebased on 4.7.alpha5]



---

archive/issue_comments_120836.json:
```json
{
    "body": "Attachment [trac_11244_fixmoredeprecationswarnings.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_fixmoredeprecationswarnings.patch) by fbissey created at 2011-04-25 19:42:40",
    "created_at": "2011-04-25T19:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120836",
    "user": "fbissey"
}
```

Attachment [trac_11244_fixmoredeprecationswarnings.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_fixmoredeprecationswarnings.patch) by fbissey created at 2011-04-25 19:42:40



---

archive/issue_comments_120837.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-25T19:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120837",
    "user": "fbissey"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120838.json:
```json
{
    "body": "Use this patch if you base your review on 4.7.1.alpha1",
    "created_at": "2011-05-18T22:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120838",
    "user": "fbissey"
}
```

Use this patch if you base your review on 4.7.1.alpha1



---

archive/issue_comments_120839.json:
```json
{
    "body": "Attachment [trac_11244_fixmoredeprecationswarnings.2.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_fixmoredeprecationswarnings.2.patch) by fbissey created at 2011-05-30 03:18:16",
    "created_at": "2011-05-30T03:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120839",
    "user": "fbissey"
}
```

Attachment [trac_11244_fixmoredeprecationswarnings.2.patch](tarball://root/attachments/some-uuid/ticket11244/trac_11244_fixmoredeprecationswarnings.2.patch) by fbissey created at 2011-05-30 03:18:16



---

archive/issue_comments_120840.json:
```json
{
    "body": "Patches applied to sage-4.7.1.alpha2, then did 'sage -b', followed by 'make testlong'.  All tests passed.  Positive review!",
    "created_at": "2011-06-15T13:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120840",
    "user": "mariah"
}
```

Patches applied to sage-4.7.1.alpha2, then did 'sage -b', followed by 'make testlong'.  All tests passed.  Positive review!



---

archive/issue_comments_120841.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-06-15T13:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120841",
    "user": "mariah"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_120842.json:
```json
{
    "body": "Thank you Mariah for the review. Thank you John for the suggestion to make it better. Thank you Steve for pointing the obvious.\n\nThank you all for making this reach this stage.",
    "created_at": "2011-06-15T13:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120842",
    "user": "fbissey"
}
```

Thank you Mariah for the review. Thank you John for the suggestion to make it better. Thank you Steve for pointing the obvious.

Thank you all for making this reach this stage.



---

archive/issue_comments_120843.json:
```json
{
    "body": "Removing the work issue as it was in fact dealt with.",
    "created_at": "2011-06-18T20:29:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120843",
    "user": "fbissey"
}
```

Removing the work issue as it was in fact dealt with.



---

archive/issue_comments_120844.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-07-22T12:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120844",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_120845.json:
```json
{
    "body": "(for another ticket) maybe it would be best if we subclassed the warnings to all inherit from a SageWarning class, and then turn on just Sage warnings...",
    "created_at": "2011-07-22T14:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11072#issuecomment-120845",
    "user": "jason"
}
```

(for another ticket) maybe it would be best if we subclassed the warnings to all inherit from a SageWarning class, and then turn on just Sage warnings...
