# Issue 11072: In python-2.7 deprecation warnings are not shown to the user by default

Issue created by migration from Trac.

Original creator: fbissey

Original creation time: 2011-04-24 03:36:56

Assignee: jason

CC:  kini

In python 2.7 deprecation warnings are a developer only feature. Which mean that sage's deprecation warnings are not shown either. A previous patch in #9958 only re-enable deprecation warnings in doctests but not in regular sage sessions.


---

Comment by fbissey created at 2011-04-24 03:46:56

Changing status from new to needs_review.


---

Attachment

new patch to restore deprecation warnings in python 2.7 (now in git format)


---

Comment by fbissey created at 2011-04-24 04:26:35

Changing status from needs_review to needs_work.


---

Comment by fbissey created at 2011-04-24 04:26:35

There is an issue with

```
sage -t -force_lib "devel/sage-main/sage/combinat/partition.py"
**********************************************************************
File "/usr/share/sage/devel/sage-main/sage/combinat/partition.py", line 2511:
    sage: RestrictedPartitions(5,[3,2,1])
Expected:
    doctest:...: DeprecationWarning: RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.
    doctest:...: DeprecationWarning: RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.
    Partitions of 5 restricted to the values [1, 2, 3]
Got:
    doctest:260: DeprecationWarning: RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.
    Partitions of 5 restricted to the values [1, 2, 3] 
```

But clearly I am not sure why the original code should give both a warning and a deprecation warning. Of course my patch only let sage display the later.


---

Comment by fbissey created at 2011-04-24 04:28:00

The code in question

```
    import warnings
    warnings.warn('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)
    from sage.misc.misc import deprecation
    deprecation('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.')
    return RestrictedPartitions_nsk(n, S, k)
```



---

Comment by fbissey created at 2011-04-24 23:40:55

I see that in fact there are are two related functions being deprecated and this is a way to warn for both at the same time.


---

Comment by fbissey created at 2011-04-25 00:46:07

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2011-04-25 01:15:16

Patch to reenable extra deprecation warning in sage/combinat/partition.py.


---

Attachment

Fixing my mistaken assumptions about warnings in general.


---

Comment by fbissey created at 2011-04-25 01:34:48

There are more deprecation warnings issued by the standard python mechanism rather than sage's mechanism

```
sage-4.7.alpha1 $ grep -r DeprecationWarning\,\ stacklevel *
sage/matrix/constructor.py:                    warnings.warn("invocation of block_matrix with just a list whose length is a perfect square is deprecated. See the documentation for details.", DeprecationWarning, stacklevel=2)
sage/combinat/partition.py:    warnings.warn('RestrictedPartitions is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)
sage/combinat/partition.py:        warnings.warn('RestrictedPartitions_nsk is deprecated; use Partitions with the parts_in keyword instead.', DeprecationWarning, stacklevel=2)
sage/groups/perm_gps/permgroup.py:        warnings.warn('quotient_group() is deprecated; use quotient() instead.', DeprecationWarning, stacklevel=2)
sage/graphs/base/graph_backends.py:                    DeprecationWarning, stacklevel=2)
sage/graphs/base/graph_backends.py:                    DeprecationWarning, stacklevel=2)
sage/misc/misc.py:    warn(message, DeprecationWarning, stacklevel=3)
```



---

Comment by fbissey created at 2011-04-25 01:34:48

Changing status from needs_review to needs_work.


---

Comment by fbissey created at 2011-04-25 11:23:36

3 more files fixed. double messaging removed in two of them. [rebased on 4.7.alpha5]


---

Attachment


---

Comment by fbissey created at 2011-04-25 19:42:40

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2011-05-18 22:54:50

Use this patch if you base your review on 4.7.1.alpha1


---

Attachment


---

Comment by mariah created at 2011-06-15 13:37:48

Patches applied to sage-4.7.1.alpha2, then did 'sage -b', followed by 'make testlong'.  All tests passed.  Positive review!


---

Comment by mariah created at 2011-06-15 13:37:48

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2011-06-15 13:44:06

Thank you Mariah for the review. Thank you John for the suggestion to make it better. Thank you Steve for pointing the obvious.

Thank you all for making this reach this stage.


---

Comment by fbissey created at 2011-06-18 20:29:04

Removing the work issue as it was in fact dealt with.


---

Comment by jdemeyer created at 2011-07-22 12:50:38

Resolution: fixed


---

Comment by jason created at 2011-07-22 14:59:20

(for another ticket) maybe it would be best if we subclassed the warnings to all inherit from a SageWarning class, and then turn on just Sage warnings...
