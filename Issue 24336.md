# Issue 24336: bug in creating graphic matroid with explicit groundset labels

Issue created by migration from Trac.

Original creator: dimpase

Original creation time: 2018-01-19 18:38:49

CC:  stefan rudi zgershkoff

with the branch in #24512, which changes the implementation of WheelGraph, one has

```
sage: M = Matroid(range(8),graphs.WheelGraph(5))
sage: M.graphic_coextension(0,X=[1,2])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-38-f3164ab7cc54> in <module>()
----> 1 M.graphic_coextension(Integer(0),X=[Integer(1),Integer(2)])

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/graphic_matroid.pyc in graphic_coextension(self, u, v, X, element)
   1593         edgelist = self.groundset_to_edges(X)
   1594 
-> 1595         split_vertex(G, u, v, edgelist)
   1596         G.add_edge(u, v, element)
   1597 

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/utilities.pyc in split_vertex(G, u, v, edges)
    773                 G.delete_edge(e)
    774             else:
--> 775                 raise ValueError("the edges are not all incident with u")
    776 
    777         elif e[0] == u:

ValueError: the edges are not all incident with u
```

which indicates an inconsistency in creation of M.
Indeed, the following works:

```
sage: M = Matroid(graphs.WheelGraph(5))
sage: M.graphic_coextension(0,X=[(0,2),(0,3)])
Graphic matroid of rank 5 on 9 elements
```



---

Comment by dimpase created at 2018-01-20 00:10:52

isn't there a documentation bug:
Currently one only sees

```
   A coextension in a graphic matroid is the opposite of contracting
   an edge; that is, vertices are merged, and a new edge is added
   between them. This method will split a vertex, and move the edges
   indicated by "X" to the new vertex.
```

This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.

----

And while I am at it, isn't `edges of "u"` in description of `X` too informal? Should it be `edges incident to "u"` ?


---

Comment by zgershkoff created at 2018-01-23 00:05:50

Given the discussion in #24512, I'm not sure what needs to be changed in the code, if anything. The doctest was fixed already so future changes to `WheelGraph()` won't upset it.

Replying to [comment:1 dimpase]:
> isn't there a documentation bug:
> Currently one only sees
> {{{
>    A coextension in a graphic matroid is the opposite of contracting
>    an edge; that is, vertices are merged, and a new edge is added
>    between them. This method will split a vertex, and move the edges
>    indicated by "X" to the new vertex.
> }}}
> This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.

Yes, that's an error. How about this: 

 {{{
    A coextension in a graphic matroid is the opposite of contracting
    an edge; that is, a vertex is split, and a new edge is added
    between the resulting vertices. This method will create a new vertex
    adjacent to "u", and move the edges indicated by "X" from "u"
    to the new vertex.
 }}}

> And while I am at it, isn't `edges of "u"` in description of `X` too informal? Should it be `edges incident to "u"` ?

I suppose it's not standard, but I think the meaning is unambiguous. The phrase "edges of" only makes sense followed by a set of edges or an object that implies a set of edges (such as a graph), and I think there's only one set of edges that a vertex implies. But sure, we can change it since we're changing things.


---

Comment by dimpase created at 2018-02-03 22:39:56

OK, so here is the reworded doc. Please review.
----
New commits:


---

Comment by dimpase created at 2018-02-03 22:39:56

Changing status from new to needs_review.


---

Comment by zgershkoff created at 2018-02-14 23:25:10

Looks fine. Patchbot doesn't like it but I think that's unrelated.

You're not going to fix `edges of "u"` as well?


---

Comment by git created at 2018-02-15 10:56:42

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2018-02-15 10:57:57

OK, right, fixed this too.


---

Comment by zgershkoff created at 2018-02-21 02:54:13

LGTM


---

Comment by zgershkoff created at 2018-02-21 02:54:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-02-22 17:40:47

Resolution: fixed
