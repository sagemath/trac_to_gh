# Issue 34583: Sympy numerical calculation in sage is slightly incorrect, but only in SageMath.

Issue created by migration from https://trac.sagemath.org/ticket/34820

Original creator: @mathlover2

Original creation time: 2022-12-04 04:22:46

Keywords: sympy, numerical, evalf

Executing the following code in [SageMath](SageMath)



```
j = var('j')
part_func(x) = product(1/(1-x^j), j, 1, Infinity, hold=True)
u = part_func(1/4)._sympy_()
print(u.evalf())
```


prints the result 1.45235363523568. The _actual_ result is 1.45235364244960, which is what is returned when running Sympy in an IPython terminal (without Sage) and running the equivalent


```
from sympy import *
k = var('k')
u = Product(1/(1-(1/4)**k), (k, 1, oo)
print(u.evalf())
```



I got this result both on a system-wide install of Sage 9.5 on Ubuntu and a system-wide install of Sage 9.5 on Kali Linux as well as a local install of Sage 9.7 compiled from source on Kali Linux. 

I also ran evalf with the verbose flag set to true. See the attached files, sage_evalf_verbose_output.txt and sympy_evalf_verbose_output.txt. Note that the Sage output indicates the operation is longer and more convoluted than with Sympy.

Please note that this is my first report to this repository. If I have messed up the bug-reporting procedure in some way, let me know.






---

Attachment


---

Attachment

ADDENDUM: It seems this is in fact a bug with Sympy and not sage. Note that in the test code aboce, the Sympy code uses (1/4) instead of Rational(1, 4), which is the correct Sympy representation of rational numbers and what the [SageMath](SageMath) library calls.

I will try to figure out the issue over there, and I request that this ticket be closed.


---

Comment by chapoton created at 2022-12-07 16:32:33

Resolution: invalid
