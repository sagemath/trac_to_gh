# Issue 16266: q-x construction of Orthogonal Arrays

Issue created by migration from https://trac.sagemath.org/ticket/16503

Original creator: ncohen

Original creation time: 2014-06-20 10:32:21

CC:  vdelecroix

Another construction of orthogonal arrays. New OA for `n=158, 329, 334, 355, 517, 574, 745, 979, 1926`.

Thanks to Julian R. Abel's pointers, as usual `:-)`

Nathann


---

Comment by ncohen created at 2014-06-20 10:36:41

Changing status from new to needs_review.


---

Comment by git created at 2014-06-20 10:39:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-06-25 15:12:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by ncohen created at 2014-06-26 10:47:43

Updated on top of #16500 !

Nathann


---

Comment by git created at 2014-06-26 10:48:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2014-06-27 12:02:58

Hi Nathann,

1) One lines 656-659 you have an import followed by a commented check!!

```
from sage.combinat.designs.bibd import _check_pbd
PBD = [[relabel[xx] for xx in B if not xx in points_to_delete] for B in TD]

# _check_pbd(PBD,n,[q,q-x-1,q-x+1,x+2])
```

why is that?

2) This is wrong (lines 730-731)

```
# The next is always True, because q is a prime power
# orthogonal_array(k+1,q,existence=True) and
```

if k+1 > q... instead we can start the loop at k+1 instead of 3.

3) I bounced into something bad: I wanted to change in `find_recursive_construction` the

```
assert k >= 3
```

into a

```
assert k > 3, "you do not need recursion for k<4"
```

since it is trivial to build one latin square. But it appears that the recursive constructions is called with k=3 many times! so bad! This has to be corrected... but hopefully, not here. I guess that #16535 would be the good place.

Vincent


---

Comment by ncohen created at 2014-06-27 12:43:51

Hello !

> 1) One lines 656-659 you have an import followed by a commented check!!
> {{{
> from sage.combinat.designs.bibd import _check_pbd
> PBD = [[relabel[xx] for xx in B if not xx in points_to_delete] for B in TD]
> 
> # _check_pbd(PBD,n,[q,q-x-1,q-x+1,x+2])
> }}}
> why is that?

It is something I used while implementing the construction and as it said something about the PBD I left it. I updated that comment as that troubled you.

> 2) This is wrong (lines 730-731)
> {{{
> # The next is always True, because q is a prime power
> # orthogonal_array(k+1,q,existence=True) and
> }}}

The line before that one is 


```
            orthogonal_array(k+1,q-x+1,existence=True) and
```


> 3) I bounced into something bad: I wanted to change in `find_recursive_construction` the
> {{{
> assert k >= 3
> }}}
> into a
> {{{
> assert k > 3, "you do not need recursion for k<4"
> }}}
> since it is trivial to build one latin square. But it appears that the recursive constructions is called with k=3 many times! so bad! This has to be corrected... but hopefully, not here. I guess that #16535 would be the good place.

Why in #16535 ? What we need to do is add a case for k=3 in the `orthogonal_array` constructor.

I fixed the things above, plus an apparently incorrect `1<x`.

Nathann


---

Comment by git created at 2014-06-27 12:44:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-06-27 17:51:32

Hi Nathann,

You can actually cut the loop if `x >= q` as `x` is increasing along the loop. It is done at `public/16503` (it does not matter too much right now, but it will if you want to compute a big MOLS table).

Beyond that, you can set to positive review.

Vincent


---

Comment by vdelecroix created at 2014-06-27 17:51:43

Changing status from needs_review to needs_info.


---

Comment by ncohen created at 2014-06-27 18:06:01

HMmmmm... I don't like much to differentiate over integer divisions.. Do you mind if we keep it like that ?

Nathann


---

Comment by vdelecroix created at 2014-06-27 18:13:07

Replying to [comment:11 ncohen]:
> HMmmmm... I don't like much to differentiate over integer divisions.. Do you mind if we keep it like that ?

Me neither, but the floor function is increasing... so it is fine (as the composition of increasing functions is increasing)! But we can keep it as it is, since we cut very little with that: `(q^2-n)/(q-2) ~ q + cte` for large `q`.

Vincent


---

Comment by vdelecroix created at 2014-06-27 18:13:07

Changing status from needs_info to positive_review.


---

Comment by vdelecroix created at 2014-06-28 08:15:42

Changing status from positive_review to needs_work.


---

Comment by vdelecroix created at 2014-06-28 08:15:42

As reported in #16524 there is a problem building the doc. Solution (line 622)

```
-    REFERENCES::
+    REFERENCES:
```



---

Comment by git created at 2014-06-28 08:17:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-06-28 08:17:53

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2014-06-28 08:22:01

... building the doc...


---

Comment by vdelecroix created at 2014-06-28 08:26:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-06-29 00:32:55

Resolution: fixed
