# Issue 10861: giac interface

Issue created by migration from Trac.

Original creator: frederichan

Original creation time: 2011-03-15 15:20:54

Assignee: was

Keywords: giac, interfaces

[PATCH] for a giac interface in sage. (adapted from maple.py)

This patch allows to interface sage with an external giac program.

some benchmarks ca be found here:
http://people.math.jussieu.fr/~han/xcas/sagegiac-bench.txt


---

Comment by frederichan created at 2011-03-30 21:54:27

Changing status from new to needs_review.


---

Comment by frederichan created at 2011-03-30 21:54:27

version 2 replace the initial version. (minor changes to have 100% coverage and tests)


---

Attachment

giac interface (version 3)


---

Comment by frederichan created at 2011-06-05 23:00:53

version3: minor changes in giac.py: 
l38 modify output of test to not depend on giac's configuration
l1079: typo: # otional  -> # optional


---

Comment by kohel created at 2011-10-26 09:36:19

Changing assignee from was to kohel.


---

Comment by kohel created at 2011-10-26 11:55:30

Changing status from needs_review to needs_work.


---

Comment by kohel created at 2011-10-26 11:55:30

This adds a new interface (based on maple.py) to the 
giac library:

http://www-fourier.ujf-grenoble.fr/~parisse/giac.html

This library, in the form of the graphical interface 
xcas, is widely used in the France competitive exams 
for high school teachers, hence widely tested.

The new interface is fully documented, more examples 
of usage are found here:

http://www.math.jussieu.fr/~han/exemples-giac%20--%20Sage.html

I identified one error in preparing the patch: 'giac'
needs to be added to interfaces at the end of all.py.

A simple pre-parsing would improve the interface:

sage: s = """
my_mod(a,b) := {
    return irem(a,b)
}
"""

sage: giac(s)

<error>

However, reducing to one line works:

sage: giac(s.replace("\n",""))
 (a,b)->{ 
  return(irem(a,b));  
}

sage: giac("my_mod(103,101)")

2

or similarly one can insert \'s:

sage: giac(s.replace("\n","\\"))
 (a,b)->{ 
  return(irem(a,b));  
}

sage: giac("my_mod(103,101)")

2

Caution: I don't know if the giac 
parser always ignores "\n", and in 
the second replacement some more 
care is needed to avoid replacing 
"\\\n" with "\\\\".

The example given on the above site is:

%giac
f:=(a,b)-> if (a<b)  \
             then  x[a,b];   \
             else    if (a>b) \
                      then  -x[b,a]; \
                      else   0;  \
                     fi;\
             fi;

Given that giac uses ";" to terminate lines, 
a better pre-parsing would render the \'s 
unnecessary, as is the case for the xcas 
interpretter.

It should be noted that conversions back to 
Sage are limited.  As far as I can tell only 
automatic string evaluations succeed (but 
errors are trapped and this is documented).

Finally, the author notes that an interrupt 
in Sage can kill the giac session.

Extending conversions to Sage and handling 
interrupts better are larger projects which
could be done later.  Rebuilding the diff 
to recover the %giac magic feature and some 
slight pre-parsing would be desirable to 
complete this interface.


---

Attachment

addon for magic mode %giac, and a basic  conversion giac->sage for Lists


---

Comment by frederichan created at 2011-11-03 23:18:09

Changing status from needs_work to needs_review.


---

Comment by kohel created at 2011-11-04 10:18:53

The two diffs (sagegiac.diff then sagegiac_addons1.diff) install and 
build cleanly against sage-4.7.1, provides a useful new interface 
(to the symbolic and arithmetic library giac), is well-documented and 
clean.


---

Comment by kohel created at 2011-11-04 10:18:53

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-11-06 10:06:58

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2011-11-06 10:06:58

There is a doctest error because of bad indentation in `sage/symbolic/expression.pyx`:

```
docstring of sage.symbolic.expression.Expression.sum:120: (WARNING/2) Literal block expected; none found.
```



---

Comment by frederichan created at 2011-11-07 20:56:04

Remove assignee kohel.


---

Comment by frederichan created at 2011-11-07 20:56:04

The patch trac10940.diff is an all in one patch for: 
sagegiac.diff+sagegiac_addons1.diff+ 

-the indent bug in expression.pyx 
-add vector conversion support from sage to giac


---

Comment by frederichan created at 2011-11-07 21:02:15

Replying to [comment:9 Han Frederic]:
I made an mistake and  deleted owner kohel


---

Comment by frederichan created at 2011-11-07 21:02:15

Set assignee to kohel.


---

Comment by frederichan created at 2011-11-07 21:03:22

Changing status from needs_work to needs_review.


---

Comment by frederichan created at 2011-11-26 13:22:42

apply only this patch.  ( diff with the previous version: removed trailing whitespaces)


---

Attachment

The documentation works fine now.  But there is still "add vector conversion support from sage to giac" which needs to be reviewed.


---

Comment by frederichan created at 2012-01-28 11:41:54

Replying to [comment:12 jdemeyer]:
> The documentation works fine now.  But there is still "add vector conversion support from sage to giac" which needs to be reviewed.

If it helps the review I have done a giac spkg (trac 12375). I can also remove this minor enhancement (all the modifications in sage/modules/free_module_element.pyx) or put it in another trac, let me know.


---

Comment by jdemeyer created at 2012-01-30 10:41:18

Han: cannot you get David Kohel to review this ticket?


---

Comment by kohel created at 2012-01-30 11:35:41

I verified the patch applies to sage-4.8, and tested the vector conversion, which works.


---

Comment by kohel created at 2012-02-02 21:07:16

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-02-07 13:21:07

Resolution: fixed
