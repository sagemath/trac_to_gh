# Issue 17690: Discarded arguments in IntegerVector

Issue created by migration from https://trac.sagemath.org/ticket/17927

Original creator: ncohen

Original creation time: 2015-03-11 08:02:01

CC:  jhpalmieri jdemeyer aschilling tscrim vdelecroix combinat nthiery

As reported in #17898, `IntegerVector` ignores some of its arguments


```
sage: list(IntegerVectors(4, length=3, min_part=1)) # a bug?
[[4], [3, 1], [2, 2], [2, 1, 1], [1, 3], [1, 2, 1], [1, 1, 2], [1, 1, 1, 1]
```


This branch makes it raise exceptions where it should

Nathann


---

Comment by ncohen created at 2015-03-11 09:37:50

New commits:


---

Comment by ncohen created at 2015-03-11 09:37:50

Changing status from new to needs_review.


---

Comment by git created at 2015-03-11 09:45:39

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2015-03-12 09:16:03

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2015-03-12 09:17:12

I just updated the patch. It is not simpler, as all arguments are actually forwarded to the functions, which then refuse the ones that they do not accept. This way Python raises the exceptions for us.

Nathann


---

Comment by vdelecroix created at 2015-03-14 22:12:23

Note that it would be cool to actually conert the input to either Python integer or Sage integers (and also make the output uniform, i.e. being list of Python integer or list of Sage integers but mixing both can lead to disaster):

```
sage: V = IntegerVectors(4/1, 3/1)
sage: a = V.first()
sage: a in V
False
sage: type(a[0])
<type 'sage.rings.rational.Rational'>
sage: type(a[1])
<type 'int'>
```

Not exactly the topic of the ticket but I bumped into that issue and saw this ticket in the trac list...

Vincent


---

Comment by ncohen created at 2015-03-15 12:37:42

> Not exactly the topic of the ticket but I bumped into that issue and saw this ticket in the trac list...

It would already be very cool if this ticket could be reviewed as it is. I wonder if anybody uses that class, but the number of inconsistencies it contains is amazing.

Nathann


---

Comment by ncohen created at 2015-03-25 16:27:29

Guys ?...


---

Comment by jdemeyer created at 2015-03-25 16:31:37

I am still waiting for an answer to [comment:51:ticket:17979] (that ticket also makes changes to `IntegerVectors`)


---

Comment by ncohen created at 2015-03-25 16:36:05

> I am still waiting for an answer to [comment:51:ticket:17979] (that ticket also makes changes to `IntegerVectors`)

Oh. I see.

Well, it's up to you.. But I am not sure that they will answer soon, and if they do nothing will change before #17979 gets merged too... SOooo well.

As you like.

Nathann


---

Comment by jdemeyer created at 2015-04-14 20:32:25

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-04-14 21:14:16

I don't know whether it really should depend on #18109, but at least it should be checked that there is no conflict.


---

Comment by ncohen created at 2015-04-15 07:37:37

Nicolas said that he would do it (in comment:465:ticket:17979). Could you? These bugs need to be fixed too. Thanks,

Nathann


---

Comment by nthiery created at 2015-04-15 12:10:29

I actually done a good chunk of work in this direction. However I very
soon realized that, to avoid changing a lot of doctests temporarilly
and reverting them back later on, we really want to have a class for
integer vectors of a given length (with constraints). A disjoint union is not enough. Indeed quite some of the doctests are about things like checking containment which is not available with a disjoint union.

The natural thing to implement this class is to base it on
`IntegerLists` (not `IntegerListsLex`). Since the code base for the
later is in a state of flux, I'd rather wait a couple days and base
the work on #18109. I also want to focus on other things with people
during the Sage days here. I guess it would be doable within the next
two week.

Or we can go for a temporary solution, but it feels like just
additional work for not much value: casual users won't benefit from
work here before 6.7 anyway, we are not in total rush.


---

Comment by ncohen created at 2015-04-15 12:39:14

Nicolas,

You told me that you would rebase this ticket on top of #17979 once that it will be merged. Could you honor this promise?

We work differently on many things. I need to be able to trust people I work with. You also know that I never believed in 'ticket that will be written later', or 'code in a state of flux'. This branch was in `needs_review` 5 weeks ago, and has not been reviewed because we were waiting on your ticket #17979.

Please do not let my work go to waste after we waited for you.

Nathann


---

Comment by nthiery created at 2015-04-15 13:02:22

I can do that. But this really amounts in doing a crappy workaround now, breaking and "fixing" existing tests (sorry, but that's exactly what some of your changes are doing). I believe it's more efficient to shoot directly for the right thing. On other occasions you complain to me that I should not indulge myself with such temporary fixes.

I'd appreciate if I could decide myself what's the right approach in work I handle. You are not my boss.


---

Comment by ncohen created at 2015-04-15 13:05:06

> I'd appreciate if I could decide myself what's the right approach in work I handle. You are not my boss.

You make promises that you do not keep.


---

Comment by ncohen created at 2015-04-15 13:14:12

(currently rebasing the code)


---

Comment by git created at 2015-04-15 13:24:35

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2015-04-15 13:26:33

Here it is. Actually, most of what the patch did had been re-done in #17979, and all that is left to do here is raise an exception when `IntegerVectors(length=3)` is called.

Nathann


---

Comment by ncohen created at 2015-04-15 13:26:33

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2015-04-15 13:45:55

And there are no conflicts with #18109.


---

Comment by nthiery created at 2015-04-15 14:01:14

It was *your* decision to take over my work because *you* felt it was better to have this intermediate step. I was going to fullfill way more than my promise. Now you wasted my time, since I will need to rebase my work.

If you want to discourage people, that's the way to proceed.


---

Comment by ncohen created at 2015-04-15 14:08:39

> It was *your* decision to take over my work because *you* felt it was better to have this intermediate step.

What ? To take over your work? `O_o`

I created this ticket when #17898 (which removed the stopgap) was reviewed (see comment:63:ticket:17898).

> I was going to fullfill way more than my promise.

17 months ago you were also going to fix cartesian products (#15425). See also #18182 which was created yesterday. And there are many many things that you were going to fix 3 or 5 years ago.

> Now you wasted my time, since I will need to rebase my work.

I don't know what work you are talking about. But since I created this ticket 5 weeks ago, I guess that you should base your work on top of this ticket instead of asking me to rebase mine.

Nathann


---

Comment by nthiery created at 2015-04-16 04:48:40

Changing status from needs_review to needs_work.


---

Comment by nthiery created at 2015-04-16 04:48:40


```
sage: [0,0,0,0] in IntegerVectors(0, 3)
False
sage: [3,1,2,4] in IntegerVectors(None, 3) # oops
True
```



---

Comment by git created at 2015-04-16 06:48:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-04-16 07:54:24

Changing status from needs_work to needs_review.


---

Comment by nthiery created at 2015-04-16 14:48:10

This achieves what the ticket claims, and it's better to have an error than something possibly wrong. This will require undoing some stuff once the real fix will come, but if that makes you happy to have this intermediate step, I can live with that.
Positive review.


---

Comment by nthiery created at 2015-04-16 14:48:17

Changing status from needs_review to positive_review.


---

Comment by nthiery created at 2015-04-16 14:50:35

Replying to [comment:21 ncohen]:
> Here it is. Actually, most of what the patch did had been re-done in #17979

Indeed, I had taken a lead advance on my promise, by merging in a good part of your work at the occasion where it was most productive for to do it.


---

Comment by nthiery created at 2015-04-16 15:23:41

Replying to [comment:24 ncohen]:
> > It was *your* decision to take over my work because *you* felt it was better to have this intermediate step.
> 
> What ? To take over your work? `O_o`

By "my work" here, I meant "rebasing your branch on top of #17979".

> 17 months ago you were also going to fix cartesian products (#15425).

This is a long run task. More than half of the items are already
achieved.

> See also #18182 which was created yesterday.

#18182 is not a fix. It's a new feature. Beside I am actively helping
out Daniel who is working on it here at Sage Days 67.

When contributing infrastructure one certainly is responsible for
making sure that the infrastructure is robust, and that the basic
applications are available. But there is no reason why one should
implement each and every application of the infrastructure.

>  And there are many many things that you were going to fix 3 or 5 years ago.

And I did many of them, and in particular I believe I did all for
which I had set a specific timeline. And in the mean time I did a lot
of infrastructure, refactoring, and finalization work, prioritized
according to the needs of many people.

Now, and again, you are not my boss to judge on how I prioritize on
the many tasks that needs to be done.

> I don't know what work you are talking about.

3 hours of hard work on a proper cleanup of integer vectors (currently
stashed out), that I now need to rebase when it would have been more
productive to do all at once.

Anyway, done with this ticket. Bye.


---

Comment by vbraun created at 2015-04-18 23:40:19

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-04-18 23:40:19

reviewer name


---

Comment by ncohen created at 2015-04-19 05:34:50

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2015-04-19 16:45:00

Resolution: fixed
