# Issue 18868: Allow sage -i python to actually install the right version of Python

archive/issues_018868.json:
```json
{
    "body": "CC:  @jhpalmieri\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/19105\n\n",
    "created_at": "2015-08-27T18:24:53Z",
    "labels": [
        "component: scripts"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Allow sage -i python to actually install the right version of Python",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18868",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @jhpalmieri



Issue created by migration from https://trac.sagemath.org/ticket/19105





---

archive/issue_comments_257940.json:
```json
{
    "body": "I don't understand what the ticket proposes.\n* Renaming python2 -> python is backward\n* Renaming python3 -> python is too soon \n* Adding more spaghetti code to the install script to special-case python sucks\nIMHO the current behavior is ideal, throw an error and point the user to either python2 or python3",
    "created_at": "2015-08-28T12:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257940",
    "user": "https://github.com/vbraun"
}
```

I don't understand what the ticket proposes.
* Renaming python2 -> python is backward
* Renaming python3 -> python is too soon 
* Adding more spaghetti code to the install script to special-case python sucks
IMHO the current behavior is ideal, throw an error and point the user to either python2 or python3



---

archive/issue_comments_257941.json:
```json
{
    "body": "Replying to [comment:1 vbraun]:\n> I don't understand what the ticket proposes.\n> * Renaming python2 -> python is backward\n> * Renaming python3 -> python is too soon \n> * Adding more spaghetti code to the install script to special-case python sucks\n\nLuckily, none of the above applies.\n\nThere is already code in `build/make/install` which deals with Python 2 vs. Python 3. The resulting file `build/make/Makefile` contains what is needed to make this work very easily.",
    "created_at": "2015-08-28T12:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257941",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:1 vbraun]:
> I don't understand what the ticket proposes.
> * Renaming python2 -> python is backward
> * Renaming python3 -> python is too soon 
> * Adding more spaghetti code to the install script to special-case python sucks

Luckily, none of the above applies.

There is already code in `build/make/install` which deals with Python 2 vs. Python 3. The resulting file `build/make/Makefile` contains what is needed to make this work very easily.



---

archive/issue_comments_257942.json:
```json
{
    "body": "Admittedly, making `./sage -f python` work is a lot harder than making `./sage -i python` work. Unfortunately, it is `./sage -f python` which is actually needed (for example, after installing openssl).",
    "created_at": "2015-08-28T13:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257942",
    "user": "https://github.com/jdemeyer"
}
```

Admittedly, making `./sage -f python` work is a lot harder than making `./sage -i python` work. Unfortunately, it is `./sage -f python` which is actually needed (for example, after installing openssl).



---

archive/issue_comments_257943.json:
```json
{
    "body": "IMHO it is not needed, just make up your mind which python version you want to install.",
    "created_at": "2015-08-28T13:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257943",
    "user": "https://github.com/vbraun"
}
```

IMHO it is not needed, just make up your mind which python version you want to install.



---

archive/issue_comments_257944.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-09-11T08:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257944",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_257945.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-11T08:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257945",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_257946.json:
```json
{
    "body": "Note that this is the only commit for this ticket, the rest comes from dependencies:\n\n> New commits:\n> ||[74c78c1](http://git.sagemath.org/sage.git/commit/?id=74c78c179010befaf59224628a64efdf0ca88048)||`Allow \"sage -i python\" and \"sage -f python\"`||",
    "created_at": "2015-09-11T08:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257946",
    "user": "https://github.com/jdemeyer"
}
```

Note that this is the only commit for this ticket, the rest comes from dependencies:

> New commits:
> ||[74c78c1](http://git.sagemath.org/sage.git/commit/?id=74c78c179010befaf59224628a64efdf0ca88048)||`Allow "sage -i python" and "sage -f python"`||



---

archive/issue_comments_257947.json:
```json
{
    "body": "So the solution is C: Adding more spaghetti code to the install script to special-case python",
    "created_at": "2015-09-11T08:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257947",
    "user": "https://github.com/vbraun"
}
```

So the solution is C: Adding more spaghetti code to the install script to special-case python



---

archive/issue_comments_257948.json:
```json
{
    "body": "Another possible solution: don't search on-line standard packages.\n\n```diff\ndiff --git a/build/bin/sage-spkg b/build/bin/sage-spkg\nindex f4b085b..356efb9 100755\n--- a/build/bin/sage-spkg\n+++ b/build/bin/sage-spkg\n@@ -331,7 +331,7 @@ if [ ! -f \"$PKG_SRC\" ]; then\n             if [ $? -ne 0 ]; then\n                 exit 1\n             fi\n-            for repo in optional experimental standard huge archive; do\n+            for repo in optional experimental huge archive; do\n                 # Download the list of packages.\n                 echo \">>> Checking online list of $repo packages.\"\n                 # File inside DOT_SAGE should be writable\n```\n\nThat's where the problematic Python package is, right? And with recent versions of Sage, is there any reason to search \"standard\" packages? I think that all of those are either outdated or have more recent new-style replacements.",
    "created_at": "2015-09-11T16:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257948",
    "user": "https://github.com/jhpalmieri"
}
```

Another possible solution: don't search on-line standard packages.

```diff
diff --git a/build/bin/sage-spkg b/build/bin/sage-spkg
index f4b085b..356efb9 100755
--- a/build/bin/sage-spkg
+++ b/build/bin/sage-spkg
@@ -331,7 +331,7 @@ if [ ! -f "$PKG_SRC" ]; then
             if [ $? -ne 0 ]; then
                 exit 1
             fi
-            for repo in optional experimental standard huge archive; do
+            for repo in optional experimental huge archive; do
                 # Download the list of packages.
                 echo ">>> Checking online list of $repo packages."
                 # File inside DOT_SAGE should be writable
```

That's where the problematic Python package is, right? And with recent versions of Sage, is there any reason to search "standard" packages? I think that all of those are either outdated or have more recent new-style replacements.



---

archive/issue_comments_257949.json:
```json
{
    "body": "Replying to [comment:10 jhpalmieri]:\n> And with recent versions of Sage, is there any reason to search \"standard\" packages?\nAs you recall from #19004, we aren't searching anything anymore.\n\nThere are two partially separate issues here:\n1. make sure that `sage -i python` **does not** install the **wrong** Python package.\n2. make sure that `sage -i python` **does** install the **correct** Python package.\n\nThis patch here is more about the second point.",
    "created_at": "2015-09-11T16:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257949",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:10 jhpalmieri]:
> And with recent versions of Sage, is there any reason to search "standard" packages?
As you recall from #19004, we aren't searching anything anymore.

There are two partially separate issues here:
1. make sure that `sage -i python` **does not** install the **wrong** Python package.
2. make sure that `sage -i python` **does** install the **correct** Python package.

This patch here is more about the second point.



---

archive/issue_comments_257950.json:
```json
{
    "body": "There was also talk of rolling back #19004, in which case my suggestion would apply. But I guess not here. Is that a worthwhile change to make in any case? Should I open a ticket?",
    "created_at": "2015-09-11T17:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257950",
    "user": "https://github.com/jhpalmieri"
}
```

There was also talk of rolling back #19004, in which case my suggestion would apply. But I guess not here. Is that a worthwhile change to make in any case? Should I open a ticket?



---

archive/issue_comments_257951.json:
```json
{
    "body": "Replying to [comment:12 jhpalmieri]:\n> Should I open a ticket?\nFor what exactly?",
    "created_at": "2015-09-11T17:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257951",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:12 jhpalmieri]:
> Should I open a ticket?
For what exactly?



---

archive/issue_comments_257952.json:
```json
{
    "body": "Never mind. If you take any efforts to roll back #19004, consider making those changes.",
    "created_at": "2015-09-11T17:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257952",
    "user": "https://github.com/jhpalmieri"
}
```

Never mind. If you take any efforts to roll back #19004, consider making those changes.



---

archive/issue_comments_257953.json:
```json
{
    "body": "Replying to [comment:14 jhpalmieri]:\n> If you take any efforts to roll back #19004\nWell, there is this huge thread on sage-devel discussing that. Some people are in favour, some against, no clear consensus. There is also a ticket for the rollback: #19158.",
    "created_at": "2015-09-11T18:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257953",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:14 jhpalmieri]:
> If you take any efforts to roll back #19004
Well, there is this huge thread on sage-devel discussing that. Some people are in favour, some against, no clear consensus. There is also a ticket for the rollback: #19158.



---

archive/issue_comments_257954.json:
```json
{
    "body": "Close as \"nobodycares\".",
    "created_at": "2016-01-25T21:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257954",
    "user": "https://github.com/jdemeyer"
}
```

Close as "nobodycares".



---

archive/issue_comments_257955.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-25T21:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257955",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_257956.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2016-02-23T23:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18868#issuecomment-257956",
    "user": "https://github.com/vbraun"
}
```

Resolution: wontfix



---

archive/issue_events_018025.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-23T23:01:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18868",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18868#event-18025"
}
```
