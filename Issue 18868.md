# Issue 18868: Allow sage -i python to actually install the right version of Python

Issue created by migration from https://trac.sagemath.org/ticket/19105

Original creator: jdemeyer

Original creation time: 2015-08-27 18:24:53

CC:  jhpalmieri




---

Comment by vbraun created at 2015-08-28 12:53:55

I don't understand what the ticket proposes.
* Renaming python2 -> python is backward
* Renaming python3 -> python is too soon 
* Adding more spaghetti code to the install script to special-case python sucks
IMHO the current behavior is ideal, throw an error and point the user to either python2 or python3


---

Comment by jdemeyer created at 2015-08-28 12:58:05

Replying to [comment:1 vbraun]:
> I don't understand what the ticket proposes.
> * Renaming python2 -> python is backward
> * Renaming python3 -> python is too soon 
> * Adding more spaghetti code to the install script to special-case python sucks

Luckily, none of the above applies.

There is already code in `build/make/install` which deals with Python 2 vs. Python 3. The resulting file `build/make/Makefile` contains what is needed to make this work very easily.


---

Comment by jdemeyer created at 2015-08-28 13:00:28

Admittedly, making `./sage -f python` work is a lot harder than making `./sage -i python` work. Unfortunately, it is `./sage -f python` which is actually needed (for example, after installing openssl).


---

Comment by vbraun created at 2015-08-28 13:05:09

IMHO it is not needed, just make up your mind which python version you want to install.


---

Comment by jdemeyer created at 2015-09-11 08:34:32

New commits:


---

Comment by jdemeyer created at 2015-09-11 08:34:32

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-09-11 08:35:19

Note that this is the only commit for this ticket, the rest comes from dependencies:

> New commits:
> ||[74c78c1](http://git.sagemath.org/sage.git/commit/?id=74c78c179010befaf59224628a64efdf0ca88048)||`Allow "sage -i python" and "sage -f python"`||


---

Comment by vbraun created at 2015-09-11 08:39:43

So the solution is C: Adding more spaghetti code to the install script to special-case python


---

Comment by jhpalmieri created at 2015-09-11 16:28:48

Another possible solution: don't search on-line standard packages.

```diff
diff --git a/build/bin/sage-spkg b/build/bin/sage-spkg
index f4b085b..356efb9 100755
--- a/build/bin/sage-spkg
+++ b/build/bin/sage-spkg
@@ -331,7 +331,7 @@ if [ ! -f "$PKG_SRC" ]; then
             if [ $? -ne 0 ]; then
                 exit 1
             fi
-            for repo in optional experimental standard huge archive; do
+            for repo in optional experimental huge archive; do
                 # Download the list of packages.
                 echo ">>> Checking online list of $repo packages."
                 # File inside DOT_SAGE should be writable
```

That's where the problematic Python package is, right? And with recent versions of Sage, is there any reason to search "standard" packages? I think that all of those are either outdated or have more recent new-style replacements.


---

Comment by jdemeyer created at 2015-09-11 16:32:35

Replying to [comment:10 jhpalmieri]:
> And with recent versions of Sage, is there any reason to search "standard" packages?
As you recall from #19004, we aren't searching anything anymore.

There are two partially separate issues here:
1. make sure that `sage -i python` *does not* install the *wrong* Python package.
2. make sure that `sage -i python` *does* install the *correct* Python package.

This patch here is more about the second point.


---

Comment by jhpalmieri created at 2015-09-11 17:11:33

There was also talk of rolling back #19004, in which case my suggestion would apply. But I guess not here. Is that a worthwhile change to make in any case? Should I open a ticket?


---

Comment by jdemeyer created at 2015-09-11 17:34:42

Replying to [comment:12 jhpalmieri]:
> Should I open a ticket?
For what exactly?


---

Comment by jhpalmieri created at 2015-09-11 17:44:48

Never mind. If you take any efforts to roll back #19004, consider making those changes.


---

Comment by jdemeyer created at 2015-09-11 18:17:34

Replying to [comment:14 jhpalmieri]:
> If you take any efforts to roll back #19004
Well, there is this huge thread on sage-devel discussing that. Some people are in favour, some against, no clear consensus. There is also a ticket for the rollback: #19158.


---

Comment by jdemeyer created at 2016-01-25 21:21:36

Close as "nobodycares".


---

Comment by jdemeyer created at 2016-01-25 21:21:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-23 23:01:59

Resolution: wontfix
