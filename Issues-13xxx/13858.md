# Issue 13858: update M4RI to newest upstream release

archive/issues_013654.json:
```json
{
    "body": "A new version of M4RI is available:\u00a0[20121224](https://bitbucket.org/malb/m4ri/wiki/M4RI-20121224)\n\n* it improves performance\n* compilation time is considerably shorter because cache tuning was dropped\n\n**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20121224.spkg\n\n**Keywords:** m4ri\n\n**Reviewer:** Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/13858\n\n",
    "closed_at": "2013-04-03T15:12:10Z",
    "created_at": "2012-12-21T18:31:30Z",
    "labels": [
        "component: packages: standard",
        "enhancement",
        "duplicate"
    ],
    "title": "update M4RI to newest upstream release",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13858",
    "user": "https://github.com/malb"
}
```
A new version of M4RI is available: [20121224](https://bitbucket.org/malb/m4ri/wiki/M4RI-20121224)

* it improves performance
* compilation time is considerably shorter because cache tuning was dropped

**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20121224.spkg

**Keywords:** m4ri

**Reviewer:** Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/13858





---

archive/issue_comments_165737.json:
```json
{
    "body": "<a id='comment:1'></a>\nSo where's the spkg? ;-)",
    "created_at": "2012-12-21T19:47:19Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165737",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:1'></a>
So where's the spkg? ;-)



---

archive/issue_comments_165738.json:
```json
{
    "body": "<a id='comment:2'></a>\nWorking on it, I needed a ticket number for SPKG.txt",
    "created_at": "2012-12-21T20:02:52Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165738",
    "user": "https://github.com/malb"
}
```

<a id='comment:2'></a>
Working on it, I needed a ticket number for SPKG.txt



---

archive/issue_events_118954.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2012-12-21T20:39:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118954"
}
```



---

archive/issue_comments_165739.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,6 @@\n-A new version of M4RI is available which mainly improves performance.\n+A new version of M4RI is available:\u00a0[20121224](https://bitbucket.org/malb/m4ri/wiki/M4RI-20121224)\n+\n+* it improves performance\n+* compilation time is considerably shorter because cache tuning was dropped\n+\n+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20121224.spkg\n``````\n",
    "created_at": "2012-12-21T20:39:57Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165739",
    "user": "https://github.com/malb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,6 @@
-A new version of M4RI is available which mainly improves performance.
+A new version of M4RI is available: [20121224](https://bitbucket.org/malb/m4ri/wiki/M4RI-20121224)
+
+* it improves performance
+* compilation time is considerably shorter because cache tuning was dropped
+
+**Install:** http://sage.math.washington.edu/home/malb/spkgs/libm4ri-20121224.spkg
``````




---

archive/issue_comments_165740.json:
```json
{
    "body": "**Author:** Martin Albrecht",
    "created_at": "2012-12-21T20:39:57Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165740",
    "user": "https://github.com/malb"
}
```

**Author:** Martin Albrecht



---

archive/issue_comments_165741.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"m4ri\".",
    "created_at": "2012-12-21T20:39:57Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165741",
    "user": "https://github.com/malb"
}
```

**Changing keywords** from "" to "m4ri".



---

archive/issue_comments_165742.json:
```json
{
    "body": "<a id='comment:4'></a>\nAh, zu Weihnachten 'ne Zeitmaschine bekommen und gleich mal drei Tage zur\u00fcckgereist.\n\nHat der Weltuntergang also nicht stattgefunden?",
    "created_at": "2012-12-21T20:48:03Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165742",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
Ah, zu Weihnachten 'ne Zeitmaschine bekommen und gleich mal drei Tage zurückgereist.

Hat der Weltuntergang also nicht stattgefunden?



---

archive/issue_comments_165743.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt only works for M4RI releases though.",
    "created_at": "2012-12-21T20:49:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165743",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'></a>
It only works for M4RI releases though.



---

archive/issue_comments_165744.json:
```json
{
    "body": "<a id='comment:6'></a>\nWe should probably add `-L{SAGE_LOCAL}/lib` to `LDFLAGS`, or set (`PNG_CFLAGS` and) `PNG_LIBS` [on Darwin [if `pkg-config` isn't installed or functional]]; cf. David Joyner's report for Sage 5.7.rc0 on sage-release.",
    "created_at": "2013-02-22T16:12:17Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165744",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>
We should probably add `-L{SAGE_LOCAL}/lib` to `LDFLAGS`, or set (`PNG_CFLAGS` and) `PNG_LIBS` [on Darwin [if `pkg-config` isn't installed or functional]]; cf. David Joyner's report for Sage 5.7.rc0 on sage-release.



---

archive/issue_comments_165745.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [@nexttime](#comment%3A6):\n> cf. David Joyner's report for Sage 5.7.rc0 on sage-release.\n\n```\nI had less luck on 10.8.2 (2.66 GHz Intel Core 2 Duo):\n\n...\nFound package conway_polynomials-0.4 in\nspkg/standard/conway_polynomials-0.4.spkg\nconway_polynomials-0.4\n====================================================\nExtracting package\n/Users/wdj/sagefiles/sage-5.7.rc0/spkg/standard/conway_polynomials-0.4.spkg\n-rw-r--r--  1 wdj  staff  227035 Feb 16 06:30\n/Users/wdj/sagefiles/sage-5.7.rc0/spkg/standard/conway_polynomials-0.4.spkg\nFinished extraction\n****************************************************\nHost system:\nDarwin jeeves.home 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25\n00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/Users/wdj/sagefiles/sage-5.7.rc0/local/libexec/gcc/x86_64-apple-darwin12.2.0/4.6.3/lto-wrapper\nTarget: x86_64-apple-darwin12.2.0\nConfigured with: ../src/configure\n--prefix=/Users/wdj/sagefiles/sage-5.7.rc0/local\n--with-local-prefix=/Users/wdj/sagefiles/sage-5.7.rc0/local\n--with-gmp=/Users/wdj/sagefiles/sage-5.7.rc0/local\n--with-mpfr=/Users/wdj/sagefiles/sage-5.7.rc0/local\n--with-mpc=/Users/wdj/sagefiles/sage-5.7.rc0/local --with-system-zlib\n--disable-multilib\nThread model: posix\ngcc version 4.6.3 (GCC)\n****************************************************\nTraceback (most recent call last):\n  File \"./spkg-install\", line 4, in <module>\n    from sage.all import save\n  File \"/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/all.py\",\nline 70, in <module>\n    from sage.matrix.all     import *\n  File \"/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/matrix/all.py\",\nline 1, in <module>\n    from matrix_space import MatrixSpace, is_MatrixSpace\n  File \"/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/matrix/matrix_space.py\",\nline 37, in <module>\n    import matrix_modn_dense\n  File \"matrix_modn_dense_template_header.pxi\", line 11, in init\nsage.matrix.matrix_modn_dense (sage/matrix/matrix_modn_dense.c:13872)\n  File \"matrix_integer_dense.pxd\", line 12, in init\nsage.matrix.matrix_modn_dense_float\n(sage/matrix/matrix_modn_dense_float.cpp:16875)\n  File \"matrix_mod2_dense.pxd\", line 7, in init\nsage.matrix.matrix_integer_dense\n(sage/matrix/matrix_integer_dense.c:43160)\nImportError: dlopen(/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so,\n2): Library not loaded: /usr/local/lib/libpng12.0.dylib\n  Referenced from:\n/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/libm4ri-0.0.20120613.dylib\n  Reason: Incompatible library version: libm4ri-0.0.20120613.dylib\nrequires version 40.0.0 or later, but libpng12.0.dylib provides\nversion 36.0.0\n\nreal\t0m3.444s\nuser\t0m0.470s\nsys\t0m0.368s\n************************************************************************\nError installing package conway_polynomials-0.4\n************************************************************************\n...\n```",
    "created_at": "2013-02-22T16:16:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165745",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
Replying to [@nexttime](#comment%3A6):
> cf. David Joyner's report for Sage 5.7.rc0 on sage-release.

```
I had less luck on 10.8.2 (2.66 GHz Intel Core 2 Duo):

...
Found package conway_polynomials-0.4 in
spkg/standard/conway_polynomials-0.4.spkg
conway_polynomials-0.4
====================================================
Extracting package
/Users/wdj/sagefiles/sage-5.7.rc0/spkg/standard/conway_polynomials-0.4.spkg
-rw-r--r--  1 wdj  staff  227035 Feb 16 06:30
/Users/wdj/sagefiles/sage-5.7.rc0/spkg/standard/conway_polynomials-0.4.spkg
Finished extraction
****************************************************
Host system:
Darwin jeeves.home 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25
00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/Users/wdj/sagefiles/sage-5.7.rc0/local/libexec/gcc/x86_64-apple-darwin12.2.0/4.6.3/lto-wrapper
Target: x86_64-apple-darwin12.2.0
Configured with: ../src/configure
--prefix=/Users/wdj/sagefiles/sage-5.7.rc0/local
--with-local-prefix=/Users/wdj/sagefiles/sage-5.7.rc0/local
--with-gmp=/Users/wdj/sagefiles/sage-5.7.rc0/local
--with-mpfr=/Users/wdj/sagefiles/sage-5.7.rc0/local
--with-mpc=/Users/wdj/sagefiles/sage-5.7.rc0/local --with-system-zlib
--disable-multilib
Thread model: posix
gcc version 4.6.3 (GCC)
****************************************************
Traceback (most recent call last):
  File "./spkg-install", line 4, in <module>
    from sage.all import save
  File "/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/all.py",
line 70, in <module>
    from sage.matrix.all     import *
  File "/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/matrix/all.py",
line 1, in <module>
    from matrix_space import MatrixSpace, is_MatrixSpace
  File "/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/matrix/matrix_space.py",
line 37, in <module>
    import matrix_modn_dense
  File "matrix_modn_dense_template_header.pxi", line 11, in init
sage.matrix.matrix_modn_dense (sage/matrix/matrix_modn_dense.c:13872)
  File "matrix_integer_dense.pxd", line 12, in init
sage.matrix.matrix_modn_dense_float
(sage/matrix/matrix_modn_dense_float.cpp:16875)
  File "matrix_mod2_dense.pxd", line 7, in init
sage.matrix.matrix_integer_dense
(sage/matrix/matrix_integer_dense.c:43160)
ImportError: dlopen(/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so,
2): Library not loaded: /usr/local/lib/libpng12.0.dylib
  Referenced from:
/Users/wdj/sagefiles/sage-5.7.rc0/local/lib/libm4ri-0.0.20120613.dylib
  Reason: Incompatible library version: libm4ri-0.0.20120613.dylib
requires version 40.0.0 or later, but libpng12.0.dylib provides
version 36.0.0

real	0m3.444s
user	0m0.470s
sys	0m0.368s
************************************************************************
Error installing package conway_polynomials-0.4
************************************************************************
...
```



---

archive/issue_comments_165746.json:
```json
{
    "body": "<a id='comment:8'></a>\nHmmm, doesn't look like libm4ri['s `spkg-install`] was the culprit though:\n\n```\n...\n/bin/sh ./libtool --tag=CC   --mode=link gcc -std=gnu99 -mmmx -msse -msse2 -msse3   -I/Users/wdj/sagefiles/sage-5.7.rc0/local/include -g -fPIC -Wall -pedantic -O2 -release 0.0.20120613 -no-undefined  -o libm4ri.la -rpath /Users/wdj/sagefiles/sage-5.7.rc0/local/lib brilliantrussian.lo misc.lo mzd.lo graycode.lo strassen.lo mzp.lo triangular.lo triangular_russian.lo ple.lo ple_russian.lo solve.lo echelonform.lo mmc.lo debug_dump.lo io.lo -lpng12 \nlibtool: link: gcc -dynamiclib  -o .libs/libm4ri-0.0.20120613.dylib  .libs/brilliantrussian.o .libs/misc.o .libs/mzd.o .libs/graycode.o .libs/strassen.o .libs/mzp.o .libs/triangular.o .libs/triangular_russian.o .libs/ple.o .libs/ple_russian.o .libs/solve.o .libs/echelonform.o .libs/mmc.o .libs/debug_dump.o .libs/io.o   /Users/wdj/sagefiles/sage-5.7.rc0/local/lib/libpng12.dylib  -mmmx -msse -msse2 -msse3 -O2   -install_name  /Users/wdj/sagefiles/sage-5.7.rc0/local/lib/libm4ri-0.0.20120613.dylib  -Wl,-single_module\n...\n```",
    "created_at": "2013-02-22T18:43:33Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165746",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>
Hmmm, doesn't look like libm4ri['s `spkg-install`] was the culprit though:

```
...
/bin/sh ./libtool --tag=CC   --mode=link gcc -std=gnu99 -mmmx -msse -msse2 -msse3   -I/Users/wdj/sagefiles/sage-5.7.rc0/local/include -g -fPIC -Wall -pedantic -O2 -release 0.0.20120613 -no-undefined  -o libm4ri.la -rpath /Users/wdj/sagefiles/sage-5.7.rc0/local/lib brilliantrussian.lo misc.lo mzd.lo graycode.lo strassen.lo mzp.lo triangular.lo triangular_russian.lo ple.lo ple_russian.lo solve.lo echelonform.lo mmc.lo debug_dump.lo io.lo -lpng12 
libtool: link: gcc -dynamiclib  -o .libs/libm4ri-0.0.20120613.dylib  .libs/brilliantrussian.o .libs/misc.o .libs/mzd.o .libs/graycode.o .libs/strassen.o .libs/mzp.o .libs/triangular.o .libs/triangular_russian.o .libs/ple.o .libs/ple_russian.o .libs/solve.o .libs/echelonform.o .libs/mmc.o .libs/debug_dump.o .libs/io.o   /Users/wdj/sagefiles/sage-5.7.rc0/local/lib/libpng12.dylib  -mmmx -msse -msse2 -msse3 -O2   -install_name  /Users/wdj/sagefiles/sage-5.7.rc0/local/lib/libm4ri-0.0.20120613.dylib  -Wl,-single_module
...
```



---

archive/issue_comments_165747.json:
```json
{
    "body": "<a id='comment:9'></a>\nSee https://github.com/sagemath/sage/issues/14335 for a more recent version/ticket. This one here should be closed.",
    "created_at": "2013-03-22T13:51:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165747",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'></a>
See https://github.com/sagemath/sage/issues/14335 for a more recent version/ticket. This one here should be closed.



---

archive/issue_events_118955.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2013-03-22T13:51:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118955"
}
```



---

archive/issue_comments_165748.json:
```json
{
    "body": "**Changing author** from \"Martin Albrecht\" to \"\".",
    "created_at": "2013-04-01T17:08:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165748",
    "user": "https://github.com/tscrim"
}
```

**Changing author** from "Martin Albrecht" to "".



---

archive/issue_comments_165749.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2013-04-01T17:08:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13858#issuecomment-165749",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_events_118956.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-04-01T17:08:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118956"
}
```



---

archive/issue_events_118957.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-04-01T17:08:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118957"
}
```



---

archive/issue_events_118958.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T15:12:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118958"
}
```



---

archive/issue_events_118959.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T15:12:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118959"
}
```



---

archive/issue_events_118960.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-03T15:12:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13858",
    "label": "duplicate",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13858#event-118960"
}
```
