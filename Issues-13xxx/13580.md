# Issue 13580: Parallel map reduce on SearchForest

archive/issues_013376.json:
```json
{
    "body": "Implement a map reduce algorithm in parallel on large sets described by a `SearchForest`. We use a work-stealing algorithm (see https://en.wikipedia.org/wiki/Work_stealing) based on Python's multiprocessing. \n\n\nAssignee: @hivert\n\nCC:  sage-combinat @nathanncohen @jdemeyer @seblabbe\n\nKeywords: map-reduce, days57, days77\n\nReviewer: S\u00e9bastien Labb\u00e9, Jean-Baptiste Priez\n\nAuthor: Florent Hivert, Jean-Baptiste Priez, Nathann Cohen\n\nBranch: 134c1fad85dd50fa28528adc343bad759b174cc6\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13580\n\n",
    "closed_at": "2016-04-08T22:40:20Z",
    "created_at": "2012-10-07T17:07:38Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Parallel map reduce on SearchForest",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13580",
    "user": "https://github.com/hivert"
}
```
Implement a map reduce algorithm in parallel on large sets described by a `SearchForest`. We use a work-stealing algorithm (see https://en.wikipedia.org/wiki/Work_stealing) based on Python's multiprocessing. 


Assignee: @hivert

CC:  sage-combinat @nathanncohen @jdemeyer @seblabbe

Keywords: map-reduce, days57, days77

Reviewer: Sébastien Labbé, Jean-Baptiste Priez

Author: Florent Hivert, Jean-Baptiste Priez, Nathann Cohen

Branch: 134c1fad85dd50fa28528adc343bad759b174cc6

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13580





---

archive/issue_comments_204585.json:
```json
{
    "body": "<a id='comment:1'></a>\nSalut Florent et Nathann,\n\nI am starting to think/work on #6637... I have some questions. Mainly, I would like to know what is this ticket, because the above one liner in the description does not say much...\n\n- Will SearchForest survive or not? \n- Does it replace SearchForest?\n- Does it improve SearchForest? \n- Does it use SearchForest?\n- Or is it used by SearchForest?\n\nAlso, Florent wrote on [sage-devel](https://groups.google.com/d/msg/sage-devel/5XHvEx89RlQ/Tb_QBWepC5YJ) in October 2012 that \n\n```\n   I'm also in the process of finalizing a patch which do parallel and even\n   distributed map-reduce on recursively enumerated sets (currently badly named\n   SearchForest, I'll change the name in my patch, ticket #13580, patch on\n   Sage-Combinat queue [1]).\n```\n\n- I do not see in the cited patch that the name of SearchForest is changed.\n- What would be a better name for SearchForest ?\n- What patch is the more recent? the \"old\" one or the \"experimental\" one?\n\n```\n    trac_13580-map_reduce-fh.patch #+experimental\n    map_reduce_improved_loop-fh.patch #+experimental\n    map_reduce_condition-fh.patch #+experimental\n    trac_13580-map_reduce-old-fh.patch \n```",
    "created_at": "2013-02-09T18:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204585",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:1'></a>
Salut Florent et Nathann,

I am starting to think/work on #6637... I have some questions. Mainly, I would like to know what is this ticket, because the above one liner in the description does not say much...

- Will SearchForest survive or not? 
- Does it replace SearchForest?
- Does it improve SearchForest? 
- Does it use SearchForest?
- Or is it used by SearchForest?

Also, Florent wrote on [sage-devel](https://groups.google.com/d/msg/sage-devel/5XHvEx89RlQ/Tb_QBWepC5YJ) in October 2012 that 

```
   I'm also in the process of finalizing a patch which do parallel and even
   distributed map-reduce on recursively enumerated sets (currently badly named
   SearchForest, I'll change the name in my patch, ticket #13580, patch on
   Sage-Combinat queue [1]).
```

- I do not see in the cited patch that the name of SearchForest is changed.
- What would be a better name for SearchForest ?
- What patch is the more recent? the "old" one or the "experimental" one?

```
    trac_13580-map_reduce-fh.patch #+experimental
    map_reduce_improved_loop-fh.patch #+experimental
    map_reduce_condition-fh.patch #+experimental
    trac_13580-map_reduce-old-fh.patch 
```



---

archive/issue_events_037813.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37813"
}
```



---

archive/issue_events_037814.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37814"
}
```



---

archive/issue_events_037815.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37815"
}
```



---

archive/issue_comments_204586.json:
```json
{
    "body": "Changing branch from \"\" to \"u/hivert/13580/map_reduce\"",
    "created_at": "2014-04-07T21:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204586",
    "user": "https://github.com/hivert"
}
```

Changing branch from "" to "u/hivert/13580/map_reduce"



---

archive/issue_comments_204587.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew commits:\n|                                                                                                                                          |                                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|\n|[693c672](http://git.sagemath.org/sage.git/commit/?id=693c672387212c47ac65012466f92ffa2cc55932)|`Imported code from trac_13580-map_reduce-fh.patch + fixed multiline doctests.`|",
    "created_at": "2014-04-09T02:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204587",
    "user": "https://github.com/hivert"
}
```

<a id='comment:5'></a>
New commits:
|                                                                                                                                          |                                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
|[693c672](http://git.sagemath.org/sage.git/commit/?id=693c672387212c47ac65012466f92ffa2cc55932)|`Imported code from trac_13580-map_reduce-fh.patch + fixed multiline doctests.`|



---

archive/issue_comments_204588.json:
```json
{
    "body": "Changing commit from \"\" to \"693c672387212c47ac65012466f92ffa2cc55932\"",
    "created_at": "2014-04-09T02:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204588",
    "user": "https://github.com/hivert"
}
```

Changing commit from "" to "693c672387212c47ac65012466f92ffa2cc55932"



---

archive/issue_comments_204589.json:
```json
{
    "body": "Changing keywords from \"map-reduce\" to \"map-reduce, days57\".",
    "created_at": "2014-04-09T02:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204589",
    "user": "https://github.com/hivert"
}
```

Changing keywords from "map-reduce" to "map-reduce, days57".



---

archive/issue_events_037816.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37816"
}
```



---

archive/issue_events_037817.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37817"
}
```



---

archive/issue_events_037818.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37818"
}
```



---

archive/issue_events_037819.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37819"
}
```



---

archive/issue_comments_204590.json:
```json
{
    "body": "Changing branch from \"u/hivert/13580/map_reduce\" to \"u/nthiery/13580/map_reduce\"",
    "created_at": "2015-03-06T11:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204590",
    "user": "https://github.com/nthiery"
}
```

Changing branch from "u/hivert/13580/map_reduce" to "u/nthiery/13580/map_reduce"



---

archive/issue_comments_204591.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[addb17a](http://git.sagemath.org/sage.git/commit/?id=addb17a177397cd9de0952e7c1ee457fe49220bc)|`13580: Trivial rest fix`|",
    "created_at": "2015-03-09T15:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204591",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[addb17a](http://git.sagemath.org/sage.git/commit/?id=addb17a177397cd9de0952e7c1ee457fe49220bc)|`13580: Trivial rest fix`|



---

archive/issue_comments_204592.json:
```json
{
    "body": "Changing commit from \"693c672387212c47ac65012466f92ffa2cc55932\" to \"addb17a177397cd9de0952e7c1ee457fe49220bc\"",
    "created_at": "2015-03-09T15:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204592",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "693c672387212c47ac65012466f92ffa2cc55932" to "addb17a177397cd9de0952e7c1ee457fe49220bc"



---

archive/issue_comments_204593.json:
```json
{
    "body": "Changing branch from \"u/nthiery/13580/map_reduce\" to \"u/hivert/13580/map_reduce\"",
    "created_at": "2015-05-08T22:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204593",
    "user": "https://github.com/hivert"
}
```

Changing branch from "u/nthiery/13580/map_reduce" to "u/hivert/13580/map_reduce"



---

archive/issue_comments_204594.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[92e6e68](http://git.sagemath.org/sage.git/commit/?id=92e6e680771d6f286954bf85ee0064d22a0b253c)|`Merge branch 't/13580/map_reduce' into 13580`|",
    "created_at": "2015-05-20T22:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204594",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[92e6e68](http://git.sagemath.org/sage.git/commit/?id=92e6e680771d6f286954bf85ee0064d22a0b253c)|`Merge branch 't/13580/map_reduce' into 13580`|



---

archive/issue_comments_204595.json:
```json
{
    "body": "Changing commit from \"addb17a177397cd9de0952e7c1ee457fe49220bc\" to \"92e6e680771d6f286954bf85ee0064d22a0b253c\"",
    "created_at": "2015-05-20T22:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204595",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "addb17a177397cd9de0952e7c1ee457fe49220bc" to "92e6e680771d6f286954bf85ee0064d22a0b253c"



---

archive/issue_comments_204596.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[734c748](http://git.sagemath.org/sage.git/commit/?id=734c74810e63321463e4bca7bcf0da85dffc47b9)|`#13580 Fixed test after merging #6637`|",
    "created_at": "2015-05-20T23:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204596",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[734c748](http://git.sagemath.org/sage.git/commit/?id=734c74810e63321463e4bca7bcf0da85dffc47b9)|`#13580 Fixed test after merging #6637`|



---

archive/issue_comments_204597.json:
```json
{
    "body": "Changing commit from \"92e6e680771d6f286954bf85ee0064d22a0b253c\" to \"734c74810e63321463e4bca7bcf0da85dffc47b9\"",
    "created_at": "2015-05-20T23:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204597",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "92e6e680771d6f286954bf85ee0064d22a0b253c" to "734c74810e63321463e4bca7bcf0da85dffc47b9"



---

archive/issue_comments_204598.json:
```json
{
    "body": "<a id='comment:13'></a>\nI saw the following typo in map reduce file while looking at the previous commit: \"As an example, ee compute\"",
    "created_at": "2015-05-21T07:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204598",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:13'></a>
I saw the following typo in map reduce file while looking at the previous commit: "As an example, ee compute"



---

archive/issue_comments_204599.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[f234f60](http://git.sagemath.org/sage.git/commit/?id=f234f60f37e007365c2aec1b4defea55ff255c70)|`#13580 : improved documentation`|",
    "created_at": "2015-05-21T15:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204599",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[f234f60](http://git.sagemath.org/sage.git/commit/?id=f234f60f37e007365c2aec1b4defea55ff255c70)|`#13580 : improved documentation`|



---

archive/issue_comments_204600.json:
```json
{
    "body": "Changing commit from \"734c74810e63321463e4bca7bcf0da85dffc47b9\" to \"f234f60f37e007365c2aec1b4defea55ff255c70\"",
    "created_at": "2015-05-21T15:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204600",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "734c74810e63321463e4bca7bcf0da85dffc47b9" to "f234f60f37e007365c2aec1b4defea55ff255c70"



---

archive/issue_comments_204601.json:
```json
{
    "body": "Changing commit from \"f234f60f37e007365c2aec1b4defea55ff255c70\" to \"7a33037a2d444e2f6981637d3e187cbcca72ba7d\"",
    "created_at": "2015-11-23T11:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f234f60f37e007365c2aec1b4defea55ff255c70" to "7a33037a2d444e2f6981637d3e187cbcca72ba7d"



---

archive/issue_comments_204602.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[171be75](http://git.sagemath.org/sage.git/commit/?id=171be755e22c8f552d2e80506d55304881a907e2)|`Merge branch 'master' into t/13580/13580/map_reduce`|\n|[bfdf33e](http://git.sagemath.org/sage.git/commit/?id=bfdf33e488973f4f416f2335a212dee4d3ca3287)|`Fixed naming convention`|\n|[7a33037](http://git.sagemath.org/sage.git/commit/?id=7a33037a2d444e2f6981637d3e187cbcca72ba7d)|`Work in progress on the DOC`|",
    "created_at": "2015-11-23T11:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204602",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[171be75](http://git.sagemath.org/sage.git/commit/?id=171be755e22c8f552d2e80506d55304881a907e2)|`Merge branch 'master' into t/13580/13580/map_reduce`|
|[bfdf33e](http://git.sagemath.org/sage.git/commit/?id=bfdf33e488973f4f416f2335a212dee4d3ca3287)|`Fixed naming convention`|
|[7a33037](http://git.sagemath.org/sage.git/commit/?id=7a33037a2d444e2f6981637d3e187cbcca72ba7d)|`Work in progress on the DOC`|



---

archive/issue_comments_204603.json:
```json
{
    "body": "Changing commit from \"7a33037a2d444e2f6981637d3e187cbcca72ba7d\" to \"168ceae047328c6c529e0ce70d91a4300efabe29\"",
    "created_at": "2015-11-26T11:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204603",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7a33037a2d444e2f6981637d3e187cbcca72ba7d" to "168ceae047328c6c529e0ce70d91a4300efabe29"



---

archive/issue_comments_204604.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[168ceae](http://git.sagemath.org/sage.git/commit/?id=168ceae047328c6c529e0ce70d91a4300efabe29)|`Added architecture picture for map_reduce`|",
    "created_at": "2015-11-26T11:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204604",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[168ceae](http://git.sagemath.org/sage.git/commit/?id=168ceae047328c6c529e0ce70d91a4300efabe29)|`Added architecture picture for map_reduce`|



---

archive/issue_comments_204605.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |          |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------|\n|[366fc17](http://git.sagemath.org/sage.git/commit/?id=366fc174904f11f97196c0da38e53d949b236b1f)|`More Doc`|\n|[6c12752](http://git.sagemath.org/sage.git/commit/?id=6c127527dfcd62673f2d871616a22b95a4b368e9)|`Tested timeout option`|",
    "created_at": "2015-12-01T08:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204605",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |          |
|------------------------------------------------------------------------------------------------------------------------------------------|----------|
|[366fc17](http://git.sagemath.org/sage.git/commit/?id=366fc174904f11f97196c0da38e53d949b236b1f)|`More Doc`|
|[6c12752](http://git.sagemath.org/sage.git/commit/?id=6c127527dfcd62673f2d871616a22b95a4b368e9)|`Tested timeout option`|



---

archive/issue_comments_204606.json:
```json
{
    "body": "Changing commit from \"168ceae047328c6c529e0ce70d91a4300efabe29\" to \"6c127527dfcd62673f2d871616a22b95a4b368e9\"",
    "created_at": "2015-12-01T08:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "168ceae047328c6c529e0ce70d91a4300efabe29" to "6c127527dfcd62673f2d871616a22b95a4b368e9"



---

archive/issue_comments_204607.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|\n|[493bb52](http://git.sagemath.org/sage.git/commit/?id=493bb52f98bb2551eb557528fbfc2d6a908bd38d)|`Done the doc of Map/Reduce`|",
    "created_at": "2015-12-14T13:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204607",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
|[493bb52](http://git.sagemath.org/sage.git/commit/?id=493bb52f98bb2551eb557528fbfc2d6a908bd38d)|`Done the doc of Map/Reduce`|



---

archive/issue_comments_204608.json:
```json
{
    "body": "Changing commit from \"6c127527dfcd62673f2d871616a22b95a4b368e9\" to \"493bb52f98bb2551eb557528fbfc2d6a908bd38d\"",
    "created_at": "2015-12-14T13:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204608",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6c127527dfcd62673f2d871616a22b95a4b368e9" to "493bb52f98bb2551eb557528fbfc2d6a908bd38d"



---

archive/issue_comments_204609.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[2534f12](http://git.sagemath.org/sage.git/commit/?id=2534f12eaf4a820c6e9a76894aabf19775b8ba05)|`Moved map/reduce to sage/parallel`|",
    "created_at": "2015-12-14T13:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[2534f12](http://git.sagemath.org/sage.git/commit/?id=2534f12eaf4a820c6e9a76894aabf19775b8ba05)|`Moved map/reduce to sage/parallel`|



---

archive/issue_comments_204610.json:
```json
{
    "body": "Changing commit from \"493bb52f98bb2551eb557528fbfc2d6a908bd38d\" to \"2534f12eaf4a820c6e9a76894aabf19775b8ba05\"",
    "created_at": "2015-12-14T13:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204610",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "493bb52f98bb2551eb557528fbfc2d6a908bd38d" to "2534f12eaf4a820c6e9a76894aabf19775b8ba05"



---

archive/issue_comments_204611.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,2 @@\n-Implement a map reduce algorithm in parallel on large sets described by a `SearchForest`.\n+Implement a map reduce algorithm in parallel on large sets described by a `SearchForest`. We use a work-stealing algorithm (see https://en.wikipedia.org/wiki/Work_stealing) based on Python's multiprocessing. \n \n``````\n",
    "created_at": "2015-12-14T14:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204611",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,2 @@
-Implement a map reduce algorithm in parallel on large sets described by a `SearchForest`.
+Implement a map reduce algorithm in parallel on large sets described by a `SearchForest`. We use a work-stealing algorithm (see https://en.wikipedia.org/wiki/Work_stealing) based on Python's multiprocessing. 
 
``````




---

archive/issue_comments_204612.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-12-14T14:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204612",
    "user": "https://github.com/hivert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_204613.json:
```json
{
    "body": "<a id='comment:21'></a>\nThe branch currently have conflicts with development version of Sage (because the link is red in the description of the ticket above). The branch seems to be based on 6.2.beta6 which is old and may explain the presence of a conflict.",
    "created_at": "2015-12-14T16:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204613",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:21'></a>
The branch currently have conflicts with development version of Sage (because the link is red in the description of the ticket above). The branch seems to be based on 6.2.beta6 which is old and may explain the presence of a conflict.



---

archive/issue_comments_204614.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-14T16:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204614",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_204615.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [slabbe](#comment%3A21):\n> The branch currently have conflicts with development version of Sage (because the link is red in the description of the ticket above). The branch seems to be based on 6.2.beta6 which is old and may explain the presence of a conflict.\n\n\nYes ! there is a trivial conflict. Thank you for pointing it. I'm fixing it, testing and re-uploading.",
    "created_at": "2015-12-14T19:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204615",
    "user": "https://github.com/hivert"
}
```

<a id='comment:22'></a>
Replying to [slabbe](#comment%3A21):
> The branch currently have conflicts with development version of Sage (because the link is red in the description of the ticket above). The branch seems to be based on 6.2.beta6 which is old and may explain the presence of a conflict.


Yes ! there is a trivial conflict. Thank you for pointing it. I'm fixing it, testing and re-uploading.



---

archive/issue_comments_204616.json:
```json
{
    "body": "Changing commit from \"2534f12eaf4a820c6e9a76894aabf19775b8ba05\" to \"e5b74770eec0b0e93e22a70358bc83f16893ce2a\"",
    "created_at": "2015-12-14T20:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2534f12eaf4a820c6e9a76894aabf19775b8ba05" to "e5b74770eec0b0e93e22a70358bc83f16893ce2a"



---

archive/issue_comments_204617.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[e5b7477](http://git.sagemath.org/sage.git/commit/?id=e5b74770eec0b0e93e22a70358bc83f16893ce2a)|`Merge 6.10.rc1 + fixed conflict`|",
    "created_at": "2015-12-14T20:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[e5b7477](http://git.sagemath.org/sage.git/commit/?id=e5b74770eec0b0e93e22a70358bc83f16893ce2a)|`Merge 6.10.rc1 + fixed conflict`|



---

archive/issue_comments_204618.json:
```json
{
    "body": "Changing commit from \"e5b74770eec0b0e93e22a70358bc83f16893ce2a\" to \"82fd1e47599b75ef22133d18199ed1ee15478f5d\"",
    "created_at": "2015-12-14T20:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e5b74770eec0b0e93e22a70358bc83f16893ce2a" to "82fd1e47599b75ef22133d18199ed1ee15478f5d"



---

archive/issue_comments_204619.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[82fd1e4](http://git.sagemath.org/sage.git/commit/?id=82fd1e47599b75ef22133d18199ed1ee15478f5d)|`Fixed links according to deprecation/rebase`|",
    "created_at": "2015-12-14T20:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204619",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[82fd1e4](http://git.sagemath.org/sage.git/commit/?id=82fd1e47599b75ef22133d18199ed1ee15478f5d)|`Fixed links according to deprecation/rebase`|



---

archive/issue_comments_204620.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [hivert](#comment%3A22):\n> Replying to [slabbe](#comment%3A21):\n> > The branch currently have conflicts with development version of Sage (because the link is red in the description of the ticket above). The branch seems to be based on 6.2.beta6 which is old and may explain the presence of a conflict.\n\n> \n> Yes ! there is a trivial conflict. Thank you for pointing it. I'm fixing it, testing and re-uploading.\n\n\nDone ! I was actually based on 6.9.",
    "created_at": "2015-12-14T20:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204620",
    "user": "https://github.com/hivert"
}
```

<a id='comment:25'></a>
Replying to [hivert](#comment%3A22):
> Replying to [slabbe](#comment%3A21):
> > The branch currently have conflicts with development version of Sage (because the link is red in the description of the ticket above). The branch seems to be based on 6.2.beta6 which is old and may explain the presence of a conflict.

> 
> Yes ! there is a trivial conflict. Thank you for pointing it. I'm fixing it, testing and re-uploading.


Done ! I was actually based on 6.9.



---

archive/issue_comments_204621.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-14T20:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204621",
    "user": "https://github.com/hivert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204622.json:
```json
{
    "body": "Changing commit from \"82fd1e47599b75ef22133d18199ed1ee15478f5d\" to \"68b6530ecc825e773bdd34b09a98b21eb4d8987c\"",
    "created_at": "2015-12-14T21:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "82fd1e47599b75ef22133d18199ed1ee15478f5d" to "68b6530ecc825e773bdd34b09a98b21eb4d8987c"



---

archive/issue_comments_204623.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[68b6530](http://git.sagemath.org/sage.git/commit/?id=68b6530ecc825e773bdd34b09a98b21eb4d8987c)|`Removed TODO in doc`|",
    "created_at": "2015-12-14T21:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                     |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[68b6530](http://git.sagemath.org/sage.git/commit/?id=68b6530ecc825e773bdd34b09a98b21eb4d8987c)|`Removed TODO in doc`|



---

archive/issue_comments_204624.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[b93ba7d](http://git.sagemath.org/sage.git/commit/?id=b93ba7da6f57a9fd6f02469819f4d3ce0c2f289b)|`Fixed a link + doctest`|",
    "created_at": "2015-12-14T22:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[b93ba7d](http://git.sagemath.org/sage.git/commit/?id=b93ba7da6f57a9fd6f02469819f4d3ce0c2f289b)|`Fixed a link + doctest`|



---

archive/issue_comments_204625.json:
```json
{
    "body": "Changing commit from \"68b6530ecc825e773bdd34b09a98b21eb4d8987c\" to \"b93ba7da6f57a9fd6f02469819f4d3ce0c2f289b\"",
    "created_at": "2015-12-14T22:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "68b6530ecc825e773bdd34b09a98b21eb4d8987c" to "b93ba7da6f57a9fd6f02469819f4d3ce0c2f289b"



---

archive/issue_comments_204626.json:
```json
{
    "body": "Changing commit from \"b93ba7da6f57a9fd6f02469819f4d3ce0c2f289b\" to \"5c7720dae1034f1b2e04bb9abb3ea90797de55ee\"",
    "created_at": "2015-12-15T07:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204626",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b93ba7da6f57a9fd6f02469819f4d3ce0c2f289b" to "5c7720dae1034f1b2e04bb9abb3ea90797de55ee"



---

archive/issue_comments_204627.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[5c7720d](http://git.sagemath.org/sage.git/commit/?id=5c7720dae1034f1b2e04bb9abb3ea90797de55ee)|`Fixed doctest continuations and raise statements`|",
    "created_at": "2015-12-15T07:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204627",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[5c7720d](http://git.sagemath.org/sage.git/commit/?id=5c7720dae1034f1b2e04bb9abb3ea90797de55ee)|`Fixed doctest continuations and raise statements`|



---

archive/issue_comments_204628.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [git](#comment%3A29):\n> |                                                                                                                                          |                                                  |\n> |------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n> |[5c7720d](http://git.sagemath.org/sage.git/commit/?id=5c7720dae1034f1b2e04bb9abb3ea90797de55ee)|`Fixed doctest continuations and raise statements`|\n\n\nPatchbot was complaining about old style multiline doctests and exception raises. Fixed and reuped. Should be Ok now.",
    "created_at": "2015-12-15T07:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204628",
    "user": "https://github.com/hivert"
}
```

<a id='comment:30'></a>
Replying to [git](#comment%3A29):
> |                                                                                                                                          |                                                  |
> |------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
> |[5c7720d](http://git.sagemath.org/sage.git/commit/?id=5c7720dae1034f1b2e04bb9abb3ea90797de55ee)|`Fixed doctest continuations and raise statements`|


Patchbot was complaining about old style multiline doctests and exception raises. Fixed and reuped. Should be Ok now.



---

archive/issue_comments_204629.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[cb9c011](http://git.sagemath.org/sage.git/commit/?id=cb9c011d0b7f2f3a736f7418c51d49ccc8c5b715)|`Fixed another multiline doctest`|",
    "created_at": "2015-12-15T16:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[cb9c011](http://git.sagemath.org/sage.git/commit/?id=cb9c011d0b7f2f3a736f7418c51d49ccc8c5b715)|`Fixed another multiline doctest`|



---

archive/issue_comments_204630.json:
```json
{
    "body": "Changing commit from \"5c7720dae1034f1b2e04bb9abb3ea90797de55ee\" to \"cb9c011d0b7f2f3a736f7418c51d49ccc8c5b715\"",
    "created_at": "2015-12-15T16:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5c7720dae1034f1b2e04bb9abb3ea90797de55ee" to "cb9c011d0b7f2f3a736f7418c51d49ccc8c5b715"



---

archive/issue_comments_204631.json:
```json
{
    "body": "<a id='comment:32'></a>\nI just looked at the code in the browser. Looks good. I will do real code review later this week hopefully. Quickly, I saw two typos:\n\nFirst line of `/src/sage/parallel/map_reduce.py` : `Paralell`\n\nLater in the same file I think: `parameters tu the`",
    "created_at": "2015-12-15T20:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204631",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:32'></a>
I just looked at the code in the browser. Looks good. I will do real code review later this week hopefully. Quickly, I saw two typos:

First line of `/src/sage/parallel/map_reduce.py` : `Paralell`

Later in the same file I think: `parameters tu the`



---

archive/issue_comments_204632.json:
```json
{
    "body": "Changing commit from \"cb9c011d0b7f2f3a736f7418c51d49ccc8c5b715\" to \"14b086beac66e6a3fe3bf6be2cd7ae0e28c20152\"",
    "created_at": "2015-12-15T21:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cb9c011d0b7f2f3a736f7418c51d49ccc8c5b715" to "14b086beac66e6a3fe3bf6be2cd7ae0e28c20152"



---

archive/issue_comments_204633.json:
```json
{
    "body": "<a id='comment:33'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[14b086b](http://git.sagemath.org/sage.git/commit/?id=14b086beac66e6a3fe3bf6be2cd7ae0e28c20152)|`Fixed Sebastien's Typos`|",
    "created_at": "2015-12-15T21:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204633",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[14b086b](http://git.sagemath.org/sage.git/commit/?id=14b086beac66e6a3fe3bf6be2cd7ae0e28c20152)|`Fixed Sebastien's Typos`|



---

archive/issue_comments_204634.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [slabbe](#comment%3A32):\n> I just looked at the code in the browser. Looks good. I will do real code review later this week hopefully. Quickly, I saw two typos:\n\n\nFixed ! I'm afraid you'll find more ! By the way, removed distributed from the title since I don't do distributed computation anymore. I had a prototype which allowed to launch those computation on a cluster of machines, but it induces a huge performance loss do I dropped It. maybe we will work on this with Jeroen...",
    "created_at": "2015-12-15T21:14:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204634",
    "user": "https://github.com/hivert"
}
```

<a id='comment:34'></a>
Replying to [slabbe](#comment%3A32):
> I just looked at the code in the browser. Looks good. I will do real code review later this week hopefully. Quickly, I saw two typos:


Fixed ! I'm afraid you'll find more ! By the way, removed distributed from the title since I don't do distributed computation anymore. I had a prototype which allowed to launch those computation on a cluster of machines, but it induces a huge performance loss do I dropped It. maybe we will work on this with Jeroen...



---

archive/issue_comments_204635.json:
```json
{
    "body": "<a id='comment:35'></a>\nDear Florent, I know that you like multiline doctests, but for two reasons I prefer to avoid them as much as possible in doctests:\n\n1. It is not fun for the user who wants to adapt an example after a copy paste in the console. The up arrow brings the multiline all at once and it is not fun to change the value 10 to a value 25 let say.\n2. Using variables to store the input before calling the method gives lot of information easily to the user: what are the argument names, in what order should they be used.\n\nI know I am asking you to change your style by asking you this, but don't you agree with me or can you provide some counter-arguments to mine? I give an example below:\n\n```diff\ndiff --git a/src/sage/combinat/backtrack.py b/src/sage/combinat/backtrack.py\nindex 9dee057..ac1243a 100644\n--- a/src/sage/combinat/backtrack.py\n+++ b/src/sage/combinat/backtrack.py\n@@ -695,17 +695,19 @@ class SearchForest(Parent):\n                    reduce_function = None,\n                    reduce_init = None):\n         r\"\"\"\n-        Apply en Map Reduce algorithm on ``self``\n+        Apply a Map Reduce algorithm on ``self``\n \n         EXAMPLES::\n \n-            sage: F = RecursivelyEnumeratedSet( [([i],i, i) for i in range(1,10)],\n-            ....:     lambda (list, sum, last):\n-            ....:         [(list + [i], sum + i, i) for i in range(1,last)],\n-            ....:     structure='forest', enumeration='depth')\n+            sage: seeds = [([i],i, i) for i in range(1,10)]\n+            sage: succ = lambda (list, sum, last): \n+            ....:               [(list + [i], sum + i, i) for i in range(1,last)]\n+            sage: F = RecursivelyEnumeratedSet(seeds, succ, \n+            ....:                       structure='forest', enumeration='depth')\n             sage: y = var('y')\n-            sage: F.map_reduce(\n-            ....:     lambda (li, sum, _): y**sum, lambda x,y: x + y,  0 )\n+            sage: map_function = lambda (li, sum, _): y**sum\n+            sage: reduce_function = lambda x,y: x + y\n+            sage: F.map_reduce(map_function, reduce_function, 0)\n             y^45 + y^44 + y^43 + 2*y^42 + 2*y^41 + 3*y^40 + 4*y^39 + 5*y^38 + 6*y^37 + 8*y^36 + 9*y^35 \n \n         .. SEEALSO:: :mod:`sage.parallel.map_reduce`\n```\n\nI noticed another typo on the same line as the one `parameters tu the` : `On` -> `One`",
    "created_at": "2015-12-16T11:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204635",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:35'></a>
Dear Florent, I know that you like multiline doctests, but for two reasons I prefer to avoid them as much as possible in doctests:

1. It is not fun for the user who wants to adapt an example after a copy paste in the console. The up arrow brings the multiline all at once and it is not fun to change the value 10 to a value 25 let say.
2. Using variables to store the input before calling the method gives lot of information easily to the user: what are the argument names, in what order should they be used.

I know I am asking you to change your style by asking you this, but don't you agree with me or can you provide some counter-arguments to mine? I give an example below:

```diff
diff --git a/src/sage/combinat/backtrack.py b/src/sage/combinat/backtrack.py
index 9dee057..ac1243a 100644
--- a/src/sage/combinat/backtrack.py
+++ b/src/sage/combinat/backtrack.py
@@ -695,17 +695,19 @@ class SearchForest(Parent):
                    reduce_function = None,
                    reduce_init = None):
         r"""
-        Apply en Map Reduce algorithm on ``self``
+        Apply a Map Reduce algorithm on ``self``
 
         EXAMPLES::
 
-            sage: F = RecursivelyEnumeratedSet( [([i],i, i) for i in range(1,10)],
-            ....:     lambda (list, sum, last):
-            ....:         [(list + [i], sum + i, i) for i in range(1,last)],
-            ....:     structure='forest', enumeration='depth')
+            sage: seeds = [([i],i, i) for i in range(1,10)]
+            sage: succ = lambda (list, sum, last): 
+            ....:               [(list + [i], sum + i, i) for i in range(1,last)]
+            sage: F = RecursivelyEnumeratedSet(seeds, succ, 
+            ....:                       structure='forest', enumeration='depth')
             sage: y = var('y')
-            sage: F.map_reduce(
-            ....:     lambda (li, sum, _): y**sum, lambda x,y: x + y,  0 )
+            sage: map_function = lambda (li, sum, _): y**sum
+            sage: reduce_function = lambda x,y: x + y
+            sage: F.map_reduce(map_function, reduce_function, 0)
             y^45 + y^44 + y^43 + 2*y^42 + 2*y^41 + 3*y^40 + 4*y^39 + 5*y^38 + 6*y^37 + 8*y^36 + 9*y^35 
 
         .. SEEALSO:: :mod:`sage.parallel.map_reduce`
```

I noticed another typo on the same line as the one `parameters tu the` : `On` -> `One`



---

archive/issue_comments_204636.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [slabbe](#comment%3A35):\n> Dear Florent, I know that you like multiline doctests, but for two reasons I prefer to avoid them as much as possible in doctests:\n> \n> 1. It is not fun for the user who wants to adapt an example after a copy paste in the console. The up arrow brings the multiline all at once and it is not fun to change the value 10 to a value 25 let say.\n\n\nI'm tempted to answer that I don't have this problem with emacs ;-). Of course, for the people using a two letters editor...\n\n>  2. Using variables to store the input before calling the method gives lot of information easily to the user: what are the argument names, in what order should they be used.\n\n\nI'm much more convinced by this argument. I'm watching an exam tomorrow evening. I'll change my code accordingly.",
    "created_at": "2015-12-16T23:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204636",
    "user": "https://github.com/hivert"
}
```

<a id='comment:36'></a>
Replying to [slabbe](#comment%3A35):
> Dear Florent, I know that you like multiline doctests, but for two reasons I prefer to avoid them as much as possible in doctests:
> 
> 1. It is not fun for the user who wants to adapt an example after a copy paste in the console. The up arrow brings the multiline all at once and it is not fun to change the value 10 to a value 25 let say.


I'm tempted to answer that I don't have this problem with emacs ;-). Of course, for the people using a two letters editor...

>  2. Using variables to store the input before calling the method gives lot of information easily to the user: what are the argument names, in what order should they be used.


I'm much more convinced by this argument. I'm watching an exam tomorrow evening. I'll change my code accordingly.



---

archive/issue_comments_204637.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [hivert](#comment%3A36):\n> I'm much more convinced by this argument. I'm watching an exam tomorrow evening. I'll change my code accordingly.\n\n\nActually, I'm not that much convinced. It's not clear for me that\n\n```\n      sage: map_function = lambda x: 1\n      sage: reduce_function = lambda x,y: x+y\n      sage: reduce_init = 0\n      sage: S.map_reduce(map_function, reduce_function, reduce_init)\n      131071\n```\nis much better than\n\n```\n      sage: S.map_reduce(\n      ....:   map_function = lambda x: 1,\n      ....:   reduce_function = lambda x,y: x+y,\n      ....:   reduce_init = 0 )\n```\nIn this second version which is the style I adopted in `map_reduce.py`, we don't repeat the name twice, which is better in my opinion.\n\nA third possibility is\n\n```\n      sage: S.map_reduce(lambda x: 1, lambda x,y: x+y, 0)\n```\nIt is the one used through the whole `backtrack.py` files. Unless for very short example, I don't find it very readable. But since it's not adding new code but changing old one, which needs even more cleanup and doc improvement, I'd rather keep it for another ticket. More precisly, I'd rather do that during #16351.\n\nWhat do you think ?",
    "created_at": "2015-12-17T13:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204637",
    "user": "https://github.com/hivert"
}
```

<a id='comment:37'></a>
Replying to [hivert](#comment%3A36):
> I'm much more convinced by this argument. I'm watching an exam tomorrow evening. I'll change my code accordingly.


Actually, I'm not that much convinced. It's not clear for me that

```
      sage: map_function = lambda x: 1
      sage: reduce_function = lambda x,y: x+y
      sage: reduce_init = 0
      sage: S.map_reduce(map_function, reduce_function, reduce_init)
      131071
```
is much better than

```
      sage: S.map_reduce(
      ....:   map_function = lambda x: 1,
      ....:   reduce_function = lambda x,y: x+y,
      ....:   reduce_init = 0 )
```
In this second version which is the style I adopted in `map_reduce.py`, we don't repeat the name twice, which is better in my opinion.

A third possibility is

```
      sage: S.map_reduce(lambda x: 1, lambda x,y: x+y, 0)
```
It is the one used through the whole `backtrack.py` files. Unless for very short example, I don't find it very readable. But since it's not adding new code but changing old one, which needs even more cleanup and doc improvement, I'd rather keep it for another ticket. More precisly, I'd rather do that during #16351.

What do you think ?



---

archive/issue_comments_204638.json:
```json
{
    "body": "<a id='comment:38'></a>\nI'm not sure to understand the patchbot complaint ? Is it because the `map_reduce` is not imported as Sage's startup ?",
    "created_at": "2015-12-17T13:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204638",
    "user": "https://github.com/hivert"
}
```

<a id='comment:38'></a>
I'm not sure to understand the patchbot complaint ? Is it because the `map_reduce` is not imported as Sage's startup ?



---

archive/issue_comments_204639.json:
```json
{
    "body": "<a id='comment:39'></a>\nI just uploaded a doc improvement: the `map_reduce` function was missing the description of the input.",
    "created_at": "2015-12-17T14:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204639",
    "user": "https://github.com/hivert"
}
```

<a id='comment:39'></a>
I just uploaded a doc improvement: the `map_reduce` function was missing the description of the input.



---

archive/issue_comments_204640.json:
```json
{
    "body": "<a id='comment:40'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------|\n|[e3c4c71](http://git.sagemath.org/sage.git/commit/?id=e3c4c716b4dbd9650f06de80e6477bb4e9d36a1c)|`Doc improvements`|",
    "created_at": "2015-12-17T14:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------|
|[e3c4c71](http://git.sagemath.org/sage.git/commit/?id=e3c4c716b4dbd9650f06de80e6477bb4e9d36a1c)|`Doc improvements`|



---

archive/issue_comments_204641.json:
```json
{
    "body": "Changing commit from \"14b086beac66e6a3fe3bf6be2cd7ae0e28c20152\" to \"e3c4c716b4dbd9650f06de80e6477bb4e9d36a1c\"",
    "created_at": "2015-12-17T14:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204641",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "14b086beac66e6a3fe3bf6be2cd7ae0e28c20152" to "e3c4c716b4dbd9650f06de80e6477bb4e9d36a1c"



---

archive/issue_comments_204642.json:
```json
{
    "body": "Changing commit from \"e3c4c716b4dbd9650f06de80e6477bb4e9d36a1c\" to \"31c4735651aa4f56c7e6899e6352669fa2b21d99\"",
    "created_at": "2015-12-17T18:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204642",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e3c4c716b4dbd9650f06de80e6477bb4e9d36a1c" to "31c4735651aa4f56c7e6899e6352669fa2b21d99"



---

archive/issue_comments_204643.json:
```json
{
    "body": "<a id='comment:41'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[31c4735](http://git.sagemath.org/sage.git/commit/?id=31c4735651aa4f56c7e6899e6352669fa2b21d99)|`Removed unneded import in pxd`|",
    "created_at": "2015-12-17T18:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[31c4735](http://git.sagemath.org/sage.git/commit/?id=31c4735651aa4f56c7e6899e6352669fa2b21d99)|`Removed unneded import in pxd`|



---

archive/issue_comments_204644.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [hivert](#comment%3A37):\n> What do you think ?\n\n\nI think that some doctest are more important than other, especially the first doctests that people might be expected to see when using the map reduce code. For example the `map_reduce` method in the recursively enumerated set file is one possible entry point where clarity of doctests matters more. Therefore, I like the way you change the doctest. Definitively, the top of the module is an important entry point. For other sub methods of the class map reduce, I care less...",
    "created_at": "2015-12-18T14:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204644",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:42'></a>
Replying to [hivert](#comment%3A37):
> What do you think ?


I think that some doctest are more important than other, especially the first doctests that people might be expected to see when using the map reduce code. For example the `map_reduce` method in the recursively enumerated set file is one possible entry point where clarity of doctests matters more. Therefore, I like the way you change the doctest. Definitively, the top of the module is an important entry point. For other sub methods of the class map reduce, I care less...



---

archive/issue_comments_204645.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [hivert](#comment%3A38):\n> I'm not sure to understand the patchbot complaint ? Is it because the `map_reduce` is not imported as Sage's startup ?  \n\n\nI don't see why neither...",
    "created_at": "2015-12-18T14:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204645",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:43'></a>
Replying to [hivert](#comment%3A38):
> I'm not sure to understand the patchbot complaint ? Is it because the `map_reduce` is not imported as Sage's startup ?  


I don't see why neither...



---

archive/issue_comments_204646.json:
```json
{
    "body": "<a id='comment:44'></a>\n`Event`, `Condition`, `time` and `os` are imported in map_reduce file but are not used.",
    "created_at": "2015-12-18T16:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204646",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:44'></a>
`Event`, `Condition`, `time` and `os` are imported in map_reduce file but are not used.



---

archive/issue_comments_204647.json:
```json
{
    "body": "<a id='comment:45'></a>\nIs there a reason why you use `res=[\"\"]` and `res[0]` in `print_communication_statistics` instead of `res=\"\"` and `res`?",
    "created_at": "2015-12-18T16:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204647",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:45'></a>
Is there a reason why you use `res=[""]` and `res[0]` in `print_communication_statistics` instead of `res=""` and `res`?



---

archive/issue_comments_204648.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [slabbe](#comment%3A45):\n> Is there a reason why you use `res=[\"\"]` and `res[0]` in `print_communication_statistics` instead of `res=\"\"` and `res`?\n\n\nYes ! This is the classical trick to have a local variable shared with the local function (see e.g: http://stackoverflow.com/questions/2609518/python-nested-function-scopes).",
    "created_at": "2015-12-18T17:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204648",
    "user": "https://github.com/hivert"
}
```

<a id='comment:46'></a>
Replying to [slabbe](#comment%3A45):
> Is there a reason why you use `res=[""]` and `res[0]` in `print_communication_statistics` instead of `res=""` and `res`?


Yes ! This is the classical trick to have a local variable shared with the local function (see e.g: http://stackoverflow.com/questions/2609518/python-nested-function-scopes).



---

archive/issue_comments_204649.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [slabbe](#comment%3A44):\n> `Event`, `Condition`, `time` and `os` are imported in map_reduce file but are not used.\n\n\nFixed in my last push.",
    "created_at": "2015-12-18T17:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204649",
    "user": "https://github.com/hivert"
}
```

<a id='comment:47'></a>
Replying to [slabbe](#comment%3A44):
> `Event`, `Condition`, `time` and `os` are imported in map_reduce file but are not used.


Fixed in my last push.



---

archive/issue_comments_204650.json:
```json
{
    "body": "Changing commit from \"31c4735651aa4f56c7e6899e6352669fa2b21d99\" to \"cca788124c7eb757cceda7cb7a73f9af28149a1e\"",
    "created_at": "2015-12-18T17:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "31c4735651aa4f56c7e6899e6352669fa2b21d99" to "cca788124c7eb757cceda7cb7a73f9af28149a1e"



---

archive/issue_comments_204651.json:
```json
{
    "body": "<a id='comment:48'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[cca7881](http://git.sagemath.org/sage.git/commit/?id=cca788124c7eb757cceda7cb7a73f9af28149a1e)|`Removed unneeded import`|",
    "created_at": "2015-12-18T17:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204651",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[cca7881](http://git.sagemath.org/sage.git/commit/?id=cca788124c7eb757cceda7cb7a73f9af28149a1e)|`Removed unneeded import`|



---

archive/issue_comments_204652.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [slabbe](#comment%3A43): \n> I don't see why neither...\n\n\nAccording to Vincent on Sage devel it is probably a bug of the patchbot (see https://groups.google.com/forum/#!topic/sage-devel/xlpLwktA5Hk).",
    "created_at": "2015-12-18T17:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204652",
    "user": "https://github.com/hivert"
}
```

<a id='comment:49'></a>
Replying to [slabbe](#comment%3A43): 
> I don't see why neither...


According to Vincent on Sage devel it is probably a bug of the patchbot (see https://groups.google.com/forum/#!topic/sage-devel/xlpLwktA5Hk).



---

archive/issue_comments_204653.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [hivert](#comment%3A46):\n> Replying to [slabbe](#comment%3A45):\n> > Is there a reason why you use `res=[\"\"]` and `res[0]` in `print_communication_statistics` instead of `res=\"\"` and `res`?\n\n> \n> Yes ! This is the classical trick to have a local variable shared with the local function (see e.g: http://stackoverflow.com/questions/2609518/python-nested-function-scopes).\n\n\nCould you add this information inside the code of that method?",
    "created_at": "2015-12-21T10:56:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204653",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:50'></a>
Replying to [hivert](#comment%3A46):
> Replying to [slabbe](#comment%3A45):
> > Is there a reason why you use `res=[""]` and `res[0]` in `print_communication_statistics` instead of `res=""` and `res`?

> 
> Yes ! This is the classical trick to have a local variable shared with the local function (see e.g: http://stackoverflow.com/questions/2609518/python-nested-function-scopes).


Could you add this information inside the code of that method?



---

archive/issue_comments_204654.json:
```json
{
    "body": "<a id='comment:51'></a>\n`map_reduce` method of `SearchForest` should document what happen when this method is called with no arguments, i.e. returns the cardinality. More precisely, it should say that the value `None` for arguments `map_function` and `reduce_function` is replaced by what?",
    "created_at": "2015-12-21T13:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204654",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:51'></a>
`map_reduce` method of `SearchForest` should document what happen when this method is called with no arguments, i.e. returns the cardinality. More precisely, it should say that the value `None` for arguments `map_function` and `reduce_function` is replaced by what?



---

archive/issue_comments_204655.json:
```json
{
    "body": "<a id='comment:52'></a>\n`On can use the three following parameters:` -> `One can use the three following parameters:`",
    "created_at": "2015-12-21T13:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204655",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:52'></a>
`On can use the three following parameters:` -> `One can use the three following parameters:`



---

archive/issue_comments_204656.json:
```json
{
    "body": "<a id='comment:53'></a>\nI get the following doctests error on top on sage-6.10 on my machine:\n\n```\nGit branch: 13580\nUsing --optional=gcc,mpir,python2,sage\nDoctesting 1 file.\nsage -t --warn-long 85.4 map_reduce.py\n**********************************************************************\nFile \"map_reduce.py\", line 960, in sage.parallel.map_reduce.RESetMapReduce._signal_task_start\nFailed example:\n    S._active_tasks\nExpected:\n    <Semaphore(value=2)>\nGot:\n    <Semaphore(value=unknown)>\n**********************************************************************\nFile \"map_reduce.py\", line 964, in sage.parallel.map_reduce.RESetMapReduce._signal_task_start\nFailed example:\n    S._active_tasks\nExpected:\n    <Semaphore(value=3)>\nGot:\n    <Semaphore(value=unknown)>\n**********************************************************************\nFile \"map_reduce.py\", line 985, in sage.parallel.map_reduce.RESetMapReduce._signal_task_done\nFailed example:\n    S._active_tasks\nExpected:\n    <Semaphore(value=2)>\nGot:\n    <Semaphore(value=unknown)>\n**********************************************************************\nFile \"map_reduce.py\", line 989, in sage.parallel.map_reduce.RESetMapReduce._signal_task_done\nFailed example:\n    S._active_tasks\nExpected:\n    <Semaphore(value=1)>\nGot:\n    <Semaphore(value=unknown)>\n**********************************************************************\n2 items had failures:\n   2 of   9 in sage.parallel.map_reduce.RESetMapReduce._signal_task_done\n   2 of   7 in sage.parallel.map_reduce.RESetMapReduce._signal_task_start\n    [249 tests, 4 failures, 43.04 s]\n----------------------------------------------------------------------\nsage -t --warn-long 85.4 map_reduce.py  # 4 doctests failed\n----------------------------------------------------------------------\n```\n\nIt seems ok on patchbot reporting seemingly unrelated errors :\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/interfaces/expect.py  # Timed out\nsage -t --long src/sage/interfaces/gap.py  # 10 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2015-12-21T14:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204656",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:53'></a>
I get the following doctests error on top on sage-6.10 on my machine:

```
Git branch: 13580
Using --optional=gcc,mpir,python2,sage
Doctesting 1 file.
sage -t --warn-long 85.4 map_reduce.py
**********************************************************************
File "map_reduce.py", line 960, in sage.parallel.map_reduce.RESetMapReduce._signal_task_start
Failed example:
    S._active_tasks
Expected:
    <Semaphore(value=2)>
Got:
    <Semaphore(value=unknown)>
**********************************************************************
File "map_reduce.py", line 964, in sage.parallel.map_reduce.RESetMapReduce._signal_task_start
Failed example:
    S._active_tasks
Expected:
    <Semaphore(value=3)>
Got:
    <Semaphore(value=unknown)>
**********************************************************************
File "map_reduce.py", line 985, in sage.parallel.map_reduce.RESetMapReduce._signal_task_done
Failed example:
    S._active_tasks
Expected:
    <Semaphore(value=2)>
Got:
    <Semaphore(value=unknown)>
**********************************************************************
File "map_reduce.py", line 989, in sage.parallel.map_reduce.RESetMapReduce._signal_task_done
Failed example:
    S._active_tasks
Expected:
    <Semaphore(value=1)>
Got:
    <Semaphore(value=unknown)>
**********************************************************************
2 items had failures:
   2 of   9 in sage.parallel.map_reduce.RESetMapReduce._signal_task_done
   2 of   7 in sage.parallel.map_reduce.RESetMapReduce._signal_task_start
    [249 tests, 4 failures, 43.04 s]
----------------------------------------------------------------------
sage -t --warn-long 85.4 map_reduce.py  # 4 doctests failed
----------------------------------------------------------------------
```

It seems ok on patchbot reporting seemingly unrelated errors :

```
----------------------------------------------------------------------
sage -t --long src/sage/interfaces/expect.py  # Timed out
sage -t --long src/sage/interfaces/gap.py  # 10 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_204657.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-21T14:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204657",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_204658.json:
```json
{
    "body": "<a id='comment:54'></a>\nI divided the review in a stack of tasks but since I am unable to parallelize my working time, I did the review serially with many interruptions during the previous days:)\n\nI finished to look at what I wanted to look at. The documentation compiles good and helps to understand what is happening. I was able to test the parallel computation on at least one extensive example. To me it will be a positive review after my previous four comments are answered.",
    "created_at": "2015-12-21T14:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204658",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:54'></a>
I divided the review in a stack of tasks but since I am unable to parallelize my working time, I did the review serially with many interruptions during the previous days:)

I finished to look at what I wanted to look at. The documentation compiles good and helps to understand what is happening. I was able to test the parallel computation on at least one extensive example. To me it will be a positive review after my previous four comments are answered.



---

archive/issue_comments_204659.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [slabbe](#comment%3A53):\n> I get the following doctests error on top on sage-6.10 on my machine:\n> \n> \n> ```\n> Expected:\n>     <Semaphore(value=1)>\n> Got:\n>     <Semaphore(value=unknown)>\n> ```\n\n\nIs this happening on MacOS ? I know that Semaphore are implemented differently on this system. See in particular [the note](https://docs.python.org/2/library/multiprocessing.html#synchronization-primitives) after class `multiprocessing.BoundedSemaphore`, where it says:\n\n    on Unix platforms like Mac OS X where sem_getvalue() is not implemented.\n\nIf so and if the rests behave correctly, I'm tempted to replace the doctests with\n\n```\n    <Semaphore(value=...)>\n```\n\nWhat do you think ?",
    "created_at": "2015-12-21T14:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204659",
    "user": "https://github.com/hivert"
}
```

<a id='comment:55'></a>
Replying to [slabbe](#comment%3A53):
> I get the following doctests error on top on sage-6.10 on my machine:
> 
> 
> ```
> Expected:
>     <Semaphore(value=1)>
> Got:
>     <Semaphore(value=unknown)>
> ```


Is this happening on MacOS ? I know that Semaphore are implemented differently on this system. See in particular [the note](https://docs.python.org/2/library/multiprocessing.html#synchronization-primitives) after class `multiprocessing.BoundedSemaphore`, where it says:

    on Unix platforms like Mac OS X where sem_getvalue() is not implemented.

If so and if the rests behave correctly, I'm tempted to replace the doctests with

```
    <Semaphore(value=...)>
```

What do you think ?



---

archive/issue_comments_204660.json:
```json
{
    "body": "<a id='comment:56'></a>\nReplying to [slabbe](#comment%3A51):\n> `map_reduce` method of `SearchForest` should document what happen when this method is called with no arguments, i.e. returns the cardinality. More precisely, it should say that the value `None` for arguments `map_function` and `reduce_function` is replaced by what?\n\n\nI didn't document this one because I'm was not sure It was a sensible default. If you think it is then let's go for it.\n\nBy the way thanks for your careful review !!!\n\nFlorent",
    "created_at": "2015-12-21T14:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204660",
    "user": "https://github.com/hivert"
}
```

<a id='comment:56'></a>
Replying to [slabbe](#comment%3A51):
> `map_reduce` method of `SearchForest` should document what happen when this method is called with no arguments, i.e. returns the cardinality. More precisely, it should say that the value `None` for arguments `map_function` and `reduce_function` is replaced by what?


I didn't document this one because I'm was not sure It was a sensible default. If you think it is then let's go for it.

By the way thanks for your careful review !!!

Florent



---

archive/issue_comments_204661.json:
```json
{
    "body": "Changing commit from \"cca788124c7eb757cceda7cb7a73f9af28149a1e\" to \"1a8b78e378bf3909a5c4ad4b15a77df7320ab42d\"",
    "created_at": "2015-12-21T15:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cca788124c7eb757cceda7cb7a73f9af28149a1e" to "1a8b78e378bf3909a5c4ad4b15a77df7320ab42d"



---

archive/issue_comments_204662.json:
```json
{
    "body": "<a id='comment:57'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[1a8b78e](http://git.sagemath.org/sage.git/commit/?id=1a8b78e378bf3909a5c4ad4b15a77df7320ab42d)|`- MacOSX compatible doctests for semaphore.`|",
    "created_at": "2015-12-21T15:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204662",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[1a8b78e](http://git.sagemath.org/sage.git/commit/?id=1a8b78e378bf3909a5c4ad4b15a77df7320ab42d)|`- MacOSX compatible doctests for semaphore.`|



---

archive/issue_comments_204663.json:
```json
{
    "body": "<a id='comment:58'></a>\nI uploaded a patch which should address all your concerns:\n- tests on MacOSX\n- typos\n- default values documentation",
    "created_at": "2015-12-21T15:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204663",
    "user": "https://github.com/hivert"
}
```

<a id='comment:58'></a>
I uploaded a patch which should address all your concerns:
- tests on MacOSX
- typos
- default values documentation



---

archive/issue_comments_204664.json:
```json
{
    "body": "<a id='comment:59'></a>\nIntroduced typo in the previous commit: `the function costant to 1.` -> `constant`",
    "created_at": "2015-12-21T19:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204664",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:59'></a>
Introduced typo in the previous commit: `the function costant to 1.` -> `constant`



---

archive/issue_comments_204665.json:
```json
{
    "body": "<a id='comment:60'></a>\nReplying to [hivert](#comment%3A55):\n> Replying to [slabbe](#comment%3A53):\n> > I get the following doctests error on top on sage-6.10 on my machine:\n> > \n> > \n> > ```\n> > Expected:\n> >     <Semaphore(value=1)>\n> > Got:\n> >     <Semaphore(value=unknown)>\n> > ```\n\n> \n> Is this happening on MacOS ? \n\n\nYes\n\n> If so and if the rests behave correctly, I'm tempted to replace the doctests with\n> \n> ```\n>     <Semaphore(value=...)>\n> ```\n> \n> What do you think ? \n\n\nI agree. All tests passed now...",
    "created_at": "2015-12-21T19:29:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204665",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:60'></a>
Replying to [hivert](#comment%3A55):
> Replying to [slabbe](#comment%3A53):
> > I get the following doctests error on top on sage-6.10 on my machine:
> > 
> > 
> > ```
> > Expected:
> >     <Semaphore(value=1)>
> > Got:
> >     <Semaphore(value=unknown)>
> > ```

> 
> Is this happening on MacOS ? 


Yes

> If so and if the rests behave correctly, I'm tempted to replace the doctests with
> 
> ```
>     <Semaphore(value=...)>
> ```
> 
> What do you think ? 


I agree. All tests passed now...



---

archive/issue_comments_204666.json:
```json
{
    "body": "<a id='comment:61'></a>\nReplying to [hivert](#comment%3A56):\n> I didn't document this one because I'm was not sure It was a sensible default. If you think it is then let's go for it.\n\n\nI think it is a good default. Also, sometimes, you may want to set only some of the arguments and this information allows it. Finally, it's good to see that cardinality is a special case of this method.",
    "created_at": "2015-12-21T19:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204666",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:61'></a>
Replying to [hivert](#comment%3A56):
> I didn't document this one because I'm was not sure It was a sensible default. If you think it is then let's go for it.


I think it is a good default. Also, sometimes, you may want to set only some of the arguments and this information allows it. Finally, it's good to see that cardinality is a special case of this method.



---

archive/issue_comments_204667.json:
```json
{
    "body": "Changing reviewer from \"\" to \"S\u00e9bastien Labb\u00e9\"",
    "created_at": "2015-12-21T19:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204667",
    "user": "https://github.com/seblabbe"
}
```

Changing reviewer from "" to "Sébastien Labbé"



---

archive/issue_comments_204668.json:
```json
{
    "body": "<a id='comment:63'></a>\nJust to be clear: I am waiting for the `costant` -> `constant` fix to change the status to positive review.",
    "created_at": "2015-12-22T12:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204668",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:63'></a>
Just to be clear: I am waiting for the `costant` -> `constant` fix to change the status to positive review.



---

archive/issue_comments_204669.json:
```json
{
    "body": "Changing branch from \"u/hivert/13580/map_reduce\" to \"u/nthiery/13580/map_reduce\"",
    "created_at": "2015-12-24T08:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204669",
    "user": "https://github.com/nthiery"
}
```

Changing branch from "u/hivert/13580/map_reduce" to "u/nthiery/13580/map_reduce"



---

archive/issue_comments_204670.json:
```json
{
    "body": "<a id='comment:65'></a>\nTypo fixed, hence changing the status to positive review on Sebastien's behalf.\n\n---\nNew commits:\n|                                                                                                                                          |                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|\n|[98fd9e1](http://git.sagemath.org/sage.git/commit/?id=98fd9e1c7a085b1ba62d004dba6cca4c89001cd2)|`13580: typo fix`|",
    "created_at": "2015-12-24T08:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204670",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:65'></a>
Typo fixed, hence changing the status to positive review on Sebastien's behalf.

---
New commits:
|                                                                                                                                          |                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
|[98fd9e1](http://git.sagemath.org/sage.git/commit/?id=98fd9e1c7a085b1ba62d004dba6cca4c89001cd2)|`13580: typo fix`|



---

archive/issue_comments_204671.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-12-24T08:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204671",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_204672.json:
```json
{
    "body": "Changing commit from \"1a8b78e378bf3909a5c4ad4b15a77df7320ab42d\" to \"98fd9e1c7a085b1ba62d004dba6cca4c89001cd2\"",
    "created_at": "2015-12-24T08:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204672",
    "user": "https://github.com/nthiery"
}
```

Changing commit from "1a8b78e378bf3909a5c4ad4b15a77df7320ab42d" to "98fd9e1c7a085b1ba62d004dba6cca4c89001cd2"



---

archive/issue_comments_204673.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-12-24T17:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204673",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_204674.json:
```json
{
    "body": "<a id='comment:66'></a>\nFails on OSX: http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/636/steps/shell_4/logs/stdio",
    "created_at": "2015-12-24T17:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204674",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:66'></a>
Fails on OSX: http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/636/steps/shell_4/logs/stdio



---

archive/issue_comments_204675.json:
```json
{
    "body": "<a id='comment:67'></a>\nHello and merry christmas every one,\n\nI have some question on this ticket.\n\nFirstly, I don't understand the documentation from the line 571:\n\n```\n    Decription of the map/reduce operation:\n\n    - ``map_function=f`` -- (default to ``None``)\n    - ``reduce_function=red`` -- (default to ``None``)\n    - ``reduce_init=init`` -- (default to ``None``)\n```\n\nWhat means `f`, `red` and `init`? My opinion is that `f`, `red`and `init` are irrelevant but an example should be interesting at this point: \n\n(copy-paste of one in the module documentation)\n\n```\n sage: from sage.parallel.map_reduce import RESetMapReduce\n sage: S = RESetMapReduce(\n ....:   roots = [[]],\n ....:   children = lambda l: [l+[0], l+[1]] if len(l) <= 15 else [],\n ....:   map_function = lambda x : 1,\n ....:   reduce_function = lambda x,y: x+y,\n ....:   reduce_init = 0 )\n sage: S.run()\n 131071\n```\n\nOk, there is the `seealso` which says go to see the documentation of the module for examples, but one example there is interesting, no?\n\nThen it seems there is some useless import (like line 1345 `from multiprocessing import current_process`) (I try to compile sage soon and I can remove all useless import if you want).\n\nFinally, I'm not sure to understand the use of `AbortError`. It is used to abort the computation and to say to the workers and the thiefs every think is done?\n\nJean-Baptiste",
    "created_at": "2015-12-26T14:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204675",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:67'></a>
Hello and merry christmas every one,

I have some question on this ticket.

Firstly, I don't understand the documentation from the line 571:

```
    Decription of the map/reduce operation:

    - ``map_function=f`` -- (default to ``None``)
    - ``reduce_function=red`` -- (default to ``None``)
    - ``reduce_init=init`` -- (default to ``None``)
```

What means `f`, `red` and `init`? My opinion is that `f`, `red`and `init` are irrelevant but an example should be interesting at this point: 

(copy-paste of one in the module documentation)

```
 sage: from sage.parallel.map_reduce import RESetMapReduce
 sage: S = RESetMapReduce(
 ....:   roots = [[]],
 ....:   children = lambda l: [l+[0], l+[1]] if len(l) <= 15 else [],
 ....:   map_function = lambda x : 1,
 ....:   reduce_function = lambda x,y: x+y,
 ....:   reduce_init = 0 )
 sage: S.run()
 131071
```

Ok, there is the `seealso` which says go to see the documentation of the module for examples, but one example there is interesting, no?

Then it seems there is some useless import (like line 1345 `from multiprocessing import current_process`) (I try to compile sage soon and I can remove all useless import if you want).

Finally, I'm not sure to understand the use of `AbortError`. It is used to abort the computation and to say to the workers and the thiefs every think is done?

Jean-Baptiste



---

archive/issue_comments_204676.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [vbraun](#comment%3A66):\n> Fails on OSX: http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/636/steps/shell_4/logs/stdio\n\n\nI can not reproduce this problem on my Mac OS X Yosemite 10.10.2:\n\n```\n$ sage -tp --long src/sage/parallel/map_reduce.py \nRunning doctests with ID 2015-12-28-10-44-31-65e477d9.\nGit branch: 13580\nUsing --optional=gcc,mpir,python2,sage\nDoctesting 1 file using 2 threads.\nsage -t --long --warn-long 85.0 src/sage/parallel/map_reduce.py\n    [252 tests, 40.89 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```",
    "created_at": "2015-12-28T09:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204676",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:68'></a>
Replying to [vbraun](#comment%3A66):
> Fails on OSX: http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/636/steps/shell_4/logs/stdio


I can not reproduce this problem on my Mac OS X Yosemite 10.10.2:

```
$ sage -tp --long src/sage/parallel/map_reduce.py 
Running doctests with ID 2015-12-28-10-44-31-65e477d9.
Git branch: 13580
Using --optional=gcc,mpir,python2,sage
Doctesting 1 file using 2 threads.
sage -t --long --warn-long 85.0 src/sage/parallel/map_reduce.py
    [252 tests, 40.89 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```



---

archive/issue_comments_204677.json:
```json
{
    "body": "<a id='comment:69'></a>\nHello,\n\nI can reproduce test failures on El Capitan (os x):\n\n- [log_map_reduce](http://kerios.fr/downloads/sage/2016/log_map_reduce)\n- [log_map_reduce2](http://kerios.fr/downloads/sage/2016/log_map_reduce2)\n- [log_map_reduce3](http://kerios.fr/downloads/sage/2016/log_map_reduce3)\n\nI run 3 tests and I obtained 3 distincts failures. My problem is that if I try to execute those lines which fails in sage terminal (several times) then it does not fail!\n\nIs it possible that the test environment is not robust specially on mac os?",
    "created_at": "2016-01-06T10:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204677",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:69'></a>
Hello,

I can reproduce test failures on El Capitan (os x):

- [log_map_reduce](http://kerios.fr/downloads/sage/2016/log_map_reduce)
- [log_map_reduce2](http://kerios.fr/downloads/sage/2016/log_map_reduce2)
- [log_map_reduce3](http://kerios.fr/downloads/sage/2016/log_map_reduce3)

I run 3 tests and I obtained 3 distincts failures. My problem is that if I try to execute those lines which fails in sage terminal (several times) then it does not fail!

Is it possible that the test environment is not robust specially on mac os?



---

archive/issue_comments_204678.json:
```json
{
    "body": "<a id='comment:70'></a>\nI read the code and I don't know how to understand this:\n\n```\nres = post_process(node)\nif res is not None:\n    self._res = reduc(self._res, mapp(res))\n```\n\nin the worker code of `walk_branch_locally` method.\n\nI think this is useless, no? Or if not then the documentation of `post_process` function should be improve to specify that if `post_process` returns `None` then there is a specific behavior.",
    "created_at": "2016-01-11T09:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204678",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:70'></a>
I read the code and I don't know how to understand this:

```
res = post_process(node)
if res is not None:
    self._res = reduc(self._res, mapp(res))
```

in the worker code of `walk_branch_locally` method.

I think this is useless, no? Or if not then the documentation of `post_process` function should be improve to specify that if `post_process` returns `None` then there is a specific behavior.



---

archive/issue_comments_204679.json:
```json
{
    "body": "<a id='comment:71'></a>\nReplying to [elixyre](#comment%3A70):\n> {{{\n> res = post_process(node)\n> if res is not None:\n>     self._res = reduc(self._res, mapp(res))\n> }}}\n> I think this is useless, no? Or if not then the documentation of `post_process` function should be improve to specify that if `post_process` returns `None` then there is a specific behavior.\n\n\nOk, this behavior is specify in the documentation of `RESetMapReduce` but this is not specified in paragraph (line 135) associated of this module.",
    "created_at": "2016-01-11T09:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204679",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:71'></a>
Replying to [elixyre](#comment%3A70):
> {{{
> res = post_process(node)
> if res is not None:
>     self._res = reduc(self._res, mapp(res))
> }}}
> I think this is useless, no? Or if not then the documentation of `post_process` function should be improve to specify that if `post_process` returns `None` then there is a specific behavior.


Ok, this behavior is specify in the documentation of `RESetMapReduce` but this is not specified in paragraph (line 135) associated of this module.



---

archive/issue_comments_204680.json:
```json
{
    "body": "<a id='comment:72'></a>\nFurthermore the lines:\n\n```\nfor child in newnodes: \n    self._todo.append(child)\n```\nof `walk_branch_locally` should be replaced by\n\n```\nself._todo_.extend(newnodes)\n```\n\n(I just notice that I read and if you are agree with my remark then I can replace that)",
    "created_at": "2016-01-11T09:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204680",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:72'></a>
Furthermore the lines:

```
for child in newnodes: 
    self._todo.append(child)
```
of `walk_branch_locally` should be replaced by

```
self._todo_.extend(newnodes)
```

(I just notice that I read and if you are agree with my remark then I can replace that)



---

archive/issue_comments_204681.json:
```json
{
    "body": "<a id='comment:73'></a>\nGo back to `None` activities, if I assume some users want to use *nodes* which could be `None` then my first idea is to use the `post_process` function to avoid problem but... if the *thief* doesn't receive then he send `None` and he says there is no job to do.\n\nI propose two solutions:\n- first one, to specify that `None` is not a node never! (this is assumed but this must be explicited in the documentation),\n- second one (the object way), to define an object `NoTask`.\n\nOpinion?",
    "created_at": "2016-01-11T10:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204681",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:73'></a>
Go back to `None` activities, if I assume some users want to use *nodes* which could be `None` then my first idea is to use the `post_process` function to avoid problem but... if the *thief* doesn't receive then he send `None` and he says there is no job to do.

I propose two solutions:
- first one, to specify that `None` is not a node never! (this is assumed but this must be explicited in the documentation),
- second one (the object way), to define an object `NoTask`.

Opinion?



---

archive/issue_comments_204682.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [elixyre](#comment%3A73):\n> Go back to `None` activities, if I assume some users want to use *nodes* which could be `None` then my first idea is to use the `post_process` function to avoid problem but... if the *thief* doesn't receive then he send `None` and he says there is no job to do.\n> \n> I propose two solutions:\n> - first one, to specify that `None` is not a node never! (this is assumed but this must be explicited in the documentation),\n\n\nI'm clearly in Favor of this solution. We assume that `None` doesn't blong to the set described by the underlying RESet. Note that this is something which concerns more the underlying RESet than the map-reduce computation.",
    "created_at": "2016-01-12T08:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204682",
    "user": "https://github.com/hivert"
}
```

<a id='comment:74'></a>
Replying to [elixyre](#comment%3A73):
> Go back to `None` activities, if I assume some users want to use *nodes* which could be `None` then my first idea is to use the `post_process` function to avoid problem but... if the *thief* doesn't receive then he send `None` and he says there is no job to do.
> 
> I propose two solutions:
> - first one, to specify that `None` is not a node never! (this is assumed but this must be explicited in the documentation),


I'm clearly in Favor of this solution. We assume that `None` doesn't blong to the set described by the underlying RESet. Note that this is something which concerns more the underlying RESet than the map-reduce computation.



---

archive/issue_comments_204683.json:
```json
{
    "body": "Changing branch from \"u/nthiery/13580/map_reduce\" to \"u/hivert/13580/map_reduce\"",
    "created_at": "2016-01-12T09:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204683",
    "user": "https://github.com/hivert"
}
```

Changing branch from "u/nthiery/13580/map_reduce" to "u/hivert/13580/map_reduce"



---

archive/issue_comments_204684.json:
```json
{
    "body": "<a id='comment:76'></a>\nNew commits:\n|                                                                                                                                          |                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|\n|[6e3bbd3](http://git.sagemath.org/sage.git/commit/?id=6e3bbd35f4572dffa1953e4f4acddc916a36c967)|`More logging for debugging`|",
    "created_at": "2016-01-12T09:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204684",
    "user": "https://github.com/hivert"
}
```

<a id='comment:76'></a>
New commits:
|                                                                                                                                          |                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
|[6e3bbd3](http://git.sagemath.org/sage.git/commit/?id=6e3bbd35f4572dffa1953e4f4acddc916a36c967)|`More logging for debugging`|



---

archive/issue_comments_204685.json:
```json
{
    "body": "Changing author from \"Florent Hivert, Nathann Cohen\" to \"Florent Hivert, Jean-Baptiste Priez, Nathann Cohen\"",
    "created_at": "2016-01-12T09:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204685",
    "user": "https://github.com/hivert"
}
```

Changing author from "Florent Hivert, Nathann Cohen" to "Florent Hivert, Jean-Baptiste Priez, Nathann Cohen"



---

archive/issue_comments_204686.json:
```json
{
    "body": "Changing commit from \"98fd9e1c7a085b1ba62d004dba6cca4c89001cd2\" to \"6e3bbd35f4572dffa1953e4f4acddc916a36c967\"",
    "created_at": "2016-01-12T09:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204686",
    "user": "https://github.com/hivert"
}
```

Changing commit from "98fd9e1c7a085b1ba62d004dba6cca4c89001cd2" to "6e3bbd35f4572dffa1953e4f4acddc916a36c967"



---

archive/issue_comments_204687.json:
```json
{
    "body": "<a id='comment:77'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|\n|[98fd9e1](http://git.sagemath.org/sage.git/commit/?id=98fd9e1c7a085b1ba62d004dba6cca4c89001cd2)|`13580: typo fix`|\n|[6b4a5cf](http://git.sagemath.org/sage.git/commit/?id=6b4a5cffe362093e6011801d3485a9dc02ddc1e2)|`Merge branch 'u/nthiery/13580/map_reduce' into t/13580/map_reduce`|",
    "created_at": "2016-01-12T10:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204687",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:77'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
|[98fd9e1](http://git.sagemath.org/sage.git/commit/?id=98fd9e1c7a085b1ba62d004dba6cca4c89001cd2)|`13580: typo fix`|
|[6b4a5cf](http://git.sagemath.org/sage.git/commit/?id=6b4a5cffe362093e6011801d3485a9dc02ddc1e2)|`Merge branch 'u/nthiery/13580/map_reduce' into t/13580/map_reduce`|



---

archive/issue_comments_204688.json:
```json
{
    "body": "Changing commit from \"6e3bbd35f4572dffa1953e4f4acddc916a36c967\" to \"6b4a5cffe362093e6011801d3485a9dc02ddc1e2\"",
    "created_at": "2016-01-12T10:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204688",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6e3bbd35f4572dffa1953e4f4acddc916a36c967" to "6b4a5cffe362093e6011801d3485a9dc02ddc1e2"



---

archive/issue_comments_204689.json:
```json
{
    "body": "<a id='comment:78'></a>\nReplying to [vbraun](#comment%3A66):\n> Fails on OSX: http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/636/steps/shell_4/logs/stdio\n\n\nWe finally got the problem with Jean-Baptiste. It occurs that semaphore are broken on MacOSX (or at least are not fully POSIX compliant). In particular, on standard unixes, when two processes are trying to acquire a semaphore whose value is more than two, they always both succeeded. On MacOS, one of them may fail. As a consequence, I'm writing a different code form MacOS relying on a Lock and a shared integer. It may be slower on system where semaphore are implemented in a lockless way.\n\nIs there a standard Sage/Python way to check if we are on MacOS ?",
    "created_at": "2016-01-15T15:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204689",
    "user": "https://github.com/hivert"
}
```

<a id='comment:78'></a>
Replying to [vbraun](#comment%3A66):
> Fails on OSX: http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/636/steps/shell_4/logs/stdio


We finally got the problem with Jean-Baptiste. It occurs that semaphore are broken on MacOSX (or at least are not fully POSIX compliant). In particular, on standard unixes, when two processes are trying to acquire a semaphore whose value is more than two, they always both succeeded. On MacOS, one of them may fail. As a consequence, I'm writing a different code form MacOS relying on a Lock and a shared integer. It may be slower on system where semaphore are implemented in a lockless way.

Is there a standard Sage/Python way to check if we are on MacOS ?



---

archive/issue_comments_204690.json:
```json
{
    "body": "<a id='comment:79'></a>\nNew commits:\n|                                                                                                                                          |                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[44566e6](http://git.sagemath.org/sage.git/commit/?id=44566e6dea943f9494fb315d9e3794c7b309c6de)|`ticket search forest map reduce with no problem on mac os x`|",
    "created_at": "2016-01-17T20:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204690",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:79'></a>
New commits:
|                                                                                                                                          |                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[44566e6](http://git.sagemath.org/sage.git/commit/?id=44566e6dea943f9494fb315d9e3794c7b309c6de)|`ticket search forest map reduce with no problem on mac os x`|



---

archive/issue_comments_204691.json:
```json
{
    "body": "Changing branch from \"u/hivert/13580/map_reduce\" to \"u/elixyre/ticket/13580\"",
    "created_at": "2016-01-17T20:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204691",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

Changing branch from "u/hivert/13580/map_reduce" to "u/elixyre/ticket/13580"



---

archive/issue_comments_204692.json:
```json
{
    "body": "Changing reviewer from \"S\u00e9bastien Labb\u00e9\" to \"S\u00e9bastien Labb\u00e9, Jean-Baptiste Priez\"",
    "created_at": "2016-01-17T20:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204692",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

Changing reviewer from "Sébastien Labbé" to "Sébastien Labbé, Jean-Baptiste Priez"



---

archive/issue_comments_204693.json:
```json
{
    "body": "Changing commit from \"6b4a5cffe362093e6011801d3485a9dc02ddc1e2\" to \"44566e6dea943f9494fb315d9e3794c7b309c6de\"",
    "created_at": "2016-01-17T20:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204693",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

Changing commit from "6b4a5cffe362093e6011801d3485a9dc02ddc1e2" to "44566e6dea943f9494fb315d9e3794c7b309c6de"



---

archive/issue_comments_204694.json:
```json
{
    "body": "<a id='comment:80'></a>\nI pushed the modifications done with Florent about mac os problem.\n\nIt seems there still exists the problem of synchronization with the `Pipe` (of the worker) but... it is never appear... so may be I am wrong.\n\nIs it possible that two distinct process write in the same time on the `_write_task` of a worker?",
    "created_at": "2016-01-17T20:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204694",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

<a id='comment:80'></a>
I pushed the modifications done with Florent about mac os problem.

It seems there still exists the problem of synchronization with the `Pipe` (of the worker) but... it is never appear... so may be I am wrong.

Is it possible that two distinct process write in the same time on the `_write_task` of a worker?



---

archive/issue_comments_204695.json:
```json
{
    "body": "Changing branch from \"u/elixyre/ticket/13580\" to \"u/hivert/ticket/13580\"",
    "created_at": "2016-02-02T10:39:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204695",
    "user": "https://github.com/hivert"
}
```

Changing branch from "u/elixyre/ticket/13580" to "u/hivert/ticket/13580"



---

archive/issue_comments_204696.json:
```json
{
    "body": "Changing commit from \"44566e6dea943f9494fb315d9e3794c7b309c6de\" to \"aa8280f9cf68d1e592b760cc85bb7442b47a243e\"",
    "created_at": "2016-02-02T10:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204696",
    "user": "https://github.com/hivert"
}
```

Changing commit from "44566e6dea943f9494fb315d9e3794c7b309c6de" to "aa8280f9cf68d1e592b760cc85bb7442b47a243e"



---

archive/issue_comments_204697.json:
```json
{
    "body": "<a id='comment:82'></a>\nI just uploaded a version which hopefully should be working on all OSes including MacOS. Please tests on various oses and report any failure here. I don't put needs review yet because it needs a few refactoring and the coverage it not yet 100%. \n\n---\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[9456035](http://git.sagemath.org/sage.git/commit/?id=9456035b5b136ed3c95d0a2ab8c05ba7b160dac2)|`Work in problem in fixing MACOX broken Semaphore`|\n|[158023b](http://git.sagemath.org/sage.git/commit/?id=158023b6a1d2feeff292b354306f33234a726acf)|`Wrote commented out MacOS version`|\n|[aa8280f](http://git.sagemath.org/sage.git/commit/?id=aa8280f9cf68d1e592b760cc85bb7442b47a243e)|`Map-reduce version which should be working even on Darwin based OSes.`|",
    "created_at": "2016-02-02T10:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204697",
    "user": "https://github.com/hivert"
}
```

<a id='comment:82'></a>
I just uploaded a version which hopefully should be working on all OSes including MacOS. Please tests on various oses and report any failure here. I don't put needs review yet because it needs a few refactoring and the coverage it not yet 100%. 

---
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[9456035](http://git.sagemath.org/sage.git/commit/?id=9456035b5b136ed3c95d0a2ab8c05ba7b160dac2)|`Work in problem in fixing MACOX broken Semaphore`|
|[158023b](http://git.sagemath.org/sage.git/commit/?id=158023b6a1d2feeff292b354306f33234a726acf)|`Wrote commented out MacOS version`|
|[aa8280f](http://git.sagemath.org/sage.git/commit/?id=aa8280f9cf68d1e592b760cc85bb7442b47a243e)|`Map-reduce version which should be working even on Darwin based OSes.`|



---

archive/issue_comments_204698.json:
```json
{
    "body": "<a id='comment:83'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------|\n|[f984165](http://git.sagemath.org/sage.git/commit/?id=f9841658ccda142d07cbfaa633dbf4b236165986)|`Fixed the doc`|",
    "created_at": "2016-02-03T09:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:83'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|[f984165](http://git.sagemath.org/sage.git/commit/?id=f9841658ccda142d07cbfaa633dbf4b236165986)|`Fixed the doc`|



---

archive/issue_comments_204699.json:
```json
{
    "body": "Changing commit from \"aa8280f9cf68d1e592b760cc85bb7442b47a243e\" to \"f9841658ccda142d07cbfaa633dbf4b236165986\"",
    "created_at": "2016-02-03T09:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "aa8280f9cf68d1e592b760cc85bb7442b47a243e" to "f9841658ccda142d07cbfaa633dbf4b236165986"



---

archive/issue_comments_204700.json:
```json
{
    "body": "Changing commit from \"f9841658ccda142d07cbfaa633dbf4b236165986\" to \"a5f4d676ce7201a801bf6c841aae0585fc144336\"",
    "created_at": "2016-03-16T16:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204700",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f9841658ccda142d07cbfaa633dbf4b236165986" to "a5f4d676ce7201a801bf6c841aae0585fc144336"



---

archive/issue_comments_204701.json:
```json
{
    "body": "<a id='comment:84'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[a5f4d67](http://git.sagemath.org/sage.git/commit/?id=a5f4d676ce7201a801bf6c841aae0585fc144336)|`Improved doc for map-reduce`|",
    "created_at": "2016-03-16T16:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:84'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[a5f4d67](http://git.sagemath.org/sage.git/commit/?id=a5f4d676ce7201a801bf6c841aae0585fc144336)|`Improved doc for map-reduce`|



---

archive/issue_comments_204702.json:
```json
{
    "body": "<a id='comment:85'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[569de0d](http://git.sagemath.org/sage.git/commit/?id=569de0dae0d23e084cbce7690a2a64b53f906f8b)|`Merge branch 'develop' into t/13580/map_reduce`|",
    "created_at": "2016-04-06T17:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:85'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[569de0d](http://git.sagemath.org/sage.git/commit/?id=569de0dae0d23e084cbce7690a2a64b53f906f8b)|`Merge branch 'develop' into t/13580/map_reduce`|



---

archive/issue_comments_204703.json:
```json
{
    "body": "Changing commit from \"a5f4d676ce7201a801bf6c841aae0585fc144336\" to \"569de0dae0d23e084cbce7690a2a64b53f906f8b\"",
    "created_at": "2016-04-06T17:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a5f4d676ce7201a801bf6c841aae0585fc144336" to "569de0dae0d23e084cbce7690a2a64b53f906f8b"



---

archive/issue_comments_204704.json:
```json
{
    "body": "Changing commit from \"569de0dae0d23e084cbce7690a2a64b53f906f8b\" to \"b07dfe28221a7473041d65230be409d6cbfafbfc\"",
    "created_at": "2016-04-07T09:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "569de0dae0d23e084cbce7690a2a64b53f906f8b" to "b07dfe28221a7473041d65230be409d6cbfafbfc"



---

archive/issue_comments_204705.json:
```json
{
    "body": "<a id='comment:86'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[b07dfe2](http://git.sagemath.org/sage.git/commit/?id=b07dfe28221a7473041d65230be409d6cbfafbfc)|`Doc of the two implementationsof ActiveTaskCounter`|",
    "created_at": "2016-04-07T09:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204705",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:86'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[b07dfe2](http://git.sagemath.org/sage.git/commit/?id=b07dfe28221a7473041d65230be409d6cbfafbfc)|`Doc of the two implementationsof ActiveTaskCounter`|



---

archive/issue_comments_204706.json:
```json
{
    "body": "Changing commit from \"b07dfe28221a7473041d65230be409d6cbfafbfc\" to \"beebcbcd43c2d7a9d024f142f5e3cb328fbc4036\"",
    "created_at": "2016-04-07T09:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b07dfe28221a7473041d65230be409d6cbfafbfc" to "beebcbcd43c2d7a9d024f142f5e3cb328fbc4036"



---

archive/issue_comments_204707.json:
```json
{
    "body": "<a id='comment:87'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[beebcbc](http://git.sagemath.org/sage.git/commit/?id=beebcbcd43c2d7a9d024f142f5e3cb328fbc4036)|`#13580: Added comment on timing in the doc`|",
    "created_at": "2016-04-07T09:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:87'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[beebcbc](http://git.sagemath.org/sage.git/commit/?id=beebcbcd43c2d7a9d024f142f5e3cb328fbc4036)|`#13580: Added comment on timing in the doc`|



---

archive/issue_comments_204708.json:
```json
{
    "body": "Changing keywords from \"map-reduce, days57\" to \"map-reduce, days57, days77\".",
    "created_at": "2016-04-07T09:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204708",
    "user": "https://github.com/hivert"
}
```

Changing keywords from "map-reduce, days57" to "map-reduce, days57, days77".



---

archive/issue_comments_204709.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-07T09:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204709",
    "user": "https://github.com/hivert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204710.json:
```json
{
    "body": "<a id='comment:88'></a>\nI just uploaded a patch with basically two implementation of `ActiveTaskCounter`: one using semaphore and which doesn't work on MACOS and one using semaphore for all POSIX compliant OSes. It should be ready for review.",
    "created_at": "2016-04-07T09:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204710",
    "user": "https://github.com/hivert"
}
```

<a id='comment:88'></a>
I just uploaded a patch with basically two implementation of `ActiveTaskCounter`: one using semaphore and which doesn't work on MACOS and one using semaphore for all POSIX compliant OSes. It should be ready for review.



---

archive/issue_comments_204711.json:
```json
{
    "body": "<a id='comment:89'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[58eca2e](http://git.sagemath.org/sage.git/commit/?id=58eca2e4decb05733145b18e08f16120b8765a81)|`#13580: Removed comment which is now in the doc`|",
    "created_at": "2016-04-07T13:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[58eca2e](http://git.sagemath.org/sage.git/commit/?id=58eca2e4decb05733145b18e08f16120b8765a81)|`#13580: Removed comment which is now in the doc`|



---

archive/issue_comments_204712.json:
```json
{
    "body": "Changing commit from \"beebcbcd43c2d7a9d024f142f5e3cb328fbc4036\" to \"58eca2e4decb05733145b18e08f16120b8765a81\"",
    "created_at": "2016-04-07T13:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204712",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "beebcbcd43c2d7a9d024f142f5e3cb328fbc4036" to "58eca2e4decb05733145b18e08f16120b8765a81"



---

archive/issue_comments_204713.json:
```json
{
    "body": "Changing commit from \"58eca2e4decb05733145b18e08f16120b8765a81\" to \"1badd8aec7efc3229cfdf76bffab3ad1f532bd33\"",
    "created_at": "2016-04-07T17:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204713",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "58eca2e4decb05733145b18e08f16120b8765a81" to "1badd8aec7efc3229cfdf76bffab3ad1f532bd33"



---

archive/issue_comments_204714.json:
```json
{
    "body": "<a id='comment:90'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[1badd8a](http://git.sagemath.org/sage.git/commit/?id=1badd8aec7efc3229cfdf76bffab3ad1f532bd33)|`#13580: Renamed ActiveTaskCounter(Posix)`|",
    "created_at": "2016-04-07T17:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204714",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:90'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[1badd8a](http://git.sagemath.org/sage.git/commit/?id=1badd8aec7efc3229cfdf76bffab3ad1f532bd33)|`#13580: Renamed ActiveTaskCounter(Posix)`|



---

archive/issue_comments_204715.json:
```json
{
    "body": "<a id='comment:91'></a>\nI get the following errors on OSX :\n\n```\nRunning doctests with ID 2016-04-07-19-23-55-8fd43b63.\nGit branch: 13580\nUsing --optional=dot2tex,mpir,python2,sage\nDoctesting 1 file using 2 threads.\nsage -t --long --warn-long 84.5 src/sage/parallel/map_reduce.py\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 727, in sage.parallel.map_reduce.ActiveTaskCounterPosix.__repr__\nFailed example:\n    ATC(4)\nExpected:\n    ActiveTaskCounter(value=4)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32e90>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 743, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start\nFailed example:\n    c = ATC(4); c\nExpected:\n    ActiveTaskCounter(value=4)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32e50>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 745, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start\nFailed example:\n    c.task_start()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start[2]>\", line 1, in <module>\n        c.task_start()\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/parallel/map_reduce.py\", line 764, in task_start\n        return self._active_tasks.get_value()\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python/multiprocessing/synchronize.py\", line 114, in get_value\n        return self._semlock._get_value()\n    NotImplementedError\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 747, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start\nFailed example:\n    c\nExpected:\n    ActiveTaskCounter(value=5)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32e50>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 755, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start\nFailed example:\n    c\nExpected:\n    ActiveTaskCounter(value=0)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32f90>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 778, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done\nFailed example:\n    c = ATC(4); c\nExpected:\n    ActiveTaskCounter(value=4)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5c10>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 780, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done\nFailed example:\n    c.task_done()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done[2]>\", line 1, in <module>\n        c.task_done()\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/parallel/map_reduce.py\", line 796, in task_done\n        return self._active_tasks.get_value()\n      File \"/Users/slabbe/Applications/sage-git/local/lib/python/multiprocessing/synchronize.py\", line 114, in get_value\n        return self._semlock._get_value()\n    NotImplementedError\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 782, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done\nFailed example:\n    c\nExpected:\n    ActiveTaskCounter(value=3)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5c10>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 805, in sage.parallel.map_reduce.ActiveTaskCounterPosix.abort\nFailed example:\n    c = ATC(4); c\nExpected:\n    ActiveTaskCounter(value=4)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5910>) failed: NotImplementedError>\n**********************************************************************\nFile \"src/sage/parallel/map_reduce.py\", line 808, in sage.parallel.map_reduce.ActiveTaskCounterPosix.abort\nFailed example:\n    c\nExpected:\n    ActiveTaskCounter(value=0)\nGot:\n    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5910>) failed: NotImplementedError>\n**********************************************************************\n4 items had failures:\n   1 of   3 in sage.parallel.map_reduce.ActiveTaskCounterPosix.__repr__\n   2 of   5 in sage.parallel.map_reduce.ActiveTaskCounterPosix.abort\n   3 of   7 in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done\n   4 of   8 in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start\n    [296 tests, 10 failures, 33.64 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 84.5 src/sage/parallel/map_reduce.py  # 10 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 33.9 seconds\n    cpu time: 5.8 seconds\n    cumulative wall time: 33.6 seconds\n```",
    "created_at": "2016-04-07T17:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204715",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:91'></a>
I get the following errors on OSX :

```
Running doctests with ID 2016-04-07-19-23-55-8fd43b63.
Git branch: 13580
Using --optional=dot2tex,mpir,python2,sage
Doctesting 1 file using 2 threads.
sage -t --long --warn-long 84.5 src/sage/parallel/map_reduce.py
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 727, in sage.parallel.map_reduce.ActiveTaskCounterPosix.__repr__
Failed example:
    ATC(4)
Expected:
    ActiveTaskCounter(value=4)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32e90>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 743, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start
Failed example:
    c = ATC(4); c
Expected:
    ActiveTaskCounter(value=4)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32e50>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 745, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start
Failed example:
    c.task_start()
Exception raised:
    Traceback (most recent call last):
      File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start[2]>", line 1, in <module>
        c.task_start()
      File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/parallel/map_reduce.py", line 764, in task_start
        return self._active_tasks.get_value()
      File "/Users/slabbe/Applications/sage-git/local/lib/python/multiprocessing/synchronize.py", line 114, in get_value
        return self._semlock._get_value()
    NotImplementedError
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 747, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start
Failed example:
    c
Expected:
    ActiveTaskCounter(value=5)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32e50>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 755, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start
Failed example:
    c
Expected:
    ActiveTaskCounter(value=0)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x190d32f90>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 778, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done
Failed example:
    c = ATC(4); c
Expected:
    ActiveTaskCounter(value=4)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5c10>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 780, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done
Failed example:
    c.task_done()
Exception raised:
    Traceback (most recent call last):
      File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done[2]>", line 1, in <module>
        c.task_done()
      File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/sage/parallel/map_reduce.py", line 796, in task_done
        return self._active_tasks.get_value()
      File "/Users/slabbe/Applications/sage-git/local/lib/python/multiprocessing/synchronize.py", line 114, in get_value
        return self._semlock._get_value()
    NotImplementedError
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 782, in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done
Failed example:
    c
Expected:
    ActiveTaskCounter(value=3)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5c10>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 805, in sage.parallel.map_reduce.ActiveTaskCounterPosix.abort
Failed example:
    c = ATC(4); c
Expected:
    ActiveTaskCounter(value=4)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5910>) failed: NotImplementedError>
**********************************************************************
File "src/sage/parallel/map_reduce.py", line 808, in sage.parallel.map_reduce.ActiveTaskCounterPosix.abort
Failed example:
    c
Expected:
    ActiveTaskCounter(value=0)
Got:
    <repr(<sage.parallel.map_reduce.ActiveTaskCounterPosix at 0x1026a5910>) failed: NotImplementedError>
**********************************************************************
4 items had failures:
   1 of   3 in sage.parallel.map_reduce.ActiveTaskCounterPosix.__repr__
   2 of   5 in sage.parallel.map_reduce.ActiveTaskCounterPosix.abort
   3 of   7 in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_done
   4 of   8 in sage.parallel.map_reduce.ActiveTaskCounterPosix.task_start
    [296 tests, 10 failures, 33.64 s]
----------------------------------------------------------------------
sage -t --long --warn-long 84.5 src/sage/parallel/map_reduce.py  # 10 doctests failed
----------------------------------------------------------------------
Total time for all tests: 33.9 seconds
    cpu time: 5.8 seconds
    cumulative wall time: 33.6 seconds
```



---

archive/issue_comments_204716.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-07T17:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204716",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_204717.json:
```json
{
    "body": "Changing commit from \"1badd8aec7efc3229cfdf76bffab3ad1f532bd33\" to \"46cbab9d81890649c3d056f47ed62065bcb04ca3\"",
    "created_at": "2016-04-07T17:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204717",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1badd8aec7efc3229cfdf76bffab3ad1f532bd33" to "46cbab9d81890649c3d056f47ed62065bcb04ca3"



---

archive/issue_comments_204718.json:
```json
{
    "body": "<a id='comment:92'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[46cbab9](http://git.sagemath.org/sage.git/commit/?id=46cbab9d81890649c3d056f47ed62065bcb04ca3)|`13580: Fixed doctests to pass on Darwin`|",
    "created_at": "2016-04-07T17:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204718",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:92'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[46cbab9](http://git.sagemath.org/sage.git/commit/?id=46cbab9d81890649c3d056f47ed62065bcb04ca3)|`13580: Fixed doctests to pass on Darwin`|



---

archive/issue_comments_204719.json:
```json
{
    "body": "<a id='comment:93'></a>\nIt works now! : \n\n```\nUsing --optional=dot2tex,mpir,python2,sage\nDoctesting 1 file using 2 threads.\nsage -t --warn-long 84.3 src/sage/parallel/map_reduce.py\n    [296 tests, 32.56 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```",
    "created_at": "2016-04-07T18:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204719",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:93'></a>
It works now! : 

```
Using --optional=dot2tex,mpir,python2,sage
Doctesting 1 file using 2 threads.
sage -t --warn-long 84.3 src/sage/parallel/map_reduce.py
    [296 tests, 32.56 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```



---

archive/issue_comments_204720.json:
```json
{
    "body": "<a id='comment:94'></a>\nsome typos:\n\n`compute the the cardinality`\n\n`its job. Non only mapping` -> `Not only`\n\n`method so that to compute the number of element you only need to call::` -> wrap the line\n\n`precedingly by we only ` -> `previously`? , `but` \n\nI would suggest to replace this:\n\n```\n        OUTPUT: Calling :meth:`task_done` decrement the counter and returns\n        its value after the decrementation.\n```\n\nby\n\n```\n        OUTPUT: \n\n        Calling :meth:`task_done` decrement the counter and returns\n        its value after the decrementation.\n```\n\nto follow sage standards (more than once).\n\nAlso, I would replace this:\n\n```\nINPUT: ``o`` -- a node\n```\n\nby\n\n```\nINPUT: \n\n- ``o`` -- a node\n```\n\nto follow sage standards (more than once).\n\n`the computation are done i` -> s missing",
    "created_at": "2016-04-07T18:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204720",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:94'></a>
some typos:

`compute the the cardinality`

`its job. Non only mapping` -> `Not only`

`method so that to compute the number of element you only need to call::` -> wrap the line

`precedingly by we only ` -> `previously`? , `but` 

I would suggest to replace this:

```
        OUTPUT: Calling :meth:`task_done` decrement the counter and returns
        its value after the decrementation.
```

by

```
        OUTPUT: 

        Calling :meth:`task_done` decrement the counter and returns
        its value after the decrementation.
```

to follow sage standards (more than once).

Also, I would replace this:

```
INPUT: ``o`` -- a node
```

by

```
INPUT: 

- ``o`` -- a node
```

to follow sage standards (more than once).

`the computation are done i` -> s missing



---

archive/issue_comments_204721.json:
```json
{
    "body": "Changing commit from \"46cbab9d81890649c3d056f47ed62065bcb04ca3\" to \"134c1fad85dd50fa28528adc343bad759b174cc6\"",
    "created_at": "2016-04-07T21:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "46cbab9d81890649c3d056f47ed62065bcb04ca3" to "134c1fad85dd50fa28528adc343bad759b174cc6"



---

archive/issue_comments_204722.json:
```json
{
    "body": "<a id='comment:95'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[134c1fa](http://git.sagemath.org/sage.git/commit/?id=134c1fad85dd50fa28528adc343bad759b174cc6)|`13580: doc rereading`|",
    "created_at": "2016-04-07T21:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204722",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:95'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[134c1fa](http://git.sagemath.org/sage.git/commit/?id=134c1fad85dd50fa28528adc343bad759b174cc6)|`13580: doc rereading`|



---

archive/issue_comments_204723.json:
```json
{
    "body": "<a id='comment:96'></a>\nI am wondering what else is currently needed for this ticket before a positive review?\n\nAlso, what are the current plans to cythonize `SearchForest` and the parallel reduce map?",
    "created_at": "2016-04-07T23:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204723",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:96'></a>
I am wondering what else is currently needed for this ticket before a positive review?

Also, what are the current plans to cythonize `SearchForest` and the parallel reduce map?



---

archive/issue_comments_204724.json:
```json
{
    "body": "<a id='comment:97'></a>\nWhat I had in mind for the next step to do was to move the `SearchForest` code from backtrack file into the `recursivelyenumerated_set.pyx` file *and* into the hierarchy of `RecEnumSet` classes so that it benefits for example of methods like the newly added `to_digraph`.",
    "created_at": "2016-04-08T00:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204724",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:97'></a>
What I had in mind for the next step to do was to move the `SearchForest` code from backtrack file into the `recursivelyenumerated_set.pyx` file *and* into the hierarchy of `RecEnumSet` classes so that it benefits for example of methods like the newly added `to_digraph`.



---

archive/issue_comments_204725.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-04-08T00:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204725",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_204726.json:
```json
{
    "body": "<a id='comment:98'></a>\nReplying to [tscrim](#comment%3A96):\n> I am wondering what else is currently needed for this ticket before a positive review?\n\n\nSebastien is currently rereading it. I think he is very close to put a positive review.\n\n> Also, what are the current plans to cythonize `SearchForest` and the parallel reduce map?\n\n\nConcerning Cythonization of map-reduce, my current opinion is that, the code\nis designed for case where the computation of the children is costly. In this\ncase the cost of the current code should be negligible. There are a lot of\nfunction calls, I'm using Python synchronization primitive, but most\nimportantly, communication is are by pickling/unpickling which is very\nslow. So the idea is to reduce at most at possible the communication, but\nwithout drastically changing the technology, I don't think you get a large\nimprovement without great effort. You'll need to rewrite all the communication\nprimitive and to inline the function call to the client code.\n\nOn the other hand, If you are allowed to write the code directly in C/C++\n(which is the case for small basic objects), then the Cilk extension of C is\nwonderful. It's a small extension which is supported by GCC since version 5,\nICC and in recent CLANG (https://cilkplus.github.io/). I've several code where\nI've been able to have very large speedup. See\ne.g. https://hal.archives-ouvertes.fr/hal-00823339/file/article.pdf if you are\ncurious.\n\nNow if you have a specific use case, I'll be happy to experiment.",
    "created_at": "2016-04-08T01:05:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204726",
    "user": "https://github.com/hivert"
}
```

<a id='comment:98'></a>
Replying to [tscrim](#comment%3A96):
> I am wondering what else is currently needed for this ticket before a positive review?


Sebastien is currently rereading it. I think he is very close to put a positive review.

> Also, what are the current plans to cythonize `SearchForest` and the parallel reduce map?


Concerning Cythonization of map-reduce, my current opinion is that, the code
is designed for case where the computation of the children is costly. In this
case the cost of the current code should be negligible. There are a lot of
function calls, I'm using Python synchronization primitive, but most
importantly, communication is are by pickling/unpickling which is very
slow. So the idea is to reduce at most at possible the communication, but
without drastically changing the technology, I don't think you get a large
improvement without great effort. You'll need to rewrite all the communication
primitive and to inline the function call to the client code.

On the other hand, If you are allowed to write the code directly in C/C++
(which is the case for small basic objects), then the Cilk extension of C is
wonderful. It's a small extension which is supported by GCC since version 5,
ICC and in recent CLANG (https://cilkplus.github.io/). I've several code where
I've been able to have very large speedup. See
e.g. https://hal.archives-ouvertes.fr/hal-00823339/file/article.pdf if you are
curious.

Now if you have a specific use case, I'll be happy to experiment.



---

archive/issue_comments_204727.json:
```json
{
    "body": "<a id='comment:99'></a>\nReplying to [slabbe](#comment%3A97):\n> What I had in mind for the next step to do was to move the `SearchForest` code from backtrack file into the `recursivelyenumerated_set.pyx` file *and* into the hierarchy of `RecEnumSet` classes so that it benefits for example of methods like the newly added `to_digraph`.\n\n\nThat was also the next goal in my mind.",
    "created_at": "2016-04-08T01:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204727",
    "user": "https://github.com/hivert"
}
```

<a id='comment:99'></a>
Replying to [slabbe](#comment%3A97):
> What I had in mind for the next step to do was to move the `SearchForest` code from backtrack file into the `recursivelyenumerated_set.pyx` file *and* into the hierarchy of `RecEnumSet` classes so that it benefits for example of methods like the newly added `to_digraph`.


That was also the next goal in my mind.



---

archive/issue_comments_204728.json:
```json
{
    "body": "<a id='comment:0'></a>\nSee #16351",
    "created_at": "2016-04-08T08:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204728",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:0'></a>
See #16351



---

archive/issue_events_037820.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-04-08T09:28:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37820"
}
```



---

archive/issue_events_037821.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-04-08T09:28:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37821"
}
```



---

archive/issue_comments_204729.json:
```json
{
    "body": "<a id='comment:101'></a>\nReplying to [hivert](#comment%3A98):\n> Replying to [tscrim](#comment%3A96):\n> > Also, what are the current plans to cythonize `SearchForest` and the parallel reduce map?\n\n> \n> Concerning Cythonization of map-reduce, my current opinion is that, the code\n> is designed for case where the computation of the children is costly. In this\n> case the cost of the current code should be negligible. There are a lot of\n> function calls, I'm using Python synchronization primitive, but most\n> importantly, communication is are by pickling/unpickling which is very\n> slow. So the idea is to reduce at most at possible the communication, but\n> without drastically changing the technology, I don't think you get a large\n> improvement without great effort. You'll need to rewrite all the communication\n> primitive and to inline the function call to the client code.\n> \n> On the other hand, If you are allowed to write the code directly in C/C++\n> (which is the case for small basic objects), then the Cilk extension of C is\n> wonderful. It's a small extension which is supported by GCC since version 5,\n> ICC and in recent CLANG (https://cilkplus.github.io/). I've several code where\n> I've been able to have very large speedup. See\n> e.g. https://hal.archives-ouvertes.fr/hal-00823339/file/article.pdf if you are\n> curious.\n> \n> Now if you have a specific use case, I'll be happy to experiment.\n\n\nChristian, Vivien, and I are working on trying to speed up the iteration of finite Coxeter groups by using (subgroups of) permutation groups and the iterator method of generic Coxeter groups, which uses a `SearchForest` (see #11187 and the `CoxeterGroups` category). Our goal is to try and match or beat GAP3 iteration time (which we are about ~30x slower).\n\nWe are in the process pushing our successor computation code to Cython and some of our other methods, but we would appreciate any insights you have.\n\nYet the code on this ticket will definitely help with that. Thank you for finishing it.",
    "created_at": "2016-04-08T09:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204729",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:101'></a>
Replying to [hivert](#comment%3A98):
> Replying to [tscrim](#comment%3A96):
> > Also, what are the current plans to cythonize `SearchForest` and the parallel reduce map?

> 
> Concerning Cythonization of map-reduce, my current opinion is that, the code
> is designed for case where the computation of the children is costly. In this
> case the cost of the current code should be negligible. There are a lot of
> function calls, I'm using Python synchronization primitive, but most
> importantly, communication is are by pickling/unpickling which is very
> slow. So the idea is to reduce at most at possible the communication, but
> without drastically changing the technology, I don't think you get a large
> improvement without great effort. You'll need to rewrite all the communication
> primitive and to inline the function call to the client code.
> 
> On the other hand, If you are allowed to write the code directly in C/C++
> (which is the case for small basic objects), then the Cilk extension of C is
> wonderful. It's a small extension which is supported by GCC since version 5,
> ICC and in recent CLANG (https://cilkplus.github.io/). I've several code where
> I've been able to have very large speedup. See
> e.g. https://hal.archives-ouvertes.fr/hal-00823339/file/article.pdf if you are
> curious.
> 
> Now if you have a specific use case, I'll be happy to experiment.


Christian, Vivien, and I are working on trying to speed up the iteration of finite Coxeter groups by using (subgroups of) permutation groups and the iterator method of generic Coxeter groups, which uses a `SearchForest` (see #11187 and the `CoxeterGroups` category). Our goal is to try and match or beat GAP3 iteration time (which we are about ~30x slower).

We are in the process pushing our successor computation code to Cython and some of our other methods, but we would appreciate any insights you have.

Yet the code on this ticket will definitely help with that. Thank you for finishing it.



---

archive/issue_comments_204730.json:
```json
{
    "body": "<a id='comment:102'></a>\nReplying to [tscrim](#comment%3A101):\n> Christian, Vivien, and I are working on trying to speed up the iteration of\n> finite Coxeter groups by using (subgroups of) permutation groups and the\n> iterator method of generic Coxeter groups, which uses a `SearchForest` (see\n> #11187 and the `CoxeterGroups` category). Our goal is to try and match or\n> beat GAP3 iteration time (which we are about ~30x slower).\n\n\nI'll be both very happy and interested to have usecase for this code.\n\n> We are in the process pushing our successor computation code to Cython and\n> some of our other methods, but we would appreciate any insights you have.\n\n\nDo you have a typical example relying on `SearchForest` of code on top of\n#11187 that I can profile ? Note that I included in the documentation of\nmap_reduce.py a guide on how to profile the parallel code. I'd like to measure\nthe proportion of time that is spend on Coxeter code one one hand and on the\nparallel infrastructure on the other.\n\n\nNow, concerning coxeter group, I'm quite sure that rewriting part of the code\nin C/C++ and using advanced parallel stuff (AVX instruction set + SIMD) you\ncan get speedup a large as several hundreds and even thousand ! As a witness\non https://github.com/hivert/IVMPG I wrote a code whose goal is to enumerate\ninteger vector modulo permutation group. Compared to the code we have in Sage\nwhich has been Cythonized and optimized by Simon King I manage to get speedup\na large as x2000 ! I need help on the build system to be able to distribute\nit. I'm pretty sure the code there is very similar to what you need in Coxeter\ngroups.\n\nBy the way, should we transfer this discussion on #11187 ?",
    "created_at": "2016-04-08T09:51:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204730",
    "user": "https://github.com/hivert"
}
```

<a id='comment:102'></a>
Replying to [tscrim](#comment%3A101):
> Christian, Vivien, and I are working on trying to speed up the iteration of
> finite Coxeter groups by using (subgroups of) permutation groups and the
> iterator method of generic Coxeter groups, which uses a `SearchForest` (see
> #11187 and the `CoxeterGroups` category). Our goal is to try and match or
> beat GAP3 iteration time (which we are about ~30x slower).


I'll be both very happy and interested to have usecase for this code.

> We are in the process pushing our successor computation code to Cython and
> some of our other methods, but we would appreciate any insights you have.


Do you have a typical example relying on `SearchForest` of code on top of
#11187 that I can profile ? Note that I included in the documentation of
map_reduce.py a guide on how to profile the parallel code. I'd like to measure
the proportion of time that is spend on Coxeter code one one hand and on the
parallel infrastructure on the other.


Now, concerning coxeter group, I'm quite sure that rewriting part of the code
in C/C++ and using advanced parallel stuff (AVX instruction set + SIMD) you
can get speedup a large as several hundreds and even thousand ! As a witness
on https://github.com/hivert/IVMPG I wrote a code whose goal is to enumerate
integer vector modulo permutation group. Compared to the code we have in Sage
which has been Cythonized and optimized by Simon King I manage to get speedup
a large as x2000 ! I need help on the build system to be able to distribute
it. I'm pretty sure the code there is very similar to what you need in Coxeter
groups.

By the way, should we transfer this discussion on #11187 ?



---

archive/issue_comments_204731.json:
```json
{
    "body": "<a id='comment:103'></a>\nReplying to [hivert](#comment%3A102):\n> By the way, should we transfer this discussion on #11187 ?\n\n\nDone.",
    "created_at": "2016-04-08T10:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204731",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:103'></a>
Replying to [hivert](#comment%3A102):
> By the way, should we transfer this discussion on #11187 ?


Done.



---

archive/issue_comments_204732.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-08T22:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204732",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_037822.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-08T22:40:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13580#event-37822"
}
```



---

archive/issue_comments_204733.json:
```json
{
    "body": "Changing branch from \"u/hivert/ticket/13580\" to \"134c1fad85dd50fa28528adc343bad759b174cc6\"",
    "created_at": "2016-04-08T22:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204733",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/hivert/ticket/13580" to "134c1fad85dd50fa28528adc343bad759b174cc6"



---

archive/issue_comments_204734.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis ticket breaks the doctests on my patchbot, i do not know whether it is because it is run from a VM or from a 32-bit system, see http://patchbot.sagemath.org/log/0/debian/8.3/i686/3.16.0-4-586/tmonteil-debian-jessie-32/2016-04-15%2012:13:01?short",
    "created_at": "2016-04-15T15:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204734",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:5'></a>
This ticket breaks the doctests on my patchbot, i do not know whether it is because it is run from a VM or from a 32-bit system, see http://patchbot.sagemath.org/log/0/debian/8.3/i686/3.16.0-4-586/tmonteil-debian-jessie-32/2016-04-15%2012:13:01?short



---

archive/issue_comments_204735.json:
```json
{
    "body": "Changing commit from \"134c1fad85dd50fa28528adc343bad759b174cc6\" to \"\"",
    "created_at": "2016-04-15T15:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204735",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing commit from "134c1fad85dd50fa28528adc343bad759b174cc6" to ""



---

archive/issue_comments_204736.json:
```json
{
    "body": "<a id='comment:6'></a>\nNote also that the VM emulates a \"Pentium III (Katmai)\"",
    "created_at": "2016-04-15T15:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204736",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:6'></a>
Note also that the VM emulates a "Pentium III (Katmai)"



---

archive/issue_comments_204737.json:
```json
{
    "body": "<a id='comment:107'></a>\nReplying to [tmonteil](#comment%3A105):\n> This ticket breaks the doctests on my patchbot, i do not know whether it is because it is run from a VM or from a 32-bit system, see http://patchbot.sagemath.org/log/0/debian/8.3/i686/3.16.0-4-586/tmonteil-debian-jessie-32/2016-04-15%2012:13:01?short\n\n\nFrom the error message, it is neither because of 32 bits nor because of the VM but because your (virtual) machine has only one core. The goal of the patch is to distribute computation on several cores. The doctest assumes that your machine has at least 2 cores. I should fix that. Though I'm not sure what to do on those kind of machine. Pretend that they are two core and let the computation run on those two cores ?",
    "created_at": "2016-04-15T20:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204737",
    "user": "https://github.com/hivert"
}
```

<a id='comment:107'></a>
Replying to [tmonteil](#comment%3A105):
> This ticket breaks the doctests on my patchbot, i do not know whether it is because it is run from a VM or from a 32-bit system, see http://patchbot.sagemath.org/log/0/debian/8.3/i686/3.16.0-4-586/tmonteil-debian-jessie-32/2016-04-15%2012:13:01?short


From the error message, it is neither because of 32 bits nor because of the VM but because your (virtual) machine has only one core. The goal of the patch is to distribute computation on several cores. The doctest assumes that your machine has at least 2 cores. I should fix that. Though I'm not sure what to do on those kind of machine. Pretend that they are two core and let the computation run on those two cores ?



---

archive/issue_comments_204738.json:
```json
{
    "body": "<a id='comment:108'></a>\nReplying to [hivert](#comment%3A107):\n> From the error message, it is neither because of 32 bits nor because of the VM but because your (virtual) machine has only one core. The goal of the patch is to distribute computation on several cores. The doctest assumes that your machine has at least 2 cores. I should fix that. Though I'm not sure what to do on those kind of machine. Pretend that they are two core and let the computation run on those two cores ?\n\n\nI just checked that I get the very same errors on my machine pretending that it has only one core.",
    "created_at": "2016-04-15T20:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204738",
    "user": "https://github.com/hivert"
}
```

<a id='comment:108'></a>
Replying to [hivert](#comment%3A107):
> From the error message, it is neither because of 32 bits nor because of the VM but because your (virtual) machine has only one core. The goal of the patch is to distribute computation on several cores. The doctest assumes that your machine has at least 2 cores. I should fix that. Though I'm not sure what to do on those kind of machine. Pretend that they are two core and let the computation run on those two cores ?


I just checked that I get the very same errors on my machine pretending that it has only one core.



---

archive/issue_comments_204739.json:
```json
{
    "body": "<a id='comment:9'></a>\nOK thanks for isolating the culplrit, i made #20449 as a follwup.",
    "created_at": "2016-04-15T20:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13580",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13580#issuecomment-204739",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:9'></a>
OK thanks for isolating the culplrit, i made #20449 as a follwup.
