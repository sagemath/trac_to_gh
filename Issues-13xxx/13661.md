# Issue 13661: accuracy problem in matrix_mod_pn for Eisenstein extensions of padics

archive/issues_013457.json:
```json
{
    "assignees": [
        "https://github.com/roed314"
    ],
    "body": "Currently, the accuracy of the matrix returned by `matrix_mod_pn()` in padic extension rings is probably too small:\n\n```\nsage: R=ZpCA(3,5)\nsage: S.<a> = R[]\nsage: L.<a>=R.extension(a^2-3)\nsage: t=a.add_bigoh(2)\nsage: t.matrix_mod_pn()\n[0 1]\n[0 0]\nsage: (t*a)._ntl_rep_abs() # but t*a is not zero\n([3], 0)\n```\n\nI think it would be better to return the following:\n\n```\n[0 1]\n[3 0]\n```\n\nOf course, the \"1\" is not known to precision `O(3^2)` but I think it is better to leave it to the caller to strip away the digits that are not wanted.\n\nThe attached patch increases the precision to the maximal precision of any of the entries of the matrix.\n\nDepends on #13659\n\nKeywords: **days71**\n\nBranch/Commit: **[u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics) @ [`956f124`](https://github.com/sagemath/sagetrac-mirror/commit/956f12477e66fa1f2568e910e1f1c6a97d2d7783)**\n\nAuthor: **Julian Rueth**\n\nComponent: **padics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13661_\n\n",
    "created_at": "2012-10-27T17:39:30Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20padics",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "accuracy problem in matrix_mod_pn for Eisenstein extensions of padics",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/13661",
    "user": "https://github.com/saraedum"
}
```
Currently, the accuracy of the matrix returned by `matrix_mod_pn()` in padic extension rings is probably too small:

```
sage: R=ZpCA(3,5)
sage: S.<a> = R[]
sage: L.<a>=R.extension(a^2-3)
sage: t=a.add_bigoh(2)
sage: t.matrix_mod_pn()
[0 1]
[0 0]
sage: (t*a)._ntl_rep_abs() # but t*a is not zero
([3], 0)
```

I think it would be better to return the following:

```
[0 1]
[3 0]
```

Of course, the "1" is not known to precision `O(3^2)` but I think it is better to leave it to the caller to strip away the digits that are not wanted.

The attached patch increases the precision to the maximal precision of any of the entries of the matrix.

Depends on #13659

Keywords: **days71**

Branch/Commit: **[u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics) @ [`956f124`](https://github.com/sagemath/sagetrac-mirror/commit/956f12477e66fa1f2568e910e1f1c6a97d2d7783)**

Author: **Julian Rueth**

Component: **padics**

_Issue created by migration from https://trac.sagemath.org/ticket/13661_





---

archive/issue_events_191191.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2012-10-27T17:39:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191191"
}
```



---

archive/issue_events_191192.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2012-10-27T17:39:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20padics",
    "label_color": "0000ff",
    "label_name": "c: padics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191192"
}
```



---

archive/issue_events_191193.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2012-10-27T17:39:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191193"
}
```



---

archive/issue_events_191194.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2012-10-27T17:39:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191194"
}
```



---

archive/issue_events_191195.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-27T17:39:30Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "subject": "https://github.com/saraedum",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191195"
}
```



---

archive/issue_comments_160343.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_13661.patch.gz](https://github.com/sagemath/sage/files/ticket13661/trac_13661.patch.gz)**",
    "created_at": "2013-08-13T15:35:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13661#issuecomment-160343",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_13661.patch.gz](https://github.com/sagemath/sage/files/ticket13661/trac_13661.patch.gz)**



---

archive/issue_events_191196.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191196"
}
```



---

archive/issue_events_191197.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191197"
}
```



---

archive/issue_events_191198.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191198"
}
```



---

archive/issue_events_191199.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191199"
}
```



---

archive/issue_events_191200.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191200"
}
```



---

archive/issue_events_191201.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191201"
}
```



---

archive/issue_events_191202.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191202"
}
```



---

archive/issue_events_191203.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191203"
}
```



---

archive/issue_comments_160344.json:
```json
{
    "body": "Branch: **[u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics)**",
    "created_at": "2016-03-16T20:43:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13661#issuecomment-160344",
    "user": "https://github.com/saraedum"
}
```

Branch: **[u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics](https://github.com/sagemath/sagetrac-mirror/tree/u/saraedum/accuracy_problem_in_matrix_mod_pn_for_eisenstein_extensions_of_padics)**



---

archive/issue_comments_160345.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b87ff516a8cb78a00bcc9dff6deed1da52eb3287\">b87ff51</a></td><td><code>Trac #13651: fixed a precision problem in _internal_lshift(), _ntl_rep_abs() of padics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3875b99bc6c7e8ac1d2745644423b34e3c5c6f9\">c3875b9</a></td><td><code>Merge branch 'develop' into t/13651/ticket/13651</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bb2a38d6af851e4ceaea311a5400496f62db730\">9bb2a38</a></td><td><code>http://trac.sagemath.org/raw-attachment/ticket/13659/trac_13659.patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/956f12477e66fa1f2568e910e1f1c6a97d2d7783\">956f124</a></td><td><code>Trac #13661: improved precision of matrix_mod_pn() and implemented matrix() for padics</code></td></tr></table>\n",
    "created_at": "2016-03-24T02:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13661#issuecomment-160345",
    "user": "https://github.com/saraedum"
}
```

<div id="comment:6"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b87ff516a8cb78a00bcc9dff6deed1da52eb3287">b87ff51</a></td><td><code>Trac #13651: fixed a precision problem in _internal_lshift(), _ntl_rep_abs() of padics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3875b99bc6c7e8ac1d2745644423b34e3c5c6f9">c3875b9</a></td><td><code>Merge branch 'develop' into t/13651/ticket/13651</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bb2a38d6af851e4ceaea311a5400496f62db730">9bb2a38</a></td><td><code>http://trac.sagemath.org/raw-attachment/ticket/13659/trac_13659.patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/956f12477e66fa1f2568e910e1f1c6a97d2d7783">956f124</a></td><td><code>Trac #13661: improved precision of matrix_mod_pn() and implemented matrix() for padics</code></td></tr></table>




---

archive/issue_comments_160346.json:
```json
{
    "body": "Commit: **[`956f124`](https://github.com/sagemath/sagetrac-mirror/commit/956f12477e66fa1f2568e910e1f1c6a97d2d7783)**",
    "created_at": "2016-03-24T02:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13661#issuecomment-160346",
    "user": "https://github.com/saraedum"
}
```

Commit: **[`956f124`](https://github.com/sagemath/sagetrac-mirror/commit/956f12477e66fa1f2568e910e1f1c6a97d2d7783)**



---

archive/issue_comments_160347.json:
```json
{
    "body": "Changed keywords from none to **days71**",
    "created_at": "2016-03-24T02:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13661#issuecomment-160347",
    "user": "https://github.com/saraedum"
}
```

Changed keywords from none to **days71**



---

archive/issue_events_191204.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13661",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13661#event-191204"
}
```
