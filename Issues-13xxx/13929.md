# Issue 13929: Wrong comparison of sparse vectors

archive/issues_013725.json:
```json
{
    "body": "The comparison of sparse vectors gives wrong results at the moment:\n\n```\nsage: V = FreeModule( GF(3), 2, sparse=True)\nsage: a = V([0,1])\nsage: b = V([1,0])\nsage: cmp(a, b)\n1 # should be -1, since we are using the lexicographic order\n```\n\nIn particular, this leads to different results when using sparse and dense vectors at the same time:\n\n```\nsage: cmp(a.dense_vector(), b)\n-1\nsage: cmp(a, b.dense_vector())\n1\n```\n\n\nAssignee: jason, was\n\nKeywords: comparison, sparse, free module\n\nReviewer: Christian Nassau\n\nAuthor: Thomas Feulner\n\nMerged: sage-5.7.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13929\n\n",
    "closed_at": "2013-01-30T07:35:37Z",
    "created_at": "2013-01-08T15:18:39Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "Wrong comparison of sparse vectors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13929",
    "user": "https://trac.sagemath.org/admin/accounts/users/tfeulner"
}
```
The comparison of sparse vectors gives wrong results at the moment:

```
sage: V = FreeModule( GF(3), 2, sparse=True)
sage: a = V([0,1])
sage: b = V([1,0])
sage: cmp(a, b)
1 # should be -1, since we are using the lexicographic order
```

In particular, this leads to different results when using sparse and dense vectors at the same time:

```
sage: cmp(a.dense_vector(), b)
-1
sage: cmp(a, b.dense_vector())
1
```


Assignee: jason, was

Keywords: comparison, sparse, free module

Reviewer: Christian Nassau

Author: Thomas Feulner

Merged: sage-5.7.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13929





---

archive/issue_events_052992.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "rename": {
        "from": "Wrong comparison of sparse",
        "to": "Wrong comparison of sparse vectors"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13929#event-52992"
}
```



---

archive/issue_comments_209323.json:
```json
{
    "body": "Attachment [trac_13929-sparse_vector_comparison.patch](tarball://root/attachments/some-uuid/ticket13929/trac_13929-sparse_vector_comparison.patch) by tfeulner created at 2013-01-08 15:44:40",
    "created_at": "2013-01-08T15:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209323",
    "user": "https://trac.sagemath.org/admin/accounts/users/tfeulner"
}
```

Attachment [trac_13929-sparse_vector_comparison.patch](tarball://root/attachments/some-uuid/ticket13929/trac_13929-sparse_vector_comparison.patch) by tfeulner created at 2013-01-08 15:44:40



---

archive/issue_comments_209324.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-01-09T05:57:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209324",
    "user": "https://trac.sagemath.org/admin/accounts/users/tfeulner"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_209325.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe patch seems to be correct (tested it against Sage 5.5) and does indeed fix a bug in the sorting order. I would have chosen a more informative doctest, for example\n\n```python\nsage: sorted(FreeModule(GF(3),2,sparse=True))\n[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]\nsage: sorted(FreeModule(GF(3),2,sparse=False))\n[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]\n```\nBut I think the patch is ready to go as it is, so I'm giving it a positive review.",
    "created_at": "2013-01-24T16:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209325",
    "user": "https://github.com/cnassau"
}
```

<a id='comment:3'></a>
The patch seems to be correct (tested it against Sage 5.5) and does indeed fix a bug in the sorting order. I would have chosen a more informative doctest, for example

```python
sage: sorted(FreeModule(GF(3),2,sparse=True))
[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]
sage: sorted(FreeModule(GF(3),2,sparse=False))
[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]
```
But I think the patch is ready to go as it is, so I'm giving it a positive review.



---

archive/issue_comments_209326.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-01-24T16:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209326",
    "user": "https://github.com/cnassau"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_209327.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Christian Nassau\"",
    "created_at": "2013-01-24T16:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209327",
    "user": "https://github.com/cnassau"
}
```

Changing reviewer from "" to "Christian Nassau"



---

archive/issue_comments_209328.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.7.beta2\"",
    "created_at": "2013-01-30T07:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209328",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.7.beta2"



---

archive/issue_events_052993.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:35:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13929#event-52993"
}
```



---

archive/issue_comments_209329.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-30T07:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13929",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13929#issuecomment-209329",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
