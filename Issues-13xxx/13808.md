# Issue 13808: Gromov hyperbolicity of graphs

archive/issues_013604.json:
```json
{
    "body": "This patch implements algorithms for computing the Gromov hyperbolicity of a graph. Although the worst case time complexity is in `O(n^4)`, the proposed implementation performs quite well in practice. It has been used on graphs with more than 10.000 vertices.\n\n\nAPPLY:\n* [attachment:trac_13808-v3.patch]\n* [attachment:trac_13808-revb.patch]\n* [attachment:trac_13808-rev2.patch]\n* [attachment:trac_13808-combinations.patch]\n\n\n\n**Assignee:** @jasongrout, @nathanncohen, @rlmill\n\n**CC:**  @nathanncohen\n\n**Keywords:** graph, hyperbolicity\n\n**Reviewer:** Nathann Cohen\n\n**Author:** David Coudert\n\n**Merged:** sage-5.6.rc0\n\n**Dependencies:** #13821\n\nIssue created by migration from https://trac.sagemath.org/ticket/13808\n\n",
    "closed_at": "2013-01-12T08:52:16Z",
    "created_at": "2012-12-07T19:40:15Z",
    "labels": [
        "component: graph theory",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "title": "Gromov hyperbolicity of graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13808",
    "user": "https://github.com/dcoudert"
}
```
This patch implements algorithms for computing the Gromov hyperbolicity of a graph. Although the worst case time complexity is in `O(n^4)`, the proposed implementation performs quite well in practice. It has been used on graphs with more than 10.000 vertices.


APPLY:
* [attachment:trac_13808-v3.patch]
* [attachment:trac_13808-revb.patch]
* [attachment:trac_13808-rev2.patch]
* [attachment:trac_13808-combinations.patch]



**Assignee:** @jasongrout, @nathanncohen, @rlmill

**CC:**  @nathanncohen

**Keywords:** graph, hyperbolicity

**Reviewer:** Nathann Cohen

**Author:** David Coudert

**Merged:** sage-5.6.rc0

**Dependencies:** #13821

Issue created by migration from https://trac.sagemath.org/ticket/13808





---

archive/issue_events_118416.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-08T12:06:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118416"
}
```



---

archive/issue_comments_164987.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"graph, hyperbolicity\".",
    "created_at": "2012-12-08T12:06:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164987",
    "user": "https://github.com/dcoudert"
}
```

**Changing keywords** from "" to "graph, hyperbolicity".



---

archive/issue_comments_164988.json:
```json
{
    "body": "<a id='comment:1'></a>\nI did my best to put comments inside the patch and sufficient documentation. I hope one will be able to review this patch ;-)\n\nThanks.",
    "created_at": "2012-12-08T12:06:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164988",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:1'></a>
I did my best to put comments inside the patch and sufficient documentation. I hope one will be able to review this patch ;-)

Thanks.



---

archive/issue_events_118417.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-12-09T19:37:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118417"
}
```



---

archive/issue_events_118418.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-12-09T19:37:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118418"
}
```



---

archive/issue_comments_164989.json:
```json
{
    "body": "<a id='comment:2'></a>\nHere is my current patch, and two comments :\n\n* It would be nice if ``sage -coverage hyperbolicity.pyx`` returned \"100% coverage\". I hate to say it, because it often means adding useless tests just to fit to the metrics `-_-`\n* What is the use of _reduce_biconnected_graph compared to goodcores ? The docstring says that this function, by removing degree 2 vertices whose neighborhood is an edge, would reduce a complete bipartite graph to an edge... But no vertex of a complete bipartite graph is adjacent to two adjacent vertices (a triangle). I do not see how (as the docstring says) this function does anything different from the good core decomposition method above.\n\nIt would also be better to set this ticket to `need_work` until your have found out where the bug you found comes from. \n\nTell me what you think of the changes I made ! They should make the html doc nicer !\n\nNathann",
    "created_at": "2012-12-09T19:37:31Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164989",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>
Here is my current patch, and two comments :

* It would be nice if ``sage -coverage hyperbolicity.pyx`` returned "100% coverage". I hate to say it, because it often means adding useless tests just to fit to the metrics `-_-`
* What is the use of _reduce_biconnected_graph compared to goodcores ? The docstring says that this function, by removing degree 2 vertices whose neighborhood is an edge, would reduce a complete bipartite graph to an edge... But no vertex of a complete bipartite graph is adjacent to two adjacent vertices (a triangle). I do not see how (as the docstring says) this function does anything different from the good core decomposition method above.

It would also be better to set this ticket to `need_work` until your have found out where the bug you found comes from. 

Tell me what you think of the changes I made ! They should make the html doc nicer !

Nathann



---

archive/issue_comments_164990.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [ncohen](#comment%3A2):\n> Here is my current patch, and two comments :\n> \n> * It would be nice if ``sage -coverage hyperbolicity.pyx`` returned \"100% coverage\". I hate to say it, because it often means adding useless tests just to fit to the metrics `-_-`\n\n\nOK, I will work on this.\n\n> * What is the use of _reduce_biconnected_graph compared to goodcores ? \n\n\nUseless, but since it is very fast (linear) it can be used for all methods, while goodcores is only for cuts+.\n\n> The docstring says that this function, by removing degree 2 vertices whose neighborhood is an edge, would reduce a complete bipartite graph to an edge... But no vertex of a complete bipartite graph is adjacent to two adjacent vertices (a triangle). I do not see how (as the docstring says) this function does anything different from the good core decomposition method above.\n\n\nOups. We must add an edge to get many triangles.\n\n> It would also be better to set this ticket to `need_work` until your have found out where the bug you found comes from. \n\n\nSure.\n \n> Tell me what you think of the changes I made ! They should make the html doc nicer !\n\n\nThat's perfect. Thanks.\n \n> Nathann\n",
    "created_at": "2012-12-09T19:56:18Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164990",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'></a>
Replying to [ncohen](#comment%3A2):
> Here is my current patch, and two comments :
> 
> * It would be nice if ``sage -coverage hyperbolicity.pyx`` returned "100% coverage". I hate to say it, because it often means adding useless tests just to fit to the metrics `-_-`


OK, I will work on this.

> * What is the use of _reduce_biconnected_graph compared to goodcores ? 


Useless, but since it is very fast (linear) it can be used for all methods, while goodcores is only for cuts+.

> The docstring says that this function, by removing degree 2 vertices whose neighborhood is an edge, would reduce a complete bipartite graph to an edge... But no vertex of a complete bipartite graph is adjacent to two adjacent vertices (a triangle). I do not see how (as the docstring says) this function does anything different from the good core decomposition method above.


Oups. We must add an edge to get many triangles.

> It would also be better to set this ticket to `need_work` until your have found out where the bug you found comes from. 


Sure.
 
> Tell me what you think of the changes I made ! They should make the html doc nicer !


That's perfect. Thanks.
 
> Nathann




---

archive/issue_comments_164991.json:
```json
{
    "body": "<a id='comment:4'></a>\n> Useless, but since it is very fast (linear) it can be used for all methods, while goodcores is only for cuts+.\n\n\nOh. But what is the difference between this function and the other one, what is it that `_reduce_biconnected_graph` can do and that the core decomposition can't ? Is their running time very different for the same purposes ? Why do you need two functions ?\n\nNathann",
    "created_at": "2012-12-09T20:06:20Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164991",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
> Useless, but since it is very fast (linear) it can be used for all methods, while goodcores is only for cuts+.


Oh. But what is the difference between this function and the other one, what is it that `_reduce_biconnected_graph` can do and that the core decomposition can't ? Is their running time very different for the same purposes ? Why do you need two functions ?

Nathann



---

archive/issue_events_118419.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-15T15:06:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118419"
}
```



---

archive/issue_events_118420.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-15T15:06:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118420"
}
```



---

archive/issue_comments_164992.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1,6 @@\n This patch implements algorithms for computing the Gromov hyperbolicity of a graph. Although the worst case time complexity is in `O(n^4)`, the proposed implementation performs quite well in practice. It has been used on graphs with more than 10.000 vertices.\n \n+\n+APPLY:\n+* [attachment:trac_13808-v2.patch]\n+\n``````\n",
    "created_at": "2012-12-15T15:06:57Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164992",
    "user": "https://github.com/dcoudert"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1,6 @@
 This patch implements algorithms for computing the Gromov hyperbolicity of a graph. Although the worst case time complexity is in `O(n^4)`, the proposed implementation performs quite well in practice. It has been used on graphs with more than 10.000 vertices.
 
+
+APPLY:
+* [attachment:trac_13808-v2.patch]
+
``````




---

archive/issue_comments_164993.json:
```json
{
    "body": "<a id='comment:5'></a>\nHello,\n\nI have fully revised the patch. I have merged both patches into a new one to simplify the process. I have removed the `_reduce_biconnected_graph` and `good_core_decomposition` methods and added a new one: `elimination_buckets`, where a bucket is understood as a set of vertices that can be eliminated as soon as the lower equals the index of the bucket. So far, this new function only identifies vertices that can be eliminated as soon as we know that the lower bound is 1. The code contains all the machinery to handle larger values, but I don't have good heuristic/algorithm ready to identify vertices that can be eliminated for 2 (only slow and not efficient methods). I propose to let this part for a future patch. This one is already huge...\n\nThe doc coverage is now 100%.\n\nShould be better now.",
    "created_at": "2012-12-15T15:06:57Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164993",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>
Hello,

I have fully revised the patch. I have merged both patches into a new one to simplify the process. I have removed the `_reduce_biconnected_graph` and `good_core_decomposition` methods and added a new one: `elimination_buckets`, where a bucket is understood as a set of vertices that can be eliminated as soon as the lower equals the index of the bucket. So far, this new function only identifies vertices that can be eliminated as soon as we know that the lower bound is 1. The code contains all the machinery to handle larger values, but I don't have good heuristic/algorithm ready to identify vertices that can be eliminated for 2 (only slow and not efficient methods). I propose to let this part for a future patch. This one is already huge...

The doc coverage is now 100%.

Should be better now.



---

archive/issue_comments_164994.json:
```json
{
    "body": "<a id='comment:6'></a>\nApply trac_13808-v2.patch",
    "created_at": "2012-12-16T15:49:22Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164994",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>
Apply trac_13808-v2.patch



---

archive/issue_comments_164995.json:
```json
{
    "body": "<a id='comment:7'></a>\nHelloooooooo David !!\n\nWell, I have been working of this patch for the last hour (at least), and I was not able to produce a patch for some of the changes I think would be good for I still do not understand the code well enough, and I only end up producing segfaults...\n\nI think that it would be nice to define the following C struct, for we are in the wonderful world of C where creating structs is totally free (unlike Java `:-P`)\n\n```\n# Defining a pair of vertices as a C struct                                                                                                                                                                                                                                     \nctypedef struct pair:                                                                                                                                                                                                                                                           \n    int i                                                                                                                                                                                                                                                                  \n    int j    \n```\n\nThis way, you do not have wird `+2` increments anymore, and you can call the `invert_cells` function only once (to exchange pair structs, not integers).\n\nI wanted to add the following documentation \n\n```\n    # We organize the pairs of vertices by length in an array of pair structs                                                                                                                                                                                                   \n    #                                                                                                                                                                                                                                                                           \n    # - path_of_length[i] point to the list of nb_path_of_length[i] pairs of                                                                                                                                                                                                    \n    #   vertices at distance i                                                                                                                                                                                                                                                  \n    #                                                                                                                                                                                                                                                                           \n    # - cpt_path[i] counts the number of pairs have already been added to                                                                                                                                                                                                       \n    #   path_of_length[i]                                                                                                                                                                                                                                                       \n    #                                                                                                                                                                                                                                                                           \n    # - all_pairs is a memory block of binomial(n,2) pairs of                                                                                                                                                                                                                   \n    #   vertices. path_of_length[i] points toward a memory area contained in -                                                                                                                                                                                                  \n    #   all_pairs.                                                                                                                                                                                                                                                              \n    #        \n```\nto replace your \n\n```\n# We organize the path by length in an array using 2 cells per path.\n```\nthough it only makes sense in my segfaulting version of hyperbolicity.pyx. If you agree with this change from integers toward pairs, then this doc could be useful.\n\nOther comments :\n* I do not see the point of using uint64_t instead of integers. I mean, if we all agree that the code is not supposed to run on 16-bits machines `:-P` The integers you need are -- in the worst case -- of order `n^2`, which may reach the 32bits limit only if the graph has size around 40k vertices. The rest of the time, requiring the integers to be 64bits just means moving around blocks of 0, and will be slower than int on 32 bits machines. Except if I missed something somewhere `O_o` Plus the code would be muuuuuuuuch easier to read without that `:-P`\n* You say several times that you compute the number of paths of each length. This scared me for you did this with only +1 increments, and the number of paths of each length is possibly... HUGE (of order `n!` in a complete graph). What you compute is actually the number of pairs of distance l for each l. Some names of variables need to be updated.\n* elimination_bucket : hmmm... Well, this method is written so that it is able to deal with code that.... it does not contain :-P\n\n```\n    - Then, we take a vertex ``u``. The diameter in ``G`` of the subgraph of its                                                                                                                                                                                                 \n      neighbors is at most two. To ensure a valid tree-decomposition, we select                                                                                                                                                                                                  \n      ``u`` if and only if the bag formed by its neighbors is either included in                                                                                                                                                                                                 \n      another bag, or includes another bag. We repeat until no more vertex can be                                                                                                                                                                                                \n      selected. This step is heuristic and the result depends on the order in                                                                                                                                                                                                    \n      which vertices are considered. NOT IMPLEMENTED YET.  \n```\n And it returns a list of things, in which only the first element will have any use (the one corresponding to vertices whose neighborhood is a clique) for the other ones will be empty. And the `max_diameter` is completely useless, ...\n* Oh, and you can use `sage_calloc` to allocate and set to zero at the same time.\n\nI attach a small patch that deals with unimportant things.\n\nNathann",
    "created_at": "2012-12-17T17:33:13Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164995",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>
Helloooooooo David !!

Well, I have been working of this patch for the last hour (at least), and I was not able to produce a patch for some of the changes I think would be good for I still do not understand the code well enough, and I only end up producing segfaults...

I think that it would be nice to define the following C struct, for we are in the wonderful world of C where creating structs is totally free (unlike Java `:-P`)

```
# Defining a pair of vertices as a C struct                                                                                                                                                                                                                                     
ctypedef struct pair:                                                                                                                                                                                                                                                           
    int i                                                                                                                                                                                                                                                                  
    int j    
```

This way, you do not have wird `+2` increments anymore, and you can call the `invert_cells` function only once (to exchange pair structs, not integers).

I wanted to add the following documentation 

```
    # We organize the pairs of vertices by length in an array of pair structs                                                                                                                                                                                                   
    #                                                                                                                                                                                                                                                                           
    # - path_of_length[i] point to the list of nb_path_of_length[i] pairs of                                                                                                                                                                                                    
    #   vertices at distance i                                                                                                                                                                                                                                                  
    #                                                                                                                                                                                                                                                                           
    # - cpt_path[i] counts the number of pairs have already been added to                                                                                                                                                                                                       
    #   path_of_length[i]                                                                                                                                                                                                                                                       
    #                                                                                                                                                                                                                                                                           
    # - all_pairs is a memory block of binomial(n,2) pairs of                                                                                                                                                                                                                   
    #   vertices. path_of_length[i] points toward a memory area contained in -                                                                                                                                                                                                  
    #   all_pairs.                                                                                                                                                                                                                                                              
    #        
```
to replace your 

```
# We organize the path by length in an array using 2 cells per path.
```
though it only makes sense in my segfaulting version of hyperbolicity.pyx. If you agree with this change from integers toward pairs, then this doc could be useful.

Other comments :
* I do not see the point of using uint64_t instead of integers. I mean, if we all agree that the code is not supposed to run on 16-bits machines `:-P` The integers you need are -- in the worst case -- of order `n^2`, which may reach the 32bits limit only if the graph has size around 40k vertices. The rest of the time, requiring the integers to be 64bits just means moving around blocks of 0, and will be slower than int on 32 bits machines. Except if I missed something somewhere `O_o` Plus the code would be muuuuuuuuch easier to read without that `:-P`
* You say several times that you compute the number of paths of each length. This scared me for you did this with only +1 increments, and the number of paths of each length is possibly... HUGE (of order `n!` in a complete graph). What you compute is actually the number of pairs of distance l for each l. Some names of variables need to be updated.
* elimination_bucket : hmmm... Well, this method is written so that it is able to deal with code that.... it does not contain :-P

```
    - Then, we take a vertex ``u``. The diameter in ``G`` of the subgraph of its                                                                                                                                                                                                 
      neighbors is at most two. To ensure a valid tree-decomposition, we select                                                                                                                                                                                                  
      ``u`` if and only if the bag formed by its neighbors is either included in                                                                                                                                                                                                 
      another bag, or includes another bag. We repeat until no more vertex can be                                                                                                                                                                                                
      selected. This step is heuristic and the result depends on the order in                                                                                                                                                                                                    
      which vertices are considered. NOT IMPLEMENTED YET.  
```
 And it returns a list of things, in which only the first element will have any use (the one corresponding to vertices whose neighborhood is a clique) for the other ones will be empty. And the `max_diameter` is completely useless, ...
* Oh, and you can use `sage_calloc` to allocate and set to zero at the same time.

I attach a small patch that deals with unimportant things.

Nathann



---

archive/issue_events_118421.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-12-17T17:33:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118421"
}
```



---

archive/issue_events_118422.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-12-17T17:33:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118422"
}
```



---

archive/issue_comments_164996.json:
```json
{
    "body": "<a id='comment:8'></a>\nOh, and I forgot something ! You define in your graph a tmp variable which is totally useless. You can remove it, and define it only inside of `_invert_cells` !\n\nNathann",
    "created_at": "2012-12-17T17:34:46Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164996",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
Oh, and I forgot something ! You define in your graph a tmp variable which is totally useless. You can remove it, and define it only inside of `_invert_cells` !

Nathann



---

archive/issue_comments_164997.json:
```json
{
    "body": "<a id='comment:9'></a>\nHello,\n\n1. Yes we can define a structure to store extremities of paths, but I'm not so sure it is totally free. I agree it could be easier to read.\n2. I agree with proposed improvement of documentation\n3. Concerning the uint64_t. I did some tests with very large graphs, so it was useful at least for me (I also used that type to count number of visited 4-tuples although it is not part of this patch). Furthermore, I'm not so sure we can use int instead, and clearly unsigned int or unsigned long int would be harder to read that uint64_t. \n4. Number of paths: you are right. The proposed modification clarifies the doc.\n5. elimination_bucket: The patch is ready to host any heuristic/algo able to identify vertices that could be eliminated as soon as the lower bound is 2 or 3 or more. However, as discussed by mail, I don't have efficient ways to identify such vertices yet. Since the extra cost is negligeable, I suggest to let it as it (including comments).\n6. sage_calloc: was not aware of it. is it safe? stable? can we safely use it if we use structures instead of arrays of numbers?\n7. extra tmp variable: since the function _invert_cells is inlined, it means each execution would have to instantiate a new variable. I'm not sure it is better/faster than current implementation.\n8. the a.patch is OK.\n\nD.",
    "created_at": "2012-12-17T19:54:06Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164997",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:9'></a>
Hello,

1. Yes we can define a structure to store extremities of paths, but I'm not so sure it is totally free. I agree it could be easier to read.
2. I agree with proposed improvement of documentation
3. Concerning the uint64_t. I did some tests with very large graphs, so it was useful at least for me (I also used that type to count number of visited 4-tuples although it is not part of this patch). Furthermore, I'm not so sure we can use int instead, and clearly unsigned int or unsigned long int would be harder to read that uint64_t. 
4. Number of paths: you are right. The proposed modification clarifies the doc.
5. elimination_bucket: The patch is ready to host any heuristic/algo able to identify vertices that could be eliminated as soon as the lower bound is 2 or 3 or more. However, as discussed by mail, I don't have efficient ways to identify such vertices yet. Since the extra cost is negligeable, I suggest to let it as it (including comments).
6. sage_calloc: was not aware of it. is it safe? stable? can we safely use it if we use structures instead of arrays of numbers?
7. extra tmp variable: since the function _invert_cells is inlined, it means each execution would have to instantiate a new variable. I'm not sure it is better/faster than current implementation.
8. the a.patch is OK.

D.



---

archive/issue_comments_164998.json:
```json
{
    "body": "<a id='comment:10'></a>\nHellooooooooooooooooooo !!\n\nA better day begins, with music. Music solves everything `:-P`\n\n> 1. Yes we can define a structure to store extremities of paths, but I'm not so sure it is totally free. I agree it could be easier to read.\n\n\nOh. C struct ? Yeah, they are free. Especially when their size is 2*sizeof(int) `:-P`\n\n> 1. I agree with proposed improvement of documentation\n> 2. Concerning the uint64_t. I did some tests with very large graphs, so it was useful at least for me (I also used that type to count number of visited 4-tuples although it is not part of this patch). \n\n\nWhat ? `O_o`\nDo you mean that in some situation regular int were not enough ? I really wonder where `O_O;;;`\n\nFurthermore, I'm not so sure we can use int instead, and clearly unsigned int or unsigned long int would be harder to read that uint64_t. \n\nWell, it seems to me that you can easily use regular 32 bits int without any proble, so that coding this with int should work. You count vertices (less than `2^16=65536`, and even less than `2^15=32768`. Anyway the distance_all_pairs code is meant to work with unished short, if I make no mistake, so it would not work if you have more than `2^16-1` vertices. Then, you count pair of vertices, and this is not larger than `(2<sup>16)</sup>2 = 2^32`, so what's the problem ? At some point in your code there is a weird \"if\" with a comment reading \"we work on unisnged int\", and I did not understand it so I cannot tell right now that this would not be a problem either if 64-bits int are replaced by 32bits int.\n\n> 1. Number of paths: you are right. The proposed modification clarifies the doc.\n> 2. elimination_bucket: The patch is ready to host any heuristic/algo able to identify vertices that could be eliminated as soon as the lower bound is 2 or 3 or more. However, as discussed by mail, I don't have efficient ways to identify such vertices yet. Since the extra cost is negligeable, I suggest to let it as it (including comments).\n\n\nWell, the extra computing time is negligible, but it makes it much harder to understand when you try to read the code. And. Well, it does nothing `^^;` Could you keep a copy of this method instead, to be used when you will have heuristics to plug there, and in the meantime keep Sage's code optimal with what is implemented and not what we plan to implement eventually ? `:-P`\n\n> 1. sage_calloc: was not aware of it. is it safe? stable? can we safely use it if we use structures instead of arrays of numbers?\n\n\nOh. Well, calloc is a C function, so I guess that it is just wrapped by sage, the same way malloc and free are wrapped.\nhttp://linux.die.net/man/3/calloc\n\n> 1. extra tmp variable: since the function _invert_cells is inlined, it means each execution would have to instantiate a new variable. I'm not sure it is better/faster than current implementation.\n\n\nHere is how the function is writted right now :\n\n```\ncdef inline _invert_cells(uint64_t * tab, uint64_t idxa, uint64_t idxb, uint64_t tmp): \n     tmp = tab[idxa] \n     tab[idxa] = tab[idxb] \n     tab[idxb] = tmp \n```\n\nLet us assume for a start that the function is *NOT* inlined. In this case, the value of \"tmp\" that the function received as input is totally useless : the function creates a new local variable named tmp, and assigns to it the value of tmp given as input.\nWell, that is useless for a new local variable is created.\n\nAnd if the function is inlined, a variable will be created, well then there is no problem for a variable will be created inside of the function that call it to do exactly what you are doing.\n\nBut. Well, how much do you want to bet that it is totally impossible to detect the difference between the two codes, even if _invert_cells called malloc(sizeof(int)) manually each time this function is called ? `:-P`\n\n> 1. the a.patch is OK.\n\n\nNathann",
    "created_at": "2012-12-18T09:55:04Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164998",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>
Hellooooooooooooooooooo !!

A better day begins, with music. Music solves everything `:-P`

> 1. Yes we can define a structure to store extremities of paths, but I'm not so sure it is totally free. I agree it could be easier to read.


Oh. C struct ? Yeah, they are free. Especially when their size is 2*sizeof(int) `:-P`

> 1. I agree with proposed improvement of documentation
> 2. Concerning the uint64_t. I did some tests with very large graphs, so it was useful at least for me (I also used that type to count number of visited 4-tuples although it is not part of this patch). 


What ? `O_o`
Do you mean that in some situation regular int were not enough ? I really wonder where `O_O;;;`

Furthermore, I'm not so sure we can use int instead, and clearly unsigned int or unsigned long int would be harder to read that uint64_t. 

Well, it seems to me that you can easily use regular 32 bits int without any proble, so that coding this with int should work. You count vertices (less than `2^16=65536`, and even less than `2^15=32768`. Anyway the distance_all_pairs code is meant to work with unished short, if I make no mistake, so it would not work if you have more than `2^16-1` vertices. Then, you count pair of vertices, and this is not larger than `(2<sup>16)</sup>2 = 2^32`, so what's the problem ? At some point in your code there is a weird "if" with a comment reading "we work on unisnged int", and I did not understand it so I cannot tell right now that this would not be a problem either if 64-bits int are replaced by 32bits int.

> 1. Number of paths: you are right. The proposed modification clarifies the doc.
> 2. elimination_bucket: The patch is ready to host any heuristic/algo able to identify vertices that could be eliminated as soon as the lower bound is 2 or 3 or more. However, as discussed by mail, I don't have efficient ways to identify such vertices yet. Since the extra cost is negligeable, I suggest to let it as it (including comments).


Well, the extra computing time is negligible, but it makes it much harder to understand when you try to read the code. And. Well, it does nothing `^^;` Could you keep a copy of this method instead, to be used when you will have heuristics to plug there, and in the meantime keep Sage's code optimal with what is implemented and not what we plan to implement eventually ? `:-P`

> 1. sage_calloc: was not aware of it. is it safe? stable? can we safely use it if we use structures instead of arrays of numbers?


Oh. Well, calloc is a C function, so I guess that it is just wrapped by sage, the same way malloc and free are wrapped.
http://linux.die.net/man/3/calloc

> 1. extra tmp variable: since the function _invert_cells is inlined, it means each execution would have to instantiate a new variable. I'm not sure it is better/faster than current implementation.


Here is how the function is writted right now :

```
cdef inline _invert_cells(uint64_t * tab, uint64_t idxa, uint64_t idxb, uint64_t tmp): 
     tmp = tab[idxa] 
     tab[idxa] = tab[idxb] 
     tab[idxb] = tmp 
```

Let us assume for a start that the function is *NOT* inlined. In this case, the value of "tmp" that the function received as input is totally useless : the function creates a new local variable named tmp, and assigns to it the value of tmp given as input.
Well, that is useless for a new local variable is created.

And if the function is inlined, a variable will be created, well then there is no problem for a variable will be created inside of the function that call it to do exactly what you are doing.

But. Well, how much do you want to bet that it is totally impossible to detect the difference between the two codes, even if _invert_cells called malloc(sizeof(int)) manually each time this function is called ? `:-P`

> 1. the a.patch is OK.


Nathann



---

archive/issue_comments_164999.json:
```json
{
    "body": "<a id='comment:11'></a>\n> > 1. Concerning the uint64_t. I did some tests with very large graphs, so it was useful at least for me (I also used that type to count number of visited 4-tuples although it is not part of this patch). \n  \n> \n> What ? `O_o`\n> Do you mean that in some situation regular int were not enough ? I really wonder where `O_O;;;`\n\n\nOn some computers, unsigned long int are on 32 bits. When you count the number of visited 4-tuples, you can exceed `2^32-1`. It happens when working on biconnected graphs with more than 20000 vertices (kind of graphs I'm currently considering).\n\n\nFor the rest of the code, I will (try to) simplify it asap.\n\n\nD.",
    "created_at": "2012-12-18T11:00:27Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-164999",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>
> > 1. Concerning the uint64_t. I did some tests with very large graphs, so it was useful at least for me (I also used that type to count number of visited 4-tuples although it is not part of this patch). 
  
> 
> What ? `O_o`
> Do you mean that in some situation regular int were not enough ? I really wonder where `O_O;;;`


On some computers, unsigned long int are on 32 bits. When you count the number of visited 4-tuples, you can exceed `2^32-1`. It happens when working on biconnected graphs with more than 20000 vertices (kind of graphs I'm currently considering).


For the rest of the code, I will (try to) simplify it asap.


D.



---

archive/issue_comments_165000.json:
```json
{
    "body": "<a id='comment:12'></a>\n> On some computers, unsigned long int are on 32 bits. When you count the number of visited 4-tuples, you can exceed `2^32-1`. It happens when working on biconnected graphs with more than 20000 vertices (kind of graphs I'm currently considering).\n\n\nOh, right. `n^4` can go far beyond 32bits integers indeed !\n\nNathann",
    "created_at": "2012-12-18T11:01:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165000",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>
> On some computers, unsigned long int are on 32 bits. When you count the number of visited 4-tuples, you can exceed `2^32-1`. It happens when working on biconnected graphs with more than 20000 vertices (kind of graphs I'm currently considering).


Oh, right. `n^4` can go far beyond 32bits integers indeed !

Nathann



---

archive/issue_comments_165001.json:
```json
{
    "body": "<a id='comment:13'></a>\nI have implemented all proposed changes:\n- use of a struct for pairs\n- use of sage_calloc when appropriate\n- use uint32_t instead of uint64_t when appropriate. These types are shorter to write/read. Also uint64_t is needed for distributions since number could potentially be huge (more theoretical than practical due to huge computation time)\n- improve ordering for visiting pairs\n- simplify pre-processing and corresponding data structure. It now only considers simplicial vertices.\n\nI have merged the [attachment:a.patch] into the new version of the patch: [attachment:trac_13808-v3.patch]. The patch is much better now, the doc is nicer, and it is a bit faster.",
    "created_at": "2012-12-21T00:12:48Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165001",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:13'></a>
I have implemented all proposed changes:
- use of a struct for pairs
- use of sage_calloc when appropriate
- use uint32_t instead of uint64_t when appropriate. These types are shorter to write/read. Also uint64_t is needed for distributions since number could potentially be huge (more theoretical than practical due to huge computation time)
- improve ordering for visiting pairs
- simplify pre-processing and corresponding data structure. It now only considers simplicial vertices.

I have merged the [attachment:a.patch] into the new version of the patch: [attachment:trac_13808-v3.patch]. The patch is much better now, the doc is nicer, and it is a bit faster.



---

archive/issue_comments_165002.json:
```json
{
    "body": "**Reviewer:** Nathann Cohen",
    "created_at": "2012-12-21T00:12:48Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165002",
    "user": "https://github.com/dcoudert"
}
```

**Reviewer:** Nathann Cohen



---

archive/issue_events_118423.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-21T00:12:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118423"
}
```



---

archive/issue_events_118424.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-21T00:12:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118424"
}
```



---

archive/issue_comments_165003.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n \n \n APPLY:\n-* [attachment:trac_13808-v2.patch]\n+* [attachment:trac_13808-v3.patch]\n \n``````\n",
    "created_at": "2012-12-21T00:12:48Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165003",
    "user": "https://github.com/dcoudert"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 
 
 APPLY:
-* [attachment:trac_13808-v2.patch]
+* [attachment:trac_13808-v3.patch]
 
``````




---

archive/issue_comments_165004.json:
```json
{
    "body": "<a id='comment:14'></a>\ndon't know why the patchbot applies v2+a.patch+v3. How to change this ?",
    "created_at": "2012-12-21T09:12:13Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165004",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:14'></a>
don't know why the patchbot applies v2+a.patch+v3. How to change this ?



---

archive/issue_comments_165005.json:
```json
{
    "body": "<a id='comment:15'></a>\nApply trac_13808-v3.patch",
    "created_at": "2012-12-21T15:22:48Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165005",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>
Apply trac_13808-v3.patch



---

archive/issue_comments_165006.json:
```json
{
    "body": "<a id='comment:16'></a>\nHelloooooo again !!\n\nIt took quiiiiiiiiite a while, but I think it's done ! Here is a small patch to attach on top of yours if you agree with it. One mistake (1->2), some comments, and memory checks Btw, if you find a way to make memory checks more compact, I'd be glad to learn it. Thought about it for a while, didn't find anything.\n\nYou can set this patch to positive review if everything is fine for you !\n\nNathann",
    "created_at": "2012-12-21T16:02:19Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165006",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>
Helloooooo again !!

It took quiiiiiiiiite a while, but I think it's done ! Here is a small patch to attach on top of yours if you agree with it. One mistake (1->2), some comments, and memory checks Btw, if you find a way to make memory checks more compact, I'd be glad to learn it. Thought about it for a while, didn't find anything.

You can set this patch to positive review if everything is fine for you !

Nathann



---

archive/issue_comments_165007.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,4 +3,6 @@\n \n APPLY:\n * [attachment:trac_13808-v3.patch]\n+* [attachment:trac_13808-rev.patch]\n+* [attachment:trac_13808-rev2.patch]\n \n``````\n",
    "created_at": "2012-12-21T20:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165007",
    "user": "https://github.com/dcoudert"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,4 +3,6 @@
 
 APPLY:
 * [attachment:trac_13808-v3.patch]
+* [attachment:trac_13808-rev.patch]
+* [attachment:trac_13808-rev2.patch]
 
``````




---

archive/attachments_018669.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13808-rev.patch",
    "asset_url": "tarball://root/attachments/ticket13808/trac_13808-rev.patch",
    "created_at": "2012-12-21T20:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13808/trac_13808-rev.patch",
    "user": "https://github.com/dcoudert"
}
```



---

archive/issue_comments_165008.json:
```json
{
    "body": "<a id='comment:17'></a>\nAttachment [trac_13808-rev.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-rev.patch) by @dcoudert created at 2012-12-21 20:14:39\n\nThanks for the revision patch. I did some more improvements in the rev2 patch to prevent others bugs. In particular, I found that the `c_distances_all_pairs` function returns NULL when the memory space is too small. I have added dedicated test, but may be we should patch the distance all pairs function.\n\nQ: should we add a message to MemoryError like \"Not enough memory to execute the function.\". We cannot doctest this because this is machine dependent.\n\nLet me know.",
    "created_at": "2012-12-21T20:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165008",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:17'></a>
Attachment [trac_13808-rev.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-rev.patch) by @dcoudert created at 2012-12-21 20:14:39

Thanks for the revision patch. I did some more improvements in the rev2 patch to prevent others bugs. In particular, I found that the `c_distances_all_pairs` function returns NULL when the memory space is too small. I have added dedicated test, but may be we should patch the distance all pairs function.

Q: should we add a message to MemoryError like "Not enough memory to execute the function.". We cannot doctest this because this is machine dependent.

Let me know.



---

archive/issue_comments_165009.json:
```json
{
    "body": "<a id='comment:18'></a>\nHelloooooooooo !!\n\nWhy isn't your `hyp==2` a `hyp >= 2` ? Once this is clear, you can set the ticket to `positive_review`. I hope that your next patches will be a tad smaller though `:-P`\n\nNathann",
    "created_at": "2012-12-24T13:27:36Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165009",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:18'></a>
Helloooooooooo !!

Why isn't your `hyp==2` a `hyp >= 2` ? Once this is clear, you can set the ticket to `positive_review`. I hope that your next patches will be a tad smaller though `:-P`

Nathann



---

archive/issue_events_118425.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-12-24T13:27:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118425"
}
```



---

archive/issue_events_118426.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-12-24T13:27:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118426"
}
```



---

archive/issue_comments_165010.json:
```json
{
    "body": "<a id='comment:19'></a>\nAbout `c_distances_all_pairs` : well, it's up to you actually. Exceptions could be nice too, as I do not expect this to cost much time where `c_distances_all_pairs` is called. But in another patch ! `;-)`\n\nNathann",
    "created_at": "2012-12-24T13:28:51Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165010",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'></a>
About `c_distances_all_pairs` : well, it's up to you actually. Exceptions could be nice too, as I do not expect this to cost much time where `c_distances_all_pairs` is called. But in another patch ! `;-)`

Nathann



---

archive/attachments_018670.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13808-rev2.patch",
    "asset_url": "tarball://root/attachments/ticket13808/trac_13808-rev2.patch",
    "created_at": "2012-12-28T11:07:47Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13808/trac_13808-rev2.patch",
    "user": "https://github.com/dcoudert"
}
```



---

archive/issue_comments_165011.json:
```json
{
    "body": "<a id='comment:20'></a>\nAttachment [trac_13808-rev2.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-rev2.patch) by @dcoudert created at 2012-12-28 11:07:47\n\nHello Nathann,\n\nI have replaced the hyp==2 with hyp>=2 and clarified the text.\n\nThanks for the review. The patch has been greatly improved.\n\nDavid.",
    "created_at": "2012-12-28T11:07:47Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165011",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:20'></a>
Attachment [trac_13808-rev2.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-rev2.patch) by @dcoudert created at 2012-12-28 11:07:47

Hello Nathann,

I have replaced the hyp==2 with hyp>=2 and clarified the text.

Thanks for the review. The patch has been greatly improved.

David.



---

archive/issue_events_118427.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-28T11:07:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118427"
}
```



---

archive/issue_events_118428.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-28T11:07:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118428"
}
```



---

archive/issue_comments_165012.json:
```json
{
    "body": "<a id='comment:21'></a>\nI set the patch to positive_review as you have suggested.\n\nThanks.",
    "created_at": "2012-12-28T11:13:17Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165012",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:21'></a>
I set the patch to positive_review as you have suggested.

Thanks.



---

archive/issue_events_118429.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-28T11:13:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118429"
}
```



---

archive/issue_events_118430.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-12-28T11:13:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118430"
}
```



---

archive/issue_events_118431.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-01T16:58:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118431"
}
```



---

archive/issue_events_118432.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-01T16:58:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118432"
}
```



---

archive/issue_comments_165013.json:
```json
{
    "body": "**Dependencies:** #13821",
    "created_at": "2013-01-01T16:58:28Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165013",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #13821



---

archive/issue_comments_165014.json:
```json
{
    "body": "<a id='comment:22'></a>\nThis needs to be fixed w.r.t. #13821:\n\n```\nsage -t  -force_lib devel/sage/sage/graphs/hyperbolicity.pyx\n**********************************************************************\nFile \"/release/merger/sage-5.6.beta3/devel/sage-main/sage/graphs/hyperbolicity.pyx\", line 351:\n    sage: elimination_ordering_of_simplicial_vertices(G)\nExpected:\n    [2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 1, 11]\nGot:\n    doctest:1: DeprecationWarning: Use Combinations(mset,k) instead.\n    See http://trac.sagemath.org/13821 for details.\n    [2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 1, 11]\n**********************************************************************\nFile \"/release/merger/sage-5.6.beta3/devel/sage-main/sage/graphs/hyperbolicity.pyx\", line 806:\n    sage: for i in xrange(10): # long test\n          G = graphs.RandomBarabasiAlbert(Integer(100),Integer(2))\n          d1,_,_ = hyperbolicity(G,algorithm='basic')\n          d2,_,_ = hyperbolicity(G,algorithm='cuts')\n          d3,_,_ = hyperbolicity(G,algorithm='cuts+')\n          l3,_,u3 = hyperbolicity(G,approximation_factor=Integer(2))\n          if d1!=d2 or d1!=d3 or l3>d1 or u3<d1:\n             print \"That's not good!\"\nExpected nothing\nGot:\n    doctest:5: DeprecationWarning: Use Combinations(mset,k) instead.\n    See http://trac.sagemath.org/13821 for details.\n**********************************************************************\n```",
    "created_at": "2013-01-01T16:58:28Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165014",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
This needs to be fixed w.r.t. #13821:

```
sage -t  -force_lib devel/sage/sage/graphs/hyperbolicity.pyx
**********************************************************************
File "/release/merger/sage-5.6.beta3/devel/sage-main/sage/graphs/hyperbolicity.pyx", line 351:
    sage: elimination_ordering_of_simplicial_vertices(G)
Expected:
    [2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 1, 11]
Got:
    doctest:1: DeprecationWarning: Use Combinations(mset,k) instead.
    See http://trac.sagemath.org/13821 for details.
    [2, 3, 4, 5, 6, 7, 8, 9, 10, 0, 1, 11]
**********************************************************************
File "/release/merger/sage-5.6.beta3/devel/sage-main/sage/graphs/hyperbolicity.pyx", line 806:
    sage: for i in xrange(10): # long test
          G = graphs.RandomBarabasiAlbert(Integer(100),Integer(2))
          d1,_,_ = hyperbolicity(G,algorithm='basic')
          d2,_,_ = hyperbolicity(G,algorithm='cuts')
          d3,_,_ = hyperbolicity(G,algorithm='cuts+')
          l3,_,u3 = hyperbolicity(G,approximation_factor=Integer(2))
          if d1!=d2 or d1!=d3 or l3>d1 or u3<d1:
             print "That's not good!"
Expected nothing
Got:
    doctest:5: DeprecationWarning: Use Combinations(mset,k) instead.
    See http://trac.sagemath.org/13821 for details.
**********************************************************************
```



---

archive/issue_comments_165015.json:
```json
{
    "body": "<a id='comment:23'></a>\nAlso,\n\n```\n# long test\n```\nshould be\n\n```\n# long time\n```",
    "created_at": "2013-01-02T10:54:21Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165015",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
Also,

```
# long test
```
should be

```
# long time
```



---

archive/attachments_018671.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13808-combinations.patch",
    "asset_url": "tarball://root/attachments/ticket13808/trac_13808-combinations.patch",
    "created_at": "2013-01-02T23:22:00Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13808/trac_13808-combinations.patch",
    "user": "https://github.com/dcoudert"
}
```



---

archive/issue_comments_165016.json:
```json
{
    "body": "Attachment [trac_13808-combinations.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-combinations.patch) by @dcoudert created at 2013-01-02 23:22:00",
    "created_at": "2013-01-02T23:22:00Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165016",
    "user": "https://github.com/dcoudert"
}
```

Attachment [trac_13808-combinations.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-combinations.patch) by @dcoudert created at 2013-01-02 23:22:00



---

archive/issue_events_118433.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2013-01-02T23:24:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118433"
}
```



---

archive/issue_events_118434.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2013-01-02T23:24:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118434"
}
```



---

archive/issue_comments_165017.json:
```json
{
    "body": "<a id='comment:24'></a>\nI was not aware of this patch.\n\nThe dependency is fixed, as well as the #long time. I hope it is OK now.\n\n\n---\npatchbot apply trac_13808-v3.patch trac_13808-rev.patch trac_13808-rev2.patch trac_13808-combinations.patch",
    "created_at": "2013-01-02T23:24:47Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165017",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:24'></a>
I was not aware of this patch.

The dependency is fixed, as well as the #long time. I hope it is OK now.


---
patchbot apply trac_13808-v3.patch trac_13808-rev.patch trac_13808-rev2.patch trac_13808-combinations.patch



---

archive/issue_comments_165018.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,4 +5,6 @@\n * [attachment:trac_13808-v3.patch]\n * [attachment:trac_13808-rev.patch]\n * [attachment:trac_13808-rev2.patch]\n+* [attachment:trac_13808-combinations.patch]\n \n+\n``````\n",
    "created_at": "2013-01-02T23:24:47Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165018",
    "user": "https://github.com/dcoudert"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,4 +5,6 @@
 * [attachment:trac_13808-v3.patch]
 * [attachment:trac_13808-rev.patch]
 * [attachment:trac_13808-rev2.patch]
+* [attachment:trac_13808-combinations.patch]
 
+
``````




---

archive/attachments_018672.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13808-v3.patch",
    "asset_url": "tarball://root/attachments/ticket13808/trac_13808-v3.patch",
    "created_at": "2013-01-03T10:45:34Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13808/trac_13808-v3.patch",
    "user": "https://github.com/dcoudert"
}
```



---

archive/issue_comments_165019.json:
```json
{
    "body": "Attachment [trac_13808-v3.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-v3.patch) by @dcoudert created at 2013-01-03 10:45:34\n\nnew combined version",
    "created_at": "2013-01-03T10:45:34Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165019",
    "user": "https://github.com/dcoudert"
}
```

Attachment [trac_13808-v3.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-v3.patch) by @dcoudert created at 2013-01-03 10:45:34

new combined version



---

archive/issue_comments_165020.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n \n APPLY:\n * [attachment:trac_13808-v3.patch]\n-* [attachment:trac_13808-rev.patch]\n+* [attachment:trac_13808-revb.patch]\n * [attachment:trac_13808-rev2.patch]\n * [attachment:trac_13808-combinations.patch]\n \n``````\n",
    "created_at": "2013-01-03T10:49:41Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165020",
    "user": "https://github.com/dcoudert"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 
 APPLY:
 * [attachment:trac_13808-v3.patch]
-* [attachment:trac_13808-rev.patch]
+* [attachment:trac_13808-revb.patch]
 * [attachment:trac_13808-rev2.patch]
 * [attachment:trac_13808-combinations.patch]
 
``````




---

archive/attachments_018673.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13808-revb.patch",
    "asset_url": "tarball://root/attachments/ticket13808/trac_13808-revb.patch",
    "created_at": "2013-01-03T10:49:41Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13808/trac_13808-revb.patch",
    "user": "https://github.com/dcoudert"
}
```



---

archive/issue_comments_165021.json:
```json
{
    "body": "<a id='comment:25'></a>\nAttachment [trac_13808-revb.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-revb.patch) by @dcoudert created at 2013-01-03 10:49:41\n\nMinor edit to get rid of trailing white space. Should be better for the patchbot.\n\n---\npatchbot apply trac_13808-v3.patch trac_13808-revb.patch trac_13808-rev2.patch trac_13808-combinations.patch",
    "created_at": "2013-01-03T10:49:41Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165021",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:25'></a>
Attachment [trac_13808-revb.patch](https://github.com/sagemath/sage/files/ticket13808/trac_13808-revb.patch) by @dcoudert created at 2013-01-03 10:49:41

Minor edit to get rid of trailing white space. Should be better for the patchbot.

---
patchbot apply trac_13808-v3.patch trac_13808-revb.patch trac_13808-rev2.patch trac_13808-combinations.patch



---

archive/issue_events_118435.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-01-04T09:59:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118435"
}
```



---

archive/issue_events_118436.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-01-04T09:59:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118436"
}
```



---

archive/issue_comments_165022.json:
```json
{
    "body": "<a id='comment:26'></a>\nPassed all long tests modulo the doctest problem in beta2. Good to go again !\n\nNathann",
    "created_at": "2013-01-04T09:59:58Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165022",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>
Passed all long tests modulo the doctest problem in beta2. Good to go again !

Nathann



---

archive/issue_comments_165023.json:
```json
{
    "body": "<a id='comment:27'></a>\nThanks (again) !",
    "created_at": "2013-01-04T10:14:59Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165023",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:27'></a>
Thanks (again) !



---

archive/issue_events_118437.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-12T08:52:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118437"
}
```



---

archive/issue_events_118438.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-12T08:52:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13808#event-118438"
}
```



---

archive/issue_comments_165024.json:
```json
{
    "body": "**Merged:** sage-5.6.rc0",
    "created_at": "2013-01-12T08:52:16Z",
    "issue": "https://github.com/sagemath/sage/issues/13808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13808#issuecomment-165024",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.6.rc0
