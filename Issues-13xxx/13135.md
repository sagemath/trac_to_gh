# Issue 13135: list_plot3d.py should not generate NaN coordinates

archive/issues_012963.json:
```json
{
    "assignees": [],
    "body": "Both #12798 and the matplotlib upgrade (#23696) cause this:\n\n```\nsage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py\n**********************************************************************\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d\nWarning, slow doctest:\n    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)\nTest ran for 926.47 s\n**********************************************************************\n```\non hardware which is slow in computing with `NaN` values.\n\nThis plot is done by tachyon but in the input to tachyon, there are many `NaN`s. This can be seen by applying [attachment: nancount.patch](https://github.com/sagemath/sage/files/ticket13135/nancount.patch.gz). The result is\n\n```\nsage -t --long src/sage/plot/plot3d/list_plot3d.py\n**********************************************************************\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d\nFailed example:\n    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)\nExpected:\n    Graphics3d Object\nGot:\n    Got 3206 NaN values\n    Graphics3d Object\n**********************************************************************\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 387, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples\nFailed example:\n    show(list_plot3d([[1, 1, 1], [1, 2, 1], [0, 1, 3], [1, 0, 4]], point_list=True))\nExpected nothing\nGot:\n    Got 31 NaN values\n**********************************************************************\nFile \"src/sage/plot/plot3d/list_plot3d.py\", line 391, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples\nFailed example:\n    list_plot3d([(1, 2, 3), (0, 1, 3), (2, 1, 4), (1, 0, -2)], texture='yellow', num_points=50)\nExpected:\n    Graphics3d Object\nGot:\n    Got 1273 NaN values\n    Graphics3d Object\n**********************************************************************\n```\n\nAssignee: **@jasongrout, @williamstein**\n\nCC:  @strogdon @kiwifb\n\nBranch/Commit: **[4d17a73](https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c)**\n\nReviewer: **Steven Trogdon**\n\nAuthor: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13135_\n\n",
    "closed_at": "2018-03-28T18:26:07Z",
    "created_at": "2012-06-19T08:25:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "list_plot3d.py should not generate NaN coordinates",
    "type": "issue",
    "updated_at": "2018-03-28T18:26:07Z",
    "url": "https://github.com/sagemath/sage/issues/13135",
    "user": "https://github.com/jdemeyer"
}
```
Both #12798 and the matplotlib upgrade (#23696) cause this:

```
sage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py
**********************************************************************
File "src/sage/plot/plot3d/list_plot3d.py", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d
Warning, slow doctest:
    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)
Test ran for 926.47 s
**********************************************************************
```
on hardware which is slow in computing with `NaN` values.

This plot is done by tachyon but in the input to tachyon, there are many `NaN`s. This can be seen by applying [attachment: nancount.patch](https://github.com/sagemath/sage/files/ticket13135/nancount.patch.gz). The result is

```
sage -t --long src/sage/plot/plot3d/list_plot3d.py
**********************************************************************
File "src/sage/plot/plot3d/list_plot3d.py", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d
Failed example:
    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)
Expected:
    Graphics3d Object
Got:
    Got 3206 NaN values
    Graphics3d Object
**********************************************************************
File "src/sage/plot/plot3d/list_plot3d.py", line 387, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples
Failed example:
    show(list_plot3d([[1, 1, 1], [1, 2, 1], [0, 1, 3], [1, 0, 4]], point_list=True))
Expected nothing
Got:
    Got 31 NaN values
**********************************************************************
File "src/sage/plot/plot3d/list_plot3d.py", line 391, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples
Failed example:
    list_plot3d([(1, 2, 3), (0, 1, 3), (2, 1, 4), (1, 0, -2)], texture='yellow', num_points=50)
Expected:
    Graphics3d Object
Got:
    Got 1273 NaN values
    Graphics3d Object
**********************************************************************
```

Assignee: **@jasongrout, @williamstein**

CC:  @strogdon @kiwifb

Branch/Commit: **[4d17a73](https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c)**

Reviewer: **Steven Trogdon**

Author: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/13135_





---

archive/issue_events_167090.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T08:25:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167090"
}
```



---

archive/issue_events_167091.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T08:25:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "component: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167091"
}
```



---

archive/issue_events_167092.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T08:25:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167092"
}
```



---

archive/issue_events_167093.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T08:25:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167093"
}
```



---

archive/issue_events_167094.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T09:02:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167094"
}
```



---

archive/issue_events_167095.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-19T09:02:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167095"
}
```



---

archive/issue_comments_152596.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This used to work on Solaris SPARC in sage-5.1.beta3, but no longer in sage-5.1.beta5:\n+This used to work on Solaris SPARC in sage-5.1.beta3, but no longer in sage-5.1.beta4:\n \n ```\n sage -t  --long -force_lib devel/sage/sage/plot/plot3d/list_plot3d.py\n``````\n",
    "created_at": "2012-06-22T21:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152596",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This used to work on Solaris SPARC in sage-5.1.beta3, but no longer in sage-5.1.beta5:
+This used to work on Solaris SPARC in sage-5.1.beta3, but no longer in sage-5.1.beta4:
 
 ```
 sage -t  --long -force_lib devel/sage/sage/plot/plot3d/list_plot3d.py
``````




---

archive/issue_comments_152597.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,11 @@\n \n          [5001.6 s]\n ```\n+\n+More precisely, this takes forever:\n+\n+```\n+Trying:\n+    list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=Integer(100))###line 159:_sage_    >>> list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=100)\n+Expecting nothing\n+```\n``````\n",
    "created_at": "2012-06-22T21:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152597",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,11 @@
 
          [5001.6 s]
 ```
+
+More precisely, this takes forever:
+
+```
+Trying:
+    list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=Integer(100))###line 159:_sage_    >>> list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=100)
+Expecting nothing
+```
``````




---

archive/issue_comments_152598.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThis takes 0.18s on my laptop in sage-5.1.beta5. I don't see why it should take >5s on some other hardware unless the hardware is really that slow.\n\n```\nsage: l=[]\nsage: for i in range(-5,5):\n          for j in range(-5,5):\n              l.append((normalvariate(0,1),normalvariate(0,1),normalvariate(0,1)))\n\nsage: %time list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=100)\nCPU times: user 0.16 s, sys: 0.01 s, total: 0.18 s\nWall time: 0.18 s\n```",
    "created_at": "2012-06-23T01:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152598",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:4" align="right">Comment 4</div>

This takes 0.18s on my laptop in sage-5.1.beta5. I don't see why it should take >5s on some other hardware unless the hardware is really that slow.

```
sage: l=[]
sage: for i in range(-5,5):
          for j in range(-5,5):
              l.append((normalvariate(0,1),normalvariate(0,1),normalvariate(0,1)))

sage: %time list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=100)
CPU times: user 0.16 s, sys: 0.01 s, total: 0.18 s
Wall time: 0.18 s
```



---

archive/issue_comments_152599.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,10 +7,10 @@\n          [5001.6 s]\n ```\n \n-More precisely, this takes forever:\n+More precisely, this takes a very long time:\n \n ```\n Trying:\n-    list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=Integer(100))###line 159:_sage_    >>> list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=100)\n+    list_plot3d([(Integer(0),Integer(0),Integer(1)), (Integer(2),Integer(3),Integer(4)), (-Integer(1),-Integer(1),-Integer(1))],num_points=Integer(400)) # long time###line 171:_sage_    >>> list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400) # long time\n Expecting nothing\n ```\n``````\n",
    "created_at": "2012-06-23T07:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152599",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,10 +7,10 @@
          [5001.6 s]
 ```
 
-More precisely, this takes forever:
+More precisely, this takes a very long time:
 
 ```
 Trying:
-    list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=Integer(100))###line 159:_sage_    >>> list_plot3d(l,interpolation_type='nn',texture='yellow',num_points=100)
+    list_plot3d([(Integer(0),Integer(0),Integer(1)), (Integer(2),Integer(3),Integer(4)), (-Integer(1),-Integer(1),-Integer(1))],num_points=Integer(400)) # long time###line 171:_sage_    >>> list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400) # long time
 Expecting nothing
 ```
``````




---

archive/issue_comments_152600.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@ppurka](#comment%3A4):\n> This takes 0.18s on my laptop in sage-5.1.beta5. I don't see why it should take >5s on some other hardware unless the hardware is really that slow.\n\nDo an explaination of why it could have slowed down a lot because of this ticket?",
    "created_at": "2012-06-23T07:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152600",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@ppurka](#comment%3A4):
> This takes 0.18s on my laptop in sage-5.1.beta5. I don't see why it should take >5s on some other hardware unless the hardware is really that slow.

Do an explaination of why it could have slowed down a lot because of this ticket?



---

archive/issue_comments_152601.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@jdemeyer](#comment%3A6):\n> Replying to [@ppurka](#comment%3A4):\n> > This takes 0.18s on my laptop in sage-5.1.beta5. I don't see why it should take >5s on some other hardware unless the hardware is really that slow.\n\n> Do an explaination of why it could have slowed down a lot because of this ticket?\n\nI think the way to handle the slow down is to reduce the `num_points` to 100.\n\nIt is not really a \"slow down\" per se, but it actually gives an accurate plot. Before #13135 3d plots of lists of points were just plain wrong.\n\nI think the following is a good means of checking the time that the plot in the revised description takes\n\n```\nsage: %time list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400).export_jmol('/tmp/a.jmol')            \nCPU times: user 5.37 s, sys: 0.05 s, total: 5.42 s\nWall time: 5.44 s\nsage: %time list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=100).export_jmol('/tmp/a.jmol')\nCPU times: user 0.35 s, sys: 0.00 s, total: 0.35 s\nWall time: 0.35 s\n```\nCan you run this command on the Solaris machine and find out what is the time taken? If it takes much less time on the latter command, then it would be good to have the latter one (with 100 points) instead of the former one (with 400 points).",
    "created_at": "2012-06-23T07:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152601",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@jdemeyer](#comment%3A6):
> Replying to [@ppurka](#comment%3A4):
> > This takes 0.18s on my laptop in sage-5.1.beta5. I don't see why it should take >5s on some other hardware unless the hardware is really that slow.

> Do an explaination of why it could have slowed down a lot because of this ticket?

I think the way to handle the slow down is to reduce the `num_points` to 100.

It is not really a "slow down" per se, but it actually gives an accurate plot. Before #13135 3d plots of lists of points were just plain wrong.

I think the following is a good means of checking the time that the plot in the revised description takes

```
sage: %time list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400).export_jmol('/tmp/a.jmol')            
CPU times: user 5.37 s, sys: 0.05 s, total: 5.42 s
Wall time: 5.44 s
sage: %time list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=100).export_jmol('/tmp/a.jmol')
CPU times: user 0.35 s, sys: 0.00 s, total: 0.35 s
Wall time: 0.35 s
```
Can you run this command on the Solaris machine and find out what is the time taken? If it takes much less time on the latter command, then it would be good to have the latter one (with 100 points) instead of the former one (with 400 points).



---

archive/issue_comments_152602.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nHere's an other weird thing: the test takes *much* longer when running the doctests than when run individually.  Inside Sage, there is not much difference with/without the #12798 patches.  But when running the doctest, there is a huge difference.\n\nCould there be a resource leak of some kind?",
    "created_at": "2012-06-23T07:28:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152602",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">Comment 8</div>

Here's an other weird thing: the test takes *much* longer when running the doctests than when run individually.  Inside Sage, there is not much difference with/without the #12798 patches.  But when running the doctest, there is a huge difference.

Could there be a resource leak of some kind?



---

archive/issue_comments_152603.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nA resource leak might be a possibility. I ran the following two commands:\n\n**Vanilla sage-5.1beta5**\n\n```\n...sage-5.1.beta5/devel/sage\u00bb ../../sage -t --long -force_lib sage/plot/plot3d/list_plot3d.py \nsage -t --long -force_lib \"devel/sage-main/sage/plot/plot3d/list_plot3d.py\"\n\t [10.3 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 10.3 seconds\n```\n\nThen I changed that `list_plot` example to the following:\n\n```\nsage: list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400).export_jmol(tmp_filename()+'.jmol') # long time\n```\n\n**After change to the `list_plot` example**\n\n```\n...sage-5.1.beta5/devel/sage\u00bb ../../sage -t --long -force_lib sage/plot/plot3d/list_plot3d.py \nsage -t --long -force_lib \"devel/sage-main/sage/plot/plot3d/list_plot3d.py\"\n\t [8.6 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 8.6 seconds\n```\nThat is quite a bit of a difference just for dumping the jmol into a file.\n\nIs there some automated way to measure the memory/cpu usage of a running process?",
    "created_at": "2012-06-23T07:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152603",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:9" align="right">Comment 9</div>

A resource leak might be a possibility. I ran the following two commands:

**Vanilla sage-5.1beta5**

```
...sage-5.1.beta5/devel/sage» ../../sage -t --long -force_lib sage/plot/plot3d/list_plot3d.py 
sage -t --long -force_lib "devel/sage-main/sage/plot/plot3d/list_plot3d.py"
	 [10.3 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 10.3 seconds
```

Then I changed that `list_plot` example to the following:

```
sage: list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400).export_jmol(tmp_filename()+'.jmol') # long time
```

**After change to the `list_plot` example**

```
...sage-5.1.beta5/devel/sage» ../../sage -t --long -force_lib sage/plot/plot3d/list_plot3d.py 
sage -t --long -force_lib "devel/sage-main/sage/plot/plot3d/list_plot3d.py"
	 [8.6 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 8.6 seconds
```
That is quite a bit of a difference just for dumping the jmol into a file.

Is there some automated way to measure the memory/cpu usage of a running process?



---

archive/issue_events_167096.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-26T06:50:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167096"
}
```



---

archive/issue_events_167097.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-26T06:50:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167097"
}
```



---

archive/issue_events_167098.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-26T06:50:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167098"
}
```



---

archive/issue_events_167099.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-26T06:50:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167099"
}
```



---

archive/issue_comments_152604.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This used to work on Solaris SPARC in sage-5.1.beta3, but no longer in sage-5.1.beta4:\n+#12798 causes this:\n \n ```\n sage -t  --long -force_lib devel/sage/sage/plot/plot3d/list_plot3d.py\n``````\n",
    "created_at": "2012-06-26T06:50:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152604",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This used to work on Solaris SPARC in sage-5.1.beta3, but no longer in sage-5.1.beta4:
+#12798 causes this:
 
 ```
 sage -t  --long -force_lib devel/sage/sage/plot/plot3d/list_plot3d.py
``````




---

archive/issue_events_167100.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167100"
}
```



---

archive/issue_events_167101.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167101"
}
```



---

archive/issue_events_167102.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167102"
}
```



---

archive/issue_events_167103.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167103"
}
```



---

archive/issue_events_167104.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167104"
}
```



---

archive/issue_events_167105.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167105"
}
```



---

archive/issue_events_167106.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167106"
}
```



---

archive/issue_events_167107.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167107"
}
```



---

archive/issue_events_167108.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T11:28:33Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "title_is": "list_plot3d.py should not generate NaN coordinates",
    "title_was": "list_plot3d.py timeout in Solaris",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167108"
}
```



---

archive/issue_comments_152605.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,12 @@\n-#12798 causes this:\n+#12798 and the matplotlib upgrade to 2.1.0 cause this:\n \n ```\n-sage -t  --long -force_lib devel/sage/sage/plot/plot3d/list_plot3d.py\n-*** *** Error: TIMED OUT! PROCESS KILLED! *** ***\n-\n-         [5001.6 s]\n+sage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py\n+**********************************************************************\n+File \"src/sage/plot/plot3d/list_plot3d.py\", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d\n+Warning, slow doctest:\n+    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)\n+Test ran for 926.47 s\n+**********************************************************************\n ```\n-\n-More precisely, this takes a very long time:\n-\n-```\n-Trying:\n-    list_plot3d([(Integer(0),Integer(0),Integer(1)), (Integer(2),Integer(3),Integer(4)), (-Integer(1),-Integer(1),-Integer(1))],num_points=Integer(400)) # long time###line 171:_sage_    >>> list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400) # long time\n-Expecting nothing\n-```\n+on hardware which is slow in computing with `NaN` values.\n``````\n",
    "created_at": "2018-02-28T11:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152605",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,12 @@
-#12798 causes this:
+#12798 and the matplotlib upgrade to 2.1.0 cause this:
 
 ```
-sage -t  --long -force_lib devel/sage/sage/plot/plot3d/list_plot3d.py
-*** *** Error: TIMED OUT! PROCESS KILLED! *** ***
-
-         [5001.6 s]
+sage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py
+**********************************************************************
+File "src/sage/plot/plot3d/list_plot3d.py", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d
+Warning, slow doctest:
+    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)
+Test ran for 926.47 s
+**********************************************************************
 ```
-
-More precisely, this takes a very long time:
-
-```
-Trying:
-    list_plot3d([(Integer(0),Integer(0),Integer(1)), (Integer(2),Integer(3),Integer(4)), (-Integer(1),-Integer(1),-Integer(1))],num_points=Integer(400)) # long time###line 171:_sage_    >>> list_plot3d([(0,0,1), (2,3,4), (-1,-1,-1)],num_points=400) # long time
-Expecting nothing
-```
+on hardware which is slow in computing with `NaN` values.
``````




---

archive/issue_events_167109.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T11:28:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167109"
}
```



---

archive/issue_events_167110.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T11:28:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167110"
}
```



---

archive/issue_comments_152606.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,5 @@\n **********************************************************************\n ```\n on hardware which is slow in computing with `NaN` values.\n+\n+This plot is done by tachyon but in the input to tachyon, there are many `NaN`s.\n``````\n",
    "created_at": "2018-02-28T11:30:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152606",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,5 @@
 **********************************************************************
 ```
 on hardware which is slow in computing with `NaN` values.
+
+This plot is done by tachyon but in the input to tachyon, there are many `NaN`s.
``````




---

archive/issue_comments_152607.json:
```json
{
    "body": "Example tachyon input",
    "created_at": "2018-02-28T11:34:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152607",
    "user": "https://github.com/jdemeyer"
}
```

Example tachyon input



---

archive/issue_comments_152608.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nAttachment: **[tachyon.dat.gz](https://github.com/sagemath/sage/files/ticket13135/tachyon.dat.gz)**\n\nI'm attaching an example Tachyon input file generated by `list_plot3d`.",
    "created_at": "2018-02-28T11:35:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152608",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">Comment 18</div>

Attachment: **[tachyon.dat.gz](https://github.com/sagemath/sage/files/ticket13135/tachyon.dat.gz)**

I'm attaching an example Tachyon input file generated by `list_plot3d`.



---

archive/issue_comments_152609.json:
```json
{
    "body": "Patch to show the problem",
    "created_at": "2018-02-28T12:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152609",
    "user": "https://github.com/jdemeyer"
}
```

Patch to show the problem



---

archive/issue_events_167111.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T12:59:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167111"
}
```



---

archive/issue_events_167112.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T12:59:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167112"
}
```



---

archive/issue_comments_152610.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nAttachment: **[nancount.patch.gz](https://github.com/sagemath/sage/files/ticket13135/nancount.patch.gz)**",
    "created_at": "2018-02-28T12:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152610",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">Comment 19</div>

Attachment: **[nancount.patch.gz](https://github.com/sagemath/sage/files/ticket13135/nancount.patch.gz)**



---

archive/issue_comments_152611.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,4 +11,34 @@\n ```\n on hardware which is slow in computing with `NaN` values.\n \n-This plot is done by tachyon but in the input to tachyon, there are many `NaN`s.\n+This plot is done by tachyon but in the input to tachyon, there are many `NaN`s. This can be seen by applying [attachment: nancount.patch](https://github.com/sagemath/sage/files/ticket13135/nancount.patch.gz). The result is\n+\n+```\n+sage -t --long src/sage/plot/plot3d/list_plot3d.py\n+**********************************************************************\n+File \"src/sage/plot/plot3d/list_plot3d.py\", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d\n+Failed example:\n+    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)\n+Expected:\n+    Graphics3d Object\n+Got:\n+    Got 3206 NaN values\n+    Graphics3d Object\n+**********************************************************************\n+File \"src/sage/plot/plot3d/list_plot3d.py\", line 387, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples\n+Failed example:\n+    show(list_plot3d([[1, 1, 1], [1, 2, 1], [0, 1, 3], [1, 0, 4]], point_list=True))\n+Expected nothing\n+Got:\n+    Got 31 NaN values\n+**********************************************************************\n+File \"src/sage/plot/plot3d/list_plot3d.py\", line 391, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples\n+Failed example:\n+    list_plot3d([(1, 2, 3), (0, 1, 3), (2, 1, 4), (1, 0, -2)], texture='yellow', num_points=50)\n+Expected:\n+    Graphics3d Object\n+Got:\n+    Got 1273 NaN values\n+    Graphics3d Object\n+**********************************************************************\n+```\n``````\n",
    "created_at": "2018-02-28T12:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152611",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,4 +11,34 @@
 ```
 on hardware which is slow in computing with `NaN` values.
 
-This plot is done by tachyon but in the input to tachyon, there are many `NaN`s.
+This plot is done by tachyon but in the input to tachyon, there are many `NaN`s. This can be seen by applying [attachment: nancount.patch](https://github.com/sagemath/sage/files/ticket13135/nancount.patch.gz). The result is
+
+```
+sage -t --long src/sage/plot/plot3d/list_plot3d.py
+**********************************************************************
+File "src/sage/plot/plot3d/list_plot3d.py", line 143, in sage.plot.plot3d.list_plot3d.list_plot3d
+Failed example:
+    list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)
+Expected:
+    Graphics3d Object
+Got:
+    Got 3206 NaN values
+    Graphics3d Object
+**********************************************************************
+File "src/sage/plot/plot3d/list_plot3d.py", line 387, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples
+Failed example:
+    show(list_plot3d([[1, 1, 1], [1, 2, 1], [0, 1, 3], [1, 0, 4]], point_list=True))
+Expected nothing
+Got:
+    Got 31 NaN values
+**********************************************************************
+File "src/sage/plot/plot3d/list_plot3d.py", line 391, in sage.plot.plot3d.list_plot3d.list_plot3d_tuples
+Failed example:
+    list_plot3d([(1, 2, 3), (0, 1, 3), (2, 1, 4), (1, 0, -2)], texture='yellow', num_points=50)
+Expected:
+    Graphics3d Object
+Got:
+    Got 1273 NaN values
+    Graphics3d Object
+**********************************************************************
+```
``````




---

archive/issue_comments_152612.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-#12798 and the matplotlib upgrade to 2.1.0 cause this:\n+Both #12798 and the matplotlib upgrade (#23696) cause this:\n \n ```\n sage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py\n@@ -42,3 +42,4 @@\n     Graphics3d Object\n **********************************************************************\n ```\n+In \n``````\n",
    "created_at": "2018-02-28T13:08:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152612",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-#12798 and the matplotlib upgrade to 2.1.0 cause this:
+Both #12798 and the matplotlib upgrade (#23696) cause this:
 
 ```
 sage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py
@@ -42,3 +42,4 @@
     Graphics3d Object
 **********************************************************************
 ```
+In 
``````




---

archive/issue_comments_152613.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -42,4 +42,3 @@\n     Graphics3d Object\n **********************************************************************\n ```\n-In \n``````\n",
    "created_at": "2018-02-28T13:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152613",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -42,4 +42,3 @@
     Graphics3d Object
 **********************************************************************
 ```
-In 
``````




---

archive/issue_comments_152614.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nsimpler case maybe\n\n```\nsage: var('x,y')\nsage: f = lambda x,y: x+y if x*x+y*y<=1 else NaN\nsage: plot3d(f,(x,-2,2),(y,-2,2)).tachyon()  \n```",
    "created_at": "2018-02-28T16:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152614",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">Comment 22</div>

simpler case maybe

```
sage: var('x,y')
sage: f = lambda x,y: x+y if x*x+y*y<=1 else NaN
sage: plot3d(f,(x,-2,2),(y,-2,2)).tachyon()  
```



---

archive/issue_comments_152615.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nand\n\n```\nsage: G = polygon([(NaN,NaN,NaN)]*3)\nsage: G.tachyon_repr(G.default_render_params())\n['TRI V0 nan nan nan V1 nan nan nan V2 nan nan nan', 'texture3']\n```\nMaybe we should filter this out of tachyon input ? or more generally ?",
    "created_at": "2018-02-28T17:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152615",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">Comment 23</div>

and

```
sage: G = polygon([(NaN,NaN,NaN)]*3)
sage: G.tachyon_repr(G.default_render_params())
['TRI V0 nan nan nan V1 nan nan nan V2 nan nan nan', 'texture3']
```
Maybe we should filter this out of tachyon input ? or more generally ?



---

archive/issue_comments_152616.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nReplying to [@fchapoton](#comment%3A23):\n> Maybe we should filter this out of tachyon input ? or more generally ?\n\nThat doesn't solve the underlying problem. Why are `NaN`s suddenly appearing? That didn't happen before #23696.",
    "created_at": "2018-02-28T19:14:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152616",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">Comment 24</div>

Replying to [@fchapoton](#comment%3A23):
> Maybe we should filter this out of tachyon input ? or more generally ?

That doesn't solve the underlying problem. Why are `NaN`s suddenly appearing? That didn't happen before #23696.



---

archive/issue_comments_152617.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nDoesn't explain the `NaN` but could the following be what one is observing when doctesting\n\n```\nsage: l = []\nsage: for i in range(-5, 5):\n....:     for j in range(-5, 5):\n....:         l.append((normalvariate(0, 1), normalvariate(0, 1), normalvariate(0, 1)))\n....:         \nsage: %timeit list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)\nThe slowest run took 109.32 times longer than the fastest. This could mean that an intermediate result is being cached.\n1 loop, best of 3: 3.11 ms per loop\n```\nThe first run is always the slowest.",
    "created_at": "2018-02-28T20:34:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152617",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:26" align="right">Comment 26</div>

Doesn't explain the `NaN` but could the following be what one is observing when doctesting

```
sage: l = []
sage: for i in range(-5, 5):
....:     for j in range(-5, 5):
....:         l.append((normalvariate(0, 1), normalvariate(0, 1), normalvariate(0, 1)))
....:         
sage: %timeit list_plot3d(l, interpolation_type='clough', texture='yellow', num_points=100)
The slowest run took 109.32 times longer than the fastest. This could mean that an intermediate result is being cached.
1 loop, best of 3: 3.11 ms per loop
```
The first run is always the slowest.



---

archive/issue_comments_152618.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nOK in the case of `clough` and `linear` we could able to filter `NaN` at a cost. Both define a function `g` like so\n\n```\n        def g(x, y):\n            z = f([x, y])\n            return (x, y, z)\n```\nI guess `g` could return empty if `z` turns to be a `NaN`. Is it even doable?",
    "created_at": "2018-02-28T22:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152618",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">Comment 28</div>

OK in the case of `clough` and `linear` we could able to filter `NaN` at a cost. Both define a function `g` like so

```
        def g(x, y):
            z = f([x, y])
            return (x, y, z)
```
I guess `g` could return empty if `z` turns to be a `NaN`. Is it even doable?



---

archive/issue_comments_152619.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nFiltering `NaN`s is easy, but that is really ignoring the problem. The real problem is that `NaN`s are appearing in a computation which did not produce `NaN`s before #23696.",
    "created_at": "2018-03-01T06:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152619",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">Comment 29</div>

Filtering `NaN`s is easy, but that is really ignoring the problem. The real problem is that `NaN`s are appearing in a computation which did not produce `NaN`s before #23696.



---

archive/issue_comments_152620.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nThe interpolation algorithm is completely different, so there is a possibility that this particular algorithm is completely unsuited to this particular set of points. I am now curious to see what the plot look like but that will have to wait until I go back to work tomorrow morning (~14 hours in my time zone).",
    "created_at": "2018-03-01T06:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152620",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">Comment 30</div>

The interpolation algorithm is completely different, so there is a possibility that this particular algorithm is completely unsuited to this particular set of points. I am now curious to see what the plot look like but that will have to wait until I go back to work tomorrow morning (~14 hours in my time zone).



---

archive/issue_comments_152621.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nIt may be that the `nan` are a feature of using scipy.interpolate.CloughTocher2DInterpolator. The documentation indicates that if requested points are outside the convex hull then, unless specified, they are filled in with `nan`.",
    "created_at": "2018-03-01T06:22:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152621",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:31" align="right">Comment 31</div>

It may be that the `nan` are a feature of using scipy.interpolate.CloughTocher2DInterpolator. The documentation indicates that if requested points are outside the convex hull then, unless specified, they are filled in with `nan`.



---

archive/issue_comments_152622.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nReplying to [@strogdon](#comment%3A31):\n> It may be that the `nan` are a feature of using scipy.interpolate.CloughTocher2DInterpolator. The documentation indicates that if requested points are outside the convex hull then, unless specified, they are filled in with `nan`.\n\nThanks for the info. If so, filtering them probably is the right thing to do after all.",
    "created_at": "2018-03-01T06:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152622",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">Comment 32</div>

Replying to [@strogdon](#comment%3A31):
> It may be that the `nan` are a feature of using scipy.interpolate.CloughTocher2DInterpolator. The documentation indicates that if requested points are outside the convex hull then, unless specified, they are filled in with `nan`.

Thanks for the info. If so, filtering them probably is the right thing to do after all.



---

archive/issue_comments_152623.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nReplying to [@jdemeyer](#comment%3A32):\n> Replying to [@strogdon](#comment%3A31):\n> > It may be that the `nan` are a feature of using scipy.interpolate.CloughTocher2DInterpolator. The documentation indicates that if requested points are outside the convex hull then, unless specified, they are filled in with `nan`.\n\n> \n> Thanks for the info. If so, filtering them probably is the right thing to do after all.\n\nYes, this algorithm just doesn't do extrapolation and put NaN for anything that would be an extrapolation. We could set an arbitrary  value, but to what? The average z value of the input? 0?",
    "created_at": "2018-03-01T06:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152623",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:33" align="right">Comment 33</div>

Replying to [@jdemeyer](#comment%3A32):
> Replying to [@strogdon](#comment%3A31):
> > It may be that the `nan` are a feature of using scipy.interpolate.CloughTocher2DInterpolator. The documentation indicates that if requested points are outside the convex hull then, unless specified, they are filled in with `nan`.

> 
> Thanks for the info. If so, filtering them probably is the right thing to do after all.

Yes, this algorithm just doesn't do extrapolation and put NaN for anything that would be an extrapolation. We could set an arbitrary  value, but to what? The average z value of the input? 0?



---

archive/issue_comments_152624.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nReplying to [@fchapoton](#comment%3A23):\n> Maybe we should filter this out of tachyon input ? or more generally ?\n\nIf you want to filter them, I think the right place is the `triangulate()` method.",
    "created_at": "2018-03-01T08:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152624",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">Comment 34</div>

Replying to [@fchapoton](#comment%3A23):
> Maybe we should filter this out of tachyon input ? or more generally ?

If you want to filter them, I think the right place is the `triangulate()` method.



---

archive/issue_comments_152625.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nI just spent some time with matplotlib code to check what it does for extrapolation. And it looks like it returns `NaN` for those points as well. So the problem should be present as well for `linear` interpolation. I couldn't find anything in the documentation about what the stuff behind `spline` do for extrapolation - by the look of the output picture it just extrapolates.",
    "created_at": "2018-03-01T21:10:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152625",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:35" align="right">Comment 35</div>

I just spent some time with matplotlib code to check what it does for extrapolation. And it looks like it returns `NaN` for those points as well. So the problem should be present as well for `linear` interpolation. I couldn't find anything in the documentation about what the stuff behind `spline` do for extrapolation - by the look of the output picture it just extrapolates.



---

archive/issue_comments_152626.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nThere is some discussion also on #12798 about `NaN` coordinates and even a patch.",
    "created_at": "2018-03-02T13:54:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152626",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">Comment 36</div>

There is some discussion also on #12798 about `NaN` coordinates and even a patch.



---

archive/issue_comments_152627.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nReplying to [@jdemeyer](#comment%3A36):\n> There is some discussion also on #12798 about `NaN` coordinates and even a patch.\n\nThe patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.",
    "created_at": "2018-03-02T15:52:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152627",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:37" align="right">Comment 37</div>

Replying to [@jdemeyer](#comment%3A36):
> There is some discussion also on #12798 about `NaN` coordinates and even a patch.

The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.



---

archive/issue_comments_152628.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nReplying to [@strogdon](#comment%3A37):\n> in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.\n\nMaybe, but I wouldn't try to fix that here. It would be a non-trivial change to change the `triangulate()` method to better take into account the input points. That is not something that we should fix in this blocker ticket.",
    "created_at": "2018-03-02T15:56:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152628",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">Comment 38</div>

Replying to [@strogdon](#comment%3A37):
> in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.

Maybe, but I wouldn't try to fix that here. It would be a non-trivial change to change the `triangulate()` method to better take into account the input points. That is not something that we should fix in this blocker ticket.



---

archive/issue_comments_152629.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nReplying to [@jdemeyer](#comment%3A38):\n> Replying to [@strogdon](#comment%3A37):\n> > in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.\n\n> \n> Maybe, but I wouldn't try to fix that here. It would be a non-trivial change to change the `triangulate()` method to better take into account the input points. That is not something that we should fix in this blocker ticket.\n\nDoes it help your situation? I can't really test whether there is a time savings. I can only verify that the `NaN` are stripped.",
    "created_at": "2018-03-02T17:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152629",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:39" align="right">Comment 39</div>

Replying to [@jdemeyer](#comment%3A38):
> Replying to [@strogdon](#comment%3A37):
> > in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.

> 
> Maybe, but I wouldn't try to fix that here. It would be a non-trivial change to change the `triangulate()` method to better take into account the input points. That is not something that we should fix in this blocker ticket.

Does it help your situation? I can't really test whether there is a time savings. I can only verify that the `NaN` are stripped.



---

archive/issue_comments_152630.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nReplying to [@strogdon](#comment%3A37):\n> The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.\n\nThat is, most of them are gone. There are still a few `corner` ones left.",
    "created_at": "2018-03-02T19:15:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152630",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:40" align="right">Comment 40</div>

Replying to [@strogdon](#comment%3A37):
> The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.

That is, most of them are gone. There are still a few `corner` ones left.



---

archive/issue_comments_152631.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nReplying to [@strogdon](#comment%3A40):\n> Replying to [@strogdon](#comment%3A37):\n> > The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.\n\n> That is, most of them are gone. There are still a few `corner` ones left.\n\nCan you elaborate on that. I thought `NaN` were not displayed anyway, so I didn't expect a difference before and after stripping them.",
    "created_at": "2018-03-02T19:20:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152631",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:41" align="right">Comment 41</div>

Replying to [@strogdon](#comment%3A40):
> Replying to [@strogdon](#comment%3A37):
> > The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.

> That is, most of them are gone. There are still a few `corner` ones left.

Can you elaborate on that. I thought `NaN` were not displayed anyway, so I didn't expect a difference before and after stripping them.



---

archive/issue_comments_152632.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@kiwifb](#comment%3A41):\n> Replying to [@strogdon](#comment%3A40):\n> > Replying to [@strogdon](#comment%3A37):\n> > > The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.\n\n> > That is, most of them are gone. There are still a few `corner` ones left.\n\n> \n> Can you elaborate on that. I thought `NaN` were not displayed anyway, so I didn't expect a difference before and after stripping them.\n\nBasically, from my understanding, the stripping is an attempt to find the maximal rectangle that fits inside the convex hull and the 3D surface is drawn over this rectangle. The procedure sometimes fails, most notably at the corners of the constructed rectangle.",
    "created_at": "2018-03-02T19:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152632",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@kiwifb](#comment%3A41):
> Replying to [@strogdon](#comment%3A40):
> > Replying to [@strogdon](#comment%3A37):
> > > The patch does remove the `NaN` values but in so doing it appears the surface is cropped such that it is not displayed over the entire convex hull.

> > That is, most of them are gone. There are still a few `corner` ones left.

> 
> Can you elaborate on that. I thought `NaN` were not displayed anyway, so I didn't expect a difference before and after stripping them.

Basically, from my understanding, the stripping is an attempt to find the maximal rectangle that fits inside the convex hull and the 3D surface is drawn over this rectangle. The procedure sometimes fails, most notably at the corners of the constructed rectangle.



---

archive/issue_comments_152633.json:
```json
{
    "body": "Attachment: **[before_after_stripping_nan.patch.gz](https://github.com/sagemath/sage/files/ticket13135/before_after_stripping_nan.patch.gz)**\n\nbefore and after stripping NaN patch",
    "created_at": "2018-03-02T20:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152633",
    "user": "https://github.com/strogdon"
}
```

Attachment: **[before_after_stripping_nan.patch.gz](https://github.com/sagemath/sage/files/ticket13135/before_after_stripping_nan.patch.gz)**

before and after stripping NaN patch



---

archive/issue_comments_152634.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nPatch to see changes before and after stripping the `NaN`s. Apply as `patch -p1 < before_after_stripping_nan.patch` and then rebuild sage, `./sage -b`. To test use that in\ncomment:26 without the `timeit`.",
    "created_at": "2018-03-02T20:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152634",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:43" align="right">Comment 43</div>

Patch to see changes before and after stripping the `NaN`s. Apply as `patch -p1 < before_after_stripping_nan.patch` and then rebuild sage, `./sage -b`. To test use that in
comment:26 without the `timeit`.



---

archive/issue_comments_152635.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nYes, I can see there is some differences. What does the plotting do with `NaN`?",
    "created_at": "2018-03-07T21:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152635",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:44" align="right">Comment 44</div>

Yes, I can see there is some differences. What does the plotting do with `NaN`?



---

archive/issue_comments_152636.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nReplying to [@kiwifb](#comment%3A44):\n> Yes, I can see there is some differences. What does the plotting do with `NaN`?\n\nMy understanding is that points that have associated values of `NaN` are not plotted. When the test is run there should be two plots. The plot where the `NaN` are `stripped` should be displayed above a nearly rectangular region, except possibly, near the corners of the region. It is at these corners where there are some, possibly remaining `NaN`s.",
    "created_at": "2018-03-08T00:24:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152636",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:45" align="right">Comment 45</div>

Replying to [@kiwifb](#comment%3A44):
> Yes, I can see there is some differences. What does the plotting do with `NaN`?

My understanding is that points that have associated values of `NaN` are not plotted. When the test is run there should be two plots. The plot where the `NaN` are `stripped` should be displayed above a nearly rectangular region, except possibly, near the corners of the region. It is at these corners where there are some, possibly remaining `NaN`s.



---

archive/issue_comments_152637.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nFrom commit [950bdd8145d262e493321bef67d3d57d26f9c464](https://github.com/sagemath/sagetrac-mirror/blob/950bdd8145d262e493321bef67d3d57d26f9c464/src/sage/plot/plot3d/list_plot3d.py) the changes to `src/sage/plot/plot3d/list_plot3d.py` contain\n\n```\n-        T=delaunay.Triangulation(x,y)\n-        f=T.nn_interpolator(z)\n-        f.default_value=0.0\n-        j=numpy.complex(0,1)\n-        vals=f[ymin:ymax:j*num_points,xmin:xmax:j*num_points]\n+        points=[[x[i],y[i]] for i in range(len(x))]\n+        j = numpy.complex(0, 1)\n+        f = interpolate.CloughTocher2DInterpolator(points,z)\n         from .parametric_surface import ParametricSurface\n```\nSo if I'm not mistaken the old `delaunay triagulation` implementation fills points outside the convex hull with zeros, i.e. `f.default_value=0.0`. The same thing can be achieved with scipy.interpolate.CloughTocher2DInterpolator with the change\n\n```diff\ndiff --git a/src/sage/plot/plot3d/list_plot3d.py b/src/sage/plot/plot3d/list_plot3d.py\nindex c0c578b99f..77aeb583ae 100644\n--- a/src/sage/plot/plot3d/list_plot3d.py\n+++ b/src/sage/plot/plot3d/list_plot3d.py\n@@ -461,7 +461,7 @@ def list_plot3d_tuples(v, interpolation_type, texture, **kwds):\n \n         points=[[x[i],y[i]] for i in range(len(x))]\n         j = numpy.complex(0, 1)\n-        f = interpolate.CloughTocher2DInterpolator(points,z)\n+        f = interpolate.CloughTocher2DInterpolator(points,z,fill_value=0.0)\n         from .parametric_surface import ParametricSurface\n         def g(x, y):\n             z = f([x, y])\n```\nIn my opinion the resulting plot is not particularly pleasing but it does reproduce the old behavior. I'm unable to determine whether there is any CPU savings. I do believe that modern graphing algorithms generate these `NaN`s as a mechanism to not plot points and that leaving things as-is is what should be done. In which case the doctest could be marked as `# long time` until the older hardware that doesn't like the `NaN`s is gone. So I would favor either of the above two approaches instead of `stripping` the `NaN`s.",
    "created_at": "2018-03-12T22:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152637",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:46" align="right">Comment 46</div>

From commit [950bdd8145d262e493321bef67d3d57d26f9c464](https://github.com/sagemath/sagetrac-mirror/blob/950bdd8145d262e493321bef67d3d57d26f9c464/src/sage/plot/plot3d/list_plot3d.py) the changes to `src/sage/plot/plot3d/list_plot3d.py` contain

```
-        T=delaunay.Triangulation(x,y)
-        f=T.nn_interpolator(z)
-        f.default_value=0.0
-        j=numpy.complex(0,1)
-        vals=f[ymin:ymax:j*num_points,xmin:xmax:j*num_points]
+        points=[[x[i],y[i]] for i in range(len(x))]
+        j = numpy.complex(0, 1)
+        f = interpolate.CloughTocher2DInterpolator(points,z)
         from .parametric_surface import ParametricSurface
```
So if I'm not mistaken the old `delaunay triagulation` implementation fills points outside the convex hull with zeros, i.e. `f.default_value=0.0`. The same thing can be achieved with scipy.interpolate.CloughTocher2DInterpolator with the change

```diff
diff --git a/src/sage/plot/plot3d/list_plot3d.py b/src/sage/plot/plot3d/list_plot3d.py
index c0c578b99f..77aeb583ae 100644
--- a/src/sage/plot/plot3d/list_plot3d.py
+++ b/src/sage/plot/plot3d/list_plot3d.py
@@ -461,7 +461,7 @@ def list_plot3d_tuples(v, interpolation_type, texture, **kwds):
 
         points=[[x[i],y[i]] for i in range(len(x))]
         j = numpy.complex(0, 1)
-        f = interpolate.CloughTocher2DInterpolator(points,z)
+        f = interpolate.CloughTocher2DInterpolator(points,z,fill_value=0.0)
         from .parametric_surface import ParametricSurface
         def g(x, y):
             z = f([x, y])
```
In my opinion the resulting plot is not particularly pleasing but it does reproduce the old behavior. I'm unable to determine whether there is any CPU savings. I do believe that modern graphing algorithms generate these `NaN`s as a mechanism to not plot points and that leaving things as-is is what should be done. In which case the doctest could be marked as `# long time` until the older hardware that doesn't like the `NaN`s is gone. So I would favor either of the above two approaches instead of `stripping` the `NaN`s.



---

archive/issue_comments_152638.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nI must say that in a previous comment I mentioned the possibility of using `fill_value`. If `0` reproduce the old behavior we could go with that but I don't think it is an especially good or always appropriate value. As you said if `NaN` means do not plot, then it is more appropriate.\n\nThe problem is not with older hardware, power8 is not especially old, but its handling of NaN is currently poor. I don't know if it can be improved at the software level eventually but I would hope so.",
    "created_at": "2018-03-12T22:37:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152638",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:47" align="right">Comment 47</div>

I must say that in a previous comment I mentioned the possibility of using `fill_value`. If `0` reproduce the old behavior we could go with that but I don't think it is an especially good or always appropriate value. As you said if `NaN` means do not plot, then it is more appropriate.

The problem is not with older hardware, power8 is not especially old, but its handling of NaN is currently poor. I don't know if it can be improved at the software level eventually but I would hope so.



---

archive/issue_comments_152639.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nReplying to [@kiwifb](#comment%3A47):\n> I must say that in a previous comment I mentioned the possibility of using `fill_value`. If `0` reproduce the old behavior we could go with that but I don't think it is an especially good or always appropriate value. As you said if `NaN` means do not plot, then it is more appropriate.\n> \n> The problem is not with older hardware, power8 is not especially old, but its handling of NaN is currently poor. I don't know if it can be improved at the software level eventually but I would hope so.\n\nI couldn't check things with vanilla Sage. But I was able to install MPL-1.5.3 on sage-on-gentoo and I could manually replicate the current behavior by setting `f.default_value=numpy.float('nan')` with the old `delaunay triangulation`.",
    "created_at": "2018-03-12T22:47:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152639",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:48" align="right">Comment 48</div>

Replying to [@kiwifb](#comment%3A47):
> I must say that in a previous comment I mentioned the possibility of using `fill_value`. If `0` reproduce the old behavior we could go with that but I don't think it is an especially good or always appropriate value. As you said if `NaN` means do not plot, then it is more appropriate.
> 
> The problem is not with older hardware, power8 is not especially old, but its handling of NaN is currently poor. I don't know if it can be improved at the software level eventually but I would hope so.

I couldn't check things with vanilla Sage. But I was able to install MPL-1.5.3 on sage-on-gentoo and I could manually replicate the current behavior by setting `f.default_value=numpy.float('nan')` with the old `delaunay triangulation`.



---

archive/issue_comments_152640.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nReplying to [@strogdon](#comment%3A46):\n> I do believe that modern graphing algorithms generate these `NaN`s as a mechanism to not plot points and that leaving things as-is is what should be done.\n\n-1.\n\nPlotting `NaN`s makes no sense at all. It can only lead to [garbage in, garbage out](https://en.wikipedia.org/wiki/Garbage_in,_garbage_out).\n\nI am actually surprised that removing the `NaN`s changes the output. I haven't looked at the code, but it makes me suspect that maybe the `NaN` removal is not done correctly.",
    "created_at": "2018-03-13T08:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152640",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">Comment 49</div>

Replying to [@strogdon](#comment%3A46):
> I do believe that modern graphing algorithms generate these `NaN`s as a mechanism to not plot points and that leaving things as-is is what should be done.

-1.

Plotting `NaN`s makes no sense at all. It can only lead to [garbage in, garbage out](https://en.wikipedia.org/wiki/Garbage_in,_garbage_out).

I am actually surprised that removing the `NaN`s changes the output. I haven't looked at the code, but it makes me suspect that maybe the `NaN` removal is not done correctly.



---

archive/issue_comments_152641.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nReplying to [@jdemeyer](#comment%3A49):\n> Plotting `NaN`s makes no sense at all. It can only lead to [garbage in, garbage out](https://en.wikipedia.org/wiki/Garbage_in,_garbage_out).\n> \n\nTry it!\n\n```\nsage: import matplotlib.pyplot as plt\nsage: fig, (ax1, ax2) = plt.subplots(1,2)\nsage: ax1.plot([1, 2, 2, 2, 3], [1, 1, NaN, 2, 2]);\nsage: ax2.plot([1, 2, 2, 3], [1, 1, 2, 2]);\nsage: plt.show()\n```\nThere may be other ways, but both scipy and matplotlib know how to handle such things.",
    "created_at": "2018-03-13T21:10:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152641",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:50" align="right">Comment 50</div>

Replying to [@jdemeyer](#comment%3A49):
> Plotting `NaN`s makes no sense at all. It can only lead to [garbage in, garbage out](https://en.wikipedia.org/wiki/Garbage_in,_garbage_out).
> 

Try it!

```
sage: import matplotlib.pyplot as plt
sage: fig, (ax1, ax2) = plt.subplots(1,2)
sage: ax1.plot([1, 2, 2, 2, 3], [1, 1, NaN, 2, 2]);
sage: ax2.plot([1, 2, 2, 3], [1, 1, 2, 2]);
sage: plt.show()
```
There may be other ways, but both scipy and matplotlib know how to handle such things.



---

archive/issue_comments_152642.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nWhat's your point? That example is showing a `Line2D` object which is a high-level object: it's a collection of lines, which the low-level renderer will treat as individual lines to be drawn.\n\nIt's precisely the transformation of a high-level object (the input to `list_plot3d`) to a low-level object (a collection of triangles) that is going wrong in this ticket.",
    "created_at": "2018-03-14T10:55:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152642",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">Comment 51</div>

What's your point? That example is showing a `Line2D` object which is a high-level object: it's a collection of lines, which the low-level renderer will treat as individual lines to be drawn.

It's precisely the transformation of a high-level object (the input to `list_plot3d`) to a low-level object (a collection of triangles) that is going wrong in this ticket.



---

archive/issue_comments_152643.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nIn other words: the bug is not about a `NaN` appearing in the input of `list_plot3d`. It is about a `NaN` appearing in the processing of otherwise valid input and being sent to the rendering engine.",
    "created_at": "2018-03-14T10:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152643",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">Comment 52</div>

In other words: the bug is not about a `NaN` appearing in the input of `list_plot3d`. It is about a `NaN` appearing in the processing of otherwise valid input and being sent to the rendering engine.



---

archive/issue_comments_152644.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nReplying to [@jdemeyer](#comment%3A52):\n> In other words: the bug is not about a `NaN` appearing in the input of `list_plot3d`. It is about a `NaN` appearing in the processing of otherwise valid input and being sent to the rendering engine.\n\nOK, so I guess there could be a problem inside `ParametricSurface` which receives input that contains the `NaN`s. A big task to fix that. So perhaps we should do as was done previously with the old code until `ParametricSurface` can be investigated, i.e. fill points outside the convex hull with zeros? I believe we know how to do that with `CloughTocher2DInterpolator`.",
    "created_at": "2018-03-14T14:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152644",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:53" align="right">Comment 53</div>

Replying to [@jdemeyer](#comment%3A52):
> In other words: the bug is not about a `NaN` appearing in the input of `list_plot3d`. It is about a `NaN` appearing in the processing of otherwise valid input and being sent to the rendering engine.

OK, so I guess there could be a problem inside `ParametricSurface` which receives input that contains the `NaN`s. A big task to fix that. So perhaps we should do as was done previously with the old code until `ParametricSurface` can be investigated, i.e. fill points outside the convex hull with zeros? I believe we know how to do that with `CloughTocher2DInterpolator`.



---

archive/issue_comments_152645.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nReplying to [@strogdon](#comment%3A53):\n> OK, so I guess there could be a problem inside `ParametricSurface` which receives input that contains the `NaN`s. A big task to fix that.\n\nI still think that it should be possible to just remove all the triangles containing a `NaN`. That can't be too hard.",
    "created_at": "2018-03-14T16:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152645",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:54" align="right">Comment 54</div>

Replying to [@strogdon](#comment%3A53):
> OK, so I guess there could be a problem inside `ParametricSurface` which receives input that contains the `NaN`s. A big task to fix that.

I still think that it should be possible to just remove all the triangles containing a `NaN`. That can't be too hard.



---

archive/issue_comments_152646.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nDoesn't strike me as a release blocker bug...",
    "created_at": "2018-03-25T00:43:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152646",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:55" align="right">Comment 55</div>

Doesn't strike me as a release blocker bug...



---

archive/issue_events_167113.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-25T00:43:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167113"
}
```



---

archive/issue_events_167114.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-25T00:43:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167114"
}
```



---

archive/issue_comments_152647.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nIt is. It yields a **massive** (orders of magnitude) slowdown on most platforms (x86_64 is the exception here), causing `make ptest` to timeout consistently and it is a recent regression.",
    "created_at": "2018-03-26T05:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152647",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">Comment 56</div>

It is. It yields a **massive** (orders of magnitude) slowdown on most platforms (x86_64 is the exception here), causing `make ptest` to timeout consistently and it is a recent regression.



---

archive/issue_events_167115.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-26T05:17:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167115"
}
```



---

archive/issue_events_167116.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-26T05:17:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167116"
}
```



---

archive/issue_comments_152648.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2018-03-26T15:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152648",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_152649.json:
```json
{
    "body": "Branch: **[u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates)**",
    "created_at": "2018-03-27T09:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152649",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates)**



---

archive/issue_comments_152650.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c5a3736ed18c692f0d63ba6b22e52ff1d7cd9a8\">4c5a373</a></td><td><code>Remove vertices containing a NaN or infinity</code></td></tr></table>\n",
    "created_at": "2018-03-27T10:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152650",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59" align="right">Comment 59</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c5a3736ed18c692f0d63ba6b22e52ff1d7cd9a8">4c5a373</a></td><td><code>Remove vertices containing a NaN or infinity</code></td></tr></table>




---

archive/issue_comments_152651.json:
```json
{
    "body": "Commit: **[4c5a373](https://github.com/sagemath/sagetrac-mirror/commit/4c5a3736ed18c692f0d63ba6b22e52ff1d7cd9a8)**",
    "created_at": "2018-03-27T10:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152651",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[4c5a373](https://github.com/sagemath/sagetrac-mirror/commit/4c5a3736ed18c692f0d63ba6b22e52ff1d7cd9a8)**



---

archive/issue_events_167117.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-27T10:31:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167117"
}
```



---

archive/issue_events_167118.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2018-03-27T16:26:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167118"
}
```



---

archive/issue_events_167119.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2018-03-27T16:26:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167119"
}
```



---

archive/issue_comments_152652.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nI thought all along that if there was a problem it had to be with the code that does the triangulation, not with the inputs. It's good that someone was capable of sorting through the code. I see no `NaN`s in the output and the surfaces appear to be drawn over the full convex hull. It may be interesting to see what are the CPU savings? But I do see at least one failure\n\n```\nsage -t --long src/sage/plot/plot3d/parametric_surface.pyx\n**********************************************************************\nFile \"src/sage/plot/plot3d/parametric_surface.pyx\", line 257, in sage.plot.plot3d.parametric_surface.ParametricSurface.obj_repr\nFailed example:\n    s[:2]+s[2][:3]+s[3][:3]\nExpected:\n    ['g obj_1',\n     'usemtl texture91',\n     'v -2 -2 0',\n     'v -2 -1.89744 0.399737',\n     'v -1.89744 -1.89744 0',\n     'f 1 2 3 4',\n     'f 2 5 6 3',\n     'f 5 7 8 6']\nGot:\n    ['g obj_1',\n     'usemtl texture111',\n     'v -2 -2 0',\n     'v -2 -1.89744 0.399737',\n     'v -1.89744 -1.89744 0',\n     'f 1 2 3 4',\n     'f 2 5 6 3',\n     'f 5 7 8 6']\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.plot.plot3d.parametric_surface.ParametricSurface.obj_repr\n```",
    "created_at": "2018-03-27T16:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152652",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:61" align="right">Comment 61</div>

I thought all along that if there was a problem it had to be with the code that does the triangulation, not with the inputs. It's good that someone was capable of sorting through the code. I see no `NaN`s in the output and the surfaces appear to be drawn over the full convex hull. It may be interesting to see what are the CPU savings? But I do see at least one failure

```
sage -t --long src/sage/plot/plot3d/parametric_surface.pyx
**********************************************************************
File "src/sage/plot/plot3d/parametric_surface.pyx", line 257, in sage.plot.plot3d.parametric_surface.ParametricSurface.obj_repr
Failed example:
    s[:2]+s[2][:3]+s[3][:3]
Expected:
    ['g obj_1',
     'usemtl texture91',
     'v -2 -2 0',
     'v -2 -1.89744 0.399737',
     'v -1.89744 -1.89744 0',
     'f 1 2 3 4',
     'f 2 5 6 3',
     'f 5 7 8 6']
Got:
    ['g obj_1',
     'usemtl texture111',
     'v -2 -2 0',
     'v -2 -1.89744 0.399737',
     'v -1.89744 -1.89744 0',
     'f 1 2 3 4',
     'f 2 5 6 3',
     'f 5 7 8 6']
**********************************************************************
1 item had failures:
   1 of   5 in sage.plot.plot3d.parametric_surface.ParametricSurface.obj_repr
```



---

archive/issue_comments_152653.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nReplying to [@strogdon](#comment%3A61):\n> But I do see at least one failure\n\nI cannot reproduce that failure but the original test had `texture...` so I'll change that.",
    "created_at": "2018-03-27T18:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152653",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">Comment 62</div>

Replying to [@strogdon](#comment%3A61):
> But I do see at least one failure

I cannot reproduce that failure but the original test had `texture...` so I'll change that.



---

archive/issue_comments_152654.json:
```json
{
    "body": "Changed commit from **[4c5a373](https://github.com/sagemath/sagetrac-mirror/commit/4c5a3736ed18c692f0d63ba6b22e52ff1d7cd9a8)** to **[4d17a73](https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c)**",
    "created_at": "2018-03-27T18:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152654",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4c5a373](https://github.com/sagemath/sagetrac-mirror/commit/4c5a3736ed18c692f0d63ba6b22e52ff1d7cd9a8)** to **[4d17a73](https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c)**



---

archive/issue_comments_152655.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c\">4d17a73</a></td><td><code>Remove vertices containing a NaN or infinity</code></td></tr></table>\n",
    "created_at": "2018-03-27T18:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152655",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:63" align="right">Comment 63</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c">4d17a73</a></td><td><code>Remove vertices containing a NaN or infinity</code></td></tr></table>




---

archive/issue_events_167120.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-27T19:11:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167120"
}
```



---

archive/issue_events_167121.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-27T19:11:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167121"
}
```



---

archive/issue_events_167122.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2018-03-27T19:52:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167122"
}
```



---

archive/issue_events_167123.json:
```json
{
    "actor": "https://github.com/strogdon",
    "created_at": "2018-03-27T19:52:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167123"
}
```



---

archive/issue_comments_152656.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nOn my very old, although x86_64, computer\n\n```\nsage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py\n    [45 tests, 23.20 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 23.3 seconds\n    cpu time: 4.4 seconds\n    cumulative wall time: 23.2 seconds\n```\nThe results do visually look to be correct. I can't test on anything but x86_64 but if it is slow elsewhere it's not now due to the `NaN`s.",
    "created_at": "2018-03-27T19:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152656",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:65" align="right">Comment 65</div>

On my very old, although x86_64, computer

```
sage -t --long --warn-long 10.0 src/sage/plot/plot3d/list_plot3d.py
    [45 tests, 23.20 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 23.3 seconds
    cpu time: 4.4 seconds
    cumulative wall time: 23.2 seconds
```
The results do visually look to be correct. I can't test on anything but x86_64 but if it is slow elsewhere it's not now due to the `NaN`s.



---

archive/issue_comments_152657.json:
```json
{
    "body": "Reviewer: **Steven Trogdon**",
    "created_at": "2018-03-27T19:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152657",
    "user": "https://github.com/strogdon"
}
```

Reviewer: **Steven Trogdon**



---

archive/issue_events_167124.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-28T18:26:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167124"
}
```



---

archive/issue_events_167125.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ce8d5f7601ba0ec4fcc69d6cda510cdc9e1fcabd",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-03-28T18:26:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13135#event-167125"
}
```



---

archive/issue_comments_152658.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates)** to **[4d17a73](https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c)**",
    "created_at": "2018-03-28T18:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13135#issuecomment-152658",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/list_plot3d_py_should_not_generate_nan_coordinates)** to **[4d17a73](https://github.com/sagemath/sagetrac-mirror/commit/4d17a73d3e0b7f7151acc4e29146c3992f3ac43c)**
