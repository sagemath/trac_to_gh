# Issue 13821: Change sage.combinat.combinat.combinations() to use Combinations

archive/issues_013617.json:
```json
{
    "body": "As I mentioned a long time ago in #5288, the `combinations()` method is not ideal for working with Sage objects. This warning is also present in the documentation of this command. There is a much better command `Combinations`. The `combinations` command should be made to return a list by calling `Combinations` instead.\n\nThe result of this change in the code will be that\n1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.\n2. It will be able to handle Sage objects much better.\n\nSimilarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.\n\nThe attached patch performs this change.\n\n---\nApply to devel/sage in this order:\n1. [attachment:trac_13821-change_combinations.patch]\n2. [attachment:trac_13821-replace_combinations.patch]\n\n**Assignee:** sage-combinat\n\n**CC:**  sage-combinat @kini\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Punarbasu Purkayastha\n\n**Merged:** sage-5.6.beta3\n\n**Dependencies:** #13723, #11763, #13503\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13821\n\n",
    "closed_at": "2013-01-07T20:56:34Z",
    "created_at": "2012-12-11T15:21:21Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.6",
    "title": "Change sage.combinat.combinat.combinations() to use Combinations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13821",
    "user": "https://github.com/ppurka"
}
```
As I mentioned a long time ago in #5288, the `combinations()` method is not ideal for working with Sage objects. This warning is also present in the documentation of this command. There is a much better command `Combinations`. The `combinations` command should be made to return a list by calling `Combinations` instead.

The result of this change in the code will be that
1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.
2. It will be able to handle Sage objects much better.

Similarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.

The attached patch performs this change.

---
Apply to devel/sage in this order:
1. [attachment:trac_13821-change_combinations.patch]
2. [attachment:trac_13821-replace_combinations.patch]

**Assignee:** sage-combinat

**CC:**  sage-combinat @kini

**Reviewer:** Travis Scrimshaw

**Author:** Punarbasu Purkayastha

**Merged:** sage-5.6.beta3

**Dependencies:** #13723, #11763, #13503

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/13821





---

archive/issue_comments_215094.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-12-11T16:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215094",
    "user": "https://github.com/ppurka"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_215095.json:
```json
{
    "body": "**Author:** Punarbasu Purkayastha",
    "created_at": "2012-12-11T16:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215095",
    "user": "https://github.com/ppurka"
}
```

**Author:** Punarbasu Purkayastha



---

archive/issue_comments_215096.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe attached patch implements this change.",
    "created_at": "2012-12-11T16:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215096",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:1'></a>
The attached patch implements this change.



---

archive/issue_comments_215097.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,6 +3,10 @@\n The result of this change in the code will be that\n 1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.\n 2. It will be able to handle Sage objects much better.\n-3. If and when #10534 is merged, the function will automatically gain at least 10x speed.\n \n Similarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.\n+\n+The attached patch performs this change.\n+\n+---\n+Apply [attachment:trac_13821-change_combinations.patch] to devel/sage.\n``````\n",
    "created_at": "2012-12-11T16:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215097",
    "user": "https://github.com/ppurka"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,6 +3,10 @@
 The result of this change in the code will be that
 1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.
 2. It will be able to handle Sage objects much better.
-3. If and when #10534 is merged, the function will automatically gain at least 10x speed.
 
 Similarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.
+
+The attached patch performs this change.
+
+---
+Apply [attachment:trac_13821-change_combinations.patch] to devel/sage.
``````




---

archive/issue_comments_215098.json:
```json
{
    "body": "<a id='comment:2'></a>\nWhy not deprecate the function? Does this depend on #5288 getting merged into sage?\n\nThanks,\n\nTravis",
    "created_at": "2012-12-11T19:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215098",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
Why not deprecate the function? Does this depend on #5288 getting merged into sage?

Thanks,

Travis



---

archive/issue_comments_215099.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2012-12-11T19:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215099",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_215100.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [tscrim](#comment%3A2):\n> Why not deprecate the function? Does this depend on #5288 getting merged into sage?\n> \n> Thanks,\n\n\n> Travis\n\nIt could be deprecated. But I don't know why it was written in the first place. It doesn't depend on #5288 at all.",
    "created_at": "2012-12-12T01:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215100",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:3'></a>
Replying to [tscrim](#comment%3A2):
> Why not deprecate the function? Does this depend on #5288 getting merged into sage?
> 
> Thanks,


> Travis

It could be deprecated. But I don't know why it was written in the first place. It doesn't depend on #5288 at all.



---

archive/issue_comments_215101.json:
```json
{
    "body": "<a id='comment:4'></a>\nMy guess is that it was from the old code (before `Combinations` and possibly before the categories model). I would deprecate the function since it is redundant and it just references `Combinations`. Also your `INPUT:` list bullets are indented too far and I would prefer the documentation to say *returns* or *references* rather than *wrapper for* for `combinations_iterator`. Thanks.",
    "created_at": "2012-12-15T07:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215101",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
My guess is that it was from the old code (before `Combinations` and possibly before the categories model). I would deprecate the function since it is redundant and it just references `Combinations`. Also your `INPUT:` list bullets are indented too far and I would prefer the documentation to say *returns* or *references* rather than *wrapper for* for `combinations_iterator`. Thanks.



---

archive/issue_comments_215102.json:
```json
{
    "body": "<a id='comment:5'></a>\nOk. I have put deprecation in the functions and done a bunch of cleanups. There is a second patch which replaces all the calls to `combinations*` with `Combinations`, that i could find with `search_src()`.",
    "created_at": "2012-12-15T16:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215102",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:5'></a>
Ok. I have put deprecation in the functions and done a bunch of cleanups. There is a second patch which replaces all the calls to `combinations*` with `Combinations`, that i could find with `search_src()`.



---

archive/issue_comments_215103.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,4 +9,6 @@\n The attached patch performs this change.\n \n ---\n-Apply [attachment:trac_13821-change_combinations.patch] to devel/sage.\n+Apply to devel/sage in this order:\n+1. [attachment:trac_13821-change_combinations.patch]\n+2. [attachment:trac_13821-replace_combinations.patch]\n``````\n",
    "created_at": "2012-12-15T16:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215103",
    "user": "https://github.com/ppurka"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,4 +9,6 @@
 The attached patch performs this change.
 
 ---
-Apply [attachment:trac_13821-change_combinations.patch] to devel/sage.
+Apply to devel/sage in this order:
+1. [attachment:trac_13821-change_combinations.patch]
+2. [attachment:trac_13821-replace_combinations.patch]
``````




---

archive/issue_comments_215104.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2012-12-15T16:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215104",
    "user": "https://github.com/ppurka"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_215105.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2012-12-15T18:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215105",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_215106.json:
```json
{
    "body": "<a id='comment:6'></a>\nA few more documenation things:\n- The `INPUT:` for `combintions_iterator()` is still indented.\n- You have `..note::` but there should be a space there: `.. NOTE::` (personally I prefer the capitalized form since it is consistent with the dev-guide, but if you prefer the lowercase, that's fine).\n- I don't like the formatting of\n\n```\nIt is possible to take combinations of Sage objects.::\n```\n  as it will output in the html\n\n```\nIt is possible to take combinations of Sage objects.:\n```\n  Thus either remove the period or put a space between the period and the colon (i.e. as `objects. ::`).\n\nThanks,\n\nTravis",
    "created_at": "2012-12-15T18:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215106",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
A few more documenation things:
- The `INPUT:` for `combintions_iterator()` is still indented.
- You have `..note::` but there should be a space there: `.. NOTE::` (personally I prefer the capitalized form since it is consistent with the dev-guide, but if you prefer the lowercase, that's fine).
- I don't like the formatting of

```
It is possible to take combinations of Sage objects.::
```
  as it will output in the html

```
It is possible to take combinations of Sage objects.:
```
  Thus either remove the period or put a space between the period and the colon (i.e. as `objects. ::`).

Thanks,

Travis



---

archive/issue_comments_215107.json:
```json
{
    "body": "Apply to devel/sage",
    "created_at": "2012-12-15T20:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215107",
    "user": "https://github.com/ppurka"
}
```

Apply to devel/sage



---

archive/issue_comments_215108.json:
```json
{
    "body": "<a id='comment:7'></a>\nAttachment [trac_13821-change_combinations.patch](tarball://root/attachments/some-uuid/ticket13821/trac_13821-change_combinations.patch) by @ppurka created at 2012-12-15 20:37:27\n\nThanks for the review. These issues should be fixed now.\n\nPatchbot: apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch",
    "created_at": "2012-12-15T20:37:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215108",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:7'></a>
Attachment [trac_13821-change_combinations.patch](tarball://root/attachments/some-uuid/ticket13821/trac_13821-change_combinations.patch) by @ppurka created at 2012-12-15 20:37:27

Thanks for the review. These issues should be fixed now.

Patchbot: apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch



---

archive/issue_comments_215109.json:
```json
{
    "body": "<a id='comment:8'></a>\nLooks good to me. Thanks.",
    "created_at": "2012-12-16T17:13:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215109",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
Looks good to me. Thanks.



---

archive/issue_comments_215110.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-12-16T17:13:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215110",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_215111.json:
```json
{
    "body": "**Dependencies:** #13723",
    "created_at": "2012-12-22T07:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215111",
    "user": "https://github.com/jdemeyer"
}
```

**Dependencies:** #13723



---

archive/issue_comments_215112.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2012-12-22T07:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215112",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_215113.json:
```json
{
    "body": "<a id='comment:9'></a>\nThis needs to be rebased on top of #13723.",
    "created_at": "2012-12-22T07:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215113",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
This needs to be rebased on top of #13723.



---

archive/issue_comments_215114.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [jdemeyer](#comment%3A9):\n> This needs to be rebased on top of #13723.\n\nThis should be fixed now. Only change needed was the [removal of an import](https://github.com/ppurka/sage-patches/commit/32d79050656d5fa65d5eb44912f43cd8be2f9dba#L0L18).",
    "created_at": "2012-12-22T13:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215114",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:10'></a>
Replying to [jdemeyer](#comment%3A9):
> This needs to be rebased on top of #13723.

This should be fixed now. Only change needed was the [removal of an import](https://github.com/ppurka/sage-patches/commit/32d79050656d5fa65d5eb44912f43cd8be2f9dba#L0L18).



---

archive/issue_comments_215115.json:
```json
{
    "body": "**Changing status** from needs_work to positive_review.",
    "created_at": "2012-12-22T13:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215115",
    "user": "https://github.com/ppurka"
}
```

**Changing status** from needs_work to positive_review.



---

archive/issue_comments_215116.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2012-12-30T12:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215116",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_215117.json:
```json
{
    "body": "<a id='comment:11'></a>\nThere are two doctest failures coming from #11763:\n\n```\nsage -t  -force_lib devel/sage/sage/geometry/polyhedron/base_ZZ.py\n**********************************************************************\nFile \"/release/merger/sage-5.6.beta2/devel/sage-main/sage/geometry/polyhedron/base_ZZ.py\", line 227:\n    sage: list( P.fibration_generator(2) )\nExpected:\n    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]\nGot:\n    doctest:239: DeprecationWarning: Use Combinations(mset,k) instead.\n    See http://trac.sagemath.org/13821 for details.\n    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]\n**********************************************************************\n```\nand\n\n```\nsage -t  -force_lib devel/sage/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"/release/merger/sage-5.6.beta2/devel/sage-main/sage/graphs/generic_graph.py\", line 11862:\n    sage: G.triangles_count()\nExpected:\n    0\nGot:\n    doctest:11913: DeprecationWarning: Use Combinations(mset,k) instead.\n    See http://trac.sagemath.org/13821 for details.\n    0\n**********************************************************************\n```",
    "created_at": "2012-12-30T12:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215117",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
There are two doctest failures coming from #11763:

```
sage -t  -force_lib devel/sage/sage/geometry/polyhedron/base_ZZ.py
**********************************************************************
File "/release/merger/sage-5.6.beta2/devel/sage-main/sage/geometry/polyhedron/base_ZZ.py", line 227:
    sage: list( P.fibration_generator(2) )
Expected:
    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]
Got:
    doctest:239: DeprecationWarning: Use Combinations(mset,k) instead.
    See http://trac.sagemath.org/13821 for details.
    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]
**********************************************************************
```
and

```
sage -t  -force_lib devel/sage/sage/graphs/generic_graph.py
**********************************************************************
File "/release/merger/sage-5.6.beta2/devel/sage-main/sage/graphs/generic_graph.py", line 11862:
    sage: G.triangles_count()
Expected:
    0
Got:
    doctest:11913: DeprecationWarning: Use Combinations(mset,k) instead.
    See http://trac.sagemath.org/13821 for details.
    0
**********************************************************************
```



---

archive/issue_comments_215118.json:
```json
{
    "body": "**Changing dependencies** from \"#13723\" to \"#13723, #11763\".",
    "created_at": "2012-12-30T12:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215118",
    "user": "https://github.com/jdemeyer"
}
```

**Changing dependencies** from "#13723" to "#13723, #11763".



---

archive/issue_comments_215119.json:
```json
{
    "body": "Attachment [trac_13821-replace_combinations.patch](tarball://root/attachments/some-uuid/ticket13821/trac_13821-replace_combinations.patch) by @ppurka created at 2012-12-30 16:36:18\n\nApply to devel/sage after above patch",
    "created_at": "2012-12-30T16:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215119",
    "user": "https://github.com/ppurka"
}
```

Attachment [trac_13821-replace_combinations.patch](tarball://root/attachments/some-uuid/ticket13821/trac_13821-replace_combinations.patch) by @ppurka created at 2012-12-30 16:36:18

Apply to devel/sage after above patch



---

archive/issue_comments_215120.json:
```json
{
    "body": "<a id='comment:12'></a>\n[Updated](https://github.com/ppurka/sage-patches/commit/be89adf79265ebd147c16ea5dc4e9db044253f00) the patch. I will set it to positive review if the patchbot turns green with envy.",
    "created_at": "2012-12-30T16:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215120",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:12'></a>
[Updated](https://github.com/ppurka/sage-patches/commit/be89adf79265ebd147c16ea5dc4e9db044253f00) the patch. I will set it to positive review if the patchbot turns green with envy.



---

archive/issue_comments_215121.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2012-12-30T16:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215121",
    "user": "https://github.com/ppurka"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_215122.json:
```json
{
    "body": "<a id='comment:13'></a>\nppurka: this is a change which requires an actual review.",
    "created_at": "2012-12-31T09:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215122",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
ppurka: this is a change which requires an actual review.



---

archive/issue_comments_215123.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A13):\n> ppurka: this is a change which requires an actual review.\n\nI don't mind. But the patchbot seems to have failed in exactly the same position. This is unexpected. I didn't see any other use of `combination` from `search_src()`.\n\nMoreover, my local testing gave no errors on those files.",
    "created_at": "2012-12-31T09:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215123",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A13):
> ppurka: this is a change which requires an actual review.

I don't mind. But the patchbot seems to have failed in exactly the same position. This is unexpected. I didn't see any other use of `combination` from `search_src()`.

Moreover, my local testing gave no errors on those files.



---

archive/issue_comments_215124.json:
```json
{
    "body": "<a id='comment:15'></a>\nFrom the patchbot logs:\n\n```\n2012-12-30 23:17:49 +0000\nLooking at #13821\nLooking at #13723\n#13723 already applied (5.6.beta0 <= 5.6.beta1)\nLooking at #11763\n#11763 already applied (5.6.beta1 <= 5.6.beta1)\nPatches for #13821:\n    trac_13821-change_combinations.patch#06e5f20c6df61a1803698a5b80ee0240\n    trac_13821-replace_combinations.patch#5356795e4cae7f89cd58c17dbe122f7f\nhg qpop trac_13821-replace_combinations.patch\nqpop: trac_13821-replace_combinations.patch is already at the top\nhg qapplied\ntrac_13821-change_combinations.patch\ntrac_13821-replace_combinations.patch\n```\nWhy is it using the old patches? Shouldn't it be trying with the new patches?",
    "created_at": "2012-12-31T09:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215124",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:15'></a>
From the patchbot logs:

```
2012-12-30 23:17:49 +0000
Looking at #13821
Looking at #13723
#13723 already applied (5.6.beta0 <= 5.6.beta1)
Looking at #11763
#11763 already applied (5.6.beta1 <= 5.6.beta1)
Patches for #13821:
    trac_13821-change_combinations.patch#06e5f20c6df61a1803698a5b80ee0240
    trac_13821-replace_combinations.patch#5356795e4cae7f89cd58c17dbe122f7f
hg qpop trac_13821-replace_combinations.patch
qpop: trac_13821-replace_combinations.patch is already at the top
hg qapplied
trac_13821-change_combinations.patch
trac_13821-replace_combinations.patch
```
Why is it using the old patches? Shouldn't it be trying with the new patches?



---

archive/issue_comments_215125.json:
```json
{
    "body": "<a id='comment:16'></a>\npatchbot apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch",
    "created_at": "2012-12-31T12:03:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215125",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:16'></a>
patchbot apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch



---

archive/issue_comments_215126.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-12-31T17:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215126",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_215127.json:
```json
{
    "body": "<a id='comment:17'></a>\nWorks for me as well:\n\n```\ntravis@travis-virtualbox:~/sage-5.5.rc0/devel/sage-reviews/sage$ sage -t graphs/generic_graph.py geometry/polyhedron/base_ZZ.py \nsage -t  \"devel/sage-reviews/sage/geometry/polyhedron/base_ZZ.py\"\n\t [24.3 s]\nsage -t  \"devel/sage-reviews/sage/graphs/generic_graph.py\"  \n\t [91.9 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 116.3 seconds\n```\n(For whomever is interested, the replace patch depends on #13503)\n\nI've had this issue of the patchbot using old patches come up a few places before. I've kicked the patchbot, so hopefully next time the patchbot will pass all tests. Since the tests pass for me, I'm going to set this to positive review.",
    "created_at": "2012-12-31T17:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215127",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Works for me as well:

```
travis@travis-virtualbox:~/sage-5.5.rc0/devel/sage-reviews/sage$ sage -t graphs/generic_graph.py geometry/polyhedron/base_ZZ.py 
sage -t  "devel/sage-reviews/sage/geometry/polyhedron/base_ZZ.py"
	 [24.3 s]
sage -t  "devel/sage-reviews/sage/graphs/generic_graph.py"  
	 [91.9 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 116.3 seconds
```
(For whomever is interested, the replace patch depends on #13503)

I've had this issue of the patchbot using old patches come up a few places before. I've kicked the patchbot, so hopefully next time the patchbot will pass all tests. Since the tests pass for me, I'm going to set this to positive review.



---

archive/issue_comments_215128.json:
```json
{
    "body": "<a id='comment:18'></a>\nThanks.\n\nI didn't know it was a more common occurrence with the patchbot. It looks like it doesn't clear the queue while applying new patches.",
    "created_at": "2012-12-31T17:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215128",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:18'></a>
Thanks.

I didn't know it was a more common occurrence with the patchbot. It looks like it doesn't clear the queue while applying new patches.



---

archive/issue_comments_215129.json:
```json
{
    "body": "<a id='comment:19'></a>\n`@`kini - can you have a look at the patchbot? I think you are one of the few people who know how it works.",
    "created_at": "2012-12-31T17:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215129",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:19'></a>
`@`kini - can you have a look at the patchbot? I think you are one of the few people who know how it works.



---

archive/issue_comments_215130.json:
```json
{
    "body": "<a id='comment:20'></a>\nHmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...",
    "created_at": "2012-12-31T18:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215130",
    "user": "https://github.com/kini"
}
```

<a id='comment:20'></a>
Hmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...



---

archive/issue_comments_215131.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [kini](#comment%3A20):\n> Hmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...\n\n\nDid it fail to apply? My guess is that is because #13503 was merged in `5.6.beta1`. I've formally added it as a dependency.",
    "created_at": "2013-01-01T05:35:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215131",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
Replying to [kini](#comment%3A20):
> Hmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...


Did it fail to apply? My guess is that is because #13503 was merged in `5.6.beta1`. I've formally added it as a dependency.



---

archive/issue_comments_215132.json:
```json
{
    "body": "**Changing dependencies** from \"#13723, #11763\" to \"#13723, #11763, #13503\".",
    "created_at": "2013-01-01T05:35:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215132",
    "user": "https://github.com/tscrim"
}
```

**Changing dependencies** from "#13723, #11763" to "#13723, #11763, #13503".



---

archive/issue_comments_215133.json:
```json
{
    "body": "<a id='comment:22'></a>\nIt should apply fine to beta0, since it applies fine to beta1. Anyway, the patchbot seems to have caught up or kini did some miracle! :)",
    "created_at": "2013-01-01T10:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215133",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:22'></a>
It should apply fine to beta0, since it applies fine to beta1. Anyway, the patchbot seems to have caught up or kini did some miracle! :)



---

archive/issue_comments_215134.json:
```json
{
    "body": "<a id='comment:23'></a>\nI didn't do anything. Vanilla 5.6.beta1 doesn't even pass tests on my machine, and my patchbot failed to apply #11763 to beta0 for some reason. Volker's patchbot is the one that came along and gave this ticket a green light.",
    "created_at": "2013-01-01T19:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215134",
    "user": "https://github.com/kini"
}
```

<a id='comment:23'></a>
I didn't do anything. Vanilla 5.6.beta1 doesn't even pass tests on my machine, and my patchbot failed to apply #11763 to beta0 for some reason. Volker's patchbot is the one that came along and gave this ticket a green light.



---

archive/issue_events_044907.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-07T20:56:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13821#event-44907"
}
```



---

archive/issue_comments_215135.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-01-07T20:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215135",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed



---

archive/issue_comments_215136.json:
```json
{
    "body": "**Merged:** sage-5.6.beta3",
    "created_at": "2013-01-07T20:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13821#issuecomment-215136",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.6.beta3
