# Issue 13821: Change sage.combinat.combinat.combinations() to use Combinations

archive/issues_013617.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "As I mentioned a long time ago in #5288, the `combinations()` method is not ideal for working with Sage objects. This warning is also present in the documentation of this command. There is a much better command `Combinations`. The `combinations` command should be made to return a list by calling `Combinations` instead.\n\nThe result of this change in the code will be that\n1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.\n2. It will be able to handle Sage objects much better.\n\nSimilarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.\n\nThe attached patch performs this change.\n\n---\nApply to devel/sage in this order:\n1. [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz)\n2. [attachment: trac_13821-replace_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-replace_combinations.patch.gz)\n\nDepends on #13723\nDepends on #11763\nDepends on #13503\n\nCC:  @sagetrac-sage-combinat @kini\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Punarbasu Purkayastha**\n\nMerged: **sage-5.6.beta3**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13821_\n\n",
    "closed_at": "2013-01-07T20:56:34Z",
    "created_at": "2012-12-11T15:21:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Change sage.combinat.combinat.combinations() to use Combinations",
    "type": "issue",
    "updated_at": "2013-01-07T20:56:34Z",
    "url": "https://github.com/sagemath/sage/issues/13821",
    "user": "https://github.com/ppurka"
}
```
As I mentioned a long time ago in #5288, the `combinations()` method is not ideal for working with Sage objects. This warning is also present in the documentation of this command. There is a much better command `Combinations`. The `combinations` command should be made to return a list by calling `Combinations` instead.

The result of this change in the code will be that
1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.
2. It will be able to handle Sage objects much better.

Similarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.

The attached patch performs this change.

---
Apply to devel/sage in this order:
1. [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz)
2. [attachment: trac_13821-replace_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-replace_combinations.patch.gz)

Depends on #13723
Depends on #11763
Depends on #13503

CC:  @sagetrac-sage-combinat @kini

Reviewer: **Travis Scrimshaw**

Author: **Punarbasu Purkayastha**

Merged: **sage-5.6.beta3**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/13821_





---

archive/issue_events_193927.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-11T15:21:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193927"
}
```



---

archive/issue_events_193928.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-11T15:21:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193928"
}
```



---

archive/issue_events_193929.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-11T15:21:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193929"
}
```



---

archive/issue_events_193930.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-11T15:21:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193930"
}
```



---

archive/issue_events_193931.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2012-12-11T15:21:21Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "subject": "https://github.com/ppurka",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193931"
}
```



---

archive/issue_events_193932.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-11T16:02:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193932"
}
```



---

archive/issue_comments_162920.json:
```json
{
    "body": "Author: **Punarbasu Purkayastha**",
    "created_at": "2012-12-11T16:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162920",
    "user": "https://github.com/ppurka"
}
```

Author: **Punarbasu Purkayastha**



---

archive/issue_comments_162921.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe attached patch implements this change.",
    "created_at": "2012-12-11T16:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162921",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:1" align="right">comment:1</div>

The attached patch implements this change.



---

archive/issue_comments_162922.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,10 @@\n The result of this change in the code will be that\n 1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.\n 2. It will be able to handle Sage objects much better.\n-3. If and when #10534 is merged, the function will automatically gain at least 10x speed.\n \n Similarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.\n+\n+The attached patch performs this change.\n+\n+---\n+Apply [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz) to devel/sage.\n``````\n",
    "created_at": "2012-12-11T16:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162922",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,10 @@
 The result of this change in the code will be that
 1. It will also speed up the function considerably, partly because it won't depend on string parsing from GAP.
 2. It will be able to handle Sage objects much better.
-3. If and when #10534 is merged, the function will automatically gain at least 10x speed.
 
 Similarly, `combinations_iterator` should directly return a `Combinations` object, instead of duplicating stuff.
+
+The attached patch performs this change.
+
+---
+Apply [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz) to devel/sage.
``````




---

archive/issue_comments_162923.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nWhy not deprecate the function? Does this depend on #5288 getting merged into sage?\n\nThanks,\n\nTravis",
    "created_at": "2012-12-11T19:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162923",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:2" align="right">comment:2</div>

Why not deprecate the function? Does this depend on #5288 getting merged into sage?

Thanks,

Travis



---

archive/issue_events_193933.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-11T19:29:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193933"
}
```



---

archive/issue_events_193934.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-11T19:29:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193934"
}
```



---

archive/issue_comments_162924.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@tscrim](#comment:2):\n> Why not deprecate the function? Does this depend on #5288 getting merged into sage?\n> \n> Thanks,\n\n> Travis\n\nIt could be deprecated. But I don't know why it was written in the first place. It doesn't depend on #5288 at all.",
    "created_at": "2012-12-12T01:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162924",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@tscrim](#comment:2):
> Why not deprecate the function? Does this depend on #5288 getting merged into sage?
> 
> Thanks,

> Travis

It could be deprecated. But I don't know why it was written in the first place. It doesn't depend on #5288 at all.



---

archive/issue_comments_162925.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nMy guess is that it was from the old code (before `Combinations` and possibly before the categories model). I would deprecate the function since it is redundant and it just references `Combinations`. Also your `INPUT:` list bullets are indented too far and I would prefer the documentation to say *returns* or *references* rather than *wrapper for* for `combinations_iterator`. Thanks.",
    "created_at": "2012-12-15T07:04:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162925",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:4" align="right">comment:4</div>

My guess is that it was from the old code (before `Combinations` and possibly before the categories model). I would deprecate the function since it is redundant and it just references `Combinations`. Also your `INPUT:` list bullets are indented too far and I would prefer the documentation to say *returns* or *references* rather than *wrapper for* for `combinations_iterator`. Thanks.



---

archive/issue_comments_162926.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOk. I have put deprecation in the functions and done a bunch of cleanups. There is a second patch which replaces all the calls to `combinations*` with `Combinations`, that i could find with `search_src()`.",
    "created_at": "2012-12-15T16:28:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162926",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:5" align="right">comment:5</div>

Ok. I have put deprecation in the functions and done a bunch of cleanups. There is a second patch which replaces all the calls to `combinations*` with `Combinations`, that i could find with `search_src()`.



---

archive/issue_comments_162927.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,6 @@\n The attached patch performs this change.\n \n ---\n-Apply [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz) to devel/sage.\n+Apply to devel/sage in this order:\n+1. [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz)\n+2. [attachment: trac_13821-replace_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-replace_combinations.patch.gz)\n``````\n",
    "created_at": "2012-12-15T16:28:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162927",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,6 @@
 The attached patch performs this change.
 
 ---
-Apply [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz) to devel/sage.
+Apply to devel/sage in this order:
+1. [attachment: trac_13821-change_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz)
+2. [attachment: trac_13821-replace_combinations.patch](https://github.com/sagemath/sage/files/ticket13821/trac_13821-replace_combinations.patch.gz)
``````




---

archive/issue_events_193935.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-15T16:28:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193935"
}
```



---

archive/issue_events_193936.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-15T16:28:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193936"
}
```



---

archive/issue_comments_162928.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2012-12-15T18:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162928",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_162929.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nA few more documenation things:\n- The `INPUT:` for `combintions_iterator()` is still indented.\n- You have `..note::` but there should be a space there: `.. NOTE::` (personally I prefer the capitalized form since it is consistent with the dev-guide, but if you prefer the lowercase, that's fine).\n- I don't like the formatting of\n\n```\nIt is possible to take combinations of Sage objects.::\n```\n  as it will output in the html\n\n```\nIt is possible to take combinations of Sage objects.:\n```\n  Thus either remove the period or put a space between the period and the colon (i.e. as `objects. ::`).\n\nThanks,\n\nTravis",
    "created_at": "2012-12-15T18:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162929",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

A few more documenation things:
- The `INPUT:` for `combintions_iterator()` is still indented.
- You have `..note::` but there should be a space there: `.. NOTE::` (personally I prefer the capitalized form since it is consistent with the dev-guide, but if you prefer the lowercase, that's fine).
- I don't like the formatting of

```
It is possible to take combinations of Sage objects.::
```
  as it will output in the html

```
It is possible to take combinations of Sage objects.:
```
  Thus either remove the period or put a space between the period and the colon (i.e. as `objects. ::`).

Thanks,

Travis



---

archive/issue_comments_162930.json:
```json
{
    "body": "Apply to devel/sage",
    "created_at": "2012-12-15T20:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162930",
    "user": "https://github.com/ppurka"
}
```

Apply to devel/sage



---

archive/issue_comments_162931.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_13821-change_combinations.patch.gz](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz)**\n\nThanks for the review. These issues should be fixed now.\n\nPatchbot: apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch",
    "created_at": "2012-12-15T20:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162931",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_13821-change_combinations.patch.gz](https://github.com/sagemath/sage/files/ticket13821/trac_13821-change_combinations.patch.gz)**

Thanks for the review. These issues should be fixed now.

Patchbot: apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch



---

archive/issue_comments_162932.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nLooks good to me. Thanks.",
    "created_at": "2012-12-16T17:13:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162932",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

Looks good to me. Thanks.



---

archive/issue_events_193937.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-16T17:13:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193937"
}
```



---

archive/issue_events_193938.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-16T17:13:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193938"
}
```



---

archive/issue_comments_162933.json:
```json
{
    "body": "Dependencies: **#13723**",
    "created_at": "2012-12-22T07:01:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162933",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#13723**



---

archive/issue_events_193939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-22T07:01:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193939"
}
```



---

archive/issue_events_193940.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-22T07:01:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193940"
}
```



---

archive/issue_comments_162934.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThis needs to be rebased on top of #13723.",
    "created_at": "2012-12-22T07:01:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162934",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

This needs to be rebased on top of #13723.



---

archive/issue_comments_162935.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jdemeyer](#comment:9):\n> This needs to be rebased on top of #13723.\n\nThis should be fixed now. Only change needed was the [removal of an import](https://github.com/ppurka/sage-patches/commit/32d79050656d5fa65d5eb44912f43cd8be2f9dba#L0L18).",
    "created_at": "2012-12-22T13:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162935",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jdemeyer](#comment:9):
> This needs to be rebased on top of #13723.

This should be fixed now. Only change needed was the [removal of an import](https://github.com/ppurka/sage-patches/commit/32d79050656d5fa65d5eb44912f43cd8be2f9dba#L0L18).



---

archive/issue_events_193941.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-22T13:35:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193941"
}
```



---

archive/issue_events_193942.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-22T13:35:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193942"
}
```



---

archive/issue_events_193943.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-30T12:11:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193943"
}
```



---

archive/issue_events_193944.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-30T12:11:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193944"
}
```



---

archive/issue_comments_162936.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThere are two doctest failures coming from #11763:\n\n```\nsage -t  -force_lib devel/sage/sage/geometry/polyhedron/base_ZZ.py\n**********************************************************************\nFile \"/release/merger/sage-5.6.beta2/devel/sage-main/sage/geometry/polyhedron/base_ZZ.py\", line 227:\n    sage: list( P.fibration_generator(2) )\nExpected:\n    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]\nGot:\n    doctest:239: DeprecationWarning: Use Combinations(mset,k) instead.\n    See http://trac.sagemath.org/13821 for details.\n    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]\n**********************************************************************\n```\nand\n\n```\nsage -t  -force_lib devel/sage/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"/release/merger/sage-5.6.beta2/devel/sage-main/sage/graphs/generic_graph.py\", line 11862:\n    sage: G.triangles_count()\nExpected:\n    0\nGot:\n    doctest:11913: DeprecationWarning: Use Combinations(mset,k) instead.\n    See http://trac.sagemath.org/13821 for details.\n    0\n**********************************************************************\n```",
    "created_at": "2012-12-30T12:11:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162936",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

There are two doctest failures coming from #11763:

```
sage -t  -force_lib devel/sage/sage/geometry/polyhedron/base_ZZ.py
**********************************************************************
File "/release/merger/sage-5.6.beta2/devel/sage-main/sage/geometry/polyhedron/base_ZZ.py", line 227:
    sage: list( P.fibration_generator(2) )
Expected:
    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]
Got:
    doctest:239: DeprecationWarning: Use Combinations(mset,k) instead.
    See http://trac.sagemath.org/13821 for details.
    [A 2-dimensional polyhedron in ZZ^4 defined as the convex hull of 3 vertices]
**********************************************************************
```
and

```
sage -t  -force_lib devel/sage/sage/graphs/generic_graph.py
**********************************************************************
File "/release/merger/sage-5.6.beta2/devel/sage-main/sage/graphs/generic_graph.py", line 11862:
    sage: G.triangles_count()
Expected:
    0
Got:
    doctest:11913: DeprecationWarning: Use Combinations(mset,k) instead.
    See http://trac.sagemath.org/13821 for details.
    0
**********************************************************************
```



---

archive/issue_comments_162937.json:
```json
{
    "body": "Changed dependencies from **#13723** to **#13723, #11763**",
    "created_at": "2012-12-30T12:11:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162937",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13723** to **#13723, #11763**



---

archive/issue_comments_162938.json:
```json
{
    "body": "Attachment: **[trac_13821-replace_combinations.patch.gz](https://github.com/sagemath/sage/files/ticket13821/trac_13821-replace_combinations.patch.gz)**\n\nApply to devel/sage after above patch",
    "created_at": "2012-12-30T16:36:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162938",
    "user": "https://github.com/ppurka"
}
```

Attachment: **[trac_13821-replace_combinations.patch.gz](https://github.com/sagemath/sage/files/ticket13821/trac_13821-replace_combinations.patch.gz)**

Apply to devel/sage after above patch



---

archive/issue_comments_162939.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n[Updated](https://github.com/ppurka/sage-patches/commit/be89adf79265ebd147c16ea5dc4e9db044253f00) the patch. I will set it to positive review if the patchbot turns green with envy.",
    "created_at": "2012-12-30T16:37:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162939",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:12" align="right">comment:12</div>

[Updated](https://github.com/ppurka/sage-patches/commit/be89adf79265ebd147c16ea5dc4e9db044253f00) the patch. I will set it to positive review if the patchbot turns green with envy.



---

archive/issue_events_193945.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-30T16:37:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193945"
}
```



---

archive/issue_events_193946.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-12-30T16:37:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193946"
}
```



---

archive/issue_comments_162940.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nppurka: this is a change which requires an actual review.",
    "created_at": "2012-12-31T09:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162940",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

ppurka: this is a change which requires an actual review.



---

archive/issue_comments_162941.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment:13):\n> ppurka: this is a change which requires an actual review.\n\nI don't mind. But the patchbot seems to have failed in exactly the same position. This is unexpected. I didn't see any other use of `combination` from `search_src()`.\n\nMoreover, my local testing gave no errors on those files.",
    "created_at": "2012-12-31T09:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162941",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment:13):
> ppurka: this is a change which requires an actual review.

I don't mind. But the patchbot seems to have failed in exactly the same position. This is unexpected. I didn't see any other use of `combination` from `search_src()`.

Moreover, my local testing gave no errors on those files.



---

archive/issue_comments_162942.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nFrom the patchbot logs:\n\n```\n2012-12-30 23:17:49 +0000\nLooking at #13821\nLooking at #13723\n#13723 already applied (5.6.beta0 <= 5.6.beta1)\nLooking at #11763\n#11763 already applied (5.6.beta1 <= 5.6.beta1)\nPatches for #13821:\n    trac_13821-change_combinations.patch#06e5f20c6df61a1803698a5b80ee0240\n    trac_13821-replace_combinations.patch#5356795e4cae7f89cd58c17dbe122f7f\nhg qpop trac_13821-replace_combinations.patch\nqpop: trac_13821-replace_combinations.patch is already at the top\nhg qapplied\ntrac_13821-change_combinations.patch\ntrac_13821-replace_combinations.patch\n```\nWhy is it using the old patches? Shouldn't it be trying with the new patches?",
    "created_at": "2012-12-31T09:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162942",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:15" align="right">comment:15</div>

From the patchbot logs:

```
2012-12-30 23:17:49 +0000
Looking at #13821
Looking at #13723
#13723 already applied (5.6.beta0 <= 5.6.beta1)
Looking at #11763
#11763 already applied (5.6.beta1 <= 5.6.beta1)
Patches for #13821:
    trac_13821-change_combinations.patch#06e5f20c6df61a1803698a5b80ee0240
    trac_13821-replace_combinations.patch#5356795e4cae7f89cd58c17dbe122f7f
hg qpop trac_13821-replace_combinations.patch
qpop: trac_13821-replace_combinations.patch is already at the top
hg qapplied
trac_13821-change_combinations.patch
trac_13821-replace_combinations.patch
```
Why is it using the old patches? Shouldn't it be trying with the new patches?



---

archive/issue_comments_162943.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\npatchbot apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch",
    "created_at": "2012-12-31T12:03:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162943",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:16" align="right">comment:16</div>

patchbot apply trac_13821-change_combinations.patch trac_13821-replace_combinations.patch



---

archive/issue_events_193947.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-31T17:36:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193947"
}
```



---

archive/issue_events_193948.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2012-12-31T17:36:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193948"
}
```



---

archive/issue_comments_162944.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nWorks for me as well:\n\n```\ntravis@travis-virtualbox:~/sage-5.5.rc0/devel/sage-reviews/sage$ sage -t graphs/generic_graph.py geometry/polyhedron/base_ZZ.py \nsage -t  \"devel/sage-reviews/sage/geometry/polyhedron/base_ZZ.py\"\n\t [24.3 s]\nsage -t  \"devel/sage-reviews/sage/graphs/generic_graph.py\"  \n\t [91.9 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 116.3 seconds\n```\n(For whomever is interested, the replace patch depends on #13503)\n\nI've had this issue of the patchbot using old patches come up a few places before. I've kicked the patchbot, so hopefully next time the patchbot will pass all tests. Since the tests pass for me, I'm going to set this to positive review.",
    "created_at": "2012-12-31T17:36:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162944",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

Works for me as well:

```
travis@travis-virtualbox:~/sage-5.5.rc0/devel/sage-reviews/sage$ sage -t graphs/generic_graph.py geometry/polyhedron/base_ZZ.py 
sage -t  "devel/sage-reviews/sage/geometry/polyhedron/base_ZZ.py"
	 [24.3 s]
sage -t  "devel/sage-reviews/sage/graphs/generic_graph.py"  
	 [91.9 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 116.3 seconds
```
(For whomever is interested, the replace patch depends on #13503)

I've had this issue of the patchbot using old patches come up a few places before. I've kicked the patchbot, so hopefully next time the patchbot will pass all tests. Since the tests pass for me, I'm going to set this to positive review.



---

archive/issue_comments_162945.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThanks.\n\nI didn't know it was a more common occurrence with the patchbot. It looks like it doesn't clear the queue while applying new patches.",
    "created_at": "2012-12-31T17:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162945",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:18" align="right">comment:18</div>

Thanks.

I didn't know it was a more common occurrence with the patchbot. It looks like it doesn't clear the queue while applying new patches.



---

archive/issue_comments_162946.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n@kini - can you have a look at the patchbot? I think you are one of the few people who know how it works.",
    "created_at": "2012-12-31T17:43:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162946",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:19" align="right">comment:19</div>

@kini - can you have a look at the patchbot? I think you are one of the few people who know how it works.



---

archive/issue_comments_162947.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...",
    "created_at": "2012-12-31T18:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162947",
    "user": "https://github.com/kini"
}
```

<div id="comment:20" align="right">comment:20</div>

Hmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...



---

archive/issue_comments_162948.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@kini](#comment:20):\n> Hmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...\n\nDid it fail to apply? My guess is that is because #13503 was merged in `5.6.beta1`. I've formally added it as a dependency.",
    "created_at": "2013-01-01T05:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162948",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@kini](#comment:20):
> Hmm, I have no idea. I tried running my 5.6.beta0 patchbot on it but it failed even more strangely. Building 5.6.beta1 now to try that...

Did it fail to apply? My guess is that is because #13503 was merged in `5.6.beta1`. I've formally added it as a dependency.



---

archive/issue_comments_162949.json:
```json
{
    "body": "Changed dependencies from **#13723, #11763** to **#13723, #11763, #13503**",
    "created_at": "2013-01-01T05:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162949",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **#13723, #11763** to **#13723, #11763, #13503**



---

archive/issue_comments_162950.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nIt should apply fine to beta0, since it applies fine to beta1. Anyway, the patchbot seems to have caught up or kini did some miracle! :)",
    "created_at": "2013-01-01T10:40:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162950",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:22" align="right">comment:22</div>

It should apply fine to beta0, since it applies fine to beta1. Anyway, the patchbot seems to have caught up or kini did some miracle! :)



---

archive/issue_comments_162951.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI didn't do anything. Vanilla 5.6.beta1 doesn't even pass tests on my machine, and my patchbot failed to apply #11763 to beta0 for some reason. Volker's patchbot is the one that came along and gave this ticket a green light.",
    "created_at": "2013-01-01T19:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162951",
    "user": "https://github.com/kini"
}
```

<div id="comment:23" align="right">comment:23</div>

I didn't do anything. Vanilla 5.6.beta1 doesn't even pass tests on my machine, and my patchbot failed to apply #11763 to beta0 for some reason. Volker's patchbot is the one that came along and gave this ticket a green light.



---

archive/issue_events_193949.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-07T20:56:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193949"
}
```



---

archive/issue_events_193950.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-07T20:56:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13821#event-193950"
}
```



---

archive/issue_comments_162952.json:
```json
{
    "body": "Merged: **sage-5.6.beta3**",
    "created_at": "2013-01-07T20:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13821#issuecomment-162952",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.6.beta3**
