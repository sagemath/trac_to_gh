# Issue 13301: Implement linear time algorithm to detect path intersection

archive/issues_013129.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-lucaspastor"
    ],
    "body": "Path intersection can be detected in a fast way using the algorithm described\nin [BKP2011]. The algorithm is based on radix trees.\n\n[BKP2011] S. Brlek, M. Koskas, X. Proven\u00e7al. A linear time and space\nalgorithm for detecting path intersection in `Z^d`, Theorical Computer\nScience 412 (2011) 4841-4850:[http://dx.doi.org/10.1016/j.tcs.2011.04.019](http://dx.doi.org/10.1016/j.tcs.2011.04.019)\n\n\nCC:  @seblabbe\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13301_\n\n",
    "created_at": "2012-07-26T22:32:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement linear time algorithm to detect path intersection",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/13301",
    "user": "https://github.com/sagetrac-lucaspastor"
}
```
Path intersection can be detected in a fast way using the algorithm described
in [BKP2011]. The algorithm is based on radix trees.

[BKP2011] S. Brlek, M. Koskas, X. Proven√ßal. A linear time and space
algorithm for detecting path intersection in `Z^d`, Theorical Computer
Science 412 (2011) 4841-4850:[http://dx.doi.org/10.1016/j.tcs.2011.04.019](http://dx.doi.org/10.1016/j.tcs.2011.04.019)


CC:  @seblabbe

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/13301_





---

archive/issue_events_185507.json:
```json
{
    "actor": "https://github.com/sagetrac-lucaspastor",
    "created_at": "2012-07-26T22:32:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185507"
}
```



---

archive/issue_events_185508.json:
```json
{
    "actor": "https://github.com/sagetrac-lucaspastor",
    "created_at": "2012-07-26T22:32:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185508"
}
```



---

archive/issue_events_185509.json:
```json
{
    "actor": "https://github.com/sagetrac-lucaspastor",
    "created_at": "2012-07-26T22:32:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185509"
}
```



---

archive/issue_events_185510.json:
```json
{
    "actor": "https://github.com/sagetrac-lucaspastor",
    "created_at": "2012-07-26T22:32:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185510"
}
```



---

archive/issue_events_185511.json:
```json
{
    "actor": "https://github.com/sagetrac-lucaspastor",
    "created_at": "2012-07-26T22:32:01Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "subject": "https://github.com/sagetrac-lucaspastor",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185511"
}
```



---

archive/issue_comments_153780.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe fact that -1 % 2 returns -1 in sage library .pyx file is explained here :\n\nhttps://groups.google.com/forum/?fromgroups#!topic/sage-devel/GMfCUATUquQ",
    "created_at": "2012-07-27T02:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13301#issuecomment-153780",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:2" align="right">comment:2</div>

The fact that -1 % 2 returns -1 in sage library .pyx file is explained here :

https://groups.google.com/forum/?fromgroups#!topic/sage-devel/GMfCUATUquQ



---

archive/issue_comments_153781.json:
```json
{
    "body": "Attachment: **[self_intersection.patch.gz](https://github.com/sagemath/sage/files/ticket13301/self_intersection.patch.gz)**\n\nThe implementation's sage patch.",
    "created_at": "2012-08-07T23:28:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13301#issuecomment-153781",
    "user": "https://github.com/sagetrac-lucaspastor"
}
```

Attachment: **[self_intersection.patch.gz](https://github.com/sagemath/sage/files/ticket13301/self_intersection.patch.gz)**

The implementation's sage patch.



---

archive/issue_comments_153782.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAs of now, the node structure is:\n\n```\n#Node structure\ncdef struct Node:\n    int node_number\n    int node_id\n    Node* parent\n    Node** children\n    Node** neighbors\n    int* coords\n    int visited\n```\n\nI believe it could be simplified. For example, I believe `node_id` is unused by the important 4 functions. Also `node_number` and `visited` are used by distinct functions. So, they could be merged into one `int data` which could do both job.\n\nMoreover, I thought the coords were not necessary inside the node as we can find them from the data structure. Hence, a simplified node structure could be :\n\n```\n#Node structure\ncdef struct Node:\n    Node* parent\n    Node** children\n    Node** neighbors\n    int data\n```\n\nWhat do you think?",
    "created_at": "2012-08-30T16:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13301#issuecomment-153782",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:3" align="right">comment:3</div>

As of now, the node structure is:

```
#Node structure
cdef struct Node:
    int node_number
    int node_id
    Node* parent
    Node** children
    Node** neighbors
    int* coords
    int visited
```

I believe it could be simplified. For example, I believe `node_id` is unused by the important 4 functions. Also `node_number` and `visited` are used by distinct functions. So, they could be merged into one `int data` which could do both job.

Moreover, I thought the coords were not necessary inside the node as we can find them from the data structure. Hence, a simplified node structure could be :

```
#Node structure
cdef struct Node:
    Node* parent
    Node** children
    Node** neighbors
    int data
```

What do you think?



---

archive/issue_events_185512.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185512"
}
```



---

archive/issue_events_185513.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185513"
}
```



---

archive/issue_events_185514.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185514"
}
```



---

archive/issue_events_185515.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185515"
}
```



---

archive/issue_events_185516.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185516"
}
```



---

archive/issue_events_185517.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185517"
}
```



---

archive/issue_events_185518.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185518"
}
```



---

archive/issue_events_185519.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185519"
}
```



---

archive/issue_events_185520.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13301",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13301#event-185520"
}
```
