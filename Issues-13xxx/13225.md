# Issue 13225: Check if lattices are upper/lower-semimodular and modular

archive/issues_013053.json:
```json
{
    "body": "Add is_upper_semimodular, is_lower_semimodular and is_modular to FiniteLatticePoset class.\n\nChanges _meet and _join in the HasseDiagram class to lazy attributes, fixing the problem that meets and joins failed to be defined for the dual of a lattice.\n\nApply: [attachment:trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch]\n\nAssignee: sage-combinat\n\nKeywords: sd40\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Alex Csar, Kevin Dilks, Sangwook Kim\n\nMerged: sage-5.10.beta3\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13225\n\n",
    "closed_at": "2013-05-13T13:25:38Z",
    "created_at": "2012-07-10T23:37:08Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Check if lattices are upper/lower-semimodular and modular",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13225",
    "user": "https://trac.sagemath.org/admin/accounts/users/csar"
}
```
Add is_upper_semimodular, is_lower_semimodular and is_modular to FiniteLatticePoset class.

Changes _meet and _join in the HasseDiagram class to lazy attributes, fixing the problem that meets and joins failed to be defined for the dual of a lattice.

Apply: [attachment:trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch]

Assignee: sage-combinat

Keywords: sd40

Reviewer: Frédéric Chapoton

Author: Alex Csar, Kevin Dilks, Sangwook Kim

Merged: sage-5.10.beta3

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13225





---

archive/issue_comments_158258.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-13T19:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158258",
    "user": "https://trac.sagemath.org/admin/accounts/users/csar"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_158259.json:
```json
{
    "body": "<a id='comment:3'></a>apply trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar.patch",
    "created_at": "2012-11-05T12:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158259",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>apply trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar.patch



---

archive/issue_comments_158260.json:
```json
{
    "body": "<a id='comment:4'></a>Could you explain what you did in the hasse_diagram file ? What was the bug that you claim to correct ?",
    "created_at": "2012-12-18T20:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158260",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>Could you explain what you did in the hasse_diagram file ? What was the bug that you claim to correct ?



---

archive/issue_comments_158261.json:
```json
{
    "body": "<a id='comment:5'></a>The issue in hasse_diagram was that taking the dual of the lattice somehow created a situation where the dual poset would attempt to take a join, but joins wouldn't be defined. \n\nFor example, \n\n```\nL = LatticePoset({0:[1,2,3],1:[4],2:[4],3:[4]})\nP=L.dual()\nx=P.random_element()\ny=P.random_element()\nP.join(x,y)\n```\n\nproduces \n\n```\n/Applications/sage-5.3/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.pyc in join(self, x, y)\n    268         \"\"\"\n    269         i, j = map(self._element_to_vertex,(x,y))\n--> 270         return self._vertex_to_element(self._hasse_diagram._join[i,j])\n    271 \n    272 ####################################################################################\n\nAttributeError: 'HasseDiagram' object has no attribute '_join'\n```\n\nI must admit I no longer see why the code currently in sage fails to create ` _join ` when it's needed. (I realise I produced the example using 5.3, not 5.4. I don't have 5.4 to hand at the moment.)",
    "created_at": "2012-12-19T00:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158261",
    "user": "https://trac.sagemath.org/admin/accounts/users/csar"
}
```

<a id='comment:5'></a>The issue in hasse_diagram was that taking the dual of the lattice somehow created a situation where the dual poset would attempt to take a join, but joins wouldn't be defined. 

For example, 

```
L = LatticePoset({0:[1,2,3],1:[4],2:[4],3:[4]})
P=L.dual()
x=P.random_element()
y=P.random_element()
P.join(x,y)
```

produces 

```
/Applications/sage-5.3/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.pyc in join(self, x, y)
    268         """
    269         i, j = map(self._element_to_vertex,(x,y))
--> 270         return self._vertex_to_element(self._hasse_diagram._join[i,j])
    271 
    272 ####################################################################################

AttributeError: 'HasseDiagram' object has no attribute '_join'
```

I must admit I no longer see why the code currently in sage fails to create ` _join ` when it's needed. (I realise I produced the example using 5.3, not 5.4. I don't have 5.4 to hand at the moment.)



---

archive/issue_comments_158262.json:
```json
{
    "body": "<a id='comment:6'></a>Your example has the same behavior in 5.5.rc0.\n\nYou should add this example as a doctest, to check that this is no longer the case with the patch.",
    "created_at": "2012-12-19T19:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158262",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>Your example has the same behavior in 5.5.rc0.

You should add this example as a doctest, to check that this is no longer the case with the patch.



---

archive/issue_comments_158263.json:
```json
{
    "body": "<a id='comment:8'></a>here is a rebased patch on 5.9.beta0\n\nfor the bot:\n\napply trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch",
    "created_at": "2013-03-28T20:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158263",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>here is a rebased patch on 5.9.beta0

for the bot:

apply trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch



---

archive/issue_comments_158264.json:
```json
{
    "body": "<a id='comment:9'></a>One question :\n\nare the two lines\n\n```\nif q==r: \n    continue \n```\n(in the is_upper_semimodular method) really needed ?",
    "created_at": "2013-03-29T08:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158264",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>One question :

are the two lines

```
if q==r: 
    continue 
```
(in the is_upper_semimodular method) really needed ?



---

archive/issue_comments_158265.json:
```json
{
    "body": "<a id='comment:10'></a>Attachment [trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch](tarball://root/attachments/some-uuid/ticket13225/trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch) by @fchapoton created at 2013-05-09 18:34:09\n\nOk, here is a new patch, with small changes and more doc.\n\nIt seems to be good to go, but let us first wait for the bot report.\n\napply trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch",
    "created_at": "2013-05-09T18:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158265",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>Attachment [trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch](tarball://root/attachments/some-uuid/ticket13225/trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch) by @fchapoton created at 2013-05-09 18:34:09

Ok, here is a new patch, with small changes and more doc.

It seems to be good to go, but let us first wait for the bot report.

apply trac_13225-add_upper_lower_semimodular_and_modular_for_lattices-csar-v2.patch



---

archive/issue_comments_158266.json:
```json
{
    "body": "<a id='comment:11'></a>ok, positive review",
    "created_at": "2013-05-10T20:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158266",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>ok, positive review



---

archive/issue_comments_158267.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-05-10T20:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158267",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_158268.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-05-13T13:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13225#issuecomment-158268",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_036477.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-13T13:25:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13225",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13225#event-36477"
}
```
