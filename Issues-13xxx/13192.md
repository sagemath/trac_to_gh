# Issue 13192: some code clean up for sage/graphs/graph.py

archive/issues_013020.json:
```json
{
    "body": "The function compare_edges() of module 'sage.graphs.graph.py' is a simple comparison function used only in function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.\n\nSuggesting to replace it by a built-in function at the place where it was used.\n\nApply [attachment:trac_13192-cleanup-v3.patch] and [attachment:trac_13192_whitespace.patch].\n\n**Assignee:** @jasongrout, @nathanncohen, @rlmill\n\n**CC:**  @nathanncohen\n\n**Keywords:** sparse6_string\n\n**Reviewer:** Nathann Cohen, Karl-Dieter Crisman\n\n**Author:** Birk Eisermann\n\n**Merged:** sage-5.3.beta1\n\n**Dependencies:** #13109\n\nIssue created by migration from https://trac.sagemath.org/ticket/13192\n\n",
    "closed_at": "2012-08-12T19:01:01Z",
    "created_at": "2012-07-02T06:37:48Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "some code clean up for sage/graphs/graph.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13192",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```
The function compare_edges() of module 'sage.graphs.graph.py' is a simple comparison function used only in function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.

Suggesting to replace it by a built-in function at the place where it was used.

Apply [attachment:trac_13192-cleanup-v3.patch] and [attachment:trac_13192_whitespace.patch].

**Assignee:** @jasongrout, @nathanncohen, @rlmill

**CC:**  @nathanncohen

**Keywords:** sparse6_string

**Reviewer:** Nathann Cohen, Karl-Dieter Crisman

**Author:** Birk Eisermann

**Merged:** sage-5.3.beta1

**Dependencies:** #13109

Issue created by migration from https://trac.sagemath.org/ticket/13192





---

archive/issue_comments_187780.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-07-02T06:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187780",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_187781.json:
```json
{
    "body": "**Reviewer:** Nathann Cohen",
    "created_at": "2012-07-02T10:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187781",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Nathann Cohen



---

archive/issue_comments_187782.json:
```json
{
    "body": "<a id='comment:2'></a>\nDead right ! Good to go `:-)`\n\nNathann",
    "created_at": "2012-07-02T10:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187782",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>
Dead right ! Good to go `:-)`

Nathann



---

archive/issue_comments_187783.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-07-02T10:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187783",
    "user": "https://github.com/nathanncohen"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_187784.json:
```json
{
    "body": "**Author:** Birk Eisermann",
    "created_at": "2012-07-02T10:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187784",
    "user": "https://github.com/nathanncohen"
}
```

**Author:** Birk Eisermann



---

archive/issue_comments_187785.json:
```json
{
    "body": "<a id='comment:3'></a>\nI'm not sure the advantage of moving it to a local function and removing tests.",
    "created_at": "2012-07-02T10:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187785",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:3'></a>
I'm not sure the advantage of moving it to a local function and removing tests.



---

archive/issue_comments_187786.json:
```json
{
    "body": "**Changing status** from positive_review to needs_info.",
    "created_at": "2012-07-02T10:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187786",
    "user": "https://github.com/mwhansen"
}
```

**Changing status** from positive_review to needs_info.



---

archive/issue_comments_187787.json:
```json
{
    "body": "<a id='comment:4'></a>\nHmmm... Well. It's true that there are two tests, but that's more or less just for the show -- or rather because of the \"-coverage\" Sage flag `:-P`\n\nThe thing is that Birk noticed that its documentation was missing some information, and reading its code we noticed that the function would behave very badly if used of graphs whose vertices are something different from integers. We already had some problems of the kind with other codes that assumed vertices were totally ordered.\nSoooooooo as it looks like a custom function, made only to be called by the function above, and in order to prevent somebody from using it without knowing that it may be wrong sometimes.... It sounded better to move it inside of that function.\n\n... And to document its behaviour better, which Birk did `:-)`\n\nWhat do you think ?\n\nNathann",
    "created_at": "2012-07-02T10:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187787",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
Hmmm... Well. It's true that there are two tests, but that's more or less just for the show -- or rather because of the "-coverage" Sage flag `:-P`

The thing is that Birk noticed that its documentation was missing some information, and reading its code we noticed that the function would behave very badly if used of graphs whose vertices are something different from integers. We already had some problems of the kind with other codes that assumed vertices were totally ordered.
Soooooooo as it looks like a custom function, made only to be called by the function above, and in order to prevent somebody from using it without knowing that it may be wrong sometimes.... It sounded better to move it inside of that function.

... And to document its behaviour better, which Birk did `:-)`

What do you think ?

Nathann



---

archive/issue_comments_187788.json:
```json
{
    "body": "<a id='comment:5'></a>\nOkay, okay, - you are making me learn python... ;-)  I took some information from http://wiki.python.org/moin/HowTo/Sorting/\n\n\nHow about my following one liner? (included in recent patch)\n\n```\nedges.sort(key=lambda e: (e[1],e[0]))\n```\n\nThis needs Python version >= 2.4 . Is this dependency okay for sage?\n\n\nOtherwise, we could write\n\n```\nedges.sort(cmp=lambda e,f: cmp(e[1],f[1]) or cmp(e[0],f[0]))\n```\n\nwhich seems Python 3.x **incompatible** though not an issue yet.\n\nFor testing, I run\n\n```\nsage -c \"for g in graphs(8): print g.sparse6_string()\" > gr8-old.out\n```\nfor all three version (old, key-version, cmp-verison) and the output was the same.\n\n\nNow, how about giving up the 30 lines of compare_edges() with a good feeling?\n\nBirk",
    "created_at": "2012-07-02T13:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187788",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:5'></a>
Okay, okay, - you are making me learn python... ;-)  I took some information from http://wiki.python.org/moin/HowTo/Sorting/


How about my following one liner? (included in recent patch)

```
edges.sort(key=lambda e: (e[1],e[0]))
```

This needs Python version >= 2.4 . Is this dependency okay for sage?


Otherwise, we could write

```
edges.sort(cmp=lambda e,f: cmp(e[1],f[1]) or cmp(e[0],f[0]))
```

which seems Python 3.x **incompatible** though not an issue yet.

For testing, I run

```
sage -c "for g in graphs(8): print g.sparse6_string()" > gr8-old.out
```
for all three version (old, key-version, cmp-verison) and the output was the same.


Now, how about giving up the 30 lines of compare_edges() with a good feeling?

Birk



---

archive/issue_comments_187789.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2012-07-02T15:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187789",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_187790.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-The function compare_edges() of module 'sage.graphs.graph.py' is used only in one place, function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.\n+The function compare_edges() of module 'sage.graphs.graph.py' is a simple comparison function used only in function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.\n \n-Hence, suggesting to make it a local function at the place where it is used.\n+Suggesting to replace it by a built-in function at the place where it was used.\n``````\n",
    "created_at": "2012-07-02T15:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187790",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-The function compare_edges() of module 'sage.graphs.graph.py' is used only in one place, function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.
+The function compare_edges() of module 'sage.graphs.graph.py' is a simple comparison function used only in function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.
 
-Hence, suggesting to make it a local function at the place where it is used.
+Suggesting to replace it by a built-in function at the place where it was used.
``````




---

archive/issue_comments_187791.json:
```json
{
    "body": "<a id='comment:7'></a>\nI still agree with the patch.. Even more, actually. Mike ? `:-)`\n\nNathann",
    "created_at": "2012-07-02T15:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187791",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>
I still agree with the patch.. Even more, actually. Mike ? `:-)`

Nathann



---

archive/issue_comments_187792.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis is indeed better.  Sage uses Python 2.7 so 2.4 is no problem :)  And it looks like the edges in question will already have integer labels at this point in the code, right? Nathann, I think this should be ok now.  There is the deprecation period issue, but I'm assuming that you are vouching that this function had no actual graph-theoretic use, correct?  I suppose you could do the deprecation thing to cover all bases.  But this is a better solution in any case. \n\nI'm wondering about the whitespace changes - could give problems with conflicts with other patches.  You really only need two hunks here.",
    "created_at": "2012-07-07T02:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187792",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
This is indeed better.  Sage uses Python 2.7 so 2.4 is no problem :)  And it looks like the edges in question will already have integer labels at this point in the code, right? Nathann, I think this should be ok now.  There is the deprecation period issue, but I'm assuming that you are vouching that this function had no actual graph-theoretic use, correct?  I suppose you could do the deprecation thing to cover all bases.  But this is a better solution in any case. 

I'm wondering about the whitespace changes - could give problems with conflicts with other patches.  You really only need two hunks here.



---

archive/issue_comments_187793.json:
```json
{
    "body": "<a id='comment:9'></a>\nOkay, will update... Is removal of trailing space within the *modified* function a problem assuming noone else is working on that function?\n\nBirk",
    "created_at": "2012-07-09T02:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187793",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:9'></a>
Okay, will update... Is removal of trailing space within the *modified* function a problem assuming noone else is working on that function?

Birk



---

archive/issue_comments_187794.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2012-07-09T02:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187794",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_187795.json:
```json
{
    "body": "<a id='comment:10'></a>\nNo, removing whitespace right nearby isn't really a problem, but sometimes people *are* working on the same function (especially if it's a large one, like `plot` or something, so it's best to keep it relatively minimal.  In this case, for instance, I could imagine someone working on fixing a type in the doc (say) where you removed whitespace, and then this might conflict.\n\nBy the way, your commit message is good but maybe you could remove the `mq` part.",
    "created_at": "2012-07-09T13:45:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187795",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
No, removing whitespace right nearby isn't really a problem, but sometimes people *are* working on the same function (especially if it's a large one, like `plot` or something, so it's best to keep it relatively minimal.  In this case, for instance, I could imagine someone working on fixing a type in the doc (say) where you removed whitespace, and then this might conflict.

By the way, your commit message is good but maybe you could remove the `mq` part.



---

archive/issue_comments_187796.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2012-07-10T07:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187796",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_187797.json:
```json
{
    "body": "**Dependencies:** #13109",
    "created_at": "2012-07-10T07:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187797",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Dependencies:** #13109



---

archive/issue_comments_187798.json:
```json
{
    "body": "<a id='comment:11'></a>\nOkay! I reduced the whitespace changes and added a \"new style\" deprecation warning in case anyone would use this simple yet quite specific function. (I have not removed the old function. Hope it was meant like that...)",
    "created_at": "2012-07-10T07:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187798",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:11'></a>
Okay! I reduced the whitespace changes and added a "new style" deprecation warning in case anyone would use this simple yet quite specific function. (I have not removed the old function. Hope it was meant like that...)



---

archive/issue_comments_187799.json:
```json
{
    "body": "<a id='comment:12'></a>\nUpdated because of an doctest error...",
    "created_at": "2012-07-19T09:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187799",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:12'></a>
Updated because of an doctest error...



---

archive/issue_comments_187800.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2012-07-20T16:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187800",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_187801.json:
```json
{
    "body": "**Changing reviewer** from \"Nathann Cohen\" to \"Nathann Cohen, Karl-Dieter Crisman\".",
    "created_at": "2012-07-20T16:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187801",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Nathann Cohen" to "Nathann Cohen, Karl-Dieter Crisman".



---

archive/issue_comments_187802.json:
```json
{
    "body": "<a id='comment:13'></a>\nYour update apparently added a lot of whitespace changes again.  Also, what was the doctest error?   Did you change the code at all?\n\nI think generally in doctests we go with \n\n```\ndoctest:...: DeprecationWarning: compare\n```\ninstead of \n\n```\ndoctest:1: DeprecationWarning: compare\n```\nin case things were to go in a different order.  At any rate, that's what I've seen.\n\nAlso, even if you aren't removing the function, presumably it was still testing something useful.  Would it be possible to add a graph like the kind Nathann suggests (with non-integer vertices) that shows that this new code is properly comparing, as well as showing it properly compares the edges tested before?  I agree that it's good (or at least I said I did above!), just that we want to have documentation.\n\nBasically, what you could do is move the tests in the old function to the tests for the actual meaningful function, and then leave only a very minimal doctest in the old function that states that this is deprecated in the docstring, and has *one* test exactly to test the deprecation warning.\n\nSorry that this is more work, but I think it's good as a model for others as well.",
    "created_at": "2012-07-20T16:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187802",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>
Your update apparently added a lot of whitespace changes again.  Also, what was the doctest error?   Did you change the code at all?

I think generally in doctests we go with 

```
doctest:...: DeprecationWarning: compare
```
instead of 

```
doctest:1: DeprecationWarning: compare
```
in case things were to go in a different order.  At any rate, that's what I've seen.

Also, even if you aren't removing the function, presumably it was still testing something useful.  Would it be possible to add a graph like the kind Nathann suggests (with non-integer vertices) that shows that this new code is properly comparing, as well as showing it properly compares the edges tested before?  I agree that it's good (or at least I said I did above!), just that we want to have documentation.

Basically, what you could do is move the tests in the old function to the tests for the actual meaningful function, and then leave only a very minimal doctest in the old function that states that this is deprecated in the docstring, and has *one* test exactly to test the deprecation warning.

Sorry that this is more work, but I think it's good as a model for others as well.



---

archive/attachments_017822.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13192_cleanup.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13192/trac_13192_cleanup.patch",
    "created_at": "2012-07-23T11:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```



---

archive/issue_comments_187803.json:
```json
{
    "body": "",
    "created_at": "2012-07-23T11:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187803",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```





---

archive/issue_comments_187804.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2012-07-23T11:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187804",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Changing status** from needs_work to needs_review.



---

archive/attachments_017823.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13192_whitespace.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13192/trac_13192_whitespace.patch",
    "created_at": "2012-07-23T11:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```



---

archive/issue_comments_187805.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [kcrisman](#comment%3A13):\n> Your update apparently added a lot of whitespace changes again.\n\nMy last update did *not* touch the whitespaces. In a previous update I reduced the number of changed lines from 10 to 6 lines. These trailing whitespace changes are only within the documentation of the method `sparse6_string`, which does not seem to be modified for years(?, ...according to my search on sage-trac). It reads like removing trailing whitespace is forbidden. Hence, I have moved all these changes into a separate file and you are at liberty to exclude or include them - no question asked! ;-)\n\n> Also, what was the doctest error?   Did you change the code at all?\n\nAm I lying? - joke - Okay, the change was small! It added exactly the line on that you were commenting. When (restoring and) deprecating the old function I did not think about that the deprecation will affect all doctests where this functions is called. (In my case luckily only one place - the doctest of the deprecated function.)\n\n> I think generally in doctests we go with \n> \n> ```\n> doctest:...: DeprecationWarning: compare\n> ```\n> instead of \n> \n> ```\n> doctest:1: DeprecationWarning: compare\n> ```\n> in case things were to go in a different order.  At any rate, that's what I've seen.\n\n>\nUnfortunately, my first discovery was \"doctest:1:\" (and there are a few such places in the source code) and I copied that. - Now it is changed.\n\n> Also, even if you aren't removing the function, presumably it was still testing something useful.  Would it be possible to add a graph like the kind Nathann suggests (with non-integer vertices) that shows that this new code is properly comparing, as well as showing it properly compares the edges tested before?  I agree that it's good (or at least I said I did above!), just that we want to have documentation.\n\n\nThe change was about sorting graph edges. Thus, I added some doctests that sort the edges once by the old method and once by the new method and compare the results. As suggested I put these doctests in the deprecated function.\n\n> Basically, what you could do is move the tests in the old function to the tests for the actual meaningful function, and then leave only a very minimal doctest in the old function that states that this is deprecated in the docstring, and has *one* test exactly to test the deprecation warning.\n\n\nI reduced the old doctests to just one. It will save a few millionths of a second for doctesting ;-) Well, in this case there was not much doctesting to remove...\n\nBirk",
    "created_at": "2012-07-23T11:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187805",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:14'></a>
Replying to [kcrisman](#comment%3A13):
> Your update apparently added a lot of whitespace changes again.

My last update did *not* touch the whitespaces. In a previous update I reduced the number of changed lines from 10 to 6 lines. These trailing whitespace changes are only within the documentation of the method `sparse6_string`, which does not seem to be modified for years(?, ...according to my search on sage-trac). It reads like removing trailing whitespace is forbidden. Hence, I have moved all these changes into a separate file and you are at liberty to exclude or include them - no question asked! ;-)

> Also, what was the doctest error?   Did you change the code at all?

Am I lying? - joke - Okay, the change was small! It added exactly the line on that you were commenting. When (restoring and) deprecating the old function I did not think about that the deprecation will affect all doctests where this functions is called. (In my case luckily only one place - the doctest of the deprecated function.)

> I think generally in doctests we go with 
> 
> ```
> doctest:...: DeprecationWarning: compare
> ```
> instead of 
> 
> ```
> doctest:1: DeprecationWarning: compare
> ```
> in case things were to go in a different order.  At any rate, that's what I've seen.

>
Unfortunately, my first discovery was "doctest:1:" (and there are a few such places in the source code) and I copied that. - Now it is changed.

> Also, even if you aren't removing the function, presumably it was still testing something useful.  Would it be possible to add a graph like the kind Nathann suggests (with non-integer vertices) that shows that this new code is properly comparing, as well as showing it properly compares the edges tested before?  I agree that it's good (or at least I said I did above!), just that we want to have documentation.


The change was about sorting graph edges. Thus, I added some doctests that sort the edges once by the old method and once by the new method and compare the results. As suggested I put these doctests in the deprecated function.

> Basically, what you could do is move the tests in the old function to the tests for the actual meaningful function, and then leave only a very minimal doctest in the old function that states that this is deprecated in the docstring, and has *one* test exactly to test the deprecation warning.


I reduced the old doctests to just one. It will save a few millionths of a second for doctesting ;-) Well, in this case there was not much doctesting to remove...

Birk



---

archive/issue_comments_187806.json:
```json
{
    "body": "<a id='comment:15'></a>\nSorry, I wasn't meaning to be too picky.  I was just trying to avoid craziness.  I thought maybe your error in doctests was due to the `doctest:1:`, so that is why I harped on it, same with the whitespace, since it seemed to be in an unrelated place.\n\nAnyway, my main point with the testing wasn't to show that it was the same as before (though at least one non-trivial example would be nice), but rather to test the thing *you yourself* (I though it was Nathann) first noted in the description :-) \n\n```\nit works only on graphs whose vertices can be compared with the < operator, e.g. integers\n```\nSo I figured that at least one graph that was not properly representable/represented/could have been bad in the `sparse_6string` format before should be shown to operate properly now.  And that should be in the `sparse_6string` documentation.\n\nI don't think you need to include a million examples in the other doctest, though.  My concern was that whatever the sorting was *for* in normal graphs needed to be tested, and perhaps that is already done elsewhere.  I'm not familiar enough with that format to know why they have to be sorted that way.  Besides, once the function was removed, the tests in the deprecated function would disappear anyway.",
    "created_at": "2012-07-23T14:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187806",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>
Sorry, I wasn't meaning to be too picky.  I was just trying to avoid craziness.  I thought maybe your error in doctests was due to the `doctest:1:`, so that is why I harped on it, same with the whitespace, since it seemed to be in an unrelated place.

Anyway, my main point with the testing wasn't to show that it was the same as before (though at least one non-trivial example would be nice), but rather to test the thing *you yourself* (I though it was Nathann) first noted in the description :-) 

```
it works only on graphs whose vertices can be compared with the < operator, e.g. integers
```
So I figured that at least one graph that was not properly representable/represented/could have been bad in the `sparse_6string` format before should be shown to operate properly now.  And that should be in the `sparse_6string` documentation.

I don't think you need to include a million examples in the other doctest, though.  My concern was that whatever the sorting was *for* in normal graphs needed to be tested, and perhaps that is already done elsewhere.  I'm not familiar enough with that format to know why they have to be sorted that way.  Besides, once the function was removed, the tests in the deprecated function would disappear anyway.



---

archive/issue_comments_187807.json:
```json
{
    "body": "<a id='comment:16'></a>\nOkay, I think I got the meaning. First, there was nothing really wrong before. The quote does not refer to sparse6_string. It refers to compare_edges which can only be apply to graph edges whose vertices are comparable with \"<\". It has always been possible to use sparse6_string with *any* graph (since vertices are map to integers before sorting). So actually everything has already been tested.\n\nIn the sparse6 format (see http://cs.anu.edu.au/~bdm/data/formats.txt) to write a graph with vertices {0,1,...,k} the edges are traversed in the following order (and that is why they need to be sorted):\n\n(0,1),\n\n(0,2),(1,2),\n\n...,\n\n(0,k), (1,k), ..., (k-1,k).\n\nAny comments?",
    "created_at": "2012-07-27T11:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187807",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:16'></a>
Okay, I think I got the meaning. First, there was nothing really wrong before. The quote does not refer to sparse6_string. It refers to compare_edges which can only be apply to graph edges whose vertices are comparable with "<". It has always been possible to use sparse6_string with *any* graph (since vertices are map to integers before sorting). So actually everything has already been tested.

In the sparse6 format (see http://cs.anu.edu.au/~bdm/data/formats.txt) to write a graph with vertices {0,1,...,k} the edges are traversed in the following order (and that is why they need to be sorted):

(0,1),

(0,2),(1,2),

...,

(0,k), (1,k), ..., (k-1,k).

Any comments?



---

archive/issue_comments_187808.json:
```json
{
    "body": "<a id='comment:17'></a>\nOh, so you are saying that even with graphs with non-integer (say matrix) edges, there never was a problem?  Only with the silly method itself... I see.  Nathann's comment about \"other codes\" misled me.\n\nOkay, then this is all a little overkill and I apologize. Now that you've written the deprecation, might as well keep it, but the last thing graph.py needs is lots of long tests, so just remove those tests; I think we've already more than verified here that the results are the same.\n\nI'm attaching a different version.  If you like it, I think this should be ok to go.",
    "created_at": "2012-07-27T15:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187808",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:17'></a>
Oh, so you are saying that even with graphs with non-integer (say matrix) edges, there never was a problem?  Only with the silly method itself... I see.  Nathann's comment about "other codes" misled me.

Okay, then this is all a little overkill and I apologize. Now that you've written the deprecation, might as well keep it, but the last thing graph.py needs is lots of long tests, so just remove those tests; I think we've already more than verified here that the results are the same.

I'm attaching a different version.  If you like it, I think this should be ok to go.



---

archive/attachments_017824.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13192-cleanup-v2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13192/trac_13192-cleanup-v2.patch",
    "created_at": "2012-07-27T15:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_187809.json:
```json
{
    "body": "",
    "created_at": "2012-07-27T15:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187809",
    "user": "https://github.com/kcrisman"
}
```





---

archive/issue_comments_187810.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-07-27T15:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187810",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_187811.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The function compare_edges() of module 'sage.graphs.graph.py' is a simple comparison function used only in function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.\n \n Suggesting to replace it by a built-in function at the place where it was used.\n+\n+Apply [attachment:trac_13192-cleanup-v2.patch] and [attachment:trac_13192_whitespace.patch].\n``````\n",
    "created_at": "2012-07-27T15:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187811",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The function compare_edges() of module 'sage.graphs.graph.py' is a simple comparison function used only in function sparse6_string(), and it works only on graphs whose vertices can be compared with the < operator, e.g. integers. Furthermore, the documentation is incomplete.
 
 Suggesting to replace it by a built-in function at the place where it was used.
+
+Apply [attachment:trac_13192-cleanup-v2.patch] and [attachment:trac_13192_whitespace.patch].
``````




---

archive/issue_comments_187812.json:
```json
{
    "body": "<a id='comment:18'></a>\nJust change the status if you have a problem with this, or if the patchbot complains.  I qrefreshed the patch to v2.  Presumably the whitespace still applies.\n\nPatchbot, apply [attachment:trac_13192-cleanup-v2.patch] and [attachment:trac_13192_whitespace.patch].",
    "created_at": "2012-07-27T15:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187812",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>
Just change the status if you have a problem with this, or if the patchbot complains.  I qrefreshed the patch to v2.  Presumably the whitespace still applies.

Patchbot, apply [attachment:trac_13192-cleanup-v2.patch] and [attachment:trac_13192_whitespace.patch].



---

archive/issue_events_042624.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-27T20:07:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "milestone": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13192#event-42624"
}
```



---

archive/issue_comments_187813.json:
```json
{
    "body": "<a id='comment:20'></a>\npatchbot: apply trac_13192-cleanup-v2.patch trac_13192_whitespace.patch",
    "created_at": "2012-07-30T06:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187813",
    "user": "https://github.com/kini"
}
```

<a id='comment:20'></a>
patchbot: apply trac_13192-cleanup-v2.patch trac_13192_whitespace.patch



---

archive/issue_comments_187814.json:
```json
{
    "body": "<a id='comment:21'></a>\nkcrisman: the patchbot can't read the patch filenames when you link them to the actual attachments, which is why I made the comment just before this one.",
    "created_at": "2012-07-30T06:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187814",
    "user": "https://github.com/kini"
}
```

<a id='comment:21'></a>
kcrisman: the patchbot can't read the patch filenames when you link them to the actual attachments, which is why I made the comment just before this one.



---

archive/issue_comments_187815.json:
```json
{
    "body": "<a id='comment:22'></a>\nThanks. Patches are fine.\n(And thanks, Keshav, for helping that patchbot reads only plain text.)",
    "created_at": "2012-07-30T06:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187815",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:22'></a>
Thanks. Patches are fine.
(And thanks, Keshav, for helping that patchbot reads only plain text.)



---

archive/issue_comments_187816.json:
```json
{
    "body": "<a id='comment:23'></a>\nThe patches don't seem to apply to 5.2.rc1 (see the patchbot results).",
    "created_at": "2012-07-30T06:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187816",
    "user": "https://github.com/kini"
}
```

<a id='comment:23'></a>
The patches don't seem to apply to 5.2.rc1 (see the patchbot results).



---

archive/attachments_017825.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13192-cleanup-v3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13192/trac_13192-cleanup-v3.patch",
    "created_at": "2012-07-30T07:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```



---

archive/issue_comments_187817.json:
```json
{
    "body": "<a id='comment:24'></a>\nLet's try this one......\n\npatchbot: apply trac_13192-cleanup-v3.patch trac_13192_whitespace.patch",
    "created_at": "2012-07-30T07:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187817",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

<a id='comment:24'></a>
Let's try this one......

patchbot: apply trac_13192-cleanup-v3.patch trac_13192_whitespace.patch



---

archive/issue_comments_187818.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Suggesting to replace it by a built-in function at the place where it was used.\n \n-Apply [attachment:trac_13192-cleanup-v2.patch] and [attachment:trac_13192_whitespace.patch].\n+Apply [attachment:trac_13192-cleanup-v3.patch] and [attachment:trac_13192_whitespace.patch].\n``````\n",
    "created_at": "2012-07-30T07:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187818",
    "user": "https://trac.sagemath.org/admin/accounts/users/eisermbi"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Suggesting to replace it by a built-in function at the place where it was used.
 
-Apply [attachment:trac_13192-cleanup-v2.patch] and [attachment:trac_13192_whitespace.patch].
+Apply [attachment:trac_13192-cleanup-v3.patch] and [attachment:trac_13192_whitespace.patch].
``````




---

archive/issue_events_042625.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-12T19:01:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13192#event-42625"
}
```



---

archive/issue_comments_187819.json:
```json
{
    "body": "**Merged:** sage-5.3.beta1",
    "created_at": "2012-08-12T19:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13192#issuecomment-187819",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.3.beta1
