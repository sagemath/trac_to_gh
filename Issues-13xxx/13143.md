# Issue 13143: Use MathJax by default when building docs from Makefile

archive/issues_012971.json:
```json
{
    "body": "At the moment, running `make` runs `make doc`, which in turn runs `make doc-html`. This runs Sphinx without the `-j` option, so MathJax (or jsMath, pre #9774) is not used: png image files are used instead. Using png images is much slower, so we should use MathJax (or jsMath) by default.\n\nTiming and disk space information:\n\nTutorial without MathJax: \n\n```\n$ rm -rf devel/sage/doc/output\n$ time sage --docbuild tutorial html\n...\nreal 2m17.950s\nuser 1m29.441s\nsys 0m15.478s\n$ du -s -h devel/sage/doc/output\n3.9M output/\n```\nWith MathJax:\n\n```\n$ rm -rf devel/sage/doc/output\n$ time sage --docbuild tutorial html -j\n...\nreal 0m9.871s\nuser 0m6.530s\nsys 0m1.739s\n$ du -s -h devel/sage/doc/output\n 8.5M output/\n```\nWhen building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). \n\n---\n\n- Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.\n- Apply [and [attachment:trac_13143-pictures.patch](https://github.com/sagemath/sage/files/ticket13143/0535acad0f66ffe476498de0f17f9a48.patch](https://github.com/sagemath/sage/files/ticket13143/0081ade1c1a4778159c80669473a7e18.patch)) to the Sage library.\n\nThis change was discussed [on sage-devel](https://groups.google.com/d/topic/sage-devel/eHPVwaaqWSA/discussion).\n\nDepends on #9774\n\nDepends on #13121\n\n**Assignee:** GeorgSWeber\n\n**CC:**  @nthiery\n\n**Keywords:** Makefile doc MathJax sd40\n\n**Reviewer:** Dmitrii Pasechnik\n\n**Author:** John Palmieri\n\n**Merged:** sage-5.5.beta2\n\nIssue created by migration from https://trac.sagemath.org/ticket/13143\n\n",
    "closed_at": "2012-11-01T12:47:11Z",
    "created_at": "2012-06-20T18:27:05Z",
    "labels": [
        "component: build",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.5",
    "title": "Use MathJax by default when building docs from Makefile",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13143",
    "user": "https://github.com/jhpalmieri"
}
```
At the moment, running `make` runs `make doc`, which in turn runs `make doc-html`. This runs Sphinx without the `-j` option, so MathJax (or jsMath, pre #9774) is not used: png image files are used instead. Using png images is much slower, so we should use MathJax (or jsMath) by default.

Timing and disk space information:

Tutorial without MathJax: 

```
$ rm -rf devel/sage/doc/output
$ time sage --docbuild tutorial html
...
real 2m17.950s
user 1m29.441s
sys 0m15.478s
$ du -s -h devel/sage/doc/output
3.9M output/
```
With MathJax:

```
$ rm -rf devel/sage/doc/output
$ time sage --docbuild tutorial html -j
...
real 0m9.871s
user 0m6.530s
sys 0m1.739s
$ du -s -h devel/sage/doc/output
 8.5M output/
```
When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). 

---

- Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.
- Apply [and [attachment:trac_13143-pictures.patch](https://github.com/sagemath/sage/files/ticket13143/0535acad0f66ffe476498de0f17f9a48.patch](https://github.com/sagemath/sage/files/ticket13143/0081ade1c1a4778159c80669473a7e18.patch)) to the Sage library.

This change was discussed [on sage-devel](https://groups.google.com/d/topic/sage-devel/eHPVwaaqWSA/discussion).

Depends on #9774

Depends on #13121

**Assignee:** GeorgSWeber

**CC:**  @nthiery

**Keywords:** Makefile doc MathJax sd40

**Reviewer:** Dmitrii Pasechnik

**Author:** John Palmieri

**Merged:** sage-5.5.beta2

Issue created by migration from https://trac.sagemath.org/ticket/13143





---

archive/issue_comments_152797.json:
```json
{
    "body": "root repo",
    "created_at": "2012-06-20T18:27:41Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152797",
    "user": "https://github.com/jhpalmieri"
}
```

root repo



---

archive/issue_events_110808.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-06-20T18:28:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110808"
}
```



---

archive/attachments_018388.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13143-use-mathjax.patch",
    "asset_url": "tarball://root/attachments/ticket13143/trac_13143-use-mathjax.patch",
    "created_at": "2012-06-20T18:28:05Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13143/trac_13143-use-mathjax.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_152798.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Attachment:** [trac_13143-use-mathjax.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-use-mathjax.patch)",
    "created_at": "2012-06-20T18:28:05Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152798",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
**Attachment:** [trac_13143-use-mathjax.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-use-mathjax.patch)



---

archive/issue_comments_152799.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -26,5 +26,5 @@\n $ du -s -h devel/sage/doc/output\n  8.5M\toutput/\n ```\n-When building all of the documentation, the disk space goes from about 320 M (without MathJax) to about 465M (with). \n+When building all of the documentation, the disk space goes from about 320M (without MathJax) to about 465M (with). \n \n``````\n",
    "created_at": "2012-06-20T18:28:32Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152799",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -26,5 +26,5 @@
 $ du -s -h devel/sage/doc/output
  8.5M	output/
 ```
-When building all of the documentation, the disk space goes from about 320 M (without MathJax) to about 465M (with). 
+When building all of the documentation, the disk space goes from about 320M (without MathJax) to about 465M (with). 
 
``````




---

archive/issue_comments_152800.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-At the moment, running `make` runs `make doc`, which in turn runs `make doc-html`. This runs Sphinx without the `-j` option, so MathJax (or jsMath, pre #9774) is not used: png image files are used instead. Using png images is much slower (although takes less disk space), so we should use MathJax (or jsMath) by default.\n+At the moment, running `make` runs `make doc`, which in turn runs `make doc-html`. This runs Sphinx without the `-j` option, so MathJax (or jsMath, pre #9774) is not used: png image files are used instead. Using png images is much slower, so we should use MathJax (or jsMath) by default.\n \n Timing and disk space information:\n \n@@ -26,5 +26,5 @@\n $ du -s -h devel/sage/doc/output\n  8.5M\toutput/\n ```\n-When building all of the documentation, the disk space goes from about 320M (without MathJax) to about 465M (with). \n+When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). \n \n``````\n",
    "created_at": "2012-06-20T20:59:13Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152800",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-At the moment, running `make` runs `make doc`, which in turn runs `make doc-html`. This runs Sphinx without the `-j` option, so MathJax (or jsMath, pre #9774) is not used: png image files are used instead. Using png images is much slower (although takes less disk space), so we should use MathJax (or jsMath) by default.
+At the moment, running `make` runs `make doc`, which in turn runs `make doc-html`. This runs Sphinx without the `-j` option, so MathJax (or jsMath, pre #9774) is not used: png image files are used instead. Using png images is much slower, so we should use MathJax (or jsMath) by default.
 
 Timing and disk space information:
 
@@ -26,5 +26,5 @@
 $ du -s -h devel/sage/doc/output
  8.5M	output/
 ```
-When building all of the documentation, the disk space goes from about 320M (without MathJax) to about 465M (with). 
+When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). 
 
``````




---

archive/issue_comments_152801.json:
```json
{
    "body": "<a id='comment:4'></a>\nHere's a question.  I've noticed that sometimes looking at MathJax stuff when I'm not on the internet is less than great.  What is the story then?\n\nBut this certainly looks right.\n\nMaybe something should then also be added to the developer or installation guide (wherever the make options are documented other than in the Makefile) that points out how *not* to use MathJax in a build.   Like to do `make build doc-html` or whatever the correct syntax would be.",
    "created_at": "2012-07-05T16:39:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152801",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Here's a question.  I've noticed that sometimes looking at MathJax stuff when I'm not on the internet is less than great.  What is the story then?

But this certainly looks right.

Maybe something should then also be added to the developer or installation guide (wherever the make options are documented other than in the Makefile) that points out how *not* to use MathJax in a build.   Like to do `make build doc-html` or whatever the correct syntax would be.



---

archive/issue_comments_152802.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -28,3 +28,7 @@\n ```\n When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). \n \n+---\n+\n+- Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.\n+- Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.\n``````\n",
    "created_at": "2012-07-09T20:21:10Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152802",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -28,3 +28,7 @@
 ```
 When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). 
 
+---
+
+- Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.
+- Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.
``````




---

archive/issue_comments_152803.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe \"v2\" patches do the following: \n\n- turn MathJax on by default, by modifying the script sage-env and by modifying how the variable's value is checked in the doc building files\n- pass the \"no-pdf-links\" option only when building the website document, so its presence (or lack) on the command-line doesn't cause the reference manual to be rebuilt.",
    "created_at": "2012-07-09T22:19:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152803",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
The "v2" patches do the following: 

- turn MathJax on by default, by modifying the script sage-env and by modifying how the variable's value is checked in the doc building files
- pass the "no-pdf-links" option only when building the website document, so its presence (or lack) on the command-line doesn't cause the reference manual to be rebuilt.



---

archive/issue_comments_152804.json:
```json
{
    "body": "<a id='comment:7'></a>\nIn response to Karl-Dieter's comment, I've added some documentation, to the \"environment variables\" section of the installation guide.",
    "created_at": "2012-07-10T03:41:47Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152804",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
In response to Karl-Dieter's comment, I've added some documentation, to the "environment variables" section of the installation guide.



---

archive/issue_comments_152805.json:
```json
{
    "body": "<a id='comment:8'></a>\nOk, this is more minimalist than I would like (i.e., have all the make targets documented somewhere) but I think it's appropriate for this ticket.  I'm sorry that I don't have time to give this full review, though again it seems ok.",
    "created_at": "2012-07-10T03:49:10Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152805",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
Ok, this is more minimalist than I would like (i.e., have all the make targets documented somewhere) but I think it's appropriate for this ticket.  I'm sorry that I don't have time to give this full review, though again it seems ok.



---

archive/issue_comments_152806.json:
```json
{
    "body": "<a id='comment:9'></a>\nSee #13219 for documentation of the make targets.",
    "created_at": "2012-07-10T04:50:47Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152806",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
See #13219 for documentation of the make targets.



---

archive/issue_comments_152807.json:
```json
{
    "body": "**Changing dependencies** from \"#9774\" to \"#9774, #13121\".",
    "created_at": "2012-07-10T04:52:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152807",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing dependencies** from "#9774" to "#9774, #13121".



---

archive/issue_comments_152808.json:
```json
{
    "body": "**Changing keywords** from \"Makefile doc MathJax\" to \"Makefile doc MathJax sd40\".",
    "created_at": "2012-07-10T12:45:04Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152808",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing keywords** from "Makefile doc MathJax" to "Makefile doc MathJax sd40".



---

archive/issue_comments_152809.json:
```json
{
    "body": "<a id='comment:12'></a>\nI had a problem with Latex creating thousands of errors on CentOS 4.7 (an old version of Linux, which I need to run for some commercial software). See discussion at:\n\nhttp://groups.google.com/forum/?fromgroups#!topic/sage-devel/7erAQRbHYUU\n\nAt John Palmieri's suggestion, I run:\n\n```\n$ rm -rf SAGE_ROOT/devel/sage/doc/output\n$ sage --docbuild all html -j\n```\n\nand the documentation built OK, with no errors. \n\n\nDave",
    "created_at": "2012-07-24T20:33:59Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152809",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:12'></a>
I had a problem with Latex creating thousands of errors on CentOS 4.7 (an old version of Linux, which I need to run for some commercial software). See discussion at:

http://groups.google.com/forum/?fromgroups#!topic/sage-devel/7erAQRbHYUU

At John Palmieri's suggestion, I run:

```
$ rm -rf SAGE_ROOT/devel/sage/doc/output
$ sage --docbuild all html -j
```

and the documentation built OK, with no errors. 


Dave



---

archive/issue_comments_152810.json:
```json
{
    "body": "**Changing dependencies** from \"#9774, #13121\" to \"#9774, #13121, #6495\".",
    "created_at": "2012-09-11T21:58:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152810",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing dependencies** from "#9774, #13121" to "#9774, #13121, #6495".



---

archive/issue_comments_152811.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -32,3 +32,5 @@\n \n - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.\n - Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.\n+\n+This has #6495 as a dependency, although that isn't necessary. The Sage library patch here could easily be rebased to avoid that dependency.\n``````\n",
    "created_at": "2012-09-11T22:03:26Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152811",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -32,3 +32,5 @@
 
 - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.
 - Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.
+
+This has #6495 as a dependency, although that isn't necessary. The Sage library patch here could easily be rebased to avoid that dependency.
``````




---

archive/issue_comments_152812.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,4 +33,3 @@\n - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.\n - Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.\n \n-This has #6495 as a dependency, although that isn't necessary. The Sage library patch here could easily be rebased to avoid that dependency.\n``````\n",
    "created_at": "2012-10-01T15:46:40Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152812",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,4 +33,3 @@
 - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.
 - Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.
 
-This has #6495 as a dependency, although that isn't necessary. The Sage library patch here could easily be rebased to avoid that dependency.
``````




---

archive/issue_comments_152813.json:
```json
{
    "body": "**Changing dependencies** from \"#9774, #13121, #6495\" to \"#9774, #13121\".",
    "created_at": "2012-10-01T15:46:40Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152813",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing dependencies** from "#9774, #13121, #6495" to "#9774, #13121".



---

archive/issue_comments_152814.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -33,3 +33,4 @@\n - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.\n - Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.\n \n+This change was discussed [on sage-devel](https://groups.google.com/d/topic/sage-devel/eHPVwaaqWSA/discussion).\n``````\n",
    "created_at": "2012-10-01T18:48:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152814",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -33,3 +33,4 @@
 - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.
 - Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.
 
+This change was discussed [on sage-devel](https://groups.google.com/d/topic/sage-devel/eHPVwaaqWSA/discussion).
``````




---

archive/issue_comments_152815.json:
```json
{
    "body": "root repo",
    "created_at": "2012-10-01T20:35:28Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152815",
    "user": "https://github.com/jhpalmieri"
}
```

root repo



---

archive/attachments_018389.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13143-root.v2.patch",
    "asset_url": "tarball://root/attachments/ticket13143/trac_13143-root.v2.patch",
    "created_at": "2012-10-01T20:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/attachments_018390.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13143-sage.v2.patch",
    "asset_url": "tarball://root/attachments/ticket13143/trac_13143-sage.v2.patch",
    "created_at": "2012-10-01T20:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_152816.json:
```json
{
    "body": "**Attachment:** [trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch)\n\n**Attachment:** [trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch)\n\nSage library",
    "created_at": "2012-10-01T20:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152816",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch)

**Attachment:** [trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch)

Sage library



---

archive/issue_comments_152817.json:
```json
{
    "body": "<a id='comment:17'></a>\nHi John,\n\nAs a prerequisite of #6495 I'm starting to review this one.\n\nFlorent",
    "created_at": "2012-10-04T12:01:29Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152817",
    "user": "https://github.com/hivert"
}
```

<a id='comment:17'></a>
Hi John,

As a prerequisite of #6495 I'm starting to review this one.

Florent



---

archive/issue_comments_152818.json:
```json
{
    "body": "<a id='comment:18'></a>\nHi Florent,\n\nGreat. Please let me know if you have any questions or comments.\n\n   John",
    "created_at": "2012-10-04T14:14:49Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152818",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
Hi Florent,

Great. Please let me know if you have any questions or comments.

   John



---

archive/issue_comments_152819.json:
```json
{
    "body": "<a id='comment:19'></a>\nHi John,\n\nReplying to [jhpalmieri](#comment%3A18):\n> Great. Please let me know if you have any questions or comments.\n\nI'm running into some problems. Here are what I did: on a fresh 5.4.rc0, I\nmade a clone and imported the two `v2` patches. Then I removed the\n`doc/output` directory and issued a\n\n```\nsage -docbuild reference html\n```\nAfter that some pages are perfectly Ok but for some other (I can't find a\npattern) there is a line in the bottom saying\n\n```\nLoading [MathJax]/fonts/HTML-CSS/TeX/png/imagedata.js\n```\nAnd after somehow ten seconds the text changes to\n\n```\nFile failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js\n```\nIndeed the file doesn't exists on my filesystem. By the way, I'm using\nFirefox 15.0 on openSuSE 12.1 64 bits.\n\nAm I missing something trivial ?\n\nCheers,\n\nFlorent",
    "created_at": "2012-10-05T15:35:35Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152819",
    "user": "https://github.com/hivert"
}
```

<a id='comment:19'></a>
Hi John,

Replying to [jhpalmieri](#comment%3A18):
> Great. Please let me know if you have any questions or comments.

I'm running into some problems. Here are what I did: on a fresh 5.4.rc0, I
made a clone and imported the two `v2` patches. Then I removed the
`doc/output` directory and issued a

```
sage -docbuild reference html
```
After that some pages are perfectly Ok but for some other (I can't find a
pattern) there is a line in the bottom saying

```
Loading [MathJax]/fonts/HTML-CSS/TeX/png/imagedata.js
```
And after somehow ten seconds the text changes to

```
File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js
```
Indeed the file doesn't exists on my filesystem. By the way, I'm using
Firefox 15.0 on openSuSE 12.1 64 bits.

Am I missing something trivial ?

Cheers,

Florent



---

archive/issue_comments_152820.json:
```json
{
    "body": "<a id='comment:20'></a>\nSorry for the two answers.\n\n> And after somehow ten seconds the text changes to\n> \n> ```\n> File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js\n> ```\n\nYou probably guessed it but after that the maths are replaced by a red\n`[Math Processing Error]`.\n\nCheers,\n\nFlorent",
    "created_at": "2012-10-05T15:37:31Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152820",
    "user": "https://github.com/hivert"
}
```

<a id='comment:20'></a>
Sorry for the two answers.

> And after somehow ten seconds the text changes to
> 
> ```
> File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js
> ```

You probably guessed it but after that the maths are replaced by a red
`[Math Processing Error]`.

Cheers,

Florent



---

archive/issue_comments_152821.json:
```json
{
    "body": "<a id='comment:21'></a>\nHi Florent,\n\nI have no idea. I tried on my machine (OS X). I browsed through 10-20 pages of the reference manual and saw no problems. Does this depend on this ticket? If you don't apply the patches and run\n\n```\nsage -docbuild reference html -j\n```\ndo you see the same problem?\n\n```\nFile failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js\n```\nI don't even see a \"png\" directory. I see \"eot\", \"otf\", and \"svg\" directories.",
    "created_at": "2012-10-05T18:18:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152821",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>
Hi Florent,

I have no idea. I tried on my machine (OS X). I browsed through 10-20 pages of the reference manual and saw no problems. Does this depend on this ticket? If you don't apply the patches and run

```
sage -docbuild reference html -j
```
do you see the same problem?

```
File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js
```
I don't even see a "png" directory. I see "eot", "otf", and "svg" directories.



---

archive/issue_comments_152822.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jhpalmieri](#comment%3A21):\n> Hi Florent,\n> \n> I have no idea. I tried on my machine (OS X). I browsed through 10-20 pages of the reference manual and saw no problems. Does this depend on this ticket? If you don't apply the patches and run\n> \n> ```\n> sage -docbuild reference html -j\n> ```\n> do you see the same problem?\n\nRunning... I can't wait having #6495 ;-)\n\n> ```\n> File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js\n> ```\n> I don't even see a \"png\" directory. I see \"eot\", \"otf\", and \"svg\" directories.\n\nSorry I wasn't precise enough. The same holds for me.",
    "created_at": "2012-10-06T08:07:49Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152822",
    "user": "https://github.com/hivert"
}
```

<a id='comment:22'></a>
Replying to [jhpalmieri](#comment%3A21):
> Hi Florent,
> 
> I have no idea. I tried on my machine (OS X). I browsed through 10-20 pages of the reference manual and saw no problems. Does this depend on this ticket? If you don't apply the patches and run
> 
> ```
> sage -docbuild reference html -j
> ```
> do you see the same problem?

Running... I can't wait having #6495 ;-)

> ```
> File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js
> ```
> I don't even see a "png" directory. I see "eot", "otf", and "svg" directories.

Sorry I wasn't precise enough. The same holds for me.



---

archive/issue_comments_152823.json:
```json
{
    "body": "<a id='comment:23'></a>\nApparently it has nothing to do with the patch... I'm trying with sage-5.3...\n\nFlorent",
    "created_at": "2012-10-06T10:33:05Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152823",
    "user": "https://github.com/hivert"
}
```

<a id='comment:23'></a>
Apparently it has nothing to do with the patch... I'm trying with sage-5.3...

Florent



---

archive/issue_comments_152824.json:
```json
{
    "body": "<a id='comment:24'></a>\nSo the problem has nothing to do with the patch here. MathJax math seems to be Ok on my laptop with sage 5.3 but are both broken with sage 5.4.rc0 and 5.4.rc1. More precisely I just did the following:\n\n- Build from sources a fresh 5.4.rc1\n- removed `devel/sage-main/doc/output/html/en/reference`\n- issued `./sage -docbuild reference html --mathjax`\n\nthen the file `index.html` displayed correctly in firefox but `devel/sage-main/doc/output/html/en/reference/sage/modular/modsym/p1list.html` was broken. The error message is the same as before. Any idea ? May this be related to #9774 ?\n\nFlorent",
    "created_at": "2012-10-07T14:56:17Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152824",
    "user": "https://github.com/hivert"
}
```

<a id='comment:24'></a>
So the problem has nothing to do with the patch here. MathJax math seems to be Ok on my laptop with sage 5.3 but are both broken with sage 5.4.rc0 and 5.4.rc1. More precisely I just did the following:

- Build from sources a fresh 5.4.rc1
- removed `devel/sage-main/doc/output/html/en/reference`
- issued `./sage -docbuild reference html --mathjax`

then the file `index.html` displayed correctly in firefox but `devel/sage-main/doc/output/html/en/reference/sage/modular/modsym/p1list.html` was broken. The error message is the same as before. Any idea ? May this be related to #9774 ?

Florent



---

archive/issue_comments_152825.json:
```json
{
    "body": "<a id='comment:25'></a>\nThere is also a problem with compiling the doc with `MathJax`. Some pages use advanced LateX stuff such as pictures. Unfortunately they doesn't work with `MathJax` activated. See eg:\n\n```\nsage/graphs/base/static_sparse_graph.pyx\n```\n\nCheers,\n\nFlorent",
    "created_at": "2012-10-07T19:47:08Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152825",
    "user": "https://github.com/hivert"
}
```

<a id='comment:25'></a>
There is also a problem with compiling the doc with `MathJax`. Some pages use advanced LateX stuff such as pictures. Unfortunately they doesn't work with `MathJax` activated. See eg:

```
sage/graphs/base/static_sparse_graph.pyx
```

Cheers,

Florent



---

archive/issue_comments_152826.json:
```json
{
    "body": "<a id='comment:26'></a>\nIdeally, this would be dealt with by Sphinx (and I'm glad you wrote to sphinx-devel about it). But the documentation should be written so that it looks good with or without MathJax (or jsMath, in older versions of Sage). The `picture` mode LaTeX code isn't processed correctly with these: it only works with the pngmath Sphinx extension. (I checked some older versions of Sage, and it didn't work with jsMath either.) So I think the documentation should be changed: for pictures like these, someone should just produce some pngs and then include them, as is done in several other places in the docs. Indeed, that documentation should never have been allowed in Sage in the first place, since it didn't build using Sphinx's jsMath extension.\n\nI've been playing around with Sphinx, trying to see if there is a way to turn extensions like pngmath on or off using a function `process_mathjax` called like\n\n```\n    app.connect('autodoc-process-docstring', process_mathjax)\n```\nin the `setup` function at the end of devel/sage/doc/common/conf.py, but I haven't gotten anywhere yet.",
    "created_at": "2012-10-08T05:46:00Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152826",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>
Ideally, this would be dealt with by Sphinx (and I'm glad you wrote to sphinx-devel about it). But the documentation should be written so that it looks good with or without MathJax (or jsMath, in older versions of Sage). The `picture` mode LaTeX code isn't processed correctly with these: it only works with the pngmath Sphinx extension. (I checked some older versions of Sage, and it didn't work with jsMath either.) So I think the documentation should be changed: for pictures like these, someone should just produce some pngs and then include them, as is done in several other places in the docs. Indeed, that documentation should never have been allowed in Sage in the first place, since it didn't build using Sphinx's jsMath extension.

I've been playing around with Sphinx, trying to see if there is a way to turn extensions like pngmath on or off using a function `process_mathjax` called like

```
    app.connect('autodoc-process-docstring', process_mathjax)
```
in the `setup` function at the end of devel/sage/doc/common/conf.py, but I haven't gotten anywhere yet.



---

archive/issue_comments_152827.json:
```json
{
    "body": "<a id='comment:27'></a>\nHere is a patch which replaces several picture environments with pngs. I tried searching the Sage library for possible problems, but I don't know exactly what MathJax cannot handle, so I searched for files containing both \".. math\" and \"begin{\". These were the only instances I found which didn't render correctly with MathJax. I'm afraid it would be almost impossible to search the whole reference manual to look for other problems, since I think they only appear upon rendering in the web browser.",
    "created_at": "2012-10-08T20:26:32Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152827",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>
Here is a patch which replaces several picture environments with pngs. I tried searching the Sage library for possible problems, but I don't know exactly what MathJax cannot handle, so I searched for files containing both ".. math" and "begin{". These were the only instances I found which didn't render correctly with MathJax. I'm afraid it would be almost impossible to search the whole reference manual to look for other problems, since I think they only appear upon rendering in the web browser.



---

archive/issue_comments_152828.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -31,6 +31,6 @@\n ---\n \n - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.\n-- Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.\n+- Apply [and [attachment:trac_13143-pictures.patch](https://github.com/sagemath/sage/files/ticket13143/0535acad0f66ffe476498de0f17f9a48.patch](https://github.com/sagemath/sage/files/ticket13143/0081ade1c1a4778159c80669473a7e18.patch)) to the Sage library.\n \n This change was discussed [on sage-devel](https://groups.google.com/d/topic/sage-devel/eHPVwaaqWSA/discussion).\n``````\n",
    "created_at": "2012-10-08T20:26:32Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152828",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -31,6 +31,6 @@
 ---
 
 - Apply [attachment:trac_13143-root.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-root.v2.patch) to the root repo.
-- Apply [attachment:trac_13143-sage.v2.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-sage.v2.patch) to the Sage library.
+- Apply [and [attachment:trac_13143-pictures.patch](https://github.com/sagemath/sage/files/ticket13143/0535acad0f66ffe476498de0f17f9a48.patch](https://github.com/sagemath/sage/files/ticket13143/0081ade1c1a4778159c80669473a7e18.patch)) to the Sage library.
 
 This change was discussed [on sage-devel](https://groups.google.com/d/topic/sage-devel/eHPVwaaqWSA/discussion).
``````




---

archive/issue_comments_152829.json:
```json
{
    "body": "<a id='comment:28'></a>\nIf this approach (pngs instead of picture environments) looks okay, I'll rebase #6495 on top of it.",
    "created_at": "2012-10-08T20:39:21Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152829",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
If this approach (pngs instead of picture environments) looks okay, I'll rebase #6495 on top of it.



---

archive/issue_comments_152830.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [hivert](#comment%3A19):\n>       Hi John,\n> \n> Replying to [jhpalmieri](#comment%3A18):\n> > Great. Please let me know if you have any questions or comments.\n\n> \n> I'm running into some problems. Here are what I did: on a fresh 5.4.rc0, I\n> made a clone and imported the two `v2` patches. Then I removed the\n> `doc/output` directory and issued a\n> \n> ```\n> sage -docbuild reference html\n> ```\n> After that some pages are perfectly Ok but for some other (I can't find a\n> pattern) there is a line in the bottom saying\n> \n> ```\n> Loading [MathJax]/fonts/HTML-CSS/TeX/png/imagedata.js\n> ```\n> And after somehow ten seconds the text changes to\n> \n> ```\n> File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js\n> ```\n> Indeed the file doesn't exists on my filesystem. By the way, I'm using\n> Firefox 15.0 on openSuSE 12.1 64 bits.\n\nI still don't know what's going on with this. On several systems (OS X and sage.math.washington.edu), I don't see this. A few weeks ago, I made a version of the documentation using MathJax and #6495: [http://sage.math.washington.edu/home/palmieri/misc/6495-jsmath/html/en/index.html](http://sage.math.washington.edu/home/palmieri/misc/6495-jsmath/html/en/index.html). I skimmed through some pages, and don't see any of these problems. Do you have any ideas what could be causing it? I can't imagine why it would make a difference, but did you run `sage -b` in addition to removing `doc/output`? Is it repeatable, and are the web pages on which the problems occur repeatable?",
    "created_at": "2012-10-09T16:06:10Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152830",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:29'></a>
Replying to [hivert](#comment%3A19):
>       Hi John,
> 
> Replying to [jhpalmieri](#comment%3A18):
> > Great. Please let me know if you have any questions or comments.

> 
> I'm running into some problems. Here are what I did: on a fresh 5.4.rc0, I
> made a clone and imported the two `v2` patches. Then I removed the
> `doc/output` directory and issued a
> 
> ```
> sage -docbuild reference html
> ```
> After that some pages are perfectly Ok but for some other (I can't find a
> pattern) there is a line in the bottom saying
> 
> ```
> Loading [MathJax]/fonts/HTML-CSS/TeX/png/imagedata.js
> ```
> And after somehow ten seconds the text changes to
> 
> ```
> File failed to load: file:///home/data/Sage-Install/sage-5.4.rc0/devel/sage-doc/doc/output/html/en/reference/_static/fonts/HTML-CSS/TeX/png/imagedata.js
> ```
> Indeed the file doesn't exists on my filesystem. By the way, I'm using
> Firefox 15.0 on openSuSE 12.1 64 bits.

I still don't know what's going on with this. On several systems (OS X and sage.math.washington.edu), I don't see this. A few weeks ago, I made a version of the documentation using MathJax and #6495: [http://sage.math.washington.edu/home/palmieri/misc/6495-jsmath/html/en/index.html](http://sage.math.washington.edu/home/palmieri/misc/6495-jsmath/html/en/index.html). I skimmed through some pages, and don't see any of these problems. Do you have any ideas what could be causing it? I can't imagine why it would make a difference, but did you run `sage -b` in addition to removing `doc/output`? Is it repeatable, and are the web pages on which the problems occur repeatable?



---

archive/issue_comments_152831.json:
```json
{
    "body": "<a id='comment:30'></a>\nAs far as other possibly incompatible pieces of LaTeX in the Sage library, I haven't found any. I ran\n\n```\nsage: search_src('\\\\\\\\[a-zA-Z]', interact=False)\n```\nto get a list of all strings starting with a backslash and then a letter, then turned this into a list of all of the potential LaTeX commands used in Sage, and compared it to [MathJax's list](http://docs.mathjax.org/en/latest/tex.html#supported-latex-commands). For items on Sage's list that aren't recognized by MathJax, I looked at how they were used in the Sage library. This wasn't a very long list, and I admit that I wasn't extremely careful, but I didn't find any problems.",
    "created_at": "2012-10-09T22:56:44Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152831",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>
As far as other possibly incompatible pieces of LaTeX in the Sage library, I haven't found any. I ran

```
sage: search_src('\\\\[a-zA-Z]', interact=False)
```
to get a list of all strings starting with a backslash and then a letter, then turned this into a list of all of the potential LaTeX commands used in Sage, and compared it to [MathJax's list](http://docs.mathjax.org/en/latest/tex.html#supported-latex-commands). For items on Sage's list that aren't recognized by MathJax, I looked at how they were used in the Sage library. This wasn't a very long list, and I admit that I wasn't extremely careful, but I didn't find any problems.



---

archive/issue_comments_152832.json:
```json
{
    "body": "<a id='comment:31'></a>\n(I just fixed a typo in the commit message.)",
    "created_at": "2012-10-18T20:31:10Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152832",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'></a>
(I just fixed a typo in the commit message.)



---

archive/issue_comments_152833.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [jhpalmieri](#comment%3A30):\n> As far as other possibly incompatible pieces of LaTeX in the Sage library, I haven't found any. I ran\n> \n> ```\n> sage: search_src('\\\\\\\\[a-zA-Z]', interact=False)\n> ```\n> to get a list of all strings starting with a backslash and then a letter, then turned this into a list of all of the potential LaTeX commands used in Sage, and compared it to [MathJax's list](http://docs.mathjax.org/en/latest/tex.html#supported-latex-commands). For items on Sage's list that aren't recognized by MathJax, I looked at how they were used in the Sage library. This wasn't a very long list, and I admit that I wasn't extremely careful, but I didn't find any problems.\n\nHere is one thing I found: compare http://www.sagemath.org/doc/thematic_tutorials/numtheory_rsa.html and\nthe corresponding page in your output, somewhere in the middle:\n\n```\nFormally, let\n\n\u03a3={A,B,C,...,Z}\n\nbe the set of capital letters of the English alphabet. Furthermore, let\n```\nOn your pages (and also on my own build with this patch), the formula \\Sigma={A,B,C,...,Z} is broken (viewed on OSX10.6.8, with Chrome or with Safari). Namely, \nit looks like \u03a3={\\textttA,\\textttB,\\textttC,...,\\textttZ}, with \\texttt typeset in red.\n\nIn the source I see\n\n```\n.. MATH::\n\n    \\Sigma\n    =\n    \\{ \\texttt{A}, \\texttt{B}, \\texttt{C}, \\dots, \\texttt{Z} \\}\n\n```\nwhich look like 100% kosher TeX to me.\n\nCan you fix this in `MathJax` config?",
    "created_at": "2012-10-27T14:42:58Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152833",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'></a>
Replying to [jhpalmieri](#comment%3A30):
> As far as other possibly incompatible pieces of LaTeX in the Sage library, I haven't found any. I ran
> 
> ```
> sage: search_src('\\\\[a-zA-Z]', interact=False)
> ```
> to get a list of all strings starting with a backslash and then a letter, then turned this into a list of all of the potential LaTeX commands used in Sage, and compared it to [MathJax's list](http://docs.mathjax.org/en/latest/tex.html#supported-latex-commands). For items on Sage's list that aren't recognized by MathJax, I looked at how they were used in the Sage library. This wasn't a very long list, and I admit that I wasn't extremely careful, but I didn't find any problems.

Here is one thing I found: compare http://www.sagemath.org/doc/thematic_tutorials/numtheory_rsa.html and
the corresponding page in your output, somewhere in the middle:

```
Formally, let

Î£={A,B,C,...,Z}

be the set of capital letters of the English alphabet. Furthermore, let
```
On your pages (and also on my own build with this patch), the formula \Sigma={A,B,C,...,Z} is broken (viewed on OSX10.6.8, with Chrome or with Safari). Namely, 
it looks like Î£={\textttA,\textttB,\textttC,...,\textttZ}, with \texttt typeset in red.

In the source I see

```
.. MATH::

    \Sigma
    =
    \{ \texttt{A}, \texttt{B}, \texttt{C}, \dots, \texttt{Z} \}

```
which look like 100% kosher TeX to me.

Can you fix this in `MathJax` config?



---

archive/issue_events_110809.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-27T14:42:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110809"
}
```



---

archive/issue_events_110810.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-27T14:42:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110810"
}
```



---

archive/issue_comments_152834.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [dimpase](#comment%3A32):\n\n> Can you fix this in `MathJax` config?\n\nThis appears to be a mathjax bug, of sorts, according to [google](http://www.mail-archive.com/wikibugs-l@lists.wikimedia.org/msg134519.html).\nIf I put the following into `Macro:` section of `mathjax_sage.js` in `output/html/en/thematic_tutorials/_static/` then it displays just right (`textfs` and `emph` are added just for good measure, as they suffer the same fate, apparently).\n\n```\ntexttt:             ['\\\\mathord{\\\\tt{\\\\text{#1}}}',1],\ntextsf:             ['\\\\mathord{\\\\sf{\\\\text{#1}}}',1],\nemph:               ['\\\\textit{#1}',1]\n ```\n\napparently this should be added to the appropriate `mathjax_sage.js_t` file, although how to rebuild the docs to take care of this change this way, I don't know. If someone tells me this, I could come up with a patch.",
    "created_at": "2012-10-27T15:19:59Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152834",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>
Replying to [dimpase](#comment%3A32):

> Can you fix this in `MathJax` config?

This appears to be a mathjax bug, of sorts, according to [google](http://www.mail-archive.com/wikibugs-l@lists.wikimedia.org/msg134519.html).
If I put the following into `Macro:` section of `mathjax_sage.js` in `output/html/en/thematic_tutorials/_static/` then it displays just right (`textfs` and `emph` are added just for good measure, as they suffer the same fate, apparently).

```
texttt:             ['\\mathord{\\tt{\\text{#1}}}',1],
textsf:             ['\\mathord{\\sf{\\text{#1}}}',1],
emph:               ['\\textit{#1}',1]
 ```

apparently this should be added to the appropriate `mathjax_sage.js_t` file, although how to rebuild the docs to take care of this change this way, I don't know. If someone tells me this, I could come up with a patch.



---

archive/issue_events_110811.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-27T15:19:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110811"
}
```



---

archive/issue_events_110812.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-27T15:19:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110812"
}
```



---

archive/issue_comments_152835.json:
```json
{
    "body": "<a id='comment:34'></a>\n`\\texttt` is supposed to be used in text mode, not math mode, so whether it's a MathJax bug, we should replace it with `\\mathtt`. That fixes the problem for me. I'll add this patch in a few minutes. I also don't know what version of MathJax we have; at some point we should probably upgrade.",
    "created_at": "2012-10-27T15:22:50Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152835",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
`\texttt` is supposed to be used in text mode, not math mode, so whether it's a MathJax bug, we should replace it with `\mathtt`. That fixes the problem for me. I'll add this patch in a few minutes. I also don't know what version of MathJax we have; at some point we should probably upgrade.



---

archive/issue_events_110813.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-27T15:32:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110813"
}
```



---

archive/issue_events_110814.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-27T15:32:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110814"
}
```



---

archive/issue_comments_152836.json:
```json
{
    "body": "<a id='comment:35'></a>\nIn fact, I think that MathJax is only designed to handle math mode, so we shouldn't expect `\\texttt` or `\\textsf` to work, or `\\emph` in text mode. (Sphinx won't even call MathJax on text not between single backquotes, i.e., on non-math.) Using `\\emph` in math mode is not very common, so I suggest not worrying about it.",
    "created_at": "2012-10-27T15:32:32Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152836",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:35'></a>
In fact, I think that MathJax is only designed to handle math mode, so we shouldn't expect `\texttt` or `\textsf` to work, or `\emph` in text mode. (Sphinx won't even call MathJax on text not between single backquotes, i.e., on non-math.) Using `\emph` in math mode is not very common, so I suggest not worrying about it.



---

archive/issue_comments_152837.json:
```json
{
    "body": "<a id='comment:36'></a>\nNote that `\\texttt` appears in two more places in the Sage library, but not in the documentation: in combinat/posets/linear_extension.py and in modules/vector_space_morphism.py. In the first of these, it should be replace by `\\mathtt`, and in the second, probably by `\\text`. These changes are not related to this ticket, but we can add them on anyway...",
    "created_at": "2012-10-27T15:42:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152837",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'></a>
Note that `\texttt` appears in two more places in the Sage library, but not in the documentation: in combinat/posets/linear_extension.py and in modules/vector_space_morphism.py. In the first of these, it should be replace by `\mathtt`, and in the second, probably by `\text`. These changes are not related to this ticket, but we can add them on anyway...



---

archive/issue_comments_152838.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [jhpalmieri](#comment%3A36):\n> Note that `\\texttt` appears in two more places in the Sage library, but not in the documentation: in combinat/posets/linear_extension.py and in modules/vector_space_morphism.py. In the first of these, it should be replace by `\\mathtt`, and in the second, probably by `\\text`. These changes are not related to this ticket, but we can add them on anyway...\n\nRight, let's do this, and hopefully be done with! Indeed, I didn't think straight about `\\texttt{`}.",
    "created_at": "2012-10-27T15:50:40Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152838",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>
Replying to [jhpalmieri](#comment%3A36):
> Note that `\texttt` appears in two more places in the Sage library, but not in the documentation: in combinat/posets/linear_extension.py and in modules/vector_space_morphism.py. In the first of these, it should be replace by `\mathtt`, and in the second, probably by `\text`. These changes are not related to this ticket, but we can add them on anyway...

Right, let's do this, and hopefully be done with! Indeed, I didn't think straight about `\texttt{`}.



---

archive/attachments_018391.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13143-optional.patch",
    "asset_url": "tarball://root/attachments/ticket13143/trac_13143-optional.patch",
    "created_at": "2012-10-27T15:51:33Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13143/trac_13143-optional.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_152839.json:
```json
{
    "body": "**Attachment:** [trac_13143-optional.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-optional.patch)\n\noptional patch, independent of the others",
    "created_at": "2012-10-27T15:51:33Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152839",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_13143-optional.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-optional.patch)

optional patch, independent of the others



---

archive/issue_comments_152840.json:
```json
{
    "body": "<a id='comment:38'></a>\nIf you think we should apply the \"optional\" patch, please add it to the ticket description (under the list of patches to be applied).",
    "created_at": "2012-10-27T15:54:37Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152840",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'></a>
If you think we should apply the "optional" patch, please add it to the ticket description (under the list of patches to be applied).



---

archive/issue_comments_152841.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [jhpalmieri](#comment%3A38):\n> If you think we should apply the \"optional\" patch, please add it to the ticket description (under the list of patches to be applied).\n\nIn both cases it's inside the docs for _latex function, which do not appear in the HTML documentation at all, for some reason.\nI guess sphynx skips stuff beginning from _. I don't know whether it's a bug or a feature.",
    "created_at": "2012-10-27T16:29:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152841",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>
Replying to [jhpalmieri](#comment%3A38):
> If you think we should apply the "optional" patch, please add it to the ticket description (under the list of patches to be applied).

In both cases it's inside the docs for _latex function, which do not appear in the HTML documentation at all, for some reason.
I guess sphynx skips stuff beginning from _. I don't know whether it's a bug or a feature.



---

archive/issue_events_110815.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-27T17:01:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110815"
}
```



---

archive/issue_events_110816.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-27T17:01:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110816"
}
```



---

archive/issue_comments_152842.json:
```json
{
    "body": "**Reviewer:** Dmitrii Pasechnik",
    "created_at": "2012-10-29T21:28:35Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152842",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Dmitrii Pasechnik



---

archive/issue_events_110817.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-29T21:28:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110817"
}
```



---

archive/issue_events_110818.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-29T21:28:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110818"
}
```



---

archive/issue_comments_152843.json:
```json
{
    "body": "Sage library",
    "created_at": "2012-11-01T12:46:29Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152843",
    "user": "https://github.com/jdemeyer"
}
```

Sage library



---

archive/attachments_018392.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13143-pictures.patch",
    "asset_url": "tarball://root/attachments/ticket13143/trac_13143-pictures.patch",
    "created_at": "2012-11-01T12:47:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13143/trac_13143-pictures.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_152844.json:
```json
{
    "body": "<a id='comment:42'></a>\n**Attachment:** [trac_13143-pictures.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-pictures.patch)\n\nRebased to sage-5.5.beta1.",
    "created_at": "2012-11-01T12:47:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152844",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>
**Attachment:** [trac_13143-pictures.patch](https://github.com/sagemath/sage/files/ticket13143/trac_13143-pictures.patch)

Rebased to sage-5.5.beta1.



---

archive/issue_comments_152845.json:
```json
{
    "body": "**Merged:** sage-5.5.beta2",
    "created_at": "2012-11-01T12:47:11Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152845",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.5.beta2



---

archive/issue_events_110819.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:47:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110819"
}
```



---

archive/issue_events_110820.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:47:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13143#event-110820"
}
```



---

archive/issue_comments_152846.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,11 +8,11 @@\n $ rm -rf devel/sage/doc/output\n $ time sage --docbuild tutorial html\n ...\n-real\t2m17.950s\n-user\t1m29.441s\n-sys\t0m15.478s\n+real 2m17.950s\n+user 1m29.441s\n+sys 0m15.478s\n $ du -s -h devel/sage/doc/output\n-3.9M\toutput/\n+3.9M output/\n ```\n With MathJax:\n \n@@ -20,11 +20,11 @@\n $ rm -rf devel/sage/doc/output\n $ time sage --docbuild tutorial html -j\n ...\n-real\t0m9.871s\n-user\t0m6.530s\n-sys\t0m1.739s\n+real 0m9.871s\n+user 0m6.530s\n+sys 0m1.739s\n $ du -s -h devel/sage/doc/output\n- 8.5M\toutput/\n+ 8.5M output/\n ```\n When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). \n \n``````\n",
    "created_at": "2015-09-06T17:27:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13143#issuecomment-152846",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,11 +8,11 @@
 $ rm -rf devel/sage/doc/output
 $ time sage --docbuild tutorial html
 ...
-real	2m17.950s
-user	1m29.441s
-sys	0m15.478s
+real 2m17.950s
+user 1m29.441s
+sys 0m15.478s
 $ du -s -h devel/sage/doc/output
-3.9M	output/
+3.9M output/
 ```
 With MathJax:
 
@@ -20,11 +20,11 @@
 $ rm -rf devel/sage/doc/output
 $ time sage --docbuild tutorial html -j
 ...
-real	0m9.871s
-user	0m6.530s
-sys	0m1.739s
+real 0m9.871s
+user 0m6.530s
+sys 0m1.739s
 $ du -s -h devel/sage/doc/output
- 8.5M	output/
+ 8.5M output/
 ```
 When building all of the documentation, the disk space actually drops, going from about 320M (without MathJax) to about 295M (with). 
 
``````

