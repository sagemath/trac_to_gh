# Issue 13546: Bug in is_perfect

archive/issues_013342.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/nathanncohen",
        "https://github.com/rlmill"
    ],
    "body": "The method for recognizing perfect graphs if flawed. Consider the following sage function:\n\n```\ndef f(n):\n    c= 0\n    for g in graphs.nauty_geng(str(n)):\n        if g.is_perfect():\n            c+=1\n    return c\n\n```\n\none can readily see that f(7) = 607 and f(8) = 8899 which is, (according to oeis http://oeis.org/A052431) incorrect. What should be true is that f(7) = 906 and f(7) = 8887.\n\nI propose to rewrite a correct algorithm perhaps using the  polynomial algorithm (www.comp.leeds.ac.uk/vuskovi/FOCS03final.ps).\n\nApply :\n* [attachment: trac_13546.2.patch](https://github.com/sagemath/sage/files/ticket13546/trac_13546.2.patch.gz)\n\nDepends on #8952\n\nCC:  @rbeezer\n\nKeywords: **is_perfect, graph theory**\n\nReviewer: **Jernej Azarija, S\u00e9bastien Labb\u00e9**\n\nAuthor: **Nathann Cohen**\n\nMerged: **sage-5.7.beta4**\n\nComponent: **graph theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13546_\n\n",
    "closed_at": "2013-02-09T12:12:37Z",
    "created_at": "2012-09-28T17:06:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Bug in is_perfect",
    "type": "issue",
    "updated_at": "2013-02-09T12:12:37Z",
    "url": "https://github.com/sagemath/sage/issues/13546",
    "user": "https://github.com/sagetrac-azi"
}
```
The method for recognizing perfect graphs if flawed. Consider the following sage function:

```
def f(n):
    c= 0
    for g in graphs.nauty_geng(str(n)):
        if g.is_perfect():
            c+=1
    return c

```

one can readily see that f(7) = 607 and f(8) = 8899 which is, (according to oeis http://oeis.org/A052431) incorrect. What should be true is that f(7) = 906 and f(7) = 8887.

I propose to rewrite a correct algorithm perhaps using the  polynomial algorithm (www.comp.leeds.ac.uk/vuskovi/FOCS03final.ps).

Apply :
* [attachment: trac_13546.2.patch](https://github.com/sagemath/sage/files/ticket13546/trac_13546.2.patch.gz)

Depends on #8952

CC:  @rbeezer

Keywords: **is_perfect, graph theory**

Reviewer: **Jernej Azarija, Sébastien Labbé**

Author: **Nathann Cohen**

Merged: **sage-5.7.beta4**

Component: **graph theory**

_Issue created by migration from https://trac.sagemath.org/ticket/13546_





---

archive/issue_events_189921.json:
```json
{
    "actor": "https://github.com/sagetrac-azi",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189921"
}
```



---

archive/issue_events_189922.json:
```json
{
    "actor": "https://github.com/sagetrac-azi",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "eeeeee",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189922"
}
```



---

archive/issue_events_189923.json:
```json
{
    "actor": "https://github.com/sagetrac-azi",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189923"
}
```



---

archive/issue_events_189924.json:
```json
{
    "actor": "https://github.com/sagetrac-azi",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189924"
}
```



---

archive/issue_events_189925.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "subject": "https://github.com/sagetrac-azi",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189925"
}
```



---

archive/issue_events_189926.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "subject": "https://github.com/sagetrac-azi",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189926"
}
```



---

archive/issue_events_189927.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2012-09-28T17:06:28Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "subject": "https://github.com/sagetrac-azi",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189927"
}
```



---

archive/issue_comments_158111.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHmmmmmmmmm `O_o;;;`\n\n```\nsage: def f(n):\n....:         c= 0\n....:     for g in graphs.nauty_geng(str(n)):\n....:             if g.is_perfect():\n....:                 c+=1\n....:     return c\n....: \nsage: f(7)\n907\n```",
    "created_at": "2012-10-01T10:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158111",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:1" align="right">comment:1</div>

Hmmmmmmmmm `O_o;;;`

```
sage: def f(n):
....:         c= 0
....:     for g in graphs.nauty_geng(str(n)):
....:             if g.is_perfect():
....:                 c+=1
....:     return c
....: 
sage: f(7)
907
```



---

archive/issue_comments_158112.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nYes and the interesting part is that you get more perfect graphs on 7 nodes and less graph of order 8.",
    "created_at": "2012-10-01T11:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158112",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:2" align="right">comment:2</div>

Yes and the interesting part is that you get more perfect graphs on 7 nodes and less graph of order 8.



---

archive/issue_comments_158113.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI have modified is perfect in the following way: \n\n```\n        ret = self.is_odd_hole_free(certificate = certificate)\n     \n        if ret == False or (certificate and ret != None):\n            return ret\n     \n        self_complement = self.complement()\n     \n        ret = self.is_odd_hole_free(certificate = certificate)\n     \n        if ret == False or (certificate and ret != None):\n            return ret\n    \n        return True \n```\n\nThe error is still there so I suppose there is a bug in is_odd_hole_free. I will try to spot the bug there and make a temporary patch",
    "created_at": "2012-10-01T11:19:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158113",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:3" align="right">comment:3</div>

I have modified is perfect in the following way: 

```
        ret = self.is_odd_hole_free(certificate = certificate)
     
        if ret == False or (certificate and ret != None):
            return ret
     
        self_complement = self.complement()
     
        ret = self.is_odd_hole_free(certificate = certificate)
     
        if ret == False or (certificate and ret != None):
            return ret
    
        return True 
```

The error is still there so I suppose there is a bug in is_odd_hole_free. I will try to spot the bug there and make a temporary patch



---

archive/issue_comments_158114.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAhahaahah... Stupid bug `:-)`\n\nOk, it is now fixed by the following patch. Here's what it does :\n\n* It tests if the graph's complement is bipartite. Just a potential speed improvement.\n* Returns a result immediately if the girth is odd and > 3, and not only if it is equal to 5\nAnd ... more importantly `:-D`\n\n* replaces an occurrence of ``self`` which should have been ``self_complement`` from the beginning `:-DDDDDDD`\n\nNathann",
    "created_at": "2012-10-01T12:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158114",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">comment:4</div>

Ahahaahah... Stupid bug `:-)`

Ok, it is now fixed by the following patch. Here's what it does :

* It tests if the graph's complement is bipartite. Just a potential speed improvement.
* Returns a result immediately if the girth is odd and > 3, and not only if it is equal to 5
And ... more importantly `:-D`

* replaces an occurrence of ``self`` which should have been ``self_complement`` from the beginning `:-DDDDDDD`

Nathann



---

archive/issue_comments_158115.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n(but of course if you feel like implementing the polynomial algorithm, this is still a very interesting (not to mention courageous) thing to do `:-D`\n\nNathann",
    "created_at": "2012-10-01T12:37:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158115",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:5" align="right">comment:5</div>

(but of course if you feel like implementing the polynomial algorithm, this is still a very interesting (not to mention courageous) thing to do `:-D`

Nathann



---

archive/issue_events_189928.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2012-10-01T12:37:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189928"
}
```



---

archive/issue_comments_158116.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWhat about the is_odd_hole_free function? isn't it better if is_perfect directly calls it? Otherwise we have duplicated code?",
    "created_at": "2012-10-01T16:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158116",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:7" align="right">comment:7</div>

What about the is_odd_hole_free function? isn't it better if is_perfect directly calls it? Otherwise we have duplicated code?



---

archive/issue_comments_158117.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWell, I thought while writing this code that it was better to check all odd holes and antiholes from small sizes to larger ones, than to test first ALL HOLES (all sizes) then all antiholes (all sizes).\n\nThat's the difference between this code and yours. Probably that's just a matter of taste after all `O_o`. What do you think ?\n\nNathann",
    "created_at": "2012-10-01T16:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158117",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:8" align="right">comment:8</div>

Well, I thought while writing this code that it was better to check all odd holes and antiholes from small sizes to larger ones, than to test first ALL HOLES (all sizes) then all antiholes (all sizes).

That's the difference between this code and yours. Probably that's just a matter of taste after all `O_o`. What do you think ?

Nathann



---

archive/issue_comments_158118.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI completely agree with you. This is just a minor stylistic difference. \n\nI am still inclined towards \"the less duplicated solution\" especially since the algorithm has exponential complexity and when it \"dies\" it dies.",
    "created_at": "2012-10-02T11:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158118",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:9" align="right">comment:9</div>

I completely agree with you. This is just a minor stylistic difference. 

I am still inclined towards "the less duplicated solution" especially since the algorithm has exponential complexity and when it "dies" it dies.



---

archive/issue_comments_158119.json:
```json
{
    "body": "Dependencies: **8952**",
    "created_at": "2012-10-02T13:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158119",
    "user": "https://github.com/nathanncohen"
}
```

Dependencies: **8952**



---

archive/issue_comments_158120.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOk.. Well, here is a new patch that depends on 8952. The other difference between your code and the current one is that your code cannot use the \"girth\" computation to avoid looking for useless cycles. I updated 8952 so that is_odd_hole_free first computes the graph's odd_girth before anything, and then begins to check the existence of odd cycles.\n\nAnd I can now update this patch. I was not too keen on replacing the code at first, but I have to admit that it is muuuuuuch cleaner like that. You're right ! `;-)`\n\nNathann",
    "created_at": "2012-10-02T13:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158120",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:10" align="right">comment:10</div>

Ok.. Well, here is a new patch that depends on 8952. The other difference between your code and the current one is that your code cannot use the "girth" computation to avoid looking for useless cycles. I updated 8952 so that is_odd_hole_free first computes the graph's odd_girth before anything, and then begins to check the existence of odd cycles.

And I can now update this patch. I was not too keen on replacing the code at first, but I have to admit that it is muuuuuuch cleaner like that. You're right ! `;-)`

Nathann



---

archive/issue_comments_158121.json:
```json
{
    "body": "Changed dependencies from **8952** to **#8952**",
    "created_at": "2012-11-27T18:19:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158121",
    "user": "https://github.com/dcoudert"
}
```

Changed dependencies from **8952** to **#8952**



---

archive/issue_comments_158122.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTrying to understand the bug... with sage-5.6.rc0 I get:\n\n```\nsage: time s_907 = set(g.sparse6_string() for g in graphs.nauty_geng('7') if g.is_perfect())\nTime: CPU 29.02 s, Wall: 29.74 s\nsage: len(s_907)\n907\nsave(s_907, '907_perfect_graph.sobj') \n```\n\nWith sage-5.6.rc0 + the patch:\n\n```\nsage: time s_906 = set(g.sparse6_string() for g in graphs.nauty_geng('7') if g.is_perfect())\nTime: CPU 25.30 s, Wall: 26.32 s\nsage: len(s_906)\n906\nsage: s_907 = load('907_perfect_graph.sobj')\nsage: s_906.issubset(s_907)\nTrue\nsage: len(s_907.difference(s_906))\n1\nsage: a = s_907.difference(s_906).pop()\nsage: a\n':FgGE@I@GxGs'\nsage: Graph(a)\nLooped multi-graph on 7 vertices\nsage: Graph(a).show()\n```\n\nWith sage-5.6.rc0 and no patch applied:\n\n```\nsage: for g in graphs.nauty_geng('7'):\n....:     if g.sparse6_string() == ':FgGE@I@GxGs':\n....:         break\n....:         \nsage: g\nGraph on 7 vertices\nsage: g.to_dictionary()\n{0: [2, 3, 4, 5], 1: [3, 4, 5, 6], 2: [0, 4, 5, 6], 3: [0, 1, 5, 6], 4: [0, 1, 2, 6], 5: [0, 1, 2, 3], 6: [1, 2, 3, 4]}\n```\n\nStarting from scratch. With sage-5.6.rc0, I get True with this graph:\n\n```\nsage: g = Graph({0: [2, 3, 4, 5], 1: [3, 4, 5, 6], 2: [0, 4, 5, 6], 3: [0, 1, 5, 6], 4: [0, 1, 2, 6], 5: [0, 1, 2, 3], 6: [1, 2, 3, 4]})\nsage: g.is_perfect()\nTrue\n```\n\nStrangely, I get a runtime error if I reconstruct the graph from the sparse string:\n\n```\nsage: Graph(':FgGE@I@GxGs').is_perfect()\nTraceback (most recent call last):\n...\nRuntimeError: Segmentation fault\n```\n\nI don't know what this sparse string is doing... It does not seem to be injective for instance... Anyway.\n\nWith sage-5.6.rc0 + the patch, everything is fine:\n\n```\nsage: Graph(':FgGE@I@GxGs').is_perfect()\nFalse\nsage: g = Graph({0: [2, 3, 4, 5], 1: [3, 4, 5, 6], 2: [0, 4, 5, 6], 3: [0, 1, 5, 6], 4: [0, 1, 2, 6], 5: [0, 1, 2, 3], 6: [1, 2, 3, 4]})\nsage: g.is_perfect()\nFalse\n```\n\nCan we add this previous doctest in the patch? because there is no doctest in the patch in its actual version. It would have to be an optional one since it depends on the optional package nauty....\n\nThere is something I still do not understand (related to sparse string). `is_perfect` does not seem to be preserve under the passage to the `sparse6_string`... Only 818 of the graph are still perfect after the recovery... All this would be more easy if graphs were hashable... Anyways...\n\n```\nage: time s = set(g.sparse6_string() for g in graphs.nauty_geng('7') if g.is_perfect())\nTime: CPU 24.94 s, Wall: 24.99 s\nsage: L = [Graph(g).is_perfect() for g in s]\nsage: all(L)\nFalse\nsage: import collections\nsage: collections.Counter(L)\nCounter({False: 818, True: 88})\n```",
    "created_at": "2013-01-24T17:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158122",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:12" align="right">comment:12</div>

Trying to understand the bug... with sage-5.6.rc0 I get:

```
sage: time s_907 = set(g.sparse6_string() for g in graphs.nauty_geng('7') if g.is_perfect())
Time: CPU 29.02 s, Wall: 29.74 s
sage: len(s_907)
907
save(s_907, '907_perfect_graph.sobj') 
```

With sage-5.6.rc0 + the patch:

```
sage: time s_906 = set(g.sparse6_string() for g in graphs.nauty_geng('7') if g.is_perfect())
Time: CPU 25.30 s, Wall: 26.32 s
sage: len(s_906)
906
sage: s_907 = load('907_perfect_graph.sobj')
sage: s_906.issubset(s_907)
True
sage: len(s_907.difference(s_906))
1
sage: a = s_907.difference(s_906).pop()
sage: a
':FgGE@I@GxGs'
sage: Graph(a)
Looped multi-graph on 7 vertices
sage: Graph(a).show()
```

With sage-5.6.rc0 and no patch applied:

```
sage: for g in graphs.nauty_geng('7'):
....:     if g.sparse6_string() == ':FgGE@I@GxGs':
....:         break
....:         
sage: g
Graph on 7 vertices
sage: g.to_dictionary()
{0: [2, 3, 4, 5], 1: [3, 4, 5, 6], 2: [0, 4, 5, 6], 3: [0, 1, 5, 6], 4: [0, 1, 2, 6], 5: [0, 1, 2, 3], 6: [1, 2, 3, 4]}
```

Starting from scratch. With sage-5.6.rc0, I get True with this graph:

```
sage: g = Graph({0: [2, 3, 4, 5], 1: [3, 4, 5, 6], 2: [0, 4, 5, 6], 3: [0, 1, 5, 6], 4: [0, 1, 2, 6], 5: [0, 1, 2, 3], 6: [1, 2, 3, 4]})
sage: g.is_perfect()
True
```

Strangely, I get a runtime error if I reconstruct the graph from the sparse string:

```
sage: Graph(':FgGE@I@GxGs').is_perfect()
Traceback (most recent call last):
...
RuntimeError: Segmentation fault
```

I don't know what this sparse string is doing... It does not seem to be injective for instance... Anyway.

With sage-5.6.rc0 + the patch, everything is fine:

```
sage: Graph(':FgGE@I@GxGs').is_perfect()
False
sage: g = Graph({0: [2, 3, 4, 5], 1: [3, 4, 5, 6], 2: [0, 4, 5, 6], 3: [0, 1, 5, 6], 4: [0, 1, 2, 6], 5: [0, 1, 2, 3], 6: [1, 2, 3, 4]})
sage: g.is_perfect()
False
```

Can we add this previous doctest in the patch? because there is no doctest in the patch in its actual version. It would have to be an optional one since it depends on the optional package nauty....

There is something I still do not understand (related to sparse string). `is_perfect` does not seem to be preserve under the passage to the `sparse6_string`... Only 818 of the graph are still perfect after the recovery... All this would be more easy if graphs were hashable... Anyways...

```
age: time s = set(g.sparse6_string() for g in graphs.nauty_geng('7') if g.is_perfect())
Time: CPU 24.94 s, Wall: 24.99 s
sage: L = [Graph(g).is_perfect() for g in s]
sage: all(L)
False
sage: import collections
sage: collections.Counter(L)
Counter({False: 818, True: 88})
```



---

archive/issue_comments_158123.json:
```json
{
    "body": "Reviewer: **S\u00e9bastien Labb\u00e9**",
    "created_at": "2013-01-24T17:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158123",
    "user": "https://github.com/seblabbe"
}
```

Reviewer: **Sébastien Labbé**



---

archive/issue_events_189929.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2013-01-24T17:19:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189929"
}
```



---

archive/issue_events_189930.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2013-01-24T17:19:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189930"
}
```



---

archive/issue_comments_158124.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nUpdated ! `:-)`\n\nNathann",
    "created_at": "2013-01-24T17:36:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158124",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:13" align="right">comment:13</div>

Updated ! `:-)`

Nathann



---

archive/issue_events_189931.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-01-24T17:36:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189931"
}
```



---

archive/issue_events_189932.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-01-24T17:36:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189932"
}
```



---

archive/issue_comments_158125.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAll test passed on `sage/graphs/generic_graph.py`. Documentation builds fine. Doctests which were broken before were added in the latest patch. To me it is a positive review. I let  \tJernej Azarija say a last word on it.",
    "created_at": "2013-01-24T18:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158125",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:14" align="right">comment:14</div>

All test passed on `sage/graphs/generic_graph.py`. Documentation builds fine. Doctests which were broken before were added in the latest patch. To me it is a positive review. I let  	Jernej Azarija say a last word on it.



---

archive/issue_comments_158126.json:
```json
{
    "body": "Changed reviewer from **S\u00e9bastien Labb\u00e9** to **Jernej Azarija, S\u00e9bastien Labb\u00e9**",
    "created_at": "2013-01-24T18:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158126",
    "user": "https://github.com/seblabbe"
}
```

Changed reviewer from **Sébastien Labbé** to **Jernej Azarija, Sébastien Labbé**



---

archive/issue_comments_158127.json:
```json
{
    "body": "Changed author from **Jernej Azarija** to **Nathann Cohen**",
    "created_at": "2013-01-24T18:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158127",
    "user": "https://github.com/seblabbe"
}
```

Changed author from **Jernej Azarija** to **Nathann Cohen**



---

archive/issue_comments_158128.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nJernej told me he has a question!\n\nWhat is the purpose of removing loops and multiple edges from the complement? Given a simple graph, does't sage produce a simple complement?",
    "created_at": "2013-01-25T11:12:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158128",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:15" align="right">comment:15</div>

Jernej told me he has a question!

What is the purpose of removing loops and multiple edges from the complement? Given a simple graph, does't sage produce a simple complement?



---

archive/issue_comments_158129.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nWell... Because Sebastien told me yesterday that \"there was a bug\" when he typed `Graph(mygraph.sparse6_string()).is_perfect`, and the reason is that when you build a graph from a sparse6 string, the graph (even tough it does not have loops nor multiple edges) *allows them*. And when you compute the complement of that graph, you get multiple edges and loops, which was a problem.\n\nWell. It's up to you, really. I don't care either way. And I hate labels, multiple edges, and loops `:-P`\n\nNathann",
    "created_at": "2013-01-25T11:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158129",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:16" align="right">comment:16</div>

Well... Because Sebastien told me yesterday that "there was a bug" when he typed `Graph(mygraph.sparse6_string()).is_perfect`, and the reason is that when you build a graph from a sparse6 string, the graph (even tough it does not have loops nor multiple edges) *allows them*. And when you compute the complement of that graph, you get multiple edges and loops, which was a problem.

Well. It's up to you, really. I don't care either way. And I hate labels, multiple edges, and loops `:-P`

Nathann



---

archive/issue_comments_158130.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI see!\n\nWell this looks more like a bug of the Graph constructor handling sparse6/graph6 strings. The named formats are used for simple graphs hence it is pointless to have them return non-simple graphs?",
    "created_at": "2013-01-25T11:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158130",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:17" align="right">comment:17</div>

I see!

Well this looks more like a bug of the Graph constructor handling sparse6/graph6 strings. The named formats are used for simple graphs hence it is pointless to have them return non-simple graphs?



---

archive/issue_comments_158131.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOh ! They can't store graphs with multiples labels, nor loops ? Then I'd be glad to make them simple graphs by default `:-D`\n\nNathann",
    "created_at": "2013-01-25T11:36:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158131",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:18" align="right">comment:18</div>

Oh ! They can't store graphs with multiples labels, nor loops ? Then I'd be glad to make them simple graphs by default `:-D`

Nathann



---

archive/issue_comments_158132.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nWell, unfortunately sparse6 string supports multiple edges `:-P`\n\nNathann",
    "created_at": "2013-01-25T11:38:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158132",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:19" align="right">comment:19</div>

Well, unfortunately sparse6 string supports multiple edges `:-P`

Nathann



---

archive/issue_comments_158133.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHello!\n\nSince someone may be using this thing on simple and non-simple graphs and expect the non-simple case to yield something different than we currently do (automatically false?) I propose to either\n\n* Document that non-simple graphs are going to be treated as simple\n\n* Simply test at the beginning if the graph is simple and return an exception if it is not. \n\nI like this last option better since the notion of a perfect graph is defined for simple graphs so if the user is sending something that is non-simple it is his problem to handle that!",
    "created_at": "2013-01-29T23:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158133",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:20" align="right">comment:20</div>

Hello!

Since someone may be using this thing on simple and non-simple graphs and expect the non-simple case to yield something different than we currently do (automatically false?) I propose to either

* Document that non-simple graphs are going to be treated as simple

* Simply test at the beginning if the graph is simple and return an exception if it is not. 

I like this last option better since the notion of a perfect graph is defined for simple graphs so if the user is sending something that is non-simple it is his problem to handle that!



---

archive/issue_comments_158134.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHello !!\n\n> Since someone may be using this thing on simple and non-simple graphs and expect the non-simple case to yield something different than we currently do\n\nNo way. If somebody calls this method, he/she wants to test a simple graph. No other way. If they expect anything by giving non-simple digraphs, it would be getting incoherent results.\n\n> * Document that non-simple graphs are going to be treated as simple\n\nPerfect graphs are only defined for simple graphs.\n\n> * Simply test at the beginning if the graph is simple and return an exception if it is not. \n> \n> I like this last option better since the notion of a perfect graph is defined for simple graphs so if the user is sending something that is non-simple it is his problem to handle that!\n\nThe point is that in the situation of sparse6 strings, the graph given is simple but *allows* loops and multiple edges.\n\nNathann",
    "created_at": "2013-01-30T13:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158134",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:21" align="right">comment:21</div>

Hello !!

> Since someone may be using this thing on simple and non-simple graphs and expect the non-simple case to yield something different than we currently do

No way. If somebody calls this method, he/she wants to test a simple graph. No other way. If they expect anything by giving non-simple digraphs, it would be getting incoherent results.

> * Document that non-simple graphs are going to be treated as simple

Perfect graphs are only defined for simple graphs.

> * Simply test at the beginning if the graph is simple and return an exception if it is not. 
> 
> I like this last option better since the notion of a perfect graph is defined for simple graphs so if the user is sending something that is non-simple it is his problem to handle that!

The point is that in the situation of sparse6 strings, the graph given is simple but *allows* loops and multiple edges.

Nathann



---

archive/issue_comments_158135.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nPatch updated to filter non-simple graphs !\n\nNathann",
    "created_at": "2013-01-30T13:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158135",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:22" align="right">comment:22</div>

Patch updated to filter non-simple graphs !

Nathann



---

archive/issue_comments_158136.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nEeeh... I should refrain from posting things late at night - I am writing confusing stuff...\n\nAnyhow. I am aware of the sparse6 issue but in my opinion that is an issue of how we currently handle sparse6 strings! So if we enforce the simplicity rule in is_perfect then at some point someone will perhaps get annoyed and want an option of the form \n\n```\nGraph('sparse6_string',force_simplicity=True)\n```\n\ninstead of Sage having to guess if the user sent a sparse6 graph that was converted to a non-simple graph etc... Or perhaps the Graph() constructor could check if the resulting graph is simple and automatically flag it as such.\n\nThank you for taking my comment into relevance! \n\nAs far as I see, the patch need not remove loops and multiple edges from the complement now?",
    "created_at": "2013-01-30T14:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158136",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:23" align="right">comment:23</div>

Eeeh... I should refrain from posting things late at night - I am writing confusing stuff...

Anyhow. I am aware of the sparse6 issue but in my opinion that is an issue of how we currently handle sparse6 strings! So if we enforce the simplicity rule in is_perfect then at some point someone will perhaps get annoyed and want an option of the form 

```
Graph('sparse6_string',force_simplicity=True)
```

instead of Sage having to guess if the user sent a sparse6 graph that was converted to a non-simple graph etc... Or perhaps the Graph() constructor could check if the resulting graph is simple and automatically flag it as such.

Thank you for taking my comment into relevance! 

As far as I see, the patch need not remove loops and multiple edges from the complement now?



---

archive/issue_comments_158137.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n> Anyhow. I am aware of the sparse6 issue but in my opinion that is an issue of how we currently handle sparse6 strings! So if we enforce the simplicity rule in is_perfect then at some point someone will perhaps get annoyed and want an option of the form \n\nRight now there is no problem with sparse6 strings, because the functions does not check whether the graph ALLOWS loops and multiple edges, but whether it HAS some. So the exception is not raised for sparse6 string, and is only raised if there is a loop in the graph, or multiple edges.\n\n> As far as I see, the patch need not remove loops and multiple edges from the complement now?\n\nIt is still needed, for instance for graphs coming from sparse6, because even though they contain no multiple edges and loops they allow it. So the complement will have multiple edges.\n\nActually, the problem is probably that taking the complement of a graph that allows loops will add loops and multiple edges to the graph, and I don't really think that's a good behaviour.\n\nNathann",
    "created_at": "2013-01-30T17:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158137",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:24" align="right">comment:24</div>

> Anyhow. I am aware of the sparse6 issue but in my opinion that is an issue of how we currently handle sparse6 strings! So if we enforce the simplicity rule in is_perfect then at some point someone will perhaps get annoyed and want an option of the form 

Right now there is no problem with sparse6 strings, because the functions does not check whether the graph ALLOWS loops and multiple edges, but whether it HAS some. So the exception is not raised for sparse6 string, and is only raised if there is a loop in the graph, or multiple edges.

> As far as I see, the patch need not remove loops and multiple edges from the complement now?

It is still needed, for instance for graphs coming from sparse6, because even though they contain no multiple edges and loops they allow it. So the complement will have multiple edges.

Actually, the problem is probably that taking the complement of a graph that allows loops will add loops and multiple edges to the graph, and I don't really think that's a good behaviour.

Nathann



---

archive/issue_comments_158138.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI see !\n\nWell if a graph *allows* multiple edges and loops isn't it then by definition a non-simple graph?\n\nThings see, pretty messy to me if this is not so :-)",
    "created_at": "2013-01-30T17:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158138",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:25" align="right">comment:25</div>

I see !

Well if a graph *allows* multiple edges and loops isn't it then by definition a non-simple graph?

Things see, pretty messy to me if this is not so :-)



---

archive/issue_comments_158139.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n> Well if a graph *allows* multiple edges and loops isn't it then by definition a non-simple graph?\n\nWell, you will not find any math book telling you when a Sage graph is simple or not, so the usual definition is \"does it have a loop or an edge\" ?\n\nNathann",
    "created_at": "2013-01-30T18:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158139",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:26" align="right">comment:26</div>

> Well if a graph *allows* multiple edges and loops isn't it then by definition a non-simple graph?

Well, you will not find any math book telling you when a Sage graph is simple or not, so the usual definition is "does it have a loop or an edge" ?

Nathann



---

archive/issue_comments_158140.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nYeah but IMO this is not natural and consistent. \n\nSomehow it would imply that a DiGraph with 1 vertex (and any arc-less DiGraph for that matter) is in fact a Graph and hence that all generic methods for graphs should apply?\n\nHopefully my remarks do not sound like being too pedantic or impolite or something! I would just like to get a clear picture of why this needs be so",
    "created_at": "2013-01-30T18:11:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158140",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:27" align="right">comment:27</div>

Yeah but IMO this is not natural and consistent. 

Somehow it would imply that a DiGraph with 1 vertex (and any arc-less DiGraph for that matter) is in fact a Graph and hence that all generic methods for graphs should apply?

Hopefully my remarks do not sound like being too pedantic or impolite or something! I would just like to get a clear picture of why this needs be so



---

archive/issue_comments_158141.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThe question is this : if you have a graph and add the same edge twice, do you necessarily want your graph to have it twice or did you just add it twice by mistake ? Currently, in Sage :\n\n```\nsage: g = Graph()\nsage: g.add_edge(0,1)\nsage: g.add_edge(0,1)\nsage: g.add_edge(0,1)\nsage: g.size()\n1\nsage: g.edges()\n[(0, 1, None)]\n```\n\nIf we were to change this way of doing, then that graph would have multiple edges, while at the moment you would have to insist on allowing multiple edges if you want.\n\nNathann",
    "created_at": "2013-01-30T18:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158141",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:28" align="right">comment:28</div>

The question is this : if you have a graph and add the same edge twice, do you necessarily want your graph to have it twice or did you just add it twice by mistake ? Currently, in Sage :

```
sage: g = Graph()
sage: g.add_edge(0,1)
sage: g.add_edge(0,1)
sage: g.add_edge(0,1)
sage: g.size()
1
sage: g.edges()
[(0, 1, None)]
```

If we were to change this way of doing, then that graph would have multiple edges, while at the moment you would have to insist on allowing multiple edges if you want.

Nathann



---

archive/issue_comments_158142.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nYes!\n\nWhat confuses me is this. Suppose I allow multiple edges from a graph G why is it then not treated as being non-simple.\n\nWhat about the remark on handling sparse6 strings? If a sparse6 string represents a simple graph there is no need to return a graph allowing multiple edges?",
    "created_at": "2013-01-30T18:20:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158142",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:29" align="right">comment:29</div>

Yes!

What confuses me is this. Suppose I allow multiple edges from a graph G why is it then not treated as being non-simple.

What about the remark on handling sparse6 strings? If a sparse6 string represents a simple graph there is no need to return a graph allowing multiple edges?



---

archive/issue_comments_158143.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nYo !\n\n> What confuses me is this. Suppose I allow multiple edges from a graph G why is it then not treated as being non-simple.\n\nThere's nothing called \"simple\" graph is Sage. What we have is 4 methods : has_loops, allows_loops, has_multiple_edges, allows_multiple_edges. I don't know why that's how it got written, but that's how it is. We can change that of course, and even define a is_simple function. But well, that's how it is.\n\n> What about the remark on handling sparse6 strings? If a sparse6 string represents a simple graph there is no need to return a graph allowing multiple edges?\n\nIt means that whether a graph allows loops depends on whether the sparse6 string you feed it with allows it. So if you store 1000 sparse6 string and load them all, some of the graphs you get will allow multiple edges and loops, some others will not. I think that this would be dirty.\n\nWhat could be done is this :\n\n```\nGraph(my_string, allow_loops = True, allow_multiple_edges = True)\n```\nreturs graphs allowing loops and multiple edges.\n\n```\nGraph(my_string, allow_loops = False)\n```\nraises an exception if the string does not correspond to a non-simple graph.\n\nThe point is that you wouldn't create graphs allowing loops and multiple edges by mistake.\n\nNathann",
    "created_at": "2013-01-30T18:49:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158143",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:30" align="right">comment:30</div>

Yo !

> What confuses me is this. Suppose I allow multiple edges from a graph G why is it then not treated as being non-simple.

There's nothing called "simple" graph is Sage. What we have is 4 methods : has_loops, allows_loops, has_multiple_edges, allows_multiple_edges. I don't know why that's how it got written, but that's how it is. We can change that of course, and even define a is_simple function. But well, that's how it is.

> What about the remark on handling sparse6 strings? If a sparse6 string represents a simple graph there is no need to return a graph allowing multiple edges?

It means that whether a graph allows loops depends on whether the sparse6 string you feed it with allows it. So if you store 1000 sparse6 string and load them all, some of the graphs you get will allow multiple edges and loops, some others will not. I think that this would be dirty.

What could be done is this :

```
Graph(my_string, allow_loops = True, allow_multiple_edges = True)
```
returs graphs allowing loops and multiple edges.

```
Graph(my_string, allow_loops = False)
```
raises an exception if the string does not correspond to a non-simple graph.

The point is that you wouldn't create graphs allowing loops and multiple edges by mistake.

Nathann



---

archive/issue_comments_158144.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nHello!\n\nThanks for the clarifications.\n\nWhat I don't like is this. The \"looped\" here implies as if the graph is non-simple.\n\n```\nsage: G = graphs.PetersenGraph()  \nsage: G\nPetersen graph: Graph on 10 vertices\nsage: Graph(G.sparse6_string())   \nLooped multi-graph on 10 vertices\n```\n\nI see that this is not an issue with is_perfect hence I'll flag this ticket with a positive review. But I really don't like the current way we are handling multigraphs as it introduces messy situations and I would really like to get a clear distinctions for this.",
    "created_at": "2013-02-01T10:38:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158144",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:31" align="right">comment:31</div>

Hello!

Thanks for the clarifications.

What I don't like is this. The "looped" here implies as if the graph is non-simple.

```
sage: G = graphs.PetersenGraph()  
sage: G
Petersen graph: Graph on 10 vertices
sage: Graph(G.sparse6_string())   
Looped multi-graph on 10 vertices
```

I see that this is not an issue with is_perfect hence I'll flag this ticket with a positive review. But I really don't like the current way we are handling multigraphs as it introduces messy situations and I would really like to get a clear distinctions for this.



---

archive/issue_events_189933.json:
```json
{
    "actor": "https://github.com/sagetrac-azi",
    "created_at": "2013-02-01T10:38:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189933"
}
```



---

archive/issue_events_189934.json:
```json
{
    "actor": "https://github.com/sagetrac-azi",
    "created_at": "2013-02-01T10:38:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189934"
}
```



---

archive/issue_comments_158145.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nWhat would you thing of modifying the constructor as I said above ?\n\nThanks for the review !\n\nNathann",
    "created_at": "2013-02-01T12:13:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158145",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:32" align="right">comment:32</div>

What would you thing of modifying the constructor as I said above ?

Thanks for the review !

Nathann



---

archive/issue_comments_158146.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThis would definitely solve part of the problem but I am not sure how elegant it'd be. I am afraid this would increase the complexity of all these constructors while not solving the problem at the root - which somehow I think is related to a design issue handling simple and non-simple graphs together!",
    "created_at": "2013-02-01T12:22:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158146",
    "user": "https://github.com/sagetrac-azi"
}
```

<div id="comment:33" align="right">comment:33</div>

This would definitely solve part of the problem but I am not sure how elegant it'd be. I am afraid this would increase the complexity of all these constructors while not solving the problem at the root - which somehow I think is related to a design issue handling simple and non-simple graphs together!



---

archive/issue_comments_158147.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThis needs to be rebased to sage-5.7.beta2.",
    "created_at": "2013-02-01T16:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158147",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

This needs to be rebased to sage-5.7.beta2.



---

archive/issue_events_189935.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-01T16:33:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189935"
}
```



---

archive/issue_events_189936.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-01T16:33:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189936"
}
```



---

archive/issue_comments_158148.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nWell, because of that segfault with Sage I can't run tests, be it on my office's computer or on my laptop `:-/`\n\nNathann",
    "created_at": "2013-02-02T10:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158148",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:35" align="right">comment:35</div>

Well, because of that segfault with Sage I can't run tests, be it on my office's computer or on my laptop `:-/`

Nathann



---

archive/issue_comments_158149.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nApply trac_13546.2.patch",
    "created_at": "2013-02-03T20:56:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158149",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:36" align="right">comment:36</div>

Apply trac_13546.2.patch



---

archive/issue_comments_158150.json:
```json
{
    "body": "Attachment: **[trac_13546.2.patch.gz](https://github.com/sagemath/sage/files/ticket13546/trac_13546.2.patch.gz)**",
    "created_at": "2013-02-04T10:20:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158150",
    "user": "https://github.com/nathanncohen"
}
```

Attachment: **[trac_13546.2.patch.gz](https://github.com/sagemath/sage/files/ticket13546/trac_13546.2.patch.gz)**



---

archive/issue_events_189937.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-02-04T10:48:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189937"
}
```



---

archive/issue_events_189938.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-02-04T10:48:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189938"
}
```



---

archive/issue_comments_158151.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,5 @@\n \n I propose to rewrite a correct algorithm perhaps using the  polynomial algorithm (www.comp.leeds.ac.uk/vuskovi/FOCS03final.ps).\n \n+Apply :\n+* [attachment: trac_13546.2.patch](https://github.com/sagemath/sage/files/ticket13546/trac_13546.2.patch.gz)\n``````\n",
    "created_at": "2013-02-04T10:48:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158151",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,5 @@
 
 I propose to rewrite a correct algorithm perhaps using the  polynomial algorithm (www.comp.leeds.ac.uk/vuskovi/FOCS03final.ps).
 
+Apply :
+* [attachment: trac_13546.2.patch](https://github.com/sagemath/sage/files/ticket13546/trac_13546.2.patch.gz)
``````




---

archive/issue_comments_158152.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nGood to go ! I had to ask David to check it on his computer as Sage segfaults on mine on exit,  which prevents me from running tests `:-/`\n\nNathann",
    "created_at": "2013-02-04T10:48:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158152",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:37" align="right">comment:37</div>

Good to go ! I had to ask David to check it on his computer as Sage segfaults on mine on exit,  which prevents me from running tests `:-/`

Nathann



---

archive/issue_events_189939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-09T12:12:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189939"
}
```



---

archive/issue_events_189940.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-09T12:12:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13546#event-189940"
}
```



---

archive/issue_comments_158153.json:
```json
{
    "body": "Merged: **sage-5.7.beta4**",
    "created_at": "2013-02-09T12:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13546#issuecomment-158153",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.7.beta4**
