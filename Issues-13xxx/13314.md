# Issue 13314: segmentation fault with roots over ComplexField

archive/issues_013142.json:
```json
{
    "assignees": [
        "https://github.com/burcin"
    ],
    "body": "this was reported to me by Benjamin Dadoun:\n\n```\nsage: CC=ComplexField(128)\nsage: z=polygen(CC, 'z')\nsage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315708974074167296*z^80 + 279189840125316599983095153558720348160*z^76 - 110522928999596165272398266482588385280*z^72 + 31087466142071580858231009754176552960*z^68 - 6606701181888932299640001500276588544*z^64 + 1101219301431275611150985571298443264*z^60 - 147498447216213728441335387395194880*z^56 + 16134143217737051761322600788131840*z^52 - 1456690062677843407408776850964480*z^48 + 109261914698248556477361418141696*z^44 - 6829504668478678587441535778816*z^40 + 355736441058167833075415777280*z^36 - 15393873200469425036030115840*z^32 + 549832294277433090197422080*z^28 - 16038265915694612515651584*z^24 + 375931794881970935169024*z^20 - 6911153168471496130560*z^16 + 95997158355731169280*z^12 - 947428403886210560*z^8 + 5921977682886976*z^4 - 17626570956801\nsage: p.roots(ring=CC)\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/users/caramel/bdadoun/Desktop/ceval/<ipython console> in <module>()\n\n/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python2\\\n.7/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.poly\\\nnomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_el\\\nement.c:31093)()\n\n/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python2\\\n.7/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.gen.polroots (sage\\\n/libs/pari/gen.c:35318)()\n\nRuntimeError: Segmentation fault\n```\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg) (diff: [attachment: pari-2.5.2.p1.diff](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz))\n\n**apply** [attachment: 13314_polroots_test.patch](https://github.com/sagemath/sage/files/ticket13314/13314_polroots_test.patch.gz)\n\nDepends on #13320\nDepends on #12346\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\nCC:  @jdemeyer @JohnCremona\n\nComponent: **calculus**\n\nAuthor: **Paul Zimmermann, Jeroen Demeyer**\n\nReviewer: **John Cremona**\n\nMerged: **sage-5.4.beta0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13314_\n\n",
    "closed_at": "2012-09-03T14:13:21Z",
    "created_at": "2012-07-31T16:01:37Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20calculus",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "segmentation fault with roots over ComplexField",
    "type": "issue",
    "updated_at": "2012-09-03T14:23:08Z",
    "url": "https://github.com/sagemath/sage/issues/13314",
    "user": "https://github.com/zimmermann6"
}
```
this was reported to me by Benjamin Dadoun:

```
sage: CC=ComplexField(128)
sage: z=polygen(CC, 'z')
sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315708974074167296*z^80 + 279189840125316599983095153558720348160*z^76 - 110522928999596165272398266482588385280*z^72 + 31087466142071580858231009754176552960*z^68 - 6606701181888932299640001500276588544*z^64 + 1101219301431275611150985571298443264*z^60 - 147498447216213728441335387395194880*z^56 + 16134143217737051761322600788131840*z^52 - 1456690062677843407408776850964480*z^48 + 109261914698248556477361418141696*z^44 - 6829504668478678587441535778816*z^40 + 355736441058167833075415777280*z^36 - 15393873200469425036030115840*z^32 + 549832294277433090197422080*z^28 - 16038265915694612515651584*z^24 + 375931794881970935169024*z^20 - 6911153168471496130560*z^16 + 95997158355731169280*z^12 - 947428403886210560*z^8 + 5921977682886976*z^4 - 17626570956801
sage: p.roots(ring=CC)
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/users/caramel/bdadoun/Desktop/ceval/<ipython console> in <module>()

/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python2\
.7/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.poly\
nomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_el\
ement.c:31093)()

/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python2\
.7/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.gen.polroots (sage\
/libs/pari/gen.c:35318)()

RuntimeError: Segmentation fault
```

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg) (diff: [attachment: pari-2.5.2.p1.diff](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz))

**apply** [attachment: 13314_polroots_test.patch](https://github.com/sagemath/sage/files/ticket13314/13314_polroots_test.patch.gz)

Depends on #13320
Depends on #12346

Upstream: **Fixed upstream, but not in a stable release.**

CC:  @jdemeyer @JohnCremona

Component: **calculus**

Author: **Paul Zimmermann, Jeroen Demeyer**

Reviewer: **John Cremona**

Merged: **sage-5.4.beta0**

_Issue created by migration from https://trac.sagemath.org/ticket/13314_





---

archive/issue_events_183934.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-07-31T16:01:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183934"
}
```



---

archive/issue_events_183935.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-07-31T16:01:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183935"
}
```



---

archive/issue_events_183936.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-07-31T16:01:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183936"
}
```



---

archive/issue_events_183937.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-07-31T16:01:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183937"
}
```



---

archive/issue_events_183938.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2012-07-31T16:01:37Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "subject": "https://github.com/zimmermann6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183938"
}
```



---

archive/issue_comments_153980.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI get the same with Sage 5.2 [rc0] built from source on Ubuntu 10.04.4 LTS x86_64 (GCC 4.7.0).",
    "created_at": "2012-07-31T16:56:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153980",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:1" align="right">comment:1</div>

I get the same with Sage 5.2 [rc0] built from source on Ubuntu 10.04.4 LTS x86_64 (GCC 4.7.0).



---

archive/issue_comments_153981.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nFWIW, the segfault occurs in the PARI library, and apparently depends on the precision of the complex field (works for me with up to 64 bits).",
    "created_at": "2012-07-31T17:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153981",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:2" align="right">comment:2</div>

FWIW, the segfault occurs in the PARI library, and apparently depends on the precision of the complex field (works for me with up to 64 bits).



---

archive/issue_comments_153982.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nyes the Seg. fault occurs for a precision of 65 bits or more. However I was unable to reproduce it using the GP interpreter (with version 2.5.0). It would be easier to report upstream if we can reproduce it using GP than the Pari library.\n\nPaul",
    "created_at": "2012-08-01T06:32:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153982",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:3" align="right">comment:3</div>

yes the Seg. fault occurs for a precision of 65 bits or more. However I was unable to reproduce it using the GP interpreter (with version 2.5.0). It would be easier to report upstream if we can reproduce it using GP than the Pari library.

Paul



---

archive/issue_comments_153983.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI tried to trace the error down to the Pari library. In file `rootpol.c`, function\n`roots_aux`, the segmentation fault happens in the call to `roots_com` with\n`l=4` and `bit_accuracy(l)=128` where `p` is (as printed by the Pari `output`\nfunction):\n\n```\n(1.00000000000000000000000000000000000000+0.E-38*I)*z^84+(0.E-38+0.E-38*I)*z^83+(0.E-38+0.E-38*I)*z^82+(0.E-38+0.E-38*I)*z^81+(-1.31262215974857454625635000411421060562+0.E-38*I)*z^80+(0.E-38+0.E-38*I)*z^79+(0.E-38+0.E-38*I)*z^78+(0.E-38+0.E-38*I)*z^77+(0.82046519968571818282043750514276325703+0.E-38*I)*z^76+(0.E-38+0.E-38*I)*z^75+(0.E-38+0.E-38*I)*z^74+(0.E-38+0.E-38*I)*z^73+(-0.324797696688395171049634768678515683860+0.E-38*I)*z^72+(0.E-38+0.E-38*I)*z^71+(0.E-38+0.E-38*I)*z^70+(0.E-38+0.E-38*I)*z^69+(0.091357852078460689143613038254443381448+0.E-38*I)*z^68+(0.E-38+0.E-38*I)*z^67+(0.E-38+0.E-38*I)*z^66+(0.E-38+0.E-38*I)*z^65+(-0.0194153497922034252412722132863365231970+0.E-38*I)*z^64+(0.E-38+0.E-38*I)*z^63+(0.E-38+0.E-38*I)*z^62+(0.E-38+0.E-38*I)*z^61+(0.00323619266962232567325444265726730463939+0.E-38*I)*z^60+(0.E-38+0.E-38*I)*z^59+(0.E-38+0.E-38*I)*z^58+(0.E-38+0.E-38*I)*z^57+(-0.000433458978644296491914756665198016349904+0.E-38*I)*z^56+(0.E-38+0.E-38*I)*z^55+(0.E-38+0.E-38*I)*z^54+(0.E-38+0.E-38*I)*z^53+(4.74139855195190713770398956497520437380E-5+0.E-38*I)*z^52+(0.E-38+0.E-38*I)*z^51+(0.E-38+0.E-38*I)*z^50+(0.E-38+0.E-38*I)*z^49+(-4.2808273489419220927898795386466919422E-6+0.E-38*I)*z^48+(0.E-38+0.E-38*I)*z^47+(0.E-38+0.E-38*I)*z^46+(0.E-38+0.E-38*I)*z^45+(3.21091908719544601469774304001807661846E-7+0.E-38*I)*z^44+(0.E-38+0.E-38*I)*z^43+(0.E-38+0.E-38*I)*z^42+(0.E-38+0.E-38*I)*z^41+(-2.00701103917778153737692276628195892519E-8+0.E-38*I)*z^40+(0.E-38+0.E-38*I)*z^39+(0.E-38+0.E-38*I)*z^38+(0.E-38+0.E-38*I)*z^37+(1.04541544211375485185820631903782289784E-9+0.E-38*I)*z^36+(0.E-38+0.E-38*I)*z^35+(0.E-38+0.E-38*I)*z^34+(0.E-38+0.E-38*I)*z^33+(-4.52385274610660402740066744025679312462E-11+0.E-38*I)*z^32+(0.E-38+0.E-38*I)*z^31+(0.E-38+0.E-38*I)*z^30+(0.E-38+0.E-38*I)*z^29+(1.61581188955695039273058373628568909992E-12+0.E-38*I)*z^28+(0.E-38+0.E-38*I)*z^27+(0.E-38+0.E-38*I)*z^26+(0.E-38+0.E-38*I)*z^25+(-4.71322274522116476238604321139902691134E-14+0.E-38*I)*z^24+(0.E-38+0.E-38*I)*z^23+(0.E-38+0.E-38*I)*z^22+(0.E-38+0.E-38*I)*z^21+(1.10476425294559942483778527936674858155E-15+0.E-38*I)*z^20+(0.E-38+0.E-38*I)*z^19+(0.E-38+0.E-38*I)*z^18+(0.E-38+0.E-38*I)*z^17+(-2.03100537680144918840320161959898939477E-17+0.E-38*I)*z^16+(0.E-38+0.E-38*I)*z^15+(0.E-38+0.E-38*I)*z^14+(0.E-38+0.E-38*I)*z^13+(2.82110293355386359309869812795381913797E-19+0.E-38*I)*z^12+(0.E-38+0.E-38*I)*z^11+(0.E-38+0.E-38*I)*z^10+(0.E-38+0.E-38*I)*z^9+(-2.78424184144204274350181426076550186938E-21+0.E-38*I)*z^8+(0.E-38+0.E-38*I)*z^7+(0.E-38+0.E-38*I)*z^6+(0.E-38+0.E-38*I)*z^5+(1.74031282798232506192330105295904480920E-23+0.E-38*I)*z^4+(0.E-38+0.E-38*I)*z^3+(0.E-38+0.E-38*I)*z^2+(0.E-38+0.E-38*I)*z+(-5.1799836460219446701130005742251516370E-26+0.E-38*I)\n```\nPaul",
    "created_at": "2012-08-01T13:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153983",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:4" align="right">comment:4</div>

I tried to trace the error down to the Pari library. In file `rootpol.c`, function
`roots_aux`, the segmentation fault happens in the call to `roots_com` with
`l=4` and `bit_accuracy(l)=128` where `p` is (as printed by the Pari `output`
function):

```
(1.00000000000000000000000000000000000000+0.E-38*I)*z^84+(0.E-38+0.E-38*I)*z^83+(0.E-38+0.E-38*I)*z^82+(0.E-38+0.E-38*I)*z^81+(-1.31262215974857454625635000411421060562+0.E-38*I)*z^80+(0.E-38+0.E-38*I)*z^79+(0.E-38+0.E-38*I)*z^78+(0.E-38+0.E-38*I)*z^77+(0.82046519968571818282043750514276325703+0.E-38*I)*z^76+(0.E-38+0.E-38*I)*z^75+(0.E-38+0.E-38*I)*z^74+(0.E-38+0.E-38*I)*z^73+(-0.324797696688395171049634768678515683860+0.E-38*I)*z^72+(0.E-38+0.E-38*I)*z^71+(0.E-38+0.E-38*I)*z^70+(0.E-38+0.E-38*I)*z^69+(0.091357852078460689143613038254443381448+0.E-38*I)*z^68+(0.E-38+0.E-38*I)*z^67+(0.E-38+0.E-38*I)*z^66+(0.E-38+0.E-38*I)*z^65+(-0.0194153497922034252412722132863365231970+0.E-38*I)*z^64+(0.E-38+0.E-38*I)*z^63+(0.E-38+0.E-38*I)*z^62+(0.E-38+0.E-38*I)*z^61+(0.00323619266962232567325444265726730463939+0.E-38*I)*z^60+(0.E-38+0.E-38*I)*z^59+(0.E-38+0.E-38*I)*z^58+(0.E-38+0.E-38*I)*z^57+(-0.000433458978644296491914756665198016349904+0.E-38*I)*z^56+(0.E-38+0.E-38*I)*z^55+(0.E-38+0.E-38*I)*z^54+(0.E-38+0.E-38*I)*z^53+(4.74139855195190713770398956497520437380E-5+0.E-38*I)*z^52+(0.E-38+0.E-38*I)*z^51+(0.E-38+0.E-38*I)*z^50+(0.E-38+0.E-38*I)*z^49+(-4.2808273489419220927898795386466919422E-6+0.E-38*I)*z^48+(0.E-38+0.E-38*I)*z^47+(0.E-38+0.E-38*I)*z^46+(0.E-38+0.E-38*I)*z^45+(3.21091908719544601469774304001807661846E-7+0.E-38*I)*z^44+(0.E-38+0.E-38*I)*z^43+(0.E-38+0.E-38*I)*z^42+(0.E-38+0.E-38*I)*z^41+(-2.00701103917778153737692276628195892519E-8+0.E-38*I)*z^40+(0.E-38+0.E-38*I)*z^39+(0.E-38+0.E-38*I)*z^38+(0.E-38+0.E-38*I)*z^37+(1.04541544211375485185820631903782289784E-9+0.E-38*I)*z^36+(0.E-38+0.E-38*I)*z^35+(0.E-38+0.E-38*I)*z^34+(0.E-38+0.E-38*I)*z^33+(-4.52385274610660402740066744025679312462E-11+0.E-38*I)*z^32+(0.E-38+0.E-38*I)*z^31+(0.E-38+0.E-38*I)*z^30+(0.E-38+0.E-38*I)*z^29+(1.61581188955695039273058373628568909992E-12+0.E-38*I)*z^28+(0.E-38+0.E-38*I)*z^27+(0.E-38+0.E-38*I)*z^26+(0.E-38+0.E-38*I)*z^25+(-4.71322274522116476238604321139902691134E-14+0.E-38*I)*z^24+(0.E-38+0.E-38*I)*z^23+(0.E-38+0.E-38*I)*z^22+(0.E-38+0.E-38*I)*z^21+(1.10476425294559942483778527936674858155E-15+0.E-38*I)*z^20+(0.E-38+0.E-38*I)*z^19+(0.E-38+0.E-38*I)*z^18+(0.E-38+0.E-38*I)*z^17+(-2.03100537680144918840320161959898939477E-17+0.E-38*I)*z^16+(0.E-38+0.E-38*I)*z^15+(0.E-38+0.E-38*I)*z^14+(0.E-38+0.E-38*I)*z^13+(2.82110293355386359309869812795381913797E-19+0.E-38*I)*z^12+(0.E-38+0.E-38*I)*z^11+(0.E-38+0.E-38*I)*z^10+(0.E-38+0.E-38*I)*z^9+(-2.78424184144204274350181426076550186938E-21+0.E-38*I)*z^8+(0.E-38+0.E-38*I)*z^7+(0.E-38+0.E-38*I)*z^6+(0.E-38+0.E-38*I)*z^5+(1.74031282798232506192330105295904480920E-23+0.E-38*I)*z^4+(0.E-38+0.E-38*I)*z^3+(0.E-38+0.E-38*I)*z^2+(0.E-38+0.E-38*I)*z+(-5.1799836460219446701130005742251516370E-26+0.E-38*I)
```
Paul



---

archive/issue_comments_153984.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\ninvestigation is underway with the help of the Pari developers.\n\nPaul",
    "created_at": "2012-08-01T15:08:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153984",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:5" align="right">comment:5</div>

investigation is underway with the help of the Pari developers.

Paul



---

archive/issue_comments_153985.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nfor the record, here are the instructions from the Pari developers to (try to) reproduce the problem with Pari: first remove the `static` declaration for the function `roots_com`,\nthen add `gpwritebin(\"/tmp/gp.tmp\", p);` before the `roots_com` call in `rootpol.c`, then under GP:\n\n```\n? install(\"roots_com\", GL)\n? pol = read(\"/tmp/gp.tmp\");\n> ? roots_com(pol, 4)\n  ***   bug in PARI/GP (Segmentation Fault), please report\n  ***   Break loop: type 'break' to go back to GP\n```\nPaul",
    "created_at": "2012-08-02T06:35:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153985",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:6" align="right">comment:6</div>

for the record, here are the instructions from the Pari developers to (try to) reproduce the problem with Pari: first remove the `static` declaration for the function `roots_com`,
then add `gpwritebin("/tmp/gp.tmp", p);` before the `roots_com` call in `rootpol.c`, then under GP:

```
? install("roots_com", GL)
? pol = read("/tmp/gp.tmp");
> ? roots_com(pol, 4)
  ***   bug in PARI/GP (Segmentation Fault), please report
  ***   Break loop: type 'break' to go back to GP
```
Paul



---

archive/issue_comments_153986.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nwe are unable to reproduce the Segmentation fault from GP:\n\n```\n? install(\"roots_com\", GL)\n? pol = read(\"/tmp/gp.tmp\");\n? var = roots_com(p, 128)\n%2 = [0.E-38]\n```\nPaul",
    "created_at": "2012-08-02T06:57:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153986",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:7" align="right">comment:7</div>

we are unable to reproduce the Segmentation fault from GP:

```
? install("roots_com", GL)
? pol = read("/tmp/gp.tmp");
? var = roots_com(p, 128)
%2 = [0.E-38]
```
Paul



---

archive/issue_comments_153987.json:
```json
{
    "body": "Upstream: **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2012-08-02T09:30:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153987",
    "user": "https://github.com/zimmermann6"
}
```

Upstream: **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_153988.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nKarim Belabas tells me he can now reproduce the Segmentation fault with Pari 2.5.2, but not with 2.6.*.\n\nPaul",
    "created_at": "2012-08-02T09:30:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153988",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:8" align="right">comment:8</div>

Karim Belabas tells me he can now reproduce the Segmentation fault with Pari 2.5.2, but not with 2.6.*.

Paul



---

archive/issue_comments_153989.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2012-08-03T09:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153989",
    "user": "https://github.com/zimmermann6"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_153990.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nthe bug is fixed with the following Pari patch (from Karim Belabas):\n\n```\n    fix typo introduced in 7b985ff8a726e89191d2733b9052b2e2c228bfde\n    \"minor improvements root_error()\"\n    prod was not re-initialized to 1.\n\ndiff --git a/src/basemath/rootpol.c b/src/basemath/rootpol.c\nindex 3099bb2..0be400f 100644\n--- a/src/basemath/rootpol.c\n+++ b/src/basemath/rootpol.c\n@@ -1611,8 +1611,8 @@ split_0(GEN p, long bit, GEN *F, GEN *G)\n static GEN\n root_error(long n, long k, GEN roots_pol, long pari_err, GEN shatzle)\n {\n-  GEN rho, d, eps, epsbis, eps2, prod, aux, rap = NULL;\n-  long i, j, m;\n+  GEN rho, d, eps, epsbis, eps2, aux, rap = NULL;\n+  long i, j;\n\n   d = cgetg(n+1,t_VEC);\n   for (i=1; i<=n; i++)\n@@ -1627,11 +1627,11 @@ root_error(long n, long k, GEN roots_pol, long pari_err\\\n, GEN shatzle)\n   if (expo(rho) < 0) rho = real_1(DEFAULTPREC);\n   eps = mulrr(rho, shatzle);\n   aux = shiftr(powru(rho,n), pari_err);\n-  prod = NULL; /* 1. */\n\n   for (j=1; j<=2 || (j<=5 && cmprr(rap, dbltor(1.2)) > 0); j++)\n   {\n-    m = n;\n+    GEN prod = NULL; /* 1. */\n+    long m = n;\n     epsbis = mulrr(eps, dbltor(1.25));\n     for (i=1; i<=n; i++)\n     {\n```\nNote this bug is fixed in the \"master\" branch upstream (2.6.*, no official release yet).\n\nPaul\n\nPS: I leave for 3 weeks of vacations, feel free to submit a proper patch in the meantime.",
    "created_at": "2012-08-03T09:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153990",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:9" align="right">comment:9</div>

the bug is fixed with the following Pari patch (from Karim Belabas):

```
    fix typo introduced in 7b985ff8a726e89191d2733b9052b2e2c228bfde
    "minor improvements root_error()"
    prod was not re-initialized to 1.

diff --git a/src/basemath/rootpol.c b/src/basemath/rootpol.c
index 3099bb2..0be400f 100644
--- a/src/basemath/rootpol.c
+++ b/src/basemath/rootpol.c
@@ -1611,8 +1611,8 @@ split_0(GEN p, long bit, GEN *F, GEN *G)
 static GEN
 root_error(long n, long k, GEN roots_pol, long pari_err, GEN shatzle)
 {
-  GEN rho, d, eps, epsbis, eps2, prod, aux, rap = NULL;
-  long i, j, m;
+  GEN rho, d, eps, epsbis, eps2, aux, rap = NULL;
+  long i, j;

   d = cgetg(n+1,t_VEC);
   for (i=1; i<=n; i++)
@@ -1627,11 +1627,11 @@ root_error(long n, long k, GEN roots_pol, long pari_err\
, GEN shatzle)
   if (expo(rho) < 0) rho = real_1(DEFAULTPREC);
   eps = mulrr(rho, shatzle);
   aux = shiftr(powru(rho,n), pari_err);
-  prod = NULL; /* 1. */

   for (j=1; j<=2 || (j<=5 && cmprr(rap, dbltor(1.2)) > 0); j++)
   {
-    m = n;
+    GEN prod = NULL; /* 1. */
+    long m = n;
     epsbis = mulrr(eps, dbltor(1.25));
     for (i=1; i<=n; i++)
     {
```
Note this bug is fixed in the "master" branch upstream (2.6.*, no official release yet).

Paul

PS: I leave for 3 weeks of vacations, feel free to submit a proper patch in the meantime.



---

archive/issue_comments_153991.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nsince nobody did a patch, I will try. How to do a patch to a standard spkg? Should I build a\nnew one?\n\nPaul",
    "created_at": "2012-08-29T07:31:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153991",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:10" align="right">comment:10</div>

since nobody did a patch, I will try. How to do a patch to a standard spkg? Should I build a
new one?

Paul



---

archive/issue_comments_153992.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@zimmermann6](#comment%3A10):\n> since nobody did a patch, I will try.\n\nJeroen usually merges such fixes to the pari package immediately. Perhaps he hasn't seen this yet.\n\n> How to do a patch to a standard spkg? Should I build a\n> new one?\n\nThe usual way is to create a new package and bump the revision number, from pari-2.5.2.p0 to pari-2.5.2.p1 for example.\n\n\nThanks for following up on this.",
    "created_at": "2012-08-29T10:20:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153992",
    "user": "https://github.com/burcin"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@zimmermann6](#comment%3A10):
> since nobody did a patch, I will try.

Jeroen usually merges such fixes to the pari package immediately. Perhaps he hasn't seen this yet.

> How to do a patch to a standard spkg? Should I build a
> new one?

The usual way is to create a new package and bump the revision number, from pari-2.5.2.p0 to pari-2.5.2.p1 for example.


Thanks for following up on this.



---

archive/issue_comments_153993.json:
```json
{
    "body": "Author: **Paul Zimmermann**",
    "created_at": "2012-08-29T12:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153993",
    "user": "https://github.com/zimmermann6"
}
```

Author: **Paul Zimmermann**



---

archive/issue_events_183939.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-08-29T12:40:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183939"
}
```



---

archive/issue_comments_153994.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI've put a new spkg at http://www.loria.fr/~zimmerma/pari-2.5.1.p4.spkg.\nPlease be cool with me since it is the first time I update a spkg.\n\nPaul",
    "created_at": "2012-08-29T12:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153994",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:12" align="right">comment:12</div>

I've put a new spkg at http://www.loria.fr/~zimmerma/pari-2.5.1.p4.spkg.
Please be cool with me since it is the first time I update a spkg.

Paul



---

archive/issue_comments_153995.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nCould you please put a link to the upstream bug tracker for futute reference?\n\nFor the spkg, this should be based on the most recent version, which is pari-2.5.2.  I can take care of that.",
    "created_at": "2012-08-29T12:46:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153995",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Could you please put a link to the upstream bug tracker for futute reference?

For the spkg, this should be based on the most recent version, which is pari-2.5.2.  I can take care of that.



---

archive/issue_comments_153996.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nExcept for not committing the changes the to hg repository, it seems you made the spkg correctly.",
    "created_at": "2012-08-29T12:52:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153996",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Except for not committing the changes the to hg repository, it seems you made the spkg correctly.



---

archive/issue_comments_153997.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n this was reported to me by Benjamin Dadoun:\n \n ```\n-\n sage: CC=ComplexField(128)\n sage: z=polygen(CC, 'z')\n sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315\\\n@@ -32,3 +31,5 @@\n \n RuntimeError: Segmentation fault\n ```\n+\n+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg) (diff: [attachment: pari-2.5.2.p1.diff](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz))\n``````\n",
    "created_at": "2012-08-29T12:56:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153997",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
 this was reported to me by Benjamin Dadoun:
 
 ```
-
 sage: CC=ComplexField(128)
 sage: z=polygen(CC, 'z')
 sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315\
@@ -32,3 +31,5 @@
 
 RuntimeError: Segmentation fault
 ```
+
+**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg) (diff: [attachment: pari-2.5.2.p1.diff](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz))
``````




---

archive/issue_comments_153998.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[pari-2.5.2.p1.diff.gz](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz)**",
    "created_at": "2012-08-29T12:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153998",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[pari-2.5.2.p1.diff.gz](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz)**



---

archive/issue_comments_153999.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,17 +3,7 @@\n ```\n sage: CC=ComplexField(128)\n sage: z=polygen(CC, 'z')\n-sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315\\\n-708974074167296*z^80 + 279189840125316599983095153558720348160*z^76 - 110522928\\\n-999596165272398266482588385280*z^72 + 31087466142071580858231009754176552960*z^\\\n-68 - 6606701181888932299640001500276588544*z^64 + 11012193014312756111509855712\\\n-98443264*z^60 - 147498447216213728441335387395194880*z^56 + 1613414321773705176\\\n-1322600788131840*z^52 - 1456690062677843407408776850964480*z^48 + 1092619146982\\\n-48556477361418141696*z^44 - 6829504668478678587441535778816*z^40 + 355736441058\\\n-167833075415777280*z^36 - 15393873200469425036030115840*z^32 + 5498322942774330\\\n-90197422080*z^28 - 16038265915694612515651584*z^24 + 375931794881970935169024*z\\\n-^20 - 6911153168471496130560*z^16 + 95997158355731169280*z^12 - 947428403886210\\\n-560*z^8 + 5921977682886976*z^4 - 17626570956801\n+sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315708974074167296*z^80 + 279189840125316599983095153558720348160*z^76 - 110522928999596165272398266482588385280*z^72 + 31087466142071580858231009754176552960*z^68 - 6606701181888932299640001500276588544*z^64 + 1101219301431275611150985571298443264*z^60 - 147498447216213728441335387395194880*z^56 + 16134143217737051761322600788131840*z^52 - 1456690062677843407408776850964480*z^48 + 109261914698248556477361418141696*z^44 - 6829504668478678587441535778816*z^40 + 355736441058167833075415777280*z^36 - 15393873200469425036030115840*z^32 + 549832294277433090197422080*z^28 - 16038265915694612515651584*z^24 + 375931794881970935169024*z^20 - 6911153168471496130560*z^16 + 95997158355731169280*z^12 - 947428403886210560*z^8 + 5921977682886976*z^4 - 17626570956801\n sage: p.roots(ring=CC)\n ---------------------------------------------------------------------------\n RuntimeError                              Traceback (most recent call last)\n``````\n",
    "created_at": "2012-08-29T12:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-153999",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,17 +3,7 @@
 ```
 sage: CC=ComplexField(128)
 sage: z=polygen(CC, 'z')
-sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315\
-708974074167296*z^80 + 279189840125316599983095153558720348160*z^76 - 110522928\
-999596165272398266482588385280*z^72 + 31087466142071580858231009754176552960*z^\
-68 - 6606701181888932299640001500276588544*z^64 + 11012193014312756111509855712\
-98443264*z^60 - 147498447216213728441335387395194880*z^56 + 1613414321773705176\
-1322600788131840*z^52 - 1456690062677843407408776850964480*z^48 + 1092619146982\
-48556477361418141696*z^44 - 6829504668478678587441535778816*z^40 + 355736441058\
-167833075415777280*z^36 - 15393873200469425036030115840*z^32 + 5498322942774330\
-90197422080*z^28 - 16038265915694612515651584*z^24 + 375931794881970935169024*z\
-^20 - 6911153168471496130560*z^16 + 95997158355731169280*z^12 - 947428403886210\
-560*z^8 + 5921977682886976*z^4 - 17626570956801
+sage: p=340282366920938463463374607431768211457*z^84 - 446662175392119146634315708974074167296*z^80 + 279189840125316599983095153558720348160*z^76 - 110522928999596165272398266482588385280*z^72 + 31087466142071580858231009754176552960*z^68 - 6606701181888932299640001500276588544*z^64 + 1101219301431275611150985571298443264*z^60 - 147498447216213728441335387395194880*z^56 + 16134143217737051761322600788131840*z^52 - 1456690062677843407408776850964480*z^48 + 109261914698248556477361418141696*z^44 - 6829504668478678587441535778816*z^40 + 355736441058167833075415777280*z^36 - 15393873200469425036030115840*z^32 + 549832294277433090197422080*z^28 - 16038265915694612515651584*z^24 + 375931794881970935169024*z^20 - 6911153168471496130560*z^16 + 95997158355731169280*z^12 - 947428403886210560*z^8 + 5921977682886976*z^4 - 17626570956801
 sage: p.roots(ring=CC)
 ---------------------------------------------------------------------------
 RuntimeError                              Traceback (most recent call last)
``````




---

archive/issue_comments_154000.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nJeroen,\n\nReplying to [@jdemeyer](#comment%3A13):\n> Could you please put a link to the upstream bug tracker for futute reference?\n> \n> For the spkg, this should be based on the most recent version, which is pari-2.5.2.  I can take care of that.\n\nyes please do!\n\nPaul",
    "created_at": "2012-08-29T12:59:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154000",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:17" align="right">comment:17</div>

Jeroen,

Replying to [@jdemeyer](#comment%3A13):
> Could you please put a link to the upstream bug tracker for futute reference?
> 
> For the spkg, this should be based on the most recent version, which is pari-2.5.2.  I can take care of that.

yes please do!

Paul



---

archive/issue_comments_154001.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,3 +23,5 @@\n ```\n \n **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg) (diff: [attachment: pari-2.5.2.p1.diff](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz))\n+\n+**apply** [attachment: 13314_polroots_test.patch](https://github.com/sagemath/sage/files/ticket13314/13314_polroots_test.patch.gz)\n``````\n",
    "created_at": "2012-08-29T13:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154001",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,3 +23,5 @@
 ```
 
 **spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/pari-2.5.2.p1.spkg) (diff: [attachment: pari-2.5.2.p1.diff](https://github.com/sagemath/sage/files/ticket13314/pari-2.5.2.p1.diff.gz))
+
+**apply** [attachment: 13314_polroots_test.patch](https://github.com/sagemath/sage/files/ticket13314/13314_polroots_test.patch.gz)
``````




---

archive/issue_comments_154002.json:
```json
{
    "body": "Changed author from **Paul Zimmermann** to **Paul Zimmermann, Jeroen Demeyer**",
    "created_at": "2012-08-29T13:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154002",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Paul Zimmermann** to **Paul Zimmermann, Jeroen Demeyer**



---

archive/issue_comments_154003.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAdded a regression test ;-)  Needs review.",
    "created_at": "2012-08-29T13:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154003",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Added a regression test ;-)  Needs review.



---

archive/issue_comments_154004.json:
```json
{
    "body": "Attachment: **[13314_polroots_test.patch.gz](https://github.com/sagemath/sage/files/ticket13314/13314_polroots_test.patch.gz)**",
    "created_at": "2012-09-03T11:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154004",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[13314_polroots_test.patch.gz](https://github.com/sagemath/sage/files/ticket13314/13314_polroots_test.patch.gz)**



---

archive/issue_comments_154005.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThere was one doctest failure on 32-bit systems, fixed now.\n\nStill needs review.",
    "created_at": "2012-09-03T11:45:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154005",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

There was one doctest failure on 32-bit systems, fixed now.

Still needs review.



---

archive/issue_comments_154006.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nJohn, please could you review that easy one?\n\nPaul",
    "created_at": "2012-09-03T12:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154006",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:20" align="right">comment:20</div>

John, please could you review that easy one?

Paul



---

archive/issue_comments_154007.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@zimmermann6](#comment%3A20):\n> John, please could you review that easy one?\n> \n> Paul\n\nOK -- should I install the new spkg using sage -f and then apply the patch and then test?  I think other spkgs depend on the pari one (e.g. eclib does) so I am not sure how that will work.\n\nJohn",
    "created_at": "2012-09-03T12:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154007",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@zimmermann6](#comment%3A20):
> John, please could you review that easy one?
> 
> Paul

OK -- should I install the new spkg using sage -f and then apply the patch and then test?  I think other spkgs depend on the pari one (e.g. eclib does) so I am not sure how that will work.

John



---

archive/issue_comments_154008.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nFirst of all: reviewing a ticket is mainly about looking at the patch and checking that it makes sense.\n\nIf `eclib` uses PARI to do root-finding over the complex numbers, then yes, it could affect `eclib`.  However, assuming `eclib` does dynamic linking, then it's not required to actually recompile `eclib`.  The upgraded PARI would automatically be used by `eclib`.\n\nSo, for a ticket like this, I would suggest to run *all* doctests in Sage (root-finding affects many things) but I don't think a full rebuild is needed.\n\nIn any case, any failures would be caught by the Buildbot.  So the worst that can happen is that you waste the time of the release manager and possibly anger him slightly if the failure is particularly obvious (e.g. if somebody edits file X and there are doctests failures in file X, then the author/reviewer did not do their due diligence).",
    "created_at": "2012-09-03T13:06:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154008",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

First of all: reviewing a ticket is mainly about looking at the patch and checking that it makes sense.

If `eclib` uses PARI to do root-finding over the complex numbers, then yes, it could affect `eclib`.  However, assuming `eclib` does dynamic linking, then it's not required to actually recompile `eclib`.  The upgraded PARI would automatically be used by `eclib`.

So, for a ticket like this, I would suggest to run *all* doctests in Sage (root-finding affects many things) but I don't think a full rebuild is needed.

In any case, any failures would be caught by the Buildbot.  So the worst that can happen is that you waste the time of the release manager and possibly anger him slightly if the failure is particularly obvious (e.g. if somebody edits file X and there are doctests failures in file X, then the author/reviewer did not do their due diligence).



---

archive/issue_comments_154009.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThanks.  I did what I said (built the new spkg with sage -f, then sage -b to rebuild which did trigger a lot of compilations, then applied the patch).  The touched files test OK, and I'm now testing everything (i.e. sage -t -long).\n\nThe last thing I would want to do is anger the release manager (even if only slightly)!\n\nThe Sage patch looks fine, and also the spkg patching (assuming that Karim has fixed this properly, which seems likely).",
    "created_at": "2012-09-03T13:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154009",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:23" align="right">comment:23</div>

Thanks.  I did what I said (built the new spkg with sage -f, then sage -b to rebuild which did trigger a lot of compilations, then applied the patch).  The touched files test OK, and I'm now testing everything (i.e. sage -t -long).

The last thing I would want to do is anger the release manager (even if only slightly)!

The Sage patch looks fine, and also the spkg patching (assuming that Karim has fixed this properly, which seems likely).



---

archive/issue_comments_154010.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAll good except:\n\n```\nsage -t -long devel/sage-main/sage/matrix/matrix_integer_dense.pyx\n**********************************************************************\nFile \"/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx\", line 4967:\n    sage: pari('mathnf(Mat([0,1]), 4)')\nExpected:\n    [Mat([0, 1]), [1, 0; 0, 1]]\nGot:\n    [Mat(1), [1, 0; 0, 1]]\n**********************************************************************\nFile \"/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx\", line 5040:\n    sage: pari('mathnf(Mat([0,1]), 4)')\nExpected:\n    [Mat([0, 1]), [1, 0; 0, 1]]\nGot:\n    [Mat(1), [1, 0; 0, 1]]\n**********************************************************************\n```\nwhich look strange to me (and also not relevant to the changes made)!",
    "created_at": "2012-09-03T13:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154010",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:24" align="right">comment:24</div>

All good except:

```
sage -t -long devel/sage-main/sage/matrix/matrix_integer_dense.pyx
**********************************************************************
File "/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx", line 4967:
    sage: pari('mathnf(Mat([0,1]), 4)')
Expected:
    [Mat([0, 1]), [1, 0; 0, 1]]
Got:
    [Mat(1), [1, 0; 0, 1]]
**********************************************************************
File "/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx", line 5040:
    sage: pari('mathnf(Mat([0,1]), 4)')
Expected:
    [Mat([0, 1]), [1, 0; 0, 1]]
Got:
    [Mat(1), [1, 0; 0, 1]]
**********************************************************************
```
which look strange to me (and also not relevant to the changes made)!



---

archive/issue_comments_154011.json:
```json
{
    "body": "Dependencies: **#13320, #12346**",
    "created_at": "2012-09-03T13:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154011",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#13320, #12346**



---

archive/issue_comments_154012.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@JohnCremona](#comment%3A24):\n> All good except:\n> \n> ```\n> sage -t -long devel/sage-main/sage/matrix/matrix_integer_dense.pyx\n> **********************************************************************\n> File \"/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx\", line 4967:\n>     sage: pari('mathnf(Mat([0,1]), 4)')\n> Expected:\n>     [Mat([0, 1]), [1, 0; 0, 1]]\n> Got:\n>     [Mat(1), [1, 0; 0, 1]]\n> **********************************************************************\n> File \"/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx\", line 5040:\n>     sage: pari('mathnf(Mat([0,1]), 4)')\n> Expected:\n>     [Mat([0, 1]), [1, 0; 0, 1]]\n> Got:\n>     [Mat(1), [1, 0; 0, 1]]\n> **********************************************************************\n> ```\n\nApply the patch from #12346 (merged in sage-5.3.beta2, I assume you use an older version).",
    "created_at": "2012-09-03T13:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154012",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@JohnCremona](#comment%3A24):
> All good except:
> 
> ```
> sage -t -long devel/sage-main/sage/matrix/matrix_integer_dense.pyx
> **********************************************************************
> File "/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx", line 4967:
>     sage: pari('mathnf(Mat([0,1]), 4)')
> Expected:
>     [Mat([0, 1]), [1, 0; 0, 1]]
> Got:
>     [Mat(1), [1, 0; 0, 1]]
> **********************************************************************
> File "/home/jec/sage-5.3.beta1/devel/sage-main/sage/matrix/matrix_integer_dense.pyx", line 5040:
>     sage: pari('mathnf(Mat([0,1]), 4)')
> Expected:
>     [Mat([0, 1]), [1, 0; 0, 1]]
> Got:
>     [Mat(1), [1, 0; 0, 1]]
> **********************************************************************
> ```

Apply the patch from #12346 (merged in sage-5.3.beta2, I assume you use an older version).



---

archive/issue_comments_154013.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nSorry, I was using beta1 and did not know about the dependencies.  Watch this space...",
    "created_at": "2012-09-03T14:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154013",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:26" align="right">comment:26</div>

Sorry, I was using beta1 and did not know about the dependencies.  Watch this space...



---

archive/issue_events_183940.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2012-09-03T14:12:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183940"
}
```



---

archive/issue_events_183941.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2012-09-03T14:12:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183941"
}
```



---

archive/issue_comments_154014.json:
```json
{
    "body": "Reviewer: **John Cremona**",
    "created_at": "2012-09-03T14:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154014",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona**



---

archive/issue_comments_154015.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@JohnCremona](#comment%3A26):\n> Sorry, I was using beta1 and did not know about the dependencies.  Watch this space...\n\nOK now with that patch!",
    "created_at": "2012-09-03T14:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154015",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@JohnCremona](#comment%3A26):
> Sorry, I was using beta1 and did not know about the dependencies.  Watch this space...

OK now with that patch!



---

archive/issue_events_183942.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-03T14:13:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183942"
}
```



---

archive/issue_events_183943.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-03T14:13:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183943"
}
```



---

archive/issue_comments_154016.json:
```json
{
    "body": "Merged: **sage-5.4.beta0**",
    "created_at": "2012-09-03T14:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154016",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.4.beta0**



---

archive/issue_events_183944.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-03T14:13:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "milestone_number": null,
    "milestone_title": "sage-5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183944"
}
```



---

archive/issue_events_183945.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-03T14:13:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13314#event-183945"
}
```



---

archive/issue_comments_154017.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nthank you very much John for the efficient review!\n\nPaul",
    "created_at": "2012-09-03T14:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13314#issuecomment-154017",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:29" align="right">comment:29</div>

thank you very much John for the efficient review!

Paul
