# Issue 13211: Upgrade GAP to 4.5.7

archive/issues_013039.json:
```json
{
    "assignees": [],
    "body": "While we are at it, move the gap install to `$SAGE_LOCAL/gap/gap.x.y.z`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `latest` -> `gap-x.y.z` so that not every script has to figure out the current version number. This follows what is usually done with java, another offender who can't install in a standards-compliant manner:\n\n```\n[vbraun@laptop ~]$ ll /usr/java\ntotal 8\ndrwxr-xr-x. 3 root root 4096 Jul  9 17:37 jdk1.7.0_03\ndrwxr-xr-x. 8 root root 4096 Jul  9 17:37 jdk1.7.0_05\nlrwxrwxrwx. 1 root root   21 Jul  9 17:37 latest -> /usr/java/jdk1.7.0_05\n```\n\nUpdated spkgs:\n* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg \n* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.7.spkg \n* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.7.spkg\n\nApply to SAGE_ROOT\n* [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) \n\n Apply\n* [attachment: trac_13211_fix_gap_doctests_vb.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests_vb.patch.gz)\n* [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n* [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)\n* [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)\n\nDepends on #13123\nDepends on #13579\n\nCC:  @ppurka @dimpase @miguelmarco @jhpalmieri @rbeezer @vbraun @burcin\n\nUpstream: **Reported upstream. Developers acknowledge bug.**\n\nReviewer: **Dmitrii Pasechnik**\n\nAuthor: **Volker Braun, Jeroen Demeyer**\n\nMerged: **sage-5.6.beta1**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13211_\n\n",
    "closed_at": "2012-12-26T13:20:10Z",
    "created_at": "2012-07-07T13:28:54Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade GAP to 4.5.7",
    "type": "issue",
    "updated_at": "2013-01-25T12:19:53Z",
    "url": "https://github.com/sagemath/sage/issues/13211",
    "user": "https://github.com/kini"
}
```
While we are at it, move the gap install to `$SAGE_LOCAL/gap/gap.x.y.z`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `latest` -> `gap-x.y.z` so that not every script has to figure out the current version number. This follows what is usually done with java, another offender who can't install in a standards-compliant manner:

```
[vbraun@laptop ~]$ ll /usr/java
total 8
drwxr-xr-x. 3 root root 4096 Jul  9 17:37 jdk1.7.0_03
drwxr-xr-x. 8 root root 4096 Jul  9 17:37 jdk1.7.0_05
lrwxrwxrwx. 1 root root   21 Jul  9 17:37 latest -> /usr/java/jdk1.7.0_05
```

Updated spkgs:
* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg 
* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.7.spkg 
* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.7.spkg

Apply to SAGE_ROOT
* [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) 

 Apply
* [attachment: trac_13211_fix_gap_doctests_vb.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests_vb.patch.gz)
* [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
* [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)
* [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)

Depends on #13123
Depends on #13579

CC:  @ppurka @dimpase @miguelmarco @jhpalmieri @rbeezer @vbraun @burcin

Upstream: **Reported upstream. Developers acknowledge bug.**

Reviewer: **Dmitrii Pasechnik**

Author: **Volker Braun, Jeroen Demeyer**

Merged: **sage-5.6.beta1**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/13211_





---

archive/issue_events_183759.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-07-07T13:28:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183759"
}
```



---

archive/issue_events_183760.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-07-07T13:28:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183760"
}
```



---

archive/issue_events_183761.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-07-07T13:28:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183761"
}
```



---

archive/issue_events_183762.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-07-07T13:28:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183762"
}
```



---

archive/issue_comments_151623.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-As title.\n+As title. Currently 4.5.4 is out, but there are plans for 4.5.5 (just a minor update) to come out soon.\n``````\n",
    "created_at": "2012-07-08T06:28:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151623",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-As title.
+As title. Currently 4.5.4 is out, but there are plans for 4.5.5 (just a minor update) to come out soon.
``````




---

archive/issue_events_183763.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-07-08T06:28:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "title_is": "Upgrade GAP to 4.5",
    "title_was": "Upgrade GAP to 4.5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183763"
}
```



---

archive/issue_comments_151624.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFrom the GAP website:  \"The current version is GAP 4.5.5 released on July 17th, 2012.\"",
    "created_at": "2012-07-26T05:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151624",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:3" align="right">comment:3</div>

From the GAP website:  "The current version is GAP 4.5.5 released on July 17th, 2012."



---

archive/issue_comments_151625.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n-As title. Currently 4.5.4 is out, but there are plans for 4.5.5 (just a minor update) to come out soon.\n+While we are at it, move the gap install to `$SAGE_LOCAL`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `gap-newest` -> `gap-x.y.z` so that not every script has to figure out the current version number.\n+\n+Updated spkgs:\n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.5.spkg \n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.5.spkg \n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.5.spkg\n+\n``````\n",
    "created_at": "2012-08-27T02:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151625",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,7 @@
-As title. Currently 4.5.4 is out, but there are plans for 4.5.5 (just a minor update) to come out soon.
+While we are at it, move the gap install to `$SAGE_LOCAL`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `gap-newest` -> `gap-x.y.z` so that not every script has to figure out the current version number.
+
+Updated spkgs:
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.5.spkg 
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.5.spkg 
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.5.spkg
+
``````




---

archive/issue_comments_151626.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2012-08-27T02:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151626",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_183764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-08-27T02:45:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "title_is": "Upgrade GAP to 4.5.5",
    "title_was": "Upgrade GAP to 4.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183764"
}
```



---

archive/issue_comments_151627.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAnd of course the random number generator (random group element) in GAP changed, yay!",
    "created_at": "2012-08-27T02:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151627",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

And of course the random number generator (random group element) in GAP changed, yay!



---

archive/issue_comments_151628.json:
```json
{
    "body": "Changed keywords from none to **rng**",
    "created_at": "2012-08-27T02:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151628",
    "user": "https://github.com/vbraun"
}
```

Changed keywords from none to **rng**



---

archive/issue_comments_151629.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt could also be a good moment to include as many gap packages as possible in the gap_packages spkg. I made a list with the licenses of some packages [1] and a spkg with those  packages that have gpl license and i was able to make install seamlessly [2].\n\nIt was all for 4.4.12 version, but should be easily ported to 4.5\n\n[1] https://docs.google.com/spreadsheet/ccc?key=0AvB7eBQ-W5NGdDN2X1NVQnUyQ24tQ05CQzRlVVh2Rmc\n[2] https://docs.google.com/open?id=0B_B7eBQ-W5NGWUUzQzYxdFRqaXM",
    "created_at": "2012-08-27T09:39:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151629",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:7" align="right">comment:7</div>

It could also be a good moment to include as many gap packages as possible in the gap_packages spkg. I made a list with the licenses of some packages [1] and a spkg with those  packages that have gpl license and i was able to make install seamlessly [2].

It was all for 4.4.12 version, but should be easily ported to 4.5

[1] https://docs.google.com/spreadsheet/ccc?key=0AvB7eBQ-W5NGdDN2X1NVQnUyQ24tQ05CQzRlVVh2Rmc
[2] https://docs.google.com/open?id=0B_B7eBQ-W5NGWUUzQzYxdFRqaXM



---

archive/issue_comments_151630.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nNo this is not a good moment to add features to gap. Make a separate ticket.",
    "created_at": "2012-08-27T10:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151630",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

No this is not a good moment to add features to gap. Make a separate ticket.



---

archive/issue_comments_151631.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@vbraun](#comment:8):\n> No this is not a good moment to add features to gap. Make a separate ticket.\n\nindeed, that can be done later. Let's upgrade first. \nBy the way, did you take care of #13341?",
    "created_at": "2012-08-27T11:19:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151631",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@vbraun](#comment:8):
> No this is not a good moment to add features to gap. Make a separate ticket.

indeed, that can be done later. Let's upgrade first. 
By the way, did you take care of #13341?



---

archive/issue_comments_151632.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI've based it on #13341 and tried to not touch any cygwin stuff. Though its probably save to say that cygwin broke, I don't have a Windows machine to test on.",
    "created_at": "2012-08-27T13:49:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151632",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

I've based it on #13341 and tried to not touch any cygwin stuff. Though its probably save to say that cygwin broke, I don't have a Windows machine to test on.



---

archive/issue_comments_151633.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAlso the new gap prints escape codes on Fedora 17, I've communicated this to the GAP devs here:\n\n```\n[vbraun@laptop ~]$ echo '1+1;' | sage -gap -q | od -c\n0000000 033   [   ?   1   0   3   4   h   2  \\n\n0000012\n```",
    "created_at": "2012-08-27T14:17:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151633",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

Also the new gap prints escape codes on Fedora 17, I've communicated this to the GAP devs here:

```
[vbraun@laptop ~]$ echo '1+1;' | sage -gap -q | od -c
0000000 033   [   ?   1   0   3   4   h   2  \n
0000012
```



---

archive/issue_comments_151634.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n-While we are at it, move the gap install to `$SAGE_LOCAL`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `gap-newest` -> `gap-x.y.z` so that not every script has to figure out the current version number.\n+While we are at it, move the gap install to `$SAGE_LOCAL/gap/gap.x.y.z`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `latest` -> `gap-x.y.z` so that not every script has to figure out the current version number. This follows what is usually done with java, another offender who can't install in a standards-compliant manner:\n+\n+```\n+[vbraun@laptop ~]$ ll /usr/java\n+total 8\n+drwxr-xr-x. 3 root root 4096 Jul  9 17:37 jdk1.7.0_03\n+drwxr-xr-x. 8 root root 4096 Jul  9 17:37 jdk1.7.0_05\n+lrwxrwxrwx. 1 root root   21 Jul  9 17:37 latest -> /usr/java/jdk1.7.0_05\n+```\n \n Updated spkgs:\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.5.spkg \n``````\n",
    "created_at": "2012-08-27T14:17:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151634",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
-While we are at it, move the gap install to `$SAGE_LOCAL`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `gap-newest` -> `gap-x.y.z` so that not every script has to figure out the current version number.
+While we are at it, move the gap install to `$SAGE_LOCAL/gap/gap.x.y.z`. Its not cool to put anything but libraries into `/lib`. Also, make a symlink `latest` -> `gap-x.y.z` so that not every script has to figure out the current version number. This follows what is usually done with java, another offender who can't install in a standards-compliant manner:
+
+```
+[vbraun@laptop ~]$ ll /usr/java
+total 8
+drwxr-xr-x. 3 root root 4096 Jul  9 17:37 jdk1.7.0_03
+drwxr-xr-x. 8 root root 4096 Jul  9 17:37 jdk1.7.0_05
+lrwxrwxrwx. 1 root root   21 Jul  9 17:37 latest -> /usr/java/jdk1.7.0_05
+```
 
 Updated spkgs:
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.5.spkg 
``````




---

archive/issue_comments_151635.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHere are test failures on my `OpenSUSE` laptop.\n\nMost of the tests fail because of changes in the random generator or because of slightly changed error messages or because of changing documentation in GAP or simply because of testing against the version number.\n\nHere are more serious problems:\n\n```\nFile \"/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/interfaces/gap.py\", line 1330:\n    sage: 'Centralizer' in s5.trait_names()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/simon/SAGE/prerelease/sage-5.2.rc0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/simon/SAGE/prerelease/sage-5.2.rc0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/simon/SAGE/prerelease/sage-5.2.rc0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_46[3]>\", line 1, in <module>\n        'Centralizer' in s5.trait_names()###line 1330:\n    sage: 'Centralizer' in s5.trait_names()\n      File \"/home/simon/SAGE/prerelease/sage-5.2.rc0/local/lib/python/site-packages/sage/interfaces/gap.py\", line 1338, in trait_names\n        v = eval(v)\n      File \"<string>\", line 4\n        \"in\", \"ShallowCopy\", <Attribute \"Name\",\n                             ^\n    SyntaxError: invalid syntax\n```\n\nIn sage/coding/linear_code.py are a few crashes, like this:\n\n```\nFile \"/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/linear_code.py\", line 2047:\n    sage: G.order()\nException raised:\n    Traceback (most recent call last):\n...\n    RuntimeError: Gap produced error output\n    Error, Variable: '$sage16' must have a value\n\n       executing Size($sage16);\n**********************************************************************\nFile \"/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/linear_code.py\", line 2716:\n    sage: C.zeta_polynomial()\nException raised:\n    Traceback (most recent call last):\n...\n    RuntimeError: Gap produced error output\n    Error, Variable: '$sage24' must have a value\n\n       executing Print($sage24);\n**********************************************************************\nFile \"/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/linear_code.py\", line 599:\n    sage: for B in self_orthogonal_binary_codes(7,3,4):\n       print B; print B.gen_mat()\nExpected:\n    Linear code of length 4, dimension 1 over Finite Field of size 2\n    [1 1 1 1]\n    Linear code of length 6, dimension 2 over Finite Field of size 2\n    [1 1 1 1 0 0]\n    [0 1 0 1 1 1]\n    Linear code of length 7, dimension 3 over Finite Field of size 2\n    [1 0 1 1 0 1 0]\n    [0 1 0 1 1 1 0]\n    [0 0 1 0 1 1 1]\nGot:\n    Linear code of length 4, dimension 1 over Finite Field of size 2\n    [1 1 1 1]\n    ** Gap crashed or quit executing 'Read(\"/home/simon/.sage//temp/linux_sqwp.site/18857//interface//tmp18907\");' **\n    Restarting Gap and trying again\n    Linear code of length 6, dimension 2 over Finite Field of size 2\n    [1 1 1 1 0 0]\n    [0 1 0 1 1 1]\n    Linear code of length 7, dimension 3 over Finite Field of size 2\n    [1 0 1 1 0 1 0]\n    [0 1 0 1 1 1 0]\n    [0 0 1 0 1 1 1]\n**********************************************************************\n```\n\nNote the crash in the last example. A similar crash is:\n\n```\nFile \"/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/code_constructions.py\", line 530:\n    sage: C.minimum_distance()\nExpected:\n    4\nGot:\n    ** Gap crashed or quit executing 'Read(\"/home/simon/.sage//temp/linux_sqwp.site/18774//interface//tmp18791\");' **\n    Restarting Gap and trying again\n    4\n```\n\nSeveral tests in latin.py fail, probably because of changes in the random generator. Couldn't one test instead whether the squares really *are* latin?\n\nA strange one:\n\n```\nFile \"/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/tests/cmdline.py\", line 359:\n    sage: out\nExpected:\n    '120\\n'\nGot:\n    '\\x1b[?1034h120\\n'\n```",
    "created_at": "2012-08-30T14:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151635",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

Here are test failures on my `OpenSUSE` laptop.

Most of the tests fail because of changes in the random generator or because of slightly changed error messages or because of changing documentation in GAP or simply because of testing against the version number.

Here are more serious problems:

```
File "/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/interfaces/gap.py", line 1330:
    sage: 'Centralizer' in s5.trait_names()
Exception raised:
    Traceback (most recent call last):
      File "/home/simon/SAGE/prerelease/sage-5.2.rc0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/simon/SAGE/prerelease/sage-5.2.rc0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/simon/SAGE/prerelease/sage-5.2.rc0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_46[3]>", line 1, in <module>
        'Centralizer' in s5.trait_names()###line 1330:
    sage: 'Centralizer' in s5.trait_names()
      File "/home/simon/SAGE/prerelease/sage-5.2.rc0/local/lib/python/site-packages/sage/interfaces/gap.py", line 1338, in trait_names
        v = eval(v)
      File "<string>", line 4
        "in", "ShallowCopy", <Attribute "Name",
                             ^
    SyntaxError: invalid syntax
```

In sage/coding/linear_code.py are a few crashes, like this:

```
File "/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/linear_code.py", line 2047:
    sage: G.order()
Exception raised:
    Traceback (most recent call last):
...
    RuntimeError: Gap produced error output
    Error, Variable: '$sage16' must have a value

       executing Size($sage16);
**********************************************************************
File "/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/linear_code.py", line 2716:
    sage: C.zeta_polynomial()
Exception raised:
    Traceback (most recent call last):
...
    RuntimeError: Gap produced error output
    Error, Variable: '$sage24' must have a value

       executing Print($sage24);
**********************************************************************
File "/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/linear_code.py", line 599:
    sage: for B in self_orthogonal_binary_codes(7,3,4):
       print B; print B.gen_mat()
Expected:
    Linear code of length 4, dimension 1 over Finite Field of size 2
    [1 1 1 1]
    Linear code of length 6, dimension 2 over Finite Field of size 2
    [1 1 1 1 0 0]
    [0 1 0 1 1 1]
    Linear code of length 7, dimension 3 over Finite Field of size 2
    [1 0 1 1 0 1 0]
    [0 1 0 1 1 1 0]
    [0 0 1 0 1 1 1]
Got:
    Linear code of length 4, dimension 1 over Finite Field of size 2
    [1 1 1 1]
    ** Gap crashed or quit executing 'Read("/home/simon/.sage//temp/linux_sqwp.site/18857//interface//tmp18907");' **
    Restarting Gap and trying again
    Linear code of length 6, dimension 2 over Finite Field of size 2
    [1 1 1 1 0 0]
    [0 1 0 1 1 1]
    Linear code of length 7, dimension 3 over Finite Field of size 2
    [1 0 1 1 0 1 0]
    [0 1 0 1 1 1 0]
    [0 0 1 0 1 1 1]
**********************************************************************
```

Note the crash in the last example. A similar crash is:

```
File "/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/coding/code_constructions.py", line 530:
    sage: C.minimum_distance()
Expected:
    4
Got:
    ** Gap crashed or quit executing 'Read("/home/simon/.sage//temp/linux_sqwp.site/18774//interface//tmp18791");' **
    Restarting Gap and trying again
    4
```

Several tests in latin.py fail, probably because of changes in the random generator. Couldn't one test instead whether the squares really *are* latin?

A strange one:

```
File "/home/simon/SAGE/prerelease/sage-5.2.rc0/devel/sage-main/sage/tests/cmdline.py", line 359:
    sage: out
Expected:
    '120\n'
Got:
    '\x1b[?1034h120\n'
```



---

archive/issue_comments_151636.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2012-08-30T15:51:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151636",
    "user": "https://github.com/vbraun"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_151637.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI've isolated a test case for the gap crashes and sent it to the GAP developers.",
    "created_at": "2012-08-30T15:51:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151637",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

I've isolated a test case for the gap crashes and sent it to the GAP developers.



---

archive/issue_comments_151638.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2012-08-30T17:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151638",
    "user": "https://github.com/vbraun"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_151639.json:
```json
{
    "body": "Changed keywords from **rng** to none",
    "created_at": "2012-08-30T17:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151639",
    "user": "https://github.com/vbraun"
}
```

Changed keywords from **rng** to none



---

archive/issue_comments_151640.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe crashes are all due to a GAP garbage collection bug in Z/2Z-specific code. I've fixed all other doctest errors. The only remaining ones are\n\n```\nsage -t  -force_lib devel/sage/sage/coding/code_constructions.py # 1 doctests failed\nsage -t  -force_lib devel/sage/sage/coding/linear_code.py # 3 doctests failed\n```",
    "created_at": "2012-08-30T17:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151640",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:14" align="right">comment:14</div>

The crashes are all due to a GAP garbage collection bug in Z/2Z-specific code. I've fixed all other doctest errors. The only remaining ones are

```
sage -t  -force_lib devel/sage/sage/coding/code_constructions.py # 1 doctests failed
sage -t  -force_lib devel/sage/sage/coding/linear_code.py # 3 doctests failed
```



---

archive/issue_comments_151641.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,3 +13,5 @@\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.5.spkg \n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.5.spkg\n \n+Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n+\n``````\n",
    "created_at": "2012-08-30T17:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151641",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,3 +13,5 @@
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.5.spkg 
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.5.spkg
 
+Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
+
``````




---

archive/issue_comments_151642.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI received a patch from the upstream developers, to be included in gap-4.5.6. I've updated the gap spkg with the fix, now the Sage testsuite runs without errors. I also updated the gap_packages spkg with a fix for a function name clash in braid-1.1 that broke the GAP testsuite (i.e. SAGE_CHECK=yes). So as far as I'm concerned we are good to go.\n\nI would appreciate a speedy review of this ticket *nudge* *nudge*",
    "created_at": "2012-09-02T11:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151642",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

I received a patch from the upstream developers, to be included in gap-4.5.6. I've updated the gap spkg with the fix, now the Sage testsuite runs without errors. I also updated the gap_packages spkg with a fix for a function name clash in braid-1.1 that broke the GAP testsuite (i.e. SAGE_CHECK=yes). So as far as I'm concerned we are good to go.

I would appreciate a speedy review of this ticket *nudge* *nudge*



---

archive/issue_events_183765.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-09-02T11:28:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183765"
}
```



---

archive/issue_comments_151643.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2012-09-02T11:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151643",
    "user": "https://github.com/vbraun"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_151644.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nInstalling the gap-4.5.5 spkg, the new gap packages and database gap spkgs worked fine on `openSuse` with `SAGE_CHECK=yes`. Now I'll start the Sage test suite.",
    "created_at": "2012-09-02T14:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151644",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Installing the gap-4.5.5 spkg, the new gap packages and database gap spkgs worked fine on `openSuse` with `SAGE_CHECK=yes`. Now I'll start the Sage test suite.



---

archive/issue_comments_151645.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThe Sage test suite passes as well. `hg status` has nothing to complain, in any of the three packages. And `SPKG.txt` is updated in all cases. Hence, from my perspective, it is a positive review. However, I'll repeat on bsd.math, and perhaps someone else can repeat on `openSolaris`.",
    "created_at": "2012-09-02T15:49:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151645",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:17" align="right">comment:17</div>

The Sage test suite passes as well. `hg status` has nothing to complain, in any of the three packages. And `SPKG.txt` is updated in all cases. Hence, from my perspective, it is a positive review. However, I'll repeat on bsd.math, and perhaps someone else can repeat on `openSolaris`.



---

archive/issue_comments_151646.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nPS: Unfortunately most test of the to-be-reviewed latest version of my p_group_cohomology spkg fail with the new versions of Singular and GAP. But I guess that's my own problem...",
    "created_at": "2012-09-02T15:51:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151646",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

PS: Unfortunately most test of the to-be-reviewed latest version of my p_group_cohomology spkg fail with the new versions of Singular and GAP. But I guess that's my own problem...



---

archive/issue_comments_151647.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nDear Volker and Simon,\n\nThanks very much for your work on this one.  I've been becoming a lot more familiar with the GAP interface this summer and getting undergraduate students involved, so I really appreciate your work getting this organized and reviewed.\n\nRob",
    "created_at": "2012-09-02T18:29:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151647",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:19" align="right">comment:19</div>

Dear Volker and Simon,

Thanks very much for your work on this one.  I've been becoming a lot more familiar with the GAP interface this summer and getting undergraduate students involved, so I really appreciate your work getting this organized and reviewed.

Rob



---

archive/issue_comments_151648.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOn two different OS X 10.7 machines, there is one doctest failure:\n\n```\nsage -t --long \"devel/sage/sage/interfaces/gap.py\"          \n**********************************************************************\nFile \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/devel/sage/sage/interfaces/gap.py\", line 521:\n    sage: a = gap(3)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_9[8]>\", line 1, in <module>\n        a = gap(Integer(3))###line 521:\n    sage: a = gap(3)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/interface.py\", line 197, in __call__\n        return self._coerce_from_special_method(x)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/interface.py\", line 223, in _coerce_from_special_method\n        return (x.__getattribute__(s))(self)\n      File \"sage_object.pyx\", line 463, in sage.structure.sage_object.SageObject._gap_ (sage/structure/sage_object.c:4529)\n      File \"sage_object.pyx\", line 439, in sage.structure.sage_object.SageObject._interface_ (sage/structure/sage_object.c:4129)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/interface.py\", line 195, in __call__\n        return cls(self, x, name=name)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/expect.py\", line 1330, in __init__\n        raise TypeError, x\n    TypeError: Gap produced error output\n    Error, user interrupt\n\n       executing $sage4:=3;;\n**********************************************************************\n```\nI'll try to build on OpenSolaris, too.",
    "created_at": "2012-09-02T22:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151648",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

On two different OS X 10.7 machines, there is one doctest failure:

```
sage -t --long "devel/sage/sage/interfaces/gap.py"          
**********************************************************************
File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/devel/sage/sage/interfaces/gap.py", line 521:
    sage: a = gap(3)
Exception raised:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_9[8]>", line 1, in <module>
        a = gap(Integer(3))###line 521:
    sage: a = gap(3)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/interface.py", line 197, in __call__
        return self._coerce_from_special_method(x)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/interface.py", line 223, in _coerce_from_special_method
        return (x.__getattribute__(s))(self)
      File "sage_object.pyx", line 463, in sage.structure.sage_object.SageObject._gap_ (sage/structure/sage_object.c:4529)
      File "sage_object.pyx", line 439, in sage.structure.sage_object.SageObject._interface_ (sage/structure/sage_object.c:4129)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/interface.py", line 195, in __call__
        return cls(self, x, name=name)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/local/lib/python/site-packages/sage/interfaces/expect.py", line 1330, in __init__
        raise TypeError, x
    TypeError: Gap produced error output
    Error, user interrupt

       executing $sage4:=3;;
**********************************************************************
```
I'll try to build on OpenSolaris, too.



---

archive/issue_comments_151649.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@jhpalmieri](#comment:20):\n> On two different OS X 10.7 machines, there is one doctest failure:\n> \n> ```\n> sage -t --long \"devel/sage/sage/interfaces/gap.py\"          \n> **********************************************************************\n> File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/devel/sage/sage/interfaces/gap.py\", line 521:\n>     sage: a = gap(3)\n> Exception raised:\n>     Traceback (most recent call last):\n> ...\n> ```\n> I'll try to build on OpenSolaris, too.\n\nWow. That's not good. I suppose that there are a lot of further errors. If `gap(3)` breaks then I guess most other gap stuff will break, too.\n\nFWIW, make ptest worked on my laptop and make ptestlong worked on bsd.math. The spkgs look fine, in terms of `hg status` and `SPKG.txt`.",
    "created_at": "2012-09-03T05:24:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151649",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@jhpalmieri](#comment:20):
> On two different OS X 10.7 machines, there is one doctest failure:
> 
> ```
> sage -t --long "devel/sage/sage/interfaces/gap.py"          
> **********************************************************************
> File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.3.rc0-gap/devel/sage/sage/interfaces/gap.py", line 521:
>     sage: a = gap(3)
> Exception raised:
>     Traceback (most recent call last):
> ...
> ```
> I'll try to build on OpenSolaris, too.

Wow. That's not good. I suppose that there are a lot of further errors. If `gap(3)` breaks then I guess most other gap stuff will break, too.

FWIW, make ptest worked on my laptop and make ptestlong worked on bsd.math. The spkgs look fine, in terms of `hg status` and `SPKG.txt`.



---

archive/issue_comments_151650.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThat is the only error, actually. I did `make ptestlong` and everything else passed.",
    "created_at": "2012-09-03T05:36:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151650",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

That is the only error, actually. I did `make ptestlong` and everything else passed.



---

archive/issue_comments_151651.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nA little more data: I can only get the doctest to fail if the system is somewhat loaded (for example, doing parallel doctests). If the system is idle, the doctest passes consistently; if it's loaded, the doctest fails consistently.\n\n(In more detail: I am remotely logging into the machine in my office at the university, and I know that no one else uses the machine. Running 'make ptestlong` gives a failure, running `./sage -tp 2 devel/sage/sage/interfaces/` gives a failure, running the doctest while I'm also building another installation of Sage gives a failure, while it passes when running the doctest by itself. It's quite repeatable.)",
    "created_at": "2012-09-03T05:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151651",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

A little more data: I can only get the doctest to fail if the system is somewhat loaded (for example, doing parallel doctests). If the system is idle, the doctest passes consistently; if it's loaded, the doctest fails consistently.

(In more detail: I am remotely logging into the machine in my office at the university, and I know that no one else uses the machine. Running 'make ptestlong` gives a failure, running `./sage -tp 2 devel/sage/sage/interfaces/` gives a failure, running the doctest while I'm also building another installation of Sage gives a failure, while it passes when running the doctest by itself. It's quite repeatable.)



---

archive/issue_comments_151652.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@simon-king-jena](#comment:21):\n> Wow. That's not good. I suppose that there are a lot of further errors. If `gap(3)` breaks then I guess most other gap stuff will break, too.\n\nThis is where Ctrl-C is tested, for the record.\n\nEdit: where automatic restarting of the GAP interpreter is tested.",
    "created_at": "2012-09-03T08:24:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151652",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@simon-king-jena](#comment:21):
> Wow. That's not good. I suppose that there are a lot of further errors. If `gap(3)` breaks then I guess most other gap stuff will break, too.

This is where Ctrl-C is tested, for the record.

Edit: where automatic restarting of the GAP interpreter is tested.



---

archive/issue_comments_151653.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@vbraun](#comment:24):\n> This is where Ctrl-C is tested, for the record.\n> \n> Edit: where automatic restarting of the GAP interpreter is tested.\n\nYou mean this one?\n\n```\n        The following tests against a bug fixed at trac ticket #10296:\n\n            sage: a = gap(3)\n            sage: gap.eval('quit;')\n            ''\n            sage: a = gap(3)\n            ** Gap crashed or quit executing '$sage...:=3;;' **\n            Restarting Gap and trying again\n            sage: a\n            3\n```\nDoes it fail in the first or in the second instance of `a = gap(3)`? Why does it report a user interrupt, when either nothing has happened at all (first instance) or GAP was not running (second instance)?",
    "created_at": "2012-09-03T09:12:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151653",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@vbraun](#comment:24):
> This is where Ctrl-C is tested, for the record.
> 
> Edit: where automatic restarting of the GAP interpreter is tested.

You mean this one?

```
        The following tests against a bug fixed at trac ticket #10296:

            sage: a = gap(3)
            sage: gap.eval('quit;')
            ''
            sage: a = gap(3)
            ** Gap crashed or quit executing '$sage...:=3;;' **
            Restarting Gap and trying again
            sage: a
            3
```
Does it fail in the first or in the second instance of `a = gap(3)`? Why does it report a user interrupt, when either nothing has happened at all (first instance) or GAP was not running (second instance)?



---

archive/issue_comments_151654.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI could reproduce this in repeated testing on Linux. You actually need to scroll up a bit higher:\n\n```\n            sage: gap.interrupt(timeout=1) is not None\n            True\n            sage: gap._eval_using_file_cutoff = cutoff\n\n        The following tests against a bug fixed at trac ticket #10296:\n\n            sage: a = gap(3)\n```\nand it dies in the first `gap(3)`. Because our `interrupt()` method is crap, it sends the wrong quit string and GAP/readline interferes with Ctrl-C. \n\nThe updated patch fixes this. I still find a ~1% chance of failing `sage.interfaces.gap` doctests in random places, but thats probably on par for any pexpect interface.",
    "created_at": "2012-09-03T10:42:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151654",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">comment:26</div>

I could reproduce this in repeated testing on Linux. You actually need to scroll up a bit higher:

```
            sage: gap.interrupt(timeout=1) is not None
            True
            sage: gap._eval_using_file_cutoff = cutoff

        The following tests against a bug fixed at trac ticket #10296:

            sage: a = gap(3)
```
and it dies in the first `gap(3)`. Because our `interrupt()` method is crap, it sends the wrong quit string and GAP/readline interferes with Ctrl-C. 

The updated patch fixes this. I still find a ~1% chance of failing `sage.interfaces.gap` doctests in random places, but thats probably on par for any pexpect interface.



---

archive/issue_comments_151655.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAlso `gap_console()` was broken. Fixed it and added a meaningful doctest.",
    "created_at": "2012-09-03T11:41:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151655",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">comment:27</div>

Also `gap_console()` was broken. Fixed it and added a meaningful doctest.



---

archive/issue_comments_151656.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nOn OpenSolaris, I am getting doctest failures in interfaces/expect.py. The failures are not always the same, but here is a sample:\n\n- http://sage.math.washington.edu/home/palmieri/misc/EXPECT1.log\n- http://sage.math.washington.edu/home/palmieri/misc/EXPECT2.log\n- http://sage.math.washington.edu/home/palmieri/misc/EXPECT3.log\n\nI don't know what these have to do with this ticket, but they certainly seem to be caused by the spkg here.\n\n---\n\nBy the way, the new library patch seems to fix the issues on OS X.",
    "created_at": "2012-09-03T17:42:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151656",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:28" align="right">comment:28</div>

On OpenSolaris, I am getting doctest failures in interfaces/expect.py. The failures are not always the same, but here is a sample:

- http://sage.math.washington.edu/home/palmieri/misc/EXPECT1.log
- http://sage.math.washington.edu/home/palmieri/misc/EXPECT2.log
- http://sage.math.washington.edu/home/palmieri/misc/EXPECT3.log

I don't know what these have to do with this ticket, but they certainly seem to be caused by the spkg here.

---

By the way, the new library patch seems to fix the issues on OS X.



---

archive/issue_comments_151657.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n\n```\nsage -t --long \"devel/sage/sage/interfaces/expect.py\"       \n**********************************************************************\nFile \"/export/home/palmieri/testing/clean/sage-5.3.rc0/devel/sage/sage/interfaces/expect.py\", line 608:\n    sage: L = [t[1] for t in f(range(5))]\nExpected nothing\nGot:\n    [Errno 12] Not enough space\n    Killing any remaining workers...\n```\nDisk is full, it seems.",
    "created_at": "2012-09-03T17:47:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151657",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">comment:29</div>


```
sage -t --long "devel/sage/sage/interfaces/expect.py"       
**********************************************************************
File "/export/home/palmieri/testing/clean/sage-5.3.rc0/devel/sage/sage/interfaces/expect.py", line 608:
    sage: L = [t[1] for t in f(range(5))]
Expected nothing
Got:
    [Errno 12] Not enough space
    Killing any remaining workers...
```
Disk is full, it seems.



---

archive/issue_comments_151658.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@vbraun](#comment:29):\n\n> Disk is full, it seems.\n\nIt looks like there is space to me, but which disk should I be looking at? I don't understand why after installing the spkg here, if I then do `./sage -f spkg/standard/gap-4.4.12.p7.spkg`, the doctest passes, and then if I do `./sage -f gap-4.5.5.spkg`, it fails again. Does the new version of GAP create temporary files somewhere new, compared to the old version?",
    "created_at": "2012-09-03T18:06:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151658",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@vbraun](#comment:29):

> Disk is full, it seems.

It looks like there is space to me, but which disk should I be looking at? I don't understand why after installing the spkg here, if I then do `./sage -f spkg/standard/gap-4.4.12.p7.spkg`, the doctest passes, and then if I do `./sage -f gap-4.5.5.spkg`, it fails again. Does the new version of GAP create temporary files somewhere new, compared to the old version?



---

archive/issue_comments_151659.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@jhpalmieri](#comment:30):\n> It looks like there is space to me, but which disk should I be looking at?\n\nI didn't change anything. All temp files should go to `$DOT_SAGE` as before.",
    "created_at": "2012-09-03T18:28:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151659",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@jhpalmieri](#comment:30):
> It looks like there is space to me, but which disk should I be looking at?

I didn't change anything. All temp files should go to `$DOT_SAGE` as before.



---

archive/issue_comments_151660.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOn bsd.math, at least when #12876 and its dependencies are added, I find:\n\n```\nsage -t -force_lib \"devel/sage/sage/interfaces/gap.py\"      \n**********************************************************************\nFile \"/scratch/sking/sage-5.3.rc1/devel/sage/sage/interfaces/gap.py\", line 809:\n    sage: gap(2)\nExpected:\n    2\nGot:\n    <BLANKLINE>\n**********************************************************************\n1 items had failures:\n   1 of   4 in __main__.example_21\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /Users/SimonKing/.sage//tmp/gap_70056.py\n         [29.6 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -force_lib \"devel/sage/sage/interfaces/gap.py\"\nTotal time for all tests: 29.7 seconds\n```\n\nI'd need to repeat without all the other patches, though, to be on the safe side.",
    "created_at": "2012-09-03T19:41:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151660",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:32" align="right">comment:32</div>

On bsd.math, at least when #12876 and its dependencies are added, I find:

```
sage -t -force_lib "devel/sage/sage/interfaces/gap.py"      
**********************************************************************
File "/scratch/sking/sage-5.3.rc1/devel/sage/sage/interfaces/gap.py", line 809:
    sage: gap(2)
Expected:
    2
Got:
    <BLANKLINE>
**********************************************************************
1 items had failures:
   1 of   4 in __main__.example_21
***Test Failed*** 1 failures.
For whitespace errors, see the file /Users/SimonKing/.sage//tmp/gap_70056.py
         [29.6 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -force_lib "devel/sage/sage/interfaces/gap.py"
Total time for all tests: 29.7 seconds
```

I'd need to repeat without all the other patches, though, to be on the safe side.



---

archive/issue_comments_151661.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nOpenSolaris: I tried setting DOT_SAGE to /tmp/palmieri, and I still see the same failures with the new spkg, no failures with the old one. Any ideas?",
    "created_at": "2012-09-03T19:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151661",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:33" align="right">comment:33</div>

OpenSolaris: I tried setting DOT_SAGE to /tmp/palmieri, and I still see the same failures with the new spkg, no failures with the old one. Any ideas?



---

archive/issue_comments_151662.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@simon-king-jena](#comment:32):\n> On bsd.math, at least when #12876 and its dependencies are added, I find:\n> \n> ```\n> sage -t -force_lib \"devel/sage/sage/interfaces/gap.py\"      \n> **********************************************************************\n> File \"/scratch/sking/sage-5.3.rc1/devel/sage/sage/interfaces/gap.py\", line 809:\n>     sage: gap(2)\n> Expected:\n>     2\n> Got:\n>     <BLANKLINE>\n> ```\n\nThe error is reproducible, with just the new spkg and the doctest fix patch applied. That must be a really nasty side effect, because in an interactive session `gap(2)` returns 2.",
    "created_at": "2012-09-03T19:53:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151662",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@simon-king-jena](#comment:32):
> On bsd.math, at least when #12876 and its dependencies are added, I find:
> 
> ```
> sage -t -force_lib "devel/sage/sage/interfaces/gap.py"      
> **********************************************************************
> File "/scratch/sking/sage-5.3.rc1/devel/sage/sage/interfaces/gap.py", line 809:
>     sage: gap(2)
> Expected:
>     2
> Got:
>     <BLANKLINE>
> ```

The error is reproducible, with just the new spkg and the doctest fix patch applied. That must be a really nasty side effect, because in an interactive session `gap(2)` returns 2.



---

archive/issue_comments_151663.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI took some time to understand the gap pexpect interface. Altogether, I think it would be better to base it on the normal interface which seems to be more stable and definitely has more exposure. But we are using the package mode (`gap -p`) and that is neither documented (apart from the source) nor does it behave particularly well when you send Ctrl-C. But that is definitely for another ticket. \n\nI did add more checks after `interrupt()` that the pexpect interface is in a sane state, and restart gap if it is not. I ran 500+ iterations of the doctest and do not get any failures anymore. I'm pretty confident that this is at least as good as we had before, so please review.",
    "created_at": "2012-09-05T14:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151663",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:35" align="right">comment:35</div>

I took some time to understand the gap pexpect interface. Altogether, I think it would be better to base it on the normal interface which seems to be more stable and definitely has more exposure. But we are using the package mode (`gap -p`) and that is neither documented (apart from the source) nor does it behave particularly well when you send Ctrl-C. But that is definitely for another ticket. 

I did add more checks after `interrupt()` that the pexpect interface is in a sane state, and restart gap if it is not. I ran 500+ iterations of the doctest and do not get any failures anymore. I'm pretty confident that this is at least as good as we had before, so please review.



---

archive/issue_comments_151664.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nThere was one doctest error is `sage/interfaces/expect.py` where there is a synchronization method for the expect interface. Since it doesn't know about the GAP package mode it actually desynchronizes the gap interface ;-) Fixed in the updated patch.",
    "created_at": "2012-09-05T16:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151664",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:36" align="right">comment:36</div>

There was one doctest error is `sage/interfaces/expect.py` where there is a synchronization method for the expect interface. Since it doesn't know about the GAP package mode it actually desynchronizes the gap interface ;-) Fixed in the updated patch.



---

archive/issue_comments_151665.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nOn skynet machine mark (Solaris on sparc, Sage built with `SAGE_INSTALL_GCC=yes`), this version of Gap doesn't work:\n\n```\n$ ./sage --gap\n *********   GAP, Version 4.5.5 of 16-Jul-2012 (free software, GPL)\n *  GAP  *   http://www.gap-system.org\n *********   Architecture: sparc-sun-solaris2.10-gcc-default32\n Libs used:  gmp\n Loading the library and packages ...\n/home/palmieri/mark/sage-5.3.rc1/spkg/bin/sage: line 400:  4079 Bus Error               (core dumped) \"$SAGE_LOCAL/bin/gap\" \"$@\"\n```",
    "created_at": "2012-09-05T18:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151665",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:37" align="right">comment:37</div>

On skynet machine mark (Solaris on sparc, Sage built with `SAGE_INSTALL_GCC=yes`), this version of Gap doesn't work:

```
$ ./sage --gap
 *********   GAP, Version 4.5.5 of 16-Jul-2012 (free software, GPL)
 *  GAP  *   http://www.gap-system.org
 *********   Architecture: sparc-sun-solaris2.10-gcc-default32
 Libs used:  gmp
 Loading the library and packages ...
/home/palmieri/mark/sage-5.3.rc1/spkg/bin/sage: line 400:  4079 Bus Error               (core dumped) "$SAGE_LOCAL/bin/gap" "$@"
```



---

archive/issue_comments_151666.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI'm not surprised that it doesn't work on SPARC. I'll send the authors a bug report. But since its not a primary platform it shouldn't stop us from shipping the new GAP version.",
    "created_at": "2012-09-05T19:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151666",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:38" align="right">comment:38</div>

I'm not surprised that it doesn't work on SPARC. I'll send the authors a bug report. But since its not a primary platform it shouldn't stop us from shipping the new GAP version.



---

archive/issue_comments_151667.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI've investigated the SPARC issue and received a patch from the GAP developers. I've updated the spkg, now builds and tests fine on mark.",
    "created_at": "2012-09-06T13:55:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151667",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">comment:39</div>

I've investigated the SPARC issue and received a patch from the GAP developers. I've updated the spkg, now builds and tests fine on mark.



---

archive/issue_events_183766.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-09-22T11:27:33Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "title_is": "Upgrade GAP to 4.5.6",
    "title_was": "Upgrade GAP to 4.5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183766"
}
```



---

archive/issue_comments_151668.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nNaturally, nobody dared to review this ticket. So GAP released the next version in the meantime. Updated to gap-4.5.6.",
    "created_at": "2012-09-22T11:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151668",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:40" align="right">comment:40</div>

Naturally, nobody dared to review this ticket. So GAP released the next version in the meantime. Updated to gap-4.5.6.



---

archive/issue_comments_151669.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,9 +9,9 @@\n ```\n \n Updated spkgs:\n-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.5.spkg \n-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.5.spkg \n-* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.5.spkg\n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.6.spkg \n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n \n``````\n",
    "created_at": "2012-09-22T11:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151669",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,9 +9,9 @@
 ```
 
 Updated spkgs:
-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.5.spkg 
-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.5.spkg 
-* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.5.spkg
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.6.spkg 
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
 Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
 
``````




---

archive/issue_comments_151670.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, in a later stable release.** to **Completely fixed; Fix reported upstream**",
    "created_at": "2012-09-22T11:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151670",
    "user": "https://github.com/vbraun"
}
```

Changed upstream from **Fixed upstream, in a later stable release.** to **Completely fixed; Fix reported upstream**



---

archive/issue_comments_151671.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@vbraun](#comment:40):\n> Naturally, nobody dared to review this ticket. So GAP released the next version in the meantime. Updated to gap-4.5.6.\n\nchallenge accepted :/ expect a review real soon...",
    "created_at": "2012-09-22T11:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151671",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@vbraun](#comment:40):
> Naturally, nobody dared to review this ticket. So GAP released the next version in the meantime. Updated to gap-4.5.6.

challenge accepted :/ expect a review real soon...



---

archive/issue_comments_151672.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nhttp://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.6.spkg has uncommitted changes in `SPKG.txt`\nand the spkg itself is not compressed, making it over 50MB instead of under 10MB.",
    "created_at": "2012-09-22T13:33:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151672",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:42" align="right">comment:42</div>

http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.6.spkg has uncommitted changes in `SPKG.txt`
and the spkg itself is not compressed, making it over 50MB instead of under 10MB.



---

archive/issue_events_183767.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-09-22T14:01:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183767"
}
```



---

archive/issue_events_183768.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-09-22T14:01:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183768"
}
```



---

archive/issue_comments_151673.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,9 +9,8 @@\n ```\n \n Updated spkgs:\n-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.6.spkg \n+* http://boxen.math.washington.edu/home/dima/packages/gap-4.5.6.spkg\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n-\n``````\n",
    "created_at": "2012-09-22T14:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151673",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,9 +9,8 @@
 ```
 
 Updated spkgs:
-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.6.spkg 
+* http://boxen.math.washington.edu/home/dima/packages/gap-4.5.6.spkg
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
 Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
-
``````




---

archive/issue_comments_151674.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI've created the spkg file with checked in changes and compressed it. The link included in the modified ticket description. Otherwise, great stuff! Positive review.",
    "created_at": "2012-09-22T14:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151674",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:43" align="right">comment:43</div>

I've created the spkg file with checked in changes and compressed it. The link included in the modified ticket description. Otherwise, great stuff! Positive review.



---

archive/issue_comments_151675.json:
```json
{
    "body": "Reviewer: **Dmitrii Pasechnik**",
    "created_at": "2012-09-23T16:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151675",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Dmitrii Pasechnik**



---

archive/issue_events_183769.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-23T16:43:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183769"
}
```



---

archive/issue_events_183770.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-23T16:43:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183770"
}
```



---

archive/issue_events_183771.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-23T17:44:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183771"
}
```



---

archive/issue_events_183772.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-23T17:44:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183772"
}
```



---

archive/issue_comments_151676.json:
```json
{
    "body": "Dependencies: **#13123**",
    "created_at": "2012-09-23T17:44:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151676",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#13123**



---

archive/issue_comments_151677.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nThis needs to be rebased to #13123.",
    "created_at": "2012-09-23T17:44:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151677",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

This needs to be rebased to #13123.



---

archive/issue_comments_151678.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nI get the following errors on Mac OS X 10.4 PPC.  I think they are all about the seed for random tests.  Notice that they did pass in the past, and they are neither the old nor the new versions of the expected results from the patch here.  Could the little/big-endian have any impact on this?  I assume not, but otherwise it seems odd that they worked in the past and don't now.  Of course, they ARE \"random\"...\n\n```\nsage -t  \"devel/sage-main/sage/algebras/group_algebra_new.py\"\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/algebras/group_algebra_new.py\", line 592:\n    sage: GroupAlgebra(DihedralGroup(6), QQ).random_element()\nExpected:\n    -1/95*(2,6)(3,5) - 1/2*(1,3)(4,6)\nGot:\n    -1/95*(1,3)(4,6) - 1/2*(1,5,3)(2,6,4)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/algebras/group_algebra_new.py\", line 594:\n    sage: GroupAlgebra(SU(2, 13), QQ).random_element(1)\nExpected:\n    1/2*[      1 9*a + 2]\n    [9*a + 2      12]\nGot:\n    1/2*[       4  9*a + 2]\n    [6*a + 10        1]\n**********************************************************************\n1 items had failures:\n   2 of   5 in __main__.example_23\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /Users/student/.sage//tmp/group_algebra_new_23167.py\n         [83.0 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/__init__.py\"\n         [2.8 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/all.py\"    \n         [0.9 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/general_linear.py\"\n         [93.5 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/homset.py\" \n         [30.6 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/linear.py\" \n         [21.4 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/matrix_group.py\"\n         [129.7 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/matrix_group_element.py\"\n         [53.0 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/matrix_group_morphism.py\"\n         [50.4 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/orthogonal.py\"\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/orthogonal.py\", line 244:\n    sage: GO( 3, GF(7), 0).random_element()\nExpected:\n    [1 0 0]\n    [6 1 6]\n    [5 0 6]\nGot:\n    [1 5 3]\n    [0 1 0]\n    [0 6 6]\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/orthogonal.py\", line 142:\n    sage: G.random_element()\nExpected:\n    [4 3 5 2]\n    [6 6 4 0]\n    [0 4 6 0]\n    [4 4 5 1]\nGot:\n    [0 6 4 6]\n    [2 5 0 2]\n    [5 5 4 0]\n    [1 0 3 4]\n**********************************************************************\n2 items had failures:\n   1 of   6 in __main__.example_10\n   1 of   6 in __main__.example_4\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /Users/student/.sage//tmp/orthogonal_23218.py\n         [39.1 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/special_linear.py\"\n         [42.5 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/symplectic.py\"\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/symplectic.py\", line 16:\n    sage: G.random_element()\nExpected:\n    [5 4 6 0]\n    [1 1 6 2]\n    [5 5 0 6]\n    [5 4 5 1]\nGot:\n    [2 3 2 1]\n    [6 4 6 5]\n    [1 2 5 2]\n    [6 5 1 0]\n**********************************************************************\n1 items had failures:\n   1 of   8 in __main__.example_0\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /Users/student/.sage//tmp/symplectic_23230.py\n         [30.4 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/unitary.py\"\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/unitary.py\", line 26:\n    sage: G.random_element()\nExpected:\n    [4*a + 1 4*a + 4   a + 4]\n    [3*a + 3       3       3]\n    [  a + 2 4*a + 1 3*a + 3]\nGot:\n    [2*a + 3       4 3*a + 2]\n    [3*a + 4       a 3*a + 1]\n    [    4*a 2*a + 2   a + 2]\n**********************************************************************\n1 items had failures:\n   1 of  10 in __main__.example_0\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /Users/student/.sage//tmp/unitary_23236.py\n         [31.7 s]\nsage -t  \"devel/sage-main/sage/misc/randstate.pyx\"          \n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 57:\n    sage: rtest()\nExpected:\n    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,3,2), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)  \nGot:\n    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,2)(4,5), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 61:\n    sage: rtest()\nExpected:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  \nGot:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 65:\n    sage: rtest()\nExpected:\n    (207, -0.0141049486533456, 4*x^2 + 1/2, (1,3,2), [ 0, 0, 1, 0, 1 ],  637693405, 27695, 0.19982565117278328)  \nGot:\n    (207, -0.0141049486533456, 4*x^2 + 1/2, (2,3), [ 0, 0, 1, 0, 1 ], 637693405, 27695, 0.19982565117278328)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 69:\n    sage: rtest()\nExpected:\n    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,3,2), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)  \nGot:\n    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,2)(4,5), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 73:\n    sage: rtest()\nExpected:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  \nGot:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 77:\n    sage: rtest()\nExpected:\n    (207, -0.0141049486533456, 4*x^2 + 1/2, (1,3,2), [ 0, 0, 1, 0, 1 ],  637693405, 27695, 0.19982565117278328)  \nGot:\n    (207, -0.0141049486533456, 4*x^2 + 1/2, (2,3), [ 0, 0, 1, 0, 1 ], 637693405, 27695, 0.19982565117278328)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 88:\n    sage: rtest()\nExpected:\n    (720, -0.612180244315804, x^2 - x, (2,3), [ 1, 0, 0, 0, 0 ], 912534076, 14005, 0.9205331599518184)   \nGot:\n    (720, -0.612180244315804, x^2 - x, (1,3), [ 1, 0, 0, 0, 0 ], 912534076, 14005, 0.9205331599518184)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 224:\n    sage: r1 = rtest(); r1\nExpected:\n    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,3,2), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)  \nGot:\n    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,2)(4,5), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 227:\n    sage: r2 = rtest(); r2\nExpected:\n    (105, 0.642309615982449, -x^2 - x - 6, (1,2,3), [ 1, 0, 0, 1, 1 ], 14082860, 1271, 0.001767155077382232)  \nGot:\n    (105, 0.642309615982449, -x^2 - x - 6, (4,5), [ 1, 0, 0, 1, 1 ], 14082860, 1271, 0.001767155077382232)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 236:\n    sage: with seed(1): rtest()\nExpected:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  \nGot:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 239:\n    sage: r2m = rtest(); r2m\nExpected:\n    (105, 0.642309615982449, -x^2 - x - 6, (1,2,3), [ 1, 0, 0, 1, 1 ], 14082860, 19769, 0.001767155077382232)  \nGot:\n    (105, 0.642309615982449, -x^2 - x - 6, (4,5), [ 1, 0, 0, 1, 1 ], 14082860, 19769, 0.001767155077382232)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 255:\n    sage: with seed(1):\n          rtest();\n          rtest();\nExpected:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  \n    (138, -0.0404945051288503, 2*x - 24, (2,3), [ 1, 1, 1, 0, 1 ], 1966097838, 10234, 0.0033332230808060803)      \nGot:\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)\n    (138, -0.0404945051288503, 2*x - 24, (2,3), [ 1, 1, 1, 0, 1 ], 1966097838, 10234, 0.0033332230808060803)\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 274:\n    sage: try:\n          ctx.__enter__()\n          rtest()\n    finally:\n          ctx.__exit__(None, None, None)\nExpected:\n    <sage.misc.randstate.randstate object at 0x...>\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  \n    False\nGot:\n    <sage.misc.randstate.randstate object at 0x155950c0>\n    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)\n    False\n**********************************************************************\nFile \"/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx\", line 703:\n    sage: gap.Random(1, 10^50)\nExpected:\n    1496738263332555434474532297768680634540939580077\nGot:\n    97144566318213989637952954803537490912828430192472\n**********************************************************************\n```",
    "created_at": "2012-09-24T17:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151678",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:46" align="right">comment:46</div>

I get the following errors on Mac OS X 10.4 PPC.  I think they are all about the seed for random tests.  Notice that they did pass in the past, and they are neither the old nor the new versions of the expected results from the patch here.  Could the little/big-endian have any impact on this?  I assume not, but otherwise it seems odd that they worked in the past and don't now.  Of course, they ARE "random"...

```
sage -t  "devel/sage-main/sage/algebras/group_algebra_new.py"
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/algebras/group_algebra_new.py", line 592:
    sage: GroupAlgebra(DihedralGroup(6), QQ).random_element()
Expected:
    -1/95*(2,6)(3,5) - 1/2*(1,3)(4,6)
Got:
    -1/95*(1,3)(4,6) - 1/2*(1,5,3)(2,6,4)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/algebras/group_algebra_new.py", line 594:
    sage: GroupAlgebra(SU(2, 13), QQ).random_element(1)
Expected:
    1/2*[      1 9*a + 2]
    [9*a + 2      12]
Got:
    1/2*[       4  9*a + 2]
    [6*a + 10        1]
**********************************************************************
1 items had failures:
   2 of   5 in __main__.example_23
***Test Failed*** 2 failures.
For whitespace errors, see the file /Users/student/.sage//tmp/group_algebra_new_23167.py
         [83.0 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/__init__.py"
         [2.8 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/all.py"    
         [0.9 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/general_linear.py"
         [93.5 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/homset.py" 
         [30.6 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/linear.py" 
         [21.4 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/matrix_group.py"
         [129.7 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/matrix_group_element.py"
         [53.0 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/matrix_group_morphism.py"
         [50.4 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/orthogonal.py"
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/orthogonal.py", line 244:
    sage: GO( 3, GF(7), 0).random_element()
Expected:
    [1 0 0]
    [6 1 6]
    [5 0 6]
Got:
    [1 5 3]
    [0 1 0]
    [0 6 6]
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/orthogonal.py", line 142:
    sage: G.random_element()
Expected:
    [4 3 5 2]
    [6 6 4 0]
    [0 4 6 0]
    [4 4 5 1]
Got:
    [0 6 4 6]
    [2 5 0 2]
    [5 5 4 0]
    [1 0 3 4]
**********************************************************************
2 items had failures:
   1 of   6 in __main__.example_10
   1 of   6 in __main__.example_4
***Test Failed*** 2 failures.
For whitespace errors, see the file /Users/student/.sage//tmp/orthogonal_23218.py
         [39.1 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/special_linear.py"
         [42.5 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/symplectic.py"
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/symplectic.py", line 16:
    sage: G.random_element()
Expected:
    [5 4 6 0]
    [1 1 6 2]
    [5 5 0 6]
    [5 4 5 1]
Got:
    [2 3 2 1]
    [6 4 6 5]
    [1 2 5 2]
    [6 5 1 0]
**********************************************************************
1 items had failures:
   1 of   8 in __main__.example_0
***Test Failed*** 1 failures.
For whitespace errors, see the file /Users/student/.sage//tmp/symplectic_23230.py
         [30.4 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/unitary.py"
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/groups/matrix_gps/unitary.py", line 26:
    sage: G.random_element()
Expected:
    [4*a + 1 4*a + 4   a + 4]
    [3*a + 3       3       3]
    [  a + 2 4*a + 1 3*a + 3]
Got:
    [2*a + 3       4 3*a + 2]
    [3*a + 4       a 3*a + 1]
    [    4*a 2*a + 2   a + 2]
**********************************************************************
1 items had failures:
   1 of  10 in __main__.example_0
***Test Failed*** 1 failures.
For whitespace errors, see the file /Users/student/.sage//tmp/unitary_23236.py
         [31.7 s]
sage -t  "devel/sage-main/sage/misc/randstate.pyx"          
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 57:
    sage: rtest()
Expected:
    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,3,2), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)  
Got:
    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,2)(4,5), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 61:
    sage: rtest()
Expected:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  
Got:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 65:
    sage: rtest()
Expected:
    (207, -0.0141049486533456, 4*x^2 + 1/2, (1,3,2), [ 0, 0, 1, 0, 1 ],  637693405, 27695, 0.19982565117278328)  
Got:
    (207, -0.0141049486533456, 4*x^2 + 1/2, (2,3), [ 0, 0, 1, 0, 1 ], 637693405, 27695, 0.19982565117278328)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 69:
    sage: rtest()
Expected:
    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,3,2), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)  
Got:
    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,2)(4,5), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 73:
    sage: rtest()
Expected:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  
Got:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 77:
    sage: rtest()
Expected:
    (207, -0.0141049486533456, 4*x^2 + 1/2, (1,3,2), [ 0, 0, 1, 0, 1 ],  637693405, 27695, 0.19982565117278328)  
Got:
    (207, -0.0141049486533456, 4*x^2 + 1/2, (2,3), [ 0, 0, 1, 0, 1 ], 637693405, 27695, 0.19982565117278328)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 88:
    sage: rtest()
Expected:
    (720, -0.612180244315804, x^2 - x, (2,3), [ 1, 0, 0, 0, 0 ], 912534076, 14005, 0.9205331599518184)   
Got:
    (720, -0.612180244315804, x^2 - x, (1,3), [ 1, 0, 0, 0, 0 ], 912534076, 14005, 0.9205331599518184)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 224:
    sage: r1 = rtest(); r1
Expected:
    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,3,2), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)  
Got:
    (303, -0.266166246380421, 1/2*x^2 - 1/95*x - 1/2, (1,2)(4,5), [ 0, 0, 0, 0, 1 ], 963229057, 8045, 0.9661911734708414)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 227:
    sage: r2 = rtest(); r2
Expected:
    (105, 0.642309615982449, -x^2 - x - 6, (1,2,3), [ 1, 0, 0, 1, 1 ], 14082860, 1271, 0.001767155077382232)  
Got:
    (105, 0.642309615982449, -x^2 - x - 6, (4,5), [ 1, 0, 0, 1, 1 ], 14082860, 1271, 0.001767155077382232)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 236:
    sage: with seed(1): rtest()
Expected:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  
Got:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 239:
    sage: r2m = rtest(); r2m
Expected:
    (105, 0.642309615982449, -x^2 - x - 6, (1,2,3), [ 1, 0, 0, 1, 1 ], 14082860, 19769, 0.001767155077382232)  
Got:
    (105, 0.642309615982449, -x^2 - x - 6, (4,5), [ 1, 0, 0, 1, 1 ], 14082860, 19769, 0.001767155077382232)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 255:
    sage: with seed(1):
          rtest();
          rtest();
Expected:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  
    (138, -0.0404945051288503, 2*x - 24, (2,3), [ 1, 1, 1, 0, 1 ], 1966097838, 10234, 0.0033332230808060803)      
Got:
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)
    (138, -0.0404945051288503, 2*x - 24, (2,3), [ 1, 1, 1, 0, 1 ], 1966097838, 10234, 0.0033332230808060803)
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 274:
    sage: try:
          ctx.__enter__()
          rtest()
    finally:
          ctx.__exit__(None, None, None)
Expected:
    <sage.misc.randstate.randstate object at 0x...>
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,3,2), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)  
    False
Got:
    <sage.misc.randstate.randstate object at 0x155950c0>
    (978, 0.0557699430711638, -3*x^2 - 1/12, (1,2,3), [ 0, 1, 1, 0, 0 ], 1161603091, 60359, 0.8335077654199736)
    False
**********************************************************************
File "/Users/student/Desktop/sage-5.4.beta1/devel/sage-main/sage/misc/randstate.pyx", line 703:
    sage: gap.Random(1, 10^50)
Expected:
    1496738263332555434474532297768680634540939580077
Got:
    97144566318213989637952954803537490912828430192472
**********************************************************************
```



---

archive/issue_comments_151679.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nIn `sage.misc.randstate.pyx` there is a method `set_seed_gap()` that checks for big endian-ness and flips bytes around in that case. It could be that GAP's new random number code is actually big endian clean. Can you modify `set_seed_gap()` and see if that fixes things?",
    "created_at": "2012-09-24T18:18:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151679",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:47" align="right">comment:47</div>

In `sage.misc.randstate.pyx` there is a method `set_seed_gap()` that checks for big endian-ness and flips bytes around in that case. It could be that GAP's new random number code is actually big endian clean. Can you modify `set_seed_gap()` and see if that fixes things?



---

archive/issue_comments_151680.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\n> In `sage.misc.randstate.pyx` there is a method `set_seed_gap()` that checks for big endian-ness and flips bytes around in that case. It could be that GAP's new random number code is actually big endian clean. Can you modify `set_seed_gap()` and see if that fixes things?\n\nWell, what do you know!  I didn't think Sage had any custom code for big endian...  I'll try this now.  It certainly sounds likely.\n\n---\n\nIt does fix the problem in randstate.pyx, so I think you're right about the others.  Testing now.",
    "created_at": "2012-09-24T18:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151680",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:48" align="right">comment:48</div>

> In `sage.misc.randstate.pyx` there is a method `set_seed_gap()` that checks for big endian-ness and flips bytes around in that case. It could be that GAP's new random number code is actually big endian clean. Can you modify `set_seed_gap()` and see if that fixes things?

Well, what do you know!  I didn't think Sage had any custom code for big endian...  I'll try this now.  It certainly sounds likely.

---

It does fix the problem in randstate.pyx, so I think you're right about the others.  Testing now.



---

archive/issue_comments_151681.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\n\n```\nsage -t  \"devel/sage-main/sage/algebras/group_algebra_new.py\"\n         [81.4 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/orthogonal.py\"\n         [31.4 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/symplectic.py\"\n         [30.7 s]\nsage -t  \"devel/sage-main/sage/groups/matrix_gps/unitary.py\"\n         [31.2 s]\nsage -t  \"devel/sage-main/sage/misc/randstate.pyx\"          \n         [109.4 s]\n```\n\nI just gutted that part of the code.\n\n```diff\n# HG changeset patch\n# User Karl-Dieter Crisman <kcrisman@gmail.com>\n# Date 1348512346 14400\n# Node ID aedbdc34982e44f81636a8006f7fc44086604f43\n# Parent  e1f48782037500988a1ea3f3b0764ead26b6232f\nRemove big-endian workaround\n\ndiff --git a/sage/misc/randstate.pyx b/sage/misc/randstate.pyx\n--- a/sage/misc/randstate.pyx\n+++ b/sage/misc/randstate.pyx\n@@ -718,23 +718,6 @@\n                  seed = ZZ.random_element(long(1)<<128)\n                  classic_seed = seed\n \n-                 if sys.byteorder == 'big':\n-                     # GAP's random number generator initialization\n-                     # (in integer.c, in FuncInitRandomMT) takes its\n-                     # seed as a string, then converts this string into\n-                     # an array of 32-bit integers just by casting the\n-                     # pointer.  Thus, the result depends on the\n-                     # endianness of the machine.  As a workaround, we\n-                     # swap the bytes in the string ourselves, so that\n-                     # GAP always gets the same array of integers.\n-\n-                     seed = str(seed)\n-                     new_seed = ''\n-                     while len(seed) >= 4:\n-                         new_seed += seed[3::-1]\n-                         seed = seed[4:]\n-                     seed = '\"' + new_seed + '\"'\n-\n                  mersenne_seed = seed\n \n              prev_mersenne_seed = gap.Reset(gap.GlobalMersenneTwister, mersenne_seed)\n```\nI don't know why these never format quite right...",
    "created_at": "2012-09-24T18:46:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151681",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:49" align="right">comment:49</div>


```
sage -t  "devel/sage-main/sage/algebras/group_algebra_new.py"
         [81.4 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/orthogonal.py"
         [31.4 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/symplectic.py"
         [30.7 s]
sage -t  "devel/sage-main/sage/groups/matrix_gps/unitary.py"
         [31.2 s]
sage -t  "devel/sage-main/sage/misc/randstate.pyx"          
         [109.4 s]
```

I just gutted that part of the code.

```diff
# HG changeset patch
# User Karl-Dieter Crisman <kcrisman@gmail.com>
# Date 1348512346 14400
# Node ID aedbdc34982e44f81636a8006f7fc44086604f43
# Parent  e1f48782037500988a1ea3f3b0764ead26b6232f
Remove big-endian workaround

diff --git a/sage/misc/randstate.pyx b/sage/misc/randstate.pyx
--- a/sage/misc/randstate.pyx
+++ b/sage/misc/randstate.pyx
@@ -718,23 +718,6 @@
                  seed = ZZ.random_element(long(1)<<128)
                  classic_seed = seed
 
-                 if sys.byteorder == 'big':
-                     # GAP's random number generator initialization
-                     # (in integer.c, in FuncInitRandomMT) takes its
-                     # seed as a string, then converts this string into
-                     # an array of 32-bit integers just by casting the
-                     # pointer.  Thus, the result depends on the
-                     # endianness of the machine.  As a workaround, we
-                     # swap the bytes in the string ourselves, so that
-                     # GAP always gets the same array of integers.
-
-                     seed = str(seed)
-                     new_seed = ''
-                     while len(seed) >= 4:
-                         new_seed += seed[3::-1]
-                         seed = seed[4:]
-                     seed = '"' + new_seed + '"'
-
                  mersenne_seed = seed
 
              prev_mersenne_seed = gap.Reset(gap.GlobalMersenneTwister, mersenne_seed)
```
I don't know why these never format quite right...



---

archive/issue_comments_151682.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@kcrisman](#comment:46):\n> I get the following errors on Mac OS X 10.4 PPC.  I think they are all about the seed for random tests.  Notice that they did pass in the past, and they are neither the old nor the new versions of the expected results from the patch here.  Could the little/big-endian have any impact on this? \n\nOh dear, now I see why it felt like good deja vu  : see #9867. Nice moldy bitrotten ticket.  \nIt was never merged when the current ticket was prepared. \n\nI've put #9867 up for review. Please close it and merge it here somehow...",
    "created_at": "2012-09-25T06:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151682",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@kcrisman](#comment:46):
> I get the following errors on Mac OS X 10.4 PPC.  I think they are all about the seed for random tests.  Notice that they did pass in the past, and they are neither the old nor the new versions of the expected results from the patch here.  Could the little/big-endian have any impact on this? 

Oh dear, now I see why it felt like good deja vu  : see #9867. Nice moldy bitrotten ticket.  
It was never merged when the current ticket was prepared. 

I've put #9867 up for review. Please close it and merge it here somehow...



---

archive/issue_comments_151683.json:
```json
{
    "body": "Attachment: **[endianness.patch.gz](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)**",
    "created_at": "2012-09-26T05:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151683",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[endianness.patch.gz](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)**



---

archive/issue_comments_151684.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,7 @@\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n-Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n+Apply: \n+[attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n+[attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)\n+\n``````\n",
    "created_at": "2012-09-26T05:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151684",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,7 @@
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
-Apply [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
+Apply: 
+[attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
+[attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)
+
``````




---

archive/issue_comments_151685.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI have added the patch from #9867 here.",
    "created_at": "2012-09-26T05:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151685",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

I have added the patch from #9867 here.



---

archive/issue_comments_151686.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,6 +14,6 @@\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n Apply: \n-[attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n-[attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)\n+* [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n+* [attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)\n \n``````\n",
    "created_at": "2012-09-26T05:46:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151686",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,6 +14,6 @@
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
 Apply: 
-[attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
-[attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)
+* [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
+* [attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)
 
``````




---

archive/issue_comments_151687.json:
```json
{
    "body": "Changed dependencies from **#13123** to **#13123, #13123**",
    "created_at": "2012-09-26T09:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151687",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#13123** to **#13123, #13123**



---

archive/issue_events_183773.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-09-26T09:58:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183773"
}
```



---

archive/issue_events_183774.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-09-26T09:58:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183774"
}
```



---

archive/issue_comments_151688.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI've rebased it on #13123 (that is, on the as-of-yet unrelease sage-5.4.beta2) and folded in the endianness patch.",
    "created_at": "2012-09-26T09:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151688",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:53" align="right">comment:53</div>

I've rebased it on #13123 (that is, on the as-of-yet unrelease sage-5.4.beta2) and folded in the endianness patch.



---

archive/issue_comments_151689.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI don't think it depends on #13123 *twice*.",
    "created_at": "2012-09-26T10:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151689",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:54" align="right">comment:54</div>

I don't think it depends on #13123 *twice*.



---

archive/issue_comments_151690.json:
```json
{
    "body": "Changed dependencies from **#13123, #13123** to **#13123**",
    "created_at": "2012-09-26T10:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151690",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13123, #13123** to **#13123**



---

archive/issue_comments_151691.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,5 +15,3 @@\n \n Apply: \n * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n-* [attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)\n-\n``````\n",
    "created_at": "2012-10-05T09:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151691",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,5 +15,3 @@
 
 Apply: 
 * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
-* [attachment: endianness.patch](https://github.com/sagemath/sage/files/ticket13211/endianness.patch.gz)
-
``````




---

archive/issue_comments_151692.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nIt seems the endianness patch is included in the other patch...",
    "created_at": "2012-10-05T09:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151692",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

It seems the endianness patch is included in the other patch...



---

archive/issue_comments_151693.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nWhen testing this in a from-scratch built Sage, I got\n\n```\nsage -t  -force_lib devel/sage/sage/tests/cmdline.py\n**********************************************************************\nFile \"/release/merger/sage-5.5.beta0/devel/sage-main/sage/tests/cmdline.py\", line 408:\n    sage: err\nExpected:\n    ''\nGot:\n    'gap: halving pool size.\\n'\n**********************************************************************\n```\nOn subsequent tests, I did not get this message.",
    "created_at": "2012-10-05T13:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151693",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

When testing this in a from-scratch built Sage, I got

```
sage -t  -force_lib devel/sage/sage/tests/cmdline.py
**********************************************************************
File "/release/merger/sage-5.5.beta0/devel/sage-main/sage/tests/cmdline.py", line 408:
    sage: err
Expected:
    ''
Got:
    'gap: halving pool size.\n'
**********************************************************************
```
On subsequent tests, I did not get this message.



---

archive/issue_comments_151694.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nLooking at the GAP sources, this seems to be caused by a lack of memory...",
    "created_at": "2012-10-05T13:39:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151694",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:57" align="right">comment:57</div>

Looking at the GAP sources, this seems to be caused by a lack of memory...



---

archive/issue_comments_151695.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nAlso, I somehow ended up with orphan GAP processes running:\n\n```\njdemeyer@sage:/release/merger/sage-5.5.beta0$ ps -ef |grep gap\njdemeyer 10863     1 99 14:26 ?        01:21:46 /release/merger/sage-5.5.beta0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta0/local/gap/latest -r -b -p -T -o 9999G /release/merger/sage-5.5.beta0/local/share/sage/ext/gap/sage.g\njdemeyer 17015 10589  0 15:49 pts/124  00:00:00 grep gap\njdemeyer 22854     1 99 14:52 ?        00:56:56 /release/merger/sage-5.5.beta0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta0/local/gap/latest -r -b -p -T -o 9999G /release/merger/sage-5.5.beta0/local/share/sage/ext/gap/sage.g\n```",
    "created_at": "2012-10-05T13:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151695",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>

Also, I somehow ended up with orphan GAP processes running:

```
jdemeyer@sage:/release/merger/sage-5.5.beta0$ ps -ef |grep gap
jdemeyer 10863     1 99 14:26 ?        01:21:46 /release/merger/sage-5.5.beta0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta0/local/gap/latest -r -b -p -T -o 9999G /release/merger/sage-5.5.beta0/local/share/sage/ext/gap/sage.g
jdemeyer 17015 10589  0 15:49 pts/124  00:00:00 grep gap
jdemeyer 22854     1 99 14:52 ?        00:56:56 /release/merger/sage-5.5.beta0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta0/local/gap/latest -r -b -p -T -o 9999G /release/merger/sage-5.5.beta0/local/share/sage/ext/gap/sage.g
```



---

archive/issue_comments_151696.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nIts not lack of actual memory, it is a lack of swap space. GAP reserves addressing space and  corresponding swap space such that the addressing space could be actually used (potentially by swapping) if GAP were to use that much memory. If the initial workspace is too large, it tries with half the size iteratively until it succeeds. The \"halving pool size\" is harmless but cannot be disabled.",
    "created_at": "2012-10-05T13:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151696",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:59" align="right">comment:59</div>

Its not lack of actual memory, it is a lack of swap space. GAP reserves addressing space and  corresponding swap space such that the addressing space could be actually used (potentially by swapping) if GAP were to use that much memory. If the initial workspace is too large, it tries with half the size iteratively until it succeeds. The "halving pool size" is harmless but cannot be disabled.



---

archive/issue_comments_151697.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@vbraun](#comment:59):\n> The \"halving pool size\" is harmless but cannot be disabled.\n\nThe `printf()` could be patched out... if it's harmless.",
    "created_at": "2012-10-05T14:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151697",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@vbraun](#comment:59):
> The "halving pool size" is harmless but cannot be disabled.

The `printf()` could be patched out... if it's harmless.



---

archive/issue_comments_151698.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nI've written upstream about this issue, hopefully it'll be fixed in a future release.\n\nI'm not entirely happy with our allocation strategy, if you are running multiple sage processes (e.g. on a server) then you quickly reserve most of swap. I'll add a patch to tweak the pool size.",
    "created_at": "2012-10-05T14:16:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151698",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:61" align="right">comment:61</div>

I've written upstream about this issue, hopefully it'll be fixed in a future release.

I'm not entirely happy with our allocation strategy, if you are running multiple sage processes (e.g. on a server) then you quickly reserve most of swap. I'll add a patch to tweak the pool size.



---

archive/issue_comments_151699.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nIn any case, something needs to be done about the `cmdline.py` doctest failure due to that \"error\" message which isn't even an error.\n\nAlso: after running all doctests again, I ended up again with an orphaned `gap` process.",
    "created_at": "2012-10-05T19:06:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151699",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">comment:62</div>

In any case, something needs to be done about the `cmdline.py` doctest failure due to that "error" message which isn't even an error.

Also: after running all doctests again, I ended up again with an orphaned `gap` process.



---

archive/issue_events_183775.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-05T19:06:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183775"
}
```



---

archive/issue_events_183776.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-05T19:06:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183776"
}
```



---

archive/issue_comments_151700.json:
```json
{
    "body": "Changed dependencies from **#13123** to **#13123, #13579**",
    "created_at": "2012-10-08T20:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151700",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#13123** to **#13123, #13579**



---

archive/issue_comments_151701.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nI've fixed the \"halving pool size\" doctest error and changed the workspace allocation to default to 1/10*(available swap). This should give you enough workspace without reserving all swap when you run a server (or parallel doctests).\n\nI can't reproduce any gap orphans. I verified that the gap pid is correctly written to `spawned_processes` so even if Sage gets kill -9'ed the sage-cleaner will get rid of orphans. Maybe sage-cleaner has some issue on your setup, Jeroen?\n\nThe additional trac_13211_pool_size.patch needs review... Dima? ;-)",
    "created_at": "2012-10-08T20:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151701",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:64" align="right">comment:64</div>

I've fixed the "halving pool size" doctest error and changed the workspace allocation to default to 1/10*(available swap). This should give you enough workspace without reserving all swap when you run a server (or parallel doctests).

I can't reproduce any gap orphans. I verified that the gap pid is correctly written to `spawned_processes` so even if Sage gets kill -9'ed the sage-cleaner will get rid of orphans. Maybe sage-cleaner has some issue on your setup, Jeroen?

The additional trac_13211_pool_size.patch needs review... Dima? ;-)



---

archive/issue_comments_151702.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,4 @@\n \n Apply: \n * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n+* [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)\n``````\n",
    "created_at": "2012-10-08T20:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151702",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,4 @@
 
 Apply: 
 * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
+* [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)
``````




---

archive/issue_events_183777.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-08T20:49:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183777"
}
```



---

archive/issue_events_183778.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-08T20:49:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183778"
}
```



---

archive/issue_comments_151703.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@vbraun](#comment:64):\n> I can't reproduce any gap orphans. I verified that the gap pid is correctly written to `spawned_processes`\n\nI haven't looked at the code, but are you sure gap is started only from one place in Sage?  Maybe the command line helps:\n\n```\n/release/merger/sage-5.5.beta0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta0/local/gap/latest -r -b -p -T -o 9999G /release/merger/sage-5.5.beta0/local/share/sage/ext/gap/sage.g\n```",
    "created_at": "2012-10-08T21:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151703",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@vbraun](#comment:64):
> I can't reproduce any gap orphans. I verified that the gap pid is correctly written to `spawned_processes`

I haven't looked at the code, but are you sure gap is started only from one place in Sage?  Maybe the command line helps:

```
/release/merger/sage-5.5.beta0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta0/local/gap/latest -r -b -p -T -o 9999G /release/merger/sage-5.5.beta0/local/share/sage/ext/gap/sage.g
```



---

archive/issue_comments_151704.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nI spend quite some time today trying to find any change that might change where or how gap is started, but I didn't find any. I ran various doctests and tried to kill -9 the sage process, but never managed to produce any orphans that weren't cleaned up.",
    "created_at": "2012-10-08T21:17:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151704",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:66" align="right">comment:66</div>

I spend quite some time today trying to find any change that might change where or how gap is started, but I didn't find any. I ran various doctests and tried to kill -9 the sage process, but never managed to produce any orphans that weren't cleaned up.



---

archive/issue_comments_151705.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nOn MacOSX 10.6.8 I get\n\n```\nsage -t --long -force_lib \"devel/sage/sage/misc/memory_info.py\"\n**********************************************************************\nFile \"/usr/local/src/sage/sage-5.4.rc0/devel/sage/sage/misc/memory_info.py\", line 99:\n    sage: print \"ignore this\";  mem._parse_proc_meminfo()   # random output\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage/sage-5.4.rc0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.4.rc0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.4.rc0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[4]>\", line 1, in <module>\n        print \"ignore this\";  mem._parse_proc_meminfo()   # random output###line 99:\n    sage: print \"ignore this\";  mem._parse_proc_meminfo()   # random output\n    AttributeError: 'MemoryInfo_guess' object has no attribute '_parse_proc_meminfo'\n**********************************************************************\n1 items had failures:\n   1 of   6 in __main__.example_3\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /Users/dima/.sage//tmp/memory_info_41483.py\n\t [2.6 s]\n```",
    "created_at": "2012-10-09T11:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151705",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:67" align="right">comment:67</div>

On MacOSX 10.6.8 I get

```
sage -t --long -force_lib "devel/sage/sage/misc/memory_info.py"
**********************************************************************
File "/usr/local/src/sage/sage-5.4.rc0/devel/sage/sage/misc/memory_info.py", line 99:
    sage: print "ignore this";  mem._parse_proc_meminfo()   # random output
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage/sage-5.4.rc0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.4.rc0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.4.rc0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[4]>", line 1, in <module>
        print "ignore this";  mem._parse_proc_meminfo()   # random output###line 99:
    sage: print "ignore this";  mem._parse_proc_meminfo()   # random output
    AttributeError: 'MemoryInfo_guess' object has no attribute '_parse_proc_meminfo'
**********************************************************************
1 items had failures:
   1 of   6 in __main__.example_3
***Test Failed*** 1 failures.
For whitespace errors, see the file /Users/dima/.sage//tmp/memory_info_41483.py
	 [2.6 s]
```



---

archive/issue_comments_151706.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nI see, raising an exception still makes `# random` doctests fail. Updated patch fixes this and adds special handling for OSX to get the ram size.",
    "created_at": "2012-10-09T12:30:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151706",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:68" align="right">comment:68</div>

I see, raising an exception still makes `# random` doctests fail. Updated patch fixes this and adds special handling for OSX to get the ram size.



---

archive/issue_comments_151707.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@vbraun](#comment:68):\n> I see, raising an exception still makes `# random` doctests fail. Updated patch fixes this and adds special handling for OSX to get the ram size.\n\nOK, this works on OSX now, good. Let me me check on Linux...",
    "created_at": "2012-10-09T13:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151707",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@vbraun](#comment:68):
> I see, raising an exception still makes `# random` doctests fail. Updated patch fixes this and adds special handling for OSX to get the ram size.

OK, this works on OSX now, good. Let me me check on Linux...



---

archive/issue_comments_151708.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@dimpase](#comment:69):\n> Replying to [@vbraun](#comment:68):\n> > I see, raising an exception still makes `# random` doctests fail. Updated patch fixes this and adds special handling for OSX to get the ram size.\n\n> \n> OK, this works on OSX now, good. Let me me check on Linux...\n\nwith #13579 and #13211 patches applied, I have the following weirdness on Debian:\n\n```\n$ ../../sage    \n----------------------------------------------------------------------\n| Sage Version 5.4.rc1, Release Date: 2012-10-05                     |\n| Type \"notebook()\" for the browser-based notebook interface.        |\n| Type \"help()\" for help.                                            |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\n        top: unknown argument 'l'\nusage:  top -hv | -bcisSH -d delay -n iterations [-u user | -U user] -p pid [,pid ...]\n\nsage: \n```\nhere is my patch queue:\n\n```\n/usr/local/src/sage/sage-5.4.rc1/devel/sage$ hg qapplied\n13579_secure_tmp.patch\ntrac_13579_fix_test_executable.patch\ntrac_13211_fix_gap_doctests.patch\ntrac_13211_pool_size.patch\n```\n\nPS. This seems to be due to failure to tell OSX from Linux!",
    "created_at": "2012-10-09T15:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151708",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@dimpase](#comment:69):
> Replying to [@vbraun](#comment:68):
> > I see, raising an exception still makes `# random` doctests fail. Updated patch fixes this and adds special handling for OSX to get the ram size.

> 
> OK, this works on OSX now, good. Let me me check on Linux...

with #13579 and #13211 patches applied, I have the following weirdness on Debian:

```
$ ../../sage    
----------------------------------------------------------------------
| Sage Version 5.4.rc1, Release Date: 2012-10-05                     |
| Type "notebook()" for the browser-based notebook interface.        |
| Type "help()" for help.                                            |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
        top: unknown argument 'l'
usage:  top -hv | -bcisSH -d delay -n iterations [-u user | -U user] -p pid [,pid ...]

sage: 
```
here is my patch queue:

```
/usr/local/src/sage/sage-5.4.rc1/devel/sage$ hg qapplied
13579_secure_tmp.patch
trac_13579_fix_test_executable.patch
trac_13211_fix_gap_doctests.patch
trac_13211_pool_size.patch
```

PS. This seems to be due to failure to tell OSX from Linux!



---

archive/issue_comments_151709.json:
```json
{
    "body": "Attachment: **[fixlinuxmeminfo.patch.gz](https://github.com/sagemath/sage/files/ticket13211/fixlinuxmeminfo.patch.gz)**\n\nfix control flow in misc/memory_info.py",
    "created_at": "2012-10-09T15:34:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151709",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[fixlinuxmeminfo.patch.gz](https://github.com/sagemath/sage/files/ticket13211/fixlinuxmeminfo.patch.gz)**

fix control flow in misc/memory_info.py



---

archive/issue_comments_151710.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nWell, why don't you actually check for Darwin/OSX? E.g.\n\n```\nimport platform\nif platform.system=='Darwin':\n   # do OSX-thing...\nelse:\n   # the rest...\n```",
    "created_at": "2012-10-09T16:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151710",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:71" align="right">comment:71</div>

Well, why don't you actually check for Darwin/OSX? E.g.

```
import platform
if platform.system=='Darwin':
   # do OSX-thing...
else:
   # the rest...
```



---

archive/issue_comments_151711.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nI can't apply the patches. \n\n```\nsage: hg_sage.apply('https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz')\nAttempting to load remote file: https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz\nLoading: [.......]\ncd \"/home/mmarco/sage-5.3/devel/sage\" && sage --hg import   \"/home/mmarco/.sage/temp/neumann/583/tmp_0.patch\"\napplying /home/mmarco/.sage/temp/neumann/583/tmp_0.patch\npatching file sage/interfaces/gap.py\nHunk #20 FAILED at 1663\n1 out of 21 hunks FAILED -- saving rejects to file sage/interfaces/gap.py.rej\npatching file sage/tests/cmdline.py\nHunk #1 FAILED at 516\n1 out of 1 hunks FAILED -- saving rejects to file sage/tests/cmdline.py.rej\nabort: patch failed to apply\n```",
    "created_at": "2012-10-09T20:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151711",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:72" align="right">comment:72</div>

I can't apply the patches. 

```
sage: hg_sage.apply('https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz')
Attempting to load remote file: https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz
Loading: [.......]
cd "/home/mmarco/sage-5.3/devel/sage" && sage --hg import   "/home/mmarco/.sage/temp/neumann/583/tmp_0.patch"
applying /home/mmarco/.sage/temp/neumann/583/tmp_0.patch
patching file sage/interfaces/gap.py
Hunk #20 FAILED at 1663
1 out of 21 hunks FAILED -- saving rejects to file sage/interfaces/gap.py.rej
patching file sage/tests/cmdline.py
Hunk #1 FAILED at 516
1 out of 1 hunks FAILED -- saving rejects to file sage/tests/cmdline.py.rej
abort: patch failed to apply
```



---

archive/issue_comments_151712.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nYou need at least sage-5.4.beta2 to apply the patches, I think.",
    "created_at": "2012-10-09T20:41:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151712",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:73" align="right">comment:73</div>

You need at least sage-5.4.beta2 to apply the patches, I think.



---

archive/issue_comments_151713.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nOk should work now!",
    "created_at": "2012-10-09T21:36:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151713",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:74" align="right">comment:74</div>

Ok should work now!



---

archive/issue_comments_151714.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@vbraun](#comment:74):\n> Ok should work now!\n\nlooks good. Another round of tests, and hopefully it's done.",
    "created_at": "2012-10-10T01:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151714",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@vbraun](#comment:74):
> Ok should work now!

looks good. Another round of tests, and hopefully it's done.



---

archive/issue_comments_151715.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nThere is an apparent incompatibility with the new GUAVA GAP package:\n\n```\nsage -t  --optional -force_lib devel/sage/sage/coding/linear_code.py\n**********************************************************************File \"/usr/local/src/sage/sage-5.4.rc1/devel/sage-main/sage/coding/linear_code.py\",\n line 1239:\n    sage: C.covering_radius()  # requires optional GAP package GuavaException raised:\n    Traceback (most recent call last):      File \"/usr/local/src/sage/sage-5.4.rc1/local/bin/ncadoctest.py\", line 1231, i\nn run_one_test        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.4.rc1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compilefla\ngs)      File \"/usr/local/src/sage/sage-5.4.rc1/local/bin/ncadoctest.py\", line 1172, i\nn run_one_example        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_24[3]>\", line 1, in <module>\n        C.covering_radius()  # requires optional GAP package Guava###line 1239:\n    sage: C.covering_radius()  # requires optional GAP package Guava\n      File \"/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/co\nding/linear_code.py\", line 1245, in covering_radius        C = gapG.GeneratorMatCode(gap(F))\n      File \"/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in\nterfaces/interface.py\", line 584, in __call__        return self._obj.parent().function_call(self._name, [self._obj] + list(args\n), kwds)\n      File \"/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in\nterfaces/gap.py\", line 874, in function_call\n        ['%s=%s'%(key,value.name()) for key, value in kwds.items()])))      File \"/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in\nterfaces/gap.py\", line 546, in eval\n        result = Expect.eval(self, input_line, **kwds)      File \"/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in\nterfaces/expect.py\", line 1236, in eval        for L in code.split('\\n') if L != ''])\n      File \"/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/interfaces/gap.py\", line 747, in _eval_line\n        raise RuntimeError, message\n    RuntimeError: Gap produced error output\n    Error, Variable: 'GeneratorMatCode' must have a value\n\n       executing GeneratorMatCode($sage8,$sage1);\n**********************************************************************\n.... etc\n```",
    "created_at": "2012-10-10T05:21:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151715",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:76" align="right">comment:76</div>

There is an apparent incompatibility with the new GUAVA GAP package:

```
sage -t  --optional -force_lib devel/sage/sage/coding/linear_code.py
**********************************************************************File "/usr/local/src/sage/sage-5.4.rc1/devel/sage-main/sage/coding/linear_code.py",
 line 1239:
    sage: C.covering_radius()  # requires optional GAP package GuavaException raised:
    Traceback (most recent call last):      File "/usr/local/src/sage/sage-5.4.rc1/local/bin/ncadoctest.py", line 1231, i
n run_one_test        self.run_one_example(test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.4.rc1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compilefla
gs)      File "/usr/local/src/sage/sage-5.4.rc1/local/bin/ncadoctest.py", line 1172, i
n run_one_example        compileflags, 1) in test.globs
      File "<doctest __main__.example_24[3]>", line 1, in <module>
        C.covering_radius()  # requires optional GAP package Guava###line 1239:
    sage: C.covering_radius()  # requires optional GAP package Guava
      File "/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/co
ding/linear_code.py", line 1245, in covering_radius        C = gapG.GeneratorMatCode(gap(F))
      File "/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in
terfaces/interface.py", line 584, in __call__        return self._obj.parent().function_call(self._name, [self._obj] + list(args
), kwds)
      File "/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in
terfaces/gap.py", line 874, in function_call
        ['%s=%s'%(key,value.name()) for key, value in kwds.items()])))      File "/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in
terfaces/gap.py", line 546, in eval
        result = Expect.eval(self, input_line, **kwds)      File "/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/in
terfaces/expect.py", line 1236, in eval        for L in code.split('\n') if L != ''])
      File "/usr/local/src/sage/sage-5.4.rc1/local/lib/python/site-packages/sage/interfaces/gap.py", line 747, in _eval_line
        raise RuntimeError, message
    RuntimeError: Gap produced error output
    Error, Variable: 'GeneratorMatCode' must have a value

       executing GeneratorMatCode($sage8,$sage1);
**********************************************************************
.... etc
```



---

archive/issue_events_183779.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-10T10:02:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183779"
}
```



---

archive/issue_events_183780.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-10T10:02:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183780"
}
```



---

archive/issue_comments_151716.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nPositive review. The issues with optional packages, such as the above, and [over here at sage-devel](https://groups.google.com/d/topic/sage-devel/LIdbHCZ1fVI/discussion), should be tackled elsewhere.",
    "created_at": "2012-10-10T10:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151716",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:78" align="right">comment:78</div>

Positive review. The issues with optional packages, such as the above, and [over here at sage-devel](https://groups.google.com/d/topic/sage-devel/LIdbHCZ1fVI/discussion), should be tackled elsewhere.



---

archive/issue_events_183781.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-13T10:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183781"
}
```



---

archive/issue_events_183782.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-13T10:15:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183782"
}
```



---

archive/issue_comments_151717.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nrebased for sage-5.4.rc2",
    "created_at": "2012-10-31T19:26:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151717",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:80" align="right">comment:80</div>

rebased for sage-5.4.rc2



---

archive/issue_comments_151718.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\n> While we are at it, move the gap install to `$SAGE_LOCAL/gap/gap.x.y.z`.\n\nWould it make sense to use `$SAGE_LOCAL/share/gap/gap.x.y.z` instead?",
    "created_at": "2012-10-31T21:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151718",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:81" align="right">comment:81</div>

> While we are at it, move the gap install to `$SAGE_LOCAL/gap/gap.x.y.z`.

Would it make sense to use `$SAGE_LOCAL/share/gap/gap.x.y.z` instead?



---

archive/issue_comments_151719.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@jhpalmieri](#comment:81):\n> Would it make sense to use `$SAGE_LOCAL/share/gap/gap.x.y.z` instead?\n\nNo, `/share/` isn't for binaries.",
    "created_at": "2012-10-31T21:26:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151719",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@jhpalmieri](#comment:81):
> Would it make sense to use `$SAGE_LOCAL/share/gap/gap.x.y.z` instead?

No, `/share/` isn't for binaries.



---

archive/issue_events_183783.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:17:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183783"
}
```



---

archive/issue_events_183784.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:17:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183784"
}
```



---

archive/issue_comments_151720.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nThis fails on Skynet `eno`:\n\n```\nHost system:\nLinux eno 3.3.7-1.fc16.x86_64 #1 SMP Tue May 22 13:59:39 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc/libexec/gcc/x86_64-unknown-linux-gnu/4.7.0/lto-wrapper\nTarget: x86_64-unknown-linux-gnu\nConfigured with: /usr/local/gcc-4.7.0/src/gcc-4.7.0/configure --enable-languages=c,c++,fortran --with-gnu-as --with-as=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/as --with-gnu-ld --with-ld=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/ld --with-gmp=/usr/local/mpir-2.5.1/x86_64-Linux-core2-fc-gcc-4.6.3-rh --with-mpfr=/usr/local/mpfr-3.1.0/x86_64-Linux-core2-fc-mpir-2.5.1-gcc-4.6.3-rh --with-mpc=/usr/local/mpc-0.9/x86_64-Linux-core2-fc-mpir-2.5.1-mpfr-3.1.0-gcc-4.6.3-rh --prefix=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc\nThread model: posix\ngcc version 4.7.0 (GCC) \n****************************************************\nspkg-install is using\nVERSION = 4.5.6\nGAP_DIR = gap-4.5.6\nINSTALL_DIR = /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.5.beta1/local/gap/gap-4.5.6\nApplying patches...\npatching file gap.shi\npatching file tst/testinstall.g\nConfiguring GAP...\nchecking for gcc... gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to accept ISO C89... none needed\nchecking how to run the C preprocessor... gcc -E\nchecking for grep that handles long lines and -e... /bin/grep\nchecking for egrep... /bin/grep -E\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking size of void *... 8\nchecking ABI bit size... 64\nchecking build system type... x86_64-unknown-linux-gnu\nchecking host system type... x86_64-unknown-linux-gnu\nchecking target system type... x86_64-unknown-linux-gnu\nchecking for gcc... (cached) gcc\nchecking whether we are using the GNU C compiler... (cached) yes\nchecking whether gcc accepts -g... (cached) yes\nchecking for gcc option to accept ISO C89... (cached) none needed\nchecking whether make sets $(MAKE)... yes\nchecking GAP config name... default64\nconfigure: error: Could not locate GMP in the specified location\nError configuring GAP.\n```",
    "created_at": "2012-11-02T01:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151720",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:84" align="right">comment:84</div>

This fails on Skynet `eno`:

```
Host system:
Linux eno 3.3.7-1.fc16.x86_64 #1 SMP Tue May 22 13:59:39 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc/libexec/gcc/x86_64-unknown-linux-gnu/4.7.0/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: /usr/local/gcc-4.7.0/src/gcc-4.7.0/configure --enable-languages=c,c++,fortran --with-gnu-as --with-as=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/as --with-gnu-ld --with-ld=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/ld --with-gmp=/usr/local/mpir-2.5.1/x86_64-Linux-core2-fc-gcc-4.6.3-rh --with-mpfr=/usr/local/mpfr-3.1.0/x86_64-Linux-core2-fc-mpir-2.5.1-gcc-4.6.3-rh --with-mpc=/usr/local/mpc-0.9/x86_64-Linux-core2-fc-mpir-2.5.1-mpfr-3.1.0-gcc-4.6.3-rh --prefix=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc
Thread model: posix
gcc version 4.7.0 (GCC) 
****************************************************
spkg-install is using
VERSION = 4.5.6
GAP_DIR = gap-4.5.6
INSTALL_DIR = /home/buildbot/build/sage/eno-1/eno_full/build/sage-5.5.beta1/local/gap/gap-4.5.6
Applying patches...
patching file gap.shi
patching file tst/testinstall.g
Configuring GAP...
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking size of void *... 8
checking ABI bit size... 64
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking target system type... x86_64-unknown-linux-gnu
checking for gcc... (cached) gcc
checking whether we are using the GNU C compiler... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for gcc option to accept ISO C89... (cached) none needed
checking whether make sets $(MAKE)... yes
checking GAP config name... default64
configure: error: Could not locate GMP in the specified location
Error configuring GAP.
```



---

archive/issue_events_183785.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-02T01:07:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183785"
}
```



---

archive/issue_events_183786.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-02T01:07:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183786"
}
```



---

archive/issue_comments_151721.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nReplying to [@jdemeyer](#comment:84):\n> This fails on Skynet `eno`:\n> \n> ```\n> Host system:\n> Linux eno 3.3.7-1.fc16.x86_64 #1 SMP Tue May 22 13:59:39 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\n> ****************************************************\n> C compiler: gcc\n> C compiler version:\n> Using built-in specs.\n> COLLECT_GCC=gcc\n> COLLECT_LTO_WRAPPER=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc/libexec/gcc/x86_64-unknown-linux-gnu/4.7.0/lto-wrapper\n> Target: x86_64-unknown-linux-gnu\n> Configured with: /usr/local/gcc-4.7.0/src/gcc-4.7.0/configure --enable-languages=c,c++,fortran --with-gnu-as --with-as=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/as --with-gnu-ld --with-ld=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/ld --with-gmp=/usr/local/mpir-2.5.1/x86_64-Linux-core2-fc-gcc-4.6.3-rh --with-mpfr=/usr/local/mpfr-3.1.0/x86_64-Linux-core2-fc-mpir-2.5.1-gcc-4.6.3-rh --with-mpc=/usr/local/mpc-0.9/x86_64-Linux-core2-fc-mpir-2.5.1-mpfr-3.1.0-gcc-4.6.3-rh --prefix=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc\n> Thread model: posix\n> gcc version 4.7.0 (GCC) \n> ```\n\nmust everything be able to run with gcc 4.7.0, too?",
    "created_at": "2012-11-02T03:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151721",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:85" align="right">comment:85</div>

Replying to [@jdemeyer](#comment:84):
> This fails on Skynet `eno`:
> 
> ```
> Host system:
> Linux eno 3.3.7-1.fc16.x86_64 #1 SMP Tue May 22 13:59:39 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
> ****************************************************
> C compiler: gcc
> C compiler version:
> Using built-in specs.
> COLLECT_GCC=gcc
> COLLECT_LTO_WRAPPER=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc/libexec/gcc/x86_64-unknown-linux-gnu/4.7.0/lto-wrapper
> Target: x86_64-unknown-linux-gnu
> Configured with: /usr/local/gcc-4.7.0/src/gcc-4.7.0/configure --enable-languages=c,c++,fortran --with-gnu-as --with-as=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/as --with-gnu-ld --with-ld=/usr/local/binutils-2.22/x86_64-Linux-core2-fc-gcc-4.6.2-rh/bin/ld --with-gmp=/usr/local/mpir-2.5.1/x86_64-Linux-core2-fc-gcc-4.6.3-rh --with-mpfr=/usr/local/mpfr-3.1.0/x86_64-Linux-core2-fc-mpir-2.5.1-gcc-4.6.3-rh --with-mpc=/usr/local/mpc-0.9/x86_64-Linux-core2-fc-mpir-2.5.1-mpfr-3.1.0-gcc-4.6.3-rh --prefix=/usr/local/gcc-4.7.0/x86_64-Linux-core2-fc
> Thread model: posix
> gcc version 4.7.0 (GCC) 
> ```

must everything be able to run with gcc 4.7.0, too?



---

archive/issue_comments_151722.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nReplying to [@dimpase](#comment:85):\n> must everything be able to run with gcc 4.7.0, too?\n\nAt least some gcc-4.7.x version should work.",
    "created_at": "2012-11-02T09:00:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151722",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:86" align="right">comment:86</div>

Replying to [@dimpase](#comment:85):
> must everything be able to run with gcc 4.7.0, too?

At least some gcc-4.7.x version should work.



---

archive/issue_comments_151723.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nThe orphaned processes are still a problem for me.  After playing around with a Sage version including this patch, I am seeing 9 gap processes running at 100% CPU.",
    "created_at": "2012-11-02T09:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151723",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:87" align="right">comment:87</div>

The orphaned processes are still a problem for me.  After playing around with a Sage version including this patch, I am seeing 9 gap processes running at 100% CPU.



---

archive/issue_comments_151724.json:
```json
{
    "body": "Changed keywords from none to **orphaned processes, build on eno**",
    "created_at": "2012-11-02T09:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151724",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from none to **orphaned processes, build on eno**



---

archive/issue_comments_151725.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nOn Itanium (Skynet `iras`):\n\n```\ngap(15123): unaligned access to 0x607ffffffecfa0ef, ip=0x400000000019cbd0\n\ngap(15123): unaligned access to 0x607ffffffecfa0e7, ip=0x400000000019cbd0\n\ngap(15123): unaligned access to 0x607ffffffecfa0df, ip=0x400000000019cbd0\n\ngap(15123): unaligned access to 0x607ffffffecfa0d7, ip=0x400000000019cbd0\n\ngap(15123): unaligned access to 0x607ffffffecfa0cf, ip=0x400000000019cbd0\n\nsage -t  --long -force_lib devel/sage/sage/interfaces/gap.py\n**********************************************************************\nFile \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/devel/sage-main/sage/interfaces/gap.py\", line 886:\n    sage: c = gap.trait_names()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_21[2]>\", line 1, in <module>\n        c = gap.trait_names()###line 886:\n    sage: c = gap.trait_names()\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/lib/python/site-packages/sage/interfaces/gap.py\", line 1379, in trait_names\n        self.__trait_names = eval(self.eval('NamesSystemGVars()')) + \\\n      File \"<string>\", line 2644\n        gap(15082): unaligned access to 0x607ffffffe79200f, ip=0x400000000019cbd0\n                  ^\n    SyntaxError: invalid syntax\n**********************************************************************\n```",
    "created_at": "2012-11-02T09:11:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151725",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:89" align="right">comment:89</div>

On Itanium (Skynet `iras`):

```
gap(15123): unaligned access to 0x607ffffffecfa0ef, ip=0x400000000019cbd0

gap(15123): unaligned access to 0x607ffffffecfa0e7, ip=0x400000000019cbd0

gap(15123): unaligned access to 0x607ffffffecfa0df, ip=0x400000000019cbd0

gap(15123): unaligned access to 0x607ffffffecfa0d7, ip=0x400000000019cbd0

gap(15123): unaligned access to 0x607ffffffecfa0cf, ip=0x400000000019cbd0

sage -t  --long -force_lib devel/sage/sage/interfaces/gap.py
**********************************************************************
File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/devel/sage-main/sage/interfaces/gap.py", line 886:
    sage: c = gap.trait_names()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_21[2]>", line 1, in <module>
        c = gap.trait_names()###line 886:
    sage: c = gap.trait_names()
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.5.beta1/local/lib/python/site-packages/sage/interfaces/gap.py", line 1379, in trait_names
        self.__trait_names = eval(self.eval('NamesSystemGVars()')) + \
      File "<string>", line 2644
        gap(15082): unaligned access to 0x607ffffffe79200f, ip=0x400000000019cbd0
                  ^
    SyntaxError: invalid syntax
**********************************************************************
```



---

archive/issue_comments_151726.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nOn OS X 10.6 (William's `bsd` machine), I get the same build error as `eno`:\n\n```\nHost system:\nDarwin bsd.math.washington.edu 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:32:41 PDT 2011; root:xnu-1504.15.3~1/RELEASE_X86_64 x86_64\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local/libexec/gcc/x86_64-apple-darwin10.8.0/4.6.3/lto-wrapper\nTarget: x86_64-apple-darwin10.8.0\nConfigured with: ../src/configure --prefix=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-local-prefix=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-gmp=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-mpfr=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-mpc=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-system-zlib --disable-multilib  \nThread model: posix\ngcc version 4.6.3 (GCC) \n****************************************************\nspkg-install is using\nVERSION = 4.5.6\nGAP_DIR = gap-4.5.6\nINSTALL_DIR = /Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local/gap/gap-4.5.6\nApplying patches...\npatching file gap.shi\npatching file tst/testinstall.g\nConfiguring GAP...\nchecking for gcc... gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to accept ISO C89... none needed\nchecking how to run the C preprocessor... cpp\nchecking for grep that handles long lines and -e... /usr/bin/grep\nchecking for egrep... /usr/bin/grep -E\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking size of void *... 8\nchecking ABI bit size... 64\nchecking build system type... x86_64-apple-darwin10.8.0\nchecking host system type... x86_64-apple-darwin10.8.0\nchecking target system type... x86_64-apple-darwin10.8.0\nchecking for gcc... (cached) gcc\nchecking whether we are using the GNU C compiler... (cached) yes\nchecking whether gcc accepts -g... (cached) yes\nchecking for gcc option to accept ISO C89... (cached) none needed\nchecking whether make sets $(MAKE)... yes\nchecking GAP config name... default64\nconfigure: error: Could not locate GMP in the specified location\nError configuring GAP.\n```",
    "created_at": "2012-11-02T09:13:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151726",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:90" align="right">comment:90</div>

On OS X 10.6 (William's `bsd` machine), I get the same build error as `eno`:

```
Host system:
Darwin bsd.math.washington.edu 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:32:41 PDT 2011; root:xnu-1504.15.3~1/RELEASE_X86_64 x86_64
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local/libexec/gcc/x86_64-apple-darwin10.8.0/4.6.3/lto-wrapper
Target: x86_64-apple-darwin10.8.0
Configured with: ../src/configure --prefix=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-local-prefix=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-gmp=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-mpfr=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-mpc=/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local --with-system-zlib --disable-multilib  
Thread model: posix
gcc version 4.6.3 (GCC) 
****************************************************
spkg-install is using
VERSION = 4.5.6
GAP_DIR = gap-4.5.6
INSTALL_DIR = /Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.5.beta1/local/gap/gap-4.5.6
Applying patches...
patching file gap.shi
patching file tst/testinstall.g
Configuring GAP...
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking how to run the C preprocessor... cpp
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking size of void *... 8
checking ABI bit size... 64
checking build system type... x86_64-apple-darwin10.8.0
checking host system type... x86_64-apple-darwin10.8.0
checking target system type... x86_64-apple-darwin10.8.0
checking for gcc... (cached) gcc
checking whether we are using the GNU C compiler... (cached) yes
checking whether gcc accepts -g... (cached) yes
checking for gcc option to accept ISO C89... (cached) none needed
checking whether make sets $(MAKE)... yes
checking GAP config name... default64
configure: error: Could not locate GMP in the specified location
Error configuring GAP.
```



---

archive/issue_comments_151727.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nConcerning the orphaned process: could it be that they appear during the **build** as opposed to when running Sage?  Typical command line:\n\n```\n/release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -b -p -T -o 6271720243 /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\n```",
    "created_at": "2012-11-02T09:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151727",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:91" align="right">comment:91</div>

Concerning the orphaned process: could it be that they appear during the **build** as opposed to when running Sage?  Typical command line:

```
/release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -b -p -T -o 6271720243 /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
```



---

archive/issue_comments_151728.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nReplying to [@jdemeyer](#comment:91):\n> Concerning the orphaned process: could it be that they appear during the **build** as opposed to when running Sage?  Typical command line:\n> \n> ```\n> /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -b -p -T -o 6271720243 /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\n> ```\n\nwell, I have seen an orphaned gap process a couple of times, but I don't even recall whether it was with this patch, or not.",
    "created_at": "2012-11-02T10:41:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151728",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:92" align="right">comment:92</div>

Replying to [@jdemeyer](#comment:91):
> Concerning the orphaned process: could it be that they appear during the **build** as opposed to when running Sage?  Typical command line:
> 
> ```
> /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -b -p -T -o 6271720243 /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
> ```

well, I have seen an orphaned gap process a couple of times, but I don't even recall whether it was with this patch, or not.



---

archive/issue_comments_151729.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nReplying to [@jdemeyer](#comment:90):\n> On OS X 10.6 (William's `bsd` machine), I get the same build error as `eno`:\n\nOh, OK, this is a missing dependency, I think. GAP depends upon MPIR now, as it uses (pseudo)GMP. I'll attach a patch in a second.",
    "created_at": "2012-11-02T13:04:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151729",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:93" align="right">comment:93</div>

Replying to [@jdemeyer](#comment:90):
> On OS X 10.6 (William's `bsd` machine), I get the same build error as `eno`:

Oh, OK, this is a missing dependency, I think. GAP depends upon MPIR now, as it uses (pseudo)GMP. I'll attach a patch in a second.



---

archive/issue_comments_151730.json:
```json
{
    "body": "Attachment: **[trac_13211_mpir_dep.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz)**\n\nadding MPIR dependence",
    "created_at": "2012-11-02T13:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151730",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[trac_13211_mpir_dep.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz)**

adding MPIR dependence



---

archive/issue_comments_151731.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,6 +13,9 @@\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n-Apply: \n+Apply to SAGE_ROOT\n+* [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) \n+\n+ Apply\n * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)\n``````\n",
    "created_at": "2012-11-02T13:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151731",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,6 +13,9 @@
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
-Apply: 
+Apply to SAGE_ROOT
+* [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) 
+
+ Apply
 * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
 * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)
``````




---

archive/issue_events_183787.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-02T13:15:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183787"
}
```



---

archive/issue_events_183788.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-02T13:15:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183788"
}
```



---

archive/issue_comments_151732.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nThe question is not why are there GAP orphans, but why is the sage-cleaner not killing them once the parent Sage process quits?\n\nI'll shortly add a patch to run gap with `prctl --unaligned=silent` on itanium, this will get rid of the offending alignment warnings.",
    "created_at": "2012-11-02T15:37:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151732",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:95" align="right">comment:95</div>

The question is not why are there GAP orphans, but why is the sage-cleaner not killing them once the parent Sage process quits?

I'll shortly add a patch to run gap with `prctl --unaligned=silent` on itanium, this will get rid of the offending alignment warnings.



---

archive/issue_comments_151733.json:
```json
{
    "body": "Changed keywords from **orphaned processes, build on eno** to **orphaned processes**",
    "created_at": "2012-11-02T17:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151733",
    "user": "https://github.com/dimpase"
}
```

Changed keywords from **orphaned processes, build on eno** to **orphaned processes**



---

archive/issue_comments_151734.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nI'm currently building again to try to determine when the processes are created.",
    "created_at": "2012-11-02T17:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151734",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:97" align="right">comment:97</div>

I'm currently building again to try to determine when the processes are created.



---

archive/issue_comments_151735.json:
```json
{
    "body": "Attachment: **[trac_13211_itanium_fix.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)**\n\nInitial patch",
    "created_at": "2012-11-02T17:28:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151735",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13211_itanium_fix.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)**

Initial patch



---

archive/issue_comments_151736.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nPositive review to dima's dependency patch.\n\nI've also added the patch to suppress the itanium warnings. I haven't tested it on itanium yet (building sage-5.4.rc3 first). But I've verified that the `prctl` call gets rid of the warnings.",
    "created_at": "2012-11-02T17:30:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151736",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:98" align="right">comment:98</div>

Positive review to dima's dependency patch.

I've also added the patch to suppress the itanium warnings. I haven't tested it on itanium yet (building sage-5.4.rc3 first). But I've verified that the `prctl` call gets rid of the warnings.



---

archive/issue_comments_151737.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,3 +19,4 @@\n  Apply\n * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)\n+* [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n``````\n",
    "created_at": "2012-11-02T17:30:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151737",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,3 +19,4 @@
  Apply
 * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
 * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)
+* [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
``````




---

archive/issue_comments_151738.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nPS: The GAP command line includes `-o 6271720243`, this is clearly from `trac_13211_pool_size.patch` and not a process created during build.",
    "created_at": "2012-11-02T17:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151738",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:99" align="right">comment:99</div>

PS: The GAP command line includes `-o 6271720243`, this is clearly from `trac_13211_pool_size.patch` and not a process created during build.



---

archive/issue_events_183789.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-03T08:58:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183789"
}
```



---

archive/issue_events_183790.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-03T08:58:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183790"
}
```



---

archive/issue_comments_151739.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nI found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.",
    "created_at": "2012-11-03T08:58:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151739",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:0" align="right">comment:0</div>

I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.



---

archive/issue_comments_151740.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nReplying to [@jdemeyer](#comment:100):\n> I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.\n\nI can reproduce this neither on Debian x86_64 nor on OSX 10.6.8. Specifically, I cd to SAGE_ROOT and start\n`./local/bin/sage-starts` there.\nI even tried to remove `~/.sage/`, no difference.\n\nIt looks like we need more details on the system you see this. (Preferably, access to it...).",
    "created_at": "2012-11-03T10:59:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151740",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:101" align="right">comment:101</div>

Replying to [@jdemeyer](#comment:100):
> I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.

I can reproduce this neither on Debian x86_64 nor on OSX 10.6.8. Specifically, I cd to SAGE_ROOT and start
`./local/bin/sage-starts` there.
I even tried to remove `~/.sage/`, no difference.

It looks like we need more details on the system you see this. (Preferably, access to it...).



---

archive/issue_comments_151741.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nReplying to [@dimpase](#comment:101):\n> Replying to [@jdemeyer](#comment:100):\n> > I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.\n\n> \n> I can reproduce this neither on Debian x86_64 nor on OSX 10.6.8. Specifically, I cd to SAGE_ROOT and start\n> `./local/bin/sage-starts` there.\n> I even tried to remove `~/.sage/`, no difference.\n> \n> It looks like we need more details on the system you see this. (Preferably, access to it...).\n\nOK, got it. I need to issue several `local/bin/sage-starts` within a short period of time on Debian x86_64. Then I get the orphans! Otherwise, not. A race condition, of sorts?",
    "created_at": "2012-11-03T11:02:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151741",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:102" align="right">comment:102</div>

Replying to [@dimpase](#comment:101):
> Replying to [@jdemeyer](#comment:100):
> > I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.

> 
> I can reproduce this neither on Debian x86_64 nor on OSX 10.6.8. Specifically, I cd to SAGE_ROOT and start
> `./local/bin/sage-starts` there.
> I even tried to remove `~/.sage/`, no difference.
> 
> It looks like we need more details on the system you see this. (Preferably, access to it...).

OK, got it. I need to issue several `local/bin/sage-starts` within a short period of time on Debian x86_64. Then I get the orphans! Otherwise, not. A race condition, of sorts?



---

archive/issue_comments_151742.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nReplying to [@dimpase](#comment:102):\n> Replying to [@dimpase](#comment:101):\n> > Replying to [@jdemeyer](#comment:100):\n> > > I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.\n\n> > \n> > I can reproduce this neither on Debian x86_64 nor on OSX 10.6.8. Specifically, I cd to SAGE_ROOT and start\n> > `./local/bin/sage-starts` there.\n> > I even tried to remove `~/.sage/`, no difference.\n> > \n> > It looks like we need more details on the system you see this. (Preferably, access to it...).\n\n> OK, got it. I need to issue several `local/bin/sage-starts` within a short period of time on Debian x86_64. Then I get the orphans! Otherwise, not. A race condition, of sorts?\n\nOops, no, in fact, these are not orphans, in the sense that they are not staying running forever. They all finish within 20-30 seconds. A typical process looks as follows (very similar to Jeroen's case):\n\n```\ndima     17195     1 93 19:24 ?        00:00:25 /usr/local/src/sage/sage-5.4.rc3/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /usr/local/src/sage/sage-5.4.rc3/local/gap/latest -r -b -p -T -o 872851456 /usr/local/src/sage/sage-5.4.rc3/local/share/sage/ext/gap/sage.g\n```\n\nJeroen, so you say that for you these processes don't finish by themselves?",
    "created_at": "2012-11-03T11:31:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151742",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:103" align="right">comment:103</div>

Replying to [@dimpase](#comment:102):
> Replying to [@dimpase](#comment:101):
> > Replying to [@jdemeyer](#comment:100):
> > > I found out how to reproduce the orphans: running `local/bin/sage-starts` creates a gap orphan every time I run it.

> > 
> > I can reproduce this neither on Debian x86_64 nor on OSX 10.6.8. Specifically, I cd to SAGE_ROOT and start
> > `./local/bin/sage-starts` there.
> > I even tried to remove `~/.sage/`, no difference.
> > 
> > It looks like we need more details on the system you see this. (Preferably, access to it...).

> OK, got it. I need to issue several `local/bin/sage-starts` within a short period of time on Debian x86_64. Then I get the orphans! Otherwise, not. A race condition, of sorts?

Oops, no, in fact, these are not orphans, in the sense that they are not staying running forever. They all finish within 20-30 seconds. A typical process looks as follows (very similar to Jeroen's case):

```
dima     17195     1 93 19:24 ?        00:00:25 /usr/local/src/sage/sage-5.4.rc3/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /usr/local/src/sage/sage-5.4.rc3/local/gap/latest -r -b -p -T -o 872851456 /usr/local/src/sage/sage-5.4.rc3/local/share/sage/ext/gap/sage.g
```

Jeroen, so you say that for you these processes don't finish by themselves?



---

archive/issue_comments_151743.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@dimpase](#comment:103):\n> Jeroen, so you say that for you these processes don't finish by themselves?\n\nYes, they do not finish by themselves (at least not within a day).\n\n> It looks like we need more details on the system you see this. (Preferably, access to it...). \n\nsage.math.washington.edu: Ubuntu 8.04.4 LTS, x86_64.",
    "created_at": "2012-11-03T12:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151743",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@dimpase](#comment:103):
> Jeroen, so you say that for you these processes don't finish by themselves?

Yes, they do not finish by themselves (at least not within a day).

> It looks like we need more details on the system you see this. (Preferably, access to it...). 

sage.math.washington.edu: Ubuntu 8.04.4 LTS, x86_64.



---

archive/issue_comments_151744.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWell, I spoke too soon, sometimes they do finish by themselves.",
    "created_at": "2012-11-03T12:20:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151744",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Well, I spoke too soon, sometimes they do finish by themselves.



---

archive/issue_comments_151745.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nBig there's still the obvious question: what is that `gap` process doing and why does it keep running for a while?",
    "created_at": "2012-11-03T12:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151745",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Big there's still the obvious question: what is that `gap` process doing and why does it keep running for a while?



---

archive/issue_comments_151746.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nRunning `strace` on such a `gap` process shows:\n\n```\ngetrusage(RUSAGE_SELF, {ru_utime={97, 710000}, ru_stime={0, 200000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={97, 740000}, ru_stime={0, 200000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={97, 770000}, ru_stime={0, 200000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={97, 800000}, ru_stime={0, 200000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={97, 830000}, ru_stime={0, 200000}, ...}) = 0\n```\n[...]\n\n```\ngetrusage(RUSAGE_SELF, {ru_utime={116, 940000}, ru_stime={0, 200000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\n--- SIGSEGV (Segmentation fault) @ 0 (0) ---\nProcess 12608 detached\n```\nIt looks like it's stuck in an infinite loop until it finally segfaults, which is almost certainly not what's supposed to happen.",
    "created_at": "2012-11-03T12:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151746",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Running `strace` on such a `gap` process shows:

```
getrusage(RUSAGE_SELF, {ru_utime={97, 710000}, ru_stime={0, 200000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={97, 740000}, ru_stime={0, 200000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={97, 770000}, ru_stime={0, 200000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={97, 800000}, ru_stime={0, 200000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={97, 830000}, ru_stime={0, 200000}, ...}) = 0
```
[...]

```
getrusage(RUSAGE_SELF, {ru_utime={116, 940000}, ru_stime={0, 200000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
Process 12608 detached
```
It looks like it's stuck in an infinite loop until it finally segfaults, which is almost certainly not what's supposed to happen.



---

archive/issue_comments_151747.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFor those interested: a full `strace` can be found at [http://boxen.math.washington.edu/home/jdemeyer/gap.trace](http://boxen.math.washington.edu/home/jdemeyer/gap.trace)",
    "created_at": "2012-11-03T12:41:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151747",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

For those interested: a full `strace` can be found at [http://boxen.math.washington.edu/home/jdemeyer/gap.trace](http://boxen.math.washington.edu/home/jdemeyer/gap.trace)



---

archive/issue_comments_151748.json:
```json
{
    "body": "<div id=\"comment:109\" align=\"right\">comment:109</div>\n\nReplying to [@jdemeyer](#comment:106):\n> Big there's still the obvious question: what is that `gap` process doing and why does it keep running for a while?\n\nthat it's the same GAP process as the one that gets started during the \"normal\" Sage startup.\nAnd it does the following things, as you can see by uncommenting `LogTo` line at the end of `sage.g`. \n\n```\ngap> LoadPackage(\"ctbllib\");\ntrue\n...\ngap> SaveWorkspace(\"/var/folders/qW/qWY+4Ku1GF0WXrOsV+IDvk+++TM/-Tmp-//dotsageKTXveD/gap/workspace-8046660130267724445\");\ntrue\ngap> \n```\n`LoadPackage()` things are OK, it's just loading GAP's packages.\nThe tough thing is `SaveWorkspace()`, which dumps GAP's workspace into a binary file; which can be loaded back --- well, not in this case of course, cause we are invoked with --nodotsage, so it goes to waste.\n\nSo I suppose that's what gets stuck, and crashes, for some reason (e.g. not enough disk space?).",
    "created_at": "2012-11-03T14:07:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151748",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:109" align="right">comment:109</div>

Replying to [@jdemeyer](#comment:106):
> Big there's still the obvious question: what is that `gap` process doing and why does it keep running for a while?

that it's the same GAP process as the one that gets started during the "normal" Sage startup.
And it does the following things, as you can see by uncommenting `LogTo` line at the end of `sage.g`. 

```
gap> LoadPackage("ctbllib");
true
...
gap> SaveWorkspace("/var/folders/qW/qWY+4Ku1GF0WXrOsV+IDvk+++TM/-Tmp-//dotsageKTXveD/gap/workspace-8046660130267724445");
true
gap> 
```
`LoadPackage()` things are OK, it's just loading GAP's packages.
The tough thing is `SaveWorkspace()`, which dumps GAP's workspace into a binary file; which can be loaded back --- well, not in this case of course, cause we are invoked with --nodotsage, so it goes to waste.

So I suppose that's what gets stuck, and crashes, for some reason (e.g. not enough disk space?).



---

archive/issue_comments_151749.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nWhats the content of your `~/.sage/tmp/<hostname>/<pid>/spawned_processes` file?",
    "created_at": "2012-11-03T14:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151749",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:0" align="right">comment:0</div>

Whats the content of your `~/.sage/tmp/<hostname>/<pid>/spawned_processes` file?



---

archive/issue_comments_151750.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nPS: Writing the workspace dump succeeds as you can see from Jeroen's strace. \n\nWe don't specifically close down GAP afterwards, but just close the stdin/out pipes. This sends GAP into at tizzy, and it keeps trying to read from stdin after getting EIO (why would you do this?). Still, the real question remains: why is GAP not killed by the sage cleaner?",
    "created_at": "2012-11-03T14:17:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151750",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

PS: Writing the workspace dump succeeds as you can see from Jeroen's strace. 

We don't specifically close down GAP afterwards, but just close the stdin/out pipes. This sends GAP into at tizzy, and it keeps trying to read from stdin after getting EIO (why would you do this?). Still, the real question remains: why is GAP not killed by the sage cleaner?



---

archive/issue_comments_151751.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNow I see ENOSPC errors (I think not before):\n\n```\nopen(\"/tmp/dotsagewHCJJ1/gap/workspace-5368401171496622154\", O_WRONLY|O_CREAT|O_TRUNC, 0644) = 4\nwrite(4, \"GAP workspace\\0004.5.6\\00064 bit\\0\\10\\7\\6\\5\\4\"..., 100000) = -1 ENOSPC (No space left on device)\n```\n\nBut this doesn't make sense as there is plenty of space on `/tmp` and I can create large files manually there:\n\n```\njdemeyer@sage:sage-5.5.beta0-gap$ dd if=/dev/zero of=/tmp/dotsagewHCJJ1/gap/workspace-5368401171496622154 bs=1024 count=100000\n100000+0 records in\n100000+0 records out\n102400000 bytes (102 MB) copied, 0.158741 s, 645 MB/s\n```\n\nI am lost...",
    "created_at": "2012-11-03T14:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151751",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Now I see ENOSPC errors (I think not before):

```
open("/tmp/dotsagewHCJJ1/gap/workspace-5368401171496622154", O_WRONLY|O_CREAT|O_TRUNC, 0644) = 4
write(4, "GAP workspace\0004.5.6\00064 bit\0\10\7\6\5\4"..., 100000) = -1 ENOSPC (No space left on device)
```

But this doesn't make sense as there is plenty of space on `/tmp` and I can create large files manually there:

```
jdemeyer@sage:sage-5.5.beta0-gap$ dd if=/dev/zero of=/tmp/dotsagewHCJJ1/gap/workspace-5368401171496622154 bs=1024 count=100000
100000+0 records in
100000+0 records out
102400000 bytes (102 MB) copied, 0.158741 s, 645 MB/s
```

I am lost...



---

archive/issue_comments_151752.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nCould the ENOSPC be related to the fact that this a tmpfs and that GAP reserves all the memory for itself?",
    "created_at": "2012-11-03T14:30:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151752",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Could the ENOSPC be related to the fact that this a tmpfs and that GAP reserves all the memory for itself?



---

archive/issue_comments_151753.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nDoes gap create lots of small files in `/tmp`? If so, are you running out of inodes? You can check using `df -i`.",
    "created_at": "2012-11-03T14:31:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151753",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:4" align="right">comment:4</div>

Does gap create lots of small files in `/tmp`? If so, are you running out of inodes? You can check using `df -i`.



---

archive/issue_comments_151754.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n`/tmp` is as good as empty:\n\n```\njdemeyer@sage:~$ df -h /tmp\nFilesystem      Size  Used Avail Use% Mounted on\ntmpfs            16G   25M   16G   1% /tmp\njdemeyer@sage:~$ df -i /tmp\nFilesystem     Inodes IUsed  IFree IUse% Mounted on\ntmpfs          524288  1253 523035    1% /tmp\n```\n\n(looking at the trace, gap doesn't create a lot of files in `/tmp`)",
    "created_at": "2012-11-03T14:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151754",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

`/tmp` is as good as empty:

```
jdemeyer@sage:~$ df -h /tmp
Filesystem      Size  Used Avail Use% Mounted on
tmpfs            16G   25M   16G   1% /tmp
jdemeyer@sage:~$ df -i /tmp
Filesystem     Inodes IUsed  IFree IUse% Mounted on
tmpfs          524288  1253 523035    1% /tmp
```

(looking at the trace, gap doesn't create a lot of files in `/tmp`)



---

archive/issue_comments_151755.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nPossibly kernel bug? From 2.6.38 changelog: \"tmpfs: fix spurious ENOSPC when racing with unswap\". GAP puts pressure on swap since it locks address space (and hence reduces the available swap).",
    "created_at": "2012-11-03T14:49:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151755",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

Possibly kernel bug? From 2.6.38 changelog: "tmpfs: fix spurious ENOSPC when racing with unswap". GAP puts pressure on swap since it locks address space (and hence reduces the available swap).



---

archive/issue_comments_151756.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSwitching filesystems made to ENOSPC disappear.",
    "created_at": "2012-11-03T15:09:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151756",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Switching filesystems made to ENOSPC disappear.



---

archive/issue_comments_151757.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBut now I cannot reproduce the orphans anymore, they now crash much earlier:\n\n```\nwrite(4, \"\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\202\\30\\0\\0\\0\\0\\0\\0\\300\\3\\0\\0\\0\"..., 100000) = 100000\nwrite(4, \"\\0\\0\\0\\0\\275\\10\\0\\0\\0\\0\\0\\0\\363\\6\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\"..., 100000) = 100000\nwrite(4, \"\\0\\0\\0\\275\\10\\0\\0\\0\\0\\0\\0\\306\\v\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\"..., 100000) = 100000\nwrite(4, \"\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\275\"..., 86744) = 86744\nclose(4)                                = 0\nwrite(1, \"@n\", 2)                       = 2\nwrite(1, \"true@J\", 6)                   = 6\ngetrusage(RUSAGE_SELF, {ru_utime={2, 900000}, ru_stime={0, 140000}, ...}) = 0\ngetrusage(RUSAGE_SELF, {ru_utime={2, 900000}, ru_stime={0, 140000}, ...}) = 0\nwrite(1, \"@n\", 2)                       = 2\nwrite(1, \"gap> \", 5)                    = 5\nwrite(1, \"@i\", 2)                       = 2\ngetrusage(RUSAGE_SELF, {ru_utime={2, 900000}, ru_stime={0, 140000}, ...}) = 0\nread(0, \"\", 1)                          = 0\nwrite(1, \"\\r\", 1)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\nwrite(1, \"@f\", 2)                       = -1 EIO (Input/output error)\n--- SIGSEGV (Segmentation fault) @ 0 (0) ---\n+++ killed by SIGSEGV +++\n```",
    "created_at": "2012-11-03T15:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151757",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

But now I cannot reproduce the orphans anymore, they now crash much earlier:

```
write(4, "\0\0\0\0\0\0\0\0\0\0\0\0\202\30\0\0\0\0\0\0\300\3\0\0\0"..., 100000) = 100000
write(4, "\0\0\0\0\275\10\0\0\0\0\0\0\363\6\0\0\0\0\0\0\0\0\0\0\0"..., 100000) = 100000
write(4, "\0\0\0\275\10\0\0\0\0\0\0\306\v\0\0\0\0\0\0\0\0\0\0\0\0"..., 100000) = 100000
write(4, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\275"..., 86744) = 86744
close(4)                                = 0
write(1, "@n", 2)                       = 2
write(1, "true@J", 6)                   = 6
getrusage(RUSAGE_SELF, {ru_utime={2, 900000}, ru_stime={0, 140000}, ...}) = 0
getrusage(RUSAGE_SELF, {ru_utime={2, 900000}, ru_stime={0, 140000}, ...}) = 0
write(1, "@n", 2)                       = 2
write(1, "gap> ", 5)                    = 5
write(1, "@i", 2)                       = 2
getrusage(RUSAGE_SELF, {ru_utime={2, 900000}, ru_stime={0, 140000}, ...}) = 0
read(0, "", 1)                          = 0
write(1, "\r", 1)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
write(1, "@f", 2)                       = -1 EIO (Input/output error)
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++
```



---

archive/issue_comments_151758.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAnd `\"$DOT_SAGE/tmp/sage.math.washington.edu\"` is empty after Sage is finished.",
    "created_at": "2012-11-03T15:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151758",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

And `"$DOT_SAGE/tmp/sage.math.washington.edu"` is empty after Sage is finished.



---

archive/issue_comments_151759.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nBut for `sage-cleaner`, what matters is \"$DOT_SAGE/**temp**/sage.math.washington.edu\"",
    "created_at": "2012-11-03T15:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151759",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:0" align="right">comment:0</div>

But for `sage-cleaner`, what matters is "$DOT_SAGE/**temp**/sage.math.washington.edu"



---

archive/issue_comments_151760.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWhen running Sage **interactively** (as opposed to `sage -c`), `gap` gets closed properly because it gets sent `\"quit;\\n\"`\n\n```\nwrite(4, \"\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\201\\20\\0\\0\\0\\0\"..., 91115) = 91115\nclose(4)                                = 0\nwrite(1, \"@n\", 2)                       = 2\nwrite(1, \"true@J\", 6)                   = 6\ngetrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0\ngetrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0\nwrite(1, \"@n\", 2)                       = 2\nwrite(1, \"gap> \", 5)                    = 5\nwrite(1, \"@i\", 2)                       = 2\ngetrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0\nread(0, \"q\", 1)                         = 1\nwrite(1, \"q\", 1)                        = 1\nread(0, \"u\", 1)                         = 1\nwrite(1, \"u\", 1)                        = 1\nread(0, \"i\", 1)                         = 1\nwrite(1, \"i\", 1)                        = 1\nread(0, \"t\", 1)                         = 1\nwrite(1, \"t\", 1)                        = 1\nread(0, \";\", 1)                         = 1\nwrite(1, \";\", 1)                        = 1\nread(0, \"\\n\", 1)                        = 1\nwrite(1, \"\\r\", 1)                       = 1\nwrite(1, \"\\n\", 1)                       = 1\nwrite(1, \"@r\", 2)                       = 2\nwrite(1, \"quit;@J\", 7)                  = 7\ngetrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0\nread(3, \"\", 20000)                      = 0\nclose(3)                                = 0\nexit_group(0)                           = ?\n```",
    "created_at": "2012-11-03T15:20:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151760",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

When running Sage **interactively** (as opposed to `sage -c`), `gap` gets closed properly because it gets sent `"quit;\n"`

```
write(4, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\201\20\0\0\0\0"..., 91115) = 91115
close(4)                                = 0
write(1, "@n", 2)                       = 2
write(1, "true@J", 6)                   = 6
getrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0
getrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0
write(1, "@n", 2)                       = 2
write(1, "gap> ", 5)                    = 5
write(1, "@i", 2)                       = 2
getrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0
read(0, "q", 1)                         = 1
write(1, "q", 1)                        = 1
read(0, "u", 1)                         = 1
write(1, "u", 1)                        = 1
read(0, "i", 1)                         = 1
write(1, "i", 1)                        = 1
read(0, "t", 1)                         = 1
write(1, "t", 1)                        = 1
read(0, ";", 1)                         = 1
write(1, ";", 1)                        = 1
read(0, "\n", 1)                        = 1
write(1, "\r", 1)                       = 1
write(1, "\n", 1)                       = 1
write(1, "@r", 2)                       = 2
write(1, "quit;@J", 7)                  = 7
getrusage(RUSAGE_SELF, {ru_utime={2, 790000}, ru_stime={0, 170000}, ...}) = 0
read(3, "", 20000)                      = 0
close(3)                                = 0
exit_group(0)                           = ?
```



---

archive/issue_comments_151761.json:
```json
{
    "body": "Changed keywords from **orphaned processes** to **segmentation fault in child process**",
    "created_at": "2012-11-03T15:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151761",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from **orphaned processes** to **segmentation fault in child process**



---

archive/issue_comments_151762.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nRegardless of `sage-cleaner`, I think it's clear that the gap Segmentation Fault should be fixed.",
    "created_at": "2012-11-03T15:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151762",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Regardless of `sage-cleaner`, I think it's clear that the gap Segmentation Fault should be fixed.



---

archive/issue_comments_151763.json:
```json
{
    "body": "<div id=\"comment:123\" align=\"right\">comment:123</div>\n\nReplying to [@jdemeyer](#comment:120):\n> But for `sage-cleaner`, what matters is \"$DOT_SAGE/**temp**/sage.math.washington.edu\"\n\nOK, so the cleaner does not clean if one starts with --nodotsage...\n\nAt least this should go  another ticket, IMHO.",
    "created_at": "2012-11-03T15:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151763",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:123" align="right">comment:123</div>

Replying to [@jdemeyer](#comment:120):
> But for `sage-cleaner`, what matters is "$DOT_SAGE/**temp**/sage.math.washington.edu"

OK, so the cleaner does not clean if one starts with --nodotsage...

At least this should go  another ticket, IMHO.



---

archive/issue_comments_151764.json:
```json
{
    "body": "Work Issues: **segmentation fault in child process**",
    "created_at": "2012-11-03T15:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151764",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **segmentation fault in child process**



---

archive/issue_comments_151765.json:
```json
{
    "body": "Changed keywords from **segmentation fault in child process** to none",
    "created_at": "2012-11-03T15:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151765",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from **segmentation fault in child process** to none



---

archive/issue_comments_151766.json:
```json
{
    "body": "Initial patch",
    "created_at": "2012-11-03T15:34:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151766",
    "user": "https://github.com/vbraun"
}
```

Initial patch



---

archive/issue_comments_151767.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAttachment: **[trac_13211_quit_after_workspace.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)**\n\nI've added a patch to explicitly quit Gap after writing the workspace. \n\nThe sage-cleaner indeed looks in `.../temp/...`, but `SAGE_TMP` is in `.../tmp/...` so the cleaner is currently broken. Thats the fault of #13579",
    "created_at": "2012-11-03T15:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151767",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">comment:5</div>

Attachment: **[trac_13211_quit_after_workspace.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)**

I've added a patch to explicitly quit Gap after writing the workspace. 

The sage-cleaner indeed looks in `.../temp/...`, but `SAGE_TMP` is in `.../tmp/...` so the cleaner is currently broken. Thats the fault of #13579



---

archive/issue_events_183791.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-03T15:41:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183791"
}
```



---

archive/issue_events_183792.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-03T15:41:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183792"
}
```



---

archive/issue_comments_151768.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,3 +20,4 @@\n * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)\n * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n+* [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)\n``````\n",
    "created_at": "2012-11-03T15:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151768",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,3 +20,4 @@
 * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
 * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)
 * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
+* [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)
``````




---

archive/issue_comments_151769.json:
```json
{
    "body": "Changed work issues from **segmentation fault in child process** to none",
    "created_at": "2012-11-03T15:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151769",
    "user": "https://github.com/vbraun"
}
```

Changed work issues from **segmentation fault in child process** to none



---

archive/issue_comments_151770.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI've made #13681 to deal with some fallout of the `SAGE_TMP` change that #13579 introduced.",
    "created_at": "2012-11-03T16:12:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151770",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

I've made #13681 to deal with some fallout of the `SAGE_TMP` change that #13579 introduced.



---

archive/issue_events_183793.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-04T04:06:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183793"
}
```



---

archive/issue_events_183794.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-04T04:06:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183794"
}
```



---

archive/issue_comments_151771.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAfter running some doctests again with this patch, I see a lot of orphan gap processes again.\nThe strace is as before:\n\n```\n[...]\ngetrusage(RUSAGE_SELF, {ru_utime={9186, 870000}, ru_stime={6, 120000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={9187, 210000}, ru_stime={6, 120000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={9187, 550000}, ru_stime={6, 120000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={9187, 910000}, ru_stime={6, 120000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\ngetrusage(RUSAGE_SELF, {ru_utime={9188, 260000}, ru_stime={6, 120000}, ...}) = 0\nwrite(1, \"@!\", 2)                       = -1 EIO (Input/output error)\n[...]\n```",
    "created_at": "2012-11-08T20:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151771",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

After running some doctests again with this patch, I see a lot of orphan gap processes again.
The strace is as before:

```
[...]
getrusage(RUSAGE_SELF, {ru_utime={9186, 870000}, ru_stime={6, 120000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={9187, 210000}, ru_stime={6, 120000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={9187, 550000}, ru_stime={6, 120000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={9187, 910000}, ru_stime={6, 120000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
getrusage(RUSAGE_SELF, {ru_utime={9188, 260000}, ru_stime={6, 120000}, ...}) = 0
write(1, "@!", 2)                       = -1 EIO (Input/output error)
[...]
```



---

archive/issue_events_183795.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-08T20:29:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183795"
}
```



---

archive/issue_events_183796.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-08T20:29:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183796"
}
```



---

archive/issue_events_183797.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-09T15:37:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183797"
}
```



---

archive/issue_events_183798.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-09T15:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183798"
}
```



---

archive/issue_comments_151772.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAgain, the question is not why are there GAP orphans but why is the sage-cleaner not killing them once the parent Sage process quits?",
    "created_at": "2012-11-09T15:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151772",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Again, the question is not why are there GAP orphans but why is the sage-cleaner not killing them once the parent Sage process quits?



---

archive/issue_comments_151773.json:
```json
{
    "body": "<div id=\"comment:130\" align=\"right\">comment:130</div>\n\nReplying to [@vbraun](#comment:129):\n> Again, the question is not why are there GAP orphans but why is the sage-cleaner not killing them once the parent Sage process quits?\n\nThat's **a** question, I don't think it's **the** question.  Sage should clean up for itself and `sage-cleaner` should only be a last resort.",
    "created_at": "2012-11-09T17:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151773",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:130" align="right">comment:130</div>

Replying to [@vbraun](#comment:129):
> Again, the question is not why are there GAP orphans but why is the sage-cleaner not killing them once the parent Sage process quits?

That's **a** question, I don't think it's **the** question.  Sage should clean up for itself and `sage-cleaner` should only be a last resort.



---

archive/issue_comments_151774.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI agree, but since you are the only one who is able to get the orphans (possibly in conjunction with a kernel bug) I'd be perfectly happy to let sage-cleaner handle this corner case.",
    "created_at": "2012-11-09T17:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151774",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

I agree, but since you are the only one who is able to get the orphans (possibly in conjunction with a kernel bug) I'd be perfectly happy to let sage-cleaner handle this corner case.



---

archive/issue_comments_151775.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nOn an unrelated note, the interleaved getrusage / write strace probably means that GAP is running something in the internal profiler.",
    "created_at": "2012-11-09T17:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151775",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">comment:2</div>

On an unrelated note, the interleaved getrusage / write strace probably means that GAP is running something in the internal profiler.



---

archive/issue_comments_151776.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nCan you confirm that the offending gap process still doesn't include the \"-L ...gapworkspace..\" command line switch? This probably means that the processes originate when creating the workspace. Is this on a file system that disallows simultaneous writes from multiple processes to the same file?",
    "created_at": "2012-11-09T18:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151776",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

Can you confirm that the offending gap process still doesn't include the "-L ...gapworkspace.." command line switch? This probably means that the processes originate when creating the workspace. Is this on a file system that disallows simultaneous writes from multiple processes to the same file?



---

archive/issue_comments_151777.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAlso, can you post a strace for the hanging GAP process? With trac_13211_quit_after_workspace.patch the 'gap_reset_workspace()' command quits correctly, so I suspect your problem is at a different place now.",
    "created_at": "2012-11-09T18:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151777",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

Also, can you post a strace for the hanging GAP process? With trac_13211_quit_after_workspace.patch the 'gap_reset_workspace()' command quits correctly, so I suspect your problem is at a different place now.



---

archive/issue_comments_151778.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nTo better test this, I disabled the cleaner (by putting `sys.exit(0)` in `sage-cleaner`).\n\nExample strace of segfaulting process is attached.",
    "created_at": "2012-11-12T10:11:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151778",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

To better test this, I disabled the cleaner (by putting `sys.exit(0)` in `sage-cleaner`).

Example strace of segfaulting process is attached.



---

archive/issue_comments_151779.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI'm also seeing a lot of `ENOMEM` errors in the trace.  Could these be caused by the huge pool size?",
    "created_at": "2012-11-12T10:15:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151779",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I'm also seeing a lot of `ENOMEM` errors in the trace.  Could these be caused by the huge pool size?



---

archive/issue_comments_151780.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThere is a potential infinite loop with `_eval_line` in `gap.py`: when it crashes, it keeps trying again over and over:\n\n```\n    def _eval_line(self, line, allow_use_file=True, wait_for_prompt=True, restart_if_needed=True):\n        [...]\n        try:\n            [...]\n        except (RuntimeError,TypeError),message:\n            if 'EOF' in message[0] or E is None or not E.isalive():\n                print \"** %s crashed or quit executing '%s' **\"%(self, line)\n                print \"Restarting %s and trying again\"%self\n                self._start()\n                if line != '':\n                    return self._eval_line(line, allow_use_file=allow_use_file)\n                else:\n                    return ''\n            else:\n                raise RuntimeError, message\n```\n\nIs this intentional? Probably the number of retries should be limited.\n\n(this seems unrelated to this ticket but I thought I should mention it)",
    "created_at": "2012-11-12T10:44:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151780",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

There is a potential infinite loop with `_eval_line` in `gap.py`: when it crashes, it keeps trying again over and over:

```
    def _eval_line(self, line, allow_use_file=True, wait_for_prompt=True, restart_if_needed=True):
        [...]
        try:
            [...]
        except (RuntimeError,TypeError),message:
            if 'EOF' in message[0] or E is None or not E.isalive():
                print "** %s crashed or quit executing '%s' **"%(self, line)
                print "Restarting %s and trying again"%self
                self._start()
                if line != '':
                    return self._eval_line(line, allow_use_file=allow_use_file)
                else:
                    return ''
            else:
                raise RuntimeError, message
```

Is this intentional? Probably the number of retries should be limited.

(this seems unrelated to this ticket but I thought I should mention it)



---

archive/issue_comments_151781.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nDid you apply `trac_13211_pool_size.patch`? Unless your machine has exabyte-sized swap it shouldn't even try to allocate such a large pool.",
    "created_at": "2012-11-12T16:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151781",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

Did you apply `trac_13211_pool_size.patch`? Unless your machine has exabyte-sized swap it shouldn't even try to allocate such a large pool.



---

archive/issue_comments_151782.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOh I see, `gap -o <number>` doesn't work. It apparently requires a binary prefix.",
    "created_at": "2012-11-12T16:30:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151782",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Oh I see, `gap -o <number>` doesn't work. It apparently requires a binary prefix.



---

archive/issue_comments_151783.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nThere is apparently an overflow in gap's argument parsing at `3*2^31`:\n\n```\n(sage-sh) vbraun@localhost:~$ /home/vbraun/opt/sage-5.4.rc4/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -l /home/vbraun/opt/sage-5.4.rc4/local/gap/latest -o 6442450943\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   GAP, Version 4.5.6 of 16-Sep-2012 (free software, GPL)\n \u2502  GAP  \u2502   http://www.gap-system.org\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   Architecture: x86_64-unknown-linux-gnu-gcc-default64\n Libs used:  gmp, readline\n Loading the library and packages ...\n Packages:   GAPDoc 1.5.1\n Try '?help' for help. See also  '?copyright' and  '?authors'\ngap> \n(sage-sh) vbraun@localhost:~$ /home/vbraun/opt/sage-5.4.rc4/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -l /home/vbraun/opt/sage-5.4.rc4/local/gap/latest -o 6442450944\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\ngap: halving pool size.\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   GAP, Version 4.5.6 of 16-Sep-2012 (free software, GPL)\n \u2502  GAP  \u2502   http://www.gap-system.org\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   Architecture: x86_64-unknown-linux-gnu-gcc-default64\n Libs used:  gmp, readline\n Loading the library and packages ...\n Packages:   GAPDoc 1.5.1\n Try '?help' for help. See also  '?copyright' and  '?authors'\n```\nThat explains why you get the ENOMEMs. But gap tries smaller and smaller mmaps until it succeeds, so this is not a real problem. It will eat the available swap space and put much more pressure on the virtual memory system, though. I'll report this issue upstream.",
    "created_at": "2012-11-12T21:21:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151783",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:0" align="right">comment:0</div>

There is apparently an overflow in gap's argument parsing at `3*2^31`:

```
(sage-sh) vbraun@localhost:~$ /home/vbraun/opt/sage-5.4.rc4/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -l /home/vbraun/opt/sage-5.4.rc4/local/gap/latest -o 6442450943
 ┌───────┐   GAP, Version 4.5.6 of 16-Sep-2012 (free software, GPL)
 │  GAP  │   http://www.gap-system.org
 └───────┘   Architecture: x86_64-unknown-linux-gnu-gcc-default64
 Libs used:  gmp, readline
 Loading the library and packages ...
 Packages:   GAPDoc 1.5.1
 Try '?help' for help. See also  '?copyright' and  '?authors'
gap> 
(sage-sh) vbraun@localhost:~$ /home/vbraun/opt/sage-5.4.rc4/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -l /home/vbraun/opt/sage-5.4.rc4/local/gap/latest -o 6442450944
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
gap: halving pool size.
 ┌───────┐   GAP, Version 4.5.6 of 16-Sep-2012 (free software, GPL)
 │  GAP  │   http://www.gap-system.org
 └───────┘   Architecture: x86_64-unknown-linux-gnu-gcc-default64
 Libs used:  gmp, readline
 Loading the library and packages ...
 Packages:   GAPDoc 1.5.1
 Try '?help' for help. See also  '?copyright' and  '?authors'
```
That explains why you get the ENOMEMs. But gap tries smaller and smaller mmaps until it succeeds, so this is not a real problem. It will eat the available swap space and put much more pressure on the virtual memory system, though. I'll report this issue upstream.



---

archive/issue_comments_151784.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI've updated the patch to use `gap -o <number>m` for a specific number of megabytes instead of specifying the pool size in bytes. This should avoid the argument parsing overflow.",
    "created_at": "2012-11-12T21:47:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151784",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

I've updated the patch to use `gap -o <number>m` for a specific number of megabytes instead of specifying the pool size in bytes. This should avoid the argument parsing overflow.



---

archive/issue_comments_151785.json:
```json
{
    "body": "<div id=\"comment:142\" align=\"right\">comment:142</div>\n\nReplying to [@vbraun](#comment:140):\n> There is apparently an overflow in gap's argument parsing at `3*2^31`:\n> That explains why you get the ENOMEMs. But gap tries smaller and smaller mmaps until it succeeds, so this is not a real problem. It will eat the available swap space and put much more pressure on the virtual memory system, though. I'll report this issue upstream.\n\nby the way, GAP finally has a real [tracker](http://tracker.gap-system.org/)!",
    "created_at": "2012-11-13T02:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151785",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:142" align="right">comment:142</div>

Replying to [@vbraun](#comment:140):
> There is apparently an overflow in gap's argument parsing at `3*2^31`:
> That explains why you get the ENOMEMs. But gap tries smaller and smaller mmaps until it succeeds, so this is not a real problem. It will eat the available swap space and put much more pressure on the virtual memory system, though. I'll report this issue upstream.

by the way, GAP finally has a real [tracker](http://tracker.gap-system.org/)!



---

archive/issue_events_183799.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-13T09:42:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183799"
}
```



---

archive/issue_events_183800.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-13T09:42:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183800"
}
```



---

archive/issue_comments_151786.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">comment:143</div>\n\nReplying to [@vbraun](#comment:141):\n> I've updated the patch to use `gap -o <number>m` for a specific number of megabytes instead of specifying the pool size in bytes. This should avoid the argument parsing overflow.\n\nOK, I am testing this on the culprit machine (sage on sagemath UW cluster), and not able to see any staying up GAP processes. I'll try a bit more, and unless I succeed, I'll make it positive review...",
    "created_at": "2012-11-13T09:42:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151786",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:143" align="right">comment:143</div>

Replying to [@vbraun](#comment:141):
> I've updated the patch to use `gap -o <number>m` for a specific number of megabytes instead of specifying the pool size in bytes. This should avoid the argument parsing overflow.

OK, I am testing this on the culprit machine (sage on sagemath UW cluster), and not able to see any staying up GAP processes. I'll try a bit more, and unless I succeed, I'll make it positive review...



---

archive/issue_comments_151787.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAfter building and fully doctesting Sage, I still end up with 20 gap processes:\n\n```\njdemeyer@sage:~$ ps -ef |grep gap\njdemeyer  6148     1 83 10:12 ?        03:35:26 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\njdemeyer  6150     1 83 10:12 ?        03:36:51 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\njdemeyer  6154     1 83 10:12 ?        03:35:23 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\n[...]\n```",
    "created_at": "2012-11-13T13:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151787",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

After building and fully doctesting Sage, I still end up with 20 gap processes:

```
jdemeyer@sage:~$ ps -ef |grep gap
jdemeyer  6148     1 83 10:12 ?        03:35:26 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
jdemeyer  6150     1 83 10:12 ?        03:36:51 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
jdemeyer  6154     1 83 10:12 ?        03:35:23 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
[...]
```



---

archive/issue_comments_151788.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAt least, the ENOMEM errors are gone!",
    "created_at": "2012-11-13T13:42:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151788",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

At least, the ENOMEM errors are gone!



---

archive/issue_comments_151789.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n[attachment: gap.10799](https://github.com/sagemath/sage/files/ticket13211/gap.10799.gz) shows the strace of a hanging process. At some point, the trace stops, it seems no further system calls are done.\n\nI don't see the EIO errors and segmentation faults anymore, perhaps that was caused by ENOMEM?",
    "created_at": "2012-11-13T13:56:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151789",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

[attachment: gap.10799](https://github.com/sagemath/sage/files/ticket13211/gap.10799.gz) shows the strace of a hanging process. At some point, the trace stops, it seems no further system calls are done.

I don't see the EIO errors and segmentation faults anymore, perhaps that was caused by ENOMEM?



---

archive/issue_comments_151790.json:
```json
{
    "body": "<div id=\"comment:147\" align=\"right\">comment:147</div>\n\nReplying to [@jdemeyer](#comment:144):\n> After building and fully doctesting Sage, I still end up with 20 gap processes:\n\nI tried applying the patches (and the spkg) on this ticket to Sage 5.4.rc4, and running `make ptest`. I have not got any `gap` processes left after it has finished. Have you been doing something else, something nonstandard?",
    "created_at": "2012-11-13T14:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151790",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:147" align="right">comment:147</div>

Replying to [@jdemeyer](#comment:144):
> After building and fully doctesting Sage, I still end up with 20 gap processes:

I tried applying the patches (and the spkg) on this ticket to Sage 5.4.rc4, and running `make ptest`. I have not got any `gap` processes left after it has finished. Have you been doing something else, something nonstandard?



---

archive/issue_comments_151791.json:
```json
{
    "body": "<div id=\"comment:148\" align=\"right\">comment:148</div>\n\nReplying to [@jdemeyer](#comment:144):\n> After building and fully doctesting Sage, I still end up with 20 gap processes:\n> \n> ```\n> jdemeyer@sage:~$ ps -ef |grep gap\n> jdemeyer  6148     1 83 10:12 ?        03:35:26 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\n> jdemeyer  6150     1 83 10:12 ?        03:36:51 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\n> jdemeyer  6154     1 83 10:12 ?        03:35:23 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g\n> [...]\n> ```\n\nWhere is .sage/ used in these calls to GAP? AFAIK there is no `/release/merger/sage-5.5.beta2/home/`, yet they list GAP workspace files `/release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359`.\n\nWeird. Could it be the reason for them to hang?",
    "created_at": "2012-11-13T14:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151791",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:148" align="right">comment:148</div>

Replying to [@jdemeyer](#comment:144):
> After building and fully doctesting Sage, I still end up with 20 gap processes:
> 
> ```
> jdemeyer@sage:~$ ps -ef |grep gap
> jdemeyer  6148     1 83 10:12 ?        03:35:26 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
> jdemeyer  6150     1 83 10:12 ?        03:36:51 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
> jdemeyer  6154     1 83 10:12 ?        03:35:23 /release/merger/sage-5.5.beta2/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap -m 24m -l /release/merger/sage-5.5.beta2/local/gap/latest -r -L /release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359 -b -p -T -o 6274m /release/merger/sage-5.5.beta2/local/share/sage/ext/gap/sage.g
> [...]
> ```

Where is .sage/ used in these calls to GAP? AFAIK there is no `/release/merger/sage-5.5.beta2/home/`, yet they list GAP workspace files `/release/merger/sage-5.5.beta2/home/.sage/gap/workspace-1647326966196298359`.

Weird. Could it be the reason for them to hang?



---

archive/issue_comments_151792.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n`/release/merger/sage-5.5.beta2/home` is a temporary `$HOME` directory for the merger. It's similar to using the `--nodotsage` command line option to `sage`.",
    "created_at": "2012-11-13T15:08:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151792",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

`/release/merger/sage-5.5.beta2/home` is a temporary `$HOME` directory for the merger. It's similar to using the `--nodotsage` command line option to `sage`.



---

archive/issue_comments_151793.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nThe GAP developers acknowledged the option parsing overflow, will be fixed in the next stable release.",
    "created_at": "2012-11-13T17:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151793",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:0" align="right">comment:0</div>

The GAP developers acknowledged the option parsing overflow, will be fixed in the next stable release.



---

archive/issue_comments_151794.json:
```json
{
    "body": "Attachment: **[trac_13211_quit.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)**\n\nInitial patch",
    "created_at": "2012-11-13T18:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151794",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13211_quit.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)**

Initial patch



---

archive/issue_comments_151795.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nIs the number of orphans related to the number of parallel doctest processes? The added patch fixes an issue where we abandoned one process instead of killing it if the cached workspace fails to load and needs to be recreated.",
    "created_at": "2012-11-13T18:47:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151795",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

Is the number of orphans related to the number of parallel doctest processes? The added patch fixes an issue where we abandoned one process instead of killing it if the cached workspace fails to load and needs to be recreated.



---

archive/issue_comments_151796.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,4 @@\n * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)\n * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)\n+* [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)\n``````\n",
    "created_at": "2012-11-13T18:48:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151796",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,4 @@
 * [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)
 * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
 * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)
+* [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)
``````




---

archive/issue_comments_151797.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI spoke too soon about the EIO errors and segmentation faults being gone, I still get them.",
    "created_at": "2012-11-13T20:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151797",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

I spoke too soon about the EIO errors and segmentation faults being gone, I still get them.



---

archive/issue_comments_151798.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI still don't understand why you get EIO. This means something is seriously foobared, no? When sage quits the other end of the pipe should be closed, resulting in EPIPE.\n\nMy theory is the following: the Sage expect interface can use temporary files to redirect stdin/out and this is where the problem lies. If you run with `sage --nodotsage`, this temporary file is on `/tmp` (see `SAGE_TMP_INTERFACE`). The tmpfs on sage.math has some bug that is triggered when you put pressure on the virtual memory, when most of the swap is locked in anonymous mmaps.",
    "created_at": "2012-11-13T22:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151798",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

I still don't understand why you get EIO. This means something is seriously foobared, no? When sage quits the other end of the pipe should be closed, resulting in EPIPE.

My theory is the following: the Sage expect interface can use temporary files to redirect stdin/out and this is where the problem lies. If you run with `sage --nodotsage`, this temporary file is on `/tmp` (see `SAGE_TMP_INTERFACE`). The tmpfs on sage.math has some bug that is triggered when you put pressure on the virtual memory, when most of the swap is locked in anonymous mmaps.



---

archive/issue_comments_151799.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI ran some more doctests and GAP is not the only process that ends up in a write loop with EIO until it segfaults. E.g. Maxima does it, too. I guess your problem is that GAP does **not** segfault under certain circumstances.",
    "created_at": "2012-11-14T04:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151799",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">comment:5</div>

I ran some more doctests and GAP is not the only process that ends up in a write loop with EIO until it segfaults. E.g. Maxima does it, too. I guess your problem is that GAP does **not** segfault under certain circumstances.



---

archive/issue_comments_151800.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe glibc manual says: *EIO also occurs when a background process tries to read from the controlling terminal, and the normal action of stopping the process by sending it a SIGTTIN signal isn't working. This might happen if signal is being blocked or ignored, or because the process group is orphaned. See section Job Control, for more information about job control, and section Signal Handling, for information about signals.*",
    "created_at": "2012-11-14T04:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151800",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

The glibc manual says: *EIO also occurs when a background process tries to read from the controlling terminal, and the normal action of stopping the process by sending it a SIGTTIN signal isn't working. This might happen if signal is being blocked or ignored, or because the process group is orphaned. See section Job Control, for more information about job control, and section Signal Handling, for information about signals.*



---

archive/issue_comments_151801.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI don't want to annoy Jeroen yet again, but I really think we are done with this ticket. If on an old system (Ubuntu 8.04 LTS will reach its EOL in the coming April) under some very unusual circumstances it doesn't quite work as expected, it should not  hold the ticket up.",
    "created_at": "2012-11-14T05:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151801",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

I don't want to annoy Jeroen yet again, but I really think we are done with this ticket. If on an old system (Ubuntu 8.04 LTS will reach its EOL in the coming April) under some very unusual circumstances it doesn't quite work as expected, it should not  hold the ticket up.



---

archive/issue_comments_151802.json:
```json
{
    "body": "<div id=\"comment:158\" align=\"right\">comment:158</div>\n\nReplying to [@dimpase](#comment:157):\n> I don't want to annoy Jeroen yet again, but I really think we are done with this ticket. If on an old system (Ubuntu 8.04 LTS will reach its EOL in the coming April) under some very unusual circumstances it doesn't quite work as expected, it should not  hold the ticket up. \n\nIf that old system happens to be the one on which Sage releases are made, it obviously holds up the ticket.",
    "created_at": "2012-11-14T08:13:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151802",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:158" align="right">comment:158</div>

Replying to [@dimpase](#comment:157):
> I don't want to annoy Jeroen yet again, but I really think we are done with this ticket. If on an old system (Ubuntu 8.04 LTS will reach its EOL in the coming April) under some very unusual circumstances it doesn't quite work as expected, it should not  hold the ticket up. 

If that old system happens to be the one on which Sage releases are made, it obviously holds up the ticket.



---

archive/issue_comments_151803.json:
```json
{
    "body": "Attachment: **[gap.19589.gz](https://github.com/sagemath/sage/files/ticket13211/gap.19589.gz)**\n\nFirst 1500 lines of an infinite strace",
    "created_at": "2012-11-14T13:50:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151803",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[gap.19589.gz](https://github.com/sagemath/sage/files/ticket13211/gap.19589.gz)**

First 1500 lines of an infinite strace



---

archive/issue_comments_151804.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI doubt that `/tmp` has anything to do with it. The filedescriptor giving EIO is a deleted pseudo-terminal, not a temporary file. This can be seen from `/proc/$PID/fd`:\n\n```\njdemeyer@sage:/tmp/gaptrace$ ls -l /proc/19589/fd\ntotal 0\nlrwx------ 1 jdemeyer jdemeyer 64 Nov 14 11:49 0 -> /dev/pts/71 (deleted)\nlrwx------ 1 jdemeyer jdemeyer 64 Nov 14 11:49 1 -> /dev/pts/71 (deleted)\nlrwx------ 1 jdemeyer jdemeyer 64 Nov 14 11:49 2 -> /dev/pts/71 (deleted)\n```\n\nI don't think it's a relevant discussion why we sometimes get Segmentation Faults and sometimes not.",
    "created_at": "2012-11-14T13:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151804",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

I doubt that `/tmp` has anything to do with it. The filedescriptor giving EIO is a deleted pseudo-terminal, not a temporary file. This can be seen from `/proc/$PID/fd`:

```
jdemeyer@sage:/tmp/gaptrace$ ls -l /proc/19589/fd
total 0
lrwx------ 1 jdemeyer jdemeyer 64 Nov 14 11:49 0 -> /dev/pts/71 (deleted)
lrwx------ 1 jdemeyer jdemeyer 64 Nov 14 11:49 1 -> /dev/pts/71 (deleted)
lrwx------ 1 jdemeyer jdemeyer 64 Nov 14 11:49 2 -> /dev/pts/71 (deleted)
```

I don't think it's a relevant discussion why we sometimes get Segmentation Faults and sometimes not.



---

archive/issue_events_183801.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-14T13:55:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183801"
}
```



---

archive/issue_events_183802.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-14T13:55:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183802"
}
```



---

archive/issue_comments_151805.json:
```json
{
    "body": "<div id=\"comment:160\" align=\"right\">comment:160</div>\n\nReplying to [@vbraun](#comment:154):\n> When sage quits the other end of the pipe should be closed, resulting in EPIPE.\n\nA pseudo-terminal is not a pipe.",
    "created_at": "2012-11-14T13:56:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151805",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:160" align="right">comment:160</div>

Replying to [@vbraun](#comment:154):
> When sage quits the other end of the pipe should be closed, resulting in EPIPE.

A pseudo-terminal is not a pipe.



---

archive/issue_comments_151806.json:
```json
{
    "body": "<div id=\"comment:161\" align=\"right\">comment:161</div>\n\nReplying to [@jdemeyer](#comment:159):\n> I doubt that `/tmp` has anything to do with it. \n\nSomewhere near the end of  `sage/ext/gap/sage.g`\nthere is a commented out line `LogTo(\"/tmp/gapsage.log\");`\nCould you uncomment it and try to reproduce such a hanging GAP process, with this log on?\n\nAs well, perhaps add some debugging prints into each of the GAP functions in the file.\nSomething like `AppendTo(\"/tmp/sageg\",\"OperationsAdmittingFirstArgument\\n\");`\nwhere `OperationsAdmittingFirstArgument` is the function name, and \"tmp/sageg\" the name of the log file...\n\nMy guess that the problem is in `$SAGE.NewPager()`, which tries to get `$SAGE.tempfile` and fails, either during this interaction, or upon attempting to open it.",
    "created_at": "2012-11-14T15:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151806",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:161" align="right">comment:161</div>

Replying to [@jdemeyer](#comment:159):
> I doubt that `/tmp` has anything to do with it. 

Somewhere near the end of  `sage/ext/gap/sage.g`
there is a commented out line `LogTo("/tmp/gapsage.log");`
Could you uncomment it and try to reproduce such a hanging GAP process, with this log on?

As well, perhaps add some debugging prints into each of the GAP functions in the file.
Something like `AppendTo("/tmp/sageg","OperationsAdmittingFirstArgument\n");`
where `OperationsAdmittingFirstArgument` is the function name, and "tmp/sageg" the name of the log file...

My guess that the problem is in `$SAGE.NewPager()`, which tries to get `$SAGE.tempfile` and fails, either during this interaction, or upon attempting to open it.



---

archive/issue_comments_151807.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI am seriously debugging GAP now to check for the problem.",
    "created_at": "2012-11-14T15:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151807",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

I am seriously debugging GAP now to check for the problem.



---

archive/issue_comments_151808.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI'm pretty sure I found the bug. The culprit is the following from `src/sysfiles.c`:\n\n```\n/* utility to check return value of 'write'  */\nssize_t writeandcheck(int fd, const char *buf, size_t count) {\n  int ret;\n  ret = write(fd, buf, count);\n  if (ret < 0)\n  {\n    ErrorQuit(\"Cannot write to file descriptor %d, see 'LastSystemError();'\\n\",\n               fd, 0L);\n  }\nreturn ret;\n}\n```\n\nIf the pseudo-tty is closed, then `write()` fails with EIO, causing GAP to write an error message. We then get an infinite loop of failing to write the error message.",
    "created_at": "2012-11-14T16:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151808",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

I'm pretty sure I found the bug. The culprit is the following from `src/sysfiles.c`:

```
/* utility to check return value of 'write'  */
ssize_t writeandcheck(int fd, const char *buf, size_t count) {
  int ret;
  ret = write(fd, buf, count);
  if (ret < 0)
  {
    ErrorQuit("Cannot write to file descriptor %d, see 'LastSystemError();'\n",
               fd, 0L);
  }
return ret;
}
```

If the pseudo-tty is closed, then `write()` fails with EIO, causing GAP to write an error message. We then get an infinite loop of failing to write the error message.



---

archive/issue_comments_151809.json:
```json
{
    "body": "<div id=\"comment:164\" align=\"right\">comment:164</div>\n\nReplying to [@jdemeyer](#comment:163):\n\nIt seems that `ErrorQuit` could just write to `stderr` in this case. Although in general it's not clear to me how to deal with it, for such a plug perhaps could break the ability of the interpreter to recover from errors.\nIs it actually possible to reliably check that the pty is closed?",
    "created_at": "2012-11-14T16:37:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151809",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:164" align="right">comment:164</div>

Replying to [@jdemeyer](#comment:163):

It seems that `ErrorQuit` could just write to `stderr` in this case. Although in general it's not clear to me how to deal with it, for such a plug perhaps could break the ability of the interpreter to recover from errors.
Is it actually possible to reliably check that the pty is closed?



---

archive/issue_comments_151810.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNow that I know what the problem is, reproducing the Segmentation Fault is trivial. Within a Sage shell:\n\n```\n(sage-sh) jdemeyer@sage:sage-5.5.beta2$ gap &>/dev/full\nSegmentation fault\n```",
    "created_at": "2012-11-14T19:03:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151810",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Now that I know what the problem is, reproducing the Segmentation Fault is trivial. Within a Sage shell:

```
(sage-sh) jdemeyer@sage:sage-5.5.beta2$ gap &>/dev/full
Segmentation fault
```



---

archive/issue_comments_151811.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou'd still get a EPIPE if the process wasn't orphaned. Also, the problem is that GAP is **not** segfaulting in some circumstances when it is orphaned. If it would segfault you wouldn't get an orphan.\n\nThe underlying problem is that the expect interfaces don't always clean up processes before quitting Sage, hence leading to orphaned processes to start with. Only after the process is orphaned you get EIO's.",
    "created_at": "2012-11-14T19:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151811",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

You'd still get a EPIPE if the process wasn't orphaned. Also, the problem is that GAP is **not** segfaulting in some circumstances when it is orphaned. If it would segfault you wouldn't get an orphan.

The underlying problem is that the expect interfaces don't always clean up processes before quitting Sage, hence leading to orphaned processes to start with. Only after the process is orphaned you get EIO's.



---

archive/issue_comments_151812.json:
```json
{
    "body": "<div id=\"comment:167\" align=\"right\">comment:167</div>\n\nReplying to [@vbraun](#comment:166):\n> You'd still get a EPIPE if the process wasn't orphaned.\n\nI doubt that pseudo-terminals can cause an EPIPE (at least in Linux).  Even if they would, you should also get a SIGPIPE signal, killing the process.\n\n> Also, the problem is that GAP is **not** segfaulting in some circumstances when it is orphaned.\n\nI would not say that this is the problem. There is a bug in GAP which may or may not lead to a segfault. Relying that it will cause a segfault is silly.\n\n> The underlying problem is that the expect interfaces don't always clean up processes before quitting Sage, hence leading to orphaned processes to start with. Only after the process is orphaned you get EIO's.\n\nTrue. So either we fix GAP or we fix the Sage interface, and preferably both.",
    "created_at": "2012-11-14T19:40:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151812",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:167" align="right">comment:167</div>

Replying to [@vbraun](#comment:166):
> You'd still get a EPIPE if the process wasn't orphaned.

I doubt that pseudo-terminals can cause an EPIPE (at least in Linux).  Even if they would, you should also get a SIGPIPE signal, killing the process.

> Also, the problem is that GAP is **not** segfaulting in some circumstances when it is orphaned.

I would not say that this is the problem. There is a bug in GAP which may or may not lead to a segfault. Relying that it will cause a segfault is silly.

> The underlying problem is that the expect interfaces don't always clean up processes before quitting Sage, hence leading to orphaned processes to start with. Only after the process is orphaned you get EIO's.

True. So either we fix GAP or we fix the Sage interface, and preferably both.



---

archive/issue_comments_151813.json:
```json
{
    "body": "maxima getting EIO & segfault too",
    "created_at": "2012-11-14T20:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151813",
    "user": "https://github.com/vbraun"
}
```

maxima getting EIO & segfault too



---

archive/issue_comments_151814.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[sage-test-maxima-EIO.strace.gz](https://github.com/sagemath/sage/files/ticket13211/sage-test-maxima-EIO.strace.gz)**\n\nJust for the record, other programs Segfault after running into EIO for a while as well. I dare say that most interactive binaries are not meant to be run as orphans. I don't see much point in making sure that the GAP command line interface can be run without controlling terminal.",
    "created_at": "2012-11-14T20:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151814",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[sage-test-maxima-EIO.strace.gz](https://github.com/sagemath/sage/files/ticket13211/sage-test-maxima-EIO.strace.gz)**

Just for the record, other programs Segfault after running into EIO for a while as well. I dare say that most interactive binaries are not meant to be run as orphans. I don't see much point in making sure that the GAP command line interface can be run without controlling terminal.



---

archive/issue_comments_151815.json:
```json
{
    "body": "<div id=\"comment:169\" align=\"right\">comment:169</div>\n\nReplying to [@vbraun](#comment:168):\n> Just for the record, other programs Segfault after running into EIO for a while as well.\n\nIndeed, it seems ECL has exactly the same bug. But that doesn't mean the GAP bug (or the Sage bug controlling GAP if you want) shouldn't be fixed.\n\nAnd the problem isn't limited to terminals: as I showed, it can also occur for example when writing to a filesystem which is full.",
    "created_at": "2012-11-14T20:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151815",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:169" align="right">comment:169</div>

Replying to [@vbraun](#comment:168):
> Just for the record, other programs Segfault after running into EIO for a while as well.

Indeed, it seems ECL has exactly the same bug. But that doesn't mean the GAP bug (or the Sage bug controlling GAP if you want) shouldn't be fixed.

And the problem isn't limited to terminals: as I showed, it can also occur for example when writing to a filesystem which is full.



---

archive/issue_comments_151816.json:
```json
{
    "body": "<div id=\"comment:170\" align=\"right\">comment:170</div>\n\nReplying to [@jdemeyer](#comment:165):\n> Now that I know what the problem is, reproducing the Segmentation Fault is trivial. Within a Sage shell:\n> \n> ```\n> (sage-sh) jdemeyer@sage:sage-5.5.beta2$ gap &>/dev/full\n> Segmentation fault\n> ```\n\nThis is not the complete story. First off, you need to run with -T, which is meant to suppress the usual interactive behavour, and this is the option using which the orphans in question arise. In fact, it is because `stderr` is full, not because `stdout` is full.\n\n```\n(sage-sh) dima@sage$ gap -T >/dev/full\nError, Cannot write to file descriptor 1, see 'LastSystemError();'\n\nError, Cannot write to file descriptor 1, see 'LastSystemError();'\n\nError, Cannot write to file descriptor 1, see 'LastSystemError();'\n\nError, Cannot write to file descriptor 1, see 'LastSystemError();'\n\nError, Cannot write to file descriptor 1, see 'LastSystemError();'\n\nSyntax error: ; expected\n^\nError, Cannot write to file descriptor 1, see 'LastSystemError();'\n\n(sage-sh) dima@sage$\n```\nThus if the `stderr` is OK, it sort of works (the `Syntax error;` is quite weird though, and might be an indication of a \"more real\" bug).\nBy the way, `gap-4.4` just hangs in this situation.\n\nAs we talk about the situation with -T on, we can patch, say, `ErrorQuit` for this case to print to `stderr` and quit immediately. This will not fix this completely, but at least it will make sure that with -T option the behaviour is as it should be.\n\nAn alternative is to change Sage so that GAPs `stderr` does not get redirected. I don't know how well this will work, though.",
    "created_at": "2012-11-15T07:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151816",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:170" align="right">comment:170</div>

Replying to [@jdemeyer](#comment:165):
> Now that I know what the problem is, reproducing the Segmentation Fault is trivial. Within a Sage shell:
> 
> ```
> (sage-sh) jdemeyer@sage:sage-5.5.beta2$ gap &>/dev/full
> Segmentation fault
> ```

This is not the complete story. First off, you need to run with -T, which is meant to suppress the usual interactive behavour, and this is the option using which the orphans in question arise. In fact, it is because `stderr` is full, not because `stdout` is full.

```
(sage-sh) dima@sage$ gap -T >/dev/full
Error, Cannot write to file descriptor 1, see 'LastSystemError();'

Error, Cannot write to file descriptor 1, see 'LastSystemError();'

Error, Cannot write to file descriptor 1, see 'LastSystemError();'

Error, Cannot write to file descriptor 1, see 'LastSystemError();'

Error, Cannot write to file descriptor 1, see 'LastSystemError();'

Syntax error: ; expected
^
Error, Cannot write to file descriptor 1, see 'LastSystemError();'

(sage-sh) dima@sage$
```
Thus if the `stderr` is OK, it sort of works (the `Syntax error;` is quite weird though, and might be an indication of a "more real" bug).
By the way, `gap-4.4` just hangs in this situation.

As we talk about the situation with -T on, we can patch, say, `ErrorQuit` for this case to print to `stderr` and quit immediately. This will not fix this completely, but at least it will make sure that with -T option the behaviour is as it should be.

An alternative is to change Sage so that GAPs `stderr` does not get redirected. I don't know how well this will work, though.



---

archive/issue_comments_151817.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI've created an issue on GAP bugtracker in regard to the comment 165: \nhttp://tracker.gap-system.org/issues/125",
    "created_at": "2012-11-15T08:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151817",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

I've created an issue on GAP bugtracker in regard to the comment 165: 
http://tracker.gap-system.org/issues/125



---

archive/issue_comments_151818.json:
```json
{
    "body": "Changed upstream from **Completely fixed; Fix reported upstream** to **Reported upstream. No feedback yet.**",
    "created_at": "2012-11-15T08:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151818",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Completely fixed; Fix reported upstream** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_151819.json:
```json
{
    "body": "<div id=\"comment:172\" align=\"right\">comment:172</div>\n\nReplying to [@dimpase](#comment:171):\n> I've created an issue on GAP bugtracker in regard to the comment 165: \n> http://tracker.gap-system.org/issues/125\n\nToo bad one cannot even look at the tracker issue without logging in. I registered for an account, but it needs to be approved by a moderator. Let me know if anything interesting comes up from upstream.",
    "created_at": "2012-11-15T09:11:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151819",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:172" align="right">comment:172</div>

Replying to [@dimpase](#comment:171):
> I've created an issue on GAP bugtracker in regard to the comment 165: 
> http://tracker.gap-system.org/issues/125

Too bad one cannot even look at the tracker issue without logging in. I registered for an account, but it needs to be approved by a moderator. Let me know if anything interesting comes up from upstream.



---

archive/issue_comments_151820.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n ```\n \n Updated spkgs:\n-* http://boxen.math.washington.edu/home/dima/packages/gap-4.5.6.spkg\n+* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n``````\n",
    "created_at": "2012-11-15T09:45:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151820",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 ```
 
 Updated spkgs:
-* http://boxen.math.washington.edu/home/dima/packages/gap-4.5.6.spkg
+* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
``````




---

archive/issue_events_183803.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-15T09:45:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183803"
}
```



---

archive/issue_events_183804.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-15T09:45:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183804"
}
```



---

archive/issue_comments_151821.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nNew spkg with patch added: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg)\n\nPatch attached.",
    "created_at": "2012-11-15T09:45:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151821",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

New spkg with patch added: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg)

Patch attached.



---

archive/issue_comments_151822.json:
```json
{
    "body": "Attachment: **[writeandcheck.patch.gz](https://github.com/sagemath/sage/files/ticket13211/writeandcheck.patch.gz)**\n\nPatch added to GAP in gap-4.5.6.p0",
    "created_at": "2012-11-15T09:45:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151822",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[writeandcheck.patch.gz](https://github.com/sagemath/sage/files/ticket13211/writeandcheck.patch.gz)**

Patch added to GAP in gap-4.5.6.p0



---

archive/issue_events_183805.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-15T12:38:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183805"
}
```



---

archive/issue_events_183806.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-15T12:38:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183806"
}
```



---

archive/issue_comments_151823.json:
```json
{
    "body": "<div id=\"comment:174\" align=\"right\">comment:174</div>\n\nReplying to [@jdemeyer](#comment:173):\n> New spkg with patch added: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg)\n> \n> Patch attached.\n\nThe patch makes `gap &>/dev/full` hang. (Well, this is consistent with GAP 4.4 behaviour). At least this is good enough, I suppose, to fix the orphans issue. I mark this as positive review, with understanding that orphans, which I can't reproduce anyway, are no longer there. I hope GAP people will fix this good and proper.",
    "created_at": "2012-11-15T12:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151823",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:174" align="right">comment:174</div>

Replying to [@jdemeyer](#comment:173):
> New spkg with patch added: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg)
> 
> Patch attached.

The patch makes `gap &>/dev/full` hang. (Well, this is consistent with GAP 4.4 behaviour). At least this is good enough, I suppose, to fix the orphans issue. I mark this as positive review, with understanding that orphans, which I can't reproduce anyway, are no longer there. I hope GAP people will fix this good and proper.



---

archive/issue_comments_151824.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2012-11-15T12:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151824",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_151825.json:
```json
{
    "body": "<div id=\"comment:175\" align=\"right\">comment:175</div>\n\nReplying to [@dimpase](#comment:174):\n> The patch makes `gap &>/dev/full` hang.\n\nOf course it \"hangs\", since it's waiting for user input. It's still an interactive GAP session, you can hit CTRL-D to exit.",
    "created_at": "2012-11-15T13:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151825",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:175" align="right">comment:175</div>

Replying to [@dimpase](#comment:174):
> The patch makes `gap &>/dev/full` hang.

Of course it "hangs", since it's waiting for user input. It's still an interactive GAP session, you can hit CTRL-D to exit.



---

archive/issue_comments_151826.json:
```json
{
    "body": "<div id=\"comment:176\" align=\"right\">comment:176</div>\n\nReplying to [@jdemeyer](#comment:175):\n> Replying to [@dimpase](#comment:174):\n> > The patch makes `gap &>/dev/full` hang.\n\n> Of course it \"hangs\", since it's waiting for user input. It's still an interactive GAP session, you can hit CTRL-D to exit.\n\n Oh, right. I tried CTRL-C, in vain :-)",
    "created_at": "2012-11-15T14:20:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151826",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:176" align="right">comment:176</div>

Replying to [@jdemeyer](#comment:175):
> Replying to [@dimpase](#comment:174):
> > The patch makes `gap &>/dev/full` hang.

> Of course it "hangs", since it's waiting for user input. It's still an interactive GAP session, you can hit CTRL-D to exit.

 Oh, right. I tried CTRL-C, in vain :-)



---

archive/issue_events_183807.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:23:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183807"
}
```



---

archive/issue_events_183808.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:23:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183808"
}
```



---

archive/issue_comments_151827.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThere is something wrong with the pool size patch. On the buildbot machine \"snapperkob\" (Ubuntu 12.04 x86_64), gap is started with \"-o 53m\" which is too few. It gives\n\n```\nRuntimeError: Gap produced error output\nError, exceeded the permitted memory (`-o' command line option)\n\n   executing SaveWorkspace(\"/tmp/dotsageyds6nf/gap/workspace-8407479053605879120\");\n```\n\nBut there is plenty of memory available:\n\n```\n$ cat /proc/meminfo\nMemTotal:        8012124 kB\nMemFree:         2736044 kB\nBuffers:          125968 kB\nCached:          4721000 kB\nSwapCached:            0 kB\nActive:          2978056 kB\nInactive:        1930440 kB\nActive(anon):      61564 kB\nInactive(anon):     3648 kB\nActive(file):    2916492 kB\nInactive(file):  1926792 kB\nUnevictable:           0 kB\nMlocked:               0 kB\nSwapTotal:        524284 kB\nSwapFree:         524284 kB\nDirty:                20 kB\nWriteback:             0 kB\nAnonPages:         61552 kB\nMapped:            14396 kB\nShmem:              3688 kB\nSlab:             261404 kB\nSReclaimable:     243728 kB\nSUnreclaim:        17676 kB\nKernelStack:        1280 kB\nPageTables:         3568 kB\nNFS_Unstable:          0 kB\nBounce:                0 kB\nWritebackTmp:          0 kB\nCommitLimit:     4530344 kB\nCommitted_AS:     160128 kB\nVmallocTotal:   34359738367 kB\nVmallocUsed:      561128 kB\nVmallocChunk:   34359173628 kB\nHardwareCorrupted:     0 kB\nAnonHugePages:         0 kB\nHugePages_Total:       0\nHugePages_Free:        0\nHugePages_Rsvd:        0\nHugePages_Surp:        0\nHugepagesize:       2048 kB\nDirectMap4k:       47100 kB\nDirectMap2M:     8173568 kB\n```",
    "created_at": "2012-11-16T12:23:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151827",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

There is something wrong with the pool size patch. On the buildbot machine "snapperkob" (Ubuntu 12.04 x86_64), gap is started with "-o 53m" which is too few. It gives

```
RuntimeError: Gap produced error output
Error, exceeded the permitted memory (`-o' command line option)

   executing SaveWorkspace("/tmp/dotsageyds6nf/gap/workspace-8407479053605879120");
```

But there is plenty of memory available:

```
$ cat /proc/meminfo
MemTotal:        8012124 kB
MemFree:         2736044 kB
Buffers:          125968 kB
Cached:          4721000 kB
SwapCached:            0 kB
Active:          2978056 kB
Inactive:        1930440 kB
Active(anon):      61564 kB
Inactive(anon):     3648 kB
Active(file):    2916492 kB
Inactive(file):  1926792 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:        524284 kB
SwapFree:         524284 kB
Dirty:                20 kB
Writeback:             0 kB
AnonPages:         61552 kB
Mapped:            14396 kB
Shmem:              3688 kB
Slab:             261404 kB
SReclaimable:     243728 kB
SUnreclaim:        17676 kB
KernelStack:        1280 kB
PageTables:         3568 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:     4530344 kB
Committed_AS:     160128 kB
VmallocTotal:   34359738367 kB
VmallocUsed:      561128 kB
VmallocChunk:   34359173628 kB
HardwareCorrupted:     0 kB
AnonHugePages:         0 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
DirectMap4k:       47100 kB
DirectMap2M:     8173568 kB
```



---

archive/issue_events_183809.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:31:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183809"
}
```



---

archive/issue_events_183810.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:31:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183810"
}
```



---

archive/issue_events_183811.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:55:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183811"
}
```



---

archive/issue_events_183812.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:55:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183812"
}
```



---

archive/issue_events_183813.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:56:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183813"
}
```



---

archive/issue_events_183814.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-16T12:56:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183814"
}
```



---

archive/issue_comments_151828.json:
```json
{
    "body": "<div id=\"comment:181\" align=\"right\">comment:181</div>\n\nReplying to [@jdemeyer](#comment:177):\n> There is something wrong with the pool size patch. On the buildbot machine \"snapperkob\" (Ubuntu 12.04 x86_64), gap is started with \"-o 53m\" which is too few. \n\nI'll try to reproduce this on `sage.combinat`. This is the only Ubuntu 12.04 x86_64 I presently have access to.",
    "created_at": "2012-11-16T13:22:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151828",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:181" align="right">comment:181</div>

Replying to [@jdemeyer](#comment:177):
> There is something wrong with the pool size patch. On the buildbot machine "snapperkob" (Ubuntu 12.04 x86_64), gap is started with "-o 53m" which is too few. 

I'll try to reproduce this on `sage.combinat`. This is the only Ubuntu 12.04 x86_64 I presently have access to.



---

archive/issue_comments_151829.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe machine has only 512MB of swap? The pool defaults to 1/10th of the total swap.",
    "created_at": "2012-11-16T14:22:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151829",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">comment:2</div>

The machine has only 512MB of swap? The pool defaults to 1/10th of the total swap.



---

archive/issue_comments_151830.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI've changed the pool size computation to default to at least 75MB.",
    "created_at": "2012-11-16T14:30:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151830",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

I've changed the pool size computation to default to at least 75MB.



---

archive/issue_comments_151831.json:
```json
{
    "body": "<div id=\"comment:184\" align=\"right\">comment:184</div>\n\nReplying to [@vbraun](#comment:183):\n> I've changed the pool size computation to default to at least 75MB.\n\nyes, I was just reading your patch. It's my fault that I missed this potential problem before (I am aware of a \"modern\" school that teaches that swap is dead, as there is so much RAM nowadays...).\n\nLet me test it now.",
    "created_at": "2012-11-16T14:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151831",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:184" align="right">comment:184</div>

Replying to [@vbraun](#comment:183):
> I've changed the pool size computation to default to at least 75MB.

yes, I was just reading your patch. It's my fault that I missed this potential problem before (I am aware of a "modern" school that teaches that swap is dead, as there is so much RAM nowadays...).

Let me test it now.



---

archive/issue_comments_151832.json:
```json
{
    "body": "<div id=\"comment:185\" align=\"right\">comment:185</div>\n\nReplying to [@vbraun](#comment:183):\n> I've changed the pool size computation to default to at least 75MB.\n\nno, you have set it to `75*1024**3`, which is 75**GB**!\nYou should do `75*1024**2` instead.",
    "created_at": "2012-11-16T15:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151832",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:185" align="right">comment:185</div>

Replying to [@vbraun](#comment:183):
> I've changed the pool size computation to default to at least 75MB.

no, you have set it to `75*1024**3`, which is 75**GB**!
You should do `75*1024**2` instead.



---

archive/issue_comments_151833.json:
```json
{
    "body": "<div id=\"comment:186\" align=\"right\">comment:186</div>\n\nReplying to [@dimpase](#comment:185):\n> Replying to [@vbraun](#comment:183):\n> > I've changed the pool size computation to default to at least 75MB.\n\n> no, you have set it to `75*1024**3`, which is 75**GB**!\n> You should do `75*1024**2` instead.\n\nI also think that \n\n```\n   suggested_size = max(int(mem.available_swap() / 10),  \n \t\t                         int(mem.available_ram()  / 50),   # in case you run without swap \n \t\t                         75 * 1024**2 )      # about 75MB is the minimum to run GAP \n```\nis way too much for machines with a lot of RAM. E.g. I tried this on sage.combinat and got 3.6GB as the `suggested_size`.\nI'd rather propose\n\n```\n   suggested_size = min(150 * 1024**2, \n                               max(int(mem.available_swap() / 10),  \n \t\t               int(mem.available_ram()  / 50),   # in case you run without swap \n \t\t               75 * 1024**2 ))      # about 75MB is the minimum to run GAP \n``` \nfor 150MB is certainly good enough, but would not lead to problems if you have a hundred instances of Sage running on the same machine.",
    "created_at": "2012-11-16T15:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151833",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:186" align="right">comment:186</div>

Replying to [@dimpase](#comment:185):
> Replying to [@vbraun](#comment:183):
> > I've changed the pool size computation to default to at least 75MB.

> no, you have set it to `75*1024**3`, which is 75**GB**!
> You should do `75*1024**2` instead.

I also think that 

```
   suggested_size = max(int(mem.available_swap() / 10),  
 		                         int(mem.available_ram()  / 50),   # in case you run without swap 
 		                         75 * 1024**2 )      # about 75MB is the minimum to run GAP 
```
is way too much for machines with a lot of RAM. E.g. I tried this on sage.combinat and got 3.6GB as the `suggested_size`.
I'd rather propose

```
   suggested_size = min(150 * 1024**2, 
                               max(int(mem.available_swap() / 10),  
 		               int(mem.available_ram()  / 50),   # in case you run without swap 
 		               75 * 1024**2 ))      # about 75MB is the minimum to run GAP 
``` 
for 150MB is certainly good enough, but would not lead to problems if you have a hundred instances of Sage running on the same machine.



---

archive/issue_comments_151834.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nOn 32-bit systems:\n\n```\nsage -t  --long -force_lib devel/sage/sage/misc/memory_info.py\n**********************************************************************\nFile \"/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.5.beta2/devel/sage-main/sage/misc/memory_info.py\", line 350:\n    sage: mem.total_ram()\nExpected:\n    4294967296\nGot:\n    4294967296L\n**********************************************************************\n```",
    "created_at": "2012-11-16T19:09:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151834",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

On 32-bit systems:

```
sage -t  --long -force_lib devel/sage/sage/misc/memory_info.py
**********************************************************************
File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.5.beta2/devel/sage-main/sage/misc/memory_info.py", line 350:
    sage: mem.total_ram()
Expected:
    4294967296
Got:
    4294967296L
**********************************************************************
```



---

archive/issue_comments_151835.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWould it make sense, in `spkg-install`, to either remove the old GAP installation or (probably better) to move it to `local/gap/gap-4.4.12`?",
    "created_at": "2012-11-17T00:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151835",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">comment:8</div>

Would it make sense, in `spkg-install`, to either remove the old GAP installation or (probably better) to move it to `local/gap/gap-4.4.12`?



---

archive/issue_comments_151836.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThanks, fixed the MB... its been a long time that I've seen computations not finish because of `O(1024^2)` bytes of storage missing ;-)\n\nI've also added the appropriate `# 64-bit` vs `# 32-bit` to the offending doctest.\n\nThe pool size is **NOT** allocated ram, it is an anonymous mmap and will only be used if necessary. 150MB is definitely not enough for serious computations. If you want hundreds of Sage instances then thats fine, you just need enough swap. Or, if you prefer, you can set up your desktop without swap. Then the pool will be backed by actual RAM, but you hopefully were aware of that when you decided not to have a swap partition.\n\nFinally, I don't see any benefit in moving/deleting the previous GAP install. We'll just run into unintended consequences.",
    "created_at": "2012-11-17T05:38:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151836",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Thanks, fixed the MB... its been a long time that I've seen computations not finish because of `O(1024^2)` bytes of storage missing ;-)

I've also added the appropriate `# 64-bit` vs `# 32-bit` to the offending doctest.

The pool size is **NOT** allocated ram, it is an anonymous mmap and will only be used if necessary. 150MB is definitely not enough for serious computations. If you want hundreds of Sage instances then thats fine, you just need enough swap. Or, if you prefer, you can set up your desktop without swap. Then the pool will be backed by actual RAM, but you hopefully were aware of that when you decided not to have a swap partition.

Finally, I don't see any benefit in moving/deleting the previous GAP install. We'll just run into unintended consequences.



---

archive/issue_comments_151837.json:
```json
{
    "body": "<div id=\"comment:190\" align=\"right\">comment:190</div>\n\nReplying to [@vbraun](#comment:189):\n\n> The pool size is **NOT** allocated ram, it is an anonymous mmap and will only be used if necessary. 150MB is definitely not enough for serious computations. If you want hundreds of Sage instances then thats fine, you just need enough swap. \n\nWhy do we need to set '-o' at all? GAP can perfectly start with only '-m' (i.e. the initial amount of memory) set only.\n'-o' is meant to set the maximal amount of RAM to be available, at least according to GAPs [docs](http://www.gap-system.org/Manuals/doc/ref/chap3.html).",
    "created_at": "2012-11-17T06:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151837",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:190" align="right">comment:190</div>

Replying to [@vbraun](#comment:189):

> The pool size is **NOT** allocated ram, it is an anonymous mmap and will only be used if necessary. 150MB is definitely not enough for serious computations. If you want hundreds of Sage instances then thats fine, you just need enough swap. 

Why do we need to set '-o' at all? GAP can perfectly start with only '-m' (i.e. the initial amount of memory) set only.
'-o' is meant to set the maximal amount of RAM to be available, at least according to GAPs [docs](http://www.gap-system.org/Manuals/doc/ref/chap3.html).



---

archive/issue_comments_151838.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nIf you don't specify '-o' then gap will just chose a pool size for you. The virtual memory pool address space can't be changed after GAP has started. The actual memory used can expand and contract. Of course the actual memory used is bounded by the pool size.",
    "created_at": "2012-11-17T13:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151838",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

If you don't specify '-o' then gap will just chose a pool size for you. The virtual memory pool address space can't be changed after GAP has started. The actual memory used can expand and contract. Of course the actual memory used is bounded by the pool size.



---

archive/issue_comments_151839.json:
```json
{
    "body": "<div id=\"comment:192\" align=\"right\">comment:192</div>\n\nReplying to [@vbraun](#comment:191):\n> If you don't specify '-o' then gap will just chose a pool size for you. The virtual memory pool address space can't be changed after GAP has started. The actual memory used can expand and contract. Of course the actual memory used is bounded by the pool size.\n\nOK. Still, what about limiting the suggested_size to something (say, 500MB) - I agree that 150MB I suggested above is on a low side. \n\nAnyway, we should put somewhere in the documentation a remark that by default such-and-such max amount is allocated, but if you need more, then do `set_gap_memory_pool_size()` before doing any GAP stuff. \n\nBy the way, can one terminate, from Sage, all the running GAP subprocesses?",
    "created_at": "2012-11-17T13:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151839",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:192" align="right">comment:192</div>

Replying to [@vbraun](#comment:191):
> If you don't specify '-o' then gap will just chose a pool size for you. The virtual memory pool address space can't be changed after GAP has started. The actual memory used can expand and contract. Of course the actual memory used is bounded by the pool size.

OK. Still, what about limiting the suggested_size to something (say, 500MB) - I agree that 150MB I suggested above is on a low side. 

Anyway, we should put somewhere in the documentation a remark that by default such-and-such max amount is allocated, but if you need more, then do `set_gap_memory_pool_size()` before doing any GAP stuff. 

By the way, can one terminate, from Sage, all the running GAP subprocesses?



---

archive/issue_comments_151840.json:
```json
{
    "body": "<div id=\"comment:193\" align=\"right\">comment:193</div>\n\nReplying to [@dimpase](#comment:192):\n> OK. Still, what about limiting the suggested_size to something (say, 500MB) - I agree that 150MB I suggested above is on a low side. \n\nI'm against absolute limits, it should be a fraction of the available resources. Otherwise you'll end up on record with \"640kb is enough for everyone\".\n\n> Anyway, we should put somewhere in the documentation a remark that by default such-and-such max amount is allocated, but if you need more, then do `set_gap_memory_pool_size()` before doing any GAP stuff. \n\nIts in the `set_gap_memory_pool_size` docstring already.\n\n> By the way, can one terminate, from Sage, all the running GAP subprocesses?\n\nThe Sage expect interface does not keep a list of started subprocesses, so no. That would be a nice enhancement to the whole expect stuff, but please in another ticket.",
    "created_at": "2012-11-24T14:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151840",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:193" align="right">comment:193</div>

Replying to [@dimpase](#comment:192):
> OK. Still, what about limiting the suggested_size to something (say, 500MB) - I agree that 150MB I suggested above is on a low side. 

I'm against absolute limits, it should be a fraction of the available resources. Otherwise you'll end up on record with "640kb is enough for everyone".

> Anyway, we should put somewhere in the documentation a remark that by default such-and-such max amount is allocated, but if you need more, then do `set_gap_memory_pool_size()` before doing any GAP stuff. 

Its in the `set_gap_memory_pool_size` docstring already.

> By the way, can one terminate, from Sage, all the running GAP subprocesses?

The Sage expect interface does not keep a list of started subprocesses, so no. That would be a nice enhancement to the whole expect stuff, but please in another ticket.



---

archive/issue_events_183815.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-24T14:44:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183815"
}
```



---

archive/issue_events_183816.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-24T14:44:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183816"
}
```



---

archive/issue_comments_151841.json:
```json
{
    "body": "<div id=\"comment:195\" align=\"right\">comment:195</div>\n\nReplying to [@vbraun](#comment:193):\n> Replying to [@dimpase](#comment:192):\n> > OK. Still, what about limiting the suggested_size to something (say, 500MB) - I agree that 150MB I suggested above is on a low side. \n\n> \n> I'm against absolute limits, it should be a fraction of the available resources. Otherwise you'll end up on record with \"640kb is enough for everyone\".\n\nI propose a limit that can be explicitly overwritten, not something absolute. The reason is that on big machines a fraction of the resource can be too big to be meaningful, and will make sharing the machine very hard, as the first few processes will grab an enormous chunk of swap, and the remaining ones will suffer.\nI propose a limit that one would not even notice on a typical desktop (OK, if you think 500MB is too small, make it 750MB, or 1GB). \nAnd if you come to a super-duper machine to compute something huge then OK, please tell the system explicitly how much memory you might need.\n\nAs a matter of fact, I do not understand why GAP needs to **reserve** any swap at all. Just does not make sense to me. What is so special about GAP here?",
    "created_at": "2012-11-24T15:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151841",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:195" align="right">comment:195</div>

Replying to [@vbraun](#comment:193):
> Replying to [@dimpase](#comment:192):
> > OK. Still, what about limiting the suggested_size to something (say, 500MB) - I agree that 150MB I suggested above is on a low side. 

> 
> I'm against absolute limits, it should be a fraction of the available resources. Otherwise you'll end up on record with "640kb is enough for everyone".

I propose a limit that can be explicitly overwritten, not something absolute. The reason is that on big machines a fraction of the resource can be too big to be meaningful, and will make sharing the machine very hard, as the first few processes will grab an enormous chunk of swap, and the remaining ones will suffer.
I propose a limit that one would not even notice on a typical desktop (OK, if you think 500MB is too small, make it 750MB, or 1GB). 
And if you come to a super-duper machine to compute something huge then OK, please tell the system explicitly how much memory you might need.

As a matter of fact, I do not understand why GAP needs to **reserve** any swap at all. Just does not make sense to me. What is so special about GAP here?



---

archive/issue_comments_151842.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nBy \"absolute\" limit I mean a fixed size (as opposed to relative to available resources). 640kb (or any other fixed amount) is not going to be good enough in the future.\n\nThe current GAP in Sage does soak up all the available swap and I don't see anybody complaining about it. It does make my desktop slow down to a crawl whenever the patchbot hits GAP, though. Maybe this patch is not the ideal solution, but its a vast improvement over what we currently have. \n\nAs for the rest, read the mmap manpage. You either reserve swap or you get SIGSEGV when you run out of memory. And GAP is not written in a way what would handle that signal.",
    "created_at": "2012-11-24T16:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151842",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

By "absolute" limit I mean a fixed size (as opposed to relative to available resources). 640kb (or any other fixed amount) is not going to be good enough in the future.

The current GAP in Sage does soak up all the available swap and I don't see anybody complaining about it. It does make my desktop slow down to a crawl whenever the patchbot hits GAP, though. Maybe this patch is not the ideal solution, but its a vast improvement over what we currently have. 

As for the rest, read the mmap manpage. You either reserve swap or you get SIGSEGV when you run out of memory. And GAP is not written in a way what would handle that signal.



---

archive/issue_events_183817.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-24T17:54:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183817"
}
```



---

archive/issue_events_183818.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-11-24T17:54:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183818"
}
```



---

archive/issue_comments_151843.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFWIW, this report https://groups.google.com/d/msg/sage-release/qxv0lvoSfN4/dSYcy-xOG1AJ mentions orphans with the previous version of GAP as well.",
    "created_at": "2012-11-25T22:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151843",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

FWIW, this report https://groups.google.com/d/msg/sage-release/qxv0lvoSfN4/dSYcy-xOG1AJ mentions orphans with the previous version of GAP as well.



---

archive/issue_comments_151844.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI had accidentally dropped the workaround for the `gap -o 3*2^31` option parser overflow, its back in the trac_13211_pool_size.patch now.\n\nAlso, seems like the reporter on sage-release didn't get GAP orphans with the old version after all.",
    "created_at": "2012-11-26T19:33:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151844",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

I had accidentally dropped the workaround for the `gap -o 3*2^31` option parser overflow, its back in the trac_13211_pool_size.patch now.

Also, seems like the reporter on sage-release didn't get GAP orphans with the old version after all.



---

archive/issue_comments_151845.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nThe memory size still isn't completely right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap) and iras (Linux ia64, 4GB RAM + 2GB swap):\n\n```\nsage -t  --long -force_lib devel/sage/sage/groups/matrix_gps/matrix_group_morphism.py\n**********************************************************************\nFile \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/devel/sage-main/sage/groups/matrix_gps/matrix_group_morphism.py\", line 229:\n    sage: f = O.hom([r*x*r_ for x in O.gens()])  # long time (19s on sage.math, 2011)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_7[17]>\", line 1, in <module>\n        f = O.hom([r*x*r_ for x in O.gens()])  # long time (19s on sage.math, 2011)###line 229:\n    sage: f = O.hom([r*x*r_ for x in O.gens()])  # long time (19s on sage.math, 2011)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/groups/matrix_gps/matrix_group.py\", line 268, in hom\n        return self.Hom(U)(x)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/groups/matrix_gps/homset.py\", line 114, in __call__\n        im_gens, check=check)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/groups/matrix_gps/matrix_group_morphism.py\", line 75, in __init__\n        phi0 = gap(self)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/interface.py\", line 197, in __call__\n        return self._coerce_from_special_method(x)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/interface.py\", line 223, in _coerce_from_special_method\n        return (x.__getattribute__(s))(self)\n      File \"sage_object.pyx\", line 463, in sage.structure.sage_object.SageObject._gap_ (sage/structure/sage_object.c:4539)\n      File \"sage_object.pyx\", line 439, in sage.structure.sage_object.SageObject._interface_ (sage/structure/sage_object.c:4139)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/interface.py\", line 195, in __call__\n        return cls(self, x, name=name)\n      File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/expect.py\", line 1308, in __init__\n        raise TypeError, x\n    TypeError: Gap terminated unexpectedly while reading in a large line:\n    Gap produced error output\n    Error, exceeded the permitted memory (`-o' command line option)\n\n       executing Read(\"/home/buildbot/.sage/temp/iras/26682/interface/tmp26707\");\n**********************************************************************\n```\n\nSince this *never* happened with the old GAP, I consider this a regression which should be fixed.",
    "created_at": "2012-12-18T07:35:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151845",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:0" align="right">comment:0</div>

The memory size still isn't completely right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap) and iras (Linux ia64, 4GB RAM + 2GB swap):

```
sage -t  --long -force_lib devel/sage/sage/groups/matrix_gps/matrix_group_morphism.py
**********************************************************************
File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/devel/sage-main/sage/groups/matrix_gps/matrix_group_morphism.py", line 229:
    sage: f = O.hom([r*x*r_ for x in O.gens()])  # long time (19s on sage.math, 2011)
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_7[17]>", line 1, in <module>
        f = O.hom([r*x*r_ for x in O.gens()])  # long time (19s on sage.math, 2011)###line 229:
    sage: f = O.hom([r*x*r_ for x in O.gens()])  # long time (19s on sage.math, 2011)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/groups/matrix_gps/matrix_group.py", line 268, in hom
        return self.Hom(U)(x)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/groups/matrix_gps/homset.py", line 114, in __call__
        im_gens, check=check)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/groups/matrix_gps/matrix_group_morphism.py", line 75, in __init__
        phi0 = gap(self)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/interface.py", line 197, in __call__
        return self._coerce_from_special_method(x)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/interface.py", line 223, in _coerce_from_special_method
        return (x.__getattribute__(s))(self)
      File "sage_object.pyx", line 463, in sage.structure.sage_object.SageObject._gap_ (sage/structure/sage_object.c:4539)
      File "sage_object.pyx", line 439, in sage.structure.sage_object.SageObject._interface_ (sage/structure/sage_object.c:4139)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/interface.py", line 195, in __call__
        return cls(self, x, name=name)
      File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/expect.py", line 1308, in __init__
        raise TypeError, x
    TypeError: Gap terminated unexpectedly while reading in a large line:
    Gap produced error output
    Error, exceeded the permitted memory (`-o' command line option)

       executing Read("/home/buildbot/.sage/temp/iras/26682/interface/tmp26707");
**********************************************************************
```

Since this *never* happened with the old GAP, I consider this a regression which should be fixed.



---

archive/issue_events_183819.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T07:35:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183819"
}
```



---

archive/issue_events_183820.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T07:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183820"
}
```



---

archive/issue_comments_151846.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nOn hawk (OpenSolaris i386), I get this reproducible doctest error:\n\n```\nsage -t  --long -force_lib devel/sage/sage/interfaces/gap.py\ngap: halving pool size.\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/devel/sage-main/sage/interfaces/gap.py\", line 376:\n    sage: gap('\"finished computation\"'); gap.interrupt(); gap('\"ok\"')\nException raised:\n    Traceback (most recent call last):\n      File \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_6[5]>\", line 1, in <module>\n        gap('\"finished computation\"'); gap.interrupt(); gap('\"ok\"')###line 376:\n    sage: gap('\"finished computation\"'); gap.interrupt(); gap('\"ok\"')\n      File \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/gap.py\", line 393, in interrupt\n        E.sendline()\n      File \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/lib/python/site-packages/pexpect.py\", line 677, in sendline\n        n = n + self.send (os.linesep)\n      File \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/lib/python/site-packages/pexpect.py\", line 669, in send\n        c = os.write(self.child_fd, str)\n    OSError: [Errno 22] Invalid argument\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/devel/sage-main/sage/interfaces/gap.py\", line 1794:\n    sage: gap_version()\nExpected:\n    doctest:...: DeprecationWarning: use gap.version() instead\n    See http://trac.sagemath.org/13211 for details.\n    '4.5.6'\nGot:\n    doctest:1: DeprecationWarning: use gap.version() instead\n    See http://trac.sagemath.org/13211 for details.\n    ** Gap crashed or quit executing 'VERSION;' **\n    Restarting Gap and trying again\n    '4.5.6'\n**********************************************************************\n```\n\nIt seems we're trying to write to a closed filedescriptor.",
    "created_at": "2012-12-18T07:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151846",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

On hawk (OpenSolaris i386), I get this reproducible doctest error:

```
sage -t  --long -force_lib devel/sage/sage/interfaces/gap.py
gap: halving pool size.
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/devel/sage-main/sage/interfaces/gap.py", line 376:
    sage: gap('"finished computation"'); gap.interrupt(); gap('"ok"')
Exception raised:
    Traceback (most recent call last):
      File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_6[5]>", line 1, in <module>
        gap('"finished computation"'); gap.interrupt(); gap('"ok"')###line 376:
    sage: gap('"finished computation"'); gap.interrupt(); gap('"ok"')
      File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/lib/python/site-packages/sage/interfaces/gap.py", line 393, in interrupt
        E.sendline()
      File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/lib/python/site-packages/pexpect.py", line 677, in sendline
        n = n + self.send (os.linesep)
      File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/local/lib/python/site-packages/pexpect.py", line 669, in send
        c = os.write(self.child_fd, str)
    OSError: [Errno 22] Invalid argument
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-5.6.beta0/devel/sage-main/sage/interfaces/gap.py", line 1794:
    sage: gap_version()
Expected:
    doctest:...: DeprecationWarning: use gap.version() instead
    See http://trac.sagemath.org/13211 for details.
    '4.5.6'
Got:
    doctest:1: DeprecationWarning: use gap.version() instead
    See http://trac.sagemath.org/13211 for details.
    ** Gap crashed or quit executing 'VERSION;' **
    Restarting Gap and trying again
    '4.5.6'
**********************************************************************
```

It seems we're trying to write to a closed filedescriptor.



---

archive/issue_comments_151847.json:
```json
{
    "body": "<div id=\"comment:202\" align=\"right\">comment:202</div>\n\nReplying to [@jdemeyer](#comment:200):\n> The memory size still isn't completely right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap) and iras (Linux ia64, 4GB RAM + 2GB swap):\n\nThese are cases where the hardcoded minimum for the GAP memory pool is used (since they have insufficient swap space). I'll try to find a minimal value that is sufficient to run the long doctests, not just to start up GAP.",
    "created_at": "2012-12-18T10:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151847",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:202" align="right">comment:202</div>

Replying to [@jdemeyer](#comment:200):
> The memory size still isn't completely right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap) and iras (Linux ia64, 4GB RAM + 2GB swap):

These are cases where the hardcoded minimum for the GAP memory pool is used (since they have insufficient swap space). I'll try to find a minimal value that is sufficient to run the long doctests, not just to start up GAP.



---

archive/issue_comments_151848.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-12-18T10:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151848",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_151849.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAttachment: **[trac_13211_pool_size.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)**\n\nTurns out we need 76MB for the long doctests, but we hardcoded 75MB. I've increased the minimum to 100MB to give us some headroom for future doctests. I'll see if I can reproduce the OpenSolaris bug on OpenIndiana (if anybody with access to hawk can debug it go for it, but I don't have an account). But that shouldn't stop us from shipping the update.",
    "created_at": "2012-12-18T10:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151849",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

Attachment: **[trac_13211_pool_size.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)**

Turns out we need 76MB for the long doctests, but we hardcoded 75MB. I've increased the minimum to 100MB to give us some headroom for future doctests. I'll see if I can reproduce the OpenSolaris bug on OpenIndiana (if anybody with access to hawk can debug it go for it, but I don't have an account). But that shouldn't stop us from shipping the update.



---

archive/issue_events_183821.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-18T10:38:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183821"
}
```



---

archive/issue_events_183822.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-18T10:38:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183822"
}
```



---

archive/issue_comments_151850.json:
```json
{
    "body": "<div id=\"comment:204\" align=\"right\">comment:204</div>\n\nReplying to [@vbraun](#comment:203):\n> I'll see if I can reproduce the OpenSolaris bug on OpenIndiana (if anybody with access to hawk can debug it go for it, but I don't have an account). But that shouldn't stop us from shipping the update. \n\nA failure on a supported platform does stop the update...",
    "created_at": "2012-12-19T11:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151850",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:204" align="right">comment:204</div>

Replying to [@vbraun](#comment:203):
> I'll see if I can reproduce the OpenSolaris bug on OpenIndiana (if anybody with access to hawk can debug it go for it, but I don't have an account). But that shouldn't stop us from shipping the update. 

A failure on a supported platform does stop the update...



---

archive/issue_events_183823.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-19T11:40:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183823"
}
```



---

archive/issue_events_183824.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-19T11:40:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183824"
}
```



---

archive/issue_comments_151851.json:
```json
{
    "body": "<div id=\"comment:205\" align=\"right\">comment:205</div>\n\nReplying to [@jdemeyer](#comment:204):\n> Replying to [@vbraun](#comment:203):\n> > I'll see if I can reproduce the OpenSolaris bug on OpenIndiana (if anybody with access to hawk can debug it go for it, but I don't have an account). But that shouldn't stop us from shipping the update. \n\n> \n> A failure on a supported platform does stop the update...\n\nI am having trouble building 5.5.rc1 on hawk. It errors out for no obvious reason.",
    "created_at": "2012-12-19T11:52:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151851",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:205" align="right">comment:205</div>

Replying to [@jdemeyer](#comment:204):
> Replying to [@vbraun](#comment:203):
> > I'll see if I can reproduce the OpenSolaris bug on OpenIndiana (if anybody with access to hawk can debug it go for it, but I don't have an account). But that shouldn't stop us from shipping the update. 

> 
> A failure on a supported platform does stop the update...

I am having trouble building 5.5.rc1 on hawk. It errors out for no obvious reason.



---

archive/issue_comments_151852.json:
```json
{
    "body": "<div id=\"comment:206\" align=\"right\">comment:206</div>\n\nReplying to [@jdemeyer](#comment:204):\n> A failure on a supported platform does stop the update...\n\nThe most glaring bug is of course that OpenSolaris is a fully supported platform. https://groups.google.com/d/topic/sage-devel/nRVBUQtL_d4/discussion",
    "created_at": "2012-12-19T12:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151852",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:206" align="right">comment:206</div>

Replying to [@jdemeyer](#comment:204):
> A failure on a supported platform does stop the update...

The most glaring bug is of course that OpenSolaris is a fully supported platform. https://groups.google.com/d/topic/sage-devel/nRVBUQtL_d4/discussion



---

archive/issue_comments_151853.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAnother unrelated issue is that setting `SAGE_DEBUG=yes` doesn't correctly set `-O0`, as it's overwritten later in the command line by an `-O2`:\n\n```\n$ SAGE_DEBUG=yes ./sage -f gap-4.5.6.p0.spkg\n[...]\ngcc -I. -I../.. -DCONFIG_H  -I/release/merger/sage-5.6.beta0/local/include -D__GMP_MP_RELEASE=50002 -O0 -g3 -DDEBUG_MASTERPOINTERS -DDEBUG_GLOBAL_BAGS -DDEBUG_FUNCTIONS_BAGS -Wall -g -O2   -o intfuncs.o -c ../../src/intfuncs.c\n[...]\n```",
    "created_at": "2012-12-20T09:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151853",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Another unrelated issue is that setting `SAGE_DEBUG=yes` doesn't correctly set `-O0`, as it's overwritten later in the command line by an `-O2`:

```
$ SAGE_DEBUG=yes ./sage -f gap-4.5.6.p0.spkg
[...]
gcc -I. -I../.. -DCONFIG_H  -I/release/merger/sage-5.6.beta0/local/include -D__GMP_MP_RELEASE=50002 -O0 -g3 -DDEBUG_MASTERPOINTERS -DDEBUG_GLOBAL_BAGS -DDEBUG_FUNCTIONS_BAGS -Wall -g -O2   -o intfuncs.o -c ../../src/intfuncs.c
[...]
```



---

archive/issue_comments_151854.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFYI: GAP-4.5.7 has been released which fixes (amongst other things)\n> Numbers in memory options on the command line exceeding 2<sup>32</sup> could not be parsed correctly, even on 64-bit systems. [Reported by Volker Braun]",
    "created_at": "2012-12-20T09:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151854",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

FYI: GAP-4.5.7 has been released which fixes (amongst other things)
> Numbers in memory options on the command line exceeding 2<sup>32</sup> could not be parsed correctly, even on 64-bit systems. [Reported by Volker Braun]



---

archive/issue_comments_151855.json:
```json
{
    "body": "Attachment: **[cflags.patch.gz](https://github.com/sagemath/sage/files/ticket13211/cflags.patch.gz)**\n\nFix CFLAGS setting in GAP configure file",
    "created_at": "2012-12-20T09:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151855",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[cflags.patch.gz](https://github.com/sagemath/sage/files/ticket13211/cflags.patch.gz)**

Fix CFLAGS setting in GAP configure file



---

archive/issue_comments_151856.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI reported the patch [attachment: cflags.patch](https://github.com/sagemath/sage/files/ticket13211/cflags.patch.gz) upstream, it should be added to the spkg.",
    "created_at": "2012-12-20T10:00:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151856",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

I reported the patch [attachment: cflags.patch](https://github.com/sagemath/sage/files/ticket13211/cflags.patch.gz) upstream, it should be added to the spkg.



---

archive/issue_comments_151857.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nThe \"`Special Update/Build Instructions`\" are quite unclear to me. I'm trying to update the package to GAP-4.5.7 but it's difficult to understand what all this means:\n\n```\nThis is a stripped-down version of GAP.  The databases, which are arch\nindependent, are in a separate package and doc and tests are removed.\n\n** IMPORTANT **:\n   When you update this package, be sure to put the guava package\n   in the package directory!!\n\nDelete some of the documentation:\n  cd doc\n  rm *.bbl *.aux *.dvi *.idx *.ilg *.l* *.m* *.pdf *.toc  *.blg *.ind\n  rm */*.bbl */*.aux */*.dvi */*.idx */*.ilg */*.l* */*.m* */*.pdf */*.ind */*.toc */*.blg\n\nDATABASES (separated out to database_gap.spkg) except GAPDoc which is required:\n  rm -rf small prim trans\n  cd pkg\n  rm -rf !(GAPDoc*)\n\nStuff that isn't GAP sources:\n  rm -rf bin/*\n  cd extern\n  rm -rf !Makefile.in\n```",
    "created_at": "2012-12-20T11:37:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151857",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:0" align="right">comment:0</div>

The "`Special Update/Build Instructions`" are quite unclear to me. I'm trying to update the package to GAP-4.5.7 but it's difficult to understand what all this means:

```
This is a stripped-down version of GAP.  The databases, which are arch
independent, are in a separate package and doc and tests are removed.

** IMPORTANT **:
   When you update this package, be sure to put the guava package
   in the package directory!!

Delete some of the documentation:
  cd doc
  rm *.bbl *.aux *.dvi *.idx *.ilg *.l* *.m* *.pdf *.toc  *.blg *.ind
  rm */*.bbl */*.aux */*.dvi */*.idx */*.ilg */*.l* */*.m* */*.pdf */*.ind */*.toc */*.blg

DATABASES (separated out to database_gap.spkg) except GAPDoc which is required:
  rm -rf small prim trans
  cd pkg
  rm -rf !(GAPDoc*)

Stuff that isn't GAP sources:
  rm -rf bin/*
  cd extern
  rm -rf !Makefile.in
```



---

archive/issue_comments_151858.json:
```json
{
    "body": "<div id=\"comment:211\" align=\"right\">comment:211</div>\n\nReplying to [@jdemeyer](#comment:210):\n> The \"`Special Update/Build Instructions`\" are quite unclear to me. I'm trying to update the package to GAP-4.5.7 but it's difficult to understand what all this means:\n> \n> ```\n> This is a stripped-down version of GAP.  The databases, which are arch\n> independent, are in a separate package and doc and tests are removed.\n> \n> ** IMPORTANT **:\n>    When you update this package, be sure to put the guava package\n>    in the package directory!!\n> ```\n\nsomehow, guava, the favorite GAP package of DJ, used to enjoy a special deal. But not anymore, for a while already. This needs to be updated. \n\nGAP packages (a selection) go to gap_packages optional package.\n\nI hope the rest is clear. \n\n> \n> Delete some of the documentation:\n>   cd doc\n>   rm *.bbl *.aux *.dvi *.idx *.ilg *.l* *.m* *.pdf *.toc  *.blg *.ind\n>   rm */*.bbl */*.aux */*.dvi */*.idx */*.ilg */*.l* */*.m* */*.pdf */*.ind */*.toc */*.blg\n> \n> DATABASES (separated out to database_gap.spkg) except GAPDoc which is required:\n>   rm -rf small prim trans\n>   cd pkg\n>   rm -rf !(GAPDoc*)\n> \n> Stuff that isn't GAP sources:\n>   rm -rf bin/*\n>   cd extern\n>   rm -rf !Makefile.in\n> }}}",
    "created_at": "2012-12-20T12:08:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151858",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:211" align="right">comment:211</div>

Replying to [@jdemeyer](#comment:210):
> The "`Special Update/Build Instructions`" are quite unclear to me. I'm trying to update the package to GAP-4.5.7 but it's difficult to understand what all this means:
> 
> ```
> This is a stripped-down version of GAP.  The databases, which are arch
> independent, are in a separate package and doc and tests are removed.
> 
> ** IMPORTANT **:
>    When you update this package, be sure to put the guava package
>    in the package directory!!
> ```

somehow, guava, the favorite GAP package of DJ, used to enjoy a special deal. But not anymore, for a while already. This needs to be updated. 

GAP packages (a selection) go to gap_packages optional package.

I hope the rest is clear. 

> 
> Delete some of the documentation:
>   cd doc
>   rm *.bbl *.aux *.dvi *.idx *.ilg *.l* *.m* *.pdf *.toc  *.blg *.ind
>   rm */*.bbl */*.aux */*.dvi */*.idx */*.ilg */*.l* */*.m* */*.pdf */*.ind */*.toc */*.blg
> 
> DATABASES (separated out to database_gap.spkg) except GAPDoc which is required:
>   rm -rf small prim trans
>   cd pkg
>   rm -rf !(GAPDoc*)
> 
> Stuff that isn't GAP sources:
>   rm -rf bin/*
>   cd extern
>   rm -rf !Makefile.in
> }}}



---

archive/issue_comments_151859.json:
```json
{
    "body": "<div id=\"comment:212\" align=\"right\">comment:212</div>\n\nReplying to [@dimpase](#comment:211):\n> I hope the rest is clear.\n\nIt's not.\n\nWhen updating the sources is non-trivial, it's best to create a shell script (called `spkg-src`) which downloads and prepares `src/`.",
    "created_at": "2012-12-20T12:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151859",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:212" align="right">comment:212</div>

Replying to [@dimpase](#comment:211):
> I hope the rest is clear.

It's not.

When updating the sources is non-trivial, it's best to create a shell script (called `spkg-src`) which downloads and prepares `src/`.



---

archive/issue_comments_151860.json:
```json
{
    "body": "Fix interrupts in Solaris",
    "created_at": "2012-12-20T12:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151860",
    "user": "https://github.com/jdemeyer"
}
```

Fix interrupts in Solaris



---

archive/issue_comments_151861.json:
```json
{
    "body": "Work Issues: **Clarify src updates**",
    "created_at": "2012-12-20T12:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151861",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **Clarify src updates**



---

archive/issue_comments_151862.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAttachment: **[siginterrupt.patch.gz](https://github.com/sagemath/sage/files/ticket13211/siginterrupt.patch.gz)**\n\nI have a new spkg ready which includes two patches: [attachment: cflags.patch](https://github.com/sagemath/sage/files/ticket13211/cflags.patch.gz) and [attachment: siginterrupt.patch](https://github.com/sagemath/sage/files/ticket13211/siginterrupt.patch.gz). The latter one fixes the OpenSolaris issue and has also been reported upstream.\n\nSomebody else should really clarify `SPKG.txt` on how to update `src` or write a shell script to do so.",
    "created_at": "2012-12-20T12:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151862",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Attachment: **[siginterrupt.patch.gz](https://github.com/sagemath/sage/files/ticket13211/siginterrupt.patch.gz)**

I have a new spkg ready which includes two patches: [attachment: cflags.patch](https://github.com/sagemath/sage/files/ticket13211/cflags.patch.gz) and [attachment: siginterrupt.patch](https://github.com/sagemath/sage/files/ticket13211/siginterrupt.patch.gz). The latter one fixes the OpenSolaris issue and has also been reported upstream.

Somebody else should really clarify `SPKG.txt` on how to update `src` or write a shell script to do so.



---

archive/issue_comments_151863.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nCall me an optimist, but I'm still hoping that upstream will clean up their build system and dist tarball. The layout of their dist tarball and the required packages are also in a flux, so I don't see the value of a shell script. Having said that, the instructions are written in a manner that you just have to cd into the gap* source directory and execute them. E.g. there are directories `gap4r5/small`, `gap4r5/prim`, and `gap4r5/trans`. Then by \"`rm -rf small prim trans`\" I mean to check that the directory layout hasn't changed and then delete these directories.",
    "created_at": "2012-12-20T13:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151863",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

Call me an optimist, but I'm still hoping that upstream will clean up their build system and dist tarball. The layout of their dist tarball and the required packages are also in a flux, so I don't see the value of a shell script. Having said that, the instructions are written in a manner that you just have to cd into the gap* source directory and execute them. E.g. there are directories `gap4r5/small`, `gap4r5/prim`, and `gap4r5/trans`. Then by "`rm -rf small prim trans`" I mean to check that the directory layout hasn't changed and then delete these directories.



---

archive/issue_comments_151864.json:
```json
{
    "body": "<div id=\"comment:215\" align=\"right\">comment:215</div>\n\nReplying to [@vbraun](#comment:214):\n> Having said that, the instructions are written in a manner that you just have to cd into the gap* source directory and execute them.\n\nNot quite. I don't know what `rm -rf !(GAPDoc*)` is supposed to do:\n\n```\njdemeyer@sage:~/spkg/gap-4.5.7.p0/src/pkg$ rm -rf !(GAPDoc*)\nbash: !: event not found\n```\n\nBesides, if you're writing out the commands in `SPKG.txt`, you might as well create an actual shell script which is easier to use than copy/pasting the code and putting the right \"cd\" statements in between.",
    "created_at": "2012-12-20T13:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151864",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:215" align="right">comment:215</div>

Replying to [@vbraun](#comment:214):
> Having said that, the instructions are written in a manner that you just have to cd into the gap* source directory and execute them.

Not quite. I don't know what `rm -rf !(GAPDoc*)` is supposed to do:

```
jdemeyer@sage:~/spkg/gap-4.5.7.p0/src/pkg$ rm -rf !(GAPDoc*)
bash: !: event not found
```

Besides, if you're writing out the commands in `SPKG.txt`, you might as well create an actual shell script which is easier to use than copy/pasting the code and putting the right "cd" statements in between.



---

archive/issue_comments_151865.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou don't like extended shell globs? Then there is no concise way to match with exceptions, I think. \n\n```\nshopt +extglob\n```\nBoth the mercurial and subversion bash completion scripts enable this by default.",
    "created_at": "2012-12-20T14:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151865",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

You don't like extended shell globs? Then there is no concise way to match with exceptions, I think. 

```
shopt +extglob
```
Both the mercurial and subversion bash completion scripts enable this by default.



---

archive/issue_comments_151866.json:
```json
{
    "body": "<div id=\"comment:217\" align=\"right\">comment:217</div>\n\nReplying to [@vbraun](#comment:216):\n> You don't like extended shell globs?\n\nNever heard of this...",
    "created_at": "2012-12-20T15:44:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151866",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:217" align="right">comment:217</div>

Replying to [@vbraun](#comment:216):
> You don't like extended shell globs?

Never heard of this...



---

archive/issue_comments_151867.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI guess you mean\n\n```\nshopt -s extglob\n```",
    "created_at": "2012-12-20T15:54:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151867",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

I guess you mean

```
shopt -s extglob
```



---

archive/issue_comments_151868.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYes, sorry.",
    "created_at": "2012-12-20T15:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151868",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

Yes, sorry.



---

archive/issue_comments_151869.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n ```\n \n Updated spkgs:\n-* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg\n+* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.7.p0.spkg\n * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n \n``````\n",
    "created_at": "2012-12-20T16:57:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151869",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 ```
 
 Updated spkgs:
-* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.6.p0.spkg
+* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.7.p0.spkg
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
 * http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
 
``````




---

archive/issue_comments_151870.json:
```json
{
    "body": "Attachment: **[gap-4.5.7.p0.diff.gz](https://github.com/sagemath/sage/files/ticket13211/gap-4.5.7.p0.diff.gz)**\n\nDiff for the GAP spkg 4.5.6 -> 4.5.7.p0. For reference / review only.",
    "created_at": "2012-12-20T17:00:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151870",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[gap-4.5.7.p0.diff.gz](https://github.com/sagemath/sage/files/ticket13211/gap-4.5.7.p0.diff.gz)**

Diff for the GAP spkg 4.5.6 -> 4.5.7.p0. For reference / review only.



---

archive/issue_comments_151871.json:
```json
{
    "body": "Changed author from **Volker Braun** to **Volker Braun, Jeroen Demeyer**",
    "created_at": "2012-12-20T17:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151871",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Volker Braun** to **Volker Braun, Jeroen Demeyer**



---

archive/issue_events_183825.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-20T17:01:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183825"
}
```



---

archive/issue_events_183826.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-20T17:01:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183826"
}
```



---

archive/issue_comments_151872.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI updated `SPKG.txt` and upgraded to GAP-4.5.7.  needs review...",
    "created_at": "2012-12-20T17:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151872",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

I updated `SPKG.txt` and upgraded to GAP-4.5.7.  needs review...



---

archive/issue_comments_151873.json:
```json
{
    "body": "Changed work issues from **Clarify src updates** to none",
    "created_at": "2012-12-20T17:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151873",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **Clarify src updates** to none



---

archive/issue_events_183827.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-20T17:23:41Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "title_is": "Upgrade GAP to 4.5.7",
    "title_was": "Upgrade GAP to 4.5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183827"
}
```



---

archive/issue_comments_151874.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nDid you check that nothing in the `gap_package` and `database_gap` packages changed? Should I version bump them to 4.5.7 to be clear?",
    "created_at": "2012-12-20T17:39:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151874",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

Did you check that nothing in the `gap_package` and `database_gap` packages changed? Should I version bump them to 4.5.7 to be clear?



---

archive/issue_comments_151875.json:
```json
{
    "body": "<div id=\"comment:225\" align=\"right\">comment:225</div>\n\nReplying to [@vbraun](#comment:224):\n> Did you check that nothing in the `gap_package` and `database_gap` packages changed? Should I version bump them to 4.5.7 to be clear?\n\nAt least some packages might have been changed (this is not in sync with the GAP releases, AFAIK).\n\nAlso, after updating with Jeroen's spkg, I still get gap.version 4.5.6, not 4.5.7.",
    "created_at": "2012-12-20T17:46:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151875",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:225" align="right">comment:225</div>

Replying to [@vbraun](#comment:224):
> Did you check that nothing in the `gap_package` and `database_gap` packages changed? Should I version bump them to 4.5.7 to be clear?

At least some packages might have been changed (this is not in sync with the GAP releases, AFAIK).

Also, after updating with Jeroen's spkg, I still get gap.version 4.5.6, not 4.5.7.



---

archive/issue_comments_151876.json:
```json
{
    "body": "<div id=\"comment:226\" align=\"right\">comment:226</div>\n\nReplying to [@dimpase](#comment:225):\n> Also, after updating with Jeroen's spkg, I still get gap.version 4.5.6, not 4.5.7.\n\nMe, too. I verified that the upstream tarball shows the correct version (4.5.7) upon startup, so something is wrong with the spkg sources.",
    "created_at": "2012-12-20T18:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151876",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:226" align="right">comment:226</div>

Replying to [@dimpase](#comment:225):
> Also, after updating with Jeroen's spkg, I still get gap.version 4.5.6, not 4.5.7.

Me, too. I verified that the upstream tarball shows the correct version (4.5.7) upon startup, so something is wrong with the spkg sources.



---

archive/issue_comments_151877.json:
```json
{
    "body": "<div id=\"comment:227\" align=\"right\">comment:227</div>\n\nReplying to [@dimpase](#comment:225):\n> Also, after updating with Jeroen's spkg, I still get gap.version 4.5.6, not 4.5.7.\n\nIt works for me:\n\n```\njdemeyer@sage:/release/merger/sage-5.6.beta1$ ./sage --gap\n *********   GAP, Version 4.5.7 of 14-Dec-2012 (free software, GPL)\n *  GAP  *   http://www.gap-system.org\n *********   Architecture: x86_64-unknown-linux-gnu-gcc-default64\n Libs used:  gmp, readline\n Loading the library and packages ...\n Packages:   GAPDoc 1.5.1\n Try '?help' for help. See also  '?copyright' and  '?authors'\ngap>\n```\n\n```\njdemeyer@sage:/release/merger/sage-5.6.beta1$ ./sage\n----------------------------------------------------------------------\n| Sage Version 5.5.rc1, Release Date: 2012-12-18                     |\n| Type \"notebook()\" for the browser-based notebook interface.        |\n| Type \"help()\" for help.                                            |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: gap.version()\n'4.5.7'\n```",
    "created_at": "2012-12-20T19:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151877",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:227" align="right">comment:227</div>

Replying to [@dimpase](#comment:225):
> Also, after updating with Jeroen's spkg, I still get gap.version 4.5.6, not 4.5.7.

It works for me:

```
jdemeyer@sage:/release/merger/sage-5.6.beta1$ ./sage --gap
 *********   GAP, Version 4.5.7 of 14-Dec-2012 (free software, GPL)
 *  GAP  *   http://www.gap-system.org
 *********   Architecture: x86_64-unknown-linux-gnu-gcc-default64
 Libs used:  gmp, readline
 Loading the library and packages ...
 Packages:   GAPDoc 1.5.1
 Try '?help' for help. See also  '?copyright' and  '?authors'
gap>
```

```
jdemeyer@sage:/release/merger/sage-5.6.beta1$ ./sage
----------------------------------------------------------------------
| Sage Version 5.5.rc1, Release Date: 2012-12-18                     |
| Type "notebook()" for the browser-based notebook interface.        |
| Type "help()" for help.                                            |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: gap.version()
'4.5.7'
```



---

archive/issue_comments_151878.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe doctest needs to be changed though to reflect version 4.5.7",
    "created_at": "2012-12-20T19:55:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151878",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

The doctest needs to be changed though to reflect version 4.5.7



---

archive/issue_comments_151879.json:
```json
{
    "body": "<div id=\"comment:229\" align=\"right\">comment:229</div>\n\nReplying to [@vbraun](#comment:224):\n> Did you check that nothing in the `gap_package` and `database_gap` packages changed?\n\nNo, I didn't check anything, nor did I realise that this was needed. Please go ahead and update them.",
    "created_at": "2012-12-20T20:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151879",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:229" align="right">comment:229</div>

Replying to [@vbraun](#comment:224):
> Did you check that nothing in the `gap_package` and `database_gap` packages changed?

No, I didn't check anything, nor did I realise that this was needed. Please go ahead and update them.



---

archive/issue_comments_151880.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nThe `gap/latest` symlink is not correctly created, which is why the old version is still used if you installed gap-4.5.6 previously. I'll fix that, too.",
    "created_at": "2012-12-20T20:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151880",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:0" align="right">comment:0</div>

The `gap/latest` symlink is not correctly created, which is why the old version is still used if you installed gap-4.5.6 previously. I'll fix that, too.



---

archive/issue_comments_151881.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,7 +18,6 @@\n \n  Apply\n * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n-* [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)\n * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)\n * [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)\n``````\n",
    "created_at": "2012-12-20T20:12:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151881",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,7 +18,6 @@
 
  Apply
 * [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
-* [attachment: trac_13211_pool_size.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_pool_size.patch.gz)
 * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
 * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)
 * [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)
``````




---

archive/issue_comments_151882.json:
```json
{
    "body": "<div id=\"comment:232\" align=\"right\">comment:232</div>\n\nReplying to [@vbraun](#comment:230):\n> The `gap/latest` symlink is not correctly created, which is why the old version is still used if you installed gap-4.5.6 previously. I'll fix that, too.\n\nok",
    "created_at": "2012-12-20T20:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151882",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:232" align="right">comment:232</div>

Replying to [@vbraun](#comment:230):
> The `gap/latest` symlink is not correctly created, which is why the old version is still used if you installed gap-4.5.6 previously. I'll fix that, too.

ok



---

archive/issue_comments_151883.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,9 +9,9 @@\n ```\n \n Updated spkgs:\n-* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.7.p0.spkg\n-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg \n-* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg\n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg \n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.7.spkg \n+* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.7.spkg\n \n Apply to SAGE_ROOT\n * [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) \n``````\n",
    "created_at": "2012-12-20T20:24:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151883",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,9 +9,9 @@
 ```
 
 Updated spkgs:
-* http://boxen.math.washington.edu/home/jdemeyer/spkg/gap-4.5.7.p0.spkg
-* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.6.spkg 
-* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.6.spkg
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg 
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/gap_packages-4.5.7.spkg 
+* http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.7.spkg
 
 Apply to SAGE_ROOT
 * [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) 
``````




---

archive/issue_comments_151884.json:
```json
{
    "body": "Attachment: **[gap-4.5.7.p1.diff.gz](https://github.com/sagemath/sage/files/ticket13211/gap-4.5.7.p1.diff.gz)**\n\nspkg diff for review only",
    "created_at": "2012-12-20T20:25:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151884",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[gap-4.5.7.p1.diff.gz](https://github.com/sagemath/sage/files/ticket13211/gap-4.5.7.p1.diff.gz)**

spkg diff for review only



---

archive/issue_comments_151885.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nNothing changed in the `gap_packages` and `database_gap` this time, but I bumped the version to match. In any case they need to be updated from the old gap-4.4 ones.",
    "created_at": "2012-12-20T20:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151885",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

Nothing changed in the `gap_packages` and `database_gap` this time, but I bumped the version to match. In any case they need to be updated from the old gap-4.4 ones.



---

archive/issue_events_183828.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-20T20:32:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183828"
}
```



---

archive/issue_events_183829.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-20T20:32:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183829"
}
```



---

archive/issue_comments_151886.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nPositive review to Jeroen's changes.",
    "created_at": "2012-12-20T20:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151886",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">comment:5</div>

Positive review to Jeroen's changes.



---

archive/issue_comments_151887.json:
```json
{
    "body": "Updated for GAP-4.5.7 (contains pool_size patch)",
    "created_at": "2012-12-21T07:36:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151887",
    "user": "https://github.com/jdemeyer"
}
```

Updated for GAP-4.5.7 (contains pool_size patch)



---

archive/issue_events_183830.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-22T07:07:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183830"
}
```



---

archive/issue_events_183831.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-22T07:07:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183831"
}
```



---

archive/issue_comments_151888.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[trac_13211_fix_gap_doctests.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)**\n\nThe memory size still isn't right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap):\n\n```\nsage -t  --long -force_lib devel/sage/sage/combinat/root_system/weyl_group.py\n**********************************************************************\nFile \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/devel/sage-main/sage/combinat/root_system/weyl_group.py\", line 543:\n    sage: all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_16[4]>\", line 1, in <module>\n        all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)###line 543:\n    sage: all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)\n      File \"<doctest __main__.example_16[4]>\", line 1, in <genexpr>\n        all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)###line 543:\n    sage: all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/combinat/root_system/weyl_group.py\", line 579, in long_element_hardcoded\n        return self.__call__(m)\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/combinat/root_system/weyl_group.py\", line 362, in __call__\n        if not gap(g) in gap(self):\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/interface.py\", line 675, in __contains__\n        return P._contains(x.name(), self.name())\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/gap.py\", line 815, in _contains\n        return self.eval('%s in %s'%(v1,v2)) == \"true\"\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/gap.py\", line 574, in eval\n        result = Expect.eval(self, input_line, **kwds)\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/expect.py\", line 1220, in eval\n        for L in code.split('\\n') if L != ''])\n      File \"/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/gap.py\", line 775, in _eval_line\n        raise RuntimeError, message\n    RuntimeError: Gap produced error output\n    Error, exceeded the permitted memory (`-o' command line option)\n\n       executing $sage3 in $sage11;\n**********************************************************************\n```",
    "created_at": "2012-12-22T07:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151888",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[trac_13211_fix_gap_doctests.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)**

The memory size still isn't right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap):

```
sage -t  --long -force_lib devel/sage/sage/combinat/root_system/weyl_group.py
**********************************************************************
File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/devel/sage-main/sage/combinat/root_system/weyl_group.py", line 543:
    sage: all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_16[4]>", line 1, in <module>
        all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)###line 543:
    sage: all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)
      File "<doctest __main__.example_16[4]>", line 1, in <genexpr>
        all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)###line 543:
    sage: all( WeylGroup(t).long_element() == WeylGroup(t).long_element_hardcoded() for t in types )  # long time (17s on sage.math, 2011)
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/combinat/root_system/weyl_group.py", line 579, in long_element_hardcoded
        return self.__call__(m)
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/combinat/root_system/weyl_group.py", line 362, in __call__
        if not gap(g) in gap(self):
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/interface.py", line 675, in __contains__
        return P._contains(x.name(), self.name())
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/gap.py", line 815, in _contains
        return self.eval('%s in %s'%(v1,v2)) == "true"
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/gap.py", line 574, in eval
        result = Expect.eval(self, input_line, **kwds)
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/expect.py", line 1220, in eval
        for L in code.split('\n') if L != ''])
      File "/home/buildbot/build/sage/snapperkob/snapperkob_full/build/sage-5.6.beta1/local/lib/python/site-packages/sage/interfaces/gap.py", line 775, in _eval_line
        raise RuntimeError, message
    RuntimeError: Gap produced error output
    Error, exceeded the permitted memory (`-o' command line option)

       executing $sage3 in $sage11;
**********************************************************************
```



---

archive/issue_comments_151889.json:
```json
{
    "body": "<div id=\"comment:237\" align=\"right\">comment:237</div>\n\nReplying to [@jdemeyer](#comment:236):\n> The memory size still isn't right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap):\n\nsame on my OSX 10.6.8 laptop. Actually, just the following suffices:\n\n```\n$ sage \n----------------------------------------------------------------------\n| Sage Version 5.5.rc0, Release Date: 2012-11-17                     |\n| Type \"notebook()\" for the browser-based notebook interface.        |\n| Type \"help()\" for help.                                            |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: WeylGroup(['E',6]).long_element() == WeylGroup(['E',6]).long_element_hardcoded()\nERROR: An unexpected error occurred while tokenizing input\n[...]\nRuntimeError: Gap produced error output\nError, exceeded the permitted memory (`-o' command line option)\n```\nRepeating this line again in the same session produces no error, something I don't understand.",
    "created_at": "2012-12-22T07:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151889",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:237" align="right">comment:237</div>

Replying to [@jdemeyer](#comment:236):
> The memory size still isn't right, as I got this doctest error on snapperkob (Linux Ubuntu 12.04 x86_64, 8GB RAM + 0.5GB swap):

same on my OSX 10.6.8 laptop. Actually, just the following suffices:

```
$ sage 
----------------------------------------------------------------------
| Sage Version 5.5.rc0, Release Date: 2012-11-17                     |
| Type "notebook()" for the browser-based notebook interface.        |
| Type "help()" for help.                                            |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: WeylGroup(['E',6]).long_element() == WeylGroup(['E',6]).long_element_hardcoded()
ERROR: An unexpected error occurred while tokenizing input
[...]
RuntimeError: Gap produced error output
Error, exceeded the permitted memory (`-o' command line option)
```
Repeating this line again in the same session produces no error, something I don't understand.



---

archive/issue_comments_151890.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-12-22T14:07:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151890",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_151891.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,7 @@\n * [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) \n \n  Apply\n-* [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)\n+* [attachment: trac_13211_fix_gap_doctests.2.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.2.patch.gz)\n * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)\n * [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)\n``````\n",
    "created_at": "2012-12-22T14:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151891",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,7 @@
 * [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) 
 
  Apply
-* [attachment: trac_13211_fix_gap_doctests.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.patch.gz)
+* [attachment: trac_13211_fix_gap_doctests.2.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.2.patch.gz)
 * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
 * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)
 * [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)
``````




---

archive/issue_comments_151892.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[trac_13211_fix_gap_doctests.2.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.2.patch.gz)**\n\nI see, the by far largest computation with GAP is actually in combinat and not in the group theory stuff %-) We actually need about 220 MB, so I increased the minimum to 250 MB. I checked that make ptestlong runs without any further errors.\n\nDima, running the command twice probably uses values that were cached in Sage.",
    "created_at": "2012-12-22T14:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151892",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[trac_13211_fix_gap_doctests.2.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.2.patch.gz)**

I see, the by far largest computation with GAP is actually in combinat and not in the group theory stuff %-) We actually need about 220 MB, so I increased the minimum to 250 MB. I checked that make ptestlong runs without any further errors.

Dima, running the command twice probably uses values that were cached in Sage.



---

archive/issue_events_183832.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-22T14:13:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183832"
}
```



---

archive/issue_events_183833.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-22T14:13:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183833"
}
```



---

archive/issue_comments_151893.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nVolker, your patch is missing `memory_info.py` for some reason.",
    "created_at": "2012-12-22T22:17:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151893",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Volker, your patch is missing `memory_info.py` for some reason.



---

archive/issue_comments_151894.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nAlso, something else I just noted: in #12221, I determined it was better to complete unset `TERM` instead of setting it to \"dumb\". I don't remember why, but I do remember that was the most reliable. \n\nBut I don't care very much since it seems to pass doctests...",
    "created_at": "2012-12-22T22:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151894",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:0" align="right">comment:0</div>

Also, something else I just noted: in #12221, I determined it was better to complete unset `TERM` instead of setting it to "dumb". I don't remember why, but I do remember that was the most reliable. 

But I don't care very much since it seems to pass doctests...



---

archive/issue_events_183834.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-22T22:19:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183834"
}
```



---

archive/issue_events_183835.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-22T22:19:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183835"
}
```



---

archive/issue_comments_151895.json:
```json
{
    "body": "Attachment: **[trac_13211_fix_gap_doctests.3.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.3.patch.gz)**\n\nUpdated patch",
    "created_at": "2012-12-22T22:34:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151895",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13211_fix_gap_doctests.3.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.3.patch.gz)**

Updated patch



---

archive/issue_comments_151896.json:
```json
{
    "body": "Attachment: **[trac_13211_fix_gap_doctests_vb.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests_vb.patch.gz)**\n\nUpdated patch",
    "created_at": "2012-12-22T22:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151896",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13211_fix_gap_doctests_vb.patch.gz](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests_vb.patch.gz)**

Updated patch



---

archive/issue_comments_151897.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nStrange that the file got lost, I didn't edit anything in that dir. I put `memory_info.py` back in and switched from \"dumb\" to no TERM.",
    "created_at": "2012-12-22T22:43:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151897",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">comment:2</div>

Strange that the file got lost, I didn't edit anything in that dir. I put `memory_info.py` back in and switched from "dumb" to no TERM.



---

archive/issue_events_183836.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-22T22:43:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183836"
}
```



---

archive/issue_events_183837.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-12-22T22:43:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183837"
}
```



---

archive/issue_comments_151898.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,7 @@\n * [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) \n \n  Apply\n-* [attachment: trac_13211_fix_gap_doctests.2.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.2.patch.gz)\n+* [attachment: trac_13211_fix_gap_doctests_vb.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests_vb.patch.gz)\n * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)\n * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)\n * [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)\n``````\n",
    "created_at": "2012-12-22T22:43:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151898",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,7 @@
 * [attachment: trac_13211_mpir_dep.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_mpir_dep.patch.gz) 
 
  Apply
-* [attachment: trac_13211_fix_gap_doctests.2.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests.2.patch.gz)
+* [attachment: trac_13211_fix_gap_doctests_vb.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_fix_gap_doctests_vb.patch.gz)
 * [attachment: trac_13211_itanium_fix.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_itanium_fix.patch.gz)
 * [attachment: trac_13211_quit_after_workspace.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit_after_workspace.patch.gz)
 * [attachment: trac_13211_quit.patch](https://github.com/sagemath/sage/files/ticket13211/trac_13211_quit.patch.gz)
``````




---

archive/issue_events_183838.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-26T13:20:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183838"
}
```



---

archive/issue_events_183839.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-26T13:20:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13211#event-183839"
}
```



---

archive/issue_comments_151899.json:
```json
{
    "body": "Merged: **sage-5.6.beta1**",
    "created_at": "2012-12-26T13:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151899",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.6.beta1**



---

archive/issue_comments_151900.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAnd there was much rejoicing...",
    "created_at": "2012-12-26T13:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151900",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

And there was much rejoicing...



---

archive/issue_comments_151901.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThanks! \\o/",
    "created_at": "2012-12-26T13:39:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151901",
    "user": "https://github.com/ppurka"
}
```

<div id="comment:4" align="right">comment:4</div>

Thanks! \o/



---

archive/issue_comments_151902.json:
```json
{
    "body": "<div id=\"comment:245\" align=\"right\">comment:245</div>\n\nReplying to [@jdemeyer](#comment:243):\n> And there was much rejoicing...\n\nCongratulation! Although it means that I have to produce a new version of my group cohomology spkg - it seems that the new Gap version has a different syntax or function names or whatever else to cope with... :(",
    "created_at": "2012-12-26T14:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151902",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:245" align="right">comment:245</div>

Replying to [@jdemeyer](#comment:243):
> And there was much rejoicing...

Congratulation! Although it means that I have to produce a new version of my group cohomology spkg - it seems that the new Gap version has a different syntax or function names or whatever else to cope with... :(



---

archive/issue_comments_151903.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nboth optional SPKSes are on their way around the world :-)",
    "created_at": "2012-12-26T17:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151903",
    "user": "https://github.com/haraldschilly"
}
```

<div id="comment:6" align="right">comment:6</div>

both optional SPKSes are on their way around the world :-)



---

archive/issue_comments_151904.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe database_gap spkg on the mirrors seems to be corrupted, as does the one on Volker's page in the ticket description:\n\n```\npalmieri@sage:sage$ ./sage -i http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.7.spkg\nAttempting to download package database_gap-4.5.7\n>>> Downloading database_gap-4.5.7.spkg.\n[............................................................]\ndatabase_gap-4.5.7\n====================================================\nExtracting package /scratch/palmieri/sage-5.5.rc0/spkg/optional/database_gap-4.5.7.spkg\n-rw-r--r-- 1 palmieri palmieri 59654144 2012-12-29 17:33 /scratch/palmieri/sage-5.5.rc0/spkg/optional/database_gap-4.5.7.spkg\ntar: Skipping to next header\ntar: Error exit delayed from previous errors\nError: failed to extract /scratch/palmieri/sage-5.5.rc0/spkg/optional/database_gap-4.5.7.spkg\n```",
    "created_at": "2012-12-30T01:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151904",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">comment:7</div>

The database_gap spkg on the mirrors seems to be corrupted, as does the one on Volker's page in the ticket description:

```
palmieri@sage:sage$ ./sage -i http://www.stp.dias.ie/~vbraun/Sage/spkg/database_gap-4.5.7.spkg
Attempting to download package database_gap-4.5.7
>>> Downloading database_gap-4.5.7.spkg.
[............................................................]
database_gap-4.5.7
====================================================
Extracting package /scratch/palmieri/sage-5.5.rc0/spkg/optional/database_gap-4.5.7.spkg
-rw-r--r-- 1 palmieri palmieri 59654144 2012-12-29 17:33 /scratch/palmieri/sage-5.5.rc0/spkg/optional/database_gap-4.5.7.spkg
tar: Skipping to next header
tar: Error exit delayed from previous errors
Error: failed to extract /scratch/palmieri/sage-5.5.rc0/spkg/optional/database_gap-4.5.7.spkg
```



---

archive/issue_comments_151905.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFixed, the file was truncated. This is the correct checksum:\n\n```\n[vbraun@volker-desktop spkg]$ md5sum database_gap-4.5.7.spkg \n46b0a14437b1fe996cbbb482d00e5325  database_gap-4.5.7.spkg\n```",
    "created_at": "2012-12-30T21:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151905",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

Fixed, the file was truncated. This is the correct checksum:

```
[vbraun@volker-desktop spkg]$ md5sum database_gap-4.5.7.spkg 
46b0a14437b1fe996cbbb482d00e5325  database_gap-4.5.7.spkg
```



---

archive/issue_comments_151906.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nok,i've replaced the faulty file on the master and the md5 sum matches now. mirrors are updating when you read this!",
    "created_at": "2012-12-30T21:40:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151906",
    "user": "https://github.com/haraldschilly"
}
```

<div id="comment:9" align="right">comment:9</div>

ok,i've replaced the faulty file on the master and the md5 sum matches now. mirrors are updating when you read this!



---

archive/issue_comments_151907.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nJust FYI, JP opened a followup at #13954 since this broke on Cygwin.  No action necessary here, of course, and it looks like he has a fix in any case.",
    "created_at": "2013-01-15T14:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151907",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:0" align="right">comment:0</div>

Just FYI, JP opened a followup at #13954 since this broke on Cygwin.  No action necessary here, of course, and it looks like he has a fix in any case.



---

archive/issue_comments_151908.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI get some weird stuff in interfaces/gap.py on OS X 10.4 with 5.6.beta2.  Things like \n\n```\nsage: n = get_gap_memory_pool_size()\n<snip>\n    free_ram = int(free_ram([:-1]) * units[free_ram[-1]]\nValueError: invalid literal for int() with base 10: '33.1'\n```\nand lots and lots of other similar things.  The new file misc/memory_info.py has similar problems.  This was all introduced in this ticket, so I assume it is related... but maybe there was a followup I am unaware of?  Thanks for any feedback.",
    "created_at": "2013-01-15T16:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151908",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:1" align="right">comment:1</div>

I get some weird stuff in interfaces/gap.py on OS X 10.4 with 5.6.beta2.  Things like 

```
sage: n = get_gap_memory_pool_size()
<snip>
    free_ram = int(free_ram([:-1]) * units[free_ram[-1]]
ValueError: invalid literal for int() with base 10: '33.1'
```
and lots and lots of other similar things.  The new file misc/memory_info.py has similar problems.  This was all introduced in this ticket, so I assume it is related... but maybe there was a followup I am unaware of?  Thanks for any feedback.



---

archive/issue_comments_151909.json:
```json
{
    "body": "<div id=\"comment:252\" align=\"right\">comment:252</div>\n\nThere is a follow-up at #13880, but if that doesn't fix your problem, **please post to sage-devel** such that this can be fixed before releasing the final Sage 5.6.",
    "created_at": "2013-01-15T16:51:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151909",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:252" align="right">comment:252</div>

There is a follow-up at #13880, but if that doesn't fix your problem, **please post to sage-devel** such that this can be fixed before releasing the final Sage 5.6.



---

archive/issue_comments_151910.json:
```json
{
    "body": "<div id=\"comment:253\" align=\"right\">comment:253</div>\n\n> There is a follow-up at #13880, but if that doesn't fix your problem, **please post to sage-devel** such that this can be fixed before releasing the final Sage 5.6.\n\nI saw that, but it didn't seem to be quite the same issue... but I'll try it!",
    "created_at": "2013-01-15T17:31:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151910",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:253" align="right">comment:253</div>

> There is a follow-up at #13880, but if that doesn't fix your problem, **please post to sage-devel** such that this can be fixed before releasing the final Sage 5.6.

I saw that, but it didn't seem to be quite the same issue... but I'll try it!



---

archive/issue_comments_151911.json:
```json
{
    "body": "<div id=\"comment:254\" align=\"right\">comment:254</div>\n\n> > There is a follow-up at #13880, but if that doesn't fix your problem, **please post to sage-devel** such that this can be fixed before releasing the final Sage 5.6.\n\n> I saw that, but it didn't seem to be quite the same issue... but I'll try it!\n\nSorry, it didn't seem to do it.  I've posted to sage-devel.",
    "created_at": "2013-01-15T17:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151911",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:254" align="right">comment:254</div>

> > There is a follow-up at #13880, but if that doesn't fix your problem, **please post to sage-devel** such that this can be fixed before releasing the final Sage 5.6.

> I saw that, but it didn't seem to be quite the same issue... but I'll try it!

Sorry, it didn't seem to do it.  I've posted to sage-devel.



---

archive/issue_comments_151912.json:
```json
{
    "body": "<div id=\"comment:255\" align=\"right\">comment:255</div>\n\n(never mind)",
    "created_at": "2013-01-16T06:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151912",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:255" align="right">comment:255</div>

(never mind)



---

archive/issue_comments_151913.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThis caused a serious slow-down in congruence subgroups: [https://groups.google.com/forum/?fromgroups#!topic/sage-devel/e3EDIRLuJXA](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/e3EDIRLuJXA)",
    "created_at": "2013-01-25T10:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151913",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

This caused a serious slow-down in congruence subgroups: [https://groups.google.com/forum/?fromgroups#!topic/sage-devel/e3EDIRLuJXA](https://groups.google.com/forum/?fromgroups#!topic/sage-devel/e3EDIRLuJXA)



---

archive/issue_comments_151914.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReported upstream at http://tracker.gap-system.org/issues/221",
    "created_at": "2013-01-25T12:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13211",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13211#issuecomment-151914",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

Reported upstream at http://tracker.gap-system.org/issues/221
