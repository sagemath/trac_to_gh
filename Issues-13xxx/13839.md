# Issue 13839: Let lrcalc build as a shared library on Cygwin.

archive/issues_013635.json:
```json
{
    "body": "We need to pass the -no-undefined flag to libtool to build a shared library on Cygwin.\n\nThis was added to the 1.1.6 beta spkg distributed within Sage.\n\nFollowing discussion with upstream it was decided that upstream would distribute an alternate autotools-based lrcalc, named lrcalc-sage, using the spkg modified sources.\n\nThe sources have been published upstream:\nhttp://www.math.rutgers.edu/~asbuch/lrcalc/\n\nTherefore we stop tracking the src directory (which was not such a good idea) as it will be done upstream.\n(And as a consequence the diff attached here is quite big but the spkg does not grows.)\n\nTry spkg at\nhttp://boxen.math.washington.edu/home/jpflori/lrcalc-1.1.6.spkg\n\n\nAssignee: tbd\n\nCC:  @kcrisman @dimpase @nthiery\n\nKeywords: lrcalc spkg cygwin\n\nUpstream: None of the above - read trac for reasoning.\n\nReviewer: Dmitrii Pasechnik\n\nAuthor: Jean-Pierre Flori\n\nMerged: sage-5.8.beta1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13839\n\n",
    "closed_at": "2013-02-22T19:12:24Z",
    "created_at": "2012-12-17T15:44:38Z",
    "labels": [
        "component: porting: cygwin",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "Let lrcalc build as a shared library on Cygwin.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13839",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```
We need to pass the -no-undefined flag to libtool to build a shared library on Cygwin.

This was added to the 1.1.6 beta spkg distributed within Sage.

Following discussion with upstream it was decided that upstream would distribute an alternate autotools-based lrcalc, named lrcalc-sage, using the spkg modified sources.

The sources have been published upstream:
http://www.math.rutgers.edu/~asbuch/lrcalc/

Therefore we stop tracking the src directory (which was not such a good idea) as it will be done upstream.
(And as a consequence the diff attached here is quite big but the spkg does not grows.)

Try spkg at
http://boxen.math.washington.edu/home/jpflori/lrcalc-1.1.6.spkg


Assignee: tbd

CC:  @kcrisman @dimpase @nthiery

Keywords: lrcalc spkg cygwin

Upstream: None of the above - read trac for reasoning.

Reviewer: Dmitrii Pasechnik

Author: Jean-Pierre Flori

Merged: sage-5.8.beta1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13839





---

archive/issue_comments_168482.json:
```json
{
    "body": "Attachment [lrcalc-1.1.6beta2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.diff) by jpflori created at 2012-12-17 16:22:09\n\nSpkg diff, for review only.",
    "created_at": "2012-12-17T16:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168482",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [lrcalc-1.1.6beta2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.diff) by jpflori created at 2012-12-17 16:22:09

Spkg diff, for review only.



---

archive/issue_comments_168483.json:
```json
{
    "body": "<a id='comment:1'></a>New spkg uploaded.\n\nI've rerun autoreconf with recent versions of the tool as the current state of the build system looked messy (and trying to use Jeroen smart spkg to produce a minimal diff complained a little and produced something broken).\n\nIt works fine on Linux, I won't be able to check on Cygwin before this night or tomorrow.",
    "created_at": "2012-12-17T16:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168483",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:1'></a>New spkg uploaded.

I've rerun autoreconf with recent versions of the tool as the current state of the build system looked messy (and trying to use Jeroen smart spkg to produce a minimal diff complained a little and produced something broken).

It works fine on Linux, I won't be able to check on Cygwin before this night or tomorrow.



---

archive/issue_comments_168484.json:
```json
{
    "body": "Changing keywords from \"lrcalc spkg\" to \"lrcalc spkg cygwin\".",
    "created_at": "2012-12-17T16:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168484",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing keywords from "lrcalc spkg" to "lrcalc spkg cygwin".



---

archive/issue_comments_168485.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-12-17T16:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168485",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_168486.json:
```json
{
    "body": "<a id='comment:2'></a>Upstream is ready to distribute an alternative official package using autotools, in addition to the original one using a custom build system.\n\nSo I propose to wait for everybody to be happy with the spkg here, send it upstream, repackage it \"properly\" here and merge it.",
    "created_at": "2012-12-17T17:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168486",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:2'></a>Upstream is ready to distribute an alternative official package using autotools, in addition to the original one using a custom build system.

So I propose to wait for everybody to be happy with the spkg here, send it upstream, repackage it "properly" here and merge it.



---

archive/issue_comments_168487.json:
```json
{
    "body": "<a id='comment:3'></a>I checked the changes in the diff, and am happy with them. Feel free to set a positive review on my behalf (I'll be offline the next couple days).",
    "created_at": "2012-12-17T22:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168487",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:3'></a>I checked the changes in the diff, and am happy with them. Feel free to set a positive review on my behalf (I'll be offline the next couple days).



---

archive/issue_comments_168488.json:
```json
{
    "body": "<a id='comment:4'></a>Just a confirmation that this works as expected on Cygwin.\n\nAfter our discussion with upstream, I will remove tracking of the src directory from the spkg and repost a new spkg.\nThe src directory will now be tracked in a separate hg tree kept upstream.",
    "created_at": "2012-12-18T14:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168488",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:4'></a>Just a confirmation that this works as expected on Cygwin.

After our discussion with upstream, I will remove tracking of the src directory from the spkg and repost a new spkg.
The src directory will now be tracked in a separate hg tree kept upstream.



---

archive/issue_comments_168489.json:
```json
{
    "body": "Attachment [lrcalc-1.1.6beta2.2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.2.diff) by jpflori created at 2012-12-18 15:22:06\n\nSpkg diff, for review only.",
    "created_at": "2012-12-18T15:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168489",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [lrcalc-1.1.6beta2.2.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6beta2.2.diff) by jpflori created at 2012-12-18 15:22:06

Spkg diff, for review only.



---

archive/issue_comments_168490.json:
```json
{
    "body": "<a id='comment:6'></a>Wait, did this not work right?  Or is this just an enhancement?  (I know there is a parent ticket, but I forget the number.)",
    "created_at": "2012-12-18T15:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168490",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>Wait, did this not work right?  Or is this just an enhancement?  (I know there is a parent ticket, but I forget the number.)



---

archive/issue_comments_168491.json:
```json
{
    "body": "<a id='comment:7'></a>It was not build as shared before.\nI cannot say that the static archive produced was dysfunctional, I've not run the tests, so we can consider it an enhancement if not a defect.",
    "created_at": "2012-12-18T15:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168491",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:7'></a>It was not build as shared before.
I cannot say that the static archive produced was dysfunctional, I've not run the tests, so we can consider it an enhancement if not a defect.



---

archive/issue_comments_168492.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-02-08T10:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168492",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_168493.json:
```json
{
    "body": "<a id='comment:9'></a>There have been some minimal changes to the tarball posted upstream so we need to resync.",
    "created_at": "2013-02-08T10:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168493",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:9'></a>There have been some minimal changes to the tarball posted upstream so we need to resync.



---

archive/issue_comments_168494.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-19T10:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168494",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_168495.json:
```json
{
    "body": "<a id='comment:10'></a>I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.\n\nNicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?",
    "created_at": "2013-02-19T10:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168495",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:10'></a>I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.

Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?



---

archive/issue_comments_168496.json:
```json
{
    "body": "Attachment [lrcalc-1.1.6.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6.diff) by jpflori created at 2013-02-19 10:16:45\n\nSpkg diff, for review only.",
    "created_at": "2013-02-19T10:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168496",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [lrcalc-1.1.6.diff](tarball://root/attachments/some-uuid/ticket13839/lrcalc-1.1.6.diff) by jpflori created at 2013-02-19 10:16:45

Spkg diff, for review only.



---

archive/issue_comments_168497.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 jpflori]:\n> I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.\n> \n> Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?\n\n\nIt builds on cygwin, but fails tests. More precisely the following fails:\n\n```\nsage: from sage.libs.lcalc.lcalc_Lfunction import *\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-1-015a4f363123> in <module>()\n----> 1 from sage.libs.lcalc.lcalc_Lfunction import *\n\nImportError: No such file or directory\nsage:\n```\nIs it just me?",
    "created_at": "2013-02-19T11:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168497",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>Replying to [comment:10 jpflori]:
> I've resynced the src folder with the upstream tarball (mostly copyright additions and some autotools regenration stuff) and polished a little bit SPKG.txt.
> 
> Nicolas could you have a quick look at the spkg and put this to positive review as we planned a few monthes ago?


It builds on cygwin, but fails tests. More precisely the following fails:

```
sage: from sage.libs.lcalc.lcalc_Lfunction import *
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-1-015a4f363123> in <module>()
----> 1 from sage.libs.lcalc.lcalc_Lfunction import *

ImportError: No such file or directory
sage:
```
Is it just me?



---

archive/issue_comments_168498.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-02-19T11:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168498",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_168499.json:
```json
{
    "body": "<a id='comment:12'></a>Didn't you mess lcalc and lrcalc together?",
    "created_at": "2013-02-19T11:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168499",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:12'></a>Didn't you mess lcalc and lrcalc together?



---

archive/issue_comments_168500.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-02-19T11:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168500",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_168501.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 jpflori]:\n> Didn't you mess lcalc and lrcalc together?\n\noops, indeed. lrcalc works. Positive review.",
    "created_at": "2013-02-19T11:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168501",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>Replying to [comment:12 jpflori]:
> Didn't you mess lcalc and lrcalc together?

oops, indeed. lrcalc works. Positive review.



---

archive/issue_comments_168502.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-19T11:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168502",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_038818.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-19T14:33:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "milestone": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13839#event-38818"
}
```



---

archive/issue_comments_168503.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-02-22T19:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13839#issuecomment-168503",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_038819.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-22T19:12:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13839",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13839#event-38819"
}
```
