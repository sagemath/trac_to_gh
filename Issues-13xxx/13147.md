# Issue 13147: Delay the evaluation of SAGE_TMP in order to facilitate forking in doctesting

archive/issues_012975.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-mvngu"
    ],
    "body": "In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n\n**Apply** \n* [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n\n\nDepends on #13579\nDepends on #13681\n\nCC:  @mwhansen\n\nReviewer: **John Palmieri**\n\nAuthor: **David Roe, Mike Hansen**\n\nMerged: **sage-5.5.beta1**\n\nComponent: **doctest coverage**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13147_\n\n",
    "closed_at": "2012-11-12T21:57:16Z",
    "created_at": "2012-06-21T05:36:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Delay the evaluation of SAGE_TMP in order to facilitate forking in doctesting",
    "type": "issue",
    "updated_at": "2012-11-12T21:57:16Z",
    "url": "https://github.com/sagemath/sage/issues/13147",
    "user": "https://github.com/roed314"
}
```
In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.

**Apply** 
* [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).


Depends on #13579
Depends on #13681

CC:  @mwhansen

Reviewer: **John Palmieri**

Author: **David Roe, Mike Hansen**

Merged: **sage-5.5.beta1**

Component: **doctest coverage**

_Issue created by migration from https://trac.sagemath.org/ticket/13147_





---

archive/issue_events_180899.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180899"
}
```



---

archive/issue_events_180900.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180900"
}
```



---

archive/issue_events_180901.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180901"
}
```



---

archive/issue_events_180902.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180902"
}
```



---

archive/issue_events_180903.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "subject": "https://github.com/roed314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180903"
}
```



---

archive/issue_comments_150581.json:
```json
{
    "body": "Attachment: **[13147_move.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_move.patch.gz)**\n\nDavid Roe/Robert Bradshaw's original solution: I don't like it as much as Mike's",
    "created_at": "2012-06-21T05:37:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150581",
    "user": "https://github.com/roed314"
}
```

Attachment: **[13147_move.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_move.patch.gz)**

David Roe/Robert Bradshaw's original solution: I don't like it as much as Mike's



---

archive/issue_comments_150582.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI like Mike's solution a lot more, but it requires speaklater.  I think this is in the new flasque notebook?  Can we use it from there?",
    "created_at": "2012-06-21T05:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150582",
    "user": "https://github.com/roed314"
}
```

<div id="comment:1" align="right">comment:1</div>

I like Mike's solution a lot more, but it requires speaklater.  I think this is in the new flasque notebook?  Can we use it from there?



---

archive/issue_events_180904.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:38:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180904"
}
```



---

archive/issue_comments_150583.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions\n+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n+\n+Apply [attachment: 13147_lazy.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)\n``````\n",
    "created_at": "2012-06-21T05:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150583",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions
+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
+
+Apply [attachment: 13147_lazy.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)
``````




---

archive/issue_comments_150584.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n+1 for Mike's solution, I know nothing about the flask notebook, but we certainly shouldn't include speaklater in the manner it is done in the patch.\n\nAlso, why are we using temp files and directories in `DOT_SAGE` still, I see no reason to not use the tempfile module with Mike's patch.",
    "created_at": "2012-06-21T06:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150584",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:4" align="right">comment:4</div>

+1 for Mike's solution, I know nothing about the flask notebook, but we certainly shouldn't include speaklater in the manner it is done in the patch.

Also, why are we using temp files and directories in `DOT_SAGE` still, I see no reason to not use the tempfile module with Mike's patch.



---

archive/issue_comments_150585.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWhile you're rewriting the definition of `SAGE_TMP`, you should change lines like\n\n```\nd = '%s/temp/%s/%s/'%(DOT_SAGE, HOSTNAME, os.getpid()) \n```\nto use `os.path.join`.",
    "created_at": "2012-06-21T14:43:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150585",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

While you're rewriting the definition of `SAGE_TMP`, you should change lines like

```
d = '%s/temp/%s/%s/'%(DOT_SAGE, HOSTNAME, os.getpid()) 
```
to use `os.path.join`.



---

archive/issue_comments_150586.json:
```json
{
    "body": "Attachment: **[13147_lazy.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch.gz)**\n\nMike Hansen's solution",
    "created_at": "2012-06-21T18:56:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150586",
    "user": "https://github.com/roed314"
}
```

Attachment: **[13147_lazy.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch.gz)**

Mike Hansen's solution



---

archive/issue_comments_150587.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAndrew, are you referring to the fact that Mike creates speaklater.py in the Sage library?",
    "created_at": "2012-06-22T01:39:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150587",
    "user": "https://github.com/kini"
}
```

<div id="comment:6" align="right">comment:6</div>

Andrew, are you referring to the fact that Mike creates speaklater.py in the Sage library?



---

archive/issue_comments_150588.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYeah, I think Andrew's referring to the fact that Mike just included speaklater.\n\npatchbot: apply 13147_lazy.patch.",
    "created_at": "2012-06-22T02:26:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150588",
    "user": "https://github.com/roed314"
}
```

<div id="comment:7" align="right">comment:7</div>

Yeah, I think Andrew's referring to the fact that Mike just included speaklater.

patchbot: apply 13147_lazy.patch.



---

archive/issue_comments_150589.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\npatchbot: apply 13147_lazy.patch",
    "created_at": "2012-06-22T02:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150589",
    "user": "https://github.com/kini"
}
```

<div id="comment:8" align="right">comment:8</div>

patchbot: apply 13147_lazy.patch



---

archive/issue_comments_150590.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n`sage/misc/speaklater.py` has no documentation *at all*.\n\nWhy the name `speaklater` and not `lazy_string` (or whatever)?",
    "created_at": "2012-06-25T10:21:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150590",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

`sage/misc/speaklater.py` has no documentation *at all*.

Why the name `speaklater` and not `lazy_string` (or whatever)?



---

archive/issue_events_180905.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-25T10:21:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180905"
}
```



---

archive/issue_events_180906.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-25T10:21:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180906"
}
```



---

archive/issue_comments_150591.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nBecause it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater). Obviously we should just depend on speaklater and not incorporate it into the Sage library.",
    "created_at": "2012-06-25T10:30:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150591",
    "user": "https://github.com/kini"
}
```

<div id="comment:10" align="right">comment:10</div>

Because it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater). Obviously we should just depend on speaklater and not incorporate it into the Sage library.



---

archive/issue_comments_150592.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@kini](#comment:10):\n> Because it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater).\n\nAt the very least, document this fact in the file `speaklater.py`.  Also, you should credit the author and specify the license.",
    "created_at": "2012-06-25T11:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150592",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@kini](#comment:10):
> Because it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater).

At the very least, document this fact in the file `speaklater.py`.  Also, you should credit the author and specify the license.



---

archive/issue_comments_150593.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWhen I wrote that patch, including the speaklater code was just something to get things as a proof of concept.  I didn't think that that code would ever try to go in as is.",
    "created_at": "2012-06-25T12:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150593",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:12" align="right">comment:12</div>

When I wrote that patch, including the speaklater code was just something to get things as a proof of concept.  I didn't think that that code would ever try to go in as is.



---

archive/issue_comments_150594.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIsn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.",
    "created_at": "2012-06-25T15:19:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150594",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:13" align="right">comment:13</div>

Isn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.



---

archive/issue_comments_150595.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jhpalmieri](#comment:13):\n> Isn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.\n\nI think it's philosophically wrong to make Sage depend on the Sage Notebook.  Since it's a small file, I don't mind the duplication much.",
    "created_at": "2012-06-25T15:32:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150595",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jhpalmieri](#comment:13):
> Isn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.

I think it's philosophically wrong to make Sage depend on the Sage Notebook.  Since it's a small file, I don't mind the duplication much.



---

archive/issue_comments_150596.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI think it's philosophically wrong for the Sage notebook to depend on Sage: that's the whole point of the notebook project. But Sage can and should depend on its various component packages, so I don't see anything wrong with Sage depending on files included in the sagenb spkg.  But maybe I'm misunderstanding your point.",
    "created_at": "2012-06-25T16:16:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150596",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

I think it's philosophically wrong for the Sage notebook to depend on Sage: that's the whole point of the notebook project. But Sage can and should depend on its various component packages, so I don't see anything wrong with Sage depending on files included in the sagenb spkg.  But maybe I'm misunderstanding your point.



---

archive/issue_comments_150597.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOkay, I think it's wrong to depend on the Sage Notebook for stuff which isn't notebook-related.\n\nI also don't think that `speaklater` should be included in the `sagenb` spkg.  Technically, it probably should be a separate spkg, but that seems way overkill given that it's essentially one small file.",
    "created_at": "2012-06-25T16:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150597",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Okay, I think it's wrong to depend on the Sage Notebook for stuff which isn't notebook-related.

I also don't think that `speaklater` should be included in the `sagenb` spkg.  Technically, it probably should be a separate spkg, but that seems way overkill given that it's essentially one small file.



---

archive/issue_comments_150598.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI don't think the sagenb spkg should contain a bunch of tarballs either. I think we should start using the package management system from lmonade and steal Gentoo's ebuilds for most of our packages, so there will be very minimal effort required to package additional pieces of software (such as speaklater) for Sage. But that is far off, I guess. At least it will need to be after we drop SPKGs and complete #13015.",
    "created_at": "2012-06-25T18:34:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150598",
    "user": "https://github.com/kini"
}
```

<div id="comment:17" align="right">comment:17</div>

I don't think the sagenb spkg should contain a bunch of tarballs either. I think we should start using the package management system from lmonade and steal Gentoo's ebuilds for most of our packages, so there will be very minimal effort required to package additional pieces of software (such as speaklater) for Sage. But that is far off, I guess. At least it will need to be after we drop SPKGs and complete #13015.



---

archive/issue_comments_150599.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSo what's the plan for this ticket?  The options seem to be:\n\n1. Include speaklater.py with no doctests; include attribution and license.\n2. Include speaklater.py with doctests (I'm not going to write them...); include attribution and license.\n3. Depend on #11080 and import speaklater from sagenb\n4. Make an spkg.\n5. Write a simplified lazy string with doctests.\n\nI think my vote would be for 3.",
    "created_at": "2012-06-28T08:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150599",
    "user": "https://github.com/roed314"
}
```

<div id="comment:18" align="right">comment:18</div>

So what's the plan for this ticket?  The options seem to be:

1. Include speaklater.py with no doctests; include attribution and license.
2. Include speaklater.py with doctests (I'm not going to write them...); include attribution and license.
3. Depend on #11080 and import speaklater from sagenb
4. Make an spkg.
5. Write a simplified lazy string with doctests.

I think my vote would be for 3.



---

archive/issue_comments_150600.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI vote for 1.",
    "created_at": "2012-06-28T08:49:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150600",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

I vote for 1.



---

archive/issue_comments_150601.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI vote for 4.",
    "created_at": "2012-06-28T09:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150601",
    "user": "https://github.com/kini"
}
```

<div id="comment:20" align="right">comment:20</div>

I vote for 4.



---

archive/issue_comments_150602.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHere's an SPKG: http://wstein.org/home/keshav/files/speaklater-1.2-fbc7a37.spkg",
    "created_at": "2012-06-28T09:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150602",
    "user": "https://github.com/kini"
}
```

<div id="comment:21" align="right">comment:21</div>

Here's an SPKG: http://wstein.org/home/keshav/files/speaklater-1.2-fbc7a37.spkg



---

archive/issue_comments_150603.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI also vote for the spkg. The one Keshav provided looks fine.",
    "created_at": "2012-06-29T07:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150603",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:22" align="right">comment:22</div>

I also vote for the spkg. The one Keshav provided looks fine.



---

archive/issue_comments_150604.json:
```json
{
    "body": "Attachment: **[13147_lazy_spkg.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy_spkg.patch.gz)**\n\nLazy string solution for use with spkg",
    "created_at": "2012-06-29T07:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150604",
    "user": "https://github.com/ohanar"
}
```

Attachment: **[13147_lazy_spkg.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy_spkg.patch.gz)**

Lazy string solution for use with spkg



---

archive/issue_comments_150605.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nWe should also patch deps since this would become a standard SPKG.",
    "created_at": "2012-06-29T08:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150605",
    "user": "https://github.com/kini"
}
```

<div id="comment:23" align="right">comment:23</div>

We should also patch deps since this would become a standard SPKG.



---

archive/issue_comments_150606.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nWe also need a vote on sage-devel for the inclusion of speaklater as a standard spkg.  I'm a bit concerned that we'll get objections since\n\n* speaklater has no doctests\n* we haven't made it an optional package first\n* we're adding another dependency of sage\n\nBut I'm happy to be proved wrong.  Keshav and Andrew, do one of you want to write an e-mail to sage-devel or should I?",
    "created_at": "2012-07-03T07:59:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150606",
    "user": "https://github.com/roed314"
}
```

<div id="comment:24" align="right">comment:24</div>

We also need a vote on sage-devel for the inclusion of speaklater as a standard spkg.  I'm a bit concerned that we'll get objections since

* speaklater has no doctests
* we haven't made it an optional package first
* we're adding another dependency of sage

But I'm happy to be proved wrong.  Keshav and Andrew, do one of you want to write an e-mail to sage-devel or should I?



---

archive/issue_comments_150607.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n* Upstream source is not required to have doctests.\n  * speaklater was already included in the flask notebook, so we're really just moving it into its own spkg.\n\nSo I don't think it should be a big deal.",
    "created_at": "2012-07-03T17:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150607",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

* Upstream source is not required to have doctests.
  * speaklater was already included in the flask notebook, so we're really just moving it into its own spkg.

So I don't think it should be a big deal.



---

archive/issue_comments_150608.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@roed314](#comment:24):\n> * speaklater has no doctests\n\nNot required, as John said.\n\n> * we haven't made it an optional package first\n\nNot really a big deal I think\n\n> * we're adding another dependency of sage\n\nNo we're not - we're including another package in Sage.\n\nBy the way, I asked the author of speaklater on IRC to release a new version containing the fix for the pickling problem we ran across in sagenb many months ago, and a couple of days ago he seems to have released 1.3, so here's a new SPKG: http://wstein.org/home/keshav/files/speaklater-1.3.spkg",
    "created_at": "2012-07-04T03:12:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150608",
    "user": "https://github.com/kini"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@roed314](#comment:24):
> * speaklater has no doctests

Not required, as John said.

> * we haven't made it an optional package first

Not really a big deal I think

> * we're adding another dependency of sage

No we're not - we're including another package in Sage.

By the way, I asked the author of speaklater on IRC to release a new version containing the fix for the pickling problem we ran across in sagenb many months ago, and a couple of days ago he seems to have released 1.3, so here's a new SPKG: http://wstein.org/home/keshav/files/speaklater-1.3.spkg



---

archive/issue_comments_150609.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nOops, forgot to update SPKG.txt - done now (same URL).",
    "created_at": "2012-07-04T03:14:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150609",
    "user": "https://github.com/kini"
}
```

<div id="comment:27" align="right">comment:27</div>

Oops, forgot to update SPKG.txt - done now (same URL).



---

archive/issue_comments_150610.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n \n-Apply [attachment: 13147_lazy.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)\n+**Apply** [attachment: 13147_new.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)\n``````\n",
    "created_at": "2012-07-12T01:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150610",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
 
-Apply [attachment: 13147_lazy.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)
+**Apply** [attachment: 13147_new.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)
``````




---

archive/issue_comments_150611.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nGiven the opposition to speaklater as an spkg on sage-devel, I've added doctests to speaklater.py, make a couple changes and added it as sage.misc.lazy_string.\n\npatchbot: apply 13147_new.patch",
    "created_at": "2012-07-12T01:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150611",
    "user": "https://github.com/roed314"
}
```

<div id="comment:28" align="right">comment:28</div>

Given the opposition to speaklater as an spkg on sage-devel, I've added doctests to speaklater.py, make a couple changes and added it as sage.misc.lazy_string.

patchbot: apply 13147_new.patch



---

archive/issue_events_180907.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T01:22:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180907"
}
```



---

archive/issue_events_180908.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T01:22:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180908"
}
```



---

archive/issue_comments_150612.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nMissed something; I'll fix it in a few hours.",
    "created_at": "2012-07-12T03:40:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150612",
    "user": "https://github.com/roed314"
}
```

<div id="comment:29" align="right">comment:29</div>

Missed something; I'll fix it in a few hours.



---

archive/issue_events_180909.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T03:40:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180909"
}
```



---

archive/issue_events_180910.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T03:40:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180910"
}
```



---

archive/issue_comments_150613.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nAlright, fixed.",
    "created_at": "2012-07-12T07:58:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150613",
    "user": "https://github.com/roed314"
}
```

<div id="comment:30" align="right">comment:30</div>

Alright, fixed.



---

archive/issue_events_180911.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T07:58:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180911"
}
```



---

archive/issue_events_180912.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T07:58:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180912"
}
```



---

archive/issue_comments_150614.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nLine 23 of cleaner.py:\n\n```\n    F = os.path.join(misc.SAGE_TMP, 'spawned_processes') \n```\nShould it say `str(SAGE_TMP)`?",
    "created_at": "2012-07-13T16:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150614",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">comment:31</div>

Line 23 of cleaner.py:

```
    F = os.path.join(misc.SAGE_TMP, 'spawned_processes') 
```
Should it say `str(SAGE_TMP)`?



---

archive/issue_comments_150615.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI think that the file lazy_string.py should have a bit more documentation at the top, for example (from the [speaklater website](https://github.com/mitsuhiko/speaklater):\n\n```\nA module that provides lazy strings for translations. Basically you get an\nobject that appears to be a string but changes the value every time the value\nis evaluated based on a callable you provide.\n```\nA few examples would be nice, too.\n\n(Right now it looks like a typical, underdocumented, Python module (well, it's much better than this because of the doctests you added), whereas it should look like a typical, well-documented, Sage module.)",
    "created_at": "2012-07-13T16:55:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150615",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

I think that the file lazy_string.py should have a bit more documentation at the top, for example (from the [speaklater website](https://github.com/mitsuhiko/speaklater):

```
A module that provides lazy strings for translations. Basically you get an
object that appears to be a string but changes the value every time the value
is evaluated based on a callable you provide.
```
A few examples would be nice, too.

(Right now it looks like a typical, underdocumented, Python module (well, it's much better than this because of the doctests you added), whereas it should look like a typical, well-documented, Sage module.)



---

archive/issue_comments_150616.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nAll gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?",
    "created_at": "2012-07-13T16:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150616",
    "user": "https://github.com/kini"
}
```

<div id="comment:33" align="right">comment:33</div>

All gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?



---

archive/issue_comments_150617.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jhpalmieri](#comment:31):\n> Line 23 of cleaner.py:\n> \n> ```\n>     F = os.path.join(misc.SAGE_TMP, 'spawned_processes') \n> ```\n> Should it say `str(SAGE_TMP)`?\n\nThere was a typo in Mike's version of `speaklater.py` (`__eq__` was broken); os.path.join now works without the explicit string cast.\n\n`os.path.exists` doesn't though (and I'm not sure exactly why, since I can't find the source code of `os.stat`).",
    "created_at": "2012-07-13T18:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150617",
    "user": "https://github.com/roed314"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jhpalmieri](#comment:31):
> Line 23 of cleaner.py:
> 
> ```
>     F = os.path.join(misc.SAGE_TMP, 'spawned_processes') 
> ```
> Should it say `str(SAGE_TMP)`?

There was a typo in Mike's version of `speaklater.py` (`__eq__` was broken); os.path.join now works without the explicit string cast.

`os.path.exists` doesn't though (and I'm not sure exactly why, since I can't find the source code of `os.stat`).



---

archive/issue_comments_150618.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nKeshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than \"Creates a lazy string by invoking func with args\". Maybe just one more sentence like: \"A typical usage might be ...\". Maybe another sentence like: \"Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc.\"\n\nAnd this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.",
    "created_at": "2012-07-13T18:46:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150618",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">comment:35</div>

Keshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than "Creates a lazy string by invoking func with args". Maybe just one more sentence like: "A typical usage might be ...". Maybe another sentence like: "Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc."

And this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.



---

archive/issue_comments_150619.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@kini](#comment:33):\n> All gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?\n\nI wasn't sure what the `__gettext__` method did; it can be readded if desired.",
    "created_at": "2012-07-13T19:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150619",
    "user": "https://github.com/roed314"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@kini](#comment:33):
> All gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?

I wasn't sure what the `__gettext__` method did; it can be readded if desired.



---

archive/issue_comments_150620.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@jhpalmieri](#comment:35):\n> Keshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than \"Creates a lazy string by invoking func with args\". Maybe just one more sentence like: \"A typical usage might be ...\". Maybe another sentence like: \"Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc.\"\n> \n> And this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.\n\nMakes sense.  I'm going to be out of communication for a few days but I can add some more documentation when I get back.  Keshav, if you want to do it before then that would be cool too.  ;-)",
    "created_at": "2012-07-13T19:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150620",
    "user": "https://github.com/roed314"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@jhpalmieri](#comment:35):
> Keshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than "Creates a lazy string by invoking func with args". Maybe just one more sentence like: "A typical usage might be ...". Maybe another sentence like: "Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc."
> 
> And this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.

Makes sense.  I'm going to be out of communication for a few days but I can add some more documentation when I get back.  Keshav, if you want to do it before then that would be cool too.  ;-)



---

archive/issue_comments_150621.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\n(never mind)",
    "created_at": "2012-08-02T15:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150621",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

(never mind)



---

archive/issue_events_180913.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:15:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180913"
}
```



---

archive/issue_events_180914.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:15:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180914"
}
```



---

archive/issue_events_180915.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:16:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180915"
}
```



---

archive/issue_events_180916.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:16:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180916"
}
```



---

archive/issue_comments_150622.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nPing.\n\nI think this just needs a bit of work with the documentation.",
    "created_at": "2012-08-23T18:40:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150622",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:40" align="right">comment:40</div>

Ping.

I think this just needs a bit of work with the documentation.



---

archive/issue_comments_150623.json:
```json
{
    "body": "Adds speaklater.py to sage/misc with doctests.",
    "created_at": "2012-10-17T01:30:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150623",
    "user": "https://github.com/roed314"
}
```

Adds speaklater.py to sage/misc with doctests.



---

archive/issue_comments_150624.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nAttachment: **[13147_new.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch.gz)**\n\nI've rebased against 5.4.rc1 and addressed John's concerns about documentation by adding to the module's docstring.",
    "created_at": "2012-10-17T01:30:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150624",
    "user": "https://github.com/roed314"
}
```

<div id="comment:41" align="right">comment:41</div>

Attachment: **[13147_new.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch.gz)**

I've rebased against 5.4.rc1 and addressed John's concerns about documentation by adding to the module's docstring.



---

archive/issue_comments_150625.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nThis will likely need to be rebased to #13579.",
    "created_at": "2012-10-17T06:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150625",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">comment:42</div>

This will likely need to be rebased to #13579.



---

archive/issue_comments_150626.json:
```json
{
    "body": "Attachment: **[13147_over_13579.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz)**",
    "created_at": "2012-10-17T07:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150626",
    "user": "https://github.com/roed314"
}
```

Attachment: **[13147_over_13579.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz)**



---

archive/issue_comments_150627.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n \n-**Apply** [attachment: 13147_new.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)\n+**Apply** [attachment: 13147_over_13579.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)\n``````\n",
    "created_at": "2012-10-17T07:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150627",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
 
-**Apply** [attachment: 13147_new.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)
+**Apply** [attachment: 13147_over_13579.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)
``````




---

archive/issue_comments_150628.json:
```json
{
    "body": "Dependencies: **#13579**",
    "created_at": "2012-10-17T07:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150628",
    "user": "https://github.com/roed314"
}
```

Dependencies: **#13579**



---

archive/issue_comments_150629.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n \n-**Apply** [attachment: 13147_over_13579.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)\n+**Apply** [attachment: 13147_over_13579.patch](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz) and [attachment: trac_13147-ref.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz).\n``````\n",
    "created_at": "2012-10-18T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150629",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.
 
-**Apply** [attachment: 13147_over_13579.patch.](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)
+**Apply** [attachment: 13147_over_13579.patch](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz) and [attachment: trac_13147-ref.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz).
``````




---

archive/issue_comments_150630.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2012-10-18T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150630",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_180917.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:29:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180917"
}
```



---

archive/issue_events_180918.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:29:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180918"
}
```



---

archive/issue_comments_150631.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nLooks good to me now. I have attached a very small referee patch.\n\nShould Keshav be listed as an author and/or a reviewer?",
    "created_at": "2012-10-18T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150631",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>

Looks good to me now. I have attached a very small referee patch.

Should Keshav be listed as an author and/or a reviewer?



---

archive/issue_events_180919.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180919"
}
```



---

archive/issue_events_180920.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180920"
}
```



---

archive/issue_comments_150632.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nWait, I'm getting some doctest failures. I have to investigate some more.",
    "created_at": "2012-10-18T18:42:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150632",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:45" align="right">comment:45</div>

Wait, I'm getting some doctest failures. I have to investigate some more.



---

archive/issue_events_180921.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180921"
}
```



---

archive/issue_events_180922.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180922"
}
```



---

archive/issue_comments_150633.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nOkay, the problem is the line\n\n```\nreturn os.path.join(SAGE_TMP, 'spyx', os.sep) \n```\nAccording to the documentation for [os.path.join](http://docs.python.org/library/os.path.html#os.path.join):\n\n    If any component is an absolute path, all previous components are thrown away, and joining continues.\n\nSo if you use os.sep (which is '/', an absolute path), everything before that is discarded. I've provided a revised referee's patch to fix this. My changes need review.",
    "created_at": "2012-10-18T20:20:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150633",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:47" align="right">comment:47</div>

Okay, the problem is the line

```
return os.path.join(SAGE_TMP, 'spyx', os.sep) 
```
According to the documentation for [os.path.join](http://docs.python.org/library/os.path.html#os.path.join):

    If any component is an absolute path, all previous components are thrown away, and joining continues.

So if you use os.sep (which is '/', an absolute path), everything before that is discarded. I've provided a revised referee's patch to fix this. My changes need review.



---

archive/issue_events_180923.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-10-19T20:57:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180923"
}
```



---

archive/issue_events_180924.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-10-19T20:57:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180924"
}
```



---

archive/issue_comments_150634.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nJohn, your changes look good to me.",
    "created_at": "2012-10-19T20:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150634",
    "user": "https://github.com/ohanar"
}
```

<div id="comment:48" align="right">comment:48</div>

John, your changes look good to me.



---

archive/issue_events_180925.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-23T07:23:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180925"
}
```



---

archive/issue_events_180926.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-23T07:23:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180926"
}
```



---

archive/issue_comments_150635.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nHas it been verified that removing the trailing slash from SPYX_TMP and SAGE_TMP_INTERFACE doesn't change the functionality of the things using those strings?",
    "created_at": "2012-10-23T14:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150635",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:50" align="right">comment:50</div>

Has it been verified that removing the trailing slash from SPYX_TMP and SAGE_TMP_INTERFACE doesn't change the functionality of the things using those strings?



---

archive/issue_events_180927.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:03:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180927"
}
```



---

archive/issue_events_180928.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:03:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180928"
}
```



---

archive/issue_events_180929.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:06:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180929"
}
```



---

archive/issue_events_180930.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:06:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180930"
}
```



---

archive/issue_comments_150636.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nThe previous version passed doctests, but I see that it modified the behavior slightly because of the missing slash at the end of `SAGE_TMP_INTERFACE`. Here's a new patch. The variables `SPYX_TMP` and `SAGE_TMP_INTERFACE` are not used in local/bin or spkg/, so I think this new patch should take care of things.",
    "created_at": "2012-10-23T16:06:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150636",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:52" align="right">comment:52</div>

The previous version passed doctests, but I see that it modified the behavior slightly because of the missing slash at the end of `SAGE_TMP_INTERFACE`. Here's a new patch. The variables `SPYX_TMP` and `SAGE_TMP_INTERFACE` are not used in local/bin or spkg/, so I think this new patch should take care of things.



---

archive/issue_comments_150637.json:
```json
{
    "body": "Attachment: **[trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)**",
    "created_at": "2012-10-23T18:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150637",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)**



---

archive/issue_comments_150638.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThese are the only two locations that refer to `SPYX_TMP` and `SAGE_TMP_INTERFACE`.  I'm happy that removing the trailing \"/\" won't cause additional problems, though it would be nice if the patchbot would run the tests....",
    "created_at": "2012-10-24T03:46:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150638",
    "user": "https://github.com/roed314"
}
```

<div id="comment:53" align="right">comment:53</div>

These are the only two locations that refer to `SPYX_TMP` and `SAGE_TMP_INTERFACE`.  I'm happy that removing the trailing "/" won't cause additional problems, though it would be nice if the patchbot would run the tests....



---

archive/issue_events_180931.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180931"
}
```



---

archive/issue_events_180932.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180932"
}
```



---

archive/issue_events_180933.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180933"
}
```



---

archive/issue_events_180934.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180934"
}
```



---

archive/issue_events_180935.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T04:22:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180935"
}
```



---

archive/issue_events_180936.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T04:22:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180936"
}
```



---

archive/issue_comments_150639.json:
```json
{
    "body": "Merged: **sage-5.5.beta1**",
    "created_at": "2012-11-01T12:01:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150639",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.5.beta1**



---

archive/issue_events_180937.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:01:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180937"
}
```



---

archive/issue_events_180938.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:01:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180938"
}
```



---

archive/issue_comments_150640.json:
```json
{
    "body": "Changed merged from **sage-5.5.beta1** to none",
    "created_at": "2012-11-03T19:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150640",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-5.5.beta1** to none



---

archive/issue_events_180939.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-03T19:50:22Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180939"
}
```



---

archive/issue_comments_150641.json:
```json
{
    "body": "Changed dependencies from **#13579** to **#13579, #13681**",
    "created_at": "2012-11-03T19:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150641",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13579** to **#13579, #13681**



---

archive/issue_events_180940.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-04T18:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180940"
}
```



---

archive/issue_comments_150642.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nRebased to #13681.",
    "created_at": "2012-11-04T18:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150642",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:59" align="right">comment:59</div>

Rebased to #13681.



---

archive/issue_comments_150643.json:
```json
{
    "body": "Attachment: **[trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz)**",
    "created_at": "2012-11-04T18:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150643",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz)**



---

archive/issue_comments_150644.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n \n-**Apply** [attachment: 13147_over_13579.patch](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz) and [attachment: trac_13147-ref.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz).\n+**Apply** [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n``````\n",
    "created_at": "2012-11-04T18:44:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150644",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.
 
-**Apply** [attachment: 13147_over_13579.patch](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz) and [attachment: trac_13147-ref.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz).
+**Apply** [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
``````




---

archive/issue_events_180941.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-04T18:44:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180941"
}
```



---

archive/issue_events_180942.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-04T18:44:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180942"
}
```



---

archive/issue_comments_150645.json:
```json
{
    "body": "Attachment: **[trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz)**\n\nInitial patch",
    "created_at": "2012-11-05T20:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150645",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz)**

Initial patch



---

archive/issue_comments_150646.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nDoctesting still litters files around than don't get deleted because SAGE_TESTDIR is not a the expected DOT_SAGE/tmp/hostname/pid/. The trac_13681_root.patch fixes this. Bumped from #13681 so we can finally ship Sage-5.4.",
    "created_at": "2012-11-05T20:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150646",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:61" align="right">comment:61</div>

Doctesting still litters files around than don't get deleted because SAGE_TESTDIR is not a the expected DOT_SAGE/tmp/hostname/pid/. The trac_13681_root.patch fixes this. Bumped from #13681 so we can finally ship Sage-5.4.



---

archive/issue_events_180943.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:09:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180943"
}
```



---

archive/issue_events_180944.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:09:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180944"
}
```



---

archive/issue_comments_150647.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n \n-**Apply** [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n+**Apply** \n+* [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n+* [attachment: trac_13681_root.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo\n+\n``````\n",
    "created_at": "2012-11-05T20:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150647",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.
 
-**Apply** [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
+**Apply** 
+* [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
+* [attachment: trac_13681_root.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo
+
``````




---

archive/issue_events_180945.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:10:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180945"
}
```



---

archive/issue_events_180946.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:10:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180946"
}
```



---

archive/issue_comments_150648.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nVolker, can you describe a situation in which doctesting leaves files lying around?",
    "created_at": "2012-11-06T19:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150648",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:63" align="right">comment:63</div>

Volker, can you describe a situation in which doctesting leaves files lying around?



---

archive/issue_comments_150649.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nPretty much always. Just run `make ptest` and you end up with files in `SAGE_TESTDIR`. Perhaps they have to fail an/or be interrupted? I don't remember having to do anything special. Right now I have, for example,\n\n```\n[vbraun@laptop hg]$ ll ~/.sage/tmp/\n-rw-rw-r--. 1 vbraun vbraun  82814 Nov  6 15:04 ring_3259.py\n```",
    "created_at": "2012-11-06T20:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150649",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:64" align="right">comment:64</div>

Pretty much always. Just run `make ptest` and you end up with files in `SAGE_TESTDIR`. Perhaps they have to fail an/or be interrupted? I don't remember having to do anything special. Right now I have, for example,

```
[vbraun@laptop hg]$ ll ~/.sage/tmp/
-rw-rw-r--. 1 vbraun vbraun  82814 Nov  6 15:04 ring_3259.py
```



---

archive/issue_comments_150650.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nFailed doctests are *supposed* to leave files lying around. For example, when I run `sage -tp ...` and there is a failure, I see a message\n\n```\nThe temporary doctesting directory\n   /Users/palmieri/.sage/tmp/jpalmieri538-76123\nwas not removed: it is not empty, presumably because doctests\nfailed or doctesting was interrupted.\n```\nWith your change, the files get left in subdirectories of `tmp/jpalmieri538/` which are then cleaned up the next time Sage runs (or maybe when it exits). Since we have in the past decided to intentionally not delete the failing files, I'm not sure it's appropriate to automatically delete them.\n\nI would suggest moving the Sage root patch and corresponding discussion to #12415, since that ticket modifies the doctesting framework considerably. I think that temporary files are not even created anymore during doctesting with the patches there. (Maybe you can help out with the interrupt issues, too.)",
    "created_at": "2012-11-07T20:39:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150650",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:65" align="right">comment:65</div>

Failed doctests are *supposed* to leave files lying around. For example, when I run `sage -tp ...` and there is a failure, I see a message

```
The temporary doctesting directory
   /Users/palmieri/.sage/tmp/jpalmieri538-76123
was not removed: it is not empty, presumably because doctests
failed or doctesting was interrupted.
```
With your change, the files get left in subdirectories of `tmp/jpalmieri538/` which are then cleaned up the next time Sage runs (or maybe when it exits). Since we have in the past decided to intentionally not delete the failing files, I'm not sure it's appropriate to automatically delete them.

I would suggest moving the Sage root patch and corresponding discussion to #12415, since that ticket modifies the doctesting framework considerably. I think that temporary files are not even created anymore during doctesting with the patches there. (Maybe you can help out with the interrupt issues, too.)



---

archive/issue_comments_150651.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nI see. I do end up with a lot of cruft in `.sage/tmp` though, and I do think that this needs fixing. But its not urgent. So lets do the new doctesting stuff first and see what happens.",
    "created_at": "2012-11-08T00:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150651",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:66" align="right">comment:66</div>

I see. I do end up with a lot of cruft in `.sage/tmp` though, and I do think that this needs fixing. But its not urgent. So lets do the new doctesting stuff first and see what happens.



---

archive/issue_events_180947.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-08T00:50:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180947"
}
```



---

archive/issue_events_180948.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-08T00:50:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180948"
}
```



---

archive/issue_comments_150652.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,4 @@\n \n **Apply** \n * [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n-* [attachment: trac_13681_root.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo\n \n``````\n",
    "created_at": "2012-11-08T00:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150652",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,4 @@
 
 **Apply** 
 * [attachment: trac_13147-rebased-to-13681.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
-* [attachment: trac_13681_root.patch](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo
 
``````




---

archive/issue_events_180949.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-12T21:57:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180949"
}
```



---

archive/issue_events_180950.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-12T21:57:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-180950"
}
```



---

archive/issue_comments_150653.json:
```json
{
    "body": "Merged: **sage-5.5.beta1**",
    "created_at": "2012-11-12T21:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-150653",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.5.beta1**
