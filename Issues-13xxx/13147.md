# Issue 13147: Delay the evaluation of SAGE_TMP in order to facilitate forking in doctesting

archive/issues_012975.json:
```json
{
    "assignees": [],
    "body": "In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n\n**Apply** \n* [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n\n\nDepends on #13579\nDepends on #13681\n\nAssignee: **mvngu**\n\nCC:  @mwhansen\n\nReviewer: **John Palmieri**\n\nAuthor: **David Roe, Mike Hansen**\n\nMerged: **sage-5.5.beta1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13147_\n\n",
    "closed_at": "2012-11-12T21:57:16Z",
    "created_at": "2012-06-21T05:36:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Delay the evaluation of SAGE_TMP in order to facilitate forking in doctesting",
    "type": "issue",
    "updated_at": "2012-11-12T21:57:16Z",
    "url": "https://github.com/sagemath/sage/issues/13147",
    "user": "https://github.com/roed314"
}
```
In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.

**Apply** 
* [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).


Depends on #13579
Depends on #13681

Assignee: **mvngu**

CC:  @mwhansen

Reviewer: **John Palmieri**

Author: **David Roe, Mike Hansen**

Merged: **sage-5.5.beta1**

_Issue created by migration from https://trac.sagemath.org/ticket/13147_





---

archive/issue_events_167322.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167322"
}
```



---

archive/issue_events_167323.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167323"
}
```



---

archive/issue_events_167324.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167324"
}
```



---

archive/issue_events_167325.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167325"
}
```



---

archive/issue_comments_152931.json:
```json
{
    "body": "Attachment: **[13147_move.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_move.patch.gz)**\n\nDavid Roe/Robert Bradshaw's original solution: I don't like it as much as Mike's",
    "created_at": "2012-06-21T05:37:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152931",
    "user": "https://github.com/roed314"
}
```

Attachment: **[13147_move.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_move.patch.gz)**

David Roe/Robert Bradshaw's original solution: I don't like it as much as Mike's



---

archive/issue_comments_152932.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nI like Mike's solution a lot more, but it requires speaklater.  I think this is in the new flasque notebook?  Can we use it from there?",
    "created_at": "2012-06-21T05:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152932",
    "user": "https://github.com/roed314"
}
```

<a id='comment:1'>Comment 1:</a>
I like Mike's solution a lot more, but it requires speaklater.  I think this is in the new flasque notebook?  Can we use it from there?



---

archive/issue_events_167326.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-06-21T05:38:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167326"
}
```



---

archive/issue_comments_152933.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions\n+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n+\n+Apply [attachment: 13147_lazy.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)\n``````\n",
    "created_at": "2012-06-21T05:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152933",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions
+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
+
+Apply [attachment: 13147_lazy.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)
``````




---

archive/issue_comments_152934.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\n+1 for Mike's solution, I know nothing about the flask notebook, but we certainly shouldn't include speaklater in the manner it is done in the patch.\n\nAlso, why are we using temp files and directories in `DOT_SAGE` still, I see no reason to not use the tempfile module with Mike's patch.",
    "created_at": "2012-06-21T06:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152934",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:4'>Comment 4:</a>
+1 for Mike's solution, I know nothing about the flask notebook, but we certainly shouldn't include speaklater in the manner it is done in the patch.

Also, why are we using temp files and directories in `DOT_SAGE` still, I see no reason to not use the tempfile module with Mike's patch.



---

archive/issue_comments_152935.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nWhile you're rewriting the definition of `SAGE_TMP`, you should change lines like\n\n```\nd = '%s/temp/%s/%s/'%(DOT_SAGE, HOSTNAME, os.getpid()) \n```\nto use `os.path.join`.",
    "created_at": "2012-06-21T14:43:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152935",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'>Comment 5:</a>
While you're rewriting the definition of `SAGE_TMP`, you should change lines like

```
d = '%s/temp/%s/%s/'%(DOT_SAGE, HOSTNAME, os.getpid()) 
```
to use `os.path.join`.



---

archive/issue_comments_152936.json:
```json
{
    "body": "Attachment: **[13147_lazy.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch.gz)**\n\nMike Hansen's solution",
    "created_at": "2012-06-21T18:56:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152936",
    "user": "https://github.com/roed314"
}
```

Attachment: **[13147_lazy.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch.gz)**

Mike Hansen's solution



---

archive/issue_comments_152937.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAndrew, are you referring to the fact that Mike creates speaklater.py in the Sage library?",
    "created_at": "2012-06-22T01:39:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152937",
    "user": "https://github.com/kini"
}
```

<a id='comment:6'>Comment 6:</a>
Andrew, are you referring to the fact that Mike creates speaklater.py in the Sage library?



---

archive/issue_comments_152938.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nYeah, I think Andrew's referring to the fact that Mike just included speaklater.\n\npatchbot: apply 13147_lazy.patch.",
    "created_at": "2012-06-22T02:26:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152938",
    "user": "https://github.com/roed314"
}
```

<a id='comment:7'>Comment 7:</a>
Yeah, I think Andrew's referring to the fact that Mike just included speaklater.

patchbot: apply 13147_lazy.patch.



---

archive/issue_comments_152939.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\npatchbot: apply 13147_lazy.patch",
    "created_at": "2012-06-22T02:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152939",
    "user": "https://github.com/kini"
}
```

<a id='comment:8'>Comment 8:</a>
patchbot: apply 13147_lazy.patch



---

archive/issue_comments_152940.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\n`sage/misc/speaklater.py` has no documentation *at all*.\n\nWhy the name `speaklater` and not `lazy_string` (or whatever)?",
    "created_at": "2012-06-25T10:21:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152940",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
`sage/misc/speaklater.py` has no documentation *at all*.

Why the name `speaklater` and not `lazy_string` (or whatever)?



---

archive/issue_events_167327.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-25T10:21:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167327"
}
```



---

archive/issue_events_167328.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-25T10:21:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167328"
}
```



---

archive/issue_comments_152941.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBecause it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater). Obviously we should just depend on speaklater and not incorporate it into the Sage library.",
    "created_at": "2012-06-25T10:30:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152941",
    "user": "https://github.com/kini"
}
```

<a id='comment:10'>Comment 10:</a>
Because it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater). Obviously we should just depend on speaklater and not incorporate it into the Sage library.



---

archive/issue_comments_152942.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@kini](#comment%3A10):\n> Because it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater).\n\nAt the very least, document this fact in the file `speaklater.py`.  Also, you should credit the author and specify the license.",
    "created_at": "2012-06-25T11:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152942",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@kini](#comment%3A10):
> Because it's a file ripped directly from the package [speaklater](https://github.com/mitsuhiko/speaklater).

At the very least, document this fact in the file `speaklater.py`.  Also, you should credit the author and specify the license.



---

archive/issue_comments_152943.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nWhen I wrote that patch, including the speaklater code was just something to get things as a proof of concept.  I didn't think that that code would ever try to go in as is.",
    "created_at": "2012-06-25T12:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152943",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:12'>Comment 12:</a>
When I wrote that patch, including the speaklater code was just something to get things as a proof of concept.  I didn't think that that code would ever try to go in as is.



---

archive/issue_comments_152944.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nIsn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.",
    "created_at": "2012-06-25T15:19:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152944",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'>Comment 13:</a>
Isn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.



---

archive/issue_comments_152945.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@jhpalmieri](#comment%3A13):\n> Isn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.\n\nI think it's philosophically wrong to make Sage depend on the Sage Notebook.  Since it's a small file, I don't mind the duplication much.",
    "created_at": "2012-06-25T15:32:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152945",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@jhpalmieri](#comment%3A13):
> Isn't speaklater included with the new notebook? So this ticket could depend on #11080 and then it would not include a copy of speaklater.py.

I think it's philosophically wrong to make Sage depend on the Sage Notebook.  Since it's a small file, I don't mind the duplication much.



---

archive/issue_comments_152946.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI think it's philosophically wrong for the Sage notebook to depend on Sage: that's the whole point of the notebook project. But Sage can and should depend on its various component packages, so I don't see anything wrong with Sage depending on files included in the sagenb spkg.  But maybe I'm misunderstanding your point.",
    "created_at": "2012-06-25T16:16:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152946",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'>Comment 15:</a>
I think it's philosophically wrong for the Sage notebook to depend on Sage: that's the whole point of the notebook project. But Sage can and should depend on its various component packages, so I don't see anything wrong with Sage depending on files included in the sagenb spkg.  But maybe I'm misunderstanding your point.



---

archive/issue_comments_152947.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nOkay, I think it's wrong to depend on the Sage Notebook for stuff which isn't notebook-related.\n\nI also don't think that `speaklater` should be included in the `sagenb` spkg.  Technically, it probably should be a separate spkg, but that seems way overkill given that it's essentially one small file.",
    "created_at": "2012-06-25T16:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152947",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'>Comment 16:</a>
Okay, I think it's wrong to depend on the Sage Notebook for stuff which isn't notebook-related.

I also don't think that `speaklater` should be included in the `sagenb` spkg.  Technically, it probably should be a separate spkg, but that seems way overkill given that it's essentially one small file.



---

archive/issue_comments_152948.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nI don't think the sagenb spkg should contain a bunch of tarballs either. I think we should start using the package management system from lmonade and steal Gentoo's ebuilds for most of our packages, so there will be very minimal effort required to package additional pieces of software (such as speaklater) for Sage. But that is far off, I guess. At least it will need to be after we drop SPKGs and complete #13015.",
    "created_at": "2012-06-25T18:34:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152948",
    "user": "https://github.com/kini"
}
```

<a id='comment:17'>Comment 17:</a>
I don't think the sagenb spkg should contain a bunch of tarballs either. I think we should start using the package management system from lmonade and steal Gentoo's ebuilds for most of our packages, so there will be very minimal effort required to package additional pieces of software (such as speaklater) for Sage. But that is far off, I guess. At least it will need to be after we drop SPKGs and complete #13015.



---

archive/issue_comments_152949.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nSo what's the plan for this ticket?  The options seem to be:\n\n1. Include speaklater.py with no doctests; include attribution and license.\n2. Include speaklater.py with doctests (I'm not going to write them...); include attribution and license.\n3. Depend on #11080 and import speaklater from sagenb\n4. Make an spkg.\n5. Write a simplified lazy string with doctests.\n\nI think my vote would be for 3.",
    "created_at": "2012-06-28T08:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152949",
    "user": "https://github.com/roed314"
}
```

<a id='comment:18'>Comment 18:</a>
So what's the plan for this ticket?  The options seem to be:

1. Include speaklater.py with no doctests; include attribution and license.
2. Include speaklater.py with doctests (I'm not going to write them...); include attribution and license.
3. Depend on #11080 and import speaklater from sagenb
4. Make an spkg.
5. Write a simplified lazy string with doctests.

I think my vote would be for 3.



---

archive/issue_comments_152950.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nI vote for 1.",
    "created_at": "2012-06-28T08:49:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152950",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'>Comment 19:</a>
I vote for 1.



---

archive/issue_comments_152951.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nI vote for 4.",
    "created_at": "2012-06-28T09:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152951",
    "user": "https://github.com/kini"
}
```

<a id='comment:20'>Comment 20:</a>
I vote for 4.



---

archive/issue_comments_152952.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nHere's an SPKG: http://wstein.org/home/keshav/files/speaklater-1.2-fbc7a37.spkg",
    "created_at": "2012-06-28T09:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152952",
    "user": "https://github.com/kini"
}
```

<a id='comment:21'>Comment 21:</a>
Here's an SPKG: http://wstein.org/home/keshav/files/speaklater-1.2-fbc7a37.spkg



---

archive/issue_comments_152953.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI also vote for the spkg. The one Keshav provided looks fine.",
    "created_at": "2012-06-29T07:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152953",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:22'>Comment 22:</a>
I also vote for the spkg. The one Keshav provided looks fine.



---

archive/issue_comments_152954.json:
```json
{
    "body": "Attachment: **[13147_lazy_spkg.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy_spkg.patch.gz)**\n\nLazy string solution for use with spkg",
    "created_at": "2012-06-29T07:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152954",
    "user": "https://github.com/ohanar"
}
```

Attachment: **[13147_lazy_spkg.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy_spkg.patch.gz)**

Lazy string solution for use with spkg



---

archive/issue_comments_152955.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nWe should also patch deps since this would become a standard SPKG.",
    "created_at": "2012-06-29T08:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152955",
    "user": "https://github.com/kini"
}
```

<a id='comment:23'>Comment 23:</a>
We should also patch deps since this would become a standard SPKG.



---

archive/issue_comments_152956.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nWe also need a vote on sage-devel for the inclusion of speaklater as a standard spkg.  I'm a bit concerned that we'll get objections since\n\n* speaklater has no doctests\n* we haven't made it an optional package first\n* we're adding another dependency of sage\n\nBut I'm happy to be proved wrong.  Keshav and Andrew, do one of you want to write an e-mail to sage-devel or should I?",
    "created_at": "2012-07-03T07:59:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152956",
    "user": "https://github.com/roed314"
}
```

<a id='comment:24'>Comment 24:</a>
We also need a vote on sage-devel for the inclusion of speaklater as a standard spkg.  I'm a bit concerned that we'll get objections since

* speaklater has no doctests
* we haven't made it an optional package first
* we're adding another dependency of sage

But I'm happy to be proved wrong.  Keshav and Andrew, do one of you want to write an e-mail to sage-devel or should I?



---

archive/issue_comments_152957.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\n* Upstream source is not required to have doctests.\n  * speaklater was already included in the flask notebook, so we're really just moving it into its own spkg.\n\nSo I don't think it should be a big deal.",
    "created_at": "2012-07-03T17:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152957",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'>Comment 25:</a>
* Upstream source is not required to have doctests.
  * speaklater was already included in the flask notebook, so we're really just moving it into its own spkg.

So I don't think it should be a big deal.



---

archive/issue_comments_152958.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nReplying to [@roed314](#comment%3A24):\n> * speaklater has no doctests\n\nNot required, as John said.\n\n> * we haven't made it an optional package first\n\nNot really a big deal I think\n\n> * we're adding another dependency of sage\n\nNo we're not - we're including another package in Sage.\n\nBy the way, I asked the author of speaklater on IRC to release a new version containing the fix for the pickling problem we ran across in sagenb many months ago, and a couple of days ago he seems to have released 1.3, so here's a new SPKG: http://wstein.org/home/keshav/files/speaklater-1.3.spkg",
    "created_at": "2012-07-04T03:12:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152958",
    "user": "https://github.com/kini"
}
```

<a id='comment:26'>Comment 26:</a>
Replying to [@roed314](#comment%3A24):
> * speaklater has no doctests

Not required, as John said.

> * we haven't made it an optional package first

Not really a big deal I think

> * we're adding another dependency of sage

No we're not - we're including another package in Sage.

By the way, I asked the author of speaklater on IRC to release a new version containing the fix for the pickling problem we ran across in sagenb many months ago, and a couple of days ago he seems to have released 1.3, so here's a new SPKG: http://wstein.org/home/keshav/files/speaklater-1.3.spkg



---

archive/issue_comments_152959.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nOops, forgot to update SPKG.txt - done now (same URL).",
    "created_at": "2012-07-04T03:14:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152959",
    "user": "https://github.com/kini"
}
```

<a id='comment:27'>Comment 27:</a>
Oops, forgot to update SPKG.txt - done now (same URL).



---

archive/issue_comments_152960.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n \n-Apply [attachment: 13147_lazy.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)\n+**Apply** [attachment: 13147_new.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)\n``````\n",
    "created_at": "2012-07-12T01:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152960",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
 
-Apply [attachment: 13147_lazy.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_lazy.patch..gz)
+**Apply** [attachment: 13147_new.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)
``````




---

archive/issue_comments_152961.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nGiven the opposition to speaklater as an spkg on sage-devel, I've added doctests to speaklater.py, make a couple changes and added it as sage.misc.lazy_string.\n\npatchbot: apply 13147_new.patch",
    "created_at": "2012-07-12T01:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152961",
    "user": "https://github.com/roed314"
}
```

<a id='comment:28'>Comment 28:</a>
Given the opposition to speaklater as an spkg on sage-devel, I've added doctests to speaklater.py, make a couple changes and added it as sage.misc.lazy_string.

patchbot: apply 13147_new.patch



---

archive/issue_events_167329.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T01:22:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167329"
}
```



---

archive/issue_events_167330.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T01:22:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167330"
}
```



---

archive/issue_comments_152962.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nMissed something; I'll fix it in a few hours.",
    "created_at": "2012-07-12T03:40:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152962",
    "user": "https://github.com/roed314"
}
```

<a id='comment:29'>Comment 29:</a>
Missed something; I'll fix it in a few hours.



---

archive/issue_events_167331.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T03:40:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167331"
}
```



---

archive/issue_events_167332.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T03:40:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167332"
}
```



---

archive/issue_comments_152963.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nAlright, fixed.",
    "created_at": "2012-07-12T07:58:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152963",
    "user": "https://github.com/roed314"
}
```

<a id='comment:30'>Comment 30:</a>
Alright, fixed.



---

archive/issue_events_167333.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T07:58:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167333"
}
```



---

archive/issue_events_167334.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-07-12T07:58:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167334"
}
```



---

archive/issue_comments_152964.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nLine 23 of cleaner.py:\n\n```\n    F = os.path.join(misc.SAGE_TMP, 'spawned_processes') \n```\nShould it say `str(SAGE_TMP)`?",
    "created_at": "2012-07-13T16:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152964",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'>Comment 31:</a>
Line 23 of cleaner.py:

```
    F = os.path.join(misc.SAGE_TMP, 'spawned_processes') 
```
Should it say `str(SAGE_TMP)`?



---

archive/issue_comments_152965.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nI think that the file lazy_string.py should have a bit more documentation at the top, for example (from the [speaklater website](https://github.com/mitsuhiko/speaklater):\n\n```\nA module that provides lazy strings for translations. Basically you get an\nobject that appears to be a string but changes the value every time the value\nis evaluated based on a callable you provide.\n```\nA few examples would be nice, too.\n\n(Right now it looks like a typical, underdocumented, Python module (well, it's much better than this because of the doctests you added), whereas it should look like a typical, well-documented, Sage module.)",
    "created_at": "2012-07-13T16:55:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152965",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'>Comment 32:</a>
I think that the file lazy_string.py should have a bit more documentation at the top, for example (from the [speaklater website](https://github.com/mitsuhiko/speaklater):

```
A module that provides lazy strings for translations. Basically you get an
object that appears to be a string but changes the value every time the value
is evaluated based on a callable you provide.
```
A few examples would be nice, too.

(Right now it looks like a typical, underdocumented, Python module (well, it's much better than this because of the doctests you added), whereas it should look like a typical, well-documented, Sage module.)



---

archive/issue_comments_152966.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nAll gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?",
    "created_at": "2012-07-13T16:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152966",
    "user": "https://github.com/kini"
}
```

<a id='comment:33'>Comment 33:</a>
All gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?



---

archive/issue_comments_152967.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nReplying to [@jhpalmieri](#comment%3A31):\n> Line 23 of cleaner.py:\n> \n> ```\n>     F = os.path.join(misc.SAGE_TMP, 'spawned_processes') \n> ```\n> Should it say `str(SAGE_TMP)`?\n\nThere was a typo in Mike's version of `speaklater.py` (`__eq__` was broken); os.path.join now works without the explicit string cast.\n\n`os.path.exists` doesn't though (and I'm not sure exactly why, since I can't find the source code of `os.stat`).",
    "created_at": "2012-07-13T18:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152967",
    "user": "https://github.com/roed314"
}
```

<a id='comment:34'>Comment 34:</a>
Replying to [@jhpalmieri](#comment%3A31):
> Line 23 of cleaner.py:
> 
> ```
>     F = os.path.join(misc.SAGE_TMP, 'spawned_processes') 
> ```
> Should it say `str(SAGE_TMP)`?

There was a typo in Mike's version of `speaklater.py` (`__eq__` was broken); os.path.join now works without the explicit string cast.

`os.path.exists` doesn't though (and I'm not sure exactly why, since I can't find the source code of `os.stat`).



---

archive/issue_comments_152968.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nKeshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than \"Creates a lazy string by invoking func with args\". Maybe just one more sentence like: \"A typical usage might be ...\". Maybe another sentence like: \"Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc.\"\n\nAnd this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.",
    "created_at": "2012-07-13T18:46:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152968",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:35'>Comment 35:</a>
Keshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than "Creates a lazy string by invoking func with args". Maybe just one more sentence like: "A typical usage might be ...". Maybe another sentence like: "Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc."

And this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.



---

archive/issue_comments_152969.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nReplying to [@kini](#comment%3A33):\n> All gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?\n\nI wasn't sure what the `__gettext__` method did; it can be readded if desired.",
    "created_at": "2012-07-13T19:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152969",
    "user": "https://github.com/roed314"
}
```

<a id='comment:36'>Comment 36:</a>
Replying to [@kini](#comment%3A33):
> All gettext stuff has been ripped out, so that exact text is no longer appropriate. Also I see several examples in the docstrings. What did you have in mind? Or did you mean a module-level docstring with one large example set walking you how to use all the functionality of the module?

I wasn't sure what the `__gettext__` method did; it can be readded if desired.



---

archive/issue_comments_152970.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nReplying to [@jhpalmieri](#comment%3A35):\n> Keshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than \"Creates a lazy string by invoking func with args\". Maybe just one more sentence like: \"A typical usage might be ...\". Maybe another sentence like: \"Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc.\"\n> \n> And this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.\n\nMakes sense.  I'm going to be out of communication for a few days but I can add some more documentation when I get back.  Keshav, if you want to do it before then that would be cool too.  ;-)",
    "created_at": "2012-07-13T19:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152970",
    "user": "https://github.com/roed314"
}
```

<a id='comment:37'>Comment 37:</a>
Replying to [@jhpalmieri](#comment%3A35):
> Keshav: I'm thinking that when I read the documentation, either for the whole module or just for `_LazyString` or `lazy_string`, I should see something less terse than "Creates a lazy string by invoking func with args". Maybe just one more sentence like: "A typical usage might be ...". Maybe another sentence like: "Sage uses this code in constructing the path for the directory SAGE_TMP -- see sage.misc.misc."
> 
> And this could either be in the documentation for `lazy_string` or in a module-level docstring. I guess my point is this: I see the docstrings here, and I still have to think for a bit and read the examples to understand what this does and why you might want it. I'd rather not have to think. I also don't know why this is in Sage at all; I certainly think that there is some cruft in the Sage which should be removed, so I'd like to know why this is here. Regarding the existing doctests, they don't quite convince me why I would want to use this instead of just constructing the strings when I need them.

Makes sense.  I'm going to be out of communication for a few days but I can add some more documentation when I get back.  Keshav, if you want to do it before then that would be cool too.  ;-)



---

archive/issue_comments_152971.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\n(never mind)",
    "created_at": "2012-08-02T15:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152971",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'>Comment 38:</a>
(never mind)



---

archive/issue_events_167335.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:15:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167335"
}
```



---

archive/issue_events_167336.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:15:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167336"
}
```



---

archive/issue_events_167337.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:16:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167337"
}
```



---

archive/issue_events_167338.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-02T15:16:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167338"
}
```



---

archive/issue_comments_152972.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nPing.\n\nI think this just needs a bit of work with the documentation.",
    "created_at": "2012-08-23T18:40:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152972",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:40'>Comment 40:</a>
Ping.

I think this just needs a bit of work with the documentation.



---

archive/issue_comments_152973.json:
```json
{
    "body": "Adds speaklater.py to sage/misc with doctests.",
    "created_at": "2012-10-17T01:30:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152973",
    "user": "https://github.com/roed314"
}
```

Adds speaklater.py to sage/misc with doctests.



---

archive/issue_comments_152974.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nAttachment: **[13147_new.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch.gz)**\n\nI've rebased against 5.4.rc1 and addressed John's concerns about documentation by adding to the module's docstring.",
    "created_at": "2012-10-17T01:30:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152974",
    "user": "https://github.com/roed314"
}
```

<a id='comment:41'>Comment 41:</a>
Attachment: **[13147_new.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch.gz)**

I've rebased against 5.4.rc1 and addressed John's concerns about documentation by adding to the module's docstring.



---

archive/issue_comments_152975.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nThis will likely need to be rebased to #13579.",
    "created_at": "2012-10-17T06:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152975",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'>Comment 42:</a>
This will likely need to be rebased to #13579.



---

archive/issue_comments_152976.json:
```json
{
    "body": "Attachment: **[13147_over_13579.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz)**",
    "created_at": "2012-10-17T07:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152976",
    "user": "https://github.com/roed314"
}
```

Attachment: **[13147_over_13579.patch.gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch.gz)**



---

archive/issue_comments_152977.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n \n-**Apply** [attachment: 13147_new.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)\n+**Apply** [attachment: 13147_over_13579.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)\n``````\n",
    "created_at": "2012-10-17T07:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152977",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
 
-**Apply** [attachment: 13147_new.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_new.patch..gz)
+**Apply** [attachment: 13147_over_13579.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)
``````




---

archive/issue_comments_152978.json:
```json
{
    "body": "Dependencies: **#13579**",
    "created_at": "2012-10-17T07:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152978",
    "user": "https://github.com/roed314"
}
```

Dependencies: **#13579**



---

archive/issue_comments_152979.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.\n+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n \n-**Apply** [attachment: 13147_over_13579.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)\n+**Apply** [and [attachment: trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)(https://github.com/sagemath/sage/files/ticket13147/8b00abe37764e05e0ee791243eff2cc1.gz).\n``````\n",
    "created_at": "2012-10-18T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152979",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.  Here are two potential solutions.
+In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.
 
-**Apply** [attachment: 13147_over_13579.patch..gz](https://github.com/sagemath/sage/files/ticket13147/13147_over_13579.patch..gz)
+**Apply** [and [attachment: trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)(https://github.com/sagemath/sage/files/ticket13147/8b00abe37764e05e0ee791243eff2cc1.gz).
``````




---

archive/issue_comments_152980.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2012-10-18T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152980",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_167339.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:29:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167339"
}
```



---

archive/issue_events_167340.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:29:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167340"
}
```



---

archive/issue_comments_152981.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nLooks good to me now. I have attached a very small referee patch.\n\nShould Keshav be listed as an author and/or a reviewer?",
    "created_at": "2012-10-18T18:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152981",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'>Comment 44:</a>
Looks good to me now. I have attached a very small referee patch.

Should Keshav be listed as an author and/or a reviewer?



---

archive/issue_events_167341.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167341"
}
```



---

archive/issue_events_167342.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167342"
}
```



---

archive/issue_comments_152982.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nWait, I'm getting some doctest failures. I have to investigate some more.",
    "created_at": "2012-10-18T18:42:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152982",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:45'>Comment 45:</a>
Wait, I'm getting some doctest failures. I have to investigate some more.



---

archive/issue_events_167343.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167343"
}
```



---

archive/issue_events_167344.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-18T18:42:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167344"
}
```



---

archive/issue_comments_152983.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nOkay, the problem is the line\n\n```\nreturn os.path.join(SAGE_TMP, 'spyx', os.sep) \n```\nAccording to the documentation for [os.path.join](http://docs.python.org/library/os.path.html#os.path.join):\n\n    If any component is an absolute path, all previous components are thrown away, and joining continues.\n\nSo if you use os.sep (which is '/', an absolute path), everything before that is discarded. I've provided a revised referee's patch to fix this. My changes need review.",
    "created_at": "2012-10-18T20:20:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152983",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:47'>Comment 47:</a>
Okay, the problem is the line

```
return os.path.join(SAGE_TMP, 'spyx', os.sep) 
```
According to the documentation for [os.path.join](http://docs.python.org/library/os.path.html#os.path.join):

    If any component is an absolute path, all previous components are thrown away, and joining continues.

So if you use os.sep (which is '/', an absolute path), everything before that is discarded. I've provided a revised referee's patch to fix this. My changes need review.



---

archive/issue_events_167345.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-10-19T20:57:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167345"
}
```



---

archive/issue_events_167346.json:
```json
{
    "actor": "https://github.com/ohanar",
    "created_at": "2012-10-19T20:57:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167346"
}
```



---

archive/issue_comments_152984.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nJohn, your changes look good to me.",
    "created_at": "2012-10-19T20:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152984",
    "user": "https://github.com/ohanar"
}
```

<a id='comment:48'>Comment 48:</a>
John, your changes look good to me.



---

archive/issue_events_167347.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-23T07:23:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167347"
}
```



---

archive/issue_events_167348.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-23T07:23:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167348"
}
```



---

archive/issue_comments_152985.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nHas it been verified that removing the trailing slash from SPYX_TMP and SAGE_TMP_INTERFACE doesn't change the functionality of the things using those strings?",
    "created_at": "2012-10-23T14:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152985",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'>Comment 50:</a>
Has it been verified that removing the trailing slash from SPYX_TMP and SAGE_TMP_INTERFACE doesn't change the functionality of the things using those strings?



---

archive/issue_events_167349.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:03:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167349"
}
```



---

archive/issue_events_167350.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:03:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167350"
}
```



---

archive/issue_events_167351.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:06:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167351"
}
```



---

archive/issue_events_167352.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-23T16:06:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167352"
}
```



---

archive/issue_comments_152986.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nThe previous version passed doctests, but I see that it modified the behavior slightly because of the missing slash at the end of `SAGE_TMP_INTERFACE`. Here's a new patch. The variables `SPYX_TMP` and `SAGE_TMP_INTERFACE` are not used in local/bin or spkg/, so I think this new patch should take care of things.",
    "created_at": "2012-10-23T16:06:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152986",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:52'>Comment 52:</a>
The previous version passed doctests, but I see that it modified the behavior slightly because of the missing slash at the end of `SAGE_TMP_INTERFACE`. Here's a new patch. The variables `SPYX_TMP` and `SAGE_TMP_INTERFACE` are not used in local/bin or spkg/, so I think this new patch should take care of things.



---

archive/issue_comments_152987.json:
```json
{
    "body": "Attachment: **[trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)**",
    "created_at": "2012-10-23T18:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152987",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)**



---

archive/issue_comments_152988.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nThese are the only two locations that refer to `SPYX_TMP` and `SAGE_TMP_INTERFACE`.  I'm happy that removing the trailing \"/\" won't cause additional problems, though it would be nice if the patchbot would run the tests....",
    "created_at": "2012-10-24T03:46:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152988",
    "user": "https://github.com/roed314"
}
```

<a id='comment:53'>Comment 53:</a>
These are the only two locations that refer to `SPYX_TMP` and `SAGE_TMP_INTERFACE`.  I'm happy that removing the trailing "/" won't cause additional problems, though it would be nice if the patchbot would run the tests....



---

archive/issue_events_167353.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167353"
}
```



---

archive/issue_events_167354.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167354"
}
```



---

archive/issue_events_167355.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167355"
}
```



---

archive/issue_events_167356.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T03:46:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167356"
}
```



---

archive/issue_events_167357.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T04:22:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167357"
}
```



---

archive/issue_events_167358.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-10-24T04:22:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "milestone_number": null,
    "milestone_title": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167358"
}
```



---

archive/issue_comments_152989.json:
```json
{
    "body": "Merged: **sage-5.5.beta1**",
    "created_at": "2012-11-01T12:01:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152989",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.5.beta1**



---

archive/issue_events_167359.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:01:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167359"
}
```



---

archive/issue_events_167360.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:01:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167360"
}
```



---

archive/issue_comments_152990.json:
```json
{
    "body": "Changed merged from **sage-5.5.beta1** to none",
    "created_at": "2012-11-03T19:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152990",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-5.5.beta1** to none



---

archive/issue_comments_152991.json:
```json
{
    "body": "Changed dependencies from **#13579** to **#13579, #13681**",
    "created_at": "2012-11-03T19:52:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152991",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#13579** to **#13579, #13681**



---

archive/issue_events_167361.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-04T18:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167361"
}
```



---

archive/issue_comments_152992.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nRebased to #13681.",
    "created_at": "2012-11-04T18:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152992",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:59'>Comment 59:</a>
Rebased to #13681.



---

archive/issue_comments_152993.json:
```json
{
    "body": "Attachment: **[trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz)**",
    "created_at": "2012-11-04T18:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152993",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz)**



---

archive/issue_comments_152994.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n \n-**Apply** [and [attachment: trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)(https://github.com/sagemath/sage/files/ticket13147/8b00abe37764e05e0ee791243eff2cc1.gz).\n+**Apply** [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n``````\n",
    "created_at": "2012-11-04T18:44:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152994",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.
 
-**Apply** [and [attachment: trac_13147-ref.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-ref.patch.gz)(https://github.com/sagemath/sage/files/ticket13147/8b00abe37764e05e0ee791243eff2cc1.gz).
+**Apply** [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
``````




---

archive/issue_events_167362.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-04T18:44:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167362"
}
```



---

archive/issue_events_167363.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-11-04T18:44:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167363"
}
```



---

archive/issue_comments_152995.json:
```json
{
    "body": "Attachment: **[trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz)**\n\nInitial patch",
    "created_at": "2012-11-05T20:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152995",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz)**

Initial patch



---

archive/issue_comments_152996.json:
```json
{
    "body": "<a id='comment:61'>Comment 61:</a>\nDoctesting still litters files around than don't get deleted because SAGE_TESTDIR is not a the expected DOT_SAGE/tmp/hostname/pid/. The trac_13681_root.patch fixes this. Bumped from #13681 so we can finally ship Sage-5.4.",
    "created_at": "2012-11-05T20:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152996",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:61'>Comment 61:</a>
Doctesting still litters files around than don't get deleted because SAGE_TESTDIR is not a the expected DOT_SAGE/tmp/hostname/pid/. The trac_13681_root.patch fixes this. Bumped from #13681 so we can finally ship Sage-5.4.



---

archive/issue_events_167364.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:09:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167364"
}
```



---

archive/issue_events_167365.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:09:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167365"
}
```



---

archive/issue_comments_152997.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.\n \n-**Apply** [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n+**Apply** \n+* [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n+* [attachment: trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo\n+\n``````\n",
    "created_at": "2012-11-05T20:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152997",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 In order to use multiprocessing in the new doctesting framework (#12415), sage's infrastructure for dealing with temporary files needs to change.
 
-**Apply** [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
+**Apply** 
+* [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
+* [attachment: trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo
+
``````




---

archive/issue_events_167366.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:10:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167366"
}
```



---

archive/issue_events_167367.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:10:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167367"
}
```



---

archive/issue_comments_152998.json:
```json
{
    "body": "<a id='comment:63'>Comment 63:</a>\nVolker, can you describe a situation in which doctesting leaves files lying around?",
    "created_at": "2012-11-06T19:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152998",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:63'>Comment 63:</a>
Volker, can you describe a situation in which doctesting leaves files lying around?



---

archive/issue_comments_152999.json:
```json
{
    "body": "<a id='comment:64'>Comment 64:</a>\nPretty much always. Just run `make ptest` and you end up with files in `SAGE_TESTDIR`. Perhaps they have to fail an/or be interrupted? I don't remember having to do anything special. Right now I have, for example,\n\n```\n[vbraun@laptop hg]$ ll ~/.sage/tmp/\n-rw-rw-r--. 1 vbraun vbraun  82814 Nov  6 15:04 ring_3259.py\n```",
    "created_at": "2012-11-06T20:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-152999",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:64'>Comment 64:</a>
Pretty much always. Just run `make ptest` and you end up with files in `SAGE_TESTDIR`. Perhaps they have to fail an/or be interrupted? I don't remember having to do anything special. Right now I have, for example,

```
[vbraun@laptop hg]$ ll ~/.sage/tmp/
-rw-rw-r--. 1 vbraun vbraun  82814 Nov  6 15:04 ring_3259.py
```



---

archive/issue_comments_153000.json:
```json
{
    "body": "<a id='comment:65'>Comment 65:</a>\nFailed doctests are *supposed* to leave files lying around. For example, when I run `sage -tp ...` and there is a failure, I see a message\n\n```\nThe temporary doctesting directory\n   /Users/palmieri/.sage/tmp/jpalmieri538-76123\nwas not removed: it is not empty, presumably because doctests\nfailed or doctesting was interrupted.\n```\nWith your change, the files get left in subdirectories of `tmp/jpalmieri538/` which are then cleaned up the next time Sage runs (or maybe when it exits). Since we have in the past decided to intentionally not delete the failing files, I'm not sure it's appropriate to automatically delete them.\n\nI would suggest moving the Sage root patch and corresponding discussion to #12415, since that ticket modifies the doctesting framework considerably. I think that temporary files are not even created anymore during doctesting with the patches there. (Maybe you can help out with the interrupt issues, too.)",
    "created_at": "2012-11-07T20:39:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-153000",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:65'>Comment 65:</a>
Failed doctests are *supposed* to leave files lying around. For example, when I run `sage -tp ...` and there is a failure, I see a message

```
The temporary doctesting directory
   /Users/palmieri/.sage/tmp/jpalmieri538-76123
was not removed: it is not empty, presumably because doctests
failed or doctesting was interrupted.
```
With your change, the files get left in subdirectories of `tmp/jpalmieri538/` which are then cleaned up the next time Sage runs (or maybe when it exits). Since we have in the past decided to intentionally not delete the failing files, I'm not sure it's appropriate to automatically delete them.

I would suggest moving the Sage root patch and corresponding discussion to #12415, since that ticket modifies the doctesting framework considerably. I think that temporary files are not even created anymore during doctesting with the patches there. (Maybe you can help out with the interrupt issues, too.)



---

archive/issue_comments_153001.json:
```json
{
    "body": "<a id='comment:66'>Comment 66:</a>\nI see. I do end up with a lot of cruft in `.sage/tmp` though, and I do think that this needs fixing. But its not urgent. So lets do the new doctesting stuff first and see what happens.",
    "created_at": "2012-11-08T00:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-153001",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:66'>Comment 66:</a>
I see. I do end up with a lot of cruft in `.sage/tmp` though, and I do think that this needs fixing. But its not urgent. So lets do the new doctesting stuff first and see what happens.



---

archive/issue_events_167368.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-08T00:50:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167368"
}
```



---

archive/issue_events_167369.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-08T00:50:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167369"
}
```



---

archive/issue_comments_153002.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,4 @@\n \n **Apply** \n * [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).\n-* [attachment: trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo\n \n``````\n",
    "created_at": "2012-11-08T00:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-153002",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,4 @@
 
 **Apply** 
 * [attachment: trac_13147-rebased-to-13681.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13147-rebased-to-13681.patch.gz).
-* [attachment: trac_13681_root.patch.gz](https://github.com/sagemath/sage/files/ticket13147/trac_13681_root.patch.gz) to the root repo
 
``````




---

archive/issue_events_167370.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-12T21:57:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167370"
}
```



---

archive/issue_events_167371.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-12T21:57:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13147#event-167371"
}
```



---

archive/issue_comments_153003.json:
```json
{
    "body": "Merged: **sage-5.5.beta1**",
    "created_at": "2012-11-12T21:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13147#issuecomment-153003",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.5.beta1**
