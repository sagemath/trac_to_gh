# Issue 13055: Refactor numerical_approx()

archive/issues_012883.json:
```json
{
    "body": "Drop the `_numerical_approx` method, instead use `numerical_approx`. Move the generic implementation to a new Cython file. Also put the conversion of decimal digits to bits in one place.\n\nFinally, the documentation of `numerical_approx` should be made more clear and consistent.\n\n\nAssignee: @burcin\n\nCC:  benjaminjones\n\nKeywords: numerical_approx, sd40.5, days74\n\nBranch/Commit: fd79227f589f50f190066f7e636356007544b556\n\nReviewer: Marc Mezzarobba\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13055\n\n",
    "closed_at": "2016-08-07T20:00:14Z",
    "created_at": "2012-05-29T03:27:40Z",
    "labels": [
        "component: basic arithmetic",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Refactor numerical_approx()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13055",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```
Drop the `_numerical_approx` method, instead use `numerical_approx`. Move the generic implementation to a new Cython file. Also put the conversion of decimal digits to bits in one place.

Finally, the documentation of `numerical_approx` should be made more clear and consistent.


Assignee: @burcin

CC:  benjaminjones

Keywords: numerical_approx, sd40.5, days74

Branch/Commit: fd79227f589f50f190066f7e636356007544b556

Reviewer: Marc Mezzarobba

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13055





---

archive/issue_comments_164720.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -23,9 +23,7 @@\n Real Field with 200 bits of precision\n \\`\\`\\`\n \n-This might not seem that significant -- we could interpret \"n\" as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get hold=True to behave nicely. I'd prefer that f(1.2345678901234567890) give the same answer as f(1.2345678901234567890, hold=True).n(), especially now that we typically get the precision from the parent.\n-\n-Keywords: numerical_approx\n+This might not seem that significant -- we could interpret \"n\" as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get hold=True to behave nicely. I'd prefer that \\`f(1.2345678901234567890)\\` give the same answer as \\`f(1.2345678901234567890, hold=True).n()\\`, especially now that we typically get the precision from the parent.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-05-29T03:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164720",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

Description changed:
```diff
--- 
+++ 
@@ -23,9 +23,7 @@
 Real Field with 200 bits of precision
 \`\`\`
 
-This might not seem that significant -- we could interpret "n" as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get hold=True to behave nicely. I'd prefer that f(1.2345678901234567890) give the same answer as f(1.2345678901234567890, hold=True).n(), especially now that we typically get the precision from the parent.
-
-Keywords: numerical_approx
+This might not seem that significant -- we could interpret "n" as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get hold=True to behave nicely. I'd prefer that \`f(1.2345678901234567890)\` give the same answer as \`f(1.2345678901234567890, hold=True).n()\`, especially now that we typically get the precision from the parent.
 
 Comment: 1
 
```




---

archive/issue_comments_164721.json:
```json
{
    "body": "Changing keywords from \"numerical_approx\" to \"numerical_approx, sd40.5\".",
    "created_at": "2012-05-29T03:43:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164721",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

Changing keywords from "numerical_approx" to "numerical_approx, sd40.5".



---

archive/issue_events_035804.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35804"
}
```



---

archive/issue_events_035805.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35805"
}
```



---

archive/issue_events_035806.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35806"
}
```



---

archive/issue_events_035807.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35807"
}
```



---

archive/issue_events_035808.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35808"
}
```



---

archive/issue_events_035809.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35809"
}
```



---

archive/issue_events_035810.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35810"
}
```



---

archive/issue_comments_164722.json:
```json
{
    "body": "<a id='comment:7'></a>I doubt that this is a bug. How would you guess the default precision for the `.n()` method?",
    "created_at": "2014-11-27T19:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164722",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>I doubt that this is a bug. How would you guess the default precision for the `.n()` method?



---

archive/issue_comments_164723.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,28 @@\n+By going via SR we can lose precision when using numerical_approx:\n \n+\\`\\`\\`\n+sage: p\n+3.1415926535897932384626433832795028841971693993751058209749\n+sage: parent(p)\n+Real Field with 200 bits of precision\n+sage: SR(p)\n+3.1415926535897932384626433832795028841971693993751058209749\n+sage: SR(p).n()\n+3.14159265358979\n+sage: parent(SR(p).n())\n+Real Field with 53 bits of precision\n+\\`\\`\\`\n+\n+The information is still there, though (as is obvious from the fact the string produced has all those extra digits):\n+\n+\\`\\`\\`\n+sage: SR(p).pyobject()\n+3.1415926535897932384626433832795028841971693993751058209749\n+sage: parent(SR(p).pyobject())\n+Real Field with 200 bits of precision\n+\\`\\`\\`\n+\n+This might not seem that significant -- we could interpret \"n\" as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get hold=True to behave nicely. I'd prefer that \\`f(1.2345678901234567890)\\` give the same answer as \\`f(1.2345678901234567890, hold=True).n()\\`, especially now that we typically get the precision from the parent.\n \n Comment: 1\n \n```\n",
    "created_at": "2014-11-27T19:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164723",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,28 @@
+By going via SR we can lose precision when using numerical_approx:
 
+\`\`\`
+sage: p
+3.1415926535897932384626433832795028841971693993751058209749
+sage: parent(p)
+Real Field with 200 bits of precision
+sage: SR(p)
+3.1415926535897932384626433832795028841971693993751058209749
+sage: SR(p).n()
+3.14159265358979
+sage: parent(SR(p).n())
+Real Field with 53 bits of precision
+\`\`\`
+
+The information is still there, though (as is obvious from the fact the string produced has all those extra digits):
+
+\`\`\`
+sage: SR(p).pyobject()
+3.1415926535897932384626433832795028841971693993751058209749
+sage: parent(SR(p).pyobject())
+Real Field with 200 bits of precision
+\`\`\`
+
+This might not seem that significant -- we could interpret "n" as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get hold=True to behave nicely. I'd prefer that \`f(1.2345678901234567890)\` give the same answer as \`f(1.2345678901234567890, hold=True).n()\`, especially now that we typically get the precision from the parent.
 
 Comment: 1
 
```




---

archive/issue_comments_164724.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n+We can lose precision when using \\`numerical_approx\\`:\n \n+\\`\\`\\`\n+sage: p = pi.n(200)\n+sage: p\n+3.1415926535897932384626433832795028841971693993751058209749\n+sage: p.numerical_approx()\n+3.14159265358979\n+\\`\\`\\`\n+\n+This might not seem that significant -- we could interpret \\`.n()\\` as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get \\`hold=True\\` for symbolics to behave nicely. I'd prefer that \\`f(1.2345678901234567890)\\` gives the same answer as \\`f(1.2345678901234567890, hold=True).n()\\`, especially now that we typically get the precision from the parent.\n+\n+Related: #16025\n \n Comment: 1\n \n```\n",
    "created_at": "2014-11-27T21:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164724",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,16 @@
+We can lose precision when using \`numerical_approx\`:
 
+\`\`\`
+sage: p = pi.n(200)
+sage: p
+3.1415926535897932384626433832795028841971693993751058209749
+sage: p.numerical_approx()
+3.14159265358979
+\`\`\`
+
+This might not seem that significant -- we could interpret \`.n()\` as always defaulting to 53 bits unless specified otherwise -- but it can cause some headaches when trying to get \`hold=True\` for symbolics to behave nicely. I'd prefer that \`f(1.2345678901234567890)\` gives the same answer as \`f(1.2345678901234567890, hold=True).n()\`, especially now that we typically get the precision from the parent.
+
+Related: #16025
 
 Comment: 1
 
```




---

archive/issue_comments_164725.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2014-11-27T21:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164725",
    "user": "https://github.com/jdemeyer"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_164726.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-27T21:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164726",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_events_035811.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-27T21:15:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35811"
}
```



---

archive/issue_events_035812.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-27T21:15:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35812"
}
```



---

archive/issue_comments_164727.json:
```json
{
    "body": "<a id='comment:11'></a>Hmm, I'm not sure this is wontfix, though.  I'm sympathetic to your argument, but Doug's point that\n\n```\nsage: sin(1.2345678901234567890)\n0.9440057250452665781\nsage: sin(1.2345678901234567890).n()\n0.944005725045267\n```\nseems good; you shouldn't *lose* precision, should you?  (Forget about hold!)",
    "created_at": "2014-12-04T03:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164727",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>Hmm, I'm not sure this is wontfix, though.  I'm sympathetic to your argument, but Doug's point that

```
sage: sin(1.2345678901234567890)
0.9440057250452665781
sage: sin(1.2345678901234567890).n()
0.944005725045267
```
seems good; you shouldn't *lose* precision, should you?  (Forget about hold!)



---

archive/issue_comments_164728.json:
```json
{
    "body": "<a id='comment:12'></a>Losing precision is a *feature* of the `.n()` method, that's what it does. The `x.n()` method asks for a *numerical approximation* of `x` to a precision of 53 bits. This is easily explained. I also like the fact that neither the implementation nor the user should need to worry about what `x` is, the output is a real/complex number with 53 bits of precision.\n\nIf you think that `.n()` is wrong, what should `(2/3).n()` return then? The only possible answer which doesn't lose precision is the rational 2/3.",
    "created_at": "2014-12-04T07:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164728",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Losing precision is a *feature* of the `.n()` method, that's what it does. The `x.n()` method asks for a *numerical approximation* of `x` to a precision of 53 bits. This is easily explained. I also like the fact that neither the implementation nor the user should need to worry about what `x` is, the output is a real/complex number with 53 bits of precision.

If you think that `.n()` is wrong, what should `(2/3).n()` return then? The only possible answer which doesn't lose precision is the rational 2/3.



---

archive/issue_comments_164729.json:
```json
{
    "body": "<a id='comment:13'></a>About `hold=True`, that even doesn't seem to work with real numbers:\n\n```\nsage: gamma(1.2345678901234567890, hold=True)\n0.9097200568693150729\n```",
    "created_at": "2014-12-04T07:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164729",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>About `hold=True`, that even doesn't seem to work with real numbers:

```
sage: gamma(1.2345678901234567890, hold=True)
0.9097200568693150729
```



---

archive/issue_events_035813.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-04T14:23:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35813"
}
```



---

archive/issue_events_035814.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-12-04T14:23:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35814"
}
```



---

archive/issue_comments_164730.json:
```json
{
    "body": "<a id='comment:14'></a>> About `hold=True`, that even doesn't seem to work with real numbers:\n\nExactly, which is why I didn't use that example.\n\nOkay, I don't have that much invested in this.   But then \n\n```\nsage: x = 1.2340000000000000000000001\nsage: x.n?\nDocstring:\n   Return a numerical approximation of x with at least prec bits of\n   precision.\n\n   EXAMPLES:\n\n      sage: (2/3).n()\n      0.666666666666667\n      sage: pi.n(digits=10)\n      3.141592654\n      sage: pi.n(prec=20)   # 20 bits\n      3.1416\n\n   TESTS:\n\n   Check that http://trac.sagemath.org/14778 is fixed:\n\n      sage: (0).n(algorithm='foo')\n      0.000000000000000\n```\nshould really be improved, and possibly the documentation for other versions of `.numerical_approx` as well.  Those are practically stubs!",
    "created_at": "2014-12-04T14:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164730",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'></a>> About `hold=True`, that even doesn't seem to work with real numbers:

Exactly, which is why I didn't use that example.

Okay, I don't have that much invested in this.   But then 

```
sage: x = 1.2340000000000000000000001
sage: x.n?
Docstring:
   Return a numerical approximation of x with at least prec bits of
   precision.

   EXAMPLES:

      sage: (2/3).n()
      0.666666666666667
      sage: pi.n(digits=10)
      3.141592654
      sage: pi.n(prec=20)   # 20 bits
      3.1416

   TESTS:

   Check that http://trac.sagemath.org/14778 is fixed:

      sage: (0).n(algorithm='foo')
      0.000000000000000
```
should really be improved, and possibly the documentation for other versions of `.numerical_approx` as well.  Those are practically stubs!



---

archive/issue_comments_164731.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-04T14:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164731",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_164732.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2014-12-04T14:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164732",
    "user": "https://github.com/kcrisman"
}
```

Changing priority from major to minor.



---

archive/issue_comments_164733.json:
```json
{
    "body": "Changing component from symbolics to documentation.",
    "created_at": "2014-12-25T09:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164733",
    "user": "https://github.com/rwst"
}
```

Changing component from symbolics to documentation.



---

archive/issue_comments_164734.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:14 kcrisman]:\n> Okay, I don't have that much invested in this.   But then `x.n?`\n> should really be improved, and possibly the documentation for other versions of `.numerical_approx` as well.  Those are practically stubs!\n\n\nThis is actually a general problem we have with Sage documentation: often one has similar functions/methods which all do the same thing (on different kinds of objects). In this case, the `numerical_approx` function in `src/sage/misc/functional.py` is much better documented. What's the optimal solution which doesn't simply replicate the documentation from `numerical_approx()`?",
    "created_at": "2015-03-09T10:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164734",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>Replying to [comment:14 kcrisman]:
> Okay, I don't have that much invested in this.   But then `x.n?`
> should really be improved, and possibly the documentation for other versions of `.numerical_approx` as well.  Those are practically stubs!


This is actually a general problem we have with Sage documentation: often one has similar functions/methods which all do the same thing (on different kinds of objects). In this case, the `numerical_approx` function in `src/sage/misc/functional.py` is much better documented. What's the optimal solution which doesn't simply replicate the documentation from `numerical_approx()`?



---

archive/issue_comments_164735.json:
```json
{
    "body": "<a id='comment:17'></a>One other detail which is wrong in the \"at least\" in \"at least prec bits of precision\". Certainly for the global `numerical_approx()` function, it's **exactly** `prec` bits.",
    "created_at": "2015-03-09T10:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164735",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>One other detail which is wrong in the "at least" in "at least prec bits of precision". Certainly for the global `numerical_approx()` function, it's **exactly** `prec` bits.



---

archive/issue_comments_164736.json:
```json
{
    "body": "Changing keywords from \"numerical_approx, sd40.5\" to \"numerical_approx, sd40.5, days74\".",
    "created_at": "2016-06-01T10:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164736",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "numerical_approx, sd40.5" to "numerical_approx, sd40.5, days74".



---

archive/issue_events_035815.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-01T10:00:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35815"
}
```



---

archive/issue_events_035816.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-01T10:00:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35816"
}
```



---

archive/issue_comments_164737.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+The documentation of \\`numerical_approx\\` should be made more clear.\n \n Comment: 1\n \n```\n",
    "created_at": "2016-06-01T10:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164737",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+The documentation of \`numerical_approx\` should be made more clear.
 
 Comment: 1
 
```




---

archive/issue_comments_164738.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+The documentation of \\`numerical_approx\\` should be made more clear.\n \n+We also refactor the code a bit to make it simpler. In particular, we change \\`_numerical_approx\\` by \\`numerical_approx\\` everywhere.\n \n Comment: 1\n \n```\n",
    "created_at": "2016-06-01T10:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164738",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+The documentation of \`numerical_approx\` should be made more clear.
 
+We also refactor the code a bit to make it simpler. In particular, we change \`_numerical_approx\` by \`numerical_approx\` everywhere.
 
 Comment: 1
 
```




---

archive/issue_comments_164739.json:
```json
{
    "body": "Changing component from documentation to basic arithmetic.",
    "created_at": "2016-06-01T12:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164739",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from documentation to basic arithmetic.



---

archive/issue_comments_164740.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n+Drop the \\`_numerical_approx\\` method, instead use \\`numerical_approx\\`. Move the generic implementation to a new Cython file. Also put the conversion of decimal digits to bits in one place.\n+\n+Finally, the documentation of \\`numerical_approx\\` should be made more clear and consistent.\n \n \n Comment: 1\n```\n",
    "created_at": "2016-06-01T12:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164740",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,6 @@
+Drop the \`_numerical_approx\` method, instead use \`numerical_approx\`. Move the generic implementation to a new Cython file. Also put the conversion of decimal digits to bits in one place.
+
+Finally, the documentation of \`numerical_approx\` should be made more clear and consistent.
 
 
 Comment: 1
```




---

archive/issue_comments_164741.json:
```json
{
    "body": "<a id='comment:23'></a>New commits:",
    "created_at": "2016-06-01T14:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164741",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>New commits:



---

archive/issue_comments_164742.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-06-01T14:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164742",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_164743.json:
```json
{
    "body": "<a id='comment:24'></a>Most of the changes look good to me, but I don't like the new description of `RealLiteral.numerical_approx()`: as far as I understand \u201creal literals\u201d are exact decimal numbers, so converting one to a `RealField` element with d\u00b7log\u2081\u2080\u00a02 bits of precision doesn't really \u201cchange its precision\u201d to d decimal digits.\n\nAnd\u2014just wondering, I have nothing against that choice\u2014is there a reason why you didn't put the generic implementation directly in `Element` (and put code to convert non-Elements to Elements before calling it when necessary)?",
    "created_at": "2016-06-02T10:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164743",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:24'></a>Most of the changes look good to me, but I don't like the new description of `RealLiteral.numerical_approx()`: as far as I understand “real literals” are exact decimal numbers, so converting one to a `RealField` element with d·log₁₀ 2 bits of precision doesn't really “change its precision” to d decimal digits.

And—just wondering, I have nothing against that choice—is there a reason why you didn't put the generic implementation directly in `Element` (and put code to convert non-Elements to Elements before calling it when necessary)?



---

archive/issue_comments_164744.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 mmezzarobba]:\n> is there a reason why you didn't put the generic implementation directly in `Element` (and put code to convert non-Elements to Elements before calling it when necessary)?\n\n\nBecause of the \"put code to convert non-Elements to Elements before calling it\" part. I don't know how to do that in general.",
    "created_at": "2016-06-02T11:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164744",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Replying to [comment:24 mmezzarobba]:
> is there a reason why you didn't put the generic implementation directly in `Element` (and put code to convert non-Elements to Elements before calling it when necessary)?


Because of the "put code to convert non-Elements to Elements before calling it" part. I don't know how to do that in general.



---

archive/issue_comments_164745.json:
```json
{
    "body": "<a id='comment:26'></a>**ping**",
    "created_at": "2016-08-01T11:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164745",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>**ping**



---

archive/issue_comments_164746.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-08-02T06:13:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164746",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_164747.json:
```json
{
    "body": "<a id='comment:28'></a>I still disagree about the docstring of `RealLiteral.numerical_approx()`, but let's not again delay the ticket by two months...",
    "created_at": "2016-08-04T09:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164747",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:28'></a>I still disagree about the docstring of `RealLiteral.numerical_approx()`, but let's not again delay the ticket by two months...



---

archive/issue_comments_164748.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-04T09:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164748",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_035817.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-07T20:00:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13055#event-35817"
}
```



---

archive/issue_comments_164749.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-07T20:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13055",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13055#issuecomment-164749",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
