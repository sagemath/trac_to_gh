# Issue 13762: Implement k-bounded quotient space

archive/issues_013558.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-chrisjamesberg"
    ],
    "body": "This will implement the k-bounded quotient space, whose basis is indexed by monomial symmetric functions indexed by k-bounded partitions. It is the dual Hopf algebra to the k-bounded subspace where the k-Schur functions live. In doing so, I have also fixed the bug from Ticket #13743.\n\nCC:  @sagetrac-sage-combinat @saliola @zabrocki @anneschilling @tscrim\n\nKeywords: **symmetric functions, partitions**\n\nReviewer: **Anne Schilling**\n\nAuthor: **Chris Berg, Mike Zabrocki**\n\nMerged: **sage-5.6.beta2**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13762_\n\n",
    "closed_at": "2013-01-01T11:37:53Z",
    "created_at": "2012-11-27T02:43:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement k-bounded quotient space",
    "type": "issue",
    "updated_at": "2013-01-23T11:23:15Z",
    "url": "https://github.com/sagemath/sage/issues/13762",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```
This will implement the k-bounded quotient space, whose basis is indexed by monomial symmetric functions indexed by k-bounded partitions. It is the dual Hopf algebra to the k-bounded subspace where the k-Schur functions live. In doing so, I have also fixed the bug from Ticket #13743.

CC:  @sagetrac-sage-combinat @saliola @zabrocki @anneschilling @tscrim

Keywords: **symmetric functions, partitions**

Reviewer: **Anne Schilling**

Author: **Chris Berg, Mike Zabrocki**

Merged: **sage-5.6.beta2**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/13762_





---

archive/issue_events_193006.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-27T02:43:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193006"
}
```



---

archive/issue_events_193007.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-27T02:43:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193007"
}
```



---

archive/issue_events_193008.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-27T02:43:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193008"
}
```



---

archive/issue_events_193009.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-27T02:43:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193009"
}
```



---

archive/issue_events_193010.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-27T02:43:12Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "subject": "https://github.com/sagetrac-chrisjamesberg",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193010"
}
```



---

archive/issue_events_193011.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-27T02:53:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193011"
}
```



---

archive/issue_events_193012.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-29T15:31:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193012"
}
```



---

archive/issue_events_193013.json:
```json
{
    "actor": "https://github.com/sagetrac-chrisjamesberg",
    "created_at": "2012-11-29T15:31:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193013"
}
```



---

archive/issue_comments_162046.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This will implement the k-bounded quotient space, whose basis is indexed by monomial symmetric functions indexed by k-bounded partitions. It is the dual Hopf algebra to the k-bounded subspace where the k-Schur functions live.\n+This will implement the k-bounded quotient space, whose basis is indexed by monomial symmetric functions indexed by k-bounded partitions. It is the dual Hopf algebra to the k-bounded subspace where the k-Schur functions live. In doing so, I have also fixed the bug from Ticket #13743.\n``````\n",
    "created_at": "2012-11-29T15:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162046",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-This will implement the k-bounded quotient space, whose basis is indexed by monomial symmetric functions indexed by k-bounded partitions. It is the dual Hopf algebra to the k-bounded subspace where the k-Schur functions live.
+This will implement the k-bounded quotient space, whose basis is indexed by monomial symmetric functions indexed by k-bounded partitions. It is the dual Hopf algebra to the k-bounded subspace where the k-Schur functions live. In doing so, I have also fixed the bug from Ticket #13743.
``````




---

archive/issue_comments_162047.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nApply: trac_13762_k_quotient.patch",
    "created_at": "2012-11-29T18:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162047",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

<div id="comment:8" align="right">comment:8</div>

Apply: trac_13762_k_quotient.patch



---

archive/issue_comments_162048.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\ncc'ed since this conflicts with #13605.",
    "created_at": "2012-12-01T00:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162048",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

cc'ed since this conflicts with #13605.



---

archive/issue_comments_162049.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nApply: trac_13762_k_quotient.patch",
    "created_at": "2012-12-11T22:15:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162049",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

<div id="comment:10" align="right">comment:10</div>

Apply: trac_13762_k_quotient.patch



---

archive/issue_comments_162050.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHi Chris,\n\nThanks for the new patch. I assume this fixes the coercion bug? Did you also fold \n\n* trac_13762_addthis.patch\n* trac_13762_possiblefix.patch\n\nthat were passed around by e-mail, or should they go after this patch still?\n\nAnne",
    "created_at": "2012-12-11T23:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162050",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:11" align="right">comment:11</div>

Hi Chris,

Thanks for the new patch. I assume this fixes the coercion bug? Did you also fold 

* trac_13762_addthis.patch
* trac_13762_possiblefix.patch

that were passed around by e-mail, or should they go after this patch still?

Anne



---

archive/issue_comments_162051.json:
```json
{
    "body": "Reviewer: **Anne Schilling**",
    "created_at": "2012-12-12T05:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162051",
    "user": "https://github.com/anneschilling"
}
```

Reviewer: **Anne Schilling**



---

archive/issue_comments_162052.json:
```json
{
    "body": "Changed author from **Chris Berg** to **Chris Berg, Mike Zabrocki**",
    "created_at": "2012-12-12T05:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162052",
    "user": "https://github.com/anneschilling"
}
```

Changed author from **Chris Berg** to **Chris Berg, Mike Zabrocki**



---

archive/issue_comments_162053.json:
```json
{
    "body": "Changed keywords from none to **symmetric functions, partitions**",
    "created_at": "2012-12-12T05:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162053",
    "user": "https://github.com/anneschilling"
}
```

Changed keywords from none to **symmetric functions, partitions**



---

archive/issue_comments_162054.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThis patch implements the K-k-Schur functions and their duals. I tested this code my old private code and it gives the correct answers in the cases I checked.\n\nChris and Mike, here are a couple more comments I have:\n\n* When building the documentation I get an error\n\n```\nsage/combinat/sf/new_kschur                                                                  \nSphinx error:\n'ascii' codec can't decode byte 0xe2 in position 34698: ordinal not in range(128)\n```\n\n* Line 549 of the patch \"Returns the symmetric functions. Needed to make TestSuite work\" probably needs to be changed.\n\n* You need an extra line after 650.\n\n* In line 883 of new_kschur (in the patch) the dash is strange\n\n```\n.. [LamSchillingShimozono2010] T. Lam, A. Schilling, M.Shimozono, K-theory Schubert calculus of the affine Grassmannian, \n \t883\t        Compositio Math. 146 (2010), 811\u00e2\ufffd\ufffd852. \n```\nAlso, this reference should probably appear in def K_kschur(self) as well.\n\n* Line 887 \"\"\"r  should read r\"\"\" (or remove the r)\n\nSo much for now!\n\nAnne",
    "created_at": "2012-12-12T05:59:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162054",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:13" align="right">comment:13</div>

This patch implements the K-k-Schur functions and their duals. I tested this code my old private code and it gives the correct answers in the cases I checked.

Chris and Mike, here are a couple more comments I have:

* When building the documentation I get an error

```
sage/combinat/sf/new_kschur                                                                  
Sphinx error:
'ascii' codec can't decode byte 0xe2 in position 34698: ordinal not in range(128)
```

* Line 549 of the patch "Returns the symmetric functions. Needed to make TestSuite work" probably needs to be changed.

* You need an extra line after 650.

* In line 883 of new_kschur (in the patch) the dash is strange

```
.. [LamSchillingShimozono2010] T. Lam, A. Schilling, M.Shimozono, K-theory Schubert calculus of the affine Grassmannian, 
 	883	        Compositio Math. 146 (2010), 811â��852. 
```
Also, this reference should probably appear in def K_kschur(self) as well.

* Line 887 """r  should read r""" (or remove the r)

So much for now!

Anne



---

archive/issue_comments_162055.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAnne,\n\nAren't the documentation error and the dash error related? I replaced the dash and the documentation builds fine on my machine.\n\nBecause the patch had changed so much, I didn't know where to put a line after 650, because line 650 had probably changed.\n\nEverything else is fixed. Yes, all the other patches are folded into this.\n\nApply: trac_13762_k_quotient.patch",
    "created_at": "2012-12-12T16:02:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162055",
    "user": "https://github.com/sagetrac-chrisjamesberg"
}
```

<div id="comment:14" align="right">comment:14</div>

Anne,

Aren't the documentation error and the dash error related? I replaced the dash and the documentation builds fine on my machine.

Because the patch had changed so much, I didn't know where to put a line after 650, because line 650 had probably changed.

Everything else is fixed. Yes, all the other patches are folded into this.

Apply: trac_13762_k_quotient.patch



---

archive/issue_comments_162056.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nHi Chris,\n\nThanks for the changes. The line that should be added is after line 807 in the current version.\nOther than that it looks good to me. If Mike is also happy, I'll let him set a positive review!\n\nAnne",
    "created_at": "2012-12-13T00:09:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162056",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:15" align="right">comment:15</div>

Hi Chris,

Thanks for the changes. The line that should be added is after line 807 in the current version.
Other than that it looks good to me. If Mike is also happy, I'll let him set a positive review!

Anne



---

archive/issue_events_193014.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2012-12-13T04:02:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193014"
}
```



---

archive/issue_events_193015.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2012-12-13T04:02:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193015"
}
```



---

archive/issue_comments_162057.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHi,\nI am happy with this version of the patch.  Chris, thanks for all the work and Anne thanks for the review.\n-Mike",
    "created_at": "2012-12-13T04:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162057",
    "user": "https://github.com/zabrocki"
}
```

<div id="comment:16" align="right">comment:16</div>

Hi,
I am happy with this version of the patch.  Chris, thanks for all the work and Anne thanks for the review.
-Mike



---

archive/issue_comments_162058.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThere is a problem with the building of the documentation introduced by this patch\n\n```\nreading sources... [100%] structure                                                                                                                                    \n/Applications/sage-5.5.rc0/local/lib/python2.7/site-packages/sage/combinat/sf/new_kschur.py:docstring of sage.combinat.sf.new_kschur.K_kSchur:9: WARNING: Duplicate explicit target name: \"lamschillingshimozono2010\".\n/Applications/sage-5.5.rc0/local/lib/python2.7/site-packages/sage/combinat/sf/new_kschur.py:docstring of sage.combinat.sf.new_kschur.K_kSchur:9: WARNING: duplicate citation LamSchillingShimozono2010, other instance in /Applications/sage-5.5.rc0/devel/sage/doc/en/reference/sage/combinat/sf/new_kschur.rst\n```\nI think this needs to be fixed!\n\nAnne",
    "created_at": "2012-12-20T19:29:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162058",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:17" align="right">comment:17</div>

There is a problem with the building of the documentation introduced by this patch

```
reading sources... [100%] structure                                                                                                                                    
/Applications/sage-5.5.rc0/local/lib/python2.7/site-packages/sage/combinat/sf/new_kschur.py:docstring of sage.combinat.sf.new_kschur.K_kSchur:9: WARNING: Duplicate explicit target name: "lamschillingshimozono2010".
/Applications/sage-5.5.rc0/local/lib/python2.7/site-packages/sage/combinat/sf/new_kschur.py:docstring of sage.combinat.sf.new_kschur.K_kSchur:9: WARNING: duplicate citation LamSchillingShimozono2010, other instance in /Applications/sage-5.5.rc0/devel/sage/doc/en/reference/sage/combinat/sf/new_kschur.rst
```
I think this needs to be fixed!

Anne



---

archive/issue_comments_162059.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThere was a repeated reference.  It should be fixed now.\n\nApply: trac_13762_k_quotient-2.patch",
    "created_at": "2012-12-20T21:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162059",
    "user": "https://github.com/zabrocki"
}
```

<div id="comment:18" align="right">comment:18</div>

There was a repeated reference.  It should be fixed now.

Apply: trac_13762_k_quotient-2.patch



---

archive/issue_comments_162060.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@zabrocki](#comment:18):\n> There was a repeated reference.  It should be fixed now.\n> \n> Apply: trac_13762_k_quotient-2.patch\n\nLooks good now! I leave the positive review.\n\nAnne",
    "created_at": "2012-12-20T23:48:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162060",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@zabrocki](#comment:18):
> There was a repeated reference.  It should be fixed now.
> 
> Apply: trac_13762_k_quotient-2.patch

Looks good now! I leave the positive review.

Anne



---

archive/issue_comments_162061.json:
```json
{
    "body": "Work Issues: **don't use assert**",
    "created_at": "2012-12-23T21:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162061",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **don't use assert**



---

archive/issue_events_193016.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-23T21:20:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193016"
}
```



---

archive/issue_events_193017.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-23T21:20:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193017"
}
```



---

archive/issue_comments_162062.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThere has been a discussion about the usage of \"assert\" and you should not use \"assert\" for bad user input, only to check for actual bugs. Bad input should probably give a `ValueError` instead.\n\nIf there is any way at all to reproduce an `AssertionError` using documented public functions, that is by definition a bug.",
    "created_at": "2012-12-23T21:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162062",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

There has been a discussion about the usage of "assert" and you should not use "assert" for bad user input, only to check for actual bugs. Bad input should probably give a `ValueError` instead.

If there is any way at all to reproduce an `AssertionError` using documented public functions, that is by definition a bug.



---

archive/issue_comments_162063.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAlso, the commit message should not be one long line. You should wrap the message in multiple lines, but make sure the first line (which appears in `hg log`) makes sense by itself.",
    "created_at": "2012-12-26T13:17:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162063",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

Also, the commit message should not be one long line. You should wrap the message in multiple lines, but make sure the first line (which appears in `hg log`) makes sense by itself.



---

archive/issue_comments_162064.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nHi Jeroen,\nThere are a few '`assert`' lines that we can clearly remove and change to `ValueError`, but there is one I am unsure about.  Around line 599 in k_dual.py we have\n\n```\nif isinstance(c, Partition_class): \n      assert len(rest) == 0 \n```\nI don't see how to trigger this.  Is it ok to leave it as is?\n\nSome of our assertion errors that appear are triggered in code in free_module.py.  Should I change that code here or open a new ticket?",
    "created_at": "2012-12-27T06:19:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162064",
    "user": "https://github.com/zabrocki"
}
```

<div id="comment:22" align="right">comment:22</div>

Hi Jeroen,
There are a few '`assert`' lines that we can clearly remove and change to `ValueError`, but there is one I am unsure about.  Around line 599 in k_dual.py we have

```
if isinstance(c, Partition_class): 
      assert len(rest) == 0 
```
I don't see how to trigger this.  Is it ok to leave it as is?

Some of our assertion errors that appear are triggered in code in free_module.py.  Should I change that code here or open a new ticket?



---

archive/issue_comments_162065.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@zabrocki](#comment:22):\n> \n> ```\n> if isinstance(c, Partition_class): \n>       assert len(rest) == 0 \n> ```\n> I don't see how to trigger this.  Is it ok to leave it as is?\n\nAbsolutely. This is how `assert` should be used: to say \"this condition is always true, without any further assumptions\".\n\n> Some of our assertion errors that appear are triggered in code in free_module.py.  Should I change that code here or open a new ticket?\n\nI don't think you have to change it here, but at least make sure you don't introduce any new wrongly-used asserts.",
    "created_at": "2012-12-27T10:15:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162065",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@zabrocki](#comment:22):
> 
> ```
> if isinstance(c, Partition_class): 
>       assert len(rest) == 0 
> ```
> I don't see how to trigger this.  Is it ok to leave it as is?

Absolutely. This is how `assert` should be used: to say "this condition is always true, without any further assumptions".

> Some of our assertion errors that appear are triggered in code in free_module.py.  Should I change that code here or open a new ticket?

I don't think you have to change it here, but at least make sure you don't introduce any new wrongly-used asserts.



---

archive/issue_comments_162066.json:
```json
{
    "body": "Attachment: **[trac_13762_k_quotient.2.patch.gz](https://github.com/sagemath/sage/files/ticket13762/trac_13762_k_quotient.2.patch.gz)**",
    "created_at": "2012-12-27T13:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162066",
    "user": "https://github.com/zabrocki"
}
```

Attachment: **[trac_13762_k_quotient.2.patch.gz](https://github.com/sagemath/sage/files/ticket13762/trac_13762_k_quotient.2.patch.gz)**



---

archive/issue_events_193018.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2012-12-27T13:36:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193018"
}
```



---

archive/issue_events_193019.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2012-12-27T13:36:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193019"
}
```



---

archive/issue_comments_162067.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOK.  Our doctests still raise two assertion errors for calling '`coefficient`' in free_module.py.",
    "created_at": "2012-12-27T13:36:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162067",
    "user": "https://github.com/zabrocki"
}
```

<div id="comment:24" align="right">comment:24</div>

OK.  Our doctests still raise two assertion errors for calling '`coefficient`' in free_module.py.



---

archive/issue_comments_162068.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nApply:  trac_13762_k_quotient.2.patch",
    "created_at": "2012-12-27T17:28:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162068",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:25" align="right">comment:25</div>

Apply:  trac_13762_k_quotient.2.patch



---

archive/issue_comments_162069.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nLooks good to me now! I set it back to positive review.\n\nAnne",
    "created_at": "2012-12-27T17:58:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162069",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:26" align="right">comment:26</div>

Looks good to me now! I set it back to positive review.

Anne



---

archive/issue_comments_162070.json:
```json
{
    "body": "Changed work issues from **don't use assert** to none",
    "created_at": "2012-12-27T17:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162070",
    "user": "https://github.com/anneschilling"
}
```

Changed work issues from **don't use assert** to none



---

archive/issue_events_193020.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2012-12-27T17:59:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193020"
}
```



---

archive/issue_events_193021.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2012-12-27T17:59:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193021"
}
```



---

archive/issue_comments_162071.json:
```json
{
    "body": "Merged: **sage-5.6.beta2**",
    "created_at": "2013-01-01T11:37:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162071",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.6.beta2**



---

archive/issue_events_193022.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-01T11:37:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193022"
}
```



---

archive/issue_events_193023.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-01T11:37:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13762#event-193023"
}
```



---

archive/issue_comments_162072.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nPlease read some comments from #12313, which apply to this code:\n\n(tl;dr: your code is badly written and #12313 will make it much slower)\n\n> Had a quick look. To simplify and speed up the tests a little bit, you can concentrate on one of the tests that's slow:\n> \n> ```\n> sage: cmd='dks4._test_associativity()'\n> sage: import cProfile,pstats\n> sage: s=pstats.Stats(cProfile.Profile().runctx(cmd,globals(),{}))\n> sage: S=s.sort_stats('cumulative')\n> sage: S.print_stats()\n> ...\n> sage: S.print_callers()\n> ...\n> ```\n> the latter one essentially gives you the call graph, weighted by time contributed.\n> \n> In fact it shows you pretty quickly that ShurFunctions were apparently VERY heavily relying on parents being cached:\n> \n> ```\n> X=dks4[0]+ 2*dks4[1] + 3*dks4[2]\n> (X*X)*X #wait quite a long time\n> ```\n> This mainly uses `dks4.product` and you can follow the code from there to see this has not been written with runtime optimization in mind. Probably if you make some things cached the way there, you'll regain the original performance.\n> \n> My first impression is that this code indeed will make a concrete realization of some structure, perform the operation, and throw away the concrete realization. Elements on the way basically ARE homs, hence all the homsets.\n\n> I think the normal behaviour of a CAS should be that a structure S is considered garbage and can be collected, unless the user has constructed some object O and keeps a reference to it, and O keeps a chain of references to S. Sadly, that was not the case for Sage, but this ticket is part of an attempt to make Sage behave \"normally\" in that department.\n> \n> Hence, if the same structure is needed repeatedly during a computation, then the programmer should keep a reference to it locally, rather than relying on an external cache. And if different methods of an object O will use the same structure S, then it makes sense to store S as an attribute of O, in order to prevent S from being garbage collected as long as O is alive (but not longer than that).\n> \n> I think what Nils wanted to say is: If other parts of the Sage library do not obey the general rules formulated in the preceding paragraph, but rely on an infinite external cache, then they need to be fixed. But the need to fix them should not prevent us from changing the infinite external cache to a finite external cache, because that is of benefit for all parts in the Sage library that follow the general rules.",
    "created_at": "2013-01-23T11:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162072",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Please read some comments from #12313, which apply to this code:

(tl;dr: your code is badly written and #12313 will make it much slower)

> Had a quick look. To simplify and speed up the tests a little bit, you can concentrate on one of the tests that's slow:
> 
> ```
> sage: cmd='dks4._test_associativity()'
> sage: import cProfile,pstats
> sage: s=pstats.Stats(cProfile.Profile().runctx(cmd,globals(),{}))
> sage: S=s.sort_stats('cumulative')
> sage: S.print_stats()
> ...
> sage: S.print_callers()
> ...
> ```
> the latter one essentially gives you the call graph, weighted by time contributed.
> 
> In fact it shows you pretty quickly that ShurFunctions were apparently VERY heavily relying on parents being cached:
> 
> ```
> X=dks4[0]+ 2*dks4[1] + 3*dks4[2]
> (X*X)*X #wait quite a long time
> ```
> This mainly uses `dks4.product` and you can follow the code from there to see this has not been written with runtime optimization in mind. Probably if you make some things cached the way there, you'll regain the original performance.
> 
> My first impression is that this code indeed will make a concrete realization of some structure, perform the operation, and throw away the concrete realization. Elements on the way basically ARE homs, hence all the homsets.

> I think the normal behaviour of a CAS should be that a structure S is considered garbage and can be collected, unless the user has constructed some object O and keeps a reference to it, and O keeps a chain of references to S. Sadly, that was not the case for Sage, but this ticket is part of an attempt to make Sage behave "normally" in that department.
> 
> Hence, if the same structure is needed repeatedly during a computation, then the programmer should keep a reference to it locally, rather than relying on an external cache. And if different methods of an object O will use the same structure S, then it makes sense to store S as an attribute of O, in order to prevent S from being garbage collected as long as O is alive (but not longer than that).
> 
> I think what Nils wanted to say is: If other parts of the Sage library do not obey the general rules formulated in the preceding paragraph, but rely on an infinite external cache, then they need to be fixed. But the need to fix them should not prevent us from changing the infinite external cache to a finite external cache, because that is of benefit for all parts in the Sage library that follow the general rules.



---

archive/issue_comments_162073.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nSee #13991 for a follow-up.",
    "created_at": "2013-01-23T11:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13762",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13762#issuecomment-162073",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

See #13991 for a follow-up.
