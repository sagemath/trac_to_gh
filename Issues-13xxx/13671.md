# Issue 13671: p.lift(...) results are non-deterministic and incoherent for multivariate polynomials

archive/issues_013467.json:
```json
{
    "body": "** Merge together with #13675, circular dependency **\n\n```\nsage: R.<x1,x2> = QQ[]\nsage: I = R.ideal(x2**2 + x1 - 2, x1**2 - 1)\nsage: test = I.gen(0) + x2*I.gen(1)\nsage: test.lift(I) # correct\n[1, x2]\nsage: (test+1).lift(I) # invalid input, should give error\n[0, 0]\nsage: test.lift(I) # incorrect\n[0, 0]\n```\n\np.lift(I) should raise an exception \"ValueError: polynomial is not in the ideal\" instead of returning [0,0,...,0] in the first place...\n\n** Merge together with #13675, circular dependency **\n\n\nAssignee: @malb\n\nCC:  @mstreng @malb\n\nKeywords: polynomial rings, mathematically wrong result\n\nReviewer: Marco Streng\n\nAuthor: Charles Bouillaguet\n\nMerged: sage-5.5.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13671\n\n",
    "closed_at": "2012-11-13T08:21:32Z",
    "created_at": "2012-10-30T13:37:50Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.5",
    "title": "p.lift(...) results are non-deterministic and incoherent for multivariate polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13671",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```
** Merge together with #13675, circular dependency **

```
sage: R.<x1,x2> = QQ[]
sage: I = R.ideal(x2**2 + x1 - 2, x1**2 - 1)
sage: test = I.gen(0) + x2*I.gen(1)
sage: test.lift(I) # correct
[1, x2]
sage: (test+1).lift(I) # invalid input, should give error
[0, 0]
sage: test.lift(I) # incorrect
[0, 0]
```

p.lift(I) should raise an exception "ValueError: polynomial is not in the ideal" instead of returning [0,0,...,0] in the first place...

** Merge together with #13675, circular dependency **


Assignee: @malb

CC:  @mstreng @malb

Keywords: polynomial rings, mathematically wrong result

Reviewer: Marco Streng

Author: Charles Bouillaguet

Merged: sage-5.5.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13671





---

archive/issue_comments_176803.json:
```json
{
    "body": "<a id='comment:1'></a>Hans (of Singular) wrote:\n\n> An additional comment:\n> WerrorS also sets the global variable errorreported,\n> which is used at many places to abort after an error\n> (and to avoid general error message if there was already one\n> (hopefully more specific)).\n> errorreported is reset to 0 in the error handling branch of the singular\n> interpreter.\n> Maybe something equivalent is missing for the routine from libsingular\n> not called via the singular interpreter?\n\n\nThis could be it, we don't reset it.",
    "created_at": "2012-11-05T12:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176803",
    "user": "https://github.com/malb"
}
```

<a id='comment:1'></a>Hans (of Singular) wrote:

> An additional comment:
> WerrorS also sets the global variable errorreported,
> which is used at many places to abort after an error
> (and to avoid general error message if there was already one
> (hopefully more specific)).
> errorreported is reset to 0 in the error handling branch of the singular
> interpreter.
> Maybe something equivalent is missing for the routine from libsingular
> not called via the singular interpreter?


This could be it, we don't reset it.



---

archive/issue_comments_176804.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-11-05T22:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176804",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_176805.json:
```json
{
    "body": "<a id='comment:3'></a>Did you ask Gauss to write the patch for you?\n\n```\n# HG changeset patch\n# User Carl Friedrich Gauss <cfgauss@uni-goettingen.de>\n```\nYou should update the `.hmrc` file in your home directory (use your own name and email address) and export a new patch here and at #13675.",
    "created_at": "2012-11-05T22:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176805",
    "user": "https://github.com/mstreng"
}
```

<a id='comment:3'></a>Did you ask Gauss to write the patch for you?

```
# HG changeset patch
# User Carl Friedrich Gauss <cfgauss@uni-goettingen.de>
```
You should update the `.hmrc` file in your home directory (use your own name and email address) and export a new patch here and at #13675.



---

archive/issue_comments_176806.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-11-05T22:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176806",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_176807.json:
```json
{
    "body": "<a id='comment:4'></a>ps. Would it be possible to add a check which error was reported by Singular? Just in case self is in I, but Singular reports an error for some other reason (in which case I guess `RuntimeError` is appropriate).",
    "created_at": "2012-11-05T22:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176807",
    "user": "https://github.com/mstreng"
}
```

<a id='comment:4'></a>ps. Would it be possible to add a check which error was reported by Singular? Just in case self is in I, but Singular reports an error for some other reason (in which case I guess `RuntimeError` is appropriate).



---

archive/issue_comments_176808.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-11-05T22:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176808",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_176809.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 mstreng]:\n> ps. Would it be possible to add a check which error was reported by Singular? Just in case self is in I, but Singular reports an error for some other reason (in which case I guess `RuntimeError` is appropriate).\n\n\nI renamed myself and tested that Singular returns ``1`` when the polynomial is not in the ideal...",
    "created_at": "2012-11-05T22:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176809",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```

<a id='comment:5'></a>Replying to [comment:4 mstreng]:
> ps. Would it be possible to add a check which error was reported by Singular? Just in case self is in I, but Singular reports an error for some other reason (in which case I guess `RuntimeError` is appropriate).


I renamed myself and tested that Singular returns ``1`` when the polynomial is not in the ideal...



---

archive/issue_comments_176810.json:
```json
{
    "body": "<a id='comment:6'></a>\n```\n4088\t            errorreported = 0 \n4089\t            if errorreported == 1: \n```\nThis looks like it does not work.",
    "created_at": "2012-11-05T23:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176810",
    "user": "https://github.com/mstreng"
}
```

<a id='comment:6'></a>
```
4088	            errorreported = 0 
4089	            if errorreported == 1: 
```
This looks like it does not work.



---

archive/issue_comments_176811.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 mstreng]:\n> {{{\n> 4088\t            errorreported = 0 \n> 4089\t            if errorreported == 1: \n> }}}\n> This looks like it does not work.\n\n\nGood lord, that was stupid.",
    "created_at": "2012-11-05T23:11:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176811",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```

<a id='comment:7'></a>Replying to [comment:6 mstreng]:
> {{{
> 4088	            errorreported = 0 
> 4089	            if errorreported == 1: 
> }}}
> This looks like it does not work.


Good lord, that was stupid.



---

archive/issue_comments_176812.json:
```json
{
    "body": "Attachment [13671_lift_bug.patch](tarball://root/attachments/some-uuid/ticket13671/13671_lift_bug.patch) by Bouillaguet created at 2012-11-05 23:45:55\n\nApparently fixing the bug",
    "created_at": "2012-11-05T23:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176812",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```

Attachment [13671_lift_bug.patch](tarball://root/attachments/some-uuid/ticket13671/13671_lift_bug.patch) by Bouillaguet created at 2012-11-05 23:45:55

Apparently fixing the bug



---

archive/issue_comments_176813.json:
```json
{
    "body": "<a id='comment:8'></a>Looks good!",
    "created_at": "2012-11-06T00:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176813",
    "user": "https://github.com/mstreng"
}
```

<a id='comment:8'></a>Looks good!



---

archive/issue_comments_176814.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+** Merge together with #13675, circular dependency **\n+\n \\`\\`\\`\n sage: R.<x1,x2> = QQ[]\n sage: I = R.ideal(x2**2 + x1 - 2, x1**2 - 1)\n@@ -12,6 +14,9 @@\n \n p.lift(I) should raise an exception \"ValueError: polynomial is not in the ideal\" instead of returning [0,0,...,0] in the first place...\n \n+** Merge together with #13675, circular dependency **\n+\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/13671\n```\n",
    "created_at": "2012-11-06T00:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176814",
    "user": "https://github.com/mstreng"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,5 @@
+** Merge together with #13675, circular dependency **
+
 \`\`\`
 sage: R.<x1,x2> = QQ[]
 sage: I = R.ideal(x2**2 + x1 - 2, x1**2 - 1)
@@ -12,6 +14,9 @@
 
 p.lift(I) should raise an exception "ValueError: polynomial is not in the ideal" instead of returning [0,0,...,0] in the first place...
 
+** Merge together with #13675, circular dependency **
+
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/13671
```




---

archive/issue_comments_176815.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-11-06T00:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176815",
    "user": "https://github.com/mstreng"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_176816.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 mstreng]:\n> Looks good!\n\n\nI don't understand the circular dependency... Why would this one depend on #13675 ?",
    "created_at": "2012-11-06T00:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176816",
    "user": "https://trac.sagemath.org/admin/accounts/users/Bouillaguet"
}
```

<a id='comment:9'></a>Replying to [comment:8 mstreng]:
> Looks good!


I don't understand the circular dependency... Why would this one depend on #13675 ?



---

archive/issue_comments_176817.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 Bouillaguet]:\n> I don't understand the circular dependency... Why would this one depend on #13675 ?\n\n\nNot all doctests pass when only this patch is applied.",
    "created_at": "2012-11-06T00:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176817",
    "user": "https://github.com/mstreng"
}
```

<a id='comment:10'></a>Replying to [comment:9 Bouillaguet]:
> I don't understand the circular dependency... Why would this one depend on #13675 ?


Not all doctests pass when only this patch is applied.



---

archive/issue_events_038192.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-13T08:21:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13671#event-38192"
}
```



---

archive/issue_comments_176818.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-11-13T08:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13671",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13671#issuecomment-176818",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
