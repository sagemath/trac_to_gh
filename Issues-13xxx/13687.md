# Issue 13687: Parents for groups

archive/issues_013483.json:
```json
{
    "assignees": [
        "https://github.com/wdjoyner"
    ],
    "body": "Groups are based on the deprecated `ParentWithGens`. This ticket is about forward-porting them to the new coercion framework.\n\nTo limit the size of the patchbomb I'm only porting the Abelian groups. The rest depends on `old.Group`\n\nVarious oddities needed to be cleaned up in the process:\n* make parents unique and elements immutable (often requires tuples instead of lists)\n* rename `AbelianGroup_class.invariants()` -> `AbelianGroup_class.gens_orders()` since they are not necessarily the abelian invariants (=elementary divisors).\n* rename `element.list()` -> `element.exponents()` for the exponent vector.\n* implement a `AbelianGroupWithValues` where you attach values to the (abstract) generators. Used in the unit group of a number field, for example.\n* lots of places return lists when they should return tuples\n\nI haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.\n\nApply\n* [attachment: 13687_parent_for_groups_all_vb.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all_vb.patch.gz)\n* [attachment: 13687_32bitfix.patch](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)\n\nCC:  @miguelmarco @roed314 @wdjoyner @simon-king-jena\n\nKeywords: **new Parent**\n\nReviewer: **David Roe**\n\nAuthor: **Volker Braun**\n\nMerged: **sage-5.7.beta2**\n\nComponent: **group theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13687_\n\n",
    "closed_at": "2013-01-31T09:20:04Z",
    "created_at": "2012-11-05T16:12:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Parents for groups",
    "type": "issue",
    "updated_at": "2013-01-31T09:20:04Z",
    "url": "https://github.com/sagemath/sage/issues/13687",
    "user": "https://github.com/vbraun"
}
```
Groups are based on the deprecated `ParentWithGens`. This ticket is about forward-porting them to the new coercion framework.

To limit the size of the patchbomb I'm only porting the Abelian groups. The rest depends on `old.Group`

Various oddities needed to be cleaned up in the process:
* make parents unique and elements immutable (often requires tuples instead of lists)
* rename `AbelianGroup_class.invariants()` -> `AbelianGroup_class.gens_orders()` since they are not necessarily the abelian invariants (=elementary divisors).
* rename `element.list()` -> `element.exponents()` for the exponent vector.
* implement a `AbelianGroupWithValues` where you attach values to the (abstract) generators. Used in the unit group of a number field, for example.
* lots of places return lists when they should return tuples

I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.

Apply
* [attachment: 13687_parent_for_groups_all_vb.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all_vb.patch.gz)
* [attachment: 13687_32bitfix.patch](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)

CC:  @miguelmarco @roed314 @wdjoyner @simon-king-jena

Keywords: **new Parent**

Reviewer: **David Roe**

Author: **Volker Braun**

Merged: **sage-5.7.beta2**

Component: **group theory**

_Issue created by migration from https://trac.sagemath.org/ticket/13687_





---

archive/issue_events_189810.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T16:12:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189810"
}
```



---

archive/issue_events_189811.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T16:12:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
    "label_color": "0000ff",
    "label_name": "c: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189811"
}
```



---

archive/issue_events_189812.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T16:12:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189812"
}
```



---

archive/issue_events_189813.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T16:12:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189813"
}
```



---

archive/issue_events_189814.json:
```json
{
    "actor": "https://github.com/wdjoyner",
    "created_at": "2012-11-05T16:12:01Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "subject": "https://github.com/vbraun",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189814"
}
```



---

archive/issue_comments_160605.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,5 +7,5 @@\n * rename `AbelianGroup_class.invariants()` -> `AbelianGroup_class.gens_orders()` since they are not necessarily the abelian invariants (=elementary divisors).\n * rename `element.list()` -> `element.exponents()` for the exponent vector.\n * implement a `AbelianGroupWithValues` where you attach values to the (abstract) generators. Used in the unit group of a number field, for example.\n+* lots of places return lists when they should return tuples\n \n-\n``````\n",
    "created_at": "2012-11-05T20:24:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160605",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,5 +7,5 @@
 * rename `AbelianGroup_class.invariants()` -> `AbelianGroup_class.gens_orders()` since they are not necessarily the abelian invariants (=elementary divisors).
 * rename `element.list()` -> `element.exponents()` for the exponent vector.
 * implement a `AbelianGroupWithValues` where you attach values to the (abstract) generators. Used in the unit group of a number field, for example.
+* lots of places return lists when they should return tuples
 
-
``````




---

archive/issue_events_189815.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-05T20:25:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189815"
}
```



---

archive/issue_comments_160606.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,4 @@\n * implement a `AbelianGroupWithValues` where you attach values to the (abstract) generators. Used in the unit group of a number field, for example.\n * lots of places return lists when they should return tuples\n \n+I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.\n``````\n",
    "created_at": "2012-11-06T01:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160606",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,4 @@
 * implement a `AbelianGroupWithValues` where you attach values to the (abstract) generators. Used in the unit group of a number field, for example.
 * lots of places return lists when they should return tuples
 
+I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.
``````




---

archive/issue_comments_160607.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2012-11-06T01:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160607",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_comments_160608.json:
```json
{
    "body": "Changed keywords from none to **new Parent**",
    "created_at": "2012-11-06T01:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160608",
    "user": "https://github.com/vbraun"
}
```

Changed keywords from none to **new Parent**



---

archive/issue_events_189816.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-11-06T10:04:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189816"
}
```



---

archive/issue_events_189817.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2012-11-06T10:04:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189817"
}
```



---

archive/issue_comments_160609.json:
```json
{
    "body": "Reviewer: **David Roe**",
    "created_at": "2012-11-06T10:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160609",
    "user": "https://github.com/roed314"
}
```

Reviewer: **David Roe**



---

archive/issue_comments_160610.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHi Volker,\nI'm about halfway through this.  Overall it's looking great.  Here are some comments (let me know if anything is unclear):\n\n* in the `_normalize` function for `AbelianGroup`, perhaps the 0s should come last, since that lines up with the standard divisibility condition for invariants.  Also, if `gens_orders` is a string of length `n` then it will get through your error checking.\n\n* `_normalize` should have examples.\n\n* In `random_element`, shouldn't the fact that doctesting consistently chooses a random seed mean we don't need to mark `G.random_element()` as `# random output`?\n\n* In the docstring for `equals`, the documentation for the output is wrong: should be checking whether they are the same subset.\n\n* In `invs()`, where you write `raise Exception # WTF`, maybe we should figure out what was intended by this function and fix it.  :-)\n\n* In the module summary of `dual_abelian_group`, you can use floating point tolerance rather than just marking the output as random.  In particular, shouldn't your first example be exact?\n\n* In module doctoring for `dual_abelian_group_element`, you should take out the `# random` marking on some doctests (using floating point tolerance instead if necessary)\n\nI should go to sleep, but I'll try to get through more of this tomorrow.  When you make changes, could you upload a separate patch?",
    "created_at": "2012-11-06T10:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160610",
    "user": "https://github.com/roed314"
}
```

<div id="comment:5" align="right">comment:5</div>

Hi Volker,
I'm about halfway through this.  Overall it's looking great.  Here are some comments (let me know if anything is unclear):

* in the `_normalize` function for `AbelianGroup`, perhaps the 0s should come last, since that lines up with the standard divisibility condition for invariants.  Also, if `gens_orders` is a string of length `n` then it will get through your error checking.

* `_normalize` should have examples.

* In `random_element`, shouldn't the fact that doctesting consistently chooses a random seed mean we don't need to mark `G.random_element()` as `# random output`?

* In the docstring for `equals`, the documentation for the output is wrong: should be checking whether they are the same subset.

* In `invs()`, where you write `raise Exception # WTF`, maybe we should figure out what was intended by this function and fix it.  :-)

* In the module summary of `dual_abelian_group`, you can use floating point tolerance rather than just marking the output as random.  In particular, shouldn't your first example be exact?

* In module doctoring for `dual_abelian_group_element`, you should take out the `# random` marking on some doctests (using floating point tolerance instead if necessary)

I should go to sleep, but I'll try to get through more of this tomorrow.  When you make changes, could you upload a separate patch?



---

archive/issue_comments_160611.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n1. The 0's were prepended, I just kept that behavior. I think its more in line with the mathematical expectation of writing a group as free+torsion instead of the other way round. Also, the `gens_orders` are not the abelian invariants. \n\n5. I still haven't figured out what `invs()` is for, I'll just delete it ;-)\n\nI agree with the rest. Most of it is just stuff that was already there and I didn't fix...",
    "created_at": "2012-11-06T16:16:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160611",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

1. The 0's were prepended, I just kept that behavior. I think its more in line with the mathematical expectation of writing a group as free+torsion instead of the other way round. Also, the `gens_orders` are not the abelian invariants. 

5. I still haven't figured out what `invs()` is for, I'll just delete it ;-)

I agree with the rest. Most of it is just stuff that was already there and I didn't fix...



---

archive/issue_comments_160612.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n1.  Fair enough.\n\n5.  Sounds good.\n\nI know, I saw the old code.  But if you're making changes this extensive you might as well fix some more stuff.  :-)",
    "created_at": "2012-11-06T17:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160612",
    "user": "https://github.com/roed314"
}
```

<div id="comment:7" align="right">comment:7</div>

1.  Fair enough.

5.  Sounds good.

I know, I saw the old code.  But if you're making changes this extensive you might as well fix some more stuff.  :-)



---

archive/issue_events_189818.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-06T17:31:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189818"
}
```



---

archive/issue_events_189819.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-06T17:31:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189819"
}
```



---

archive/issue_comments_160613.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,7 @@\n * lots of places return lists when they should return tuples\n \n I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.\n+\n+Apply\n+* [attachment: trac_13687_Parent_for_groups.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)\n+* [attachment: trac_13687_review.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)\n``````\n",
    "created_at": "2012-11-06T17:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160613",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,7 @@
 * lots of places return lists when they should return tuples
 
 I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.
+
+Apply
+* [attachment: trac_13687_Parent_for_groups.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)
+* [attachment: trac_13687_review.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)
``````




---

archive/issue_comments_160614.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHere are some more suggestions.  I'm going to leave it marked as needs review so that the patchbot will continue testing.\n\n1. In `AbelianGroupElement.__init__`, I think it's useful to allow `ints` in the `generator_orders`, rather than asserting that they all be `Integers`\n\n2. Documentation of `exponents` doesn't line up with `__init__` method in `AbelianGroupElementBase`.  You should give an example in the documentation of that function showing that the exponents are still integers, not elements of the base ring.\n\n3. In docstring for `AbelianGroupWithValues`, maybe you should note that `values_group` could be a ring or field, since Sage doesn't currently support the group of units in a ring very well.\n\n4. I don't think that `AbelianGroupWithValuesEmbedding` should inherit from `CallMorphism`, but rather just from `Morphism`.\n\n5. For the arithmetic operations in `AbelianGroupWithValuesElement`, I would keep the computation of `_value` lazy (check to see if both left and right values are not None).  By being nonlazy you'll get more floating point drift and also you may compute unnecessary values.  \n\n6. Your docstring for `AbelianGroupWithValues_class.values_group` is incomplete.\n\n7. Indentation problem at the end of the docstring for `Group` (right before `def __init__`)\n\n8. You set  `Element = FractionalIdealClass` on `SFractionalIdealClass(FractionalIdealClass)`.  This should be done on the parent, not the element.\n\n9. There doesn't seem to be a failure in the test suite for `ClassGroup`, so you should remove the sentence about a failure caused by not having a category of additive abelian groups.\n\n10. In `unit_group.py` you use `_.value()` a few times; can you give `UK.torsion_generator()` (etc)  a name and use it instead of `_`?\n\n21. You have a docstring floating that needs to be deleted where `gen(self, i=0)` used to be in `UnitGroup`",
    "created_at": "2012-11-06T21:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160614",
    "user": "https://github.com/roed314"
}
```

<div id="comment:9" align="right">comment:9</div>

Here are some more suggestions.  I'm going to leave it marked as needs review so that the patchbot will continue testing.

1. In `AbelianGroupElement.__init__`, I think it's useful to allow `ints` in the `generator_orders`, rather than asserting that they all be `Integers`

2. Documentation of `exponents` doesn't line up with `__init__` method in `AbelianGroupElementBase`.  You should give an example in the documentation of that function showing that the exponents are still integers, not elements of the base ring.

3. In docstring for `AbelianGroupWithValues`, maybe you should note that `values_group` could be a ring or field, since Sage doesn't currently support the group of units in a ring very well.

4. I don't think that `AbelianGroupWithValuesEmbedding` should inherit from `CallMorphism`, but rather just from `Morphism`.

5. For the arithmetic operations in `AbelianGroupWithValuesElement`, I would keep the computation of `_value` lazy (check to see if both left and right values are not None).  By being nonlazy you'll get more floating point drift and also you may compute unnecessary values.  

6. Your docstring for `AbelianGroupWithValues_class.values_group` is incomplete.

7. Indentation problem at the end of the docstring for `Group` (right before `def __init__`)

8. You set  `Element = FractionalIdealClass` on `SFractionalIdealClass(FractionalIdealClass)`.  This should be done on the parent, not the element.

9. There doesn't seem to be a failure in the test suite for `ClassGroup`, so you should remove the sentence about a failure caused by not having a category of additive abelian groups.

10. In `unit_group.py` you use `_.value()` a few times; can you give `UK.torsion_generator()` (etc)  a name and use it instead of `_`?

21. You have a docstring floating that needs to be deleted where `gen(self, i=0)` used to be in `UnitGroup`



---

archive/issue_comments_160615.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n1. `AbelianGroup_class` derives from `UniqueRepresentation`, so I want to enforce canonical arguments with the assertions. Its the job of the `AbelianGroup` factory function to canonicalize the user input.\n\n5. For the unit group, say, its much more expensive to do the exponentiation than non-lazy multiplication. Imagine you want to list all units. This is also what the `FractionalIdealClass` and friends do. If its cheap to exponentiate the values then I would agree with you, but in that case you probably don't need such an elaborate `AbelianGroupWithValues`.",
    "created_at": "2012-11-07T02:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160615",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

1. `AbelianGroup_class` derives from `UniqueRepresentation`, so I want to enforce canonical arguments with the assertions. Its the job of the `AbelianGroup` factory function to canonicalize the user input.

5. For the unit group, say, its much more expensive to do the exponentiation than non-lazy multiplication. Imagine you want to list all units. This is also what the `FractionalIdealClass` and friends do. If its cheap to exponentiate the values then I would agree with you, but in that case you probably don't need such an elaborate `AbelianGroupWithValues`.



---

archive/issue_comments_160616.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThe updated patch addresses all remaining issues. I've also based `ClassGroup` on `AbelianGroupWithValues` and some other improvements.",
    "created_at": "2012-11-08T04:16:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160616",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

The updated patch addresses all remaining issues. I've also based `ClassGroup` on `AbelianGroupWithValues` and some other improvements.



---

archive/issue_comments_160617.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nLooks good.  Two more comments and then I'm happy to give a positive review:\n\n* In docstring for `SFractionalIdealClass`, your example blocks are indented.  There should also only be one block rather than three.\n\n* There's a failure in the startup plugin.  I have no problem giving a positive review even so, but I thought I'd point it out in case you wanted to change anything related to imports.  :-)",
    "created_at": "2012-11-08T08:28:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160617",
    "user": "https://github.com/roed314"
}
```

<div id="comment:12" align="right">comment:12</div>

Looks good.  Two more comments and then I'm happy to give a positive review:

* In docstring for `SFractionalIdealClass`, your example blocks are indented.  There should also only be one block rather than three.

* There's a failure in the startup plugin.  I have no problem giving a positive review even so, but I thought I'd point it out in case you wanted to change anything related to imports.  :-)



---

archive/issue_comments_160618.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nGood eyes with the indent ;-)\n\nI noticed that startup modules changed. Fun fact: the `operator` Python module (for `operator.mul`, say) was imported as a by-product of Abelian groups. And the coercion framework assumes that it is imported in its doctests. I've moved the actual import to `sage.all`, as you saw. In any case, I'm planning to make everything lazy if possible, but first I should go through the rest of the groups and port them to the new parents.",
    "created_at": "2012-11-08T16:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160618",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

Good eyes with the indent ;-)

I noticed that startup modules changed. Fun fact: the `operator` Python module (for `operator.mul`, say) was imported as a by-product of Abelian groups. And the coercion framework assumes that it is imported in its doctests. I've moved the actual import to `sage.all`, as you saw. In any case, I'm planning to make everything lazy if possible, but first I should go through the rest of the groups and port them to the new parents.



---

archive/issue_events_189820.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-08T16:17:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189820"
}
```



---

archive/issue_events_189821.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-08T16:17:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189821"
}
```



---

archive/issue_comments_160619.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSounds good.  Let me know when you need a review for the transition on the other groups.  Thanks for all the changes here: fixing Groups has been a daunting task.",
    "created_at": "2012-11-08T18:05:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160619",
    "user": "https://github.com/roed314"
}
```

<div id="comment:14" align="right">comment:14</div>

Sounds good.  Let me know when you need a review for the transition on the other groups.  Thanks for all the changes here: fixing Groups has been a daunting task.



---

archive/issue_comments_160620.json:
```json
{
    "body": "Rebased patch",
    "created_at": "2012-11-13T19:51:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160620",
    "user": "https://github.com/vbraun"
}
```

Rebased patch



---

archive/issue_comments_160621.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAttachment: **[trac_13687_Parent_for_groups.patch.gz](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)**\n\nPatch rebased for sage-5.5.beta0",
    "created_at": "2012-11-13T19:52:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160621",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

Attachment: **[trac_13687_Parent_for_groups.patch.gz](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)**

Patch rebased for sage-5.5.beta0



---

archive/issue_comments_160622.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nLong doctests fail:\n\n```\nsage -t -long \"devel/sage/sage/rings/number_field/number_field_ideal.py\"\n  ***   Warning: precision too low for generators, not given.\n**********************************************************************\nFile \"/release/merger/sage-5.5.beta1/devel/sage/sage/rings/number_field/number_field_ideal.py\", line 2462:\n    sage: G.gens_values()\nExpected:\n    (2*a^2 - 1, 2*a^2 + 2*a - 2)\nGot:\n    (2*a - 1, 2*a^2 + 2*a - 2)\n**********************************************************************\n```",
    "created_at": "2012-11-14T15:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160622",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Long doctests fail:

```
sage -t -long "devel/sage/sage/rings/number_field/number_field_ideal.py"
  ***   Warning: precision too low for generators, not given.
**********************************************************************
File "/release/merger/sage-5.5.beta1/devel/sage/sage/rings/number_field/number_field_ideal.py", line 2462:
    sage: G.gens_values()
Expected:
    (2*a^2 - 1, 2*a^2 + 2*a - 2)
Got:
    (2*a - 1, 2*a^2 + 2*a - 2)
**********************************************************************
```



---

archive/issue_events_189822.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-14T15:53:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189822"
}
```



---

archive/issue_events_189823.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-14T15:53:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189823"
}
```



---

archive/issue_comments_160623.json:
```json
{
    "body": "Attachment: **[trac_13687_review.patch.gz](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)**\n\nImproved patch",
    "created_at": "2012-11-14T20:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160623",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13687_review.patch.gz](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)**

Improved patch



---

archive/issue_events_189824.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-14T20:52:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189824"
}
```



---

archive/issue_events_189825.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-14T20:52:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189825"
}
```



---

archive/issue_comments_160624.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI've marked the offending doctest as `# random `, which is what it was before the patch.",
    "created_at": "2012-11-14T20:52:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160624",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:17" align="right">comment:17</div>

I've marked the offending doctest as `# random `, which is what it was before the patch.



---

archive/issue_comments_160625.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThis patch introduces some bad uses of `assert`. You should only use \"assert\" to check for actual bugs, not for bad user input. If there is any way at all to reproduce an AssertionError using documented public functions, that is by definition a bug.",
    "created_at": "2012-11-15T08:19:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160625",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

This patch introduces some bad uses of `assert`. You should only use "assert" to check for actual bugs, not for bad user input. If there is any way at all to reproduce an AssertionError using documented public functions, that is by definition a bug.



---

archive/issue_comments_160626.json:
```json
{
    "body": "Work Issues: **bad use of assert**",
    "created_at": "2012-11-15T08:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160626",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **bad use of assert**



---

archive/issue_events_189826.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-15T08:20:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189826"
}
```



---

archive/issue_events_189827.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-15T08:20:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189827"
}
```



---

archive/issue_comments_160627.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nMost importantly, you must never use `assert` for control flow. So the following is very wrong:\n\n```\ntry:\n    ...\nexcept AssertionError:\n    ...\n```",
    "created_at": "2012-11-15T08:21:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160627",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Most importantly, you must never use `assert` for control flow. So the following is very wrong:

```
try:
    ...
except AssertionError:
    ...
```



---

archive/issue_events_189828.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-15T17:20:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189828"
}
```



---

archive/issue_events_189829.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-15T17:20:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189829"
}
```



---

archive/issue_comments_160628.json:
```json
{
    "body": "Changed work issues from **bad use of assert** to none",
    "created_at": "2012-11-15T17:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160628",
    "user": "https://github.com/vbraun"
}
```

Changed work issues from **bad use of assert** to none



---

archive/issue_comments_160629.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAgreed, but its only \"introduced\" in the sense that I copied the old `groups.pyx` to `old.pyx` to support old-style parents until every group is switched over. I've cleaned up the `AssertionError` in the new `group.pyx` but not in the `old.pyx`.",
    "created_at": "2012-11-15T17:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160629",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:21" align="right">comment:21</div>

Agreed, but its only "introduced" in the sense that I copied the old `groups.pyx` to `old.pyx` to support old-style parents until every group is switched over. I've cleaned up the `AssertionError` in the new `group.pyx` but not in the `old.pyx`.



---

archive/issue_comments_160630.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n Apply\n * [attachment: trac_13687_Parent_for_groups.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)\n * [attachment: trac_13687_review.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)\n+* [attachment: trac_13687_assertions.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_assertions.patch.gz)\n``````\n",
    "created_at": "2012-11-15T17:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160630",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 Apply
 * [attachment: trac_13687_Parent_for_groups.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)
 * [attachment: trac_13687_review.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)
+* [attachment: trac_13687_assertions.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_assertions.patch.gz)
``````




---

archive/issue_comments_160631.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-11-22T21:06:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160631",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_160632.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAttachment: **[trac_13687_assertions.patch.gz](https://github.com/sagemath/sage/files/ticket13687/trac_13687_assertions.patch.gz)**\n\nI can't seem to be able to apply the patch on sage-5.4.1 Is it rebased for some other version? Or maybe it conflicts with patches from #13211, #6391 or #13588?",
    "created_at": "2012-12-04T13:33:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160632",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:22" align="right">comment:22</div>

Attachment: **[trac_13687_assertions.patch.gz](https://github.com/sagemath/sage/files/ticket13687/trac_13687_assertions.patch.gz)**

I can't seem to be able to apply the patch on sage-5.4.1 Is it rebased for some other version? Or maybe it conflicts with patches from #13211, #6391 or #13588?



---

archive/issue_comments_160633.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI have based the patches on sage-5.5.rc0. Can you give that a try?",
    "created_at": "2012-12-04T14:14:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160633",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">comment:23</div>

I have based the patches on sage-5.5.rc0. Can you give that a try?



---

archive/issue_comments_160634.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nYes, that works. Thank you.",
    "created_at": "2012-12-04T18:43:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160634",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:24" align="right">comment:24</div>

Yes, that works. Thank you.



---

archive/issue_comments_160635.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSo, Jeroen, would you be happy with a positive review now that the assertion issue is cleaned from the new code, but kept in the old one?  Or should we make the full transition of groups before accepting this?",
    "created_at": "2013-01-03T09:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160635",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:25" align="right">comment:25</div>

So, Jeroen, would you be happy with a positive review now that the assertion issue is cleaned from the new code, but kept in the old one?  Or should we make the full transition of groups before accepting this?



---

archive/issue_comments_160636.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI combined and rebased the patches and marked `old.pyx` and `old.pxd` as copies.",
    "created_at": "2013-01-03T09:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160636",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

I combined and rebased the patches and marked `old.pyx` and `old.pxd` as copies.



---

archive/issue_comments_160637.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,6 +12,4 @@\n I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.\n \n Apply\n-* [attachment: trac_13687_Parent_for_groups.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)\n-* [attachment: trac_13687_review.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)\n-* [attachment: trac_13687_assertions.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_assertions.patch.gz)\n+* [attachment: 13687_parent_for_groups_all.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)\n``````\n",
    "created_at": "2013-01-03T09:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160637",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,6 +12,4 @@
 I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.
 
 Apply
-* [attachment: trac_13687_Parent_for_groups.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_Parent_for_groups.patch.gz)
-* [attachment: trac_13687_review.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_review.patch.gz)
-* [attachment: trac_13687_assertions.patch](https://github.com/sagemath/sage/files/ticket13687/trac_13687_assertions.patch.gz)
+* [attachment: 13687_parent_for_groups_all.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)
``````




---

archive/issue_comments_160638.json:
```json
{
    "body": "Attachment: **[13687_parent_for_groups_all.patch.gz](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)**",
    "created_at": "2013-01-03T09:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160638",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[13687_parent_for_groups_all.patch.gz](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)**



---

archive/issue_comments_160639.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nIt's not required to fix all of `old.pyx`. If the *newly introduced assertions* are fine, then that's sufficient.",
    "created_at": "2013-01-03T09:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160639",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

It's not required to fix all of `old.pyx`. If the *newly introduced assertions* are fine, then that's sufficient.



---

archive/issue_events_189830.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-24T12:35:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189830"
}
```



---

archive/issue_events_189831.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-24T12:35:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189831"
}
```



---

archive/issue_comments_160640.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI'm fine with the rebasing... don't think there is anything else to review.",
    "created_at": "2013-01-24T12:35:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160640",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:28" align="right">comment:28</div>

I'm fine with the rebasing... don't think there is anything else to review.



---

archive/issue_events_189832.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-26T10:47:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189832"
}
```



---

archive/issue_events_189833.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-26T10:47:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189833"
}
```



---

archive/issue_comments_160641.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThis needs to rebased to sage-5.7.beta1.",
    "created_at": "2013-01-26T10:47:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160641",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

This needs to rebased to sage-5.7.beta1.



---

archive/issue_comments_160642.json:
```json
{
    "body": "Attachment: **[13687_parent_for_groups_all_vb.patch.gz](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all_vb.patch.gz)**\n\nUpdated patch",
    "created_at": "2013-01-26T17:58:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160642",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[13687_parent_for_groups_all_vb.patch.gz](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all_vb.patch.gz)**

Updated patch



---

archive/issue_comments_160643.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nRebased to sage-5.7.beta1",
    "created_at": "2013-01-26T18:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160643",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:30" align="right">comment:30</div>

Rebased to sage-5.7.beta1



---

archive/issue_events_189834.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-26T18:32:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189834"
}
```



---

archive/issue_events_189835.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-26T18:32:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189835"
}
```



---

archive/issue_comments_160644.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI ran into a strange issue here: http://tracker.gap-system.org/issues/224. I've added a larger initial workspace size (`-m 64m`) which should be a workaround. In any case it has nothing to do with upgrading the group parents.",
    "created_at": "2013-01-26T18:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160644",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:31" align="right">comment:31</div>

I ran into a strange issue here: http://tracker.gap-system.org/issues/224. I've added a larger initial workspace size (`-m 64m`) which should be a workaround. In any case it has nothing to do with upgrading the group parents.



---

archive/issue_events_189836.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-29T20:36:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189836"
}
```



---

archive/issue_events_189837.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-29T20:36:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189837"
}
```



---

archive/issue_comments_160645.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThere are 2 failures on 32-bit:\n\n```\nsage -t  --long -force_lib devel/sage/sage/rings/number_field/unit_group.py\n**********************************************************************\nFile \"/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.7.beta2/devel/sage-main/sage/rings/number_field/unit_group.py\", line 138:\n    sage: u.value()\nExpected:\n    -1/4*a^3 - 7/4*a^2 - 17/4*a - 19/4\nGot:\n    -1/4*a^3 + 7/4*a^2 - 17/4*a + 19/4\n**********************************************************************\nsage -t  --long -force_lib devel/sage/sage/rings/polynomial/polynomial_quotient_ring.py\n**********************************************************************\nFile \"/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.7.beta2/devel/sage-main/sage/rings/polynomial/polynomial_quotient_ring.py\", line 974:\n    sage: S.S_class_group([K.ideal(a)])\nExpected:\n    [((2, -a + 1, 1/2*xbar + 1/2, -1/2*a*xbar + 1/2*a + 1), 6, 1/2*xbar - 3/2)] \nGot:\n    [((2, -a + 1, 1/2*xbar + 1/2, -1/2*a*xbar + 1/2*a + 1), 6, -1/2*xbar + 3/2)]\n**********************************************************************\n```",
    "created_at": "2013-01-29T20:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160645",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

There are 2 failures on 32-bit:

```
sage -t  --long -force_lib devel/sage/sage/rings/number_field/unit_group.py
**********************************************************************
File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.7.beta2/devel/sage-main/sage/rings/number_field/unit_group.py", line 138:
    sage: u.value()
Expected:
    -1/4*a^3 - 7/4*a^2 - 17/4*a - 19/4
Got:
    -1/4*a^3 + 7/4*a^2 - 17/4*a + 19/4
**********************************************************************
sage -t  --long -force_lib devel/sage/sage/rings/polynomial/polynomial_quotient_ring.py
**********************************************************************
File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.7.beta2/devel/sage-main/sage/rings/polynomial/polynomial_quotient_ring.py", line 974:
    sage: S.S_class_group([K.ideal(a)])
Expected:
    [((2, -a + 1, 1/2*xbar + 1/2, -1/2*a*xbar + 1/2*a + 1), 6, 1/2*xbar - 3/2)] 
Got:
    [((2, -a + 1, 1/2*xbar + 1/2, -1/2*a*xbar + 1/2*a + 1), 6, -1/2*xbar + 3/2)]
**********************************************************************
```



---

archive/issue_comments_160646.json:
```json
{
    "body": "Attachment: **[13687_32bitfix.patch.gz](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)**\n\nInitial patch",
    "created_at": "2013-01-29T22:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160646",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[13687_32bitfix.patch.gz](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)**

Initial patch



---

archive/issue_events_189838.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-29T22:03:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189838"
}
```



---

archive/issue_events_189839.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-29T22:03:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189839"
}
```



---

archive/issue_comments_160647.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI've added the necessary `# 32-bit` clauses...",
    "created_at": "2013-01-29T22:03:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160647",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

I've added the necessary `# 32-bit` clauses...



---

archive/issue_comments_160648.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,3 +13,4 @@\n \n Apply\n * [attachment: 13687_parent_for_groups_all.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)\n+* [attachment: 13687_32bitfix.patch](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)\n``````\n",
    "created_at": "2013-01-29T22:03:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160648",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,3 +13,4 @@
 
 Apply
 * [attachment: 13687_parent_for_groups_all.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)
+* [attachment: 13687_32bitfix.patch](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)
``````




---

archive/issue_comments_160649.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,5 +12,5 @@\n I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.\n \n Apply\n-* [attachment: 13687_parent_for_groups_all.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)\n+* [attachment: 13687_parent_for_groups_all_vb.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all_vb.patch.gz)\n * [attachment: 13687_32bitfix.patch](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)\n``````\n",
    "created_at": "2013-01-30T08:22:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160649",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,5 +12,5 @@
 I haven't actually deprecated `.invariants()` and `.list()`, just changed the documentation to suggest the equivalent `.gens_orders()` and .exponents()` methods. But I think we should deprecate them. Though I first want to work my way through the remaining groups code.
 
 Apply
-* [attachment: 13687_parent_for_groups_all.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all.patch.gz)
+* [attachment: 13687_parent_for_groups_all_vb.patch](https://github.com/sagemath/sage/files/ticket13687/13687_parent_for_groups_all_vb.patch.gz)
 * [attachment: 13687_32bitfix.patch](https://github.com/sagemath/sage/files/ticket13687/13687_32bitfix.patch.gz)
``````




---

archive/issue_comments_160650.json:
```json
{
    "body": "Merged: **sage-5.7.beta2**",
    "created_at": "2013-01-31T09:20:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13687#issuecomment-160650",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.7.beta2**



---

archive/issue_events_189840.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-31T09:20:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189840"
}
```



---

archive/issue_events_189841.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-31T09:20:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13687",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13687#event-189841"
}
```
