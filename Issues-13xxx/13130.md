# Issue 13130: Ring support for projective space points and morphisms

archive/issues_012958.json:
```json
{
    "assignees": [
        "https://github.com/bhutz"
    ],
    "body": "Projective points and morphisms are currently only support over fields. Support for rings is needed.\n\n\nApply:\n* [attachment: trac_13130_rings_for_projective_space.patch](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space.patch.gz)\n\nCC:  @mminzlaff\n\nKeywords: **projective space ring**\n\nReviewer: **Michelle Manes**\n\nAuthor: **Ben Hutz**\n\nMerged: **sage-5.8.beta3**\n\nComponent: **algebraic geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13130_\n\n",
    "closed_at": "2013-03-04T07:37:05Z",
    "created_at": "2012-06-18T14:59:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Ring support for projective space points and morphisms",
    "type": "issue",
    "updated_at": "2013-03-06T13:52:03Z",
    "url": "https://github.com/sagemath/sage/issues/13130",
    "user": "https://github.com/bhutz"
}
```
Projective points and morphisms are currently only support over fields. Support for rings is needed.


Apply:
* [attachment: trac_13130_rings_for_projective_space.patch](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space.patch.gz)

CC:  @mminzlaff

Keywords: **projective space ring**

Reviewer: **Michelle Manes**

Author: **Ben Hutz**

Merged: **sage-5.8.beta3**

Component: **algebraic geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/13130_





---

archive/issue_events_182373.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-06-18T14:59:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182373"
}
```



---

archive/issue_events_182374.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-06-18T14:59:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182374"
}
```



---

archive/issue_events_182375.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-06-18T14:59:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182375"
}
```



---

archive/issue_events_182376.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-06-18T14:59:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182376"
}
```



---

archive/issue_events_182377.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-06-18T14:59:31Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "subject": "https://github.com/bhutz",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182377"
}
```



---

archive/issue_comments_150201.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSummary: Adding support for rings in projective spaces.\n\nSee comments from: https://groups.google.com/forum/?fromgroups#!topic/sage-devel/HXXqQ_XP358\n\n\npoint.py:\n\n-no automatic normalization (as is currently done with fields)\n\n-implemented `__eq__` and `__ne__`, added a note in `__cmp__` for ell_point.py that `__eq__` and `__ne__` are implemented for projective points\n\n-implemented scale_by() - scales the coordinates by a given amount\n\n-implemented normalize_coordinates() - removes the gcd of the coordinates\n\n\nmorphism.py:\n\n-no automatic gcd removal (even over CC this does not work)\nThis change reverses part of Trac: 3964 (https://github.com/sagemath/sage/issues/3964)\n\n-removed \"immutable\" for .__polys since you can scale projective coordinates\n\n-added \"check\" to `__call__` to help deal with indeterminacies and allow for bypassing the initialization checks for points\n\n-implemented scale_by() - scales the coordinates by a given amount\n\n-implemented normalize_coordinates() - removes the gcd of the coordinates\n\n\nhomset.py:\n\n-allowed rings\n\n\nprojective_space.py:\n\n-implemented dimension() - since the current implementation was giving incorrect values when the base ring is a ring (for example ZZ)\n\n\ngeneral changes:\n\n-added many examples\n\n-cleaned up imports",
    "created_at": "2012-06-18T15:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150201",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:1" align="right">comment:1</div>

Summary: Adding support for rings in projective spaces.

See comments from: https://groups.google.com/forum/?fromgroups#!topic/sage-devel/HXXqQ_XP358


point.py:

-no automatic normalization (as is currently done with fields)

-implemented `__eq__` and `__ne__`, added a note in `__cmp__` for ell_point.py that `__eq__` and `__ne__` are implemented for projective points

-implemented scale_by() - scales the coordinates by a given amount

-implemented normalize_coordinates() - removes the gcd of the coordinates


morphism.py:

-no automatic gcd removal (even over CC this does not work)
This change reverses part of Trac: 3964 (https://github.com/sagemath/sage/issues/3964)

-removed "immutable" for .__polys since you can scale projective coordinates

-added "check" to `__call__` to help deal with indeterminacies and allow for bypassing the initialization checks for points

-implemented scale_by() - scales the coordinates by a given amount

-implemented normalize_coordinates() - removes the gcd of the coordinates


homset.py:

-allowed rings


projective_space.py:

-implemented dimension() - since the current implementation was giving incorrect values when the base ring is a ring (for example ZZ)


general changes:

-added many examples

-cleaned up imports



---

archive/issue_events_182378.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-06-18T15:20:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182378"
}
```



---

archive/issue_comments_150202.json:
```json
{
    "body": "Changed author from **bhutz** to **Ben Hutz**",
    "created_at": "2012-06-18T18:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150202",
    "user": "https://github.com/novoselt"
}
```

Changed author from **bhutz** to **Ben Hutz**



---

archive/issue_comments_150203.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nUpdated so that it applies on Sage-5.1",
    "created_at": "2012-07-17T12:10:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150203",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:4" align="right">comment:4</div>

Updated so that it applies on Sage-5.1



---

archive/issue_comments_150204.json:
```json
{
    "body": "Replaces trac_13130_rings_for_projective_space.patch",
    "created_at": "2012-08-04T18:37:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150204",
    "user": "https://github.com/annahaensch"
}
```

Replaces trac_13130_rings_for_projective_space.patch



---

archive/issue_comments_150205.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAttachment: **[trac_13130_rings_for_projective_space_v2.patch.gz](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space_v2.patch.gz)**\n\nI ran -t on each of the following files:\n\n* schemes/elliptic_curves/ell_point.py\n* schemes/generic/homset.py\n* schemes/generic/morphism.py\n* schemes/generic/point.py\n* schemes/generic/projective_space.py\n* schemes/readme.py\n\nand \"All tests passed!\" \n\nI ran -coverage to check the doctest coverage, all affected files had 100% coverage, except: \n\n* schemes/generic/morphism.py (95%) \n* schemes/generic/point.py (37%)\n\n****************\nI brought morphism.py to 100%, but point.py is still missing things.\n\nI ran --testall --long and got the following error:\n\n```\n******************************\nFile \"/Users/annahaensch/sage-5.2/devel/sage/sage/interfaces/r.py\", line 1169:\n    sage: os.path.realpath(tmpdir) == sageobj(r.getwd())\nExpected:\n    True\nGot:\n    False\n******************************************\n1 items had failures:\n   1 of   7 in __main__.example_43\nTest Failed**** 1 failures.\n```\n\nJust to be sure, I ran a longtest just on interfaces/r.py, and all tests passed, which is unsurprising, since this patch doesn't touch that file\u2026not sure what to do about that one.\n\nI ran -docbuild reference html and got one LaTex error, line 531 of sage/schemes/generic/projective_space.py.  Changed <code>\\`\\PP^N\\`</code> to <code>'\\mathbb{P}^N\\` </code>.",
    "created_at": "2012-08-04T18:45:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150205",
    "user": "https://github.com/annahaensch"
}
```

<div id="comment:5" align="right">comment:5</div>

Attachment: **[trac_13130_rings_for_projective_space_v2.patch.gz](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space_v2.patch.gz)**

I ran -t on each of the following files:

* schemes/elliptic_curves/ell_point.py
* schemes/generic/homset.py
* schemes/generic/morphism.py
* schemes/generic/point.py
* schemes/generic/projective_space.py
* schemes/readme.py

and "All tests passed!" 

I ran -coverage to check the doctest coverage, all affected files had 100% coverage, except: 

* schemes/generic/morphism.py (95%) 
* schemes/generic/point.py (37%)

****************
I brought morphism.py to 100%, but point.py is still missing things.

I ran --testall --long and got the following error:

```
******************************
File "/Users/annahaensch/sage-5.2/devel/sage/sage/interfaces/r.py", line 1169:
    sage: os.path.realpath(tmpdir) == sageobj(r.getwd())
Expected:
    True
Got:
    False
******************************************
1 items had failures:
   1 of   7 in __main__.example_43
Test Failed**** 1 failures.
```

Just to be sure, I ran a longtest just on interfaces/r.py, and all tests passed, which is unsurprising, since this patch doesn't touch that fileâ€¦not sure what to do about that one.

I ran -docbuild reference html and got one LaTex error, line 531 of sage/schemes/generic/projective_space.py.  Changed <code>\`\PP^N\`</code> to <code>'\mathbb{P}^N\` </code>.



---

archive/issue_events_182379.json:
```json
{
    "actor": "https://github.com/annahaensch",
    "created_at": "2012-08-04T18:46:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182379"
}
```



---

archive/issue_events_182380.json:
```json
{
    "actor": "https://github.com/annahaensch",
    "created_at": "2012-08-04T18:46:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182380"
}
```



---

archive/issue_comments_150206.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWhat is the reason for `needs_work`?\n\nMore importantly - what is the reason for replacing the original patch? Do you propose a different implementation? Why? What are the differences?",
    "created_at": "2012-08-04T20:12:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150206",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:7" align="right">comment:7</div>

What is the reason for `needs_work`?

More importantly - what is the reason for replacing the original patch? Do you propose a different implementation? Why? What are the differences?



---

archive/issue_comments_150207.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAs I describe in the comment above, the new patch reflects some minor changes to bring doctest coverage up to 100% and fix the docbuild errors.  Also, mentioned above, it still fails to pass the long test, due to some errors in r functionality, which is why the patch needs_work.",
    "created_at": "2012-08-04T22:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150207",
    "user": "https://github.com/annahaensch"
}
```

<div id="comment:8" align="right">comment:8</div>

As I describe in the comment above, the new patch reflects some minor changes to bring doctest coverage up to 100% and fix the docbuild errors.  Also, mentioned above, it still fails to pass the long test, due to some errors in r functionality, which is why the patch needs_work.



---

archive/issue_comments_150208.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThanks for reviewing this Anna (and the doc fix).  Just to be sure I understand the current situation:\n\nwhen you run --testall --long you get an error in r.py, but when you run -t --long on r.py you get all passed?",
    "created_at": "2012-08-04T22:31:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150208",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:9" align="right">comment:9</div>

Thanks for reviewing this Anna (and the doc fix).  Just to be sure I understand the current situation:

when you run --testall --long you get an error in r.py, but when you run -t --long on r.py you get all passed?



---

archive/issue_comments_150209.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@bhutz](#comment:9):\n> Thanks for reviewing this Anna (and the doc fix).  Just to be sure I understand the current situation:\n> \n> when you run --testall --long you get an error in r.py, but when you run -t --long on r.py you get all passed?\n\nThat's correct.  The patch must call some routines from r.py, but not actually touch r.py.",
    "created_at": "2012-08-04T22:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150209",
    "user": "https://github.com/annahaensch"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@bhutz](#comment:9):
> Thanks for reviewing this Anna (and the doc fix).  Just to be sure I understand the current situation:
> 
> when you run --testall --long you get an error in r.py, but when you run -t --long on r.py you get all passed?

That's correct.  The patch must call some routines from r.py, but not actually touch r.py.



---

archive/issue_comments_150210.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nIf the new patch reflect some minor changes, it should be a small reviewer patch on top of the original (quite big) one. If the original patch cannot be applied anymore at all, that's another issue.\n\nIt is also not clear if failures in `r.py` are related to this ticket. Do you always get an error with `--testall` when this patch is installed and never without it?",
    "created_at": "2012-08-04T22:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150210",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:11" align="right">comment:11</div>

If the new patch reflect some minor changes, it should be a small reviewer patch on top of the original (quite big) one. If the original patch cannot be applied anymore at all, that's another issue.

It is also not clear if failures in `r.py` are related to this ticket. Do you always get an error with `--testall` when this patch is installed and never without it?



---

archive/issue_comments_150211.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@novoselt](#comment:11):\n> If the new patch reflect some minor changes, it should be a small reviewer patch on top of the original (quite big) one. If the original patch cannot be applied anymore at all, that's another issue.\n> \n\nI wasn't sure what the convention was for fixing patches.  If that's easier, I can certainly upload a new patch to reflect that convention.\n\n> It is also not clear if failures in `r.py` are related to this ticket. Do you always get an error with `--testall` when this patch is installed and never without it?\n\nThat's correct.  Before testing this patch I built sage-5.2 from source and ran --testall --long, and all tests passed.  I applied the patch, re-ran the test, and got the error.",
    "created_at": "2012-08-04T22:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150211",
    "user": "https://github.com/annahaensch"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@novoselt](#comment:11):
> If the new patch reflect some minor changes, it should be a small reviewer patch on top of the original (quite big) one. If the original patch cannot be applied anymore at all, that's another issue.
> 

I wasn't sure what the convention was for fixing patches.  If that's easier, I can certainly upload a new patch to reflect that convention.

> It is also not clear if failures in `r.py` are related to this ticket. Do you always get an error with `--testall` when this patch is installed and never without it?

That's correct.  Before testing this patch I built sage-5.2 from source and ran --testall --long, and all tests passed.  I applied the patch, re-ran the test, and got the error.



---

archive/issue_comments_150212.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@annahaensch](#comment:12):\n> Replying to [@novoselt](#comment:11):\n> > If the new patch reflect some minor changes, it should be a small reviewer patch on top of the original (quite big) one. If the original patch cannot be applied anymore at all, that's another issue.\n> > \n\n> \n> I wasn't sure what the convention was for fixing patches.  If that's easier, I can certainly upload a new patch to reflect that convention.\n> \n\nPlease do ;-)\n\n> > It is also not clear if failures in `r.py` are related to this ticket. Do you always get an error with `--testall` when this patch is installed and never without it?\n\n> \n> That's correct.  Before testing this patch I built sage-5.2 from source and ran --testall --long, and all tests passed.  I applied the patch, re-ran the test, and got the error.  \n\nSo - you ran tests ONCE without the patch and there were no error and then ONCE with the patch and there was one? If that is the case and the error does not appear when testing that file separately, it is still quite that you hit a sporadic bug which is not relates to this ticket (and I am pretty sure I've seen recently other complains on this module). Can you test with the patch and `--testall --long` again several times and see if it is always the same failure?",
    "created_at": "2012-08-05T00:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150212",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@annahaensch](#comment:12):
> Replying to [@novoselt](#comment:11):
> > If the new patch reflect some minor changes, it should be a small reviewer patch on top of the original (quite big) one. If the original patch cannot be applied anymore at all, that's another issue.
> > 

> 
> I wasn't sure what the convention was for fixing patches.  If that's easier, I can certainly upload a new patch to reflect that convention.
> 

Please do ;-)

> > It is also not clear if failures in `r.py` are related to this ticket. Do you always get an error with `--testall` when this patch is installed and never without it?

> 
> That's correct.  Before testing this patch I built sage-5.2 from source and ran --testall --long, and all tests passed.  I applied the patch, re-ran the test, and got the error.  

So - you ran tests ONCE without the patch and there were no error and then ONCE with the patch and there was one? If that is the case and the error does not appear when testing that file separately, it is still quite that you hit a sporadic bug which is not relates to this ticket (and I am pretty sure I've seen recently other complains on this module). Can you test with the patch and `--testall --long` again several times and see if it is always the same failure?



---

archive/issue_comments_150213.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nFor the original patch:\n* `NOTES::` should be formatted as `.. note::`\n* Names of methods, types, etc. should be at the very least double quoted like <code>\\`\\`__eq__\\`\\`</code> or better yet referred to like <code>:class:\\`ValueError\\`</code>\n* Why `_element_constructor_` was removed? It is part of the coercion framework and it is likely that it has to be present.\n* It looks to me like the code of `class SchemeMorphism_polynomial_projective_space` was moved inside the same file. Why? Was it changed?\n* Input/output is not documented everywhere and formatting is not always correct. See http://www.sagemath.org/doc/developer/conventions.html#documentation-strings\n* `dimension` method is defined to just return `relative_dimension` Why??? `dimension` does work already and works differently:\n\n ```\n sage: ProjectiveSpace(3,QQ[\"y\"],'x').dimension_relative()\n 3\n sage: ProjectiveSpace(3,QQ[\"y\"],'x').dimension()\n 4\n```\n The patch breaks backward compatibility and makes dimension inconsistent between different spaces.",
    "created_at": "2012-08-05T00:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150213",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:14" align="right">comment:14</div>

For the original patch:
* `NOTES::` should be formatted as `.. note::`
* Names of methods, types, etc. should be at the very least double quoted like <code>\`\`__eq__\`\`</code> or better yet referred to like <code>:class:\`ValueError\`</code>
* Why `_element_constructor_` was removed? It is part of the coercion framework and it is likely that it has to be present.
* It looks to me like the code of `class SchemeMorphism_polynomial_projective_space` was moved inside the same file. Why? Was it changed?
* Input/output is not documented everywhere and formatting is not always correct. See http://www.sagemath.org/doc/developer/conventions.html#documentation-strings
* `dimension` method is defined to just return `relative_dimension` Why??? `dimension` does work already and works differently:

 ```
 sage: ProjectiveSpace(3,QQ["y"],'x').dimension_relative()
 3
 sage: ProjectiveSpace(3,QQ["y"],'x').dimension()
 4
```
 The patch breaks backward compatibility and makes dimension inconsistent between different spaces.



---

archive/issue_comments_150214.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nas another data point the --testall --long passes on my machine (Ubuntu)\n\nTo answer the questions in the last comment:\n\nThe formatting I can address. I had thought I'd followed the conventions, but I'll go back through and check all the changes.\n\n_element_constructor was removed since it was simply returning NotImplemented. As in \npoints_projective_field, removing that place holder allows the SchemeHomset_points _element_constructor to be used for point_projective_ring\n\n\nSchemeMorphism_polynomial_projective_space was moved to have the projective classes together. If it is more standard in Sage to have the `_polynomial_` classes together, then I can certainly move it back.\n\n\nDimension was changed since it seemed to be not working for projective spaces. Before the new dimension function you would get\n\nsage: ProjectiveSpace(QQ,2,'x').dimension()\n\n2\n\nsage: ProjectiveSpace(ZZ,2,'x').dimension()\n\n3\n\nI assumed that the value for ZZ was wrong. Although it seems that Spec(ZZ).dimension() does in fact return 1 while Spec(QQ).dimension() returns 0. Is this really the desired behavior, that the dimension of projective space over the integers is +1?",
    "created_at": "2012-08-05T01:24:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150214",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:15" align="right">comment:15</div>

as another data point the --testall --long passes on my machine (Ubuntu)

To answer the questions in the last comment:

The formatting I can address. I had thought I'd followed the conventions, but I'll go back through and check all the changes.

_element_constructor was removed since it was simply returning NotImplemented. As in 
points_projective_field, removing that place holder allows the SchemeHomset_points _element_constructor to be used for point_projective_ring


SchemeMorphism_polynomial_projective_space was moved to have the projective classes together. If it is more standard in Sage to have the `_polynomial_` classes together, then I can certainly move it back.


Dimension was changed since it seemed to be not working for projective spaces. Before the new dimension function you would get

sage: ProjectiveSpace(QQ,2,'x').dimension()

2

sage: ProjectiveSpace(ZZ,2,'x').dimension()

3

I assumed that the value for ZZ was wrong. Although it seems that Spec(ZZ).dimension() does in fact return 1 while Spec(QQ).dimension() returns 0. Is this really the desired behavior, that the dimension of projective space over the integers is +1?



---

archive/issue_comments_150215.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nIt is standard in Sage to keep track of who is doing what and why, if you rearrange a file, then you will be shown as the author of new lines and this ticket will be listed as a reason for its addition. There can be different schemes of arranging names and classes (e.g. I like to have everything alphabetically). I don't think we have any standard conventions for that. But you should never \"just move\" existing code because of the history loss.\n\nIntegers have a chain of prime ideals of length 1, e.g. (0) contained in (2), so its dimension is one. Rationals have dimension zero since there is only one prime ideal (length of the chain is zero), as for other fields.\n\nIf you look at the documentation of existing dimension function, you will see that it is indeed supposed to work like this: dimension of the base ring is taken into consideration. Moreover, you can see that there are long names for either way `dimension_absolute` and `dimension_relative`, and just `dimension` is explicitly shown to work as `dimension_absolute`. So it is definitely not a good idea to make this \"default\" dimension mean relative in the case of projective spaces.",
    "created_at": "2012-08-05T03:04:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150215",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:16" align="right">comment:16</div>

It is standard in Sage to keep track of who is doing what and why, if you rearrange a file, then you will be shown as the author of new lines and this ticket will be listed as a reason for its addition. There can be different schemes of arranging names and classes (e.g. I like to have everything alphabetically). I don't think we have any standard conventions for that. But you should never "just move" existing code because of the history loss.

Integers have a chain of prime ideals of length 1, e.g. (0) contained in (2), so its dimension is one. Rationals have dimension zero since there is only one prime ideal (length of the chain is zero), as for other fields.

If you look at the documentation of existing dimension function, you will see that it is indeed supposed to work like this: dimension of the base ring is taken into consideration. Moreover, you can see that there are long names for either way `dimension_absolute` and `dimension_relative`, and just `dimension` is explicitly shown to work as `dimension_absolute`. So it is definitely not a good idea to make this "default" dimension mean relative in the case of projective spaces.



---

archive/issue_comments_150216.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI've made the following changes:\n\n- found and fixed the formatting\n- included the docstring fix and the coverage fix from Anna's version\n- no longer implement a dimension function\n- returned the :class:SchemeMorphism_polynomial_projective_space to its original location\n\ntestall passes on my machine.\n\nHowever, I'm not sure what the right step for the file attachment is. I can replace my original patch with my new one, but cannot replace or remove Anna's version.  Should I replace my original version or upload it as a new (3rd) version?",
    "created_at": "2012-08-05T16:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150216",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:17" align="right">comment:17</div>

I've made the following changes:

- found and fixed the formatting
- included the docstring fix and the coverage fix from Anna's version
- no longer implement a dimension function
- returned the :class:SchemeMorphism_polynomial_projective_space to its original location

testall passes on my machine.

However, I'm not sure what the right step for the file attachment is. I can replace my original patch with my new one, but cannot replace or remove Anna's version.  Should I replace my original version or upload it as a new (3rd) version?



---

archive/issue_comments_150217.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nUsually it is OK to replace your patch with an updated one. When there is more than one patch on the ticket, it is also a good idea to include \"Apply\" section in the description, see e.g. #11763. This is for reviewers and the release manager, who should not go through all the comments once this ticket is ready to be merged. You can also add a comment \"Apply ...\" for the patchbot, but it is moody and does not always pick it up.",
    "created_at": "2012-08-05T16:44:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150217",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:18" align="right">comment:18</div>

Usually it is OK to replace your patch with an updated one. When there is more than one patch on the ticket, it is also a good idea to include "Apply" section in the description, see e.g. #11763. This is for reviewers and the release manager, who should not go through all the comments once this ticket is ready to be merged. You can also add a comment "Apply ..." for the patchbot, but it is moody and does not always pick it up.



---

archive/issue_comments_150218.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n Projective points and morphisms are currently only support over fields. Support for rings is needed.\n+\n+\n+Apply:\n+* [attachment: trac_13130_rings_for_projective_space.patch](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space.patch.gz)\n``````\n",
    "created_at": "2012-08-05T17:35:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150218",
    "user": "https://github.com/bhutz"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 Projective points and morphisms are currently only support over fields. Support for rings is needed.
+
+
+Apply:
+* [attachment: trac_13130_rings_for_projective_space.patch](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space.patch.gz)
``````




---

archive/issue_events_182381.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-08-05T17:59:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182381"
}
```



---

archive/issue_events_182382.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2012-08-05T17:59:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182382"
}
```



---

archive/issue_comments_150219.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI went to check this on 5.3 and noticed that I had implemented scale_by() and normalize_coordinates() in class::SchemeMorphism_polynomial. That was wrong since they should only apply to projective maps. So I've moved those to SchemeMorphism_polynomial_projective_space.\n\nThey modify the _ _polys attribute of the SchememMorphism_polynomial, but a _ _ attribute is private. Since it makes sense to inherit the polys attribute, I changed it to ._polys. I checked through the source and found no place where that created an issue and all tests currently pass.\n\nAlso, I noticed that somehow I've created a bunch of\n\n_ 'blank line'\n\n+ 'blank line'\n\nI tried to removed those directly from the patch file and wrecked patch. If someone could tell me how to get those out of there, I'd like to remove them.",
    "created_at": "2012-10-05T13:51:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150219",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:22" align="right">comment:22</div>

I went to check this on 5.3 and noticed that I had implemented scale_by() and normalize_coordinates() in class::SchemeMorphism_polynomial. That was wrong since they should only apply to projective maps. So I've moved those to SchemeMorphism_polynomial_projective_space.

They modify the _ _polys attribute of the SchememMorphism_polynomial, but a _ _ attribute is private. Since it makes sense to inherit the polys attribute, I changed it to ._polys. I checked through the source and found no place where that created an issue and all tests currently pass.

Also, I noticed that somehow I've created a bunch of

_ 'blank line'

+ 'blank line'

I tried to removed those directly from the patch file and wrecked patch. If someone could tell me how to get those out of there, I'd like to remove them.



---

archive/issue_comments_150220.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nUpdated to work with Sage 5.5.",
    "created_at": "2013-01-03T17:19:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150220",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:23" align="right">comment:23</div>

Updated to work with Sage 5.5.



---

archive/issue_comments_150221.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nWhile working on something else, I found a bug in the patch. It's been fixed and the new patch uploaded.",
    "created_at": "2013-01-08T16:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150221",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:24" align="right">comment:24</div>

While working on something else, I found a bug in the patch. It's been fixed and the new patch uploaded.



---

archive/issue_comments_150222.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nPatch needs to be rediffed for current sage...",
    "created_at": "2013-02-24T04:09:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150222",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

Patch needs to be rediffed for current sage...



---

archive/issue_comments_150223.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAll seems good on 5.7",
    "created_at": "2013-02-24T21:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150223",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:26" align="right">comment:26</div>

All seems good on 5.7



---

archive/issue_comments_150224.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nPatchbot:\napply trac_13130_rings_for_projective_space.patch",
    "created_at": "2013-02-25T01:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150224",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">comment:27</div>

Patchbot:
apply trac_13130_rings_for_projective_space.patch



---

archive/issue_comments_150225.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nMinor changes from review.",
    "created_at": "2013-02-28T02:24:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150225",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:28" align="right">comment:28</div>

Minor changes from review.



---

archive/issue_comments_150226.json:
```json
{
    "body": "Attachment: **[trac_13130_rings_for_projective_space.patch.gz](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space.patch.gz)**\n\nminor changes from review",
    "created_at": "2013-03-01T14:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150226",
    "user": "https://github.com/bhutz"
}
```

Attachment: **[trac_13130_rings_for_projective_space.patch.gz](https://github.com/sagemath/sage/files/ticket13130/trac_13130_rings_for_projective_space.patch.gz)**

minor changes from review



---

archive/issue_comments_150227.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI have run longtest, done docbuild, and checked for coverage.  Everything passes 100%.\n\nI have also tested functionality pretty extensively, and everything works great.\n\nThis patch should definitely be incorporate because it is the foundation that will allow future development of arithmetic dynamics functionality.",
    "created_at": "2013-03-02T01:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150227",
    "user": "https://github.com/sagetrac-mmanes"
}
```

<div id="comment:29" align="right">comment:29</div>

I have run longtest, done docbuild, and checked for coverage.  Everything passes 100%.

I have also tested functionality pretty extensively, and everything works great.

This patch should definitely be incorporate because it is the foundation that will allow future development of arithmetic dynamics functionality.



---

archive/issue_events_182383.json:
```json
{
    "actor": "https://github.com/sagetrac-mmanes",
    "created_at": "2013-03-02T01:20:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182383"
}
```



---

archive/issue_events_182384.json:
```json
{
    "actor": "https://github.com/sagetrac-mmanes",
    "created_at": "2013-03-02T01:20:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182384"
}
```



---

archive/issue_comments_150228.json:
```json
{
    "body": "Reviewer: **Michelle Manes**",
    "created_at": "2013-03-02T12:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150228",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Michelle Manes**



---

archive/issue_comments_150229.json:
```json
{
    "body": "Merged: **sage-5.8.beta3**",
    "created_at": "2013-03-04T07:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150229",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.8.beta3**



---

archive/issue_events_182385.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-04T07:37:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182385"
}
```



---

archive/issue_events_182386.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-04T07:37:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13130#event-182386"
}
```



---

archive/issue_comments_150230.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nWell, this is closed, but you still need to correct the doc : there are wrong \"INPUT::\" everywhere.",
    "created_at": "2013-03-06T13:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150230",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:32" align="right">comment:32</div>

Well, this is closed, but you still need to correct the doc : there are wrong "INPUT::" everywhere.



---

archive/issue_comments_150231.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI agree, the documentation formatting is horrible.",
    "created_at": "2013-03-06T13:12:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150231",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

I agree, the documentation formatting is horrible.



---

archive/issue_comments_150232.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nOk. This will be fixed as part of #14217.",
    "created_at": "2013-03-06T13:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13130#issuecomment-150232",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:34" align="right">comment:34</div>

Ok. This will be fixed as part of #14217.
