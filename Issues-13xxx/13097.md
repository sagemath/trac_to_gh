# Issue 13097: integral of ln(1+4/5*sin(x)) from -3.1415 to 3.1415 crashes Maxima and Sage

archive/issues_012925.json:
```json
{
    "body": "See extensive discussion at [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/dZFPiWRWSoc).\n\nReported by Ben Jones:\n\n```\nsage: integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)\n\n\n;;;\n;;; Binding stack overflow.\n;;; Jumping to the outermost toplevel prompt\n;;;\n\n...\n\n;;;\n;;; Binding stack overflow.\n;;; Jumping to the outermost toplevel prompt\n;;;\n\n\n/Users/jonesbe/sage/sage-5.1.beta2/spkg/bin/sage: line 335: 86594 Illegal instruction     sage-ipython \"$@\" -i\n```\n\nThere don't seem to be any problems with Maxima.  Although it's been traced down (thanks to Dan Drake) to 5.0.beta3, the only obvious candidate for a change in our interface is when we added `abs_integrate`, which doesn't seem to impact things.\n\n```\n(%i2) load(abs_integrate);\n(%o2) /Users/.../sage-5.0/local/share/maxima/5.26.0/s\\\nhare/contrib/integration/abs_integrate.mac\n(%i4) keepfloat:true;\n(%o4)                                true\n(%i7) integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415);\n                          3.1415\n                         /\n                         [            4 sin(x)\n(%o7)                    I         ln(-------- + 1) dx\n                         ]               5\n                         /\n                          - 3.1415\n```\nAnd we have\n\n```\nsage: maxima_calculus(\" integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415);\")\n'integrate(ln(4*sin(x)/5+1),x,-3.1415,3.1415)\n```\nso something must indeed be wrong in how we're sending this to Maxima.\n\n**Assignee:** @burcin\n\n**CC:**  @benjaminfjones dsm\n\n**Keywords:** integral\n\n**Branch/Commit:** [3f41b09a332040a3be9fb0376b03a9397b84eaff](https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff)\n\n**Upstream:** Fixed upstream, in a later stable release.\n\n**Reviewer:** Karl-Dieter Crisman\n\n**Author:** Dave Morris\n\nIssue created by migration from https://trac.sagemath.org/ticket/13097\n\n",
    "closed_at": "2021-03-09T00:01:01Z",
    "created_at": "2012-06-08T13:22:58Z",
    "labels": [
        "component: calculus",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "title": "integral of ln(1+4/5*sin(x)) from -3.1415 to 3.1415 crashes Maxima and Sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13097",
    "user": "https://github.com/kcrisman"
}
```
See extensive discussion at [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/dZFPiWRWSoc).

Reported by Ben Jones:

```
sage: integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)


;;;
;;; Binding stack overflow.
;;; Jumping to the outermost toplevel prompt
;;;

...

;;;
;;; Binding stack overflow.
;;; Jumping to the outermost toplevel prompt
;;;


/Users/jonesbe/sage/sage-5.1.beta2/spkg/bin/sage: line 335: 86594 Illegal instruction     sage-ipython "$@" -i
```

There don't seem to be any problems with Maxima.  Although it's been traced down (thanks to Dan Drake) to 5.0.beta3, the only obvious candidate for a change in our interface is when we added `abs_integrate`, which doesn't seem to impact things.

```
(%i2) load(abs_integrate);
(%o2) /Users/.../sage-5.0/local/share/maxima/5.26.0/s\
hare/contrib/integration/abs_integrate.mac
(%i4) keepfloat:true;
(%o4)                                true
(%i7) integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415);
                          3.1415
                         /
                         [            4 sin(x)
(%o7)                    I         ln(-------- + 1) dx
                         ]               5
                         /
                          - 3.1415
```
And we have

```
sage: maxima_calculus(" integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415);")
'integrate(ln(4*sin(x)/5+1),x,-3.1415,3.1415)
```
so something must indeed be wrong in how we're sending this to Maxima.

**Assignee:** @burcin

**CC:**  @benjaminfjones dsm

**Keywords:** integral

**Branch/Commit:** [3f41b09a332040a3be9fb0376b03a9397b84eaff](https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff)

**Upstream:** Fixed upstream, in a later stable release.

**Reviewer:** Karl-Dieter Crisman

**Author:** Dave Morris

Issue created by migration from https://trac.sagemath.org/ticket/13097





---

archive/issue_comments_151640.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-See extensive discussion at \n+See extensive discussion at [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/dZFPiWRWSoc).\n \n Reported by Ben Jones:\n \n``````\n",
    "created_at": "2012-06-08T13:24:08Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151640",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-See extensive discussion at 
+See extensive discussion at [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/dZFPiWRWSoc).
 
 Reported by Ben Jones:
 
``````




---

archive/issue_comments_151641.json:
```json
{
    "body": "<a id='comment:2'></a>\nCould it rather be something wrong in how we are receiving data from Maxima(lib)?",
    "created_at": "2012-06-08T13:59:28Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151641",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
Could it rather be something wrong in how we are receiving data from Maxima(lib)?



---

archive/issue_comments_151642.json:
```json
{
    "body": "<a id='comment:4'></a>\nI don't think maxima understands `ln`. If you do\n\n```\nmaxima_calculus(\" integrate(log(1+4/5*sin(x)), x, -3.1415, 3.1415);\")\n```\nyou see the same thing happening. No problem in vanilla maxima. But when we load `abs_integrate`:\n\n```\n(%i1) load(abs_integrate);\n(%o1) /usr/local/sage/5.0/local/share/maxima/5.26.0/share/contrib/integration/abs_integrate.mac\n(%i2) integrate(log(1+4/5*sin(x)), x, -3.1415, 3.1415);\n...\nCondition of type: STACK-OVERFLOW\nBINDING-STACK overflow at size 8448. Stack can probably be resized.\n```\nFYI: with\n\n```\nfrom sage.interfaces.maxima_lib import *\nfrom sage.libs.ecl import *\nargs=(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)\nI=EclObject(([max_integrate],[sr_to_max(SR(a)) for a in args]))\nI\n```\nyou see what expression gets passed to maxima_lib. With\n\n```\nEclObject('#$integrate(log(1+4/5*sin(x)), x, -3.1415, 3.1415)$')\n```\nyou see what maxima's parser would produce. With\n\n```\nmaxima_eval(I)\n```\nyou can trigger the same explosion. Note that with this trick, you can quickly see that\n\n```\nEclObject('#$integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)$')\n```\ncreates an essentially different expression.",
    "created_at": "2012-06-08T22:38:38Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151642",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:4'></a>
I don't think maxima understands `ln`. If you do

```
maxima_calculus(" integrate(log(1+4/5*sin(x)), x, -3.1415, 3.1415);")
```
you see the same thing happening. No problem in vanilla maxima. But when we load `abs_integrate`:

```
(%i1) load(abs_integrate);
(%o1) /usr/local/sage/5.0/local/share/maxima/5.26.0/share/contrib/integration/abs_integrate.mac
(%i2) integrate(log(1+4/5*sin(x)), x, -3.1415, 3.1415);
...
Condition of type: STACK-OVERFLOW
BINDING-STACK overflow at size 8448. Stack can probably be resized.
```
FYI: with

```
from sage.interfaces.maxima_lib import *
from sage.libs.ecl import *
args=(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)
I=EclObject(([max_integrate],[sr_to_max(SR(a)) for a in args]))
I
```
you see what expression gets passed to maxima_lib. With

```
EclObject('#$integrate(log(1+4/5*sin(x)), x, -3.1415, 3.1415)$')
```
you see what maxima's parser would produce. With

```
maxima_eval(I)
```
you can trigger the same explosion. Note that with this trick, you can quickly see that

```
EclObject('#$integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)$')
```
creates an essentially different expression.



---

archive/issue_comments_151643.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe problem can be simplified to\n\n```\nintegrate(log(sin(x)),x);\n```\nwhich maxima without `abs_integrate` can do (or at least it returns an answer).\n\nThis is now [Maxima Artifact 3533723](http://sourceforge.net/tracker/?func=detail&aid=3533723&group_id=4933&atid=104933)",
    "created_at": "2012-06-09T01:57:36Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151643",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:5'></a>
The problem can be simplified to

```
integrate(log(sin(x)),x);
```
which maxima without `abs_integrate` can do (or at least it returns an answer).

This is now [Maxima Artifact 3533723](http://sourceforge.net/tracker/?func=detail&aid=3533723&group_id=4933&atid=104933)



---

archive/issue_comments_151644.json:
```json
{
    "body": "**Upstream:** Reported upstream. No feedback yet.",
    "created_at": "2012-06-09T01:57:36Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151644",
    "user": "https://github.com/nbruin"
}
```

**Upstream:** Reported upstream. No feedback yet.



---

archive/issue_comments_151645.json:
```json
{
    "body": "<a id='comment:6'></a>\n> I don't think maxima understands `ln`. If you do\n\nWell, egg on my face!  Sorry for that noise.  I just don't use Maxima enough beyond trying to generate bug reports or find new functionality for Sage :)\n\nAnd good diagnosis; I guess if I had tried `log` instead I would have gotten the same problem.",
    "created_at": "2012-06-09T03:09:33Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151645",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
> I don't think maxima understands `ln`. If you do

Well, egg on my face!  Sorry for that noise.  I just don't use Maxima enough beyond trying to generate bug reports or find new functionality for Sage :)

And good diagnosis; I guess if I had tried `log` instead I would have gotten the same problem.



---

archive/issue_comments_151646.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [nbruin](#comment%3A4):\n> I don't think maxima understands `ln`. \n\n\n*facepalm*. Sorry for noise on `sage-support`",
    "created_at": "2012-06-09T08:04:44Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151646",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Replying to [nbruin](#comment%3A4):
> I don't think maxima understands `ln`. 


*facepalm*. Sorry for noise on `sage-support`



---

archive/issue_comments_151647.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\".",
    "created_at": "2012-06-09T16:30:07Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151647",
    "user": "https://github.com/nbruin"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug.".



---

archive/issue_comments_151648.json:
```json
{
    "body": "<a id='comment:8'></a>\nWe really need more options for \"upstream\" ;-). How about \"Developers acknowledge bug, propose fix, but haven't gotten around to merging it because they got the fix with less than 24 hours round trip time\"? See Maxima tracker. I have no doubt this will be fixed in some future Maxima release.",
    "created_at": "2012-06-09T16:30:07Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151648",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:8'></a>
We really need more options for "upstream" ;-). How about "Developers acknowledge bug, propose fix, but haven't gotten around to merging it because they got the fix with less than 24 hours round trip time"? See Maxima tracker. I have no doubt this will be fixed in some future Maxima release.



---

archive/issue_comments_151649.json:
```json
{
    "body": "<a id='comment:9'></a>\nWe can monkey-patch Barton Willis's fix into sage's maxima:\n\n```\nsage: L=\"\"\"signum_int(q,x) :=\n....: block([w : 1, acc : [], sgn, v, f, listconstvars : true],\n....:   q : convert_to_signum(q),\n....:   if freeof('signum, q) then\n....:     (false)\n....:   else (\n....:     q : almost_everywhere_simp(q),\n....:     v : listofvars(q),\n....:     q : block([expandwrt_denom : true], expandwrt(q,'signum)),\n....:     if (f : abs_int_extra(q,x)) # false then f\n....:     else if (f : partition_as_signum(q,x)) # false then (\n....:       w : first(f),\n....:       acc : second(f),\n....:       if every(lambda([s], linear_in_p(s,x)), acc) then (\n....:       sgn : xreduce(\"*\", map(lambda([s], diff(s,x)),acc)),\n....:       acc : map(lambda([s], rhs(first(linsolve(s, x)))),acc),\n....:       signum_int_helper(signum(sgn) * w, sort(acc), x)))\n....:     else if (safe_op(q) = \"+\") then (\n....:         f : map(lambda([s], signum_int(s,x)), args(q)),\n....:         if member(false, f) then false else xreduce(\"+\", f))\n....:       else block([extra_integration_methods : [],\n....:         extra_definite_integration_methods : []],integrate(q,x))\n....:   )\n....: );\"\"\"\nsage:  integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)\nintegrate(log(4/5*sin(x) + 1), x, -3.1415, 3.1415)\nsage: integrate(ln(sin(x)),x)\n1/2*I*x^2 - 1/2*x*log(sin(x)^2 + cos(x)^2 - 2*cos(x) + 1) - 1/2*x*log(sin(x)^2 + cos(x)^2 + 2*cos(x) + 1) + x*log(sin(x)) + I*x*arctan2(sin(x), -cos(x) + 1) - I*x*arctan2(sin(x), cos(x) + 1) + I*polylog(2, -e^(I*x)) + I*polylog(2, e^(I*x))\n\n```\nThis just patches a routine defined in `abs_integrate.mac`. It's a *LOT* slower than in 4.7.1, though, so if performance is any concern, we might want to reconsider whether abs_integrate should be loaded by default. By manipulating the maxima variables `extra_integration_methods` and `extra_definite_integration_methods` it should be possible to control which integration methods maxima tries to use (this is what `abs_integrate` hooks into).",
    "created_at": "2012-06-09T18:37:04Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151649",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:9'></a>
We can monkey-patch Barton Willis's fix into sage's maxima:

```
sage: L="""signum_int(q,x) :=
....: block([w : 1, acc : [], sgn, v, f, listconstvars : true],
....:   q : convert_to_signum(q),
....:   if freeof('signum, q) then
....:     (false)
....:   else (
....:     q : almost_everywhere_simp(q),
....:     v : listofvars(q),
....:     q : block([expandwrt_denom : true], expandwrt(q,'signum)),
....:     if (f : abs_int_extra(q,x)) # false then f
....:     else if (f : partition_as_signum(q,x)) # false then (
....:       w : first(f),
....:       acc : second(f),
....:       if every(lambda([s], linear_in_p(s,x)), acc) then (
....:       sgn : xreduce("*", map(lambda([s], diff(s,x)),acc)),
....:       acc : map(lambda([s], rhs(first(linsolve(s, x)))),acc),
....:       signum_int_helper(signum(sgn) * w, sort(acc), x)))
....:     else if (safe_op(q) = "+") then (
....:         f : map(lambda([s], signum_int(s,x)), args(q)),
....:         if member(false, f) then false else xreduce("+", f))
....:       else block([extra_integration_methods : [],
....:         extra_definite_integration_methods : []],integrate(q,x))
....:   )
....: );"""
sage:  integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)
integrate(log(4/5*sin(x) + 1), x, -3.1415, 3.1415)
sage: integrate(ln(sin(x)),x)
1/2*I*x^2 - 1/2*x*log(sin(x)^2 + cos(x)^2 - 2*cos(x) + 1) - 1/2*x*log(sin(x)^2 + cos(x)^2 + 2*cos(x) + 1) + x*log(sin(x)) + I*x*arctan2(sin(x), -cos(x) + 1) - I*x*arctan2(sin(x), cos(x) + 1) + I*polylog(2, -e^(I*x)) + I*polylog(2, e^(I*x))

```
This just patches a routine defined in `abs_integrate.mac`. It's a *LOT* slower than in 4.7.1, though, so if performance is any concern, we might want to reconsider whether abs_integrate should be loaded by default. By manipulating the maxima variables `extra_integration_methods` and `extra_definite_integration_methods` it should be possible to control which integration methods maxima tries to use (this is what `abs_integrate` hooks into).



---

archive/issue_comments_151650.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2012-07-07T02:29:40Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151650",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, but not in a stable release.".



---

archive/issue_events_110194.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110194"
}
```



---

archive/issue_events_110195.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110195"
}
```



---

archive/issue_events_110196.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110196"
}
```



---

archive/issue_events_110197.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110197"
}
```



---

archive/issue_events_110198.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110198"
}
```



---

archive/issue_events_110199.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110199"
}
```



---

archive/issue_events_110200.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110200"
}
```



---

archive/issue_events_110201.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110201"
}
```



---

archive/issue_comments_151651.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"integral\".",
    "created_at": "2020-09-22T12:02:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151651",
    "user": "https://github.com/fchapoton"
}
```

**Changing keywords** from "" to "integral".



---

archive/issue_events_110202.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-22T16:08:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110202"
}
```



---

archive/issue_events_110203.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-22T16:08:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110203"
}
```



---

archive/issue_comments_151652.json:
```json
{
    "body": "<a id='comment:16'></a>\nI don't see crashes 8 years later on:\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.2.beta12, Release Date: 2020-09-06              \u2502\n\u2502 Using Python 3.8.5. Type \"help()\" for help.                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nsage: integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)                                                                                \n-1.40205228301\nsage: integrate(ln(1+4/5*sin(x)), x, -pi, pi)                                                                                        \nintegrate(log(4/5*sin(x) + 1), x, -pi, pi)\nsage: integrate(log(sin(x)),x)                                                                                                       \n1/2*I*x^2 - I*x*arctan2(sin(x), cos(x) + 1) + I*x*arctan2(sin(x), -cos(x) + 1) - 1/2*x*log(cos(x)^2 + sin(x)^2 + 2*cos(x) + 1) - 1/2*x*log(cos(x)^2 + sin(x)^2 - 2*cos(x) + 1) + x*log(sin(x)) + I*dilog(-e^(I*x)) + I*dilog(e^(I*x))\n```\n\npropose to close as worksforme.",
    "created_at": "2020-09-22T16:08:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151652",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
I don't see crashes 8 years later on:

```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.2.beta12, Release Date: 2020-09-06              │
│ Using Python 3.8.5. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
sage: integrate(ln(1+4/5*sin(x)), x, -3.1415, 3.1415)                                                                                
-1.40205228301
sage: integrate(ln(1+4/5*sin(x)), x, -pi, pi)                                                                                        
integrate(log(4/5*sin(x) + 1), x, -pi, pi)
sage: integrate(log(sin(x)),x)                                                                                                       
1/2*I*x^2 - I*x*arctan2(sin(x), cos(x) + 1) + I*x*arctan2(sin(x), -cos(x) + 1) - 1/2*x*log(cos(x)^2 + sin(x)^2 + 2*cos(x) + 1) - 1/2*x*log(cos(x)^2 + sin(x)^2 - 2*cos(x) + 1) + x*log(sin(x)) + I*dilog(-e^(I*x)) + I*dilog(e^(I*x))
```

propose to close as worksforme.



---

archive/issue_events_110204.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-09-22T16:08:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110204"
}
```



---

archive/issue_events_110205.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-09-22T16:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "worksforme",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110205"
}
```



---

archive/issue_comments_151653.json:
```json
{
    "body": "<a id='comment:17'></a>\nok, then",
    "created_at": "2020-09-22T16:27:49Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151653",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
ok, then



---

archive/issue_events_110206.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-09-22T16:27:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110206"
}
```



---

archive/issue_events_110207.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-09-22T16:27:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110207"
}
```



---

archive/issue_comments_151654.json:
```json
{
    "body": "<a id='comment:18'></a>\nAs always, doctest ...",
    "created_at": "2020-09-22T17:09:34Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151654",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>
As always, doctest ...



---

archive/issue_events_110208.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2020-09-22T17:09:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "worksforme",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110208"
}
```



---

archive/issue_comments_151655.json:
```json
{
    "body": "<a id='comment:19'></a>\nAlso, it was indeed applied in Maxima.",
    "created_at": "2020-09-22T17:10:23Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151655",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:19'></a>
Also, it was indeed applied in Maxima.



---

archive/issue_comments_151656.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, but not in a stable release.\" to \"Fixed upstream, in a later stable release.\".",
    "created_at": "2020-09-22T17:10:23Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151656",
    "user": "https://github.com/kcrisman"
}
```

**Changing upstream** from "Fixed upstream, but not in a stable release." to "Fixed upstream, in a later stable release.".



---

archive/issue_comments_151657.json:
```json
{
    "body": "<a id='comment:20'></a>\nok, you are right, but I will wait until #25119 is in sage",
    "created_at": "2020-09-22T18:17:27Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151657",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>
ok, you are right, but I will wait until #25119 is in sage



---

archive/issue_comments_151658.json:
```json
{
    "body": "<a id='comment:21'></a>\nobviously no rush whatsoever since it's fixed",
    "created_at": "2020-09-22T21:46:32Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151658",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:21'></a>
obviously no rush whatsoever since it's fixed



---

archive/issue_comments_151659.json:
```json
{
    "body": "**Branch:** [public/13097](https://github.com/sagemath/sagetrac-mirror/tree/public/13097)",
    "created_at": "2021-01-24T04:07:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151659",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Branch:** [public/13097](https://github.com/sagemath/sagetrac-mirror/tree/public/13097)



---

archive/issue_comments_151660.json:
```json
{
    "body": "<a id='comment:23'></a>\nThe PR adds the original issue as a doctest.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff\">3f41b09</a></td><td><code>doctest for trac 13097</code></td></tr></table>\n",
    "created_at": "2021-01-24T04:10:04Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151660",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:23'></a>
The PR adds the original issue as a doctest.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff">3f41b09</a></td><td><code>doctest for trac 13097</code></td></tr></table>




---

archive/issue_comments_151661.json:
```json
{
    "body": "**Author:** Dave Morris",
    "created_at": "2021-01-24T04:10:04Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151661",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Author:** Dave Morris



---

archive/issue_events_110209.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-24T04:10:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "bug",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110209"
}
```



---

archive/issue_events_110210.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-24T04:10:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110210"
}
```



---

archive/issue_events_110211.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-24T04:10:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110211"
}
```



---

archive/issue_comments_151662.json:
```json
{
    "body": "**Commit:** [3f41b09a332040a3be9fb0376b03a9397b84eaff](https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff)",
    "created_at": "2021-01-24T04:10:04Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151662",
    "user": "https://github.com/DaveWitteMorris"
}
```

**Commit:** [3f41b09a332040a3be9fb0376b03a9397b84eaff](https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff)



---

archive/issue_events_110212.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-24T04:10:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110212"
}
```



---

archive/issue_events_110213.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-01-24T04:10:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "minor",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110213"
}
```



---

archive/issue_comments_151663.json:
```json
{
    "body": "<a id='comment:24'></a>\nThanks!",
    "created_at": "2021-01-25T13:54:01Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151663",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>
Thanks!



---

archive/issue_events_110214.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2021-01-25T13:54:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110214"
}
```



---

archive/issue_events_110215.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2021-01-25T13:54:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110215"
}
```



---

archive/issue_comments_151664.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2021-01-25T13:54:01Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151664",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_events_110216.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-09T00:01:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110216"
}
```



---

archive/issue_events_110217.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b4c66dcdffb707b32b4709bb17245b9601d15abd",
    "created_at": "2021-03-09T00:01:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13097#event-110217"
}
```



---

archive/issue_comments_151665.json:
```json
{
    "body": "**Changing branch** from \"[public/13097](https://github.com/sagemath/sagetrac-mirror/tree/public/13097)\" to \"[3f41b09a332040a3be9fb0376b03a9397b84eaff](https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff)\".",
    "created_at": "2021-03-09T00:01:01Z",
    "issue": "https://github.com/sagemath/sage/issues/13097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13097#issuecomment-151665",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/13097](https://github.com/sagemath/sagetrac-mirror/tree/public/13097)" to "[3f41b09a332040a3be9fb0376b03a9397b84eaff](https://github.com/sagemath/sagetrac-mirror/commit/3f41b09a332040a3be9fb0376b03a9397b84eaff)".
