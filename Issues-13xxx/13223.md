# Issue 13223: Implement Poset.is_graded using a polynomial time (linear?) algorithm.

archive/issues_013051.json:
```json
{
    "assignees": [],
    "body": "Title says it all. See also #13222.\n\nDepends on #13222\n\nAssignee: **sage-combinat**\n\nCC:  sage-combinat mcco0489@math.umn.edu @nathanncohen\n\nKeywords: **sd40**\n\nBranch/Commit: **[u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_](https://github.com/sagemath/sagetrac-mirror/tree/u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_) @ [a9896c7](https://github.com/sagemath/sagetrac-mirror/commit/a9896c7e9f9e8e6c6f52a25a3370c2d595e2fecf)**\n\nAuthor: **Jori M\u00e4ntysalo**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13223_\n\n",
    "closed_at": "2014-10-13T15:52:27Z",
    "created_at": "2012-07-10T17:36:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement Poset.is_graded using a polynomial time (linear?) algorithm.",
    "type": "issue",
    "updated_at": "2014-10-13T15:52:27Z",
    "url": "https://github.com/sagemath/sage/issues/13223",
    "user": "https://github.com/nthiery"
}
```
Title says it all. See also #13222.

Depends on #13222

Assignee: **sage-combinat**

CC:  sage-combinat mcco0489@math.umn.edu @nathanncohen

Keywords: **sd40**

Branch/Commit: **[u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_](https://github.com/sagemath/sagetrac-mirror/tree/u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_) @ [a9896c7](https://github.com/sagemath/sagetrac-mirror/commit/a9896c7e9f9e8e6c6f52a25a3370c2d595e2fecf)**

Author: **Jori Mäntysalo**

_Issue created by migration from https://trac.sagemath.org/ticket/13223_





---

archive/issue_events_162790.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-07-10T17:36:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162790"
}
```



---

archive/issue_events_162791.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-07-10T17:36:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162791"
}
```



---

archive/issue_events_162792.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-07-10T17:36:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162792"
}
```



---

archive/issue_comments_154670.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nThomas McConville will be implementing this",
    "created_at": "2012-09-05T20:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154670",
    "user": "https://github.com/sagetrac-gmoose05"
}
```

<a id='comment:1'>Comment 1:</a>
Thomas McConville will be implementing this



---

archive/issue_events_162793.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162793"
}
```



---

archive/issue_events_162794.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162794"
}
```



---

archive/issue_comments_154671.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI've improved the situation in #13240; the algorithm is now polynomial time. Wouldn't hurt to improve it nevertheless.",
    "created_at": "2013-10-21T02:52:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154671",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:4'>Comment 4:</a>
I've improved the situation in #13240; the algorithm is now polynomial time. Wouldn't hurt to improve it nevertheless.



---

archive/issue_events_162795.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162795"
}
```



---

archive/issue_events_162796.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162796"
}
```



---

archive/issue_events_162797.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162797"
}
```



---

archive/issue_events_162798.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162798"
}
```



---

archive/issue_events_162799.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162799"
}
```



---

archive/issue_events_162800.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162800"
}
```



---

archive/issue_comments_154672.json:
```json
{
    "body": "Attachment: **[faster-isgraded.txt](https://github.com/sagemath/sage/files/ticket13223/faster-isgraded.txt)**",
    "created_at": "2014-10-06T13:39:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154672",
    "user": "https://github.com/jm58660"
}
```

Attachment: **[faster-isgraded.txt](https://github.com/sagemath/sage/files/ticket13223/faster-isgraded.txt)**



---

archive/issue_comments_154673.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nI attached an example code. Before integrating to Sage it must be changed so that rank list is saved, or should it? For now `is_graded()` starts with `is_ranked()`, and it saves rank of every element to internal variable.",
    "created_at": "2014-10-06T13:45:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154673",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:8'>Comment 8:</a>
I attached an example code. Before integrating to Sage it must be changed so that rank list is saved, or should it? For now `is_graded()` starts with `is_ranked()`, and it saves rank of every element to internal variable.



---

archive/issue_comments_154674.json:
```json
{
    "body": "Branch: **[u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_](https://github.com/sagemath/sagetrac-mirror/tree/u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_)**",
    "created_at": "2014-10-07T10:28:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154674",
    "user": "https://github.com/jm58660"
}
```

Branch: **[u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_](https://github.com/sagemath/sagetrac-mirror/tree/u/jmantysalo/implement_poset_is_graded_using_a_polynomial_time__linear___algorithm_)**



---

archive/issue_comments_154675.json:
```json
{
    "body": "Commit: **[a9896c7](https://github.com/sagemath/sagetrac-mirror/commit/a9896c7e9f9e8e6c6f52a25a3370c2d595e2fecf)**",
    "created_at": "2014-10-07T10:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154675",
    "user": "https://github.com/jm58660"
}
```

Commit: **[a9896c7](https://github.com/sagemath/sagetrac-mirror/commit/a9896c7e9f9e8e6c6f52a25a3370c2d595e2fecf)**



---

archive/issue_events_162801.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-10-07T10:34:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162801"
}
```



---

archive/issue_comments_154676.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI should now be O(n). (Where `n` if number of cover relations, not number of elements.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32a7eb719139f71290050d3f9f322badc7f33bb1\">32a7eb7</a></td><td><code>New algorithm.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9896c7e9f9e8e6c6f52a25a3370c2d595e2fecf\">a9896c7</a></td><td><code>.</code></td></tr></table>\n",
    "created_at": "2014-10-07T10:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154676",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:10'>Comment 10:</a>
I should now be O(n). (Where `n` if number of cover relations, not number of elements.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32a7eb719139f71290050d3f9f322badc7f33bb1">32a7eb7</a></td><td><code>New algorithm.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9896c7e9f9e8e6c6f52a25a3370c2d595e2fecf">a9896c7</a></td><td><code>.</code></td></tr></table>




---

archive/issue_comments_154677.json:
```json
{
    "body": "Author: **Jori M\u00e4ntysalo**",
    "created_at": "2014-10-07T10:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154677",
    "user": "https://github.com/jm58660"
}
```

Author: **Jori Mäntysalo**



---

archive/issue_comments_154678.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nDuh, must to do more timings. This is somewhat faster when going throught Posets(8), but much slower with bigger random posets. Algorithm should probably be selected by number of elements and cover relations.",
    "created_at": "2014-10-07T12:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154678",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:11'>Comment 11:</a>
Duh, must to do more timings. This is somewhat faster when going throught Posets(8), but much slower with bigger random posets. Algorithm should probably be selected by number of elements and cover relations.



---

archive/issue_comments_154679.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI do not understand. According to Wikipedia, isn't this poset graded by the function which associates to every element the length of its label ?\n\nhttp://en.wikipedia.org/wiki/Graded_poset\n\n```\nsage: d=DiGraph(); d.add_path([\"aaaa\",\"aaa\",\"aa\",\"a\"]); d.add_path([\"bbb\",\"aa\"])\nsage: Poset(d).is_graded()\nFalse\n```\n\n(same result with or without your branch applied)\n\nNathann",
    "created_at": "2014-10-07T19:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154679",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'>Comment 12:</a>
I do not understand. According to Wikipedia, isn't this poset graded by the function which associates to every element the length of its label ?

http://en.wikipedia.org/wiki/Graded_poset

```
sage: d=DiGraph(); d.add_path(["aaaa","aaa","aa","a"]); d.add_path(["bbb","aa"])
sage: Poset(d).is_graded()
False
```

(same result with or without your branch applied)

Nathann



---

archive/issue_events_162802.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-10-07T19:29:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162802"
}
```



---

archive/issue_events_162803.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-10-07T19:29:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162803"
}
```



---

archive/issue_events_162804.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-10-08T04:39:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162804"
}
```



---

archive/issue_events_162805.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-10-08T04:39:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162805"
}
```



---

archive/issue_comments_154680.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nSome sources define graded poset like what Sage define ranked. For that see #16998 and doc for `is_graded` on `posets.py`.\n\nMy code lacked one `set()` function. But after that also `minimal_elements()` takes more time that I thinked, hence this code is still slower than original in many (most?) cases.\n\nAlso, original code is O(n). Hence I dropped this to minor priority.",
    "created_at": "2014-10-08T04:39:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154680",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:13'>Comment 13:</a>
Some sources define graded poset like what Sage define ranked. For that see #16998 and doc for `is_graded` on `posets.py`.

My code lacked one `set()` function. But after that also `minimal_elements()` takes more time that I thinked, hence this code is still slower than original in many (most?) cases.

Also, original code is O(n). Hence I dropped this to minor priority.



---

archive/issue_comments_154681.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nA side note about #17002: It makes `minimal_elements` slightly slower. Must modify functions `sinks()` and `sources()` on `digraph.py`.",
    "created_at": "2014-10-08T13:15:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154681",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:14'>Comment 14:</a>
A side note about #17002: It makes `minimal_elements` slightly slower. Must modify functions `sinks()` and `sources()` on `digraph.py`.



---

archive/issue_comments_154682.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nOh. I thought that it would go unnoticed.\n\nWell, try replacing the code of sinks/source from\n\n```\nreturn [x for x in self if self.out_degree(x)==0]\n```\n\nto\n\n```\nreturn [x for x,d in self.out_degree(labels=True).iteritems() if d==0]\n```\n\nIt means less calls to `out_degree`. Perhaps that's what you detected ?\n\nNathann",
    "created_at": "2014-10-08T13:22:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154682",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'>Comment 15:</a>
Oh. I thought that it would go unnoticed.

Well, try replacing the code of sinks/source from

```
return [x for x in self if self.out_degree(x)==0]
```

to

```
return [x for x,d in self.out_degree(labels=True).iteritems() if d==0]
```

It means less calls to `out_degree`. Perhaps that's what you detected ?

Nathann



---

archive/issue_comments_154683.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nI'll try that.\n\nWhole question is irrelevant, but interesting. It should be clear that checking if a poset is graded is faster when doing it \"directly\" and not throught rank function. Rank should need both in- ja out-edges of underlying graph, direct method just out-edges; and out-edges are just picked up from memory, not searched in any way.\n\nHowever, many timinigs say against this.",
    "created_at": "2014-10-08T17:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154683",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:16'>Comment 16:</a>
I'll try that.

Whole question is irrelevant, but interesting. It should be clear that checking if a poset is graded is faster when doing it "directly" and not throught rank function. Rank should need both in- ja out-edges of underlying graph, direct method just out-edges; and out-edges are just picked up from memory, not searched in any way.

However, many timinigs say against this.



---

archive/issue_comments_154684.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nHello !\n\nJust looked at the code again, but I do not see what possible improvement you expect. Algorithmically, things are done correctly. Now, if you really need to save some time on this function you can change a couple of lines to avoid creating lists unnecessarily, turn the Python list into a C arrays, things like that. But I think that the Poset code still needs other improvements before this kind of things begin to be the critical costs.\n\nAbout definitions, though: what is implemented is not equivalent to `return all(rf(i) == rank for i in maxes)`, for you need to do the same with mins. This `Poset` is not graded according to the definition involving \"all maximal chains\":\n\n`Poset(DiGraph({1:[2],3:[2],4:[3]})).show()`\n\nIt would be interesting to compare the speed of `rank_dict` and `is_graded` though, as their code is very similar.\n\nNathann",
    "created_at": "2014-10-12T14:59:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154684",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'>Comment 17:</a>
Hello !

Just looked at the code again, but I do not see what possible improvement you expect. Algorithmically, things are done correctly. Now, if you really need to save some time on this function you can change a couple of lines to avoid creating lists unnecessarily, turn the Python list into a C arrays, things like that. But I think that the Poset code still needs other improvements before this kind of things begin to be the critical costs.

About definitions, though: what is implemented is not equivalent to `return all(rf(i) == rank for i in maxes)`, for you need to do the same with mins. This `Poset` is not graded according to the definition involving "all maximal chains":

`Poset(DiGraph({1:[2],3:[2],4:[3]})).show()`

It would be interesting to compare the speed of `rank_dict` and `is_graded` though, as their code is very similar.

Nathann



---

archive/issue_comments_154685.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@nathanncohen](#comment%3A17):\n\n> Now, if you really need to save some time on this function you can change a couple of lines to avoid creating lists unnecessarily, turn the Python list into a C arrays, things like that. But I think that the Poset code still needs other improvements before this kind of things begin to be the critical costs.\n\nYep. Should this one be marked as positive_review and moved to wontfix-milestone?\n\n> About definitions, though: what is implemented is not equivalent to `return all(rf(i) == rank for i in maxes)`, for you need to do the same with mins.\n\nTrue.\n\n> It would be interesting to compare the speed of `rank_dict` and `is_graded` though, as their code is very similar.\n\nI made a code that was slightly faster when calculating how many of `Posets(8)` are graded (assuming that ranks were not already computed). IF \"going up\" is cheaper than going down, i.e. poset is internally saved as digraph of upper covers, then in principle current implementation would be `O(n^2)` and my implementation `O(n)`. But in reality this sppedup is not happening.",
    "created_at": "2014-10-13T05:30:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154685",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@nathanncohen](#comment%3A17):

> Now, if you really need to save some time on this function you can change a couple of lines to avoid creating lists unnecessarily, turn the Python list into a C arrays, things like that. But I think that the Poset code still needs other improvements before this kind of things begin to be the critical costs.

Yep. Should this one be marked as positive_review and moved to wontfix-milestone?

> About definitions, though: what is implemented is not equivalent to `return all(rf(i) == rank for i in maxes)`, for you need to do the same with mins.

True.

> It would be interesting to compare the speed of `rank_dict` and `is_graded` though, as their code is very similar.

I made a code that was slightly faster when calculating how many of `Posets(8)` are graded (assuming that ranks were not already computed). IF "going up" is cheaper than going down, i.e. poset is internally saved as digraph of upper covers, then in principle current implementation would be `O(n^2)` and my implementation `O(n)`. But in reality this sppedup is not happening.



---

archive/issue_comments_154686.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nYooooooo !\n\n> Yep. Should this one be marked as positive_review and moved to wontfix-milestone?\n\n+1 to that\n\n> I made a code that was slightly faster when calculating how many of `Posets(8)` are graded (assuming that ranks were not already computed). IF \"going up\" is cheaper than going down, i.e. poset is internally saved as digraph of upper covers, then in principle current implementation would be `O(n^2)` and my implementation `O(n)`. But in reality this sppedup is not happening.\n\nWell, going up or down should be the same cost. The edges are stored twice (in each direction) in digraphs.\n\nNathann",
    "created_at": "2014-10-13T09:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154686",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'>Comment 19:</a>
Yooooooo !

> Yep. Should this one be marked as positive_review and moved to wontfix-milestone?

+1 to that

> I made a code that was slightly faster when calculating how many of `Posets(8)` are graded (assuming that ranks were not already computed). IF "going up" is cheaper than going down, i.e. poset is internally saved as digraph of upper covers, then in principle current implementation would be `O(n^2)` and my implementation `O(n)`. But in reality this sppedup is not happening.

Well, going up or down should be the same cost. The edges are stored twice (in each direction) in digraphs.

Nathann



---

archive/issue_events_162806.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-10-13T10:45:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162806"
}
```



---

archive/issue_events_162807.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-10-13T10:45:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162807"
}
```



---

archive/issue_events_162808.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2014-10-13T10:45:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162808"
}
```



---

archive/issue_comments_154687.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nAs current algorithm already is `O(n)` with small constant factor, and Nathann also suggest closing this, I mark this ticket as dontfix-positive_review.\n\nTodo-note from `posets.py` must also be removed. However, I can do that on #16998.",
    "created_at": "2014-10-13T10:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154687",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:20'>Comment 20:</a>
As current algorithm already is `O(n)` with small constant factor, and Nathann also suggest closing this, I mark this ticket as dontfix-positive_review.

Todo-note from `posets.py` must also be removed. However, I can do that on #16998.



---

archive/issue_comments_154688.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nSorry for the confusion that came from me. When I said that \"Wouldn't hurt to improve it nevertheless\", I didn't have any particular improvements in mind, just an impression that I wasn't being very thorough. And I think it wasn't exactly my algorithm that got implemented in Sage, but rather an improved version by Anne(?) and Nicolas(?).",
    "created_at": "2014-10-13T13:38:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154688",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:21'>Comment 21:</a>
Sorry for the confusion that came from me. When I said that "Wouldn't hurt to improve it nevertheless", I didn't have any particular improvements in mind, just an impression that I wasn't being very thorough. And I think it wasn't exactly my algorithm that got implemented in Sage, but rather an improved version by Anne(?) and Nicolas(?).



---

archive/issue_comments_154689.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nOkay. Well, for sure I do not know any algorithmic way to compute that which would be better than the current one.\n\nNathann",
    "created_at": "2014-10-13T13:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13223#issuecomment-154689",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'>Comment 22:</a>
Okay. Well, for sure I do not know any algorithmic way to compute that which would be better than the current one.

Nathann



---

archive/issue_events_162809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-13T15:52:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162809"
}
```



---

archive/issue_events_162810.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-13T15:52:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162810"
}
```



---

archive/issue_events_162811.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-13T15:52:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13223",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "a6a6a6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13223#event-162811"
}
```
