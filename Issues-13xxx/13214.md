# Issue 13214: Finite field homomorphisms and Frobenius endomorphisms

archive/issues_013042.json:
```json
{
    "assignees": [
        "https://github.com/aghitza"
    ],
    "body": "Here is a patch implementing:\n\n1. Frobenius endomorphisms over finite fields (generic implementation, plus special implementations for prime finite fields and givaro finite fields)\n2. embeddings between finite fields (with again a special implementation for givaro finite fields)\n3. hashing and rich comparisons for general morphisms\n\n---\nApply: [attachment: trac_13214-folded.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-folded.patch.gz)\n\nDepends on #8335\n\nCC:  @sagetrac-tfeulner @xcaruso @darijgr @jpflori @pjbruin @defeo @sagetrac-JCooley @sagetrac-dfesti\n\nKeywords: **frobenius finite fields sd51**\n\nReviewer: **Paul Zimmermann, Peter Bruin, Volker Braun**\n\nAuthor: **Xavier Caruso, Peter Bruin**\n\nMerged: **sage-5.13.beta2**\n\nComponent: **finite rings**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13214_\n\n",
    "closed_at": "2013-10-31T19:16:00Z",
    "created_at": "2012-07-09T08:26:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20finite%20rings",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Finite field homomorphisms and Frobenius endomorphisms",
    "type": "issue",
    "updated_at": "2013-10-31T19:16:00Z",
    "url": "https://github.com/sagemath/sage/issues/13214",
    "user": "https://github.com/xcaruso"
}
```
Here is a patch implementing:

1. Frobenius endomorphisms over finite fields (generic implementation, plus special implementations for prime finite fields and givaro finite fields)
2. embeddings between finite fields (with again a special implementation for givaro finite fields)
3. hashing and rich comparisons for general morphisms

---
Apply: [attachment: trac_13214-folded.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-folded.patch.gz)

Depends on #8335

CC:  @sagetrac-tfeulner @xcaruso @darijgr @jpflori @pjbruin @defeo @sagetrac-JCooley @sagetrac-dfesti

Keywords: **frobenius finite fields sd51**

Reviewer: **Paul Zimmermann, Peter Bruin, Volker Braun**

Author: **Xavier Caruso, Peter Bruin**

Merged: **sage-5.13.beta2**

Component: **finite rings**

_Issue created by migration from https://trac.sagemath.org/ticket/13214_





---

archive/issue_events_183875.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2012-07-09T08:26:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183875"
}
```



---

archive/issue_events_183876.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2012-07-09T08:26:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183876"
}
```



---

archive/issue_events_183877.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2012-07-09T08:26:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183877"
}
```



---

archive/issue_events_183878.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2012-07-09T08:26:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183878"
}
```



---

archive/issue_events_183879.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2012-07-09T08:26:03Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "subject": "https://github.com/xcaruso",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183879"
}
```



---

archive/issue_events_183880.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2012-07-09T08:27:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183880"
}
```



---

archive/issue_comments_151963.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI guess your patch should also contain some *.pxd files since I receive the following error message.\n\n```\nBuilding modified file sage/rings/finite_rings/hom_finite_field.pyx.\nTraceback (most recent call last):\n  File \"setup.py\", line 829, in <module>\n    queue = compile_command_list(ext_modules, deps)\n  File \"setup.py\", line 789, in compile_command_list\n    dep_file, dep_time = deps.newest_dep(f,m)\n  File \"setup.py\", line 696, in newest_dep\n    for f in self.all_deps(filename, ext_module):\n  File \"setup.py\", line 677, in all_deps\n    for f in self.immediate_deps(filename, ext_module):\n  File \"setup.py\", line 659, in immediate_deps\n    self._deps[filename] = self.parse_deps(filename, ext_module)\n  File \"setup.py\", line 647, in parse_deps\n    raise IOError, msg\nIOError: could not find dependency sage/rings/finite_rings/hom_finite_field.pxd included in sage/rings/finite_rings/hom_prime_finite_field.pyx.\nError installing modified sage library code.\n```",
    "created_at": "2012-07-25T07:28:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151963",
    "user": "https://github.com/sagetrac-tfeulner"
}
```

<div id="comment:2" align="right">comment:2</div>

I guess your patch should also contain some *.pxd files since I receive the following error message.

```
Building modified file sage/rings/finite_rings/hom_finite_field.pyx.
Traceback (most recent call last):
  File "setup.py", line 829, in <module>
    queue = compile_command_list(ext_modules, deps)
  File "setup.py", line 789, in compile_command_list
    dep_file, dep_time = deps.newest_dep(f,m)
  File "setup.py", line 696, in newest_dep
    for f in self.all_deps(filename, ext_module):
  File "setup.py", line 677, in all_deps
    for f in self.immediate_deps(filename, ext_module):
  File "setup.py", line 659, in immediate_deps
    self._deps[filename] = self.parse_deps(filename, ext_module)
  File "setup.py", line 647, in parse_deps
    raise IOError, msg
IOError: could not find dependency sage/rings/finite_rings/hom_finite_field.pxd included in sage/rings/finite_rings/hom_prime_finite_field.pyx.
Error installing modified sage library code.
```



---

archive/issue_comments_151964.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nXavier, if I define an element of GF(q<sup>2</sup>) which is in fact an element of GF(q), will this patch enable to convert it efficiently to the smaller field? If so, please can you tell me how?\n\nPaul",
    "created_at": "2012-07-25T16:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151964",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:4" align="right">comment:4</div>

Xavier, if I define an element of GF(q<sup>2</sup>) which is in fact an element of GF(q), will this patch enable to convert it efficiently to the smaller field? If so, please can you tell me how?

Paul



---

archive/issue_comments_151965.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOh sorry, I forgot *.pxd files. Thanks!\n\n\nPaul, the answer to your question is probably yes... at least if q is small enough so that you can work with givaro fields (otherwise, it won't be so efficient).\n\nActually, I have not implemented automatic coercions between finite fields (essentially because embeddings between finite fields are not canonical). As a consequence it's not so easy to create embeddings. Nevertheless, here is what you can do:\n\n```\nsage: K.<x> = GF(5^3)\nsage: L.<y> = GF(5^6)\nsage: from sage.rings.finite_rings.hom_finite_field_givaro import FiniteFieldEmbedding_givaro\nsage: f = FiniteFieldEmbedding_givaro(K,L); f\nEmbedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6\nsage: g = f.section(); g\nSection of Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6\nsage: g(y^126)\n3*x^2 + 1\nsage: g(y)\nTraceback (most recent call last):\n...\nValueError: y is not in the image of Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6\n```\n\nIf you are sure that you won't never use another embedding of K into L, you can even define f as a coerce map as follows:\n\n```\nsage: K._unset_coercions_used()\nsage: K._populate_coercion_lists_(embedding=f)\n```\n\nThen the following will work:\n\n```\nsage: L(x)\n2*y^5 + 3*y^4 + 3*y^2 + y + 2\nsage: z = x*y; z\n3*y^5 + 3*y^4 + 4*y^2 + 2*y + 1\nsage: K(z/y)\nx\nsage: K(y)\nTraceback (most recent call last):\n...\nValueError: y is not in the image of Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6\n```",
    "created_at": "2012-07-25T22:09:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151965",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:5" align="right">comment:5</div>

Oh sorry, I forgot *.pxd files. Thanks!


Paul, the answer to your question is probably yes... at least if q is small enough so that you can work with givaro fields (otherwise, it won't be so efficient).

Actually, I have not implemented automatic coercions between finite fields (essentially because embeddings between finite fields are not canonical). As a consequence it's not so easy to create embeddings. Nevertheless, here is what you can do:

```
sage: K.<x> = GF(5^3)
sage: L.<y> = GF(5^6)
sage: from sage.rings.finite_rings.hom_finite_field_givaro import FiniteFieldEmbedding_givaro
sage: f = FiniteFieldEmbedding_givaro(K,L); f
Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6
sage: g = f.section(); g
Section of Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6
sage: g(y^126)
3*x^2 + 1
sage: g(y)
Traceback (most recent call last):
...
ValueError: y is not in the image of Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6
```

If you are sure that you won't never use another embedding of K into L, you can even define f as a coerce map as follows:

```
sage: K._unset_coercions_used()
sage: K._populate_coercion_lists_(embedding=f)
```

Then the following will work:

```
sage: L(x)
2*y^5 + 3*y^4 + 3*y^2 + y + 2
sage: z = x*y; z
3*y^5 + 3*y^4 + 4*y^2 + 2*y + 1
sage: K(z/y)
x
sage: K(y)
Traceback (most recent call last):
...
ValueError: y is not in the image of Embedding of Finite Field in x of size 5^3 into Finite Field in y of size 5^6
```



---

archive/issue_comments_151966.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nPlease fill in your real name as Author.",
    "created_at": "2012-07-27T20:39:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151966",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Please fill in your real name as Author.



---

archive/issue_comments_151967.json:
```json
{
    "body": "Author: **Xavier Caruso**",
    "created_at": "2012-07-28T07:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151967",
    "user": "https://github.com/xcaruso"
}
```

Author: **Xavier Caruso**



---

archive/issue_comments_151968.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nXavier, I tried to apply the patch on top of Sage 5.1 but got:\n\n```\nsage: hg_sage.import_patch(\"trac_13214_hom_finite_field.patch\")\ncd \"/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/devel/sage\" && sage --hg import   \"/tmp/trac_13214_hom_finite_field.patch\"\napplying /tmp/trac_13214_hom_finite_field.patch\n** unknown exception encountered, please report by visiting\n**  http://mercurial.selenic.com/wiki/BugTracker\n** Python 2.7.3 (default, Jul  9 2012, 15:05:17) [GCC 4.6.3]\n** Mercurial Distributed SCM (version 1.8.4)\n** Extensions loaded: color, mq, pager, rebase, relink\nTraceback (most recent call last):\n  File \"/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/bin/hg\", line 38, in <module>\n    mercurial.dispatch.run()\n  File \"/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python/mercurial/dispatch.py\", line 16, in run\n    sys.exit(dispatch(sys.argv[1:]))\n  File \"/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python/mercurial/dispatch.py\", line 36, in dispatch\n    return _runcatch(u, args)\n...\n  File \"/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python/mercurial/patch.py\", line 339, in readgitpatch\n    gp.setmode(int(line[-6:], 8))\nValueError: invalid literal for int() with base 8: '</pre>'\n```\nShould I apply it on top of Sage 5.2 or later?\n\nPaul",
    "created_at": "2012-07-31T12:20:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151968",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:9" align="right">comment:9</div>

Xavier, I tried to apply the patch on top of Sage 5.1 but got:

```
sage: hg_sage.import_patch("trac_13214_hom_finite_field.patch")
cd "/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/devel/sage" && sage --hg import   "/tmp/trac_13214_hom_finite_field.patch"
applying /tmp/trac_13214_hom_finite_field.patch
** unknown exception encountered, please report by visiting
**  http://mercurial.selenic.com/wiki/BugTracker
** Python 2.7.3 (default, Jul  9 2012, 15:05:17) [GCC 4.6.3]
** Mercurial Distributed SCM (version 1.8.4)
** Extensions loaded: color, mq, pager, rebase, relink
Traceback (most recent call last):
  File "/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/bin/hg", line 38, in <module>
    mercurial.dispatch.run()
  File "/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python/mercurial/dispatch.py", line 16, in run
    sys.exit(dispatch(sys.argv[1:]))
  File "/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python/mercurial/dispatch.py", line 36, in dispatch
    return _runcatch(u, args)
...
  File "/usr/local/sage-5.1-linux-64bit-ubuntu_12.04_lts-x86_64-Linux/local/lib/python/mercurial/patch.py", line 339, in readgitpatch
    gp.setmode(int(line[-6:], 8))
ValueError: invalid literal for int() with base 8: '</pre>'
```
Should I apply it on top of Sage 5.2 or later?

Paul



---

archive/issue_comments_151969.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nplease discard my last comment, I downloaded the patch in html form...\n\nPaul",
    "created_at": "2012-08-01T06:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151969",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:10" align="right">comment:10</div>

please discard my last comment, I downloaded the patch in html form...

Paul



---

archive/issue_comments_151970.json:
```json
{
    "body": "Work Issues: **failing doctests**",
    "created_at": "2012-08-01T11:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151970",
    "user": "https://github.com/zimmermann6"
}
```

Work Issues: **failing doctests**



---

archive/issue_comments_151971.json:
```json
{
    "body": "Reviewer: **Paul Zimmermann**",
    "created_at": "2012-08-01T11:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151971",
    "user": "https://github.com/zimmermann6"
}
```

Reviewer: **Paul Zimmermann**



---

archive/issue_events_183881.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-08-01T11:14:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183881"
}
```



---

archive/issue_events_183882.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2012-08-01T11:14:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183882"
}
```



---

archive/issue_comments_151972.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\non top of Sage 5.1 I get the following failures with this patch:\n\n```\nsage -t  devel/sage-13214/sage/categories/modules_with_basis.py # 3 doctests failed\nsage -t  devel/sage-13214/sage/rings/finite_rings/finite_field_base.pyx # 2 doctests failed\nsage -t  devel/sage-13214/sage/rings/finite_rings/finite_field_givaro.py # 2 doctests failed\nsage -t  devel/sage-13214/sage/rings/finite_rings/hom_finite_field.pyx # 2 doctests failed\n```\nPaul",
    "created_at": "2012-08-01T11:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151972",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:11" align="right">comment:11</div>

on top of Sage 5.1 I get the following failures with this patch:

```
sage -t  devel/sage-13214/sage/categories/modules_with_basis.py # 3 doctests failed
sage -t  devel/sage-13214/sage/rings/finite_rings/finite_field_base.pyx # 2 doctests failed
sage -t  devel/sage-13214/sage/rings/finite_rings/finite_field_givaro.py # 2 doctests failed
sage -t  devel/sage-13214/sage/rings/finite_rings/hom_finite_field.pyx # 2 doctests failed
```
Paul



---

archive/issue_comments_151973.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nDear Paul,\n\nI cannot reproduce the three last failures on my computer[*]. Could you please give me the complete output of 'sage -t'?\n\n[*] I'm currently working with sage 5.1.rc0; it's probably the reason.",
    "created_at": "2012-08-09T20:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151973",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:12" align="right">comment:12</div>

Dear Paul,

I cannot reproduce the three last failures on my computer[*]. Could you please give me the complete output of 'sage -t'?

[*] I'm currently working with sage 5.1.rc0; it's probably the reason.



---

archive/issue_comments_151974.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThese are the failures Paul observed (here on Sage 5.3) with this patch:\n\n```\nsage -t  \"devel/sage-codecan/sage/categories/modules_with_basis.py\"\n**********************************************************************\nFile \"devel/sage-codecan/sage/categories/modules_with_basis.py\", line 1149:\n    sage: TestSuite(phi).run() # known issue\nExpected:\n    Failure in _test_category:\n    ...\n    The following tests failed: _test_category\nGot:\n    Failure in _test_category:\n    Traceback (most recent call last):\n      File \"local/lib/python/site-packages/sage/misc/sage_unittest.py\", line 275, in run\n        test_method(tester = tester)\n      File \"element.pyx\", line 499, in sage.structure.element.Element._test_category (sage/structure/element.c:4702)\n      File \"local/lib/python2.7/unittest/case.py\", line 420, in assertTrue\n        raise self.failureException(msg)\n    AssertionError: False is not true\n    ------------------------------------------------------------\n    Failure in _test_eq:\n    Traceback (most recent call last):\n      File \"local/lib/python/site-packages/sage/misc/sage_unittest.py\", line 275, in run\n        test_method(tester = tester)\n      File \"element.pyx\", line 545, in sage.structure.element.Element._test_eq (sage/structure/element.c:4907)\n      File \"morphism.pyx\", line 214, in sage.categories.morphism.Morphism.__richcmp__ (sage/categories/morphism.c:3398)\n      File \"element.pyx\", line 876, in sage.structure.element.Element._richcmp (sage/structure/element.c:8370)\n      File \"element.pyx\", line 923, in sage.structure.element.Element._richcmp_c_impl (sage/structure/element.c:8671)\n      File \"morphism.pyx\", line 228, in sage.categories.morphism.Morphism._cmp_c_impl (sage/categories/morphism.c:3708)\n    NotImplementedError\n    ------------------------------------------------------------\n    The following tests failed: _test_category, _test_eq\n**********************************************************************\nFile \"devel/sage-codecan/sage/categories/modules_with_basis.py\", line 1384:\n    sage: TestSuite(phi).run() # known issue; see ModuleMorphism above\nExpected:\n    Failure in _test_category:\n    ...\n    The following tests failed: _test_category\nGot:\n    Failure in _test_category:\n    Traceback (most recent call last):\n      File \"local/lib/python/site-packages/sage/misc/sage_unittest.py\", line 275, in run\n        test_method(tester = tester)\n      File \"element.pyx\", line 499, in sage.structure.element.Element._test_category (sage/structure/element.c:4702)\n      File \"local/lib/python2.7/unittest/case.py\", line 420, in assertTrue\n        raise self.failureException(msg)\n    AssertionError: False is not true\n    ------------------------------------------------------------\n    Failure in _test_eq:\n    Traceback (most recent call last):\n      File \"local/lib/python/site-packages/sage/misc/sage_unittest.py\", line 275, in run\n        test_method(tester = tester)\n      File \"element.pyx\", line 545, in sage.structure.element.Element._test_eq (sage/structure/element.c:4907)\n      File \"morphism.pyx\", line 214, in sage.categories.morphism.Morphism.__richcmp__ (sage/categories/morphism.c:3398)\n      File \"element.pyx\", line 876, in sage.structure.element.Element._richcmp (sage/structure/element.c:8370)\n      File \"element.pyx\", line 923, in sage.structure.element.Element._richcmp_c_impl (sage/structure/element.c:8671)\n      File \"morphism.pyx\", line 228, in sage.categories.morphism.Morphism._cmp_c_impl (sage/categories/morphism.c:3708)\n    NotImplementedError\n    ------------------------------------------------------------\n    The following tests failed: _test_category, _test_eq\n**********************************************************************\nFile \"devel/sage-codecan/sage/categories/modules_with_basis.py\", line 1762:\n    sage: TestSuite(phi).run() # known issue; see ModuleMorphismByLinearity.__init__\nExpected:\n    Failure in _test_category:\n    ...\n    The following tests failed: _test_category\nGot:\n    Failure in _test_category:\n    Traceback (most recent call last):\n      File \"local/lib/python/site-packages/sage/misc/sage_unittest.py\", line 275, in run\n        test_method(tester = tester)\n      File \"element.pyx\", line 499, in sage.structure.element.Element._test_category (sage/structure/element.c:4702)\n      File \"local/lib/python2.7/unittest/case.py\", line 420, in assertTrue\n        raise self.failureException(msg)\n    AssertionError: False is not true\n    ------------------------------------------------------------\n    Failure in _test_eq:\n    Traceback (most recent call last):\n      File \"local/lib/python/site-packages/sage/misc/sage_unittest.py\", line 275, in run\n        test_method(tester = tester)\n      File \"element.pyx\", line 545, in sage.structure.element.Element._test_eq (sage/structure/element.c:4907)\n      File \"morphism.pyx\", line 214, in sage.categories.morphism.Morphism.__richcmp__ (sage/categories/morphism.c:3398)\n      File \"element.pyx\", line 876, in sage.structure.element.Element._richcmp (sage/structure/element.c:8370)\n      File \"element.pyx\", line 923, in sage.structure.element.Element._richcmp_c_impl (sage/structure/element.c:8671)\n      File \"morphism.pyx\", line 228, in sage.categories.morphism.Morphism._cmp_c_impl (sage/categories/morphism.c:3708)\n    NotImplementedError\n    ------------------------------------------------------------\n    The following tests failed: _test_category, _test_eq\n**********************************************************************\n3 items had failures:\n   1 of   8 in __main__.example_40\n   1 of   9 in __main__.example_45\n   1 of   9 in __main__.example_55\n***Test Failed*** 3 failures.\n```\n\n```\nsage -t  \"devel/sage-codecan/sage/rings/finite_rings/finite_field_base.pyx\"\n**********************************************************************\nFile \"devel/sage-codecan/sage/rings/finite_rings/finite_field_base.pyx\", line 793:\n    sage: k.frobenius_endomorphism(6) == Frob\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"devel/sage-codecan/sage/rings/finite_rings/finite_field_base.pyx\", line 796:\n    sage: k.frobenius_endomorphism(5) == IdentityMorphism(k)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   2 of  13 in __main__.example_38\n```\n\n```\nsage -t  \"devel/sage-codecan/sage/rings/finite_rings/finite_field_givaro.py\"\n**********************************************************************\nFile \"devel/sage-codecan/sage/rings/finite_rings/finite_field_givaro.py\", line 651:\n    sage: k.frobenius_endomorphism(6) == Frob\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"devel/sage-codecan/sage/rings/finite_rings/finite_field_givaro.py\", line 654:\n    sage: k.frobenius_endomorphism(5) == IdentityMorphism(k)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   2 of  13 in __main__.example_21\n***Test Failed*** 2 failures.\n```\n\n```\nsage -t  \"devel/sage-codecan/sage/rings/finite_rings/hom_finite_field.pyx\"\n**********************************************************************\nFile \"devel/sage-codecan/sage/rings/finite_rings/hom_finite_field.pyx\", line 74:\n    sage: Frob == Frob^15\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"devel/sage-codecan/sage/rings/finite_rings/hom_finite_field.pyx\", line 76:\n    sage: Frob^14 == Hom(k,k).identity()\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   2 of  26 in __main__.example_0\n***Test Failed*** 2 failures.\n```",
    "created_at": "2012-10-15T07:09:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151974",
    "user": "https://github.com/sagetrac-tfeulner"
}
```

<div id="comment:13" align="right">comment:13</div>

These are the failures Paul observed (here on Sage 5.3) with this patch:

```
sage -t  "devel/sage-codecan/sage/categories/modules_with_basis.py"
**********************************************************************
File "devel/sage-codecan/sage/categories/modules_with_basis.py", line 1149:
    sage: TestSuite(phi).run() # known issue
Expected:
    Failure in _test_category:
    ...
    The following tests failed: _test_category
Got:
    Failure in _test_category:
    Traceback (most recent call last):
      File "local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "element.pyx", line 499, in sage.structure.element.Element._test_category (sage/structure/element.c:4702)
      File "local/lib/python2.7/unittest/case.py", line 420, in assertTrue
        raise self.failureException(msg)
    AssertionError: False is not true
    ------------------------------------------------------------
    Failure in _test_eq:
    Traceback (most recent call last):
      File "local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "element.pyx", line 545, in sage.structure.element.Element._test_eq (sage/structure/element.c:4907)
      File "morphism.pyx", line 214, in sage.categories.morphism.Morphism.__richcmp__ (sage/categories/morphism.c:3398)
      File "element.pyx", line 876, in sage.structure.element.Element._richcmp (sage/structure/element.c:8370)
      File "element.pyx", line 923, in sage.structure.element.Element._richcmp_c_impl (sage/structure/element.c:8671)
      File "morphism.pyx", line 228, in sage.categories.morphism.Morphism._cmp_c_impl (sage/categories/morphism.c:3708)
    NotImplementedError
    ------------------------------------------------------------
    The following tests failed: _test_category, _test_eq
**********************************************************************
File "devel/sage-codecan/sage/categories/modules_with_basis.py", line 1384:
    sage: TestSuite(phi).run() # known issue; see ModuleMorphism above
Expected:
    Failure in _test_category:
    ...
    The following tests failed: _test_category
Got:
    Failure in _test_category:
    Traceback (most recent call last):
      File "local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "element.pyx", line 499, in sage.structure.element.Element._test_category (sage/structure/element.c:4702)
      File "local/lib/python2.7/unittest/case.py", line 420, in assertTrue
        raise self.failureException(msg)
    AssertionError: False is not true
    ------------------------------------------------------------
    Failure in _test_eq:
    Traceback (most recent call last):
      File "local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "element.pyx", line 545, in sage.structure.element.Element._test_eq (sage/structure/element.c:4907)
      File "morphism.pyx", line 214, in sage.categories.morphism.Morphism.__richcmp__ (sage/categories/morphism.c:3398)
      File "element.pyx", line 876, in sage.structure.element.Element._richcmp (sage/structure/element.c:8370)
      File "element.pyx", line 923, in sage.structure.element.Element._richcmp_c_impl (sage/structure/element.c:8671)
      File "morphism.pyx", line 228, in sage.categories.morphism.Morphism._cmp_c_impl (sage/categories/morphism.c:3708)
    NotImplementedError
    ------------------------------------------------------------
    The following tests failed: _test_category, _test_eq
**********************************************************************
File "devel/sage-codecan/sage/categories/modules_with_basis.py", line 1762:
    sage: TestSuite(phi).run() # known issue; see ModuleMorphismByLinearity.__init__
Expected:
    Failure in _test_category:
    ...
    The following tests failed: _test_category
Got:
    Failure in _test_category:
    Traceback (most recent call last):
      File "local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "element.pyx", line 499, in sage.structure.element.Element._test_category (sage/structure/element.c:4702)
      File "local/lib/python2.7/unittest/case.py", line 420, in assertTrue
        raise self.failureException(msg)
    AssertionError: False is not true
    ------------------------------------------------------------
    Failure in _test_eq:
    Traceback (most recent call last):
      File "local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "element.pyx", line 545, in sage.structure.element.Element._test_eq (sage/structure/element.c:4907)
      File "morphism.pyx", line 214, in sage.categories.morphism.Morphism.__richcmp__ (sage/categories/morphism.c:3398)
      File "element.pyx", line 876, in sage.structure.element.Element._richcmp (sage/structure/element.c:8370)
      File "element.pyx", line 923, in sage.structure.element.Element._richcmp_c_impl (sage/structure/element.c:8671)
      File "morphism.pyx", line 228, in sage.categories.morphism.Morphism._cmp_c_impl (sage/categories/morphism.c:3708)
    NotImplementedError
    ------------------------------------------------------------
    The following tests failed: _test_category, _test_eq
**********************************************************************
3 items had failures:
   1 of   8 in __main__.example_40
   1 of   9 in __main__.example_45
   1 of   9 in __main__.example_55
***Test Failed*** 3 failures.
```

```
sage -t  "devel/sage-codecan/sage/rings/finite_rings/finite_field_base.pyx"
**********************************************************************
File "devel/sage-codecan/sage/rings/finite_rings/finite_field_base.pyx", line 793:
    sage: k.frobenius_endomorphism(6) == Frob
Expected:
    True
Got:
    False
**********************************************************************
File "devel/sage-codecan/sage/rings/finite_rings/finite_field_base.pyx", line 796:
    sage: k.frobenius_endomorphism(5) == IdentityMorphism(k)
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   2 of  13 in __main__.example_38
```

```
sage -t  "devel/sage-codecan/sage/rings/finite_rings/finite_field_givaro.py"
**********************************************************************
File "devel/sage-codecan/sage/rings/finite_rings/finite_field_givaro.py", line 651:
    sage: k.frobenius_endomorphism(6) == Frob
Expected:
    True
Got:
    False
**********************************************************************
File "devel/sage-codecan/sage/rings/finite_rings/finite_field_givaro.py", line 654:
    sage: k.frobenius_endomorphism(5) == IdentityMorphism(k)
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   2 of  13 in __main__.example_21
***Test Failed*** 2 failures.
```

```
sage -t  "devel/sage-codecan/sage/rings/finite_rings/hom_finite_field.pyx"
**********************************************************************
File "devel/sage-codecan/sage/rings/finite_rings/hom_finite_field.pyx", line 74:
    sage: Frob == Frob^15
Expected:
    True
Got:
    False
**********************************************************************
File "devel/sage-codecan/sage/rings/finite_rings/hom_finite_field.pyx", line 76:
    sage: Frob^14 == Hom(k,k).identity()
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   2 of  26 in __main__.example_0
***Test Failed*** 2 failures.
```



---

archive/issue_comments_151975.json:
```json
{
    "body": "Attachment: **[trac_13214_hom_finite_field.2.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)**",
    "created_at": "2012-10-16T11:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151975",
    "user": "https://github.com/sagetrac-tfeulner"
}
```

Attachment: **[trac_13214_hom_finite_field.2.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)**



---

archive/issue_events_183883.json:
```json
{
    "actor": "https://github.com/sagetrac-tfeulner",
    "created_at": "2012-10-16T12:00:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183883"
}
```



---

archive/issue_events_183884.json:
```json
{
    "actor": "https://github.com/sagetrac-tfeulner",
    "created_at": "2012-10-16T12:00:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183884"
}
```



---

archive/issue_comments_151976.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,6 @@\n 1. Frobenius endomorphisms over finite fields (generic implementation, plus special implementations for prime finite fields and givaro finite fields)\n 2. embeddings between finite fields (with again a special implementation for givaro finite fields)\n 3. hashing and rich comparisons for general morphisms\n+\n+---\n+Apply: [trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)\n``````\n",
    "created_at": "2012-10-16T12:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151976",
    "user": "https://github.com/sagetrac-tfeulner"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,6 @@
 1. Frobenius endomorphisms over finite fields (generic implementation, plus special implementations for prime finite fields and givaro finite fields)
 2. embeddings between finite fields (with again a special implementation for givaro finite fields)
 3. hashing and rich comparisons for general morphisms
+
+---
+Apply: [trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)
``````




---

archive/issue_comments_151977.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI changed the coercion in sage/rings/finite_rings/homset.py. Now, this patch passes all doctests except for the one documented in sage/categories/modules_with_basis.py. I did not change the error messages there, because I wanted to discuss the failure first.",
    "created_at": "2012-10-16T12:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151977",
    "user": "https://github.com/sagetrac-tfeulner"
}
```

<div id="comment:14" align="right">comment:14</div>

I changed the coercion in sage/rings/finite_rings/homset.py. Now, this patch passes all doctests except for the one documented in sage/categories/modules_with_basis.py. I did not change the error messages there, because I wanted to discuss the failure first.



---

archive/issue_comments_151978.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,5 @@\n \n ---\n Apply: [trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)\n+\n+Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)\n``````\n",
    "created_at": "2012-10-22T13:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151978",
    "user": "https://github.com/xcaruso"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,5 @@
 
 ---
 Apply: [trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)
+
+Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)
``````




---

archive/issue_comments_151979.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks for catching this!\n\nI now understand why I didn't see this failure: it's just because this patch actually depends on #13184 and that the corresponding patch was applied on my computer. Sorry for this!\n\nI also attach a new version of my patch fixing the problem in modules_with_basis.py; I'm not really happy with my solution (but it has the advantage to be very short). Please let me now if you have some comment!",
    "created_at": "2012-10-22T13:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151979",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks for catching this!

I now understand why I didn't see this failure: it's just because this patch actually depends on #13184 and that the corresponding patch was applied on my computer. Sorry for this!

I also attach a new version of my patch fixing the problem in modules_with_basis.py; I'm not really happy with my solution (but it has the advantage to be very short). Please let me now if you have some comment!



---

archive/issue_comments_151980.json:
```json
{
    "body": "Dependencies: **#13184**",
    "created_at": "2012-10-22T13:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151980",
    "user": "https://github.com/xcaruso"
}
```

Dependencies: **#13184**



---

archive/issue_comments_151981.json:
```json
{
    "body": "Changed work issues from **failing doctests** to none",
    "created_at": "2012-10-22T13:41:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151981",
    "user": "https://github.com/xcaruso"
}
```

Changed work issues from **failing doctests** to none



---

archive/issue_comments_151982.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nfor the bot:\n\nApply trac_13214_hom_finite_field.2.patch",
    "created_at": "2013-03-20T16:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151982",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

for the bot:

Apply trac_13214_hom_finite_field.2.patch



---

archive/issue_comments_151983.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nlet me remove the dependency to #13184 from the ticket description and see what happens (waiting for the bot to run)",
    "created_at": "2013-03-20T19:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151983",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:18" align="right">comment:18</div>

let me remove the dependency to #13184 from the ticket description and see what happens (waiting for the bot to run)



---

archive/issue_comments_151984.json:
```json
{
    "body": "Changed dependencies from **#13184** to none",
    "created_at": "2013-03-20T19:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151984",
    "user": "https://github.com/fchapoton"
}
```

Changed dependencies from **#13184** to none



---

archive/issue_comments_151985.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,6 @@\n 3. hashing and rich comparisons for general morphisms\n \n ---\n-Apply: [trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)\n+Apply: [attachment: trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)\n \n-Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)\n+Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)\n``````\n",
    "created_at": "2013-03-28T21:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151985",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,6 @@
 3. hashing and rich comparisons for general morphisms
 
 ---
-Apply: [trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)
+Apply: [attachment: trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)
 
-Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)
+Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)
``````




---

archive/issue_comments_151986.json:
```json
{
    "body": "Dependencies: **#13184**",
    "created_at": "2013-03-28T21:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151986",
    "user": "https://github.com/fchapoton"
}
```

Dependencies: **#13184**



---

archive/issue_comments_151987.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nlet us now try with dependency to #13184 put back\n\nfor the bot:\n\napply trac_13214_hom_finite_field.patch",
    "created_at": "2013-03-28T21:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151987",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:19" align="right">comment:19</div>

let us now try with dependency to #13184 put back

for the bot:

apply trac_13214_hom_finite_field.patch



---

archive/issue_events_183885.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-05T15:04:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183885"
}
```



---

archive/issue_events_183886.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-04-05T15:04:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183886"
}
```



---

archive/issue_comments_151988.json:
```json
{
    "body": "Work Issues: **does not build**",
    "created_at": "2013-04-05T15:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151988",
    "user": "https://github.com/fchapoton"
}
```

Work Issues: **does not build**



---

archive/issue_comments_151989.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nplease provide a patch that applies, builds and pass all tests",
    "created_at": "2013-04-05T15:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151989",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

please provide a patch that applies, builds and pass all tests



---

archive/issue_comments_151990.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nNot sure how this relates to #8335, but it might be worth having a look there.",
    "created_at": "2013-06-04T09:12:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151990",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:22" align="right">comment:22</div>

Not sure how this relates to #8335, but it might be worth having a look there.



---

archive/issue_comments_151991.json:
```json
{
    "body": "Attachment: **[trac_13214_hom_finite_field.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)**",
    "created_at": "2013-06-26T08:20:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151991",
    "user": "https://github.com/xcaruso"
}
```

Attachment: **[trac_13214_hom_finite_field.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)**



---

archive/issue_events_183887.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2013-06-26T08:30:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183887"
}
```



---

archive/issue_events_183888.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2013-06-26T08:30:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183888"
}
```



---

archive/issue_comments_151992.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI've just posted a patch that should apply on sage-5.10 (let's wait and see).\n\nJean-Pierre, I was actually not aware about your work with David Roe on lattices of finite fields. I had a quick look at what you have implemented. Unfortunately, it seems to me that our philosophy is a bit different: if I understand correctly, you are trying to make all finite fields canonical whereas my idea was to ask explicitely to the user which embeddings (between finite fields) are canonical and which ones are not.\n\nBut, you're right. We should definitely understand precisely how our respective patches relate and merge them if necessary (or discard one of them, i.e. mine).\n\nNote: Actually, my main motivation for this patch was to implement Frobenius endomorphisms. I think you patch does not provide this functionality. Is that correct?",
    "created_at": "2013-06-26T08:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151992",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:23" align="right">comment:23</div>

I've just posted a patch that should apply on sage-5.10 (let's wait and see).

Jean-Pierre, I was actually not aware about your work with David Roe on lattices of finite fields. I had a quick look at what you have implemented. Unfortunately, it seems to me that our philosophy is a bit different: if I understand correctly, you are trying to make all finite fields canonical whereas my idea was to ask explicitely to the user which embeddings (between finite fields) are canonical and which ones are not.

But, you're right. We should definitely understand precisely how our respective patches relate and merge them if necessary (or discard one of them, i.e. mine).

Note: Actually, my main motivation for this patch was to implement Frobenius endomorphisms. I think you patch does not provide this functionality. Is that correct?



---

archive/issue_comments_151993.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,4 @@\n 3. hashing and rich comparisons for general morphisms\n \n ---\n-Apply: [attachment: trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)\n-\n-Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)\n+Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)\n``````\n",
    "created_at": "2013-06-26T08:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151993",
    "user": "https://github.com/xcaruso"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,4 @@
 3. hashing and rich comparisons for general morphisms
 
 ---
-Apply: [attachment: trac_13214_hom_finite_field.2.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.2.patch.gz)
-
-Or: [trac_13184_homset_unique_parent](https://github.com/sagemath/sage/files/ticket13184/trac_13184_homset_unique_parent.gz) and [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)
+Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)
``````




---

archive/issue_comments_151994.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI agree that the purposes of both patches are quite orthogonal: the point of our patch is a first step toward having compatible embeddings in lattices of finite fields automatically, i.e. mimic what Magma does where the user does not have to pay attention to such things and it just works.\n\nAnd I feel we should merge both patches if possible, even if at some later point it could make sense to refactor some pieces of code.",
    "created_at": "2013-06-26T08:53:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151994",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:24" align="right">comment:24</div>

I agree that the purposes of both patches are quite orthogonal: the point of our patch is a first step toward having compatible embeddings in lattices of finite fields automatically, i.e. mimic what Magma does where the user does not have to pay attention to such things and it just works.

And I feel we should merge both patches if possible, even if at some later point it could make sense to refactor some pieces of code.



---

archive/issue_comments_151995.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThis looks interesting.  One question at the moment: it does not appear to relate to the basic functionality that currently exists (in `sage/rings/finite_rings/homset.py`).  Is that intentional?  I can already type, for example,\n\n```\nsage: F9.<a>=GF(3^2)         \nsage: F81.<b>=GF(3^4)\nsage: f=F9.hom((b^10,))        \nsage: f\nRing morphism:\n  From: Finite Field in a of size 3^2\n  To:   Finite Field in b of size 3^4\n  Defn: a |--> 2*b^3 + 2*b^2 + 1\nsage: f(a^2+a)\nb^3 + b^2\nsage: type(f)\n<class 'sage.rings.finite_rings.homset.FiniteFieldHomomorphism_im_gens'>\n```",
    "created_at": "2013-06-26T14:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151995",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:25" align="right">comment:25</div>

This looks interesting.  One question at the moment: it does not appear to relate to the basic functionality that currently exists (in `sage/rings/finite_rings/homset.py`).  Is that intentional?  I can already type, for example,

```
sage: F9.<a>=GF(3^2)         
sage: F81.<b>=GF(3^4)
sage: f=F9.hom((b^10,))        
sage: f
Ring morphism:
  From: Finite Field in a of size 3^2
  To:   Finite Field in b of size 3^4
  Defn: a |--> 2*b^3 + 2*b^2 + 1
sage: f(a^2+a)
b^3 + b^2
sage: type(f)
<class 'sage.rings.finite_rings.homset.FiniteFieldHomomorphism_im_gens'>
```



---

archive/issue_comments_151996.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAs for the differing purposes of the two approaches, there should probably be two categories into which a finite field can be put:\n\n- the category of all finite fields.  In this category, between any two objects there are either several morphisms or none at all, but no canonical one.\n\n- the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.",
    "created_at": "2013-06-26T14:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151996",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:26" align="right">comment:26</div>

As for the differing purposes of the two approaches, there should probably be two categories into which a finite field can be put:

- the category of all finite fields.  In this category, between any two objects there are either several morphisms or none at all, but no canonical one.

- the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.



---

archive/issue_comments_151997.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@pjbruin](#comment:26):\n> As for the differing purposes of the two approaches, there should probably be two categories into which a finite field can be put:\n> \n> - the category of all finite fields.  In this category, between any two objects there are either several morphisms or none at all, but no canonical one.\n\nWhich is basically what we currently have and also what this ticket does.\n> \n> - the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.\n\nI would like this to be the default at some point, just like in Magma, not because I want to replicate Magma but for usual computations it seems a more practical choice.\n#8335 provides such an imlementation, though it not really practical for large fields and there is no proper categorical framework as you suggest.\n\nThis framework could be implemented in an independent ticket (and should if we want to be able to merge some tickets in a finite amount of time).",
    "created_at": "2013-06-26T14:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151997",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@pjbruin](#comment:26):
> As for the differing purposes of the two approaches, there should probably be two categories into which a finite field can be put:
> 
> - the category of all finite fields.  In this category, between any two objects there are either several morphisms or none at all, but no canonical one.

Which is basically what we currently have and also what this ticket does.
> 
> - the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.

I would like this to be the default at some point, just like in Magma, not because I want to replicate Magma but for usual computations it seems a more practical choice.
#8335 provides such an imlementation, though it not really practical for large fields and there is no proper categorical framework as you suggest.

This framework could be implemented in an independent ticket (and should if we want to be able to merge some tickets in a finite amount of time).



---

archive/issue_comments_151998.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jpflori](#comment:27):\n\n> Which is basically what we currently have and also what this ticket does.\n\nYes, and precisely for this reason I think it is important to have a clear picture of what belongs in the \"category of all finite fields\" framework, what belongs in the future \"finite subfields of a given algebraic closure\" framework, and what is independent of the framework.  Among the category-independent things would certainly be the various classes implementing the interfaces to FLINT, Givaro, NTL and PARI, and to a large extent the `FiniteField` base class itself.\n\n> > - the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.\n\n> I would like this to be the default at some point, just like in Magma, not because I want to replicate Magma but for usual computations it seems a more practical choice.\n\nThat probably depends strongly on the application.  Often one just needs to work with a single finite field.  In such cases it would be nicer if creating this field would give you a sparse polynomial for efficiency, not one that has been constructed to fit in an algebraic closure that you are unlikely to use.\n\nOf course it would be best if one could do both at the same time, like Magma (see references at #8751), by having an implementation that allows using sparse polynomials while still being able to put the fields in a compatible system/algebraic closure.  However, that should probably be done on top of the distinction between the two categories mentioned above, not by muddling this distinction.",
    "created_at": "2013-06-26T16:34:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151998",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jpflori](#comment:27):

> Which is basically what we currently have and also what this ticket does.

Yes, and precisely for this reason I think it is important to have a clear picture of what belongs in the "category of all finite fields" framework, what belongs in the future "finite subfields of a given algebraic closure" framework, and what is independent of the framework.  Among the category-independent things would certainly be the various classes implementing the interfaces to FLINT, Givaro, NTL and PARI, and to a large extent the `FiniteField` base class itself.

> > - the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.

> I would like this to be the default at some point, just like in Magma, not because I want to replicate Magma but for usual computations it seems a more practical choice.

That probably depends strongly on the application.  Often one just needs to work with a single finite field.  In such cases it would be nicer if creating this field would give you a sparse polynomial for efficiency, not one that has been constructed to fit in an algebraic closure that you are unlikely to use.

Of course it would be best if one could do both at the same time, like Magma (see references at #8751), by having an implementation that allows using sparse polynomials while still being able to put the fields in a compatible system/algebraic closure.  However, that should probably be done on top of the distinction between the two categories mentioned above, not by muddling this distinction.



---

archive/issue_comments_151999.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@pjbruin](#comment:25):\n> This looks interesting.  One question at the moment: it does not appear to relate to the basic functionality that currently exists (in `sage/rings/finite_rings/homset.py`).  Is that intentional?\n\nYes, more or less.\n\nActually, my first motivation was to implement Frobenius endomorphism and, according to me, FrobeniusEndomorphism should not derive from RingHomomorphism_im_gens. Indeed, defining Frobenius endomorphisms by giving its value on the generator is not really appropriate for many operations we would like to perform (i.e. evaluation if the field has a small characteristic and a big size, composition, computation of the order or of the subfield of fixed points).\n\nOn the other hand, I agree that it makes sense to derive the various classes of embeddings from FiniteFieldHomomorphism_im_gens. I can actually change this if you think that it is better.\n\n\n> As for the differing purposes of the two approaches, there should probably be two categories into which a finite field can be put:\n> \n> - the category of all finite fields.  In this category, between any two objects there are either several morphisms or none at all, but no canonical one.\n> \n> - the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.\n\nThis sounds good.\nAnd the second category should be a subcategory of the first one, right (a finite subfield of a given algebraic closure of **F**<sub>*p*</sub> is in particular a finite field)? If so, all category-independant functions should go to the first category (even if the second one is the default, as suggested by Jean-Pierre). This is the case in particular for Frobenius endomorphisms.",
    "created_at": "2013-06-26T19:35:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-151999",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@pjbruin](#comment:25):
> This looks interesting.  One question at the moment: it does not appear to relate to the basic functionality that currently exists (in `sage/rings/finite_rings/homset.py`).  Is that intentional?

Yes, more or less.

Actually, my first motivation was to implement Frobenius endomorphism and, according to me, FrobeniusEndomorphism should not derive from RingHomomorphism_im_gens. Indeed, defining Frobenius endomorphisms by giving its value on the generator is not really appropriate for many operations we would like to perform (i.e. evaluation if the field has a small characteristic and a big size, composition, computation of the order or of the subfield of fixed points).

On the other hand, I agree that it makes sense to derive the various classes of embeddings from FiniteFieldHomomorphism_im_gens. I can actually change this if you think that it is better.


> As for the differing purposes of the two approaches, there should probably be two categories into which a finite field can be put:
> 
> - the category of all finite fields.  In this category, between any two objects there are either several morphisms or none at all, but no canonical one.
> 
> - the category of finite subfields of a given algebraic closure of **F**<sub>*p*</sub>.  In this category there is at most one morphism beteen any two objects, namely the inclusion qua subfields of the given algebraic closure.

This sounds good.
And the second category should be a subcategory of the first one, right (a finite subfield of a given algebraic closure of **F**<sub>*p*</sub> is in particular a finite field)? If so, all category-independant functions should go to the first category (even if the second one is the default, as suggested by Jean-Pierre). This is the case in particular for Frobenius endomorphisms.



---

archive/issue_comments_152000.json:
```json
{
    "body": "Changed keywords from **frobenius finite fields** to **frobenius finite fields sd51**",
    "created_at": "2013-07-13T19:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152000",
    "user": "https://github.com/pjbruin"
}
```

Changed keywords from **frobenius finite fields** to **frobenius finite fields sd51**



---

archive/issue_comments_152001.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThis might be a good target for Sage Days 51 (22-26 July, [http://wiki.sagemath.org/sagedaysleiden](http://wiki.sagemath.org/sagedaysleiden)).  For now I just checked that the patch applies to 5.11.beta3 (with some fuzz) and passes doctests.  I got one failure (a different embedding than expected is generated), probably because I am working under #14888.",
    "created_at": "2013-07-13T19:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152001",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:31" align="right">comment:31</div>

This might be a good target for Sage Days 51 (22-26 July, [http://wiki.sagemath.org/sagedaysleiden](http://wiki.sagemath.org/sagedaysleiden)).  For now I just checked that the patch applies to 5.11.beta3 (with some fuzz) and passes doctests.  I got one failure (a different embedding than expected is generated), probably because I am working under #14888.



---

archive/issue_comments_152002.json:
```json
{
    "body": "Changed work issues from **does not build** to none",
    "created_at": "2013-07-13T19:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152002",
    "user": "https://github.com/pjbruin"
}
```

Changed work issues from **does not build** to none



---

archive/issue_comments_152003.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nApply trac_13214_hom_finite_field.patch\u200b\n\n(for patchbot)",
    "created_at": "2013-07-25T11:46:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152003",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:32" align="right">comment:32</div>

Apply trac_13214_hom_finite_field.patch​

(for patchbot)



---

archive/issue_comments_152004.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nfor the bot:\n\napply only trac_13214_hom_finite_field.patch",
    "created_at": "2013-08-02T09:39:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152004",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:33" align="right">comment:33</div>

for the bot:

apply only trac_13214_hom_finite_field.patch



---

archive/issue_comments_152005.json:
```json
{
    "body": "Attachment: **[trac_13214-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz)**\n\n(long) reviewer patch",
    "created_at": "2013-08-13T08:37:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152005",
    "user": "https://github.com/pjbruin"
}
```

Attachment: **[trac_13214-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz)**

(long) reviewer patch



---

archive/issue_comments_152006.json:
```json
{
    "body": "Changed reviewer from **Paul Zimmermann** to **Paul Zimmermann, Peter Bruin**",
    "created_at": "2013-08-13T08:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152006",
    "user": "https://github.com/pjbruin"
}
```

Changed reviewer from **Paul Zimmermann** to **Paul Zimmermann, Peter Bruin**



---

archive/issue_comments_152007.json:
```json
{
    "body": "Changed dependencies from **#13184** to **#8335**",
    "created_at": "2013-08-13T08:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152007",
    "user": "https://github.com/pjbruin"
}
```

Changed dependencies from **#13184** to **#8335**



---

archive/issue_events_183889.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-08-13T08:55:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183889"
}
```



---

archive/issue_events_183890.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-08-13T08:55:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20finite%20rings",
    "label_color": "0000ff",
    "label_name": "c: finite rings",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183890"
}
```



---

archive/issue_events_183891.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-08-13T08:55:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "title_is": "Finite field homomorphisms and Frobenius endomorphisms",
    "title_was": "Frobenius endomorphism over finite fields",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183891"
}
```



---

archive/issue_comments_152008.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,4 @@\n 3. hashing and rich comparisons for general morphisms\n \n ---\n-Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)\n+Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz), [attachment: trac_13214-reviewer.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz)\n``````\n",
    "created_at": "2013-08-13T08:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152008",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,4 @@
 3. hashing and rich comparisons for general morphisms
 
 ---
-Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz)
+Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz), [attachment: trac_13214-reviewer.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz)
``````




---

archive/issue_comments_152009.json:
```json
{
    "body": "Changed author from **Xavier Caruso** to **Xavier Caruso, Peter Bruin**",
    "created_at": "2013-08-13T08:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152009",
    "user": "https://github.com/pjbruin"
}
```

Changed author from **Xavier Caruso** to **Xavier Caruso, Peter Bruin**



---

archive/issue_comments_152010.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nIn principle I am giving this a positive review, but since the reviewer patch I just uploaded contains some non-trivial changes, I think it is best if someone else reviews those changes first.\n\nSummary of changes in [attachment: trac_13214-reviewer.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz):\n- Do not add `inverse()` method to `Section`; it is currently not used and does not seem to be the best name, since its return value (the original map) is only a one-sided inverse.\n- Add method `gens()` to `CombinatorialFreeModule` to fix a doctest failure in `modules_with_basis.py`.  I guess this is the same failure discussed in [comment:14](#comment:14) above.\n- Rename `[Section]FiniteFieldEmbedding_*` to `[Section]FiniteFieldHomomorphism_*`; even though finite field homomorphisms are automatically injective, I think \"homomorphism\" fits better with existing code.  Furthermore, to me \"embedding\" makes it sound too much like finite field homomorphisms are canonical.\n- Derive `FiniteFieldHomomorphism_generic` from `RingHomomorphism_im_gens` as suggested above.\n- Replace the existing `FiniteFieldHomomorphism_im_gens` by the new `FiniteFieldHomomorphism_generic`.\n- Better integration of the new code into the existing finite field code.\n- Remove the `_repr_()` method of `FiniteFieldHomomorphism_generic`, so that the output is the same as for the old `FiniteFieldHomomorphism_im_gens`.\n- Do not automatically generate a section for every finite field homomorphism.\n- Numerous whitespace edits and some other typographical changes.",
    "created_at": "2013-08-13T08:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152010",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:34" align="right">comment:34</div>

In principle I am giving this a positive review, but since the reviewer patch I just uploaded contains some non-trivial changes, I think it is best if someone else reviews those changes first.

Summary of changes in [attachment: trac_13214-reviewer.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz):
- Do not add `inverse()` method to `Section`; it is currently not used and does not seem to be the best name, since its return value (the original map) is only a one-sided inverse.
- Add method `gens()` to `CombinatorialFreeModule` to fix a doctest failure in `modules_with_basis.py`.  I guess this is the same failure discussed in [comment:14](#comment:14) above.
- Rename `[Section]FiniteFieldEmbedding_*` to `[Section]FiniteFieldHomomorphism_*`; even though finite field homomorphisms are automatically injective, I think "homomorphism" fits better with existing code.  Furthermore, to me "embedding" makes it sound too much like finite field homomorphisms are canonical.
- Derive `FiniteFieldHomomorphism_generic` from `RingHomomorphism_im_gens` as suggested above.
- Replace the existing `FiniteFieldHomomorphism_im_gens` by the new `FiniteFieldHomomorphism_generic`.
- Better integration of the new code into the existing finite field code.
- Remove the `_repr_()` method of `FiniteFieldHomomorphism_generic`, so that the output is the same as for the old `FiniteFieldHomomorphism_im_gens`.
- Do not automatically generate a section for every finite field homomorphism.
- Numerous whitespace edits and some other typographical changes.



---

archive/issue_comments_152011.json:
```json
{
    "body": "Attachment: **[trac_13214-folded.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214-folded.patch.gz)**\n\nfor convenience: unified patch combining trac_13214_hom_finite_field.patch and trac_13214-reviewer.patch",
    "created_at": "2013-08-13T08:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152011",
    "user": "https://github.com/pjbruin"
}
```

Attachment: **[trac_13214-folded.patch.gz](https://github.com/sagemath/sage/files/ticket13214/trac_13214-folded.patch.gz)**

for convenience: unified patch combining trac_13214_hom_finite_field.patch and trac_13214-reviewer.patch



---

archive/issue_events_183892.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183892"
}
```



---

archive/issue_events_183893.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183893"
}
```



---

archive/issue_comments_152012.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\napply only trac_13214-folded.patch",
    "created_at": "2013-08-21T08:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152012",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:36" align="right">comment:36</div>

apply only trac_13214-folded.patch



---

archive/issue_comments_152013.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,4 @@\n 3. hashing and rich comparisons for general morphisms\n \n ---\n-Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz), [attachment: trac_13214-reviewer.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz)\n+Apply: [attachment: trac_13214-folded.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-folded.patch.gz)\n``````\n",
    "created_at": "2013-08-21T08:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152013",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,4 @@
 3. hashing and rich comparisons for general morphisms
 
 ---
-Apply: [attachment: trac_13214_hom_finite_field.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214_hom_finite_field.patch.gz), [attachment: trac_13214-reviewer.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-reviewer.patch.gz)
+Apply: [attachment: trac_13214-folded.patch](https://github.com/sagemath/sage/files/ticket13214/trac_13214-folded.patch.gz)
``````




---

archive/issue_events_183894.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-09-06T09:11:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183894"
}
```



---

archive/issue_events_183895.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2013-09-06T09:11:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183895"
}
```



---

archive/issue_comments_152014.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI'm currently at Sage Days 53 and could spare some time on this one... unless Luca is nearing completion of his review?\n\nIf I understand correctly, what needs to be done is to check Peter's changes as he already went over what Xavier did?",
    "created_at": "2013-09-24T13:45:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152014",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:38" align="right">comment:38</div>

I'm currently at Sage Days 53 and could spare some time on this one... unless Luca is nearing completion of his review?

If I understand correctly, what needs to be done is to check Peter's changes as he already went over what Xavier did?



---

archive/issue_comments_152015.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@jpflori](#comment:38):\n> I'm currently at Sage Days 53 and could spare some time on this one... unless Luca is nearing completion of his review?\n\nI'm rather nearing completion of the new class I'm starting next week... so feel free to go ahead :)",
    "created_at": "2013-09-24T13:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152015",
    "user": "https://github.com/defeo"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@jpflori](#comment:38):
> I'm currently at Sage Days 53 and could spare some time on this one... unless Luca is nearing completion of his review?

I'm rather nearing completion of the new class I'm starting next week... so feel free to go ahead :)



---

archive/issue_comments_152016.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@jpflori](#comment:38):\n> I'm currently at Sage Days 53 and could spare some time on this one... unless Luca is nearing completion of his review?\n> \n> If I understand correctly, what needs to be done is to check Peter's changes as he already went over what Xavier did?\n\nYes, it would be nice if you could take a look either at my reviewer patch or at the combined one (the combined patch is only a little larger and probably easier to review).",
    "created_at": "2013-09-24T14:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152016",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@jpflori](#comment:38):
> I'm currently at Sage Days 53 and could spare some time on this one... unless Luca is nearing completion of his review?
> 
> If I understand correctly, what needs to be done is to check Peter's changes as he already went over what Xavier did?

Yes, it would be nice if you could take a look either at my reviewer patch or at the combined one (the combined patch is only a little larger and probably easier to review).



---

archive/issue_comments_152017.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\npatchbot: only\n\nApply trac_13214-folded.patch\u200b",
    "created_at": "2013-10-23T09:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152017",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:41" align="right">comment:41</div>

patchbot: only

Apply trac_13214-folded.patch​



---

archive/issue_events_183896.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-10-25T11:46:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183896"
}
```



---

archive/issue_events_183897.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-10-25T11:46:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183897"
}
```



---

archive/issue_comments_152018.json:
```json
{
    "body": "Changed reviewer from **Paul Zimmermann, Peter Bruin** to **Paul Zimmermann, Peter Bruin, Volker Braun**",
    "created_at": "2013-10-25T11:46:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152018",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Paul Zimmermann, Peter Bruin** to **Paul Zimmermann, Peter Bruin, Volker Braun**



---

archive/issue_comments_152019.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nThe review patch looks good to me.",
    "created_at": "2013-10-25T11:46:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152019",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:42" align="right">comment:42</div>

The review patch looks good to me.



---

archive/issue_events_183898.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:16:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183898"
}
```



---

archive/issue_events_183899.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:16:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13214#event-183899"
}
```



---

archive/issue_comments_152020.json:
```json
{
    "body": "Merged: **sage-5.13.beta2**",
    "created_at": "2013-10-31T19:16:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13214",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13214#issuecomment-152020",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta2**
