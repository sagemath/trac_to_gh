# Issue 13289: Determine if a vertex is a cut vertex

archive/issues_013117.json:
```json
{
    "assignees": [],
    "body": "This patch test if a given vertex is a cut vertex, that is if its removal from the (di)graph increases the number of (weakly) connected components.\n\n\nAssignee: **@jasongrout, @nathanncohen, @rlmill**\n\nCC:  @sagetrac-lkeough\n\nReviewer: **Sebastian Luther**\n\nAuthor: **David Coudert**\n\nMerged: **sage-5.4.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13289_\n\n",
    "closed_at": "2012-09-28T07:47:53Z",
    "created_at": "2012-07-24T22:17:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Determine if a vertex is a cut vertex",
    "type": "issue",
    "updated_at": "2012-09-28T07:47:53Z",
    "url": "https://github.com/sagemath/sage/issues/13289",
    "user": "https://github.com/dcoudert"
}
```
This patch test if a given vertex is a cut vertex, that is if its removal from the (di)graph increases the number of (weakly) connected components.


Assignee: **@jasongrout, @nathanncohen, @rlmill**

CC:  @sagetrac-lkeough

Reviewer: **Sebastian Luther**

Author: **David Coudert**

Merged: **sage-5.4.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/13289_





---

archive/issue_events_169764.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-24T22:17:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "milestone_number": null,
    "milestone_title": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169764"
}
```



---

archive/issue_events_169765.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-24T22:17:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "component: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169765"
}
```



---

archive/issue_events_169766.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-24T22:17:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169766"
}
```



---

archive/issue_events_169767.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-24T22:17:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169767"
}
```



---

archive/issue_events_169768.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-24T22:41:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169768"
}
```



---

archive/issue_comments_155855.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nI'm not fully satisfied of this patch, but I have no better implementation in mind.\n\nFor digraphs, this patch considers weakly connected components, but it could also considers strongly connected components. I'm not sure of the most relevant definition.",
    "created_at": "2012-07-24T22:41:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155855",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:1" align="right">Comment 1</div>

I'm not fully satisfied of this patch, but I have no better implementation in mind.

For digraphs, this patch considers weakly connected components, but it could also considers strongly connected components. I'm not sure of the most relevant definition.



---

archive/issue_comments_155856.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n This patch test if a given vertex is a cut vertex, that is if its removal from the (di)graph increases the number of (weakly) connected components.\n+\n+For digraphs, this patch considers weakly connected components, but it could also considers strongly connected components. I'm not sure of the most relevant definition.\n``````\n",
    "created_at": "2012-07-24T22:41:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155856",
    "user": "https://github.com/dcoudert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 This patch test if a given vertex is a cut vertex, that is if its removal from the (di)graph increases the number of (weakly) connected components.
+
+For digraphs, this patch considers weakly connected components, but it could also considers strongly connected components. I'm not sure of the most relevant definition.
``````




---

archive/issue_comments_155857.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,2 @@\n This patch test if a given vertex is a cut vertex, that is if its removal from the (di)graph increases the number of (weakly) connected components.\n \n-For digraphs, this patch considers weakly connected components, but it could also considers strongly connected components. I'm not sure of the most relevant definition.\n``````\n",
    "created_at": "2012-07-24T22:42:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155857",
    "user": "https://github.com/dcoudert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,2 @@
 This patch test if a given vertex is a cut vertex, that is if its removal from the (di)graph increases the number of (weakly) connected components.
 
-For digraphs, this patch considers weakly connected components, but it could also considers strongly connected components. I'm not sure of the most relevant definition.
``````




---

archive/issue_comments_155858.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nI'm not sure of the most relevant definition either, but blocks_and_cut_vertices also uses the underlying graph for directed graphs.\n\nI tried using blocks and cut vertices to write is_cut_vertex, but it appears to be much slower (as expected).  I'm not sure of a better way to implement this.\n\nThe tests all ran fine, maybe it's a good idea to add a digraphs test/example?",
    "created_at": "2012-07-25T15:44:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155858",
    "user": "https://github.com/sagetrac-lkeough"
}
```

<div id="comment:3" align="right">Comment 3</div>

I'm not sure of the most relevant definition either, but blocks_and_cut_vertices also uses the underlying graph for directed graphs.

I tried using blocks and cut vertices to write is_cut_vertex, but it appears to be much slower (as expected).  I'm not sure of a better way to implement this.

The tests all ran fine, maybe it's a good idea to add a digraphs test/example?



---

archive/issue_comments_155859.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nI added a test on a digraph.\n\nI don't know how to make this patch faster. So unless someone has a better proposition now, you can validate this patch, and future improvements will go to a new patch.\n\nThanks.",
    "created_at": "2012-07-25T16:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155859",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:4" align="right">Comment 4</div>

I added a test on a digraph.

I don't know how to make this patch faster. So unless someone has a better proposition now, you can validate this patch, and future improvements will go to a new patch.

Thanks.



---

archive/issue_comments_155860.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nGood, all the tests ran fine.  When I built the documentation I noticed a colon is missing in line 4026 so the example with giving a vertex not in the graph isn't showing up properly.  Once that is fixed I'll give a positive review.",
    "created_at": "2012-07-26T17:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155860",
    "user": "https://github.com/sagetrac-lkeough"
}
```

<div id="comment:5" align="right">Comment 5</div>

Good, all the tests ran fine.  When I built the documentation I noticed a colon is missing in line 4026 so the example with giving a vertex not in the graph isn't showing up properly.  Once that is fixed I'll give a positive review.



---

archive/issue_comments_155861.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nOups. That's the default of working remotely. I don't always notice such mistakes.\nIt should now be OK.",
    "created_at": "2012-07-26T19:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155861",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:6" align="right">Comment 6</div>

Oups. That's the default of working remotely. I don't always notice such mistakes.
It should now be OK.



---

archive/issue_events_169769.json:
```json
{
    "actor": "https://github.com/sagetrac-lkeough",
    "created_at": "2012-07-26T20:46:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169769"
}
```



---

archive/issue_events_169770.json:
```json
{
    "actor": "https://github.com/sagetrac-lkeough",
    "created_at": "2012-07-26T20:46:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169770"
}
```



---

archive/issue_comments_155862.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThanks for the review !",
    "created_at": "2012-07-26T20:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155862",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:8" align="right">Comment 8</div>

Thanks for the review !



---

archive/issue_comments_155863.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nPlease fill in your real name as Reviewer.",
    "created_at": "2012-07-27T20:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155863",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">Comment 9</div>

Please fill in your real name as Reviewer.



---

archive/issue_events_169771.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-07-29T20:24:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169771"
}
```



---

archive/issue_events_169772.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-07-29T20:24:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169772"
}
```



---

archive/issue_comments_155864.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nThere is major problem with this patch. It modifies the given graph.\n\nWhile it tries to revert the effect, this is still a bad idea. If an exception occurs between the removal of the vertex and the addition of the edges then the graph will end up modified (just think of CTRL+C or out of memory).\n\nAlso the reversal doesn't work for directed graphs currently. Just check the number of edges of D in your test case.\n\nI'd argue that you shouldn't try to fix the reversal, but get rid of it. I don't now much about the problem, so can't suggest a better algorithm that what a quick google search would reveal. If you can't find a better algorithm, make a copy of the graph and modify this copy.",
    "created_at": "2012-07-29T20:24:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155864",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:10" align="right">Comment 10</div>

There is major problem with this patch. It modifies the given graph.

While it tries to revert the effect, this is still a bad idea. If an exception occurs between the removal of the vertex and the addition of the edges then the graph will end up modified (just think of CTRL+C or out of memory).

Also the reversal doesn't work for directed graphs currently. Just check the number of edges of D in your test case.

I'd argue that you shouldn't try to fix the reversal, but get rid of it. I don't now much about the problem, so can't suggest a better algorithm that what a quick google search would reveal. If you can't find a better algorithm, make a copy of the graph and modify this copy.



---

archive/issue_comments_155865.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nThat's right, the patch should not modify the graph. Unfortunately I have no got implementation to propose. In particular, it is impossible to use the blocks and cuts procedure since it is way to slow (should be cythonized some day).\n\nI have changed the patch. I'm not happy with this implementation but it's working. One may later propose a faster implementation.",
    "created_at": "2012-07-29T22:54:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155865",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:11" align="right">Comment 11</div>

That's right, the patch should not modify the graph. Unfortunately I have no got implementation to propose. In particular, it is impossible to use the blocks and cuts procedure since it is way to slow (should be cythonized some day).

I have changed the patch. I'm not happy with this implementation but it's working. One may later propose a faster implementation.



---

archive/issue_comments_155866.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nIf fact the running time of the function is largely dominated by the copy of the graph. This is boring.",
    "created_at": "2012-07-30T06:41:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155866",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:12" align="right">Comment 12</div>

If fact the running time of the function is largely dominated by the copy of the graph. This is boring.



---

archive/issue_comments_155867.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nAt least for the undirected case you could perform two DFSs and count the visited vertices. The first search would start at v and run on the orginal graph. The second one would ignore all edges incident to v and start at any neighbor of v. If v is not a cut vertex, the number of visited vertices should decrese only by 1.\n\nFor the first search you could call connected_component_containing_vertex. For the second run you need to inline the code and add the ability to ignore edges.",
    "created_at": "2012-07-30T08:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155867",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:13" align="right">Comment 13</div>

At least for the undirected case you could perform two DFSs and count the visited vertices. The first search would start at v and run on the orginal graph. The second one would ignore all edges incident to v and start at any neighbor of v. If v is not a cut vertex, the number of visited vertices should decrese only by 1.

For the first search you could call connected_component_containing_vertex. For the second run you need to inline the code and add the ability to ignore edges.



---

archive/issue_events_169773.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-30T11:27:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169773"
}
```



---

archive/issue_events_169774.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-07-30T11:27:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169774"
}
```



---

archive/issue_comments_155868.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nI fact, only one DFS is required for undirected graphs (or weak connectivity), and two for the strong connectivity of directed graphs. I don't need to copy the graph anymore and the running time of the resulting algorithm is acceptable.\n\n```\nsage: G = digraphs.RandomDirectedGNP(1000,.3)\nsage: H = digraphs.RandomDirectedGNP(1000,.3)\nsage: K = G+H\nsage: K.add_edge(0,1000)\nsage: K.add_edge(1200,300)\nsage: %time K.is_strongly_connected()\nCPU times: user 0.09 s, sys: 0.00 s, total: 0.09 s\nWall time: 0.09 s\nTrue\nsage: %time K.is_cut_vertex(0)\nCPU times: user 0.23 s, sys: 0.00 s, total: 0.23 s\nWall time: 0.23 s\nTrue\nsage: %time K.is_cut_vertex(0, weak=True)\nCPU times: user 1.01 s, sys: 0.00 s, total: 1.01 s\nWall time: 1.01 s\nFalse\n```\nThe only way to be faster is to use cython, as for the is_strongly_connected function. But I'm not sure it is worth the effort.",
    "created_at": "2012-07-30T11:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155868",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:14" align="right">Comment 14</div>

I fact, only one DFS is required for undirected graphs (or weak connectivity), and two for the strong connectivity of directed graphs. I don't need to copy the graph anymore and the running time of the resulting algorithm is acceptable.

```
sage: G = digraphs.RandomDirectedGNP(1000,.3)
sage: H = digraphs.RandomDirectedGNP(1000,.3)
sage: K = G+H
sage: K.add_edge(0,1000)
sage: K.add_edge(1200,300)
sage: %time K.is_strongly_connected()
CPU times: user 0.09 s, sys: 0.00 s, total: 0.09 s
Wall time: 0.09 s
True
sage: %time K.is_cut_vertex(0)
CPU times: user 0.23 s, sys: 0.00 s, total: 0.23 s
Wall time: 0.23 s
True
sage: %time K.is_cut_vertex(0, weak=True)
CPU times: user 1.01 s, sys: 0.00 s, total: 1.01 s
Wall time: 1.01 s
False
```
The only way to be faster is to use cython, as for the is_strongly_connected function. But I'm not sure it is worth the effort.



---

archive/issue_comments_155869.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nNice work!\n\n1)\n\n```\n4034\t        if not u in self.vertices(): \n```\nshould be:\n\n```\n4034\t        if u not in self:\n```\n\n2) Any reason you're using self._directed instead of self.is_directed() \\\\\n3) \n\n```\nwhile len(queue) > 0: \n```\nshould be:\n\n```\nwhile queue:\n```\n4) There is a potential performance optimization. Currently you first perform the full dfs and then check if all neighbors of v have been seen. You could instead mark the neighbors as seen once you saw them and abort the dfs once you saw all of them. \\\\\ni.e. store them in a set and call discard on the set whenever you add a vertex to 'seen'. Then abort the dfs when the set is empty.",
    "created_at": "2012-07-30T11:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155869",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:15" align="right">Comment 15</div>

Nice work!

1)

```
4034	        if not u in self.vertices(): 
```
should be:

```
4034	        if u not in self:
```

2) Any reason you're using self._directed instead of self.is_directed() \\
3) 

```
while len(queue) > 0: 
```
should be:

```
while queue:
```
4) There is a potential performance optimization. Currently you first perform the full dfs and then check if all neighbors of v have been seen. You could instead mark the neighbors as seen once you saw them and abort the dfs once you saw all of them. \\
i.e. store them in a set and call discard on the set whenever you add a vertex to 'seen'. Then abort the dfs when the set is empty.



---

archive/issue_comments_155870.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nYou are right for 1 and 3. It's not obvious for me to write such stuff.\n\n2: it's just that both are working. I changed to is_directed() which is cleaner.\n\n4: I did it. So far I have not seen any difference but it could be interesting for some graphs, and it is strongly dependent on the dfs ordering.\n\nI have also changed seen from set to dict. It could be faster to access a cell of a dictionary than to test is a elt is in a set. Furthermore, I avoid testing w!=u by initializing seen[u] to True, so it will never be considered.\n\nThanks for the comments.",
    "created_at": "2012-07-30T12:29:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155870",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:16" align="right">Comment 16</div>

You are right for 1 and 3. It's not obvious for me to write such stuff.

2: it's just that both are working. I changed to is_directed() which is cleaner.

4: I did it. So far I have not seen any difference but it could be interesting for some graphs, and it is strongly dependent on the dfs ordering.

I have also changed seen from set to dict. It could be faster to access a cell of a dictionary than to test is a elt is in a set. Furthermore, I avoid testing w!=u by initializing seen[u] to True, so it will never be considered.

Thanks for the comments.



---

archive/issue_comments_155871.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nI changed the position of the targets.discard(w) to discard when it enters the queue and not when it is removed. That's better.",
    "created_at": "2012-07-30T12:46:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155871",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:17" align="right">Comment 17</div>

I changed the position of the targets.discard(w) to discard when it enters the queue and not when it is removed. That's better.



---

archive/issue_comments_155872.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@dcoudert](#comment%3A16):\n> I have also changed seen from set to dict. It could be faster to access a cell of a >dictionary than to test is a elt is in a set.\n\nIIRC they are both implemented as hash maps, which should make the set faster. I think it has something to do with the fact that the \"v in s\" has to catch the KeyError and return False instead of just raising the exception. That's exactly what happens with your dict here. It doesn't catch KeyError, but that's fine because it never occurs. Making it faster.\n\nIn contrast, if you let it catch the exception aka \"seen.get(w, False)\", the dict is a lot slower.\n\n\n>Furthermore, I avoid testing w!=u by initializing seen[u] to True, so it will never be considered.\n>\n\nGood idea.\n\nOnce I checked the manual and ptestlong, I'll give it a positive review.",
    "created_at": "2012-07-30T13:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155872",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@dcoudert](#comment%3A16):
> I have also changed seen from set to dict. It could be faster to access a cell of a >dictionary than to test is a elt is in a set.

IIRC they are both implemented as hash maps, which should make the set faster. I think it has something to do with the fact that the "v in s" has to catch the KeyError and return False instead of just raising the exception. That's exactly what happens with your dict here. It doesn't catch KeyError, but that's fine because it never occurs. Making it faster.

In contrast, if you let it catch the exception aka "seen.get(w, False)", the dict is a lot slower.


>Furthermore, I avoid testing w!=u by initializing seen[u] to True, so it will never be considered.
>

Good idea.

Once I checked the manual and ptestlong, I'll give it a positive review.



---

archive/issue_comments_155873.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI found a bug in the directed case. \n\n```\nsage: D = DiGraph()\nsage: D.add_edges(((1,2),(2,1),(2,5),(3,4),(4,3),(4,5),(5,6),(6,5),(5,7),(7,5),(6,7),(7,6)))\nsage: D.is_cut_vertex(5) # Should be False\nTrue\nsage: D.strongly_connected_components()\n[[1, 2], [3, 4], [5, 6, 7]]\nsage: D.delete_vertex(5)\nsage: D.strongly_connected_components()  # The number of components did not increase.\n[[1, 2], [3, 4], [6, 7]]\n```\n\nEdit: Possible solution: Check only those neighbors which are in the same strong component as v.",
    "created_at": "2012-07-30T16:43:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155873",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:19" align="right">Comment 19</div>

I found a bug in the directed case. 

```
sage: D = DiGraph()
sage: D.add_edges(((1,2),(2,1),(2,5),(3,4),(4,3),(4,5),(5,6),(6,5),(5,7),(7,5),(6,7),(7,6)))
sage: D.is_cut_vertex(5) # Should be False
True
sage: D.strongly_connected_components()
[[1, 2], [3, 4], [5, 6, 7]]
sage: D.delete_vertex(5)
sage: D.strongly_connected_components()  # The number of components did not increase.
[[1, 2], [3, 4], [6, 7]]
```

Edit: Possible solution: Check only those neighbors which are in the same strong component as v.



---

archive/issue_comments_155874.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nOuppss. This is solved in this new version. I'm using a set of vertices to restrict the DFS to the vertices in the connected or strongly connected component containing u.\n\nI have also restored the `seen = set([start, u])` instead of a dict since only a subset of the vertices are now considered. In fact I don't know if it has a real impact on the performances, but it reduces initialization cost per loop.\n\nI hope everything is in order now ;-)\n\nDon't forget to put your name as reviewer.",
    "created_at": "2012-07-30T17:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155874",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:20" align="right">Comment 20</div>

Ouppss. This is solved in this new version. I'm using a set of vertices to restrict the DFS to the vertices in the connected or strongly connected component containing u.

I have also restored the `seen = set([start, u])` instead of a dict since only a subset of the vertices are now considered. In fact I don't know if it has a real impact on the performances, but it reduces initialization cost per loop.

I hope everything is in order now ;-)

Don't forget to put your name as reviewer.



---

archive/issue_comments_155875.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@dcoudert](#comment%3A20):\n> Ouppss. This is solved in this new version. I'm using a set of vertices to restrict the DFS to the vertices in the connected or strongly connected component containing u.\n> \n\nIs this really necessary for the undirected case? Aren't all neighbors of v in the same connected component as v?",
    "created_at": "2012-07-30T18:01:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155875",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@dcoudert](#comment%3A20):
> Ouppss. This is solved in this new version. I'm using a set of vertices to restrict the DFS to the vertices in the connected or strongly connected component containing u.
> 

Is this really necessary for the undirected case? Aren't all neighbors of v in the same connected component as v?



---

archive/issue_comments_155876.json:
```json
{
    "body": "Reviewer: **Sebastian Luther**",
    "created_at": "2012-07-30T18:01:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155876",
    "user": "https://github.com/sagetrac-sluther"
}
```

Reviewer: **Sebastian Luther**



---

archive/issue_comments_155877.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nYes, all neighbors of v are in the same connected component. I have replaced the code with `CC = [self.vertex_iterator()]`.\n\nI did several tests to see if it would be faster to duplicate the code to avoid the test `w in CC` but then we need to add the test `w != u` which takes some time as well (although very little) and overall the difference is very small. So I have finally decided not to duplicate the code.",
    "created_at": "2012-07-30T22:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155877",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:23" align="right">Comment 23</div>

Yes, all neighbors of v are in the same connected component. I have replaced the code with `CC = [self.vertex_iterator()]`.

I did several tests to see if it would be faster to duplicate the code to avoid the test `w in CC` but then we need to add the test `w != u` which takes some time as well (although very little) and overall the difference is very small. So I have finally decided not to duplicate the code.



---

archive/issue_events_169775.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-01T05:54:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169775"
}
```



---

archive/issue_events_169776.json:
```json
{
    "actor": "https://github.com/sagetrac-sluther",
    "created_at": "2012-08-01T05:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169776"
}
```



---

archive/issue_comments_155878.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nTests pass, documentation looks good. Positiv review!",
    "created_at": "2012-08-01T05:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155878",
    "user": "https://github.com/sagetrac-sluther"
}
```

<div id="comment:24" align="right">Comment 24</div>

Tests pass, documentation looks good. Positiv review!



---

archive/issue_comments_155879.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nThanks for the review and all the comments. The patch is much better now.",
    "created_at": "2012-08-01T06:56:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155879",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:25" align="right">Comment 25</div>

Thanks for the review and all the comments. The patch is much better now.



---

archive/issue_events_169777.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-13T06:35:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169777"
}
```



---

archive/issue_events_169778.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-13T06:35:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169778"
}
```



---

archive/issue_comments_155880.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nThis needs to be rebased to sage-5.3.beta1.",
    "created_at": "2012-08-13T06:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155880",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">Comment 26</div>

This needs to be rebased to sage-5.3.beta1.



---

archive/issue_comments_155881.json:
```json
{
    "body": "Attachment: **[trac_13289_is_cut_vertex.patch.gz](https://github.com/sagemath/sage/files/ticket13289/trac_13289_is_cut_vertex.patch.gz)**\n\nrebased for sage-5.3.beta1",
    "created_at": "2012-08-13T14:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155881",
    "user": "https://github.com/dcoudert"
}
```

Attachment: **[trac_13289_is_cut_vertex.patch.gz](https://github.com/sagemath/sage/files/ticket13289/trac_13289_is_cut_vertex.patch.gz)**

rebased for sage-5.3.beta1



---

archive/issue_events_169779.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-08-13T14:33:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169779"
}
```



---

archive/issue_events_169780.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2012-08-13T14:33:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169780"
}
```



---

archive/issue_comments_155882.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nHello,\n\nI have rebased the patch to sage-5.3.beta1, so it should be easily reviewed.\n\nBest,",
    "created_at": "2012-08-13T14:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155882",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:27" align="right">Comment 27</div>

Hello,

I have rebased the patch to sage-5.3.beta1, so it should be easily reviewed.

Best,



---

archive/issue_comments_155883.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nFor a trivial rebase, you can change the status yourself to `positive_review`.",
    "created_at": "2012-09-26T07:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155883",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">Comment 28</div>

For a trivial rebase, you can change the status yourself to `positive_review`.



---

archive/issue_events_169781.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-26T07:35:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169781"
}
```



---

archive/issue_events_169782.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-26T07:35:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169782"
}
```



---

archive/issue_comments_155884.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nI didn't know that.\nThank you.",
    "created_at": "2012-09-26T08:20:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155884",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:29" align="right">Comment 29</div>

I didn't know that.
Thank you.



---

archive/issue_comments_155885.json:
```json
{
    "body": "Merged: **sage-5.4.rc0**",
    "created_at": "2012-09-28T07:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13289#issuecomment-155885",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.4.rc0**



---

archive/issue_events_169783.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T07:47:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169783"
}
```



---

archive/issue_events_169784.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T07:47:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13289",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13289#event-169784"
}
```
