# Issue 13698: Access to graph routines of the GLPK

archive/issues_013494.json:
```json
{
    "body": "Certain types of linear problems can be more efficiently solved with algorithms more specialized than the simplex algorithm. An example of such problems is a mincost problem. The GLPK provides a set of graph / network algorithms which currently have got not interface to Sage.\n\nThis patch implements a new backend intended to provide access to the GLPK graph / network routines. The initial implementation should provide an interface to\n\n* glp_mincost_okalg - Solving mincost problems with the out-of-kilter algorithm\n* glp_maxflow_ffalg - Solving maxflow problems with the Ford-Fulkerson algorithm\n* glp_cpp - Solving critical path problems\n\nIn addition it provides support for reading and writing problem data to files\n\nApply :\n* [attachment:trac_13698_glpk_graph_routv2.patch]\n* [attachment:trac_13698-rev.patch]\n* [attachment:trac_13698-rev2.patch]\n* [attachment:trac_13698-rev3.patch]\n* [attachment:trac_13698-rev4.patch]\n\nAssignee: jason, jkantor\n\nCC:  @nathanncohen @dcoudert\n\nKeywords: out-of-kilter, minflow, maxflow, critical path, GLPK\n\nReviewer: Nathann Cohen\n\nAuthor: Christian Kuper\n\nMerged: sage-5.10.beta0\n\nDependencies: #12415\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13698\n\n",
    "closed_at": "2013-04-13T13:49:11Z",
    "created_at": "2012-11-10T20:08:47Z",
    "labels": [
        "component: numerical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Access to graph routines of the GLPK",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13698",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```
Certain types of linear problems can be more efficiently solved with algorithms more specialized than the simplex algorithm. An example of such problems is a mincost problem. The GLPK provides a set of graph / network algorithms which currently have got not interface to Sage.

This patch implements a new backend intended to provide access to the GLPK graph / network routines. The initial implementation should provide an interface to

* glp_mincost_okalg - Solving mincost problems with the out-of-kilter algorithm
* glp_maxflow_ffalg - Solving maxflow problems with the Ford-Fulkerson algorithm
* glp_cpp - Solving critical path problems

In addition it provides support for reading and writing problem data to files

Apply :
* [attachment:trac_13698_glpk_graph_routv2.patch]
* [attachment:trac_13698-rev.patch]
* [attachment:trac_13698-rev2.patch]
* [attachment:trac_13698-rev3.patch]
* [attachment:trac_13698-rev4.patch]

Assignee: jason, jkantor

CC:  @nathanncohen @dcoudert

Keywords: out-of-kilter, minflow, maxflow, critical path, GLPK

Reviewer: Nathann Cohen

Author: Christian Kuper

Merged: sage-5.10.beta0

Dependencies: #12415

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13698





---

archive/issue_comments_212493.json:
```json
{
    "body": "Access to out-of-kilter and other glpk graph algos",
    "created_at": "2012-11-23T21:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212493",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Access to out-of-kilter and other glpk graph algos



---

archive/issue_comments_212494.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [trac_13698_glpk_graph_rout.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698_glpk_graph_rout.patch) by christiankuper created at 2012-11-23 21:01:41",
    "created_at": "2012-11-23T21:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212494",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:1'></a>
Attachment [trac_13698_glpk_graph_rout.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698_glpk_graph_rout.patch) by christiankuper created at 2012-11-23 21:01:41



---

archive/issue_comments_212495.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-11-23T21:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212495",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_212496.json:
```json
{
    "body": "<a id='comment:2'></a>\nStill waiting for a review\n\nChristian",
    "created_at": "2012-12-16T15:55:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212496",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:2'></a>
Still waiting for a review

Christian



---

archive/issue_comments_212497.json:
```json
{
    "body": "<a id='comment:3'></a>\nHellooooooooo Christian !!!\n\nYour patch is still waiting for a review, but such large patches eat my week-ends. And I also have #13808 too deal with `T_T`\nI uploaded a patch which does some (uninteresting) changes to your patch. I also have a list of comments. I can see that you put a lot of work in this patch, but you add a big amount of things in Sage so it is bound to take some time again `^^;`\n\n* `create_graph method` : why is this a method, and not just part of the __init__ function ? If I do the following, it looks like memory keeps being allocated and is never freed !\n  {{{\n  gbe = GLPKGraphBackend()\n  gbe.create_graph()\n  gbe.create_graph()\n  gbe.create_graph()\n  ...\n  }}}\n\n* Can't all occurrences of `if self.graph is NULL:` be removed from the file ? self.graph() can never be null !\n* self.graph() can be null if something went wrong with the memory allocation. An exception should be raised if that happens.\n* I had never seen this `property` Python thing but it feels weird to have two ways to set/get this graph_name parameter. Could you chose between one of those ? (same for other properties defined in the module)\n* Note from personal experience : I regret to have exposed \"name\" functions in the LP interface. It has always been a mess to maintain, it takes a loooooooooot of code just to deal with it, and I really do not see the point. It's up to you in this case but in you stead I would not expose anything related to names `^^;`\n* It looks like you need to free memory in methods like `del_vertices` when you allocate it, for instance your `num` variable.\n* Considering that the Graph methods in Sage are `Graph.add_vertices` and `Graph.delete_vertices`, could you copy the same names in your interface ? Or do you think that it is a bad idea ? (same with edges)\n* `arc_exists` is `has_edge` in Sage. Or `has_arc` if you prefer.\n* I had not seen this `delete_graph` method when I made my first comment. But here again, I feel that this should not be a meethod, and be a part of `__destruct__` instead `:-)`\n* `read_graph` : in Sage's way of doing things, this should be part of the constructor. Something like \"you can build an empty graph, or build it from a file`\n* It would be nice to have an index of methods at the top of the module's documentation, as we have at the top of the following page : http://www.sagemath.org/doc/reference/sage/graphs/graph.html. It takes some time to do it, and it is hell to do unless you know how to use emacs/vim macros.. If you feel like doing it, I will do it myself when this patch will be almost done.\n* It would be nice to say what ccdata is supposed to be, somewhere.\n* It would make sense to update GenericGraph.flow() so that it can use GLPK as a solver. Actually, the best would be to have in your new module a function converting a Sage graph to a GLPK graph, so that the code in GenericGraph would stay short. This way we could also begin to compare performances.\n\nHave a nice sunday eveniiiiiiiiiiiiiing ! `:-P`\n\nNathann",
    "created_at": "2012-12-16T16:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212497",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>
Hellooooooooo Christian !!!

Your patch is still waiting for a review, but such large patches eat my week-ends. And I also have #13808 too deal with `T_T`
I uploaded a patch which does some (uninteresting) changes to your patch. I also have a list of comments. I can see that you put a lot of work in this patch, but you add a big amount of things in Sage so it is bound to take some time again `^^;`

* `create_graph method` : why is this a method, and not just part of the __init__ function ? If I do the following, it looks like memory keeps being allocated and is never freed !
  {{{
  gbe = GLPKGraphBackend()
  gbe.create_graph()
  gbe.create_graph()
  gbe.create_graph()
  ...
  }}}

* Can't all occurrences of `if self.graph is NULL:` be removed from the file ? self.graph() can never be null !
* self.graph() can be null if something went wrong with the memory allocation. An exception should be raised if that happens.
* I had never seen this `property` Python thing but it feels weird to have two ways to set/get this graph_name parameter. Could you chose between one of those ? (same for other properties defined in the module)
* Note from personal experience : I regret to have exposed "name" functions in the LP interface. It has always been a mess to maintain, it takes a loooooooooot of code just to deal with it, and I really do not see the point. It's up to you in this case but in you stead I would not expose anything related to names `^^;`
* It looks like you need to free memory in methods like `del_vertices` when you allocate it, for instance your `num` variable.
* Considering that the Graph methods in Sage are `Graph.add_vertices` and `Graph.delete_vertices`, could you copy the same names in your interface ? Or do you think that it is a bad idea ? (same with edges)
* `arc_exists` is `has_edge` in Sage. Or `has_arc` if you prefer.
* I had not seen this `delete_graph` method when I made my first comment. But here again, I feel that this should not be a meethod, and be a part of `__destruct__` instead `:-)`
* `read_graph` : in Sage's way of doing things, this should be part of the constructor. Something like "you can build an empty graph, or build it from a file`
* It would be nice to have an index of methods at the top of the module's documentation, as we have at the top of the following page : http://www.sagemath.org/doc/reference/sage/graphs/graph.html. It takes some time to do it, and it is hell to do unless you know how to use emacs/vim macros.. If you feel like doing it, I will do it myself when this patch will be almost done.
* It would be nice to say what ccdata is supposed to be, somewhere.
* It would make sense to update GenericGraph.flow() so that it can use GLPK as a solver. Actually, the best would be to have in your new module a function converting a Sage graph to a GLPK graph, so that the code in GenericGraph would stay short. This way we could also begin to compare performances.

Have a nice sunday eveniiiiiiiiiiiiiing ! `:-P`

Nathann



---

archive/issue_comments_212498.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-12-16T16:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212498",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212499.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [ncohen](#comment%3A3):\n\nHello Nathann,\n\nsorry, I did not mean to push you for a review (I know the patch is big) but thanks a million for your fast and very constructive comments. You really gave me something to chew on ;-), but this is fun.\n\nThanks again!!!\n\nChristian",
    "created_at": "2012-12-16T16:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212499",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:4'></a>
Replying to [ncohen](#comment%3A3):

Hello Nathann,

sorry, I did not mean to push you for a review (I know the patch is big) but thanks a million for your fast and very constructive comments. You really gave me something to chew on ;-), but this is fun.

Thanks again!!!

Christian



---

archive/issue_comments_212500.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [ncohen](#comment%3A3):\n\nHi Nathann,\n\nfinally I find the time start working on your comments, maybe I can bother you with a few questions again ;-)\n\n\n> \n> * `create_graph method` : why is this a method, and not just part of the __init__ function ? If I do the following, it looks like memory keeps being allocated and is never freed !\n\n\nAbsolutly correct, changed that!\n\n> \n> * Can't all occurrences of `if self.graph is NULL:` be removed from the file ? self.graph() can never be null !\n> * self.graph() can be null if something went wrong with the memory allocation. An exception should be raised if that happens.\n\n\nGot it again, residues from prior version :$  Killed them all and added a memory check with the appropriate exception.\n> * I had never seen this `property` Python thing but it feels weird to have two ways to set/get this graph_name parameter. Could you chose between one of those ? (same for other properties defined in the module)\n \nOk, you might be right here.\n> * Note from personal experience : I regret to have exposed \"name\" functions in the LP interface. It has always been a mess to maintain, it takes a loooooooooot of code just to deal with it, and I really do not see the point. It's up to you in this case but in you stead I would not expose anything related to names `^^;`\n \nYou might be right that this feature makes no sense but I do not fully grap what the problems you mention could be. Can you give me a hint here?\n> * It looks like you need to free memory in methods like `del_vertices` when you allocate it, for instance your `num` variable.\n \nYup! Learned something again and will pay attention to mallocs in the future, I promise ;-)\n> * Considering that the Graph methods in Sage are `Graph.add_vertices` and `Graph.delete_vertices`, could you copy the same names in your interface ? Or do you think that it is a bad idea ? (same with edges)\n \nHmm, do you mean the same names only or the full interface (names and arguments and output)? Although it would require a bit of work it might be sensible to go for the second alternative: A standard (same job = same function call) within a software like Sage would make sense. What do you think?\n> * `arc_exists` is `has_edge` in Sage. Or `has_arc` if you prefer.\n \ndito\n> * I had not seen this `delete_graph` method when I made my first comment. But here again, I feel that this should not be a meethod, and be a part of `__destruct__` instead `:-)`\n \nRight, see above.\n> * `read_graph` : in Sage's way of doing things, this should be part of the constructor. Something like \"you can build an empty graph, or build it from a file`\n \nRight, see above\n> * It would be nice to have an index of methods at the top of the module's documentation, as we have at the top of the following page : http://www.sagemath.org/doc/reference/sage/graphs/graph.html. It takes some time to do it, and it is hell to do unless you know how to use emacs/vim macros.. If you feel like doing it, I will do it myself when this patch will be almost done.\n \nYes, you are right, but as you say, when the patch is almost done ;-\n> * It would be nice to say what ccdata is supposed to be, somewhere.\n \nAh, yes indeed ;-=\n> * It would make sense to update GenericGraph.flow() so that it can use GLPK as a solver. Actually, the best would be to have in your new module a function converting a Sage graph to a GLPK graph, so that the code in GenericGraph would stay short. This way we could also begin to compare performances.\n \nThat's a cool idea, let's see what I can do ;-)\n\nThanks again for your support!!!!\n\nChristian",
    "created_at": "2012-12-21T20:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212500",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:5'></a>
Replying to [ncohen](#comment%3A3):

Hi Nathann,

finally I find the time start working on your comments, maybe I can bother you with a few questions again ;-)


> 
> * `create_graph method` : why is this a method, and not just part of the __init__ function ? If I do the following, it looks like memory keeps being allocated and is never freed !


Absolutly correct, changed that!

> 
> * Can't all occurrences of `if self.graph is NULL:` be removed from the file ? self.graph() can never be null !
> * self.graph() can be null if something went wrong with the memory allocation. An exception should be raised if that happens.


Got it again, residues from prior version :$  Killed them all and added a memory check with the appropriate exception.
> * I had never seen this `property` Python thing but it feels weird to have two ways to set/get this graph_name parameter. Could you chose between one of those ? (same for other properties defined in the module)
 
Ok, you might be right here.
> * Note from personal experience : I regret to have exposed "name" functions in the LP interface. It has always been a mess to maintain, it takes a loooooooooot of code just to deal with it, and I really do not see the point. It's up to you in this case but in you stead I would not expose anything related to names `^^;`
 
You might be right that this feature makes no sense but I do not fully grap what the problems you mention could be. Can you give me a hint here?
> * It looks like you need to free memory in methods like `del_vertices` when you allocate it, for instance your `num` variable.
 
Yup! Learned something again and will pay attention to mallocs in the future, I promise ;-)
> * Considering that the Graph methods in Sage are `Graph.add_vertices` and `Graph.delete_vertices`, could you copy the same names in your interface ? Or do you think that it is a bad idea ? (same with edges)
 
Hmm, do you mean the same names only or the full interface (names and arguments and output)? Although it would require a bit of work it might be sensible to go for the second alternative: A standard (same job = same function call) within a software like Sage would make sense. What do you think?
> * `arc_exists` is `has_edge` in Sage. Or `has_arc` if you prefer.
 
dito
> * I had not seen this `delete_graph` method when I made my first comment. But here again, I feel that this should not be a meethod, and be a part of `__destruct__` instead `:-)`
 
Right, see above.
> * `read_graph` : in Sage's way of doing things, this should be part of the constructor. Something like "you can build an empty graph, or build it from a file`
 
Right, see above
> * It would be nice to have an index of methods at the top of the module's documentation, as we have at the top of the following page : http://www.sagemath.org/doc/reference/sage/graphs/graph.html. It takes some time to do it, and it is hell to do unless you know how to use emacs/vim macros.. If you feel like doing it, I will do it myself when this patch will be almost done.
 
Yes, you are right, but as you say, when the patch is almost done ;-
> * It would be nice to say what ccdata is supposed to be, somewhere.
 
Ah, yes indeed ;-=
> * It would make sense to update GenericGraph.flow() so that it can use GLPK as a solver. Actually, the best would be to have in your new module a function converting a Sage graph to a GLPK graph, so that the code in GenericGraph would stay short. This way we could also begin to compare performances.
 
That's a cool idea, let's see what I can do ;-)

Thanks again for your support!!!!

Christian



---

archive/issue_comments_212501.json:
```json
{
    "body": "<a id='comment:6'></a>\nHelloooooooooo !!\n\n> > * Note from personal experience : I regret to have exposed \"name\" functions in the LP interface. It has always been a mess to maintain, it takes a loooooooooot of code just to deal with it, and I really do not see the point. It's up to you in this case but in you stead I would not expose anything related to names `^^;`\n \n> You might be right that this feature makes no sense but I do not fully grap what the problems you mention could be. Can you give me a hint here?\n\nOh. Well, actually nothing serious. I just exposed the \"names\" methods from the LP solvers, and it turned out later that they behaved quite differently (some things were named in a solver that were no named in others), some had maximum lengths, sometimes created segfaults... And in the end, all this for nothing, as it would have been smarter to implement the names directly in Sage itself (if at all) and note use those defined inside of the solvers.\nAnyway, I still don't see the points of these names `:-P`\n\nHave fuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuun ! `:-)`\n\nNathann",
    "created_at": "2012-12-23T13:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212501",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>
Helloooooooooo !!

> > * Note from personal experience : I regret to have exposed "name" functions in the LP interface. It has always been a mess to maintain, it takes a loooooooooot of code just to deal with it, and I really do not see the point. It's up to you in this case but in you stead I would not expose anything related to names `^^;`
 
> You might be right that this feature makes no sense but I do not fully grap what the problems you mention could be. Can you give me a hint here?

Oh. Well, actually nothing serious. I just exposed the "names" methods from the LP solvers, and it turned out later that they behaved quite differently (some things were named in a solver that were no named in others), some had maximum lengths, sometimes created segfaults... And in the end, all this for nothing, as it would have been smarter to implement the names directly in Sage itself (if at all) and note use those defined inside of the solvers.
Anyway, I still don't see the points of these names `:-P`

Have fuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuun ! `:-)`

Nathann



---

archive/issue_comments_212502.json:
```json
{
    "body": "<a id='comment:7'></a>\nJust a small update to assure I am still working on this patch: When implementing the suggested changes I found a way to create a segfault - want to remove this bug before uploading a new version.",
    "created_at": "2012-12-27T15:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212502",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:7'></a>
Just a small update to assure I am still working on this patch: When implementing the suggested changes I found a way to create a segfault - want to remove this bug before uploading a new version.



---

archive/issue_comments_212503.json:
```json
{
    "body": "<a id='comment:8'></a>\nHello,\n\nI reworked the patch considerably based on Nathann's comments above. The major changes:\n* Assured syncronization of created extension types and the glpk_graph\n* Removed potential memory leaks\n* Renamed methods to align with existing Sage Graph method names, and\n* added some methods to align with existing Sage Graph\n* Removed exposure of \"name\" property of glpk graph\n* Moved reading files to constructor\n* Added __repr__ to extension types\n* Added import method for Sage Graphs\n\nLooking forward for feedback\n\nChristian",
    "created_at": "2013-01-05T20:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212503",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:8'></a>
Hello,

I reworked the patch considerably based on Nathann's comments above. The major changes:
* Assured syncronization of created extension types and the glpk_graph
* Removed potential memory leaks
* Renamed methods to align with existing Sage Graph method names, and
* added some methods to align with existing Sage Graph
* Removed exposure of "name" property of glpk graph
* Moved reading files to constructor
* Added __repr__ to extension types
* Added import method for Sage Graphs

Looking forward for feedback

Christian



---

archive/issue_comments_212504.json:
```json
{
    "body": "<a id='comment:9'></a>\nApply trac_13698_glpk_graph_routv2.patch",
    "created_at": "2013-01-09T09:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212504",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>
Apply trac_13698_glpk_graph_routv2.patch



---

archive/issue_comments_212505.json:
```json
{
    "body": "<a id='comment:10'></a>\nAdded index and removed some errors in the doc.",
    "created_at": "2013-01-10T11:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212505",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:10'></a>
Added index and removed some errors in the doc.



---

archive/issue_comments_212506.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-01-10T11:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212506",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212507.json:
```json
{
    "body": "<a id='comment:11'></a>\nHmmmmm.... I'm sorry to say this but I read this patch 3 times, on three different days (with long intervals in between), and each time it made me very angry.. There's something like 1500 lines of code in there whose role is to do :\n\n```\nget_something()\n    return self.backend.something\nset_something(x)\n    self.backend.something = x\n```\neach time checking that the backend exists, and with doctests.. Honestly, we have to find a way around this. 1500 lines of code.Including doctests, of course. 1500 lines.\n\nI'll walk a bit and go eat something to change my mind, then think about it again. \n\nNathann",
    "created_at": "2013-01-19T14:25:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212507",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:11'></a>
Hmmmmm.... I'm sorry to say this but I read this patch 3 times, on three different days (with long intervals in between), and each time it made me very angry.. There's something like 1500 lines of code in there whose role is to do :

```
get_something()
    return self.backend.something
set_something(x)
    self.backend.something = x
```
each time checking that the backend exists, and with doctests.. Honestly, we have to find a way around this. 1500 lines of code.Including doctests, of course. 1500 lines.

I'll walk a bit and go eat something to change my mind, then think about it again. 

Nathann



---

archive/issue_comments_212508.json:
```json
{
    "body": "<a id='comment:12'></a>\nThinking of `__get__` and `__set__` right now...\n\nI also wrote to Cython's google group.\n\nhttps://groups.google.com/d/topic/cython-users/b8Il3DLGhoI/discussion\n\nNathann",
    "created_at": "2013-01-19T14:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212508",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>
Thinking of `__get__` and `__set__` right now...

I also wrote to Cython's google group.

https://groups.google.com/d/topic/cython-users/b8Il3DLGhoI/discussion

Nathann



---

archive/issue_comments_212509.json:
```json
{
    "body": "<a id='comment:13'></a>\nHello Nathann,\n\nfirst of all: Thanks for the time you invest in helping me on this! Sorry for making you angry, not my intention - I just did the best I could. But I know how to take your well meant beatings by now ;-)\n\nIf I understand you correctly: You are basically saying that I need to find a way around the GLPKArc and GLPKVertex classes. Is that correct?\n\nChristian",
    "created_at": "2013-01-19T17:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212509",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:13'></a>
Hello Nathann,

first of all: Thanks for the time you invest in helping me on this! Sorry for making you angry, not my intention - I just did the best I could. But I know how to take your well meant beatings by now ;-)

If I understand you correctly: You are basically saying that I need to find a way around the GLPKArc and GLPKVertex classes. Is that correct?

Christian



---

archive/issue_comments_212510.json:
```json
{
    "body": "<a id='comment:14'></a>\nHelloooooooo Christian !\n\nWell, I'm angry because I cannot think of a good way around, that's why... If I had one in mind that would have just been a good remark for the review, but I don't know how to do it either, and all the things I have in mind are surrounded by big fat \"Bad work\" signs `:-P`\n\nI hope that we wil find a way around, or that the Cython guys have something in mind. But indeed, it's more or less about removing those two classes, which are just C structures exposed in Cython.\n\nI would be even angrier if there was no way around. But of course that was a couple of hours ago. I had a burger and a pint off cider since, and this make a very big difference `:-D`\n\nHave fuuuuuuuuuuuuuuuuuuuuuuuun !\n\nNathann",
    "created_at": "2013-01-19T17:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212510",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>
Helloooooooo Christian !

Well, I'm angry because I cannot think of a good way around, that's why... If I had one in mind that would have just been a good remark for the review, but I don't know how to do it either, and all the things I have in mind are surrounded by big fat "Bad work" signs `:-P`

I hope that we wil find a way around, or that the Cython guys have something in mind. But indeed, it's more or less about removing those two classes, which are just C structures exposed in Cython.

I would be even angrier if there was no way around. But of course that was a couple of hours ago. I had a burger and a pint off cider since, and this make a very big difference `:-D`

Have fuuuuuuuuuuuuuuuuuuuuuuuun !

Nathann



---

archive/issue_comments_212511.json:
```json
{
    "body": "<a id='comment:15'></a>\nHello Nathann,\n\nI am just bending my mind around this issue. There is one idea I have currently. My line of thinking: Basically the main purpose of this patch is using graph algos in GLPK. What do you think of the following approach: Leaving all the basic graph definitions to the Sage Graph classes. When a solving routines is called: Create the GLPKGraph on the fly from the Sage Graph, solve via GLPK and feed the solution into a solution dict. What do you think?\n\nChristian",
    "created_at": "2013-01-19T18:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212511",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:15'></a>
Hello Nathann,

I am just bending my mind around this issue. There is one idea I have currently. My line of thinking: Basically the main purpose of this patch is using graph algos in GLPK. What do you think of the following approach: Leaving all the basic graph definitions to the Sage Graph classes. When a solving routines is called: Create the GLPKGraph on the fly from the Sage Graph, solve via GLPK and feed the solution into a solution dict. What do you think?

Christian



---

archive/issue_comments_212512.json:
```json
{
    "body": "<a id='comment:16'></a>\nWell, to be honest I did not really know what you had in mind with this patch... If you only want to be able to call GLPK algorithms on some graphs, indeed this patch is going too far. But well, let's first wait for an answer from the Cython guys. Perhaps we can have both for free `;-)`\n\nNathann",
    "created_at": "2013-01-19T18:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212512",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>
Well, to be honest I did not really know what you had in mind with this patch... If you only want to be able to call GLPK algorithms on some graphs, indeed this patch is going too far. But well, let's first wait for an answer from the Cython guys. Perhaps we can have both for free `;-)`

Nathann



---

archive/issue_comments_212513.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-01-22T07:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212513",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212514.json:
```json
{
    "body": "<a id='comment:18'></a>\nFollowing Nathann's comment I removed the two classes GLPKArc and GLPKVertex and replaced the access using dicts. Doing this I tried to stick as close as possible to the exitsitng definitions in GenericGraph for consistency.\n\nEager to know whether this approach \"feels better\". ;-)\n\nChristian",
    "created_at": "2013-02-10T16:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212514",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:18'></a>
Following Nathann's comment I removed the two classes GLPKArc and GLPKVertex and replaced the access using dicts. Doing this I tried to stick as close as possible to the exitsitng definitions in GenericGraph for consistency.

Eager to know whether this approach "feels better". ;-)

Christian



---

archive/issue_comments_212515.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-10T16:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212515",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212516.json:
```json
{
    "body": "<a id='comment:20'></a>\nTwo quick things :\n* Why do you keep a pointer toward Sage's graph ``self.sage_graph`` ? There are several problem with this design : the graph may be modified by the user, while you keep a pointer toward a graph that gets modified. Secondly, as it seems you only need it for two methods, you might as well give the graph as a parameter to those two methods, and get rid of the parameter.\n*  Don't do this :\n    {{{\n    sage: from sage.numerical.backends.glpk_graph_backend \\ \nimport GLPKGraphBackend\n}}}\n    If you *need* to split lines, do it this way :\n    {{{\n    sage: from sage.numerical.backends.glpk_graph_backend \\ \n...      import GLPKGraphBackend\n}}}\n\n    But you really shouldn't split lines so often. It' meant to make code easier to read (a least I believe it is), but sometimes it really doesn't help. As they appear really often, I think that you should let this line stay even if it is very long. Besides, you very often don't need to add a terinal `\\`. For instance, this :\n\n        {{{\n \t830\t                return (u, v, {\"low\":(<c_a_data *>a.data).low, \\ \n \t831\t                               \"cap\":(<c_a_data *>a.data).cap, \\ \n \t832\t                               \"cost\":(<c_a_data *>a.data).cost, \\ \n \t833\t                               \"x\":(<c_a_data *>a.data).x}) \n}}}\n\n    Can be replaced by \n\n        {{{\n \t830\t                return (u, v, {\"low\":(<c_a_data *>a.data).low, \n \t831\t                               \"cap\":(<c_a_data *>a.data).cap, \n \t832\t                               \"cost\":(<c_a_data *>a.data).cost, \n \t833\t                               \"x\":(<c_a_data *>a.data).x}) \n}}}\n    It works, because Python knows the line is not finished : some parenthesis are still open at this step, and it's waiting for `}` and `)`.\n\nNathann",
    "created_at": "2013-02-10T19:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212516",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:20'></a>
Two quick things :
* Why do you keep a pointer toward Sage's graph ``self.sage_graph`` ? There are several problem with this design : the graph may be modified by the user, while you keep a pointer toward a graph that gets modified. Secondly, as it seems you only need it for two methods, you might as well give the graph as a parameter to those two methods, and get rid of the parameter.
*  Don't do this :
    {{{
    sage: from sage.numerical.backends.glpk_graph_backend \ 
import GLPKGraphBackend
}}}
    If you *need* to split lines, do it this way :
    {{{
    sage: from sage.numerical.backends.glpk_graph_backend \ 
...      import GLPKGraphBackend
}}}

    But you really shouldn't split lines so often. It' meant to make code easier to read (a least I believe it is), but sometimes it really doesn't help. As they appear really often, I think that you should let this line stay even if it is very long. Besides, you very often don't need to add a terinal `\`. For instance, this :

        {{{
 	830	                return (u, v, {"low":(<c_a_data *>a.data).low, \ 
 	831	                               "cap":(<c_a_data *>a.data).cap, \ 
 	832	                               "cost":(<c_a_data *>a.data).cost, \ 
 	833	                               "x":(<c_a_data *>a.data).x}) 
}}}

    Can be replaced by 

        {{{
 	830	                return (u, v, {"low":(<c_a_data *>a.data).low, 
 	831	                               "cap":(<c_a_data *>a.data).cap, 
 	832	                               "cost":(<c_a_data *>a.data).cost, 
 	833	                               "x":(<c_a_data *>a.data).x}) 
}}}
    It works, because Python knows the line is not finished : some parenthesis are still open at this step, and it's waiting for `}` and `)`.

Nathann



---

archive/issue_comments_212517.json:
```json
{
    "body": "<a id='comment:21'></a>\nThanks for your quick reply and the hints, Nathann. This time they were not to hard to include ;-)\n\nHave a nice weekend\n\nChristian",
    "created_at": "2013-02-10T19:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212517",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:21'></a>
Thanks for your quick reply and the hints, Nathann. This time they were not to hard to include ;-)

Have a nice weekend

Christian



---

archive/issue_comments_212518.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-02-16T22:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212518",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_212519.json:
```json
{
    "body": "<a id='comment:23'></a>\nHellooooooooooooooo Christian.\n\nWell, I think I spent my whole saturday on your patch. Here is a patch to apply on topof yours, which changes many things among which the following :\n\n* `set_vertex/set_vertices` were renamed to `set_vertex_demand` and `set_vertices_demand` as they define \"rhs\", and as the help of `get_vertex` says that `\"rhs\"` represents the demand in mincost flow algorithms. As a result, they do not take a dictionary as an argument anymore but only a numerical value, as it is only meant to define a numerical value and nothing else.\n\n* some unimportant reformatting of the index of method at the tp of the document. It goes beyond 80 characters, but it is easier to read this way.\n\n* `fname` is not `fname` but \"data\". data can be a filename, None, or a Sage graph.\n\n* You can use \"::\" wherever you like, not only after \"EXAMPLES\".\n\n* `import_generic_graph` looks like trouble if you call it after having defined edges and vertices in the graph. And its use did not seem very sensible at this step. Hence I removed the function, which is now part of the class constructor.\n\n* In this `import_generic_graph` function you were trying to guess the value of `rhs` from the vertex name, by casting it to a float. Are you aware that most of our graph's vertices are integers ? And that no two vertices can have the same name ? This would let rhs be defined to 0, 2, 3, 4, 5 ... in a graph without anybody noticing, wouldn't it ? I removed that part of the code. Honestly I do not like the fact that rhs is guessed from the result of `Graph.get_vertex` (if it happens to be a numerical value or a dictionary) as it seems to be that users could have stuff defined in `rhs` without knowing it. Looks dangerous. If you agree I would be glad to see it removed, otherwise I will not complain anymore.\n\n* I hate the fact that vertices are necessarily represented by strings. But that's not your fault of course, the API is written like that.\n\n* I hate the fact that there is no function in the API to look for an edge, and that you have to do it yourself.\n\nAnd many, many other small details in the code. A bugfix in `add_vertices` random stuff everywhere.\n\nWell. Tell me what you think about it. I don't know if all this will be heavily used for itself, but we will a least have to expose the flow algorithms inside of the Graph.connectivity methods later on. Thank you for your work for I know it has taken a lifetime, and I think this patch will be ready very soon. \n\nSee youuuuuuuuuuuuuuuuuuuuuuuuuuuu !!!\n\nNathann\n\nP.S. : Pleaaaaaaaaaaase. No other \"patch bombs\". These things are too big to review at once `:-P`",
    "created_at": "2013-02-16T22:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212519",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:23'></a>
Hellooooooooooooooo Christian.

Well, I think I spent my whole saturday on your patch. Here is a patch to apply on topof yours, which changes many things among which the following :

* `set_vertex/set_vertices` were renamed to `set_vertex_demand` and `set_vertices_demand` as they define "rhs", and as the help of `get_vertex` says that `"rhs"` represents the demand in mincost flow algorithms. As a result, they do not take a dictionary as an argument anymore but only a numerical value, as it is only meant to define a numerical value and nothing else.

* some unimportant reformatting of the index of method at the tp of the document. It goes beyond 80 characters, but it is easier to read this way.

* `fname` is not `fname` but "data". data can be a filename, None, or a Sage graph.

* You can use "::" wherever you like, not only after "EXAMPLES".

* `import_generic_graph` looks like trouble if you call it after having defined edges and vertices in the graph. And its use did not seem very sensible at this step. Hence I removed the function, which is now part of the class constructor.

* In this `import_generic_graph` function you were trying to guess the value of `rhs` from the vertex name, by casting it to a float. Are you aware that most of our graph's vertices are integers ? And that no two vertices can have the same name ? This would let rhs be defined to 0, 2, 3, 4, 5 ... in a graph without anybody noticing, wouldn't it ? I removed that part of the code. Honestly I do not like the fact that rhs is guessed from the result of `Graph.get_vertex` (if it happens to be a numerical value or a dictionary) as it seems to be that users could have stuff defined in `rhs` without knowing it. Looks dangerous. If you agree I would be glad to see it removed, otherwise I will not complain anymore.

* I hate the fact that vertices are necessarily represented by strings. But that's not your fault of course, the API is written like that.

* I hate the fact that there is no function in the API to look for an edge, and that you have to do it yourself.

And many, many other small details in the code. A bugfix in `add_vertices` random stuff everywhere.

Well. Tell me what you think about it. I don't know if all this will be heavily used for itself, but we will a least have to expose the flow algorithms inside of the Graph.connectivity methods later on. Thank you for your work for I know it has taken a lifetime, and I think this patch will be ready very soon. 

See youuuuuuuuuuuuuuuuuuuuuuuuuuuu !!!

Nathann

P.S. : Pleaaaaaaaaaaase. No other "patch bombs". These things are too big to review at once `:-P`



---

archive/issue_comments_212520.json:
```json
{
    "body": "<a id='comment:24'></a>\nAttachment [trac_13698-rev.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev.patch) by @nathanncohen created at 2013-02-16 22:05:59\n\nApply trac_13698_glpk_graph_routv2.patch, trac_13698-rev.patch",
    "created_at": "2013-02-16T22:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212520",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>
Attachment [trac_13698-rev.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev.patch) by @nathanncohen created at 2013-02-16 22:05:59

Apply trac_13698_glpk_graph_routv2.patch, trac_13698-rev.patch



---

archive/issue_comments_212521.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,7 @@\n * glp_cpp - Solving critical path problems\n \n In addition it provides support for reading and writing problem data to files\n+\n+Apply :\n+* [attachment:trac_13698_glpk_graph_routv2.patch]\n+* [attachment:trac_13698-rev.patch]\n``````\n",
    "created_at": "2013-02-16T22:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212521",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,7 @@
 * glp_cpp - Solving critical path problems
 
 In addition it provides support for reading and writing problem data to files
+
+Apply :
+* [attachment:trac_13698_glpk_graph_routv2.patch]
+* [attachment:trac_13698-rev.patch]
``````




---

archive/issue_comments_212522.json:
```json
{
    "body": "<a id='comment:25'></a>\nHello Nathann,\n\nfirst of all: Thanks a million for all the time you invested helping me get this of the ground!!!! I promise: I will never ever again come up with something as long as this patch. I really underestimated the work needed - a typical newbie error :-(\n\nI haven't had the time to go through all your changes in detail but all you say and did looks sensible and like improvements to me. Give me a day or two to check it all.\n\nThank you again\n\nChristian",
    "created_at": "2013-02-18T21:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212522",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:25'></a>
Hello Nathann,

first of all: Thanks a million for all the time you invested helping me get this of the ground!!!! I promise: I will never ever again come up with something as long as this patch. I really underestimated the work needed - a typical newbie error :-(

I haven't had the time to go through all your changes in detail but all you say and did looks sensible and like improvements to me. Give me a day or two to check it all.

Thank you again

Christian



---

archive/issue_comments_212523.json:
```json
{
    "body": "<a id='comment:26'></a>\nHello Nathann,\n\n\n> * `set_vertex/set_vertices` were renamed to `set_vertex_demand` and `set_vertices_demand` as they define \"rhs\", and as the help of `get_vertex` says that `\"rhs\"` represents the demand in mincost flow algorithms. As a result, they do not take a dictionary as an argument anymore but only a numerical value, as it is only meant to define a numerical value and nothing else.\n> \n> * some unimportant reformatting of the index of method at the tp of the document. It goes beyond 80 characters, but it is easier to read this way.\n> \n> * `fname` is not `fname` but \"data\". data can be a filename, None, or a Sage graph.\n> \n> * You can use \"::\" wherever you like, not only after \"EXAMPLES\".\n\n\nThanks for all the good changes!\n\n> * `import_generic_graph` looks like trouble if you call it after having defined edges and vertices in the graph. And its use did not seem very sensible at this step. Hence I removed the function, which is now part of the class constructor.\n\n\nYou're absolutely right\n\n\n> * In this `import_generic_graph` function you were trying to guess the value of `rhs` from the vertex name, by casting it to a float. Are you aware that most of our graph's vertices are integers ? And that no two vertices can have the same name ? This would let rhs be defined to 0, 2, 3, 4, 5 ... in a graph without anybody noticing, wouldn't it ? I removed that part of the code. Honestly I do not like the fact that rhs is guessed from the result of `Graph.get_vertex` (if it happens to be a numerical value or a dictionary) as it seems to be that users could have stuff defined in `rhs` without knowing it. Looks dangerous. If you agree I would be glad to see it removed, otherwise I will not complain anymore.\n\n\nYou are absolutely correct, I hadn't thought of that. I removed the \"guessing\".\n\n> * I hate the fact that vertices are necessarily represented by strings. But that's not your fault of course, the API is written like that.\n> \n> * I hate the fact that there is no function in the API to look for an edge, and that you have to do it yourself.\n\n\nI agree, the API is not perfect. I had thought about the \"vertices must be strings\" issue and do have some ideas for a workaround to leave it aside for now.\n\nThanks again!!!!\n\nChristian",
    "created_at": "2013-02-28T21:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212523",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:26'></a>
Hello Nathann,


> * `set_vertex/set_vertices` were renamed to `set_vertex_demand` and `set_vertices_demand` as they define "rhs", and as the help of `get_vertex` says that `"rhs"` represents the demand in mincost flow algorithms. As a result, they do not take a dictionary as an argument anymore but only a numerical value, as it is only meant to define a numerical value and nothing else.
> 
> * some unimportant reformatting of the index of method at the tp of the document. It goes beyond 80 characters, but it is easier to read this way.
> 
> * `fname` is not `fname` but "data". data can be a filename, None, or a Sage graph.
> 
> * You can use "::" wherever you like, not only after "EXAMPLES".


Thanks for all the good changes!

> * `import_generic_graph` looks like trouble if you call it after having defined edges and vertices in the graph. And its use did not seem very sensible at this step. Hence I removed the function, which is now part of the class constructor.


You're absolutely right


> * In this `import_generic_graph` function you were trying to guess the value of `rhs` from the vertex name, by casting it to a float. Are you aware that most of our graph's vertices are integers ? And that no two vertices can have the same name ? This would let rhs be defined to 0, 2, 3, 4, 5 ... in a graph without anybody noticing, wouldn't it ? I removed that part of the code. Honestly I do not like the fact that rhs is guessed from the result of `Graph.get_vertex` (if it happens to be a numerical value or a dictionary) as it seems to be that users could have stuff defined in `rhs` without knowing it. Looks dangerous. If you agree I would be glad to see it removed, otherwise I will not complain anymore.


You are absolutely correct, I hadn't thought of that. I removed the "guessing".

> * I hate the fact that vertices are necessarily represented by strings. But that's not your fault of course, the API is written like that.
> 
> * I hate the fact that there is no function in the API to look for an edge, and that you have to do it yourself.


I agree, the API is not perfect. I had thought about the "vertices must be strings" issue and do have some ideas for a workaround to leave it aside for now.

Thanks again!!!!

Christian



---

archive/issue_comments_212524.json:
```json
{
    "body": "Attachment [trac_13698_rev.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698_rev.patch) by christiankuper created at 2013-02-28 21:50:23",
    "created_at": "2013-02-28T21:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212524",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Attachment [trac_13698_rev.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698_rev.patch) by christiankuper created at 2013-02-28 21:50:23



---

archive/issue_comments_212525.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,4 +10,4 @@\n \n Apply :\n * [attachment:trac_13698_glpk_graph_routv2.patch]\n-* [attachment:trac_13698-rev.patch]\n+* [attachment:trac_13698-rev.2.patch]\n``````\n",
    "created_at": "2013-02-28T21:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212525",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,4 +10,4 @@
 
 Apply :
 * [attachment:trac_13698_glpk_graph_routv2.patch]
-* [attachment:trac_13698-rev.patch]
+* [attachment:trac_13698-rev.2.patch]
``````




---

archive/issue_comments_212526.json:
```json
{
    "body": "<a id='comment:27'></a>\nAttachment [trac_13698-rev.2.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev.2.patch) by christiankuper created at 2013-02-28 21:54:11",
    "created_at": "2013-02-28T21:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212526",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:27'></a>
Attachment [trac_13698-rev.2.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev.2.patch) by christiankuper created at 2013-02-28 21:54:11



---

archive/issue_comments_212527.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-02-28T21:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212527",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_212528.json:
```json
{
    "body": "<a id='comment:28'></a>\nI hope I did the modifications with the 2 patches correctly. I could not replace the trac_13698-rev.patch so I had to upload it with as trac_13698-rev.2.patch",
    "created_at": "2013-02-28T21:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212528",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:28'></a>
I hope I did the modifications with the 2 patches correctly. I could not replace the trac_13698-rev.patch so I had to upload it with as trac_13698-rev.2.patch



---

archive/issue_comments_212529.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-01T13:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212529",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212530.json:
```json
{
    "body": "<a id='comment:29'></a>\nHmmmmmmmmmm ... `O_o`\n\nIt turns out that this patch does not apply on beta2 anymore because #6495 changes the way the doc files are stored.\n\nCould I also ask you to upload the difference between your patch and mine instead of replacing one ? My patch was rather long and I have no way to see what is the difference between yours and mine `:-)`\n\nNathann",
    "created_at": "2013-03-01T13:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212530",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:29'></a>
Hmmmmmmmmmm ... `O_o`

It turns out that this patch does not apply on beta2 anymore because #6495 changes the way the doc files are stored.

Could I also ask you to upload the difference between your patch and mine instead of replacing one ? My patch was rather long and I have no way to see what is the difference between yours and mine `:-)`

Nathann



---

archive/issue_comments_212531.json:
```json
{
    "body": "Modifications to trac_13698-rev.patch",
    "created_at": "2013-03-02T21:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212531",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Modifications to trac_13698-rev.patch



---

archive/issue_comments_212532.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2013-03-02T21:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212532",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_212533.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,4 +10,5 @@\n \n Apply :\n * [attachment:trac_13698_glpk_graph_routv2.patch]\n-* [attachment:trac_13698-rev.2.patch]\n+* [attachment:trac_13698-rev.patch]\n+* [attachment:trac_13698-rev2.patch]\n``````\n",
    "created_at": "2013-03-02T21:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212533",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,4 +10,5 @@
 
 Apply :
 * [attachment:trac_13698_glpk_graph_routv2.patch]
-* [attachment:trac_13698-rev.2.patch]
+* [attachment:trac_13698-rev.patch]
+* [attachment:trac_13698-rev2.patch]
``````




---

archive/issue_comments_212534.json:
```json
{
    "body": "<a id='comment:30'></a>\nAttachment [trac_13698-rev2.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev2.patch) by christiankuper created at 2013-03-02 21:01:48",
    "created_at": "2013-03-02T21:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212534",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:30'></a>
Attachment [trac_13698-rev2.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev2.patch) by christiankuper created at 2013-03-02 21:01:48



---

archive/issue_comments_212535.json:
```json
{
    "body": "<a id='comment:31'></a>\nHello Nathann,\n> \n> It turns out that this patch does not apply on beta2 anymore because #6495 changes the way the doc files are stored.\n> \n\nCan you give me a hint what I need to do?\n\n> Could I also ask you to upload the difference between your patch and mine instead of replacing one ? My patch was rather long and I have no way to see what is the difference between yours and mine `:-)`\n\n\nI hope I understood you correctly. I put my last changes (only a few lines) into a seperate patch.\n\nChristian",
    "created_at": "2013-03-02T21:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212535",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:31'></a>
Hello Nathann,
> 
> It turns out that this patch does not apply on beta2 anymore because #6495 changes the way the doc files are stored.
> 

Can you give me a hint what I need to do?

> Could I also ask you to upload the difference between your patch and mine instead of replacing one ? My patch was rather long and I have no way to see what is the difference between yours and mine `:-)`


I hope I understood you correctly. I put my last changes (only a few lines) into a seperate patch.

Christian



---

archive/issue_comments_212536.json:
```json
{
    "body": "<a id='comment:32'></a>\nHelloooooooooooooooooooo !!!\n\n> Can you give me a hint what I need to do?\n\n\nOh. Well, download beta2 and rebase the patch, but I will do that in a second `:-)`\n\n> I hope I understood you correctly. I put my last changes (only a few lines) into a seperate patch.\n\n\nYepyepyep ! Looks good ! I will re-read everything once and we should be ok afterwards !\n\nNathann",
    "created_at": "2013-03-04T14:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212536",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:32'></a>
Helloooooooooooooooooooo !!!

> Can you give me a hint what I need to do?


Oh. Well, download beta2 and rebase the patch, but I will do that in a second `:-)`

> I hope I understood you correctly. I put my last changes (only a few lines) into a seperate patch.


Yepyepyep ! Looks good ! I will re-read everything once and we should be ok afterwards !

Nathann



---

archive/issue_comments_212537.json:
```json
{
    "body": "Attachment [trac_13698_glpk_graph_routv2.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698_glpk_graph_routv2.patch) by @nathanncohen created at 2013-03-04 14:54:33\n\nReference to sage_graph removed and revised formatting",
    "created_at": "2013-03-04T14:54:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212537",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_13698_glpk_graph_routv2.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698_glpk_graph_routv2.patch) by @nathanncohen created at 2013-03-04 14:54:33

Reference to sage_graph removed and revised formatting



---

archive/issue_comments_212538.json:
```json
{
    "body": "<a id='comment:33'></a>\nApply trac_13698_glpk_graph_routv2.patch, trac_13698-rev.patch, trac_13698-rev2.patch",
    "created_at": "2013-03-05T13:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212538",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:33'></a>
Apply trac_13698_glpk_graph_routv2.patch, trac_13698-rev.patch, trac_13698-rev2.patch



---

archive/issue_comments_212539.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,4 @@\n * [attachment:trac_13698_glpk_graph_routv2.patch]\n * [attachment:trac_13698-rev.patch]\n * [attachment:trac_13698-rev2.patch]\n+* [attachment:trac_13698-rev3.patch]\n``````\n",
    "created_at": "2013-03-05T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212539",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,4 @@
 * [attachment:trac_13698_glpk_graph_routv2.patch]
 * [attachment:trac_13698-rev.patch]
 * [attachment:trac_13698-rev2.patch]
+* [attachment:trac_13698-rev3.patch]
``````




---

archive/issue_comments_212540.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathann Cohen\"",
    "created_at": "2013-03-05T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212540",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Nathann Cohen"



---

archive/issue_comments_212541.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-03-05T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212541",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_212542.json:
```json
{
    "body": "<a id='comment:34'></a>\nHelloooooooooo again ! I just went over the patch again and changed a few characters. I added several 's' to verbs so that they would either all have one, nd I removed a variable named \"graph_sol\" which was not really useful as a class parameter.\n\nIf you as ok with this then we can set this ticket to positive review ! `;-)`\n\nHave fuuuuuuuuuuuuuuuuuuuuuun !!\n\nNathann",
    "created_at": "2013-03-05T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212542",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:34'></a>
Helloooooooooo again ! I just went over the patch again and changed a few characters. I added several 's' to verbs so that they would either all have one, nd I removed a variable named "graph_sol" which was not really useful as a class parameter.

If you as ok with this then we can set this ticket to positive review ! `;-)`

Have fuuuuuuuuuuuuuuuuuuuuuun !!

Nathann



---

archive/issue_comments_212543.json:
```json
{
    "body": "Attachment [trac_13698-rev3.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev3.patch) by @nathanncohen created at 2013-03-05 14:43:43",
    "created_at": "2013-03-05T14:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212543",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_13698-rev3.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev3.patch) by @nathanncohen created at 2013-03-05 14:43:43



---

archive/issue_comments_212544.json:
```json
{
    "body": "<a id='comment:35'></a>\nHello Nathann,\n\nThank you for the improvements you made! I feel absolutly comfortable with the changes in the trac_13698-rev3.patch.\n\nThanks again!!!\n\nChristian",
    "created_at": "2013-03-09T18:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212544",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:35'></a>
Hello Nathann,

Thank you for the improvements you made! I feel absolutly comfortable with the changes in the trac_13698-rev3.patch.

Thanks again!!!

Christian



---

archive/issue_comments_212545.json:
```json
{
    "body": "<a id='comment:36'></a>\nWell, then... Positive review ! And we will have to expose this flow method from inside the graph library eventually `:-)`\n\nNathann",
    "created_at": "2013-03-09T18:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212545",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:36'></a>
Well, then... Positive review ! And we will have to expose this flow method from inside the graph library eventually `:-)`

Nathann



---

archive/issue_comments_212546.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-09T18:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212546",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_044460.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-11T09:07:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13698#event-44460"
}
```



---

archive/issue_comments_212547.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#12415\"",
    "created_at": "2013-03-11T11:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212547",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#12415"



---

archive/issue_comments_212548.json:
```json
{
    "body": "<a id='comment:38'></a>\nWith #12415:\n\n```\nsage -t devel/sage/sage/numerical/backends/glpk_graph_backend.pyx\n**********************************************************************\nFile \"devel/sage/sage/numerical/backends/glpk_graph_backend.pyx\", line 156, in sage.numerical.backends.glpk_graph_backend.GLPKGraphBackend\nFailed example:\n    gbe.write_graph(SAGE_TMP+\"/graph.txt\")\nExpected:\n    0\nGot:\n    Writing graph to `/tmp/dotsagem31030/temp/sage.math.washington.edu/13336/graph.txt'...\n    2 lines were written\n    0\n**********************************************************************\n```\nand more like this...",
    "created_at": "2013-03-11T11:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212548",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>
With #12415:

```
sage -t devel/sage/sage/numerical/backends/glpk_graph_backend.pyx
**********************************************************************
File "devel/sage/sage/numerical/backends/glpk_graph_backend.pyx", line 156, in sage.numerical.backends.glpk_graph_backend.GLPKGraphBackend
Failed example:
    gbe.write_graph(SAGE_TMP+"/graph.txt")
Expected:
    0
Got:
    Writing graph to `/tmp/dotsagem31030/temp/sage.math.washington.edu/13336/graph.txt'...
    2 lines were written
    0
**********************************************************************
```
and more like this...



---

archive/issue_comments_212549.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-11T13:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212549",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_212550.json:
```json
{
    "body": "<a id='comment:40'></a>\nOk,it seems that #12415 means that the \"...\" placeholder is not accepted any more (at least for some outputs). Removing \"...\" resulted in successful doctest.",
    "created_at": "2013-03-24T16:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212550",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:40'></a>
Ok,it seems that #12415 means that the "..." placeholder is not accepted any more (at least for some outputs). Removing "..." resulted in successful doctest.



---

archive/issue_comments_212551.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-24T16:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212551",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212552.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,3 +13,4 @@\n * [attachment:trac_13698-rev.patch]\n * [attachment:trac_13698-rev2.patch]\n * [attachment:trac_13698-rev3.patch]\n+* [attachment:trac_13698-rev4.patch]\n``````\n",
    "created_at": "2013-03-24T16:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212552",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,3 +13,4 @@
 * [attachment:trac_13698-rev.patch]
 * [attachment:trac_13698-rev2.patch]
 * [attachment:trac_13698-rev3.patch]
+* [attachment:trac_13698-rev4.patch]
``````




---

archive/issue_comments_212553.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-24T18:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212553",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_212554.json:
```json
{
    "body": "<a id='comment:43'></a>\nI'm pretty sure that I fixed this doctest problem somewhere else, but I don't remember right now `^^;`\n\nNathann",
    "created_at": "2013-03-24T18:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212554",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:43'></a>
I'm pretty sure that I fixed this doctest problem somewhere else, but I don't remember right now `^^;`

Nathann



---

archive/issue_comments_212555.json:
```json
{
    "body": "<a id='comment:44'></a>\nI get this failure on Solaris SPARC:\n\n```\nsage -t --long devel/sage/sage/numerical/backends/glpk_graph_backend.pyx\n**********************************************************************\nFile \"devel/sage/sage/numerical/backends/glpk_graph_backend.pyx\", line 1340, in sage.numerical.backends.glpk_graph_backend.GLPKGraphBackend.cpp\nFailed example:\n    print 1, v[\"rhs\"], v[\"es\"], v[\"ls\"]\nExpected:\n    1 1.0 0.0 2.0\nGot:\n    1 1.0 5.30498947741e-315 0.0\n**********************************************************************\n```",
    "created_at": "2013-03-26T17:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212555",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
I get this failure on Solaris SPARC:

```
sage -t --long devel/sage/sage/numerical/backends/glpk_graph_backend.pyx
**********************************************************************
File "devel/sage/sage/numerical/backends/glpk_graph_backend.pyx", line 1340, in sage.numerical.backends.glpk_graph_backend.GLPKGraphBackend.cpp
Failed example:
    print 1, v["rhs"], v["es"], v["ls"]
Expected:
    1 1.0 0.0 2.0
Got:
    1 1.0 5.30498947741e-315 0.0
**********************************************************************
```



---

archive/issue_comments_212556.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-26T17:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212556",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_212557.json:
```json
{
    "body": "<a id='comment:45'></a>\nAdded a tolerance check to cope with the SPARC Solaris error.",
    "created_at": "2013-03-29T19:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212557",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:45'></a>
Added a tolerance check to cope with the SPARC Solaris error.



---

archive/issue_comments_212558.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-29T19:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212558",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212559.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-30T11:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212559",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_044461.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-04T17:39:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13698#event-44461"
}
```



---

archive/issue_comments_212560.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-04T17:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212560",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_212561.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.9.beta4\"",
    "created_at": "2013-04-04T17:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212561",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.9.beta4"



---

archive/issue_comments_212562.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2013-04-05T06:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212562",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_212563.json:
```json
{
    "body": "<a id='comment:48'></a>\nIt still fails exactly the same test as before on Solaris SPARC:\n\n```\nsage -t --long devel/sage/sage/numerical/backends/glpk_graph_backend.pyx\n**********************************************************************\nFile \"devel/sage/sage/numerical/backends/glpk_graph_backend.pyx\", line 1340, in sage.numerical.backends.glpk_graph_backend.GLPKGraphBackend.cpp\nFailed example:\n    print 1, v[\"rhs\"], v[\"es\"], v[\"ls\"] # abs tol 1e-6\nExpected:\n    1 1.0 0.0 2.0\nGot:\n    1 1.0 5.30498947741e-315 0.0\nTolerance exceeded in 1 of 4\n    2.0 vs 0.0\n**********************************************************************\n```",
    "created_at": "2013-04-05T06:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212563",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>
It still fails exactly the same test as before on Solaris SPARC:

```
sage -t --long devel/sage/sage/numerical/backends/glpk_graph_backend.pyx
**********************************************************************
File "devel/sage/sage/numerical/backends/glpk_graph_backend.pyx", line 1340, in sage.numerical.backends.glpk_graph_backend.GLPKGraphBackend.cpp
Failed example:
    print 1, v["rhs"], v["es"], v["ls"] # abs tol 1e-6
Expected:
    1 1.0 0.0 2.0
Got:
    1 1.0 5.30498947741e-315 0.0
Tolerance exceeded in 1 of 4
    2.0 vs 0.0
**********************************************************************
```



---

archive/issue_comments_212564.json:
```json
{
    "body": "Changing merged from \"sage-5.9.beta4\" to \"\"",
    "created_at": "2013-04-05T06:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212564",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "sage-5.9.beta4" to ""



---

archive/issue_comments_212565.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2013-04-05T06:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212565",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_comments_212566.json:
```json
{
    "body": "Fixed errors cause by Solaris Sparc",
    "created_at": "2013-04-06T11:49:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212566",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Fixed errors cause by Solaris Sparc



---

archive/issue_comments_212567.json:
```json
{
    "body": "<a id='comment:49'></a>\nAttachment [trac_13698-rev4.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev4.patch) by christiankuper created at 2013-04-06 12:06:33\n\nThe only \"unique\" aspect in the method causing the error is the pointers passed to the GLPK library function. This is the only function where the pointer of two parameters is defined like \"x*sizeof(double) + y*sizeof(long)\" - and these two values are causing the errors. All other pointers are defined like \"x*sizeof(double)\". Therefore I suspect that \"sizeof(long)\" is causing the errors.\n\nI therefore redefined the \"c_v_data\" structure so the <long> value is the last value. This now allows all pointers to be defined as \"x*sizeof(double)\", i.e. without sizeof long. In addition defined the field in the data structure as \"long\" and not as \"int\".\n\nHopefully this removes the failure in the test on a Solaris. Due to the lack of a solaris machine I cannot verify this myself, therefore I tried to explain the reasoning behind the changes I did.\n\nChristian",
    "created_at": "2013-04-06T12:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212567",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:49'></a>
Attachment [trac_13698-rev4.patch](tarball://root/attachments/some-uuid/ticket13698/trac_13698-rev4.patch) by christiankuper created at 2013-04-06 12:06:33

The only "unique" aspect in the method causing the error is the pointers passed to the GLPK library function. This is the only function where the pointer of two parameters is defined like "x*sizeof(double) + y*sizeof(long)" - and these two values are causing the errors. All other pointers are defined like "x*sizeof(double)". Therefore I suspect that "sizeof(long)" is causing the errors.

I therefore redefined the "c_v_data" structure so the <long> value is the last value. This now allows all pointers to be defined as "x*sizeof(double)", i.e. without sizeof long. In addition defined the field in the data structure as "long" and not as "int".

Hopefully this removes the failure in the test on a Solaris. Due to the lack of a solaris machine I cannot verify this myself, therefore I tried to explain the reasoning behind the changes I did.

Christian



---

archive/issue_comments_212568.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-04-06T12:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212568",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_212569.json:
```json
{
    "body": "<a id='comment:51'></a>\nWhy don't you think it was just caused by the fact that \"cut\" used to be of \"int\" type in the structure's definition, and seemed to be counted as \"sizeof(long)\" int `glp_cpp` ?\n\nBesides, if this line (the call to `glp_cpp`) has to be changed, wouldn't others need to be changed too ?\n\nNathann",
    "created_at": "2013-04-06T12:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212569",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:51'></a>
Why don't you think it was just caused by the fact that "cut" used to be of "int" type in the structure's definition, and seemed to be counted as "sizeof(long)" int `glp_cpp` ?

Besides, if this line (the call to `glp_cpp`) has to be changed, wouldn't others need to be changed too ?

Nathann



---

archive/issue_comments_212570.json:
```json
{
    "body": "<a id='comment:52'></a>\nReplying to [ncohen](#comment%3A51):\n> Why don't you think it was just caused by the fact that \"cut\" used to be of \"int\" type in the structure's definition, and seemed to be counted as \"sizeof(long)\" int `glp_cpp` ?\n> \n\nYou are probably right, just to be on the safe side I did both ;-)\n\n\n> Besides, if this line (the call to `glp_cpp`) has to be changed, wouldn't others need to be changed too ?\n> \n\nYes of course, I changed \"glp_maxflow_ffalg\" call too, which I did. All other function calls are not affected as they do not need the affected fields of the structure.\n\nChristian\n\nBTW: Of course I re-ran the tests and all passed!",
    "created_at": "2013-04-06T12:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212570",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:52'></a>
Replying to [ncohen](#comment%3A51):
> Why don't you think it was just caused by the fact that "cut" used to be of "int" type in the structure's definition, and seemed to be counted as "sizeof(long)" int `glp_cpp` ?
> 

You are probably right, just to be on the safe side I did both ;-)


> Besides, if this line (the call to `glp_cpp`) has to be changed, wouldn't others need to be changed too ?
> 

Yes of course, I changed "glp_maxflow_ffalg" call too, which I did. All other function calls are not affected as they do not need the affected fields of the structure.

Christian

BTW: Of course I re-ran the tests and all passed!



---

archive/issue_comments_212571.json:
```json
{
    "body": "<a id='comment:53'></a>\nWell, I guess it's worth a try then. Though your patch contains no modification to `glp_maxflow_ffalg`.\n\nNathann",
    "created_at": "2013-04-06T12:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212571",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:53'></a>
Well, I guess it's worth a try then. Though your patch contains no modification to `glp_maxflow_ffalg`.

Nathann



---

archive/issue_comments_212572.json:
```json
{
    "body": "<a id='comment:54'></a>\nOoops my mistake.\n\nSorry.\n\nIt does.\n\nNathann",
    "created_at": "2013-04-06T12:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212572",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:54'></a>
Ooops my mistake.

Sorry.

It does.

Nathann



---

archive/issue_comments_212573.json:
```json
{
    "body": "<a id='comment:55'></a>\nOk, it makes sense. Let's ask Jeroen to give it another try `:-)`\n\nNathann",
    "created_at": "2013-04-06T12:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212573",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:55'></a>
Ok, it makes sense. Let's ask Jeroen to give it another try `:-)`

Nathann



---

archive/issue_comments_212574.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-06T12:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212574",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_212575.json:
```json
{
    "body": "<a id='comment:56'></a>\nReplying to [ncohen](#comment%3A55):\n> Ok, it makes sense. Let's ask Jeroen to give it another try `:-)`\n> \n> Nathann\n\n\nThank you !!!!!!!!!",
    "created_at": "2013-04-06T13:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212575",
    "user": "https://trac.sagemath.org/admin/accounts/users/christiankuper"
}
```

<a id='comment:56'></a>
Replying to [ncohen](#comment%3A55):
> Ok, it makes sense. Let's ask Jeroen to give it another try `:-)`
> 
> Nathann


Thank you !!!!!!!!!



---

archive/issue_events_044462.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-06T14:52:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13698#event-44462"
}
```



---

archive/issue_events_044463.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-06T14:52:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13698#event-44463"
}
```



---

archive/issue_comments_212576.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-13T13:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212576",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_044464.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-13T13:49:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13698#event-44464"
}
```



---

archive/issue_comments_212577.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.10.beta0\"",
    "created_at": "2013-04-13T13:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13698",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13698#issuecomment-212577",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.10.beta0"
