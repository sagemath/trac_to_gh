# Issue 13990: Bug fix and small improvement of spanning_trees_count

archive/issues_013786.json:
```json
{
    "body": "The current implementation of spanning_trees_count returns 1 as the number of spanning trees for the empty graph\n\n```\nsage: G = Graph()\nsage: G.spanning_trees_count()\n1\n```\n\nwhich is of course incorrect. \n\nThe attached patch fixes this and also removes the unnecessary call to abs().\n\n\n\n**Assignee:** @jasongrout, @nathanncohen, @rlmill\n\n**CC:**  azi ncohen\n\n**Reviewer:** Nathann Cohen\n\n**Author:** Jernej Azarija\n\n**Merged:** sage-5.7.beta4\n\nIssue created by migration from https://trac.sagemath.org/ticket/13990\n\n",
    "closed_at": "2013-02-09T12:14:45Z",
    "created_at": "2013-01-22T22:52:18Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "Bug fix and small improvement of spanning_trees_count",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13990",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```
The current implementation of spanning_trees_count returns 1 as the number of spanning trees for the empty graph

```
sage: G = Graph()
sage: G.spanning_trees_count()
1
```

which is of course incorrect. 

The attached patch fixes this and also removes the unnecessary call to abs().



**Assignee:** @jasongrout, @nathanncohen, @rlmill

**CC:**  azi ncohen

**Reviewer:** Nathann Cohen

**Author:** Jernej Azarija

**Merged:** sage-5.7.beta4

Issue created by migration from https://trac.sagemath.org/ticket/13990





---

archive/attachments_018893.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13990_spantree_empty.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13990/trac_13990_spantree_empty.patch",
    "created_at": "2013-01-22T22:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```



---

archive/issue_comments_205611.json:
```json
{
    "body": "",
    "created_at": "2013-01-22T22:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205611",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```





---

archive/issue_comments_205612.json:
```json
{
    "body": "<a id='comment:1'></a>\nHelloooooooo !!\n\nWell... Thinking about it, why isn't the empty set a good spanning tree for the empty graph ? And by the way, why do you think that you can remove this \"abs\" ? Can't this thing be negative sometimes ? I only saw that result with \"abs\" around `:-)`\n\nNathann",
    "created_at": "2013-01-23T10:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205612",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>
Helloooooooo !!

Well... Thinking about it, why isn't the empty set a good spanning tree for the empty graph ? And by the way, why do you think that you can remove this "abs" ? Can't this thing be negative sometimes ? I only saw that result with "abs" around `:-)`

Nathann



---

archive/issue_comments_205613.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-02-01T10:38:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205613",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_205614.json:
```json
{
    "body": "<a id='comment:3'></a>\nDamn. I haven't seen your comment..\n\n\n\nA tree is a connected graph with n vertices and n-1 edges. There is no subgraph of the empty graph having $-1$ edges and $0$ vertices hence there is no spanning tree of the empty graph. I have also tested the function in Mathematica which returns 0 as expected.\n\nAs for abs(). The matrix tree theorem states the following. Let L_{i,j} be the Laplacian matrix of a graph G from which we remove the i'th column and j'th row. Then the number of spanning trees is (-1)^{i+j}det(L_{i,j}) hence for i=j the expression simplifies to simply computing det(L_{i,j})",
    "created_at": "2013-02-01T10:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205614",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:3'></a>
Damn. I haven't seen your comment..



A tree is a connected graph with n vertices and n-1 edges. There is no subgraph of the empty graph having $-1$ edges and $0$ vertices hence there is no spanning tree of the empty graph. I have also tested the function in Mathematica which returns 0 as expected.

As for abs(). The matrix tree theorem states the following. Let L_{i,j} be the Laplacian matrix of a graph G from which we remove the i'th column and j'th row. Then the number of spanning trees is (-1)^{i+j}det(L_{i,j}) hence for i=j the expression simplifies to simply computing det(L_{i,j})



---

archive/issue_comments_205615.json:
```json
{
    "body": "<a id='comment:4'></a>\nA tree is a set of edges such that the graph induced by the set of edges is connected. Hence there is one spanning tree of the empty graph.\n\nI'm not playing with words, just saying that one can either expect 1 or 0 there...\n\nFor instance, people there expect 1 : http://oeis.org/A000272\nAnd I guess that you will always need one when you define a recursion formula to compute it.\n\nAgreed for you modification to \"abs\". Looks like everybody out there agrees that this is not needed `:-)`\n\nNathann",
    "created_at": "2013-02-01T12:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205615",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
A tree is a set of edges such that the graph induced by the set of edges is connected. Hence there is one spanning tree of the empty graph.

I'm not playing with words, just saying that one can either expect 1 or 0 there...

For instance, people there expect 1 : http://oeis.org/A000272
And I guess that you will always need one when you define a recursion formula to compute it.

Agreed for you modification to "abs". Looks like everybody out there agrees that this is not needed `:-)`

Nathann



---

archive/issue_comments_205616.json:
```json
{
    "body": "<a id='comment:5'></a>\nYeah!\n\nThough if you take this definition in mind the complete graph is itself a tree! \n\nI agree with your remark that this is probably just a matter of how you define it but then I think it Sage is not consistent with respect to the \"is_tree\" routine.\n\n```\nsage: G = graphs.EmptyGraph()\nsage: G.is_tree()            \nFalse\n```",
    "created_at": "2013-02-01T13:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205616",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:5'></a>
Yeah!

Though if you take this definition in mind the complete graph is itself a tree! 

I agree with your remark that this is probably just a matter of how you define it but then I think it Sage is not consistent with respect to the "is_tree" routine.

```
sage: G = graphs.EmptyGraph()
sage: G.is_tree()            
False
```



---

archive/issue_comments_205617.json:
```json
{
    "body": "<a id='comment:6'></a>\nAhaahh. Yep, now that's a problem `:-)`\n\nDo we fix this instead, then ?\n\nNathann",
    "created_at": "2013-02-01T13:12:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205617",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>
Ahaahh. Yep, now that's a problem `:-)`

Do we fix this instead, then ?

Nathann



---

archive/issue_comments_205618.json:
```json
{
    "body": "<a id='comment:7'></a>\nI'll ask around (mathoverflow) a bit if there if there are any reasons for defining this quantity in either way and then we see! \n\nOKOKOK?",
    "created_at": "2013-02-01T15:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205618",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:7'></a>
I'll ask around (mathoverflow) a bit if there if there are any reasons for defining this quantity in either way and then we see! 

OKOKOK?



---

archive/issue_comments_205619.json:
```json
{
    "body": "<a id='comment:8'></a>\n> OKOKOK?\n\n\n+1 !\n\nNathann",
    "created_at": "2013-02-01T18:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205619",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
> OKOKOK?


+1 !

Nathann



---

archive/issue_comments_205620.json:
```json
{
    "body": "<a id='comment:9'></a>\nhttp://mathoverflow.net/questions/120536/is-the-empty-graph-a-tree",
    "created_at": "2013-02-01T20:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205620",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:9'></a>
http://mathoverflow.net/questions/120536/is-the-empty-graph-a-tree



---

archive/issue_comments_205621.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe guys there seems to agree that\n\n\n* The empty graph is not a tree. (OK in Sage)\n* The empty graph is a forest. (OK in Sage)\n* The empty graph is not connected. (FAIL in Sage)\n* The number of spanning trees in the empty graph is 0. (FAIL in Sage)\n\nNow I would suggest that I change the patch so that all things work as expected by the points above. What you think mr Cohen?",
    "created_at": "2013-02-02T11:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205621",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:10'></a>
The guys there seems to agree that


* The empty graph is not a tree. (OK in Sage)
* The empty graph is a forest. (OK in Sage)
* The empty graph is not connected. (FAIL in Sage)
* The number of spanning trees in the empty graph is 0. (FAIL in Sage)

Now I would suggest that I change the patch so that all things work as expected by the points above. What you think mr Cohen?



---

archive/issue_comments_205622.json:
```json
{
    "body": "<a id='comment:11'></a>\nHellooooooo !!\n\n> The guys there seems to agree that\n> \n> * The empty graph is not a tree. (OK in Sage)\n> * The empty graph is a forest. (OK in Sage)\n> * The empty graph is not connected. (FAIL in Sage)\n> * The number of spanning trees in the empty graph is 0. (FAIL in Sage)\n> \n> Now I would suggest that I change the patch so that all things work as expected by the points above. What you think mr Cohen?\n\n\nAhahahaah. Well I would have prefered that the empty graph be a tree and a forest, AND connected. And I still wonder how they deal with the fact that \"there exists a path between any pair of vertices\" in the empty graph... But WELL `:-D`\n\nI'll review that patch if you write it ! And besides the connectedness of the empty graph, I totally love people that can go to such length over such trivial things `:-D`\n\nHave fuuuuuuuuuuuuuuuun !!! `:-D`\n\nNathann",
    "created_at": "2013-02-02T13:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205622",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:11'></a>
Hellooooooo !!

> The guys there seems to agree that
> 
> * The empty graph is not a tree. (OK in Sage)
> * The empty graph is a forest. (OK in Sage)
> * The empty graph is not connected. (FAIL in Sage)
> * The number of spanning trees in the empty graph is 0. (FAIL in Sage)
> 
> Now I would suggest that I change the patch so that all things work as expected by the points above. What you think mr Cohen?


Ahahahaah. Well I would have prefered that the empty graph be a tree and a forest, AND connected. And I still wonder how they deal with the fact that "there exists a path between any pair of vertices" in the empty graph... But WELL `:-D`

I'll review that patch if you write it ! And besides the connectedness of the empty graph, I totally love people that can go to such length over such trivial things `:-D`

Have fuuuuuuuuuuuuuuuun !!! `:-D`

Nathann



---

archive/issue_comments_205623.json:
```json
{
    "body": "<a id='comment:12'></a>\nYeah! If you look at the answers on the page you'll see that only Bourbaki defines the empty graph as being connected so it appears there is a French thing in defining things differently :-)))))\n\nAnyhow I completely agree that this is non-important and trivial, but since I already raised this issue I'd like to have the best \"fix for the crowd\" possible.",
    "created_at": "2013-02-02T14:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205623",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:12'></a>
Yeah! If you look at the answers on the page you'll see that only Bourbaki defines the empty graph as being connected so it appears there is a French thing in defining things differently :-)))))

Anyhow I completely agree that this is non-important and trivial, but since I already raised this issue I'd like to have the best "fix for the crowd" possible.



---

archive/issue_comments_205624.json:
```json
{
    "body": "<a id='comment:13'></a>\nWell, then ...\n\nNathann",
    "created_at": "2013-02-03T20:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205624",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:13'></a>
Well, then ...

Nathann



---

archive/issue_comments_205625.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-02-03T20:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205625",
    "user": "https://github.com/nathanncohen"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_205626.json:
```json
{
    "body": "<a id='comment:14'></a>\nPlease fill in the Author / Reviewer fields with your real names.",
    "created_at": "2013-02-04T09:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205626",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Please fill in the Author / Reviewer fields with your real names.



---

archive/issue_comments_205627.json:
```json
{
    "body": "**Author:** Jernej Azarija",
    "created_at": "2013-02-04T10:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205627",
    "user": "https://github.com/nathanncohen"
}
```

**Author:** Jernej Azarija



---

archive/issue_comments_205628.json:
```json
{
    "body": "**Reviewer:** Nathann Cohen",
    "created_at": "2013-02-04T10:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205628",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Nathann Cohen



---

archive/issue_comments_205629.json:
```json
{
    "body": "**Merged:** sage-5.7.beta4",
    "created_at": "2013-02-09T12:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13990#issuecomment-205629",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.7.beta4



---

archive/issue_events_045091.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-09T12:14:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13990",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13990#event-45091"
}
```
