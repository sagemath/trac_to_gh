# Issue 13109: Rewrite deprecation to use trac ticket numbers

archive/issues_012937.json:
```json
{
    "body": "As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n\n```\ndeprecation(trac_number, message) \n```\nwhere both arguments are mandatory.  Once this code is in Sage, one \ncan deduce every possible thing discussed above in this thread from \nthe trac number.   The deprecation warning can produce the URL of the \ntrac ticket. \n\nAnalogous changes are made to `deprecated_function_alias` and `deprecated_callable_import`. Finally, the ``@`rename_keyword(deprecated=\"sage version string\", ...)` decorator is changed to\n\n```\n@rename_keyword(deprecation=<trac_number>, ...)\n```\n\nApply\n* [attachment:trac_13109_deprecation.patch]\n* [attachment:trac_13109_ticket_numbers.patch]\n* [attachment:trac_13109_fix_doctests.patch]\n* [attachment:trac_13109-documentation.v3.patch]\n\nThis ticket also fixes #8073, #8546.\n\nAssignee: mvngu\n\nCC:  @JohnCremona @kini @williamstein @jasongrout @kcrisman\n\nReviewer: John Palmieri, Karl-Dieter Crisman\n\nAuthor: Volker Braun\n\nMerged: sage-5.2.rc0\n\nDependencies: #12544, #12965\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13109\n\n",
    "closed_at": "2012-07-16T16:40:59Z",
    "created_at": "2012-06-12T20:26:15Z",
    "labels": [
        "component: doctest coverage"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.2",
    "title": "Rewrite deprecation to use trac ticket numbers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13109",
    "user": "https://github.com/vbraun"
}
```
As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments

```
deprecation(trac_number, message) 
```
where both arguments are mandatory.  Once this code is in Sage, one 
can deduce every possible thing discussed above in this thread from 
the trac number.   The deprecation warning can produce the URL of the 
trac ticket. 

Analogous changes are made to `deprecated_function_alias` and `deprecated_callable_import`. Finally, the ``@`rename_keyword(deprecated="sage version string", ...)` decorator is changed to

```
@rename_keyword(deprecation=<trac_number>, ...)
```

Apply
* [attachment:trac_13109_deprecation.patch]
* [attachment:trac_13109_ticket_numbers.patch]
* [attachment:trac_13109_fix_doctests.patch]
* [attachment:trac_13109-documentation.v3.patch]

This ticket also fixes #8073, #8546.

Assignee: mvngu

CC:  @JohnCremona @kini @williamstein @jasongrout @kcrisman

Reviewer: John Palmieri, Karl-Dieter Crisman

Author: Volker Braun

Merged: sage-5.2.rc0

Dependencies: #12544, #12965

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13109





---

archive/issue_comments_165588.json:
```json
{
    "body": "<a id='comment:1'></a>I just have to say it, please don't hurt me!\n\n```\n\nDefinition:     sage.misc.misc.deprecation(message, version=None)\nDocstring:\n       Issue a deprecation warning.\n    \n       INPUT:\n    \n          * \"message\" - an explanation why things are deprecated and by\n            what it\n               should be replaced.\n    \n          * \"version\" - (optional) on which version and when the\n            deprecation\n               occurred. Please put there the version of sage at the time\n               of deprecation.\n```\nThat's incompatible with the current one, as far as I understand the ways optional args with defaults work.  So will the syntax for the deprecation function have to be ... deprecated?",
    "created_at": "2012-06-13T00:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165588",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'></a>I just have to say it, please don't hurt me!

```

Definition:     sage.misc.misc.deprecation(message, version=None)
Docstring:
       Issue a deprecation warning.
    
       INPUT:
    
          * "message" - an explanation why things are deprecated and by
            what it
               should be replaced.
    
          * "version" - (optional) on which version and when the
            deprecation
               occurred. Please put there the version of sage at the time
               of deprecation.
```
That's incompatible with the current one, as far as I understand the ways optional args with defaults work.  So will the syntax for the deprecation function have to be ... deprecated?



---

archive/issue_comments_165589.json:
```json
{
    "body": "<a id='comment:2'></a>That depends on whether the barber of Seville shaves himself or not.",
    "created_at": "2012-06-13T09:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165589",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>That depends on whether the barber of Seville shaves himself or not.



---

archive/issue_comments_165590.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -6,7 +6,12 @@\n where both arguments are mandatory.  Once this code is in Sage, one \n can deduce every possible thing discussed above in this thread from \n the trac number.   The deprecation warning can produce the URL of the \n-trac ticket.\n+trac ticket. \n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-14T13:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165590",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -6,7 +6,12 @@
 where both arguments are mandatory.  Once this code is in Sage, one 
 can deduce every possible thing discussed above in this thread from 
 the trac number.   The deprecation warning can produce the URL of the 
-trac ticket.
+trac ticket. 
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
 
 Comment: 1
 
```




---

archive/issue_comments_165591.json:
```json
{
    "body": "<a id='comment:3'></a>The first patch changes the deprecation syntax. The second adds the trac numbers to all deprecations in the Sage library. The third fixes all doctests.",
    "created_at": "2012-06-14T13:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165591",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>The first patch changes the deprecation syntax. The second adds the trac numbers to all deprecations in the Sage library. The third fixes all doctests.



---

archive/issue_comments_165592.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-14T13:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165592",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,23 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
 
 Comment: 1
 
```




---

archive/issue_comments_165593.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n+* [attachment:trac_13109_documentation.patch]\n+\n+This ticket also fixes #8073, #8546.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-14T14:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165593",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
+* [attachment:trac_13109_documentation.patch]
+
+This ticket also fixes #8073, #8546.
 
 Comment: 1
 
```




---

archive/issue_comments_165594.json:
```json
{
    "body": "<a id='comment:5'></a>The last patch adds documentation to the developer guide.",
    "created_at": "2012-06-14T14:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165594",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>The last patch adds documentation to the developer guide.



---

archive/issue_comments_165595.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-06-14T14:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165595",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_165596.json:
```json
{
    "body": "<a id='comment:7'></a>Very comprehensive work.\n* I first have to say that [attachment:trac_13109_ticket_numbers.patch] is extremely impressive.  I guess that relieves any concerns about deprecating the deprecation functionality.\n* Do we want to use the `:trac:` markup anywhere here?  Of course, that doesn't show up as nicely in the command line, so perhaps not.\n* So will it be up the end user to determine whether a given item is nearing the end of its deprecation life?  I do like that part of #8546.  It could be really tedious to check whether a number of things are due. Why not have that as another (optional) argument?  Maybe there is a good reason I'm just missing, certainly this syntax is easier for the person writing the code.\n* Also, what happens if Trac goes the way of ... Mercurial for sagenb?  \n* I notice that `Foo` also has terrible doctesting, in addition to having several ill-conceived methods.  But in general I really like it - very clear but also not dry. \n* That said, there should be an example of how to doctest the deprecation, because it won't look like what comes out, but rather \n\n```\ndoctest:...: DeprecationWarning: \n]}}\n  as you know from the presumably tedious work on the doctest patch.",
    "created_at": "2012-06-14T14:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165596",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>Very comprehensive work.
* I first have to say that [attachment:trac_13109_ticket_numbers.patch] is extremely impressive.  I guess that relieves any concerns about deprecating the deprecation functionality.
* Do we want to use the `:trac:` markup anywhere here?  Of course, that doesn't show up as nicely in the command line, so perhaps not.
* So will it be up the end user to determine whether a given item is nearing the end of its deprecation life?  I do like that part of #8546.  It could be really tedious to check whether a number of things are due. Why not have that as another (optional) argument?  Maybe there is a good reason I'm just missing, certainly this syntax is easier for the person writing the code.
* Also, what happens if Trac goes the way of ... Mercurial for sagenb?  
* I notice that `Foo` also has terrible doctesting, in addition to having several ill-conceived methods.  But in general I really like it - very clear but also not dry. 
* That said, there should be an example of how to doctest the deprecation, because it won't look like what comes out, but rather 

```
doctest:...: DeprecationWarning: 
]}}
  as you know from the presumably tedious work on the doctest patch.



---

archive/issue_comments_165597.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n+* [attachment:trac_13109_documentation.patch]\n+\n+This ticket also fixes #8073.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-14T14:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165597",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
+* [attachment:trac_13109_documentation.patch]
+
+This ticket also fixes #8073.
 
 Comment: 1
 
```




---

archive/issue_comments_165598.json:
```json
{
    "body": "<a id='comment:8'></a>Oops, removing that was a mistake.\n\nOne more thing; to make *sure* that this supersedes #8073, if we do keep Sage versions in, let's make sure to make it very very clear whether we are doing >= or >.  \n\nAlso, reading through the ticket number patch confirms my sense that Sage version is important; looking at something that says Sage version 4.3 (!!!) is far more revealing than Trac number so and so.",
    "created_at": "2012-06-14T14:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165598",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>Oops, removing that was a mistake.

One more thing; to make *sure* that this supersedes #8073, if we do keep Sage versions in, let's make sure to make it very very clear whether we are doing >= or >.  

Also, reading through the ticket number patch confirms my sense that Sage version is important; looking at something that says Sage version 4.3 (!!!) is far more revealing than Trac number so and so.



---

archive/issue_comments_165599.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n+* [attachment:trac_13109_documentation.patch]\n+\n+This ticket also fixes #8073, #8546.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-14T14:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165599",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
+* [attachment:trac_13109_documentation.patch]
+
+This ticket also fixes #8073, #8546.
 
 Comment: 1
 
```




---

archive/issue_comments_165600.json:
```json
{
    "body": "<a id='comment:9'></a>The :trac: markup shows nicely in the html reference. I've opened #13116 to properly render it on the commandline.\n\nIf you record the trac number then its == and there is no question about >= or >.\n\nWe should collect deprecated ticket numbers during doctest so we can list them. Then its easy to list the deprecations sorted by age, say. But this is for another ticket.",
    "created_at": "2012-06-14T15:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165600",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>The :trac: markup shows nicely in the html reference. I've opened #13116 to properly render it on the commandline.

If you record the trac number then its == and there is no question about >= or >.

We should collect deprecated ticket numbers during doctest so we can list them. Then its easy to list the deprecations sorted by age, say. But this is for another ticket.



---

archive/issue_comments_165601.json:
```json
{
    "body": "<a id='comment:10'></a>I updated the patches to use the shorter url `http://trac.sagemath.org/<number>`, no other changes.\n\nThere is nothing different in doctesting deprecations from doctesting other stuff in the Sage library, so I'm against adding an extra section on that to the coding conventions section. Shorter is better if there is no additional information conveyed.\n\nNow would be a good time to review this ticket. It touches a lot of places and I do have better things to do than to keep the patches up-to-date for the next 6 months :-P",
    "created_at": "2012-06-15T11:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165601",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>I updated the patches to use the shorter url `http://trac.sagemath.org/<number>`, no other changes.

There is nothing different in doctesting deprecations from doctesting other stuff in the Sage library, so I'm against adding an extra section on that to the coding conventions section. Shorter is better if there is no additional information conveyed.

Now would be a good time to review this ticket. It touches a lot of places and I do have better things to do than to keep the patches up-to-date for the next 6 months :-P



---

archive/issue_comments_165602.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 vbraun]:\n> I updated the patches to use the shorter url `http://trac.sagemath.org/<number>`, no other changes.\n> \n> There is nothing different in doctesting deprecations from doctesting other stuff in the Sage library, so I'm against adding an extra section on that to the coding conventions section. Shorter is better if there is no additional information conveyed.\n\n\nSimply not true.  You have\n\n```\ndoctest:1: DeprecationWarning: \n```\nbut one needs an ellipsis, and this is standard in the tests I've seen.  Probably not always necessary, but good protocol.  \n\n```\ndoctest:...: DeprecationWarning: \n```\nIn fact, you even change this in several of the tests in your patch.  \n\nAlso, I'm wondering why the tests pass in developer/conventions.rst when you don't use the `doctest:` at all.  Is that itself completely optional?  Now I'm confused.  \n\nIn fact, even putting in a blatant error in that file doesn't cause a problem in testing.  Do these even get tested?",
    "created_at": "2012-06-15T13:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165602",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>Replying to [comment:10 vbraun]:
> I updated the patches to use the shorter url `http://trac.sagemath.org/<number>`, no other changes.
> 
> There is nothing different in doctesting deprecations from doctesting other stuff in the Sage library, so I'm against adding an extra section on that to the coding conventions section. Shorter is better if there is no additional information conveyed.


Simply not true.  You have

```
doctest:1: DeprecationWarning: 
```
but one needs an ellipsis, and this is standard in the tests I've seen.  Probably not always necessary, but good protocol.  

```
doctest:...: DeprecationWarning: 
```
In fact, you even change this in several of the tests in your patch.  

Also, I'm wondering why the tests pass in developer/conventions.rst when you don't use the `doctest:` at all.  Is that itself completely optional?  Now I'm confused.  

In fact, even putting in a blatant error in that file doesn't cause a problem in testing.  Do these even get tested?



---

archive/issue_comments_165603.json:
```json
{
    "body": "<a id='comment:12'></a>Oh, and as to reviewing this monster - I appreciate what you're saying, but actually checking that all these Trac numbers are correct is a big job all by itself.  I'm sorry that I may not be able to get to this one soon.",
    "created_at": "2012-06-15T13:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165603",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>Oh, and as to reviewing this monster - I appreciate what you're saying, but actually checking that all these Trac numbers are correct is a big job all by itself.  I'm sorry that I may not be able to get to this one soon.



---

archive/issue_comments_165604.json:
```json
{
    "body": "<a id='comment:13'></a>Although I started this with my post to sage-devel, I'm afraid that I don't have time to test it as I am rushing for a deadline and will be away for 3 weeks with little opportunity.\n\nRegarding checking all the trac numbers being correct:  I'm sure that almost all, if not all are correct, since I am sure that Volker will have done a careful job.  Hence I think that a positive review on this should *not* wait for every one to be checked.  If any are wrong, as soon as anyone notices it can be fixed in a separate follow-up.  Is that not sensible?  Certianly better than having to do it all again in a few months!",
    "created_at": "2012-06-15T13:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165604",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:13'></a>Although I started this with my post to sage-devel, I'm afraid that I don't have time to test it as I am rushing for a deadline and will be away for 3 weeks with little opportunity.

Regarding checking all the trac numbers being correct:  I'm sure that almost all, if not all are correct, since I am sure that Volker will have done a careful job.  Hence I think that a positive review on this should *not* wait for every one to be checked.  If any are wrong, as soon as anyone notices it can be fixed in a separate follow-up.  Is that not sensible?  Certianly better than having to do it all again in a few months!



---

archive/issue_comments_165605.json:
```json
{
    "body": "<a id='comment:14'></a>We should write \"Perfect is the enemy of good\" in huge letters on top of the developer guide, I think.",
    "created_at": "2012-06-15T13:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165605",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>We should write "Perfect is the enemy of good" in huge letters on top of the developer guide, I think.



---

archive/issue_comments_165606.json:
```json
{
    "body": "Removed trailing whitespace",
    "created_at": "2012-06-15T14:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165606",
    "user": "https://github.com/vbraun"
}
```

Removed trailing whitespace



---

archive/issue_comments_165607.json:
```json
{
    "body": "<a id='comment:15'></a>Attachment [trac_13109_documentation.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_documentation.patch) by @vbraun created at 2012-06-15 14:39:33\n\nHmm now the patchbot gets the order wrong.\n\nApply trac_13109_deprecation.patch, trac_13109_fix_doctests.patch, trac_13109_documentation.patch, trac_13109_ticket_numbers.patch",
    "created_at": "2012-06-15T14:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165607",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>Attachment [trac_13109_documentation.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_documentation.patch) by @vbraun created at 2012-06-15 14:39:33

Hmm now the patchbot gets the order wrong.

Apply trac_13109_deprecation.patch, trac_13109_fix_doctests.patch, trac_13109_documentation.patch, trac_13109_ticket_numbers.patch



---

archive/issue_comments_165608.json:
```json
{
    "body": "<a id='comment:16'></a>Me, too %-)\n\nApply trac_13109_deprecation.patch, trac_13109_ticket_numbers.patch, trac_13109_fix_doctests.patch, trac_13109_documentation.patch",
    "created_at": "2012-06-15T14:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165608",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>Me, too %-)

Apply trac_13109_deprecation.patch, trac_13109_ticket_numbers.patch, trac_13109_fix_doctests.patch, trac_13109_documentation.patch



---

archive/issue_comments_165609.json:
```json
{
    "body": "<a id='comment:17'></a>I am just curious why we don't use a consistent style in deprecating functions. I would prefer the following style using decorators as I like the ``@`rename_keyword` decorator. But I am not competent enough to be sure if it is technically sound or even possible to use decorators for other deprecation situations.\n\n``` \nfrom sage.misc.decorators import rename_keyword, rename_function, deprecate \n\nclass Foo(SageObject): \n\t \n    @deprecate(3333,'You can just call f() instead') \n    def terrible_idea(self): \n        return 1 \n \t \n    @rename_function(4444, bad_name)\n    def much_better_name(self): \n        return 1 \n  \n    @rename_keyword(deprecation=5555, weird_keyword='nice_keyword') \n    def f(self, nice_keyword=True): \n        return 1\n```",
    "created_at": "2012-06-27T06:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165609",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:17'></a>I am just curious why we don't use a consistent style in deprecating functions. I would prefer the following style using decorators as I like the ``@`rename_keyword` decorator. But I am not competent enough to be sure if it is technically sound or even possible to use decorators for other deprecation situations.

``` 
from sage.misc.decorators import rename_keyword, rename_function, deprecate 

class Foo(SageObject): 
	 
    @deprecate(3333,'You can just call f() instead') 
    def terrible_idea(self): 
        return 1 
 	 
    @rename_function(4444, bad_name)
    def much_better_name(self): 
        return 1 
  
    @rename_keyword(deprecation=5555, weird_keyword='nice_keyword') 
    def f(self, nice_keyword=True): 
        return 1
```



---

archive/issue_comments_165610.json:
```json
{
    "body": "<a id='comment:18'></a>You can also use the ``@`rename_keyword' decorator to give alternative spellings for keywords (e.g. British vs. American English). Its not **just** a tool to deprecate keyword options.",
    "created_at": "2012-06-27T14:17:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165610",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>You can also use the ``@`rename_keyword' decorator to give alternative spellings for keywords (e.g. British vs. American English). Its not **just** a tool to deprecate keyword options.



---

archive/issue_comments_165611.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-06-29T14:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165611",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_165612.json:
```json
{
    "body": "<a id='comment:20'></a>Attachment [trac_13109_ticket_numbers.2.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_ticket_numbers.2.patch) by @vbraun created at 2012-06-29 14:52:10\n\nApply trac_13109_deprecation.patch, trac_13109_ticket_numbers.patch, trac_13109_fix_doctests.patch, trac_13109_documentation.patch",
    "created_at": "2012-06-29T14:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165612",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:20'></a>Attachment [trac_13109_ticket_numbers.2.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_ticket_numbers.2.patch) by @vbraun created at 2012-06-29 14:52:10

Apply trac_13109_deprecation.patch, trac_13109_ticket_numbers.patch, trac_13109_fix_doctests.patch, trac_13109_documentation.patch



---

archive/issue_comments_165613.json:
```json
{
    "body": "<a id='comment:21'></a>Patches updated for sage-5.1.rc0",
    "created_at": "2012-06-29T14:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165613",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'></a>Patches updated for sage-5.1.rc0



---

archive/issue_comments_165614.json:
```json
{
    "body": "<a id='comment:22'></a>Regarding the documentation: it looks great, but I have three suggestions: first, change \"user's\" to \"users'\" in line 4 of the first paragraph. Second, make it a section instead of a subsection so it shows up in the main table of contents for the developer's guide (change the hyphens `-----` to equals signs `======`). Third, move it to the chapter on \"coding in python\": right now it's in the middle of the doctesting stuff, and the Python chapter contains information relevant to both Python and Cython (despite the chapter title -- maybe the chapter should be \"Coding in Python and Cython\" and the following one should be \"Issues specific to coding in Cython\", but anyway...). I'm attaching a version of the patch making these changes.\n\nFor the \"ticket numbers\" and \"fix doctests\" patches, I've done a bit of spot-checking, and it all looks good. The \"deprecation\" patch basically moves the deprecation code from misc.py to superseded.py, with some small modifications, right? That looks good, too. Is there any reason to do any error-checking on the trac number argument? Right now, using \n\n```python\ndef foo():\n    sage.misc.superseded.deprecation('blah', 'the function foo is deprecated.')\n```\nworks without error. (I'm fine with the current state of affairs, I'm just asking the question.)\n\nAnyway, positive review for everything except for my version of the documentation.",
    "created_at": "2012-06-29T21:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165614",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>Regarding the documentation: it looks great, but I have three suggestions: first, change "user's" to "users'" in line 4 of the first paragraph. Second, make it a section instead of a subsection so it shows up in the main table of contents for the developer's guide (change the hyphens `-----` to equals signs `======`). Third, move it to the chapter on "coding in python": right now it's in the middle of the doctesting stuff, and the Python chapter contains information relevant to both Python and Cython (despite the chapter title -- maybe the chapter should be "Coding in Python and Cython" and the following one should be "Issues specific to coding in Cython", but anyway...). I'm attaching a version of the patch making these changes.

For the "ticket numbers" and "fix doctests" patches, I've done a bit of spot-checking, and it all looks good. The "deprecation" patch basically moves the deprecation code from misc.py to superseded.py, with some small modifications, right? That looks good, too. Is there any reason to do any error-checking on the trac number argument? Right now, using 

```python
def foo():
    sage.misc.superseded.deprecation('blah', 'the function foo is deprecated.')
```
works without error. (I'm fine with the current state of affairs, I'm just asking the question.)

Anyway, positive review for everything except for my version of the documentation.



---

archive/issue_comments_165615.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n+* [attachment:trac_13109_documentation.v2.patch]\n+\n+This ticket also fixes #8073, #8546.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-29T21:50:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165615",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
+* [attachment:trac_13109_documentation.v2.patch]
+
+This ticket also fixes #8073, #8546.
 
 Comment: 1
 
```




---

archive/issue_comments_165616.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n+* [attachment:trac_13109-documentation.v2.patch]\n+\n+This ticket also fixes #8073, #8546.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-29T21:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165616",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
+* [attachment:trac_13109-documentation.v2.patch]
+
+This ticket also fixes #8073, #8546.
 
 Comment: 1
 
```




---

archive/issue_comments_165617.json:
```json
{
    "body": "<a id='comment:23'></a>Attachment [trac_13109-documentation.v2.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109-documentation.v2.patch) by @jhpalmieri created at 2012-06-29 21:51:05",
    "created_at": "2012-06-29T21:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165617",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>Attachment [trac_13109-documentation.v2.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109-documentation.v2.patch) by @jhpalmieri created at 2012-06-29 21:51:05



---

archive/issue_comments_165618.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-06-30T09:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165618",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_165619.json:
```json
{
    "body": "Attachment [trac_number_check.diff](tarball://root/attachments/some-uuid/ticket13109/trac_number_check.diff) by @vbraun created at 2012-06-30 09:50:02\n\nchange in deprecation.patch - for review purposes only",
    "created_at": "2012-06-30T09:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165619",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_number_check.diff](tarball://root/attachments/some-uuid/ticket13109/trac_number_check.diff) by @vbraun created at 2012-06-30 09:50:02

change in deprecation.patch - for review purposes only



---

archive/issue_comments_165620.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-06-30T09:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165620",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_165621.json:
```json
{
    "body": "Attachment [trac_13109-documentation.v3.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109-documentation.v3.patch) by @vbraun created at 2012-06-30 10:08:58\n\nUpdated patch",
    "created_at": "2012-06-30T10:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165621",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_13109-documentation.v3.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109-documentation.v3.patch) by @vbraun created at 2012-06-30 10:08:58

Updated patch



---

archive/issue_comments_165622.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,26 @@\n+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments\n \n+\\`\\`\\`\n+deprecation(trac_number, message) \n+\\`\\`\\`\n+where both arguments are mandatory.  Once this code is in Sage, one \n+can deduce every possible thing discussed above in this thread from \n+the trac number.   The deprecation warning can produce the URL of the \n+trac ticket. \n+\n+Analogous changes are made to \\`deprecated_function_alias\\` and \\`deprecated_callable_import\\`. Finally, the \\`\\`@\\`rename_keyword(deprecated=\"sage version string\", ...)\\` decorator is changed to\n+\n+\\`\\`\\`\n+@rename_keyword(deprecation=<trac_number>, ...)\n+\\`\\`\\`\n+\n+Apply\n+* [attachment:trac_13109_deprecation.patch]\n+* [attachment:trac_13109_ticket_numbers.patch]\n+* [attachment:trac_13109_fix_doctests.patch]\n+* [attachment:trac_13109-documentation.v3.patch]\n+\n+This ticket also fixes #8073, #8546.\n \n Comment: 1\n \n```\n",
    "created_at": "2012-06-30T10:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165622",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,26 @@
+As discussed on https://groups.google.com/d/topic/sage-devel/I12IeaFlE7g/discussion, change the deprecation function to the new arguments
 
+\`\`\`
+deprecation(trac_number, message) 
+\`\`\`
+where both arguments are mandatory.  Once this code is in Sage, one 
+can deduce every possible thing discussed above in this thread from 
+the trac number.   The deprecation warning can produce the URL of the 
+trac ticket. 
+
+Analogous changes are made to \`deprecated_function_alias\` and \`deprecated_callable_import\`. Finally, the \`\`@\`rename_keyword(deprecated="sage version string", ...)\` decorator is changed to
+
+\`\`\`
+@rename_keyword(deprecation=<trac_number>, ...)
+\`\`\`
+
+Apply
+* [attachment:trac_13109_deprecation.patch]
+* [attachment:trac_13109_ticket_numbers.patch]
+* [attachment:trac_13109_fix_doctests.patch]
+* [attachment:trac_13109-documentation.v3.patch]
+
+This ticket also fixes #8073, #8546.
 
 Comment: 1
 
```




---

archive/issue_comments_165623.json:
```json
{
    "body": "<a id='comment:24'></a>Thanks for copy-editing the developer guide section, looks great. With your patch I got a doctest failure in `coding_in_python.rst` so I combined the final example into one doctestable example. I don't understand why this wasn't doctested before, but it passes now.\n\nSince the deprecation is moved to its own module I didn't need any error checking - any old code failed with an import error. But for the future its probably good to check that the ticket number is a number. I've amended the `trac_13109_deprecation.patch` with error checking. The change is in [This is the Trac macro *attachment:trac_number_check.diff* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_number_check.diff-macro)\n\nIf you agree with these final changes then our work here will be finished ;-)\n\nPatchbot:\napply trac_13109_deprecation.patch, trac_13109_ticket_numbers.patch, trac_13109_fix_doctests.patch, trac_13109-documentation.v3.patch",
    "created_at": "2012-06-30T10:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165623",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>Thanks for copy-editing the developer guide section, looks great. With your patch I got a doctest failure in `coding_in_python.rst` so I combined the final example into one doctestable example. I don't understand why this wasn't doctested before, but it passes now.

Since the deprecation is moved to its own module I didn't need any error checking - any old code failed with an import error. But for the future its probably good to check that the ticket number is a number. I've amended the `trac_13109_deprecation.patch` with error checking. The change is in [This is the Trac macro *attachment:trac_number_check.diff* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#attachment:trac_number_check.diff-macro)

If you agree with these final changes then our work here will be finished ;-)

Patchbot:
apply trac_13109_deprecation.patch, trac_13109_ticket_numbers.patch, trac_13109_fix_doctests.patch, trac_13109-documentation.v3.patch



---

archive/issue_comments_165624.json:
```json
{
    "body": "<a id='comment:25'></a>I agree with the changes, but I'm not sure the work is finished. I just looked at the currently positively-reviewed not-yet-merged tickets, and some of them may conflict, or have errors when deprecating functions, with the patches here: #2607, #9704, #11310 (applies with fuzz 2), #11143, #12768, #12840, #13100 (applies and passes tests, but includes an invalid use of deprecation).\n\nI suggest rebasing each of those tickets on top of this one, rather than making this one depend on all of those -- if we did that, I worry that if just one of those had to be backed out, then this one would, also. I'll work on some and you can review my changes, and vice versa for the others. Sound okay? I'll start with the high numbers and work my way down.",
    "created_at": "2012-06-30T17:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165624",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>I agree with the changes, but I'm not sure the work is finished. I just looked at the currently positively-reviewed not-yet-merged tickets, and some of them may conflict, or have errors when deprecating functions, with the patches here: #2607, #9704, #11310 (applies with fuzz 2), #11143, #12768, #12840, #13100 (applies and passes tests, but includes an invalid use of deprecation).

I suggest rebasing each of those tickets on top of this one, rather than making this one depend on all of those -- if we did that, I worry that if just one of those had to be backed out, then this one would, also. I'll work on some and you can review my changes, and vice versa for the others. Sound okay? I'll start with the high numbers and work my way down.



---

archive/issue_comments_165625.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-30T17:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165625",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_165626.json:
```json
{
    "body": "<a id='comment:26'></a>OK good.",
    "created_at": "2012-06-30T18:02:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165626",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>OK good.



---

archive/issue_comments_165627.json:
```json
{
    "body": "<a id='comment:27'></a>Added dependencies - without those 5 tickets I wasn't able to apply patches to test #2607.",
    "created_at": "2012-06-30T19:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165627",
    "user": "https://trac.sagemath.org/admin/accounts/users/aginiewicz"
}
```

<a id='comment:27'></a>Added dependencies - without those 5 tickets I wasn't able to apply patches to test #2607.



---

archive/issue_comments_165628.json:
```json
{
    "body": "<a id='comment:28'></a>aginiewicz: those are all in sage-5.1.rc0",
    "created_at": "2012-06-30T19:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165628",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'></a>aginiewicz: those are all in sage-5.1.rc0



---

archive/issue_events_036063.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:28:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13109#event-36063"
}
```



---

archive/issue_events_036064.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:53:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13109#event-36064"
}
```



---

archive/issue_events_036065.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-01T18:53:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13109#event-36065"
}
```



---

archive/issue_events_036066.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-07T22:34:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13109#event-36066"
}
```



---

archive/issue_events_036067.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-07T22:34:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13109#event-36067"
}
```



---

archive/issue_comments_165629.json:
```json
{
    "body": "<a id='comment:33'></a>This needs to be rebased to sage-5.2.beta1:\n\n```\nsage -t  -force_lib devel/sage/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"/release/merger/sage-5.2.rc0/devel/sage-main/sage/graphs/generic_graph.py\", line 10906:\n    sage: (graphs.FruchtGraph()).clustering_coeff(weight=True,\n        return_vertex_weights=True)\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.2.rc0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/release/merger/sage-5.2.rc0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/release/merger/sage-5.2.rc0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_145[7]>\", line 2, in <module>\n        return_vertex_weights=True)\n      File \"/release/merger/sage-5.2.rc0/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 10933, in clustering_coeff\n        from sage.misc.misc import deprecation\n    ImportError: cannot import name deprecation\n**********************************************************************\n```",
    "created_at": "2012-07-08T08:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165629",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>This needs to be rebased to sage-5.2.beta1:

```
sage -t  -force_lib devel/sage/sage/graphs/generic_graph.py
**********************************************************************
File "/release/merger/sage-5.2.rc0/devel/sage-main/sage/graphs/generic_graph.py", line 10906:
    sage: (graphs.FruchtGraph()).clustering_coeff(weight=True,
        return_vertex_weights=True)
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.2.rc0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/release/merger/sage-5.2.rc0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/release/merger/sage-5.2.rc0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_145[7]>", line 2, in <module>
        return_vertex_weights=True)
      File "/release/merger/sage-5.2.rc0/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 10933, in clustering_coeff
        from sage.misc.misc import deprecation
    ImportError: cannot import name deprecation
**********************************************************************
```



---

archive/issue_comments_165630.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-07-08T08:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165630",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_165631.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-07-08T11:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165631",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_165632.json:
```json
{
    "body": "Attachment [trac_13109_ticket_numbers.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_ticket_numbers.patch) by @vbraun created at 2012-07-08 11:58:30\n\nUpdated patch",
    "created_at": "2012-07-08T11:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165632",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_13109_ticket_numbers.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_ticket_numbers.patch) by @vbraun created at 2012-07-08 11:58:30

Updated patch



---

archive/issue_comments_165633.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-07-08T12:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165633",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_165634.json:
```json
{
    "body": "<a id='comment:34'></a>Attachment [trac_13109_fix_doctests.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_fix_doctests.patch) by @vbraun created at 2012-07-08 12:00:04\n\nI've updated the patches to (the as of now unreleased) sage-5.2.beta1. I'm switching this back to positive review since it is a trivial rebase.",
    "created_at": "2012-07-08T12:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165634",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>Attachment [trac_13109_fix_doctests.patch](tarball://root/attachments/some-uuid/ticket13109/trac_13109_fix_doctests.patch) by @vbraun created at 2012-07-08 12:00:04

I've updated the patches to (the as of now unreleased) sage-5.2.beta1. I'm switching this back to positive review since it is a trivial rebase.



---

archive/issue_comments_165635.json:
```json
{
    "body": "<a id='comment:35'></a>Hi guys!\n\nI love this new syntax; it's a great way to point to the right piece of information! I also appreciate the tremendous work you put into recovering the ticket number for all deprecation warnings in Sage.\n\nHowever, I am deeply concerned by the fact that this patch touches so many files in Sage. It is going to create conflicts with many upcoming patches, including many in the Sage-Combinat queue. We are already having great trouble getting things in and this would waste a *lot* of good developpers time.\n\nI thus would strongly recommend, if not request, that this change be made with a transition period where including a track ticket number is  mandatory for getting new/refactored code into Sage, but where old deprecation warnings could be left as is. Anyway, those deprecation warnings are doomed to progressively disapear by themselves; is it really worth refactoring them?\n\nJohn: sorry for voicing this, ... well ... loudly, earlier today. Sorry also for not sumbling earlier on this ticket to give my view point before all the work is done.\n\nCheers,\n                 Nicolas",
    "created_at": "2012-07-13T05:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165635",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:35'></a>Hi guys!

I love this new syntax; it's a great way to point to the right piece of information! I also appreciate the tremendous work you put into recovering the ticket number for all deprecation warnings in Sage.

However, I am deeply concerned by the fact that this patch touches so many files in Sage. It is going to create conflicts with many upcoming patches, including many in the Sage-Combinat queue. We are already having great trouble getting things in and this would waste a *lot* of good developpers time.

I thus would strongly recommend, if not request, that this change be made with a transition period where including a track ticket number is  mandatory for getting new/refactored code into Sage, but where old deprecation warnings could be left as is. Anyway, those deprecation warnings are doomed to progressively disapear by themselves; is it really worth refactoring them?

John: sorry for voicing this, ... well ... loudly, earlier today. Sorry also for not sumbling earlier on this ticket to give my view point before all the work is done.

Cheers,
                 Nicolas



---

archive/issue_comments_165636.json:
```json
{
    "body": "<a id='comment:36'></a>Hi Nicolas,\n\nHow many conflicts do you actually get? The assumption is that deprecated code isn't under current development, so although we touch a lot of files we don't actually get many conflicts. \n\nMany deprecation warnings didn't even have a \"since Sage version x\" attached, so its doubtful that they will be removed over time.\n\nWe can add a stub old-style `sage.misc.misc.deprecation`, but I think that'll just delay the pain of updating the deprecations until later since nobody will be forced to switch.\n\nBest,\nVolker",
    "created_at": "2012-07-13T13:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165636",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>Hi Nicolas,

How many conflicts do you actually get? The assumption is that deprecated code isn't under current development, so although we touch a lot of files we don't actually get many conflicts. 

Many deprecation warnings didn't even have a "since Sage version x" attached, so its doubtful that they will be removed over time.

We can add a stub old-style `sage.misc.misc.deprecation`, but I think that'll just delay the pain of updating the deprecations until later since nobody will be forced to switch.

Best,
Volker



---

archive/issue_comments_165637.json:
```json
{
    "body": "<a id='comment:37'></a>A grep on the combinat queue tells me that 34 files use deprecation. Some of those don't need to be changed at all, but I would bet that at least 20 of them do.",
    "created_at": "2012-07-13T14:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165637",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:37'></a>A grep on the combinat queue tells me that 34 files use deprecation. Some of those don't need to be changed at all, but I would bet that at least 20 of them do.



---

archive/issue_comments_165638.json:
```json
{
    "body": "<a id='comment:38'></a>Should we have\n\n```\nDeprecationWarning: You are using a deprecated way to signal deprecations.\n```\n:-)",
    "created_at": "2012-07-13T14:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165638",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>Should we have

```
DeprecationWarning: You are using a deprecated way to signal deprecations.
```
:-)



---

archive/issue_comments_165639.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:38 jdemeyer]:\n> Should we have\n> \n> ```\n> DeprecationWarning: You are using a deprecated way to signal deprecations.\n> ```\n> :-)\n\n\nSee comments 1 and 2 above (and I thought that was *my* joke!)",
    "created_at": "2012-07-13T15:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165639",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:39'></a>Replying to [comment:38 jdemeyer]:
> Should we have
> 
> ```
> DeprecationWarning: You are using a deprecated way to signal deprecations.
> ```
> :-)


See comments 1 and 2 above (and I thought that was *my* joke!)



---

archive/issue_comments_165640.json:
```json
{
    "body": "<a id='comment:40'></a>I propose that we deprecate all self-referential deprecation jokes.",
    "created_at": "2012-07-13T15:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165640",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:40'></a>I propose that we deprecate all self-referential deprecation jokes.



---

archive/issue_comments_165641.json:
```json
{
    "body": "<a id='comment:41'></a>> I propose that we deprecate all self-referential deprecation jokes.\n\nNever!",
    "created_at": "2012-07-14T00:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165641",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:41'></a>> I propose that we deprecate all self-referential deprecation jokes.

Never!



---

archive/issue_comments_165642.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-07-16T16:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13109#issuecomment-165642",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_036068.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-16T16:40:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13109",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13109#event-36068"
}
```
