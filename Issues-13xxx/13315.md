# Issue 13315: Clean up MANIFEST.in, spkg-delauto and spkg-dist

archive/issues_013143.json:
```json
{
    "body": "There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.\n\n**Apply** [attachment:13315_manifest.patch]\n\n**Reviewer:** John Palmieri\n\n**Author:** Jeroen Demeyer\n\n**Merged:** sage-5.3.beta1\n\nIssue created by migration from https://trac.sagemath.org/ticket/13315\n\n",
    "closed_at": "2012-08-12T19:01:42Z",
    "created_at": "2012-07-31T17:42:06Z",
    "labels": [
        "component: distribution",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.3",
    "title": "Clean up MANIFEST.in, spkg-delauto and spkg-dist",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13315",
    "user": "https://github.com/jdemeyer"
}
```
There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.

**Apply** [attachment:13315_manifest.patch]

**Reviewer:** John Palmieri

**Author:** Jeroen Demeyer

**Merged:** sage-5.3.beta1

Issue created by migration from https://trac.sagemath.org/ticket/13315





---

archive/issue_comments_191754.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-There are some obvious improvement and simplifications to be done to `devel/sage/MANIFEST.in`.\n+There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in`.\n``````\n",
    "created_at": "2012-07-31T17:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191754",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-There are some obvious improvement and simplifications to be done to `devel/sage/MANIFEST.in`.
+There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in`.
``````




---

archive/issue_comments_191755.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in`.\n+There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.\n``````\n",
    "created_at": "2012-07-31T19:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191755",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in`.
+There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.
``````




---

archive/issue_events_042479.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "rename": {
        "from": "Clean up devel/sage/MANIFEST.in",
        "to": "Clean up devel/sage/MANIFEST.in and spkg-dist"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13315#event-42479"
}
```



---

archive/issue_comments_191756.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.\n+\n+**Apply** [http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch](http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch) (for totally unknown reasons, this file can't be uploaded to Trac).\n``````\n",
    "created_at": "2012-07-31T21:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191756",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.
+
+**Apply** [http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch](http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch) (for totally unknown reasons, this file can't be uploaded to Trac).
``````




---

archive/issue_comments_191757.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.\n \n-**Apply** [http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch](http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch) (for totally unknown reasons, this file can't be uploaded to Trac).\n+**Apply** [attachment:13315_manifest.patch] and [attachment:13315_dist_delauto.patch]\n``````\n",
    "created_at": "2012-07-31T21:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191757",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.
 
-**Apply** [http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch](http://boxen.math.washington.edu/home/jdemeyer/patches/13315_manifest.patch) (for totally unknown reasons, this file can't be uploaded to Trac).
+**Apply** [attachment:13315_manifest.patch] and [attachment:13315_dist_delauto.patch]
``````




---

archive/issue_comments_191758.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-07-31T21:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191758",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_042480.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "rename": {
        "from": "Clean up devel/sage/MANIFEST.in and spkg-dist",
        "to": "Clean up MANIFEST.in, spkg-delauto and spkg-dist"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13315#event-42480"
}
```



---

archive/issue_comments_191759.json:
```json
{
    "body": "<a id='comment:6'></a>\nI tested this patch by creating a new sdist (starting from sage-5.2), and these are the only differences in files being added or not (this is the diff of `ls -a1RF` output):\n\n```diff\n--- sage-5.2.ls 2012-08-01 18:31:34.000000000 +0200\n+++ sage-5.2.trac13315.ls       2012-08-01 18:31:39.000000000 +0200\n@@ -30,6 +30,7 @@\n branch\n branch.cache\n branchheads.cache\n+cache/\n dirstate\n hgrc\n last-message.txt\n@@ -41,6 +42,12 @@\n undo.desc\n undo.dirstate\n\n+./.hg/cache:\n+./\n+../\n+branchheads\n+tags\n+\n ./.hg/store:\n ./\n ../\n@@ -49,6 +56,10 @@\n 00manifest.d\n 00manifest.i\n data/\n+fncache\n+phaseroots\n+undo\n+undo.phaseroots\n\n ./.hg/store/data:\n ./\n@@ -5178,7 +5189,6 @@\n ./c_lib:\n ./\n ../\n-.sconsign.dblite\n SConstruct\n include/\n src/\n```",
    "created_at": "2012-08-01T16:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191759",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
I tested this patch by creating a new sdist (starting from sage-5.2), and these are the only differences in files being added or not (this is the diff of `ls -a1RF` output):

```diff
--- sage-5.2.ls 2012-08-01 18:31:34.000000000 +0200
+++ sage-5.2.trac13315.ls       2012-08-01 18:31:39.000000000 +0200
@@ -30,6 +30,7 @@
 branch
 branch.cache
 branchheads.cache
+cache/
 dirstate
 hgrc
 last-message.txt
@@ -41,6 +42,12 @@
 undo.desc
 undo.dirstate

+./.hg/cache:
+./
+../
+branchheads
+tags
+
 ./.hg/store:
 ./
 ../
@@ -49,6 +56,10 @@
 00manifest.d
 00manifest.i
 data/
+fncache
+phaseroots
+undo
+undo.phaseroots

 ./.hg/store/data:
 ./
@@ -5178,7 +5189,6 @@
 ./c_lib:
 ./
 ../
-.sconsign.dblite
 SConstruct
 include/
 src/
```



---

archive/issue_comments_191760.json:
```json
{
    "body": "<a id='comment:7'></a>\nAt first glance this seems okay to me. But why not more clean up, for example\n\n```diff\ndiff --git a/MANIFEST.in b/MANIFEST.in\n--- a/MANIFEST.in\n+++ b/MANIFEST.in\n@@ -1,30 +1,23 @@\n-recursive-include * *.c *.cc *.cpp *.h *.hh *.hpp *.pyx *.pxd *.pxi *.txt *.tex\n-recursive-include doc *.rst *.py *.inc\n+global-include *.c *.cc *.cpp *.h *.hh *.hpp *.py  *.pyx *.pxd *.pxi *.txt *.tex\n+recursive-include doc *.rst *.inc\n graft .hg\n include .hgignore .hgtags\n include MANIFEST.in\n include bundle export install pull sage-push\n-include module_list.py\n-include fpickle_setup.py\n include spkg-delauto spkg-dist spkg-install\n include c_lib/SConstruct\n include sage/ext/mac-app/README\n include sage/graphs/graph_decompositions/rankwidth_c/README\n-include sage/libs/gmp/__init__.py\n-include sage/libs/polybori/__init__.py\n-include sage/numerical/test.py\n-include sage/rings/polynomial/padics/__init__.py\n include sage/schemes/hyperelliptic_curves/hypellfrob/README\n-include sage/server/notebook/templates/*\n-include sage/server/notebook/templates/css/*\n-include sage/server/notebook/templates/notebook/*\n-include sage/server/notebook/templates/worksheet/*\n include sage/tests/french_book/README\n+graft sage/server/notebook/templates\n+graft sage/server/notebook/templates/css\n+graft sage/server/notebook/templates/notebook\n+graft sage/server/notebook/templates/worksheet\n include doc/common/python.inv\n include doc/common/update-python-inv.sh\n include doc/en/introspect/static/empty\n include doc/en/introspect/templates/layout.html\n-include doc/en/numerical_sage/errors\n include doc/en/website/static/pdf.png\n include doc/en/website/templates/index.html\n include doc/en/a_tour_of_sage/eigen_plot.png\n```\n(Why do we include `doc/en/numerical_sage/errors`? Why don't we include all `*.py` files?)",
    "created_at": "2012-08-02T03:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191760",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
At first glance this seems okay to me. But why not more clean up, for example

```diff
diff --git a/MANIFEST.in b/MANIFEST.in
--- a/MANIFEST.in
+++ b/MANIFEST.in
@@ -1,30 +1,23 @@
-recursive-include * *.c *.cc *.cpp *.h *.hh *.hpp *.pyx *.pxd *.pxi *.txt *.tex
-recursive-include doc *.rst *.py *.inc
+global-include *.c *.cc *.cpp *.h *.hh *.hpp *.py  *.pyx *.pxd *.pxi *.txt *.tex
+recursive-include doc *.rst *.inc
 graft .hg
 include .hgignore .hgtags
 include MANIFEST.in
 include bundle export install pull sage-push
-include module_list.py
-include fpickle_setup.py
 include spkg-delauto spkg-dist spkg-install
 include c_lib/SConstruct
 include sage/ext/mac-app/README
 include sage/graphs/graph_decompositions/rankwidth_c/README
-include sage/libs/gmp/__init__.py
-include sage/libs/polybori/__init__.py
-include sage/numerical/test.py
-include sage/rings/polynomial/padics/__init__.py
 include sage/schemes/hyperelliptic_curves/hypellfrob/README
-include sage/server/notebook/templates/*
-include sage/server/notebook/templates/css/*
-include sage/server/notebook/templates/notebook/*
-include sage/server/notebook/templates/worksheet/*
 include sage/tests/french_book/README
+graft sage/server/notebook/templates
+graft sage/server/notebook/templates/css
+graft sage/server/notebook/templates/notebook
+graft sage/server/notebook/templates/worksheet
 include doc/common/python.inv
 include doc/common/update-python-inv.sh
 include doc/en/introspect/static/empty
 include doc/en/introspect/templates/layout.html
-include doc/en/numerical_sage/errors
 include doc/en/website/static/pdf.png
 include doc/en/website/templates/index.html
 include doc/en/a_tour_of_sage/eigen_plot.png
```
(Why do we include `doc/en/numerical_sage/errors`? Why don't we include all `*.py` files?)



---

archive/issue_comments_191761.json:
```json
{
    "body": "<a id='comment:8'></a>\nAlso, regarding line 22 of spkg-dist:\n\n```\n\tcp -pR .hg* doc sage c_lib tmp/\n```\ncopying the entire doc directory can take a while, since we're copying all of the output. Would it be better to copy `doc/common` and `doc/[a-z][a-z]`?",
    "created_at": "2012-08-02T03:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191761",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Also, regarding line 22 of spkg-dist:

```
	cp -pR .hg* doc sage c_lib tmp/
```
copying the entire doc directory can take a while, since we're copying all of the output. Would it be better to copy `doc/common` and `doc/[a-z][a-z]`?



---

archive/issue_comments_191762.json:
```json
{
    "body": "<a id='comment:9'></a>\nGood points.",
    "created_at": "2012-08-02T06:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191762",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Good points.



---

archive/issue_comments_191763.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2012-08-02T06:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191763",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_191764.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2012-08-02T07:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191764",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_191765.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.\n \n-**Apply** [attachment:13315_manifest.patch] and [attachment:13315_dist_delauto.patch]\n+**Apply** [attachment:13315_manifest.patch]\n``````\n",
    "created_at": "2012-08-02T07:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191765",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 There are some obvious improvements and simplifications to be done to `devel/sage/MANIFEST.in` and `devel/sage/spkg-dist`.
 
-**Apply** [attachment:13315_manifest.patch] and [attachment:13315_dist_delauto.patch]
+**Apply** [attachment:13315_manifest.patch]
``````




---

archive/issue_comments_191766.json:
```json
{
    "body": "<a id='comment:11'></a>\nIn line 1 of MANIFEST.in, should we replace `recursive-include * ...` with `global-include ...`? Then I think we can delete line 8 (`include fpickle_setup.py module_list.py`). In my testing, the results are the same with these changes.",
    "created_at": "2012-08-03T03:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191766",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
In line 1 of MANIFEST.in, should we replace `recursive-include * ...` with `global-include ...`? Then I think we can delete line 8 (`include fpickle_setup.py module_list.py`). In my testing, the results are the same with these changes.



---

archive/issue_comments_191767.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2012-08-03T07:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191767",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_191768.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2012-08-03T11:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191768",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_work to needs_review.



---

archive/attachments_018029.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "13315_manifest.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13315/13315_manifest.patch",
    "created_at": "2012-08-03T11:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_191769.json:
```json
{
    "body": "<a id='comment:13'></a>\n",
    "created_at": "2012-08-03T11:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191769",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>




---

archive/issue_comments_191770.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2012-08-03T16:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191770",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_comments_191771.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2012-08-03T16:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191771",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_191772.json:
```json
{
    "body": "<a id='comment:14'></a>\nOkay, this looks good to me.",
    "created_at": "2012-08-03T16:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191772",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
Okay, this looks good to me.



---

archive/issue_comments_191773.json:
```json
{
    "body": "**Merged:** sage-5.3.beta1",
    "created_at": "2012-08-12T19:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13315#issuecomment-191773",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.3.beta1



---

archive/issue_events_042481.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-12T19:01:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13315",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13315#event-42481"
}
```
