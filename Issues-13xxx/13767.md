# Issue 13767: upgrade boost to version 1.52.0

archive/issues_013563.json:
```json
{
    "body": "There was a discussion on sage-devel a while ago about including the Boost headers [1]. As noted there, the latest version of the optional spkg `polymake` doesn't compile with the current boost package. The current boost package is called `boost-cropped` because it contains only a subset of the boost headers, because of package size.\n\nThis new package is contains *all* headers, which is still only a subset of the upstream tarball. The total packaged size is ~ 5M, which feels reasonable to me.\n\nI've checked that the current version `polybori-0.8.2` and the current upstream version `polymake-2.12-rc3` both compile under Sage with these headers. I'm also submitting an spkg for polymake in another ticket.\n\n[1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion\n\n* Apply [attachment:trac-13767-sage_root-upgrade-to-boost-1.52.0.patch] to the root repo.\n* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg\n* Apply [attachment:0001-Update-doctests-for-polybori-that-rely-on-randomness.patch] to the sage-main repo.\n\nAssignee: tbd\n\nCC:  jpflori\n\nReviewer: Volker Braun, Fran\u00e7ois Bissey, Alexander Dreyer\n\nAuthor: Timo Kluck\n\nMerged: sage-5.8.beta3\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13767\n\n",
    "closed_at": "2013-03-05T11:00:12Z",
    "created_at": "2012-11-28T02:00:00Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "upgrade boost to version 1.52.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13767",
    "user": "https://github.com/tkluck"
}
```
There was a discussion on sage-devel a while ago about including the Boost headers [1]. As noted there, the latest version of the optional spkg `polymake` doesn't compile with the current boost package. The current boost package is called `boost-cropped` because it contains only a subset of the boost headers, because of package size.

This new package is contains *all* headers, which is still only a subset of the upstream tarball. The total packaged size is ~ 5M, which feels reasonable to me.

I've checked that the current version `polybori-0.8.2` and the current upstream version `polymake-2.12-rc3` both compile under Sage with these headers. I'm also submitting an spkg for polymake in another ticket.

[1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion

* Apply [attachment:trac-13767-sage_root-upgrade-to-boost-1.52.0.patch] to the root repo.
* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg
* Apply [attachment:0001-Update-doctests-for-polybori-that-rely-on-randomness.patch] to the sage-main repo.

Assignee: tbd

CC:  jpflori

Reviewer: Volker Braun, Fran√ßois Bissey, Alexander Dreyer

Author: Timo Kluck

Merged: sage-5.8.beta3

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13767





---

archive/issue_comments_178598.json:
```json
{
    "body": "<a id='comment:1'></a>Because of the file size limit on trac attachment, I've put it here:\n\nhttp://www.infty.nl/misc/boost-cropped-1.52.0.spkg",
    "created_at": "2012-11-28T02:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178598",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:1'></a>Because of the file size limit on trac attachment, I've put it here:

http://www.infty.nl/misc/boost-cropped-1.52.0.spkg



---

archive/issue_comments_178599.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-11-28T02:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178599",
    "user": "https://github.com/tkluck"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_178600.json:
```json
{
    "body": "<a id='comment:3'></a>The deleted patch is still in the repo:\n\n```\n[vbraun@laptop boost-cropped-1.52.0]$ hg st\n! patches/boost-1.34.1-gcc-4.4.0-fixes.patch\n```\nAlso, I take it the following in SPKG.txt is no longer true?\n\n```\nMerged against policy a patch that makes boost build with gcc 4.4.0. Will be obsoleted by an updated boost shortly.\n```",
    "created_at": "2013-02-24T03:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178600",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>The deleted patch is still in the repo:

```
[vbraun@laptop boost-cropped-1.52.0]$ hg st
! patches/boost-1.34.1-gcc-4.4.0-fixes.patch
```
Also, I take it the following in SPKG.txt is no longer true?

```
Merged against policy a patch that makes boost build with gcc 4.4.0. Will be obsoleted by an updated boost shortly.
```



---

archive/issue_comments_178601.json:
```json
{
    "body": "<a id='comment:4'></a>Thanks for reviewing. I've removed that line from SKPG.txt, and committed my changes into the hg repo. I also renamed the package to boost_cropped (underscore instead of dash) to conform to the name-version scheme.\n\nThe current version is here:\n\nhttp://www.infty.nl/misc/boost_cropped-1.52.0.spkg",
    "created_at": "2013-02-25T11:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178601",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:4'></a>Thanks for reviewing. I've removed that line from SKPG.txt, and committed my changes into the hg repo. I also renamed the package to boost_cropped (underscore instead of dash) to conform to the name-version scheme.

The current version is here:

http://www.infty.nl/misc/boost_cropped-1.52.0.spkg



---

archive/issue_comments_178602.json:
```json
{
    "body": "<a id='comment:5'></a>I just uploaded a slightly newer version (md5sum d897d8e152623fab9f9c866ce184b501) that fixes a bash escaping error in spkg-install that I happened to notice.",
    "created_at": "2013-02-25T11:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178602",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:5'></a>I just uploaded a slightly newer version (md5sum d897d8e152623fab9f9c866ce184b501) that fixes a bash escaping error in spkg-install that I happened to notice.



---

archive/issue_comments_178603.json:
```json
{
    "body": "<a id='comment:6'></a>+1 for underscore but don't we have to patch those as well?\n\n```\n[vbraun@laptop Sage]$ egrep boost-cropp sage/spkg/*\nsage/spkg/install:BOOST_CROPPED=`newest_version boost-cropped`\nsage/spkg/Makefile:BOOST_CROPPED=boost-cropped-1.34.1\n```",
    "created_at": "2013-02-25T19:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178603",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'></a>+1 for underscore but don't we have to patch those as well?

```
[vbraun@laptop Sage]$ egrep boost-cropp sage/spkg/*
sage/spkg/install:BOOST_CROPPED=`newest_version boost-cropped`
sage/spkg/Makefile:BOOST_CROPPED=boost-cropped-1.34.1
```



---

archive/issue_comments_178604.json:
```json
{
    "body": "<a id='comment:7'></a>I attached a patch doing just that. I don't know how to instruct the patchbot to apply this to sage_root, and it wouldn't work anyway since it needs the new spkg. Let me know if I can do anything more, though.\n\nNote that the file spkg/Makefile is automatically generated, so I didn't patch it.",
    "created_at": "2013-02-25T19:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178604",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:7'></a>I attached a patch doing just that. I don't know how to instruct the patchbot to apply this to sage_root, and it wouldn't work anyway since it needs the new spkg. Let me know if I can do anything more, though.

Note that the file spkg/Makefile is automatically generated, so I didn't patch it.



---

archive/issue_comments_178605.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -6,6 +6,9 @@\n \n [1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion\n \n+* Apply trac-13767-sage_root-upgrade-to-boost-1.52.0.patch to the root repo.\n+* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg\n+\n Author: Timo Kluck\n \n Comment: 1\n```\n",
    "created_at": "2013-02-25T21:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178605",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -6,6 +6,9 @@
 
 [1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion
 
+* Apply trac-13767-sage_root-upgrade-to-boost-1.52.0.patch to the root repo.
+* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg
+
 Author: Timo Kluck
 
 Comment: 1
```




---

archive/issue_comments_178606.json:
```json
{
    "body": "<a id='comment:9'></a>Looks good to me",
    "created_at": "2013-02-25T21:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178606",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>Looks good to me



---

archive/issue_comments_178607.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-25T21:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178607",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_178608.json:
```json
{
    "body": "<a id='comment:10'></a>Dumb question:  Will the change in package name (though salutary) affect upgrading?  (I.e., would we need a build patch for that?)\n\nCC:ing JP in case this might help any Cygwin woes with not having certain function (along the lines of what cephes was supposed to accomplish, but wasn't accomplishing since it wasn't installed...), though looks like he's gotten most of them ironed out :)",
    "created_at": "2013-02-26T16:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178608",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>Dumb question:  Will the change in package name (though salutary) affect upgrading?  (I.e., would we need a build patch for that?)

CC:ing JP in case this might help any Cygwin woes with not having certain function (along the lines of what cephes was supposed to accomplish, but wasn't accomplishing since it wasn't installed...), though looks like he's gotten most of them ironed out :)



---

archive/issue_comments_178609.json:
```json
{
    "body": "<a id='comment:11'></a>In `SPKG.txt`, replace\n\n```\n### boost-cropped-1.52.0 (Timo Kluck, November 28, 2012)\n```\nby\n\n```\n### boost_cropped-1.52.0 (Timo Kluck, November 28, 2012)\n```",
    "created_at": "2013-02-26T21:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178609",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>In `SPKG.txt`, replace

```
### boost-cropped-1.52.0 (Timo Kluck, November 28, 2012)
```
by

```
### boost_cropped-1.52.0 (Timo Kluck, November 28, 2012)
```



---

archive/issue_comments_178610.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+There was a discussion on sage-devel a while ago about including the Boost headers [1]. As noted there, the latest version of the optional spkg `polymake` doesn't compile with the current boost package. The current boost package is called `boost-cropped` because it contains only a subset of the boost headers, because of package size.\n \n+This new package is contains *all* headers, which is still only a subset of the upstream tarball. The total packaged size is ~ 5M, which feels reasonable to me.\n+\n+I've checked that the current version `polybori-0.8.2` and the current upstream version `polymake-2.12-rc3` both compile under Sage with these headers. I'm also submitting an spkg for polymake in another ticket.\n+\n+[1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion\n+\n+* Apply [attachment:trac-13767-sage_root-upgrade-to-boost-1.52.0.patch] to the root repo.\n+* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg\n \n Author: Timo Kluck\n \n```\n",
    "created_at": "2013-02-26T21:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178610",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,13 @@
+There was a discussion on sage-devel a while ago about including the Boost headers [1]. As noted there, the latest version of the optional spkg `polymake` doesn't compile with the current boost package. The current boost package is called `boost-cropped` because it contains only a subset of the boost headers, because of package size.
 
+This new package is contains *all* headers, which is still only a subset of the upstream tarball. The total packaged size is ~ 5M, which feels reasonable to me.
+
+I've checked that the current version `polybori-0.8.2` and the current upstream version `polymake-2.12-rc3` both compile under Sage with these headers. I'm also submitting an spkg for polymake in another ticket.
+
+[1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion
+
+* Apply [attachment:trac-13767-sage_root-upgrade-to-boost-1.52.0.patch] to the root repo.
+* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg
 
 Author: Timo Kluck
 
```




---

archive/issue_comments_178611.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 kcrisman]:\n> Dumb question:  Will the change in package name (though salutary) affect upgrading?\n\nYes.\n\n> (I.e., would we need a build patch for that?)\n\nYes, but there is such a patch.",
    "created_at": "2013-02-26T21:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178611",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:10 kcrisman]:
> Dumb question:  Will the change in package name (though salutary) affect upgrading?

Yes.

> (I.e., would we need a build patch for that?)

Yes, but there is such a patch.



---

archive/issue_comments_178612.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 jdemeyer]:\n> In `SPKG.txt`, replace\n> \n> ```\n> === boost-cropped-1.52.0 (Timo Kluck, November 28, 2012) ===\n> ```\n> by\n> \n> ```\n> === boost_cropped-1.52.0 (Timo Kluck, November 28, 2012) ===\n> ```\n\nDone and set the date to today. I uploaded a new version (md5sum 2e12e082e9db4e908d0796246d0af351).",
    "created_at": "2013-02-26T22:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178612",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:13'></a>Replying to [comment:11 jdemeyer]:
> In `SPKG.txt`, replace
> 
> ```
> === boost-cropped-1.52.0 (Timo Kluck, November 28, 2012) ===
> ```
> by
> 
> ```
> === boost_cropped-1.52.0 (Timo Kluck, November 28, 2012) ===
> ```

Done and set the date to today. I uploaded a new version (md5sum 2e12e082e9db4e908d0796246d0af351).



---

archive/issue_comments_178613.json:
```json
{
    "body": "<a id='comment:14'></a>> > (I.e., would we need a build patch for that?)\n\n> Yes, but there is such a patch.\nOk, I see that now.  I will trust you that it will perform appropriately :)",
    "created_at": "2013-02-26T22:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178613",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'></a>> > (I.e., would we need a build patch for that?)

> Yes, but there is such a patch.
Ok, I see that now.  I will trust you that it will perform appropriately :)



---

archive/issue_comments_178614.json:
```json
{
    "body": "<a id='comment:15'></a>Could this have caused\n\n```\nsage -t  --long -force_lib devel/sage/sage/rings/polynomial/pbori.pyx\n**********************************************************************\nFile \"/release/merger/sage-5.8.beta2/devel/sage-main/sage/rings/polynomial/pbori.pyx\", line 7868:\n    sage: random_set((a*b*c*d).lm(),2)\nExpected:\n    {{b,c}, {b}}\nGot:\n    {{b}, {c}}\n**********************************************************************\n[...more like this...]\n```",
    "created_at": "2013-02-27T12:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178614",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>Could this have caused

```
sage -t  --long -force_lib devel/sage/sage/rings/polynomial/pbori.pyx
**********************************************************************
File "/release/merger/sage-5.8.beta2/devel/sage-main/sage/rings/polynomial/pbori.pyx", line 7868:
    sage: random_set((a*b*c*d).lm(),2)
Expected:
    {{b,c}, {b}}
Got:
    {{b}, {c}}
**********************************************************************
[...more like this...]
```



---

archive/issue_comments_178615.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-02-27T12:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178615",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_178616.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 jdemeyer]:\n> Could this have caused\n> \n> ```\n> sage -t  --long -force_lib devel/sage/sage/rings/polynomial/pbori.pyx\n> **********************************************************************\n> File \"/release/merger/sage-5.8.beta2/devel/sage-main/sage/rings/polynomial/pbori.pyx\", line 7868:\n>     sage: random_set((a*b*c*d).lm(),2)\n> Expected:\n>     {{b,c}, {b}}\n> Got:\n>     {{b}, {c}}\n> **********************************************************************\n> [...more like this...]\n> ```\n\n\nYes, I'm pretty sure it has: I can reproduce this issue on my stock 5.5 installation with upgraded boost and recompiled polybori.\n\nThe reason is possibly that polybori probably relies on `Boost.Random` for its randomness. Since we're doing a rather large update 1.34 - > 1.52, it's quite possible that the implementation has changed sufficiently to obtain different random values even with the same seed.\n\nI would be inclined to just update the doctests, since these are inherently random results. But I would prefer to first hear the opinion of someone who actually uses polybori.",
    "created_at": "2013-02-27T15:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178616",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:16'></a>Replying to [comment:15 jdemeyer]:
> Could this have caused
> 
> ```
> sage -t  --long -force_lib devel/sage/sage/rings/polynomial/pbori.pyx
> **********************************************************************
> File "/release/merger/sage-5.8.beta2/devel/sage-main/sage/rings/polynomial/pbori.pyx", line 7868:
>     sage: random_set((a*b*c*d).lm(),2)
> Expected:
>     {{b,c}, {b}}
> Got:
>     {{b}, {c}}
> **********************************************************************
> [...more like this...]
> ```


Yes, I'm pretty sure it has: I can reproduce this issue on my stock 5.5 installation with upgraded boost and recompiled polybori.

The reason is possibly that polybori probably relies on `Boost.Random` for its randomness. Since we're doing a rather large update 1.34 - > 1.52, it's quite possible that the implementation has changed sufficiently to obtain different random values even with the same seed.

I would be inclined to just update the doctests, since these are inherently random results. But I would prefer to first hear the opinion of someone who actually uses polybori.



---

archive/issue_comments_178617.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+There was a discussion on sage-devel a while ago about including the Boost headers [1]. As noted there, the latest version of the optional spkg `polymake` doesn't compile with the current boost package. The current boost package is called `boost-cropped` because it contains only a subset of the boost headers, because of package size.\n \n+This new package is contains *all* headers, which is still only a subset of the upstream tarball. The total packaged size is ~ 5M, which feels reasonable to me.\n+\n+I've checked that the current version `polybori-0.8.2` and the current upstream version `polymake-2.12-rc3` both compile under Sage with these headers. I'm also submitting an spkg for polymake in another ticket.\n+\n+[1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion\n+\n+* Apply [attachment:trac-13767-sage_root-upgrade-to-boost-1.52.0.patch] to the root repo.\n+* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg\n+* Apply [attachment:0001-Update-doctests-for-polybori-that-rely-on-randomness.patch] to the sage-main repo.\n \n Author: Timo Kluck\n \n```\n",
    "created_at": "2013-02-27T16:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178617",
    "user": "https://github.com/tkluck"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,14 @@
+There was a discussion on sage-devel a while ago about including the Boost headers [1]. As noted there, the latest version of the optional spkg `polymake` doesn't compile with the current boost package. The current boost package is called `boost-cropped` because it contains only a subset of the boost headers, because of package size.
 
+This new package is contains *all* headers, which is still only a subset of the upstream tarball. The total packaged size is ~ 5M, which feels reasonable to me.
+
+I've checked that the current version `polybori-0.8.2` and the current upstream version `polymake-2.12-rc3` both compile under Sage with these headers. I'm also submitting an spkg for polymake in another ticket.
+
+[1] https://groups.google.com/d/topic/sage-devel/fcxNrQqVSz0/discussion
+
+* Apply [attachment:trac-13767-sage_root-upgrade-to-boost-1.52.0.patch] to the root repo.
+* Replace boost-cropped spkg with http://www.infty.nl/misc/boost_cropped-1.52.0.spkg
+* Apply [attachment:0001-Update-doctests-for-polybori-that-rely-on-randomness.patch] to the sage-main repo.
 
 Author: Timo Kluck
 
```




---

archive/issue_comments_178618.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-27T16:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178618",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_178619.json:
```json
{
    "body": "<a id='comment:18'></a>I approve the patch for the polybori tests. I have seen exactly this output in sage-on-gentoo for the last few months. I have it documented at least as far back as the time of sage-5.4.",
    "created_at": "2013-02-28T02:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178619",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:18'></a>I approve the patch for the polybori tests. I have seen exactly this output in sage-on-gentoo for the last few months. I have it documented at least as far back as the time of sage-5.4.



---

archive/issue_comments_178620.json:
```json
{
    "body": "<a id='comment:19'></a>These random ;-) changes in `PolyBoRi`'s random functions won't cause any problems.\n\nBut maybe we should just ignore the doctest results and add additional tests for the following assumed properties `result =  random_set(monomial, n)` should obey\n`len(result) == n` and `result.diff(monomial.divisors()).empty()` .",
    "created_at": "2013-02-28T08:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178620",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:19'></a>These random ;-) changes in `PolyBoRi`'s random functions won't cause any problems.

But maybe we should just ignore the doctest results and add additional tests for the following assumed properties `result =  random_set(monomial, n)` should obey
`len(result) == n` and `result.diff(monomial.divisors()).empty()` .



---

archive/issue_comments_178621.json:
```json
{
    "body": "<a id='comment:20'></a>Edited: it should read `len(result) == n`.",
    "created_at": "2013-02-28T09:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178621",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:20'></a>Edited: it should read `len(result) == n`.



---

archive/issue_comments_178622.json:
```json
{
    "body": "<a id='comment:21'></a>Anyway, if we need a quick fix: I can also give a positive review. The more generic test would then be a new ticket.",
    "created_at": "2013-02-28T09:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178622",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:21'></a>Anyway, if we need a quick fix: I can also give a positive review. The more generic test would then be a new ticket.



---

archive/issue_comments_178623.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:21 AlexanderDreyer]:\n> Anyway, if we need a quick fix: I can also give a positive review. The more generic test would then be a new ticket.\n\n\nThat would be great; the polymake upgrade also depends on this ticket, so it would be great to just get it in.",
    "created_at": "2013-02-28T10:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178623",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:22'></a>Replying to [comment:21 AlexanderDreyer]:
> Anyway, if we need a quick fix: I can also give a positive review. The more generic test would then be a new ticket.


That would be great; the polymake upgrade also depends on this ticket, so it would be great to just get it in.



---

archive/issue_comments_178624.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-28T10:39:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178624",
    "user": "https://github.com/alexanderdreyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_178625.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 tkluck]:\n> That would be great; the polymake upgrade also depends on this ticket, so it would be great to just get it in.\n\nAllright then. Please set up the other ticket when there is time and CC me there.\n\nJust out of curiosity: how is the polymake ticket related to `PolyBoRi`?",
    "created_at": "2013-02-28T10:39:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178625",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:23'></a>Replying to [comment:22 tkluck]:
> That would be great; the polymake upgrade also depends on this ticket, so it would be great to just get it in.

Allright then. Please set up the other ticket when there is time and CC me there.

Just out of curiosity: how is the polymake ticket related to `PolyBoRi`?



---

archive/issue_comments_178626.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-02-28T10:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178626",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_178627.json:
```json
{
    "body": "<a id='comment:24'></a>Could you make `SPKG.txt` world-readable inside the spkg:\n\n```\n1435597707    4 -rw-------   1 jdemeyer jdemeyer     1406 Feb 26 22:22 ./SPKG.txt\n```",
    "created_at": "2013-02-28T10:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178627",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>Could you make `SPKG.txt` world-readable inside the spkg:

```
1435597707    4 -rw-------   1 jdemeyer jdemeyer     1406 Feb 26 22:22 ./SPKG.txt
```



---

archive/issue_comments_178628.json:
```json
{
    "body": "<a id='comment:25'></a>Also: the two patches are not proper Mercurial changesets (they lack a header). You should generate patches using `hg export tip` (see [http://sagemath.org/doc/developer/walk_through.html#creating-a-change](http://sagemath.org/doc/developer/walk_through.html#creating-a-change) or [http://sagemath.org/doc/developer/walk_through.html#creating-your-own-patch-with-queues](http://sagemath.org/doc/developer/walk_through.html#creating-your-own-patch-with-queues))",
    "created_at": "2013-02-28T11:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178628",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Also: the two patches are not proper Mercurial changesets (they lack a header). You should generate patches using `hg export tip` (see [http://sagemath.org/doc/developer/walk_through.html#creating-a-change](http://sagemath.org/doc/developer/walk_through.html#creating-a-change) or [http://sagemath.org/doc/developer/walk_through.html#creating-your-own-patch-with-queues](http://sagemath.org/doc/developer/walk_through.html#creating-your-own-patch-with-queues))



---

archive/issue_comments_178629.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:23 AlexanderDreyer]:\n> > That would be great; the polymake upgrade also depends on this ticket, so it would be great to just get it in.\n\n> Just out of curiosity: how is the polymake ticket related to `PolyBoRi`?\nThis is not a polybori ticket, but a boost ticket :-)",
    "created_at": "2013-02-28T13:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178629",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:26'></a>Replying to [comment:23 AlexanderDreyer]:
> > That would be great; the polymake upgrade also depends on this ticket, so it would be great to just get it in.

> Just out of curiosity: how is the polymake ticket related to `PolyBoRi`?
This is not a polybori ticket, but a boost ticket :-)



---

archive/issue_comments_178630.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 tkluck]:\n> This is not a polybori ticket, but a boost ticket :-)\n\nSorry, I misunderstood this. (Ticket vs. patch.)",
    "created_at": "2013-02-28T13:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178630",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:27'></a>Replying to [comment:26 tkluck]:
> This is not a polybori ticket, but a boost ticket :-)

Sorry, I misunderstood this. (Ticket vs. patch.)



---

archive/issue_comments_178631.json:
```json
{
    "body": "<a id='comment:28'></a>(You wrote it correctly, I just misread)",
    "created_at": "2013-02-28T13:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178631",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:28'></a>(You wrote it correctly, I just misread)



---

archive/issue_comments_178632.json:
```json
{
    "body": "Attachment [0001-Update-doctests-for-polybori-that-rely-on-randomness.patch](tarball://root/attachments/some-uuid/ticket13767/0001-Update-doctests-for-polybori-that-rely-on-randomness.patch) by @tkluck created at 2013-02-28 14:05:19",
    "created_at": "2013-02-28T14:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178632",
    "user": "https://github.com/tkluck"
}
```

Attachment [0001-Update-doctests-for-polybori-that-rely-on-randomness.patch](tarball://root/attachments/some-uuid/ticket13767/0001-Update-doctests-for-polybori-that-rely-on-randomness.patch) by @tkluck created at 2013-02-28 14:05:19



---

archive/issue_comments_178633.json:
```json
{
    "body": "<a id='comment:29'></a>Attachment [trac-13767-sage_root-upgrade-to-boost-1.52.0.patch](tarball://root/attachments/some-uuid/ticket13767/trac-13767-sage_root-upgrade-to-boost-1.52.0.patch) by @tkluck created at 2013-02-28 14:07:31\n\nThe patches are now hg changesets. Sorry about that, I've been doing development on an integrated git tree recently, and I still had to setup the conversion git -> hg.",
    "created_at": "2013-02-28T14:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178633",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:29'></a>Attachment [trac-13767-sage_root-upgrade-to-boost-1.52.0.patch](tarball://root/attachments/some-uuid/ticket13767/trac-13767-sage_root-upgrade-to-boost-1.52.0.patch) by @tkluck created at 2013-02-28 14:07:31

The patches are now hg changesets. Sorry about that, I've been doing development on an integrated git tree recently, and I still had to setup the conversion git -> hg.



---

archive/issue_comments_178634.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-28T14:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178634",
    "user": "https://github.com/tkluck"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_178635.json:
```json
{
    "body": "<a id='comment:30'></a>I created #14205 for possibly making those doctests non-random, and put Alexander in the CC as requested.",
    "created_at": "2013-02-28T16:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178635",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:30'></a>I created #14205 for possibly making those doctests non-random, and put Alexander in the CC as requested.



---

archive/issue_comments_178636.json:
```json
{
    "body": "<a id='comment:31'></a>Could this be dependent on platform (the pbori tests, I mean)?  I get all the *original* ones after installing this spkg and patches, doing `./sage -b` and testing (hence failures).\n\n```\n\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: from polybori import random_set, set_random_seed\nsage: B.<a,b,c,d,e> = BooleanPolynomialRing()\nsage: (a*b*c*d).lm()\na*b*c*d\nsage: set_random_seed(1337)\nsage: random_set((a*b*c*d).lm(),2)\n{{b,c}, {b}}\n```\nIs there something else I should have done to make sure this change works?  (I'm on an Intel Mac OSX 10.7.)",
    "created_at": "2013-02-28T17:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178636",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:31'></a>Could this be dependent on platform (the pbori tests, I mean)?  I get all the *original* ones after installing this spkg and patches, doing `./sage -b` and testing (hence failures).

```

----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: from polybori import random_set, set_random_seed
sage: B.<a,b,c,d,e> = BooleanPolynomialRing()
sage: (a*b*c*d).lm()
a*b*c*d
sage: set_random_seed(1337)
sage: random_set((a*b*c*d).lm(),2)
{{b,c}, {b}}
```
Is there something else I should have done to make sure this change works?  (I'm on an Intel Mac OSX 10.7.)



---

archive/issue_comments_178637.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 kcrisman]:\n> Could this be dependent on platform (the pbori tests, I mean)?  I get all the *original* ones after installing this spkg and patches, doing `./sage -b` and testing (hence failures).\n> Is there something else I should have done to make sure this change works?  (I'm on an Intel Mac OSX 10.7.)\n\n\nDid you recompile the Polybori package?\n\n```\nsage -f polybori\n```",
    "created_at": "2013-02-28T17:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178637",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:32'></a>Replying to [comment:31 kcrisman]:
> Could this be dependent on platform (the pbori tests, I mean)?  I get all the *original* ones after installing this spkg and patches, doing `./sage -b` and testing (hence failures).
> Is there something else I should have done to make sure this change works?  (I'm on an Intel Mac OSX 10.7.)


Did you recompile the Polybori package?

```
sage -f polybori
```



---

archive/issue_comments_178638.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:24 jdemeyer]:\n> Could you make `SPKG.txt` world-readable inside the spkg:\n> \n> ```\n> 1435597707    4 -rw-------   1 jdemeyer jdemeyer     1406 Feb 26 22:22 ./SPKG.txt\n> ```\n\nThis has been done, too. New package version with md5sum 2852b9e02ede0ab2785930d0f9268c6f.",
    "created_at": "2013-02-28T18:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178638",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:33'></a>Replying to [comment:24 jdemeyer]:
> Could you make `SPKG.txt` world-readable inside the spkg:
> 
> ```
> 1435597707    4 -rw-------   1 jdemeyer jdemeyer     1406 Feb 26 22:22 ./SPKG.txt
> ```

This has been done, too. New package version with md5sum 2852b9e02ede0ab2785930d0f9268c6f.



---

archive/issue_comments_178639.json:
```json
{
    "body": "<a id='comment:34'></a>> Did you recompile the Polybori package?\n\nNo, because it didn't say to.  Maybe there should be something that retriggers this on update?  Anyway, works fine now, sorry for the noise (on the way to #13768...)",
    "created_at": "2013-02-28T18:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178639",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:34'></a>> Did you recompile the Polybori package?

No, because it didn't say to.  Maybe there should be something that retriggers this on update?  Anyway, works fine now, sorry for the noise (on the way to #13768...)



---

archive/issue_comments_178640.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-28T18:23:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178640",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_178641.json:
```json
{
    "body": "<a id='comment:35'></a>All administrative issues are fixed.",
    "created_at": "2013-02-28T18:23:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178641",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>All administrative issues are fixed.



---

archive/issue_comments_178642.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:34 kcrisman]:\n> > Did you recompile the Polybori package?\n\n> No, because it didn't say to.  Maybe there should be something that retriggers this on update?  \nYou're right. The makefile `spkg/Makefile` knows which packages depend on which others. Your comment reminded me to check whether it knows that polybori depends on boost_cropped: it does. I'm pretty sure that means that the upgrade path will work.\n\nThanks for testing!",
    "created_at": "2013-03-01T00:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178642",
    "user": "https://github.com/tkluck"
}
```

<a id='comment:36'></a>Replying to [comment:34 kcrisman]:
> > Did you recompile the Polybori package?

> No, because it didn't say to.  Maybe there should be something that retriggers this on update?  
You're right. The makefile `spkg/Makefile` knows which packages depend on which others. Your comment reminded me to check whether it knows that polybori depends on boost_cropped: it does. I'm pretty sure that means that the upgrade path will work.

Thanks for testing!



---

archive/issue_comments_178643.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-05T11:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13767#issuecomment-178643",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_038586.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-05T11:00:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13767",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13767#event-38586"
}
```
