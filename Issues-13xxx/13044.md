# Issue 13044: ecl chokes when CC or CXX contains space

archive/issues_012872.json:
```json
{
    "body": "Currently ecl completely fails to build when CC or CXX contains a space. This adds a patch accepted by upstream to fix this.\n\n**Upstream** (patched): http://sage.ugent.be/www/jdemeyer/sage/ecl-15.3.7.tar.bz2\n\n**Assignee:** GeorgSWeber\n\n**Keywords:** sd40.5\n\n**Branch:** [9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)\n\n**Upstream:** Fixed upstream, but not in a stable release.\n\n**Reviewer:** Jeroen Demeyer, Erik Bray\n\n**Author:** R. Andrew Ohana, Erik Bray, Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/13044\n\n",
    "closed_at": "2016-03-22T15:23:36Z",
    "created_at": "2012-05-28T04:37:04Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "ecl chokes when CC or CXX contains space",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13044",
    "user": "https://github.com/ohanar"
}
```
Currently ecl completely fails to build when CC or CXX contains a space. This adds a patch accepted by upstream to fix this.

**Upstream** (patched): http://sage.ugent.be/www/jdemeyer/sage/ecl-15.3.7.tar.bz2

**Assignee:** GeorgSWeber

**Keywords:** sd40.5

**Branch:** [9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)

**Upstream:** Fixed upstream, but not in a stable release.

**Reviewer:** Jeroen Demeyer, Erik Bray

**Author:** R. Andrew Ohana, Erik Bray, Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/13044





---

archive/issue_comments_184521.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Currently ccache completely fails building ecl, so we should disable ccache in our ecl spkg.\n+\n+New SPKG: http://wstein.org/home/ohanar/spkgs/ecl-11.1.2.cvs20111120.p2.spkg\n``````\n",
    "created_at": "2012-05-28T04:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184521",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Currently ccache completely fails building ecl, so we should disable ccache in our ecl spkg.
+
+New SPKG: http://wstein.org/home/ohanar/spkgs/ecl-11.1.2.cvs20111120.p2.spkg
``````




---

archive/issue_comments_184522.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2012-05-28T04:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184522",
    "user": "https://github.com/ohanar"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_184523.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Currently ccache completely fails building ecl, so we should disable ccache in our ecl spkg.\n+Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.\n \n New SPKG: http://wstein.org/home/ohanar/spkgs/ecl-11.1.2.cvs20111120.p2.spkg\n``````\n",
    "created_at": "2012-05-28T05:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184523",
    "user": "https://github.com/ohanar"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Currently ccache completely fails building ecl, so we should disable ccache in our ecl spkg.
+Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.
 
 New SPKG: http://wstein.org/home/ohanar/spkgs/ecl-11.1.2.cvs20111120.p2.spkg
``````




---

archive/issue_events_041924.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "rename": {
        "from": "ccache chokes on ecl",
        "to": "ecl chokes when CC or CXX contains space"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41924"
}
```



---

archive/issue_comments_184524.json:
```json
{
    "body": "<a id='comment:3'></a>\nI can verify that our current ECL chokes with \"`env CC='nice gcc' ./spkg -i ecl...`\" and that your spkg fixes it. Perhaps it would be nice to put something into the generated `ecl_cc` so we know whence it came: maybe a comment like `# ECL chokes when CC contains spaces; this script works around that. See #13044.` Then it would be easier to remove this workaround when ECL is updated.\n\nAlso, I tried `env CXX='nice g++' ./sage -f ecl...` with the old version and it worked fine. Perhaps we shouldn't also create `ecl_cxx` since ECL is not using a C++ compiler.\n\nAlso`^2`, we should send this upstream.",
    "created_at": "2012-05-28T18:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184524",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:3'></a>
I can verify that our current ECL chokes with "`env CC='nice gcc' ./spkg -i ecl...`" and that your spkg fixes it. Perhaps it would be nice to put something into the generated `ecl_cc` so we know whence it came: maybe a comment like `# ECL chokes when CC contains spaces; this script works around that. See #13044.` Then it would be easier to remove this workaround when ECL is updated.

Also, I tried `env CXX='nice g++' ./sage -f ecl...` with the old version and it worked fine. Perhaps we shouldn't also create `ecl_cxx` since ECL is not using a C++ compiler.

Also`^2`, we should send this upstream.



---

archive/issue_events_041925.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "label": "component: packages",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41925"
}
```



---

archive/issue_events_041926.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41926"
}
```



---

archive/issue_comments_184525.json:
```json
{
    "body": "<a id='comment:6'></a>\nIs this still needed?",
    "created_at": "2013-12-30T10:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184525",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
Is this still needed?



---

archive/issue_comments_184526.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2013-12-30T10:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184526",
    "user": "https://github.com/kiwifb"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_184527.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2013-12-30T10:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184527",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_184528.json:
```json
{
    "body": "<a id='comment:7'></a>\nYes, it is still needed.",
    "created_at": "2013-12-30T10:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184528",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Yes, it is still needed.



---

archive/issue_events_041927.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41927"
}
```



---

archive/issue_events_041928.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41928"
}
```



---

archive/issue_events_041929.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41929"
}
```



---

archive/issue_events_041930.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41930"
}
```



---

archive/issue_comments_184529.json:
```json
{
    "body": "<a id='comment:10'></a>\nThis needs to be converted to a new-style package, for the ECL version we currently use.",
    "created_at": "2014-05-15T20:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184529",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:10'></a>
This needs to be converted to a new-style package, for the ECL version we currently use.



---

archive/issue_comments_184530.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2014-05-15T20:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184530",
    "user": "https://github.com/pjbruin"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_events_041931.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41931"
}
```



---

archive/issue_events_041932.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41932"
}
```



---

archive/issue_comments_184531.json:
```json
{
    "body": "<a id='comment:12'></a>\nI can confirm this is still an issue--sage build breaks on ecl when `CC=ccache gcc`--obviously this can be worked around easily enough, but setting `CC` like that is not uncommon either, and only seems to be a problem with ecl.\n\nWould this be worth patching in ecl (both upstream and in sage)?",
    "created_at": "2016-02-24T15:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184531",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
I can confirm this is still an issue--sage build breaks on ecl when `CC=ccache gcc`--obviously this can be worked around easily enough, but setting `CC` like that is not uncommon either, and only seems to be a problem with ecl.

Would this be worth patching in ecl (both upstream and in sage)?



---

archive/issue_comments_184532.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe updated spkg mentioned in this ticket is a 404 now.",
    "created_at": "2016-02-24T15:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184532",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>
The updated spkg mentioned in this ticket is a 404 now.



---

archive/issue_comments_184533.json:
```json
{
    "body": "<a id='comment:14'></a>\nCurrent upstream is https://common-lisp.net/project/ecl/\nAlso `ecl-16.0.0` has been released and it would be nice to upgrade. It would be worth checking if it is still an issue in the latest release.",
    "created_at": "2016-02-24T20:22:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184533",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>
Current upstream is https://common-lisp.net/project/ecl/
Also `ecl-16.0.0` has been released and it would be nice to upgrade. It would be worth checking if it is still an issue in the latest release.



---

archive/issue_comments_184534.json:
```json
{
    "body": "<a id='comment:15'></a>\nThere is a similar bug that I've just run into, but in Python, when compiling the Cython sources.  I've never run into this before strangely, but maybe have just worked on fewer projects with cpp generated from Cython: https://bugs.python.org/issue8027\n\nI will check if the ecl issue is fixed upstream.",
    "created_at": "2016-02-25T08:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184534",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
There is a similar bug that I've just run into, but in Python, when compiling the Cython sources.  I've never run into this before strangely, but maybe have just worked on fewer projects with cpp generated from Cython: https://bugs.python.org/issue8027

I will check if the ecl issue is fixed upstream.



---

archive/issue_comments_184535.json:
```json
{
    "body": "<a id='comment:16'></a>\nFYI this bug still exists upstream, or at least in ecl-16.0.0.  I will see if I can come up with a patch.",
    "created_at": "2016-03-17T13:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184535",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
FYI this bug still exists upstream, or at least in ecl-16.0.0.  I will see if I can come up with a patch.



---

archive/issue_comments_184536.json:
```json
{
    "body": "**Changing upstream** from \"N/A\" to \"Reported upstream. No feedback yet.\".",
    "created_at": "2016-03-17T15:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184536",
    "user": "https://github.com/embray"
}
```

**Changing upstream** from "N/A" to "Reported upstream. No feedback yet.".



---

archive/issue_comments_184537.json:
```json
{
    "body": "<a id='comment:17'></a>\nSubmitted a patch to upstream: https://gitlab.com/embeddable-common-lisp/ecl/merge_requests/20",
    "created_at": "2016-03-17T15:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184537",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
Submitted a patch to upstream: https://gitlab.com/embeddable-common-lisp/ecl/merge_requests/20



---

archive/issue_comments_184538.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2016-03-17T17:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184538",
    "user": "https://github.com/embray"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_184539.json:
```json
{
    "body": "**Branch:** [u/embray/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/issue-13044)",
    "created_at": "2016-03-17T17:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184539",
    "user": "https://github.com/embray"
}
```

**Branch:** [u/embray/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/issue-13044)



---

archive/issue_comments_184540.json:
```json
{
    "body": "<a id='comment:18'></a>\nAdded the patch to the spkg.  It applies to the current version of the spkg with a bit of fuzz.  \n\nIf I understand correctly I should also update the patch version, and upload a new source package? Not sure exactly how to go about that though.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9f77c6dc61f6d3684716df620706f05a0604b64\">c9f77c6</a></td><td><code>Add patch to ecl for building when CC=ccache gcc (or the like) from https://gitlab.com/embeddable-common-lisp/ecl/merge_requests/20</code></td></tr></table>\n",
    "created_at": "2016-03-17T17:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184540",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'></a>
Added the patch to the spkg.  It applies to the current version of the spkg with a bit of fuzz.  

If I understand correctly I should also update the patch version, and upload a new source package? Not sure exactly how to go about that though.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9f77c6dc61f6d3684716df620706f05a0604b64">c9f77c6</a></td><td><code>Add patch to ecl for building when CC=ccache gcc (or the like) from https://gitlab.com/embeddable-common-lisp/ecl/merge_requests/20</code></td></tr></table>




---

archive/issue_comments_184541.json:
```json
{
    "body": "**Commit:** [c9f77c6dc61f6d3684716df620706f05a0604b64](https://github.com/sagemath/sagetrac-mirror/commit/c9f77c6dc61f6d3684716df620706f05a0604b64)",
    "created_at": "2016-03-17T17:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184541",
    "user": "https://github.com/embray"
}
```

**Commit:** [c9f77c6dc61f6d3684716df620706f05a0604b64](https://github.com/sagemath/sagetrac-mirror/commit/c9f77c6dc61f6d3684716df620706f05a0604b64)



---

archive/issue_comments_184542.json:
```json
{
    "body": "**Changing author** from \"R. Andrew Ohana\" to \"R. Andrew Ohana, Erik Bray\".",
    "created_at": "2016-03-18T18:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184542",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "R. Andrew Ohana" to "R. Andrew Ohana, Erik Bray".



---

archive/issue_events_041933.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T18:08:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41933"
}
```



---

archive/issue_events_041934.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T18:08:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41934"
}
```



---

archive/issue_comments_184543.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.\n-\n-New SPKG: http://wstein.org/home/ohanar/spkgs/ecl-11.1.2.cvs20111120.p2.spkg\n``````\n",
    "created_at": "2016-03-18T18:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184543",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1 @@
 Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.
-
-New SPKG: http://wstein.org/home/ohanar/spkgs/ecl-11.1.2.cvs20111120.p2.spkg
``````




---

archive/issue_comments_184544.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [embray](#comment%3A18):\n> Added the patch to the spkg.  It applies to the current version of the spkg with a bit of fuzz.  \n> \n> If I understand correctly I should also update the patch version\n\nIn this exceptional case I think it's not needed because there is no reason to rebuild everybody's ECL with this patch. And in the cases where ECL didn't install before, there is no **re**build needed since there couldn't have been a build in the first place.\n\n> and upload a new source package?\n\nNo, because you are not changing the source tarball, just adding a patch.",
    "created_at": "2016-03-18T18:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184544",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Replying to [embray](#comment%3A18):
> Added the patch to the spkg.  It applies to the current version of the spkg with a bit of fuzz.  
> 
> If I understand correctly I should also update the patch version

In this exceptional case I think it's not needed because there is no reason to rebuild everybody's ECL with this patch. And in the cases where ECL didn't install before, there is no **re**build needed since there couldn't have been a build in the first place.

> and upload a new source package?

No, because you are not changing the source tarball, just adding a patch.



---

archive/issue_comments_184545.json:
```json
{
    "body": "<a id='comment:21'></a>\nIf I understand correctly, for the package the patches are being applied by `spkg-src` which only seems to apply when building the source tarball.",
    "created_at": "2016-03-18T18:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184545",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'></a>
If I understand correctly, for the package the patches are being applied by `spkg-src` which only seems to apply when building the source tarball.



---

archive/issue_comments_184546.json:
```json
{
    "body": "<a id='comment:22'></a>\nOkay, this is unusual...",
    "created_at": "2016-03-19T13:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184546",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Okay, this is unusual...



---

archive/issue_comments_184547.json:
```json
{
    "body": "<a id='comment:23'></a>\nBad separation (i.e. none) between the patches that needs to be applied in `spkg-src` because autoconf has to be run after them and \"normal\" patches. I guess since you are patching the tarball anyway, you may as well put *all* the patches in it.",
    "created_at": "2016-03-19T19:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184547",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>
Bad separation (i.e. none) between the patches that needs to be applied in `spkg-src` because autoconf has to be run after them and "normal" patches. I guess since you are patching the tarball anyway, you may as well put *all* the patches in it.



---

archive/issue_comments_184548.json:
```json
{
    "body": "<a id='comment:24'></a>\nFWIW the patch has been accepted as-is upstream.",
    "created_at": "2016-03-21T10:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184548",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>
FWIW the patch has been accepted as-is upstream.



---

archive/issue_comments_184549.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2016-03-21T10:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184549",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_184550.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2016-03-21T10:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184550",
    "user": "https://github.com/jdemeyer"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_184551.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2016-03-21T11:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184551",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_184552.json:
```json
{
    "body": "**Changing author** from \"R. Andrew Ohana, Erik Bray\" to \"R. Andrew Ohana, Erik Bray, Jeroen Demeyer\".",
    "created_at": "2016-03-21T11:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184552",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "R. Andrew Ohana, Erik Bray" to "R. Andrew Ohana, Erik Bray, Jeroen Demeyer".



---

archive/issue_comments_184553.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.\n+\n+**Upstream** (patched): http://sage.ugent.be/www/jdemeyer/sage/ecl-15.3.7.tar.bz2\n``````\n",
    "created_at": "2016-03-21T11:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184553",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.
+
+**Upstream** (patched): http://sage.ugent.be/www/jdemeyer/sage/ecl-15.3.7.tar.bz2
``````




---

archive/issue_comments_184554.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/issue-13044)\" to \"[u/jdemeyer/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/issue-13044)\".",
    "created_at": "2016-03-21T11:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184554",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/embray/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/issue-13044)" to "[u/jdemeyer/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/issue-13044)".



---

archive/issue_comments_184555.json:
```json
{
    "body": "**Changing commit** from \"[c9f77c6dc61f6d3684716df620706f05a0604b64](https://github.com/sagemath/sagetrac-mirror/commit/c9f77c6dc61f6d3684716df620706f05a0604b64)\" to \"[9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)\".",
    "created_at": "2016-03-21T12:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184555",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[c9f77c6dc61f6d3684716df620706f05a0604b64](https://github.com/sagemath/sagetrac-mirror/commit/c9f77c6dc61f6d3684716df620706f05a0604b64)" to "[9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)".



---

archive/issue_comments_184556.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2016-03-21T12:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184556",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_184557.json:
```json
{
    "body": "<a id='comment:29'></a>\nBuilding with `CC=\"ccache cc\" CXX=\"ccache c++\"` now works.\n\nI cleaned up the packaging and build of ECL. In particular, I separated the patches which need to be applied by `spkg-src` from the ones which are applied at build-time. This part still needs to be reviewed.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824\">9049b15</a></td><td><code>Improve ECL packaging and build</code></td></tr></table>\n",
    "created_at": "2016-03-21T12:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184557",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
Building with `CC="ccache cc" CXX="ccache c++"` now works.

I cleaned up the packaging and build of ECL. In particular, I separated the patches which need to be applied by `spkg-src` from the ones which are applied at build-time. This part still needs to be reviewed.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824">9049b15</a></td><td><code>Improve ECL packaging and build</code></td></tr></table>




---

archive/issue_comments_184558.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2016-03-21T13:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184558",
    "user": "https://github.com/embray"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_184559.json:
```json
{
    "body": "<a id='comment:30'></a>\n+1",
    "created_at": "2016-03-21T13:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184559",
    "user": "https://github.com/embray"
}
```

<a id='comment:30'></a>
+1



---

archive/issue_comments_184560.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Erik Bray\".",
    "created_at": "2016-03-21T17:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184560",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Jeroen Demeyer" to "Jeroen Demeyer, Erik Bray".



---

archive/issue_events_041935.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-22T15:23:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13044#event-41935"
}
```



---

archive/issue_comments_184561.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/issue-13044)\" to \"[9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)\".",
    "created_at": "2016-03-22T15:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184561",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/issue-13044](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/issue-13044)" to "[9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)".



---

archive/issue_comments_184562.json:
```json
{
    "body": "**Changing commit** from \"[9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)\" to \"\".",
    "created_at": "2016-03-22T15:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184562",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[9049b155a9317d421de5ae9c22fad48eca5af824](https://github.com/sagemath/sagetrac-mirror/commit/9049b155a9317d421de5ae9c22fad48eca5af824)" to "".



---

archive/issue_comments_184563.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.\n+Currently ecl completely fails to build when CC or CXX contains a space. This adds a patch accepted by upstream to fix this.\n \n **Upstream** (patched): http://sage.ugent.be/www/jdemeyer/sage/ecl-15.3.7.tar.bz2\n``````\n",
    "created_at": "2016-03-22T15:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13044#issuecomment-184563",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Currently ecl completely fails to build when CC or CXX contains a space. This hacks around this issue by making temporary wrappers for CC and CXX.
+Currently ecl completely fails to build when CC or CXX contains a space. This adds a patch accepted by upstream to fix this.
 
 **Upstream** (patched): http://sage.ugent.be/www/jdemeyer/sage/ecl-15.3.7.tar.bz2
``````

