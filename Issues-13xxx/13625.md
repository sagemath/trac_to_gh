# Issue 13625: matrix_plot and title don't mix well (yet)

archive/issues_013421.json:
```json
{
    "body": "See [this ask.sagemath.org question](http://ask.sagemath.org/question/1888/put-title-on-matrix_plot), where elcojon gives this example.\n\n```\npiclabels = ('width [px]','height [px]')\nimport scipy \ndata = scipy.lena()\nmatrix_plot(data,axes_labels=piclabels, title='Lena image')\n```\n![](Lena-wrongtitle.png)\n\n(Note that this doesn't work literally in Sage 5.4.1 - the new Scipy in #13541 seems to have moved this to `scipy.misc.lena()`.)\n\nThis is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.\n\n---\n\nReported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).\n\n---\nPatch to workaround this issue while upstream decides how best to fix this bug.\nApply in this order to `devel/sage`:\n1. [attachment:trac_13625-new_option_title_pos.patch]\n2. [attachment:trac_13625-add_title_pos_to_matrix_plot-reviewed.patch]\n\n**Assignee:** @jasongrout, @williamstein\n\n**Upstream:** Reported upstream. Developers acknowledge bug.\n\n**Reviewer:** Karl-Dieter Crisman\n\n**Author:** Punarbasu Purkayastha\n\n**Merged:** sage-5.6.beta1\n\nIssue created by migration from https://trac.sagemath.org/ticket/13625\n\n",
    "closed_at": "2012-12-21T09:32:45Z",
    "created_at": "2012-10-19T12:21:24Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "title": "matrix_plot and title don't mix well (yet)",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/13625",
    "user": "https://github.com/kcrisman"
}
```
See [this ask.sagemath.org question](http://ask.sagemath.org/question/1888/put-title-on-matrix_plot), where elcojon gives this example.

```
piclabels = ('width [px]','height [px]')
import scipy 
data = scipy.lena()
matrix_plot(data,axes_labels=piclabels, title='Lena image')
```
![](Lena-wrongtitle.png)

(Note that this doesn't work literally in Sage 5.4.1 - the new Scipy in #13541 seems to have moved this to `scipy.misc.lena()`.)

This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.

---

Reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).

---
Patch to workaround this issue while upstream decides how best to fix this bug.
Apply in this order to `devel/sage`:
1. [attachment:trac_13625-new_option_title_pos.patch]
2. [attachment:trac_13625-add_title_pos_to_matrix_plot-reviewed.patch]

**Assignee:** @jasongrout, @williamstein

**Upstream:** Reported upstream. Developers acknowledge bug.

**Reviewer:** Karl-Dieter Crisman

**Author:** Punarbasu Purkayastha

**Merged:** sage-5.6.beta1

Issue created by migration from https://trac.sagemath.org/ticket/13625





---

archive/issue_comments_162035.json:
```json
{
    "body": "What happens currently - bad",
    "created_at": "2012-10-19T12:21:39Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162035",
    "user": "https://github.com/kcrisman"
}
```

What happens currently - bad



---

archive/attachments_018425.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "Lena-wrongtitle.png",
    "asset_url": "tarball://root/attachments/ticket13625/Lena-wrongtitle.png",
    "created_at": "2012-10-19T12:22:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13625/Lena-wrongtitle.png",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_162036.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [Lena-wrongtitle.png](https://github.com/sagemath/sage/files/ticket13625/Lena-wrongtitle.png) by @kcrisman created at 2012-10-19 12:22:02",
    "created_at": "2012-10-19T12:22:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162036",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'></a>
Attachment [Lena-wrongtitle.png](https://github.com/sagemath/sage/files/ticket13625/Lena-wrongtitle.png) by @kcrisman created at 2012-10-19 12:22:02



---

archive/issue_comments_162037.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,6 +6,6 @@\n data = scipy.lena()\n matrix_plot(data,axes_labels=piclabels, title='Lena image')\n ```\n-[This is the Trac macro *Image* that was inherited from the migration called with arguments ())](https://trac.sagemath.org/wiki/WikiMacros#Image-macro)\n+![](Lena-wrongtitle.png)\n \n This is fallout from the great *new* functionality in #10512.\n``````\n",
    "created_at": "2012-10-19T12:22:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162037",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,6 +6,6 @@
 data = scipy.lena()
 matrix_plot(data,axes_labels=piclabels, title='Lena image')
 ```
-[This is the Trac macro *Image* that was inherited from the migration called with arguments ())](https://trac.sagemath.org/wiki/WikiMacros#Image-macro)
+![](Lena-wrongtitle.png)
 
 This is fallout from the great *new* functionality in #10512.
``````




---

archive/issue_comments_162038.json:
```json
{
    "body": "<a id='comment:2'></a>\nUnless I am mistaken, this has to be a bug in matplotlib. We don't touch title positions when there is a frame.",
    "created_at": "2012-10-19T12:34:26Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162038",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:2'></a>
Unless I am mistaken, this has to be a bug in matplotlib. We don't touch title positions when there is a frame.



---

archive/issue_comments_162039.json:
```json
{
    "body": "<a id='comment:3'></a>\nThat's my point; we *do* touch them when we have axes but no frames, so that there isn't an overlap (see the discussion at #10512.  So maybe we should do so here as well.  Perhaps those are both bugs in mpl, in which case maybe it should be reported upstream, but I don't have enough mpl-fu to figure out a native mpl version of this problem quickly.  I think it's us, because in the code for\n\n```\nsage: sage.plot.matrix_plot.MatrixPlot._render_on_subplot??\n<skip stuff>\nimage=subplot.imshow(self.xy_data_array, **opts)\n<skip irrelevant stuff>\nsubplot.xaxis.tick_top()\n```\nwe presumably add the title before the ticks and labels.  So it's already placed the title early.  Maybe we should do all opts except title, and then do the title at the end in this particular rendering method?  I'll try that quick.",
    "created_at": "2012-10-19T12:43:18Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162039",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
That's my point; we *do* touch them when we have axes but no frames, so that there isn't an overlap (see the discussion at #10512.  So maybe we should do so here as well.  Perhaps those are both bugs in mpl, in which case maybe it should be reported upstream, but I don't have enough mpl-fu to figure out a native mpl version of this problem quickly.  I think it's us, because in the code for

```
sage: sage.plot.matrix_plot.MatrixPlot._render_on_subplot??
<skip stuff>
image=subplot.imshow(self.xy_data_array, **opts)
<skip irrelevant stuff>
subplot.xaxis.tick_top()
```
we presumably add the title before the ticks and labels.  So it's already placed the title early.  Maybe we should do all opts except title, and then do the title at the end in this particular rendering method?  I'll try that quick.



---

archive/issue_comments_162040.json:
```json
{
    "body": "<a id='comment:4'></a>\nScratch that last comment, \n\n```\n            opts = dict(cmap=cmap, interpolation='nearest', aspect='equal',\n                      norm=norm, vmin=options['vmin'], vmax=options['vmax'],\n                      origin=origin,zorder=options.get('zorder',None))\n```\nso I'll have to look a little more at where the title enters.",
    "created_at": "2012-10-19T12:44:30Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162040",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Scratch that last comment, 

```
            opts = dict(cmap=cmap, interpolation='nearest', aspect='equal',
                      norm=norm, vmin=options['vmin'], vmax=options['vmax'],
                      origin=origin,zorder=options.get('zorder',None))
```
so I'll have to look a little more at where the title enters.



---

archive/issue_comments_162041.json:
```json
{
    "body": "<a id='comment:5'></a>\nIndeed, the following fixes the problem (though probably introduces others!)\n\n```diff\ndiff --git a/sage/plot/graphics.py b/sage/plot/graphics.py\n--- a/sage/plot/graphics.py\n+++ b/sage/plot/graphics.py\n@@ -2460,11 +2460,8 @@\n         # free limits autoscale\n         #subplot.autoscale_view(tight=True)\n         if title is not None:\n-            if (frame) or (axes_labels is None):\n-                subplot.set_title(title, fontsize=fontsize)\n-            else: # frame is false axes is not None, and neither is axes_labels\n-                # Then, the title is moved up to avoid overlap with axes labels\n-                subplot.set_title(title, fontsize=fontsize, position=(0.5,1.05))\n+            # Then, the title is moved up to avoid overlap with axes labels\n+            subplot.set_title(title, fontsize=fontsize, position=(0.5,1.05))\n```",
    "created_at": "2012-10-19T12:52:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162041",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
Indeed, the following fixes the problem (though probably introduces others!)

```diff
diff --git a/sage/plot/graphics.py b/sage/plot/graphics.py
--- a/sage/plot/graphics.py
+++ b/sage/plot/graphics.py
@@ -2460,11 +2460,8 @@
         # free limits autoscale
         #subplot.autoscale_view(tight=True)
         if title is not None:
-            if (frame) or (axes_labels is None):
-                subplot.set_title(title, fontsize=fontsize)
-            else: # frame is false axes is not None, and neither is axes_labels
-                # Then, the title is moved up to avoid overlap with axes labels
-                subplot.set_title(title, fontsize=fontsize, position=(0.5,1.05))
+            # Then, the title is moved up to avoid overlap with axes labels
+            subplot.set_title(title, fontsize=fontsize, position=(0.5,1.05))
```



---

archive/issue_comments_162042.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,4 +8,5 @@\n ```\n ![](Lena-wrongtitle.png)\n \n-This is fallout from the great *new* functionality in #10512.\n+This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.\n+\n``````\n",
    "created_at": "2012-10-19T12:52:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162042",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,4 +8,5 @@
 ```
 ![](Lena-wrongtitle.png)
 
-This is fallout from the great *new* functionality in #10512.
+This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.
+
``````




---

archive/issue_comments_162043.json:
```json
{
    "body": "<a id='comment:6'></a>\nIt's a bug in mpl. It shouldn't be our job to move title positions around. The bug is because of `tick_top()` that is used.\n\n```\nsage: from matplotlib.figure import Figure\nsage: figure = Figure()\nsage: subplot = figure.add_subplot(111)\nsage: import numpy as np\nsage: M = np.identity(50)\nsage: subplot.imshow(M)\n<matplotlib.image.AxesImage object at 0x8bc0650>\nsage: subplot.xaxis.tick_top()   # <--------- this introduces the bug\nsage: subplot.set_title('a title')\n<matplotlib.text.Text object at 0x8c54610>\nsage: from matplotlib.backends.backend_agg import FigureCanvasAgg\nsage: figure.set_canvas(FigureCanvasAgg(figure))\nsage: figure.savefig('/tmp/a.png')\nsage: !feh /tmp/a.png\n```\n\nEDIT: the problem with shifting title positions by ourselves is that the title will be quite a bit off vertically in normal plots. Definitely not what we desire.",
    "created_at": "2012-10-19T12:56:15Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162043",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:6'></a>
It's a bug in mpl. It shouldn't be our job to move title positions around. The bug is because of `tick_top()` that is used.

```
sage: from matplotlib.figure import Figure
sage: figure = Figure()
sage: subplot = figure.add_subplot(111)
sage: import numpy as np
sage: M = np.identity(50)
sage: subplot.imshow(M)
<matplotlib.image.AxesImage object at 0x8bc0650>
sage: subplot.xaxis.tick_top()   # <--------- this introduces the bug
sage: subplot.set_title('a title')
<matplotlib.text.Text object at 0x8c54610>
sage: from matplotlib.backends.backend_agg import FigureCanvasAgg
sage: figure.set_canvas(FigureCanvasAgg(figure))
sage: figure.savefig('/tmp/a.png')
sage: !feh /tmp/a.png
```

EDIT: the problem with shifting title positions by ourselves is that the title will be quite a bit off vertically in normal plots. Definitely not what we desire.



---

archive/issue_comments_162044.json:
```json
{
    "body": "<a id='comment:7'></a>\nGotcha.  I was still trying to figure out exactly how to create what you got up there...\n\nRight, I figured that uniformly shifting the title was bad, but I was wondering if we could special-case this for now somehow while still reporting the problem. Can you report this upstream?",
    "created_at": "2012-10-19T13:05:36Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162044",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>
Gotcha.  I was still trying to figure out exactly how to create what you got up there...

Right, I figured that uniformly shifting the title was bad, but I was wondering if we could special-case this for now somehow while still reporting the problem. Can you report this upstream?



---

archive/issue_comments_162045.json:
```json
{
    "body": "**Upstream:** Not yet reported upstream; Will do shortly.",
    "created_at": "2012-10-19T13:05:36Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162045",
    "user": "https://github.com/kcrisman"
}
```

**Upstream:** Not yet reported upstream; Will do shortly.



---

archive/issue_comments_162046.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,3 +10,6 @@\n \n This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.\n \n+---\n+\n+Reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).\n``````\n",
    "created_at": "2012-10-19T13:18:38Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162046",
    "user": "https://github.com/ppurka"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,3 +10,6 @@
 
 This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.
 
+---
+
+Reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).
``````




---

archive/issue_comments_162047.json:
```json
{
    "body": "**Changing upstream** from \"Not yet reported upstream; Will do shortly.\" to \"Reported upstream. No feedback yet.\".",
    "created_at": "2012-10-19T13:18:38Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162047",
    "user": "https://github.com/ppurka"
}
```

**Changing upstream** from "Not yet reported upstream; Will do shortly." to "Reported upstream. No feedback yet.".



---

archive/issue_comments_162048.json:
```json
{
    "body": "<a id='comment:8'></a>\nOK. This is now reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).",
    "created_at": "2012-10-19T13:18:38Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162048",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:8'></a>
OK. This is now reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).



---

archive/issue_comments_162049.json:
```json
{
    "body": "<a id='comment:9'></a>\nI will try and see sometime if something can be hacked up in Sage. Maybe give users the extra control over where to put the plot title? Then it will have the added benefit of us not having to remember to remove our hack once mpl fixes it in their end. Something like `title_pos=(x_factor, y_factor)` can be used. Example would be\n\n```\nplot(x, title='such is life', title_pos=(0.4, 0.2))\n```",
    "created_at": "2012-10-19T15:31:24Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162049",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:9'></a>
I will try and see sometime if something can be hacked up in Sage. Maybe give users the extra control over where to put the plot title? Then it will have the added benefit of us not having to remember to remove our hack once mpl fixes it in their end. Something like `title_pos=(x_factor, y_factor)` can be used. Example would be

```
plot(x, title='such is life', title_pos=(0.4, 0.2))
```



---

archive/issue_comments_162050.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\".",
    "created_at": "2012-10-19T15:31:24Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162050",
    "user": "https://github.com/ppurka"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug.".



---

archive/issue_comments_162051.json:
```json
{
    "body": "<a id='comment:10'></a>\nThat seems reasonable, as long as it's automatic for matrix plots which have `origin='upper'`.  We'd need very good documentation about what the `title_pos` argument means, though, since I think it's different (relative to the figure as a 1 by 1 object) than other places where things can get set, like `text()`, where `axis_coords` is not the default.",
    "created_at": "2012-10-19T16:25:06Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162051",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
That seems reasonable, as long as it's automatic for matrix plots which have `origin='upper'`.  We'd need very good documentation about what the `title_pos` argument means, though, since I think it's different (relative to the figure as a 1 by 1 object) than other places where things can get set, like `text()`, where `axis_coords` is not the default.



---

archive/issue_comments_162052.json:
```json
{
    "body": "<a id='comment:11'></a>\nAdded patches, which must be applied in the specified order.\n1. [attachment:trac_13625-new_option_title_pos.patch]\n2. [attachment:trac_13625-add_title_pos_to_matrix_plot.patch]",
    "created_at": "2012-10-20T17:23:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162052",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:11'></a>
Added patches, which must be applied in the specified order.
1. [attachment:trac_13625-new_option_title_pos.patch]
2. [attachment:trac_13625-add_title_pos_to_matrix_plot.patch]



---

archive/issue_events_116312.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-10-20T17:23:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116312"
}
```



---

archive/issue_comments_162053.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,3 +13,9 @@\n ---\n \n Reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).\n+\n+---\n+Patch to workaround this issue while upstream decides how best to fix this bug.\n+Apply in this order to `devel/sage`:\n+1. [attachment:trac_13625-new_option_title_pos.patch]\n+2. [attachment:trac_13625-add_title_pos_to_matrix_plot.patch]\n``````\n",
    "created_at": "2012-10-20T17:23:53Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162053",
    "user": "https://github.com/ppurka"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,3 +13,9 @@
 ---
 
 Reported upstream at [1415](https://github.com/matplotlib/matplotlib/issues/1415).
+
+---
+Patch to workaround this issue while upstream decides how best to fix this bug.
+Apply in this order to `devel/sage`:
+1. [attachment:trac_13625-new_option_title_pos.patch]
+2. [attachment:trac_13625-add_title_pos_to_matrix_plot.patch]
``````




---

archive/issue_comments_162054.json:
```json
{
    "body": "<a id='comment:12'></a>\nBrief glance looks good; I'm not in a position to try plots and run tests but the concept looks right for exposing this.  I would point out that we only need the extra `title_pos` in `matrix_plot` when `origin='upper'`; it looks fine when the ticks are labeled on the bottom.  You might want to experiment a little with those.",
    "created_at": "2012-10-21T00:56:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162054",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
Brief glance looks good; I'm not in a position to try plots and run tests but the concept looks right for exposing this.  I would point out that we only need the extra `title_pos` in `matrix_plot` when `origin='upper'`; it looks fine when the ticks are labeled on the bottom.  You might want to experiment a little with those.



---

archive/issue_comments_162055.json:
```json
{
    "body": "**Author:** Punarbasu Purkayastha",
    "created_at": "2012-10-21T00:56:14Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162055",
    "user": "https://github.com/kcrisman"
}
```

**Author:** Punarbasu Purkayastha



---

archive/issue_comments_162056.json:
```json
{
    "body": "<a id='comment:13'></a>\nThanks. I forgot about the `origin` keyword. You did mention this before.",
    "created_at": "2012-10-21T01:51:54Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162056",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:13'></a>
Thanks. I forgot about the `origin` keyword. You did mention this before.



---

archive/issue_comments_162057.json:
```json
{
    "body": "<a id='comment:14'></a>\npatchbot apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot.patch",
    "created_at": "2012-10-21T01:53:09Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162057",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:14'></a>
patchbot apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot.patch



---

archive/issue_comments_162058.json:
```json
{
    "body": "<a id='comment:15'></a>\nOkay. Doctest the fixed matrix plots, with and without the keywords.  People should be able to try out the difference in the live documentation.",
    "created_at": "2012-10-21T02:11:42Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162058",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>
Okay. Doctest the fixed matrix plots, with and without the keywords.  People should be able to try out the difference in the live documentation.



---

archive/issue_comments_162059.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2012-10-21T02:11:42Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162059",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_events_116313.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-10-21T02:11:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116313"
}
```



---

archive/issue_events_116314.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-10-21T02:11:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116314"
}
```



---

archive/issue_comments_162060.json:
```json
{
    "body": "<a id='comment:16'></a>\nhopefully fixed now.",
    "created_at": "2012-10-21T02:41:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162060",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:16'></a>
hopefully fixed now.



---

archive/issue_events_116315.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-10-21T02:41:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116315"
}
```



---

archive/issue_events_116316.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2012-10-21T02:41:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116316"
}
```



---

archive/issue_comments_162061.json:
```json
{
    "body": "<a id='comment:17'></a>\noops. sorry. Forgot about one thing.",
    "created_at": "2012-10-21T02:44:22Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162061",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:17'></a>
oops. sorry. Forgot about one thing.



---

archive/issue_comments_162062.json:
```json
{
    "body": "Apply to `devel/sage`",
    "created_at": "2012-10-21T02:46:30Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162062",
    "user": "https://github.com/ppurka"
}
```

Apply to `devel/sage`



---

archive/attachments_018426.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13625-add_title_pos_to_matrix_plot.patch",
    "asset_url": "tarball://root/attachments/ticket13625/trac_13625-add_title_pos_to_matrix_plot.patch",
    "created_at": "2012-10-21T02:48:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13625/trac_13625-add_title_pos_to_matrix_plot.patch",
    "user": "https://github.com/ppurka"
}
```



---

archive/issue_comments_162063.json:
```json
{
    "body": "<a id='comment:18'></a>\nAttachment [trac_13625-add_title_pos_to_matrix_plot.patch](https://github.com/sagemath/sage/files/ticket13625/trac_13625-add_title_pos_to_matrix_plot.patch) by @ppurka created at 2012-10-21 02:48:02\n\nOk. This is fixed now. The problem with the patch was that custom `title_pos` was being overridden with `title_pos=(0.5,1.05)`. I forgot to take care of this case when I removed this keyword from `@options()`.",
    "created_at": "2012-10-21T02:48:02Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162063",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:18'></a>
Attachment [trac_13625-add_title_pos_to_matrix_plot.patch](https://github.com/sagemath/sage/files/ticket13625/trac_13625-add_title_pos_to_matrix_plot.patch) by @ppurka created at 2012-10-21 02:48:02

Ok. This is fixed now. The problem with the patch was that custom `title_pos` was being overridden with `title_pos=(0.5,1.05)`. I forgot to take care of this case when I removed this keyword from `@options()`.



---

archive/issue_comments_162064.json:
```json
{
    "body": "<a id='comment:19'></a>\npatchbot failing all doctests... me tearing hair...\n\npatchbot apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot.patch",
    "created_at": "2012-10-28T17:01:18Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162064",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:19'></a>
patchbot failing all doctests... me tearing hair...

patchbot apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot.patch



---

archive/issue_comments_162065.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,6 +7,8 @@\n matrix_plot(data,axes_labels=piclabels, title='Lena image')\n ```\n ![](Lena-wrongtitle.png)\n+\n+(Note that this doesn't work literally in Sage 5.4.1 - the new Scipy in #13541 seems to have moved this to `scipy.misc.lena()`.)\n \n This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.\n \n``````\n",
    "created_at": "2012-12-02T03:12:33Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162065",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,6 +7,8 @@
 matrix_plot(data,axes_labels=piclabels, title='Lena image')
 ```
 ![](Lena-wrongtitle.png)
+
+(Note that this doesn't work literally in Sage 5.4.1 - the new Scipy in #13541 seems to have moved this to `scipy.misc.lena()`.)
 
 This is fallout from the great *new* functionality in #10512. The `axes_labels` are irrelevant to whether this happens.
 
``````




---

archive/issue_comments_162066.json:
```json
{
    "body": "<a id='comment:21'></a>\nOkay, looks good overall, I can do all kinds of goofy things!  I like these patches, sorry for the delay.\n\nI do think we need a little better error catching.\n\n```\nsage: plot(sin, -4, 4, title='Plot sin(x)', title_pos=.05)\n<snip>\n   2482         if title is not None:\n   2483             if title_pos is not None:\n-> 2484                 if len(title_pos) != 2:\n   2485                     raise ValueError(\"`title_pos` must be a list or tuple \"\n   2486                                      \"of two real numbers.\")\n\nTypeError: object of type 'sage.rings.real_mpfr.RealLiteral' has no len()\n```\nA subtle difference, but this should also tell the user that `title_pos` must be the right format.",
    "created_at": "2012-12-02T03:23:37Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162066",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:21'></a>
Okay, looks good overall, I can do all kinds of goofy things!  I like these patches, sorry for the delay.

I do think we need a little better error catching.

```
sage: plot(sin, -4, 4, title='Plot sin(x)', title_pos=.05)
<snip>
   2482         if title is not None:
   2483             if title_pos is not None:
-> 2484                 if len(title_pos) != 2:
   2485                     raise ValueError("`title_pos` must be a list or tuple "
   2486                                      "of two real numbers.")

TypeError: object of type 'sage.rings.real_mpfr.RealLiteral' has no len()
```
A subtle difference, but this should also tell the user that `title_pos` must be the right format.



---

archive/issue_comments_162067.json:
```json
{
    "body": "<a id='comment:22'></a>\nThanks for the review! I hadn't thought of this case. Fixed now.\n\nPatchbot: apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot.patch",
    "created_at": "2012-12-02T04:05:08Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162067",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:22'></a>
Thanks for the review! I hadn't thought of this case. Fixed now.

Patchbot: apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot.patch



---

archive/issue_comments_162068.json:
```json
{
    "body": "<a id='comment:23'></a>\nShould <code>\\`title_pos\\`</code> have back ticks in the error message?\n\nI won't be able to get to this until next week, so no rush on the answer to that.  I also have to run tests, though I don't expect any surprises.",
    "created_at": "2012-12-02T04:24:21Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162068",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:23'></a>
Should <code>\`title_pos\`</code> have back ticks in the error message?

I won't be able to get to this until next week, so no rush on the answer to that.  I also have to run tests, though I don't expect any surprises.



---

archive/issue_comments_162069.json:
```json
{
    "body": "<a id='comment:24'></a>\nNot sure why i used those backticks. Fixed now.",
    "created_at": "2012-12-02T08:57:13Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162069",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:24'></a>
Not sure why i used those backticks. Fixed now.



---

archive/attachments_018427.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13625-add_title_pos_to_matrix_plot-reviewed.patch",
    "asset_url": "tarball://root/attachments/ticket13625/trac_13625-add_title_pos_to_matrix_plot-reviewed.patch",
    "created_at": "2012-12-03T22:08:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13625/trac_13625-add_title_pos_to_matrix_plot-reviewed.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_162070.json:
```json
{
    "body": "Attachment [trac_13625-add_title_pos_to_matrix_plot-reviewed.patch](https://github.com/sagemath/sage/files/ticket13625/trac_13625-add_title_pos_to_matrix_plot-reviewed.patch) by @kcrisman created at 2012-12-03 22:08:56",
    "created_at": "2012-12-03T22:08:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162070",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_13625-add_title_pos_to_matrix_plot-reviewed.patch](https://github.com/sagemath/sage/files/ticket13625/trac_13625-add_title_pos_to_matrix_plot-reviewed.patch) by @kcrisman created at 2012-12-03 22:08:56



---

archive/issue_events_116317.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-12-03T22:12:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116317"
}
```



---

archive/issue_events_116318.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-12-03T22:12:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116318"
}
```



---

archive/issue_comments_162071.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -20,4 +20,4 @@\n Patch to workaround this issue while upstream decides how best to fix this bug.\n Apply in this order to `devel/sage`:\n 1. [attachment:trac_13625-new_option_title_pos.patch]\n-2. [attachment:trac_13625-add_title_pos_to_matrix_plot.patch]\n+2. [attachment:trac_13625-add_title_pos_to_matrix_plot-reviewed.patch]\n``````\n",
    "created_at": "2012-12-03T22:12:22Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162071",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -20,4 +20,4 @@
 Patch to workaround this issue while upstream decides how best to fix this bug.
 Apply in this order to `devel/sage`:
 1. [attachment:trac_13625-new_option_title_pos.patch]
-2. [attachment:trac_13625-add_title_pos_to_matrix_plot.patch]
+2. [attachment:trac_13625-add_title_pos_to_matrix_plot-reviewed.patch]
``````




---

archive/issue_comments_162072.json:
```json
{
    "body": "<a id='comment:25'></a>\nThere was also an extra space that made the LaTeX of the Cartesian product look wrong in the built doc.  Otherwise, looks great, passes tests!\n\nPatchbot, apply trac_13625-new_option_title_pos.patch and trac_13625-add_title_pos_to_matrix_plot-reviewed.patch",
    "created_at": "2012-12-03T22:12:22Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162072",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:25'></a>
There was also an extra space that made the LaTeX of the Cartesian product look wrong in the built doc.  Otherwise, looks great, passes tests!

Patchbot, apply trac_13625-new_option_title_pos.patch and trac_13625-add_title_pos_to_matrix_plot-reviewed.patch



---

archive/issue_comments_162073.json:
```json
{
    "body": "<a id='comment:26'></a>\nOops. I didn't see that you have already fixed it! sorry. Thanks for the review. :)\n\nPatchbot apply trac_13625-new_option_title_pos.patch and trac_13625-add_title_pos_to_matrix_plot-reviewed.patch",
    "created_at": "2012-12-04T03:51:06Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162073",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:26'></a>
Oops. I didn't see that you have already fixed it! sorry. Thanks for the review. :)

Patchbot apply trac_13625-new_option_title_pos.patch and trac_13625-add_title_pos_to_matrix_plot-reviewed.patch



---

archive/issue_comments_162074.json:
```json
{
    "body": "Apply to `devel/sage`",
    "created_at": "2012-12-04T03:52:09Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162074",
    "user": "https://github.com/ppurka"
}
```

Apply to `devel/sage`



---

archive/attachments_018428.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_13625-new_option_title_pos.patch",
    "asset_url": "tarball://root/attachments/ticket13625/trac_13625-new_option_title_pos.patch",
    "created_at": "2012-12-04T03:52:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket13625/trac_13625-new_option_title_pos.patch",
    "user": "https://github.com/ppurka"
}
```



---

archive/issue_comments_162075.json:
```json
{
    "body": "<a id='comment:27'></a>\nAttachment [trac_13625-new_option_title_pos.patch](https://github.com/sagemath/sage/files/ticket13625/trac_13625-new_option_title_pos.patch) by @ppurka created at 2012-12-04 03:52:56\n\nreverted my change. sorry for the mess.\n\nPatchbot apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot-reviewed.patch",
    "created_at": "2012-12-04T03:52:56Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162075",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:27'></a>
Attachment [trac_13625-new_option_title_pos.patch](https://github.com/sagemath/sage/files/ticket13625/trac_13625-new_option_title_pos.patch) by @ppurka created at 2012-12-04 03:52:56

reverted my change. sorry for the mess.

Patchbot apply trac_13625-new_option_title_pos.patch trac_13625-add_title_pos_to_matrix_plot-reviewed.patch



---

archive/issue_events_116319.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-15T02:27:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116319"
}
```



---

archive/issue_events_116320.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-15T02:27:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "milestone": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116320"
}
```



---

archive/issue_comments_162076.json:
```json
{
    "body": "**Merged:** sage-5.6.beta1",
    "created_at": "2012-12-21T09:32:45Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162076",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.6.beta1



---

archive/issue_events_116321.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-21T09:32:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116321"
}
```



---

archive/issue_events_116322.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-21T09:32:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13625#event-116322"
}
```



---

archive/issue_comments_162077.json:
```json
{
    "body": "<a id='comment:30'></a>\nJust as FYI, https://github.com/matplotlib/matplotlib/issues/1415 might affect this.",
    "created_at": "2018-04-03T21:30:49Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162077",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:30'></a>
Just as FYI, https://github.com/matplotlib/matplotlib/issues/1415 might affect this.



---

archive/issue_comments_162078.json:
```json
{
    "body": "<a id='comment:31'></a>\nYes, may need to revisit the workaround done here.",
    "created_at": "2018-04-07T07:00:06Z",
    "issue": "https://github.com/sagemath/sage/issues/13625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13625#issuecomment-162078",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:31'></a>
Yes, may need to revisit the workaround done here.
