# Issue 13362: Fix bug in build_flow_graph

archive/issues_013190.json:
```json
{
    "body": "The function `build_flow_graph` (called by the `flow` function) contains a\n\n```\ng.set_edge_label(l)\n```\ninstead of\n\n```\ng.set_edge_label(sp[i],sp[i+1],l) \n```\nwhere ``l`` is a number.\n\n\nAssignee: jason, ncohen, rlm\n\nCC:  @nathanncohen\n\nReviewer: Keshav Kini, Nathann Cohen\n\nAuthor: David Coudert\n\nMerged: sage-5.4.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13362\n\n",
    "closed_at": "2012-09-23T16:22:20Z",
    "created_at": "2012-08-13T12:14:30Z",
    "labels": [
        "component: graph theory",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.4",
    "title": "Fix bug in build_flow_graph",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13362",
    "user": "https://github.com/dcoudert"
}
```
The function `build_flow_graph` (called by the `flow` function) contains a

```
g.set_edge_label(l)
```
instead of

```
g.set_edge_label(sp[i],sp[i+1],l) 
```
where ``l`` is a number.


Assignee: jason, ncohen, rlm

CC:  @nathanncohen

Reviewer: Keshav Kini, Nathann Cohen

Author: David Coudert

Merged: sage-5.4.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13362





---

archive/issue_comments_160809.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-08-13T12:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160809",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_160810.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2012-08-13T12:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160810",
    "user": "https://github.com/dcoudert"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_160811.json:
```json
{
    "body": "<a id='comment:3'></a>The patch is working for both sage-5.3.beta0 and sage-5.3.beta1.",
    "created_at": "2012-08-13T14:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160811",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'></a>The patch is working for both sage-5.3.beta0 and sage-5.3.beta1.



---

archive/issue_comments_160812.json:
```json
{
    "body": "<a id='comment:4'></a>It looks like the call you replaced is just completely broken and would throw `TypeError` when executed. I assume that this wasn't caught by a doctest. Could you write a doctest which goes through this code path?",
    "created_at": "2012-08-14T05:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160812",
    "user": "https://github.com/kini"
}
```

<a id='comment:4'></a>It looks like the call you replaced is just completely broken and would throw `TypeError` when executed. I assume that this wasn't caught by a doctest. Could you write a doctest which goes through this code path?



---

archive/issue_comments_160813.json:
```json
{
    "body": "<a id='comment:5'></a>It wasn't in the doctests. In fact the existence of 0-cost cycles in flows depends on the LP solver and the instance. Some LP solver simplifies the solution returning the minimum possible number of non zero variables.\n\nI added some very artificial doctests, but it does the job.",
    "created_at": "2012-08-14T08:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160813",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>It wasn't in the doctests. In fact the existence of 0-cost cycles in flows depends on the LP solver and the instance. Some LP solver simplifies the solution returning the minimum possible number of non zero variables.

I added some very artificial doctests, but it does the job.



---

archive/issue_comments_160814.json:
```json
{
    "body": "Attachment [trac_13362.patch](tarball://root/attachments/some-uuid/ticket13362/trac_13362.patch) by @dcoudert created at 2012-08-14 09:55:40\n\nwith doctests",
    "created_at": "2012-08-14T09:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160814",
    "user": "https://github.com/dcoudert"
}
```

Attachment [trac_13362.patch](tarball://root/attachments/some-uuid/ticket13362/trac_13362.patch) by @dcoudert created at 2012-08-14 09:55:40

with doctests



---

archive/issue_comments_160815.json:
```json
{
    "body": "<a id='comment:6'></a>every lines of the `_build_flow_graph` method have trailing white spaces. This is super boring!!! I have only removed those from edited lines, but I'm eager to remove all of them...",
    "created_at": "2012-08-14T09:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160815",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>every lines of the `_build_flow_graph` method have trailing white spaces. This is super boring!!! I have only removed those from edited lines, but I'm eager to remove all of them...



---

archive/issue_comments_160816.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-09-20T13:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160816",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_160817.json:
```json
{
    "body": "<a id='comment:7'></a>Well, then if doctests pass and the bug is fixed... `:-)`\n\nNathann",
    "created_at": "2012-09-20T13:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160817",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>Well, then if doctests pass and the bug is fixed... `:-)`

Nathann



---

archive/issue_events_037048.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-23T16:22:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13362#event-37048"
}
```



---

archive/issue_comments_160818.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-09-23T16:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13362",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13362#issuecomment-160818",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
