# Issue 13588: libGAP! -- create a Cython library interface to gap

archive/issues_013384.json:
```json
{
    "assignees": [
        "https://github.com/wdjoyner"
    ],
    "body": "Currently, libGAP doesn't give useful errors if something goes wrong during initialization.\n\nAlso, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n\n* Start with sage-5.6.beta3 or later.\n* Install [http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg)\n* Apply [attachment: 13588_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz) to the root repository\n* Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n* Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n* Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library\n* Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library\n* Apply [attachment: trac_13588_docbuild.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_docbuild.patch.gz) to the Sage library\n\nThe `trac_6391_*` patch has already been reviewed at #6391.\n\nDepends on #13211\nDepends on #13880\n\nCC:  @miguelmarco @sagetrac-tfeulner @gvol @simon-king-jena\n\nReviewer: **Dmitrii Pasechnik**\n\nAuthor: **Volker Braun**\n\nMerged: **sage-5.7.beta1**\n\nComponent: **group theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13588_\n\n",
    "closed_at": "2013-01-26T09:54:00Z",
    "created_at": "2012-10-08T21:03:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "libGAP! -- create a Cython library interface to gap",
    "type": "issue",
    "updated_at": "2013-01-30T07:44:29Z",
    "url": "https://github.com/sagemath/sage/issues/13588",
    "user": "https://github.com/vbraun"
}
```
Currently, libGAP doesn't give useful errors if something goes wrong during initialization.

Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.

* Start with sage-5.6.beta3 or later.
* Install [http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg)
* Apply [attachment: 13588_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz) to the root repository
* Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
* Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
* Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library
* Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library
* Apply [attachment: trac_13588_docbuild.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_docbuild.patch.gz) to the Sage library

The `trac_6391_*` patch has already been reviewed at #6391.

Depends on #13211
Depends on #13880

CC:  @miguelmarco @sagetrac-tfeulner @gvol @simon-king-jena

Reviewer: **Dmitrii Pasechnik**

Author: **Volker Braun**

Merged: **sage-5.7.beta1**

Component: **group theory**

_Issue created by migration from https://trac.sagemath.org/ticket/13588_





---

archive/issue_events_189871.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-08T21:03:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189871"
}
```



---

archive/issue_events_189872.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-08T21:03:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
    "label_color": "0000ff",
    "label_name": "c: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189872"
}
```



---

archive/issue_events_189873.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-08T21:03:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189873"
}
```



---

archive/issue_events_189874.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-08T21:03:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189874"
}
```



---

archive/issue_events_189875.json:
```json
{
    "actor": "https://github.com/wdjoyner",
    "created_at": "2012-10-08T21:03:45Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "subject": "https://github.com/vbraun",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189875"
}
```



---

archive/issue_comments_158953.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2012-10-09T10:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158953",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_189876.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-10-09T10:47:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189876"
}
```



---

archive/issue_comments_158954.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nMiguel, you said that you had some mysterious error. Can you try this patch? It depends on the recently-updated patches on #6391, #13211.",
    "created_at": "2012-10-09T10:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158954",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

Miguel, you said that you had some mysterious error. Can you try this patch? It depends on the recently-updated patches on #6391, #13211.



---

archive/issue_comments_158955.json:
```json
{
    "body": "Dependencies: **#6391, #13211**",
    "created_at": "2012-10-09T10:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158955",
    "user": "https://github.com/vbraun"
}
```

Dependencies: **#6391, #13211**



---

archive/issue_comments_158956.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI have been checking the different updates of libgap, and the error seemed to go away several versions ago. Anyways, i will keep testing it.",
    "created_at": "2012-10-09T11:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158956",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:2" align="right">comment:2</div>

I have been checking the different updates of libgap, and the error seemed to go away several versions ago. Anyways, i will keep testing it.



---

archive/issue_comments_158957.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI don't know if it is an issue related with this patch or if it comes from libgap itself, but i have experienced some problems when i use tab completion in a session in the command line (i haven't checked it in the notebook).\n\nAn example:\n\n```\nsage: F=libgap.eval('FreeGroup(2)')\nsage: (a,b)=F.GeneratorsOfGroup()\nsage: H=F/libgap([a^2,b^2,a*b*a*b])\nsage: H\n<fp group on the generators [ f1, f2 ]>\nsage: H.IsomorphismSimplifiedFpGroup()\n[ f1, f2 ] -> [ f1, f2 ]\nsage: H=F/libgap([a^2,b^2,a*b])    \nsage: c=H.Gene\nH.GeneralLinearGroup      H.GeneralisedEigenspaces  H.GeneralizedEigenvalues  H.GeneratorsOfIdeal\nH.GeneralOrthogonalGroup  H.GeneralisedEigenvalues  H.GeneratorsOfField       \nH.GeneralUnitaryGroup     H.GeneralizedEigenspaces  H.GeneratorsOfGroup       \nsage: c=H.GeneratorsOfGroup()[0]\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/home/mmarco/sage-5.4/<ipython console> in <module>()\n\n/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()\n\nAttributeError: Name \"GeneratorsOfGroup\" is not defined in GAP.\nsage: c=H.GeneratorsOfGroup()   \n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/home/mmarco/sage-5.4/<ipython console> in <module>()\n\n/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()\n\nAttributeError: Name \"GeneratorsOfGroup\" is not defined in GAP.\nsage: H\nException RuntimeError: 'Entered a critical block twice' in 'sage.libs.gap.util.error_handler' ignored\n<fp group on the generators [ f1, f2 ]>\nsage: H.GeneratorsOfGroup()\n[ f1, f2 ]\nsage: c=H.GeneratorsOfGroup()[0]\nsage: c\nf1\nsage: c=H.Generat\nH.GeneratorsOfField  H.GeneratorsOfGroup  H.GeneratorsOfIdeal  \nsage: c=H.GeneratorsOfGroup()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/home/mmarco/sage-5.4/<ipython console> in <module>()\n\n/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()\n\nAttributeError: Name \"GeneratorsOfGroup\" is not defined in GAP.\nsage: c=H.GeneratorsOfGroup()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/home/mmarco/sage-5.4/<ipython console> in <module>()\n\n/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()\n\nAttributeError: Name \"GeneratorsOfGroup\" is not defined in GAP.\nsage: H\nException RuntimeError: 'Entered a critical block twice' in 'sage.libs.gap.util.error_handler' ignored\n<fp group on the generators [ f1, f2 ]>\nsage: c=H.GeneratorsOfGroup()\n```",
    "created_at": "2012-10-11T20:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158957",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:3" align="right">comment:3</div>

I don't know if it is an issue related with this patch or if it comes from libgap itself, but i have experienced some problems when i use tab completion in a session in the command line (i haven't checked it in the notebook).

An example:

```
sage: F=libgap.eval('FreeGroup(2)')
sage: (a,b)=F.GeneratorsOfGroup()
sage: H=F/libgap([a^2,b^2,a*b*a*b])
sage: H
<fp group on the generators [ f1, f2 ]>
sage: H.IsomorphismSimplifiedFpGroup()
[ f1, f2 ] -> [ f1, f2 ]
sage: H=F/libgap([a^2,b^2,a*b])    
sage: c=H.Gene
H.GeneralLinearGroup      H.GeneralisedEigenspaces  H.GeneralizedEigenvalues  H.GeneratorsOfIdeal
H.GeneralOrthogonalGroup  H.GeneralisedEigenvalues  H.GeneratorsOfField       
H.GeneralUnitaryGroup     H.GeneralizedEigenspaces  H.GeneratorsOfGroup       
sage: c=H.GeneratorsOfGroup()[0]
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/mmarco/sage-5.4/<ipython console> in <module>()

/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()

AttributeError: Name "GeneratorsOfGroup" is not defined in GAP.
sage: c=H.GeneratorsOfGroup()   
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/mmarco/sage-5.4/<ipython console> in <module>()

/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()

AttributeError: Name "GeneratorsOfGroup" is not defined in GAP.
sage: H
Exception RuntimeError: 'Entered a critical block twice' in 'sage.libs.gap.util.error_handler' ignored
<fp group on the generators [ f1, f2 ]>
sage: H.GeneratorsOfGroup()
[ f1, f2 ]
sage: c=H.GeneratorsOfGroup()[0]
sage: c
f1
sage: c=H.Generat
H.GeneratorsOfField  H.GeneratorsOfGroup  H.GeneratorsOfIdeal  
sage: c=H.GeneratorsOfGroup()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/mmarco/sage-5.4/<ipython console> in <module>()

/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()

AttributeError: Name "GeneratorsOfGroup" is not defined in GAP.
sage: c=H.GeneratorsOfGroup()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/mmarco/sage-5.4/<ipython console> in <module>()

/home/mmarco/sage-5.4/local/lib/python2.7/site-packages/sage/libs/gap/element.so in sage.libs.gap.element.GapElement.__getattr__ (sage/libs/gap/element.c:3555)()

AttributeError: Name "GeneratorsOfGroup" is not defined in GAP.
sage: H
Exception RuntimeError: 'Entered a critical block twice' in 'sage.libs.gap.util.error_handler' ignored
<fp group on the generators [ f1, f2 ]>
sage: c=H.GeneratorsOfGroup()
```



---

archive/issue_comments_158958.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis same behaviour appears when i don't use this patch, so reported in the libgap ticket.",
    "created_at": "2012-10-12T13:42:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158958",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:4" align="right">comment:4</div>

This same behaviour appears when i don't use this patch, so reported in the libgap ticket.



---

archive/issue_comments_158959.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n Currently, libGAP doesn't give useful errors if something goes wrong during initialization.\n+\n+Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n+\n+Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)\n``````\n",
    "created_at": "2012-10-22T13:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158959",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 Currently, libGAP doesn't give useful errors if something goes wrong during initialization.
+
+Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
+
+Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)
``````




---

archive/issue_comments_158960.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nUpdated patch fixes the issue with the command line completion",
    "created_at": "2012-10-22T13:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158960",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

Updated patch fixes the issue with the command line completion



---

archive/issue_comments_158961.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nUpdated spkg fixes long input lines (>32k characters):\n\n```\nsage: S = SymmetricGroup(10000)\nsage: s = S.random_element()\nsage: len(str(s._gap_()))\n61673\nsage: libgap(s)\n(1,5243,8582,5012,6862,7477,1681,7423,8405,3101,...,5257,9362,2495,8500)( [...] )\n```",
    "created_at": "2012-11-09T19:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158961",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

Updated spkg fixes long input lines (>32k characters):

```
sage: S = SymmetricGroup(10000)
sage: s = S.random_element()
sage: len(str(s._gap_()))
61673
sage: libgap(s)
(1,5243,8582,5012,6862,7477,1681,7423,8405,3101,...,5257,9362,2495,8500)( [...] )
```



---

archive/issue_comments_158962.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n-Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)\n+Install [http://sagepad.org/spkg/libgap-4.5.6.p1.spkg](http://sagepad.org/spkg/libgap-4.5.6.p1.spkg)\n``````\n",
    "created_at": "2012-11-09T20:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158962",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
-Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)
+Install [http://sagepad.org/spkg/libgap-4.5.6.p1.spkg](http://sagepad.org/spkg/libgap-4.5.6.p1.spkg)
``````




---

archive/issue_comments_158963.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI've added the same workaround for the gap command line option issue as just discussed in #13211",
    "created_at": "2012-11-13T02:55:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158963",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

I've added the same workaround for the gap command line option issue as just discussed in #13211



---

archive/issue_comments_158964.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI've added `__nonzero__` for wrapped GAP booleans for easier use.",
    "created_at": "2012-11-16T00:21:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158964",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:10" align="right">comment:10</div>

I've added `__nonzero__` for wrapped GAP booleans for easier use.



---

archive/issue_comments_158965.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-11-20T01:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158965",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_158966.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAttachment: **[trac_13588_improve_libGAP.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz)**\n\nThe new patch allows to change the comparison method for libgap objects since not all GAP objects can be compared. This is important if you want use them as cache keys.\n\nAlso, the comparison was not properly wrapped in `sig_on/sig_off`",
    "created_at": "2012-11-20T01:23:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158966",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

Attachment: **[trac_13588_improve_libGAP.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz)**

The new patch allows to change the comparison method for libgap objects since not all GAP objects can be compared. This is important if you want use them as cache keys.

Also, the comparison was not properly wrapped in `sig_on/sig_off`



---

archive/issue_comments_158967.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI forgot to package `aclocal.m4`, updated spkg adds that file.",
    "created_at": "2012-12-18T12:16:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158967",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:12" align="right">comment:12</div>

I forgot to package `aclocal.m4`, updated spkg adds that file.



---

archive/issue_comments_158968.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n-Install [http://sagepad.org/spkg/libgap-4.5.6.p1.spkg](http://sagepad.org/spkg/libgap-4.5.6.p1.spkg)\n+Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)\n``````\n",
    "created_at": "2012-12-18T12:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158968",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
-Install [http://sagepad.org/spkg/libgap-4.5.6.p1.spkg](http://sagepad.org/spkg/libgap-4.5.6.p1.spkg)
+Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)
``````




---

archive/issue_comments_158969.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n-Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)\n+Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n``````\n",
    "created_at": "2012-12-26T13:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158969",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
-Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.6.p1.spkg)
+Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
``````




---

archive/issue_comments_158970.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nUpdated to libGap-4.5.7",
    "created_at": "2012-12-26T13:04:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158970",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

Updated to libGap-4.5.7



---

archive/issue_comments_158971.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,9 @@\n \n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n-Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n+* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg) from #13211\n+* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n+* Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n+* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n+\n+The patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n``````\n",
    "created_at": "2012-12-26T13:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158971",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,9 @@
 
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
-Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
+* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg) from #13211
+* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
+* Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
+* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
+
+The patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
``````




---

archive/issue_comments_158972.json:
```json
{
    "body": "Changed dependencies from **#6391, #13211** to **#13211**",
    "created_at": "2012-12-26T13:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158972",
    "user": "https://github.com/vbraun"
}
```

Changed dependencies from **#6391, #13211** to **#13211**



---

archive/issue_comments_158973.json:
```json
{
    "body": "patch from #6391",
    "created_at": "2012-12-26T13:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158973",
    "user": "https://github.com/vbraun"
}
```

patch from #6391



---

archive/issue_comments_158974.json:
```json
{
    "body": "Attachment: **[trac_6391_libGAP.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz)**\n\nAttachment: **[trac_6391_libGAP_root.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz)**\n\npatch from #6391",
    "created_at": "2012-12-26T13:12:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158974",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_6391_libGAP.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz)**

Attachment: **[trac_6391_libGAP_root.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz)**

patch from #6391



---

archive/issue_comments_158975.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,8 @@\n \n * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg) from #13211\n * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n+* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n-* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n+* Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n \n The patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n``````\n",
    "created_at": "2012-12-26T13:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158975",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,8 @@
 
 * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg) from #13211
 * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
+* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
-* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
+* Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
 
 The patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
``````




---

archive/issue_comments_158976.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n \n-The patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n+The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n``````\n",
    "created_at": "2012-12-26T13:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158976",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
 
-The patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
+The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
``````




---

archive/issue_events_189877.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-26T13:48:51Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "title_is": "libGAP! -- create a Cython library interface to gap",
    "title_was": "Improve libGAP startup error handling",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189877"
}
```



---

archive/issue_events_189878.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-26T13:48:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189878"
}
```



---

archive/issue_events_189879.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-26T13:48:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189879"
}
```



---

archive/issue_comments_158977.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI still see the segfault when trying to execute \"Exec\" trough libgap. This seems to make it impossible to load gap packages that make use of external programs.",
    "created_at": "2012-12-27T12:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158977",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:21" align="right">comment:21</div>

I still see the segfault when trying to execute "Exec" trough libgap. This seems to make it impossible to load gap packages that make use of external programs.



---

archive/issue_comments_158978.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThanks for reminding me, I completely forgot about the Exec thing.\n\nIn the meantime, can we get this reviewed and included into Sage before the next GAP version comes out?",
    "created_at": "2012-12-27T12:27:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158978",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:22" align="right">comment:22</div>

Thanks for reminding me, I completely forgot about the Exec thing.

In the meantime, can we get this reviewed and included into Sage before the next GAP version comes out?



---

archive/issue_comments_158979.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI've replaced the spkg with a new version that fixes the GAP Exec command.",
    "created_at": "2012-12-27T12:47:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158979",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">comment:23</div>

I've replaced the spkg with a new version that fixes the GAP Exec command.



---

archive/issue_comments_158980.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,5 +7,6 @@\n * Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n+* Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library\n \n The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n``````\n",
    "created_at": "2012-12-27T12:47:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158980",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,5 +7,6 @@
 * Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
+* Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library
 
 The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
``````




---

archive/issue_comments_158981.json:
```json
{
    "body": "Attachment: **[trac_13588_exec_fix.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz)**\n\nUpdated patch",
    "created_at": "2012-12-27T12:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158981",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13588_exec_fix.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz)**

Updated patch



---

archive/issue_comments_158982.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThanks. Still i can't load the kbmag package :(",
    "created_at": "2012-12-27T13:17:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158982",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:24" align="right">comment:24</div>

Thanks. Still i can't load the kbmag package :(



---

archive/issue_comments_158983.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI've updated the spkg, now loading kbmag works for me. I had to install it by hand since your spkg at #13673 is offline.",
    "created_at": "2012-12-27T14:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158983",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

I've updated the spkg, now loading kbmag works for me. I had to install it by hand since your spkg at #13673 is offline.



---

archive/issue_comments_158984.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI get a slew of errors in ptestlong after following the instructions of the ticket with Sage 5.5; e.g.:\n\n```\nsage -t  --long -force_lib devel/sage/sage/libs/gap/libgap.pyx\n**********************************************************************\nFile \"/usr/local/src/sage/sage-5.5/devel/sage-main/sage/libs/gap/libgap.pyx\", line 11:\n    sage: a = libgap(10)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.5/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[2]>\", line 1, in <module>\n        a = libgap(Integer(10))###line 11:\n    sage: a = libgap(10)\n      File \"lazy_import.pyx\", line 244, in sage.misc.lazy_import.LazyImport.__call__ (sage/misc/lazy_import.c:2012)\n      File \"lazy_import.pyx\", line 148, in sage.misc.lazy_import.LazyImport._get_object (sage/misc/lazy_import.c:1291)\n      File \"libgap.pyx\", line 574, in init sage.libs.gap.libgap (sage/libs/gap/libgap.c:4157)\n        libgap = Gap()\n      File \"libgap.pyx\", line 395, in sage.libs.gap.libgap.Gap.__init__ (sage/libs/gap/libgap.c:2716)\n        initialize()\n      File \"util.pyx\", line 193, in sage.libs.gap.util.initialize (sage/libs/gap/util.c:3312)\n        from sage.interfaces.gap import get_gap_memory_pool_size\n    ImportError: cannot import name get_gap_memory_pool_size\n**********************************************************************\nFile \"/usr/local/src/sage/sage-5.5/devel/sage-main/sage/libs/gap/libgap.pyx\", line 12:\n    sage: a\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.5/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[3]>\", line 1, in <module>\n        a###line 12:\n    sage: a\n    NameError: name 'a' is not defined\n\n```\n\nare some patches missing or not up date?",
    "created_at": "2013-01-02T15:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158984",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

I get a slew of errors in ptestlong after following the instructions of the ticket with Sage 5.5; e.g.:

```
sage -t  --long -force_lib devel/sage/sage/libs/gap/libgap.pyx
**********************************************************************
File "/usr/local/src/sage/sage-5.5/devel/sage-main/sage/libs/gap/libgap.pyx", line 11:
    sage: a = libgap(10)
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.5/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[2]>", line 1, in <module>
        a = libgap(Integer(10))###line 11:
    sage: a = libgap(10)
      File "lazy_import.pyx", line 244, in sage.misc.lazy_import.LazyImport.__call__ (sage/misc/lazy_import.c:2012)
      File "lazy_import.pyx", line 148, in sage.misc.lazy_import.LazyImport._get_object (sage/misc/lazy_import.c:1291)
      File "libgap.pyx", line 574, in init sage.libs.gap.libgap (sage/libs/gap/libgap.c:4157)
        libgap = Gap()
      File "libgap.pyx", line 395, in sage.libs.gap.libgap.Gap.__init__ (sage/libs/gap/libgap.c:2716)
        initialize()
      File "util.pyx", line 193, in sage.libs.gap.util.initialize (sage/libs/gap/util.c:3312)
        from sage.interfaces.gap import get_gap_memory_pool_size
    ImportError: cannot import name get_gap_memory_pool_size
**********************************************************************
File "/usr/local/src/sage/sage-5.5/devel/sage-main/sage/libs/gap/libgap.pyx", line 12:
    sage: a
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.5/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/usr/local/src/sage/sage-5.5/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[3]>", line 1, in <module>
        a###line 12:
    sage: a
    NameError: name 'a' is not defined

```

are some patches missing or not up date?



---

archive/issue_comments_158985.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nDid you apply the patches from #13211? The `get_gap_memory_pool_size()` function was added in `trac_13211_fix_gap_doctests_vb.patch`.",
    "created_at": "2013-01-02T16:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158985",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:27" align="right">comment:27</div>

Did you apply the patches from #13211? The `get_gap_memory_pool_size()` function was added in `trac_13211_fix_gap_doctests_vb.patch`.



---

archive/issue_comments_158986.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@vbraun](#comment:27):\n> Did you apply the patches from #13211? The `get_gap_memory_pool_size()` function was added in `trac_13211_fix_gap_doctests_vb.patch`.\n\nindeed, I overlooked that #13211 isn't merged in 5.5. Sorry for noise.",
    "created_at": "2013-01-02T16:52:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158986",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@vbraun](#comment:27):
> Did you apply the patches from #13211? The `get_gap_memory_pool_size()` function was added in `trac_13211_fix_gap_doctests_vb.patch`.

indeed, I overlooked that #13211 isn't merged in 5.5. Sorry for noise.



---

archive/issue_comments_158987.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nDoes sig_on() need a matching sig_off() in case sig_on() is issued in a try block, which throws an exception?\n\nComparison functions returning -1, 0, +1... So FORTRAN |V... :-)",
    "created_at": "2013-01-02T17:41:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158987",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

Does sig_on() need a matching sig_off() in case sig_on() is issued in a try block, which throws an exception?

Comparison functions returning -1, 0, +1... So FORTRAN |V... :-)



---

archive/issue_comments_158988.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\n`sig_on` and `sig_off` must be paired, though ideally they enclose only C/Cython code which cannot raise Python exceptions. A C signal will jump back to `sig_on` and raise there.\n\nhttp://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off",
    "created_at": "2013-01-02T17:57:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158988",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:30" align="right">comment:30</div>

`sig_on` and `sig_off` must be paired, though ideally they enclose only C/Cython code which cannot raise Python exceptions. A C signal will jump back to `sig_on` and raise there.

http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off



---

archive/issue_comments_158989.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\npatches from #13880 are needed for doctests to (eventually) pass here.",
    "created_at": "2013-01-03T03:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158989",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

patches from #13880 are needed for doctests to (eventually) pass here.



---

archive/issue_comments_158990.json:
```json
{
    "body": "Changed dependencies from **#13211** to **#13211, #13880**",
    "created_at": "2013-01-03T03:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158990",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#13211** to **#13211, #13880**



---

archive/issue_events_189880.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-01-05T05:09:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189880"
}
```



---

archive/issue_events_189881.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2013-01-05T05:09:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189881"
}
```



---

archive/issue_comments_158991.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n-* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg) from #13211\n+* Start with sage-5.6.beta1 or later.\n * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n * Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n``````\n",
    "created_at": "2013-01-10T10:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158991",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
-* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/gap-4.5.7.p1.spkg) from #13211
+* Start with sage-5.6.beta1 or later.
 * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
 * Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
``````




---

archive/issue_comments_158992.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n-* Start with sage-5.6.beta1 or later.\n+* Start with sage-5.6.beta3 or later.\n * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n * Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n``````\n",
    "created_at": "2013-01-10T10:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158992",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
-* Start with sage-5.6.beta1 or later.
+* Start with sage-5.6.beta3 or later.
 * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
 * Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
``````




---

archive/issue_comments_158993.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nIs the test program `sage/libs/gap/test/main.c` used anywhere in the Sage library?  I don't mind having such a program, but I'd say it belongs in the libgap spkg and not in the Sage library.  It could be run when installing libGAP.",
    "created_at": "2013-01-10T13:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158993",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

Is the test program `sage/libs/gap/test/main.c` used anywhere in the Sage library?  I don't mind having such a program, but I'd say it belongs in the libgap spkg and not in the Sage library.  It could be run when installing libGAP.



---

archive/issue_comments_158994.json:
```json
{
    "body": "Reviewer: **Dmitrii Pasechnik**",
    "created_at": "2013-01-10T13:38:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158994",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Dmitrii Pasechnik**



---

archive/issue_comments_158995.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\n`sage/libs/gap/test/main.c` is not used anywhere. As the readme file explains, it is there if you need an example for how to link with libGAP without Sage. This can be useful for debugging. LibGAP has its own testsuite.",
    "created_at": "2013-01-10T13:48:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158995",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:37" align="right">comment:37</div>

`sage/libs/gap/test/main.c` is not used anywhere. As the readme file explains, it is there if you need an example for how to link with libGAP without Sage. This can be useful for debugging. LibGAP has its own testsuite.



---

archive/issue_events_189882.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-10T14:57:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189882"
}
```



---

archive/issue_events_189883.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-10T14:57:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189883"
}
```



---

archive/issue_comments_158996.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nlibgap tries to run various autotools, which should be avoided (as it can lead to build errors).  Probably this is simply timestamps were clobbered during the packaging.\n\n```\nlibgap-4.5.7.log:WARNING: 'aclocal-1.12' is missing on your system.  You should only need it if\nlibgap-4.5.7.log:WARNING: 'automake-1.12' is missing on your system.  You should only need it if\nlibgap-4.5.7.log:WARNING: 'autoconf' is missing on your system.  You should only need it if\nlibgap-4.5.7.log:WARNING: 'autoheader' is missing on your system.  You should only need it if\n```",
    "created_at": "2013-01-10T14:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158996",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

libgap tries to run various autotools, which should be avoided (as it can lead to build errors).  Probably this is simply timestamps were clobbered during the packaging.

```
libgap-4.5.7.log:WARNING: 'aclocal-1.12' is missing on your system.  You should only need it if
libgap-4.5.7.log:WARNING: 'automake-1.12' is missing on your system.  You should only need it if
libgap-4.5.7.log:WARNING: 'autoconf' is missing on your system.  You should only need it if
libgap-4.5.7.log:WARNING: 'autoheader' is missing on your system.  You should only need it if
```



---

archive/issue_comments_158997.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nOk I've regenerated the files and checked that it builds without the WARNING on an older machine. Spkg at the same place.",
    "created_at": "2013-01-10T19:08:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158997",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">comment:39</div>

Ok I've regenerated the files and checked that it builds without the WARNING on an older machine. Spkg at the same place.



---

archive/issue_events_189884.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-10T19:08:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189884"
}
```



---

archive/issue_events_189885.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-10T19:08:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189885"
}
```



---

archive/issue_comments_158998.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nWhile building the documentation with this patch included, twice something went wrong.\n1. First time, I got an \"unhandled SIGSEGV\" in Sage while reading the sources of some elliptic curve file (sorry, forgot which one) for the PDF documentation.  I didn't store the exact logs since I thought it was a cosmic ray or something...\n2. Next attempt, building from scratch again during the build of the HTML documentation:\n\n```\nreading sources... [ 86%] sage/schemes/elliptic_curves/cm\nreading sources... [ 87%] sage/schemes/elliptic_curves/constructor\nreading sources... [ 87%] sage/schemes/elliptic_curves/ec_database\nreading sources... [ 87%] sage/schemes/elliptic_curves/ell_curve_isogeny\nreading sources... [ 87%] sage/schemes/elliptic_curves/ell_field\nreading sources... [ 87%] sage/schemes/elliptic_curves/ell_finite_field\nreading sources... [ 87%] sage/schemes/elliptic_curves/ell_generic\n\nException occurred:\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/environment.py\", line 831, in read_doc\n    pickle.dump(doctree, f, pickle.HIGHEST_PROTOCOL)\nMemoryError\nThe full traceback has been saved in /tmp/release/sphinx-err-QDcECu.log, if you want to report the issue to the developers.\n```\n\nFull traceback:\n\n```\n# Sphinx version: 1.1.2\n# Python version: 2.7.3\n# Docutils version: 0.7 release\n# Jinja2 version: 2.5.5\nTraceback (most recent call last):\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/cmdline.py\", line 189, in main\n    app.build(force_all, filenames)\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/application.py\", line 204, in build\n    self.builder.build_update()\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/builders/__init__.py\", line 196, in build_update\n    'out of date' % len(to_build))\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/builders/__init__.py\", line 216, in build\n    purple, length):\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/builders/__init__.py\", line 120, in status_iterator\n    for item in iterable:\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/environment.py\", line 616, in update_generator\n    self.read_doc(docname, app=app)\n  File \"/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/environment.py\", line 831, in read_doc\n    pickle.dump(doctree, f, pickle.HIGHEST_PROTOCOL)\nMemoryError\n```\n\nI cannot say for sure that this ticket is to blame, but the `MemoryError` certainly made me suspect GAP. And I also saw some \"halving pool size\" messages appear during the docbuilding.",
    "created_at": "2013-01-11T09:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158998",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

While building the documentation with this patch included, twice something went wrong.
1. First time, I got an "unhandled SIGSEGV" in Sage while reading the sources of some elliptic curve file (sorry, forgot which one) for the PDF documentation.  I didn't store the exact logs since I thought it was a cosmic ray or something...
2. Next attempt, building from scratch again during the build of the HTML documentation:

```
reading sources... [ 86%] sage/schemes/elliptic_curves/cm
reading sources... [ 87%] sage/schemes/elliptic_curves/constructor
reading sources... [ 87%] sage/schemes/elliptic_curves/ec_database
reading sources... [ 87%] sage/schemes/elliptic_curves/ell_curve_isogeny
reading sources... [ 87%] sage/schemes/elliptic_curves/ell_field
reading sources... [ 87%] sage/schemes/elliptic_curves/ell_finite_field
reading sources... [ 87%] sage/schemes/elliptic_curves/ell_generic

Exception occurred:
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/environment.py", line 831, in read_doc
    pickle.dump(doctree, f, pickle.HIGHEST_PROTOCOL)
MemoryError
The full traceback has been saved in /tmp/release/sphinx-err-QDcECu.log, if you want to report the issue to the developers.
```

Full traceback:

```
# Sphinx version: 1.1.2
# Python version: 2.7.3
# Docutils version: 0.7 release
# Jinja2 version: 2.5.5
Traceback (most recent call last):
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/cmdline.py", line 189, in main
    app.build(force_all, filenames)
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/application.py", line 204, in build
    self.builder.build_update()
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/builders/__init__.py", line 196, in build_update
    'out of date' % len(to_build))
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/builders/__init__.py", line 216, in build
    purple, length):
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/builders/__init__.py", line 120, in status_iterator
    for item in iterable:
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/environment.py", line 616, in update_generator
    self.read_doc(docname, app=app)
  File "/release/merger/sage-5.7.alpha0/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/environment.py", line 831, in read_doc
    pickle.dump(doctree, f, pickle.HIGHEST_PROTOCOL)
MemoryError
```

I cannot say for sure that this ticket is to blame, but the `MemoryError` certainly made me suspect GAP. And I also saw some "halving pool size" messages appear during the docbuilding.



---

archive/issue_comments_158999.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@jdemeyer](#comment:40):\n> While building the documentation with this patch included, twice something went wrong.\n> 1. First time, I got an \"unhandled SIGSEGV\" in Sage while reading the sources of some elliptic curve file (sorry, forgot which one) for the PDF documentation.  I didn't store the exact logs since I thought it was a cosmic ray or something...\n> 2. Next attempt, building from scratch again during the build of the HTML documentation:\n\nif this happens on one host only, I'd blame the RAM there.",
    "created_at": "2013-01-11T09:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-158999",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@jdemeyer](#comment:40):
> While building the documentation with this patch included, twice something went wrong.
> 1. First time, I got an "unhandled SIGSEGV" in Sage while reading the sources of some elliptic curve file (sorry, forgot which one) for the PDF documentation.  I didn't store the exact logs since I thought it was a cosmic ray or something...
> 2. Next attempt, building from scratch again during the build of the HTML documentation:

if this happens on one host only, I'd blame the RAM there.



---

archive/issue_comments_159000.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@dimpase](#comment:41):\n> if this happens on one host only, I'd blame the RAM there.\n\nIf this happens *only* with the libGAP patches, I'd blame libGAP.  Besides, why would faulty RAM lead to a `MemoryError` exception?",
    "created_at": "2013-01-11T09:57:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159000",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@dimpase](#comment:41):
> if this happens on one host only, I'd blame the RAM there.

If this happens *only* with the libGAP patches, I'd blame libGAP.  Besides, why would faulty RAM lead to a `MemoryError` exception?



---

archive/issue_comments_159001.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nAll GAP/libGAP processes should be terminated by the time we are building the manual, so I don't see how we could possibly impact that.\n\nIs this a 32-bit machine? There you might run into warts caused by the limited address space, and the halving pool size would support that. Sphinx uses quite a lot of memory and might fail to load its pickles if there is no memory left **or** no contiguous address space block available.",
    "created_at": "2013-01-11T10:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159001",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:43" align="right">comment:43</div>

All GAP/libGAP processes should be terminated by the time we are building the manual, so I don't see how we could possibly impact that.

Is this a 32-bit machine? There you might run into warts caused by the limited address space, and the halving pool size would support that. Sphinx uses quite a lot of memory and might fail to load its pickles if there is no memory left **or** no contiguous address space block available.



---

archive/issue_comments_159002.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@vbraun](#comment:43):\n> All GAP/libGAP processes should be terminated by the time we are building the manual\n\nNot really, as building the manual runs Sage code (as witnessed for example that Segmentation Faults run the Sage signal handler and display \"Unhandled SIGSEGV...\")",
    "created_at": "2013-01-11T10:22:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159002",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@vbraun](#comment:43):
> All GAP/libGAP processes should be terminated by the time we are building the manual

Not really, as building the manual runs Sage code (as witnessed for example that Segmentation Faults run the Sage signal handler and display "Unhandled SIGSEGV...")



---

archive/issue_comments_159003.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@jdemeyer](#comment:44):\n> Not really, as building the manual runs Sage code (as witnessed for example that Segmentation Faults run the Sage signal handler and display \"Unhandled SIGSEGV...\")\n\nTheoretically true, but a normal Sage session won't start GAP until it has to and libGAP is lazily imported as well. Even then, none of that has anything to do with the elliptic curve stuff. \n\nRight now the only thing in this ticket that seems to actually influence the docbuild is that the documentation becomes larger.",
    "created_at": "2013-01-11T10:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159003",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@jdemeyer](#comment:44):
> Not really, as building the manual runs Sage code (as witnessed for example that Segmentation Faults run the Sage signal handler and display "Unhandled SIGSEGV...")

Theoretically true, but a normal Sage session won't start GAP until it has to and libGAP is lazily imported as well. Even then, none of that has anything to do with the elliptic curve stuff. 

Right now the only thing in this ticket that seems to actually influence the docbuild is that the documentation becomes larger.



---

archive/issue_comments_159004.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@vbraun](#comment:45):\n> Theoretically true, but a normal Sage session won't start GAP until it has to and libGAP is lazily imported as well.\n\nThe fact that I'm seeing \"halving pool size\" messages during the docbuilding proves that GAP is started.",
    "created_at": "2013-01-11T10:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159004",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@vbraun](#comment:45):
> Theoretically true, but a normal Sage session won't start GAP until it has to and libGAP is lazily imported as well.

The fact that I'm seeing "halving pool size" messages during the docbuilding proves that GAP is started.



---

archive/issue_comments_159005.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@jdemeyer](#comment:46):\n> The fact that I'm seeing \"halving pool size\" messages during the docbuilding proves that GAP is started.\n\nThat indeed means that something is wonky. We are trying hard to pick a pool size that **should fit into memory** yet it doesn't. As I said before, this means that either there is very little memory to start with or the available address space is so fragmented that there is no contiguous piece left (32-bit only).",
    "created_at": "2013-01-11T12:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159005",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@jdemeyer](#comment:46):
> The fact that I'm seeing "halving pool size" messages during the docbuilding proves that GAP is started.

That indeed means that something is wonky. We are trying hard to pick a pool size that **should fit into memory** yet it doesn't. As I said before, this means that either there is very little memory to start with or the available address space is so fragmented that there is no contiguous piece left (32-bit only).



---

archive/issue_comments_159006.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI guess sphinx has to resolve the lazy imports in order to get at the docstrings? That would pull in libGAP, which then subtracts ~250MB from the available address space. On a 32-bit machine that might push you over the cliff since sphinx is the most memory-demanding piece of the whole sage build process. Can you tell us which architecture we are talking about?",
    "created_at": "2013-01-11T12:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159006",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">comment:48</div>

I guess sphinx has to resolve the lazy imports in order to get at the docstrings? That would pull in libGAP, which then subtracts ~250MB from the available address space. On a 32-bit machine that might push you over the cliff since sphinx is the most memory-demanding piece of the whole sage build process. Can you tell us which architecture we are talking about?



---

archive/issue_comments_159007.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nSorry, I wasn't immediately aware of this, but this was with `ulimit -v 2500000` (2.5GB) set on a 64-bit system.",
    "created_at": "2013-01-11T12:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159007",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">comment:49</div>

Sorry, I wasn't immediately aware of this, but this was with `ulimit -v 2500000` (2.5GB) set on a 64-bit system.



---

archive/issue_events_189886.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-12T21:51:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189886"
}
```



---

archive/issue_events_189887.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-12T21:51:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189887"
}
```



---

archive/issue_comments_159008.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nThis needs a patch to `MANIFEST.in` to add the `Makefile` (but again: I doubt that this really belongs in the Sage library).",
    "created_at": "2013-01-12T21:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159008",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:50" align="right">comment:50</div>

This needs a patch to `MANIFEST.in` to add the `Makefile` (but again: I doubt that this really belongs in the Sage library).



---

archive/issue_comments_159009.json:
```json
{
    "body": "Attachment: **[trac_13588_manifest.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz)**\n\nInitial patch",
    "created_at": "2013-01-13T21:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159009",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13588_manifest.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz)**

Initial patch



---

archive/issue_comments_159010.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,5 +8,6 @@\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library\n+* Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library\n \n The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n``````\n",
    "created_at": "2013-01-13T21:09:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159010",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,5 +8,6 @@
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library
+* Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library
 
 The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
``````




---

archive/issue_events_189888.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-13T21:09:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189888"
}
```



---

archive/issue_events_189889.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-13T21:09:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189889"
}
```



---

archive/issue_comments_159011.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI've added it to the manifest. I do think it is useful, when I started working on libgap that was one of the first things that I had to figure out.",
    "created_at": "2013-01-13T21:09:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159011",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:51" align="right">comment:51</div>

I've added it to the manifest. I do think it is useful, when I started working on libgap that was one of the first things that I had to figure out.



---

archive/issue_comments_159012.json:
```json
{
    "body": "Attachment: **[13588_libGAP_root.patch.gz](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz)**",
    "created_at": "2013-01-15T09:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159012",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[13588_libGAP_root.patch.gz](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz)**



---

archive/issue_comments_159013.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,10 +4,10 @@\n \n * Start with sage-5.6.beta3 or later.\n * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n-* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository\n+* Apply [attachment: 13588_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz) to the root repository\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library\n \n-The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.\n+The `trac_6391_*` patch has already been reviewed at #6391.\n``````\n",
    "created_at": "2013-01-15T09:37:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159013",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,10 +4,10 @@
 
 * Start with sage-5.6.beta3 or later.
 * Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
-* Apply [attachment: trac_6391_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP_root.patch.gz) to the root repository
+* Apply [attachment: 13588_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz) to the root repository
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library
 
-The `trac_6391_*` patches have already been reviewed at #6391, I'm just attaching them to this ticket for convenience.
+The `trac_6391_*` patch has already been reviewed at #6391.
``````




---

archive/issue_events_189890.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T09:37:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189890"
}
```



---

archive/issue_events_189891.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T09:37:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189891"
}
```



---

archive/issue_comments_159014.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nNew `SAGE_ROOT` patch which adds libgap as dependency of the Sage library.",
    "created_at": "2013-01-15T09:37:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159014",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">comment:53</div>

New `SAGE_ROOT` patch which adds libgap as dependency of the Sage library.



---

archive/issue_events_189892.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T09:37:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189892"
}
```



---

archive/issue_events_189893.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-15T09:37:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189893"
}
```



---

archive/issue_events_189894.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-15T09:50:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189894"
}
```



---

archive/issue_events_189895.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-15T09:50:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189895"
}
```



---

archive/issue_comments_159015.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nLooks good to me!",
    "created_at": "2013-01-15T09:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159015",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:54" align="right">comment:54</div>

Looks good to me!



---

archive/issue_comments_159016.json:
```json
{
    "body": "Patch needed for SPARC",
    "created_at": "2013-01-17T19:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159016",
    "user": "https://github.com/jdemeyer"
}
```

Patch needed for SPARC



---

archive/issue_comments_159017.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nAttachment: **[libgap_sparc.patch.gz](https://github.com/sagemath/sage/files/ticket13588/libgap_sparc.patch.gz)**\n\n[attachment: libgap_sparc.patch](https://github.com/sagemath/sage/files/ticket13588/libgap_sparc.patch.gz) must be added to the spkg to work on SPARC.",
    "created_at": "2013-01-17T19:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159017",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

Attachment: **[libgap_sparc.patch.gz](https://github.com/sagemath/sage/files/ticket13588/libgap_sparc.patch.gz)**

[attachment: libgap_sparc.patch](https://github.com/sagemath/sage/files/ticket13588/libgap_sparc.patch.gz) must be added to the spkg to work on SPARC.



---

archive/issue_events_189896.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-17T19:23:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189896"
}
```



---

archive/issue_events_189897.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-17T19:23:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189897"
}
```



---

archive/issue_comments_159018.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nThanks. I've added it to the symbol rewriting code in the `make_spkg.sh` script.\n\n```\n#ifdef SPARC\n#if SPARC\n        asm(\"           .globl  SparcStackFuncBags              \");\n        asm(\"   SparcStackFuncBags:                             \");\n        asm(\"           ta      0x3     ! ST_FLUSH_WINDOWS      \");\n        asm(\"           mov     %sp,%o0                         \");\n        asm(\"           retl                                    \");\n        asm(\"           nop                                     \");\n#endif\n#endif\n\n/* sunos */\n#ifdef SPARC\n#if SPARC\n        asm(\"           .globl  _SparcStackFuncBags             \");\n        asm(\"   _SparcStackFuncBags:                            \");\n        asm(\"           ta      0x3     ! ST_FLUSH_WINDOWS      \");\n        asm(\"           mov     %sp,%o0                         \");\n        asm(\"           retl                                    \");\n        asm(\"           nop                                     \");\n#endif\n#endif\n#else\n#if defined(SPARC) && SPARC\nvoid SparcStackFuncBags( void )\n{\n  asm (\" ta 0x3 \");\n  asm (\" mov %sp,%o0\" );\n  return;\n}\n#endif\n```\nI presume the offending code has grown organically over the decades...",
    "created_at": "2013-01-17T19:47:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159018",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:56" align="right">comment:56</div>

Thanks. I've added it to the symbol rewriting code in the `make_spkg.sh` script.

```
#ifdef SPARC
#if SPARC
        asm("           .globl  SparcStackFuncBags              ");
        asm("   SparcStackFuncBags:                             ");
        asm("           ta      0x3     ! ST_FLUSH_WINDOWS      ");
        asm("           mov     %sp,%o0                         ");
        asm("           retl                                    ");
        asm("           nop                                     ");
#endif
#endif

/* sunos */
#ifdef SPARC
#if SPARC
        asm("           .globl  _SparcStackFuncBags             ");
        asm("   _SparcStackFuncBags:                            ");
        asm("           ta      0x3     ! ST_FLUSH_WINDOWS      ");
        asm("           mov     %sp,%o0                         ");
        asm("           retl                                    ");
        asm("           nop                                     ");
#endif
#endif
#else
#if defined(SPARC) && SPARC
void SparcStackFuncBags( void )
{
  asm (" ta 0x3 ");
  asm (" mov %sp,%o0" );
  return;
}
#endif
```
I presume the offending code has grown organically over the decades...



---

archive/issue_events_189898.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-17T19:57:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189898"
}
```



---

archive/issue_events_189899.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-17T19:57:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189899"
}
```



---

archive/issue_comments_159019.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nThe similar operation needs to be done for\n\n```\nItaniumRegisterStackTop\n```",
    "created_at": "2013-01-18T16:04:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159019",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>

The similar operation needs to be done for

```
ItaniumRegisterStackTop
```



---

archive/issue_events_189900.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-18T16:04:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189900"
}
```



---

archive/issue_events_189901.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-18T16:04:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189901"
}
```



---

archive/issue_comments_159020.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nAlso: please remove `src/src/gasman.c.orig`",
    "created_at": "2013-01-18T16:07:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159020",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

Also: please remove `src/src/gasman.c.orig`



---

archive/issue_comments_159021.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nYay, more conditional compilation ;-)  I've added the conditional `itanium.s` source. I also changed the `make_spkg.sh` script to start from the tarball, so no superfluous files should be included. I tested the new spkg (same location) successfully on sage.math and iras.",
    "created_at": "2013-01-18T16:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159021",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:60" align="right">comment:60</div>

Yay, more conditional compilation ;-)  I've added the conditional `itanium.s` source. I also changed the `make_spkg.sh` script to start from the tarball, so no superfluous files should be included. I tested the new spkg (same location) successfully on sage.math and iras.



---

archive/issue_events_189902.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-18T16:57:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189902"
}
```



---

archive/issue_events_189903.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-18T16:57:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189903"
}
```



---

archive/issue_comments_159022.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nReplying to [@vbraun](#comment:60):\n> I tested the new spkg\n\nI assume that also includes running libgap doctests, because that's where the error shows up.",
    "created_at": "2013-01-18T17:10:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159022",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">comment:62</div>

Replying to [@vbraun](#comment:60):
> I tested the new spkg

I assume that also includes running libgap doctests, because that's where the error shows up.



---

archive/issue_comments_159023.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nWell I checked that `itanium.s` is compiled and linked into libgap on iras.",
    "created_at": "2013-01-18T18:31:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159023",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:63" align="right">comment:63</div>

Well I checked that `itanium.s` is compiled and linked into libgap on iras.



---

archive/issue_comments_159024.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nI compiled sage on iras overnight and doctests pass, too ;-)",
    "created_at": "2013-01-19T12:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159024",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:64" align="right">comment:64</div>

I compiled sage on iras overnight and doctests pass, too ;-)



---

archive/issue_comments_159025.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nSomething went wrong with your search/replace script, on `mark` (Solaris):\n\n```\nld.so.1: python2.7: fatal: relocation error: file /home/buildbot/build/sage/mark-1/mark_full/build/sage-5.7.beta0/local/lib/libgap.so.0: symbol libGAP_libGAP_SparcStackFuncBags: referenced symbol not found\n```",
    "created_at": "2013-01-21T07:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159025",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:65" align="right">comment:65</div>

Something went wrong with your search/replace script, on `mark` (Solaris):

```
ld.so.1: python2.7: fatal: relocation error: file /home/buildbot/build/sage/mark-1/mark_full/build/sage-5.7.beta0/local/lib/libgap.so.0: symbol libGAP_libGAP_SparcStackFuncBags: referenced symbol not found
```



---

archive/issue_events_189904.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-21T07:15:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189904"
}
```



---

archive/issue_events_189905.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-21T07:15:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189905"
}
```



---

archive/issue_events_189906.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-21T11:41:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189906"
}
```



---

archive/issue_events_189907.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-21T11:41:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189907"
}
```



---

archive/issue_comments_159026.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nFixed - the SparcStackFuncBags occurs in inline assembly and in C, so I now made sure to only rename it once.",
    "created_at": "2013-01-21T11:41:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159026",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:67" align="right">comment:67</div>

Fixed - the SparcStackFuncBags occurs in inline assembly and in C, so I now made sure to only rename it once.



---

archive/issue_events_189908.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-22T07:30:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189908"
}
```



---

archive/issue_events_189909.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-22T07:30:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189909"
}
```



---

archive/issue_comments_159027.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nI'm still not entirely happy with the memory allocation during docbuilding.  For reasons I cannot understand, the documentation used to build fine with\n\n```\nulimit -v 2500000\n```\nbut now it needs (I tested 100MB increments)\n\n```\nulimit -v 3500000\n```\nwhich is an increase of 1GB.  Of course, the documentation is also getting bigger, but that explains only a small part of the increase.  Also, on the buildbot I'm seeing sometimes errors of the form\n\n```\nsphinx-build -b html -d /home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/output/doctrees/de/tutorial    /home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/de/tutorial /home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/output/html/de/tutorial\nTraceback (most recent call last):\n  File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/common/builder.py\", line 1093, in <module>\n    getattr(get_builder(name), type)()\n  File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/common/builder.py\", line 232, in _wrapper\n    getattr(get_builder(document), name)(*args, **kwds)\n  File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/common/builder.py\", line 88, in f\n    subprocess.call(build_command, shell=True)\n  File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/local/lib/python/subprocess.py\", line 493, in call\n    return Popen(*popenargs, **kwargs).wait()\n  File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/local/lib/python/subprocess.py\", line 679, in __init__\n    errread, errwrite)\n  File \"/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/local/lib/python/subprocess.py\", line 1143, in _execute_child\n    self.pid = os.fork()\nOSError: [Errno 12] Cannot allocate memory\nmake: *** [doc-html-mathjax] Error 1\n```\nI suspect that GAP has something to do with this.\n\nCould you somehow fix the memory allocation to allocate an absolutely minimal amount during docbuilding?  Maybe it would make sense to introduce an environment variable `SAGE_GAP_MEGABYTES` which could be user-set to the desired memory size and which would be set by the docbuilder to a small number (say, 1 MB).",
    "created_at": "2013-01-22T07:30:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159027",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:68" align="right">comment:68</div>

I'm still not entirely happy with the memory allocation during docbuilding.  For reasons I cannot understand, the documentation used to build fine with

```
ulimit -v 2500000
```
but now it needs (I tested 100MB increments)

```
ulimit -v 3500000
```
which is an increase of 1GB.  Of course, the documentation is also getting bigger, but that explains only a small part of the increase.  Also, on the buildbot I'm seeing sometimes errors of the form

```
sphinx-build -b html -d /home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/output/doctrees/de/tutorial    /home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/de/tutorial /home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/output/html/de/tutorial
Traceback (most recent call last):
  File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/common/builder.py", line 1093, in <module>
    getattr(get_builder(name), type)()
  File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/common/builder.py", line 232, in _wrapper
    getattr(get_builder(document), name)(*args, **kwds)
  File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/devel/sage/doc/common/builder.py", line 88, in f
    subprocess.call(build_command, shell=True)
  File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/local/lib/python/subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/local/lib/python/subprocess.py", line 679, in __init__
    errread, errwrite)
  File "/home/buildbot/build/sage/iras-1/iras_full/build/sage-5.7.beta0/local/lib/python/subprocess.py", line 1143, in _execute_child
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
make: *** [doc-html-mathjax] Error 1
```
I suspect that GAP has something to do with this.

Could you somehow fix the memory allocation to allocate an absolutely minimal amount during docbuilding?  Maybe it would make sense to introduce an environment variable `SAGE_GAP_MEGABYTES` which could be user-set to the desired memory size and which would be set by the docbuilder to a small number (say, 1 MB).



---

archive/issue_comments_159028.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nI've added a setting to our Sphinx config (`doc/common/conf.py`) and builder config (`build_options.py`) to use only the minimum amount for GAP memory pool. The builder and sphinx itself both import everything to get at docstrings, so two libgap instances are being created when building the documentation. I verified that I can now build all documentation with `ulimit -v 2500000`).",
    "created_at": "2013-01-22T18:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159028",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:69" align="right">comment:69</div>

I've added a setting to our Sphinx config (`doc/common/conf.py`) and builder config (`build_options.py`) to use only the minimum amount for GAP memory pool. The builder and sphinx itself both import everything to get at docstrings, so two libgap instances are being created when building the documentation. I verified that I can now build all documentation with `ulimit -v 2500000`).



---

archive/issue_events_189910.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-22T18:13:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189910"
}
```



---

archive/issue_events_189911.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-01-22T18:13:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189911"
}
```



---

archive/issue_comments_159029.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,5 +9,6 @@\n * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library\n+* Apply [attachment: trac_13588_docbuild.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_docbuild.patch.gz) to the Sage library\n \n The `trac_6391_*` patch has already been reviewed at #6391.\n``````\n",
    "created_at": "2013-01-22T18:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159029",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,5 +9,6 @@
 * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_exec_fix.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_exec_fix.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_manifest.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_manifest.patch.gz) to the Sage library
+* Apply [attachment: trac_13588_docbuild.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_docbuild.patch.gz) to the Sage library
 
 The `trac_6391_*` patch has already been reviewed at #6391.
``````




---

archive/issue_comments_159030.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nThe following is fairly reproducible (with #13717 applied):\n\n```\nsage -t  -force_lib devel/sagenb-main/sagenb/misc/support.py\n**********************************************************************\nFile \"/release/merger/sage-5.7.beta1/devel/sagenb-main/sagenb/misc/support.py\", line 479:\n    sage: sage.server.support.syseval(gap, \"2+3\")\nExpected:\n    '5'\nGot:\n    ** Gap crashed or quit executing '2+3;' **\n    Restarting Gap and trying again\n    '5'\n**********************************************************************\n```\n\nNote that GAP is started with only 1MB of memory, as the top of this `strace` log shows:\n\n```\nexecve(\"/release/merger/sage-5.7.beta1/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap\", [\"/release/merger/sage-5.7.beta1/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap\", \"-m\", \"24m\", \"-l\", \"/release/merger/sage-5.7.beta1/local/gap/latest\", \"-r\", \"-b\", \"-p\", \"-T\", \"-o\", \"1m\", \"-s\", \"1m\", \"/release/merger/sage-5.7.beta1/local/share/sage/ext/gap/sage.g\"], [/* 84 vars */]) = 0\n```\n\nFull strace log: [http://boxen.math.washington.edu/home/jdemeyer/gap.28216](http://boxen.math.washington.edu/home/jdemeyer/gap.28216)",
    "created_at": "2013-01-23T17:15:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159030",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:70" align="right">comment:70</div>

The following is fairly reproducible (with #13717 applied):

```
sage -t  -force_lib devel/sagenb-main/sagenb/misc/support.py
**********************************************************************
File "/release/merger/sage-5.7.beta1/devel/sagenb-main/sagenb/misc/support.py", line 479:
    sage: sage.server.support.syseval(gap, "2+3")
Expected:
    '5'
Got:
    ** Gap crashed or quit executing '2+3;' **
    Restarting Gap and trying again
    '5'
**********************************************************************
```

Note that GAP is started with only 1MB of memory, as the top of this `strace` log shows:

```
execve("/release/merger/sage-5.7.beta1/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap", ["/release/merger/sage-5.7.beta1/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap", "-m", "24m", "-l", "/release/merger/sage-5.7.beta1/local/gap/latest", "-r", "-b", "-p", "-T", "-o", "1m", "-s", "1m", "/release/merger/sage-5.7.beta1/local/share/sage/ext/gap/sage.g"], [/* 84 vars */]) = 0
```

Full strace log: [http://boxen.math.washington.edu/home/jdemeyer/gap.28216](http://boxen.math.washington.edu/home/jdemeyer/gap.28216)



---

archive/issue_comments_159031.json:
```json
{
    "body": "Attachment: **[trac_13588_docbuild.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_docbuild.patch.gz)**\n\nUpdated patch",
    "created_at": "2013-01-23T20:02:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159031",
    "user": "https://github.com/vbraun"
}
```

Attachment: **[trac_13588_docbuild.patch.gz](https://github.com/sagemath/sage/files/ticket13588/trac_13588_docbuild.patch.gz)**

Updated patch



---

archive/issue_comments_159032.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nI see, introspection runs Sphinx as well so there is a chance to get `conf.py` imported in Sage. Though curiously, it doesn't cause any doctest failure on my machine. I moved the part that limits GAP to a branch in `conf.py` that is only executed when we actually build the documentation, this should fix it.",
    "created_at": "2013-01-23T20:09:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159032",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:71" align="right">comment:71</div>

I see, introspection runs Sphinx as well so there is a chance to get `conf.py` imported in Sage. Though curiously, it doesn't cause any doctest failure on my machine. I moved the part that limits GAP to a branch in `conf.py` that is only executed when we actually build the documentation, this should fix it.



---

archive/issue_events_189912.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-26T09:54:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189912"
}
```



---

archive/issue_events_189913.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-26T09:54:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13588#event-189913"
}
```



---

archive/issue_comments_159033.json:
```json
{
    "body": "Merged: **sage-5.7.beta1**",
    "created_at": "2013-01-26T09:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159033",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.7.beta1**



---

archive/issue_comments_159034.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.\n \n * Start with sage-5.6.beta3 or later.\n-* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)\n+* Install [http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg)\n * Apply [attachment: 13588_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz) to the root repository\n * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library\n * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library\n``````\n",
    "created_at": "2013-01-30T07:44:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13588#issuecomment-159034",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 Also, the GAP SIGINT handler got installed, this is fixed in the new spkg. Now Ctrl-C works as expected.
 
 * Start with sage-5.6.beta3 or later.
-* Install [http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg](http://www.stp.dias.ie/~vbraun/Sage/spkg/libgap-4.5.7.spkg)
+* Install [http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/libgap-4.5.7.spkg)
 * Apply [attachment: 13588_libGAP_root.patch](https://github.com/sagemath/sage/files/ticket13588/13588_libGAP_root.patch.gz) to the root repository
 * Apply [attachment: trac_6391_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_6391_libGAP.patch.gz) to the Sage library
 * Apply [attachment: trac_13588_improve_libGAP.patch](https://github.com/sagemath/sage/files/ticket13588/trac_13588_improve_libGAP.patch.gz) to the Sage library
``````

