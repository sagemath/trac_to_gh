# Issue 13992: Set Fortran compiler variables

archive/issues_013788.json:
```json
{
    "body": "Since SCons is too stupid to figure out by itself how to compile Fortran code (#13985), we should set environment variables in `sage-env`, similar to how we do for `CC` and `CXX`.  This is sort-of a follow-up to #13349 (deprecate `SAGE_FORTRAN`).\n\nJust for information:\n\n**Parts of Sage still using `sage_fortran`**:\n- atlas (see #10508 which currently doesn't fix this)\n- blas (spkg removed by #10508)\n- lapack (spkg removed by #10508)\n- numpy (see #11334 which currently doesn't fix this)\n- scipy (fixed by #13985)\n- the `sage-inline-fortran` script (fixed by [attachment:13992_inline_fortran.patch])\n\n**Apply**:\n1. [attachment:13992_fortran_env.patch] to `SAGE_ROOT`\n2. [attachment:13992_inline_fortran.patch] to `$SAGE_LOCAL/bin`\n\nAssignee: GeorgSWeber\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.7.beta1\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13992\n\n",
    "closed_at": "2013-01-25T13:08:50Z",
    "created_at": "2013-01-23T07:34:21Z",
    "labels": [
        "component: build",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "Set Fortran compiler variables",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13992",
    "user": "https://github.com/jdemeyer"
}
```
Since SCons is too stupid to figure out by itself how to compile Fortran code (#13985), we should set environment variables in `sage-env`, similar to how we do for `CC` and `CXX`.  This is sort-of a follow-up to #13349 (deprecate `SAGE_FORTRAN`).

Just for information:

**Parts of Sage still using `sage_fortran`**:
- atlas (see #10508 which currently doesn't fix this)
- blas (spkg removed by #10508)
- lapack (spkg removed by #10508)
- numpy (see #11334 which currently doesn't fix this)
- scipy (fixed by #13985)
- the `sage-inline-fortran` script (fixed by [attachment:13992_inline_fortran.patch])

**Apply**:
1. [attachment:13992_fortran_env.patch] to `SAGE_ROOT`
2. [attachment:13992_inline_fortran.patch] to `$SAGE_LOCAL/bin`

Assignee: GeorgSWeber

Reviewer: Fran√ßois Bissey

Author: Jeroen Demeyer

Merged: sage-5.7.beta1

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13992





---

archive/issue_comments_171021.json:
```json
{
    "body": "<a id='comment:2'></a>Attachment [13992_fortran_env.patch](tarball://root/attachments/some-uuid/ticket13992/13992_fortran_env.patch) by @jdemeyer created at 2013-01-23 10:35:05",
    "created_at": "2013-01-23T10:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171021",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>Attachment [13992_fortran_env.patch](tarball://root/attachments/some-uuid/ticket13992/13992_fortran_env.patch) by @jdemeyer created at 2013-01-23 10:35:05



---

archive/issue_comments_171022.json:
```json
{
    "body": "<a id='comment:6'></a>Attachment [13992_inline_fortran.patch](tarball://root/attachments/some-uuid/ticket13992/13992_inline_fortran.patch) by @jdemeyer created at 2013-01-23 10:49:13",
    "created_at": "2013-01-23T10:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171022",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Attachment [13992_inline_fortran.patch](tarball://root/attachments/some-uuid/ticket13992/13992_inline_fortran.patch) by @jdemeyer created at 2013-01-23 10:49:13



---

archive/issue_comments_171023.json:
```json
{
    "body": "<a id='comment:7'></a>I like the patches. I am surprised that you put g77 as a candidate. I am not sure sage can be built using g77. I would have to dig to check.",
    "created_at": "2013-01-25T09:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171023",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>I like the patches. I am surprised that you put g77 as a candidate. I am not sure sage can be built using g77. I would have to dig to check.



---

archive/issue_comments_171024.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 fbissey]:\n> I like the patches. I am surprised that you put g77 as a candidate. I am not sure sage can be built using g77. I would have to dig to check.\n\nI don't know either whether it works, I could remove it if you prefer.",
    "created_at": "2013-01-25T09:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171024",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [comment:7 fbissey]:
> I like the patches. I am surprised that you put g77 as a candidate. I am not sure sage can be built using g77. I would have to dig to check.

I don't know either whether it works, I could remove it if you prefer.



---

archive/issue_comments_171025.json:
```json
{
    "body": "<a id='comment:9'></a>After a quick scan of the spkg, nothing jumps at me as deal breaker. Building with g77 could be interesting experiment but let's not go there for this ticket. It's good as is.\nNumpy may need bumping before numpy 1.7.0 is ready - especially given its dependency on #12415. Ypu haven't put this for review, what do you think needs to be done apart from bumping spkg?",
    "created_at": "2013-01-25T09:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171025",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>After a quick scan of the spkg, nothing jumps at me as deal breaker. Building with g77 could be interesting experiment but let's not go there for this ticket. It's good as is.
Numpy may need bumping before numpy 1.7.0 is ready - especially given its dependency on #12415. Ypu haven't put this for review, what do you think needs to be done apart from bumping spkg?



---

archive/issue_comments_171026.json:
```json
{
    "body": "<a id='comment:10'></a>I didn't put this to needs_review mainly because I wanted to test it on the buildbots first.  But if you say \"positive_review if it works\", that's fine for me.\n\nNote that the spkgs are not part of this ticket, just the two patches.",
    "created_at": "2013-01-25T09:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171026",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>I didn't put this to needs_review mainly because I wanted to test it on the buildbots first.  But if you say "positive_review if it works", that's fine for me.

Note that the spkgs are not part of this ticket, just the two patches.



---

archive/issue_comments_171027.json:
```json
{
    "body": "<a id='comment:11'></a>Sure. Positive review if it works for me.",
    "created_at": "2013-01-25T09:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171027",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>Sure. Positive review if it works for me.



---

archive/issue_comments_171028.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-25T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171028",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_039338.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-25T13:08:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13992#event-39338"
}
```



---

archive/issue_comments_171029.json:
```json
{
    "body": "<a id='comment:12'></a>Works fine.",
    "created_at": "2013-01-25T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171029",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Works fine.



---

archive/issue_comments_171030.json:
```json
{
    "body": "<a id='comment:13'></a>Does `CPP` meanwhile get a default value?\n\nJust asking because you also removed\n\n```\n# letting at least CPP have a default value ('cpp') probably makes sense.\n```\nfrom `sage-env`.",
    "created_at": "2013-01-25T14:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171030",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>Does `CPP` meanwhile get a default value?

Just asking because you also removed

```
# letting at least CPP have a default value ('cpp') probably makes sense.
```
from `sage-env`.



---

archive/issue_comments_171031.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 leif]:\n> Does `CPP` meanwhile get a default value?\n\nNo, it doesn't.  I removed your comment because I don't know any reason why we should set `CPP`.",
    "created_at": "2013-01-25T14:21:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171031",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:13 leif]:
> Does `CPP` meanwhile get a default value?

No, it doesn't.  I removed your comment because I don't know any reason why we should set `CPP`.



---

archive/issue_comments_171032.json:
```json
{
    "body": "<a id='comment:15'></a>P.S.:  Just found out somebody finally removed setting `FC` to `sage_fortran` in the R spkg... :-)  (which I did years? ago, in an spkg that never got merged...)",
    "created_at": "2013-01-25T14:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171032",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>P.S.:  Just found out somebody finally removed setting `FC` to `sage_fortran` in the R spkg... :-)  (which I did years? ago, in an spkg that never got merged...)



---

archive/issue_comments_171033.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:14 jdemeyer]:\n> Replying to [comment:13 leif]:\n> > Does `CPP` meanwhile get a default value?\n\n> No, it doesn't.  I removed your comment because I don't know any reason why we should set `CPP`.\n\nMainly for use in `spkg-install` scripts and the like.  I don't think I had anything else in mind (other than overriding a *preset* `CPP` if Sage's GCC gets installed, which we already do).",
    "created_at": "2013-01-25T14:32:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171033",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>Replying to [comment:14 jdemeyer]:
> Replying to [comment:13 leif]:
> > Does `CPP` meanwhile get a default value?

> No, it doesn't.  I removed your comment because I don't know any reason why we should set `CPP`.

Mainly for use in `spkg-install` scripts and the like.  I don't think I had anything else in mind (other than overriding a *preset* `CPP` if Sage's GCC gets installed, which we already do).



---

archive/issue_comments_171034.json:
```json
{
    "body": "<a id='comment:17'></a>To what should be set `CPP` then?  `$CC -E`?  Or `cpp`?  Or `/lib/cpp`?  For now, letting `configure` figure it out has worked fine.",
    "created_at": "2013-01-25T14:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171034",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>To what should be set `CPP` then?  `$CC -E`?  Or `cpp`?  Or `/lib/cpp`?  For now, letting `configure` figure it out has worked fine.



---

archive/issue_comments_171035.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 jdemeyer]:\n> To what should be set `CPP` then?  `$CC -E`?  Or `cpp`?  Or `/lib/cpp`?  For now, letting `configure` figure it out has worked fine.\n\n\nJust to `cpp` in case it's not already set, for use in our \"own\" scripts (that don't have/use `configure`), just like `CC`, `CXX`, but also `AR` etc., i.e., for convenience (and consistency).",
    "created_at": "2013-01-25T15:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171035",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>Replying to [comment:17 jdemeyer]:
> To what should be set `CPP` then?  `$CC -E`?  Or `cpp`?  Or `/lib/cpp`?  For now, letting `configure` figure it out has worked fine.


Just to `cpp` in case it's not already set, for use in our "own" scripts (that don't have/use `configure`), just like `CC`, `CXX`, but also `AR` etc., i.e., for convenience (and consistency).



---

archive/issue_comments_171036.json:
```json
{
    "body": "<a id='comment:19'></a>But `$CPP` is not so clear, as `configure` uses `$CC -E` by default.",
    "created_at": "2013-01-25T15:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13992",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13992#issuecomment-171036",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>But `$CPP` is not so clear, as `configure` uses `$CC -E` by default.
