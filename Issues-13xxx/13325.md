# Issue 13325: eclib does not build on Cygwin

archive/issues_013153.json:
```json
{
    "body": "There are two problems with the current spkg on Cygwin:\n* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n\nAll of this is fixed in the 2012-08-30 upstream release.\n\n**Apply**:\n1. [attachment:trac_13325.patch]\n2. the **spkg** [http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg](http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg)\n\nAssignee: tbd\n\nCC:  @kcrisman @dimpase @JohnCremona @vbraun\n\nKeywords: eclib spkg cygwin\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: John Cremona\n\nAuthor: Jean-Pierre Flori\n\nMerged: sage-5.6.beta0\n\nDependencies: #13333\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13325\n\n",
    "closed_at": "2012-12-20T17:21:37Z",
    "created_at": "2012-08-02T07:28:51Z",
    "labels": [
        "component: porting: cygwin",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.6",
    "title": "eclib does not build on Cygwin",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13325",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```
There are two problems with the current spkg on Cygwin:
* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.

All of this is fixed in the 2012-08-30 upstream release.

**Apply**:
1. [attachment:trac_13325.patch]
2. the **spkg** [http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg](http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg)

Assignee: tbd

CC:  @kcrisman @dimpase @JohnCremona @vbraun

Keywords: eclib spkg cygwin

Upstream: Fixed upstream, in a later stable release.

Reviewer: John Cremona

Author: Jean-Pierre Flori

Merged: sage-5.6.beta0

Dependencies: #13333

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13325





---

archive/issue_comments_170640.json:
```json
{
    "body": "Attachment [13325.patch](tarball://root/attachments/some-uuid/ticket13325/13325.patch) by jpflori created at 2012-08-02 14:41:26\n\nSpkg diff, for review only.",
    "created_at": "2012-08-02T14:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170640",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [13325.patch](tarball://root/attachments/some-uuid/ticket13325/13325.patch) by jpflori created at 2012-08-02 14:41:26

Spkg diff, for review only.



---

archive/issue_comments_170641.json:
```json
{
    "body": "<a id='comment:1'></a>Updated spkg available at:\nhttp://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n\nAlthough I'd prefer package an updated upstream version including such fixes.\nJohn, could you update eclib ggoglecode repo?\nIf you're convinced the changes I propose are useful...\nAt least, they seem harmless on Linux and let the spkg build on Cygwin.",
    "created_at": "2012-08-02T14:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170641",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:1'></a>Updated spkg available at:
http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg

Although I'd prefer package an updated upstream version including such fixes.
John, could you update eclib ggoglecode repo?
If you're convinced the changes I propose are useful...
At least, they seem harmless on Linux and let the spkg build on Cygwin.



---

archive/issue_comments_170642.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n-Because of some mess between AM_CPP_FLAGS and AM_CXX_FLAGS, the tests target of Makefile fails when linking.\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+\n+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.\n+\n+Patched spkg available at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n+\n+Nevertheles, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-02T14:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170642",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,13 @@
-Because of some mess between AM_CPP_FLAGS and AM_CXX_FLAGS, the tests target of Makefile fails when linking.
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+
+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.
+
+Patched spkg available at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg
+
+Nevertheles, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170643.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2012-08-02T14:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170643",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_170644.json:
```json
{
    "body": "<a id='comment:2'></a>Hmmm, the 13325.patch file I uploaded is not the one I planned to.\nThat's a random previous version of the patch, please wait for me to upload a file named spkg.diff.",
    "created_at": "2012-08-02T14:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170644",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:2'></a>Hmmm, the 13325.patch file I uploaded is not the one I planned to.
That's a random previous version of the patch, please wait for me to upload a file named spkg.diff.



---

archive/issue_comments_170645.json:
```json
{
    "body": "<a id='comment:3'></a>The current spkg does not build yet.\nI get multiple definitions of _roots while building d2.exe: in d2 and in libpari.a(rootpol.o) apparently.",
    "created_at": "2012-08-02T15:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170645",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:3'></a>The current spkg does not build yet.
I get multiple definitions of _roots while building d2.exe: in d2 and in libpari.a(rootpol.o) apparently.



---

archive/issue_comments_170646.json:
```json
{
    "body": "<a id='comment:4'></a>It is certainly preferable for the eclib source (build system)  to be changed so we do not need to patch it.  I have some other suggested changes to the build system from a debian developer -- it would be very helpful if someone else could look at those too.  I am travelling at the moment and will not be able to think about this properly for the next 2+ weeks.",
    "created_at": "2012-08-02T15:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170646",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>It is certainly preferable for the eclib source (build system)  to be changed so we do not need to patch it.  I have some other suggested changes to the build system from a debian developer -- it would be very helpful if someone else could look at those too.  I am travelling at the moment and will not be able to think about this properly for the next 2+ weeks.



---

archive/issue_comments_170647.json:
```json
{
    "body": "<a id='comment:5'></a>That's because a static version of libpari is used. Using the shared one (by copying libpari.dll to libpari.dll.a) solves the problem.",
    "created_at": "2012-08-02T15:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170647",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:5'></a>That's because a static version of libpari is used. Using the shared one (by copying libpari.dll to libpari.dll.a) solves the problem.



---

archive/issue_comments_170648.json:
```json
{
    "body": "<a id='comment:7'></a>Another question to John:\n For the PARI stuff, would you consider renaming the function to something\n else?\n That would allow to link the programs statically (not that I really care,\n I think it's more important to let Cygwin find the shared lib of PARI\n before the static one anyway).",
    "created_at": "2012-08-02T15:53:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170648",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:7'></a>Another question to John:
 For the PARI stuff, would you consider renaming the function to something
 else?
 That would allow to link the programs statically (not that I really care,
 I think it's more important to let Cygwin find the shared lib of PARI
 before the static one anyway).



---

archive/issue_comments_170649.json:
```json
{
    "body": "<a id='comment:8'></a>Apparently pari creates a libpari.dll.a file but I guess Sage does not correctly copy it.\nI also see strange\nif test \"libpari-gmp.dll\" != \"libpari-gmp.dll\"\n\nHave to have a look to pari spkg install script...",
    "created_at": "2012-08-02T16:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170649",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:8'></a>Apparently pari creates a libpari.dll.a file but I guess Sage does not correctly copy it.
I also see strange
if test "libpari-gmp.dll" != "libpari-gmp.dll"

Have to have a look to pari spkg install script...



---

archive/issue_comments_170650.json:
```json
{
    "body": "<a id='comment:9'></a>The spkg does not work for me; I get\n\n```\n\n/bin/sh ../libtool --tag=CXX    --mode=link g++ -I/home/Dima/sage-5.2.rc1/local/include  -I/home/Dima/sage-5.2.rc1/local/include  -I/home/Dima/sage-5.2.rc1/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -ljc -L../libsrc -L/home/Dima/sage-5.2.rc1/local/lib -lntl -lgmp -L/home/Dima/sage-5.2.rc1/local/lib -lpari -lgmp   -o d2.exe d2.o\nlibtool: link: g++ -I/home/Dima/sage-5.2.rc1/local/include -I/home/Dima/sage-5.2.rc1/local/include -I/home/Dima/sage-5.2.rc1/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/d2.exe d2.o  /home/Dima/sage-5.2.rc1/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -L../libsrc -L/home/Dima/sage-5.2.rc1/local/lib -lntl -lpari /home/Dima/sage-5.2.rc1/local/lib/libgmp.dll.a -L/usr/lib/gcc/i686-pc-cygwin/4.5.3 -L/home/Dima/sage-5.2.rc1/local/lib\n/home/Dima/sage-5.2.rc1/local/lib/libpari.a(rootpol.o): In function `roots':\n/home/Dima/sage-5.2.rc1/spkg/build/pari-2.5.1.p3/src/Ocygwin-i686/../src/basemath/rootpol.c:2057: multiple definition of `_roots'\nd2.o:/home/Dima/sage-5.2.rc1/spkg/build/eclib-20120428.p0/src/tests/d2.cc:149: first defined here\ncollect2: ld returned 1 exit status\nMakefile:679: recipe for target `d2.exe' failed\nmake[3]: *** [d2.exe] Error 1\n```\nBy the way, did I have to install a different PARI spkg, too?",
    "created_at": "2012-08-03T06:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170650",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>The spkg does not work for me; I get

```

/bin/sh ../libtool --tag=CXX    --mode=link g++ -I/home/Dima/sage-5.2.rc1/local/include  -I/home/Dima/sage-5.2.rc1/local/include  -I/home/Dima/sage-5.2.rc1/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -ljc -L../libsrc -L/home/Dima/sage-5.2.rc1/local/lib -lntl -lgmp -L/home/Dima/sage-5.2.rc1/local/lib -lpari -lgmp   -o d2.exe d2.o
libtool: link: g++ -I/home/Dima/sage-5.2.rc1/local/include -I/home/Dima/sage-5.2.rc1/local/include -I/home/Dima/sage-5.2.rc1/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/d2.exe d2.o  /home/Dima/sage-5.2.rc1/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -L../libsrc -L/home/Dima/sage-5.2.rc1/local/lib -lntl -lpari /home/Dima/sage-5.2.rc1/local/lib/libgmp.dll.a -L/usr/lib/gcc/i686-pc-cygwin/4.5.3 -L/home/Dima/sage-5.2.rc1/local/lib
/home/Dima/sage-5.2.rc1/local/lib/libpari.a(rootpol.o): In function `roots':
/home/Dima/sage-5.2.rc1/spkg/build/pari-2.5.1.p3/src/Ocygwin-i686/../src/basemath/rootpol.c:2057: multiple definition of `_roots'
d2.o:/home/Dima/sage-5.2.rc1/spkg/build/eclib-20120428.p0/src/tests/d2.cc:149: first defined here
collect2: ld returned 1 exit status
Makefile:679: recipe for target `d2.exe' failed
make[3]: *** [d2.exe] Error 1
```
By the way, did I have to install a different PARI spkg, too?



---

archive/issue_comments_170651.json:
```json
{
    "body": "<a id='comment:10'></a>Yes you have to somehow tweak PARI to let d2 build.\n\nThe quickest hack is to copy libpari.dll to libpari.dll.a.\n\nHowever I'd prefer to copy the proper import file dll.a ggenerated by PARI when it's build.\n\nAnd I'd prefer such a fix to be included in PARI itself rather than in a Sage spkg.\nI'll contact the PARI team today.\nHopefully this could make it into 2.5.2 for which Jeroen is currently preparing a spkg as well.",
    "created_at": "2012-08-03T06:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170651",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:10'></a>Yes you have to somehow tweak PARI to let d2 build.

The quickest hack is to copy libpari.dll to libpari.dll.a.

However I'd prefer to copy the proper import file dll.a ggenerated by PARI when it's build.

And I'd prefer such a fix to be included in PARI itself rather than in a Sage spkg.
I'll contact the PARI team today.
Hopefully this could make it into 2.5.2 for which Jeroen is currently preparing a spkg as well.



---

archive/issue_comments_170652.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 jpflori]:\n> Yes you have to somehow tweak PARI to let d2 build.\n> \n> The quickest hack is to copy libpari.dll to libpari.dll.a.\n\n\nthere are 2 files named libpari.dll in SAGELOCAL. One in bin/, and another in lib/...\nAnd both of them aren't archive files, but \"real\" dlls.\nTried your hack for the one in bin/, it didn't help.\n\nAnd, by the way, how would it help the problem of `multiple definition of `_roots'`\nThis looks like overlinking rather than underlinking to me.",
    "created_at": "2012-08-03T14:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170652",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>Replying to [comment:10 jpflori]:
> Yes you have to somehow tweak PARI to let d2 build.
> 
> The quickest hack is to copy libpari.dll to libpari.dll.a.


there are 2 files named libpari.dll in SAGELOCAL. One in bin/, and another in lib/...
And both of them aren't archive files, but "real" dlls.
Tried your hack for the one in bin/, it didn't help.

And, by the way, how would it help the problem of `multiple definition of `_roots'`
This looks like overlinking rather than underlinking to me.



---

archive/issue_comments_170653.json:
```json
{
    "body": "<a id='comment:12'></a>I never said they were archive files...\n\nI said that when linking the linker finds libpari.a BEFORE libpari.dll.\nBut as there is already a function named _roots in an object file included in libpari.a it fails.\nThat's the problem.\n\nFrom now on, lets suppose we live in the lib directory and forget about the bin one which is not of interest for our purposes.\n\nSo a hack consists in making sure that the linker find libpari.dll BEFORE libpari.a.\nTo do that, you can copy libpari.dll to libpari.dll.a.\nYou could just rename it if you want to have some fun.\nYou could also delete libpari.a or rename it to jdlksjlkdjls.\n\nOr we could explicitely tell the linker to use libpari.dll, rather than just passing -lpari, but that needs more work.\nAnd anyway, PARI generates a file ending by .dll.a.\nAFAIK it's not a copy od libpari.dll, not a dll file, but some import file.\nThe point is that the linker will find it BEFORE libpari.a if its present and by looking at it it will automatically use the libpari.dll file.",
    "created_at": "2012-08-03T14:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170653",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:12'></a>I never said they were archive files...

I said that when linking the linker finds libpari.a BEFORE libpari.dll.
But as there is already a function named _roots in an object file included in libpari.a it fails.
That's the problem.

From now on, lets suppose we live in the lib directory and forget about the bin one which is not of interest for our purposes.

So a hack consists in making sure that the linker find libpari.dll BEFORE libpari.a.
To do that, you can copy libpari.dll to libpari.dll.a.
You could just rename it if you want to have some fun.
You could also delete libpari.a or rename it to jdlksjlkdjls.

Or we could explicitely tell the linker to use libpari.dll, rather than just passing -lpari, but that needs more work.
And anyway, PARI generates a file ending by .dll.a.
AFAIK it's not a copy od libpari.dll, not a dll file, but some import file.
The point is that the linker will find it BEFORE libpari.a if its present and by looking at it it will automatically use the libpari.dll file.



---

archive/issue_comments_170654.json:
```json
{
    "body": "<a id='comment:13'></a>The point is that if you link to the dll rather than the archive file, ld won't complain, which is quite understandable because the _roots function from libpari is not needed nor called directly from eclib (and how could it be anyway as theres a function called so in eclib itself).\nThe two namespaces/worlds are kept as separate as possible with ld just doing its magic when needed.\n\nIf you link archive files together, ar will try to put everything from pari and from eclib in one file, in particular it will have some trouble putting to functions with the same name in that one file.\nThe two namespaces/worlds are colliding.",
    "created_at": "2012-08-03T14:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170654",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:13'></a>The point is that if you link to the dll rather than the archive file, ld won't complain, which is quite understandable because the _roots function from libpari is not needed nor called directly from eclib (and how could it be anyway as theres a function called so in eclib itself).
The two namespaces/worlds are kept as separate as possible with ld just doing its magic when needed.

If you link archive files together, ar will try to put everything from pari and from eclib in one file, in particular it will have some trouble putting to functions with the same name in that one file.
The two namespaces/worlds are colliding.



---

archive/issue_comments_170655.json:
```json
{
    "body": "<a id='comment:14'></a>I'm very sorry this is calling you trouble, as I hardly use libpari at all (in eclib), literally only for integer factorization.  I am planning an upgrade to eclib which will make FLINT a dependency, in which case I might use FLINT for integer factorization instead.  But not very soon.",
    "created_at": "2012-08-03T15:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170655",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:14'></a>I'm very sorry this is calling you trouble, as I hardly use libpari at all (in eclib), literally only for integer factorization.  I am planning an upgrade to eclib which will make FLINT a dependency, in which case I might use FLINT for integer factorization instead.  But not very soon.



---

archive/issue_comments_170656.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n \n+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.\n+\n+Patched spkg available at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n+\n+To make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll`.\n+\n+Nevertheles, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-06T02:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170656",
    "user": "https://github.com/dimpase"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
 
+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.
+
+Patched spkg available at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg
+
+To make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll`.
+
+Nevertheles, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170657.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n \n+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.\n+\n+Patched spkg available at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n+\n+Nevertheless, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.\n+\n+\n+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-06T06:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170657",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,16 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
 
+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.
+
+Patched spkg available at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg
+
+Nevertheless, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.
+
+
+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170658.json:
```json
{
    "body": "<a id='comment:17'></a>The -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin.",
    "created_at": "2012-08-08T21:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170658",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:17'></a>The -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin.



---

archive/issue_comments_170659.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,17 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+The -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin. \n \n+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.\n+\n+Patched spkg available at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n+\n+Nevertheless, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.\n+\n+\n+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-08T21:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170659",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,17 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+The -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin. 
 
+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.
+
+Patched spkg available at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg
+
+Nevertheless, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.
+
+
+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170660.json:
```json
{
    "body": "Spkg diff, for review only. Not committed in spkg.",
    "created_at": "2012-08-09T07:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170660",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Spkg diff, for review only. Not committed in spkg.



---

archive/issue_comments_170661.json:
```json
{
    "body": "<a id='comment:18'></a>Attachment [eclib.patch](tarball://root/attachments/some-uuid/ticket13325/eclib.patch) by jpflori created at 2012-08-09 07:46:06\n\nUpdated spkg at the same url adding the -no-undefined flag.\nThis has the nice consequence that eclib now builds a shared library and that sage.libs.mwrank is functional.",
    "created_at": "2012-08-09T07:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170661",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:18'></a>Attachment [eclib.patch](tarball://root/attachments/some-uuid/ticket13325/eclib.patch) by jpflori created at 2012-08-09 07:46:06

Updated spkg at the same url adding the -no-undefined flag.
This has the nice consequence that eclib now builds a shared library and that sage.libs.mwrank is functional.



---

archive/issue_comments_170662.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,17 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+The -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.\n+\n+Patched spkg available at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n+\n+Nevertheless, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.\n+\n+\n+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-09T07:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170662",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,17 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+The -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+Then I reran autogen.sh from upstream, deleted autom4te.cache and repackaged, versioned, commented everything.
+
+Patched spkg available at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg
+
+Nevertheless, I think it would be better to repack a new release of eclib including such changes to prevent the inclusion of the patches and the hg history which make the spkg size explode.
+
+
+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170663.json:
```json
{
    "body": "<a id='comment:19'></a>As a temporary solution I've uploaded an spkg reautoconfed using #13357, so that there is no spkg size explosion.\nNot retested on Cygwin yet, but it should be as functional as before.\nNothing is definitely committed or tagged yet, I'll do it after review.",
    "created_at": "2012-08-20T15:06:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170663",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:19'></a>As a temporary solution I've uploaded an spkg reautoconfed using #13357, so that there is no spkg size explosion.
Not retested on Cygwin yet, but it should be as functional as before.
Nothing is definitely committed or tagged yet, I'll do it after review.



---

archive/issue_comments_170664.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-08-20T15:06:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170664",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_170665.json:
```json
{
    "body": "<a id='comment:21'></a>I'm going to need some help & advice here.  Since the last release of eclib with autotools there are three sets of changes:  (1) the ones by you people for Sage (triggered by cygwin issues);  (2) some changes sent to me by email by Bernhard Link of debian;  (3) changes made by me to make FLINT 3 a prerequisite, since by using FLINT in a few key places I obtain a vast speedup of some programs (nto ones used by Sage currently).  Clearly I can absorb the first two sets easily, but I am not sure about the last one, since until Sage starts to use FLINT 3 I would have to get autoconf to determine whether or not to use FLINT by setting some compiler switches or similar.  And I am very capable of getting very confused in merging 3 sets of changes to anything...",
    "created_at": "2012-08-20T15:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170665",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:21'></a>I'm going to need some help & advice here.  Since the last release of eclib with autotools there are three sets of changes:  (1) the ones by you people for Sage (triggered by cygwin issues);  (2) some changes sent to me by email by Bernhard Link of debian;  (3) changes made by me to make FLINT 3 a prerequisite, since by using FLINT in a few key places I obtain a vast speedup of some programs (nto ones used by Sage currently).  Clearly I can absorb the first two sets easily, but I am not sure about the last one, since until Sage starts to use FLINT 3 I would have to get autoconf to determine whether or not to use FLINT by setting some compiler switches or similar.  And I am very capable of getting very confused in merging 3 sets of changes to anything...



---

archive/issue_comments_170666.json:
```json
{
    "body": "<a id='comment:22'></a>FLINT 3? Is that a super secret project :)\nIf you mean FLINT 2.3, I personally think that it should quickly go into Sage, see #12173, which seems (almost?) functional to me.\n\nI still have some issues with Cygwin there, so the spkg I posted is not vanilla #12173, but rather vanilla plus a quite large rewrite of the build system.\nI'm aware that's a bad idea, because it won't get into FLINT 2.3, but I won't have the time to produce a bunch of small patches in order for only the Cygwin part to get included.\n\nAs Cygwin is not required to be supported, we should surely just ship a vanilla FLINT 2.3 when it gets released and wait for Bill to integrate my changes (if he feels like) in a 2.4 or subsequent release.",
    "created_at": "2012-08-20T15:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170666",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:22'></a>FLINT 3? Is that a super secret project :)
If you mean FLINT 2.3, I personally think that it should quickly go into Sage, see #12173, which seems (almost?) functional to me.

I still have some issues with Cygwin there, so the spkg I posted is not vanilla #12173, but rather vanilla plus a quite large rewrite of the build system.
I'm aware that's a bad idea, because it won't get into FLINT 2.3, but I won't have the time to produce a bunch of small patches in order for only the Cygwin part to get included.

As Cygwin is not required to be supported, we should surely just ship a vanilla FLINT 2.3 when it gets released and wait for Bill to integrate my changes (if he feels like) in a 2.4 or subsequent release.



---

archive/issue_comments_170667.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 jpflori]:\n> FLINT 3? Is that a super secret project :)\n> If you mean FLINT 2.3, I personally think that it should quickly go into Sage, see #12173, which seems (almost?) functional to me.\n> \n\nYes, I did mean 2.3!  I guess FLINT3 is waiting for Bill to write a new language / compiler...",
    "created_at": "2012-08-20T15:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170667",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:23'></a>Replying to [comment:22 jpflori]:
> FLINT 3? Is that a super secret project :)
> If you mean FLINT 2.3, I personally think that it should quickly go into Sage, see #12173, which seems (almost?) functional to me.
> 

Yes, I did mean 2.3!  I guess FLINT3 is waiting for Bill to write a new language / compiler...



---

archive/issue_comments_170668.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-08-20T22:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170668",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_170669.json:
```json
{
    "body": "<a id='comment:24'></a>Im finally testing the last spkg, and it seems I deleted something in it.\nI'll fix it tomorrow.",
    "created_at": "2012-08-20T22:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170669",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:24'></a>Im finally testing the last spkg, and it seems I deleted something in it.
I'll fix it tomorrow.



---

archive/issue_comments_170670.json:
```json
{
    "body": "Attachment [spkg.diff](tarball://root/attachments/some-uuid/ticket13325/spkg.diff) by jpflori created at 2012-08-21 14:16:52\n\nSpkg diff, for review only. Committed in spkg.",
    "created_at": "2012-08-21T14:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170670",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [spkg.diff](tarball://root/attachments/some-uuid/ticket13325/spkg.diff) by jpflori created at 2012-08-21 14:16:52

Spkg diff, for review only. Committed in spkg.



---

archive/issue_comments_170671.json:
```json
{
    "body": "<a id='comment:25'></a>Spkg is now fixed.\nThe error was caused by the fact that files of the build system were patched and so their timestamp updated.\nThen autotool magic wanted to regenerate some of them, which would fail because some pieces needed to do that are missing (this would also be true with the previous spkg).\nSo touching some files in the right order after patching solves the issue.",
    "created_at": "2012-08-21T14:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170671",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:25'></a>Spkg is now fixed.
The error was caused by the fact that files of the build system were patched and so their timestamp updated.
Then autotool magic wanted to regenerate some of them, which would fail because some pieces needed to do that are missing (this would also be true with the previous spkg).
So touching some files in the right order after patching solves the issue.



---

archive/issue_comments_170672.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+Then I reran automake and autoconf (not aclocal, nor libtoolize, which modified a lot of things) from upstream, repackaged, versioned, commented everything.\n+As the build system is patched before configuration, some files have to be touched in order to avoid automatic regeneration (which would fail due to the lack off some files, this is already the case in the upstream distribution).\n+\n+Patched spkg available at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg\n+\n+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-21T14:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170672",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+Then I reran automake and autoconf (not aclocal, nor libtoolize, which modified a lot of things) from upstream, repackaged, versioned, commented everything.
+As the build system is patched before configuration, some files have to be touched in order to avoid automatic regeneration (which would fail due to the lack off some files, this is already the case in the upstream distribution).
+
+Patched spkg available at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120428.p0.spkg
+
+Moreover, to make this work on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170673.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-08-21T14:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170673",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_170674.json:
```json
{
    "body": "<a id='comment:26'></a>I am right now working on making the changes you have been making to the upstream distribution.  I will report here when that is done.  At the same time I am making the changes suggested by Bernhard Link of debian (but nothing to do with FLINT at this point).",
    "created_at": "2012-08-21T14:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170674",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:26'></a>I am right now working on making the changes you have been making to the upstream distribution.  I will report here when that is done.  At the same time I am making the changes suggested by Bernhard Link of debian (but nothing to do with FLINT at this point).



---

archive/issue_comments_170675.json:
```json
{
    "body": "<a id='comment:27'></a>I want to make sure that understand the changes that you made so I can make them \"upstream\" and hence avoid any patching.  I realise that this will mean a new version of the spkg:  when I am done the eclib version will be bumped up to 2012-08-21 (assuming that I finish today) so the next spkg can have a new name instead of a patch level.\n\nFrom the Changelog in SPKG.txt:\n\n```\n+ * #13325: let eclib build on Cygwin.\n+ * Put -lgmp after -lntl and -lpari in configure.ac.\n+ * Add $(EXEEXT) to the targets in tests/Makefile.am.\n+ * Add '-no-undefined' flag to libjc.la LDFLAGS so that a shared library\n+   is built on Cygwin.\n+ * automake and autoconf were run to regenerate the configure script and\n+   Makefiles.\n```\n\n1. will no longer be necessary.  These flags are now set i nthe various Makefile.am using the macros LIBADD and LDADD, and I did put gmp last.\n\n2. $(EXEEXT).  I assume that this is set on cygwin (to \".exe\" or something) but not otherwise, so (apart from cluttering up the Makefiles) there will be no effect on other systems?   You say that this is done in src/tests, but should it also be done in src/progs?  The latter builds some binaries which are actually installed (e.g. mwrank).\n\n3. '-no-indefined' OK I can add that too.  By the way, the library name is now libec and not libjc.\n\n4. OK, so I'm a bit uncertain as to which auto* files to actually include.  When I change configure.ac or any Makefile.am files I run autoreconf.  I never touch or look at configure or the actual Makefiles.\n\nSo I will now deal with points 2 and 3 and hand back to you, if that is OK.",
    "created_at": "2012-08-21T15:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170675",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:27'></a>I want to make sure that understand the changes that you made so I can make them "upstream" and hence avoid any patching.  I realise that this will mean a new version of the spkg:  when I am done the eclib version will be bumped up to 2012-08-21 (assuming that I finish today) so the next spkg can have a new name instead of a patch level.

From the Changelog in SPKG.txt:

```
+ * #13325: let eclib build on Cygwin.
+ * Put -lgmp after -lntl and -lpari in configure.ac.
+ * Add $(EXEEXT) to the targets in tests/Makefile.am.
+ * Add '-no-undefined' flag to libjc.la LDFLAGS so that a shared library
+   is built on Cygwin.
+ * automake and autoconf were run to regenerate the configure script and
+   Makefiles.
```

1. will no longer be necessary.  These flags are now set i nthe various Makefile.am using the macros LIBADD and LDADD, and I did put gmp last.

2. $(EXEEXT).  I assume that this is set on cygwin (to ".exe" or something) but not otherwise, so (apart from cluttering up the Makefiles) there will be no effect on other systems?   You say that this is done in src/tests, but should it also be done in src/progs?  The latter builds some binaries which are actually installed (e.g. mwrank).

3. '-no-indefined' OK I can add that too.  By the way, the library name is now libec and not libjc.

4. OK, so I'm a bit uncertain as to which auto* files to actually include.  When I change configure.ac or any Makefile.am files I run autoreconf.  I never touch or look at configure or the actual Makefiles.

So I will now deal with points 2 and 3 and hand back to you, if that is OK.



---

archive/issue_comments_170676.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 cremona]:\n> 1. will no longer be necessary.  These flags are now set i nthe various Makefile.am using the macros LIBADD and LDADD, and I did put gmp last.\n  \nGreat.\n> \n> 2. $(EXEEXT).  I assume that this is set on cygwin (to \".exe\" or something) but not otherwise, so (apart from cluttering up the Makefiles) there will be no effect on other systems?   You say that this is done in src/tests, but should it also be done in src/progs?  The latter builds some binaries which are actually installed (e.g. mwrank).\n  \nYes, this is only \"really\" needed on Cygwin.\nOn most systems, let's say Linuxes, $(EXEEXT) will be void, so putting it or not won't have any visible effect.\n\nIf I remember correctly, the executables in the progs directory already magically included the $(EXEEXT) (or at least the file produced ended up in .exe).\nThere must be some difference between the two Makefile.am you used.\nI can have a look if you want.\n> \n> 3. '-no-indefined' OK I can add that too.  By the way, the library name is now libec and not libjc.\n  \nGreat (jsut beware of the typo here :)\n> \n> 4. OK, so I'm a bit uncertain as to which auto* files to actually include.  When I change configure.ac or any Makefile.am files I run autoreconf.  I never touch or look at configure or the actual Makefiles.\n  \nI'm not really sure of what should be included in a distribution tarball, I've begun fighting with autotools just a few weeks ago.\nWhat was really painfull here is that it seemed that having a more recent configure than aclocal.m4 was detected by configure itself and let it try to regenerate aclocal.m4 (which failed because of the lack of a proper m4 directory with I don't really know what macros inside).\nThe same was true for Makefile.in.\n\nDon't know what the behavior if you actually omit the configure.ac and Makefile.am files.\n> \n> So I will now deal with points 2 and 3 and hand back to you, if that is OK.",
    "created_at": "2012-08-21T16:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170676",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:28'></a>Replying to [comment:27 cremona]:
> 1. will no longer be necessary.  These flags are now set i nthe various Makefile.am using the macros LIBADD and LDADD, and I did put gmp last.
  
Great.
> 
> 2. $(EXEEXT).  I assume that this is set on cygwin (to ".exe" or something) but not otherwise, so (apart from cluttering up the Makefiles) there will be no effect on other systems?   You say that this is done in src/tests, but should it also be done in src/progs?  The latter builds some binaries which are actually installed (e.g. mwrank).
  
Yes, this is only "really" needed on Cygwin.
On most systems, let's say Linuxes, $(EXEEXT) will be void, so putting it or not won't have any visible effect.

If I remember correctly, the executables in the progs directory already magically included the $(EXEEXT) (or at least the file produced ended up in .exe).
There must be some difference between the two Makefile.am you used.
I can have a look if you want.
> 
> 3. '-no-indefined' OK I can add that too.  By the way, the library name is now libec and not libjc.
  
Great (jsut beware of the typo here :)
> 
> 4. OK, so I'm a bit uncertain as to which auto* files to actually include.  When I change configure.ac or any Makefile.am files I run autoreconf.  I never touch or look at configure or the actual Makefiles.
  
I'm not really sure of what should be included in a distribution tarball, I've begun fighting with autotools just a few weeks ago.
What was really painfull here is that it seemed that having a more recent configure than aclocal.m4 was detected by configure itself and let it try to regenerate aclocal.m4 (which failed because of the lack of a proper m4 directory with I don't really know what macros inside).
The same was true for Makefile.in.

Don't know what the behavior if you actually omit the configure.ac and Makefile.am files.
> 
> So I will now deal with points 2 and 3 and hand back to you, if that is OK.



---

archive/issue_comments_170677.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 jpflori]:\n> Replying to [comment:27 cremona]:\n> > 1. will no longer be necessary.  These flags are now set i nthe various Makefile.am using the macros LIBADD and LDADD, and I did put gmp last.\n  \n> Great.\n> > \n> > 2. $(EXEEXT).  I assume that this is set on cygwin (to \".exe\" or something) but not otherwise, so (apart from cluttering up the Makefiles) there will be no effect on other systems?   You say that this is done in src/tests, but should it also be done in src/progs?  The latter builds some binaries which are actually installed (e.g. mwrank).\n  \n> Yes, this is only \"really\" needed on Cygwin.\n> On most systems, let's say Linuxes, $(EXEEXT) will be void, so putting it or not won't have any visible effect.\n> \n> If I remember correctly, the executables in the progs directory already magically included the $(EXEEXT) (or at least the file produced ended up in .exe).\n> There must be some difference between the two Makefile.am you used.\n> I can have a look if you want.\n\nDisregard this last comment, I did not get what you said.\nThe splitting of progs and tests is posterior to the current spkg Sage ships.\n\nBut yes, I guess you could add $(EXEEXT) everywhere I guess, I must admit I don't really really remember if this is really necessary on Cygwin... but on Windows executables usually finish with .exe, so it can not hurt.\nPlus, on recent Cygwin versions, there seems to be some automatic translation from prog to prog.exe (I guess this also made my changes actually work when setting SAGE_CHECK, because I did not add $(EXEEXT) at each invocation of the programs as I just realized).\n> > \n> > 3. '-no-indefined' OK I can add that too.  By the way, the library name is now libec and not libjc.\n  \n> Great (jsut beware of the typo here :)\n> > \n> > 4. OK, so I'm a bit uncertain as to which auto* files to actually include.  When I change configure.ac or any Makefile.am files I run autoreconf.  I never touch or look at configure or the actual Makefiles.\n  \n> I'm not really sure of what should be included in a distribution tarball, I've begun fighting with autotools just a few weeks ago.\n> What was really painfull here is that it seemed that having a more recent configure than aclocal.m4 was detected by configure itself and let it try to regenerate aclocal.m4 (which failed because of the lack of a proper m4 directory with I don't really know what macros inside).\n> The same was true for Makefile.in.\n> \n> Don't know what the behavior if you actually omit the configure.ac and Makefile.am files.\n> > \n> > So I will now deal with points 2 and 3 and hand back to you, if that is OK.",
    "created_at": "2012-08-21T16:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170677",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:29'></a>Replying to [comment:28 jpflori]:
> Replying to [comment:27 cremona]:
> > 1. will no longer be necessary.  These flags are now set i nthe various Makefile.am using the macros LIBADD and LDADD, and I did put gmp last.
  
> Great.
> > 
> > 2. $(EXEEXT).  I assume that this is set on cygwin (to ".exe" or something) but not otherwise, so (apart from cluttering up the Makefiles) there will be no effect on other systems?   You say that this is done in src/tests, but should it also be done in src/progs?  The latter builds some binaries which are actually installed (e.g. mwrank).
  
> Yes, this is only "really" needed on Cygwin.
> On most systems, let's say Linuxes, $(EXEEXT) will be void, so putting it or not won't have any visible effect.
> 
> If I remember correctly, the executables in the progs directory already magically included the $(EXEEXT) (or at least the file produced ended up in .exe).
> There must be some difference between the two Makefile.am you used.
> I can have a look if you want.

Disregard this last comment, I did not get what you said.
The splitting of progs and tests is posterior to the current spkg Sage ships.

But yes, I guess you could add $(EXEEXT) everywhere I guess, I must admit I don't really really remember if this is really necessary on Cygwin... but on Windows executables usually finish with .exe, so it can not hurt.
Plus, on recent Cygwin versions, there seems to be some automatic translation from prog to prog.exe (I guess this also made my changes actually work when setting SAGE_CHECK, because I did not add $(EXEEXT) at each invocation of the programs as I just realized).
> > 
> > 3. '-no-indefined' OK I can add that too.  By the way, the library name is now libec and not libjc.
  
> Great (jsut beware of the typo here :)
> > 
> > 4. OK, so I'm a bit uncertain as to which auto* files to actually include.  When I change configure.ac or any Makefile.am files I run autoreconf.  I never touch or look at configure or the actual Makefiles.
  
> I'm not really sure of what should be included in a distribution tarball, I've begun fighting with autotools just a few weeks ago.
> What was really painfull here is that it seemed that having a more recent configure than aclocal.m4 was detected by configure itself and let it try to regenerate aclocal.m4 (which failed because of the lack of a proper m4 directory with I don't really know what macros inside).
> The same was true for Makefile.in.
> 
> Don't know what the behavior if you actually omit the configure.ac and Makefile.am files.
> > 
> > So I will now deal with points 2 and 3 and hand back to you, if that is OK.



---

archive/issue_comments_170678.json:
```json
{
    "body": "<a id='comment:30'></a>Regarding $(EXEEXT):  I have been readong up on this.  Yes, the suffix gets automagically added to bin_PROGRAMS targets but apparently not to everything.  See http://www.gnu.org/software/automake/manual/automake.html#index-Executable-extension-620 .  I assumed that you (or someone) only added this manually where it was needed, but forgot that the clib version now in Sage was as old as it is.\n\nSee #13021 for example (not my ticket and I was not CC'ed onto it).",
    "created_at": "2012-08-21T16:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170678",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:30'></a>Regarding $(EXEEXT):  I have been readong up on this.  Yes, the suffix gets automagically added to bin_PROGRAMS targets but apparently not to everything.  See http://www.gnu.org/software/automake/manual/automake.html#index-Executable-extension-620 .  I assumed that you (or someone) only added this manually where it was needed, but forgot that the clib version now in Sage was as old as it is.

See #13021 for example (not my ticket and I was not CC'ed onto it).



---

archive/issue_comments_170679.json:
```json
{
    "body": "<a id='comment:31'></a>On rereading the automake manual reference (previous post) I would assume that the suffix was provided for you *unless* you find that in some cases it is not, rather than adding the suffix manually everywhere.",
    "created_at": "2012-08-21T16:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170679",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:31'></a>On rereading the automake manual reference (previous post) I would assume that the suffix was provided for you *unless* you find that in some cases it is not, rather than adding the suffix manually everywhere.



---

archive/issue_comments_170680.json:
```json
{
    "body": "<a id='comment:32'></a>I think I now remember what the problem was:\n* autotools indeed does its magic with $(EXEEXT),\n* but you directly put smattest (and others) in a target, so make tries to build it generically and doesn't use the magic smattest$(EXEEXT) target and its autotools CFLAGS (and the one you provided to it) so it fails\n* except on Linux (and others) where the autotools magic defines a target for smattest and we get lucky...\n\nHere is an excerpt of what failed on Cygwin:\n\n```\nlibtool: link: g++ -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/mwrank.exe mwrank.o  /home/jp/sage-5.2/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -L../libsrc -L/home/jp/sage-5.2/local/lib -lntl -lpari /home/jp/sage-5.2/local/lib/libgmp.dll.a -L/usr/lib/gcc/i686-pc-cygwin/4.5.3 -L/home/jp/sage-5.2/local/lib\ng++ -g -O3     smattest.cc   -o smattest\nsmattest.cc:30:25: erreur fatale: eclib/arith.h : No such file or directory\ncompilation termin\u00e9e.\n<builtin>: recipe for target `smattest' failed\n```\nAfter adding $(EXEEXT) I got\n\n```\n/bin/sh ../libtool --tag=CXX    --mode=link g++ -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -ljc -L../libsrc -L/home/jp/sage-5.2/local/lib -lntl -lgmp -L/home/jp/sage-5.2/local/lib -lpari -lgmp   -o mwrank.exe mwrank.o  \nlibtool: link: g++ -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/mwrank.exe mwrank.o  /home/jp/sage-5.2/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.dll.a -L../libsrc -L/home/jp/sage-5.2/local/lib /home/jp/sage-5.2/local/lib/libntl.dll.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -lpari /home/jp/sage-5.2/local/lib/libgmp.dll.a -L/home/jp/sage-5.2/local/lib -L/usr/lib/gcc/i686-pc-cygwin/4.5.3\ng++ -DPACKAGE_NAME=\\\"eclib\\\" -DPACKAGE_TARNAME=\\\"eclib\\\" -DPACKAGE_VERSION=\\\"2012-04-25\\\" -DPACKAGE_STRING=\\\"eclib\\ 2012-04-25\\\" -DPACKAGE_BUGREPORT=\\\"john.cremona@gmail.com\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"eclib\\\" -DVERSION=\\\"2012-04-25\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\\\".libs/\\\" -DHAVE_ALLOCA_H=1 -DHAVE_ALLOCA=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DHAVE__BOOL=1 -DHAVE_STDBOOL_H=1 -Drestrict=__restrict -DHAVE_FLOOR=1 -DHAVE_MEMMOVE=1 -DHAVE_MEMSET=1 -DHAVE_POW=1 -DHAVE_SQRT=1 -DHAVE_STRCHR=1 -I.   -I../libsrc -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -MT smattest.o -MD -MP -MF .deps/smattest.Tpo -c -o smattest.o smattest.cc\nmv -f .deps/smattest.Tpo .deps/smattest.Po\n/bin/sh ../libtool --tag=CXX    --mode=link g++ -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -ljc -L../libsrc -L/home/jp/sage-5.2/local/lib -lntl -lgmp -L/home/jp/sage-5.2/local/lib -lpari -lgmp   -o smattest.exe smattest.o  \nlibtool: link: g++ -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/smattest.exe smattest.o  /home/jp/sage-5.2/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.dll.a -L../libsrc -L/home/jp/sage-5.2/local/lib /home/jp/sage-5.2/local/lib/libntl.dll.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -lpari /home/jp/sage-5.2/local/lib/libgmp.dll.a -L/home/jp/sage-5.2/local/lib -L/usr/lib/gcc/i686-pc-cygwin/4.5.3\n```",
    "created_at": "2012-08-21T17:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170680",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:32'></a>I think I now remember what the problem was:
* autotools indeed does its magic with $(EXEEXT),
* but you directly put smattest (and others) in a target, so make tries to build it generically and doesn't use the magic smattest$(EXEEXT) target and its autotools CFLAGS (and the one you provided to it) so it fails
* except on Linux (and others) where the autotools magic defines a target for smattest and we get lucky...

Here is an excerpt of what failed on Cygwin:

```
libtool: link: g++ -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/mwrank.exe mwrank.o  /home/jp/sage-5.2/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -L../libsrc -L/home/jp/sage-5.2/local/lib -lntl -lpari /home/jp/sage-5.2/local/lib/libgmp.dll.a -L/usr/lib/gcc/i686-pc-cygwin/4.5.3 -L/home/jp/sage-5.2/local/lib
g++ -g -O3     smattest.cc   -o smattest
smattest.cc:30:25: erreur fatale: eclib/arith.h : No such file or directory
compilation termine.
<builtin>: recipe for target `smattest' failed
```
After adding $(EXEEXT) I got

```
/bin/sh ../libtool --tag=CXX    --mode=link g++ -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -ljc -L../libsrc -L/home/jp/sage-5.2/local/lib -lntl -lgmp -L/home/jp/sage-5.2/local/lib -lpari -lgmp   -o mwrank.exe mwrank.o  
libtool: link: g++ -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/mwrank.exe mwrank.o  /home/jp/sage-5.2/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.dll.a -L../libsrc -L/home/jp/sage-5.2/local/lib /home/jp/sage-5.2/local/lib/libntl.dll.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -lpari /home/jp/sage-5.2/local/lib/libgmp.dll.a -L/home/jp/sage-5.2/local/lib -L/usr/lib/gcc/i686-pc-cygwin/4.5.3
g++ -DPACKAGE_NAME=\"eclib\" -DPACKAGE_TARNAME=\"eclib\" -DPACKAGE_VERSION=\"2012-04-25\" -DPACKAGE_STRING=\"eclib\ 2012-04-25\" -DPACKAGE_BUGREPORT=\"john.cremona@gmail.com\" -DPACKAGE_URL=\"\" -DPACKAGE=\"eclib\" -DVERSION=\"2012-04-25\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -DHAVE_ALLOCA_H=1 -DHAVE_ALLOCA=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DHAVE__BOOL=1 -DHAVE_STDBOOL_H=1 -Drestrict=__restrict -DHAVE_FLOOR=1 -DHAVE_MEMMOVE=1 -DHAVE_MEMSET=1 -DHAVE_POW=1 -DHAVE_SQRT=1 -DHAVE_STRCHR=1 -I.   -I../libsrc -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -MT smattest.o -MD -MP -MF .deps/smattest.Tpo -c -o smattest.o smattest.cc
mv -f .deps/smattest.Tpo .deps/smattest.Po
/bin/sh ../libtool --tag=CXX    --mode=link g++ -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include  -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3  -ljc -L../libsrc -L/home/jp/sage-5.2/local/lib -lntl -lgmp -L/home/jp/sage-5.2/local/lib -lpari -lgmp   -o smattest.exe smattest.o  
libtool: link: g++ -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -I/home/jp/sage-5.2/local/include -DNTL_ALL -DUSE_PARI_FACTORING -DMETHOD=2 -DNEW_OP_ORDER -g -O3 -o .libs/smattest.exe smattest.o  /home/jp/sage-5.2/spkg/build/eclib-20120428.p0/src/libsrc/.libs/libjc.dll.a -L../libsrc -L/home/jp/sage-5.2/local/lib /home/jp/sage-5.2/local/lib/libntl.dll.a /usr/lib/gcc/i686-pc-cygwin/4.5.3/libstdc++.dll.a -lpari /home/jp/sage-5.2/local/lib/libgmp.dll.a -L/home/jp/sage-5.2/local/lib -L/usr/lib/gcc/i686-pc-cygwin/4.5.3
```



---

archive/issue_comments_170681.json:
```json
{
    "body": "<a id='comment:33'></a>OK -- so I just removed all mention of EXEEXT from the Makefile.am's and redid autoreconf, and in the resulting Makefiles all the targets have got their $(EXEEXT) suffices on correctly.  So provided that these Makefiles are in the distribution it should not be necessary to do anything special.  Could you try that?  There's a new eclib tarball at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/",
    "created_at": "2012-08-21T19:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170681",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:33'></a>OK -- so I just removed all mention of EXEEXT from the Makefile.am's and redid autoreconf, and in the resulting Makefiles all the targets have got their $(EXEEXT) suffices on correctly.  So provided that these Makefiles are in the distribution it should not be necessary to do anything special.  Could you try that?  There's a new eclib tarball at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/



---

archive/issue_comments_170682.json:
```json
{
    "body": "<a id='comment:34'></a>I fear the problem is still present.\nHave a look at tests/Makefile.in; there at line 571, the PROCS_TESTS variable is defined as a list of executable names which do not include $(EXEEXT).\nSo when make will try to build the procs_tests target, it try to build targets without the $(EXEEXT), which on Cygwin are not defined by the autotools magic because EXEXT is not empty.\nOn Linux, as EXEEXT is empty, there will be no problem.\n\nI'll confirm that Cygwin fails in a few tens of minutes.",
    "created_at": "2012-08-21T20:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170682",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:34'></a>I fear the problem is still present.
Have a look at tests/Makefile.in; there at line 571, the PROCS_TESTS variable is defined as a list of executable names which do not include $(EXEEXT).
So when make will try to build the procs_tests target, it try to build targets without the $(EXEEXT), which on Cygwin are not defined by the autotools magic because EXEXT is not empty.
On Linux, as EXEEXT is empty, there will be no problem.

I'll confirm that Cygwin fails in a few tens of minutes.



---

archive/issue_comments_170683.json:
```json
{
    "body": "<a id='comment:35'></a>(In the other places there is indeed $(EXEEXT) thanks to the autotools magic, the problem is precisely that target in proc_tests do not refer to this autogenerated targets!)",
    "created_at": "2012-08-21T20:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170683",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:35'></a>(In the other places there is indeed $(EXEEXT) thanks to the autotools magic, the problem is precisely that target in proc_tests do not refer to this autogenerated targets!)



---

archive/issue_comments_170684.json:
```json
{
    "body": "<a id='comment:36'></a>Mmmm, in fact the build failed while linking libec.\nNot really sure what the point of LIBADD is, but it does not get used for libec.\nAlthough there is a libec_la_LIBADD variable which is empty in Makefile.in.\nMaybe that's what you meant to add?\nhttp://sources.redhat.com/autobook/autobook/autobook_92.html suggests it is at least (no plain LIBADD variable mentionned there, only the LIBADD macro).",
    "created_at": "2012-08-21T21:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170684",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:36'></a>Mmmm, in fact the build failed while linking libec.
Not really sure what the point of LIBADD is, but it does not get used for libec.
Although there is a libec_la_LIBADD variable which is empty in Makefile.in.
Maybe that's what you meant to add?
http://sources.redhat.com/autobook/autobook/autobook_92.html suggests it is at least (no plain LIBADD variable mentionned there, only the LIBADD macro).



---

archive/issue_comments_170685.json:
```json
{
    "body": "<a id='comment:37'></a>Apparently a general AM_LIBADD was suggested:\nhttp://osdir.com/ml/automake-gnu/2012-06/msg00019.html",
    "created_at": "2012-08-21T21:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170685",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:37'></a>Apparently a general AM_LIBADD was suggested:
http://osdir.com/ml/automake-gnu/2012-06/msg00019.html



---

archive/issue_comments_170686.json:
```json
{
    "body": "<a id='comment:38'></a>Or you could use LIBS?",
    "created_at": "2012-08-21T21:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170686",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:38'></a>Or you could use LIBS?



---

archive/issue_comments_170687.json:
```json
{
    "body": "<a id='comment:39'></a>I'll ask the debian guy about LIBADD etc, since that was one of his.",
    "created_at": "2012-08-21T21:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170687",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:39'></a>I'll ask the debian guy about LIBADD etc, since that was one of his.



---

archive/issue_comments_170688.json:
```json
{
    "body": "<a id='comment:40'></a>By the way, using libec_la_LIBADD let libec compile and in fact I got no problems with smattest (and the following programs)!",
    "created_at": "2012-08-21T22:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170688",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:40'></a>By the way, using libec_la_LIBADD let libec compile and in fact I got no problems with smattest (and the following programs)!



---

archive/issue_comments_170689.json:
```json
{
    "body": "<a id='comment:41'></a>The non-failure of the smattest and co might just be luck.\nNow the Makefile producedfirst includes an all target line with as dependencies all the binaries (so with the EXEEXT extension).\nAnd at the end of the Makefile, the all dependencies from your Makefile.am file is also included, so it points through the procs_tests target to the binaries without the EXEEXT extension.\n\nWhat happens I guess is that make first generates the file with a .exe extension, and when it want to generate the files without .exe, the automagic translation made by Cygwin makes it think that smattest=smattest.exe is already uptodate.\n\nNot sure why this did not happen before.\nMaybe was the noinst_PROGRAMS line in Makefile.am added recently?\n\nWhatsoever, I'm not convinced that relying on this behavior from Cygwin is a good idea.",
    "created_at": "2012-08-21T22:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170689",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:41'></a>The non-failure of the smattest and co might just be luck.
Now the Makefile producedfirst includes an all target line with as dependencies all the binaries (so with the EXEEXT extension).
And at the end of the Makefile, the all dependencies from your Makefile.am file is also included, so it points through the procs_tests target to the binaries without the EXEEXT extension.

What happens I guess is that make first generates the file with a .exe extension, and when it want to generate the files without .exe, the automagic translation made by Cygwin makes it think that smattest=smattest.exe is already uptodate.

Not sure why this did not happen before.
Maybe was the noinst_PROGRAMS line in Makefile.am added recently?

Whatsoever, I'm not convinced that relying on this behavior from Cygwin is a good idea.



---

archive/issue_comments_170690.json:
```json
{
    "body": "<a id='comment:42'></a>Not sure this is the right place to continue this discussion, but here are some additional poitns:\n* About the EXEEXT stuff:\n  http://www.gnu.org/savannah-checkouts/gnu/automake/manual/html_node/EXEEXT.html#EXEEXT\n  So I guess you unfortunately really have to add it to the PROCS_TESTS and similar variables.\n  This can be automated using some Makefile loops.\n* about the all target in the progs dir, your first dependencies includes all programs, and then you got Automake PROGRAMS stuff defined depending on the allprogs configuration flag, see below for further comments.\n\n\nTwo additional questions:\n* when allprogs is disabled, only the library and mwrank are installed, but everything is built. Is this intended? On solw platform (let's say Cygwin...) it would be nice to only build what is installed (and so remove the noinst_PROGRAMS stuff). I see the noinst was added in commit 93229fe24a35, could you elaborate on that? has it something to do with check targets?\n* all your tests in the check targets are really similar, except for the executable name of course, do you plan on refatoring that?",
    "created_at": "2012-08-22T07:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170690",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:42'></a>Not sure this is the right place to continue this discussion, but here are some additional poitns:
* About the EXEEXT stuff:
  http://www.gnu.org/savannah-checkouts/gnu/automake/manual/html_node/EXEEXT.html#EXEEXT
  So I guess you unfortunately really have to add it to the PROCS_TESTS and similar variables.
  This can be automated using some Makefile loops.
* about the all target in the progs dir, your first dependencies includes all programs, and then you got Automake PROGRAMS stuff defined depending on the allprogs configuration flag, see below for further comments.


Two additional questions:
* when allprogs is disabled, only the library and mwrank are installed, but everything is built. Is this intended? On solw platform (let's say Cygwin...) it would be nice to only build what is installed (and so remove the noinst_PROGRAMS stuff). I see the noinst was added in commit 93229fe24a35, could you elaborate on that? has it something to do with check targets?
* all your tests in the check targets are really similar, except for the executable name of course, do you plan on refatoring that?



---

archive/issue_comments_170691.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:42 jpflori]:\n\nSorry for the delay, when I got to this today trac was down and then had to wait before I could even reread your post.\n\n> Not sure this is the right place to continue this discussion, but here are some additional poitns:\n\n\nI'm happy to have the discussion here since then it's properly on the record.  I should perhaps add to the CC list Volker and Leif since they helped with the autotoolification earlier this year.\n\n> * About the EXEEXT stuff:\n>   http://www.gnu.org/savannah-checkouts/gnu/automake/manual/html_node/EXEEXT.html#EXEEXT\n>   So I guess you unfortunately really have to add it to the PROCS_TESTS and similar variables.\n\n\nOK, I'll do that.  It makes sense.\n\n>   This can be automated using some Makefile loops.\n\n\nNo problem, it only needs doing once.\n\n> * about the all target in the progs dir, your first dependencies includes all programs, and then you got Automake PROGRAMS stuff defined depending on the allprogs configuration flag, see below for further comments.\n> \n> \n> Two additional questions:\n> * when allprogs is disabled, only the library and mwrank are installed, but everything is built. Is this intended? On solw platform (let's say Cygwin...) it would be nice to only build what is installed (and so remove the noinst_PROGRAMS stuff). I see the noinst was added in commit 93229fe24a35, could you elaborate on that? has it something to do with check targets?\n\n\nThis should definitely be possible.  I only added the allprogs thing later on, specifically for Sage where the only binary used is mwrank.  So , progs that should be the only binary built (when allprogs is disabled).\n\n> * all your tests in the check targets are really similar, except for the executable name of course, do you plan on refatoring that?\n\n\nDo you mean, by some sort of loop, or by clever wildcard targets in the Makefile?  Would you fancy writing something suitable?  Otherwise it does not seem very urgent (and they are similar, but not identical...)\n\nI'll work more on this tomorrow.",
    "created_at": "2012-08-22T19:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170691",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:43'></a>Replying to [comment:42 jpflori]:

Sorry for the delay, when I got to this today trac was down and then had to wait before I could even reread your post.

> Not sure this is the right place to continue this discussion, but here are some additional poitns:


I'm happy to have the discussion here since then it's properly on the record.  I should perhaps add to the CC list Volker and Leif since they helped with the autotoolification earlier this year.

> * About the EXEEXT stuff:
>   http://www.gnu.org/savannah-checkouts/gnu/automake/manual/html_node/EXEEXT.html#EXEEXT
>   So I guess you unfortunately really have to add it to the PROCS_TESTS and similar variables.


OK, I'll do that.  It makes sense.

>   This can be automated using some Makefile loops.


No problem, it only needs doing once.

> * about the all target in the progs dir, your first dependencies includes all programs, and then you got Automake PROGRAMS stuff defined depending on the allprogs configuration flag, see below for further comments.
> 
> 
> Two additional questions:
> * when allprogs is disabled, only the library and mwrank are installed, but everything is built. Is this intended? On solw platform (let's say Cygwin...) it would be nice to only build what is installed (and so remove the noinst_PROGRAMS stuff). I see the noinst was added in commit 93229fe24a35, could you elaborate on that? has it something to do with check targets?


This should definitely be possible.  I only added the allprogs thing later on, specifically for Sage where the only binary used is mwrank.  So , progs that should be the only binary built (when allprogs is disabled).

> * all your tests in the check targets are really similar, except for the executable name of course, do you plan on refatoring that?


Do you mean, by some sort of loop, or by clever wildcard targets in the Makefile?  Would you fancy writing something suitable?  Otherwise it does not seem very urgent (and they are similar, but not identical...)

I'll work more on this tomorrow.



---

archive/issue_comments_170692.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [comment:43 cremona]:\n/EXEEXT.html#EXEEXT\n> >   So I guess you unfortunately really have to add it to the PROCS_TESTS and similar variables.\n\n> \n> OK, I'll do that.  It makes sense.\n> \n\nReplacing\n\n```\nPROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics\nprocs_progs: $(PROCS_PROGS)\n```\nby\n\n```\nPROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics\nprocs_progs: $(addsuffix $(EXEEXT), $(PROCS_PROGS))\n```\neverywhere needed should do the trick.\n> is built. Is this intended? On solw platform (let's say Cygwin...) it would be nice to only build what is installed (and so remove the noinst_PROGRAMS stuff). I see the noinst was added in commit 93229fe24a35, could you elaborate on that? has it something to do with check targets?\n> \n> This should definitely be possible.  I only added the allprogs thing later on, specifically for Sage where the only binary used is mwrank.  So , progs that should be the only binary built (when allprogs is disabled).\n\nGreat!\nI guess this implies removing noinst_PROGRAMS but also some dependencies for the all target:\n\n```\nprogs: procs_progs qcurves_progs qrank_progs g0n_progs\n```\nwhich would become\n\n```\nprogs: $(bin_PROGRAMS)\n```\nif that works,\nor something like\n\n```\nif ALLPROGS\nPROGS = $(PROCS_PROGS) $(QCURVES_PROGS) $(QRANK_PROGS) $(G0N_PROGS)\nelse\nPROGS = mwrank$(EXEEXT)\nendif\n\nprogs: $(PROGS)\n```\n> \n> > * all your tests in the check targets are really similar, except for the executable name of course, do you plan on refatoring that?\n \n> \n> Do you mean, by some sort of loop, or by clever wildcard targets in the Makefile?  Would you fancy writing something suitable?  Otherwise it does not seem very urgent (and they are similar, but not identical...)\n\nFor all the programs tested in a similar way, you could replace\n\n```\ncheck_qrank: qrank_progs\n\t@echo Checking qrank programs...\n\t./mwrank < $(test_input_dir)/mwrank.in > mwrank.testout 2>/dev/null && diff mwrank.testout $(test_output_dir)/mwrank.out\n\t./reduce_quartics < $(test_input_dir)/reduce_quartics.in > reduce_quartics.testout 2>/dev/null && diff reduce_quartics.testout $(test_output_dir)/reduce_quartics.out\n\t./quartic_points < $(test_input_dir)/quartic_points.in > quartic_points.testout 2>/dev/null && diff quartic_points.testout $(test_output_dir)/quartic_points.out\n\trm -f PRIMES 1\n```\nby something like\n\n```\ncheck_run = ./$(prog)$(EXEEXT) < $(test_input_dir)/$(prog).in > $(prog).testout 2>/dev/null && diff $(prog).testout $(test_output_dir)/$(prog).out || exit $$?\n\ncheck_qrank: qrank_progs\n\t@echo Checking qrank programs...\n\t$(foreach prog, $(PROCS_PROGS), $(check_run))\n\trm -f PRIMES 1\n```\nOr, potentially better cause it can use parallelism, using Makefile dependencies\n\n```\ncheck_run = ./$<$(EXEEXT) < $(test_input_dir)/$<.in > $<.testout 2>/dev/null && diff $<.testout $(test_output_dir)/$<.out || exit $$?\n\n%_RUN: %$(EXEEXT)\n\t$(check_run)\n\nqrank_progs_RUN: $(addsuffix _RUN, $(QRANK_PROGS))\n\ncheck_qrank: qrank_progs qrank_progs_RUN\n\trm -f PRIMES 1\n\n```\nprovided it works.\n\nAnd for parts were not every executable is tested in this way, you could create a secondary variable\n\n```\nQRANK_PROGS_TEST = ...\n```\nincluding only the ones to be tested and use it instead of\n\n```\nQRANK_PROGS\n```\ndirectly.\n\nI'll test such ideas tonight.",
    "created_at": "2012-08-22T20:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170692",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:44'></a>Replying to [comment:43 cremona]:
/EXEEXT.html#EXEEXT
> >   So I guess you unfortunately really have to add it to the PROCS_TESTS and similar variables.

> 
> OK, I'll do that.  It makes sense.
> 

Replacing

```
PROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics
procs_progs: $(PROCS_PROGS)
```
by

```
PROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics
procs_progs: $(addsuffix $(EXEEXT), $(PROCS_PROGS))
```
everywhere needed should do the trick.
> is built. Is this intended? On solw platform (let's say Cygwin...) it would be nice to only build what is installed (and so remove the noinst_PROGRAMS stuff). I see the noinst was added in commit 93229fe24a35, could you elaborate on that? has it something to do with check targets?
> 
> This should definitely be possible.  I only added the allprogs thing later on, specifically for Sage where the only binary used is mwrank.  So , progs that should be the only binary built (when allprogs is disabled).

Great!
I guess this implies removing noinst_PROGRAMS but also some dependencies for the all target:

```
progs: procs_progs qcurves_progs qrank_progs g0n_progs
```
which would become

```
progs: $(bin_PROGRAMS)
```
if that works,
or something like

```
if ALLPROGS
PROGS = $(PROCS_PROGS) $(QCURVES_PROGS) $(QRANK_PROGS) $(G0N_PROGS)
else
PROGS = mwrank$(EXEEXT)
endif

progs: $(PROGS)
```
> 
> > * all your tests in the check targets are really similar, except for the executable name of course, do you plan on refatoring that?
 
> 
> Do you mean, by some sort of loop, or by clever wildcard targets in the Makefile?  Would you fancy writing something suitable?  Otherwise it does not seem very urgent (and they are similar, but not identical...)

For all the programs tested in a similar way, you could replace

```
check_qrank: qrank_progs
	@echo Checking qrank programs...
	./mwrank < $(test_input_dir)/mwrank.in > mwrank.testout 2>/dev/null && diff mwrank.testout $(test_output_dir)/mwrank.out
	./reduce_quartics < $(test_input_dir)/reduce_quartics.in > reduce_quartics.testout 2>/dev/null && diff reduce_quartics.testout $(test_output_dir)/reduce_quartics.out
	./quartic_points < $(test_input_dir)/quartic_points.in > quartic_points.testout 2>/dev/null && diff quartic_points.testout $(test_output_dir)/quartic_points.out
	rm -f PRIMES 1
```
by something like

```
check_run = ./$(prog)$(EXEEXT) < $(test_input_dir)/$(prog).in > $(prog).testout 2>/dev/null && diff $(prog).testout $(test_output_dir)/$(prog).out || exit $$?

check_qrank: qrank_progs
	@echo Checking qrank programs...
	$(foreach prog, $(PROCS_PROGS), $(check_run))
	rm -f PRIMES 1
```
Or, potentially better cause it can use parallelism, using Makefile dependencies

```
check_run = ./$<$(EXEEXT) < $(test_input_dir)/$<.in > $<.testout 2>/dev/null && diff $<.testout $(test_output_dir)/$<.out || exit $$?

%_RUN: %$(EXEEXT)
	$(check_run)

qrank_progs_RUN: $(addsuffix _RUN, $(QRANK_PROGS))

check_qrank: qrank_progs qrank_progs_RUN
	rm -f PRIMES 1

```
provided it works.

And for parts were not every executable is tested in this way, you could create a secondary variable

```
QRANK_PROGS_TEST = ...
```
including only the ones to be tested and use it instead of

```
QRANK_PROGS
```
directly.

I'll test such ideas tonight.



---

archive/issue_comments_170693.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:44 jpflori]:\n> I guess this implies removing noinst_PROGRAMS but also some dependencies for the all target:\n> \n> ```\n> progs: procs_progs qcurves_progs qrank_progs g0n_progs\n> ```\n> which would become\n> \n> ```\n> progs: $(bin_PROGRAMS)\n> ```\n> if that works,\n\nIn fact, I think you can just remove the all targets...\nThe program included in bin_PROGRAMS will be built anywat thanks to autotools.",
    "created_at": "2012-08-22T21:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170693",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:45'></a>Replying to [comment:44 jpflori]:
> I guess this implies removing noinst_PROGRAMS but also some dependencies for the all target:
> 
> ```
> progs: procs_progs qcurves_progs qrank_progs g0n_progs
> ```
> which would become
> 
> ```
> progs: $(bin_PROGRAMS)
> ```
> if that works,

In fact, I think you can just remove the all targets...
The program included in bin_PROGRAMS will be built anywat thanks to autotools.



---

archive/issue_comments_170694.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:44 jpflori]:\n> Replacing\n> \n> ```\n> PROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics\n> procs_progs: $(PROCS_PROGS)\n> ```\n> by\n> \n> ```\n> PROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics\n> procs_progs: $(addsuffix $(EXEEXT), $(PROCS_PROGS))\n> ```\n> everywhere needed should do the trick.\n\nHum, Automake does not like GNU make extensions...",
    "created_at": "2012-08-22T21:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170694",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:46'></a>Replying to [comment:44 jpflori]:
> Replacing
> 
> ```
> PROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics
> procs_progs: $(PROCS_PROGS)
> ```
> by
> 
> ```
> PROCS_PROGS = solve_conic solve_legendre reduce_cubics list_cubics
> procs_progs: $(addsuffix $(EXEEXT), $(PROCS_PROGS))
> ```
> everywhere needed should do the trick.

Hum, Automake does not like GNU make extensions...



---

archive/issue_comments_170695.json:
```json
{
    "body": "<a id='comment:47'></a>Some other comments:\n* there seems to be some inconsistencies in the comments about the progs/tests not checked, and in tests h1degphi built but not checked\n* could you make the distinction between progs and tests clearer (to me! sorry, I'm not really used to eclib and mwrank...): are progs really progs for computations and tests only testing which have no real interest by themselves?\n* in the tests directory d2 is put in two targets",
    "created_at": "2012-08-22T22:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170695",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:47'></a>Some other comments:
* there seems to be some inconsistencies in the comments about the progs/tests not checked, and in tests h1degphi built but not checked
* could you make the distinction between progs and tests clearer (to me! sorry, I'm not really used to eclib and mwrank...): are progs really progs for computations and tests only testing which have no real interest by themselves?
* in the tests directory d2 is put in two targets



---

archive/issue_comments_170696.json:
```json
{
    "body": "Attachment [eclib-am.patch](tarball://root/attachments/some-uuid/ticket13325/eclib-am.patch) by jpflori created at 2012-08-22 22:35:14\n\nPatch to am files.",
    "created_at": "2012-08-22T22:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170696",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [eclib-am.patch](tarball://root/attachments/some-uuid/ticket13325/eclib-am.patch) by jpflori created at 2012-08-22 22:35:14

Patch to am files.



---

archive/issue_comments_170697.json:
```json
{
    "body": "<a id='comment:48'></a>Here is a patch which seems more or less functional in Linux at least (except that autoreconf -i rants about GNU extensions...).\n\nA couple of remarks:\n* the programs in test are only built for make check\n* in progs, when make check is run all programs are built and tested even when -disable-allprogs was passed, thats maybe not the most sensible choice\n* as mentionned above, some comments about files checked should be modified, and some other added\n* I've forgot to remove some file which should not be tested, so it fails at some point",
    "created_at": "2012-08-23T07:15:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170697",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:48'></a>Here is a patch which seems more or less functional in Linux at least (except that autoreconf -i rants about GNU extensions...).

A couple of remarks:
* the programs in test are only built for make check
* in progs, when make check is run all programs are built and tested even when -disable-allprogs was passed, thats maybe not the most sensible choice
* as mentionned above, some comments about files checked should be modified, and some other added
* I've forgot to remove some file which should not be tested, so it fails at some point



---

archive/issue_comments_170698.json:
```json
{
    "body": "<a id='comment:49'></a>OK, I have the patch and will try it out, expect to update the source tarball accordingly (I will report back).\n\nTo answer your (reasonable) questions:  yes, the intention is that binaries which are only used for testing are in tests, whle ones which people might actually want to run are in progs.  It's not an absolute distinction: one of the \"tests\" is a perfectly good interactive program which prompts for an elliptic curve and outputs its conductor;  but these days I would not expect anyone to use this program for that as they can get conductors from Sage (or Magma or pari), so it has the status of a test that the conductor-computing code (which definitely is used elsewhere in the library) is correct.\n\nSecondly, in progs, the only program used in Sage is mwrank;  there are some others here which could easily be used in Sage, though wrapping the relavant library functions would be better.  But anyone using eclib outside of Sage (including me, installing it on various machines) needs more than that, and these other prgrams are in progs.\n\nInconsistencies are no great surprise given that I completely rewrote this back in March/April, and (as you have observed) changed my mind a bit since then as to what should go where.  I'll put in a test for h1degphi (though this is actually testing some functionality which I no longer use so I might decide to remove it instead).  I'll also put in a test for d2.  I think that the ones listed in extra_progs are the test programs which I build but do not yet have test data for;  I will sort that out.  [Note that until I started repackaging this code for Sage back in 2007 I did not have any standard test data at all;  this is one good habit Sage has taught me!]",
    "created_at": "2012-08-23T11:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170698",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:49'></a>OK, I have the patch and will try it out, expect to update the source tarball accordingly (I will report back).

To answer your (reasonable) questions:  yes, the intention is that binaries which are only used for testing are in tests, whle ones which people might actually want to run are in progs.  It's not an absolute distinction: one of the "tests" is a perfectly good interactive program which prompts for an elliptic curve and outputs its conductor;  but these days I would not expect anyone to use this program for that as they can get conductors from Sage (or Magma or pari), so it has the status of a test that the conductor-computing code (which definitely is used elsewhere in the library) is correct.

Secondly, in progs, the only program used in Sage is mwrank;  there are some others here which could easily be used in Sage, though wrapping the relavant library functions would be better.  But anyone using eclib outside of Sage (including me, installing it on various machines) needs more than that, and these other prgrams are in progs.

Inconsistencies are no great surprise given that I completely rewrote this back in March/April, and (as you have observed) changed my mind a bit since then as to what should go where.  I'll put in a test for h1degphi (though this is actually testing some functionality which I no longer use so I might decide to remove it instead).  I'll also put in a test for d2.  I think that the ones listed in extra_progs are the test programs which I build but do not yet have test data for;  I will sort that out.  [Note that until I started repackaging this code for Sage back in 2007 I did not have any standard test data at all;  this is one good habit Sage has taught me!]



---

archive/issue_comments_170699.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 cremona]:\n> To answer your (reasonable) questions:  yes, the intention is that binaries which are only used for testing are in tests, whle ones which people might actually want to run are in progs.  It's not an absolute distinction: one of the \"tests\" is a perfectly good interactive program which prompts for an elliptic curve and outputs its conductor;  but these days I would not expect anyone to use this program for that as they can get conductors from Sage (or Magma or pari), so it has the status of a test that the conductor-computing code (which definitely is used elsewhere in the library) is correct.\n\nI see, thanks for the explanation.\n> \n> Secondly, in progs, the only program used in Sage is mwrank;  there are some others here which could easily be used in Sage, though wrapping the relavant library functions would be better.  But anyone using eclib outside of Sage (including me, installing it on various machines) needs more than that, and these other prgrams are in progs.\n\nAbout the fact that only mwrank is installed in Sage, after thinking a little bit about that, I'm not convinced anymore that providing an option in your build system only to please Sage is really relevant.\n\nI mean that if at some point someone decides to integrate more of them, you'll have to modify your build system once more.\nWhereas having everything installed by default is not so painful, that's just a few more kB which are insignificant in comparison with Sage's current size.\n> \n> Inconsistencies are no great surprise given that I completely rewrote this back in March/April, and (as you have observed) changed my mind a bit since then as to what should go where.  I'll put in a test for h1degphi (though this is actually testing some functionality which I no longer use so I might decide to remove it instead).  I'll also put in a test for d2.  I think that the ones listed in extra_progs are the test programs which I build but do not yet have test data for;  I will sort that out.  [Note that until I started repackaging this code for Sage back in 2007 I did not have any standard test data at all;  this is one good habit Sage has taught me!]\n\nAbout the tests, it might be a good idea to actually test that the output of diff is empty (with wc or something like that) and error out if its not.",
    "created_at": "2012-08-23T14:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170699",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:50'></a>Replying to [comment:49 cremona]:
> To answer your (reasonable) questions:  yes, the intention is that binaries which are only used for testing are in tests, whle ones which people might actually want to run are in progs.  It's not an absolute distinction: one of the "tests" is a perfectly good interactive program which prompts for an elliptic curve and outputs its conductor;  but these days I would not expect anyone to use this program for that as they can get conductors from Sage (or Magma or pari), so it has the status of a test that the conductor-computing code (which definitely is used elsewhere in the library) is correct.

I see, thanks for the explanation.
> 
> Secondly, in progs, the only program used in Sage is mwrank;  there are some others here which could easily be used in Sage, though wrapping the relavant library functions would be better.  But anyone using eclib outside of Sage (including me, installing it on various machines) needs more than that, and these other prgrams are in progs.

About the fact that only mwrank is installed in Sage, after thinking a little bit about that, I'm not convinced anymore that providing an option in your build system only to please Sage is really relevant.

I mean that if at some point someone decides to integrate more of them, you'll have to modify your build system once more.
Whereas having everything installed by default is not so painful, that's just a few more kB which are insignificant in comparison with Sage's current size.
> 
> Inconsistencies are no great surprise given that I completely rewrote this back in March/April, and (as you have observed) changed my mind a bit since then as to what should go where.  I'll put in a test for h1degphi (though this is actually testing some functionality which I no longer use so I might decide to remove it instead).  I'll also put in a test for d2.  I think that the ones listed in extra_progs are the test programs which I build but do not yet have test data for;  I will sort that out.  [Note that until I started repackaging this code for Sage back in 2007 I did not have any standard test data at all;  this is one good habit Sage has taught me!]

About the tests, it might be a good idea to actually test that the output of diff is empty (with wc or something like that) and error out if its not.



---

archive/issue_comments_170700.json:
```json
{
    "body": "<a id='comment:51'></a>Thanks for the comments.  I can avoit the warning about GNU make extesion for the addsuffix command by using (for example)\n\n```\nPROCS_PROGS_SUFFIXED = $(PROCS_PROGS:=$(EXEEXT))\n```\ninstead.  I have not yet found a way to avoid your (very neat) checkrun macro together with foreach.  I think I will leave that in and wait for someone to aomplain (there usually is someone, if some non-POSIX thing is used).\n\nI have added test input/output for the remaining programs in progs.  In view of your last comments I will not stop that other programs from building wnen allprogs is not set:  it would need changing the working of \"make check\" too, and I think that something useful is being served by building and testing these programs in progs as well as the pure tests.  And I will make similar changes to the Makefile in tests as you did in progs, including adding test input/output for the few which do not yet have them.\n\nGood point about checking the diff output; I will try that.",
    "created_at": "2012-08-23T14:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170700",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:51'></a>Thanks for the comments.  I can avoit the warning about GNU make extesion for the addsuffix command by using (for example)

```
PROCS_PROGS_SUFFIXED = $(PROCS_PROGS:=$(EXEEXT))
```
instead.  I have not yet found a way to avoid your (very neat) checkrun macro together with foreach.  I think I will leave that in and wait for someone to aomplain (there usually is someone, if some non-POSIX thing is used).

I have added test input/output for the remaining programs in progs.  In view of your last comments I will not stop that other programs from building wnen allprogs is not set:  it would need changing the working of "make check" too, and I think that something useful is being served by building and testing these programs in progs as well as the pure tests.  And I will make similar changes to the Makefile in tests as you did in progs, including adding test input/output for the few which do not yet have them.

Good point about checking the diff output; I will try that.



---

archive/issue_comments_170701.json:
```json
{
    "body": "<a id='comment:52'></a>PS regarding diff: I am using the fact that the exit status is 0 iff the files are the same.  What could be better?",
    "created_at": "2012-08-23T14:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170701",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:52'></a>PS regarding diff: I am using the fact that the exit status is 0 iff the files are the same.  What could be better?



---

archive/issue_comments_170702.json:
```json
{
    "body": "<a id='comment:53'></a>Replying to [comment:52 cremona]:\n> PS regarding diff: I am using the fact that the exit status is 0 iff the files are the same.  What could be better?\n\nI think that's perfect, it's just that I was not aware of that.",
    "created_at": "2012-08-23T14:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170702",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:53'></a>Replying to [comment:52 cremona]:
> PS regarding diff: I am using the fact that the exit status is 0 iff the files are the same.  What could be better?

I think that's perfect, it's just that I was not aware of that.



---

archive/issue_comments_170703.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:51 cremona]:\n> Thanks for the comments.  I can avoit the warning about GNU make extesion for the addsuffix command by using (for example)\n> \n> ```\n> PROCS_PROGS_SUFFIXED = $(PROCS_PROGS:=$(EXEEXT))\n> ```\n> instead.  I have not yet found a way to avoid your (very neat) checkrun macro together with foreach.  I think I will leave that in and wait for someone to aomplain (there usually is someone, if some non-POSIX thing is used).\n> \n> I have added test input/output for the remaining programs in progs.  In view of your last comments I will not stop that other programs from building wnen allprogs is not set:  it would need changing the working of \"make check\" too, and I think that something useful is being served by building and testing these programs in progs as well as the pure tests.  And I will make similar changes to the Makefile in tests as you did in progs, including adding test input/output for the few which do not yet have them.\n\nOh, I somehow failed to included such changes in the patch I uploaded here.\nAs you noted, the changes should be similar to those for progs.\n\nJust one remark, for the programs to be built in test, you can use check_PROGRAMS which ensures that they are only built for make check, rather that noinst_PROGRAMS.\n> \n> Good point about checking the diff output; I will try that.",
    "created_at": "2012-08-23T14:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170703",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:54'></a>Replying to [comment:51 cremona]:
> Thanks for the comments.  I can avoit the warning about GNU make extesion for the addsuffix command by using (for example)
> 
> ```
> PROCS_PROGS_SUFFIXED = $(PROCS_PROGS:=$(EXEEXT))
> ```
> instead.  I have not yet found a way to avoid your (very neat) checkrun macro together with foreach.  I think I will leave that in and wait for someone to aomplain (there usually is someone, if some non-POSIX thing is used).
> 
> I have added test input/output for the remaining programs in progs.  In view of your last comments I will not stop that other programs from building wnen allprogs is not set:  it would need changing the working of "make check" too, and I think that something useful is being served by building and testing these programs in progs as well as the pure tests.  And I will make similar changes to the Makefile in tests as you did in progs, including adding test input/output for the few which do not yet have them.

Oh, I somehow failed to included such changes in the patch I uploaded here.
As you noted, the changes should be similar to those for progs.

Just one remark, for the programs to be built in test, you can use check_PROGRAMS which ensures that they are only built for make check, rather that noinst_PROGRAMS.
> 
> Good point about checking the diff output; I will try that.



---

archive/issue_comments_170704.json:
```json
{
    "body": "<a id='comment:55'></a>OK, I will try using check_PROGRAMS, good idea.\n\nOne side-effect of using the loop (foreach...) for the tests is that instead of each test being visible on a separate line they are all run together with \";\" separating them (which I see you included, as it does not work without).  That does not look good.  I have a version in which first check_run is changes slightly replacing $(prog) by $${prog}, and then instead of the foreach I have\n\n```\nfor prog in $(PROCS_TESTS); do\t$(check_run); done\n```\nwhich works --it gives no output at all when the tests pass except echoing the whole input line:\n\n```\njec@fermat%(cd tests; make check)\nRunning procs checks...\nfor prog in smattest comptest rattest bigrattest ptest mptest tbessel mvectest mmattest mspace thilbert tp2points tilll vectest1 vectest2 mattest1 mattest2 space1 space2 svectest1 svectest2 tcon2 tlegcert; do\t./${prog} < ./in/${prog}.in > ${prog}.testout 2>/dev/null && diff ${prog}.testout ./out/${prog}.out || exit $?; done\n```\n-- but I do not know if this shell loop would work on non-linux (or even non-bash) systems.  Do you know?",
    "created_at": "2012-08-23T15:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170704",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:55'></a>OK, I will try using check_PROGRAMS, good idea.

One side-effect of using the loop (foreach...) for the tests is that instead of each test being visible on a separate line they are all run together with ";" separating them (which I see you included, as it does not work without).  That does not look good.  I have a version in which first check_run is changes slightly replacing $(prog) by $${prog}, and then instead of the foreach I have

```
for prog in $(PROCS_TESTS); do	$(check_run); done
```
which works --it gives no output at all when the tests pass except echoing the whole input line:

```
jec@fermat%(cd tests; make check)
Running procs checks...
for prog in smattest comptest rattest bigrattest ptest mptest tbessel mvectest mmattest mspace thilbert tp2points tilll vectest1 vectest2 mattest1 mattest2 space1 space2 svectest1 svectest2 tcon2 tlegcert; do	./${prog} < ./in/${prog}.in > ${prog}.testout 2>/dev/null && diff ${prog}.testout ./out/${prog}.out || exit $?; done
```
-- but I do not know if this shell loop would work on non-linux (or even non-bash) systems.  Do you know?



---

archive/issue_comments_170705.json:
```json
{
    "body": "<a id='comment:56'></a>I think (and hope) that for loops are part of POSIX spec for shells, just as if/then/fi, or a POSIX compliant shell would not offer much scripting capabilities.\n\nIf you're on a Debian (or derivated) system, dash which is quite minimal should be installed by default.\nTo be sure it is used by make (for testing purpose), I think you can define SHELL or sthg like that in the Makefile.",
    "created_at": "2012-08-23T15:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170705",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:56'></a>I think (and hope) that for loops are part of POSIX spec for shells, just as if/then/fi, or a POSIX compliant shell would not offer much scripting capabilities.

If you're on a Debian (or derivated) system, dash which is quite minimal should be installed by default.
To be sure it is used by make (for testing purpose), I think you can define SHELL or sthg like that in the Makefile.



---

archive/issue_comments_170706.json:
```json
{
    "body": "<a id='comment:57'></a>If the executed line is not printed anymore, it would be nice to modify the \"|| exit\" part to print the culprit name.\n\nOr prefixing echo Testing $${prog} to check_run.",
    "created_at": "2012-08-23T15:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170706",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:57'></a>If the executed line is not printed anymore, it would be nice to modify the "|| exit" part to print the culprit name.

Or prefixing echo Testing $${prog} to check_run.



---

archive/issue_comments_170707.json:
```json
{
    "body": "<a id='comment:58'></a>This has taken a long time but I think I have fixed all the issues raised so far.  I moved some programs between tests and progs, unified all the tests so they can be run with a loop, including adding tests for the programs which did not.  (One of these was not trivial since the program prompts for the filename of a file of input data and it was not easy to get that to work even with \"make distcheck\" -- but it does!).\n\nThere are no more uses of addsuffix() or foreach() but I do rely on loops in Makefile rules,so do not know whether these will run properly on other systems.\n\nThere's a new tarball at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/",
    "created_at": "2012-08-23T19:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170707",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:58'></a>This has taken a long time but I think I have fixed all the issues raised so far.  I moved some programs between tests and progs, unified all the tests so they can be run with a loop, including adding tests for the programs which did not.  (One of these was not trivial since the program prompts for the filename of a file of input data and it was not easy to get that to work even with "make distcheck" -- but it does!).

There are no more uses of addsuffix() or foreach() but I do rely on loops in Makefile rules,so do not know whether these will run properly on other systems.

There's a new tarball at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/



---

archive/issue_comments_170708.json:
```json
{
    "body": "<a id='comment:59'></a>Looks really nice.\n\nIn tests dir, you forgot to replace LDADD by LIBS and the dependencies of check targets by binaries names with EXEEXT appended (it should work as is, even on Cygwin, but for a bad reason as mentioned before).\n\nAnd unfortunately, I don't think the echo -e command is portable.\nFor example it will behave differently on bash and dash.\n(On of them will just print -e and will not interpret the \\c).\n\nFinally, as I'm a little confused by your answer about what programs in progs are built/check, I did not suggest not to check every program when allprogs is not set and make check is run.\n\nIn fact I rather suggested to always build and install (and check) every program, i.e. remove the allprogs option.\nHence, in the future, if Sage uses more programs from your package it wont need further modification (and it will only take a little more time, and a tiny amount of memory, when built for Sage).\n\nIf you want to keep the option, i suggest you add the programs different from mwrank in check_PROGRAMS when the option is disabled (I'd say you could even include mwrank for simplicity, to use the already defined variables).\nThat way, automake will generate its magic targets to build the executables (Ive not tested yet, but Id say the generated Makefile won't include anything specific currently and they will be built generically... and surely fail).",
    "created_at": "2012-08-23T21:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170708",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:59'></a>Looks really nice.

In tests dir, you forgot to replace LDADD by LIBS and the dependencies of check targets by binaries names with EXEEXT appended (it should work as is, even on Cygwin, but for a bad reason as mentioned before).

And unfortunately, I don't think the echo -e command is portable.
For example it will behave differently on bash and dash.
(On of them will just print -e and will not interpret the \c).

Finally, as I'm a little confused by your answer about what programs in progs are built/check, I did not suggest not to check every program when allprogs is not set and make check is run.

In fact I rather suggested to always build and install (and check) every program, i.e. remove the allprogs option.
Hence, in the future, if Sage uses more programs from your package it wont need further modification (and it will only take a little more time, and a tiny amount of memory, when built for Sage).

If you want to keep the option, i suggest you add the programs different from mwrank in check_PROGRAMS when the option is disabled (I'd say you could even include mwrank for simplicity, to use the already defined variables).
That way, automake will generate its magic targets to build the executables (Ive not tested yet, but Id say the generated Makefile won't include anything specific currently and they will be built generically... and surely fail).



---

archive/issue_comments_170709.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:59 jpflori]:\n> If you want to keep the option, i suggest you add the programs different from mwrank in check_PROGRAMS when the option is disabled (I'd say you could even include mwrank for simplicity, to use the already defined variables).\n> That way, automake will generate its magic targets to build the executables (Ive not tested yet, but Id say the generated Makefile won't include anything specific currently and they will be built generically... and surely fail).\n\nIn fact automake always generates its magic for all file because their all in one of the bin_PROGRAMS, its just the one actually built which change.\nAnyway, using check_PROGRAMS cannot hurt.",
    "created_at": "2012-08-23T22:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170709",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:60'></a>Replying to [comment:59 jpflori]:
> If you want to keep the option, i suggest you add the programs different from mwrank in check_PROGRAMS when the option is disabled (I'd say you could even include mwrank for simplicity, to use the already defined variables).
> That way, automake will generate its magic targets to build the executables (Ive not tested yet, but Id say the generated Makefile won't include anything specific currently and they will be built generically... and surely fail).

In fact automake always generates its magic for all file because their all in one of the bin_PROGRAMS, its just the one actually built which change.
Anyway, using check_PROGRAMS cannot hurt.



---

archive/issue_comments_170710.json:
```json
{
    "body": "<a id='comment:61'></a>Replying to [comment:59 jpflori]:\n> Looks really nice.\n\n\nThanks.\n\n> \n> In tests dir, you forgot to replace LDADD by LIBS and the dependencies of check targets by binaries names with EXEEXT appended (it should work as is, even on Cygwin, but for a bad reason as mentioned before).\n\n\nFixed.\n\n> \n> And unfortunately, I don't think the echo -e command is portable.\n> For example it will behave differently on bash and dash.\n> (On of them will just print -e and will not interpret the \\c).\n> \n\n\nFixed.   The testing just outputs the test name (one per line) as it goes, with no \"done\" at the end since that would go on a separate line which did not look good.  So, no news is good news for test output.\n\n> Finally, as I'm a little confused by your answer about what programs in progs are built/check, I did not suggest not to check every program when allprogs is not set and make check is run.\n> \n\n\nFixed (see below)\n\n> In fact I rather suggested to always build and install (and check) every program, i.e. remove the allprogs option.\n> Hence, in the future, if Sage uses more programs from your package it wont need further modification (and it will only take a little more time, and a tiny amount of memory, when built for Sage).\n> \n> If you want to keep the option, i suggest you add the programs different from mwrank in check_PROGRAMS when the option is disabled (I'd say you could even include mwrank for simplicity, to use the already defined variables).\n> That way, automake will generate its magic targets to build the executables (Ive not tested yet, but Id say the generated Makefile won't include anything specific currently and they will be built generically... and surely fail).\n\n\nI have kept the allprogs option (set to true by default).  When false: \"make\" builds the library and mwrank only (nothing in tests, nor the other prgrams in progs) while \"make check\" builds and tests everything.  When true: \"make\" builds the library and all programs in progs (nothing in tests) while \"make check\" builds and tests everything.\n\nThere's anew tarball at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/eclib-2012-08-24.tar.gz and I am about to push these changes to https://code.google.com/p/eclib/ .",
    "created_at": "2012-08-24T13:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170710",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:61'></a>Replying to [comment:59 jpflori]:
> Looks really nice.


Thanks.

> 
> In tests dir, you forgot to replace LDADD by LIBS and the dependencies of check targets by binaries names with EXEEXT appended (it should work as is, even on Cygwin, but for a bad reason as mentioned before).


Fixed.

> 
> And unfortunately, I don't think the echo -e command is portable.
> For example it will behave differently on bash and dash.
> (On of them will just print -e and will not interpret the \c).
> 


Fixed.   The testing just outputs the test name (one per line) as it goes, with no "done" at the end since that would go on a separate line which did not look good.  So, no news is good news for test output.

> Finally, as I'm a little confused by your answer about what programs in progs are built/check, I did not suggest not to check every program when allprogs is not set and make check is run.
> 


Fixed (see below)

> In fact I rather suggested to always build and install (and check) every program, i.e. remove the allprogs option.
> Hence, in the future, if Sage uses more programs from your package it wont need further modification (and it will only take a little more time, and a tiny amount of memory, when built for Sage).
> 
> If you want to keep the option, i suggest you add the programs different from mwrank in check_PROGRAMS when the option is disabled (I'd say you could even include mwrank for simplicity, to use the already defined variables).
> That way, automake will generate its magic targets to build the executables (Ive not tested yet, but Id say the generated Makefile won't include anything specific currently and they will be built generically... and surely fail).


I have kept the allprogs option (set to true by default).  When false: "make" builds the library and mwrank only (nothing in tests, nor the other prgrams in progs) while "make check" builds and tests everything.  When true: "make" builds the library and all programs in progs (nothing in tests) while "make check" builds and tests everything.

There's anew tarball at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/eclib-2012-08-24.tar.gz and I am about to push these changes to https://code.google.com/p/eclib/ .



---

archive/issue_comments_170711.json:
```json
{
    "body": "<a id='comment:62'></a>Great.\nCould you tag a release on the repo?\nThen I'll repackage it in a spkg.",
    "created_at": "2012-08-25T09:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170711",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:62'></a>Great.
Could you tag a release on the repo?
Then I'll repackage it in a spkg.



---

archive/issue_comments_170712.json:
```json
{
    "body": "<a id='comment:63'></a>Replying to [comment:62 jpflori]:\n> Great.\n> Could you tag a release on the repo?\n\n\nDone (2012-08-24)\n\n> Then I'll repackage it in a spkg.\n\n\nThanks.  Of course I'll help test, especially if there are some changes needed in Sage.",
    "created_at": "2012-08-25T15:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170712",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:63'></a>Replying to [comment:62 jpflori]:
> Great.
> Could you tag a release on the repo?


Done (2012-08-24)

> Then I'll repackage it in a spkg.


Thanks.  Of course I'll help test, especially if there are some changes needed in Sage.



---

archive/issue_comments_170713.json:
```json
{
    "body": "<a id='comment:64'></a>The spkg at\nhttp://perso.telecom-paristech.fr/~flori/sage/eclib-20120824.spkg\nbuilt and passed its tests on Linux.\nIt also built on Cygwin but got stuck while testing smattest at the end of the test during the rank computation.\nI don't think the later failure should be a blocker, the situation is already much better on Cygwin, and the problem could have another origin (some dependency being broken or I don't know what).\nAnd Cygwin is not supported officialy anyway.",
    "created_at": "2012-08-26T10:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170713",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:64'></a>The spkg at
http://perso.telecom-paristech.fr/~flori/sage/eclib-20120824.spkg
built and passed its tests on Linux.
It also built on Cygwin but got stuck while testing smattest at the end of the test during the rank computation.
I don't think the later failure should be a blocker, the situation is already much better on Cygwin, and the problem could have another origin (some dependency being broken or I don't know what).
And Cygwin is not supported officialy anyway.



---

archive/issue_comments_170714.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+All of this is fixed in the 2012-08-24 release.\n+Try updated spkg at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120824.spkg\n+\n+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-26T10:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170714",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,13 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+All of this is fixed in the 2012-08-24 release.
+Try updated spkg at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120824.spkg
+
+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170715.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:65 jpflori]:\n\nThe spkg installs OK for me but devel/sage/module_list.py needs editing (jc --> ec).",
    "created_at": "2012-08-26T12:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170715",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:66'></a>Replying to [comment:65 jpflori]:

The spkg installs OK for me but devel/sage/module_list.py needs editing (jc --> ec).



---

archive/issue_comments_170716.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-08-26T12:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170716",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_170717.json:
```json
{
    "body": "<a id='comment:67'></a>Oh yes, of course, I did not try to rebuild the Sage library itself yet, but that's definitely needed!",
    "created_at": "2012-08-26T12:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170717",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:67'></a>Oh yes, of course, I did not try to rebuild the Sage library itself yet, but that's definitely needed!



---

archive/issue_comments_170718.json:
```json
{
    "body": "<a id='comment:68'></a>About the spkg changes:\n* I've removed the Padus thing, I could not make it point to anything useful with Google. I guess it used to be a maintainer of the spkg, is that correct?\n* I think the autotools build system should have removed all GNU make specificities (especially thanks to John not using foreach etc. :), this could be confirmed on Solaris or such systems I guess, I don't have access to such systems though.\n\nAbout the module_list.py modification:\n* I'd like to check the need for -lpari on Cygwin mentioned in comments by leif in lines concerning mwrank et al, before we commit it changes to the file.",
    "created_at": "2012-08-27T08:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170718",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:68'></a>About the spkg changes:
* I've removed the Padus thing, I could not make it point to anything useful with Google. I guess it used to be a maintainer of the spkg, is that correct?
* I think the autotools build system should have removed all GNU make specificities (especially thanks to John not using foreach etc. :), this could be confirmed on Solaris or such systems I guess, I don't have access to such systems though.

About the module_list.py modification:
* I'd like to check the need for -lpari on Cygwin mentioned in comments by leif in lines concerning mwrank et al, before we commit it changes to the file.



---

archive/issue_comments_170719.json:
```json
{
    "body": "<a id='comment:69'></a>Replying to [comment:68 jpflori]:\n> About the spkg changes:\n> * I've removed the Padus thing, I could not make it point to anything useful with Google. I guess it used to be a maintainer of the spkg, is that correct?\n\n\nI don't know who that was but I'm sure it is best removed.  It was put there years ago, certainly not by me.\n\n> * I think the autotools build system should have removed all GNU make specificities (especially thanks to John not using foreach etc. :), this could be confirmed on Solaris or such systems I guess, I don't have access to such systems though.\n> \n\n\nNor me.  We'll see.\n\n> About the module_list.py modification:\n> * I'd like to check the need for -lpari on Cygwin mentioned in comments by leif in lines concerning mwrank et al, before we commit it changes to the file.\n\n\nI changed 'jc' to 'ec' in 3 places in that file but even after 'sage -ba' it didn't work properly.  I'll try again today.",
    "created_at": "2012-08-27T09:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170719",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:69'></a>Replying to [comment:68 jpflori]:
> About the spkg changes:
> * I've removed the Padus thing, I could not make it point to anything useful with Google. I guess it used to be a maintainer of the spkg, is that correct?


I don't know who that was but I'm sure it is best removed.  It was put there years ago, certainly not by me.

> * I think the autotools build system should have removed all GNU make specificities (especially thanks to John not using foreach etc. :), this could be confirmed on Solaris or such systems I guess, I don't have access to such systems though.
> 


Nor me.  We'll see.

> About the module_list.py modification:
> * I'd like to check the need for -lpari on Cygwin mentioned in comments by leif in lines concerning mwrank et al, before we commit it changes to the file.


I changed 'jc' to 'ec' in 3 places in that file but even after 'sage -ba' it didn't work properly.  I'll try again today.



---

archive/issue_comments_170720.json:
```json
{
    "body": "Attachment [eclib-20120824.patch](tarball://root/attachments/some-uuid/ticket13325/eclib-20120824.patch) by jpflori created at 2012-08-29 11:21:22\n\nSpkg diff, for review only. Committed in spkg.",
    "created_at": "2012-08-29T11:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170720",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [eclib-20120824.patch](tarball://root/attachments/some-uuid/ticket13325/eclib-20120824.patch) by jpflori created at 2012-08-29 11:21:22

Spkg diff, for review only. Committed in spkg.



---

archive/issue_comments_170721.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-08-29T11:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170721",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_170722.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+All of this is fixed in the 2012-08-24 release.\n+Try updated spkg at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120824.spkg\n+\n+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n+\n+Apply [attachment:trac_13325.patch].\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-08-29T11:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170722",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+All of this is fixed in the 2012-08-24 release.
+Try updated spkg at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120824.spkg
+
+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
+
+Apply [attachment:trac_13325.patch].
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170723.json:
```json
{
    "body": "<a id='comment:70'></a>I've updated module_list.py to take the name change into account.\nI've also removed Leif comment about pari and leave it in the libraries dependencies.\nIndeed, this is needed if we try to link the concerned modules against a static version of eclib.\nThis triggers the need of a static version of pari and the corresponding dependency, and that not only on Cygwin.\n\nIn a perfect world, this will never be needed because everything will properly build as shared libraries, but we never know what will happen.\nUntil now eclib was only build static on Cygwin, so the problem surfaced, now it is also shared, but things may change and I don't think the inclusion of pari hurts enough to be removed right now.\n\nAnd I think this is now needs_review",
    "created_at": "2012-08-29T11:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170723",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:70'></a>I've updated module_list.py to take the name change into account.
I've also removed Leif comment about pari and leave it in the libraries dependencies.
Indeed, this is needed if we try to link the concerned modules against a static version of eclib.
This triggers the need of a static version of pari and the corresponding dependency, and that not only on Cygwin.

In a perfect world, this will never be needed because everything will properly build as shared libraries, but we never know what will happen.
Until now eclib was only build static on Cygwin, so the problem surfaced, now it is also shared, but things may change and I don't think the inclusion of pari hurts enough to be removed right now.

And I think this is now needs_review



---

archive/issue_comments_170724.json:
```json
{
    "body": "<a id='comment:71'></a>I don't think I can be the one to review this being responsible for most of the upstream changes, and in any case I don't have a cygwin system to test on.  But in any case I have built the new spkg successfully (on top of 5.3.beta1 on 64-bit ubuntu linux), applied the patch and am now doing a full test which I'll report back on.",
    "created_at": "2012-08-29T11:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170724",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:71'></a>I don't think I can be the one to review this being responsible for most of the upstream changes, and in any case I don't have a cygwin system to test on.  But in any case I have built the new spkg successfully (on top of 5.3.beta1 on 64-bit ubuntu linux), applied the patch and am now doing a full test which I'll report back on.



---

archive/issue_comments_170725.json:
```json
{
    "body": "<a id='comment:72'></a>Replying to [comment:71 cremona]:\n> I don't think I can be the one to review this being responsible for most of the upstream changes, and in any case I don't have a cygwin system to test on.  But in any case I have built the new spkg successfully (on top of 5.3.beta1 on 64-bit ubuntu linux), applied the patch and am now doing a full test which I'll report back on.\n\n\nThere were several strange failures all complaining that -ljc could not be found, even after applying the patch and remembering sage -b.  I am tring again after sage -ba.  Is there anywhere else these library names are referred to?",
    "created_at": "2012-08-29T12:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170725",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:72'></a>Replying to [comment:71 cremona]:
> I don't think I can be the one to review this being responsible for most of the upstream changes, and in any case I don't have a cygwin system to test on.  But in any case I have built the new spkg successfully (on top of 5.3.beta1 on 64-bit ubuntu linux), applied the patch and am now doing a full test which I'll report back on.


There were several strange failures all complaining that -ljc could not be found, even after applying the patch and remembering sage -b.  I am tring again after sage -ba.  Is there anywhere else these library names are referred to?



---

archive/issue_comments_170726.json:
```json
{
    "body": "<a id='comment:73'></a>That's strange. Can you make sure the patch to the Sage library is correctly applied (stupid question, but...) by looking at module_list.py and searching for \"jc\"?\nOn my Linux system with 5.3.rc0 plus this ticket only, everything looks fine.",
    "created_at": "2012-08-29T12:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170726",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:73'></a>That's strange. Can you make sure the patch to the Sage library is correctly applied (stupid question, but...) by looking at module_list.py and searching for "jc"?
On my Linux system with 5.3.rc0 plus this ticket only, everything looks fine.



---

archive/issue_comments_170727.json:
```json
{
    "body": "<a id='comment:74'></a>Replying to [comment:73 jpflori]:\n> That's strange. Can you make sure the patch to the Sage library is correctly applied (stupid question, but...) by looking at module_list.py and searching for \"jc\"?\n\n\nIt's fine, there is no jc anywahere and grep -w ec module_list.py gives the correct 4 matches,\n\n> On my Linux system with 5.3.rc0 plus this ticket only, everything looks fine.\n\n\nHere is a sample failure:\n\n```\nsage -t -long devel/sage-main/sage/structure/misc.pyx\n**********************************************************************\nFile \"/home/jec/sage-5.3.beta1/devel/sage-main/sage/structure/misc.pyx\", line 244:\n    sage: cython(\"cdef class A:\\n    cdef public int a\")\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jec/sage-5.3.beta1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jec/sage-5.3.beta1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jec/sage-5.3.beta1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_5[7]>\", line 1, in <module>\n        cython(\"cdef class A:\\n    cdef public int a\")###line 244:\n    sage: cython(\"cdef class A:\\n    cdef public int a\")\n      File \"cython_c.pyx\", line 61, in sage.misc.cython_c.cython (sage/misc/cython_c.c:779)\n      File \"/home/jec/sage-5.3.beta1/local/lib/python/site-packages/sage/server/support.py\", line 473, in cython_import_all\n        create_local_c_file=create_local_c_file)\n      File \"/home/jec/sage-5.3.beta1/local/lib/python/site-packages/sage/server/support.py\", line 450, in cython_import\n        **kwds)\n      File \"/home/jec/sage-5.3.beta1/local/lib/python/site-packages/sage/misc/cython.py\", line 539, in cython\n        raise RuntimeError, \"Error compiling %s:\\n%s\\n%s\"%(filename, log, err)\n    RuntimeError: Error compiling /home/jec/.sage//temp/fermat/6134//tmp_0.spyx:\n    running build\n    running build_ext\n    building '_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0' extension\n    creating build\n    creating build/temp.linux-x86_64-2.7\n    gcc -fno-strict-aliasing -fwrapv -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/home/jec/sage-5.3.beta1/local/include/csage/ -I/home/jec/sage-5.3.beta1/local/include/ -I/home/jec/sage-5.3.beta1/local/include/python2.7/ -I/home/jec/sage-5.3.beta1/local/lib/python2.7/site-packages/numpy/core/include -I/home/jec/sage-5.3.beta1/devel/sage/sage/ext/ -I/home/jec/sage-5.3.beta1/devel/sage/ -I/home/jec/sage-5.3.beta1/devel/sage/sage/gsl/ -I/home/jec/.sage//temp/fermat/6134 -I/home/jec/sage-5.3.beta1/local/include/python2.7 -c _home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.c -o build/temp.linux-x86_64-2.7/_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.o -w -O2\n    creating build/lib.linux-x86_64-2.7\n    gcc -pthread -shared -L/home/jec/sage-5.3.beta1/local/lib build/temp.linux-x86_64-2.7/_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.o -L/home/jec/sage-5.3.beta1/local//lib/ -L/home/jec/sage-5.3.beta1/local/lib -lmpfr -lgmp -lgmpxx -lstdc++ -lpari -lm -ljc -lgsl -lgslcblas -latlas -lntl -lcsage -lpython2.7 -o build/lib.linux-x86_64-2.7/_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.so -L/home/jec/sage-5.3.beta1/local//lib\n\n    /usr/bin/ld: cannot find -ljc\n    collect2: ld returned 1 exit status\n    error: command 'gcc' failed with exit status 1\n```\nshowing that it's the linker complaining.\n\nI do not know why during a test any compilation like this needs to be done: recall that I had previously done sage -ba.",
    "created_at": "2012-08-29T13:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170727",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:74'></a>Replying to [comment:73 jpflori]:
> That's strange. Can you make sure the patch to the Sage library is correctly applied (stupid question, but...) by looking at module_list.py and searching for "jc"?


It's fine, there is no jc anywahere and grep -w ec module_list.py gives the correct 4 matches,

> On my Linux system with 5.3.rc0 plus this ticket only, everything looks fine.


Here is a sample failure:

```
sage -t -long devel/sage-main/sage/structure/misc.pyx
**********************************************************************
File "/home/jec/sage-5.3.beta1/devel/sage-main/sage/structure/misc.pyx", line 244:
    sage: cython("cdef class A:\n    cdef public int a")
Exception raised:
    Traceback (most recent call last):
      File "/home/jec/sage-5.3.beta1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jec/sage-5.3.beta1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jec/sage-5.3.beta1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_5[7]>", line 1, in <module>
        cython("cdef class A:\n    cdef public int a")###line 244:
    sage: cython("cdef class A:\n    cdef public int a")
      File "cython_c.pyx", line 61, in sage.misc.cython_c.cython (sage/misc/cython_c.c:779)
      File "/home/jec/sage-5.3.beta1/local/lib/python/site-packages/sage/server/support.py", line 473, in cython_import_all
        create_local_c_file=create_local_c_file)
      File "/home/jec/sage-5.3.beta1/local/lib/python/site-packages/sage/server/support.py", line 450, in cython_import
        **kwds)
      File "/home/jec/sage-5.3.beta1/local/lib/python/site-packages/sage/misc/cython.py", line 539, in cython
        raise RuntimeError, "Error compiling %s:\n%s\n%s"%(filename, log, err)
    RuntimeError: Error compiling /home/jec/.sage//temp/fermat/6134//tmp_0.spyx:
    running build
    running build_ext
    building '_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0' extension
    creating build
    creating build/temp.linux-x86_64-2.7
    gcc -fno-strict-aliasing -fwrapv -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/home/jec/sage-5.3.beta1/local/include/csage/ -I/home/jec/sage-5.3.beta1/local/include/ -I/home/jec/sage-5.3.beta1/local/include/python2.7/ -I/home/jec/sage-5.3.beta1/local/lib/python2.7/site-packages/numpy/core/include -I/home/jec/sage-5.3.beta1/devel/sage/sage/ext/ -I/home/jec/sage-5.3.beta1/devel/sage/ -I/home/jec/sage-5.3.beta1/devel/sage/sage/gsl/ -I/home/jec/.sage//temp/fermat/6134 -I/home/jec/sage-5.3.beta1/local/include/python2.7 -c _home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.c -o build/temp.linux-x86_64-2.7/_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.o -w -O2
    creating build/lib.linux-x86_64-2.7
    gcc -pthread -shared -L/home/jec/sage-5.3.beta1/local/lib build/temp.linux-x86_64-2.7/_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.o -L/home/jec/sage-5.3.beta1/local//lib/ -L/home/jec/sage-5.3.beta1/local/lib -lmpfr -lgmp -lgmpxx -lstdc++ -lpari -lm -ljc -lgsl -lgslcblas -latlas -lntl -lcsage -lpython2.7 -o build/lib.linux-x86_64-2.7/_home_jec__sage_temp_fermat_6134_tmp_0_spyx_0.so -L/home/jec/sage-5.3.beta1/local//lib

    /usr/bin/ld: cannot find -ljc
    collect2: ld returned 1 exit status
    error: command 'gcc' failed with exit status 1
```
showing that it's the linker complaining.

I do not know why during a test any compilation like this needs to be done: recall that I had previously done sage -ba.



---

archive/issue_comments_170728.json:
```json
{
    "body": "<a id='comment:75'></a>My bad, there are indeed failing doctests.\nI'll correct that ASAP.",
    "created_at": "2012-08-29T13:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170728",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:75'></a>My bad, there are indeed failing doctests.
I'll correct that ASAP.



---

archive/issue_comments_170729.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-08-29T13:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170729",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_170730.json:
```json
{
    "body": "<a id='comment:77'></a>Replying to [comment:75 jpflori]:\n> My bad, there are indeed failing doctests.\n> I'll correct that ASAP.\n\n\nIf that means that you understand what is causing this, very good!  I was about to put out a query to sage-devel.",
    "created_at": "2012-08-29T13:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170730",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:77'></a>Replying to [comment:75 jpflori]:
> My bad, there are indeed failing doctests.
> I'll correct that ASAP.


If that means that you understand what is causing this, very good!  I was about to put out a query to sage-devel.



---

archive/issue_comments_170731.json:
```json
{
    "body": "<a id='comment:78'></a>I think its only the cython magic command in sage which by default use a bunch of libraries including jc (which now should be ec).\nRecompiling right now to check I'm correct.",
    "created_at": "2012-08-29T13:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170731",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:78'></a>I think its only the cython magic command in sage which by default use a bunch of libraries including jc (which now should be ec).
Recompiling right now to check I'm correct.



---

archive/issue_comments_170732.json:
```json
{
    "body": "<a id='comment:79'></a>About the smattest issue on Cygwin, it seems to get stuck in smat_elim.cc in the step3 function.\nNot sure where exactly yet (nor why!).\nAnd to be clear, I don't think this should be a blocker for the current ticket (unless its solved in a couple of days...), but I'm reporting here because I mentioned the issue here earlier.",
    "created_at": "2012-08-29T13:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170732",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:79'></a>About the smattest issue on Cygwin, it seems to get stuck in smat_elim.cc in the step3 function.
Not sure where exactly yet (nor why!).
And to be clear, I don't think this should be a blocker for the current ticket (unless its solved in a couple of days...), but I'm reporting here because I mentioned the issue here earlier.



---

archive/issue_comments_170733.json:
```json
{
    "body": "<a id='comment:80'></a>Here comes an updated patch for the remaining jc issue.",
    "created_at": "2012-08-29T13:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170733",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:80'></a>Here comes an updated patch for the remaining jc issue.



---

archive/issue_comments_170734.json:
```json
{
    "body": "Patch to Sage library.",
    "created_at": "2012-08-29T13:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170734",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Patch to Sage library.



---

archive/issue_comments_170735.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-08-29T14:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170735",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_170736.json:
```json
{
    "body": "<a id='comment:81'></a>Attachment [trac_13325.patch](tarball://root/attachments/some-uuid/ticket13325/trac_13325.patch) by jpflori created at 2012-08-29 14:00:07",
    "created_at": "2012-08-29T14:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170736",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:81'></a>Attachment [trac_13325.patch](tarball://root/attachments/some-uuid/ticket13325/trac_13325.patch) by jpflori created at 2012-08-29 14:00:07



---

archive/issue_comments_170737.json:
```json
{
    "body": "<a id='comment:82'></a>Well done!  I am retesting now.\n\nI have no ideas about the smat_elim issue, but that function does have a while loop which I know must terminate....without a way to debug things in cygwin it is hard to know how to proceed on that.  Good job it is not a blocker.",
    "created_at": "2012-08-29T14:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170737",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:82'></a>Well done!  I am retesting now.

I have no ideas about the smat_elim issue, but that function does have a while loop which I know must terminate....without a way to debug things in cygwin it is hard to know how to proceed on that.  Good job it is not a blocker.



---

archive/issue_comments_170738.json:
```json
{
    "body": "<a id='comment:83'></a>I think I got the smattest issue.\nThis must be a type length issue (and several warning about overflow in xmod.h during compilation should have made me realize it earlier).\n\nIn smat_elim.cc, if I use the \"works fine\" code in xmm0 rather than the David Harvey's one, the test passes.\n\nI think the problem is with INV_BIGPRIME being defined as long, which is 32 bits here on Cygwin I guess and does not fit (1<<33)+140!) rather than int64_t, whence the warnings during compilation.\nI'm recompiling right now and will retest.\nIf that's indeed the problem, that should not be restricted to Cygwin but anywhere where long is only 32 bits.",
    "created_at": "2012-08-29T14:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170738",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:83'></a>I think I got the smattest issue.
This must be a type length issue (and several warning about overflow in xmod.h during compilation should have made me realize it earlier).

In smat_elim.cc, if I use the "works fine" code in xmm0 rather than the David Harvey's one, the test passes.

I think the problem is with INV_BIGPRIME being defined as long, which is 32 bits here on Cygwin I guess and does not fit (1<<33)+140!) rather than int64_t, whence the warnings during compilation.
I'm recompiling right now and will retest.
If that's indeed the problem, that should not be restricted to Cygwin but anywhere where long is only 32 bits.



---

archive/issue_comments_170739.json:
```json
{
    "body": "<a id='comment:84'></a>Replying to [comment:83 jpflori]:\n> I think I got the smattest issue.\n> This must be a type length issue (and several warning about overflow in xmod.h during compilation should have made me realize it earlier).\n> \n> In smat_elim.cc, if I use the \"works fine\" code in xmm0 rather than the David Harvey's one, the test passes.\n> \n> I think the problem is with INV_BIGPRIME being defined as long, which is 32 bits here on Cygwin I guess and does not fit (1<<33)+140!) rather than int64_t, whence the warnings during compilation.\n> I'm recompiling right now and will retest.\n> If that's indeed the problem, that should not be restricted to Cygwin but anywhere where long is only 32 bits.\n\n\nThat makes a lot of sense.  It was a recent change, and I clearly have not built & tested on my 32-bit laptop recently.  (I will do in future, I promise!).  I take it that the solution is to redefine that variable as int64_t?",
    "created_at": "2012-08-29T14:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170739",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:84'></a>Replying to [comment:83 jpflori]:
> I think I got the smattest issue.
> This must be a type length issue (and several warning about overflow in xmod.h during compilation should have made me realize it earlier).
> 
> In smat_elim.cc, if I use the "works fine" code in xmm0 rather than the David Harvey's one, the test passes.
> 
> I think the problem is with INV_BIGPRIME being defined as long, which is 32 bits here on Cygwin I guess and does not fit (1<<33)+140!) rather than int64_t, whence the warnings during compilation.
> I'm recompiling right now and will retest.
> If that's indeed the problem, that should not be restricted to Cygwin but anywhere where long is only 32 bits.


That makes a lot of sense.  It was a recent change, and I clearly have not built & tested on my 32-bit laptop recently.  (I will do in future, I promise!).  I take it that the solution is to redefine that variable as int64_t?



---

archive/issue_comments_170740.json:
```json
{
    "body": "<a id='comment:85'></a>You should indeed set INV_BIGPRIME to be an int64_t, but also ab in the xmm0 function in smat_elim.cc.\nThis seems to do the trick (only modifying INV_BIGPRIME was not enough).\n\nI'm rebuilding and testing everything now.",
    "created_at": "2012-08-29T14:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170740",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:85'></a>You should indeed set INV_BIGPRIME to be an int64_t, but also ab in the xmm0 function in smat_elim.cc.
This seems to do the trick (only modifying INV_BIGPRIME was not enough).

I'm rebuilding and testing everything now.



---

archive/issue_comments_170741.json:
```json
{
    "body": "<a id='comment:86'></a>Replying to [comment:85 jpflori]:\n> You should indeed set INV_BIGPRIME to be an int64_t, but also ab in the xmm0 function in smat_elim.cc.\n> This seems to do the trick (only modifying INV_BIGPRIME was not enough).\n> \n> I'm rebuilding and testing everything now.\n\n\nDone and all long tests pass.  As far as I am concerned this deserves a positive review (for the new spkg to replace the old one + the patch for two files just to take into account the change of the library name from jc to ec).",
    "created_at": "2012-08-29T14:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170741",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:86'></a>Replying to [comment:85 jpflori]:
> You should indeed set INV_BIGPRIME to be an int64_t, but also ab in the xmm0 function in smat_elim.cc.
> This seems to do the trick (only modifying INV_BIGPRIME was not enough).
> 
> I'm rebuilding and testing everything now.


Done and all long tests pass.  As far as I am concerned this deserves a positive review (for the new spkg to replace the old one + the patch for two files just to take into account the change of the library name from jc to ec).



---

archive/issue_comments_170742.json:
```json
{
    "body": "<a id='comment:87'></a>And I'm only getting numerical noise for tbessel in the tests directory:\n\n```\nEnter x: x = 1.23     K0(x)=....634[2]     K1(x) = ...062\n```\nthe ending \"2\" only appearing in one of the outputs.",
    "created_at": "2012-08-29T14:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170742",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:87'></a>And I'm only getting numerical noise for tbessel in the tests directory:

```
Enter x: x = 1.23     K0(x)=....634[2]     K1(x) = ...062
```
the ending "2" only appearing in one of the outputs.



---

archive/issue_comments_170743.json:
```json
{
    "body": "<a id='comment:88'></a>To be more precise, it appears in the expected output, but not in the one spit out on Cygwin.",
    "created_at": "2012-08-29T14:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170743",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:88'></a>To be more precise, it appears in the expected output, but not in the one spit out on Cygwin.



---

archive/issue_comments_170744.json:
```json
{
    "body": "<a id='comment:89'></a>In the progs directory, nfhpmcurve seems broken.\nIn particular, it returns 3 [0,...,0] instead of 3 [1,-1,1,17,19] and then loops.",
    "created_at": "2012-08-29T15:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170744",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:89'></a>In the progs directory, nfhpmcurve seems broken.
In particular, it returns 3 [0,...,0] instead of 3 [1,-1,1,17,19] and then loops.



---

archive/issue_comments_170745.json:
```json
{
    "body": "<a id='comment:90'></a>It seems the construction of the elliptic curve from c_4, c_6 fails.",
    "created_at": "2012-08-29T15:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170745",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:90'></a>It seems the construction of the elliptic curve from c_4, c_6 fails.



---

archive/issue_comments_170746.json:
```json
{
    "body": "<a id='comment:91'></a>The problem is fact much earlier.\nFirst hint, it tries to compute 4 curves instead of 3, having found 4 newforrms at level 2002.",
    "created_at": "2012-08-29T15:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170746",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:91'></a>The problem is fact much earlier.
First hint, it tries to compute 4 curves instead of 3, having found 4 newforrms at level 2002.



---

archive/issue_comments_170747.json:
```json
{
    "body": "<a id='comment:92'></a>There is a problem with the dimension of subspaces corresponding to eigenvalues.",
    "created_at": "2012-08-29T15:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170747",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:92'></a>There is a problem with the dimension of subspaces corresponding to eigenvalues.



---

archive/issue_comments_170748.json:
```json
{
    "body": "<a id='comment:93'></a>Replying to [comment:92 jpflori]:\n> There is a problem with the dimension of subspaces corresponding to eigenvalues.\n\n\nVery sorry for the hassle you are having here.  I am currently building eclib on my 32-bit laptop (ubuntu 12.04) in case there are any other 32/64-bit issues.  In fact I am already seeing a lot of warnings \"overflow in implicit constant conversion [-Woverflow]\" from the included file xmod.h (in line 114, i.e. where INV_BIGPRIME is defined, as you found) which certainly needs to be fixed.  Wait for me before spending more time (though I only have another half hour today as I'll be going out shortly -- to see Shakespeare's Comedy of Errors, so very appropriate!).\n\nAll the things you report could be explained by some overflow in low-level arithmetic, it will not be as serious as it looks.",
    "created_at": "2012-08-29T15:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170748",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:93'></a>Replying to [comment:92 jpflori]:
> There is a problem with the dimension of subspaces corresponding to eigenvalues.


Very sorry for the hassle you are having here.  I am currently building eclib on my 32-bit laptop (ubuntu 12.04) in case there are any other 32/64-bit issues.  In fact I am already seeing a lot of warnings "overflow in implicit constant conversion [-Woverflow]" from the included file xmod.h (in line 114, i.e. where INV_BIGPRIME is defined, as you found) which certainly needs to be fixed.  Wait for me before spending more time (though I only have another half hour today as I'll be going out shortly -- to see Shakespeare's Comedy of Errors, so very appropriate!).

All the things you report could be explained by some overflow in low-level arithmetic, it will not be as serious as it looks.



---

archive/issue_comments_170749.json:
```json
{
    "body": "<a id='comment:94'></a>I think so.\nThe fix I proposed is not sufficient, setting back once again the old \"this works\" code in xmm0 function from smat_elim solves the problem.",
    "created_at": "2012-08-29T16:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170749",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:94'></a>I think so.
The fix I proposed is not sufficient, setting back once again the old "this works" code in xmm0 function from smat_elim solves the problem.



---

archive/issue_comments_170750.json:
```json
{
    "body": "<a id='comment:95'></a>Setting r to be int64_t rather than long as well make the tests pass!",
    "created_at": "2012-08-29T16:10:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170750",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:95'></a>Setting r to be int64_t rather than long as well make the tests pass!



---

archive/issue_comments_170751.json:
```json
{
    "body": "<a id='comment:96'></a>Apart from that, I get a little bit of what seems to be numerical noise in h1bsd.",
    "created_at": "2012-08-29T16:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170751",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:96'></a>Apart from that, I get a little bit of what seems to be numerical noise in h1bsd.



---

archive/issue_comments_170752.json:
```json
{
    "body": "<a id='comment:97'></a>So I'll leave you fix the int64_t and floating point issues, tag a release and update the spkg here if that's OK with you (it took less than a couple of days :).",
    "created_at": "2012-08-29T16:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170752",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:97'></a>So I'll leave you fix the int64_t and floating point issues, tag a release and update the spkg here if that's OK with you (it took less than a couple of days :).



---

archive/issue_comments_170753.json:
```json
{
    "body": "<a id='comment:98'></a>I agree, I had just written:\n\nFor me, defining INV_BIGPRIME to be int64_t and also in smat_elim.cc's xmm0() putting back the old \"this works\" code resulted in everything passing except numerical noise in tbessel and h1bsd (both of which are new tests added last week).  I am now trying your suggestion to make the variable r in xmm0() also into int64_t.\n\nI'll fix the remaining issues tomorrow.",
    "created_at": "2012-08-29T16:21:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170753",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:98'></a>I agree, I had just written:

For me, defining INV_BIGPRIME to be int64_t and also in smat_elim.cc's xmm0() putting back the old "this works" code resulted in everything passing except numerical noise in tbessel and h1bsd (both of which are new tests added last week).  I am now trying your suggestion to make the variable r in xmm0() also into int64_t.

I'll fix the remaining issues tomorrow.



---

archive/issue_comments_170754.json:
```json
{
    "body": "<a id='comment:99'></a>Don't forget to let \"ab\" be int64_t as well.\n(And with the \"old\" code, it seems INV_BIGPRIME is not used at all, but for making the new code work, this is definitely needed).",
    "created_at": "2012-08-29T16:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170754",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:99'></a>Don't forget to let "ab" be int64_t as well.
(And with the "old" code, it seems INV_BIGPRIME is not used at all, but for making the new code work, this is definitely needed).



---

archive/issue_comments_170755.json:
```json
{
    "body": "<a id='comment:0'></a>I'm having a problem here.  I could not bring my laptop in to work so have instead been working on my 32-bit desktop (a machine I do not usually do development work on, running 32-bit Suse Enterprise).  I built recent pari and NTL on the machine but could not at first compile eclib, on account of that constant INV_BIGPRIME on line 114 of xmod.h.  It (GCC 4.3.4) tells me that it is too big to convert to a long, with no difference if I decalre it as a long or int64_t or long long.  The solution is to append LL to the constant.\n\nSorry for the delay in updating the distribution... I still have to sort out the two numerical fuzz issues.",
    "created_at": "2012-08-30T11:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170755",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:0'></a>I'm having a problem here.  I could not bring my laptop in to work so have instead been working on my 32-bit desktop (a machine I do not usually do development work on, running 32-bit Suse Enterprise).  I built recent pari and NTL on the machine but could not at first compile eclib, on account of that constant INV_BIGPRIME on line 114 of xmod.h.  It (GCC 4.3.4) tells me that it is too big to convert to a long, with no difference if I decalre it as a long or int64_t or long long.  The solution is to append LL to the constant.

Sorry for the delay in updating the distribution... I still have to sort out the two numerical fuzz issues.



---

archive/issue_comments_170756.json:
```json
{
    "body": "<a id='comment:1'></a>Updated sources at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/progs/ should fix the 32-bit issues.",
    "created_at": "2012-08-30T11:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170756",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:1'></a>Updated sources at http://homepages.warwick.ac.uk/staff/J.E.Cremona/ftp/progs/ should fix the 32-bit issues.



---

archive/issue_comments_170757.json:
```json
{
    "body": "<a id='comment:2'></a>Great!\n\nI'll test it in a 32 bits virtual machine this afternoon, and on Cygwin tonight.",
    "created_at": "2012-08-30T11:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170757",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:2'></a>Great!

I'll test it in a 32 bits virtual machine this afternoon, and on Cygwin tonight.



---

archive/issue_comments_170758.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-09-05T09:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170758",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_170759.json:
```json
{
    "body": "<a id='comment:3'></a>I'm finally testing the spkg.\nBy the way, it seems you tagged the wrong commit on your google code repo.",
    "created_at": "2012-09-05T09:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170759",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:3'></a>I'm finally testing the spkg.
By the way, it seems you tagged the wrong commit on your google code repo.



---

archive/issue_comments_170760.json:
```json
{
    "body": "<a id='comment:104'></a>Replying to [comment:103 jpflori]:\n> I'm finally testing the spkg.\n> By the way, it seems you tagged the wrong commit on your google code repo.\n\nThere is something about tagging which I do not understand, including whether to tag before or after doing something.  Anyway, the last version on googlecode is the right one, and is also available as a tarball, so ignore any tags.",
    "created_at": "2012-09-05T09:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170760",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:104'></a>Replying to [comment:103 jpflori]:
> I'm finally testing the spkg.
> By the way, it seems you tagged the wrong commit on your google code repo.

There is something about tagging which I do not understand, including whether to tag before or after doing something.  Anyway, the last version on googlecode is the right one, and is also available as a tarball, so ignore any tags.



---

archive/issue_comments_170761.json:
```json
{
    "body": "<a id='comment:5'></a>Don't worry, your hg history is not included in the dist tarball anyway, so it does not hurt here at all.\n\nIn fact you should tag a release after committing your changes: it will more or less create  a new special commit telling that the previous one (you can also give an explicit commit number IIRC) corresponds to such release.",
    "created_at": "2012-09-05T09:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170761",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:5'></a>Don't worry, your hg history is not included in the dist tarball anyway, so it does not hurt here at all.

In fact you should tag a release after committing your changes: it will more or less create  a new special commit telling that the previous one (you can also give an explicit commit number IIRC) corresponds to such release.



---

archive/issue_comments_170762.json:
```json
{
    "body": "<a id='comment:6'></a>Hopefully last remark on the new build system.\nIt tries to rebuild the test executables after the tests were run (and does nothing because everything is uptodate of course).\nNo time to look at it right now.",
    "created_at": "2012-09-05T10:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170762",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:6'></a>Hopefully last remark on the new build system.
It tries to rebuild the test executables after the tests were run (and does nothing because everything is uptodate of course).
No time to look at it right now.



---

archive/issue_comments_170763.json:
```json
{
    "body": "<a id='comment:7'></a>Ok, I guess that's just because the Automake magic check build of the test programs (which is before in the Makefile) is treated by make after the one you defined which builds the programs (which is fortunate) and then tests them.\nNot sure if anything can be done, but that's not really a problem anyway.",
    "created_at": "2012-09-05T11:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170763",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:7'></a>Ok, I guess that's just because the Automake magic check build of the test programs (which is before in the Makefile) is treated by make after the one you defined which builds the programs (which is fortunate) and then tests them.
Not sure if anything can be done, but that's not really a problem anyway.



---

archive/issue_comments_170764.json:
```json
{
    "body": "<a id='comment:108'></a>Replying to [comment:107 jpflori]:\n> Ok, I guess that's just because the Automake magic check build of the test programs (which is before in the Makefile) is treated by make after the one you defined which builds the programs (which is fortunate) and then tests them.\n> Not sure if anything can be done, but that's not really a problem anyway.\n\nI am glad that is your conclusion, as I thought this was harmless and it's not too obvious how to avoid it.  As you say, the created Makefile does things which have already been done by my manual targets.  Let's leave it.",
    "created_at": "2012-09-05T11:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170764",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:108'></a>Replying to [comment:107 jpflori]:
> Ok, I guess that's just because the Automake magic check build of the test programs (which is before in the Makefile) is treated by make after the one you defined which builds the programs (which is fortunate) and then tests them.
> Not sure if anything can be done, but that's not really a problem anyway.

I am glad that is your conclusion, as I thought this was harmless and it's not too obvious how to avoid it.  As you say, the created Makefile does things which have already been done by my manual targets.  Let's leave it.



---

archive/issue_comments_170765.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,15 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+All of this is fixed in the 2012-08-30 release.\n+Try updated spkg at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120830.spkg\n+\n+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n+\n+Apply [attachment:trac_13325.patch].\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-09-05T15:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170765",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,15 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+All of this is fixed in the 2012-08-30 release.
+Try updated spkg at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120830.spkg
+
+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
+
+Apply [attachment:trac_13325.patch].
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170766.json:
```json
{
    "body": "<a id='comment:9'></a>I can confirm the updated eclib version passes all its tests in a 32 bits Ubuntu 12.04 virtual machine (inside a 64 bits Ubuntu 12.04).\n\nUpdated spkg at\nhttp://perso.telecom-paristech.fr/~flori/sage/eclib-20120830.spkg",
    "created_at": "2012-09-05T15:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170766",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:9'></a>I can confirm the updated eclib version passes all its tests in a 32 bits Ubuntu 12.04 virtual machine (inside a 64 bits Ubuntu 12.04).

Updated spkg at
http://perso.telecom-paristech.fr/~flori/sage/eclib-20120830.spkg



---

archive/issue_comments_170767.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-09-05T15:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170767",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_170768.json:
```json
{
    "body": "Spkg diff, for review only. Committed in spkg.",
    "created_at": "2012-09-05T15:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170768",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Spkg diff, for review only. Committed in spkg.



---

archive/issue_comments_170769.json:
```json
{
    "body": "<a id='comment:0'></a>Attachment [eclib-20120830.patch](tarball://root/attachments/some-uuid/ticket13325/eclib-20120830.patch) by jpflori created at 2012-09-05 15:23:14\n\nNow with updated SPKG.txt",
    "created_at": "2012-09-05T15:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170769",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:0'></a>Attachment [eclib-20120830.patch](tarball://root/attachments/some-uuid/ticket13325/eclib-20120830.patch) by jpflori created at 2012-09-05 15:23:14

Now with updated SPKG.txt



---

archive/issue_comments_170770.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+All of this is fixed in the 2012-08-30 release.\n+Try updated spkg at\n+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120830.spkg\n+or\n+http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg\n+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.\n+\n+Apply [attachment:trac_13325.patch].\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-10-02T20:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170770",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,16 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+All of this is fixed in the 2012-08-30 release.
+Try updated spkg at
+http://perso.telecom-paristech.fr/~flori/sage/eclib-20120830.spkg
+or
+http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg
+Moreover, to make this correctly compile on CYGWIN, presently you will need, for instance, to manually create in `SAGELOCAL/lib/` a symbolic link named `libpari.dll.a` to `libpari-gmp.dll` or use the PARI spkg from #13333.
+
+Apply [attachment:trac_13325.patch].
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170771.json:
```json
{
    "body": "<a id='comment:2'></a>This works on Cygwin on XP!",
    "created_at": "2012-10-05T14:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170771",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>This works on Cygwin on XP!



---

archive/issue_comments_170772.json:
```json
{
    "body": "<a id='comment:3'></a>Please let's get this in.  I can't currently test it on Win 7, but maybe if I quick do a thing on Mac later, that would be ok.  Definitely needed on Cygwin.",
    "created_at": "2012-12-05T20:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170772",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>Please let's get this in.  I can't currently test it on Win 7, but maybe if I quick do a thing on Mac later, that would be ok.  Definitely needed on Cygwin.



---

archive/issue_comments_170773.json:
```json
{
    "body": "<a id='comment:4'></a>What needs to be done before there's a positive review?  More checking on Cygwin (which I cannot help with) or what?  Do we need more people to test jpflori's spkg on other architectures?",
    "created_at": "2012-12-05T20:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170773",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>What needs to be done before there's a positive review?  More checking on Cygwin (which I cannot help with) or what?  Do we need more people to test jpflori's spkg on other architectures?



---

archive/issue_comments_170774.json:
```json
{
    "body": "<a id='comment:5'></a>This works on Mac.  John, could you check on some kind of Linux?  I think that's enough for positive review.  Then the buildbot should do the rest once Jeroen merges this...",
    "created_at": "2012-12-05T21:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170774",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>This works on Mac.  John, could you check on some kind of Linux?  I think that's enough for positive review.  Then the buildbot should do the rest once Jeroen merges this...



---

archive/issue_comments_170775.json:
```json
{
    "body": "<a id='comment:6'></a>It is ok on Windows 7.\nI think the main point is to someone to look at the spkg diff.\nAnyway, most of the work has been done by John upstream (or let's say integrated for the few things I suggested if there are any), so the spkg diff is quite minimal (if there is any, I don't really remember).\nSo this should really be trivial.\n\nI don't think \"testing\" on \"exotic\" (let's say non linux) architecture is still needed.",
    "created_at": "2012-12-05T22:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170775",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:6'></a>It is ok on Windows 7.
I think the main point is to someone to look at the spkg diff.
Anyway, most of the work has been done by John upstream (or let's say integrated for the few things I suggested if there are any), so the spkg diff is quite minimal (if there is any, I don't really remember).
So this should really be trivial.

I don't think "testing" on "exotic" (let's say non linux) architecture is still needed.



---

archive/issue_comments_170776.json:
```json
{
    "body": "<a id='comment:117'></a>Replying to [comment:115 kcrisman]:\n> This works on Mac.  John, could you check on some kind of Linux?  I think that's enough for positive review.  Then the buildbot should do the rest once Jeroen merges this...\n\n\nTesting the spkg on 5.4.1 on linux (64-bit ubuntu), will report back.",
    "created_at": "2012-12-05T22:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170776",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:117'></a>Replying to [comment:115 kcrisman]:
> This works on Mac.  John, could you check on some kind of Linux?  I think that's enough for positive review.  Then the buildbot should do the rest once Jeroen merges this...


Testing the spkg on 5.4.1 on linux (64-bit ubuntu), will report back.



---

archive/issue_comments_170777.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+All of this is fixed in the 2012-08-30 upstream release.\n+Try updated spkg at\n+http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg\n+\n+Apply [attachment:trac_13325.patch].\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-12-06T10:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170777",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,13 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+All of this is fixed in the 2012-08-30 upstream release.
+Try updated spkg at
+http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg
+
+Apply [attachment:trac_13325.patch].
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_comments_170778.json:
```json
{
    "body": "<a id='comment:118'></a>Replying to [comment:117 cremona]:\n> Replying to [comment:115 kcrisman]:\n> > This works on Mac.  John, could you check on some kind of Linux?  I think that's enough for positive review.  Then the buildbot should do the rest once Jeroen merges this...\n\n> \n> Testing the spkg on 5.4.1 on linux (64-bit ubuntu), will report back.\n\nNor testing on Linux, but that won't hurt :)\n\nWhat I think really matters is for someone to look at [attachment:trac_13325.patch] and say \"ok, this makes sense, let's merge this\".\n\nI think that even John could put himself as reviewer here as he worked on the \"upstream\" side of this ticket (and I agree with all the great work he did if he needs some approbation on his side).",
    "created_at": "2012-12-06T10:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170778",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:118'></a>Replying to [comment:117 cremona]:
> Replying to [comment:115 kcrisman]:
> > This works on Mac.  John, could you check on some kind of Linux?  I think that's enough for positive review.  Then the buildbot should do the rest once Jeroen merges this...

> 
> Testing the spkg on 5.4.1 on linux (64-bit ubuntu), will report back.

Nor testing on Linux, but that won't hurt :)

What I think really matters is for someone to look at [attachment:trac_13325.patch] and say "ok, this makes sense, let's merge this".

I think that even John could put himself as reviewer here as he worked on the "upstream" side of this ticket (and I agree with all the great work he did if he needs some approbation on his side).



---

archive/issue_comments_170779.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-12-06T11:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170779",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_170780.json:
```json
{
    "body": "<a id='comment:9'></a>I have looked at trac_13325.patch and I say \"ok, this makes sense, let's merge this\".   I have also applied (built) the new spkg and tested the whole library, with no problems.  This was on 64-bit ubuntu linux.\n\n\nGiven this, ans all the commnets above, I am taking the liberty of marking this as \"positive review\" and hope that buildbots will agree.  I hope they are capable of both building the new spkgs and applying the patch, since doing just one will definitely not work.",
    "created_at": "2012-12-06T11:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170780",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:9'></a>I have looked at trac_13325.patch and I say "ok, this makes sense, let's merge this".   I have also applied (built) the new spkg and tested the whole library, with no problems.  This was on 64-bit ubuntu linux.


Given this, ans all the commnets above, I am taking the liberty of marking this as "positive review" and hope that buildbots will agree.  I hope they are capable of both building the new spkgs and applying the patch, since doing just one will definitely not work.



---

archive/issue_comments_170781.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+There are two problems with the current spkg on Cygwin:\n+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac\n+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.\n+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.\n \n+All of this is fixed in the 2012-08-30 upstream release.\n+\n+**Apply**:\n+1. [attachment:trac_13325.patch]\n+2. the **spkg** [http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg](http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg)\n \n Upstream: Not yet reported upstream; Will do shortly.\n \n```\n",
    "created_at": "2012-12-16T18:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170781",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,13 @@
+There are two problems with the current spkg on Cygwin:
+* -lgmp should come after -lntl and -lpari, I fixed this in configure.ac
+* the executables names in tests/Makefile.am should finish with $(EXEEXT), fixed there as well.
+* the -no-undefined flag should also be passed to libtool so that a shared library gets built on Cygwin and for sage.libs.mwrank to be functional.
 
+All of this is fixed in the 2012-08-30 upstream release.
+
+**Apply**:
+1. [attachment:trac_13325.patch]
+2. the **spkg** [http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg](http://www.infres.enst.fr/~flori/sage/eclib-20120830.spkg)
 
 Upstream: Not yet reported upstream; Will do shortly.
 
```




---

archive/issue_events_036902.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-20T17:21:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13325#event-36902"
}
```



---

archive/issue_comments_170782.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-12-20T17:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13325",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13325#issuecomment-170782",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
