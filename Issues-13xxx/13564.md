# Issue 13564: Improve diagonal from matrix/matrix2.pyx

archive/issues_013360.json:
```json
{
    "body": "The method diagonal could have a parameter so that it can return any diagonal parallel to the main diagonal.\n\n---\nApply only [attachment:trac_13564-diagonal.patch] to `devel/sage`.\n\nAssignee: jason, was\n\nKeywords: matrix, diagonal\n\nAuthor: Raniere Silva\n\nStatus: needs_info\n\nIssue created by migration from https://trac.sagemath.org/ticket/13564\n\n",
    "created_at": "2012-10-03T23:47:14Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Improve diagonal from matrix/matrix2.pyx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13564",
    "user": "https://trac.sagemath.org/admin/accounts/users/r.gaia.cs"
}
```
The method diagonal could have a parameter so that it can return any diagonal parallel to the main diagonal.

---
Apply only [attachment:trac_13564-diagonal.patch] to `devel/sage`.

Assignee: jason, was

Keywords: matrix, diagonal

Author: Raniere Silva

Status: needs_info

Issue created by migration from https://trac.sagemath.org/ticket/13564





---

archive/issue_comments_209453.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [diagonal.patch](tarball://root/attachments/some-uuid/ticket13564/diagonal.patch) by @mwhansen created at 2012-10-06 03:55:29",
    "created_at": "2012-10-06T03:55:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209453",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:1'></a>
Attachment [diagonal.patch](tarball://root/attachments/some-uuid/ticket13564/diagonal.patch) by @mwhansen created at 2012-10-06 03:55:29



---

archive/issue_comments_209454.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-10-06T03:55:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209454",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_209455.json:
```json
{
    "body": "<a id='comment:2'></a>\nHello, this comment is with respect to the statement \"- Unknown: No author specified in the file from 2012-10-03\" in your patch. The authors are mentioned in the beginning of the file.\n\nAs such, I think typically no authors are added at the top unless some major change is effected. The author names and history is preserved in mercurial anyway. You can run `sage -hg blame filename` to see which revision modified which line of the file `filename`. The revision number can then be used to pinpoint the author.",
    "created_at": "2012-10-08T09:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209455",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:2'></a>
Hello, this comment is with respect to the statement "- Unknown: No author specified in the file from 2012-10-03" in your patch. The authors are mentioned in the beginning of the file.

As such, I think typically no authors are added at the top unless some major change is effected. The author names and history is preserved in mercurial anyway. You can run `sage -hg blame filename` to see which revision modified which line of the file `filename`. The revision number can then be used to pinpoint the author.



---

archive/issue_comments_209456.json:
```json
{
    "body": "Make correction sugested by ppurka.",
    "created_at": "2012-10-08T14:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209456",
    "user": "https://trac.sagemath.org/admin/accounts/users/r.gaia.cs"
}
```

Make correction sugested by ppurka.



---

archive/issue_comments_209457.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n The method diagonal could have a parameter so that it can return any diagonal parallel to the main diagonal.\n+\n+---\n+Apply only [attachment:trac_13564-diagonal.patch] to `devel/sage`.\n``````\n",
    "created_at": "2012-10-10T13:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209457",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,4 @@
 The method diagonal could have a parameter so that it can return any diagonal parallel to the main diagonal.
+
+---
+Apply only [attachment:trac_13564-diagonal.patch] to `devel/sage`.
``````




---

archive/issue_comments_209458.json:
```json
{
    "body": "<a id='comment:3'></a>\nAttachment [trac_13564-diagonal.patch](tarball://root/attachments/some-uuid/ticket13564/trac_13564-diagonal.patch) by @ppurka created at 2012-10-10 13:21:04",
    "created_at": "2012-10-10T13:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209458",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:3'></a>
Attachment [trac_13564-diagonal.patch](tarball://root/attachments/some-uuid/ticket13564/trac_13564-diagonal.patch) by @ppurka created at 2012-10-10 13:21:04



---

archive/issue_comments_209459.json:
```json
{
    "body": "<a id='comment:4'></a>\nHave to force the patchbot :(\nPatchbot apply trac_13564-diagonal.patch",
    "created_at": "2012-10-12T08:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209459",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:4'></a>
Have to force the patchbot :(
Patchbot apply trac_13564-diagonal.patch



---

archive/issue_comments_209460.json:
```json
{
    "body": "<a id='comment:5'></a>\nSome comments:\n1. Should we be raising an error or simply returning an empty list if the `d` for the `d`-th diagonal is provided outside the range of the number of rows or columns? For instance, the empty matrix is returning an empty diagonal. Also, [Mathematica](http://www.wolframalpha.com/input/?i=Diagonal%5B%7B%7B1%2C+2%2C+3%2C+4%7D%2C+%7B5%2C+6%2C+7%2C+8%7D%2C+%7B9%2C+10%2C+11%2C+12%7D%7D%2C+4%5D) and Matlab silently return empty matrices. Octave raises an error. Numpy gives an empty matrix until `nrows()` or `ncols()` and then raises an error.\n2. If it seems more proper to raise an error, the error string could be written like the statements below. Note that `d` is always *less than* and never equal to `nrows()` or `ncols()`.\n\n```\nThe value `d` should be less than the number of columns in the matrix.\nThe value `-d` should be less than the number of rows of the matrix.\n```\n\nEDIT: The numpy error seems to stem from its refusal to create arrays which have one dimension negative. So, 0x1 array is ok, but not -1x1. The error is probably not from the diagonal code itself.",
    "created_at": "2012-10-12T15:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209460",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:5'></a>
Some comments:
1. Should we be raising an error or simply returning an empty list if the `d` for the `d`-th diagonal is provided outside the range of the number of rows or columns? For instance, the empty matrix is returning an empty diagonal. Also, [Mathematica](http://www.wolframalpha.com/input/?i=Diagonal%5B%7B%7B1%2C+2%2C+3%2C+4%7D%2C+%7B5%2C+6%2C+7%2C+8%7D%2C+%7B9%2C+10%2C+11%2C+12%7D%7D%2C+4%5D) and Matlab silently return empty matrices. Octave raises an error. Numpy gives an empty matrix until `nrows()` or `ncols()` and then raises an error.
2. If it seems more proper to raise an error, the error string could be written like the statements below. Note that `d` is always *less than* and never equal to `nrows()` or `ncols()`.

```
The value `d` should be less than the number of columns in the matrix.
The value `-d` should be less than the number of rows of the matrix.
```

EDIT: The numpy error seems to stem from its refusal to create arrays which have one dimension negative. So, 0x1 array is ok, but not -1x1. The error is probably not from the diagonal code itself.



---

archive/issue_comments_209461.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-02-10T22:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209461",
    "user": "https://github.com/KPanComputes"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_209462.json:
```json
{
    "body": "<a id='comment:6'></a>\nI am changing this to \"needs_info\" for now as it seems to me that, there is still some design decisions to make. I am adding cc: sage-devel so that this could be discussed.",
    "created_at": "2013-02-10T22:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209462",
    "user": "https://github.com/KPanComputes"
}
```

<a id='comment:6'></a>
I am changing this to "needs_info" for now as it seems to me that, there is still some design decisions to make. I am adding cc: sage-devel so that this could be discussed.



---

archive/issue_comments_209463.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [knsam](#comment%3A6):\n> I am changing this to \"needs_info\" for now as it seems to me that, there is still some design decisions to make. I am adding cc: sage-devel so that this could be discussed.\n\nThere is no user called \"sage-devel\". If you want to \"cc sage-devel\" then you need to put a post to the sage-devel mailing list. I was waiting for a reply from the author for clarification on the current implementation - thanks for setting this to needs_info. However, the author seems [inactive](http://trac.sagemath.org/sage_trac/search?noquickjump=1&ticket=on&wiki=on&q=r.gaia.cs) since last November.",
    "created_at": "2013-02-11T07:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209463",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:7'></a>
Replying to [knsam](#comment%3A6):
> I am changing this to "needs_info" for now as it seems to me that, there is still some design decisions to make. I am adding cc: sage-devel so that this could be discussed.

There is no user called "sage-devel". If you want to "cc sage-devel" then you need to put a post to the sage-devel mailing list. I was waiting for a reply from the author for clarification on the current implementation - thanks for setting this to needs_info. However, the author seems [inactive](http://trac.sagemath.org/sage_trac/search?noquickjump=1&ticket=on&wiki=on&q=r.gaia.cs) since last November.



---

archive/issue_comments_209464.json:
```json
{
    "body": "Changing author from \"r.gaia.cs\" to \"Raniere Silva\"",
    "created_at": "2013-02-11T07:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13564#issuecomment-209464",
    "user": "https://github.com/ppurka"
}
```

Changing author from "r.gaia.cs" to "Raniere Silva"



---

archive/issue_events_043851.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43851"
}
```



---

archive/issue_events_043852.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43852"
}
```



---

archive/issue_events_043853.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43853"
}
```



---

archive/issue_events_043854.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43854"
}
```



---

archive/issue_events_043855.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43855"
}
```



---

archive/issue_events_043856.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43856"
}
```



---

archive/issue_events_043857.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13564",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13564#event-43857"
}
```
