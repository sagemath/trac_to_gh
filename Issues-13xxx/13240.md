# Issue 13240: Give posets polynomials (order, characteristic, zeta, etc.)

archive/issues_013068.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "Adding some of the polynomials from Stembridge's Posets package for Maple (see http://www.math.lsa.umich.edu/~jrs/software/posetshelp.html), namely:\n\n* characteristic polynomial (done)\n* zeta polynomial (done)\n* flag f-polynomial (done)\n* flag h-polynomial (done)\n* f-polynomial (done)\n* h-polynomial (done)\n* order polynomial (done)\n* chain polynomial (done)\n* W-polynomial \n* antichain polynomial\n\napply:\n* [attachment: trac_13240-qfold.patch\u200b](https://github.com/sagemath/sage/files/ticket13240/9531d2a861288e7baa584a1d138ffa43.gz)\n* [attachment: trac_13240-review2-dg.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review2-dg.patch.gz)\n\nCC:  @kevindilks\n\nKeywords: **sd40, days45**\n\nReviewer: **Darij Grinberg, Nathann Cohen**\n\nAuthor: **Alex Csar, Kevin Dilks, Fr\u00e9d\u00e9ric Chapoton**\n\nMerged: **sage-5.13.beta2**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13240_\n\n",
    "closed_at": "2013-10-31T19:16:05Z",
    "created_at": "2012-07-12T17:02:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.13",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Give posets polynomials (order, characteristic, zeta, etc.)",
    "type": "issue",
    "updated_at": "2013-10-31T19:16:05Z",
    "url": "https://github.com/sagemath/sage/issues/13240",
    "user": "https://github.com/sagetrac-csar"
}
```
Adding some of the polynomials from Stembridge's Posets package for Maple (see http://www.math.lsa.umich.edu/~jrs/software/posetshelp.html), namely:

* characteristic polynomial (done)
* zeta polynomial (done)
* flag f-polynomial (done)
* flag h-polynomial (done)
* f-polynomial (done)
* h-polynomial (done)
* order polynomial (done)
* chain polynomial (done)
* W-polynomial 
* antichain polynomial

apply:
* [attachment: trac_13240-qfold.patch​](https://github.com/sagemath/sage/files/ticket13240/9531d2a861288e7baa584a1d138ffa43.gz)
* [attachment: trac_13240-review2-dg.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review2-dg.patch.gz)

CC:  @kevindilks

Keywords: **sd40, days45**

Reviewer: **Darij Grinberg, Nathann Cohen**

Author: **Alex Csar, Kevin Dilks, Frédéric Chapoton**

Merged: **sage-5.13.beta2**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/13240_





---

archive/issue_events_182582.json:
```json
{
    "actor": "https://github.com/sagetrac-csar",
    "created_at": "2012-07-12T17:02:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182582"
}
```



---

archive/issue_events_182583.json:
```json
{
    "actor": "https://github.com/sagetrac-csar",
    "created_at": "2012-07-12T17:02:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182583"
}
```



---

archive/issue_events_182584.json:
```json
{
    "actor": "https://github.com/sagetrac-csar",
    "created_at": "2012-07-12T17:02:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182584"
}
```



---

archive/issue_events_182585.json:
```json
{
    "actor": "https://github.com/sagetrac-csar",
    "created_at": "2012-07-12T17:02:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182585"
}
```



---

archive/issue_events_182586.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2012-07-12T17:02:42Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "subject": "https://github.com/sagetrac-csar",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182586"
}
```



---

archive/issue_events_182587.json:
```json
{
    "actor": "https://github.com/sagetrac-csar",
    "created_at": "2012-07-12T17:03:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "title_is": "Give posets polynomials (order, characteristic, zeta, etc.)",
    "title_was": "Give posets polynomails (order, characteristic, zeta, etc.)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182587"
}
```



---

archive/issue_comments_152558.json:
```json
{
    "body": "Changed keywords from **sd40** to **sd40, days45**",
    "created_at": "2013-02-14T16:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152558",
    "user": "https://github.com/sagetrac-csar"
}
```

Changed keywords from **sd40** to **sd40, days45**



---

archive/issue_comments_152559.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nA first patch, with three of the simplest polynomials",
    "created_at": "2013-05-05T19:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152559",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

A first patch, with three of the simplest polynomials



---

archive/issue_comments_152560.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI have added the flag f-vector",
    "created_at": "2013-05-14T19:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152560",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

I have added the flag f-vector



---

archive/issue_comments_152561.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI have added the flag h-polynomial",
    "created_at": "2013-05-15T18:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152561",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

I have added the flag h-polynomial



---

archive/issue_comments_152562.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI have added the characteristic polynomial",
    "created_at": "2013-05-24T16:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152562",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

I have added the characteristic polynomial



---

archive/issue_comments_152563.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,10 @@\n Adding some of the polynomials from Stembridge's Posets package for Maple (see http://www.math.lsa.umich.edu/~jrs/software/posetshelp.html), namely:\n \n-* characteristic polynomial\n-* W-polynomial\n-* zeta polynomial\n-* flag f-polynomial\n-* flag h-polynomial\n-* f-polynomial\n-* h-polynomial\n+* characteristic polynomial (done)\n+* W-polynomial \n+* zeta polynomial (done)\n+* flag f-polynomial (done)\n+* flag h-polynomial (done)\n+* f-polynomial (done)\n+* h-polynomial (done)\n * order polynomial\n``````\n",
    "created_at": "2013-05-24T16:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152563",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,10 @@
 Adding some of the polynomials from Stembridge's Posets package for Maple (see http://www.math.lsa.umich.edu/~jrs/software/posetshelp.html), namely:
 
-* characteristic polynomial
-* W-polynomial
-* zeta polynomial
-* flag f-polynomial
-* flag h-polynomial
-* f-polynomial
-* h-polynomial
+* characteristic polynomial (done)
+* W-polynomial 
+* zeta polynomial (done)
+* flag f-polynomial (done)
+* flag h-polynomial (done)
+* f-polynomial (done)
+* h-polynomial (done)
 * order polynomial
``````




---

archive/issue_comments_152564.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI think we have code from Sage Days 45 for the order polynomial (which is one line once you have zeta), the antichain polynomial and the chain polynomial.",
    "created_at": "2013-05-24T17:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152564",
    "user": "https://github.com/sagetrac-csar"
}
```

<div id="comment:8" align="right">comment:8</div>

I think we have code from Sage Days 45 for the order polynomial (which is one line once you have zeta), the antichain polynomial and the chain polynomial.



---

archive/issue_comments_152565.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\ngreat ! could you post it here as a patch on top of mine ?",
    "created_at": "2013-05-24T19:02:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152565",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

great ! could you post it here as a patch on top of mine ?



---

archive/issue_comments_152566.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nWill do. I'm compiling sage at the moment, but I should be able to do it sometime this evening (GMT -6).\n\nNote several hours later: compiling took way longer than expected. Will add to the patch tomorrow.",
    "created_at": "2013-05-24T20:03:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152566",
    "user": "https://github.com/sagetrac-csar"
}
```

<div id="comment:10" align="right">comment:10</div>

Will do. I'm compiling sage at the moment, but I should be able to do it sometime this evening (GMT -6).

Note several hours later: compiling took way longer than expected. Will add to the patch tomorrow.



---

archive/issue_comments_152567.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThe patch didn't apply. I'm pretty sure it's a problem on my end and my installation is still messed up. I'll add things when I get it fixed.",
    "created_at": "2013-05-26T03:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152567",
    "user": "https://github.com/sagetrac-csar"
}
```

<div id="comment:11" align="right">comment:11</div>

The patch didn't apply. I'm pretty sure it's a problem on my end and my installation is still messed up. I'll add things when I get it fixed.



---

archive/issue_comments_152568.json:
```json
{
    "body": "Attachment: **[trac_12340_poset_polynomials-csar.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)**\n\nadd chain polynomial and order polynomial",
    "created_at": "2013-05-27T21:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152568",
    "user": "https://github.com/sagetrac-csar"
}
```

Attachment: **[trac_12340_poset_polynomials-csar.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)**

add chain polynomial and order polynomial



---

archive/issue_comments_152569.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOkay, I've added the chain polynomial and the order polynomial. We had something written for the antichain polynomial, but I didn't include it as I wanted to check with Kevin if he knew a better way of doing it like he worked out for the chain polynomial.\n\nThe chain polynomial is written so you can ask for it in terms of something other than q. So, for example, `P.chain_polynomial(1)` would give you the chain polynomial evaluated at one. Obviously, things should be consistent as to whether you get to choose the variable, but it's a minor change to go either direction.\n\nI made a second patch on top of yours because I wasn't sure if I should be making a separate one or just adding to the patch, and combining them shouldn't be hard.",
    "created_at": "2013-05-27T21:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152569",
    "user": "https://github.com/sagetrac-csar"
}
```

<div id="comment:12" align="right">comment:12</div>

Okay, I've added the chain polynomial and the order polynomial. We had something written for the antichain polynomial, but I didn't include it as I wanted to check with Kevin if he knew a better way of doing it like he worked out for the chain polynomial.

The chain polynomial is written so you can ask for it in terms of something other than q. So, for example, `P.chain_polynomial(1)` would give you the chain polynomial evaluated at one. Obviously, things should be consistent as to whether you get to choose the variable, but it's a minor change to go either direction.

I made a second patch on top of yours because I wasn't sure if I should be making a separate one or just adding to the patch, and combining them shouldn't be hard.



---

archive/issue_comments_152570.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYes, it is better to upload a patch that applies on top of mine.\n\nI will have a closer look at your code soon.",
    "created_at": "2013-05-28T08:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152570",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

Yes, it is better to upload a patch that applies on top of mine.

I will have a closer look at your code soon.



---

archive/issue_comments_152571.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,16 @@\n Adding some of the polynomials from Stembridge's Posets package for Maple (see http://www.math.lsa.umich.edu/~jrs/software/posetshelp.html), namely:\n \n * characteristic polynomial (done)\n-* W-polynomial \n * zeta polynomial (done)\n * flag f-polynomial (done)\n * flag h-polynomial (done)\n * f-polynomial (done)\n * h-polynomial (done)\n-* order polynomial\n+* order polynomial (done)\n+* chain polynomial (done)\n+* W-polynomial \n+* antichain polynomial\n+\n+apply:\n+* [attachment: trac_1324O_first_step-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)\n+* [attachment: trac_12340_poset_polynomials-csar.patch](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)\n``````\n",
    "created_at": "2013-05-28T08:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152571",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,16 @@
 Adding some of the polynomials from Stembridge's Posets package for Maple (see http://www.math.lsa.umich.edu/~jrs/software/posetshelp.html), namely:
 
 * characteristic polynomial (done)
-* W-polynomial 
 * zeta polynomial (done)
 * flag f-polynomial (done)
 * flag h-polynomial (done)
 * f-polynomial (done)
 * h-polynomial (done)
-* order polynomial
+* order polynomial (done)
+* chain polynomial (done)
+* W-polynomial 
+* antichain polynomial
+
+apply:
+* [attachment: trac_1324O_first_step-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)
+* [attachment: trac_12340_poset_polynomials-csar.patch](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)
``````




---

archive/issue_comments_152572.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nok, here is a short review patch of your code.\n\nI have removed trailing whitespaces that you had introduced, and made small changes to the code. I have also made sure that each method starts with a brief (one-line) description of what it does. Details are then given on other lines.\n\nI would prefer not to propose the use of another variable in the code, but rather give no option. The user will get a polynomial, that he can then evaluate on whatever he wants. I think this keeps the code cleaner and shorter.\n\nCombining patches is indeed easy, and can be done just once when everything is ready.",
    "created_at": "2013-05-28T18:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152572",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:14" align="right">comment:14</div>

ok, here is a short review patch of your code.

I have removed trailing whitespaces that you had introduced, and made small changes to the code. I have also made sure that each method starts with a brief (one-line) description of what it does. Details are then given on other lines.

I would prefer not to propose the use of another variable in the code, but rather give no option. The user will get a polynomial, that he can then evaluate on whatever he wants. I think this keeps the code cleaner and shorter.

Combining patches is indeed easy, and can be done just once when everything is ready.



---

archive/issue_comments_152573.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n apply:\n * [attachment: trac_1324O_first_step-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)\n * [attachment: trac_12340_poset_polynomials-csar.patch](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)\n+* [attachment: trac_13240-review1-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review1-fc.patch.gz)\n``````\n",
    "created_at": "2013-05-28T18:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152573",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 apply:
 * [attachment: trac_1324O_first_step-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)
 * [attachment: trac_12340_poset_polynomials-csar.patch](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)
+* [attachment: trac_13240-review1-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review1-fc.patch.gz)
``````




---

archive/issue_comments_152574.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nmaybe we could stop here adding other polynomials, and try to let this set of polynomials enter sage ?",
    "created_at": "2013-06-22T20:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152574",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

maybe we could stop here adding other polynomials, and try to let this set of polynomials enter sage ?



---

archive/issue_comments_152575.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\napply trac_1324O_first_step-fc.patch, trac_12340_poset_polynomials-csar.patch, trac_13240-review1-fc.patch",
    "created_at": "2013-06-30T07:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152575",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

apply trac_1324O_first_step-fc.patch, trac_12340_poset_polynomials-csar.patch, trac_13240-review1-fc.patch



---

archive/issue_events_182588.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-06-30T16:25:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182588"
}
```



---

archive/issue_events_182589.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-07-04T09:34:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182589"
}
```



---

archive/issue_events_182590.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2013-07-04T09:34:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182590"
}
```



---

archive/issue_comments_152576.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nHello !\n\nWould it be possible to add definitions of what these polynomials are, possibly as links toward wikipedia pages ?\n\nI also think that you should cache minimal and maximal elements in the code of `remove_top_and_bottom`, otherwise you compute the maximal and minimal elements for each vertex :\n\n```\nsage: def a():                                 \n....:     print \"Hey\"\n....:     return [1]\n....: \nsage: [x for x in range(5) if x in a()]\nHey\nHey\nHey\nHey\nHey\n[1]\n```\n\nHence if you want to write this function, this really should not be computed so many times.\n\nBesides : you only implement this method for bounded posets, which means that there is one max and one min elements. Hence this complicated line only checks that each vertex is different from two given vertices.\n\nI personally do not think that this `remove_top_and_bottom` method is useful, especially when it build a copy of the whole poset, which can be very costly. You would probably save yourself a lot of time if you worked on `self` in each of your methods, and just ignored the top and bottom elements. No copies of the poset, no call to `remove_to_and_bottom` either.\n\nOh, and Florent thinks that it would be nice to add \"seealso\" sections toward \"is_bounded\", or toward polynomials that are related with each other.\n\nSee youuuuuuuuuuuuuuuuUU !!\n\nNathann",
    "created_at": "2013-07-04T09:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152576",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:19" align="right">comment:19</div>

Hello !

Would it be possible to add definitions of what these polynomials are, possibly as links toward wikipedia pages ?

I also think that you should cache minimal and maximal elements in the code of `remove_top_and_bottom`, otherwise you compute the maximal and minimal elements for each vertex :

```
sage: def a():                                 
....:     print "Hey"
....:     return [1]
....: 
sage: [x for x in range(5) if x in a()]
Hey
Hey
Hey
Hey
Hey
[1]
```

Hence if you want to write this function, this really should not be computed so many times.

Besides : you only implement this method for bounded posets, which means that there is one max and one min elements. Hence this complicated line only checks that each vertex is different from two given vertices.

I personally do not think that this `remove_top_and_bottom` method is useful, especially when it build a copy of the whole poset, which can be very costly. You would probably save yourself a lot of time if you worked on `self` in each of your methods, and just ignored the top and bottom elements. No copies of the poset, no call to `remove_to_and_bottom` either.

Oh, and Florent thinks that it would be nice to add "seealso" sections toward "is_bounded", or toward polynomials that are related with each other.

See youuuuuuuuuuuuuuuuUU !!

Nathann



---

archive/issue_comments_152577.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI'm not actually sure there are definitions on Wikipedia for any/some/most of these (I took a quick look and didn't find any). But one could include references to EC1.",
    "created_at": "2013-07-04T13:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152577",
    "user": "https://github.com/sagetrac-csar"
}
```

<div id="comment:20" align="right">comment:20</div>

I'm not actually sure there are definitions on Wikipedia for any/some/most of these (I took a quick look and didn't find any). But one could include references to EC1.



---

archive/issue_comments_152578.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHere is a new patch\n\nI have tried to adress some of the points raised by Nathan:\n\n* I have got rid of remove_top_and_bottom, but introduced chains_with_bounds\n\nThere remains to explain the definition of every polynomial, and give the references to EC1",
    "created_at": "2013-07-05T19:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152578",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

Here is a new patch

I have tried to adress some of the points raised by Nathan:

* I have got rid of remove_top_and_bottom, but introduced chains_with_bounds

There remains to explain the definition of every polynomial, and give the references to EC1



---

archive/issue_events_182591.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182591"
}
```



---

archive/issue_events_182592.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182592"
}
```



---

archive/issue_comments_152579.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nAttachment: **[trac_1324O_first_step-fc.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)**\n\napply trac_1324O_first_step-fc.patch,trac_12340_poset_polynomials-csar.patch,trac_13240-review1-fc.patch",
    "created_at": "2013-09-13T18:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152579",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">comment:23</div>

Attachment: **[trac_1324O_first_step-fc.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)**

apply trac_1324O_first_step-fc.patch,trac_12340_poset_polynomials-csar.patch,trac_13240-review1-fc.patch



---

archive/issue_comments_152580.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI have added a few more reference to Enum. Comb. 1",
    "created_at": "2013-09-13T18:37:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152580",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:24" align="right">comment:24</div>

I have added a few more reference to Enum. Comb. 1



---

archive/issue_comments_152581.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nMaybe this ticket can be considered good enough ?\n\nOne patchbot has turned green, so there is an opportunity right now.",
    "created_at": "2013-09-22T14:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152581",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

Maybe this ticket can be considered good enough ?

One patchbot has turned green, so there is an opportunity right now.



---

archive/issue_events_182593.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-09-22T14:01:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182593"
}
```



---

archive/issue_events_182594.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-09-22T14:01:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182594"
}
```



---

archive/issue_comments_152582.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nHelooooooo !\n\nThere still isn't any definition of what `f_polynomial` and `h_polynomial` return. Also, I personally do not think that a function named \"chains with bounds\" should exist (and so I will let somebody else give a positive review to this ticket), but in any case if you want to implement such a thing I'd think better to do it the following way :\n\n* create a copy of the poset without the top/bottom element\n* list its chains\n* return each of them after adding the top and bottom element at each end of the chain.\n\nNathann",
    "created_at": "2013-09-22T16:31:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152582",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:27" align="right">comment:27</div>

Helooooooo !

There still isn't any definition of what `f_polynomial` and `h_polynomial` return. Also, I personally do not think that a function named "chains with bounds" should exist (and so I will let somebody else give a positive review to this ticket), but in any case if you want to implement such a thing I'd think better to do it the following way :

* create a copy of the poset without the top/bottom element
* list its chains
* return each of them after adding the top and bottom element at each end of the chain.

Nathann



---

archive/issue_comments_152583.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nHello Nathann,\n\nwell, `chains_with_bounds` has been written to try to cope with your previous comments, that suggested to avoid copying the poset. And now you suggest to copy the poset..\n\nWould it be better to make `chains_with_bounds` a hidden method ?",
    "created_at": "2013-09-22T16:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152583",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:28" align="right">comment:28</div>

Hello Nathann,

well, `chains_with_bounds` has been written to try to cope with your previous comments, that suggested to avoid copying the poset. And now you suggest to copy the poset..

Would it be better to make `chains_with_bounds` a hidden method ?



---

archive/issue_comments_152584.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n> well, `chains_with_bounds` has been written to try to cope with your previous comments, that suggested to avoid copying the poset. And now you suggest to copy the poset..\n\nWell, yes. The best way out is to not copy the poset, to not call the `.chains()` method, and to rewrite what `chains()` does directly on this poset, ignoring the top/bottom elements on the fly. There's no need to copy.\n\nThough if you want to call this `chains()` method you will enumerate 4 times too many things chains, and you need *each time* to check if the two vertices belong to the list (by the way, you already know WHERE in the list they will appear if they do, so you can save time there too).\n\n> Would it be better to make `chains_with_bounds` a hidden method \n\nWhat about making it an option of \"chains\" ?\n\nNathann",
    "created_at": "2013-09-22T17:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152584",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:29" align="right">comment:29</div>

> well, `chains_with_bounds` has been written to try to cope with your previous comments, that suggested to avoid copying the poset. And now you suggest to copy the poset..

Well, yes. The best way out is to not copy the poset, to not call the `.chains()` method, and to rewrite what `chains()` does directly on this poset, ignoring the top/bottom elements on the fly. There's no need to copy.

Though if you want to call this `chains()` method you will enumerate 4 times too many things chains, and you need *each time* to check if the two vertices belong to the list (by the way, you already know WHERE in the list they will appear if they do, so you can save time there too).

> Would it be better to make `chains_with_bounds` a hidden method 

What about making it an option of "chains" ?

Nathann



---

archive/issue_comments_152585.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nAttachment: **[trac_13240-review1-fc.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review1-fc.patch.gz)**\n\nHello Nathann,\n\nthanks for spending time on this ticket.\n\nI have removed `chains_with_bounds`, instead adding a parameter `exclude` to the method `chains`.\n\nI have also added more documentation.",
    "created_at": "2013-09-23T19:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152585",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:30" align="right">comment:30</div>

Attachment: **[trac_13240-review1-fc.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review1-fc.patch.gz)**

Hello Nathann,

thanks for spending time on this ticket.

I have removed `chains_with_bounds`, instead adding a parameter `exclude` to the method `chains`.

I have also added more documentation.



---

archive/issue_comments_152586.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nWow ! It sure looks cleaner this way `:-)`\n\nI don't see anything wrong in this patch right now... Though I'm a bit embarassed because I don't understand the maths  at all, and it would be nice if somebody could just check that the polynomials are indeed what they should be `^^;`\n\nNathann",
    "created_at": "2013-09-25T09:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152586",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:31" align="right">comment:31</div>

Wow ! It sure looks cleaner this way `:-)`

I don't see anything wrong in this patch right now... Though I'm a bit embarassed because I don't understand the maths  at all, and it would be nice if somebody could just check that the polynomials are indeed what they should be `^^;`

Nathann



---

archive/issue_comments_152587.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThe csar patch applied with fuzz for me (5.13beta0):\n\n```\napplying trac_12340_poset_polynomials-csar.patch\npatching file sage/combinat/posets/posets.py\nHunk #1 succeeded at 28 with fuzz 1 (offset 0 lines).\nHunk #2 succeeded at 84 with fuzz 2 (offset 5 lines).\n```\n\nThe file I'm uploading in a few seconds is just a qfold so that I get a better view of the changes myself.",
    "created_at": "2013-10-20T20:09:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152587",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:32" align="right">comment:32</div>

The csar patch applied with fuzz for me (5.13beta0):

```
applying trac_12340_poset_polynomials-csar.patch
patching file sage/combinat/posets/posets.py
Hunk #1 succeeded at 28 with fuzz 1 (offset 0 lines).
Hunk #2 succeeded at 84 with fuzz 2 (offset 5 lines).
```

The file I'm uploading in a few seconds is just a qfold so that I get a better view of the changes myself.



---

archive/issue_comments_152588.json:
```json
{
    "body": "qfold",
    "created_at": "2013-10-20T20:09:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152588",
    "user": "https://github.com/darijgr"
}
```

qfold



---

archive/issue_comments_152589.json:
```json
{
    "body": "Attachment: **[trac_13240-qfold.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-qfold.patch.gz)**\n\nUPDATED! everything reviewed, except for the two flag_* functions which I don't really understand nor can find a reference for.",
    "created_at": "2013-10-21T02:48:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152589",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_13240-qfold.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-qfold.patch.gz)**

UPDATED! everything reviewed, except for the two flag_* functions which I don't really understand nor can find a reference for.



---

archive/issue_comments_152590.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nAttachment: **[trac_13240-almost-review-dg.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-almost-review-dg.patch.gz)**\n\nThanks, Nathan, for alerting me to this patch!\n\nThe file I just attached gives a review of everything but the two flag polynomials (f and h) which I couldn't find in literature. Please give a reference or a full definition (how exactly are those monomials built from the ranks etc.).\n\n#13223 notwithstanding, I've replaced the hyperpolynomial-time `is_graded` method by a polynomial-time (and memory) one. Speed comparisons:\n\nbefore:\n\n```\nsage: B2 = Posets.BooleanLattice(2)\nsage: %timeit B2.is_graded()\n10000 loops, best of 3: 84.9 us per loop\nsage: B3 = Posets.BooleanLattice(3)\nsage: %timeit B3.is_graded()\n10000 loops, best of 3: 195 us per loop\nsage: B4 = Posets.BooleanLattice(4)\nsage: %timeit B4.is_graded()\n1000 loops, best of 3: 663 us per loop\nsage: B5 = Posets.BooleanLattice(5)\nsage: %timeit B5.is_graded()\n100 loops, best of 3: 2.86 ms per loop\nsage: B6 = Posets.BooleanLattice(6)\nsage: %timeit B6.is_graded()\n100 loops, best of 3: 16 ms per loop\nsage: B7 = Posets.BooleanLattice(7)\nsage: %timeit B7.is_graded()\n10 loops, best of 3: 109 ms per loop\nsage: P = Poset({1: [2, 3], 3: [4, 5], 2: [6]})\nsage: %timeit P.is_graded()\n10000 loops, best of 3: 103 us per loop\nsage: C = Poset([list(B7) + [1337], B7.cover_relations() + [[127, 1337]]])\nsage: %timeit C.is_graded()\n10 loops, best of 3: 146 ms per loop\n```\n\nafter:\n\n```\nsage: B2 = Posets.BooleanLattice(2)\nsage: %timeit B2.is_graded()\n10000 loops, best of 3: 82.3 us per loop\nsage: B3 = Posets.BooleanLattice(3)\nsage: %timeit B3.is_graded()\n10000 loops, best of 3: 149 us per loop\nsage: B4 = Posets.BooleanLattice(4)\nsage: %timeit B4.is_graded()\n1000 loops, best of 3: 290 us per loop\nsage: B5 = Posets.BooleanLattice(5)\nsage: %timeit B5.is_graded()\n1000 loops, best of 3: 525 us per loop\nsage: B6 = Posets.BooleanLattice(6)\nsage: %timeit B6.is_graded()\n1000 loops, best of 3: 1.02 ms per loop\nsage: B7 = Posets.BooleanLattice(7)\nsage: %timeit B7.is_graded()\n100 loops, best of 3: 2.07 ms per loop\nsage: P = Poset({1: [2, 3], 3: [4, 5], 2: [6]})\nsage: %timeit P.is_graded()\n10000 loops, best of 3: 108 us per loop\nsage: C = Poset([list(B7) + [1337], B7.cover_relations() + [[127, 1337]]])\nsage: %timeit C.is_graded()\n100 loops, best of 3: 2.14 ms per loop\n```\n\nAlso I have optimized the polynomial-computing methods (apart from the ones I don't understand) by letting them work with the `_hasse_diagram` of the poset rather than the poset itself, because all methods that are used (minimal elements, top, Moebius etc.) currently work by calling the corresponding methods on the Hasse diagram and then relabelling vertices back. This also fixes the issue of `chain_polynomial` throwing errors if the poset wasn't labelled 0,1,...,n (one of the doctests I made checks for this now).\n\nProbably someone will have to review my review...\n\nfor the patchbots:\n\napply trac_13240-qfold.patch\u200b trac_13240-almost-review-dg.patch\u200b",
    "created_at": "2013-10-21T02:49:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152590",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:33" align="right">comment:33</div>

Attachment: **[trac_13240-almost-review-dg.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-almost-review-dg.patch.gz)**

Thanks, Nathan, for alerting me to this patch!

The file I just attached gives a review of everything but the two flag polynomials (f and h) which I couldn't find in literature. Please give a reference or a full definition (how exactly are those monomials built from the ranks etc.).

#13223 notwithstanding, I've replaced the hyperpolynomial-time `is_graded` method by a polynomial-time (and memory) one. Speed comparisons:

before:

```
sage: B2 = Posets.BooleanLattice(2)
sage: %timeit B2.is_graded()
10000 loops, best of 3: 84.9 us per loop
sage: B3 = Posets.BooleanLattice(3)
sage: %timeit B3.is_graded()
10000 loops, best of 3: 195 us per loop
sage: B4 = Posets.BooleanLattice(4)
sage: %timeit B4.is_graded()
1000 loops, best of 3: 663 us per loop
sage: B5 = Posets.BooleanLattice(5)
sage: %timeit B5.is_graded()
100 loops, best of 3: 2.86 ms per loop
sage: B6 = Posets.BooleanLattice(6)
sage: %timeit B6.is_graded()
100 loops, best of 3: 16 ms per loop
sage: B7 = Posets.BooleanLattice(7)
sage: %timeit B7.is_graded()
10 loops, best of 3: 109 ms per loop
sage: P = Poset({1: [2, 3], 3: [4, 5], 2: [6]})
sage: %timeit P.is_graded()
10000 loops, best of 3: 103 us per loop
sage: C = Poset([list(B7) + [1337], B7.cover_relations() + [[127, 1337]]])
sage: %timeit C.is_graded()
10 loops, best of 3: 146 ms per loop
```

after:

```
sage: B2 = Posets.BooleanLattice(2)
sage: %timeit B2.is_graded()
10000 loops, best of 3: 82.3 us per loop
sage: B3 = Posets.BooleanLattice(3)
sage: %timeit B3.is_graded()
10000 loops, best of 3: 149 us per loop
sage: B4 = Posets.BooleanLattice(4)
sage: %timeit B4.is_graded()
1000 loops, best of 3: 290 us per loop
sage: B5 = Posets.BooleanLattice(5)
sage: %timeit B5.is_graded()
1000 loops, best of 3: 525 us per loop
sage: B6 = Posets.BooleanLattice(6)
sage: %timeit B6.is_graded()
1000 loops, best of 3: 1.02 ms per loop
sage: B7 = Posets.BooleanLattice(7)
sage: %timeit B7.is_graded()
100 loops, best of 3: 2.07 ms per loop
sage: P = Poset({1: [2, 3], 3: [4, 5], 2: [6]})
sage: %timeit P.is_graded()
10000 loops, best of 3: 108 us per loop
sage: C = Poset([list(B7) + [1337], B7.cover_relations() + [[127, 1337]]])
sage: %timeit C.is_graded()
100 loops, best of 3: 2.14 ms per loop
```

Also I have optimized the polynomial-computing methods (apart from the ones I don't understand) by letting them work with the `_hasse_diagram` of the poset rather than the poset itself, because all methods that are used (minimal elements, top, Moebius etc.) currently work by calling the corresponding methods on the Hasse diagram and then relabelling vertices back. This also fixes the issue of `chain_polynomial` throwing errors if the poset wasn't labelled 0,1,...,n (one of the doctests I made checks for this now).

Probably someone will have to review my review...

for the patchbots:

apply trac_13240-qfold.patch​ trac_13240-almost-review-dg.patch​



---

archive/issue_comments_152591.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nYooooooooooooooo !!\n\nWell, all I can understand makes sense ! It was nice to merge these calls to `is_bounded` and getting the top/bottom elements in particular. It could even become an optional argument eventually : `p.is_bounded(if_it_is_bounded_return_top_and_bottom_not_true=True)` `:-)`\n\nThaaaaaaaanks Darij !\n\nNathann",
    "created_at": "2013-10-21T13:23:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152591",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:34" align="right">comment:34</div>

Yooooooooooooooo !!

Well, all I can understand makes sense ! It was nice to merge these calls to `is_bounded` and getting the top/bottom elements in particular. It could even become an optional argument eventually : `p.is_bounded(if_it_is_bounded_return_top_and_bottom_not_true=True)` `:-)`

Thaaaaaaaanks Darij !

Nathann



---

archive/issue_comments_152592.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThanks Darij, for your review patch.\n\nYour review looks good to me.\n\nconcerning flag f-vector and flag h-vector, there is something here : http://en.wikipedia.org/wiki/H-vector#Flag_h-vector_and_cd-index\n\nIt can also probably go through the hasse diagram.",
    "created_at": "2013-10-21T19:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152592",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:35" align="right">comment:35</div>

Thanks Darij, for your review patch.

Your review looks good to me.

concerning flag f-vector and flag h-vector, there is something here : http://en.wikipedia.org/wiki/H-vector#Flag_h-vector_and_cd-index

It can also probably go through the hasse diagram.



---

archive/issue_comments_152593.json:
```json
{
    "body": "Attachment: **[trac_13240-review2-dg.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review2-dg.patch.gz)**\n\ncompleted review patch. ignore the almost-review one.",
    "created_at": "2013-10-22T03:09:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152593",
    "user": "https://github.com/darijgr"
}
```

Attachment: **[trac_13240-review2-dg.patch.gz](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review2-dg.patch.gz)**

completed review patch. ignore the almost-review one.



---

archive/issue_comments_152594.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nHi Frederic,\n\nI've completed my review, editing again all four f/h-polynomials (flag and usual). Please check that:\n\n1) the definitions I've added to the docstring are correct (I have deduced them from the implementation, except for the size-1 poset case which I just found had to give 1 for reasons of consistency);\n\n2) all four methods return what they should in the case of a poset with 1 vertex (this is doctested, but I don't know if it's what you want);\n\n3) you really want the flag h-polynomial to be returned as a polynomial over QQ, even if it has integer coefficients.\n\nIf these are fine, feel free to set this to positive review!\n\nfor the patchbot:\n\napply trac_13240-qfold.patch\u200b trac_13240-review2-dg.patch",
    "created_at": "2013-10-22T03:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152594",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:36" align="right">comment:36</div>

Hi Frederic,

I've completed my review, editing again all four f/h-polynomials (flag and usual). Please check that:

1) the definitions I've added to the docstring are correct (I have deduced them from the implementation, except for the size-1 poset case which I just found had to give 1 for reasons of consistency);

2) all four methods return what they should in the case of a poset with 1 vertex (this is doctested, but I don't know if it's what you want);

3) you really want the flag h-polynomial to be returned as a polynomial over QQ, even if it has integer coefficients.

If these are fine, feel free to set this to positive review!

for the patchbot:

apply trac_13240-qfold.patch​ trac_13240-review2-dg.patch



---

archive/issue_comments_152595.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,6 +12,5 @@\n * antichain polynomial\n \n apply:\n-* [attachment: trac_1324O_first_step-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)\n-* [attachment: trac_12340_poset_polynomials-csar.patch](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)\n-* [attachment: trac_13240-review1-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review1-fc.patch.gz)\n+* [attachment: trac_13240-qfold.patch\u200b](https://github.com/sagemath/sage/files/ticket13240/9531d2a861288e7baa584a1d138ffa43.gz)\n+* [attachment: trac_13240-review2-dg.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review2-dg.patch.gz)\n``````\n",
    "created_at": "2013-10-22T03:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152595",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,6 +12,5 @@
 * antichain polynomial
 
 apply:
-* [attachment: trac_1324O_first_step-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_1324O_first_step-fc.patch.gz)
-* [attachment: trac_12340_poset_polynomials-csar.patch](https://github.com/sagemath/sage/files/ticket13240/trac_12340_poset_polynomials-csar.patch.gz)
-* [attachment: trac_13240-review1-fc.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review1-fc.patch.gz)
+* [attachment: trac_13240-qfold.patch​](https://github.com/sagemath/sage/files/ticket13240/9531d2a861288e7baa584a1d138ffa43.gz)
+* [attachment: trac_13240-review2-dg.patch](https://github.com/sagemath/sage/files/ticket13240/trac_13240-review2-dg.patch.gz)
``````




---

archive/issue_comments_152596.json:
```json
{
    "body": "Reviewer: **Darij Grinberg, Nathann Cohen**",
    "created_at": "2013-10-22T03:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152596",
    "user": "https://github.com/darijgr"
}
```

Reviewer: **Darij Grinberg, Nathann Cohen**



---

archive/issue_comments_152597.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThanks Darij,\n\nI will have a serious look later today.\n\nfor the **patchbots** (beware of invisible characters when copy pasting!)\n\napply trac_13240-qfold.patch trac_13240-review2-dg.patch",
    "created_at": "2013-10-22T07:49:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152597",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:39" align="right">comment:39</div>

Thanks Darij,

I will have a serious look later today.

for the **patchbots** (beware of invisible characters when copy pasting!)

apply trac_13240-qfold.patch trac_13240-review2-dg.patch



---

archive/issue_events_182595.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-10-22T18:29:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182595"
}
```



---

archive/issue_events_182596.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-10-22T18:29:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182596"
}
```



---

archive/issue_comments_152598.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nok, I am happy enough with the current patch. Positive review !\n\n:)",
    "created_at": "2013-10-22T18:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152598",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:40" align="right">comment:40</div>

ok, I am happy enough with the current patch. Positive review !

:)



---

archive/issue_comments_152599.json:
```json
{
    "body": "Changed author from **Alex Csar, Kevin Dilks** to **Alex Csar, Kevin Dilks, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2013-10-22T18:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152599",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Alex Csar, Kevin Dilks** to **Alex Csar, Kevin Dilks, Frédéric Chapoton**



---

archive/issue_events_182597.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:16:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182597"
}
```



---

archive/issue_events_182598.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-10-31T19:16:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13240#event-182598"
}
```



---

archive/issue_comments_152600.json:
```json
{
    "body": "Merged: **sage-5.13.beta2**",
    "created_at": "2013-10-31T19:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13240#issuecomment-152600",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.13.beta2**
