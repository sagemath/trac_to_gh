# Issue 13011: several optional tests fail in the sage/mathematica interface with mathematica 8.0

archive/issues_012839.json:
```json
{
    "body": "On OS X 10.7 with the newest version of Mathematica (8.0), several optional tests fail, probably due to changes in mathematica.  Fix this, since with the optional tests, we aim at having the tests work in the latest released version (since that is stable). \n\n```\nblastoff:interfaces wstein$ sage -t -optional mathematica.py \nsage -t -optional \"devel/sage-main/sage/interfaces/mathematica.py\"\n**********************************************************************\nFile \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 128:\n    sage: sys.Solve('{x, y}')               # optional - mathematica\nExpected:\n    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}\nGot:\n    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}\n**********************************************************************\nFile \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 152:\n    sage: v.Solve(['x', 'y'])               # optional - mathematica\nExpected:\n    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}\nGot:\n    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}\n**********************************************************************\nFile \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 270:\n    sage: print n                   # optional - mathematica\nExpected:\n                  1.5707963267948966192313216916397514420985846996876\nGot:\n    1.5707963267949\n**********************************************************************\nFile \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 315:\n    sage: math_bessel_K(2,I)                      # optional - mathematica\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/wstein/sage/build/sage-5.0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[75]>\", line 1, in <module>\n        math_bessel_K(Integer(2),I)                      # optional - mathematica###line 315:\n    sage: math_bessel_K(2,I)                      # optional - mathematica\n      File \"<doctest __main__.example_0[74]>\", line 2, in math_bessel_K\n        return mathematica(nu).BesselK(x).N(Integer(20))\n      File \"element.pyx\", line 634, in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4983)\n      File \"/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/misc/functional.py\", line 1286, in numerical_approx\n        return sage.rings.complex_field.ComplexField(prec)(x)\n      File \"/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py\", line 277, in __call__\n        return Parent.__call__(self, x)\n      File \"parent.pyx\", line 1058, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7941)\n      File \"coerce_maps.pyx\", line 82, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3345)\n      File \"coerce_maps.pyx\", line 77, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3248)\n      File \"/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py\", line 308, in _element_constructor_\n        return complex_number.ComplexNumber(self, x)\n      File \"complex_number.pyx\", line 165, in sage.rings.complex_number.ComplexNumber.__init__ (sage/rings/complex_number.c:3464)\n    TypeError: unable to coerce to a ComplexNumber: <class 'sage.interfaces.mathematica.MathematicaElement'>\n**********************************************************************\n1 items had failures:\n   4 of  85 in __main__.example_0\n***Test Failed*** 4 failures.\nFor whitespace errors, see the file /Users/wstein/.sage//tmp/mathematica_95798.py\n [5.1 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\nsage -t -optional \"devel/sage-main/sage/interfaces/mathematica.py\"\nTotal time for all tests: 5.1 seconds\nblastoff:interfaces wstein$ \n```\n\nApply \n* [attachment:trac_13011.patch]\n* [attachment:trac_13011-part2.patch]\n\nAssignee: @williamstein\n\nKeywords: sd40.5\n\nReviewer: Mike Hansen, Volker Braun\n\nAuthor: William Stein\n\nMerged: sage-5.1.beta5\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/13011\n\n",
    "closed_at": "2012-06-18T10:25:50Z",
    "created_at": "2012-05-25T17:33:44Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "several optional tests fail in the sage/mathematica interface with mathematica 8.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13011",
    "user": "https://github.com/williamstein"
}
```
On OS X 10.7 with the newest version of Mathematica (8.0), several optional tests fail, probably due to changes in mathematica.  Fix this, since with the optional tests, we aim at having the tests work in the latest released version (since that is stable). 

```
blastoff:interfaces wstein$ sage -t -optional mathematica.py 
sage -t -optional "devel/sage-main/sage/interfaces/mathematica.py"
**********************************************************************
File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 128:
    sage: sys.Solve('{x, y}')               # optional - mathematica
Expected:
    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}
Got:
    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}
**********************************************************************
File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 152:
    sage: v.Solve(['x', 'y'])               # optional - mathematica
Expected:
    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}
Got:
    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}
**********************************************************************
File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 270:
    sage: print n                   # optional - mathematica
Expected:
                  1.5707963267948966192313216916397514420985846996876
Got:
    1.5707963267949
**********************************************************************
File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 315:
    sage: math_bessel_K(2,I)                      # optional - mathematica
Exception raised:
    Traceback (most recent call last):
      File "/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/wstein/sage/build/sage-5.0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[75]>", line 1, in <module>
        math_bessel_K(Integer(2),I)                      # optional - mathematica###line 315:
    sage: math_bessel_K(2,I)                      # optional - mathematica
      File "<doctest __main__.example_0[74]>", line 2, in math_bessel_K
        return mathematica(nu).BesselK(x).N(Integer(20))
      File "element.pyx", line 634, in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4983)
      File "/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/misc/functional.py", line 1286, in numerical_approx
        return sage.rings.complex_field.ComplexField(prec)(x)
      File "/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py", line 277, in __call__
        return Parent.__call__(self, x)
      File "parent.pyx", line 1058, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7941)
      File "coerce_maps.pyx", line 82, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3345)
      File "coerce_maps.pyx", line 77, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3248)
      File "/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py", line 308, in _element_constructor_
        return complex_number.ComplexNumber(self, x)
      File "complex_number.pyx", line 165, in sage.rings.complex_number.ComplexNumber.__init__ (sage/rings/complex_number.c:3464)
    TypeError: unable to coerce to a ComplexNumber: <class 'sage.interfaces.mathematica.MathematicaElement'>
**********************************************************************
1 items had failures:
   4 of  85 in __main__.example_0
***Test Failed*** 4 failures.
For whitespace errors, see the file /Users/wstein/.sage//tmp/mathematica_95798.py
 [5.1 s]
 
----------------------------------------------------------------------
The following tests failed:


sage -t -optional "devel/sage-main/sage/interfaces/mathematica.py"
Total time for all tests: 5.1 seconds
blastoff:interfaces wstein$ 
```

Apply 
* [attachment:trac_13011.patch]
* [attachment:trac_13011-part2.patch]

Assignee: @williamstein

Keywords: sd40.5

Reviewer: Mike Hansen, Volker Braun

Author: William Stein

Merged: sage-5.1.beta5

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/13011





---

archive/issue_comments_191252.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd40.5\".",
    "created_at": "2012-05-25T17:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191252",
    "user": "https://github.com/williamstein"
}
```

Changing keywords from "" to "sd40.5".



---

archive/issue_comments_191253.json:
```json
{
    "body": "Attachment [trac_13011.patch](tarball://root/attachments/some-uuid/ticket13011/trac_13011.patch) by @williamstein created at 2012-05-25 17:57:23",
    "created_at": "2012-05-25T17:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191253",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_13011.patch](tarball://root/attachments/some-uuid/ticket13011/trac_13011.patch) by @williamstein created at 2012-05-25 17:57:23



---

archive/issue_comments_191254.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-25T17:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191254",
    "user": "https://github.com/williamstein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_191255.json:
```json
{
    "body": "<a id='comment:2'></a>I have Mathematica 8 on my laptop if you want to see this work.",
    "created_at": "2012-05-25T17:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191255",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'></a>I have Mathematica 8 on my laptop if you want to see this work.



---

archive/issue_comments_191256.json:
```json
{
    "body": "<a id='comment:3'></a>Note -- in the patch I fixed a very serious bug with \".N()\" that was introduced into Sage a year or two ago.",
    "created_at": "2012-05-25T17:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191256",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'></a>Note -- in the patch I fixed a very serious bug with ".N()" that was introduced into Sage a year or two ago.



---

archive/issue_comments_191257.json:
```json
{
    "body": "Changing author from \"\" to \"William Stein\"",
    "created_at": "2012-05-28T01:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191257",
    "user": "https://github.com/mwhansen"
}
```

Changing author from "" to "William Stein"



---

archive/issue_comments_191258.json:
```json
{
    "body": "<a id='comment:4'></a>You need to mark the `N()` tests as optional, otherwise looks good.",
    "created_at": "2012-05-28T01:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191258",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:4'></a>You need to mark the `N()` tests as optional, otherwise looks good.



---

archive/issue_comments_191259.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Mike Hansen\"",
    "created_at": "2012-05-28T01:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191259",
    "user": "https://github.com/mwhansen"
}
```

Changing reviewer from "" to "Mike Hansen"



---

archive/issue_comments_191260.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-05-28T01:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191260",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_191261.json:
```json
{
    "body": "<a id='comment:6'></a>Attachment [trac_13011-part2.patch](tarball://root/attachments/some-uuid/ticket13011/trac_13011-part2.patch) by @williamstein created at 2012-05-28 04:10:00",
    "created_at": "2012-05-28T04:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191261",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:6'></a>Attachment [trac_13011-part2.patch](tarball://root/attachments/some-uuid/ticket13011/trac_13011-part2.patch) by @williamstein created at 2012-05-28 04:10:00



---

archive/issue_comments_191262.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-05-28T04:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191262",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_191263.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -68,6 +68,10 @@\n blastoff:interfaces wstein$ \n ```\n \n+Apply \n+* [attachment:trac_13011.patch]\n+* [attachment:trac_13011-part2.patch]\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/13011\n``````\n",
    "created_at": "2012-05-28T04:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191263",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -68,6 +68,10 @@
 blastoff:interfaces wstein$ 
 ```
 
+Apply 
+* [attachment:trac_13011.patch]
+* [attachment:trac_13011-part2.patch]
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/13011
``````




---

archive/issue_comments_191264.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-28T04:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191264",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_191265.json:
```json
{
    "body": "<a id='comment:7'></a>Let's Get That Money!",
    "created_at": "2012-05-28T04:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191265",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>Let's Get That Money!



---

archive/issue_comments_191266.json:
```json
{
    "body": "Changing reviewer from \"Mike Hansen\" to \"Mike Hansen, Volker Braun\"",
    "created_at": "2012-05-28T04:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191266",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "Mike Hansen" to "Mike Hansen, Volker Braun"



---

archive/issue_comments_191267.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-06-18T10:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191267",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_191268.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.1.beta5\"",
    "created_at": "2012-06-18T10:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191268",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.1.beta5"



---

archive/issue_events_035631.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T10:25:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13011#event-35631"
}
```



---

archive/issue_comments_191269.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,76 @@\n+On OS X 10.7 with the newest version of Mathematica (8.0), several optional tests fail, probably due to changes in mathematica.  Fix this, since with the optional tests, we aim at having the tests work in the latest released version (since that is stable). \n \n+```\n+blastoff:interfaces wstein$ sage -t -optional mathematica.py \n+sage -t -optional \"devel/sage-main/sage/interfaces/mathematica.py\"\n+**********************************************************************\n+File \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 128:\n+    sage: sys.Solve('{x, y}')               # optional - mathematica\n+Expected:\n+    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}\n+Got:\n+    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}\n+**********************************************************************\n+File \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 152:\n+    sage: v.Solve(['x', 'y'])               # optional - mathematica\n+Expected:\n+    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}\n+Got:\n+    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}\n+**********************************************************************\n+File \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 270:\n+    sage: print n                   # optional - mathematica\n+Expected:\n+                  1.5707963267948966192313216916397514420985846996876\n+Got:\n+    1.5707963267949\n+**********************************************************************\n+File \"/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py\", line 315:\n+    sage: math_bessel_K(2,I)                      # optional - mathematica\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n+        self.run_one_example(test, example, filename, compileflags)\n+      File \"/Users/wstein/sage/build/sage-5.0/local/bin/sagedoctest.py\", line 38, in run_one_example\n+        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n+      File \"/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n+        compileflags, 1) in test.globs\n+      File \"<doctest __main__.example_0[75]>\", line 1, in <module>\n+        math_bessel_K(Integer(2),I)                      # optional - mathematica###line 315:\n+    sage: math_bessel_K(2,I)                      # optional - mathematica\n+      File \"<doctest __main__.example_0[74]>\", line 2, in math_bessel_K\n+        return mathematica(nu).BesselK(x).N(Integer(20))\n+      File \"element.pyx\", line 634, in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4983)\n+      File \"/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/misc/functional.py\", line 1286, in numerical_approx\n+        return sage.rings.complex_field.ComplexField(prec)(x)\n+      File \"/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py\", line 277, in __call__\n+        return Parent.__call__(self, x)\n+      File \"parent.pyx\", line 1058, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7941)\n+      File \"coerce_maps.pyx\", line 82, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3345)\n+      File \"coerce_maps.pyx\", line 77, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3248)\n+      File \"/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py\", line 308, in _element_constructor_\n+        return complex_number.ComplexNumber(self, x)\n+      File \"complex_number.pyx\", line 165, in sage.rings.complex_number.ComplexNumber.__init__ (sage/rings/complex_number.c:3464)\n+    TypeError: unable to coerce to a ComplexNumber: <class 'sage.interfaces.mathematica.MathematicaElement'>\n+**********************************************************************\n+1 items had failures:\n+   4 of  85 in __main__.example_0\n+***Test Failed*** 4 failures.\n+For whitespace errors, see the file /Users/wstein/.sage//tmp/mathematica_95798.py\n+ [5.1 s]\n+ \n+----------------------------------------------------------------------\n+The following tests failed:\n+\n+\n+sage -t -optional \"devel/sage-main/sage/interfaces/mathematica.py\"\n+Total time for all tests: 5.1 seconds\n+blastoff:interfaces wstein$ \n+```\n+\n+Apply \n+* [attachment:trac_13011.patch]\n+* [attachment:trac_13011-part2.patch]\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-09-06T14:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13011#issuecomment-191269",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,76 @@
+On OS X 10.7 with the newest version of Mathematica (8.0), several optional tests fail, probably due to changes in mathematica.  Fix this, since with the optional tests, we aim at having the tests work in the latest released version (since that is stable). 
 
+```
+blastoff:interfaces wstein$ sage -t -optional mathematica.py 
+sage -t -optional "devel/sage-main/sage/interfaces/mathematica.py"
+**********************************************************************
+File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 128:
+    sage: sys.Solve('{x, y}')               # optional - mathematica
+Expected:
+    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}
+Got:
+    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}
+**********************************************************************
+File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 152:
+    sage: v.Solve(['x', 'y'])               # optional - mathematica
+Expected:
+    {{y -> -1, x -> 0}, {y -> 11, x -> 6}}
+Got:
+    {{x -> 0, y -> -1}, {x -> 6, y -> 11}}
+**********************************************************************
+File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 270:
+    sage: print n                   # optional - mathematica
+Expected:
+                  1.5707963267948966192313216916397514420985846996876
+Got:
+    1.5707963267949
+**********************************************************************
+File "/Users/wstein/sage/build/sage-5.0/devel/sage-main/sage/interfaces/mathematica.py", line 315:
+    sage: math_bessel_K(2,I)                      # optional - mathematica
+Exception raised:
+    Traceback (most recent call last):
+      File "/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py", line 1231, in run_one_test
+        self.run_one_example(test, example, filename, compileflags)
+      File "/Users/wstein/sage/build/sage-5.0/local/bin/sagedoctest.py", line 38, in run_one_example
+        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
+      File "/Users/wstein/sage/build/sage-5.0/local/bin/ncadoctest.py", line 1172, in run_one_example
+        compileflags, 1) in test.globs
+      File "<doctest __main__.example_0[75]>", line 1, in <module>
+        math_bessel_K(Integer(2),I)                      # optional - mathematica###line 315:
+    sage: math_bessel_K(2,I)                      # optional - mathematica
+      File "<doctest __main__.example_0[74]>", line 2, in math_bessel_K
+        return mathematica(nu).BesselK(x).N(Integer(20))
+      File "element.pyx", line 634, in sage.structure.element.Element.numerical_approx (sage/structure/element.c:4983)
+      File "/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/misc/functional.py", line 1286, in numerical_approx
+        return sage.rings.complex_field.ComplexField(prec)(x)
+      File "/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py", line 277, in __call__
+        return Parent.__call__(self, x)
+      File "parent.pyx", line 1058, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7941)
+      File "coerce_maps.pyx", line 82, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3345)
+      File "coerce_maps.pyx", line 77, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3248)
+      File "/Users/wstein/sage/build/sage-5.0/local/lib/python/site-packages/sage/rings/complex_field.py", line 308, in _element_constructor_
+        return complex_number.ComplexNumber(self, x)
+      File "complex_number.pyx", line 165, in sage.rings.complex_number.ComplexNumber.__init__ (sage/rings/complex_number.c:3464)
+    TypeError: unable to coerce to a ComplexNumber: <class 'sage.interfaces.mathematica.MathematicaElement'>
+**********************************************************************
+1 items had failures:
+   4 of  85 in __main__.example_0
+***Test Failed*** 4 failures.
+For whitespace errors, see the file /Users/wstein/.sage//tmp/mathematica_95798.py
+ [5.1 s]
+ 
+----------------------------------------------------------------------
+The following tests failed:
+
+
+sage -t -optional "devel/sage-main/sage/interfaces/mathematica.py"
+Total time for all tests: 5.1 seconds
+blastoff:interfaces wstein$ 
+```
+
+Apply 
+* [attachment:trac_13011.patch]
+* [attachment:trac_13011-part2.patch]
 
 Comment: 1
 
``````

