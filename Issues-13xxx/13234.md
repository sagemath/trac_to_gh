# Issue 13234: Add Normaliz optional package

archive/issues_013062.json:
```json
{
    "body": "Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.\n\nInstall the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)\n\n**CC:**  @johnperry-math\n\n**Upstream:** Fixed upstream, but not in a stable release.\n\n**Reviewer:** Dmitrii Pasechnik\n\n**Author:** Andrey Novoseltsev\n\n**Merged:** sage-5.6.beta0\n\nIssue created by migration from https://trac.sagemath.org/ticket/13234\n\n",
    "closed_at": "2012-12-18T14:54:45Z",
    "created_at": "2012-07-11T23:01:12Z",
    "labels": [
        "component: packages: optional",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.6",
    "title": "Add Normaliz optional package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13234",
    "user": "https://github.com/novoselt"
}
```
Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.

Install the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)

**CC:**  @johnperry-math

**Upstream:** Fixed upstream, but not in a stable release.

**Reviewer:** Dmitrii Pasechnik

**Author:** Andrey Novoseltsev

**Merged:** sage-5.6.beta0

Issue created by migration from https://trac.sagemath.org/ticket/13234





---

archive/issue_events_111972.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-07-11T23:12:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111972"
}
```



---

archive/issue_events_111973.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-08-17T13:48:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111973"
}
```



---

archive/issue_events_111974.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-08-17T13:48:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111974"
}
```



---

archive/issue_comments_154698.json:
```json
{
    "body": "<a id='comment:2'></a>\n`-static` is not supported on MacOSX. There one gets:\n\n```\n...\nar -cr libnormaliz.a cone_property.o hilbert_series.o libnormaliz-templated.o\nmake normaliz\ng++  -I/usr/local/src/sage/sage-5.2.rc0/local/include  -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -static Normaliz.cpp libnormaliz/libnormaliz.a -lgmpxx -lgmp -o normaliz\nld: library not found for -lcrt0.o\ncollect2: ld returned 1 exit status\nmake[1]: *** [normaliz] Error 1\nmake: *** [linknormaliz] Error 2\nError building Normaliz.\n```\n\nIt's probably better to build a dynamic library.",
    "created_at": "2012-08-17T13:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154698",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
`-static` is not supported on MacOSX. There one gets:

```
...
ar -cr libnormaliz.a cone_property.o hilbert_series.o libnormaliz-templated.o
make normaliz
g++  -I/usr/local/src/sage/sage-5.2.rc0/local/include  -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -static Normaliz.cpp libnormaliz/libnormaliz.a -lgmpxx -lgmp -o normaliz
ld: library not found for -lcrt0.o
collect2: ld returned 1 exit status
make[1]: *** [normaliz] Error 1
make: *** [linknormaliz] Error 2
Error building Normaliz.
```

It's probably better to build a dynamic library.



---

archive/issue_comments_154699.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [dimpase](#comment%3A2):\n> `-static` is not supported on MacOSX. \n\nThe file\n`source/Makefile.configuration` contains lines\n\n```\n##for mac link libgcc not static\nNORMFLAGS = -static\n#NORMFLAGS = -static-libgcc\n```\nIf I set switch  `NORMFLAGS = -static-libgcc` then on MacOSX 10.6.8 the spkg builds OK. It's a trivial matter to add an OS recognition to spkg-install and patch the said file if one happens to be on OSX.",
    "created_at": "2012-08-17T14:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154699",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
Replying to [dimpase](#comment%3A2):
> `-static` is not supported on MacOSX. 

The file
`source/Makefile.configuration` contains lines

```
##for mac link libgcc not static
NORMFLAGS = -static
#NORMFLAGS = -static-libgcc
```
If I set switch  `NORMFLAGS = -static-libgcc` then on MacOSX 10.6.8 the spkg builds OK. It's a trivial matter to add an OS recognition to spkg-install and patch the said file if one happens to be on OSX.



---

archive/issue_comments_154700.json:
```json
{
    "body": "<a id='comment:4'></a>\nWinfried has also suggested to just remove this static option, I've updated the spkg and rewrote the installation script based on pyopenssl.",
    "created_at": "2012-10-22T05:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154700",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:4'></a>
Winfried has also suggested to just remove this static option, I've updated the spkg and rewrote the installation script based on pyopenssl.



---

archive/issue_events_111975.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-10-22T05:23:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111975"
}
```



---

archive/issue_events_111976.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-10-22T05:23:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111976"
}
```



---

archive/issue_comments_154701.json:
```json
{
    "body": "<a id='comment:5'></a>\nOK, it builds on MacOSX 10.6. (with Sage 5.4.rc0). However, if I try to use the provided in the spkg Macaulay2 package Normaliz, it does not seem to work. I  cd to the directory containing Normaliz.m2, start a standalone M2 version 1.4 within Sage shell, and then I get \n\n```\ni10 : installPackage \"Normaliz\"\nstdio:11:1:(3): error: makeDocumentTag: package cannot be determined: 'Normaliz'\nstdio:4:16-4:24: here is the first use of 'Normaliz'\n```\nI don't know enough M2 to know how to deal with it.\n\nEDIT: it could be that this just means that a version of Normaliz is already present in this instance of M2 (and indeed, it is). So just ignore this, I guess. We'll sort it out when M2 Sage spkg will be ready.",
    "created_at": "2012-10-22T07:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154701",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
OK, it builds on MacOSX 10.6. (with Sage 5.4.rc0). However, if I try to use the provided in the spkg Macaulay2 package Normaliz, it does not seem to work. I  cd to the directory containing Normaliz.m2, start a standalone M2 version 1.4 within Sage shell, and then I get 

```
i10 : installPackage "Normaliz"
stdio:11:1:(3): error: makeDocumentTag: package cannot be determined: 'Normaliz'
stdio:4:16-4:24: here is the first use of 'Normaliz'
```
I don't know enough M2 to know how to deal with it.

EDIT: it could be that this just means that a version of Normaliz is already present in this instance of M2 (and indeed, it is). So just ignore this, I guess. We'll sort it out when M2 Sage spkg will be ready.



---

archive/issue_events_111977.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-22T07:19:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111977"
}
```



---

archive/issue_events_111978.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-22T07:19:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111978"
}
```



---

archive/issue_comments_154702.json:
```json
{
    "body": "<a id='comment:6'></a>\nAs well, I don't know how to properly handle the Singular interface. Note that Normaliz provides an interface to Singular, in `src/Singular/normaliz.lib`.\n\nOn the other hand, Singular spkg provides `normaliz.lib` for version 2.7 of Normaliz.\n(Which is probably useless without Normaliz installed, and ought to be removed, but this is not for this ticket).\nI think one should make this spkg install `normaliz.lib` to its proper place in `$SAGE_LOCAL`.\n\nRegarding M2 support, it can wait, but this one definitely needs work. I'd be happy to have another look after this is implemented.",
    "created_at": "2012-10-22T08:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154702",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
As well, I don't know how to properly handle the Singular interface. Note that Normaliz provides an interface to Singular, in `src/Singular/normaliz.lib`.

On the other hand, Singular spkg provides `normaliz.lib` for version 2.7 of Normaliz.
(Which is probably useless without Normaliz installed, and ought to be removed, but this is not for this ticket).
I think one should make this spkg install `normaliz.lib` to its proper place in `$SAGE_LOCAL`.

Regarding M2 support, it can wait, but this one definitely needs work. I'd be happy to have another look after this is implemented.



---

archive/issue_comments_154703.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.",
    "created_at": "2012-10-24T02:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154703",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:7'></a>
It seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.



---

archive/issue_comments_154704.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [novoselt](#comment%3A7):\n> It seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.\n\n\nnot according to the following lines \n\n```\n@*Singular and Normaliz exchange data via files. These files are automatically\ncreated and erased behind the scenes. \n```\nin Singular/singular.lib\n\nSo it is not something independent.",
    "created_at": "2012-10-24T04:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154704",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
Replying to [novoselt](#comment%3A7):
> It seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.


not according to the following lines 

```
@*Singular and Normaliz exchange data via files. These files are automatically
created and erased behind the scenes. 
```
in Singular/singular.lib

So it is not something independent.



---

archive/issue_events_111979.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-02T03:15:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111979"
}
```



---

archive/issue_events_111980.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-02T03:15:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111980"
}
```



---

archive/issue_comments_154705.json:
```json
{
    "body": "<a id='comment:9'></a>\nAdded library copying - I misunderstood what was going on, I thought it was a library file as in \"objective code\", not \"Singular module\".",
    "created_at": "2012-12-02T03:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154705",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:9'></a>
Added library copying - I misunderstood what was going on, I thought it was a library file as in "objective code", not "Singular module".



---

archive/issue_events_111981.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-02T05:18:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111981"
}
```



---

archive/issue_events_111982.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-02T05:18:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111982"
}
```



---

archive/issue_comments_154706.json:
```json
{
    "body": "<a id='comment:10'></a>\nafter installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.\n\n```\nsage: singular_console()\n                     SINGULAR                                 /  Development\n A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n                                                           0<\n by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\nFB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\n> LIB \"normaliz.lib\";\n// ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$\n> ring R=0,(x,y,z,t),dp;\n> ideal I=x^2,y^2,z^3;\n> list l=intclMonIdeal(I);\n> showNuminvs();\nhilbert_basis_elements : 2\nnumber_extreme_rays : 2\nrank : 2\nindex : 1\nnumber_support_hyperplanes : 2\nsize_triangulation : 1\nsum_dets : 1\ngraded : 1\ndegree_1_elements : 2\ngrading : 1,-1\ngrading_denom : 1\nmultiplicity : 1\nmultiplicity_denom : 1\nhilbert_series_num : 1\nhilbert_series_denom : 1,1\nprimary : 1\nideal_multiplicity : 2\n> \n```\nwhereas according to [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219) the output should be\n\n```\nshowNuminvs();\n==> hilbert_basis_elements : 9\n==> number_extreme_rays : 6\n==> rank : 4\n==> index : 1\n==> number_support_hyperplanes : 5\n==> homogeneous : 0\n==> primary : 1\n==> ideal_multiplicity : 12\n```",
    "created_at": "2012-12-02T05:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154706",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
after installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.

```
sage: singular_console()
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-5
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> LIB "normaliz.lib";
// ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$
> ring R=0,(x,y,z,t),dp;
> ideal I=x^2,y^2,z^3;
> list l=intclMonIdeal(I);
> showNuminvs();
hilbert_basis_elements : 2
number_extreme_rays : 2
rank : 2
index : 1
number_support_hyperplanes : 2
size_triangulation : 1
sum_dets : 1
graded : 1
degree_1_elements : 2
grading : 1,-1
grading_denom : 1
multiplicity : 1
multiplicity_denom : 1
hilbert_series_num : 1
hilbert_series_denom : 1,1
primary : 1
ideal_multiplicity : 2
> 
```
whereas according to [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219) the output should be

```
showNuminvs();
==> hilbert_basis_elements : 9
==> number_extreme_rays : 6
==> rank : 4
==> index : 1
==> number_support_hyperplanes : 5
==> homogeneous : 0
==> primary : 1
==> ideal_multiplicity : 12
```



---

archive/attachments_017899.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "t.in",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13234/t.in",
    "created_at": "2012-12-02T05:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.in",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_154707.json:
```json
{
    "body": "normaliz input for (x<sup>2,y</sup>2,z^3)",
    "created_at": "2012-12-02T05:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154707",
    "user": "https://github.com/dimpase"
}
```

normaliz input for (x<sup>2,y</sup>2,z^3)



---

archive/issue_comments_154708.json:
```json
{
    "body": "<a id='comment:11'></a>\nIf I try running normaliz directly on the input (roughly) corresponding to this example of the monomial ideal (see [attachment:t.in]), I  get results consistent with [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219), see the [attachment:t.out]. So this looks like an interface problem.",
    "created_at": "2012-12-02T05:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154708",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
If I try running normaliz directly on the input (roughly) corresponding to this example of the monomial ideal (see [attachment:t.in]), I  get results consistent with [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219), see the [attachment:t.out]. So this looks like an interface problem.



---

archive/issue_comments_154709.json:
```json
{
    "body": "normaliz output",
    "created_at": "2012-12-02T05:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154709",
    "user": "https://github.com/dimpase"
}
```

normaliz output



---

archive/attachments_017900.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "t.out",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13234/t.out",
    "created_at": "2012-12-02T06:29:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.out",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_154710.json:
```json
{
    "body": "<a id='comment:12'></a>\nI also noticed that some normaliz.lib functions are not working as advertised, e.g.\n\n```\n> startNmz();\n   ? open: Error for link _ of type: ASCII, mode: r, name: nmz_sing_exec.path\n   ? cannot read from `nmz_sing_exec.path`\n   ? error occurred in or before normaliz.lib::startNmz line 292: `    string s=read(inf); `\n   ? expected string-expression. type 'help string;'\n   ? leaving normaliz.lib::startNmz\n   skipping text from `;` error at token `)`\n```\ninstead of [this](http://www.singular.uni-kl.de/Manual/latest/sing_1154.htm#SEC1230). This is probably minor, as `normaliz` executable is found in the `PATH`.\nTo make it work I can do \n\n```\n> setNmzDataPath(\"/tmp/\");\n> setNmzFilename(\"blah\");\n> writeNmzPaths();\n> startNmz();\nnmz_exec_path not set\nnmz_data_path is /tmp/\n```\nIf I then try the Singular input as above to compute \n`intclMonIdeal(I)` I can see that the files `/tmp/blah.*` created do not make sense. E.g. `/tmp/blah.in` is as follows:\n\n```\n1\n1\n2 \n3\n```\nwhich makes little sense.\n\nI would not be surprised if this is an upstream (i.e. `normaliz`) bug.",
    "created_at": "2012-12-02T06:29:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154710",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>
I also noticed that some normaliz.lib functions are not working as advertised, e.g.

```
> startNmz();
   ? open: Error for link _ of type: ASCII, mode: r, name: nmz_sing_exec.path
   ? cannot read from `nmz_sing_exec.path`
   ? error occurred in or before normaliz.lib::startNmz line 292: `    string s=read(inf); `
   ? expected string-expression. type 'help string;'
   ? leaving normaliz.lib::startNmz
   skipping text from `;` error at token `)`
```
instead of [this](http://www.singular.uni-kl.de/Manual/latest/sing_1154.htm#SEC1230). This is probably minor, as `normaliz` executable is found in the `PATH`.
To make it work I can do 

```
> setNmzDataPath("/tmp/");
> setNmzFilename("blah");
> writeNmzPaths();
> startNmz();
nmz_exec_path not set
nmz_data_path is /tmp/
```
If I then try the Singular input as above to compute 
`intclMonIdeal(I)` I can see that the files `/tmp/blah.*` created do not make sense. E.g. `/tmp/blah.in` is as follows:

```
1
1
2 
3
```
which makes little sense.

I would not be surprised if this is an upstream (i.e. `normaliz`) bug.



---

archive/issue_comments_154711.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [dimpase](#comment%3A10):\n> after installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.\n> \n> ```\n> sage: singular_console()\n>                      SINGULAR                                 /  Development\n>  A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n>                                                            0<\n>  by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\n> FB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\n> > LIB \"normaliz.lib\";\n> // ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$\n> > ring R=0,(x,y,z,t),dp;\n> ```\n\nIf I rather set  `ring R=0,(x,y,z),dp;` then the result is consistent with Singular's manual. So this looks like a documentation bug rather than anything more serious.",
    "created_at": "2012-12-02T08:51:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154711",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>
Replying to [dimpase](#comment%3A10):
> after installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.
> 
> ```
> sage: singular_console()
>                      SINGULAR                                 /  Development
>  A Computer Algebra System for Polynomial Computations       /   version 3-1-5
>                                                            0<
>  by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
> FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> > LIB "normaliz.lib";
> // ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$
> > ring R=0,(x,y,z,t),dp;
> ```

If I rather set  `ring R=0,(x,y,z),dp;` then the result is consistent with Singular's manual. So this looks like a documentation bug rather than anything more serious.



---

archive/issue_comments_154712.json:
```json
{
    "body": "**Upstream:** Reported upstream. No feedback yet.",
    "created_at": "2012-12-02T16:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154712",
    "user": "https://github.com/dimpase"
}
```

**Upstream:** Reported upstream. No feedback yet.



---

archive/issue_comments_154713.json:
```json
{
    "body": "<a id='comment:15'></a>\nI've added a patched based on the file sent to me by Christof S\u00f6ger. Now I am getting\n\n```\n                     SINGULAR                                 /  Development\n A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n                                                           0<\n by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\nFB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\n> LIB \"normaliz.lib\";\n// ** loaded /home/novoselt/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$\n> ring R=0,(x,y,z,t),dp;\n> ideal I=x^2,y^2,z^3;\n> list l=intclMonIdeal(I);\nNo grading specified and cannot find one. Disabling some computations!\n> showNuminvs();\nhilbert_basis_elements : 9\nnumber_extreme_rays : 6\nrank : 4\nindex : 1\nnumber_support_hyperplanes : 5\nsize_triangulation : 3\nsum_dets : 7\ngraded : 0\nprimary : 1\nideal_multiplicity : 12\n> \n```\nwhich seems to be consistent with Singular manual.",
    "created_at": "2012-12-03T02:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154713",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:15'></a>
I've added a patched based on the file sent to me by Christof SÃ¶ger. Now I am getting

```
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-5
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> LIB "normaliz.lib";
// ** loaded /home/novoselt/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$
> ring R=0,(x,y,z,t),dp;
> ideal I=x^2,y^2,z^3;
> list l=intclMonIdeal(I);
No grading specified and cannot find one. Disabling some computations!
> showNuminvs();
hilbert_basis_elements : 9
number_extreme_rays : 6
rank : 4
index : 1
number_support_hyperplanes : 5
size_triangulation : 3
sum_dets : 7
graded : 0
primary : 1
ideal_multiplicity : 12
> 
```
which seems to be consistent with Singular manual.



---

archive/issue_events_111983.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-03T02:39:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111983"
}
```



---

archive/issue_events_111984.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-03T02:39:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111984"
}
```



---

archive/issue_comments_154714.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2012-12-03T02:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154714",
    "user": "https://github.com/novoselt"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release.".



---

archive/attachments_017901.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "spkg-install",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13234/spkg-install",
    "created_at": "2012-12-03T02:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_154715.json:
```json
{
    "body": "For reviewing only",
    "created_at": "2012-12-03T02:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154715",
    "user": "https://github.com/novoselt"
}
```

For reviewing only



---

archive/issue_comments_154716.json:
```json
{
    "body": "For reviewing only",
    "created_at": "2012-12-03T02:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154716",
    "user": "https://github.com/novoselt"
}
```

For reviewing only



---

archive/attachments_017902.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "01-adjust-size-of-input-matrix-fix.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket13234/01-adjust-size-of-input-matrix-fix.patch",
    "created_at": "2012-12-03T11:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_154717.json:
```json
{
    "body": "<a id='comment:16'></a>\nOK, good - but could you please bump up the version to 2.8.p0, as this is not vanilla upstream.",
    "created_at": "2012-12-03T11:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154717",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
OK, good - but could you please bump up the version to 2.8.p0, as this is not vanilla upstream.



---

archive/issue_events_111985.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-03T11:55:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111985"
}
```



---

archive/issue_events_111986.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-03T11:55:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111986"
}
```



---

archive/issue_comments_154718.json:
```json
{
    "body": "<a id='comment:17'></a>\nI've made the spkg bumped up version (linked in the ticket description).",
    "created_at": "2012-12-03T11:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154718",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>
I've made the spkg bumped up version (linked in the ticket description).



---

archive/issue_comments_154719.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.\n \n-http://sage.math.washington.edu/home/novoselt/normaliz-2.8.spkg\n+Install the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)\n``````\n",
    "created_at": "2012-12-03T11:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154719",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.
 
-http://sage.math.washington.edu/home/novoselt/normaliz-2.8.spkg
+Install the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)
``````




---

archive/issue_comments_154720.json:
```json
{
    "body": "**Reviewer:** Dmitrii Pasechnik",
    "created_at": "2012-12-03T11:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154720",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dmitrii Pasechnik



---

archive/issue_comments_154721.json:
```json
{
    "body": "<a id='comment:18'></a>\nThank you for a thorough review and quick responses despite my long pauses, it was a good spkg-exercise for me!",
    "created_at": "2012-12-03T17:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154721",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:18'></a>
Thank you for a thorough review and quick responses despite my long pauses, it was a good spkg-exercise for me!



---

archive/issue_events_111987.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T11:26:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "component: packages",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111987"
}
```



---

archive/issue_events_111988.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T11:26:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "component: packages: optional",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111988"
}
```



---

archive/issue_comments_154722.json:
```json
{
    "body": "<a id='comment:20'></a>\nI just copied the spkg into the \"optional\" subdir on the server and mirrors.",
    "created_at": "2012-12-18T14:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154722",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:20'></a>
I just copied the spkg into the "optional" subdir on the server and mirrors.



---

archive/issue_comments_154723.json:
```json
{
    "body": "**Merged:** sage-5.6.beta0",
    "created_at": "2012-12-18T14:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13234#issuecomment-154723",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.6.beta0



---

archive/issue_events_111989.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T14:54:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111989"
}
```



---

archive/issue_events_111990.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T14:54:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13234",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13234#event-111990"
}
```
