# Issue 13234: Add Normaliz optional package

archive/issues_013062.json:
```json
{
    "assignees": [],
    "body": "Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.\n\nInstall the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)\n\nCC:  @johnperry-math\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\nReviewer: **Dmitrii Pasechnik**\n\nAuthor: **Andrey Novoseltsev**\n\nMerged: **sage-5.6.beta0**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/13234_\n\n",
    "closed_at": "2012-12-18T14:54:45Z",
    "created_at": "2012-07-11T23:01:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add Normaliz optional package",
    "type": "issue",
    "updated_at": "2012-12-18T14:54:45Z",
    "url": "https://github.com/sagemath/sage/issues/13234",
    "user": "https://github.com/novoselt"
}
```
Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.

Install the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)

CC:  @johnperry-math

Upstream: **Fixed upstream, but not in a stable release.**

Reviewer: **Dmitrii Pasechnik**

Author: **Andrey Novoseltsev**

Merged: **sage-5.6.beta0**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/13234_





---

archive/issue_events_182455.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-07-11T23:01:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182455"
}
```



---

archive/issue_events_182456.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-07-11T23:01:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182456"
}
```



---

archive/issue_events_182457.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-07-11T23:01:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182457"
}
```



---

archive/issue_events_182458.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-07-11T23:01:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182458"
}
```



---

archive/issue_events_182459.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-07-11T23:12:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182459"
}
```



---

archive/issue_events_182460.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-08-17T13:48:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182460"
}
```



---

archive/issue_events_182461.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-08-17T13:48:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182461"
}
```



---

archive/issue_comments_152411.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n`-static` is not supported on MacOSX. There one gets:\n\n```\n...\nar -cr libnormaliz.a cone_property.o hilbert_series.o libnormaliz-templated.o\nmake normaliz\ng++  -I/usr/local/src/sage/sage-5.2.rc0/local/include  -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -static Normaliz.cpp libnormaliz/libnormaliz.a -lgmpxx -lgmp -o normaliz\nld: library not found for -lcrt0.o\ncollect2: ld returned 1 exit status\nmake[1]: *** [normaliz] Error 1\nmake: *** [linknormaliz] Error 2\nError building Normaliz.\n```\n\nIt's probably better to build a dynamic library.",
    "created_at": "2012-08-17T13:48:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152411",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

`-static` is not supported on MacOSX. There one gets:

```
...
ar -cr libnormaliz.a cone_property.o hilbert_series.o libnormaliz-templated.o
make normaliz
g++  -I/usr/local/src/sage/sage-5.2.rc0/local/include  -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -Wall -pedantic -Wno-long-long -O3 -funroll-loops -fopenmp -static Normaliz.cpp libnormaliz/libnormaliz.a -lgmpxx -lgmp -o normaliz
ld: library not found for -lcrt0.o
collect2: ld returned 1 exit status
make[1]: *** [normaliz] Error 1
make: *** [linknormaliz] Error 2
Error building Normaliz.
```

It's probably better to build a dynamic library.



---

archive/issue_comments_152412.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@dimpase](#comment%3A2):\n> `-static` is not supported on MacOSX. \n\nThe file\n`source/Makefile.configuration` contains lines\n\n```\n##for mac link libgcc not static\nNORMFLAGS = -static\n#NORMFLAGS = -static-libgcc\n```\nIf I set switch  `NORMFLAGS = -static-libgcc` then on MacOSX 10.6.8 the spkg builds OK. It's a trivial matter to add an OS recognition to spkg-install and patch the said file if one happens to be on OSX.",
    "created_at": "2012-08-17T14:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152412",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@dimpase](#comment%3A2):
> `-static` is not supported on MacOSX. 

The file
`source/Makefile.configuration` contains lines

```
##for mac link libgcc not static
NORMFLAGS = -static
#NORMFLAGS = -static-libgcc
```
If I set switch  `NORMFLAGS = -static-libgcc` then on MacOSX 10.6.8 the spkg builds OK. It's a trivial matter to add an OS recognition to spkg-install and patch the said file if one happens to be on OSX.



---

archive/issue_comments_152413.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWinfried has also suggested to just remove this static option, I've updated the spkg and rewrote the installation script based on pyopenssl.",
    "created_at": "2012-10-22T05:23:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152413",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:4" align="right">comment:4</div>

Winfried has also suggested to just remove this static option, I've updated the spkg and rewrote the installation script based on pyopenssl.



---

archive/issue_events_182462.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-10-22T05:23:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182462"
}
```



---

archive/issue_events_182463.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-10-22T05:23:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182463"
}
```



---

archive/issue_comments_152414.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOK, it builds on MacOSX 10.6. (with Sage 5.4.rc0). However, if I try to use the provided in the spkg Macaulay2 package Normaliz, it does not seem to work. I  cd to the directory containing Normaliz.m2, start a standalone M2 version 1.4 within Sage shell, and then I get \n\n```\ni10 : installPackage \"Normaliz\"\nstdio:11:1:(3): error: makeDocumentTag: package cannot be determined: 'Normaliz'\nstdio:4:16-4:24: here is the first use of 'Normaliz'\n```\nI don't know enough M2 to know how to deal with it.\n\nEDIT: it could be that this just means that a version of Normaliz is already present in this instance of M2 (and indeed, it is). So just ignore this, I guess. We'll sort it out when M2 Sage spkg will be ready.",
    "created_at": "2012-10-22T07:19:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152414",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

OK, it builds on MacOSX 10.6. (with Sage 5.4.rc0). However, if I try to use the provided in the spkg Macaulay2 package Normaliz, it does not seem to work. I  cd to the directory containing Normaliz.m2, start a standalone M2 version 1.4 within Sage shell, and then I get 

```
i10 : installPackage "Normaliz"
stdio:11:1:(3): error: makeDocumentTag: package cannot be determined: 'Normaliz'
stdio:4:16-4:24: here is the first use of 'Normaliz'
```
I don't know enough M2 to know how to deal with it.

EDIT: it could be that this just means that a version of Normaliz is already present in this instance of M2 (and indeed, it is). So just ignore this, I guess. We'll sort it out when M2 Sage spkg will be ready.



---

archive/issue_events_182464.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-22T07:19:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182464"
}
```



---

archive/issue_events_182465.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-10-22T07:19:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182465"
}
```



---

archive/issue_comments_152415.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAs well, I don't know how to properly handle the Singular interface. Note that Normaliz provides an interface to Singular, in `src/Singular/normaliz.lib`.\n\nOn the other hand, Singular spkg provides `normaliz.lib` for version 2.7 of Normaliz.\n(Which is probably useless without Normaliz installed, and ought to be removed, but this is not for this ticket).\nI think one should make this spkg install `normaliz.lib` to its proper place in `$SAGE_LOCAL`.\n\nRegarding M2 support, it can wait, but this one definitely needs work. I'd be happy to have another look after this is implemented.",
    "created_at": "2012-10-22T08:03:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152415",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

As well, I don't know how to properly handle the Singular interface. Note that Normaliz provides an interface to Singular, in `src/Singular/normaliz.lib`.

On the other hand, Singular spkg provides `normaliz.lib` for version 2.7 of Normaliz.
(Which is probably useless without Normaliz installed, and ought to be removed, but this is not for this ticket).
I think one should make this spkg install `normaliz.lib` to its proper place in `$SAGE_LOCAL`.

Regarding M2 support, it can wait, but this one definitely needs work. I'd be happy to have another look after this is implemented.



---

archive/issue_comments_152416.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.",
    "created_at": "2012-10-24T02:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152416",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:7" align="right">comment:7</div>

It seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.



---

archive/issue_comments_152417.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@novoselt](#comment%3A7):\n> It seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.\n\nnot according to the following lines \n\n```\n@*Singular and Normaliz exchange data via files. These files are automatically\ncreated and erased behind the scenes. \n```\nin Singular/singular.lib\n\nSo it is not something independent.",
    "created_at": "2012-10-24T04:13:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152417",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@novoselt](#comment%3A7):
> It seems to me that M2 just wants to have normaliz executable during installation, the interface package is included in M2 and does not have to be installed from normaliz one. So far my goal was just to have normaliz in sage/local/bin, but I'll look at the Singular library as well. I suspect it may be independent of the rest of normaliz - it is quite a compact program.

not according to the following lines 

```
@*Singular and Normaliz exchange data via files. These files are automatically
created and erased behind the scenes. 
```
in Singular/singular.lib

So it is not something independent.



---

archive/issue_events_182466.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-02T03:15:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182466"
}
```



---

archive/issue_events_182467.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-02T03:15:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182467"
}
```



---

archive/issue_comments_152418.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAdded library copying - I misunderstood what was going on, I thought it was a library file as in \"objective code\", not \"Singular module\".",
    "created_at": "2012-12-02T03:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152418",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:9" align="right">comment:9</div>

Added library copying - I misunderstood what was going on, I thought it was a library file as in "objective code", not "Singular module".



---

archive/issue_events_182468.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-02T05:18:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182468"
}
```



---

archive/issue_events_182469.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-02T05:18:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182469"
}
```



---

archive/issue_comments_152419.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nafter installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.\n\n```\nsage: singular_console()\n                     SINGULAR                                 /  Development\n A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n                                                           0<\n by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\nFB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\n> LIB \"normaliz.lib\";\n// ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$\n> ring R=0,(x,y,z,t),dp;\n> ideal I=x^2,y^2,z^3;\n> list l=intclMonIdeal(I);\n> showNuminvs();\nhilbert_basis_elements : 2\nnumber_extreme_rays : 2\nrank : 2\nindex : 1\nnumber_support_hyperplanes : 2\nsize_triangulation : 1\nsum_dets : 1\ngraded : 1\ndegree_1_elements : 2\ngrading : 1,-1\ngrading_denom : 1\nmultiplicity : 1\nmultiplicity_denom : 1\nhilbert_series_num : 1\nhilbert_series_denom : 1,1\nprimary : 1\nideal_multiplicity : 2\n> \n```\nwhereas according to [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219) the output should be\n\n```\nshowNuminvs();\n==> hilbert_basis_elements : 9\n==> number_extreme_rays : 6\n==> rank : 4\n==> index : 1\n==> number_support_hyperplanes : 5\n==> homogeneous : 0\n==> primary : 1\n==> ideal_multiplicity : 12\n```",
    "created_at": "2012-12-02T05:18:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152419",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

after installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.

```
sage: singular_console()
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-5
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> LIB "normaliz.lib";
// ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$
> ring R=0,(x,y,z,t),dp;
> ideal I=x^2,y^2,z^3;
> list l=intclMonIdeal(I);
> showNuminvs();
hilbert_basis_elements : 2
number_extreme_rays : 2
rank : 2
index : 1
number_support_hyperplanes : 2
size_triangulation : 1
sum_dets : 1
graded : 1
degree_1_elements : 2
grading : 1,-1
grading_denom : 1
multiplicity : 1
multiplicity_denom : 1
hilbert_series_num : 1
hilbert_series_denom : 1,1
primary : 1
ideal_multiplicity : 2
> 
```
whereas according to [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219) the output should be

```
showNuminvs();
==> hilbert_basis_elements : 9
==> number_extreme_rays : 6
==> rank : 4
==> index : 1
==> number_support_hyperplanes : 5
==> homogeneous : 0
==> primary : 1
==> ideal_multiplicity : 12
```



---

archive/issue_comments_152420.json:
```json
{
    "body": "Attachment: **[t.in](https://github.com/sagemath/sage/files/ticket13234/t.in)**\n\nnormaliz input for (x<sup>2,y</sup>2,z^3)",
    "created_at": "2012-12-02T05:52:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152420",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[t.in](https://github.com/sagemath/sage/files/ticket13234/t.in)**

normaliz input for (x<sup>2,y</sup>2,z^3)



---

archive/issue_comments_152421.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nIf I try running normaliz directly on the input (roughly) corresponding to this example of the monomial ideal (see [attachment: t.in](https://github.com/sagemath/sage/files/ticket13234/t.in)), I  get results consistent with [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219), see the [attachment: t.out](https://github.com/sagemath/sage/files/ticket13234/t.out.gz). So this looks like an interface problem.",
    "created_at": "2012-12-02T05:58:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152421",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

If I try running normaliz directly on the input (roughly) corresponding to this example of the monomial ideal (see [attachment: t.in](https://github.com/sagemath/sage/files/ticket13234/t.in)), I  get results consistent with [Singular docs](http://www.singular.uni-kl.de/Manual/latest/sing_1143.htm#SEC1219), see the [attachment: t.out](https://github.com/sagemath/sage/files/ticket13234/t.out.gz). So this looks like an interface problem.



---

archive/issue_comments_152422.json:
```json
{
    "body": "normaliz output",
    "created_at": "2012-12-02T05:58:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152422",
    "user": "https://github.com/dimpase"
}
```

normaliz output



---

archive/issue_comments_152423.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAttachment: **[t.out.gz](https://github.com/sagemath/sage/files/ticket13234/t.out.gz)**\n\nI also noticed that some normaliz.lib functions are not working as advertised, e.g.\n\n```\n> startNmz();\n   ? open: Error for link _ of type: ASCII, mode: r, name: nmz_sing_exec.path\n   ? cannot read from `nmz_sing_exec.path`\n   ? error occurred in or before normaliz.lib::startNmz line 292: `    string s=read(inf); `\n   ? expected string-expression. type 'help string;'\n   ? leaving normaliz.lib::startNmz\n   skipping text from `;` error at token `)`\n```\ninstead of [this](http://www.singular.uni-kl.de/Manual/latest/sing_1154.htm#SEC1230). This is probably minor, as `normaliz` executable is found in the `PATH`.\nTo make it work I can do \n\n```\n> setNmzDataPath(\"/tmp/\");\n> setNmzFilename(\"blah\");\n> writeNmzPaths();\n> startNmz();\nnmz_exec_path not set\nnmz_data_path is /tmp/\n```\nIf I then try the Singular input as above to compute \n`intclMonIdeal(I)` I can see that the files `/tmp/blah.*` created do not make sense. E.g. `/tmp/blah.in` is as follows:\n\n```\n1\n1\n2 \n3\n```\nwhich makes little sense.\n\nI would not be surprised if this is an upstream (i.e. `normaliz`) bug.",
    "created_at": "2012-12-02T06:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152423",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Attachment: **[t.out.gz](https://github.com/sagemath/sage/files/ticket13234/t.out.gz)**

I also noticed that some normaliz.lib functions are not working as advertised, e.g.

```
> startNmz();
   ? open: Error for link _ of type: ASCII, mode: r, name: nmz_sing_exec.path
   ? cannot read from `nmz_sing_exec.path`
   ? error occurred in or before normaliz.lib::startNmz line 292: `    string s=read(inf); `
   ? expected string-expression. type 'help string;'
   ? leaving normaliz.lib::startNmz
   skipping text from `;` error at token `)`
```
instead of [this](http://www.singular.uni-kl.de/Manual/latest/sing_1154.htm#SEC1230). This is probably minor, as `normaliz` executable is found in the `PATH`.
To make it work I can do 

```
> setNmzDataPath("/tmp/");
> setNmzFilename("blah");
> writeNmzPaths();
> startNmz();
nmz_exec_path not set
nmz_data_path is /tmp/
```
If I then try the Singular input as above to compute 
`intclMonIdeal(I)` I can see that the files `/tmp/blah.*` created do not make sense. E.g. `/tmp/blah.in` is as follows:

```
1
1
2 
3
```
which makes little sense.

I would not be surprised if this is an upstream (i.e. `normaliz`) bug.



---

archive/issue_comments_152424.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@dimpase](#comment%3A10):\n> after installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.\n> \n> ```\n> sage: singular_console()\n>                      SINGULAR                                 /  Development\n>  A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n>                                                            0<\n>  by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\n> FB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\n> > LIB \"normaliz.lib\";\n> // ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$\n> > ring R=0,(x,y,z,t),dp;\n> ```\n\nIf I rather set  `ring R=0,(x,y,z),dp;` then the result is consistent with Singular's manual. So this looks like a documentation bug rather than anything more serious.",
    "created_at": "2012-12-02T08:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152424",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@dimpase](#comment%3A10):
> after installing the spkg, one can call `normaliz` from Sage's `singular_console()`, (or just as `sage -singular` --- the results are the same) but results don't always make sense. E.g.
> 
> ```
> sage: singular_console()
>                      SINGULAR                                 /  Development
>  A Computer Algebra System for Polynomial Computations       /   version 3-1-5
>                                                            0<
>  by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
> FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> > LIB "normaliz.lib";
> // ** loaded /usr/local/src/sage/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$
> > ring R=0,(x,y,z,t),dp;
> ```

If I rather set  `ring R=0,(x,y,z),dp;` then the result is consistent with Singular's manual. So this looks like a documentation bug rather than anything more serious.



---

archive/issue_comments_152425.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2012-12-02T16:43:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152425",
    "user": "https://github.com/dimpase"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_152426.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI've added a patched based on the file sent to me by Christof S\u00f6ger. Now I am getting\n\n```\n                     SINGULAR                                 /  Development\n A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n                                                           0<\n by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\nFB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\n> LIB \"normaliz.lib\";\n// ** loaded /home/novoselt/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$\n> ring R=0,(x,y,z,t),dp;\n> ideal I=x^2,y^2,z^3;\n> list l=intclMonIdeal(I);\nNo grading specified and cannot find one. Disabling some computations!\n> showNuminvs();\nhilbert_basis_elements : 9\nnumber_extreme_rays : 6\nrank : 4\nindex : 1\nnumber_support_hyperplanes : 5\nsize_triangulation : 3\nsum_dets : 7\ngraded : 0\nprimary : 1\nideal_multiplicity : 12\n> \n```\nwhich seems to be consistent with Singular manual.",
    "created_at": "2012-12-03T02:39:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152426",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:15" align="right">comment:15</div>

I've added a patched based on the file sent to me by Christof SÃ¶ger. Now I am getting

```
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-5
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> LIB "normaliz.lib";
// ** loaded /home/novoselt/sage-5.5.rc0/local/share/singular/normaliz.lib $Id$
> ring R=0,(x,y,z,t),dp;
> ideal I=x^2,y^2,z^3;
> list l=intclMonIdeal(I);
No grading specified and cannot find one. Disabling some computations!
> showNuminvs();
hilbert_basis_elements : 9
number_extreme_rays : 6
rank : 4
index : 1
number_support_hyperplanes : 5
size_triangulation : 3
sum_dets : 7
graded : 0
primary : 1
ideal_multiplicity : 12
> 
```
which seems to be consistent with Singular manual.



---

archive/issue_events_182470.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-03T02:39:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182470"
}
```



---

archive/issue_events_182471.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2012-12-03T02:39:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182471"
}
```



---

archive/issue_comments_152427.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2012-12-03T02:39:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152427",
    "user": "https://github.com/novoselt"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_152428.json:
```json
{
    "body": "Attachment: **[spkg-install.gz](https://github.com/sagemath/sage/files/ticket13234/spkg-install.gz)**\n\nFor reviewing only",
    "created_at": "2012-12-03T02:40:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152428",
    "user": "https://github.com/novoselt"
}
```

Attachment: **[spkg-install.gz](https://github.com/sagemath/sage/files/ticket13234/spkg-install.gz)**

For reviewing only



---

archive/issue_comments_152429.json:
```json
{
    "body": "For reviewing only",
    "created_at": "2012-12-03T02:40:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152429",
    "user": "https://github.com/novoselt"
}
```

For reviewing only



---

archive/issue_comments_152430.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[01-adjust-size-of-input-matrix-fix.patch.gz](https://github.com/sagemath/sage/files/ticket13234/01-adjust-size-of-input-matrix-fix.patch.gz)**\n\nOK, good - but could you please bump up the version to 2.8.p0, as this is not vanilla upstream.",
    "created_at": "2012-12-03T11:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152430",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[01-adjust-size-of-input-matrix-fix.patch.gz](https://github.com/sagemath/sage/files/ticket13234/01-adjust-size-of-input-matrix-fix.patch.gz)**

OK, good - but could you please bump up the version to 2.8.p0, as this is not vanilla upstream.



---

archive/issue_events_182472.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-03T11:55:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182472"
}
```



---

archive/issue_events_182473.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2012-12-03T11:55:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182473"
}
```



---

archive/issue_comments_152431.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI've made the spkg bumped up version (linked in the ticket description).",
    "created_at": "2012-12-03T11:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152431",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

I've made the spkg bumped up version (linked in the ticket description).



---

archive/issue_comments_152432.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.\n \n-http://sage.math.washington.edu/home/novoselt/normaliz-2.8.spkg\n+Install the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)\n``````\n",
    "created_at": "2012-12-03T11:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152432",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Normaliz http://www.mathematik.uni-osnabrueck.de/normaliz/ is one of the dependencies of Macaulay2 (which is also an optional package), but can be of interest on its own as well.
 
-http://sage.math.washington.edu/home/novoselt/normaliz-2.8.spkg
+Install the spkg from [here](http://sage.math.washington.edu/home/dima/packages/normaliz-2.8.p0.spkg)
``````




---

archive/issue_comments_152433.json:
```json
{
    "body": "Reviewer: **Dmitrii Pasechnik**",
    "created_at": "2012-12-03T11:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152433",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dmitrii Pasechnik**



---

archive/issue_comments_152434.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThank you for a thorough review and quick responses despite my long pauses, it was a good spkg-exercise for me!",
    "created_at": "2012-12-03T17:40:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152434",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:18" align="right">comment:18</div>

Thank you for a thorough review and quick responses despite my long pauses, it was a good spkg-exercise for me!



---

archive/issue_events_182474.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T11:26:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182474"
}
```



---

archive/issue_events_182475.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T11:26:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182475"
}
```



---

archive/issue_comments_152435.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI just copied the spkg into the \"optional\" subdir on the server and mirrors.",
    "created_at": "2012-12-18T14:35:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152435",
    "user": "https://github.com/haraldschilly"
}
```

<div id="comment:20" align="right">comment:20</div>

I just copied the spkg into the "optional" subdir on the server and mirrors.



---

archive/issue_comments_152436.json:
```json
{
    "body": "Merged: **sage-5.6.beta0**",
    "created_at": "2012-12-18T14:54:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/13234#issuecomment-152436",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.6.beta0**



---

archive/issue_events_182476.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T14:54:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182476"
}
```



---

archive/issue_events_182477.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-18T14:54:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/13234",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/13234#event-182477"
}
```
