# Issue 16786: Adding width() function to poset

archive/issues_016786.json:
```json
{
    "body": "CC:  ncohen\n\nAdd a `.widht()` -- i.e. number of elements in the longest antichain -- to poset. Seems to have polynomial time algorithm based on Dilworth's Theorem.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17023\n\n",
    "created_at": "2014-09-21T05:54:08Z",
    "labels": [
        "combinatorics",
        "minor",
        "enhancement"
    ],
    "title": "Adding width() function to poset",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16786",
    "user": "jmantysalo"
}
```
CC:  ncohen

Add a `.widht()` -- i.e. number of elements in the longest antichain -- to poset. Seems to have polynomial time algorithm based on Dilworth's Theorem.

Issue created by migration from https://trac.sagemath.org/ticket/17023





---

archive/issue_comments_222056.json:
```json
{
    "body": "I am writing this code right now.",
    "created_at": "2014-09-21T10:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222056",
    "user": "ncohen"
}
```

I am writing this code right now.



---

archive/issue_comments_222057.json:
```json
{
    "body": "Fast catch! So there is no function for maximum match at graphs available for wrapping?",
    "created_at": "2014-09-21T11:23:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222057",
    "user": "jmantysalo"
}
```

Fast catch! So there is no function for maximum match at graphs available for wrapping?



---

archive/issue_comments_222058.json:
```json
{
    "body": "> Fast catch! So there is no function for maximum match at graphs available for wrapping?\n\nThere is, but I want to do the job properly.\n\nYou can get the width with `len(Graph(your_poset.hasse_diagram().transitive_closure()).independent_set())` in the meantime.\n\nNathann",
    "created_at": "2014-09-21T11:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222058",
    "user": "ncohen"
}
```

> Fast catch! So there is no function for maximum match at graphs available for wrapping?

There is, but I want to do the job properly.

You can get the width with `len(Graph(your_poset.hasse_diagram().transitive_closure()).independent_set())` in the meantime.

Nathann



---

archive/issue_comments_222059.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-21T11:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222059",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_222060.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-21T11:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222060",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_222061.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-21T12:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222061",
    "user": "jmantysalo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_222062.json:
```json
{
    "body": "If `height()` has description \"Return the height (number of elements in the longest chain) of the poset.\", then I think that this should have\n\n\"Return the height (number of elements in the longest antichain) of the poset.\n\nFor information about algorithm, see :wikipedia:`Dilworth's_theorem`.\"\n\nBecause Dilworth's theorem is not really part of function definition but an implementation detail.",
    "created_at": "2014-09-21T12:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222062",
    "user": "jmantysalo"
}
```

If `height()` has description "Return the height (number of elements in the longest chain) of the poset.", then I think that this should have

"Return the height (number of elements in the longest antichain) of the poset.

For information about algorithm, see :wikipedia:`Dilworth's_theorem`."

Because Dilworth's theorem is not really part of function definition but an implementation detail.



---

archive/issue_comments_222063.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-21T12:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222063",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_222064.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-21T12:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222064",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_222065.json:
```json
{
    "body": "Seems to work. I checked extreme cases: empty poset, one-element poset, chains and antichains, all poset of size n up to n=7 and few thousand random posets with varying parameters.\n\nReading code is propably best done with someone wiser than I am.\n\nOne line descriptions should have a dot at the end, because they are full sentences.",
    "created_at": "2014-09-21T15:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222065",
    "user": "jmantysalo"
}
```

Seems to work. I checked extreme cases: empty poset, one-element poset, chains and antichains, all poset of size n up to n=7 and few thousand random posets with varying parameters.

Reading code is propably best done with someone wiser than I am.

One line descriptions should have a dot at the end, because they are full sentences.



---

archive/issue_comments_222066.json:
```json
{
    "body": "Hello,\n\nI made a few little changes. Not a review, sorry.\n----\nNew commits:",
    "created_at": "2014-09-24T18:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222066",
    "user": "chapoton"
}
```

Hello,

I made a few little changes. Not a review, sorry.
----
New commits:



---

archive/issue_comments_222067.json:
```json
{
    "body": "About \"return\" vs. \"returns\" on documentation: at least http://legacy.python.org/dev/peps/pep-0008/#documentation-strings shows example with \"return\". There was also some discussion about this at sage-devel -list at last month. Hence I think that Nathan's code follows style manual.",
    "created_at": "2014-09-25T05:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222067",
    "user": "jmantysalo"
}
```

About "return" vs. "returns" on documentation: at least http://legacy.python.org/dev/peps/pep-0008/#documentation-strings shows example with "return". There was also some discussion about this at sage-devel -list at last month. Hence I think that Nathan's code follows style manual.



---

archive/issue_comments_222068.json:
```json
{
    "body": "I did some timings. It seems that for something like `P=Posets.RandomPoset(100,0.15)` or so it is faster to run `max(len(x) for x in P.antichains())` than `P.width()`. On the other hand the measured complexity of `.width()` seems to be polynomial as it should.\n\nI will do more test on faster computer, this was done quickly with an oooold machine.",
    "created_at": "2014-09-25T05:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222068",
    "user": "jmantysalo"
}
```

I did some timings. It seems that for something like `P=Posets.RandomPoset(100,0.15)` or so it is faster to run `max(len(x) for x in P.antichains())` than `P.width()`. On the other hand the measured complexity of `.width()` seems to be polynomial as it should.

I will do more test on faster computer, this was done quickly with an oooold machine.



---

archive/issue_comments_222069.json:
```json
{
    "body": "How fast is `connected_components()` on graphs? Because this can be done simply by summing widths of connected subposets.\n\nIf posets are more \"chain-like\", then simply looking antichains seems to be faster. For posets more \"antichain-like\" it is much faster to use this new `.width()` method. Where is the turning point? Can there be some heuristic based on ratio of number of edges to number of vertices?",
    "created_at": "2014-09-25T07:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222069",
    "user": "jmantysalo"
}
```

How fast is `connected_components()` on graphs? Because this can be done simply by summing widths of connected subposets.

If posets are more "chain-like", then simply looking antichains seems to be faster. For posets more "antichain-like" it is much faster to use this new `.width()` method. Where is the turning point? Can there be some heuristic based on ratio of number of edges to number of vertices?



---

archive/issue_comments_222070.json:
```json
{
    "body": "> About \"return\" vs. \"returns\" on documentation: at least http://legacy.python.org/dev/peps/pep-0008/#documentation-strings shows example with \"return\". There was also some discussion about this at sage-devel -list at last month. Hence I think that Nathan's code follows style manual.\n\nI think that it follows manual, for not so long ago one of my patches was set to 'needs_work' because I wrote \"returns\" instead of \"return\". I do not care if the convention changes at every review for as long as I am not the one who writes the commits.\n\nNathann",
    "created_at": "2014-09-25T08:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222070",
    "user": "ncohen"
}
```

> About "return" vs. "returns" on documentation: at least http://legacy.python.org/dev/peps/pep-0008/#documentation-strings shows example with "return". There was also some discussion about this at sage-devel -list at last month. Hence I think that Nathan's code follows style manual.

I think that it follows manual, for not so long ago one of my patches was set to 'needs_work' because I wrote "returns" instead of "return". I do not care if the convention changes at every review for as long as I am not the one who writes the commits.

Nathann



---

archive/issue_comments_222071.json:
```json
{
    "body": "> I did some timings. It seems that for something like `P=Posets.RandomPoset(100,0.15)` or so it is faster to run `max(len(x) for x in P.antichains())` than `P.width()`. On the other hand the measured complexity of `.width()` seems to be polynomial as it should.\n\nSeems that random posets have a very very small width `O_o`\n\nNathann",
    "created_at": "2014-09-25T08:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222071",
    "user": "ncohen"
}
```

> I did some timings. It seems that for something like `P=Posets.RandomPoset(100,0.15)` or so it is faster to run `max(len(x) for x in P.antichains())` than `P.width()`. On the other hand the measured complexity of `.width()` seems to be polynomial as it should.

Seems that random posets have a very very small width `O_o`

Nathann



---

archive/issue_comments_222072.json:
```json
{
    "body": "Replying to [comment:16 ncohen]:\n\n> Seems that random posets have a very very small width `O_o`\n\nActually this has been thinked already. Brinkmann & McKay says at the end of paper Posets on up to 16 points \"Our results do not show this behaviour, emphasizing again that the convergence of posets to their asymptotic behaviour is quite slow.\" Hence no help from that.",
    "created_at": "2014-09-25T08:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222072",
    "user": "jmantysalo"
}
```

Replying to [comment:16 ncohen]:

> Seems that random posets have a very very small width `O_o`

Actually this has been thinked already. Brinkmann & McKay says at the end of paper Posets on up to 16 points "Our results do not show this behaviour, emphasizing again that the convergence of posets to their asymptotic behaviour is quite slow." Hence no help from that.



---

archive/issue_comments_222073.json:
```json
{
    "body": "Hello !\n\n> How fast is `connected_components()` on graphs? Because this can be done simply by summing widths of connected subposets.\n\nWhat do you mean ? If the poset is not connected you can indeed split it and compute the result on each connected components but I don't think the code I implemented will run any faster because of that. It would decrease the number of antichains though. But add an element superior to all others in your posets and you lost connectivity for the very same width.\n\n> If posets are more \"chain-like\", then simply looking antichains seems to be faster. For posets more \"antichain-like\" it is much faster to use this new `.width()` method. Where is the turning point? Can there be some heuristic based on ratio of number of edges to number of vertices?\n\nWell, maybe there is some algorithm to recognize posets with width <=2. And we already have a `is_chain` for width 1. Also, I think that something like \n\n```\nlen(Graph(posets.ChainPoset(6).hasse_diagram().transitive_closure()).independent_set())\n```\n\nshould be a bit faster than enumerating the antichains. Even though enumerating the antichains may be faster for very very line-looking posets, for you don't have any graphs to copy around, ...\n\nNathann",
    "created_at": "2014-09-25T08:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222073",
    "user": "ncohen"
}
```

Hello !

> How fast is `connected_components()` on graphs? Because this can be done simply by summing widths of connected subposets.

What do you mean ? If the poset is not connected you can indeed split it and compute the result on each connected components but I don't think the code I implemented will run any faster because of that. It would decrease the number of antichains though. But add an element superior to all others in your posets and you lost connectivity for the very same width.

> If posets are more "chain-like", then simply looking antichains seems to be faster. For posets more "antichain-like" it is much faster to use this new `.width()` method. Where is the turning point? Can there be some heuristic based on ratio of number of edges to number of vertices?

Well, maybe there is some algorithm to recognize posets with width <=2. And we already have a `is_chain` for width 1. Also, I think that something like 

```
len(Graph(posets.ChainPoset(6).hasse_diagram().transitive_closure()).independent_set())
```

should be a bit faster than enumerating the antichains. Even though enumerating the antichains may be faster for very very line-looking posets, for you don't have any graphs to copy around, ...

Nathann



---

archive/issue_comments_222074.json:
```json
{
    "body": "You are right, on average connected posets are far more common than non-connected. Hence this should be like it now is.\n\nDuh, should I try to understand theorem and read the code...",
    "created_at": "2014-09-25T12:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222074",
    "user": "jmantysalo"
}
```

You are right, on average connected posets are far more common than non-connected. Hence this should be like it now is.

Duh, should I try to understand theorem and read the code...



---

archive/issue_comments_222075.json:
```json
{
    "body": "I read the code. As a side not, almost all examples use \"P =\", you have used \"p =\".\n\nBut as far as I can say, code seems to do what it should. I think this could be marked as positive review after trivial modifications like \"returns\" vs. \"return\".",
    "created_at": "2014-09-26T10:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222075",
    "user": "jmantysalo"
}
```

I read the code. As a side not, almost all examples use "P =", you have used "p =".

But as far as I can say, code seems to do what it should. I think this could be marked as positive review after trivial modifications like "returns" vs. "return".



---

archive/issue_comments_222076.json:
```json
{
    "body": "> I read the code. As a side not, almost all examples use \"P =\", you have used \"p =\".\n\nPleaaaaaase let's not have a rule about upper/lower case `T_T`\n\n> But as far as I can say, code seems to do what it should. I think this could be marked as positive review after trivial modifications like \"returns\" vs. \"return\".\n\nFr\u00e9d\u00e9ric ? Could you remove the 's' you added ?\n\nNathann",
    "created_at": "2014-09-26T13:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222076",
    "user": "ncohen"
}
```

> I read the code. As a side not, almost all examples use "P =", you have used "p =".

Pleaaaaaase let's not have a rule about upper/lower case `T_T`

> But as far as I can say, code seems to do what it should. I think this could be marked as positive review after trivial modifications like "returns" vs. "return".

Frédéric ? Could you remove the 's' you added ?

Nathann



---

archive/issue_comments_222077.json:
```json
{
    "body": "I think the `s` in the list of methods should stay there for coherence of this list.\n\nAs there is no `s` in the first line of the new functions, things are good as they are.\n\nLGTM. Let us not lose time on stupid things.",
    "created_at": "2014-09-26T18:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222077",
    "user": "chapoton"
}
```

I think the `s` in the list of methods should stay there for coherence of this list.

As there is no `s` in the first line of the new functions, things are good as they are.

LGTM. Let us not lose time on stupid things.



---

archive/issue_comments_222078.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-26T18:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222078",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_222079.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-15T18:12:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16786#issuecomment-222079",
    "user": "vbraun"
}
```

Resolution: fixed
