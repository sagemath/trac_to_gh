# Issue 29046: tox.ini: Add test environments using LXC

Issue created by migration from https://trac.sagemath.org/ticket/29283

Original creator: mkoeppe

Original creation time: 2020-03-06 02:23:06

CC:  dimpase novoselt tmonteil

This would be in addition to the existing test environments that use Docker.

https://us.images.linuxcontainers.org/



---

Comment by mkoeppe created at 2021-06-27 23:55:20


```
tox -e lxc-ubuntu-trusty-standard
lxc-ubuntu-trusty-standard run-test-pre: PYTHONHASHSEED='3914799934'
lxc-ubuntu-trusty-standard run-test: commands[0] | bash -c 'echo Now do something like.... lxc-create --template download --name sage-lxc-ubuntu-trusty-standard -- --dist ubuntu --release trusty --arch amd64 ..... not implemented!'
Now do something like.... lxc-create --template download --name sage-lxc-ubuntu-trusty-standard -- --dist ubuntu --release trusty --arch amd64 ..... not implemented!
______________________________________________________________________ summary ______________________________________________________________________
  lxc-ubuntu-trusty-standard: commands succeeded
```


----
New commits:


---

Comment by mkoeppe created at 2021-09-17 17:31:50

This ticket needs help by people who have experience with lxc.


---

Comment by novoselt created at 2021-09-17 17:52:44

I have some experience as [SageMathCell](SageMathCell) uses LXC, this is the script that builds Sage inside containers:
https://github.com/sagemath/sagecell/blob/master/contrib/vm/container_manager.py
I am not clear however what is needed on this ticket.


---

Comment by mkoeppe created at 2021-09-17 17:56:39

I hope to replicate what is described in https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-docker-based-build-testing-using-tox using LXC instead of Docker client.


---

Comment by dimpase created at 2021-09-18 09:41:39

For one, lxc/lxd on the host should be configured to allow non-root to install new containers. Then, in principle, it should be non-problematic: install containers, login to the container, install packages and Sage there, run tests. A bit unclear how to get results out.


---

Comment by git created at 2021-09-18 17:32:35

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2021-09-18 17:34:09

Rebased on current beta
