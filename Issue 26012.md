# Issue 26012: port Sage to FreeBSD 12

archive/issues_026012.json:
```json
{
    "body": "CC:  @mkoeppe\n\nIn FreeBSD 12 the long-standing incompleteness of its libm has been helped. This simplifies a lot, compared to #22679.\n\nWe will not try to work around the toolchain [problem related to gfortran/libgcc_s](https://wiki.freebsd.org/libgcc%20problem). Instead, we just [add a line](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=208120#c14) at the end of `/etc/libmap.conf` as\nfollows:\n\n```\nlibgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/26249\n\n",
    "created_at": "2018-09-11T16:03:18Z",
    "labels": [
        "component: porting: bsd"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-pending",
    "title": "port Sage to FreeBSD 12",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26012",
    "user": "https://github.com/dimpase"
}
```
CC:  @mkoeppe

In FreeBSD 12 the long-standing incompleteness of its libm has been helped. This simplifies a lot, compared to #22679.

We will not try to work around the toolchain [problem related to gfortran/libgcc_s](https://wiki.freebsd.org/libgcc%20problem). Instead, we just [add a line](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=208120#c14) at the end of `/etc/libmap.conf` as
follows:

```
libgcc_s.so.1 /usr/local/lib/gcc7/libgcc_s.so.1
```

Issue created by migration from https://trac.sagemath.org/ticket/26249





---

archive/issue_events_065339.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-21T17:46:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26012#event-65339"
}
```



---

archive/issue_comments_366406.json:
```json
{
    "body": "This scipy [problem](https://trac.sagemath.org/ticket/22679#comment:93) is still there.\n(while this works with the system's python2)\nIt's a matter of comparing the patches used there with what we do in Sage. Perhaps they disable multithreading...",
    "created_at": "2018-11-28T14:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366406",
    "user": "https://github.com/dimpase"
}
```

This scipy [problem](https://trac.sagemath.org/ticket/22679#comment:93) is still there.
(while this works with the system's python2)
It's a matter of comparing the patches used there with what we do in Sage. Perhaps they disable multithreading...



---

archive/issue_comments_366407.json:
```json
{
    "body": "I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.",
    "created_at": "2018-11-29T09:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366407",
    "user": "https://github.com/embray"
}
```

I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.



---

archive/issue_comments_366408.json:
```json
{
    "body": "Replying to [comment:12 embray]:\n> I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything. I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.\n\n\nI can give you access to the FreeBSD 12.0 VM I am running on GCE, this would be easier, I guess. (12.0 is still in beta/RC cycle, so installation is not straightforward, you basically need to build it from source).",
    "created_at": "2018-11-29T10:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366408",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:12 embray]:
> I'm currently overextended as always and don't have any deep personal motivation to work on FreeBSD support, but I would definitely like to have it if we can so if there's anything. I can help with here I'll make a FreeBSD 12 VM so I can have it to play around on.


I can give you access to the FreeBSD 12.0 VM I am running on GCE, this would be easier, I guess. (12.0 is still in beta/RC cycle, so installation is not straightforward, you basically need to build it from source).



---

archive/issue_comments_366409.json:
```json
{
    "body": "currently testing what we have here (with Sage 8.6) on the released FreeBSD 12.0",
    "created_at": "2019-01-20T22:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366409",
    "user": "https://github.com/dimpase"
}
```

currently testing what we have here (with Sage 8.6) on the released FreeBSD 12.0



---

archive/issue_comments_366410.json:
```json
{
    "body": "the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299\n(pyexpat module does not build)",
    "created_at": "2019-02-10T09:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366410",
    "user": "https://github.com/dimpase"
}
```

the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299
(pyexpat module does not build)



---

archive/issue_comments_366411.json:
```json
{
    "body": "Replying to [comment:15 dimpase]:\n> the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299\n> (pyexpat module does not build)\n\n\nfor the time being, working around this by not installing setuptools and pip for py3",
    "created_at": "2019-02-11T09:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366411",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:15 dimpase]:
> the next issue we hit is Python3 on Sage 8.7.beta3: https://bugs.python.org/issue6299
> (pyexpat module does not build)


for the time being, working around this by not installing setuptools and pip for py3



---

archive/issue_events_065340.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-03T16:16:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26012#event-65340"
}
```



---

archive/issue_events_065341.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-05-03T16:16:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26012#event-65341"
}
```



---

archive/issue_comments_366412.json:
```json
{
    "body": "As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366412",
    "user": "https://github.com/embray"
}
```

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_events_065342.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:54:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26012#event-65342"
}
```



---

archive/issue_events_065343.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-08-31T21:37:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26012#event-65343"
}
```



---

archive/issue_comments_366413.json:
```json
{
    "body": "to use flang (which is a possibility on FreeBSD at least), one needs\n\n```diff\n--- a/build/pkgs/numpy/spkg-install\n+++ b/build/pkgs/numpy/spkg-install\n@@ -18,7 +18,7 @@ export FFLAGS=\"$FFLAGS -fPIC\"\n export FCFLAGS=\"$FCFLAGS -fPIC\"\n \n export NUMPY_FCONFIG=\"config_fc --noopt --noarch\"\n-\n+export LDFLAGS=\"$LDFLAGS -lexecinfo\" # needed for flang\n ################################################\n \n sage-python23 setup.py \\\n```\ndue to it being somewhat underlinked.",
    "created_at": "2019-08-31T21:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366413",
    "user": "https://github.com/dimpase"
}
```

to use flang (which is a possibility on FreeBSD at least), one needs

```diff
--- a/build/pkgs/numpy/spkg-install
+++ b/build/pkgs/numpy/spkg-install
@@ -18,7 +18,7 @@ export FFLAGS="$FFLAGS -fPIC"
 export FCFLAGS="$FCFLAGS -fPIC"
 
 export NUMPY_FCONFIG="config_fc --noopt --noarch"
-
+export LDFLAGS="$LDFLAGS -lexecinfo" # needed for flang
 ################################################
 
 sage-python23 setup.py \
```
due to it being somewhat underlinked.



---

archive/issue_comments_366414.json:
```json
{
    "body": "As I have to abandon the FreeBSD VM I've been using, I've pushed the current WIP branch\nto https://github.com/lwhsu/sagemath/commits/wip31082019\n\nTBC on another FreeBSD machine.",
    "created_at": "2019-08-31T21:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366414",
    "user": "https://github.com/dimpase"
}
```

As I have to abandon the FreeBSD VM I've been using, I've pushed the current WIP branch
to https://github.com/lwhsu/sagemath/commits/wip31082019

TBC on another FreeBSD machine.



---

archive/issue_comments_366415.json:
```json
{
    "body": "A work-in-progress has been submitted to the FreeBSD Phabricator:\n\nhttps://reviews.freebsd.org/D24195\n\nIts aim is to upgrade the existing port to 9.0.\n\nDo not hesitate to comment or modify!",
    "created_at": "2020-03-26T16:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366415",
    "user": "https://github.com/thierry-FreeBSD"
}
```

A work-in-progress has been submitted to the FreeBSD Phabricator:

https://reviews.freebsd.org/D24195

Its aim is to upgrade the existing port to 9.0.

Do not hesitate to comment or modify!



---

archive/issue_comments_366416.json:
```json
{
    "body": "I think it'd be much better to use the work done on \n#27330 - you don't even need to build a special Python version, but use one on the system!\n(And, of course, use autoconf, don't mess around with generated ./configure)",
    "created_at": "2020-03-26T17:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366416",
    "user": "https://github.com/dimpase"
}
```

I think it'd be much better to use the work done on 
#27330 - you don't even need to build a special Python version, but use one on the system!
(And, of course, use autoconf, don't mess around with generated ./configure)



---

archive/issue_comments_366417.json:
```json
{
    "body": "I used the external packages when this is possible with the released Sage 9.0. This version still builds the bundled Python. I guess that the progress done with #27330 will be available in the next release?\n\nThanks for your comment, I'll try to use autoconf.",
    "created_at": "2020-03-26T17:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366417",
    "user": "https://github.com/thierry-FreeBSD"
}
```

I used the external packages when this is possible with the released Sage 9.0. This version still builds the bundled Python. I guess that the progress done with #27330 will be available in the next release?

Thanks for your comment, I'll try to use autoconf.



---

archive/issue_comments_366418.json:
```json
{
    "body": "A large part of #27330 is already in 9.0.\nBut yes, I think it's much better to wait for 9.1, or actually start using 9.1.betas \n(we're near the first release candidate).\n\nIIRC FreeBSD has quite a few packages available, although they aren't always built\nwith pre-reqs needed for Sage, e.g. Flint is not built with NTL support.",
    "created_at": "2020-03-26T17:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366418",
    "user": "https://github.com/dimpase"
}
```

A large part of #27330 is already in 9.0.
But yes, I think it's much better to wait for 9.1, or actually start using 9.1.betas 
(we're near the first release candidate).

IIRC FreeBSD has quite a few packages available, although they aren't always built
with pre-reqs needed for Sage, e.g. Flint is not built with NTL support.



---

archive/issue_comments_366419.json:
```json
{
    "body": "Great! I'll try to work on 9.1 ASAP.\n\nYou are right about Flint: the ports used Cmake, and the NTL option is not available in CMakeLists.txt (and it is not even enabled by default with configure).\n\nBut we can change that, and I just sent a PR to fix it:\n\nhttps://bugs.freebsd.org/bugzilla/show_bug.cgi?id=245085",
    "created_at": "2020-03-26T21:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366419",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Great! I'll try to work on 9.1 ASAP.

You are right about Flint: the ports used Cmake, and the NTL option is not available in CMakeLists.txt (and it is not even enabled by default with configure).

But we can change that, and I just sent a PR to fix it:

https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=245085



---

archive/issue_comments_366420.json:
```json
{
    "body": "And I just added a port for Cliquer, from your autotoolized version:\n\nhttps://www.freshports.org/math/cliquer/",
    "created_at": "2020-03-27T15:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366420",
    "user": "https://github.com/thierry-FreeBSD"
}
```

And I just added a port for Cliquer, from your autotoolized version:

https://www.freshports.org/math/cliquer/



---

archive/issue_comments_366421.json:
```json
{
    "body": "Thanks. I suggest that every Sage library/package mentioned in #27330 be made a FreeBSD port (some of them are), this should be enough to finish this task.\n\nWe have plans to turn Sage into a \"normal\" pip-installable Python library, but this probably won't happen before the end of the year.",
    "created_at": "2020-03-28T03:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366421",
    "user": "https://github.com/dimpase"
}
```

Thanks. I suggest that every Sage library/package mentioned in #27330 be made a FreeBSD port (some of them are), this should be enough to finish this task.

We have plans to turn Sage into a "normal" pip-installable Python library, but this probably won't happen before the end of the year.



---

archive/issue_comments_366422.json:
```json
{
    "body": "I recently also added eclib, m4ri, gf2x, gp2c and the Pari packages (elldata, galdata, galpol, nftables and seadata).\n\nAnd still going on!",
    "created_at": "2020-03-28T19:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366422",
    "user": "https://github.com/thierry-FreeBSD"
}
```

I recently also added eclib, m4ri, gf2x, gp2c and the Pari packages (elldata, galdata, galpol, nftables and seadata).

And still going on!



---

archive/issue_comments_366423.json:
```json
{
    "body": "Some news: I have just updated the WIP-port to 9.1.beta9: it is available at\nhttps://reviews.freebsd.org/D24195\n\nEvery possible packages listed in #27330 are used as external packages, thanks for that!\n\nUnfortunately, there remain some problems, mostly caused by staging (DESTDIR): a lot of libraries are referring to the directory where they have been built: e.g.\n\nError: 'lib/python3.7/site-packages/PIL/_imagingft.so' is referring to /usr/ports/math/sage/work/stage\nError: 'lib/libldl.so.2.2.6' is referring to /usr/ports/math/sage/work/stage\n\nIs there some possibility to let them refer to relative directories?\nHow would you set SAGE_LOCAL?",
    "created_at": "2020-04-08T10:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366423",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Some news: I have just updated the WIP-port to 9.1.beta9: it is available at
https://reviews.freebsd.org/D24195

Every possible packages listed in #27330 are used as external packages, thanks for that!

Unfortunately, there remain some problems, mostly caused by staging (DESTDIR): a lot of libraries are referring to the directory where they have been built: e.g.

Error: 'lib/python3.7/site-packages/PIL/_imagingft.so' is referring to /usr/ports/math/sage/work/stage
Error: 'lib/libldl.so.2.2.6' is referring to /usr/ports/math/sage/work/stage

Is there some possibility to let them refer to relative directories?
How would you set SAGE_LOCAL?



---

archive/issue_comments_366424.json:
```json
{
    "body": "To be more precise: I have played with SAGE_LOCAL and SAGE_DESTDIR.\n\nThe logical choice seemed to set SAGE_LOCAL=$PREFIX and SAGE_DESTDIR=$STAGEDIR, but this is not the case.",
    "created_at": "2020-04-10T16:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366424",
    "user": "https://github.com/thierry-FreeBSD"
}
```

To be more precise: I have played with SAGE_LOCAL and SAGE_DESTDIR.

The logical choice seemed to set SAGE_LOCAL=$PREFIX and SAGE_DESTDIR=$STAGEDIR, but this is not the case.



---

archive/issue_comments_366425.json:
```json
{
    "body": "Actually, to be more positive, it mostly works!\n\nLooking for the root of the problem, only 29 libraries are not fully staged - but of course, thereafter the other binaries using one of this library become affected.\n\nATM (with 9.1.beta9), my list of affected libraries is:\n\nlibamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libamd.so.2\n\nlibbraiding.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libbraiding.so.0\n\nlibbrial_groebner.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial_groebner.so.3\n\nlibbrial.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial.so.3\n\nlibbtf.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libbtf.so.1\n\nlibcamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcamd.so.2\n\nlibccolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libccolamd.so.2\n\nlibcddgmp.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libcddgmp.so.0\n\nlibcholmod.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libcholmod.so.3\n\nlibcolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcolamd.so.2\n\nlibecl.so.16.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libecl.so.16.1\n\nlibfactory-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libfactory-4.1.1.so\n\nlibfflas.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libfflas.so.1\n\nlibffpack.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libffpack.so.1\n\nlibgap.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libgap.so.0\n\nlibgc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libgc.so.1\n\nlibhomfly.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libhomfly.so.0\n\nlibiml.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libiml.so.1\n\nliblinbox.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/liblinbox.so.0\n\nliblrcalc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/liblrcalc.so.1\n\nlibomalloc-0.9.6.so => /usr/ports/math/sage/work/stage/usr/local/lib/libomalloc-0.9.6.so\n\nlibpolys-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libpolys-4.1.1.so\n\nlibppl.so.14 => /usr/ports/math/sage/work/stage/usr/local/lib/libppl.so.14\n\nlibpynac.so.18 => /usr/ports/math/sage/work/stage/usr/local/lib/libpynac.so.18\n\nlibsingular_resources-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libsingular_resources-4.1.1.so\n\nlibSingular-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libSingular-4.1.1.so\n\nlibsuitesparseconfig.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libsuitesparseconfig.so.5\n\nlibumfpack.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libumfpack.so.5\n\nlibzn_poly-0.9.so => /usr/ports/math/sage/work/stage/usr/local/lib/libzn_poly-0.9.so\n\nSome of them like libgc, brial, or fflas-ffpack should be fixed RSN (thanks to #27330 ).\n\nI guess that the most problematic case is libsuitesparseconfig.so, which is widely used.",
    "created_at": "2020-04-10T17:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366425",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Actually, to be more positive, it mostly works!

Looking for the root of the problem, only 29 libraries are not fully staged - but of course, thereafter the other binaries using one of this library become affected.

ATM (with 9.1.beta9), my list of affected libraries is:

libamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libamd.so.2

libbraiding.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libbraiding.so.0

libbrial_groebner.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial_groebner.so.3

libbrial.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libbrial.so.3

libbtf.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libbtf.so.1

libcamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcamd.so.2

libccolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libccolamd.so.2

libcddgmp.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libcddgmp.so.0

libcholmod.so.3 => /usr/ports/math/sage/work/stage/usr/local/lib/libcholmod.so.3

libcolamd.so.2 => /usr/ports/math/sage/work/stage/usr/local/lib/libcolamd.so.2

libecl.so.16.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libecl.so.16.1

libfactory-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libfactory-4.1.1.so

libfflas.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libfflas.so.1

libffpack.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libffpack.so.1

libgap.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libgap.so.0

libgc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libgc.so.1

libhomfly.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/libhomfly.so.0

libiml.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/libiml.so.1

liblinbox.so.0 => /usr/ports/math/sage/work/stage/usr/local/lib/liblinbox.so.0

liblrcalc.so.1 => /usr/ports/math/sage/work/stage/usr/local/lib/liblrcalc.so.1

libomalloc-0.9.6.so => /usr/ports/math/sage/work/stage/usr/local/lib/libomalloc-0.9.6.so

libpolys-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libpolys-4.1.1.so

libppl.so.14 => /usr/ports/math/sage/work/stage/usr/local/lib/libppl.so.14

libpynac.so.18 => /usr/ports/math/sage/work/stage/usr/local/lib/libpynac.so.18

libsingular_resources-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libsingular_resources-4.1.1.so

libSingular-4.1.1.so => /usr/ports/math/sage/work/stage/usr/local/lib/libSingular-4.1.1.so

libsuitesparseconfig.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libsuitesparseconfig.so.5

libumfpack.so.5 => /usr/ports/math/sage/work/stage/usr/local/lib/libumfpack.so.5

libzn_poly-0.9.so => /usr/ports/math/sage/work/stage/usr/local/lib/libzn_poly-0.9.so

Some of them like libgc, brial, or fflas-ffpack should be fixed RSN (thanks to #27330 ).

I guess that the most problematic case is libsuitesparseconfig.so, which is widely used.



---

archive/issue_comments_366426.json:
```json
{
    "body": "I cc Matthias, who has been doing a lot of work on improving Sage's installation.\nHe'd be able to understand the issue better than me, hopefully.",
    "created_at": "2020-04-11T15:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366426",
    "user": "https://github.com/dimpase"
}
```

I cc Matthias, who has been doing a lot of work on improving Sage's installation.
He'd be able to understand the issue better than me, hopefully.



---

archive/issue_comments_366427.json:
```json
{
    "body": "The problem is documented in build/pkgs/suitesparse/patches/03-buildflags.patch:\n\n\"Note that -L$(INSTALL_LIB) cannot be removed from LDFLAGS unless the package \nis broken into components. It is necessary as the components are progressively\ninstalled in INSTALL_LIB one after the other.\"\n\nIt has been reported in #28832 and fixed for OS X with -install_name, but this does not fix it for FreeBSD. I'll have to try other patches - unless suiteparse could be used from a system package? It is not yet listed in #27330 but would be awesome!",
    "created_at": "2020-04-11T18:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366427",
    "user": "https://github.com/thierry-FreeBSD"
}
```

The problem is documented in build/pkgs/suitesparse/patches/03-buildflags.patch:

"Note that -L$(INSTALL_LIB) cannot be removed from LDFLAGS unless the package 
is broken into components. It is necessary as the components are progressively
installed in INSTALL_LIB one after the other."

It has been reported in #28832 and fixed for OS X with -install_name, but this does not fix it for FreeBSD. I'll have to try other patches - unless suiteparse could be used from a system package? It is not yet listed in #27330 but would be awesome!



---

archive/issue_comments_366428.json:
```json
{
    "body": "Now we have #29502 for suitesparse - not done yet.",
    "created_at": "2020-04-13T03:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366428",
    "user": "https://github.com/dimpase"
}
```

Now we have #29502 for suitesparse - not done yet.



---

archive/issue_comments_366429.json:
```json
{
    "body": "Some news: after #29502 for suitesparse and #29024 for singular, only 13 libraries (+ of course the modules built around them!) cause problems with staging: libbraiding libbrial_groebner libbrial libecl libfflas libffpack libgap libgc libhomfly liblinbox libppl libpynac libzn_poly-0.\n\nAmong them, all are listed in #27330 (with or without a ticket), but libpynac. We do not even have pynac in the FreeBSD ports tree (but we have math/GiNaC) => it will be my next target.",
    "created_at": "2020-04-17T19:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366429",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Some news: after #29502 for suitesparse and #29024 for singular, only 13 libraries (+ of course the modules built around them!) cause problems with staging: libbraiding libbrial_groebner libbrial libecl libfflas libffpack libgap libgc libhomfly liblinbox libppl libpynac libzn_poly-0.

Among them, all are listed in #27330 (with or without a ticket), but libpynac. We do not even have pynac in the FreeBSD ports tree (but we have math/GiNaC) => it will be my next target.



---

archive/issue_comments_366430.json:
```json
{
    "body": "After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!\n\nMeanwhile, our ports must be patched:\n\n- lang/ecl: add a symbolic link for $PREFIX/lib/ecl\n\n- math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)\n\nThey are not submitted yet, but if someone want to work on #29617 the patches are available at\n- https://people.freebsd.org/~thierry/lang_ecl.diff\n- https://people.freebsd.org/~thierry/math_maxima.diff",
    "created_at": "2020-04-29T16:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366430",
    "user": "https://github.com/thierry-FreeBSD"
}
```

After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!

Meanwhile, our ports must be patched:

- lang/ecl: add a symbolic link for $PREFIX/lib/ecl

- math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)

They are not submitted yet, but if someone want to work on #29617 the patches are available at
- https://people.freebsd.org/~thierry/lang_ecl.diff
- https://people.freebsd.org/~thierry/math_maxima.diff



---

archive/issue_comments_366431.json:
```json
{
    "body": "Replying to [comment:39 gh-thierry-FreeBSD]:\n> After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!\n> \n> Meanwhile, our ports must be patched:\n> \n> - lang/ecl: add a symbolic link for $PREFIX/lib/ecl\n> \n> - math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)\n\n\nthere are many free Common Lisp implementations, I suppose there can be lang/cl as a \"main\" package with a number of slaves, perhaps SBCL as a standard one.",
    "created_at": "2020-04-30T07:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366431",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:39 gh-thierry-FreeBSD]:
> After giac (#29541) and pynac (#29542), I tried to use a system package for ECL (lang/ecl) and Maxima (math/maxima), but without success for the moment: see #29617. To be tried again when ECL will be upgraded (#22191)!
> 
> Meanwhile, our ports must be patched:
> 
> - lang/ecl: add a symbolic link for $PREFIX/lib/ecl
> 
> - math/maxima: this one is more tricky, because now ECL is not even supported and must be added, and to get a useful package we need to replace the default from SBCL to ECL (or create a slave port?)


there are many free Common Lisp implementations, I suppose there can be lang/cl as a "main" package with a number of slaves, perhaps SBCL as a standard one.



---

archive/issue_comments_366432.json:
```json
{
    "body": "I'd recommend to add system package information for FreeBSD. See #29354 where this is done for Slackware (except for the bits that use docker)",
    "created_at": "2020-04-30T20:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366432",
    "user": "https://github.com/mkoeppe"
}
```

I'd recommend to add system package information for FreeBSD. See #29354 where this is done for Slackware (except for the bits that use docker)



---

archive/issue_comments_366433.json:
```json
{
    "body": "Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!\n\nNext step: try to solve the problem with bad staging (non-respect of $DESTDIR) for the libraries built by Sage.",
    "created_at": "2020-05-04T21:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366433",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!

Next step: try to solve the problem with bad staging (non-respect of $DESTDIR) for the libraries built by Sage.



---

archive/issue_comments_366434.json:
```json
{
    "body": "Replying to [comment:42 gh-thierry-FreeBSD]:\n> Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!\n\n\nYes, and the trick is to put the names of these packages in a freebsd.txt file to record the correspondence of spkg to FreeBSD port.",
    "created_at": "2020-05-05T02:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366434",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:42 gh-thierry-FreeBSD]:
> Well, every package listed in #27330 have a corresponding package from the FreeBSD ports tree and a spkg-configure.m4 to use it!


Yes, and the trick is to put the names of these packages in a freebsd.txt file to record the correspondence of spkg to FreeBSD port.



---

archive/issue_comments_366435.json:
```json
{
    "body": "OK, I'll do it!",
    "created_at": "2020-05-05T07:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366435",
    "user": "https://github.com/thierry-FreeBSD"
}
```

OK, I'll do it!



---

archive/issue_comments_366436.json:
```json
{
    "body": "Replying to [comment:44 gh-thierry-FreeBSD]:\n> OK, I'll do it!\n\n\nDone in #29653.",
    "created_at": "2020-05-05T17:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366436",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Replying to [comment:44 gh-thierry-FreeBSD]:
> OK, I'll do it!


Done in #29653.



---

archive/issue_comments_366437.json:
```json
{
    "body": "Next, if you're serious about FreeBSD support, I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform.",
    "created_at": "2020-05-08T16:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366437",
    "user": "https://github.com/mkoeppe"
}
```

Next, if you're serious about FreeBSD support, I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform.



---

archive/issue_comments_366438.json:
```json
{
    "body": "Replying to [comment:46 mkoeppe]:\n> I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform. \n> \n\n\nThanks, this is interesting - but at this point a bit premature: there is no compilation error, but Sage is not yet ready for FreeBSD, even if we are making progress.",
    "created_at": "2020-05-10T13:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366438",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Replying to [comment:46 mkoeppe]:
> I would recommend setting up testing infrastructure with our tox.ini and virtualbox (https://www.freebsd.org/doc/handbook/virtualization-guest-virtualbox.html) or a similar solution so that Sage developers and our CI infrastructure have a chance of testing on that platform. 
> 


Thanks, this is interesting - but at this point a bit premature: there is no compilation error, but Sage is not yet ready for FreeBSD, even if we are making progress.



---

archive/issue_comments_366439.json:
```json
{
    "body": "Well, we are almost done!\n\nIt is not yet committable in the FreeBSD ports tree, because there are some pre-requisites (isl to be upgraded, and two possible forks for ECL and Maxima if no better solution is found).\n\nSee https://reviews.freebsd.org/D24195 for details.",
    "created_at": "2020-05-31T14:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366439",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Well, we are almost done!

It is not yet committable in the FreeBSD ports tree, because there are some pre-requisites (isl to be upgraded, and two possible forks for ECL and Maxima if no better solution is found).

See https://reviews.freebsd.org/D24195 for details.



---

archive/issue_comments_366440.json:
```json
{
    "body": "for ecl I suggest to use a not yet merged\nhttps://trac.sagemath.org/ticket/22191\n\nwhich looks good on Linux and OpenBSD.\n\nalso a new release of Flint is coming.",
    "created_at": "2020-05-31T15:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366440",
    "user": "https://github.com/dimpase"
}
```

for ecl I suggest to use a not yet merged
https://trac.sagemath.org/ticket/22191

which looks good on Linux and OpenBSD.

also a new release of Flint is coming.



---

archive/issue_comments_366441.json:
```json
{
    "body": "Thanks! I'm just in discussion with the maintainers of these two ports (ECL and Maxima). Let's check this version.",
    "created_at": "2020-05-31T15:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366441",
    "user": "https://github.com/thierry-FreeBSD"
}
```

Thanks! I'm just in discussion with the maintainers of these two ports (ECL and Maxima). Let's check this version.



---

archive/issue_comments_366442.json:
```json
{
    "body": "ecl obviously must be upgraded to the latest release (maxima currently packaged with Sage works well with it, too).\n\nwhich bugs of maxima one prefers, is another question. :-)\n\nour experience with updating maxima is that each new release has serious regressions.",
    "created_at": "2020-05-31T16:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366442",
    "user": "https://github.com/dimpase"
}
```

ecl obviously must be upgraded to the latest release (maxima currently packaged with Sage works well with it, too).

which bugs of maxima one prefers, is another question. :-)

our experience with updating maxima is that each new release has serious regressions.



---

archive/issue_comments_366443.json:
```json
{
    "body": "here is Flint update ticket\nhttps://trac.sagemath.org/ticket/29719\n\nit is awaiting upstream putting in\nfinishing touches here:\nhttps://github.com/wbhart/flint2/issues/753",
    "created_at": "2020-05-31T16:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366443",
    "user": "https://github.com/dimpase"
}
```

here is Flint update ticket
https://trac.sagemath.org/ticket/29719

it is awaiting upstream putting in
finishing touches here:
https://github.com/wbhart/flint2/issues/753



---

archive/issue_comments_366444.json:
```json
{
    "body": "I guess that it is safer to get Sage 9.1 into our ports tree with the current dependencies.\n\nWe'll look to upgrade these afterwards!",
    "created_at": "2020-05-31T17:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366444",
    "user": "https://github.com/thierry-FreeBSD"
}
```

I guess that it is safer to get Sage 9.1 into our ports tree with the current dependencies.

We'll look to upgrade these afterwards!



---

archive/issue_comments_366445.json:
```json
{
    "body": "We are done, 9.1 is in the tree:\nhttps://www.freshports.org/math/sage/\n\nand we are working on the upgrade of ECL to 20.4.24:\nhttps://bugs.freebsd.org/bugzilla/show_bug.cgi?id=247283",
    "created_at": "2020-06-17T10:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366445",
    "user": "https://github.com/thierry-FreeBSD"
}
```

We are done, 9.1 is in the tree:
https://www.freshports.org/math/sage/

and we are working on the upgrade of ECL to 20.4.24:
https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=247283



---

archive/issue_comments_366446.json:
```json
{
    "body": "Replying to [comment:54 gh-thierry-FreeBSD]:\n> We are done, 9.1 is in the tree:\n> https://www.freshports.org/math/sage/\n\n\nThis is great!\n\nI guess we should make the Sagemath source FreeBSD-friendly, so that one can build\nSage from source using the standard ./configure + make route, right? This would need\n\n* adding data for the needed packages, that is, there should be\n  `build/pkgs/*/distros/freebsd.txt` files added with package names.\n\n* adding pre-reqs data: `build/pkgs/freebsd.txt` and `build/pkgs/freebsd-bootstrap.txt`\n\n* import patches you added in FreeBSD to Sage (if any)",
    "created_at": "2020-06-17T11:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366446",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:54 gh-thierry-FreeBSD]:
> We are done, 9.1 is in the tree:
> https://www.freshports.org/math/sage/


This is great!

I guess we should make the Sagemath source FreeBSD-friendly, so that one can build
Sage from source using the standard ./configure + make route, right? This would need

* adding data for the needed packages, that is, there should be
  `build/pkgs/*/distros/freebsd.txt` files added with package names.

* adding pre-reqs data: `build/pkgs/freebsd.txt` and `build/pkgs/freebsd-bootstrap.txt`

* import patches you added in FreeBSD to Sage (if any)



---

archive/issue_comments_366447.json:
```json
{
    "body": "The most important patch concerns configure.ac: without it, you cannot even run configure!\n\nI submitted it with the system package information in #29653, but it has been rejected.\n\nThe other patches are mostly specific and related to the ports system, caused by differences in directories, but shouldn't be necessary for those trying to build Sage by themselves with the bundled packages.\n\nmkoeppe asked me to set up a testing infrastructure. I'm not familiar at all with that, but I'll try to do it (any pointers appreciated!).",
    "created_at": "2020-06-17T12:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366447",
    "user": "https://github.com/thierry-FreeBSD"
}
```

The most important patch concerns configure.ac: without it, you cannot even run configure!

I submitted it with the system package information in #29653, but it has been rejected.

The other patches are mostly specific and related to the ports system, caused by differences in directories, but shouldn't be necessary for those trying to build Sage by themselves with the bundled packages.

mkoeppe asked me to set up a testing infrastructure. I'm not familiar at all with that, but I'll try to do it (any pointers appreciated!).



---

archive/issue_comments_366448.json:
```json
{
    "body": "I will look at #29653 - it needs a rebase over the latest 9.2.beta1 \n\nregarding testing - is docker ported to FreeBSD?\n\nAnyway, one can set a patchbot, for this one just needs a FreeBSD host that will pull branches and build/test them.",
    "created_at": "2020-06-17T13:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366448",
    "user": "https://github.com/dimpase"
}
```

I will look at #29653 - it needs a rebase over the latest 9.2.beta1 

regarding testing - is docker ported to FreeBSD?

Anyway, one can set a patchbot, for this one just needs a FreeBSD host that will pull branches and build/test them.



---

archive/issue_comments_366449.json:
```json
{
    "body": "There exists a port of docker: https://www.freshports.org/sysutils/docker (but I never used it!).",
    "created_at": "2020-06-17T13:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366449",
    "user": "https://github.com/thierry-FreeBSD"
}
```

There exists a port of docker: https://www.freshports.org/sysutils/docker (but I never used it!).



---

archive/issue_comments_366450.json:
```json
{
    "body": "I don't think docker port is production ready at the moment. I suggest the faster way would be having a github mirror and use hosted CI service: https://wiki.freebsd.org/HostedCI",
    "created_at": "2020-06-17T15:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366450",
    "user": "https://github.com/lwhsu"
}
```

I don't think docker port is production ready at the moment. I suggest the faster way would be having a github mirror and use hosted CI service: https://wiki.freebsd.org/HostedCI



---

archive/issue_comments_366451.json:
```json
{
    "body": "Replying to [comment:54 gh-thierry-FreeBSD]:\n> We are done, 9.1 is in the tree:\n> https://www.freshports.org/math/sage/\n\n\nI've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6\n\nHow do I get the new port in there? Do I need a system update (if yes, to what?)?\nOr it's easier?\nI've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.",
    "created_at": "2020-06-19T10:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366451",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:54 gh-thierry-FreeBSD]:
> We are done, 9.1 is in the tree:
> https://www.freshports.org/math/sage/


I've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6

How do I get the new port in there? Do I need a system update (if yes, to what?)?
Or it's easier?
I've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.



---

archive/issue_comments_366452.json:
```json
{
    "body": "You did the right thing!\n\n- 12.1-RELEASE-p6 is OK\n\n- `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.",
    "created_at": "2020-06-19T11:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366452",
    "user": "https://github.com/thierry-FreeBSD"
}
```

You did the right thing!

- 12.1-RELEASE-p6 is OK

- `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.



---

archive/issue_comments_366453.json:
```json
{
    "body": "Replying to [comment:61 dimpase]:\n> Replying to [comment:54 gh-thierry-FreeBSD]:\n> > We are done, 9.1 is in the tree:\n> > https://www.freshports.org/math/sage/\n\n> \n> I've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6\n> \n> How do I get the new port in there? Do I need a system update (if yes, to what?)?\n> Or it's easier?\n> I've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.\n\n\nI guess there are two possibilities, one is portsnap is not updated yet (unlikely, IIRC it updates hourly), the other is it's tracking quarterly branch, and 9.1 is only in latest branch now.  I haven't used portsnap for a while so I might also be wrong.\n\nTo get the latest ports tree in real-time, you can try to use svn to checkout from:\n\nhttps://svn.freebsd.org/ports/head\n\nor git from\n\nhttps://github.com/freebsd/freebsd-ports",
    "created_at": "2020-06-19T11:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366453",
    "user": "https://github.com/lwhsu"
}
```

Replying to [comment:61 dimpase]:
> Replying to [comment:54 gh-thierry-FreeBSD]:
> > We are done, 9.1 is in the tree:
> > https://www.freshports.org/math/sage/

> 
> I've revived a VM with FreeBSD, it's running 12.1-RELEASE-p6
> 
> How do I get the new port in there? Do I need a system update (if yes, to what?)?
> Or it's easier?
> I've run portsnap, and still see old stuff for sage in /usr/ports/math/sage.


I guess there are two possibilities, one is portsnap is not updated yet (unlikely, IIRC it updates hourly), the other is it's tracking quarterly branch, and 9.1 is only in latest branch now.  I haven't used portsnap for a while so I might also be wrong.

To get the latest ports tree in real-time, you can try to use svn to checkout from:

https://svn.freebsd.org/ports/head

or git from

https://github.com/freebsd/freebsd-ports



---

archive/issue_comments_366454.json:
```json
{
    "body": "Replying to [comment:62 gh-thierry-FreeBSD]:\n> You did the right thing!\n> \n> - 12.1-RELEASE-p6 is OK\n> \n> - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.\n\n\nOK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)\n\n\nlwhsu - did you see my email about CI? (just checking)",
    "created_at": "2020-06-19T11:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366454",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:62 gh-thierry-FreeBSD]:
> You did the right thing!
> 
> - 12.1-RELEASE-p6 is OK
> 
> - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.


OK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)


lwhsu - did you see my email about CI? (just checking)



---

archive/issue_comments_366455.json:
```json
{
    "body": "Replying to [comment:64 dimpase]:\n> Replying to [comment:62 gh-thierry-FreeBSD]:\n> > You did the right thing!\n> > \n> > - 12.1-RELEASE-p6 is OK\n> > \n> > - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.\n \n> \n> OK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)\n\n\nYes there are two steps. One if for fetching the content and the other one is for actually updating the ports tree.  See portsnap(8)\n \n> lwhsu - did you see my email about CI? (just checking)\n\n\nYes, please forgive me for needing longer to response.",
    "created_at": "2020-06-19T14:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26012",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26012#issuecomment-366455",
    "user": "https://github.com/lwhsu"
}
```

Replying to [comment:64 dimpase]:
> Replying to [comment:62 gh-thierry-FreeBSD]:
> > You did the right thing!
> > 
> > - 12.1-RELEASE-p6 is OK
> > 
> > - `portsnap fetch update' is a well supported method - but I do not know how long it takes to be refreshed. I guess that if you try again is 1h or 2 it should be fine.
 
> 
> OK, thanks, seems to be in progress now, after I did `portsnap fetch update` (my first try was ``portsnap fetch` - probably they are not the same thing)


Yes there are two steps. One if for fetching the content and the other one is for actually updating the ports tree.  See portsnap(8)
 
> lwhsu - did you see my email about CI? (just checking)


Yes, please forgive me for needing longer to response.
