# Issue 20668: converting frobby into a new-style package

archive/issues_020668.json:
```json
{
    "body": "CC:  vdelecroix mkoeppe\n\ncurrenly frobby is broken due to a C++ issue which Macaulay2 people know how to fix.\n\nThis ticket will convert frobby into a new-style package and apply this fix.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20905\n\n",
    "created_at": "2016-06-29T14:19:31Z",
    "labels": [
        "packages: optional",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "converting frobby into a new-style package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20668",
    "user": "dimpase"
}
```
CC:  vdelecroix mkoeppe

currenly frobby is broken due to a C++ issue which Macaulay2 people know how to fix.

This ticket will convert frobby into a new-style package and apply this fix.

Issue created by migration from https://trac.sagemath.org/ticket/20905





---

archive/issue_comments_285483.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-06-29T15:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285483",
    "user": "dimpase"
}
```

New commits:



---

archive/issue_comments_285484.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-30T09:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285484",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285485.json:
```json
{
    "body": "`SPKG_CHECK=yes sage -i frobby` returns OK, and all the tests in the frobby interface pass. There are some C++ issues in the debugging version of the program, but they can be ignored for our purposes.",
    "created_at": "2016-06-30T09:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285485",
    "user": "dimpase"
}
```

`SPKG_CHECK=yes sage -i frobby` returns OK, and all the tests in the frobby interface pass. There are some C++ issues in the debugging version of the program, but they can be ignored for our purposes.



---

archive/issue_comments_285486.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-30T09:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285486",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_285487.json:
```json
{
    "body": "Does frobby have any dependencies that should be listed?",
    "created_at": "2016-06-30T15:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285487",
    "user": "embray"
}
```

Does frobby have any dependencies that should be listed?



---

archive/issue_comments_285488.json:
```json
{
    "body": "Replying to [comment:6 embray]:\n> Does frobby have any dependencies that should be listed?\n\nit only depends on a standard Sage package (MPIR - which is impersonating GMP here).",
    "created_at": "2016-06-30T15:29:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285488",
    "user": "dimpase"
}
```

Replying to [comment:6 embray]:
> Does frobby have any dependencies that should be listed?

it only depends on a standard Sage package (MPIR - which is impersonating GMP here).



---

archive/issue_comments_285489.json:
```json
{
    "body": "Probably still good to add a `dependencies` file for that.  You can use `$(MP_LIBRARY)` for this.",
    "created_at": "2016-06-30T15:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285489",
    "user": "embray"
}
```

Probably still good to add a `dependencies` file for that.  You can use `$(MP_LIBRARY)` for this.



---

archive/issue_comments_285490.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-30T15:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285490",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285491.json:
```json
{
    "body": "Replying to [comment:8 embray]:\n> Probably still good to add a `dependencies` file for that.  You can use `$(MP_LIBRARY)` for this.\n\ndone. Indeed, this seems to be the correct thing to do.",
    "created_at": "2016-06-30T15:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285491",
    "user": "dimpase"
}
```

Replying to [comment:8 embray]:
> Probably still good to add a `dependencies` file for that.  You can use `$(MP_LIBRARY)` for this.

done. Indeed, this seems to be the correct thing to do.



---

archive/issue_comments_285492.json:
```json
{
    "body": "Upstream tarball = ?",
    "created_at": "2016-07-07T20:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285492",
    "user": "mkoeppe"
}
```

Upstream tarball = ?



---

archive/issue_comments_285493.json:
```json
{
    "body": "`sage -f -c frobby` gives:\n\n```\n[frobby-0.9.0.p2] Running the test suite for frobby-0.9.0.p2...\n[frobby-0.9.0.p2] g++   -Wall -I /Users/mkoeppe/cvs/sage/local/include -Wno-uninitialized -Wno-unused-parameter -std=c++11 -g -D DEBUG -fno-inline -Wextra -Wno-uninitialized -Wno-unused-parameter -c src/main.cpp -o bin/debug/main.o\n[frobby-0.9.0.p2] In file included from /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/map:60:0,\n[frobby-0.9.0.p2]                  from src/CliParams.h:24,\n[frobby-0.9.0.p2]                  from src/Action.h:21,\n[frobby-0.9.0.p2]                  from src/main.cpp:20:\n[frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h: In member function 'std::_Rb_tree_node<_Val>* std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_create_node(_Args&& ...)':\n[frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h:420:14: error: '__tmp' does not name a type\n[frobby-0.9.0.p2]         ::new(__tmp) _Rb_tree_node<_Val>;\n[frobby-0.9.0.p2]               ^\n[frobby-0.9.0.p2] make[2]: *** [bin/debug/main.o] Error 1\n```\n\nbut then it happily continues (\"All normal tests passed.\")",
    "created_at": "2016-07-07T21:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285493",
    "user": "mkoeppe"
}
```

`sage -f -c frobby` gives:

```
[frobby-0.9.0.p2] Running the test suite for frobby-0.9.0.p2...
[frobby-0.9.0.p2] g++   -Wall -I /Users/mkoeppe/cvs/sage/local/include -Wno-uninitialized -Wno-unused-parameter -std=c++11 -g -D DEBUG -fno-inline -Wextra -Wno-uninitialized -Wno-unused-parameter -c src/main.cpp -o bin/debug/main.o
[frobby-0.9.0.p2] In file included from /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/map:60:0,
[frobby-0.9.0.p2]                  from src/CliParams.h:24,
[frobby-0.9.0.p2]                  from src/Action.h:21,
[frobby-0.9.0.p2]                  from src/main.cpp:20:
[frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h: In member function 'std::_Rb_tree_node<_Val>* std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_create_node(_Args&& ...)':
[frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h:420:14: error: '__tmp' does not name a type
[frobby-0.9.0.p2]         ::new(__tmp) _Rb_tree_node<_Val>;
[frobby-0.9.0.p2]               ^
[frobby-0.9.0.p2] make[2]: *** [bin/debug/main.o] Error 1
```

but then it happily continues ("All normal tests passed.")



---

archive/issue_comments_285494.json:
```json
{
    "body": "Also, there is the optional frobgrob script, which depends on 4ti2. See the manual",
    "created_at": "2016-07-07T21:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285494",
    "user": "mkoeppe"
}
```

Also, there is the optional frobgrob script, which depends on 4ti2. See the manual



---

archive/issue_comments_285495.json:
```json
{
    "body": "Replying to [comment:13 mkoeppe]:\n> `sage -f -c frobby` gives:\n> {{{\n> [frobby-0.9.0.p2] Running the test suite for frobby-0.9.0.p2...\n> [frobby-0.9.0.p2] g++   -Wall -I /Users/mkoeppe/cvs/sage/local/include -Wno-uninitialized -Wno-unused-parameter -std=c++11 -g -D DEBUG -fno-inline -Wextra -Wno-uninitialized -Wno-unused-parameter -c src/main.cpp -o bin/debug/main.o\n> [frobby-0.9.0.p2] In file included from /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/map:60:0,\n> [frobby-0.9.0.p2]                  from src/CliParams.h:24,\n> [frobby-0.9.0.p2]                  from src/Action.h:21,\n> [frobby-0.9.0.p2]                  from src/main.cpp:20:\n> [frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h: In member function 'std::_Rb_tree_node<_Val>* std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_create_node(_Args&& ...)':\n> [frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h:420:14: error: '__tmp' does not name a type\n> [frobby-0.9.0.p2]         ::new(__tmp) _Rb_tree_node<_Val>;\n> [frobby-0.9.0.p2]               ^\n> [frobby-0.9.0.p2] make[2]: *** [bin/debug/main.o] Error 1\n> }}}\n> but then it happily continues (\"All normal tests passed.\")\n\nyes, I have seen this. This concerns debugging version of the program only, IMHO. My C++ is too rusty to get any idea what goes wrong there, besides vague recollections of \"iterator traits\" etc I got nightmares about... Hopefully it's OK as it is.",
    "created_at": "2016-07-07T21:24:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285495",
    "user": "dimpase"
}
```

Replying to [comment:13 mkoeppe]:
> `sage -f -c frobby` gives:
> {{{
> [frobby-0.9.0.p2] Running the test suite for frobby-0.9.0.p2...
> [frobby-0.9.0.p2] g++   -Wall -I /Users/mkoeppe/cvs/sage/local/include -Wno-uninitialized -Wno-unused-parameter -std=c++11 -g -D DEBUG -fno-inline -Wextra -Wno-uninitialized -Wno-unused-parameter -c src/main.cpp -o bin/debug/main.o
> [frobby-0.9.0.p2] In file included from /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/map:60:0,
> [frobby-0.9.0.p2]                  from src/CliParams.h:24,
> [frobby-0.9.0.p2]                  from src/Action.h:21,
> [frobby-0.9.0.p2]                  from src/main.cpp:20:
> [frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h: In member function 'std::_Rb_tree_node<_Val>* std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::_M_create_node(_Args&& ...)':
> [frobby-0.9.0.p2] /Users/mkoeppe/cvs/sage/local/include/c++/4.9.2/bits/stl_tree.h:420:14: error: '__tmp' does not name a type
> [frobby-0.9.0.p2]         ::new(__tmp) _Rb_tree_node<_Val>;
> [frobby-0.9.0.p2]               ^
> [frobby-0.9.0.p2] make[2]: *** [bin/debug/main.o] Error 1
> }}}
> but then it happily continues ("All normal tests passed.")

yes, I have seen this. This concerns debugging version of the program only, IMHO. My C++ is too rusty to get any idea what goes wrong there, besides vague recollections of "iterator traits" etc I got nightmares about... Hopefully it's OK as it is.



---

archive/issue_comments_285496.json:
```json
{
    "body": "Replying to [comment:14 mkoeppe]:\n> Also, there is the optional frobgrob script, which depends on 4ti2. See the manual\n\nshould 4ti2 be in frobby dependencies?",
    "created_at": "2016-07-07T21:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285496",
    "user": "dimpase"
}
```

Replying to [comment:14 mkoeppe]:
> Also, there is the optional frobgrob script, which depends on 4ti2. See the manual

should 4ti2 be in frobby dependencies?



---

archive/issue_comments_285497.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Replying to [comment:14 mkoeppe]:\n> > Also, there is the optional frobgrob script, which depends on 4ti2. See the manual\n> \n> should 4ti2 be in frobby dependencies? \n\nIf I understand the manual correctly, 4ti2 is only used by the frobgrob script, which is currently not installed.\nI think it should be installed; and 4ti2 should be a \"recommended package\" rather than a real dependency (like those many packages that one \"should\" install before polymake).",
    "created_at": "2016-07-07T21:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285497",
    "user": "mkoeppe"
}
```

Replying to [comment:16 dimpase]:
> Replying to [comment:14 mkoeppe]:
> > Also, there is the optional frobgrob script, which depends on 4ti2. See the manual
> 
> should 4ti2 be in frobby dependencies? 

If I understand the manual correctly, 4ti2 is only used by the frobgrob script, which is currently not installed.
I think it should be installed; and 4ti2 should be a "recommended package" rather than a real dependency (like those many packages that one "should" install before polymake).



---

archive/issue_comments_285498.json:
```json
{
    "body": "(However, Debian for example does not install \"frobgrob\".)",
    "created_at": "2016-07-07T21:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285498",
    "user": "mkoeppe"
}
```

(However, Debian for example does not install "frobgrob".)



---

archive/issue_comments_285499.json:
```json
{
    "body": "Judging only from the warning, I think the warning is coming from the fact that the forward declaration of `new` in the header has an input parameter `__tmp` that not been given an explicit type. Just add the type given in the implementation to the header and it should go away.",
    "created_at": "2016-07-08T04:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285499",
    "user": "tscrim"
}
```

Judging only from the warning, I think the warning is coming from the fact that the forward declaration of `new` in the header has an input parameter `__tmp` that not been given an explicit type. Just add the type given in the implementation to the header and it should go away.



---

archive/issue_comments_285500.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-11T20:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285500",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_285501.json:
```json
{
    "body": "Follow-up (frobgrob): #21004.",
    "created_at": "2016-07-11T20:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285501",
    "user": "mkoeppe"
}
```

Follow-up (frobgrob): #21004.



---

archive/issue_comments_285502.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-07-12T07:26:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285502",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_285503.json:
```json
{
    "body": "Reviewer name",
    "created_at": "2016-07-12T07:26:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285503",
    "user": "vbraun"
}
```

Reviewer name



---

archive/issue_comments_285504.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-07-12T08:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285504",
    "user": "mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_285505.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-13T18:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20668#issuecomment-285505",
    "user": "vbraun"
}
```

Resolution: fixed
