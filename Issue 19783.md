# Issue 19783: asymptotic expansion generator: singularity analysis (log-type) without renormalization

Issue created by migration from https://trac.sagemath.org/ticket/20020

Original creator: cheuberg

Original creation time: 2016-02-07 13:50:50

CC:  behackl dkrenn

As a follow-up to #19969, also implement singularity analysis for `(1-z)<sup>(-alpha)*(log(1/(1-z))</sup>beta`, i.e., where the renormalizing factor `1/z`, for integer beta.


---

Comment by cheuberg created at 2016-02-07 15:13:20

Last 10 new commits:


---

Comment by cheuberg created at 2016-02-07 15:13:20

Changing status from new to needs_review.


---

Comment by git created at 2016-02-07 16:38:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-02-13 09:41:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2016-02-13 09:41:44

Merged dependencies.
----
Last 10 new commits:


---

Comment by git created at 2016-02-13 11:28:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2016-02-13 11:31:05

From the docstring:

```
            sage: asymptotic_expansions._SingularityAnalysis_non_normalized_(
            ....:     'n', 1, alpha=2, beta=2, precision=4) / n
            log(n)^2 + (2*euler_gamma - 2)*log(n)
            - 2*euler_gamma + euler_gamma^2 - 1/6*pi^2 + 2
            + n^(-1)*log(n)^2 + O(n^(-1)*log(n))

        Be aware that the last result does *not* coincide with [FS2009]_,
        they do have a different error term.
```

I've checked this result and it (in particular, the term `n<sup>(-1)*log(n)</sup>2`) seems to be correct.

Apart from that, everything looks good.


---

Comment by dkrenn created at 2016-02-13 11:31:05

Changing status from needs_review to positive_review.


---

Comment by cheuberg created at 2016-02-13 15:40:38

Replying to [comment:10 dkrenn]:
> From the docstring:
> {{{
>             sage: asymptotic_expansions._SingularityAnalysis_non_normalized_(
>             ....:     'n', 1, alpha=2, beta=2, precision=4) / n
>             log(n)^2 + (2*euler_gamma - 2)*log(n)
>             - 2*euler_gamma + euler_gamma^2 - 1/6*pi^2 + 2
>             + n<sup>(-1)*log(n)</sup>2 + O(n^(-1)*log(n))
> 
>         Be aware that the last result does *not* coincide with [FS2009]_,
>         they do have a different error term.
> }}}
> I've checked this result and it (in particular, the term `n<sup>(-1)*log(n)</sup>2`) seems to be correct.
I have run numerical tests (via `compare_with_values`) for 

```
sage: asymptotic_expansions._SingularityAnalysis_non_normalized_(
....:     'n', 1, alpha=2, beta=2, precision=6)
n*log(n)^2 + (2*euler_gamma - 2)*n*log(n) + (-2*euler_gamma + euler_gamma^2 - 1/6*pi^2 + 2)*n + log(n)^2 + (2*euler_gamma + 1)*log(n) + euler_gamma + euler_gamma^2 - 1/6*pi^2 + O(n^(-1)*log(n)^2)
```

the result is

```
[(5000, -0.1171037?),
 (10000, -0.1069521?),
 (15000, -0.101778?),
 (20000, -0.098395?),
 (25000, -0.095920?),
 (30000, -0.093987?),
 (35000, -0.09242?),
 (40000, -0.09109?),
 (45000, -0.08995?),
 (50000, -0.08896?)]
```

which very much supports the additional term here (if it were not here, the renormalization would have multiplied with `n`, which is clearly not occurring).

I therefore submitted this as an erratum at the [book site](http://ac.cs.princeton.edu/errata/).

For completeness, here is my code for testing.

```
@cached_function
def H(k):
    """
    Harmonic numbers. Generating function: -log(1-z)/(1-z)
    """
    if k < 1:
        return 0
    else:
        return 1/k + H(k-1)
@cached_function
def a(k):
    """
    Coefficients of (-log(1-z))^2: differentiate GF once,
    obtain 2(-log(1-z))/(1-z), i.e., the harmonic numbers multiplied by 2.
    Shift and divide by k in order to take differntiation into account.
    """
    return 2*H(k-1)/k
@cached_function
def sum_a(k):
    """
    Summatory function of a(k), thus GF (-log(1-z))^2/(1-z).
    """
    if k<1:
        return 0
    else:
        return sum_a(k-1)+a(k)
@cached_function
def sum_sum_a(k):
    """
    Summatory function of sum_a(k), thus GF (-log(1-z))^2/(1-z)^2.
    """
    if k<1:
        return 0
    else:
        return sum_sum_a(k-1)+sum_a(k)
R.<z> = PowerSeriesRing(QQ, default_prec=100)
assert (log(1/(1-z)))^2 - sum(z^n*2*H(n-1)/n for n in range(1, 101)) == O(z^101)
assert (log(1/(1-z))/(1-z))^2 - sum(z^n*sum_sum_a(n) for n in range(1, 101)) == O(z^101)
%time result = [sum_sum_a(_) > 0 for _ in range(100, 50001, 100)]
ae = asymptotic_expansions._SingularityAnalysis_non_normalized_('n', 1, alpha=2, beta=2, precision=6); ae
ae.compare_with_values('n', sum_sum_a, srange(5000, 50001, 5000))
```



---

Comment by vbraun created at 2016-02-15 19:28:33

Resolution: fixed
