# Issue 11015: rubiks fails doctest on OpenSolaris x86 with gcc 4.6.0 and -O2 optimisation.

archive/issues_011015.json:
```json
{
    "body": "Assignee: drkirkby\n\nCC:  @jhpalmieri\n\nOn a Sun Ultra 27 running OpenSolaris06/2009, the rubiks-20070912.p12 package builds \n\n\n```\ndrkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\nsage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\n**********************************************************************\nFile \"/export/home/drkirkby/sage-4.7.alpha3/devel/sage/sage/interfaces/rubik.py\", line 132:\n    sage: solver = OptimalSolver() # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[4]>\", line 1, in <module>\n        solver = OptimalSolver() # long time###line 132:\n    sage: solver = OptimalSolver() # long time\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py\", line 98, in __init__\n        self.ready()\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py\", line 117, in ready\n        self.child.expect('enter cube')\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py\", line 912, in expect\n        return self.expect_list(compiled_pattern_list, timeout, searchwindowsize)\n      File \"/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py\", line 978, in expect_list\n        raise EOF (str(e) + '\\n' + str(self))\n    EOF: End Of File (EOF) in read_nonblocking(). Empty string style platform.\n    <pexpect.spawn instance at 0xc5367ac>\n    version: 2.0 ($Revision: 1.151 $)\n    command: /export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal\n    args: ['/export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal']\n    patterns:\n        enter cube\n    buffer (last 100 chars): \n    before (last 100 chars): olutions\n    \n    initializing transformation tables\n    \n    init_fulledge_to_edgequot : too many  edgequot's\n\n    after: <class 'pexpect.EOF'>\n    match: None\n    match_index: None\n    exitstatus: None\n    flag_eof: 1\n    pid: 10994\n    child_fd: 3\n    timeout: None\n    delimiter: <class 'pexpect.EOF'>\n    logfile: None\n    maxread: 2000\n    searchwindowsize: None\n    delaybeforesend: 0.1\n**********************************************************************\n1 items had failures:\n   1 of  12 in __main__.example_3\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /export/home/drkirkby/.sage//tmp/.doctest_rubik.py\n         [9.4 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\nTotal time for all tests: 9.4 seconds\n```\n\n\nHowever, if the optimisation level is changed from -O2 to -O1, the program behaves properly.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11168\n\n",
    "created_at": "2011-04-10T19:21:20Z",
    "labels": [
        "component: porting: solaris"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "rubiks fails doctest on OpenSolaris x86 with gcc 4.6.0 and -O2 optimisation.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11015",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
Assignee: drkirkby

CC:  @jhpalmieri

On a Sun Ultra 27 running OpenSolaris06/2009, the rubiks-20070912.p12 package builds 


```
drkirkby@hawk:~/sage-4.7.alpha3$ ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
**********************************************************************
File "/export/home/drkirkby/sage-4.7.alpha3/devel/sage/sage/interfaces/rubik.py", line 132:
    sage: solver = OptimalSolver() # long time
Exception raised:
    Traceback (most recent call last):
      File "/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/export/home/drkirkby/sage-4.7.alpha3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/export/home/drkirkby/sage-4.7.alpha3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[4]>", line 1, in <module>
        solver = OptimalSolver() # long time###line 132:
    sage: solver = OptimalSolver() # long time
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py", line 98, in __init__
        self.ready()
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/sage/interfaces/rubik.py", line 117, in ready
        self.child.expect('enter cube')
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py", line 912, in expect
        return self.expect_list(compiled_pattern_list, timeout, searchwindowsize)
      File "/export/home/drkirkby/sage-4.7.alpha3/local/lib/python/site-packages/pexpect.py", line 978, in expect_list
        raise EOF (str(e) + '\n' + str(self))
    EOF: End Of File (EOF) in read_nonblocking(). Empty string style platform.
    <pexpect.spawn instance at 0xc5367ac>
    version: 2.0 ($Revision: 1.151 $)
    command: /export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal
    args: ['/export/home/drkirkby/sage-4.7.alpha3/local/bin/optimal']
    patterns:
        enter cube
    buffer (last 100 chars): 
    before (last 100 chars): olutions
    
    initializing transformation tables
    
    init_fulledge_to_edgequot : too many  edgequot's

    after: <class 'pexpect.EOF'>
    match: None
    match_index: None
    exitstatus: None
    flag_eof: 1
    pid: 10994
    child_fd: 3
    timeout: None
    delimiter: <class 'pexpect.EOF'>
    logfile: None
    maxread: 2000
    searchwindowsize: None
    delaybeforesend: 0.1
**********************************************************************
1 items had failures:
   1 of  12 in __main__.example_3
***Test Failed*** 1 failures.
For whitespace errors, see the file /export/home/drkirkby/.sage//tmp/.doctest_rubik.py
         [9.4 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
Total time for all tests: 9.4 seconds
```


However, if the optimisation level is changed from -O2 to -O1, the program behaves properly.

Issue created by migration from https://trac.sagemath.org/ticket/11168





---

archive/issue_comments_119540.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-10T19:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119540",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_119541.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2011-04-10T19:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119541",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_119542.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-12T21:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119542",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_119543.json:
```json
{
    "body": "The patch is very simple.  The new spkg builds on both hawk (OpenSolaris on x86, with gcc 4.5.0 and gcc 4.6.0) and t2 (Solaris on sparc, with gcc 4.5.1 and 4.6.0), and tests pass in all cases.  With the old version, tests failed on both machines using gcc 4.6.0 (but everything worked fine with the earlier version of gcc).\n\nNote: to build with gcc 4.6.0 on t2, I had to set LD_LIBRARY_PATH and unset LD_OPTIONS; I couldn't get LD_OPTIONS to work.  But I don't really know how to properly use these variables anyway...",
    "created_at": "2011-04-12T21:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119543",
    "user": "https://github.com/jhpalmieri"
}
```

The patch is very simple.  The new spkg builds on both hawk (OpenSolaris on x86, with gcc 4.5.0 and gcc 4.6.0) and t2 (Solaris on sparc, with gcc 4.5.1 and 4.6.0), and tests pass in all cases.  With the old version, tests failed on both machines using gcc 4.6.0 (but everything worked fine with the earlier version of gcc).

Note: to build with gcc 4.6.0 on t2, I had to set LD_LIBRARY_PATH and unset LD_OPTIONS; I couldn't get LD_OPTIONS to work.  But I don't really know how to properly use these variables anyway...



---

archive/issue_comments_119544.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-04-13T15:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119544",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_011121.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-13T15:18:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11015#event-11121"
}
```



---

archive/issue_comments_119545.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-04-19T08:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119545",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_011122.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-19T08:55:45Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11015#event-11122"
}
```



---

archive/issue_comments_119546.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-04-19T08:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119546",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_119547.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2011-04-19T08:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119547",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_119548.json:
```json
{
    "body": "Marking this as needs_work because there are more systems with the same symptom.  In particular, on the buildbot Fedora 14-32 (cicero).",
    "created_at": "2011-04-19T08:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119548",
    "user": "https://github.com/jdemeyer"
}
```

Marking this as needs_work because there are more systems with the same symptom.  In particular, on the buildbot Fedora 14-32 (cicero).



---

archive/issue_comments_119549.json:
```json
{
    "body": "Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.",
    "created_at": "2011-04-19T08:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119549",
    "user": "https://github.com/jdemeyer"
}
```

Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.



---

archive/issue_comments_119550.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.\n\nIn the short term, I don't see we can do anything other than just lower the optimisation. \n\nIt should be noted that there are quite a few Sage patches applied - some directly to the source code, which should not have been done, but has been done. This package has been patched 13 times already! \n\nDave",
    "created_at": "2011-04-19T21:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119550",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:7 jdemeyer]:
> Also, I really dislike simply lowering the optimization level.  That is wiping the problem under the carpet, not solving it.  Also should be reported upstream.

In the short term, I don't see we can do anything other than just lower the optimisation. 

It should be noted that there are quite a few Sage patches applied - some directly to the source code, which should not have been done, but has been done. This package has been patched 13 times already! 

Dave



---

archive/issue_comments_119551.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-19T21:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119551",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_119552.json:
```json
{
    "body": "Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. \n\nDave",
    "created_at": "2011-04-19T21:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119552",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. 

Dave



---

archive/issue_comments_119553.json:
```json
{
    "body": "Replying to [comment:9 drkirkby]:\n> Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. \n> \n> Dave \n\nThe grammar was not very good there! The point being, this patch changes the optimisation to -O1 on all platforms. \n\nDave",
    "created_at": "2011-04-19T21:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119553",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:9 drkirkby]:
> Here's a revised package, which reduces the optimisation level to -O1 (as my previous patch), but this time only on all platforms, and not just Solaris. 
> 
> Dave 

The grammar was not very good there! The point being, this patch changes the optimisation to -O1 on all platforms. 

Dave



---

archive/issue_comments_119554.json:
```json
{
    "body": "I believe only the file src/reid/optimal.c needs to be reduced\nto -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)",
    "created_at": "2011-04-20T14:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119554",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

I believe only the file src/reid/optimal.c needs to be reduced
to -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)



---

archive/issue_comments_119555.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-20T14:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119555",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_119556.json:
```json
{
    "body": "Replying to [comment:11 mariah]:\n> I believe only the file src/reid/optimal.c needs to be reduced\n> to -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)\n\nMany thanks for sorting this out!!!\n\nI'm not so sure whether it makes sense to change the optimization level for just 1 file.  Maybe the whole directory `src/reid` yes, but one file?",
    "created_at": "2011-04-20T14:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119556",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:11 mariah]:
> I believe only the file src/reid/optimal.c needs to be reduced
> to -O1 due to an optimization regression in gcc-4.6.0.  See gcc bugzilla # 48702 [http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48702)

Many thanks for sorting this out!!!

I'm not so sure whether it makes sense to change the optimization level for just 1 file.  Maybe the whole directory `src/reid` yes, but one file?



---

archive/issue_comments_119557.json:
```json
{
    "body": "I don't know for sure, but I don't believe any of this is going to be too time-critical. I can't somehow seeing one wanting to solve lots of rubiks cubes and given solving them takes very little time, I don't see this as very important if we lose a few clock cycles here or there. \n\ndave",
    "created_at": "2011-04-20T14:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119557",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

I don't know for sure, but I don't believe any of this is going to be too time-critical. I can't somehow seeing one wanting to solve lots of rubiks cubes and given solving them takes very little time, I don't see this as very important if we lose a few clock cycles here or there. 

dave



---

archive/issue_comments_119558.json:
```json
{
    "body": "Since this is clearly a gcc 4.6.0 bug, I suggest to check in `spkg-install` whether we are using gcc 4.6.0 and *only* reduce the optimization level to -O1 if so.\n\nAnother annoying thing about this package is that some of the patches in `patches/` are the wrong way around (they are patches *from* the patched version *to* the original version).",
    "created_at": "2011-04-20T14:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119558",
    "user": "https://github.com/jdemeyer"
}
```

Since this is clearly a gcc 4.6.0 bug, I suggest to check in `spkg-install` whether we are using gcc 4.6.0 and *only* reduce the optimization level to -O1 if so.

Another annoying thing about this package is that some of the patches in `patches/` are the wrong way around (they are patches *from* the patched version *to* the original version).



---

archive/issue_comments_119559.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-23T08:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119559",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_119560.json:
```json
{
    "body": "I've now changed this so instead of reducing the optimisation on Solaris, it does it on all platforms with gcc 4.6.0. First it tests for gcc using `$SAGE_LOCAL/bin/testcc.sh`, then if we are using gcc, a second test is performed for gcc 4.6.0 by adding the '`dumpversion`' option to gcc. \n\nThe following is the critical bit of new code.\n\n\n```\nOPTIMIZATION_FLAGS=\"-O2\"\nif [ \"x`$SAGE_LOCAL/bin/testcc.sh $CC`\" = xGCC ] && [ \"x`$CC -dumpversion`\" = x4.6.0 ] ; then \n   echo \"Warning: Reducing the optimisation level to -O1 due to a bug in gcc 4.6.0\"\n   OPTIMIZATION_FLAGS=\"-O1\"\nfi\n```\n\n\nThere are some typos corrected too - see the attached patch. \n\nDave",
    "created_at": "2011-04-23T08:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119560",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

I've now changed this so instead of reducing the optimisation on Solaris, it does it on all platforms with gcc 4.6.0. First it tests for gcc using `$SAGE_LOCAL/bin/testcc.sh`, then if we are using gcc, a second test is performed for gcc 4.6.0 by adding the '`dumpversion`' option to gcc. 

The following is the critical bit of new code.


```
OPTIMIZATION_FLAGS="-O2"
if [ "x`$SAGE_LOCAL/bin/testcc.sh $CC`" = xGCC ] && [ "x`$CC -dumpversion`" = x4.6.0 ] ; then 
   echo "Warning: Reducing the optimisation level to -O1 due to a bug in gcc 4.6.0"
   OPTIMIZATION_FLAGS="-O1"
fi
```


There are some typos corrected too - see the attached patch. 

Dave



---

archive/issue_comments_119561.json:
```json
{
    "body": "Attachment [rubiks-optimisation-problem.patch](tarball://root/attachments/some-uuid/ticket11168/rubiks-optimisation-problem.patch) by drkirkby created at 2011-04-23 09:05:01\n\nPatch which changes optimisation to -O1 if using gcc 4.6.0  (for review purposes only - changes are in the .spkg)",
    "created_at": "2011-04-23T09:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119561",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Attachment [rubiks-optimisation-problem.patch](tarball://root/attachments/some-uuid/ticket11168/rubiks-optimisation-problem.patch) by drkirkby created at 2011-04-23 09:05:01

Patch which changes optimisation to -O1 if using gcc 4.6.0  (for review purposes only - changes are in the .spkg)



---

archive/issue_comments_119562.json:
```json
{
    "body": "David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):\n[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)",
    "created_at": "2011-04-25T10:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119562",
    "user": "https://github.com/jdemeyer"
}
```

David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):
[http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)



---

archive/issue_comments_119563.json:
```json
{
    "body": "Replying to [comment:18 jdemeyer]:\n> David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):\n> [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)\n\nI think my test\n\n\n```\nif [ \"x`$SAGE_LOCAL/bin/testcc.sh $CC`\" = xGCC ] && [ \"x`$CC -dumpversion`\" = x4.6.0 ] ; then  \n```\n\n\nfor the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, \n\nAlso, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. \n\nDave",
    "created_at": "2011-04-25T12:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119563",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:18 jdemeyer]:
> David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):
> [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)

I think my test


```
if [ "x`$SAGE_LOCAL/bin/testcc.sh $CC`" = xGCC ] && [ "x`$CC -dumpversion`" = x4.6.0 ] ; then  
```


for the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, 

Also, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. 

Dave



---

archive/issue_comments_119564.json:
```json
{
    "body": "Replying to [comment:19 drkirkby]:\n> Replying to [comment:18 jdemeyer]:\n> > David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):\n> > [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)\n> \n> I think my test\n> \n> {{{\n> if [ \"x`$SAGE_LOCAL/bin/testcc.sh $CC`\" = xGCC ] && [ \"x`$CC -dumpversion`\" = x4.6.0 ] ; then  \n> }}}\n> \n> for the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, \n> \n> Also, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. \n\nMy test *does* test for gcc in the `--version` output.\n\nIf I change the gcc test to use your original test code, would the rest of my patch get positive_review?",
    "created_at": "2011-04-25T12:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119564",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:19 drkirkby]:
> Replying to [comment:18 jdemeyer]:
> > David, in principle I agree with your changes.  However, the gcc report indicates a problem with gcc/tree-ssa-loop-ivopts.c and because of this it suffices to disable -fivopts.  New spkg which does this (and also simplifies the gcc version check):
> > [http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rubiks-20070912.p15.spkg)
> 
> I think my test
> 
> {{{
> if [ "x`$SAGE_LOCAL/bin/testcc.sh $CC`" = xGCC ] && [ "x`$CC -dumpversion`" = x4.6.0 ] ; then  
> }}}
> 
> for the version is preferable. I can't see the point in calling a C compiler with --version then greping the output, where there is a documented option (-dumpversion) to show just the version, 
> 
> Also, this could well fail for another compiler with a version of 4.6.0 - I think its safer to test for gcc first. 

My test *does* test for gcc in the `--version` output.

If I change the gcc test to use your original test code, would the rest of my patch get positive_review?



---

archive/issue_comments_119565.json:
```json
{
    "body": "David, another minor issue with your test:\nI would change `[ \"x`$CC -dumpversion`\" = x4.6.0 ]` to `[ \"x`$CC -dumpversion 2>/dev/null`\" = x4.6.0 ]` in case that `$CC` does not support `-dumpversion`.",
    "created_at": "2011-04-25T13:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119565",
    "user": "https://github.com/jdemeyer"
}
```

David, another minor issue with your test:
I would change `[ "x`$CC -dumpversion`" = x4.6.0 ]` to `[ "x`$CC -dumpversion 2>/dev/null`" = x4.6.0 ]` in case that `$CC` does not support `-dumpversion`.



---

archive/issue_comments_119566.json:
```json
{
    "body": "Replying to [comment:21 jdemeyer]:\n> David, another minor issue with your test:\n> I would change `[ \"x`$CC -dumpversion`\" = x4.6.0 ]` to `[ \"x`$CC -dumpversion 2>/dev/null`\" = x4.6.0 ]` in case that `$CC` does not support `-dumpversion`.\n\nI need to be doing something else now (gardening), so don't have chance to do much with this, but a few quick notes. \n \n* My machine is rather busy now, doing a scrub of the disks (Google scrub and ZFS if you want). The test took 130.9 seconds, compared to the 26.7 seconds with just -O1. That's slowed down by a factor of almost 5. Perhaps the load on my machine has caused this, but can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1. \n* My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact. \n* A very minor point, but it would be worth putting a link to the gcc bug in SPKG.txt. \n\nAssuming you can confirm the new compiler option given does not cause a dramatic slowdown, and change the test, then feel free to change the ticket to positive review - don't wait for me. Issues about SPKG.txt and /dev/null are not too critical - make what changes you feel are appropriate. \n\nDave",
    "created_at": "2011-04-25T14:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119566",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:21 jdemeyer]:
> David, another minor issue with your test:
> I would change `[ "x`$CC -dumpversion`" = x4.6.0 ]` to `[ "x`$CC -dumpversion 2>/dev/null`" = x4.6.0 ]` in case that `$CC` does not support `-dumpversion`.

I need to be doing something else now (gardening), so don't have chance to do much with this, but a few quick notes. 
 
* My machine is rather busy now, doing a scrub of the disks (Google scrub and ZFS if you want). The test took 130.9 seconds, compared to the 26.7 seconds with just -O1. That's slowed down by a factor of almost 5. Perhaps the load on my machine has caused this, but can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1. 
* My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact. 
* A very minor point, but it would be worth putting a link to the gcc bug in SPKG.txt. 

Assuming you can confirm the new compiler option given does not cause a dramatic slowdown, and change the test, then feel free to change the ticket to positive review - don't wait for me. Issues about SPKG.txt and /dev/null are not too critical - make what changes you feel are appropriate. 

Dave



---

archive/issue_comments_119567.json:
```json
{
    "body": "Replying to [comment:22 drkirkby]:\n> can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1.\n\nOn my machine (`Linux arcanis 2.6.34-gentoo-r12 #2 SMP Mon Dec 6 17:16:04 CET 2010 x86_64 Intel(R) Core(TM)2 Duo CPU T5870 `@` 2.00GHz GenuineIntel GNU/Linux`) with gcc 4.6.0, the long test `sage/interfaces/rubik.py` takes:\n1. p14 (using `-O1`): 39.9 s\n2. p15 (using `-O2 -fno-ivopts`): 37.5 s",
    "created_at": "2011-04-25T16:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119567",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:22 drkirkby]:
> can you check this option has not slowed things significantly. If it slower than -O1, then I think it would be better to revert to -O1.

On my machine (`Linux arcanis 2.6.34-gentoo-r12 #2 SMP Mon Dec 6 17:16:04 CET 2010 x86_64 Intel(R) Core(TM)2 Duo CPU T5870 `@` 2.00GHz GenuineIntel GNU/Linux`) with gcc 4.6.0, the long test `sage/interfaces/rubik.py` takes:
1. p14 (using `-O1`): 39.9 s
2. p15 (using `-O2 -fno-ivopts`): 37.5 s



---

archive/issue_comments_119568.json:
```json
{
    "body": "Replying to [comment:22 drkirkby]:\n>  * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.\n\nCan you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?",
    "created_at": "2011-04-25T16:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119568",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:22 drkirkby]:
>  * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.

Can you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?



---

archive/issue_comments_119569.json:
```json
{
    "body": "Attachment [rubiks-20070912.p14-p15.diff](tarball://root/attachments/some-uuid/ticket11168/rubiks-20070912.p14-p15.diff) by @jdemeyer created at 2011-04-25 17:37:01\n\ndiff p14 -> p15 (for reviewing only)",
    "created_at": "2011-04-25T17:37:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119569",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [rubiks-20070912.p14-p15.diff](tarball://root/attachments/some-uuid/ticket11168/rubiks-20070912.p14-p15.diff) by @jdemeyer created at 2011-04-25 17:37:01

diff p14 -> p15 (for reviewing only)



---

archive/issue_comments_119570.json:
```json
{
    "body": "Replying to [comment:24 jdemeyer]:\n> Replying to [comment:22 drkirkby]:\n> >  * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.\n> \n> Can you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?\n\nI think if any compiler is going to aim to be GCC compatible then it would need to support the '`-dumpversion`' option. If it does not, then I would consider that a compiler bug. The Intel compiler supports '`-dumpversion`' - see\n\nhttp://software.intel.com/sites/products/documentation/hpc/compilerpro/en-us/cpp/lin/main_cls_lin.pdf\n\nClang does too:\n\nhttps://llvm.org/viewvc/llvm-project/cfe/trunk/include/clang/Driver/Options.td?sortby=date&r1=106956&r2=106955&pathrev=106956&diff_format=s\n\n*GCC For Sun Systems* uses the gcc front end and takes the GNU options. It actually uses the GCC source code, so I assume that would take the '`-dumpversion`' option too. \n\nI'm not aware of any other GCC compatible compiler. But if they really are GCC compatible, they should take the '`-dumpversion`' option. \n\nI've just checked gcc 3.4.3, and that takes the '`-dumpversion`' option. \n\n\n```\ndrkirkby@hawk:~$ /usr/bin/gcc -dumpversion\n3.4.3\ndrkirkby@hawk:~$ /usr/bin/g++ -dumpversion\n3.4.3\ndrkirkby@hawk:~$ \n```\n\n\nJust out of interest, I checked on t2.math (a SPARC system), and that supports `-dumpversion`' too.\n\n\n```\nkirkby@t2:32 ~$ /usr/sfw/bin/gcc -dumpversion\n3.4.3\n```\n\n\nI would use more caution if it was the Fortran compiler we were testing, as the option gave a different output (same as --version) in older versions of gfortran. But that bug was fixed a year or two ago, so that now '`gfortran`' gives just the version number if given the option '`-dumpversion`'. But that test in the rubiks package only tests the C compiler, so it's immaterial what `gfortran` does. \n\nI would also note we are using the `-dumpversion`' compiler option already. The 'prereq' script uses two autoconf macros (`ax_gcc_version.m4` & `ax_gxx_version.m4`) which use the option. That is run to check the versions of gcc and g++ are the same. So I think if there was a problem using the `-dumpversion`' compiler option, we would have known about it before. \n\nDave",
    "created_at": "2011-04-26T06:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119570",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:24 jdemeyer]:
> Replying to [comment:22 drkirkby]:
> >  * My test does not use the -dumpversion option unless the compiler is first confirmed to be gcc, since the second part of the test (the version) will not be executed unless the first part (the type of compiler), is confirmed to be GCC. So I don't really see the need to send stderr to /dev/null, but I'm not bothered about that fact.
> 
> Can you guarantee that every compiler which defines `__GNUC__` understands the option `-dumpversion`?

I think if any compiler is going to aim to be GCC compatible then it would need to support the '`-dumpversion`' option. If it does not, then I would consider that a compiler bug. The Intel compiler supports '`-dumpversion`' - see

http://software.intel.com/sites/products/documentation/hpc/compilerpro/en-us/cpp/lin/main_cls_lin.pdf

Clang does too:

https://llvm.org/viewvc/llvm-project/cfe/trunk/include/clang/Driver/Options.td?sortby=date&r1=106956&r2=106955&pathrev=106956&diff_format=s

*GCC For Sun Systems* uses the gcc front end and takes the GNU options. It actually uses the GCC source code, so I assume that would take the '`-dumpversion`' option too. 

I'm not aware of any other GCC compatible compiler. But if they really are GCC compatible, they should take the '`-dumpversion`' option. 

I've just checked gcc 3.4.3, and that takes the '`-dumpversion`' option. 


```
drkirkby@hawk:~$ /usr/bin/gcc -dumpversion
3.4.3
drkirkby@hawk:~$ /usr/bin/g++ -dumpversion
3.4.3
drkirkby@hawk:~$ 
```


Just out of interest, I checked on t2.math (a SPARC system), and that supports `-dumpversion`' too.


```
kirkby@t2:32 ~$ /usr/sfw/bin/gcc -dumpversion
3.4.3
```


I would use more caution if it was the Fortran compiler we were testing, as the option gave a different output (same as --version) in older versions of gfortran. But that bug was fixed a year or two ago, so that now '`gfortran`' gives just the version number if given the option '`-dumpversion`'. But that test in the rubiks package only tests the C compiler, so it's immaterial what `gfortran` does. 

I would also note we are using the `-dumpversion`' compiler option already. The 'prereq' script uses two autoconf macros (`ax_gcc_version.m4` & `ax_gxx_version.m4`) which use the option. That is run to check the versions of gcc and g++ are the same. So I think if there was a problem using the `-dumpversion`' compiler option, we would have known about it before. 

Dave



---

archive/issue_comments_119571.json:
```json
{
    "body": "David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?",
    "created_at": "2011-04-26T07:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119571",
    "user": "https://github.com/jdemeyer"
}
```

David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?



---

archive/issue_comments_119572.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2011-04-26T07:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119572",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_119573.json:
```json
{
    "body": "Replying to [comment:26 jdemeyer]:\n> David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?\n\nSure.",
    "created_at": "2011-04-26T10:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119573",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:26 jdemeyer]:
> David, I agree with everything you say, but I hope you can agree that the `2>/dev/null` doesn't hurt anyway.  Can it get positive_review now?

Sure.



---

archive/issue_comments_119574.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-26T10:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119574",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_011123.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-26T12:18:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11015#event-11123"
}
```



---

archive/issue_comments_119575.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-04-26T12:18:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119575",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_119576.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-05-03T12:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119576",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_119577.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-05-03T12:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119577",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_011124.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-03T12:43:42Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11015#event-11124"
}
```



---

archive/issue_comments_119578.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-03T13:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119578",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_119579.json:
```json
{
    "body": "Attachment [rubiks-20070912.p15-p16.diff](tarball://root/attachments/some-uuid/ticket11168/rubiks-20070912.p15-p16.diff) by @jdemeyer created at 2011-05-03 15:21:17\n\nDiff for the rubiks spkg, for reviewing only",
    "created_at": "2011-05-03T15:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119579",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [rubiks-20070912.p15-p16.diff](tarball://root/attachments/some-uuid/ticket11168/rubiks-20070912.p15-p16.diff) by @jdemeyer created at 2011-05-03 15:21:17

Diff for the rubiks spkg, for reviewing only



---

archive/issue_comments_119580.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-03T20:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119580",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_119581.json:
```json
{
    "body": "The patch will be applied for later versions than just gcc-4.6.0.\nRecommend that the patch only be applied for gcc-4.6.0.",
    "created_at": "2011-05-03T20:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119581",
    "user": "https://trac.sagemath.org/admin/accounts/users/mariah"
}
```

The patch will be applied for later versions than just gcc-4.6.0.
Recommend that the patch only be applied for gcc-4.6.0.



---

archive/issue_comments_119582.json:
```json
{
    "body": "Replying to [comment:32 mariah]:\n> The patch will be applied for later versions than just gcc-4.6.0.\n> Recommend that the patch only be applied for gcc-4.6.0.  \nWhy?\n\nThere already exist pre-release versions of gcc 4.6.1 manifesting the same problem.\n\nI think that having the workaround for all versions 4.6.x doesn't really hurt.  It is certainly a safer alternative than applying the workaround only for gcc 4.6.0.  If at some point, this bug is fixed in a later gcc 4.6.x, then we can still change the spkg accordingly.",
    "created_at": "2011-05-04T07:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119582",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:32 mariah]:
> The patch will be applied for later versions than just gcc-4.6.0.
> Recommend that the patch only be applied for gcc-4.6.0.  
Why?

There already exist pre-release versions of gcc 4.6.1 manifesting the same problem.

I think that having the workaround for all versions 4.6.x doesn't really hurt.  It is certainly a safer alternative than applying the workaround only for gcc 4.6.0.  If at some point, this bug is fixed in a later gcc 4.6.x, then we can still change the spkg accordingly.



---

archive/issue_comments_119583.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-04T07:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119583",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_119584.json:
```json
{
    "body": "Can somebody please review?  Thanks.",
    "created_at": "2011-05-07T11:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119584",
    "user": "https://github.com/jdemeyer"
}
```

Can somebody please review?  Thanks.



---

archive/issue_comments_119585.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-05-07T22:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119585",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_119586.json:
```json
{
    "body": "Replying to [comment:35 jdemeyer]:\n> Can somebody please review?  Thanks.\n\nSure:\n\n\n```\ndrkirkby@hawk:~/sage-4.7.rc0$  ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py\nsage -t -long -force_lib \"devel/sage/sage/interfaces/rubik.py\"\n\t [25.5 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 25.6 seconds\n```\n\n\nso that option is working to resolve the bug on OpenSolaris too. This looks good to me. \n\nDave",
    "created_at": "2011-05-07T22:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119586",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Replying to [comment:35 jdemeyer]:
> Can somebody please review?  Thanks.

Sure:


```
drkirkby@hawk:~/sage-4.7.rc0$  ./sage -t  -long -force_lib devel/sage/sage/interfaces/rubik.py
sage -t -long -force_lib "devel/sage/sage/interfaces/rubik.py"
	 [25.5 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 25.6 seconds
```


so that option is working to resolve the bug on OpenSolaris too. This looks good to me. 

Dave



---

archive/issue_comments_119587.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-05-08T00:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119587",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_011125.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-08T00:28:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11015#event-11125"
}
```



---

archive/issue_comments_119588.json:
```json
{
    "body": "See #11437 for a follow-up.",
    "created_at": "2011-06-07T07:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11015#issuecomment-119588",
    "user": "https://github.com/jdemeyer"
}
```

See #11437 for a follow-up.
