# Issue 11969: Implement finite algebras

Issue created by migration from https://trac.sagemath.org/ticket/12141

Original creator: johanbosman

Original creation time: 2011-12-10 22:12:41

Assignee: AlexGhitza

CC:  mderickx

Finite algebras over fields should be implemented.  A finite algebra `A` is simply given by means of a basis and for each basis element `e` a matrix that describes (right) multiplication of `A` by `e`.


---

Comment by johanbosman created at 2011-12-20 13:33:12

Changing keywords from "" to "sd35".


---

Attachment

Lots of things to do still:
 * Properly put it in a Category.
 * Implement ideals and morphisms.


---

Attachment

Added an associativity check.


---

Attachment


---

Comment by mkosters created at 2011-12-21 16:38:48

Many new functions


---

Attachment


---

Attachment

I've uploaded an improvement of the associativity check, but it does need further improvement.


---

Attachment


---

Comment by johanbosman created at 2011-12-23 23:11:54

Don't apply this yet; it contains bugs, but I messed up my hg.


---

Attachment

Now both ideal patches can be applied, together with #11068


---

Comment by johanbosman created at 2011-12-24 00:09:33

Basic ideal stuff has also been uploaded now.  Still to add: more doctests and support for sidedness in the non-commutative case.


---

Comment by mkosters created at 2011-12-25 20:32:45

Adds some functionality. Apply 12141,  improve_ass and fix_random...


---

Attachment

In the new patch you can check if an element is a zero divisor, do a base change and check if an element is nilpotent (it also fixes the power function if there is no one etc).

`@`Johanbosman: Can you merge the files? Is my nilpotent check the easiest one?


---

Comment by johanbosman created at 2011-12-26 19:04:51

Contains #11068 and all its dependencies, for convenience


---

Attachment

Replaces all previous patches on this ticket


---

Comment by johanbosman created at 2011-12-26 19:56:53

Replying to [comment:6 mkosters]:
> In the new patch you can check if an element is a zero divisor, do a base change and check if an element is nilpotent (it also fixes the power function if there is no one etc).
> 
> `@`Johanbosman: Can you merge the files? Is my nilpotent check the easiest one?
I've uploaded a combined patch.  A few remarks about documentation:

 * Please be more precise:  Is your inverse a left or right inverse?  Same question about zero divisors, etc.
 * In the first line of a docstring, put the verb in the imperative (not extremely important, but more direct and grammatically better than "Returns blabla" without a subject).
 * Put a blank line between the double colon and the doctests (used for html generation of documentation).


---

Attachment

replaces all previous patches


---

Comment by aapitzsch created at 2011-12-28 22:49:51

Could you change

```
raise *Error, "..."
```

to

```
raise *Error("...")
```

so we don't have to do it when switching to Python 3.


---

Comment by pbruin created at 2013-06-20 11:13:40

based on 5.10.rc2; revised most of the code


---

Comment by pbruin created at 2013-06-20 11:17:30

Changing keywords from "sd35" to "".


---

Attachment

To be done: morphisms, more things related to ideals


---

Attachment

morphisms, categorification, doctests


---

Comment by pbruin created at 2013-06-21 10:15:33

Changing status from new to needs_review.


---

Comment by pbruin created at 2013-06-21 10:15:33

I added the class FiniteAlgebraMorphism and functionality for primary decomposition, mostly written by Johan Bosman.  FiniteAlgebras over a field _k_ are now members of the (existing) category FiniteDimensionalAlgebrasWithBasis(_k_).  The code is fully doctest-covered.


---

Comment by johanbosman created at 2013-06-21 21:07:17

Changing status from needs_review to needs_work.


---

Comment by johanbosman created at 2013-06-21 21:07:17

I haven't tested any of this yet, but in the code there seem to be a few things that could be improved:
* Checking associativity is time-consuming.  Since most algebras we'll be applying this to are associative anyway, it may be wise to be able to set a flag indicating the algebra is associative without explicit verification.
* Validity check for homomorphisms seems not very fast either.  Code that constructs homomorphisms, like `quotient_map`, can probably be sped up by putting `check=False` in there.
* Does primary decomposition depend on assumptions like associativity and commutativity?  Perhaps an error should be raised if these conditions aren't met.  Also check this for other functions.


---

Comment by pbruin created at 2013-06-22 11:04:54

Replying to [comment:12 johanbosman]:
> I haven't tested any of this yet, but in the code there seem to be a few things that could be improved:

Thanks for your suggestions.  I should probably have let you look at it _before_ asking for a review. :-)

I thought about including some of these things, but decided that having a usable framework was the first priority.  But you are certainly right that these improvements should be made.  They shouldn't take a lot of work.


---

Comment by pbruin created at 2013-06-29 22:14:03

based on 5.11.beta3


---

Comment by pbruin created at 2013-06-29 22:16:32

Changing status from needs_work to needs_review.


---

Attachment

The above things should be fixed now.  Everything is in [attachment:trac_12141-FiniteAlgebra.patch].


---

Comment by mderickx created at 2013-07-02 18:59:35

Changing keywords from "" to "sd51".


---

Comment by pbruin created at 2013-07-15 21:27:28

For patchbot:

Apply trac_12141-FiniteAlgebra.patch


---

Comment by pbruin created at 2013-07-17 07:36:47


```
Apply trac_12141-FiniteAlgebra.patch 
```



---

Comment by pbruin created at 2014-01-17 22:55:30

No actual changes, just converted the patch to a Git branch.


---

Comment by tscrim created at 2014-02-03 20:53:21

Okay, I've done a review and it looks good overall. However when running some of the test suites, I realized that the morphisms weren't setup like the others in Sage, so I've reworked them in my review. It's not perfect, but IMO morphisms in general need some work. Other than that, it's some documentation and minor code tweaks. If you're happy with my changes, then it's a positive review.
----
New commits:


---

Comment by jhpalmieri created at 2014-02-03 22:11:22

I think that the phrase "finite algebra" is possibly ambiguous. For example, there is a book _Structure of Finite Algebras_ by Hobby and McKenzie in which a finite algebra is actually finite as a set. Maybe "finite-dimensional algebra" would be better in your situation.


---

Comment by git created at 2014-02-04 01:42:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-02-04 01:42:51

Good point. Done.


---

Comment by pbruin created at 2014-02-10 14:55:10

Hi Travis,
> Okay, I've done a review and it looks good overall. However when running some of the test suites, I realized that the morphisms weren't setup like the others in Sage, so I've reworked them in my review. It's not perfect, but IMO morphisms in general need some work. Other than that, it's some documentation and minor code tweaks. If you're happy with my changes, then it's a positive review.
Thanks for looking at this.  To me, changing "finite" to "finite-dimensional" is OK; in commutative algebra and algebraic geometry it is very common to say "finite _A_-algebra" for an algebra that is finitely generated as an _A_-module, but in a general setting like Sage, it is possibly ambiguous.  Since the base ring is (at least currently) always a field, "finite-dimensional" is an acceptable way of clarifying this.

I haven't had the time to review your changes in detail, but here are a few things I noticed:
- you changed "EXAMPLE::" to "EXAMPLES::" in many places where there is only one example; do you have a reason for this?
- I think it should be "finite-dimensional algebra", not "finite dimensional algebra", since "finite-dimensional" is used as a single adjective.
- Are you sure that the inverse of an element should be cached?  This looks like it could waste a lot of memory.  My impression is that in general only properties of parents should be cached.  If any inverse should be cached at all, why not just that of the underlying matrix?


---

Comment by tscrim created at 2014-02-10 16:08:33

Hey Peter,

Replying to [comment:25 pbruin]:
> I haven't had the time to review your changes in detail, but here are a few things I noticed:
> - you changed "EXAMPLE::" to "EXAMPLES::" in many places where there is only one example; do you have a reason for this?

As I understand it, `EXAMPLES::` (and `TESTS::`) is the standard idiom, not the singular version even if there is only one such example. Although I seem to have missed some that I should also change to be consistent, unless you feel that I should change them back (I don't hold a strong opinion on this).

> - I think it should be "finite-dimensional algebra", not "finite dimensional algebra", since "finite-dimensional" is used as a single adjective.

Will change.

> - Are you sure that the inverse of an element should be cached?  This looks like it could waste a lot of memory.  My impression is that in general only properties of parents should be cached.  If any inverse should be cached at all, why not just that of the underlying matrix?

It depends. Things that are very memory/computationally intensive to compute but not to store are candidates for a cache, especially when it's likely to be a bottleneck.

Also it's not using much more memory by caching the element as opposed to the matrix (nor does it generate a memory leak). So let's say `x^-1 = y`, then `x` has `y` stored in its cache. So once you delete `x`, you also delete the cache containing `y`. Perhaps what we should do is have a ``@`lazy_attribute` called `_inverse` which will point to `y`, and then if we construct `x^-1`, we can set `y._inverse = x`.

The other option if you're worried about memory usage is to make it a ``@`weak_cached_function`, which allows it to be garbage collected if there is no strong reference to `x^-1` and memory is needed elsewhere.


---

Comment by git created at 2014-02-10 18:50:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-02-10 18:52:09

I've changed the inverses to use the ``@`lazy_attribute` and so `y._inverse` is automatically set when calling `x._inverse`. Everything is now `EXAMPLES::` and "finite-dimensional".


---

Comment by pbruin created at 2014-02-10 19:40:23

Replying to [comment:28 tscrim]:
> I've changed the inverses to use the ``@`lazy_attribute` and so `y._inverse` is automatically set when calling `x._inverse`. Everything is now `EXAMPLES::` and "finite-dimensional".
Actually I had forgotten that the inverse was already cached in the first place thanks to `_inverse`...  Anyway, I do like your idea of using ``@`lazy_attribute` for this.

As for `EXAMPLE[S]` and `TEST[S]`, it is true that the documentation only mentions the plural and this is used predominantly in the Sage library, but I don't see any reason for preferring the plural regardless of the actual number of examples/tests.  I don't feel too strongly about it either, but in general I wouldn't recommend to a reviewer to make such changes when it comes to matters of taste.  (Although this only applies here if `EXAMPLE[S]` is indeed a matter of taste.)

I will try to do a final check soon, unless someone else does it first.


---

Comment by git created at 2014-02-11 21:47:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-02-22 13:32:48

OK, I'm happy with the state of this ticket.  All test pass; I also ran some existing external code that uses this ticket and it still works fine after the various changes that were made here.


---

Comment by pbruin created at 2014-02-22 13:32:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-03-01 08:48:17

Resolution: fixed
