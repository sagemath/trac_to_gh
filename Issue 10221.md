# Issue 10221: Bernoulli polynomial problem

Issue created by migration from Trac.

Original creator: davidloeffler

Original creation time: 2010-11-05 13:44:18

Assignee: malb

CC:  craigcitro

Keywords: bernoulli

The "bernoulli_polynomial" command should return the nth Bernoulli polynomial evaluated at the first argument, but something odd happens when you feed it a polynomial that's not a single variable:

```
sage: R.<x> = QQ[]
sage: bernoulli_polynomial(x, 2)
x^2 - x + 1/6
sage: bernoulli_polynomial(x - 1, 2)
x^2 - x + 1/6
sage: bernoulli_polynomial(R(0), 2)
x^2 - x + 1/6
```






---

Comment by fwclarke created at 2010-11-11 11:17:39

Changing status from new to needs_review.


---

Comment by fwclarke created at 2010-11-11 11:17:39

In the attached patch I have rewritten most of the !`bernoulli_polynomial` code. Â This solves this problem.

In the case where the result is a polynomial, direct calculation from the list of coefficients is retained (for speed), but corrected for the case where x is not the variable.  This only works when the base ring is a QQ-algebra; previously an error was raised it if wasn't.

A small increase in speed results from the odd Bernoulli numbers being zero, apart from the first.   This is more significant in the non-polynomial case.

A couple of new doctests have been added.


---

Attachment

With the new patch, it not only gets the right answer, but it does so faster than it previously got the wrong answer. Can't argue with that.


---

Comment by davidloeffler created at 2010-12-07 16:00:42

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-01-26 22:27:01

Resolution: fixed
