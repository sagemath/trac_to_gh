# Issue 10221: Bernoulli polynomial problem

archive/issues_010221.json:
```json
{
    "body": "Assignee: @malb\n\nCC:  @craigcitro\n\nKeywords: bernoulli\n\nThe \"bernoulli_polynomial\" command should return the nth Bernoulli polynomial evaluated at the first argument, but something odd happens when you feed it a polynomial that's not a single variable:\n\n```\nsage: R.<x> = QQ[]\nsage: bernoulli_polynomial(x, 2)\nx^2 - x + 1/6\nsage: bernoulli_polynomial(x - 1, 2)\nx^2 - x + 1/6\nsage: bernoulli_polynomial(R(0), 2)\nx^2 - x + 1/6\n```\n\n\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10222\n\n",
    "created_at": "2010-11-05T13:44:18Z",
    "labels": [
        "component: commutative algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "Bernoulli polynomial problem",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10221",
    "user": "https://github.com/loefflerd"
}
```
Assignee: @malb

CC:  @craigcitro

Keywords: bernoulli

The "bernoulli_polynomial" command should return the nth Bernoulli polynomial evaluated at the first argument, but something odd happens when you feed it a polynomial that's not a single variable:

```
sage: R.<x> = QQ[]
sage: bernoulli_polynomial(x, 2)
x^2 - x + 1/6
sage: bernoulli_polynomial(x - 1, 2)
x^2 - x + 1/6
sage: bernoulli_polynomial(R(0), 2)
x^2 - x + 1/6
```





Issue created by migration from https://trac.sagemath.org/ticket/10222





---

archive/issue_comments_103852.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-11-11T11:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10221",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10221#issuecomment-103852",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_103853.json:
```json
{
    "body": "In the attached patch I have rewritten most of the !`bernoulli_polynomial` code. \u00a0This solves this problem.\n\nIn the case where the result is a polynomial, direct calculation from the list of coefficients is retained (for speed), but corrected for the case where x is not the variable.  This only works when the base ring is a QQ-algebra; previously an error was raised it if wasn't.\n\nA small increase in speed results from the odd Bernoulli numbers being zero, apart from the first.   This is more significant in the non-polynomial case.\n\nA couple of new doctests have been added.",
    "created_at": "2010-11-11T11:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10221",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10221#issuecomment-103853",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

In the attached patch I have rewritten most of the !`bernoulli_polynomial` code. Â This solves this problem.

In the case where the result is a polynomial, direct calculation from the list of coefficients is retained (for speed), but corrected for the case where x is not the variable.  This only works when the base ring is a QQ-algebra; previously an error was raised it if wasn't.

A small increase in speed results from the odd Bernoulli numbers being zero, apart from the first.   This is more significant in the non-polynomial case.

A couple of new doctests have been added.



---

archive/issue_comments_103854.json:
```json
{
    "body": "Attachment [trac_10222.patch](tarball://root/attachments/some-uuid/ticket10222/trac_10222.patch) by @loefflerd created at 2010-12-07 16:00:42\n\nWith the new patch, it not only gets the right answer, but it does so faster than it previously got the wrong answer. Can't argue with that.",
    "created_at": "2010-12-07T16:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10221",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10221#issuecomment-103854",
    "user": "https://github.com/loefflerd"
}
```

Attachment [trac_10222.patch](tarball://root/attachments/some-uuid/ticket10222/trac_10222.patch) by @loefflerd created at 2010-12-07 16:00:42

With the new patch, it not only gets the right answer, but it does so faster than it previously got the wrong answer. Can't argue with that.



---

archive/issue_comments_103855.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-12-07T16:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10221",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10221#issuecomment-103855",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_103856.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-26T22:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10221",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10221#issuecomment-103856",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_010339.json:
```json
{
    "actor": "@jdemeyer",
    "created_at": "2011-01-26T22:27:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10221",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10221#event-10339"
}
```
