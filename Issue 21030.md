# Issue 21030: Port SageNB widgets/interact to Jupyter

archive/issues_021030.json:
```json
{
    "body": "CC:  @EmmanuelCharpentier\n\nSupport old SageNB widgets in Jupyter notebooks. This is done by writing small wrapper functions with the old SageNB names returning `ipywidgets` widgets. That is, we essentially do\n\n```\ndef input_box(...):\n    return ipywidgets.Text(...)\n```\n\n\nWe also try to support the old SageNB ``@`interact` functionality. Many examples of SageNB interacts can be found on https://wiki.sagemath.org/interact and we try to support as much as possible in Jupyter without changes in the user code.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21267\n\n",
    "created_at": "2016-08-17T15:54:10Z",
    "labels": [
        "component: notebook"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Port SageNB widgets/interact to Jupyter",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21030",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @EmmanuelCharpentier

Support old SageNB widgets in Jupyter notebooks. This is done by writing small wrapper functions with the old SageNB names returning `ipywidgets` widgets. That is, we essentially do

```
def input_box(...):
    return ipywidgets.Text(...)
```


We also try to support the old SageNB ``@`interact` functionality. Many examples of SageNB interacts can be found on https://wiki.sagemath.org/interact and we try to support as much as possible in Jupyter without changes in the user code.

Issue created by migration from https://trac.sagemath.org/ticket/21267





---

archive/issue_comments_291089.json:
```json
{
    "body": "Are there any API conflicts? And if yes, how are we dealing with that? Separate ``@`jupyterinteract` or what? A global switch?",
    "created_at": "2016-08-17T20:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291089",
    "user": "https://github.com/vbraun"
}
```

Are there any API conflicts? And if yes, how are we dealing with that? Separate ``@`jupyterinteract` or what? A global switch?



---

archive/issue_comments_291090.json:
```json
{
    "body": "Replying to [comment:1 vbraun]:\n> Are there any API conflicts?\n\nAt least, the API is mostly compatible. I don't know any case where SageNB and Jupyter have significantly different behaviour. For the things that SageNB supports but Jupyter does not, either drop support for that feature or work with upstream to implement the feature in Jupyter. I don't strive to achieve 100% compatibility, I'm happy if it mostly works.\n\nIn some cases, the visual presentation might be different (Jupyter using a drop-down box while SageNB uses something like radio buttons). I don't care about that.\n\nOne potential issue is that SageNB supports all kinds of numbers (`Integer`, `RealNumber`, `Rational`, ...) for sliders while Jupyter only supports `int` and `float`.",
    "created_at": "2016-08-17T21:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291090",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:1 vbraun]:
> Are there any API conflicts?

At least, the API is mostly compatible. I don't know any case where SageNB and Jupyter have significantly different behaviour. For the things that SageNB supports but Jupyter does not, either drop support for that feature or work with upstream to implement the feature in Jupyter. I don't strive to achieve 100% compatibility, I'm happy if it mostly works.

In some cases, the visual presentation might be different (Jupyter using a drop-down box while SageNB uses something like radio buttons). I don't care about that.

One potential issue is that SageNB supports all kinds of numbers (`Integer`, `RealNumber`, `Rational`, ...) for sliders while Jupyter only supports `int` and `float`.



---

archive/issue_comments_291091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-19T16:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291092.json:
```json
{
    "body": "WOW how did I not know about this ticket!",
    "created_at": "2016-09-20T01:34:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291092",
    "user": "https://github.com/kcrisman"
}
```

WOW how did I not know about this ticket!



---

archive/issue_comments_291093.json:
```json
{
    "body": "Replying to [comment:5 kcrisman]:\n> WOW how did I not know about this ticket!  \n\nI'll let you know when I need testers.",
    "created_at": "2016-09-20T06:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291093",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 kcrisman]:
> WOW how did I not know about this ticket!  

I'll let you know when I need testers.



---

archive/issue_comments_291094.json:
```json
{
    "body": "I [posted](https://groups.google.com/forum/#!topic/sage-support/r7XTZ8EIiZs) a temporary workaround for people wanting interactive graphs in Jupyter notebooks using the Sage kernel.",
    "created_at": "2016-09-20T14:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291094",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I [posted](https://groups.google.com/forum/#!topic/sage-support/r7XTZ8EIiZs) a temporary workaround for people wanting interactive graphs in Jupyter notebooks using the Sage kernel.



---

archive/issue_comments_291095.json:
```json
{
    "body": "For the record, I consider this branch mostly feature-complete. It still lacks documentation and tests and the required changes to the `ipywidgets` package.\n\nI have not decided what to do with the upstream situation. There are 3 options:\n- add a whole lot of patches to `build/pkgs/ipywidgets`\n- package the upstream `master` branch\n- wait for `ipywidgets-6` to be released",
    "created_at": "2016-09-20T14:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291095",
    "user": "https://github.com/jdemeyer"
}
```

For the record, I consider this branch mostly feature-complete. It still lacks documentation and tests and the required changes to the `ipywidgets` package.

I have not decided what to do with the upstream situation. There are 3 options:
- add a whole lot of patches to `build/pkgs/ipywidgets`
- package the upstream `master` branch
- wait for `ipywidgets-6` to be released



---

archive/issue_comments_291096.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-20T15:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291096",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291097.json:
```json
{
    "body": "Replying to [comment:2 jdemeyer]:\n> ... I don't strive to achieve 100% compatibility, I'm happy if it mostly works.\n\nI say that it is quite important to work towards such a goal for all interfaces: SageNB, Jupyter, SageMathCloud, SageMathCell. It is highly annoying to develop a nice interact and then discover that it does not work with another interface. Perhaps SageNB can be left behind now, but I hope that other 3 can converge to a single documented standard...",
    "created_at": "2016-09-21T00:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291097",
    "user": "https://github.com/novoselt"
}
```

Replying to [comment:2 jdemeyer]:
> ... I don't strive to achieve 100% compatibility, I'm happy if it mostly works.

I say that it is quite important to work towards such a goal for all interfaces: SageNB, Jupyter, SageMathCloud, SageMathCell. It is highly annoying to develop a nice interact and then discover that it does not work with another interface. Perhaps SageNB can be left behind now, but I hope that other 3 can converge to a single documented standard...



---

archive/issue_comments_291098.json:
```json
{
    "body": "Replying to [comment:11 novoselt]:\n> I say that it is quite important to work towards such a goal for all interfaces: SageNB, Jupyter, SageMathCloud, SageMathCell. It is highly annoying to develop a nice interact and then discover that it does not work with another interface. Perhaps SageNB can be left behind now, but I hope that other 3 can converge to a single documented standard...\n\nI agree that we should *work towards such a goal* but some things are not so easy at the moment. In particular, this patch is re-using the existing widgets from `ipywidgets`, it doesn't add completely new widgets (it doesn't change any Javascript). For example, `ipywidgets` doesn't have a slider with rational numbers so we cannot have that. Luckily, this can be emulated by a slider taking an arbitrary list of values. But this trick does not work for a `range_slider`, so a `range_slider` with rational numbers is not supported here.",
    "created_at": "2016-09-21T07:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291098",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:11 novoselt]:
> I say that it is quite important to work towards such a goal for all interfaces: SageNB, Jupyter, SageMathCloud, SageMathCell. It is highly annoying to develop a nice interact and then discover that it does not work with another interface. Perhaps SageNB can be left behind now, but I hope that other 3 can converge to a single documented standard...

I agree that we should *work towards such a goal* but some things are not so easy at the moment. In particular, this patch is re-using the existing widgets from `ipywidgets`, it doesn't add completely new widgets (it doesn't change any Javascript). For example, `ipywidgets` doesn't have a slider with rational numbers so we cannot have that. Luckily, this can be emulated by a slider taking an arbitrary list of values. But this trick does not work for a `range_slider`, so a `range_slider` with rational numbers is not supported here.



---

archive/issue_comments_291099.json:
```json
{
    "body": "IMHO, sliders behave strangely in SageNB:\n\n```\n@interact\ndef f(x=(1, 10)):\n    print(x, parent(x))\n```\n\nThis gives a slider with floating-point values between 1 and 10. In `ipywidgets`, this would become a slider with integer values between 1 and 10. I think that the `ipywidgets` convention makes more sense here: the type of the variable should correspond to the type in the interact abbrevation (`x=(1, 10)` gives integers while `x=(1.0, 10.0)` gives floats).\n\nOn top of this, this gives Python `float`s while in a Sage context, an element of `RR` would be more appropriate.",
    "created_at": "2016-09-21T08:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291099",
    "user": "https://github.com/jdemeyer"
}
```

IMHO, sliders behave strangely in SageNB:

```
@interact
def f(x=(1, 10)):
    print(x, parent(x))
```

This gives a slider with floating-point values between 1 and 10. In `ipywidgets`, this would become a slider with integer values between 1 and 10. I think that the `ipywidgets` convention makes more sense here: the type of the variable should correspond to the type in the interact abbrevation (`x=(1, 10)` gives integers while `x=(1.0, 10.0)` gives floats).

On top of this, this gives Python `float`s while in a Sage context, an element of `RR` would be more appropriate.



---

archive/issue_comments_291100.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-21T09:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291101.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-21T09:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291101",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291102.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-21T12:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291102",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291103.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-23T10:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_056678.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-01-02T13:54:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21030#event-56678"
}
```



---

archive/issue_comments_291104.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-02T20:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291105.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-03T15:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-05T16:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291107.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-06T16:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291108.json:
```json
{
    "body": "Replying to [comment:30 jdemeyer]:\n\nIs this upgrade ready for review ? Or do you need any form of help before formal review ?",
    "created_at": "2017-01-17T13:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291108",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:30 jdemeyer]:

Is this upgrade ready for review ? Or do you need any form of help before formal review ?



---

archive/issue_comments_291109.json:
```json
{
    "body": "Essentially yes, it's ready.\n\nI didn't formally set the ticket to needs_review because I'd like to wait until the stable release of `ipywidgets` is released.",
    "created_at": "2017-01-17T17:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291109",
    "user": "https://github.com/jdemeyer"
}
```

Essentially yes, it's ready.

I didn't formally set the ticket to needs_review because I'd like to wait until the stable release of `ipywidgets` is released.



---

archive/issue_comments_291110.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-19T15:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291110",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291111.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-21T19:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291111",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291112.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-31T08:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291112",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291113.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-02-24T10:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291113",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_056679.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-02-24T10:48:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21030#event-56679"
}
```



---

archive/issue_events_056680.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-02-24T10:48:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21030#event-56680"
}
```



---

archive/issue_comments_291114.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-02-24T11:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291114",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_291115.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-24T15:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291115",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_291116.json:
```json
{
    "body": "starting with  a freshly fetched 7.6.beta4, ` make distclean && make ptestlong ` passes with one well-known-failure :\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n\nwhich passes when ran standalone.\n\nA couple warnings are repeated in `widgetsnbextension-2.0.0rc1.log` and `ipywidgets-6.0.0.rc2.log` :\n\n```\n/usr/local/sage-exp/local/lib/python2.7/site-packages/setuptools/dist.py:285: UserWarning: Normalizing '2.0.0.rc1' to '2.0.0rc1'\nwarning: manifest_maker: standard file '-c' not found\n/usr/local/sage-exp/local/lib/python2.7/site-packages/setuptools/dist.py:285: UserWarning: Normalizing '6.0.0.rc2' to '6.0.0rc2'\n```\n\n\nwhich look like innocuous booboos.\n\n==> `positive_review `\n\nFor the record : congratulations for this intricate, lengthy and much expected patch. Thank you very much !\n\nI'd recommend expedited inclusion of this update, which should go a long way making the Jupyter notebook as functional as the old one.\n\nI plan to merge this one in my current working branch (which includes #20523 an its dependencies) and give it a couple \"real-life\" functional tests. But unless the results turns out to be non- or barely-functional (which would surprise me), further enhancements should go towards a new ticket.",
    "created_at": "2017-02-24T20:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291116",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

starting with  a freshly fetched 7.6.beta4, ` make distclean && make ptestlong ` passes with one well-known-failure :

```
----------------------------------------------------------------------
sage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed
----------------------------------------------------------------------
```


which passes when ran standalone.

A couple warnings are repeated in `widgetsnbextension-2.0.0rc1.log` and `ipywidgets-6.0.0.rc2.log` :

```
/usr/local/sage-exp/local/lib/python2.7/site-packages/setuptools/dist.py:285: UserWarning: Normalizing '2.0.0.rc1' to '2.0.0rc1'
warning: manifest_maker: standard file '-c' not found
/usr/local/sage-exp/local/lib/python2.7/site-packages/setuptools/dist.py:285: UserWarning: Normalizing '6.0.0.rc2' to '6.0.0rc2'
```


which look like innocuous booboos.

==> `positive_review `

For the record : congratulations for this intricate, lengthy and much expected patch. Thank you very much !

I'd recommend expedited inclusion of this update, which should go a long way making the Jupyter notebook as functional as the old one.

I plan to merge this one in my current working branch (which includes #20523 an its dependencies) and give it a couple "real-life" functional tests. But unless the results turns out to be non- or barely-functional (which would surprise me), further enhancements should go towards a new ticket.



---

archive/issue_comments_291117.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-24T20:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291117",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_291118.json:
```json
{
    "body": "Damn !\n\nfrom the PREP tutorial \"Sage Interact Quickstart\" :\n\n```\nsage: @interact\nsage: def _(f=input_box(x^2,width=20),\n....: color=color_selector(widget='colorpicker', label=\"\"),\n....: axes=True,\n....: fill=True,\n....: zoom=range_slider(-3,3,default=(-3,3))):\n....:     show(plot(f,(x,zoom[0], zoom[1]), color=color, axes=axes,fill=fill, figsize=3))\n```\n\n(I added the `figsize=3`)\n\ngives a **static** fgure, with no controls. I see that in the terminal windows from where I launched the notebook :\n\n```\n[IPKernelApp] WARNING | The installed widget Javascript is the wrong version. It must satisfy the semver range ~2.1.0.\n```\n\nOne hidden dependency ? Something to document (in plain English...) ? \n\nOr something more serious ?\n\nBTW : this works well in the old Sage notebook (same binary, ran from another terminal...).",
    "created_at": "2017-02-24T21:07:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291118",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Damn !

from the PREP tutorial "Sage Interact Quickstart" :

```
sage: @interact
sage: def _(f=input_box(x^2,width=20),
....: color=color_selector(widget='colorpicker', label=""),
....: axes=True,
....: fill=True,
....: zoom=range_slider(-3,3,default=(-3,3))):
....:     show(plot(f,(x,zoom[0], zoom[1]), color=color, axes=axes,fill=fill, figsize=3))
```

(I added the `figsize=3`)

gives a **static** fgure, with no controls. I see that in the terminal windows from where I launched the notebook :

```
[IPKernelApp] WARNING | The installed widget Javascript is the wrong version. It must satisfy the semver range ~2.1.0.
```

One hidden dependency ? Something to document (in plain English...) ? 

Or something more serious ?

BTW : this works well in the old Sage notebook (same binary, ran from another terminal...).



---

archive/issue_comments_291119.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-24T21:07:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291119",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_291120.json:
```json
{
    "body": "Replying to [comment:47 charpent]:\n> Damn !\n> \n> from the PREP tutorial \"Sage Interact Quickstart\" :\n> {{{\n> sage: `@`interact\n> sage: def _(f=input_box(x^2,width=20),\n> ....: color=color_selector(widget='colorpicker', label=\"\"),\n> ....: axes=True,\n> ....: fill=True,\n> ....: zoom=range_slider(-3,3,default=(-3,3))):\n> ....:     show(plot(f,(x,zoom[0], zoom[1]), color=color, axes=axes,fill=fill, figsize=3))\n> }}}\n> (I added the `figsize=3`)\n> \n> gives a **static** fgure, with no controls. I see that in the terminal windows from where I launched the notebook :\n> {{{\n> [IPKernelApp] WARNING | The installed widget Javascript is the wrong version. It must satisfy the semver range ~2.1.0.\n> }}}\n> One hidden dependency ? Something to document (in plain English...) ?\n\nYour example works for me. My guess is that it's something like a browser cache which might interfere. Can you try clearing the cache and try again?",
    "created_at": "2017-02-25T07:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291120",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:47 charpent]:
> Damn !
> 
> from the PREP tutorial "Sage Interact Quickstart" :
> {{{
> sage: `@`interact
> sage: def _(f=input_box(x^2,width=20),
> ....: color=color_selector(widget='colorpicker', label=""),
> ....: axes=True,
> ....: fill=True,
> ....: zoom=range_slider(-3,3,default=(-3,3))):
> ....:     show(plot(f,(x,zoom[0], zoom[1]), color=color, axes=axes,fill=fill, figsize=3))
> }}}
> (I added the `figsize=3`)
> 
> gives a **static** fgure, with no controls. I see that in the terminal windows from where I launched the notebook :
> {{{
> [IPKernelApp] WARNING | The installed widget Javascript is the wrong version. It must satisfy the semver range ~2.1.0.
> }}}
> One hidden dependency ? Something to document (in plain English...) ?

Your example works for me. My guess is that it's something like a browser cache which might interfere. Can you try clearing the cache and try again?



---

archive/issue_comments_291121.json:
```json
{
    "body": "Replying to [comment:48 jdemeyer]:\n> Replying to [comment:47 charpent]:\n[ Snip ...]\n> Your example works for me. My guess is that it's something like a browser cache which might \ninterfere. Can you try clearing the cache and try again?\n\nDone. Same result.\n\nI might have another problem : when I type \"SAGE_BROWSER=chromium sage -n jupyter\", Sage still opens a Firefox sheet.\n\nLogging out of this sheet, manually opening Chromium, and pasting the address given in the controlling terminal window allows to open the same sheet in Chrome, with the **same** result.\n\nSuggestions ?",
    "created_at": "2017-02-25T09:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291121",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:48 jdemeyer]:
> Replying to [comment:47 charpent]:
[ Snip ...]
> Your example works for me. My guess is that it's something like a browser cache which might 
interfere. Can you try clearing the cache and try again?

Done. Same result.

I might have another problem : when I type "SAGE_BROWSER=chromium sage -n jupyter", Sage still opens a Firefox sheet.

Logging out of this sheet, manually opening Chromium, and pasting the address given in the controlling terminal window allows to open the same sheet in Chrome, with the **same** result.

Suggestions ?



---

archive/issue_comments_291122.json:
```json
{
    "body": "One more data point : same results (incl. Firefox starting with SAGE_BROWSER=\"chromium\") after rebooting ths whole hawg...\n\nI'm at loss.",
    "created_at": "2017-02-25T09:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291122",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

One more data point : same results (incl. Firefox starting with SAGE_BROWSER="chromium") after rebooting ths whole hawg...

I'm at loss.



---

archive/issue_comments_291123.json:
```json
{
    "body": "Replying to [comment:49 charpent]:\n> Suggestions ?\n\nThis is most likely not Sage-related, so please report this issue upstream to ipywidgets: \nhttps://github.com/ipython/ipywidgets/issues",
    "created_at": "2017-02-25T19:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291123",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:49 charpent]:
> Suggestions ?

This is most likely not Sage-related, so please report this issue upstream to ipywidgets: 
https://github.com/ipython/ipywidgets/issues



---

archive/issue_comments_291124.json:
```json
{
    "body": "Replying to [comment:51 jdemeyer]:\n> Replying to [comment:49 charpent]:\n> > Suggestions ?\n> \n> This is most likely not Sage-related, so please report this issue upstream to ipywidgets: \n> https://github.com/ipython/ipywidgets/issues\n\nThis is now ipywidget's [issue 1611](https://github.com/ipython/ipywidgets/issues/1161).",
    "created_at": "2017-02-25T20:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291124",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:51 jdemeyer]:
> Replying to [comment:49 charpent]:
> > Suggestions ?
> 
> This is most likely not Sage-related, so please report this issue upstream to ipywidgets: 
> https://github.com/ipython/ipywidgets/issues

This is now ipywidget's [issue 1611](https://github.com/ipython/ipywidgets/issues/1161).



---

archive/issue_comments_291125.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-27T10:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291125",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291126.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-28T10:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291126",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_291127.json:
```json
{
    "body": "Replying to [comment:47 charpent]:\n> {{{\n> [IPKernelApp] WARNING | The installed widget Javascript is the wrong version. It must satisfy the semver range ~2.1.0.\n> }}}\n\nDo you happen to have another installation of `ipywidgets`/`widgetsnbextension` which might interfere?\n\nI'm setting this back to needs_review because I cannot reproduce your problem. I hope that other people will try it, so we can see if it works for them.",
    "created_at": "2017-02-28T10:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291127",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:47 charpent]:
> {{{
> [IPKernelApp] WARNING | The installed widget Javascript is the wrong version. It must satisfy the semver range ~2.1.0.
> }}}

Do you happen to have another installation of `ipywidgets`/`widgetsnbextension` which might interfere?

I'm setting this back to needs_review because I cannot reproduce your problem. I hope that other people will try it, so we can see if it works for them.



---

archive/issue_comments_291128.json:
```json
{
    "body": "I tried your patch on two different installations (one physical machine, one pristine VM) where it succeeded. Coming back to my initial test case, I took the speps to remove entierely ipywidgets an widgetsnbextension from the systemwide installs. Theren your patch worked.\n\nI conclude that, somehow, the systemwide installation(s) of Python extensions take precedence over a sage-specific installation. hence a couple questions :\n* Is that expected or is that a bug ?\n* If a bug, does it deserve a ticket ?\n* If expected (not a bug), shouldn't this behavior be documented ?\n\nIn any case, This lifts my objections ==> `positive_review`.\n\nAnd kudos !",
    "created_at": "2017-03-01T08:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291128",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I tried your patch on two different installations (one physical machine, one pristine VM) where it succeeded. Coming back to my initial test case, I took the speps to remove entierely ipywidgets an widgetsnbextension from the systemwide installs. Theren your patch worked.

I conclude that, somehow, the systemwide installation(s) of Python extensions take precedence over a sage-specific installation. hence a couple questions :
* Is that expected or is that a bug ?
* If a bug, does it deserve a ticket ?
* If expected (not a bug), shouldn't this behavior be documented ?

In any case, This lifts my objections ==> `positive_review`.

And kudos !



---

archive/issue_comments_291129.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-01T08:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291129",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_291130.json:
```json
{
    "body": "Upstream is aware of issues with conflicting installations. In fact that's why I made the suggestion in [comment:55] to check other installations.",
    "created_at": "2017-03-01T09:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291130",
    "user": "https://github.com/jdemeyer"
}
```

Upstream is aware of issues with conflicting installations. In fact that's why I made the suggestion in [comment:55] to check other installations.



---

archive/issue_comments_291131.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-02T17:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291131",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_056681.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-02T17:43:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21030#event-56681"
}
```



---

archive/issue_comments_291132.json:
```json
{
    "body": "`@` Jeroen: quick question, I notice you have added two patches for `ipywidgets`. Are those upstreamed? If so can you give some references?",
    "created_at": "2017-03-02T21:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291132",
    "user": "https://github.com/kiwifb"
}
```

`@` Jeroen: quick question, I notice you have added two patches for `ipywidgets`. Are those upstreamed? If so can you give some references?



---

archive/issue_comments_291133.json:
```json
{
    "body": "Replying to [comment:59 fbissey]:\n> `@` Jeroen: quick question, I notice you have added two patches for `ipywidgets`.\n\nActually, there are 3 patches. Two of them (`get_interact_value_output.patch` and `output_exception.patch`) should be in https://pypi.python.org/pypi/ipywidgets/6.0.0.rc3\n\nThe other one (`widget_repr.patch`) is being discussed at https://github.com/ipython/ipywidgets/pull/1031 but upstream isn't very happy about it. However, this one is really only relevant for doctesting, not for runtime functionality.",
    "created_at": "2017-03-03T06:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291133",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:59 fbissey]:
> `@` Jeroen: quick question, I notice you have added two patches for `ipywidgets`.

Actually, there are 3 patches. Two of them (`get_interact_value_output.patch` and `output_exception.patch`) should be in https://pypi.python.org/pypi/ipywidgets/6.0.0.rc3

The other one (`widget_repr.patch`) is being discussed at https://github.com/ipython/ipywidgets/pull/1031 but upstream isn't very happy about it. However, this one is really only relevant for doctesting, not for runtime functionality.



---

archive/issue_comments_291134.json:
```json
{
    "body": "Replying to [comment:60 jdemeyer]:\n> Replying to [comment:59 fbissey]:\n> > `@` Jeroen: quick question, I notice you have added two patches for `ipywidgets`.\n> \n> Actually, there are 3 patches. Two of them (`get_interact_value_output.patch` and `output_exception.patch`) should be in https://pypi.python.org/pypi/ipywidgets/6.0.0.rc3\n> \n\nOK, good!\n\n> The other one (`widget_repr.patch`) is being discussed at https://github.com/ipython/ipywidgets/pull/1031 but upstream isn't very happy about it. However, this one is really only relevant for doctesting, not for runtime functionality.\n\nOK, I missed that one completely, I suppose that is why I have \n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/repl/ipython_kernel/widgets.py\", line 349, in sage.repl.ipython_kernel.widgets.Grid.__init__\nFailed example:\n    w\nExpected:\n    Grid(value=[[0, 1], [4, 5]], description=u'2x2 matrix', children=(Label(value=u'2x2 matrix'), VBox(children=(EvalText(value=u'0'), EvalText(value=u'4'))), VBox(children=(EvalText(value=u'1'), EvalText(value=u'5')))))\nGot:\n    <sage.repl.ipython_kernel.widgets.Grid object at 0x7f8d65145f90>\n```\n\nAnd indeed it doesn't seem to have an impact on functionality.",
    "created_at": "2017-03-03T06:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291134",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:60 jdemeyer]:
> Replying to [comment:59 fbissey]:
> > `@` Jeroen: quick question, I notice you have added two patches for `ipywidgets`.
> 
> Actually, there are 3 patches. Two of them (`get_interact_value_output.patch` and `output_exception.patch`) should be in https://pypi.python.org/pypi/ipywidgets/6.0.0.rc3
> 

OK, good!

> The other one (`widget_repr.patch`) is being discussed at https://github.com/ipython/ipywidgets/pull/1031 but upstream isn't very happy about it. However, this one is really only relevant for doctesting, not for runtime functionality.

OK, I missed that one completely, I suppose that is why I have 

```
File "/usr/lib64/python2.7/site-packages/sage/repl/ipython_kernel/widgets.py", line 349, in sage.repl.ipython_kernel.widgets.Grid.__init__
Failed example:
    w
Expected:
    Grid(value=[[0, 1], [4, 5]], description=u'2x2 matrix', children=(Label(value=u'2x2 matrix'), VBox(children=(EvalText(value=u'0'), EvalText(value=u'4'))), VBox(children=(EvalText(value=u'1'), EvalText(value=u'5')))))
Got:
    <sage.repl.ipython_kernel.widgets.Grid object at 0x7f8d65145f90>
```

And indeed it doesn't seem to have an impact on functionality.



---

archive/issue_comments_291135.json:
```json
{
    "body": "Follow-up: #22550, please review",
    "created_at": "2017-03-08T11:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291135",
    "user": "https://github.com/jdemeyer"
}
```

Follow-up: #22550, please review



---

archive/issue_comments_291136.json:
```json
{
    "body": "I updated the description to reflect recent changes in upstream ipywidgets.",
    "created_at": "2017-05-17T16:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291136",
    "user": "https://github.com/jasongrout"
}
```

I updated the description to reflect recent changes in upstream ipywidgets.



---

archive/issue_comments_291137.json:
```json
{
    "body": "Thanks for the pointers, I will certainly follow up on this (but maybe not right now).",
    "created_at": "2017-05-18T09:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21030",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21030#issuecomment-291137",
    "user": "https://github.com/jdemeyer"
}
```

Thanks for the pointers, I will certainly follow up on this (but maybe not right now).
