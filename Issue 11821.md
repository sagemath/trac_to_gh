# Issue 11821: Fix output of `sage --version`

archive/issues_011821.json:
```json
{
    "body": "Assignee: leif\n\nCC:  jhpalmieri\n\nKeywords: banner\n\nThe one who was aiming at the *Useless Use of `cat` Award* ![1] unfortunately did some wrong escaping, so we currently get for example:\n\n```sh\n$ ./sage --version\n* Warning: this is a prerelease version, and it may be unstable.     *\n```\n\n| Sage Version 4.7.2.alpha3-pre7-without-examples, Release Date: 2011-09-28 |\nAlso, I don't think the second line should be printed, hence the new version also case-sensitively \"greps\" for `Version`, such that we get:\n\n```sh\n$ ./sage --version\nSage Version 4.7.2.alpha3-pre7-without-examples, Release Date: 2011-09-28\n```\n\n\n----\n\n![1] http://partmaps.org/era/unix/award.html\n\nSee also [The Tragedy of Bash](http://uselessuseofcat.com/?p=346).\n\nIssue created by migration from https://trac.sagemath.org/ticket/11993\n\n",
    "created_at": "2011-11-05T07:42:20Z",
    "labels": [
        "scripts",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Fix output of `sage --version`",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11821",
    "user": "leif"
}
```
Assignee: leif

CC:  jhpalmieri

Keywords: banner

The one who was aiming at the *Useless Use of `cat` Award* ![1] unfortunately did some wrong escaping, so we currently get for example:

```sh
$ ./sage --version
* Warning: this is a prerelease version, and it may be unstable.     *
```

| Sage Version 4.7.2.alpha3-pre7-without-examples, Release Date: 2011-09-28 |
Also, I don't think the second line should be printed, hence the new version also case-sensitively "greps" for `Version`, such that we get:

```sh
$ ./sage --version
Sage Version 4.7.2.alpha3-pre7-without-examples, Release Date: 2011-09-28
```


----

![1] http://partmaps.org/era/unix/award.html

See also [The Tragedy of Bash](http://uselessuseofcat.com/?p=346).

Issue created by migration from https://trac.sagemath.org/ticket/11993





---

archive/issue_comments_135194.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-11-05T07:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135194",
    "user": "leif"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_135195.json:
```json
{
    "body": "While we're at it, one for you to review...",
    "created_at": "2011-11-05T07:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135195",
    "user": "leif"
}
```

While we're at it, one for you to review...



---

archive/issue_comments_135196.json:
```json
{
    "body": "In case someone should insist on the second line also getting printed, here we go:\n\n```sh\nsed -n -e '/[Vv]ersion/s/\\(^[ |*]\\+\\)\\|\\([ |*]\\+$\\)//gp' ...\n```\n",
    "created_at": "2011-11-05T08:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135196",
    "user": "leif"
}
```

In case someone should insist on the second line also getting printed, here we go:

```sh
sed -n -e '/[Vv]ersion/s/\(^[ |*]\+\)\|\([ |*]\+$\)//gp' ...
```




---

archive/issue_comments_135197.json:
```json
{
    "body": "Changing keywords from \"banner\" to \"banner sage-sage\".",
    "created_at": "2011-11-05T08:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135197",
    "user": "leif"
}
```

Changing keywords from "banner" to "banner sage-sage".



---

archive/issue_comments_135198.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-11-05T17:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135198",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_135199.json:
```json
{
    "body": "On sage.math:\n\n```\n$ sage -v\nSage Version 4.7.2.alpha4, Release Date: 2011-10-11\n$\n```\n\nOn OS X:\n\n```\n$ sage -v\n$\n```\n\nSame thing happens on Solaris and OpenSolaris.  You must be using some GNUisms in your invocation of sed.",
    "created_at": "2011-11-05T17:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135199",
    "user": "jhpalmieri"
}
```

On sage.math:

```
$ sage -v
Sage Version 4.7.2.alpha4, Release Date: 2011-10-11
$
```

On OS X:

```
$ sage -v
$
```

Same thing happens on Solaris and OpenSolaris.  You must be using some GNUisms in your invocation of sed.



---

archive/issue_comments_135200.json:
```json
{
    "body": "Attachment [trac_11993-fix_sage_--version.scripts.patch](tarball://root/attachments/some-uuid/ticket11993/trac_11993-fix_sage_--version.scripts.patch) by leif created at 2011-11-05 21:43:54\n\nSCRIPTS repo. Based on Sage 4.7.2.",
    "created_at": "2011-11-05T21:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135200",
    "user": "leif"
}
```

Attachment [trac_11993-fix_sage_--version.scripts.patch](tarball://root/attachments/some-uuid/ticket11993/trac_11993-fix_sage_--version.scripts.patch) by leif created at 2011-11-05 21:43:54

SCRIPTS repo. Based on Sage 4.7.2.



---

archive/issue_comments_135201.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-11-05T21:48:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135201",
    "user": "leif"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_135202.json:
```json
{
    "body": "Replying to [comment:4 jhpalmieri]:\n> You must be using some GNUisms in your invocation of sed.\n\nWhat a terrible failure... 8/\n\nNew patch, same place.",
    "created_at": "2011-11-05T21:48:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135202",
    "user": "leif"
}
```

Replying to [comment:4 jhpalmieri]:
> You must be using some GNUisms in your invocation of sed.

What a terrible failure... 8/

New patch, same place.



---

archive/issue_comments_135203.json:
```json
{
    "body": "As far as I can tell, you don't need the `-e` argument for sed, but it doesn't seem to hurt anything either.\n\nI'm also fine with the decision not to print the second line (\"* Warning...\").",
    "created_at": "2011-11-06T03:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135203",
    "user": "jhpalmieri"
}
```

As far as I can tell, you don't need the `-e` argument for sed, but it doesn't seem to hurt anything either.

I'm also fine with the decision not to print the second line ("* Warning...").



---

archive/issue_comments_135204.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-06T03:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135204",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_135205.json:
```json
{
    "body": "I disagree with makeing here the change\n\n```\nif [ \"$1\" = '-v' -o \"$1\" = '-version' -o \"$1\" = '--version' ]; then \n```\n\nto\n\n```\ncase \"$1\" in\n    -v|-version|--version)\n```\n\n\nI don't disagree with the change itself, just with the fact that\n1. you do it on this ticket\n2. only for this command line option\n\nIf you want to make this change, please do it on a *different* ticket and then for *all* command-line options.",
    "created_at": "2011-11-06T10:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135205",
    "user": "jdemeyer"
}
```

I disagree with makeing here the change

```
if [ "$1" = '-v' -o "$1" = '-version' -o "$1" = '--version' ]; then 
```

to

```
case "$1" in
    -v|-version|--version)
```


I don't disagree with the change itself, just with the fact that
1. you do it on this ticket
2. only for this command line option

If you want to make this change, please do it on a *different* ticket and then for *all* command-line options.



---

archive/issue_comments_135206.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-11-06T10:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135206",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_135207.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> I disagree with makeing here the change...\n\nI don't have a strong feeling about this, but I think your criticism would be more valid if the script sage-sage were a model of consistency and good style; then altering the style of one part would be a bad idea.  But I don't think it is such a model.\n\n> If you want to make this change, please do it on a different ticket and then for all command-line options.\n\nI think that we should work on #21 (using a real argument parser and starting to enforce double-hyphens for long options).  That ticket needs a lot of work \u2014 I'm not sure I like my original approach there, so I may try to rewrite it some day \u2014 but rather than patching style issues in sage-sage, it would be better to put the effort elsewhere.",
    "created_at": "2011-11-06T23:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135207",
    "user": "jhpalmieri"
}
```

Replying to [comment:7 jdemeyer]:
> I disagree with makeing here the change...

I don't have a strong feeling about this, but I think your criticism would be more valid if the script sage-sage were a model of consistency and good style; then altering the style of one part would be a bad idea.  But I don't think it is such a model.

> If you want to make this change, please do it on a different ticket and then for all command-line options.

I think that we should work on #21 (using a real argument parser and starting to enforce double-hyphens for long options).  That ticket needs a lot of work — I'm not sure I like my original approach there, so I may try to rewrite it some day — but rather than patching style issues in sage-sage, it would be better to put the effort elsewhere.



---

archive/issue_comments_135208.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-11-07T10:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135208",
    "user": "jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_135209.json:
```json
{
    "body": "Replying to [comment:8 jhpalmieri]:\n> I don't have a strong feeling about this, but I think your criticism would be more valid if the script sage-sage were a model of consistency and good style;\nActually, I do think it has a consistent bad style.\n\nAt least let's not make it less consistent.\n\nHere is a v2 patch, changing only the command itself, not the option parsing.",
    "created_at": "2011-11-07T10:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135209",
    "user": "jdemeyer"
}
```

Replying to [comment:8 jhpalmieri]:
> I don't have a strong feeling about this, but I think your criticism would be more valid if the script sage-sage were a model of consistency and good style;
Actually, I do think it has a consistent bad style.

At least let's not make it less consistent.

Here is a v2 patch, changing only the command itself, not the option parsing.



---

archive/issue_comments_135210.json:
```json
{
    "body": "Attachment [trac_11993-fix_sage_--version.scripts.v2.patch](tarball://root/attachments/some-uuid/ticket11993/trac_11993-fix_sage_--version.scripts.v2.patch) by jdemeyer created at 2011-11-07 10:21:51",
    "created_at": "2011-11-07T10:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135210",
    "user": "jdemeyer"
}
```

Attachment [trac_11993-fix_sage_--version.scripts.v2.patch](tarball://root/attachments/some-uuid/ticket11993/trac_11993-fix_sage_--version.scripts.v2.patch) by jdemeyer created at 2011-11-07 10:21:51



---

archive/issue_comments_135211.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-07T22:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11821",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11821#issuecomment-135211",
    "user": "jdemeyer"
}
```

Resolution: fixed
