# Issue 11821: Fix output of `sage --version`

Issue created by migration from Trac.

Original creator: leif

Original creation time: 2011-11-05 07:42:20

Assignee: leif

CC:  jhpalmieri

Keywords: banner

The one who was aiming at the _Useless Use of `cat` Award_ ![1] unfortunately did some wrong escaping, so we currently get for example:

```sh
$ ./sage --version
* Warning: this is a prerelease version, and it may be unstable.     *
```

| Sage Version 4.7.2.alpha3-pre7-without-examples, Release Date: 2011-09-28 |
Also, I don't think the second line should be printed, hence the new version also case-sensitively "greps" for `Version`, such that we get:

```sh
$ ./sage --version
Sage Version 4.7.2.alpha3-pre7-without-examples, Release Date: 2011-09-28
```


----

![1] http://partmaps.org/era/unix/award.html

See also [The Tragedy of Bash](http://uselessuseofcat.com/?p=346).


---

Comment by leif created at 2011-11-05 07:50:57

Changing status from new to needs_review.


---

Comment by leif created at 2011-11-05 07:50:57

While we're at it, one for you to review...


---

Comment by leif created at 2011-11-05 08:07:37

In case someone should insist on the second line also getting printed, here we go:

```sh
sed -n -e '/[Vv]ersion/s/\(^[ |*]\+\)\|\([ |*]\+$\)//gp' ...
```



---

Comment by leif created at 2011-11-05 08:19:22

Changing keywords from "banner" to "banner sage-sage".


---

Comment by jhpalmieri created at 2011-11-05 17:53:39

Changing status from needs_review to needs_work.


---

Comment by jhpalmieri created at 2011-11-05 17:53:39

On sage.math:

```
$ sage -v
Sage Version 4.7.2.alpha4, Release Date: 2011-10-11
$
```

On OS X:

```
$ sage -v
$
```

Same thing happens on Solaris and OpenSolaris.  You must be using some GNUisms in your invocation of sed.


---

Attachment

SCRIPTS repo. Based on Sage 4.7.2.


---

Comment by leif created at 2011-11-05 21:48:29

Changing status from needs_work to needs_review.


---

Comment by leif created at 2011-11-05 21:48:29

Replying to [comment:4 jhpalmieri]:
> You must be using some GNUisms in your invocation of sed.

What a terrible failure... 8/

New patch, same place.


---

Comment by jhpalmieri created at 2011-11-06 03:17:58

As far as I can tell, you don't need the `-e` argument for sed, but it doesn't seem to hurt anything either.

I'm also fine with the decision not to print the second line ("* Warning...").


---

Comment by jhpalmieri created at 2011-11-06 03:17:58

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-11-06 10:11:27

I disagree with makeing here the change

```
if [ "$1" = '-v' -o "$1" = '-version' -o "$1" = '--version' ]; then 
```

to

```
case "$1" in
    -v|-version|--version)
```


I don't disagree with the change itself, just with the fact that
 1. you do it on this ticket
 2. only for this command line option

If you want to make this change, please do it on a _different_ ticket and then for _all_ command-line options.


---

Comment by jdemeyer created at 2011-11-06 10:11:27

Changing status from positive_review to needs_work.


---

Comment by jhpalmieri created at 2011-11-06 23:12:54

Replying to [comment:7 jdemeyer]:
> I disagree with makeing here the change...

I don't have a strong feeling about this, but I think your criticism would be more valid if the script sage-sage were a model of consistency and good style; then altering the style of one part would be a bad idea.  But I don't think it is such a model.

> If you want to make this change, please do it on a different ticket and then for all command-line options.

I think that we should work on #21 (using a real argument parser and starting to enforce double-hyphens for long options).  That ticket needs a lot of work — I'm not sure I like my original approach there, so I may try to rewrite it some day — but rather than patching style issues in sage-sage, it would be better to put the effort elsewhere.


---

Comment by jdemeyer created at 2011-11-07 10:17:34

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2011-11-07 10:21:34

Replying to [comment:8 jhpalmieri]:
> I don't have a strong feeling about this, but I think your criticism would be more valid if the script sage-sage were a model of consistency and good style;
Actually, I do think it has a consistent bad style.

At least let's not make it less consistent.

Here is a v2 patch, changing only the command itself, not the option parsing.


---

Attachment


---

Comment by jdemeyer created at 2011-11-07 22:49:36

Resolution: fixed
