# Issue 25084: coxeter3 spkg-install: sed -i is not portable

archive/issues_025084.json:
```json
{
    "body": "CC:  dimpase embray jhpalmieri slelievre vbraun was tscrim\n\nIn `build/pkgs/coxeter3/spkg-install`, the line\n\n```\nsed -i \"s|@SAGE_LOCAL@|$SAGE_LOCAL|g\" directories.h\n```\n\ndoes not work on OS X because `sed -i` is not portable. (It prints an error and continues, and it does not change the file `directories.h`.) On OS X, the following works:\n\n```\nsed -e \"s|@SAGE_LOCAL@|$SAGE_LOCAL|g\" -i '' directories.h\n```\n\nbut I'm not sure this works with GNU sed.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25321\n\n",
    "created_at": "2018-05-09T23:21:58Z",
    "labels": [
        "packages: standard",
        "minor",
        "bug"
    ],
    "title": "coxeter3 spkg-install: sed -i is not portable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25084",
    "user": "jhpalmieri"
}
```
CC:  dimpase embray jhpalmieri slelievre vbraun was tscrim

In `build/pkgs/coxeter3/spkg-install`, the line

```
sed -i "s|@SAGE_LOCAL@|$SAGE_LOCAL|g" directories.h
```

does not work on OS X because `sed -i` is not portable. (It prints an error and continues, and it does not change the file `directories.h`.) On OS X, the following works:

```
sed -e "s|@SAGE_LOCAL@|$SAGE_LOCAL|g" -i '' directories.h
```

but I'm not sure this works with GNU sed.

Issue created by migration from https://trac.sagemath.org/ticket/25321





---

archive/issue_comments_353033.json:
```json
{
    "body": "See https://stackoverflow.com/questions/5694228/sed-in-place-flag-that-works-both-on-mac-bsd-and-linux for some information (perhaps accurate?) about `sed` on BSD/OSX vs. GNU/Linux.",
    "created_at": "2018-05-09T23:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353033",
    "user": "jhpalmieri"
}
```

See https://stackoverflow.com/questions/5694228/sed-in-place-flag-that-works-both-on-mac-bsd-and-linux for some information (perhaps accurate?) about `sed` on BSD/OSX vs. GNU/Linux.



---

archive/issue_comments_353034.json:
```json
{
    "body": "Does someone know a portable invocation of sed that would work here?\nOtherwise, could we detect the OS, and use an appropriate invocation?",
    "created_at": "2018-07-11T11:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353034",
    "user": "slelievre"
}
```

Does someone know a portable invocation of sed that would work here?
Otherwise, could we detect the OS, and use an appropriate invocation?



---

archive/issue_comments_353035.json:
```json
{
    "body": "Changing keywords from \"\" to \"coxeter3, sed, macOS\".",
    "created_at": "2018-07-11T11:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353035",
    "user": "slelievre"
}
```

Changing keywords from "" to "coxeter3, sed, macOS".



---

archive/issue_comments_353036.json:
```json
{
    "body": "Incredible...\n\nUse Perl instead?",
    "created_at": "2018-07-11T11:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353036",
    "user": "embray"
}
```

Incredible...

Use Perl instead?



---

archive/issue_comments_353037.json:
```json
{
    "body": "The stackoverflow link explains how to do it.",
    "created_at": "2018-07-11T14:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353037",
    "user": "vbraun"
}
```

The stackoverflow link explains how to do it.



---

archive/issue_comments_353038.json:
```json
{
    "body": "Let me know when you send a PR, and I will merge it.",
    "created_at": "2018-07-11T15:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353038",
    "user": "tscrim"
}
```

Let me know when you send a PR, and I will merge it.



---

archive/issue_comments_353039.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-11T17:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353039",
    "user": "jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_353040.json:
```json
{
    "body": "This works on OS X. I don't know about linux or cygwin.\n----\nNew commits:",
    "created_at": "2018-07-11T17:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353040",
    "user": "jhpalmieri"
}
```

This works on OS X. I don't know about linux or cygwin.
----
New commits:



---

archive/issue_comments_353041.json:
```json
{
    "body": "To check, run `./sage -i -s coxeter3` and then see if the file `local/var/tmp/sage/build/coxeter3-.../src/directories.h` contains ``@`SAGE_LOCAL`@`` or actual paths. It is supposed to contain paths.",
    "created_at": "2018-07-11T17:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353041",
    "user": "jhpalmieri"
}
```

To check, run `./sage -i -s coxeter3` and then see if the file `local/var/tmp/sage/build/coxeter3-.../src/directories.h` contains ``@`SAGE_LOCAL`@`` or actual paths. It is supposed to contain paths.



---

archive/issue_comments_353042.json:
```json
{
    "body": "Replying to [comment:1 jhpalmieri]:\n> See https://stackoverflow.com/questions/5694228/sed-in-place-flag-that-works-both-on-mac-bsd-and-linux\n> for some information (perhaps accurate?) about `sed` on BSD/OSX vs. GNU/Linux.\n\nThe [answer by kine](https://stackoverflow.com/a/22084103) to that\nStackOverflow question creates an extra file that then needs to be deleted.\n\nThe [answer by nwinkler](https://stackoverflow.com/a/51060063) there\nmight be better, but it has had no upvotes at StackOverflow.",
    "created_at": "2018-07-11T21:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353042",
    "user": "slelievre"
}
```

Replying to [comment:1 jhpalmieri]:
> See https://stackoverflow.com/questions/5694228/sed-in-place-flag-that-works-both-on-mac-bsd-and-linux
> for some information (perhaps accurate?) about `sed` on BSD/OSX vs. GNU/Linux.

The [answer by kine](https://stackoverflow.com/a/22084103) to that
StackOverflow question creates an extra file that then needs to be deleted.

The [answer by nwinkler](https://stackoverflow.com/a/51060063) there
might be better, but it has had no upvotes at StackOverflow.



---

archive/issue_comments_353043.json:
```json
{
    "body": "The extra file is in a temporary build directory, so unless you use the `-s` flag when installing, who cares? And if you do use the `-s` flag, you probably know what you're doing.",
    "created_at": "2018-07-11T22:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353043",
    "user": "jhpalmieri"
}
```

The extra file is in a temporary build directory, so unless you use the `-s` flag when installing, who cares? And if you do use the `-s` flag, you probably know what you're doing.



---

archive/issue_comments_353044.json:
```json
{
    "body": "Ping?",
    "created_at": "2018-09-04T21:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353044",
    "user": "jhpalmieri"
}
```

Ping?



---

archive/issue_comments_353045.json:
```json
{
    "body": "LGTM",
    "created_at": "2018-09-04T22:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353045",
    "user": "dimpase"
}
```

LGTM



---

archive/issue_comments_353046.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-04T22:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353046",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_353047.json:
```json
{
    "body": "Replying to [comment:5 tscrim]:\n> Let me know when you send a PR, and I will merge it.\n\nThis is a change to the `spkg-install` file, not to the actual coxeter3 package. So no PR to merge.",
    "created_at": "2018-09-04T22:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353047",
    "user": "jhpalmieri"
}
```

Replying to [comment:5 tscrim]:
> Let me know when you send a PR, and I will merge it.

This is a change to the `spkg-install` file, not to the actual coxeter3 package. So no PR to merge.



---

archive/issue_comments_353048.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-06T07:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25084#issuecomment-353048",
    "user": "vbraun"
}
```

Resolution: fixed
