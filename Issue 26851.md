# Issue 26851: better conversion of univariate polynomials from Fricas

Issue created by migration from https://trac.sagemath.org/ticket/27088

Original creator: chapoton

Original creation time: 2019-01-21 14:06:37

CC:  mantepse

Keywords: fricas




---

Comment by chapoton created at 2019-01-21 14:07:14

New commits:


---

Comment by git created at 2019-01-21 14:08:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-01-21 14:08:19

Changing status from new to needs_review.


---

Comment by mantepse created at 2019-01-21 15:21:30

Thanks for adding this.  It is unfortunate that the FriCAS domain `SingletonAsOrderedSet` does not have an `InputForm`, which implies that `UnivariatePolynomial` and `SparseUnivariatePolynomial` also don't.  Maybe this will change at some point.

Anyway, currently you are not testing this:

```
sage: x = polygen(QQ, 'x')
sage: fricas(x+3)
x + 3
sage: fricas(x+3).domainOf()
Polynomial(Integer())
```


I think you want

```
sage: f = fricas("(y^2+3)::UP(y, INT)").sage(); f
y^2 + 3
sage: f.parent()
Univariate Polynomial Ring in y over Integer Ring
```



---

Comment by git created at 2019-01-21 15:46:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-01-21 15:49:20

I have added some doctests..


---

Comment by mantepse created at 2019-01-21 17:15:58

It doesn't quite work yet, but that may actually belong to a different ticket:

```
sage: fricas("(y^2+3*x)::UP(y, UP(x, INT))").sage()
...
NotImplementedError: The translation of FriCAS type (UnivariatePolynomial x (Integer)) to sage is not yet implemented.

sage: fricas("(y^2+sqrt 3)::UP(y, AN)").sage()
...
TypeError: Illegal initializer for algebraic number

sage: fricas("(y^2+sqrt 3)::POLY(AN)").sage()
  File "<string>", line unknown
SyntaxError: Malformed expression
```


That's a bit strange, because I thought I have tested such constructions!


---

Comment by git created at 2019-01-21 19:52:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-01-22 07:12:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-01-23 08:16:16

Martin, is this good enough ?


---

Comment by mantepse created at 2019-01-23 10:10:56

I'm on it, please excuse the delay!


---

Comment by mantepse created at 2019-01-23 11:18:21

Excellent!  I tested this a fair bit, modified one test to check nested types and I made some very cosmetic changes.

If all this is OK for you, please set it to positive review on my behalf!  And thanks again!

I'll deal with the `Polynomial` bug in a separate ticket, but probably I'll wait for fricas 1.3.5 to come out first, to avoid more merge conflicts with #25899
----
New commits:


---

Comment by chapoton created at 2019-01-23 12:31:04

missing one optional fricas here:
`sage: fricas(0)._get_sage_type(m)`


---

Comment by git created at 2019-01-23 12:36:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2019-01-23 12:37:21

Oops, merci beaucoup !


---

Comment by chapoton created at 2019-01-23 14:41:14

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-01-23 14:41:14

ok, let it be. Danke sch√∂n !


---

Comment by vbraun created at 2019-01-26 15:53:44

Resolution: fixed
