# Issue 20163: Conversion NumberField -> QQbar should always work for rationals

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2016-04-09 17:16:57

CC:  mmezzarobba

After #14485 we have

```
sage: NF.<alpha> = NumberField(x^5 + 7*x + 3)
sage: QQbar(alpha**5 + 7*alpha)
Traceback (most recent call last):
...
ValueError: need a real or complex embedding to convert number field
element to algebraic number
```

but rationals are non ambiguous with respect to their embeddings.


---

Comment by vdelecroix created at 2016-04-09 17:19:46

I propose

```
`@``@` -2373,8 +2374,7 `@``@` cdef class NumberFieldElement(FieldElement):
         """
         emb = self._parent.coerce_embedding()
         if emb is None:
-            raise ValueError("need a real or complex embedding to convert "
-                             "number field element to algebraic number")
+            return parent(self._rational_())
```

And also to wait for the next beta...


---

Comment by tmonteil created at 2016-04-11 14:18:21

I think that you should still have a `try except` statement with an adapted message.

Otherwise the error message will be:


```
TypeError: Unable to coerce alpha to a rational
```


which might end up as "Uh, i know that it is not a rational, i was asking for an algebraic !".


---

Comment by vdelecroix created at 2016-04-27 22:39:25

Changing status from new to needs_review.


---

Comment by git created at 2016-04-27 22:39:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tmonteil created at 2016-04-27 23:08:01

Looks good to me, i kicked the patchbot to see if some problem appears elsewhere.


---

Comment by vdelecroix created at 2016-04-28 13:02:13

Patchbot is happy!


---

Comment by tmonteil created at 2016-04-29 09:34:42

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-05-01 16:30:26

Resolution: fixed
