# Issue 28601: sage -sws2rst broken

Issue created by migration from https://trac.sagemath.org/ticket/28838

Original creator: tmonteil

Original creation time: 2019-12-03 19:43:45

CC:  vbraun dimpase kcrisman jhpalmieri

An important feature is to still be able to handle old `.sws` worksheets because a lot of pedagogical material was written on that format. With `9.0.beta8` (Python 3 by default), when i try:


```
sage -sws2rst worksheet.sws
```


i got:


```
ModuleNotFoundError: No module named 'sagenb'
```


Fair enough, i can still install `sagenb`. But then, the same command leads to:


```
ImportError: BeautifulSoup must be installed.
```


If try to install `BeautifulSoup`, which seems Python2 specific, i got:


```
"You're trying to run a very old release of Beautiful Soup under Python 3. This will not work."<>"Please use Beautiful Soup 4, available through the pip package 'beautifulsoup4'."
```


I can install `beautifulsoup4`, but it does not solve the issue since it is for Python 3.

Of course `sagenb` is written for Python 2, and migrating it to Python 3 would require too much work.

So, i guess the best solution would be to extract and translate the required material from `sagenb` to `sage` that would let `sage -sws2rst` work.


---

Comment by fbissey created at 2019-12-03 21:36:35

Is converting `.sws` file covered by `sagenb_export`?


---

Comment by tmonteil created at 2019-12-04 12:05:07

It seems not directly: after a quick look, the script seems to parse the html page, but maybe it could try to parse the html that belongs to the .sws archive (not sure if it has the same structure). Let me CC Volker for a better understanding of what is doable.


---

Comment by chapoton created at 2019-12-04 15:49:47

Here is a first sketch. The moved files are not at the level of sage requirements, as many doctests are missing. If this matters for you, please take the job.

----
New commits:


---

Comment by tmonteil created at 2019-12-08 22:17:46

Shouldn't this go to a subdirectory of `src/ext/` (e.g. `src/ext/sws2rst/`) ?


---

Comment by chapoton created at 2019-12-09 08:02:05

Salut Thierry.

Feel free to put it anywhere you like. I am not going to do anything more here.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-08-13 16:56:07

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-08-13 16:56:07

outdated, sws stuff was removed in #30076


---

Comment by tmonteil created at 2020-08-13 18:05:28

It is even more important now that there is no `sagenb` anymore, while there are still `sws` files that people might want to convert (e.g. from a former course). I will try to work on this.


---

Comment by tmonteil created at 2020-08-13 18:05:28

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2020-08-13 18:39:15

it needs sagenb, a non-starter.


---

Comment by dimpase created at 2020-08-13 18:39:15

Changing status from needs_work to positive_review.


---

Comment by tmonteil created at 2020-08-13 19:02:24

Changing status from positive_review to needs_work.


---

Comment by tmonteil created at 2020-08-13 19:02:24

Replying to [comment:10 dimpase]:
> it needs sagenb, a non-starter.

It only needs a small part of it (see Frédéric's patch), and the feature is still needed.


---

Comment by mkoeppe created at 2020-08-13 19:06:43

Given that this has extra dependencies (`beautifulsoup`) that we have just removed, this should really be packaged as a pip-installable little package and NOT be put into `sage.misc`.


---

Comment by dimpase created at 2020-08-13 21:21:44

I don't see why such an extraction cannot be carried out in a version of Sage where this tool still works.


---

Comment by mkoeppe created at 2020-08-13 22:05:34

It seems like a great idea to me to provide this converter - as long as this code is not dumped into sagelib.


---

Comment by mkoeppe created at 2020-08-15 13:56:26

I'll be happy to help with packaging


---

Comment by mkoeppe created at 2020-08-17 16:13:00

Replying to [comment:9 tmonteil]:
> It is even more important now that there is no `sagenb` anymore, while there are still `sws` files that people might want to convert (e.g. from a former course). I will try to work on this.

Any progress?


---

Comment by mkoeppe created at 2020-08-18 17:08:56

How is this different from `sagenb_export` by the way?
----
New commits:


---

Comment by git created at 2020-08-19 04:24:40

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2020-08-19 04:28:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-08-19 04:36:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-08-19 04:37:44

It would be good to add a few test documents to the package.


---

Comment by git created at 2020-08-19 04:55:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kcrisman created at 2020-08-19 17:50:17

> How is this different from `sagenb_export` by the way?

This gives `rst` files which are quite useful for e.g. adding to Sage documentation.  That was some of the main use before.

Is this basically Pablo's stuff modified for Py3?  It looks like it's a required package, is that correct?


---

Comment by mkoeppe created at 2020-08-19 18:04:45

Replying to [comment:26 kcrisman]:
> > How is this different from `sagenb_export` by the way?
> 
> This gives `rst` files which are quite useful for e.g. adding to Sage documentation.  That was some of the main use before.

Thanks.

> Is this basically Pablo's stuff modified for Py3?

I don't know. I just moved files around that were on this ticket already.

>   It looks like it's a required package, is that correct?

No, I made it an optional package, see `build/pkgs/sage_sws2rst/type`


---

Comment by dimpase created at 2020-08-20 09:10:11

Replying to [comment:26 kcrisman]:
> > How is this different from `sagenb_export` by the way?
> 
> This gives `rst` files which are quite useful for e.g. adding to Sage documentation.  That was some of the main use before.

Jupiter's nbconvert provides conversion to rst. https://nbconvert.readthedocs.io/en/latest/
Thus, once sws is converted to jupyter, one can convert further, and the package created here is not needed.


---

Comment by kcrisman created at 2020-08-20 12:31:26

I suppose there is question as to whether the diagram commutes ...


---

Comment by mkoeppe created at 2020-08-20 12:40:39

As so often in Sage, this is a complex question - are there real users for this feature, or only imaginary users.


---

Comment by kcrisman created at 2020-08-20 13:00:48

At this point, unknown.  I think this would be a small enough constituency if Dima's suggestion is good that we could use that.  So if someone tested a few nontrivial `sws` worksheets and the result was usable and had roughly the same structure, I would think we could then provide this in documentation (perhaps adding something to the `sagenb_export` public-facing doc).

Of course, if this ticket is actually ready to go, maybe that's a moot point.


---

Comment by mkoeppe created at 2020-08-20 13:37:35

The ticket is not ready to go because I have no way of testing it. If you or someone else could contribute some sws files that we can use as a little testsuite for this package, it will be easy to finish up.


---

Comment by kcrisman created at 2020-08-20 15:41:05

> The ticket is not ready to go because I have no way of testing it. If you or someone else could contribute some sws files that we can use as a little testsuite for this package, it will be easy to finish up.

Sure thing.  Trac keeps kicking me off when I try to upload attachments, so I will send them to you under separate cover - my apologies.  Feel free to attach here, of course.


---

Comment by git created at 2020-08-20 18:25:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-08-20 18:30:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-08-20 18:35:12

I added one of the test worksheets from Karl-Dieter.

After `sage -i tox`, the code can now be tested with it using 

```
./sage -sh -c '(cd build/pkgs/sage_sws2rst/src && tox -v -v)'
```

It will need adjustments for python 3 and for the beautifulsoup 3->4 upgrade.
Currently it fails as follows:

```
  File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sage_sws2rst/src/.tox/python/lib/python3.7/site-packages/sage_sws2rst/comments2rst.py", line 146, in replace_latex
    parts = single_dollar.split(unicode(t))
NameError: name 'unicode' is not defined
```



---

Comment by mkoeppe created at 2020-08-20 18:37:52

I'll stop here for now


---

Comment by mkoeppe created at 2020-08-23 23:09:24

Thierry, please feel free to take over from here...


---

Comment by git created at 2020-09-04 23:16:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-04 23:17:37

This version seems to work to some extent.


---

Comment by git created at 2020-09-04 23:26:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-04 23:29:46

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-09-04 23:29:46

For each processed file, there are a number of warnings `Warning: node not supported (or something else?) None`. I don't know if this is a problem.


---

Comment by git created at 2020-09-04 23:34:14

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by git created at 2020-09-05 00:08:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-05 18:12:01

https://doc.sagemath.org/html/en/thematic_tutorials/sws2rst.html needs updating


---

Comment by git created at 2020-09-05 18:28:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-05 18:57:16

It has been a while I used the sagenb, but doing a `find . -name *.sws` on my machine made me rediscover few .sws including some available online. I copy the link below if it may be useful for testing:

```
http://slabbe.org/Sage/2010-perpignan/CIRM_Tutoriel_3_francais.sws
http://slabbe.org/Sage/2010-perpignan/Sage_tour_horizon.sws
http://slabbe.org/Sage/2010-perpignan/CIRM_Tutorial_3.sws
http://slabbe.org/Sage/2010-perpignan/5, 6, 100.sws
http://slabbe.org/Sage/2010-perpignan/La_Suite_Un.sws
http://slabbe.org/Sage/2010-perpignan/Outils de dessins.sws
http://slabbe.org/Sage/2010-perpignan/CIRM_Tutorial_1.sws
http://slabbe.org/Sage/2010-perpignan/CIRM_Tutoriel_1_francais.sws
http://slabbe.org/Sage/2010-days25.5-tutoriel1.sws
http://slabbe.org/Sage/2010-11-python-montreal-sage-demo.sws
http://slabbe.org/Sage/2009-canadam-sagewords.sws
```

I guess we can find more sws files in the wiki.sagemath.org


---

Comment by slabbe created at 2020-09-05 20:39:27

I get an error while building the doc:

```
[dochtml] Error building the documentation.
...
[dochtml] OSError: 
/home/slabbe/GitBox/sage/src/doc/en/thematic_tutorials/sws2rst.rst: 
WARNING: document isn't included in any toctree
```


... but I confirm that doc builds correctly *after* running `sage -i sage_sws2rst`


---

Comment by dimpase created at 2020-09-05 20:57:20

There is a typo in 

```
--- a/src/doc/en/thematic_tutorials/index.rst
+++ b/src/doc/en/thematic_tutorials/index.rst
@@ -119,6 +119,8 @@ Advanced Programming
 Documentation
 =============
 
+* :ref:`sws2srt`
+
 .. Sage development
 .. ----------------
```


- it should say `sws2rst`, obviously


---

Comment by dimpase created at 2020-09-05 20:57:39

Changing status from needs_review to needs_work.


---

Comment by slabbe created at 2020-09-05 21:00:55

Doing `sage -sws2rst CIRM_Tutorial_1.sws` creates a rst file with still a *lot* of html stuff. Is it normal? or beautiful soup does not eat the soup well?

Also doing `rst2html.py CIRM_Tutorial_1.rst` gives lots of warning of the kind


```
CIRM_Tutorial_1.rst:83: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
...
```


because a line is missing. More precisely


```
.. end of output
<html><head></head><body></body></html>
```


should be better as:


```
.. end of output

<html><head></head><body></body></html>
```



---

Comment by mkoeppe created at 2020-09-05 21:06:10

All - please feel free to contribute to the branch


---

Comment by slabbe created at 2020-09-06 09:44:25

I wrote the rst2txt and rst2sws long time ago, but sws2rst is more work (parsing html is so fun). The sws2rst script was written thanks to Pablo Angulo at the time. Let me try to spend some (limited) time on it.

Question: how does the `sage -n export` work? does it go through rst?


---

Comment by slabbe created at 2020-09-06 09:49:35

adding two commits fixing two of the issues.

But there are still a lot of html in the result. Also, warnings are printed during the execution. Maybe the way we call beautiful soup needs to be improved?


```
$ sage -sws2rst CIRM_Tutorial_1.sws 
Processing CIRM_Tutorial_1.sws
/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage_sws2rst/comments2rst.py:396:
GuessedAtParserWarning: No parser was explicitly specified, so I'm using the 
best available HTML parser for this system ("html5lib"). This usually isn't a 
problem, but if you run this code on another system, or in a different virtual 
environment, it may use a different parser and behave differently.

The code that caused this warning is on line 396 of the file 
/home/slabbe/GitBox/sage/local/lib/python3.7/site-packages/sage_sws2rst/comments2rst.py. 
To get rid of this warning, pass the additional argument 'features="html5lib"'
to the BeautifulSoup constructor.

  soup = BeautifulSoup(text,
Warning: node not supported (or something else?) html
Warning: node not supported (or something else?) html
Warning: node not supported (or something else?) html
...
Warning: node not supported (or something else?) html
Warning: node not supported (or something else?) html
Warning: node not supported (or something else?) html
File at CIRM_Tutorial_1.rst
Image directory at CIRM_Tutorial_1_media
```

----
New commits:


---

Comment by git created at 2020-09-06 09:59:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-06 10:04:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-06 10:09:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-06 10:24:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-06 10:25:06

The goal is now to make the following to work:


```
$ sage -t --optional=sage,beautifulsoup build/pkgs/sage_sws2rst/src/sage_sws2rst
...
-----------------------------------------------------------
sage -t --random-seed=0 build/pkgs/sage_sws2rst/src/sage_sws2rst/comments2rst.py  # 8 doctests failed
-----------------------------------------------------------
```


For example:


```
**********************************************************************
File "comments2rst.py", line 135, in sage_sws2rst.comments2rst.replace_latex
Failed example:
    s # optional - beautifulsoup
Expected:
    <p>Some <strong>latex: :math:`e^\pi i=-1`</strong></p>
Got:
    <html><head></head><body><p>Some <strong>latex:  :math:`e^\pi i=-1`</strong></p></body></html>
**********************************************************************
File "comments2rst.py", line 139, in sage_sws2rst.comments2rst.replace_latex
Failed example:
    s # optional - beautifulsoup
Expected:
    <p><strong>2\+2 \| 1\+3</strong></p>
Got:
    <html><head></head><body><p><strong>2\+2 \| 1\+3</strong></p></body></html>
**********************************************************************
```



---

Comment by git created at 2020-09-06 13:02:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-06 13:04:17


```
$ sage -t --optional=sage,beautifulsoup build/pkgs/sage_sws2rst/src/sage_sws2rst/
```

now gives

```
Doctesting 4 files.
sage -t --random-seed=0 build/pkgs/sage_sws2rst/src/sage_sws2rst/__init__.py
    [0 tests, 0.00 s]
sage -t --random-seed=0 build/pkgs/sage_sws2rst/src/sage_sws2rst/results2rst.py
    [6 tests, 0.01 s]
sage -t --random-seed=0 build/pkgs/sage_sws2rst/src/sage_sws2rst/comments2rst.py
    [30 tests, 0.07 s]
sage -t --random-seed=0 build/pkgs/sage_sws2rst/src/sage_sws2rst/worksheet2rst.py
    [0 tests, 0.00 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```



---

Comment by slabbe created at 2020-09-06 13:12:54

This now looks much better with no html code in the generated rst file. For example:


```
$ wget http://slabbe.org/Sage/2010-perpignan/CIRM_Tutorial_1.sws
$ sage -sws2rst CIRM_Tutorial_1.sws
Processing CIRM_Tutorial_1.sws
File at CIRM_Tutorial_1.rst
Image directory at CIRM_Tutorial_1_media
$ rst2html.py CIRM_Tutorial_1.rst CIRM_Tutorial_1.html
CIRM_Tutorial_1.rst:182: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
CIRM_Tutorial_1.rst:269: (WARNING/2) Inline strong start-string without end-string.
CIRM_Tutorial_1.rst:343: (WARNING/2) Inline strong start-string without end-string.
$ open CIRM_Tutorial_1.html 
```


The above means few ReStructuredText syntax errors are present in the generated rst file...

Also, it now looks like `.. end of output` is followed by more than one empty lines now. So let me remove the new lines I added few commits before.


---

Comment by git created at 2020-09-06 13:15:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-06 13:44:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-06 13:50:22

Ok, so, to me, this is good enough. The remaining issues are neglectable and easy to fix by hand by the user knowing ReStructuredText syntax.

I give a positive review to all commits before mines.

Few commits I did today now need review.

Question: is `sage -t --optional=sage,beautifulsoup build/pkgs/sage_sws2rst/src/sage_sws2rst/` going to be tested by the normal `sage -t -a`? (i'm not used with these kind of optional but included packages)


---

Comment by slabbe created at 2020-09-06 14:00:46

Changing status from needs_work to needs_review.


---

Comment by git created at 2020-09-06 18:11:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-06 18:13:08

The doctests now run when you install the package with SAGE_CHECK=yes


---

Comment by slabbe created at 2020-09-06 20:04:02

Great!

Let me add a commit...


---

Comment by git created at 2020-09-06 20:08:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-06 20:14:10

I am trying to run the tests with SAGE_CHECK, but before that I now get


```
$ make sage_sws2rst
...
[sage_sws2rst-none] /home/slabbe/GitBox/sage/build/pkgs/sage_sws2rst/spkg-install: 6: source: not found
[sage_sws2rst-none] Error: failed to source /home/slabbe/GitBox/sage/build/bin/sage-dist-helpers
[sage_sws2rst-none] Is /home/slabbe/GitBox/sage the correct SAGE_ROOT?
...
***************************************************************
Error building Sage.

The following package(s) may have failed to build (not necessarily
during this run of 'make sage_sws2rst'):

* package:         sage_sws2rst-none
  last build time: sept. 6 22:09
  log file:        /home/slabbe/GitBox/sage/logs/pkgs/sage_sws2rst-none.log
...
```


Same thing if I run `SAGE_CHECK=yes make sage_sws2rst`. Why does it `failed to source`?


---

Comment by mkoeppe created at 2020-09-06 20:24:10

Ah, sorry, I'll fix that


---

Comment by slabbe created at 2020-09-06 20:24:39

So if I undo the change

```diff
-#! /usr/bin/env bash
+#! /bin/sh
```

then I am able to `make sage_sws2rst`. But then `SAGE_CHECK=yes make sage_sws2rst` fails with


```
[sage_sws2rst-none] Successfully installed sage-sws2rst-9.2
[sage_sws2rst-none] Removed build tracker: '/tmp/pip-req-tracker-jp5og0mz'
[sage_sws2rst-none] /home/slabbe/GitBox/sage/build/pkgs/sage_sws2rst/spkg-install: 
ligne 17: ./spkg-check: Aucun fichier ou dossier de ce type
```


Indeed, where is the `spkg-check` file?


---

Comment by git created at 2020-09-06 20:24:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-06 20:25:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-06 20:32:02

`make sage_sws2rst` now gives:


```
[sage_sws2rst-none] /home/slabbe/GitBox/sage/build/pkgs/sage_sws2rst/spkg-install: 
239: /home/slabbe/GitBox/sage/build/bin/sage-dist-helpers: 
Syntax error: "(" unexpected (expecting "}")
```



---

Comment by git created at 2020-09-06 20:33:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-09-06 20:38:57

Good. `make sage_sws2rst` works and `SAGE_CHECK=yes make sage_sws2rst` now gives: 


```
[sage_sws2rst-none] Successfully built sage-sws2rst
[sage_sws2rst-none] Installing collected packages: sage-sws2rst
[sage_sws2rst-none]   Created temporary directory: /tmp/pip-unpacked-wheel-jwcrc2ua
[sage_sws2rst-none] 
[sage_sws2rst-none] Successfully installed sage-sws2rst-9.2
[sage_sws2rst-none] Removed build tracker: '/tmp/pip-req-tracker-w5ksuaxe'
[sage_sws2rst-none] + set -e
[sage_sws2rst-none] + sage-sws2rst -h
[sage_sws2rst-none] + python3 sage_sws2rst/comments2rst.py
[sage_sws2rst-none] + python3 sage_sws2rst/results2rst.py
[sage_sws2rst-none] + cd test
[sage_sws2rst-none] + sage-sws2rst Adding_Pictures_and_screenshots.sws
[sage_sws2rst-none] Processing Adding_Pictures_and_screenshots.sws
[sage_sws2rst-none] File at Adding_Pictures_and_screenshots.rst
[sage_sws2rst-none] Image directory at Adding_Pictures_and_screenshots_media
[sage_sws2rst-none] + sage-sws2rst MAT_141_day_25.sws
[sage_sws2rst-none] Processing MAT_141_day_25.sws
[sage_sws2rst-none] File at MAT_141_day_25.rst
[sage_sws2rst-none] Image directory at MAT_141_day_25_media
touch "/home/slabbe/GitBox/sage/local/var/lib/sage/installed/sage_sws2rst-none"
make[1] : on quitte le répertoire « /home/slabbe/GitBox/sage/build/make »

real	0m3,936s
user	0m3,554s
sys	0m0,403s
Sage build/upgrade complete!
```


Seems good!


---

Comment by slabbe created at 2020-09-06 20:49:17

In a folder with the following makefile:


```
download:
	wget http://slabbe.org/Sage/2010-perpignan/CIRM_Tutoriel_3_francais.sws
	wget http://slabbe.org/Sage/2010-perpignan/Sage_tour_horizon.sws
	wget http://slabbe.org/Sage/2010-perpignan/CIRM_Tutorial_3.sws
	wget "http://slabbe.org/Sage/2010-perpignan/5, 6, 100.sws"
	wget http://slabbe.org/Sage/2010-perpignan/La_Suite_Un.sws
	wget "http://slabbe.org/Sage/2010-perpignan/Outils de dessins.sws"
	wget http://slabbe.org/Sage/2010-perpignan/CIRM_Tutorial_1.sws
	wget http://slabbe.org/Sage/2010-perpignan/CIRM_Tutoriel_1_francais.sws
	wget http://slabbe.org/Sage/2010-days25.5-tutoriel1.sws
	wget http://slabbe.org/Sage/2010-11-python-montreal-sage-demo.sws
	wget http://slabbe.org/Sage/2009-canadam-sagewords.sws

sws2rst:
	sage -sws2rst CIRM_Tutoriel_3_francais.sws
	sage -sws2rst Sage_tour_horizon.sws
	sage -sws2rst CIRM_Tutorial_3.sws
	sage -sws2rst "5, 6, 100.sws"
	sage -sws2rst La_Suite_Un.sws
	sage -sws2rst "Outils de dessins.sws"
	sage -sws2rst CIRM_Tutorial_1.sws
	sage -sws2rst CIRM_Tutoriel_1_francais.sws
	sage -sws2rst 2010-days25.5-tutoriel1.sws
	sage -sws2rst 2010-11-python-montreal-sage-demo.sws
	#sage -sws2rst 2009-canadam-sagewords.sws

rst2html:
	rst2html.py CIRM_Tutoriel_3_francais.rst a.out
	rst2html.py Sage_tour_horizon.rst a.out
	rst2html.py CIRM_Tutorial_3.rst a.out
	rst2html.py 5,_6,_100.rst a.out
	rst2html.py La_Suite_Un.rst a.out
	rst2html.py Outils_de_dessins.rst a.out
	rst2html.py CIRM_Tutorial_1.rst a.out
	rst2html.py CIRM_Tutoriel_1_francais.rst a.out
	rst2html.py 2010-days25.5-tutoriel1.rst a.out
	rst2html.py 2010-11-python-montreal-sage-demo.rst a.out
	#rst2html.py 2009-canadam-sagewords.rst a.out
```

then `make download && make sws2rst` works and

```
make rst2html
```

gives only very few warnings:


```
$ make rst2html 
rst2html.py CIRM_Tutoriel_3_francais.rst a.out
CIRM_Tutoriel_3_francais.rst:781: (WARNING/2) Inline emphasis start-string without end-string.
rst2html.py Sage_tour_horizon.rst a.out
rst2html.py CIRM_Tutorial_3.rst a.out
CIRM_Tutorial_3.rst:754: (WARNING/2) Inline emphasis start-string without end-string.
rst2html.py 5,_6,_100.rst a.out
rst2html.py La_Suite_Un.rst a.out
rst2html.py Outils_de_dessins.rst a.out
rst2html.py CIRM_Tutorial_1.rst a.out
CIRM_Tutorial_1.rst:176: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
CIRM_Tutorial_1.rst:334: (WARNING/2) Inline strong start-string without end-string.
rst2html.py CIRM_Tutoriel_1_francais.rst a.out
CIRM_Tutoriel_1_francais.rst:178: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
CIRM_Tutoriel_1_francais.rst:338: (WARNING/2) Inline strong start-string without end-string.
rst2html.py 2010-days25.5-tutoriel1.rst a.out
2010-days25.5-tutoriel1.rst:149: (WARNING/2) Block quote ends without a blank line; unexpected unindent.
2010-days25.5-tutoriel1.rst:182: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
2010-days25.5-tutoriel1.rst:312: (WARNING/2) Inline strong start-string without end-string.
* Unknown equation environment pmatrix
rst2html.py 2010-11-python-montreal-sage-demo.rst a.out
2010-11-python-montreal-sage-demo.rst:495: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
2010-11-python-montreal-sage-demo.rst:534: (WARNING/2) Explicit markup ends without a blank line; unexpected unindent.
#rst2html.py 2009-canadam-sagewords.rst a.out
```


It is true, that sometimes it does not translates the html properly. For instance, the following paragraph appears in the file CIRM_Tutorial_3.rst:


```
`Project Euler Problem 6 <http://projecteuler.net/index.php?section=problems&id=6>`_
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

<blockquote><p>The sum of the squares of the first ten natural numbers is,</p><div style="text-align: center;">1<img alt="^(" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/><sup>2</sup><img alt=")" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/> \+ 2<img alt="^(" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/><sup>2</sup><img alt=")" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/> \+ ... \+ 10<img alt="^(" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/><sup>2</sup><img alt=")" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/> = 385</div><p>The square of the sum of the first ten natural numbers is,</p><div style="text-align: center;">(1 \+ 2 \+ ... \+ 10)<img alt="^(" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/><sup>2</sup><img alt=")" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/> = 55<img alt="^(" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/><sup>2</sup><img alt=")" src="http://projecteuler.net/index.php?section=problems&id=6" style="display: none;"/> = 3025</div><p>Hence the difference between the sum of the squares of the first ten natural numbers and the square of the sum is 3025 <img alt="−" border="0" height="3" src="http://projecteuler.net/images/symbol_minus.gif" style="vertical-align: middle;" width="9"/> 385 = 2640.</p><p>Find the difference between the sum of the squares of the first one hundred natural numbers and the square of the sum.</p></blockquote>
```


but I am quite sure it was the same problem before. From me it is a positive review.

Let's deal with blockquote and other missing styles in another ticket if somebody finds it desirable.


---

Comment by mkoeppe created at 2020-09-06 21:12:20

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-09-10 20:48:55

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2020-09-10 20:48:55


```
[dochtml] [thematic_] The HTML pages are in local/share/doc/sage/html/en/thematic_tutorials.
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/release/Sage/local/lib/python3.8/runpy.py", line 194, in _run_module_as_main
[dochtml]     return _run_code(code, main_globals, None,
[dochtml]   File "/home/release/Sage/local/lib/python3.8/runpy.py", line 87, in _run_code
[dochtml]     exec(code, run_globals)
[dochtml]   File "/home/release/Sage/local/lib/python3.8/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/home/release/Sage/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 1730, in main
[dochtml]     builder()
[dochtml]   File "/home/release/Sage/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 353, in _wrapper
[dochtml]     build_many(build_other_doc, L)
[dochtml]   File "/home/release/Sage/local/lib/python3.8/site-packages/sage_setup/docbuild/__init__.py", line 296, in build_many
[dochtml]     _build_many(target, args, processes=NUM_THREADS)
[dochtml]   File "/home/release/Sage/local/lib/python3.8/site-packages/sage_setup/docbuild/utils.py", line 289, in build_many
[dochtml]     raise worker_exc.original_exception
[dochtml] OSError: /home/release/Sage/src/doc/en/thematic_tutorials/sws2rst.rst: WARNING: document isn't included in any toctree
```



---

Comment by git created at 2020-09-11 16:10:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-11 16:10:32

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-09-12 23:04:41

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-09-12 23:04:41

Docbuild is fixed, back to positive review


---

Comment by vbraun created at 2020-09-18 20:23:13

Resolution: fixed
