# Issue 33704: implement an inverse to FiniteField.fetch_int()

Issue created by migration from https://trac.sagemath.org/ticket/33941

Original creator: lorenz

Original creation time: 2022-06-01 03:50:24

CC:  @davewittemorris slelievre

Finite fields have `.fetch_int()` to decode integers into finite-field elements by reinterpreting the base-`p` representation as a polynomial:

```sage
sage: F.<t> = GF(7^10)
sage: el = F.fetch_int(2424); el
t^4 + 3*t + 2
```


However, the inverse operation is a bit cumbersome:

```sage
sage: el.polynomial().change_ring(ZZ)(el.parent().characteristic())
2424
```


In this patch, we add an inverse to `.fetch_int()`, named `.to_integer()` in resemblance with the Python method `int.to_bytes()`. Also, some code cleanup and optimization while we're at it.


---

Comment by git created at 2022-06-01 03:56:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2022-06-01 04:00:02

Changing status from new to needs_review.


---

Comment by lorenz created at 2022-06-01 05:15:15

I just found out that #31605 already tracks this issue and that binary finite fields have `.integer_representation()`.

This leaves us with three options for naming these methods:
1. `.fetch_int()` / `.integer_representation()`    [backwards compatible]
2. `.from_integer()` / `.integer_representation()` [one deprecation]
3. `.from_integer()` / `.to_integer()`             [two deprecations]

Personally I'm still in favor of (3) because the others lack symmetry. Opinions?


---

Comment by vdelecroix created at 2022-08-13 10:26:42

Replying to [comment:3 lorenz]:
> I just found out that #31605 already tracks this issue and that binary finite fields have `.integer_representation()`.
> 
> This leaves us with three options for naming these methods:
> 1. `.fetch_int()` / `.integer_representation()`    [backwards compatible]
> 2. `.from_integer()` / `.integer_representation()` [one deprecation]
> 3. `.from_integer()` / `.to_integer()`             [two deprecations]
> 
> Personally I'm still in favor of (3) because the others lack symmetry. Opinions?

+1 to option 3


---

Comment by slelievre created at 2022-08-13 15:29:42

Also +1 for (3) for the sake of symmetry and consistency.


---

Comment by git created at 2022-08-13 15:45:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2022-08-13 15:59:50

Thanks for the responses! It seems the only remaining question is whether we want to deprecate `.integer_representation()` or not.


---

Comment by slelievre created at 2022-08-15 03:36:46

Replying to [comment:8 lorenz]:
> [...] whether [...] to deprecate `.integer_representation()` or not.

The only reason I would see not to would be consistency
with other software.

Do Magma, Maple, Mathematica have similar functions,
and if so how they are named?


---

Comment by lorenz created at 2022-08-16 03:27:19

I don't know. Some quick online searches didn't find anything.


---

Comment by git created at 2022-10-17 15:50:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-11-08 16:05:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-11-25 01:52:40

Replying to [comment:9 Samuel Lelièvre]:
> Do Magma, Maple, Mathematica have similar functions,
> and if so how they are named?

I could not find one for Magma and Maple. Mathematica has `ToElementCode` and `FromElementCode`

I think Sage is the leading software in this regard. No worry for consistency.

+1 to option 3.


---

Comment by git created at 2022-11-25 10:10:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-11-25 10:57:02

Thanks.

One more thing. I think the hyphen in `finite-field element` is legitimate but not really necessary. The hyphen is there to mean "(finite field) element" not "finite (field element)". But sage is mathematics software and there is zero risk that one reads it as "finite (field element)". "finite field", "elliptic curve", "cyclic group", etc are all mathematical terms, and rarely written in two forms (hyphened and not hyphened). For consistency, let us stick to one form. Please reconsider.


---

Comment by git created at 2022-11-25 15:13:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lorenz created at 2022-11-25 15:19:09

Done. (IMHO the hyphens improve readability even when they are not strictly _needed_ to disambiguate, but it's obviously a matter of personal preference.)


---

Comment by git created at 2022-11-26 01:31:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-11-26 01:51:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-11-26 02:00:44

Replying to [comment:18 Lorenz Panny]:
> Done. (IMHO the hyphens improve readability even when they are not strictly _needed_ to disambiguate, but it's obviously a matter of personal preference.)

Thanks! The boundary of consistency and personal preference is blurred and unfortunately is a source of perpetual debates.

I made minor edits on spaces. Otherwise, the branch looks good to me. Set it positive review once tests pass.


---

Comment by lorenz created at 2022-11-26 08:45:31

Bot looks green. Thank you!


---

Comment by lorenz created at 2022-11-26 08:45:31

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-12-11 11:11:41

Resolution: fixed
