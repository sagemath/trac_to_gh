# Issue 23335: doctests for the english translation of the book "Calcul mathématique avec Sage"

archive/issues_023335.json:
```json
{
    "body": "Assignee: @fchapoton\n\nCC:  @mforets @dcoudert @nthiery @vinklein @jhpalmieri\n\nThe purpose of this ticket is to add the doctests corresponding to the examples given in the english translation of the book \"Calcul math\u00e9matique avec Sage\" (see https://members.loria.fr/PZimmermann/sagebook/english.html).\n\nSage already includes doctests for the original version of this book (published in french in 2013). These doctests are in `src/sage/tests/french_book`, and should be updated.\n\nThe final version of the book is now under press, so it is time for adding/updating doctests.\n\n**NOTE**: some doctests are not exactly those from the book. They have been modified (in a minimal manner) so that they will pass when sage is run using python 3.\n\n**bugs found**:\n1. Using `scipy.sparse.lil_matrix` is now broken: #23867\n\nIssue created by migration from https://trac.sagemath.org/ticket/23572\n\n",
    "closed_at": "2019-02-10T12:55:37Z",
    "created_at": "2017-08-02T13:00:19Z",
    "labels": [
        "component: doctest coverage",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "doctests for the english translation of the book \"Calcul math\u00e9matique avec Sage\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23335",
    "user": "https://github.com/zimmermann6"
}
```
Assignee: @fchapoton

CC:  @mforets @dcoudert @nthiery @vinklein @jhpalmieri

The purpose of this ticket is to add the doctests corresponding to the examples given in the english translation of the book "Calcul mathématique avec Sage" (see https://members.loria.fr/PZimmermann/sagebook/english.html).

Sage already includes doctests for the original version of this book (published in french in 2013). These doctests are in `src/sage/tests/french_book`, and should be updated.

The final version of the book is now under press, so it is time for adding/updating doctests.

**NOTE**: some doctests are not exactly those from the book. They have been modified (in a minimal manner) so that they will pass when sage is run using python 3.

**bugs found**:
1. Using `scipy.sparse.lil_matrix` is now broken: #23867

Issue created by migration from https://trac.sagemath.org/ticket/23572





---

archive/issue_comments_326067.json:
```json
{
    "body": "one issue we encounter is the following. The code below differs between Sage 8.0 and Sage 8.1beta3:\n\n```\n   def NearlySingularMatrix(R,n):\n      M=matrix(R,n,n)\n      for i in range(0,n):\n         for j in range(0,n):\n            M[i,j]= (1+log(R(1+i)))/((i+1)^2+(j+1)^2)\n      return M\n   n=35\n   print NearlySingularMatrix(RDF,n).det()\n```\nWith Sage 8.0 we get `0.0`, whereas with Sage 8.1beta3 we get `-0.0`.\nI thought the determinant code was deterministic, and since RDF computations follow IEEE 754, we should get a deterministic answer. How can we get different answers?",
    "created_at": "2017-08-30T08:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326067",
    "user": "https://github.com/zimmermann6"
}
```

one issue we encounter is the following. The code below differs between Sage 8.0 and Sage 8.1beta3:

```
   def NearlySingularMatrix(R,n):
      M=matrix(R,n,n)
      for i in range(0,n):
         for j in range(0,n):
            M[i,j]= (1+log(R(1+i)))/((i+1)^2+(j+1)^2)
      return M
   n=35
   print NearlySingularMatrix(RDF,n).det()
```
With Sage 8.0 we get `0.0`, whereas with Sage 8.1beta3 we get `-0.0`.
I thought the determinant code was deterministic, and since RDF computations follow IEEE 754, we should get a deterministic answer. How can we get different answers?



---

archive/issue_comments_326068.json:
```json
{
    "body": "another issue:\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.0, Release Date: 2017-07-21                     \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nsage: C = graphs.ChvatalGraph()\nsage: from sage.graphs.graph_coloring import edge_coloring\nsage: edge_coloring(C, hex_colors = True)\n\n{'#00ffff': [(0, 6), (1, 5), (2, 8), (3, 4), (7, 11), (9, 10)],\n '#7f00ff': [(0, 4), (1, 7), (2, 6), (3, 9), (5, 11), (8, 10)],\n '#7fff00': [(0, 9), (1, 2), (3, 7), (4, 8), (5, 10), (6, 11)],\n '#ff0000': [(0, 1), (2, 3), (4, 5), (6, 10), (7, 8), (9, 11)]}\n```\nWith Sage 8.1beta3 we get:\n\n```\n    {'#00ffff': [(0, 9), (1, 5), (2, 6), (3, 4), (7, 11), (8, 10)],\n     '#7f00ff': [(0, 1), (2, 8), (3, 7), (4, 5), (6, 10), (9, 11)],\n     '#7fff00': [(0, 4), (1, 2), (3, 9), (5, 10), (6, 11), (7, 8)],\n     '#ff0000': [(0, 6), (1, 7), (2, 3), (4, 8), (5, 11), (9, 10)]}\n```\nIs there a way to get a deterministic answer? Is there any random seed that controls the edge coloring algorithm?",
    "created_at": "2017-08-30T08:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326068",
    "user": "https://github.com/zimmermann6"
}
```

another issue:

```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.0, Release Date: 2017-07-21                     │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
sage: C = graphs.ChvatalGraph()
sage: from sage.graphs.graph_coloring import edge_coloring
sage: edge_coloring(C, hex_colors = True)

{'#00ffff': [(0, 6), (1, 5), (2, 8), (3, 4), (7, 11), (9, 10)],
 '#7f00ff': [(0, 4), (1, 7), (2, 6), (3, 9), (5, 11), (8, 10)],
 '#7fff00': [(0, 9), (1, 2), (3, 7), (4, 8), (5, 10), (6, 11)],
 '#ff0000': [(0, 1), (2, 3), (4, 5), (6, 10), (7, 8), (9, 11)]}
```
With Sage 8.1beta3 we get:

```
    {'#00ffff': [(0, 9), (1, 5), (2, 6), (3, 4), (7, 11), (8, 10)],
     '#7f00ff': [(0, 1), (2, 8), (3, 7), (4, 5), (6, 10), (9, 11)],
     '#7fff00': [(0, 4), (1, 2), (3, 9), (5, 10), (6, 11), (7, 8)],
     '#ff0000': [(0, 6), (1, 7), (2, 3), (4, 8), (5, 11), (9, 10)]}
```
Is there a way to get a deterministic answer? Is there any random seed that controls the edge coloring algorithm?



---

archive/issue_comments_326069.json:
```json
{
    "body": "for comment [comment:3], I'll ask David Coudert who worked on `edge_coloring` in #22564.\n\nPaul",
    "created_at": "2017-08-30T09:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326069",
    "user": "https://github.com/zimmermann6"
}
```

for comment [comment:3], I'll ask David Coudert who worked on `edge_coloring` in #22564.

Paul



---

archive/issue_comments_326070.json:
```json
{
    "body": "The coloring is done with ILP and the result depends on the ILP solver.\n#22564 has been merged in 8.1.beta?? The patch only slightly changes the order in which constraints are added to the ILP and it is enough the get a different solution from 8.0. \n\n```\nsage: from sage.graphs.graph_coloring import edge_coloring\nsage: edge_coloring(C, hex_colors = True, solver='GLPK')\n\n{'#00ffff': [(0, 9), (1, 5), (2, 6), (3, 4), (7, 11), (8, 10)],\n '#7f00ff': [(0, 1), (2, 8), (3, 7), (4, 5), (6, 10), (9, 11)],\n '#7fff00': [(0, 4), (1, 2), (3, 9), (5, 10), (6, 11), (7, 8)],\n '#ff0000': [(0, 6), (1, 7), (2, 3), (4, 8), (5, 11), (9, 10)]}\nsage: edge_coloring(C, hex_colors = True, solver='Cplex')\n\n{'#00ffff': [(0, 6), (1, 5), (2, 3), (4, 8), (7, 11), (9, 10)],\n '#7f00ff': [(0, 1), (2, 6), (3, 4), (5, 10), (7, 8), (9, 11)],\n '#7fff00': [(0, 9), (1, 2), (3, 7), (4, 5), (6, 11), (8, 10)],\n '#ff0000': [(0, 4), (1, 7), (2, 8), (3, 9), (5, 11), (6, 10)]}\nsage: edge_coloring(C, hex_colors = True, solver='PPL')\n\n{'#00ffff': [(0, 9), (1, 5), (2, 8), (3, 4), (6, 10), (7, 11)],\n '#7f00ff': [(0, 6), (1, 7), (2, 3), (4, 5), (8, 10), (9, 11)],\n '#7fff00': [(0, 4), (1, 2), (3, 9), (5, 10), (6, 11), (7, 8)],\n '#ff0000': [(0, 1), (2, 6), (3, 7), (4, 8), (5, 11), (9, 10)]}\nsage: edge_coloring(C, hex_colors = True, solver='Coin')\n\n{'#00ffff': [(0, 4), (1, 5), (2, 6), (3, 9), (7, 11), (8, 10)],\n '#7f00ff': [(0, 6), (1, 2), (3, 7), (4, 8), (5, 10), (9, 11)],\n '#7fff00': [(0, 1), (2, 3), (4, 5), (6, 11), (7, 8), (9, 10)],\n '#ff0000': [(0, 9), (1, 7), (2, 8), (3, 4), (5, 11), (6, 10)]}\nsage: edge_coloring(C, hex_colors = True, solver='Gurobi')\n\n{'#00ffff': [(0, 1), (2, 6), (3, 9), (4, 5), (7, 11), (8, 10)],\n '#7f00ff': [(0, 6), (1, 7), (2, 3), (4, 8), (5, 10), (9, 11)],\n '#7fff00': [(0, 4), (1, 5), (2, 8), (3, 7), (6, 11), (9, 10)],\n '#ff0000': [(0, 9), (1, 2), (3, 4), (5, 11), (6, 10), (7, 8)]}\n```\nIn doctests, you must set the solver to `GLPK`. Otherwise, the default solver is used (e.g., `Cplex` if you have it).",
    "created_at": "2017-08-30T11:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326070",
    "user": "https://github.com/dcoudert"
}
```

The coloring is done with ILP and the result depends on the ILP solver.
#22564 has been merged in 8.1.beta?? The patch only slightly changes the order in which constraints are added to the ILP and it is enough the get a different solution from 8.0. 

```
sage: from sage.graphs.graph_coloring import edge_coloring
sage: edge_coloring(C, hex_colors = True, solver='GLPK')

{'#00ffff': [(0, 9), (1, 5), (2, 6), (3, 4), (7, 11), (8, 10)],
 '#7f00ff': [(0, 1), (2, 8), (3, 7), (4, 5), (6, 10), (9, 11)],
 '#7fff00': [(0, 4), (1, 2), (3, 9), (5, 10), (6, 11), (7, 8)],
 '#ff0000': [(0, 6), (1, 7), (2, 3), (4, 8), (5, 11), (9, 10)]}
sage: edge_coloring(C, hex_colors = True, solver='Cplex')

{'#00ffff': [(0, 6), (1, 5), (2, 3), (4, 8), (7, 11), (9, 10)],
 '#7f00ff': [(0, 1), (2, 6), (3, 4), (5, 10), (7, 8), (9, 11)],
 '#7fff00': [(0, 9), (1, 2), (3, 7), (4, 5), (6, 11), (8, 10)],
 '#ff0000': [(0, 4), (1, 7), (2, 8), (3, 9), (5, 11), (6, 10)]}
sage: edge_coloring(C, hex_colors = True, solver='PPL')

{'#00ffff': [(0, 9), (1, 5), (2, 8), (3, 4), (6, 10), (7, 11)],
 '#7f00ff': [(0, 6), (1, 7), (2, 3), (4, 5), (8, 10), (9, 11)],
 '#7fff00': [(0, 4), (1, 2), (3, 9), (5, 10), (6, 11), (7, 8)],
 '#ff0000': [(0, 1), (2, 6), (3, 7), (4, 8), (5, 11), (9, 10)]}
sage: edge_coloring(C, hex_colors = True, solver='Coin')

{'#00ffff': [(0, 4), (1, 5), (2, 6), (3, 9), (7, 11), (8, 10)],
 '#7f00ff': [(0, 6), (1, 2), (3, 7), (4, 8), (5, 10), (9, 11)],
 '#7fff00': [(0, 1), (2, 3), (4, 5), (6, 11), (7, 8), (9, 10)],
 '#ff0000': [(0, 9), (1, 7), (2, 8), (3, 4), (5, 11), (6, 10)]}
sage: edge_coloring(C, hex_colors = True, solver='Gurobi')

{'#00ffff': [(0, 1), (2, 6), (3, 9), (4, 5), (7, 11), (8, 10)],
 '#7f00ff': [(0, 6), (1, 7), (2, 3), (4, 8), (5, 10), (9, 11)],
 '#7fff00': [(0, 4), (1, 5), (2, 8), (3, 7), (6, 11), (9, 10)],
 '#ff0000': [(0, 9), (1, 2), (3, 4), (5, 11), (6, 10), (7, 8)]}
```
In doctests, you must set the solver to `GLPK`. Otherwise, the default solver is used (e.g., `Cplex` if you have it).



---

archive/issue_comments_326071.json:
```json
{
    "body": "David,\n\n1) from the trac page, #22564 has been merged in 8.0, thus the difference I see should be due to subsequent changes\n\n2) is there any reason why the order of the constraints was changed? It makes it difficult to add doctests for this example from our book about Sage",
    "created_at": "2017-08-30T11:28:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326071",
    "user": "https://github.com/zimmermann6"
}
```

David,

1) from the trac page, #22564 has been merged in 8.0, thus the difference I see should be due to subsequent changes

2) is there any reason why the order of the constraints was changed? It makes it difficult to add doctests for this example from our book about Sage



---

archive/issue_comments_326072.json:
```json
{
    "body": "Replying to [comment:7 zimmerma]:\n> David,\n> \n> 1) from the trac page, #22564 has been merged in 8.0, thus the difference I see should be due to subsequent changes\n> \n> 2) is there any reason why the order of the constraints was changed? It makes it difficult to add doctests for this example from our book about Sage\n\n\nI changed the code 1) to split the graph into connected components and color them separately (should be faster), and 2) because I don't understand why we should use list comprehension for adding constraints. It was:\n\n```\n    #  A vertex can not have two incident edges with the same color.\n    [p.add_constraint(\n            p.sum([color[R(e),i] for e in g.edges_incident(v, labels=False)]), max=1)\n                for v in g.vertex_iterator()\n                    for i in range(k)]\n    # an edge must have a color\n    [p.add_constraint(p.sum([color[R(e),i] for i in range(k)]), max=1, min=1)\n         for e in g.edge_iterator(labels=False)]\n    # anything is good as an objective value as long as it is satisfiable\n    e = next(g.edge_iterator(labels=False))\n    p.set_objective(color[R(e),0])\n```\nNow it is:\n\n```\n    # A vertex can not have two incident edges with the same color.\n    for v in h.vertex_iterator():\n        for i in range(k):\n            p.add_constraint(p.sum(color[R(u,v),i] for u in h.neighbor_iterator(v)) <= 1)\n    # Nn edge must have a color\n    for u,v in h.edge_iterator(labels=False):\n        p.add_constraint(p.sum(color[R(u,v),i] for i in range(k)) == 1)\n    # We color the edges of the vertex of maximum degree\n    for i,v in enumerate(h.neighbors(X)):\n        p.add_constraint( color[R(v,X),i] == 1 )\n```\nSo the main changes are:\n- use of `neighbor_iterator` instead of `edges_incident` in the first set of constraints (it has always been assumed in this method that the graph is simple)\n- removal of the objective function (not needed)\n- now force the coloring of the edges incident to the vertex of maximum degree (could speed up the resolution).\n\nIn fact, I bet that changing the version of `GLPK` could already change the result (e.g., faster algorithm converging to a different optimal solution). Furthermore, I assume that some internal heuristics of the solvers are randomized since we can set [random seed of Cplex](https://www.ibm.com/support/knowledgecenter/SSSA5P_12.6.3/ilog.odms.cplex.help/CPLEX/Parameters/topics/RandomSeed.html).",
    "created_at": "2017-08-30T12:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326072",
    "user": "https://github.com/dcoudert"
}
```

Replying to [comment:7 zimmerma]:
> David,
> 
> 1) from the trac page, #22564 has been merged in 8.0, thus the difference I see should be due to subsequent changes
> 
> 2) is there any reason why the order of the constraints was changed? It makes it difficult to add doctests for this example from our book about Sage


I changed the code 1) to split the graph into connected components and color them separately (should be faster), and 2) because I don't understand why we should use list comprehension for adding constraints. It was:

```
    #  A vertex can not have two incident edges with the same color.
    [p.add_constraint(
            p.sum([color[R(e),i] for e in g.edges_incident(v, labels=False)]), max=1)
                for v in g.vertex_iterator()
                    for i in range(k)]
    # an edge must have a color
    [p.add_constraint(p.sum([color[R(e),i] for i in range(k)]), max=1, min=1)
         for e in g.edge_iterator(labels=False)]
    # anything is good as an objective value as long as it is satisfiable
    e = next(g.edge_iterator(labels=False))
    p.set_objective(color[R(e),0])
```
Now it is:

```
    # A vertex can not have two incident edges with the same color.
    for v in h.vertex_iterator():
        for i in range(k):
            p.add_constraint(p.sum(color[R(u,v),i] for u in h.neighbor_iterator(v)) <= 1)
    # Nn edge must have a color
    for u,v in h.edge_iterator(labels=False):
        p.add_constraint(p.sum(color[R(u,v),i] for i in range(k)) == 1)
    # We color the edges of the vertex of maximum degree
    for i,v in enumerate(h.neighbors(X)):
        p.add_constraint( color[R(v,X),i] == 1 )
```
So the main changes are:
- use of `neighbor_iterator` instead of `edges_incident` in the first set of constraints (it has always been assumed in this method that the graph is simple)
- removal of the objective function (not needed)
- now force the coloring of the edges incident to the vertex of maximum degree (could speed up the resolution).

In fact, I bet that changing the version of `GLPK` could already change the result (e.g., faster algorithm converging to a different optimal solution). Furthermore, I assume that some internal heuristics of the solvers are randomized since we can set [random seed of Cplex](https://www.ibm.com/support/knowledgecenter/SSSA5P_12.6.3/ilog.odms.cplex.help/CPLEX/Parameters/topics/RandomSeed.html).



---

archive/issue_comments_326073.json:
```json
{
    "body": "David, thank you for the explanation (by the way there is a typo: \"Nn edge must have a color\" should be \"An edge...\").\n\nSince it seems impossible to have a reliable doctest for this example, we won't test it.",
    "created_at": "2017-08-30T12:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326073",
    "user": "https://github.com/zimmermann6"
}
```

David, thank you for the explanation (by the way there is a typo: "Nn edge must have a color" should be "An edge...").

Since it seems impossible to have a reliable doctest for this example, we won't test it.



---

archive/issue_comments_326074.json:
```json
{
    "body": "Replying to [ticket:23572 zimmerma]:\n> Sage already includes doctests for the original version of this book (published in french in 2013). These doctests are in `src/sage/tests/french_book`, and should be updated.\n\n\nDidn't you mention at some point that you didn't care any more about these doctests? I seem to remember something along those lines...",
    "created_at": "2017-08-31T12:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326074",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:23572 zimmerma]:
> Sage already includes doctests for the original version of this book (published in french in 2013). These doctests are in `src/sage/tests/french_book`, and should be updated.


Didn't you mention at some point that you didn't care any more about these doctests? I seem to remember something along those lines...



---

archive/issue_comments_326075.json:
```json
{
    "body": "Jeroen,\n\nwhat I said is that there were too many changes in Sage upstream (with respect to Sage 5.9 which we used in the french book in 2013) so that we could check them (and even, sometimes, we had no chance to give our opinion on them before they were merged into Sage). Those doctests nevertheless did they job since most of the examples still run with current versions of Sage.\n\nNow that we have updated the book to Sage 8.0, we'd like to add the (new) doctests to Sage doctests, so that the new (english) version of the book will not be obsolete too quickly.",
    "created_at": "2017-09-01T11:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326075",
    "user": "https://github.com/zimmermann6"
}
```

Jeroen,

what I said is that there were too many changes in Sage upstream (with respect to Sage 5.9 which we used in the french book in 2013) so that we could check them (and even, sometimes, we had no chance to give our opinion on them before they were merged into Sage). Those doctests nevertheless did they job since most of the examples still run with current versions of Sage.

Now that we have updated the book to Sage 8.0, we'd like to add the (new) doctests to Sage doctests, so that the new (english) version of the book will not be obsolete too quickly.



---

archive/issue_comments_326076.json:
```json
{
    "body": "Nicolas Thiery just tested the doctests of our book with Sage 8.1beta5 and several do fail (while all tests pass with Sage 8.0). Here are the issues:\n\n1) the `lil_matrix` do not work any more. Cf the example on page 299 of the english translation:\n\n```\n  sage: from scipy.sparse.linalg.dsolve import *\n  sage: from scipy.sparse import lil_matrix\n  sage: from numpy import array\n  sage: n = 200\n  sage: n2 = n*n\n  sage: A = lil_matrix((n2, n2))\n  sage: h2 = 1./float((n+1)^2)\n  sage: for i in range(0,n2):\n  ....:    A[i,i]=4*h2+1.\n  ....:    if i+1<n2: A[i,int(i+1)]=-h2\n  ....:    if i>0:    A[i,int(i-1)]=-h2\n  ....:    if i+n<n2: A[i,int(i+n)]=-h2\n  ....:    if i-n>=0: A[i,int(i-n)]=-h2\n  sage: Acsc = A.tocsc()\n  sage: b = array([1 for i in range(0,n2)])\n  sage: solve = factorized(Acsc) # LU factorisation\n  sage: S = solve(b)             # resolution\n```\nNow if fails at the `A = lil_matrix((n2, n2))` line with:\n\n```\n    TypeError: unrecognized lil_matrix constructor usage\n```\nAren't `lil_matrix` tested in the current doctests?\n\n2) the category of `QQ` changed:\n\n```\nFailed example:\n    QQ.category()\nExpected:\n    Join of Category of quotient fields and Category of metric spaces\nGot:\n    Join of Category of number fields and Category of quotient fields and Category of metric spaces\n```\n3) we have different output for graphs of the commands `minor` and `edge_coloring`. We will try to fix those with `solver='GLPK'` (cf comment [comment:6] above). If that does not work, is there a random seed that we can set to make those commands deterministic?",
    "created_at": "2017-09-15T09:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326076",
    "user": "https://github.com/zimmermann6"
}
```

Nicolas Thiery just tested the doctests of our book with Sage 8.1beta5 and several do fail (while all tests pass with Sage 8.0). Here are the issues:

1) the `lil_matrix` do not work any more. Cf the example on page 299 of the english translation:

```
  sage: from scipy.sparse.linalg.dsolve import *
  sage: from scipy.sparse import lil_matrix
  sage: from numpy import array
  sage: n = 200
  sage: n2 = n*n
  sage: A = lil_matrix((n2, n2))
  sage: h2 = 1./float((n+1)^2)
  sage: for i in range(0,n2):
  ....:    A[i,i]=4*h2+1.
  ....:    if i+1<n2: A[i,int(i+1)]=-h2
  ....:    if i>0:    A[i,int(i-1)]=-h2
  ....:    if i+n<n2: A[i,int(i+n)]=-h2
  ....:    if i-n>=0: A[i,int(i-n)]=-h2
  sage: Acsc = A.tocsc()
  sage: b = array([1 for i in range(0,n2)])
  sage: solve = factorized(Acsc) # LU factorisation
  sage: S = solve(b)             # resolution
```
Now if fails at the `A = lil_matrix((n2, n2))` line with:

```
    TypeError: unrecognized lil_matrix constructor usage
```
Aren't `lil_matrix` tested in the current doctests?

2) the category of `QQ` changed:

```
Failed example:
    QQ.category()
Expected:
    Join of Category of quotient fields and Category of metric spaces
Got:
    Join of Category of number fields and Category of quotient fields and Category of metric spaces
```
3) we have different output for graphs of the commands `minor` and `edge_coloring`. We will try to fix those with `solver='GLPK'` (cf comment [comment:6] above). If that does not work, is there a random seed that we can set to make those commands deterministic?



---

archive/issue_comments_326077.json:
```json
{
    "body": "Replying to [comment:12 zimmerma]:\n> 3) we have different output for graphs of the commands `minor` and `edge_coloring`. We will try to fix those with `solver='GLPK'` (cf comment [comment:6] above). If that does not work, is there a random seed that we can set to make those commands deterministic?\n\n\nAre these tests really non-deterministic or just different with different versions of Sage?",
    "created_at": "2017-09-15T09:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326077",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:12 zimmerma]:
> 3) we have different output for graphs of the commands `minor` and `edge_coloring`. We will try to fix those with `solver='GLPK'` (cf comment [comment:6] above). If that does not work, is there a random seed that we can set to make those commands deterministic?


Are these tests really non-deterministic or just different with different versions of Sage?



---

archive/issue_comments_326078.json:
```json
{
    "body": "Replying to [comment:12 zimmerma]:\n> 2) the category of `QQ` changed:\n> \n> ```\n> Failed example:\n>     QQ.category()\n> Expected:\n>     Join of Category of quotient fields and Category of metric spaces\n> Got:\n>     Join of Category of number fields and Category of quotient fields and Category of metric spaces\n> ```\n\n\nThis is a good and intentional change: just change the expected output.",
    "created_at": "2017-09-15T09:56:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326078",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:12 zimmerma]:
> 2) the category of `QQ` changed:
> 
> ```
> Failed example:
>     QQ.category()
> Expected:
>     Join of Category of quotient fields and Category of metric spaces
> Got:
>     Join of Category of number fields and Category of quotient fields and Category of metric spaces
> ```


This is a good and intentional change: just change the expected output.



---

archive/issue_comments_326079.json:
```json
{
    "body": "Replying to [comment:12 zimmerma]:\n> Aren't `lil_matrix` tested in the current doctests?\n\n\n`lil_matrix` is not used or tested anywhere in Sage. I'll have a look.",
    "created_at": "2017-09-15T10:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326079",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:12 zimmerma]:
> Aren't `lil_matrix` tested in the current doctests?


`lil_matrix` is not used or tested anywhere in Sage. I'll have a look.



---

archive/issue_comments_326080.json:
```json
{
    "body": "> 1) the lil_matrix do not work any more.\n\n\na scipy update? in sage 8.0.beta5 the version is 0.19.1, while in 8.0 it is 0.17.1.\n\nhowever, the docstring says it's still valid:\n\n```\n...\n        lil_matrix((M, N), [dtype])\n            to construct an empty matrix with shape (M, N)\n            dtype is optional, defaulting to dtype='d'. \n```",
    "created_at": "2017-09-15T10:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326080",
    "user": "https://github.com/mforets"
}
```

> 1) the lil_matrix do not work any more.


a scipy update? in sage 8.0.beta5 the version is 0.19.1, while in 8.0 it is 0.17.1.

however, the docstring says it's still valid:

```
...
        lil_matrix((M, N), [dtype])
            to construct an empty matrix with shape (M, N)
            dtype is optional, defaulting to dtype='d'. 
```



---

archive/issue_comments_326081.json:
```json
{
    "body": "Replying to [comment:13 jdemeyer]:\n> Replying to [comment:12 zimmerma]:\n> > 3) we have different output for graphs of the commands `minor` and `edge_coloring`. We will try to fix those with `solver='GLPK'` (cf comment [comment:6] above). If that does not work, is there a random seed that we can set to make those commands deterministic?\n\n> \n> Are these tests really non-deterministic or just different with different versions of Sage?\n\n\nno idea, I first asked Nicolas to test with `solver='GLPK'`.",
    "created_at": "2017-09-15T10:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326081",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:13 jdemeyer]:
> Replying to [comment:12 zimmerma]:
> > 3) we have different output for graphs of the commands `minor` and `edge_coloring`. We will try to fix those with `solver='GLPK'` (cf comment [comment:6] above). If that does not work, is there a random seed that we can set to make those commands deterministic?

> 
> Are these tests really non-deterministic or just different with different versions of Sage?


no idea, I first asked Nicolas to test with `solver='GLPK'`.



---

archive/issue_comments_326082.json:
```json
{
    "body": "Replying to [comment:14 jdemeyer]:\n> Replying to [comment:12 zimmerma]:\n> > 2) the category of `QQ` changed:\n> > \n> > ```\n> > Failed example:\n> >     QQ.category()\n> > Expected:\n> >     Join of Category of quotient fields and Category of metric spaces\n> > Got:\n> >     Join of Category of number fields and Category of quotient fields and Category of metric spaces\n> > ```\n\n> \n> This is a good and intentional change: just change the expected output.\n\n\nthis is not possible, since we currently use Sage 8.0 for the book, and this will make the doctests fail with 8.0.",
    "created_at": "2017-09-15T10:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326082",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:14 jdemeyer]:
> Replying to [comment:12 zimmerma]:
> > 2) the category of `QQ` changed:
> > 
> > ```
> > Failed example:
> >     QQ.category()
> > Expected:
> >     Join of Category of quotient fields and Category of metric spaces
> > Got:
> >     Join of Category of number fields and Category of quotient fields and Category of metric spaces
> > ```

> 
> This is a good and intentional change: just change the expected output.


this is not possible, since we currently use Sage 8.0 for the book, and this will make the doctests fail with 8.0.



---

archive/issue_comments_326083.json:
```json
{
    "body": "Replying to [comment:19 zimmerma]:\n> this is not possible, since we currently use Sage 8.0 for the book, and this will make the doctests fail with 8.0.\n\n\nIs there any particular reason that you focus on 8.0? Given that the book is still in preparation, you could use Sage 8.1 instead.",
    "created_at": "2017-09-15T10:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326083",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:19 zimmerma]:
> this is not possible, since we currently use Sage 8.0 for the book, and this will make the doctests fail with 8.0.


Is there any particular reason that you focus on 8.0? Given that the book is still in preparation, you could use Sage 8.1 instead.



---

archive/issue_comments_326084.json:
```json
{
    "body": "I opened #23867 for the `lil_matrix()` issue.",
    "created_at": "2017-09-15T11:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326084",
    "user": "https://github.com/jdemeyer"
}
```

I opened #23867 for the `lil_matrix()` issue.



---

archive/issue_comments_326085.json:
```json
{
    "body": "General comment: all the doctests in the book which return types will change in Python 3. Python 2 uses `<type 'int'>` while Python 3 uses `<class 'int'>`.",
    "created_at": "2017-09-21T08:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326085",
    "user": "https://github.com/jdemeyer"
}
```

General comment: all the doctests in the book which return types will change in Python 3. Python 2 uses `<type 'int'>` while Python 3 uses `<class 'int'>`.



---

archive/issue_comments_326086.json:
```json
{
    "body": "Replying to [comment:24 jdemeyer]:\n> General comment: all the doctests in the book which return types will change in Python 3. Python 2 uses `<type 'int'>` while Python 3 uses `<class 'int'>`.\n\n\nthanks Jeroen. Alas, there is nothing we can do for that, just wait for Python 3 and update.",
    "created_at": "2017-09-21T11:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326086",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:24 jdemeyer]:
> General comment: all the doctests in the book which return types will change in Python 3. Python 2 uses `<type 'int'>` while Python 3 uses `<class 'int'>`.


thanks Jeroen. Alas, there is nothing we can do for that, just wait for Python 3 and update.



---

archive/issue_comments_326087.json:
```json
{
    "body": "For Sage doctests, you should write `<... 'int'>` instead of `<type 'int'>`.",
    "created_at": "2017-09-21T11:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326087",
    "user": "https://github.com/jdemeyer"
}
```

For Sage doctests, you should write `<... 'int'>` instead of `<type 'int'>`.



---

archive/issue_comments_326088.json:
```json
{
    "body": "good idea! I will do that change in the doctests.",
    "created_at": "2017-09-21T11:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326088",
    "user": "https://github.com/zimmermann6"
}
```

good idea! I will do that change in the doctests.



---

archive/issue_comments_326089.json:
```json
{
    "body": "Replying to [comment:26 jdemeyer]:\n> For Sage doctests, you should write `<... 'int'>` instead of `<type 'int'>`.\n\n\nThis actually isn't necessary; the doctest parser already accounts for this minor difference.",
    "created_at": "2018-07-02T15:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326089",
    "user": "https://github.com/embray"
}
```

Replying to [comment:26 jdemeyer]:
> For Sage doctests, you should write `<... 'int'>` instead of `<type 'int'>`.


This actually isn't necessary; the doctest parser already accounts for this minor difference.



---

archive/issue_comments_326090.json:
```json
{
    "body": "I can take this over.",
    "created_at": "2018-07-10T14:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326090",
    "user": "https://github.com/embray"
}
```

I can take this over.



---

archive/issue_comments_326091.json:
```json
{
    "body": "Set assignee to @embray.",
    "created_at": "2018-07-10T14:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326091",
    "user": "https://github.com/embray"
}
```

Set assignee to @embray.



---

archive/issue_events_060393.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-09-14T07:32:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60393"
}
```



---

archive/issue_comments_326092.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2018-09-14T07:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326092",
    "user": "https://github.com/embray"
}
```

Changing priority from major to critical.



---

archive/issue_comments_326093.json:
```json
{
    "body": "Getting this done ASAP before 8.4 is out is pretty important, especially to make sure there's enough time to fix any failures that might still be lingering.",
    "created_at": "2018-09-14T07:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326093",
    "user": "https://github.com/embray"
}
```

Getting this done ASAP before 8.4 is out is pretty important, especially to make sure there's enough time to fix any failures that might still be lingering.



---

archive/issue_comments_326094.json:
```json
{
    "body": "Current versions of the examples/exercises.  There are still about half a dozen test failures, all of which are insubstantial and most of which stem from #25247, but will still need to be fixed.  The question is whether to fix them in the book, in the test suite, or both.\n\nFor one of them I'm getting a deprecation warning from scipy that we should probably heed:\n\n```\nsage -t --long src/sage/tests/books/sagebook/linsolve_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 385, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    x = cg(A, b, M = msc, tol=1.e-8)\nExpected nothing\nGot:\n    doctest:warning\n    ...\n    :\n    DeprecationWarning: scipy.sparse.linalg.cg called without specifying `atol`. The default value will be changed in a future release. For compatibility, specify a value for `atol` explicitly, e.g., ``cg(..., atol=0)``, or to retain the old behavior ``cg(..., atol='legacy')``\n```\n\n---\nNew commits:",
    "created_at": "2018-09-14T10:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326094",
    "user": "https://github.com/embray"
}
```

Current versions of the examples/exercises.  There are still about half a dozen test failures, all of which are insubstantial and most of which stem from #25247, but will still need to be fixed.  The question is whether to fix them in the book, in the test suite, or both.

For one of them I'm getting a deprecation warning from scipy that we should probably heed:

```
sage -t --long src/sage/tests/books/sagebook/linsolve_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 385, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    x = cg(A, b, M = msc, tol=1.e-8)
Expected nothing
Got:
    doctest:warning
    ...
    :
    DeprecationWarning: scipy.sparse.linalg.cg called without specifying `atol`. The default value will be changed in a future release. For compatibility, specify a value for `atol` explicitly, e.g., ``cg(..., atol=0)``, or to retain the old behavior ``cg(..., atol='legacy')``
```

---
New commits:



---

archive/issue_comments_326095.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2018-09-14T10:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326095",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_326096.json:
```json
{
    "body": "Erik,\n\n1) the examples of the book are now updated to Sage 8.3, and all examples pass with Sage 8.3\n\n2) about the conjugate gradient failure, there is no `atol` option in Sage 8.3, only `tol`,\nand using `atol=0` or `atol='legacy'` gives an error in Sage 8.3:\n\n```\nsage: x = cg(A, b, M = msc, tol=1.e-8, atol=0)       \n...\nTypeError: cg() got an unexpected keyword argument 'atol'\n```\nThe only solution I see is to ignore this warning in the doctests. How can we do this?",
    "created_at": "2018-09-18T15:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326096",
    "user": "https://github.com/zimmermann6"
}
```

Erik,

1) the examples of the book are now updated to Sage 8.3, and all examples pass with Sage 8.3

2) about the conjugate gradient failure, there is no `atol` option in Sage 8.3, only `tol`,
and using `atol=0` or `atol='legacy'` gives an error in Sage 8.3:

```
sage: x = cg(A, b, M = msc, tol=1.e-8, atol=0)       
...
TypeError: cg() got an unexpected keyword argument 'atol'
```
The only solution I see is to ignore this warning in the doctests. How can we do this?



---

archive/issue_comments_326097.json:
```json
{
    "body": "I'm not sure what to do about this--I don't recall what version of scipy is included by default with Sage 8.3, but in 8.4.beta5 it's now scipy 1.1.0, which wants you to specify `atol`.  \n\nI could have the test ignore that warning, but it would be better to just include a fixed version of that example in Sage.  The question is hhether to update the example in the book as well, or to just manually edit that one test in the copy included in the Sage tests.",
    "created_at": "2018-09-18T17:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326097",
    "user": "https://github.com/embray"
}
```

I'm not sure what to do about this--I don't recall what version of scipy is included by default with Sage 8.3, but in 8.4.beta5 it's now scipy 1.1.0, which wants you to specify `atol`.  

I could have the test ignore that warning, but it would be better to just include a fixed version of that example in Sage.  The question is hhether to update the example in the book as well, or to just manually edit that one test in the copy included in the Sage tests.



---

archive/issue_comments_326098.json:
```json
{
    "body": "Either way it would require manually modifying the test module.",
    "created_at": "2018-09-18T17:38:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326098",
    "user": "https://github.com/embray"
}
```

Either way it would require manually modifying the test module.



---

archive/issue_comments_326099.json:
```json
{
    "body": "We can't change the example in the book since it should work with Sage 8.3.\n\nI suggest you modify the doctest in the Sage distribution, by adding `atol='legacy'`.\n\nThis should solve this issue.",
    "created_at": "2018-09-19T06:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326099",
    "user": "https://github.com/zimmermann6"
}
```

We can't change the example in the book since it should work with Sage 8.3.

I suggest you modify the doctest in the Sage distribution, by adding `atol='legacy'`.

This should solve this issue.



---

archive/issue_comments_326100.json:
```json
{
    "body": "So, to answer the more general question, if there are any examples from the book that no longer work exactly on Sage 8.4, I should copy them from the book as-is, and then *only* modify the copies that are added to Sage by this ticket?\n\nI ask because if any of the examples need to be modified, one will eventually want to get them back into the book for a future version.",
    "created_at": "2018-09-20T12:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326100",
    "user": "https://github.com/embray"
}
```

So, to answer the more general question, if there are any examples from the book that no longer work exactly on Sage 8.4, I should copy them from the book as-is, and then *only* modify the copies that are added to Sage by this ticket?

I ask because if any of the examples need to be modified, one will eventually want to get them back into the book for a future version.



---

archive/issue_comments_326101.json:
```json
{
    "body": "Replying to [comment:37 embray]:\n> So, to answer the more general question, if there are any examples from the book that no longer work exactly on Sage 8.4, I should copy them from the book as-is, and then *only* modify the copies that are added to Sage by this ticket?\n\n\nyes. But please tell me of any such examples. Maybe we can still modify them in the book so that they work both for 8.3 and 8.4 (this is unfortunately not possible for the `atol` issue above).",
    "created_at": "2018-09-21T07:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326101",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:37 embray]:
> So, to answer the more general question, if there are any examples from the book that no longer work exactly on Sage 8.4, I should copy them from the book as-is, and then *only* modify the copies that are added to Sage by this ticket?


yes. But please tell me of any such examples. Maybe we can still modify them in the book so that they work both for 8.3 and 8.4 (this is unfortunately not possible for the `atol` issue above).



---

archive/issue_comments_326102.json:
```json
{
    "body": "Perhaps I'll just create a branch on the book repo for now to add any relevant updates.",
    "created_at": "2018-09-21T12:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326102",
    "user": "https://github.com/embray"
}
```

Perhaps I'll just create a branch on the book repo for now to add any relevant updates.



---

archive/issue_comments_326103.json:
```json
{
    "body": "For completeness, these are the current failures I get against 8.4.beta6:\n\n```\nsage -t src/sage/tests/books/sagebook/integration_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 109, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=0, 1, x^(-99/100))') # abs tol 1e-16\nExpected:\n    73.62914262423378365\nGot:\n    73.629142624233783843668417691077783339\nTolerance exceeded:\n    73.62914262423378365 vs 73.629142624233783843668417691077783339, tolerance 2e-16 > 1e-16\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 119, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 1e-16\nExpected:\n    74.47274932028288503\nGot:\n    74.472749320282885192304428135608736736\nTolerance exceeded:\n    74.47274932028288503 vs 74.472749320282885192304428135608736736, tolerance 2e-16 > 1e-16\n**********************************************************************\n1 item had failures:\n   2 of  87 in sage.tests.books.sagebook.integration_doctest\n    [86 tests, 2 failures, 23.25 s]\nsage -t src/sage/tests/books/sagebook/polynomes_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/polynomes_doctest.py\", line 240, in sage.tests.books.sagebook.polynomes_doctest\nFailed example:\n    r.reduce(); r\nExpected:\n    1.00000000000000/(-x + 1.00000000000000)\nGot:\n    -1.00000000000000/(x - 1.00000000000000)\n**********************************************************************\n1 item had failures:\n   1 of 111 in sage.tests.books.sagebook.polynomes_doctest\n    [110 tests, 1 failure, 2.23 s]\nsage -t src/sage/tests/books/sagebook/sol/integration_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/sol/integration_doctest.py\", line 39, in sage.tests.books.sagebook.sol.integration_doctest\nFailed example:\n    N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 1e-15\nExpected:\n    0.250000000000001\nGot:\n    0.249999999999999\nTolerance exceeded:\n    0.250000000000001 vs 0.249999999999999, tolerance 2e-15 > 1e-15\nFile \"src/sage/tests/books/sagebook/numbertheory_doctest.py\", line 34, in sage.tests.books.sagebook.numbertheory_doctest\nFailed example:\n    1/a\nExpected:\n    Traceback (most recent call last):\n      ...\n    ZeroDivisionError: Inverse does not exist.\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n...\n    ZeroDivisionError: inverse of Mod(3, 15) does not exist\n```\n\nMost of them seem to be caused by slight changes in PARI, though I'm not sure about the one with polynomes; obviously it's just choosing for some reason not to distribute the minus sign.\n\nThe last one is because the old exception message was slightly enhanced.",
    "created_at": "2018-09-25T11:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326103",
    "user": "https://github.com/embray"
}
```

For completeness, these are the current failures I get against 8.4.beta6:

```
sage -t src/sage/tests/books/sagebook/integration_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 109, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=0, 1, x^(-99/100))') # abs tol 1e-16
Expected:
    73.62914262423378365
Got:
    73.629142624233783843668417691077783339
Tolerance exceeded:
    73.62914262423378365 vs 73.629142624233783843668417691077783339, tolerance 2e-16 > 1e-16
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 119, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 1e-16
Expected:
    74.47274932028288503
Got:
    74.472749320282885192304428135608736736
Tolerance exceeded:
    74.47274932028288503 vs 74.472749320282885192304428135608736736, tolerance 2e-16 > 1e-16
**********************************************************************
1 item had failures:
   2 of  87 in sage.tests.books.sagebook.integration_doctest
    [86 tests, 2 failures, 23.25 s]
sage -t src/sage/tests/books/sagebook/polynomes_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/polynomes_doctest.py", line 240, in sage.tests.books.sagebook.polynomes_doctest
Failed example:
    r.reduce(); r
Expected:
    1.00000000000000/(-x + 1.00000000000000)
Got:
    -1.00000000000000/(x - 1.00000000000000)
**********************************************************************
1 item had failures:
   1 of 111 in sage.tests.books.sagebook.polynomes_doctest
    [110 tests, 1 failure, 2.23 s]
sage -t src/sage/tests/books/sagebook/sol/integration_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/sol/integration_doctest.py", line 39, in sage.tests.books.sagebook.sol.integration_doctest
Failed example:
    N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 1e-15
Expected:
    0.250000000000001
Got:
    0.249999999999999
Tolerance exceeded:
    0.250000000000001 vs 0.249999999999999, tolerance 2e-15 > 1e-15
File "src/sage/tests/books/sagebook/numbertheory_doctest.py", line 34, in sage.tests.books.sagebook.numbertheory_doctest
Failed example:
    1/a
Expected:
    Traceback (most recent call last):
      ...
    ZeroDivisionError: Inverse does not exist.
Got:
    <BLANKLINE>
    Traceback (most recent call last):
...
    ZeroDivisionError: inverse of Mod(3, 15) does not exist
```

Most of them seem to be caused by slight changes in PARI, though I'm not sure about the one with polynomes; obviously it's just choosing for some reason not to distribute the minus sign.

The last one is because the old exception message was slightly enhanced.



---

archive/issue_comments_326104.json:
```json
{
    "body": "Erik, I fixed the error tolerances in the book. Please could you check again?\n\nFor the failure in polynomes, is there a way in the doctests to check we get one of both outputs?\n\nFor the numbertheory failure, it is unfortunate the error message did change. Is there a way to check for \"ZeroDivisionError: ... does not exist\" in the doctest?",
    "created_at": "2018-09-26T08:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326104",
    "user": "https://github.com/zimmermann6"
}
```

Erik, I fixed the error tolerances in the book. Please could you check again?

For the failure in polynomes, is there a way in the doctests to check we get one of both outputs?

For the numbertheory failure, it is unfortunate the error message did change. Is there a way to check for "ZeroDivisionError: ... does not exist" in the doctest?



---

archive/issue_comments_326105.json:
```json
{
    "body": "Replying to [comment:41 zimmerma]:\n> Erik, I fixed the error tolerances in the book. Please could you check again?\n\n\nI will double check, but yesterday I pulled down the latest version of the book, rebuilt it, and re-copied the files.  I can try doing it one more time, perhaps with with a clean of the repository first...\n\n> For the failure in polynomes, is there a way in the doctests to check we get one of both outputs?\n\n\nTheoretically you could check for both, but it would make for a rather ugly test like:\n\n```\nsage: repr(r) in ['1.00000000000000/(-x + 1.00000000000000)', '-1.00000000000000/(x - 1.00000000000000)']\nTrue\n```\n\nRather than checking for one of both it would be better to simply check the result by value like:\n\n```\nsage: r == -1.0/(x - 1.0)\n```\n\nor something like that.  There might also be a way to normalize it; I'll take a close look.\n\n\n\n> For the numbertheory failure, it is unfortunate the error message did change. Is there a way to check for \"ZeroDivisionError: ... does not exist\" in the doctest?\n\n\nI don't think it's that \"unfortunate\".  It did change for the better, and in 8.4, whereas I had thought the book was still aiming specifically at 8.3.  While having these tests in the Sage test suite is an important way to keep track of how our changes impact real use cases, it should not block useful changes that happen to deviate from the book (especially in trivial ways).\n\nI don't see any point in changing the doctest in Sage to be less specific.  If you want to change it in the book, `ZeroDivisionEror: ...does not exist` would work, but is maybe a bit ugly and uninformative...?",
    "created_at": "2018-09-26T09:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326105",
    "user": "https://github.com/embray"
}
```

Replying to [comment:41 zimmerma]:
> Erik, I fixed the error tolerances in the book. Please could you check again?


I will double check, but yesterday I pulled down the latest version of the book, rebuilt it, and re-copied the files.  I can try doing it one more time, perhaps with with a clean of the repository first...

> For the failure in polynomes, is there a way in the doctests to check we get one of both outputs?


Theoretically you could check for both, but it would make for a rather ugly test like:

```
sage: repr(r) in ['1.00000000000000/(-x + 1.00000000000000)', '-1.00000000000000/(x - 1.00000000000000)']
True
```

Rather than checking for one of both it would be better to simply check the result by value like:

```
sage: r == -1.0/(x - 1.0)
```

or something like that.  There might also be a way to normalize it; I'll take a close look.



> For the numbertheory failure, it is unfortunate the error message did change. Is there a way to check for "ZeroDivisionError: ... does not exist" in the doctest?


I don't think it's that "unfortunate".  It did change for the better, and in 8.4, whereas I had thought the book was still aiming specifically at 8.3.  While having these tests in the Sage test suite is an important way to keep track of how our changes impact real use cases, it should not block useful changes that happen to deviate from the book (especially in trivial ways).

I don't see any point in changing the doctest in Sage to be less specific.  If you want to change it in the book, `ZeroDivisionEror: ...does not exist` would work, but is maybe a bit ugly and uninformative...?



---

archive/issue_comments_326106.json:
```json
{
    "body": "Erik,\n\nfor the \"polynomes\" failure, I have added the doctest you suggest with `repr` (the second one you propose also works before `r.reduce()`, thus is not enough).\n\nFor the \"numbertheory\" failure, I have added \"test=false\", so this example is not tested any more.\n\nAll doctests still work with Sage 8.3.\n\nPlease could you check they all work with 8.4beta6?\n\nThank you.",
    "created_at": "2018-09-26T11:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326106",
    "user": "https://github.com/zimmermann6"
}
```

Erik,

for the "polynomes" failure, I have added the doctest you suggest with `repr` (the second one you propose also works before `r.reduce()`, thus is not enough).

For the "numbertheory" failure, I have added "test=false", so this example is not tested any more.

All doctests still work with Sage 8.3.

Please could you check they all work with 8.4beta6?

Thank you.



---

archive/issue_comments_326107.json:
```json
{
    "body": "Replying to [comment:43 zimmerma]:\n> Erik,\n> \n> for the \"polynomes\" failure, I have added the doctest you suggest with `repr` (the second one you propose also works before `r.reduce()`, thus is not enough).\n\n\nI really wouldn't....  My whole point was it was not a good test, and even worse as an example in a book.  Let me see if there is a better way to write this example; I just haven't tried yet.\n\n> For the \"numbertheory\" failure, I have added \"test=false\", so this example is not tested any more.\n> \n> All doctests still work with Sage 8.3.\n> \n> Please could you check they all work with 8.4beta6?\n\n\nThat's what I'm currently testing against...",
    "created_at": "2018-09-26T11:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326107",
    "user": "https://trac.sagemath.org/admin/accounts/users/galois"
}
```

Replying to [comment:43 zimmerma]:
> Erik,
> 
> for the "polynomes" failure, I have added the doctest you suggest with `repr` (the second one you propose also works before `r.reduce()`, thus is not enough).


I really wouldn't....  My whole point was it was not a good test, and even worse as an example in a book.  Let me see if there is a better way to write this example; I just haven't tried yet.

> For the "numbertheory" failure, I have added "test=false", so this example is not tested any more.
> 
> All doctests still work with Sage 8.3.
> 
> Please could you check they all work with 8.4beta6?


That's what I'm currently testing against...



---

archive/issue_comments_326108.json:
```json
{
    "body": "Sorry, the above was me.  Forgot I was still logged in as my bot :)",
    "created_at": "2018-09-26T11:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326108",
    "user": "https://github.com/embray"
}
```

Sorry, the above was me.  Forgot I was still logged in as my bot :)



---

archive/issue_comments_326109.json:
```json
{
    "body": "Okay, I double-checked and as I suspected I am up to date with the book files, and still get slight floating point difference in the tests I mentioned previously.  I wonder if there has been a PARI or Cypari update since 8.3.\n\nAnyways, this diff is all I need for the tests to pass:\n\n```diff\ndiff --git a/src/sage/tests/books/sagebook/integration_doctest.py b/src/sage/tests/books/sagebook/integration_doctest.py\nindex 4f2699c..1a7c610 100644\n--- a/src/sage/tests/books/sagebook/integration_doctest.py\n+++ b/src/sage/tests/books/sagebook/integration_doctest.py\n@@ -106,7 +106,7 @@ Sage example in ./integration.tex, line 717::\n Sage example in ./integration.tex, line 745::\n\n   sage: p = gp.set_precision(old_prec) # we reset the default precision\n-  sage: gp('intnum(x=0, 1, x^(-99/100))') # abs tol 1e-16\n+  sage: gp('intnum(x=0, 1, x^(-99/100))') # abs tol 2e-16\n   73.62914262423378365\n\n Sage example in ./integration.tex, line 753::\n@@ -116,7 +116,7 @@ Sage example in ./integration.tex, line 753::\n\n Sage example in ./integration.tex, line 764::\n\n-  sage: gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 1e-16\n+  sage: gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 2e-16\n   74.47274932028288503\n\n Sage example in ./integration.tex, line 783::\ndiff --git a/src/sage/tests/books/sagebook/linsolve_doctest.py b/src/sage/tests/books/sagebook/linsolve_doctest.py\nindex 552bfc2..812b6b7 100644\n--- a/src/sage/tests/books/sagebook/linsolve_doctest.py\n+++ b/src/sage/tests/books/sagebook/linsolve_doctest.py\n@@ -382,7 +382,7 @@ Sage example in ./linsolve.tex, line 2721::\n   ....:     m[i,i] = 1./A[i,i]\n   sage: msc = m.tocsc()\n   sage: from scipy.sparse.linalg import cg\n-  sage: x = cg(A, b, M = msc, tol=1.e-8)\n+  sage: x = cg(A, b, M=msc, atol=1.e-8)\n\n Sage example in ./linsolve.tex, line 2782::\n\ndiff --git a/src/sage/tests/books/sagebook/numbertheory_doctest.py b/src/sage/tests/books/sagebook/numbertheory_doctest.py\nindex cb8e331..09b291d 100644\n--- a/src/sage/tests/books/sagebook/numbertheory_doctest.py\n+++ b/src/sage/tests/books/sagebook/numbertheory_doctest.py\n@@ -34,7 +34,7 @@ Sage example in ./numbertheory.tex, line 174::\n   sage: 1/a\n   Traceback (most recent call last):\n     ...\n-  ZeroDivisionError: Inverse does not exist.\n+  ZeroDivisionError: inverse of Mod(3, 15) does not exist\n\n Sage example in ./numbertheory.tex, line 199::\n\ndiff --git a/src/sage/tests/books/sagebook/polynomes_doctest.py b/src/sage/tests/books/sagebook/polynomes_doctest.py\nindex 926922d..77ba536 100644\n--- a/src/sage/tests/books/sagebook/polynomes_doctest.py\n+++ b/src/sage/tests/books/sagebook/polynomes_doctest.py\n@@ -238,7 +238,7 @@ Sage example in ./polynomes.tex, line 1399::\n Sage example in ./polynomes.tex, line 1411::\n\n   sage: r.reduce(); r\n-  1.00000000000000/(-x + 1.00000000000000)\n+  -1.00000000000000/(x - 1.00000000000000)\n\n Sage example in ./polynomes.tex, line 1487::\n\ndiff --git a/src/sage/tests/books/sagebook/sol/integration_doctest.py b/src/sage/tests/books/sagebook/sol/integration_doctest.py\nindex 518dcc9..b2c2e68 100644\n--- a/src/sage/tests/books/sagebook/sol/integration_doctest.py\n+++ b/src/sage/tests/books/sagebook/sol/integration_doctest.py\n@@ -36,7 +36,7 @@ Sage example in ./sol/integration.tex, line 58::\n\n   sage: numerical_integral(x * log(1+x), 0, 1)\n   (0.25, 2.7755575615628914e-15)\n-  sage: N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 1e-15\n+  sage: N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 2e-15\n   0.250000000000001\n   sage: numerical_integral(sqrt(1-x^2), 0, 1)\n   (0.785398167726482..., 9.042725224567119...e-07)\n```\n\nI still think the best thing to do is to apply that just in the sage doctests, and then duplicate it to a branch in the book for future updates.",
    "created_at": "2018-09-26T16:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326109",
    "user": "https://github.com/embray"
}
```

Okay, I double-checked and as I suspected I am up to date with the book files, and still get slight floating point difference in the tests I mentioned previously.  I wonder if there has been a PARI or Cypari update since 8.3.

Anyways, this diff is all I need for the tests to pass:

```diff
diff --git a/src/sage/tests/books/sagebook/integration_doctest.py b/src/sage/tests/books/sagebook/integration_doctest.py
index 4f2699c..1a7c610 100644
--- a/src/sage/tests/books/sagebook/integration_doctest.py
+++ b/src/sage/tests/books/sagebook/integration_doctest.py
@@ -106,7 +106,7 @@ Sage example in ./integration.tex, line 717::
 Sage example in ./integration.tex, line 745::

   sage: p = gp.set_precision(old_prec) # we reset the default precision
-  sage: gp('intnum(x=0, 1, x^(-99/100))') # abs tol 1e-16
+  sage: gp('intnum(x=0, 1, x^(-99/100))') # abs tol 2e-16
   73.62914262423378365

 Sage example in ./integration.tex, line 753::
@@ -116,7 +116,7 @@ Sage example in ./integration.tex, line 753::

 Sage example in ./integration.tex, line 764::

-  sage: gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 1e-16
+  sage: gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 2e-16
   74.47274932028288503

 Sage example in ./integration.tex, line 783::
diff --git a/src/sage/tests/books/sagebook/linsolve_doctest.py b/src/sage/tests/books/sagebook/linsolve_doctest.py
index 552bfc2..812b6b7 100644
--- a/src/sage/tests/books/sagebook/linsolve_doctest.py
+++ b/src/sage/tests/books/sagebook/linsolve_doctest.py
@@ -382,7 +382,7 @@ Sage example in ./linsolve.tex, line 2721::
   ....:     m[i,i] = 1./A[i,i]
   sage: msc = m.tocsc()
   sage: from scipy.sparse.linalg import cg
-  sage: x = cg(A, b, M = msc, tol=1.e-8)
+  sage: x = cg(A, b, M=msc, atol=1.e-8)

 Sage example in ./linsolve.tex, line 2782::

diff --git a/src/sage/tests/books/sagebook/numbertheory_doctest.py b/src/sage/tests/books/sagebook/numbertheory_doctest.py
index cb8e331..09b291d 100644
--- a/src/sage/tests/books/sagebook/numbertheory_doctest.py
+++ b/src/sage/tests/books/sagebook/numbertheory_doctest.py
@@ -34,7 +34,7 @@ Sage example in ./numbertheory.tex, line 174::
   sage: 1/a
   Traceback (most recent call last):
     ...
-  ZeroDivisionError: Inverse does not exist.
+  ZeroDivisionError: inverse of Mod(3, 15) does not exist

 Sage example in ./numbertheory.tex, line 199::

diff --git a/src/sage/tests/books/sagebook/polynomes_doctest.py b/src/sage/tests/books/sagebook/polynomes_doctest.py
index 926922d..77ba536 100644
--- a/src/sage/tests/books/sagebook/polynomes_doctest.py
+++ b/src/sage/tests/books/sagebook/polynomes_doctest.py
@@ -238,7 +238,7 @@ Sage example in ./polynomes.tex, line 1399::
 Sage example in ./polynomes.tex, line 1411::

   sage: r.reduce(); r
-  1.00000000000000/(-x + 1.00000000000000)
+  -1.00000000000000/(x - 1.00000000000000)

 Sage example in ./polynomes.tex, line 1487::

diff --git a/src/sage/tests/books/sagebook/sol/integration_doctest.py b/src/sage/tests/books/sagebook/sol/integration_doctest.py
index 518dcc9..b2c2e68 100644
--- a/src/sage/tests/books/sagebook/sol/integration_doctest.py
+++ b/src/sage/tests/books/sagebook/sol/integration_doctest.py
@@ -36,7 +36,7 @@ Sage example in ./sol/integration.tex, line 58::

   sage: numerical_integral(x * log(1+x), 0, 1)
   (0.25, 2.7755575615628914e-15)
-  sage: N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 1e-15
+  sage: N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 2e-15
   0.250000000000001
   sage: numerical_integral(sqrt(1-x^2), 0, 1)
   (0.785398167726482..., 9.042725224567119...e-07)
```

I still think the best thing to do is to apply that just in the sage doctests, and then duplicate it to a branch in the book for future updates.



---

archive/issue_comments_326110.json:
```json
{
    "body": "Erik, the `abs tol` changes were already applied in the book sources, thus you should not need them any more.\n\nAs I told before, we cannot apply the `atol` change since the example would not work any more with Sage 8.3, which is the version we use in the book (and the latest release at that time). I have just added `test=false` to that example, thus it should not appear any more in the doctests.\n\nFor the numbertheory issue, I have also put `test=false` in the book sources, thus it should no longer be tested.\n\nAnd finally for the polynomes issue, I have replaced the test by the one using `repr(r)` that you suggested (in silent mode).\n\nIn summary, if you regenerate the doctests with revision 739453a of the book sources, all doctests should pass with both 8.3 and 8.4beta. Please can you confirm?",
    "created_at": "2018-09-27T07:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326110",
    "user": "https://github.com/zimmermann6"
}
```

Erik, the `abs tol` changes were already applied in the book sources, thus you should not need them any more.

As I told before, we cannot apply the `atol` change since the example would not work any more with Sage 8.3, which is the version we use in the book (and the latest release at that time). I have just added `test=false` to that example, thus it should not appear any more in the doctests.

For the numbertheory issue, I have also put `test=false` in the book sources, thus it should no longer be tested.

And finally for the polynomes issue, I have replaced the test by the one using `repr(r)` that you suggested (in silent mode).

In summary, if you regenerate the doctests with revision 739453a of the book sources, all doctests should pass with both 8.3 and 8.4beta. Please can you confirm?



---

archive/issue_comments_326111.json:
```json
{
    "body": "Replying to [comment:47 zimmerma]:\n> Erik, the `abs tol` changes were already applied in the book sources, thus you should not need them any more.\n\n\nOk. I see you did that yesterday, *after* I already double-checked.\n\n> As I told before, we cannot apply the `atol` change since the example would not work any more with Sage 8.3, which is the version we use in the book (and the latest release at that time). I have just added `test=false` to that example, thus it should not appear any more in the doctests.\n\n\nIf you say so.  My point is just that it's a test that can work fine when modified.  Perhaps it's not worth testing though since it's just a scipy function.\n\n> For the numbertheory issue, I have also put `test=false` in the book sources, thus it should no longer be tested.\n> \n> And finally for the polynomes issue, I have replaced the test by the one using `repr(r)` that you suggested (in silent mode).\n\n\nThat helps, but I still don't think it's a good way to test this.",
    "created_at": "2018-09-27T08:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326111",
    "user": "https://github.com/embray"
}
```

Replying to [comment:47 zimmerma]:
> Erik, the `abs tol` changes were already applied in the book sources, thus you should not need them any more.


Ok. I see you did that yesterday, *after* I already double-checked.

> As I told before, we cannot apply the `atol` change since the example would not work any more with Sage 8.3, which is the version we use in the book (and the latest release at that time). I have just added `test=false` to that example, thus it should not appear any more in the doctests.


If you say so.  My point is just that it's a test that can work fine when modified.  Perhaps it's not worth testing though since it's just a scipy function.

> For the numbertheory issue, I have also put `test=false` in the book sources, thus it should no longer be tested.
> 
> And finally for the polynomes issue, I have replaced the test by the one using `repr(r)` that you suggested (in silent mode).


That helps, but I still don't think it's a good way to test this.



---

archive/issue_comments_326112.json:
```json
{
    "body": "I guess, my point is, if there's a `[silent]` copy of that test in the book source, solely for the purpose of generating doctests to into Sage's test suite, then it might as well just be the version of the test that works on Sage 8.4.  There's no reason at all for it to work on 8.3.",
    "created_at": "2018-09-27T08:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326112",
    "user": "https://github.com/embray"
}
```

I guess, my point is, if there's a `[silent]` copy of that test in the book source, solely for the purpose of generating doctests to into Sage's test suite, then it might as well just be the version of the test that works on Sage 8.4.  There's no reason at all for it to work on 8.3.



---

archive/issue_comments_326113.json:
```json
{
    "body": "To be clear, the result here should be deterministic.  Looking at the diffs, there was some work done in this area recently.",
    "created_at": "2018-09-27T08:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326113",
    "user": "https://github.com/embray"
}
```

To be clear, the result here should be deterministic.  Looking at the diffs, there was some work done in this area recently.



---

archive/issue_comments_326114.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-10-05T10:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326114",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326115.json:
```json
{
    "body": "Well, I went ahead and updated this from the latest version of the book, and now all tests pass, so let's just go with it.  I am still confused, Paul, about what exactly your long-term intentions are w.r.t. keeping the book+sage+doctests all in sync.  But this is good enough for now.\n\nVolker, if we could have this merged in 8.4 that would be ideal.  If for some reason it has to wait, I will do my best to ensure that these tests are still passing (which shouldn't be the problem, as I believe the time has passed for non-critical changes to 8.4), but it should definitely be merged first thing after 8.4 is released, if not before.",
    "created_at": "2018-10-05T10:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326115",
    "user": "https://github.com/embray"
}
```

Well, I went ahead and updated this from the latest version of the book, and now all tests pass, so let's just go with it.  I am still confused, Paul, about what exactly your long-term intentions are w.r.t. keeping the book+sage+doctests all in sync.  But this is good enough for now.

Volker, if we could have this merged in 8.4 that would be ideal.  If for some reason it has to wait, I will do my best to ensure that these tests are still passing (which shouldn't be the problem, as I believe the time has passed for non-critical changes to 8.4), but it should definitely be merged first thing after 8.4 is released, if not before.



---

archive/issue_comments_326116.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-10-05T10:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326116",
    "user": "https://github.com/embray"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_326117.json:
```json
{
    "body": "sorry for the delay, I was busy with the book itself.\n\nErik, the goal of including this into Sage is that people changing the behavior of Sage know when they break examples in the french book, which is the same I guess for other stuff in `sage/tests`.\n\nIt would be nice if someone could review that ticket (as author of the book, I feel in conflict of interest).",
    "created_at": "2018-10-17T16:05:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326117",
    "user": "https://github.com/zimmermann6"
}
```

sorry for the delay, I was busy with the book itself.

Erik, the goal of including this into Sage is that people changing the behavior of Sage know when they break examples in the french book, which is the same I guess for other stuff in `sage/tests`.

It would be nice if someone could review that ticket (as author of the book, I feel in conflict of interest).



---

archive/issue_comments_326118.json:
```json
{
    "body": "Replying to [comment:53 zimmerma]:\n> sorry for the delay, I was busy with the book itself.\n> \n> Erik, the goal of including this into Sage is that people changing the behavior of Sage know when they break examples in the french book, which is the same I guess for other stuff in `sage/tests`.\n\n\nI understand that obviously, and that wasn't my question. My question is to what extent do you expect Sage development to conform to the examples in the book and for how long; and what is your goal for handling cases where changes to Sage do necessarily break examples from the book? As we saw from moving from 8.3 to 8.4 there were changes that \"broke\" the examples, albeit usually in mostly trivial ways, but that were changes for the better that should not have been held back just because it would have caused some differences from published books. \n\nIIUC the goal here is to just conform with the version of Sage that the book claims to conform to. But if the book needs to be updated in the future the question is how to go about that.",
    "created_at": "2018-10-17T16:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326118",
    "user": "https://github.com/embray"
}
```

Replying to [comment:53 zimmerma]:
> sorry for the delay, I was busy with the book itself.
> 
> Erik, the goal of including this into Sage is that people changing the behavior of Sage know when they break examples in the french book, which is the same I guess for other stuff in `sage/tests`.


I understand that obviously, and that wasn't my question. My question is to what extent do you expect Sage development to conform to the examples in the book and for how long; and what is your goal for handling cases where changes to Sage do necessarily break examples from the book? As we saw from moving from 8.3 to 8.4 there were changes that "broke" the examples, albeit usually in mostly trivial ways, but that were changes for the better that should not have been held back just because it would have caused some differences from published books. 

IIUC the goal here is to just conform with the version of Sage that the book claims to conform to. But if the book needs to be updated in the future the question is how to go about that.



---

archive/issue_comments_326119.json:
```json
{
    "body": "Maybe the book should avoid using \".next()\", \"<>\", \"xrange\" and \".iteritems\", no ??\n\nSee the patchbot plugins for the long list of python3 incompatibilities...",
    "created_at": "2018-10-17T18:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326119",
    "user": "https://github.com/fchapoton"
}
```

Maybe the book should avoid using ".next()", "<>", "xrange" and ".iteritems", no ??

See the patchbot plugins for the long list of python3 incompatibilities...



---

archive/issue_comments_326120.json:
```json
{
    "body": "Replying to [comment:55 chapoton]:\n> Maybe the book should avoid using \".next()\", \"<>\", \"xrange\" and \".iteritems\", no ??\n> \n> See the patchbot plugins for the long list of python3 incompatibilities...\n\n\nsorry, this is too late. The book is now in press. Maybe for the next edition?",
    "created_at": "2018-10-18T07:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326120",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:55 chapoton]:
> Maybe the book should avoid using ".next()", "<>", "xrange" and ".iteritems", no ??
> 
> See the patchbot plugins for the long list of python3 incompatibilities...


sorry, this is too late. The book is now in press. Maybe for the next edition?



---

archive/issue_comments_326121.json:
```json
{
    "body": "Erik,\n\n[...]\n\n> I understand that obviously, and that wasn't my question. My question is to what extent do you expect Sage development to conform to the examples in the book and for how long; and what is your goal for handling cases where changes to Sage do necessarily break examples from the book? As we saw from moving from 8.3 to 8.4 there were changes that \"broke\" the examples, albeit usually in mostly trivial ways, but that were changes for the better that should not have been held back just because it would have caused some differences from published books. \n> \n> IIUC the goal here is to just conform with the version of Sage that the book claims to conform to. But if the book needs to be updated in the future the question is how to go about that. \n\n\nthe Sage developers will decide what is best, like they did in the past, between changing the behavior of Sage and breaking examples from published material. I cannot decide for them to what extent or how long.\n\nThe goal is (1) to inform the Sage developers about published material that they could break, and (2) to inform the authors of the book (by adding them in cc of the corresponding tickets) when changes are made that break some examples. In case (2) we will then discuss together case-by-case, and maybe it will be an opportunity to improve the examples in the book.",
    "created_at": "2018-10-18T07:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326121",
    "user": "https://github.com/zimmermann6"
}
```

Erik,

[...]

> I understand that obviously, and that wasn't my question. My question is to what extent do you expect Sage development to conform to the examples in the book and for how long; and what is your goal for handling cases where changes to Sage do necessarily break examples from the book? As we saw from moving from 8.3 to 8.4 there were changes that "broke" the examples, albeit usually in mostly trivial ways, but that were changes for the better that should not have been held back just because it would have caused some differences from published books. 
> 
> IIUC the goal here is to just conform with the version of Sage that the book claims to conform to. But if the book needs to be updated in the future the question is how to go about that. 


the Sage developers will decide what is best, like they did in the past, between changing the behavior of Sage and breaking examples from published material. I cannot decide for them to what extent or how long.

The goal is (1) to inform the Sage developers about published material that they could break, and (2) to inform the authors of the book (by adding them in cc of the corresponding tickets) when changes are made that break some examples. In case (2) we will then discuss together case-by-case, and maybe it will be an opportunity to improve the examples in the book.



---

archive/issue_comments_326122.json:
```json
{
    "body": "Replying to [comment:56 zimmerma]:\n> Replying to [comment:55 chapoton]:\n> > Maybe the book should avoid using \".next()\", \"<>\", \"xrange\" and \".iteritems\", no ??\n> > \n> > See the patchbot plugins for the long list of python3 incompatibilities...\n\n> \n> sorry, this is too late. The book is now in press. Maybe for the next edition?\n\n\nOk. But my point is that we are not going to accept here and now any doctest that does not pass on python3.",
    "created_at": "2018-10-18T07:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326122",
    "user": "https://github.com/fchapoton"
}
```

Replying to [comment:56 zimmerma]:
> Replying to [comment:55 chapoton]:
> > Maybe the book should avoid using ".next()", "<>", "xrange" and ".iteritems", no ??
> > 
> > See the patchbot plugins for the long list of python3 incompatibilities...

> 
> sorry, this is too late. The book is now in press. Maybe for the next edition?


Ok. But my point is that we are not going to accept here and now any doctest that does not pass on python3.



---

archive/issue_comments_326123.json:
```json
{
    "body": "> Ok. But my point is that we are not going to accept here and now any doctest that does not pass on python3. \n\n\nNicolas (which I added in cc) checked some time ago with Python3, and if I recall correctly, all tests did pass. Nicolas please can you confirm?",
    "created_at": "2018-10-18T07:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326123",
    "user": "https://github.com/zimmermann6"
}
```

> Ok. But my point is that we are not going to accept here and now any doctest that does not pass on python3. 


Nicolas (which I added in cc) checked some time ago with Python3, and if I recall correctly, all tests did pass. Nicolas please can you confirm?



---

archive/issue_comments_326124.json:
```json
{
    "body": "Many doctests are not passing with python3. Among them, some (a lot) are not your fault, just failing because sage is not yet fully ready to run with python3.\n\nBut many are caused by bad doctests in the books : use of .next, use of <>, use of xrange, etc\n\nFor example, every doctest starting with map must be wrapped with list(map(..)):\n\n```\nFailed example:\n    map (cos, [0, pi/6, pi/4, pi/3, pi/2])\nExpected:\n    [1, 1/2*sqrt(3), 1/2*sqrt(2), 1/2, 0]\nGot:\n    <map object at 0x7f1c2dd9cf28>\n```\nAn example for xrange:\n\n```\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 36, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    interp_points = [(1+2*u/(n-1), N(f(1+2*u/(n-1))))\n                     for u in xrange(n)]\nException raised:\n    Traceback (most recent call last):\n      File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 659, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py\", line 1070, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.books.sagebook.integration_doctest[7]>\", line 2, in <module>\n        for u in xrange(n)]\n    NameError: name 'xrange' is not defined\n```\n\nAnd the global test result:\n\n```\nsage -t --long --warn-long src/sage/tests/books/sagebook/combinat_doctest.py  # 25 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/float_doctest.py  # 3 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/graphique_doctest.py  # 1 doctest failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/graphtheory_doctest.py  # 11 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/lp_doctest.py  # 1 doctest failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/mpoly_doctest.py  # 19 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/programmation_doctest.py  # 23 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/nonlinear_doctest.py  # 24 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/linsolve_doctest.py  # 2 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/polynomes_doctest.py  # 1 doctest failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/integration_doctest.py  # 5 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/combinat_doctest.py  # 1 doctest failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/graphique_doctest.py  # 2 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/graphtheory_doctest.py  # 1 doctest failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/mpoly_doctest.py  # 6 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/nonlinear_doctest.py  # 2 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/numbertheory_doctest.py  # 11 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/polynomes_doctest.py  # 4 doctests failed\nsage -t --long --warn-long src/sage/tests/books/sagebook/sol/integration_doctest.py  # 6 doctests failed\n```",
    "created_at": "2018-10-18T10:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326124",
    "user": "https://github.com/fchapoton"
}
```

Many doctests are not passing with python3. Among them, some (a lot) are not your fault, just failing because sage is not yet fully ready to run with python3.

But many are caused by bad doctests in the books : use of .next, use of <>, use of xrange, etc

For example, every doctest starting with map must be wrapped with list(map(..)):

```
Failed example:
    map (cos, [0, pi/6, pi/4, pi/3, pi/2])
Expected:
    [1, 1/2*sqrt(3), 1/2*sqrt(2), 1/2, 0]
Got:
    <map object at 0x7f1c2dd9cf28>
```
An example for xrange:

```
File "src/sage/tests/books/sagebook/integration_doctest.py", line 36, in sage.tests.books.sagebook.integration_doctest
Failed example:
    interp_points = [(1+2*u/(n-1), N(f(1+2*u/(n-1))))
                     for u in xrange(n)]
Exception raised:
    Traceback (most recent call last):
      File "/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 659, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/doctest/forker.py", line 1070, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.books.sagebook.integration_doctest[7]>", line 2, in <module>
        for u in xrange(n)]
    NameError: name 'xrange' is not defined
```

And the global test result:

```
sage -t --long --warn-long src/sage/tests/books/sagebook/combinat_doctest.py  # 25 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/float_doctest.py  # 3 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/graphique_doctest.py  # 1 doctest failed
sage -t --long --warn-long src/sage/tests/books/sagebook/graphtheory_doctest.py  # 11 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/lp_doctest.py  # 1 doctest failed
sage -t --long --warn-long src/sage/tests/books/sagebook/mpoly_doctest.py  # 19 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/programmation_doctest.py  # 23 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/nonlinear_doctest.py  # 24 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/linsolve_doctest.py  # 2 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/polynomes_doctest.py  # 1 doctest failed
sage -t --long --warn-long src/sage/tests/books/sagebook/integration_doctest.py  # 5 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/combinat_doctest.py  # 1 doctest failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/graphique_doctest.py  # 2 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/graphtheory_doctest.py  # 1 doctest failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/mpoly_doctest.py  # 6 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/nonlinear_doctest.py  # 2 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/numbertheory_doctest.py  # 11 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/polynomes_doctest.py  # 4 doctests failed
sage -t --long --warn-long src/sage/tests/books/sagebook/sol/integration_doctest.py  # 6 doctests failed
```



---

archive/issue_comments_326125.json:
```json
{
    "body": "Replying to [comment:59 zimmerma]:\n> > Ok. But my point is that we are not going to accept here and now any doctest that does not pass on python3. \n  \n> \n> Nicolas (which I added in cc) checked some time ago with Python3, and if I recall correctly, all tests did pass. Nicolas please can you confirm?\n\n\nMore precisely: I had checked with Python 2 together with from future imports (print_statements, division, absolute_import); this does not cover all Python3 incompatibilities.",
    "created_at": "2018-10-19T15:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326125",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:59 zimmerma]:
> > Ok. But my point is that we are not going to accept here and now any doctest that does not pass on python3. 
  
> 
> Nicolas (which I added in cc) checked some time ago with Python3, and if I recall correctly, all tests did pass. Nicolas please can you confirm?


More precisely: I had checked with Python 2 together with from future imports (print_statements, division, absolute_import); this does not cover all Python3 incompatibilities.



---

archive/issue_comments_326126.json:
```json
{
    "body": "Because we are now (**painfully**) trying to make all doctests pass with python3, this ticket will only be accepted with the necessary changes that make all or most of its doctests pass with python3. I am sorry that this forces some differences with the fresh new book.\n\nOn the other hand, I am surprised that this book for example still uses (and maybe even recommends using) `<>`, which is known since along time to be deprecated.",
    "created_at": "2018-10-19T15:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326126",
    "user": "https://github.com/fchapoton"
}
```

Because we are now (**painfully**) trying to make all doctests pass with python3, this ticket will only be accepted with the necessary changes that make all or most of its doctests pass with python3. I am sorry that this forces some differences with the fresh new book.

On the other hand, I am surprised that this book for example still uses (and maybe even recommends using) `<>`, which is known since along time to be deprecated.



---

archive/issue_comments_326127.json:
```json
{
    "body": "Replying to [comment:63 chapoton]:\n> Because we are now (**painfully**) trying to make all doctests pass with python3, this ticket will only be accepted with the necessary changes that make all or most of its doctests pass with python3. I am sorry that this forces some differences with the fresh new book.\n\n\nthis ticket would make no sense any more, if not checking the examples from the book.\n\nWe are in a dead end. I see no solution.",
    "created_at": "2018-10-19T16:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326127",
    "user": "https://github.com/zimmermann6"
}
```

Replying to [comment:63 chapoton]:
> Because we are now (**painfully**) trying to make all doctests pass with python3, this ticket will only be accepted with the necessary changes that make all or most of its doctests pass with python3. I am sorry that this forces some differences with the fresh new book.


this ticket would make no sense any more, if not checking the examples from the book.

We are in a dead end. I see no solution.



---

archive/issue_comments_326128.json:
```json
{
    "body": "But couldn't you adapt the examples in the book to make them Python 3 compatible?",
    "created_at": "2018-10-19T17:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326128",
    "user": "https://github.com/jdemeyer"
}
```

But couldn't you adapt the examples in the book to make them Python 3 compatible?



---

archive/issue_events_060394.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:40:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60394"
}
```



---

archive/issue_events_060395.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:40:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60395"
}
```



---

archive/issue_comments_326129.json:
```json
{
    "body": "Replying to [comment:65 jdemeyer]:\n> But couldn't you adapt the examples in the book to make them Python 3 compatible?\n\n\nAs Paul already demonstrated to me while working on this ticket earlier, the tex markup for the book is already such that it's possible to have multiple copies of a given example: One that is actually shown in the book, but excluded from the tests, and one that is hidden from the text but included in the generated doctests.  So we could easily do that for the examples that are currently not Python 3 compatible.\n\nOr, more simply, for now I could just modify the copies of the examples included in Sage to be Python 3 compatible.  Most, if not all of these changes do not change the substance of the example, but rather are minor syntactic and spelling changes, mostly to do with Python itself (and not anything Sage-specific).",
    "created_at": "2018-10-28T15:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326129",
    "user": "https://github.com/embray"
}
```

Replying to [comment:65 jdemeyer]:
> But couldn't you adapt the examples in the book to make them Python 3 compatible?


As Paul already demonstrated to me while working on this ticket earlier, the tex markup for the book is already such that it's possible to have multiple copies of a given example: One that is actually shown in the book, but excluded from the tests, and one that is hidden from the text but included in the generated doctests.  So we could easily do that for the examples that are currently not Python 3 compatible.

Or, more simply, for now I could just modify the copies of the examples included in Sage to be Python 3 compatible.  Most, if not all of these changes do not change the substance of the example, but rather are minor syntactic and spelling changes, mostly to do with Python itself (and not anything Sage-specific).



---

archive/issue_comments_326130.json:
```json
{
    "body": "Here is a branch with some tests modified to be compatible with python3.\n\nWork in progress.\n\n---\nNew commits:",
    "created_at": "2018-11-04T13:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326130",
    "user": "https://github.com/fchapoton"
}
```

Here is a branch with some tests modified to be compatible with python3.

Work in progress.

---
New commits:



---

archive/issue_comments_326131.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-04T13:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326131",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326132.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-04T13:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326132",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326133.json:
```json
{
    "body": "For the ones involving `reduce` that you marked `# py2`, instead you could import `reduce` from `functools`.  \n\nIn fact, I always found it annoying that Guido took `reduce` out of the built-ins.  I think for Sage on Python 3, in order to maintain compatibility, we should add `reduce` back in as a default global.\n\nFr\u00e9d\u00e9ric, could you add a new ticket to do that, and drop the `# py2` stuff from this ticket and make this a dependency on the `reduce` one?  Then squash the the Python 3 fixes you added into a single commit (to make it a bit more manageable).  After that's done we should set this positive_review.\n\nAs I suspected, none of the Python 3 fixes for these tests materially impact the tests in any semantically meaningful way.",
    "created_at": "2018-11-06T10:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326133",
    "user": "https://github.com/embray"
}
```

For the ones involving `reduce` that you marked `# py2`, instead you could import `reduce` from `functools`.  

In fact, I always found it annoying that Guido took `reduce` out of the built-ins.  I think for Sage on Python 3, in order to maintain compatibility, we should add `reduce` back in as a default global.

Frédéric, could you add a new ticket to do that, and drop the `# py2` stuff from this ticket and make this a dependency on the `reduce` one?  Then squash the the Python 3 fixes you added into a single commit (to make it a bit more manageable).  After that's done we should set this positive_review.

As I suspected, none of the Python 3 fixes for these tests materially impact the tests in any semantically meaningful way.



---

archive/issue_comments_326134.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-11-06T10:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326134",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_326135.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-11-06T14:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326135",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326136.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-06T20:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326136",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_326137.json:
```json
{
    "body": "done",
    "created_at": "2018-11-06T20:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326137",
    "user": "https://github.com/fchapoton"
}
```

done



---

archive/issue_comments_326138.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-07T19:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326138",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326139.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-08T15:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326139",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_326140.json:
```json
{
    "body": "sorry, but I am not sure that the doctests do pass, as the patchbot has reported something strange. And they certainly do not all pass with python3..",
    "created_at": "2018-11-08T16:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326140",
    "user": "https://github.com/fchapoton"
}
```

sorry, but I am not sure that the doctests do pass, as the patchbot has reported something strange. And they certainly do not all pass with python3..



---

archive/issue_comments_326141.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-08T16:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326141",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_326142.json:
```json
{
    "body": "Well, please have a look then, because this looks related to some of the python 3 fixes you added (strangely).  I also assumed when you wrote \"done\" you had squashed the python 3 fixes--which you did--but it seems you've added more.",
    "created_at": "2018-11-08T16:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326142",
    "user": "https://github.com/embray"
}
```

Well, please have a look then, because this looks related to some of the python 3 fixes you added (strangely).  I also assumed when you wrote "done" you had squashed the python 3 fixes--which you did--but it seems you've added more.



---

archive/issue_comments_326143.json:
```json
{
    "body": "Changing assignee from @embray to @fchapoton.",
    "created_at": "2018-11-08T16:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326143",
    "user": "https://github.com/embray"
}
```

Changing assignee from @embray to @fchapoton.



---

archive/issue_comments_326144.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-10T14:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326144",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326145.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-10T14:04:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326145",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_326146.json:
```json
{
    "body": "red branch",
    "created_at": "2018-11-12T08:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326146",
    "user": "https://github.com/fchapoton"
}
```

red branch



---

archive/issue_comments_326147.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-11-12T08:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326147",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_326148.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-12T09:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326148",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326149.json:
```json
{
    "body": "rebased\n\n---\nNew commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[6d8f188](https://git.sagemath.org/sage.git/commit?id=6d8f188bb44969dbdab282109070a8bf6f25667e)|`Merge branch 'public/french_book_python3' in 8.5.b3`|\n---\nNew commits:",
    "created_at": "2018-11-12T09:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326149",
    "user": "https://github.com/fchapoton"
}
```

rebased

---
New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[6d8f188](https://git.sagemath.org/sage.git/commit?id=6d8f188bb44969dbdab282109070a8bf6f25667e)|`Merge branch 'public/french_book_python3' in 8.5.b3`|
---
New commits:



---

archive/issue_comments_326150.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-12T09:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326150",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_326151.json:
```json
{
    "body": "Why this change?\n\n```diff\ndiff --git a/src/sage/tests/books/sagebook/combinat_doctest.py b/src/sage/tests/books/sagebook/combinat_doctest.py\nindex 2192fe6..40a0aa1 100644\n--- a/src/sage/tests/books/sagebook/combinat_doctest.py\n+++ b/src/sage/tests/books/sagebook/combinat_doctest.py\n@@ -590,9 +590,9 @@ Sage example in ./combinat.tex, line 1895::\n Sage example in ./combinat.tex, line 1909::\n \n   sage: cubes = [t**3 for t in range(-999,1000)]\n-  sage: exists([(x,y) for x in cubes for y in cubes], lambda x,y: x+y == 218) # long\n+  sage: exists([(x,y) for x in cubes for y in cubes], lambda xy: sum(xy) == 218) # long\n   (True, (-125, 343))\n-  sage: exists(((x,y) for x in cubes for y in cubes), lambda x,y: x+y == 218) # long\n+  sage: exists(((x,y) for x in cubes for y in cubes), lambda xy: sum(xy) == 218) # long\n   (True, (-125, 343))\n \n Sage example in ./combinat.tex, line 1927::\n```\n\nThat doesn't look necessary...?\n\nThis one also looks like a more substantive change than it should be:\n\n```diff\ndiff --git a/src/sage/tests/books/sagebook/graphtheory_doctest.py b/src/sage/tests/books/sagebook/graphtheory_doctest.py\nindex c60c4a8..f64f416 100644\n--- a/src/sage/tests/books/sagebook/graphtheory_doctest.py\n+++ b/src/sage/tests/books/sagebook/graphtheory_doctest.py\n@@ -360,9 +360,8 @@ Sage example in ./graphtheory.tex, line 2070::\n \n Sage example in ./graphtheory.tex, line 2084::\n \n-  sage: G.independent_set()\n-  [4, 6, 9, 11, 16, 21, 23, 26, 28, 33, 38, 43, 50,\n-  56, 61, 71, 76, 78, 83, 88, 93, 95, 98, 100]\n+  sage: X = G.independent_set(); G.is_independent_set(X)\n+  True\n \n Sage example in ./graphtheory.tex, line 2139::\n```\n\nIf it happens that on Python 3 a different independent set is returned that's fine, but then we should mark that line `# random` and add the `G.is_independent_set(X)` test on a separate line.\n\nI can fix the latter.  But for the prior I wanted to check with you why the change was made since AFAICT there's no reason for it.",
    "created_at": "2018-11-12T10:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326151",
    "user": "https://github.com/embray"
}
```

Why this change?

```diff
diff --git a/src/sage/tests/books/sagebook/combinat_doctest.py b/src/sage/tests/books/sagebook/combinat_doctest.py
index 2192fe6..40a0aa1 100644
--- a/src/sage/tests/books/sagebook/combinat_doctest.py
+++ b/src/sage/tests/books/sagebook/combinat_doctest.py
@@ -590,9 +590,9 @@ Sage example in ./combinat.tex, line 1895::
 Sage example in ./combinat.tex, line 1909::
 
   sage: cubes = [t**3 for t in range(-999,1000)]
-  sage: exists([(x,y) for x in cubes for y in cubes], lambda x,y: x+y == 218) # long
+  sage: exists([(x,y) for x in cubes for y in cubes], lambda xy: sum(xy) == 218) # long
   (True, (-125, 343))
-  sage: exists(((x,y) for x in cubes for y in cubes), lambda x,y: x+y == 218) # long
+  sage: exists(((x,y) for x in cubes for y in cubes), lambda xy: sum(xy) == 218) # long
   (True, (-125, 343))
 
 Sage example in ./combinat.tex, line 1927::
```

That doesn't look necessary...?

This one also looks like a more substantive change than it should be:

```diff
diff --git a/src/sage/tests/books/sagebook/graphtheory_doctest.py b/src/sage/tests/books/sagebook/graphtheory_doctest.py
index c60c4a8..f64f416 100644
--- a/src/sage/tests/books/sagebook/graphtheory_doctest.py
+++ b/src/sage/tests/books/sagebook/graphtheory_doctest.py
@@ -360,9 +360,8 @@ Sage example in ./graphtheory.tex, line 2070::
 
 Sage example in ./graphtheory.tex, line 2084::
 
-  sage: G.independent_set()
-  [4, 6, 9, 11, 16, 21, 23, 26, 28, 33, 38, 43, 50,
-  56, 61, 71, 76, 78, 83, 88, 93, 95, 98, 100]
+  sage: X = G.independent_set(); G.is_independent_set(X)
+  True
 
 Sage example in ./graphtheory.tex, line 2139::
```

If it happens that on Python 3 a different independent set is returned that's fine, but then we should mark that line `# random` and add the `G.is_independent_set(X)` test on a separate line.

I can fix the latter.  But for the prior I wanted to check with you why the change was made since AFAICT there's no reason for it.



---

archive/issue_comments_326152.json:
```json
{
    "body": "With python3:\n\n```\nsage: cubes = [t**3 for t in range(-999,1000)]\nsage: exists([(x,y) for x in cubes for y in cubes], lambda xy: sum(xy) == 218) \n(True, (-125, 343))\nsage: exists([(x,y) for x in cubes for y in cubes], lambda x,y: x+y == 218)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-ea62578e4e4d> in <module>()\n----> 1 exists([(x,y) for x in cubes for y in cubes], lambda x,y: x+y == Integer(218))\n\n/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/misc/misc.py in exists(S, P)\n   1389     \"\"\"\n   1390     for x in S:\n-> 1391         if P(x):\n   1392             return True, x\n   1393     return False, None\n\nTypeError: <lambda>() missing 1 required positional argument: 'y'\n```",
    "created_at": "2018-11-12T16:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326152",
    "user": "https://github.com/fchapoton"
}
```

With python3:

```
sage: cubes = [t**3 for t in range(-999,1000)]
sage: exists([(x,y) for x in cubes for y in cubes], lambda xy: sum(xy) == 218) 
(True, (-125, 343))
sage: exists([(x,y) for x in cubes for y in cubes], lambda x,y: x+y == 218)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-ea62578e4e4d> in <module>()
----> 1 exists([(x,y) for x in cubes for y in cubes], lambda x,y: x+y == Integer(218))

/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/misc/misc.py in exists(S, P)
   1389     """
   1390     for x in S:
-> 1391         if P(x):
   1392             return True, x
   1393     return False, None

TypeError: <lambda>() missing 1 required positional argument: 'y'
```



---

archive/issue_comments_326153.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-19T10:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326153",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326154.json:
```json
{
    "body": "The suggested change for independent set is done. The other suggestion is not right, see above.",
    "created_at": "2018-11-19T10:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326154",
    "user": "https://github.com/fchapoton"
}
```

The suggested change for independent set is done. The other suggestion is not right, see above.



---

archive/issue_comments_326155.json:
```json
{
    "body": "Why did `sage.misc.misc.exists` change/break?  It looks like it used to be able to accept a list of tuples and now it can't?",
    "created_at": "2018-11-19T18:02:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326155",
    "user": "https://github.com/embray"
}
```

Why did `sage.misc.misc.exists` change/break?  It looks like it used to be able to accept a list of tuples and now it can't?



---

archive/issue_comments_326156.json:
```json
{
    "body": "nothing has changed, the \"exists\" failing doctests also fail with python2.",
    "created_at": "2018-11-19T19:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326156",
    "user": "https://github.com/fchapoton"
}
```

nothing has changed, the "exists" failing doctests also fail with python2.



---

archive/issue_comments_326157.json:
```json
{
    "body": "anybody out there ?",
    "created_at": "2018-11-25T19:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326157",
    "user": "https://github.com/fchapoton"
}
```

anybody out there ?



---

archive/issue_comments_326158.json:
```json
{
    "body": "Replying to [comment:90 chapoton]:\n> nothing has changed, the \"exists\" failing doctests also fail with python2.\n\n\nI understand that's not a Python 3 specific thing, but something *must* have changed in Sage since the 8.4 release since that test didn't fail before...or did it?  Was there some reason it wasn't being run?",
    "created_at": "2018-11-26T09:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326158",
    "user": "https://github.com/embray"
}
```

Replying to [comment:90 chapoton]:
> nothing has changed, the "exists" failing doctests also fail with python2.


I understand that's not a Python 3 specific thing, but something *must* have changed in Sage since the 8.4 release since that test didn't fail before...or did it?  Was there some reason it wasn't being run?



---

archive/issue_comments_326159.json:
```json
{
    "body": "Replying to [comment:92 embray]:\n> Replying to [comment:90 chapoton]:\n> > nothing has changed, the \"exists\" failing doctests also fail with python2.\n\n> \n> I understand that's not a Python 3 specific thing, but something *must* have changed in Sage since the 8.4 release since that test didn't fail before...or did it?  Was there some reason it wasn't being run?\n\n\nWell, AFAICT, it really *hasn't* changed at all recently.  So I wonder how that test ever passed, unless it was never being run at all...",
    "created_at": "2018-11-26T09:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326159",
    "user": "https://github.com/embray"
}
```

Replying to [comment:92 embray]:
> Replying to [comment:90 chapoton]:
> > nothing has changed, the "exists" failing doctests also fail with python2.

> 
> I understand that's not a Python 3 specific thing, but something *must* have changed in Sage since the 8.4 release since that test didn't fail before...or did it?  Was there some reason it wasn't being run?


Well, AFAICT, it really *hasn't* changed at all recently.  So I wonder how that test ever passed, unless it was never being run at all...



---

archive/issue_comments_326160.json:
```json
{
    "body": "Ah, I see now.  In the original test it used `lambda (x,y):`, which actually gets parsed as tuple unpacking in the function signature (e.g. same as `def f((x, y)):`) which was dropped in Python 3.  That's very subtle since in the `lambda` context it's less clear that that's what's going on (perhaps at least part of why it was dropped).\n\nOkay.",
    "created_at": "2018-11-26T09:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326160",
    "user": "https://github.com/embray"
}
```

Ah, I see now.  In the original test it used `lambda (x,y):`, which actually gets parsed as tuple unpacking in the function signature (e.g. same as `def f((x, y)):`) which was dropped in Python 3.  That's very subtle since in the `lambda` context it's less clear that that's what's going on (perhaps at least part of why it was dropped).

Okay.



---

archive/issue_comments_326161.json:
```json
{
    "body": "So ? Can we move on ? Paul, what do you think ?",
    "created_at": "2018-12-02T21:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326161",
    "user": "https://github.com/fchapoton"
}
```

So ? Can we move on ? Paul, what do you think ?



---

archive/issue_comments_326162.json:
```json
{
    "body": "> So ? Can we move on ? Paul, what do you think ? \n\n\nas I said in comment [comment:64], this ticket has diverged from the book (now in print), thus I am no longer motivated to work on it.",
    "created_at": "2018-12-03T09:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326162",
    "user": "https://github.com/zimmermann6"
}
```

> So ? Can we move on ? Paul, what do you think ? 


as I said in comment [comment:64], this ticket has diverged from the book (now in print), thus I am no longer motivated to work on it.



---

archive/issue_comments_326163.json:
```json
{
    "body": "Bonjour Paul.\n\nEst-ce que \u00e7a veut dire qu'on peut valider ce ticket ? D'une certaine fa\u00e7on, les doctests sont ceux du livre, juste modifi\u00e9s minimalement pour \u00eatre valides sous python 3.\n\nJe suis d\u00e9sol\u00e9 que \u00e7a complique la relation avec le livre. C'est vraiment dommage que le livre ne soit pas compatible avec python 3.",
    "created_at": "2018-12-03T09:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326163",
    "user": "https://github.com/fchapoton"
}
```

Bonjour Paul.

Est-ce que ça veut dire qu'on peut valider ce ticket ? D'une certaine façon, les doctests sont ceux du livre, juste modifiés minimalement pour être valides sous python 3.

Je suis désolé que ça complique la relation avec le livre. C'est vraiment dommage que le livre ne soit pas compatible avec python 3.



---

archive/issue_comments_326164.json:
```json
{
    "body": "yes please go on, after modifying the description to reflect the fact that these doctests are not exactly those from the book",
    "created_at": "2018-12-03T10:10:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326164",
    "user": "https://github.com/zimmermann6"
}
```

yes please go on, after modifying the description to reflect the fact that these doctests are not exactly those from the book



---

archive/issue_comments_326165.json:
```json
{
    "body": "I modified the ticket description. Needs review. Erik ?",
    "created_at": "2018-12-07T19:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326165",
    "user": "https://github.com/fchapoton"
}
```

I modified the ticket description. Needs review. Erik ?



---

archive/issue_comments_326166.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-10T13:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326166",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_326167.json:
```json
{
    "body": "The alternative, I suppose, would be to provide some way to just completely skip those tests on Python 3.  In a way, that might have been better.  Of course they were not written with Python 3 in mind: The book was not either, as Sage does not support Python 3 yet.  But I agree with Fr\u00e9d\u00e9ric that the translation required for running these tests on Python 3 is also trivial, and so they are still serving their intended purpose of noting changes to Sage that would invalidate the book's examples.",
    "created_at": "2018-12-10T13:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326167",
    "user": "https://github.com/embray"
}
```

The alternative, I suppose, would be to provide some way to just completely skip those tests on Python 3.  In a way, that might have been better.  Of course they were not written with Python 3 in mind: The book was not either, as Sage does not support Python 3 yet.  But I agree with Frédéric that the translation required for running these tests on Python 3 is also trivial, and so they are still serving their intended purpose of noting changes to Sage that would invalidate the book's examples.



---

archive/issue_comments_326168.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2018-12-19T17:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326168",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_326169.json:
```json
{
    "body": "One patchbot reports\n\n```\nsage -t --long src/sage/tests/books/sagebook/float_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 287, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    RBF(pi)\nExpected:\n    [3.141592653589793 +/- 5.61e-16]\nGot:\n    [3.141592653589793 +/- 3.39e-16]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 289, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    RealBallField(100)(pi)\nExpected:\n    [3.14159265358979323846264338328 +/- 3.83e-30]\nGot:\n    [3.14159265358979323846264338328 +/- 2.25e-30]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 431, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    CBF(sqrt(2),pi)\nExpected:\n    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 5.61e-16]*I\nGot:\n    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 3.39e-16]*I\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 437, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    CBF(sqrt(2)+pi*I)\nExpected:\n    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 5.61e-16]*I\nGot:\n    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 3.39e-16]*I\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 462, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    ComplexBallField(100)(1+I*pi).arg()\nExpected:\n    [1.26262725567891168344432208360 +/- 6.60e-30]\nGot:\n    [1.26262725567891168344432208360 +/- 6.46e-30]\n**********************************************************************\n```\n\nDo we have a reason to say that this patchbot is wrong?",
    "created_at": "2018-12-19T17:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326169",
    "user": "https://github.com/jdemeyer"
}
```

One patchbot reports

```
sage -t --long src/sage/tests/books/sagebook/float_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 287, in sage.tests.books.sagebook.float_doctest
Failed example:
    RBF(pi)
Expected:
    [3.141592653589793 +/- 5.61e-16]
Got:
    [3.141592653589793 +/- 3.39e-16]
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 289, in sage.tests.books.sagebook.float_doctest
Failed example:
    RealBallField(100)(pi)
Expected:
    [3.14159265358979323846264338328 +/- 3.83e-30]
Got:
    [3.14159265358979323846264338328 +/- 2.25e-30]
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 431, in sage.tests.books.sagebook.float_doctest
Failed example:
    CBF(sqrt(2),pi)
Expected:
    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 5.61e-16]*I
Got:
    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 3.39e-16]*I
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 437, in sage.tests.books.sagebook.float_doctest
Failed example:
    CBF(sqrt(2)+pi*I)
Expected:
    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 5.61e-16]*I
Got:
    [1.414213562373095 +/- 4.10e-16] + [3.141592653589793 +/- 3.39e-16]*I
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 462, in sage.tests.books.sagebook.float_doctest
Failed example:
    ComplexBallField(100)(1+I*pi).arg()
Expected:
    [1.26262725567891168344432208360 +/- 6.60e-30]
Got:
    [1.26262725567891168344432208360 +/- 6.46e-30]
**********************************************************************
```

Do we have a reason to say that this patchbot is wrong?



---

archive/issue_comments_326170.json:
```json
{
    "body": "and in fact two patchbots complain at this same place..",
    "created_at": "2018-12-19T20:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326170",
    "user": "https://github.com/fchapoton"
}
```

and in fact two patchbots complain at this same place..



---

archive/issue_comments_326171.json:
```json
{
    "body": "This would be due to #26360.  For now we should use the (not ideal) solution from that ticket of just replacing the mantissa in those floats with `...`.",
    "created_at": "2018-12-20T12:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326171",
    "user": "https://github.com/embray"
}
```

This would be due to #26360.  For now we should use the (not ideal) solution from that ticket of just replacing the mantissa in those floats with `...`.



---

archive/issue_comments_326172.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-30T10:32:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326173.json:
```json
{
    "body": "I have fixed the float doctests in the suggested way.",
    "created_at": "2018-12-30T10:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326173",
    "user": "https://github.com/fchapoton"
}
```

I have fixed the float doctests in the suggested way.



---

archive/issue_comments_326174.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-12-30T10:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326174",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_326175.json:
```json
{
    "body": "bot is now morally green",
    "created_at": "2018-12-30T19:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326175",
    "user": "https://github.com/fchapoton"
}
```

bot is now morally green



---

archive/issue_comments_326176.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-31T10:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326176",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_060396.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-31T10:06:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60396"
}
```



---

archive/issue_events_060397.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-31T10:06:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60397"
}
```



---

archive/issue_comments_326177.json:
```json
{
    "body": "on OSX:\n\n```\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 208, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    print(\"exact - classical summation: %.1f\" % (s-ii))\nExpected:\n    exact - classical summation: -45.5\nGot:\n    exact - classical summation: -45.6\n**********************************************************************\n1 item had failures:\n   1 of 142 in sage.tests.books.sagebook.float_doctest\n    [141 tests, 1 failure, 40.89 s]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/graphtheory_doctest.py\", line 66, in sage.tests.books.sagebook.graphtheory_doctest\nFailed example:\n    P.minor(graphs.CompleteBipartiteGraph(3,3))\nExpected:\n    {0: [1], 1: [8], 2: [4], 3: [6, 7, 9], 4: [2, 3], 5: [0, 5]}\nGot:\n    {0: [0, 4], 1: [1, 6, 8], 2: [2, 7], 3: [3], 4: [9], 5: [5]}\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/graphtheory_doctest.py\", line 68, in sage.tests.books.sagebook.graphtheory_doctest\nFailed example:\n    P.minor(graphs.CompleteGraph(5))\nExpected:\n    {0: [1, 6], 1: [0, 5], 2: [2, 7], 3: [4, 9], 4: [3, 8]}\nGot:\n    {0: [5, 8], 1: [1, 6], 2: [2, 3], 3: [7, 9], 4: [0, 4]}\n**********************************************************************\n1 item had failures:\n   2 of 114 in sage.tests.books.sagebook.graphtheory_doctest\n    [113 tests, 2 failures, 8.61 s]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 24, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    N(integrate(sin(x^2)/(x^2), x, 1, infinity))\nExpected:\n    0.285736646322853 - 6.93889390390723e-18*I\nGot:\n    0.285736646322853 + 6.93889390390723e-18*I\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 45, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    N(integrate(exp(-x^2)*log(x), x, 17, 42))\nExpected:\n    2.5657285006962035e-127\nGot:\n    2.565728500696221e-127\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 57, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    numerical_integral(exp(-x^2)*log(x), 17, 42)\nExpected:\n    (2.5657285006962035e-127, 3.3540254049238093e-128)\nGot:\n    (2.565728500696221e-127, 3.3540254049023843e-128)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 64, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    numerical_integral(exp(-x^100), 0, 1.1, algorithm='qng')\nExpected:\n    (0.994327538576531..., 0.016840666914688864)\nGot:\n    (0.9943275385765319, 0.016840666914705607)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 74, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    N(integrate(exp(-x^2)*log(x), x, 17, 42), digits=60)\nExpected:\n    2.5657285006962035e-127\nGot:\n    2.565728500696221e-127\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 95, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=17, 20, exp(-x^2)*log(x))')\nExpected:\n    2.5657285005610514829173563961304785900 E-127\nGot:\n    2.565728500561051482917356396 E-127\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 100, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=0, 1, sin(sin(x)))')\nExpected:\n    0.43060610312069060491237735524846578643\nGot:\n    0.4306061031206906049123773553\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 109, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=0, 1, x^(-99/100))') # abs tol 2e-16\nExpected:\n    73.62914262423378365\nGot:\n    67.28157752276430690714796980\nTolerance exceeded:\n    73.62914262423378365 vs 67.28157752276430690714796980, tolerance 6e+00 > 2e-16\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 114, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=[0, -99/100], 1, x^(-99/100))')\nExpected:\n    100.00000000000000000000000000000000000\nGot:\n    100.0000000000000000000000000\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 119, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 2e-16\nExpected:\n    74.47274932028288503\nGot:\n    68.16118711180150288540450897\nTolerance exceeded:\n    74.47274932028288503 vs 68.16118711180150288540450897, tolerance 6e+00 > 2e-16\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 178, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    f(0.0), f(0.5), f(1.0)\nExpected:\n    (0.0, 0.8414895067661431, 1.6318696084180513)\nGot:\n    (0.0, 0.8414895067661431, 1.6318696084180517)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 183, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    numerical_integral(f, 0, 1)\nExpected:\n    (0.8606791942204567, 6.301207560882073e-07)\nGot:\n    (0.8606791942204566, 6.301207561280224e-07)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 190, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    numerical_integral(f, 0, 1)\nExpected:\n    (0.860679194220456..., 6.301207560882096e-07)\nGot:\n    (0.8606791942204566, 6.301207560974723e-07)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 197, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    numerical_integral(f, 0, 1)\nExpected:\n    (0.8606791942204567, 6.301207561187562e-07)\nGot:\n    (0.8606791942204565, 6.301207561295888e-07)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/integration_doctest.py\", line 213, in sage.tests.books.sagebook.integration_doctest\nFailed example:\n    evalI(100)\nExpected:\n    (0.8606792028826138, 5.553962923506737e-07)\nGot:\n    (0.8606792028826138, 5.553962919606637e-07)\n**********************************************************************\n1 item had failures:\n  15 of  87 in sage.tests.books.sagebook.integration_doctest\n    [86 tests, 15 failures, 23.56 s]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 129, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    R1.solve_right(c)\nExpected:\n    (-1.499999999999999, -0.49999999999999867, 2.749999999999997)\nGot:\n    (-1.4999999999999967, -0.49999999999999745, 2.749999999999994)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 135, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    Z.norm(Infinity)*(Z^-1).norm(Infinity) # abs tol 1e-11\nExpected:\n    1992.3750000000168\nGot:\n    1992.3750000000014\nTolerance exceeded:\n    1992.3750000000168 vs 1992.3750000000014, tolerance 2e-11 > 1e-11\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 150, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    x = V*lamb; x\nExpected:\n    (0.2370370370370367, 0.4518518518518521, 0.3703703703703702)\nGot:\n    (-5341941225574732.0, -2670970612787367.0, 6677426531968419.0)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 155, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    m = 3; [ Sig[i,i] for i in range(0,m) ]\nExpected:\n    [8.309316833256451, 1.3983038884881154, 0.0]\nGot:\n    [8.309316833256451, 1.3983038884881158, 1.1474751322044736e-16]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 180, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    Q\nExpected:\n    [ 0.7612151656410958  0.6484993998439783]\n    [-0.6484993998439782  0.7612151656410955]\nGot:\n    [ 0.7612151656410957   0.648499399843978]\n    [-0.6484993998439779  0.7612151656410955]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 215, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    X\nExpected:\n    (0.9276845629439007, 0.10329475725387141, -0.3587917847435305)\nGot:\n    (0.9276845629439006, 0.1032947572538714, -0.3587917847435305)\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 234, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    Aref.eigenvalues()\nExpected:\n    [585.0305586200212, 92.91426499150643, 0.03226690899408103, 4.022909479477674]\nGot:\n    [585.0305586200216, 92.91426499150661, 0.03226690899409142, 4.022909479477676]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 241, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    eigen_vals\nExpected:\n    [   6.39294791648918                 0.0                 0.0]\n    [                0.0   0.560519476111939                 0.0]\n    [                0.0                 0.0 -1.9534673926011215]\nGot:\n    [  6.392947916489186                 0.0                 0.0]\n    [                0.0  0.5605194761119401                 0.0]\n    [                0.0                 0.0 -1.9534673926011223]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/linsolve_doctest.py\", line 272, in sage.tests.books.sagebook.linsolve_doctest\nFailed example:\n    roots = comp.eigenvalues(); roots\nExpected:\n    [0.3475215101190289 + 0.5665505533984981*I, 0.3475215101190289 - 0.5665505533984981*I,\n     0.34502377696179265 + 0.43990870238588275*I, 0.34502377696179265 - 0.43990870238588275*I,\n     -0.5172576143252197 + 0.5129582067889322*I, -0.5172576143252197 - 0.5129582067889322*I,\n     -1.3669971645459291, -9.983578180965276]\nGot:\n    [0.3475215101190277 + 0.5665505533984982*I,\n     0.3475215101190277 - 0.5665505533984982*I,\n     0.34502377696179476 + 0.4399087023858829*I,\n     0.34502377696179476 - 0.4399087023858829*I,\n     -0.5172576143252197 + 0.5129582067889321*I,\n     -0.5172576143252197 - 0.5129582067889321*I,\n     -1.366997164545929,\n     -9.983578180965276]\n**********************************************************************\n1 item had failures:\n   9 of 132 in sage.tests.books.sagebook.linsolve_doctest\n    [131 tests, 9 failures, 17.02 s]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/mpoly_doctest.py\", line 395, in sage.tests.books.sagebook.mpoly_doctest\nFailed example:\n    ys = CDF['y'](Jy.0).roots(); ys\nExpected:\n    [(-0.8000000000000002, 1), (0.0, 1), (0.8, 1)]\nGot:\n    [(-0.8, 1), (0.0, 1), (0.7999999999999997, 1)]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/mpoly_doctest.py\", line 397, in sage.tests.books.sagebook.mpoly_doctest\nFailed example:\n    [CDF['x'](p(y=ys[0][0])).roots() for p in J.gens()]\nExpected:\n    [[(-0.5999999999999999 - 1.306289919090511e-16*I, 1),\n     (0.6000000000000001 + 1.3062899190905113e-16*I, 1)],\n     [(0.6000000000000001 - 3.1350958058172247e-16*I, 1),\n      (2.600000000000001 + 3.135095805817224e-16*I, 1)]]\nGot:\n    [[(-0.6 - 1.30628991909051e-16*I, 1), (0.6 + 1.3062899190905103e-16*I, 1)],\n     [(0.6 - 3.135095805817224e-16*I, 1),\n      (2.6000000000000005 + 3.1350958058172237e-16*I, 1)]]\n**********************************************************************\n1 item had failures:\n   2 of 161 in sage.tests.books.sagebook.mpoly_doctest\n    [160 tests, 2 failures, 8.27 s]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/polynomes_doctest.py\", line 76, in sage.tests.books.sagebook.polynomes_doctest\nFailed example:\n    p.change_ring(RDF).factor()\nExpected:\n    (x - 15.810249675906654) * (x - 0.18975032409334563)\nGot:\n    (x - 15.810249675906654) * (x - 0.1897503240933456)\n**********************************************************************\n1 item had failures:\n   1 of 111 in sage.tests.books.sagebook.polynomes_doctest\n    [110 tests, 1 failure, 2.48 s]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/sol/integration_doctest.py\", line 39, in sage.tests.books.sagebook.sol.integration_doctest\nFailed example:\n    N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 2e-15\nExpected:\n    0.250000000000001\nGot:\n    0.249999999999996\nTolerance exceeded:\n    0.250000000000001 vs 0.249999999999996, tolerance 5e-15 > 2e-15\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/sol/integration_doctest.py\", line 41, in sage.tests.books.sagebook.sol.integration_doctest\nFailed example:\n    numerical_integral(sqrt(1-x^2), 0, 1)\nExpected:\n    (0.785398167726482..., 9.042725224567119...e-07)\nGot:\n    (0.7853981677264822, 9.042725224536535e-07)\n**********************************************************************\n1 item had failures:\n   2 of  13 in sage.tests.books.sagebook.sol.integration_doctest\n    [12 tests, 2 failures, 2.76 s]\n----------------------------------------------------------------------\n```",
    "created_at": "2018-12-31T22:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326177",
    "user": "https://github.com/vbraun"
}
```

on OSX:

```
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 208, in sage.tests.books.sagebook.float_doctest
Failed example:
    print("exact - classical summation: %.1f" % (s-ii))
Expected:
    exact - classical summation: -45.5
Got:
    exact - classical summation: -45.6
**********************************************************************
1 item had failures:
   1 of 142 in sage.tests.books.sagebook.float_doctest
    [141 tests, 1 failure, 40.89 s]
**********************************************************************
File "src/sage/tests/books/sagebook/graphtheory_doctest.py", line 66, in sage.tests.books.sagebook.graphtheory_doctest
Failed example:
    P.minor(graphs.CompleteBipartiteGraph(3,3))
Expected:
    {0: [1], 1: [8], 2: [4], 3: [6, 7, 9], 4: [2, 3], 5: [0, 5]}
Got:
    {0: [0, 4], 1: [1, 6, 8], 2: [2, 7], 3: [3], 4: [9], 5: [5]}
**********************************************************************
File "src/sage/tests/books/sagebook/graphtheory_doctest.py", line 68, in sage.tests.books.sagebook.graphtheory_doctest
Failed example:
    P.minor(graphs.CompleteGraph(5))
Expected:
    {0: [1, 6], 1: [0, 5], 2: [2, 7], 3: [4, 9], 4: [3, 8]}
Got:
    {0: [5, 8], 1: [1, 6], 2: [2, 3], 3: [7, 9], 4: [0, 4]}
**********************************************************************
1 item had failures:
   2 of 114 in sage.tests.books.sagebook.graphtheory_doctest
    [113 tests, 2 failures, 8.61 s]
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 24, in sage.tests.books.sagebook.integration_doctest
Failed example:
    N(integrate(sin(x^2)/(x^2), x, 1, infinity))
Expected:
    0.285736646322853 - 6.93889390390723e-18*I
Got:
    0.285736646322853 + 6.93889390390723e-18*I
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 45, in sage.tests.books.sagebook.integration_doctest
Failed example:
    N(integrate(exp(-x^2)*log(x), x, 17, 42))
Expected:
    2.5657285006962035e-127
Got:
    2.565728500696221e-127
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 57, in sage.tests.books.sagebook.integration_doctest
Failed example:
    numerical_integral(exp(-x^2)*log(x), 17, 42)
Expected:
    (2.5657285006962035e-127, 3.3540254049238093e-128)
Got:
    (2.565728500696221e-127, 3.3540254049023843e-128)
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 64, in sage.tests.books.sagebook.integration_doctest
Failed example:
    numerical_integral(exp(-x^100), 0, 1.1, algorithm='qng')
Expected:
    (0.994327538576531..., 0.016840666914688864)
Got:
    (0.9943275385765319, 0.016840666914705607)
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 74, in sage.tests.books.sagebook.integration_doctest
Failed example:
    N(integrate(exp(-x^2)*log(x), x, 17, 42), digits=60)
Expected:
    2.5657285006962035e-127
Got:
    2.565728500696221e-127
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 95, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=17, 20, exp(-x^2)*log(x))')
Expected:
    2.5657285005610514829173563961304785900 E-127
Got:
    2.565728500561051482917356396 E-127
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 100, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=0, 1, sin(sin(x)))')
Expected:
    0.43060610312069060491237735524846578643
Got:
    0.4306061031206906049123773553
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 109, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=0, 1, x^(-99/100))') # abs tol 2e-16
Expected:
    73.62914262423378365
Got:
    67.28157752276430690714796980
Tolerance exceeded:
    73.62914262423378365 vs 67.28157752276430690714796980, tolerance 6e+00 > 2e-16
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 114, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=[0, -99/100], 1, x^(-99/100))')
Expected:
    100.00000000000000000000000000000000000
Got:
    100.0000000000000000000000000
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 119, in sage.tests.books.sagebook.integration_doctest
Failed example:
    gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 2e-16
Expected:
    74.47274932028288503
Got:
    68.16118711180150288540450897
Tolerance exceeded:
    74.47274932028288503 vs 68.16118711180150288540450897, tolerance 6e+00 > 2e-16
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 178, in sage.tests.books.sagebook.integration_doctest
Failed example:
    f(0.0), f(0.5), f(1.0)
Expected:
    (0.0, 0.8414895067661431, 1.6318696084180513)
Got:
    (0.0, 0.8414895067661431, 1.6318696084180517)
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 183, in sage.tests.books.sagebook.integration_doctest
Failed example:
    numerical_integral(f, 0, 1)
Expected:
    (0.8606791942204567, 6.301207560882073e-07)
Got:
    (0.8606791942204566, 6.301207561280224e-07)
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 190, in sage.tests.books.sagebook.integration_doctest
Failed example:
    numerical_integral(f, 0, 1)
Expected:
    (0.860679194220456..., 6.301207560882096e-07)
Got:
    (0.8606791942204566, 6.301207560974723e-07)
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 197, in sage.tests.books.sagebook.integration_doctest
Failed example:
    numerical_integral(f, 0, 1)
Expected:
    (0.8606791942204567, 6.301207561187562e-07)
Got:
    (0.8606791942204565, 6.301207561295888e-07)
**********************************************************************
File "src/sage/tests/books/sagebook/integration_doctest.py", line 213, in sage.tests.books.sagebook.integration_doctest
Failed example:
    evalI(100)
Expected:
    (0.8606792028826138, 5.553962923506737e-07)
Got:
    (0.8606792028826138, 5.553962919606637e-07)
**********************************************************************
1 item had failures:
  15 of  87 in sage.tests.books.sagebook.integration_doctest
    [86 tests, 15 failures, 23.56 s]
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 129, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    R1.solve_right(c)
Expected:
    (-1.499999999999999, -0.49999999999999867, 2.749999999999997)
Got:
    (-1.4999999999999967, -0.49999999999999745, 2.749999999999994)
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 135, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    Z.norm(Infinity)*(Z^-1).norm(Infinity) # abs tol 1e-11
Expected:
    1992.3750000000168
Got:
    1992.3750000000014
Tolerance exceeded:
    1992.3750000000168 vs 1992.3750000000014, tolerance 2e-11 > 1e-11
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 150, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    x = V*lamb; x
Expected:
    (0.2370370370370367, 0.4518518518518521, 0.3703703703703702)
Got:
    (-5341941225574732.0, -2670970612787367.0, 6677426531968419.0)
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 155, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    m = 3; [ Sig[i,i] for i in range(0,m) ]
Expected:
    [8.309316833256451, 1.3983038884881154, 0.0]
Got:
    [8.309316833256451, 1.3983038884881158, 1.1474751322044736e-16]
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 180, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    Q
Expected:
    [ 0.7612151656410958  0.6484993998439783]
    [-0.6484993998439782  0.7612151656410955]
Got:
    [ 0.7612151656410957   0.648499399843978]
    [-0.6484993998439779  0.7612151656410955]
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 215, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    X
Expected:
    (0.9276845629439007, 0.10329475725387141, -0.3587917847435305)
Got:
    (0.9276845629439006, 0.1032947572538714, -0.3587917847435305)
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 234, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    Aref.eigenvalues()
Expected:
    [585.0305586200212, 92.91426499150643, 0.03226690899408103, 4.022909479477674]
Got:
    [585.0305586200216, 92.91426499150661, 0.03226690899409142, 4.022909479477676]
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 241, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    eigen_vals
Expected:
    [   6.39294791648918                 0.0                 0.0]
    [                0.0   0.560519476111939                 0.0]
    [                0.0                 0.0 -1.9534673926011215]
Got:
    [  6.392947916489186                 0.0                 0.0]
    [                0.0  0.5605194761119401                 0.0]
    [                0.0                 0.0 -1.9534673926011223]
**********************************************************************
File "src/sage/tests/books/sagebook/linsolve_doctest.py", line 272, in sage.tests.books.sagebook.linsolve_doctest
Failed example:
    roots = comp.eigenvalues(); roots
Expected:
    [0.3475215101190289 + 0.5665505533984981*I, 0.3475215101190289 - 0.5665505533984981*I,
     0.34502377696179265 + 0.43990870238588275*I, 0.34502377696179265 - 0.43990870238588275*I,
     -0.5172576143252197 + 0.5129582067889322*I, -0.5172576143252197 - 0.5129582067889322*I,
     -1.3669971645459291, -9.983578180965276]
Got:
    [0.3475215101190277 + 0.5665505533984982*I,
     0.3475215101190277 - 0.5665505533984982*I,
     0.34502377696179476 + 0.4399087023858829*I,
     0.34502377696179476 - 0.4399087023858829*I,
     -0.5172576143252197 + 0.5129582067889321*I,
     -0.5172576143252197 - 0.5129582067889321*I,
     -1.366997164545929,
     -9.983578180965276]
**********************************************************************
1 item had failures:
   9 of 132 in sage.tests.books.sagebook.linsolve_doctest
    [131 tests, 9 failures, 17.02 s]
**********************************************************************
File "src/sage/tests/books/sagebook/mpoly_doctest.py", line 395, in sage.tests.books.sagebook.mpoly_doctest
Failed example:
    ys = CDF['y'](Jy.0).roots(); ys
Expected:
    [(-0.8000000000000002, 1), (0.0, 1), (0.8, 1)]
Got:
    [(-0.8, 1), (0.0, 1), (0.7999999999999997, 1)]
**********************************************************************
File "src/sage/tests/books/sagebook/mpoly_doctest.py", line 397, in sage.tests.books.sagebook.mpoly_doctest
Failed example:
    [CDF['x'](p(y=ys[0][0])).roots() for p in J.gens()]
Expected:
    [[(-0.5999999999999999 - 1.306289919090511e-16*I, 1),
     (0.6000000000000001 + 1.3062899190905113e-16*I, 1)],
     [(0.6000000000000001 - 3.1350958058172247e-16*I, 1),
      (2.600000000000001 + 3.135095805817224e-16*I, 1)]]
Got:
    [[(-0.6 - 1.30628991909051e-16*I, 1), (0.6 + 1.3062899190905103e-16*I, 1)],
     [(0.6 - 3.135095805817224e-16*I, 1),
      (2.6000000000000005 + 3.1350958058172237e-16*I, 1)]]
**********************************************************************
1 item had failures:
   2 of 161 in sage.tests.books.sagebook.mpoly_doctest
    [160 tests, 2 failures, 8.27 s]
**********************************************************************
File "src/sage/tests/books/sagebook/polynomes_doctest.py", line 76, in sage.tests.books.sagebook.polynomes_doctest
Failed example:
    p.change_ring(RDF).factor()
Expected:
    (x - 15.810249675906654) * (x - 0.18975032409334563)
Got:
    (x - 15.810249675906654) * (x - 0.1897503240933456)
**********************************************************************
1 item had failures:
   1 of 111 in sage.tests.books.sagebook.polynomes_doctest
    [110 tests, 1 failure, 2.48 s]
**********************************************************************
File "src/sage/tests/books/sagebook/sol/integration_doctest.py", line 39, in sage.tests.books.sagebook.sol.integration_doctest
Failed example:
    N(QuadNC(lambda x: x * log(1+x), 0, 1, 19)) # abs tol 2e-15
Expected:
    0.250000000000001
Got:
    0.249999999999996
Tolerance exceeded:
    0.250000000000001 vs 0.249999999999996, tolerance 5e-15 > 2e-15
**********************************************************************
File "src/sage/tests/books/sagebook/sol/integration_doctest.py", line 41, in sage.tests.books.sagebook.sol.integration_doctest
Failed example:
    numerical_integral(sqrt(1-x^2), 0, 1)
Expected:
    (0.785398167726482..., 9.042725224567119...e-07)
Got:
    (0.7853981677264822, 9.042725224536535e-07)
**********************************************************************
1 item had failures:
   2 of  13 in sage.tests.books.sagebook.sol.integration_doctest
    [12 tests, 2 failures, 2.76 s]
----------------------------------------------------------------------
```



---

archive/issue_comments_326178.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-12-31T22:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326178",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_326179.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-01T18:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326180.json:
```json
{
    "body": "I did what I could (blindly) for the numerical noise on osX. We need an OsX reviewer to finish the job..",
    "created_at": "2019-01-01T18:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326180",
    "user": "https://github.com/fchapoton"
}
```

I did what I could (blindly) for the numerical noise on osX. We need an OsX reviewer to finish the job..



---

archive/issue_comments_326181.json:
```json
{
    "body": "Thank you.  What a pain in the ass.  If we had #26784 or another way to skip some tests on a specific platform I would just mark the entire directory to be skipped on OSX.  It's really beside the point of these tests that they give the exact same results on all imaginable platforms supported by Sage.",
    "created_at": "2019-01-03T19:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326181",
    "user": "https://github.com/embray"
}
```

Thank you.  What a pain in the ass.  If we had #26784 or another way to skip some tests on a specific platform I would just mark the entire directory to be skipped on OSX.  It's really beside the point of these tests that they give the exact same results on all imaginable platforms supported by Sage.



---

archive/issue_comments_326182.json:
```json
{
    "body": "I think for the rest of these it would suffice to just mark `# known fail` for now and move on.  It's not critical.  I don't think these tests were ever run on OSX before.",
    "created_at": "2019-01-03T19:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326182",
    "user": "https://github.com/embray"
}
```

I think for the rest of these it would suffice to just mark `# known fail` for now and move on.  It's not critical.  I don't think these tests were ever run on OSX before.



---

archive/issue_comments_326183.json:
```json
{
    "body": "I have no OsX computer available to see what remains to be fixed or tagged.",
    "created_at": "2019-01-10T12:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326183",
    "user": "https://github.com/fchapoton"
}
```

I have no OsX computer available to see what remains to be fixed or tagged.



---

archive/issue_events_060398.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60398"
}
```



---

archive/issue_events_060399.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60399"
}
```



---

archive/issue_comments_326184.json:
```json
{
    "body": "Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326184",
    "user": "https://github.com/embray"
}
```

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_326185.json:
```json
{
    "body": "Here is what i get with an OSX computer:\n\n```\nMacBook-de-admin:sage admin$ ./sage -t --long src/sage/tests/books/sagebook\nThis looks like the first time you are running Sage.\nCleaning up, do not interrupt this.\nDone cleaning.\nno stored timings available\nRunning doctests with ID 2019-01-17-09-16-48-9bc3bf58.\nGit branch: t/23572/public/french_book_python3\nUsing --optional=dochtml,gfortran,mpir,python2,sage\nDoctesting 32 files.\nsage -t --long src/sage/tests/books/sagebook/calculus_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/calculus_doctest.py\", line 210, in sage.tests.books.sagebook.calculus_doctest\nFailed example:\n    solve([x^2 * y * z == 18, x * y^3 * z == 24,x * y * z^4 == 6], x, y, z)\nExpected:\n    [[x == 3, y == 2, z == 1],\n     [x == (1.337215067329613 - 2.685489874065195*I),\n      y == (-1.700434271459228 + 1.052864325754712*I),\n      z == (0.9324722294043555 - 0.3612416661871523*I)], ...]\nGot:\n    [[x == 3, y == 2, z == 1], [x == (1.337215067329607 - 2.6854898740652*I), y == (-1.700434271459228 + 1.052864325754712*I), z == (0.9324722294043555 - 0.3612416661871516*I)], [x == (1.337215067329607 + 2.685489874065201*I), y == (-1.700434271459228 - 1.052864325754712*I), z == (0.9324722294043555 + 0.3612416661871516*I)], [x == (-2.550651407188843 - 1.57929648863207*I), y == (-0.5473259801441658 + 1.923651286345638*I), z == (-0.9829730996839017 - 0.1837495178165701*I)], [x == (-2.550651407188842 + 1.57929648863207*I), y == (-0.5473259801441658 - 1.923651286345638*I), z == (-0.9829730996839017 + 0.1837495178165701*I)], [x == (0.2768050783899186 - 2.987202528885068*I), y == (1.478017834441328 - 1.347391287293138*I), z == (-0.8502171357296142 - 0.5264321628773558*I)], [x == (0.276805078389906 + 2.987202528885103*I), y == (1.478017834441318 + 1.347391287293114*I), z == (-0.8502171357296142 + 0.5264321628773558*I)], [x == (-0.8209889702162457 + 2.885476929518458*I), y == (-1.205269272758512 - 1.59603445456048*I), z == (0.09226835946330207 - 0.9957341762950345*I)], [x == (-0.8209889702162482 - 2.885476929518459*I), y == (-1.205269272758513 + 1.596034454560479*I), z == (0.09226835946330207 + 0.9957341762950345*I)], [x == (-1.807903909137758 - 2.394051681840712*I), y == (0.8914767115530775 - 1.790326582710134*I), z == (0.7390089172206591 - 0.6736956436465571*I)], [x == (-1.80790390913777 + 2.394051681840719*I), y == (0.8914767115530766 + 1.790326582710125*I), z == (0.7390089172206591 + 0.6736956436465571*I)], [x == (2.217026751661979 + 2.021086930939673*I), y == (1.864944458808712 + 0.722483332374306*I), z == (-0.2736629900720828 - 0.9618256431728189*I)], [x == (2.217026751662001 - 2.021086930939692*I), y == (1.864944458808693 - 0.7224833323742994*I), z == (-0.2736629900720828 + 0.9618256431728189*I)], [x == (2.797416688213066 - 1.083724998561461*I), y == (-1.965946199367804 + 0.3674990356331406*I), z == (-0.6026346363792563 - 0.7980172272802396*I)], [x == (2.797416688213067 + 1.083724998561461*I), y == (-1.965946199367804 - 0.3674990356331406*I), z == (-0.6026346363792563 + 0.7980172272802396*I)], [x == (-2.948919299051704 + 0.5512485534497115*I), y == (0.184536718926604 + 1.991468352590069*I), z == (0.4457383557765383 - 0.8951632913550623*I)], [x == (-2.948919299051704 - 0.5512485534497119*I), y == (0.1845367189266038 - 1.991468352590069*I), z == (0.4457383557765383 + 0.8951632913550623*I)]]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/calculus_doctest.py\", line 225, in sage.tests.books.sagebook.calculus_doctest\nFailed example:\n    find_root(expr, 0.1, pi)\nExpected:\n    2.0943951023931957\nGot:\n    2.0943951023931953\n**********************************************************************\n1 item had failures:\n   2 of 146 in sage.tests.books.sagebook.calculus_doctest\n    [145 tests, 2 failures, 7.85 s]\n...\n----------------------------------------------------------------------\nsage -t --long src/sage/tests/books/sagebook/calculus_doctest.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 383.2 seconds\n    cpu time: 346.3 seconds\n    cumulative wall time: 381.1 seconds\n```",
    "created_at": "2019-01-17T12:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326185",
    "user": "https://github.com/vinklein"
}
```

Here is what i get with an OSX computer:

```
MacBook-de-admin:sage admin$ ./sage -t --long src/sage/tests/books/sagebook
This looks like the first time you are running Sage.
Cleaning up, do not interrupt this.
Done cleaning.
no stored timings available
Running doctests with ID 2019-01-17-09-16-48-9bc3bf58.
Git branch: t/23572/public/french_book_python3
Using --optional=dochtml,gfortran,mpir,python2,sage
Doctesting 32 files.
sage -t --long src/sage/tests/books/sagebook/calculus_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/calculus_doctest.py", line 210, in sage.tests.books.sagebook.calculus_doctest
Failed example:
    solve([x^2 * y * z == 18, x * y^3 * z == 24,x * y * z^4 == 6], x, y, z)
Expected:
    [[x == 3, y == 2, z == 1],
     [x == (1.337215067329613 - 2.685489874065195*I),
      y == (-1.700434271459228 + 1.052864325754712*I),
      z == (0.9324722294043555 - 0.3612416661871523*I)], ...]
Got:
    [[x == 3, y == 2, z == 1], [x == (1.337215067329607 - 2.6854898740652*I), y == (-1.700434271459228 + 1.052864325754712*I), z == (0.9324722294043555 - 0.3612416661871516*I)], [x == (1.337215067329607 + 2.685489874065201*I), y == (-1.700434271459228 - 1.052864325754712*I), z == (0.9324722294043555 + 0.3612416661871516*I)], [x == (-2.550651407188843 - 1.57929648863207*I), y == (-0.5473259801441658 + 1.923651286345638*I), z == (-0.9829730996839017 - 0.1837495178165701*I)], [x == (-2.550651407188842 + 1.57929648863207*I), y == (-0.5473259801441658 - 1.923651286345638*I), z == (-0.9829730996839017 + 0.1837495178165701*I)], [x == (0.2768050783899186 - 2.987202528885068*I), y == (1.478017834441328 - 1.347391287293138*I), z == (-0.8502171357296142 - 0.5264321628773558*I)], [x == (0.276805078389906 + 2.987202528885103*I), y == (1.478017834441318 + 1.347391287293114*I), z == (-0.8502171357296142 + 0.5264321628773558*I)], [x == (-0.8209889702162457 + 2.885476929518458*I), y == (-1.205269272758512 - 1.59603445456048*I), z == (0.09226835946330207 - 0.9957341762950345*I)], [x == (-0.8209889702162482 - 2.885476929518459*I), y == (-1.205269272758513 + 1.596034454560479*I), z == (0.09226835946330207 + 0.9957341762950345*I)], [x == (-1.807903909137758 - 2.394051681840712*I), y == (0.8914767115530775 - 1.790326582710134*I), z == (0.7390089172206591 - 0.6736956436465571*I)], [x == (-1.80790390913777 + 2.394051681840719*I), y == (0.8914767115530766 + 1.790326582710125*I), z == (0.7390089172206591 + 0.6736956436465571*I)], [x == (2.217026751661979 + 2.021086930939673*I), y == (1.864944458808712 + 0.722483332374306*I), z == (-0.2736629900720828 - 0.9618256431728189*I)], [x == (2.217026751662001 - 2.021086930939692*I), y == (1.864944458808693 - 0.7224833323742994*I), z == (-0.2736629900720828 + 0.9618256431728189*I)], [x == (2.797416688213066 - 1.083724998561461*I), y == (-1.965946199367804 + 0.3674990356331406*I), z == (-0.6026346363792563 - 0.7980172272802396*I)], [x == (2.797416688213067 + 1.083724998561461*I), y == (-1.965946199367804 - 0.3674990356331406*I), z == (-0.6026346363792563 + 0.7980172272802396*I)], [x == (-2.948919299051704 + 0.5512485534497115*I), y == (0.184536718926604 + 1.991468352590069*I), z == (0.4457383557765383 - 0.8951632913550623*I)], [x == (-2.948919299051704 - 0.5512485534497119*I), y == (0.1845367189266038 - 1.991468352590069*I), z == (0.4457383557765383 + 0.8951632913550623*I)]]
**********************************************************************
File "src/sage/tests/books/sagebook/calculus_doctest.py", line 225, in sage.tests.books.sagebook.calculus_doctest
Failed example:
    find_root(expr, 0.1, pi)
Expected:
    2.0943951023931957
Got:
    2.0943951023931953
**********************************************************************
1 item had failures:
   2 of 146 in sage.tests.books.sagebook.calculus_doctest
    [145 tests, 2 failures, 7.85 s]
...
----------------------------------------------------------------------
sage -t --long src/sage/tests/books/sagebook/calculus_doctest.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 383.2 seconds
    cpu time: 346.3 seconds
    cumulative wall time: 381.1 seconds
```



---

archive/issue_comments_326186.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-17T12:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326186",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326187.json:
```json
{
    "body": "Thanks a lot. Could you please double check now with my latest fixes ?",
    "created_at": "2019-01-17T12:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326187",
    "user": "https://github.com/fchapoton"
}
```

Thanks a lot. Could you please double check now with my latest fixes ?



---

archive/issue_comments_326188.json:
```json
{
    "body": "Yes `sage -t --long src/sage/tests/books/sagebook` now pass on OSX. In my humble opinion a green would mean positive review.",
    "created_at": "2019-01-17T12:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326188",
    "user": "https://github.com/vinklein"
}
```

Yes `sage -t --long src/sage/tests/books/sagebook` now pass on OSX. In my humble opinion a green would mean positive review.



---

archive/issue_comments_326189.json:
```json
{
    "body": "Great, thank you Vincent!  Hopefully this time...",
    "created_at": "2019-01-18T12:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326189",
    "user": "https://github.com/embray"
}
```

Great, thank you Vincent!  Hopefully this time...



---

archive/issue_comments_326190.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-01-18T12:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326190",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_326191.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-01-23T23:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326191",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_326192.json:
```json
{
    "body": "```\nsage -t --long src/sage/tests/books/sagebook/float_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 282, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    RIF(0,+infinity)\nExpected:\n    [0.00000000000000000 .. +infinity]\nGot:\n    [0.0000000000000000 .. +infinity]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 339, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    E = RIF(0,1); log(E)\nExpected:\n    [-infinity .. -0.00000000000000000]\nGot:\n    [-infinity .. -0.0000000000000000]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 352, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    1-x^2\nExpected:\n    [0.00000000000000000 .. 1.0000000000000000]\nGot:\n    [0.0000000000000000 .. 1.0000000000000000]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 354, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    1-x*x\nExpected:\n    [0.00000000000000000 .. 2.0000000000000000]\nGot:\n    [0.0000000000000000 .. 2.0000000000000000]\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/float_doctest.py\", line 356, in sage.tests.books.sagebook.float_doctest\nFailed example:\n    (1-x)*(1+x)\nExpected:\n    [0.00000000000000000 .. 4.0000000000000000]\nGot:\n    [0.0000000000000000 .. 4.0000000000000000]\n**********************************************************************\n1 item had failures:\n   5 of 142 in sage.tests.books.sagebook.float_doctest\n    [141 tests, 5 failures, 20.45 s]\n\n\nsage -t --long src/sage/tests/books/sagebook/sol/float_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/sagebook/sol/float_doctest.py\", line 137, in sage.tests.books.sagebook.sol.float_doctest\nFailed example:\n    f(I)\nExpected:\n    [0.00000000000000000 .. 1.0000000000000000]\nGot:\n    [0.0000000000000000 .. 1.0000000000000000]\n**********************************************************************\n1 item had failures:\n   1 of  49 in sage.tests.books.sagebook.sol.float_doctest\n    [48 tests, 1 failure, 1.79 s]\n\n```",
    "created_at": "2019-01-23T23:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326192",
    "user": "https://github.com/vbraun"
}
```

```
sage -t --long src/sage/tests/books/sagebook/float_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 282, in sage.tests.books.sagebook.float_doctest
Failed example:
    RIF(0,+infinity)
Expected:
    [0.00000000000000000 .. +infinity]
Got:
    [0.0000000000000000 .. +infinity]
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 339, in sage.tests.books.sagebook.float_doctest
Failed example:
    E = RIF(0,1); log(E)
Expected:
    [-infinity .. -0.00000000000000000]
Got:
    [-infinity .. -0.0000000000000000]
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 352, in sage.tests.books.sagebook.float_doctest
Failed example:
    1-x^2
Expected:
    [0.00000000000000000 .. 1.0000000000000000]
Got:
    [0.0000000000000000 .. 1.0000000000000000]
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 354, in sage.tests.books.sagebook.float_doctest
Failed example:
    1-x*x
Expected:
    [0.00000000000000000 .. 2.0000000000000000]
Got:
    [0.0000000000000000 .. 2.0000000000000000]
**********************************************************************
File "src/sage/tests/books/sagebook/float_doctest.py", line 356, in sage.tests.books.sagebook.float_doctest
Failed example:
    (1-x)*(1+x)
Expected:
    [0.00000000000000000 .. 4.0000000000000000]
Got:
    [0.0000000000000000 .. 4.0000000000000000]
**********************************************************************
1 item had failures:
   5 of 142 in sage.tests.books.sagebook.float_doctest
    [141 tests, 5 failures, 20.45 s]


sage -t --long src/sage/tests/books/sagebook/sol/float_doctest.py
**********************************************************************
File "src/sage/tests/books/sagebook/sol/float_doctest.py", line 137, in sage.tests.books.sagebook.sol.float_doctest
Failed example:
    f(I)
Expected:
    [0.00000000000000000 .. 1.0000000000000000]
Got:
    [0.0000000000000000 .. 1.0000000000000000]
**********************************************************************
1 item had failures:
   1 of  49 in sage.tests.books.sagebook.sol.float_doctest
    [48 tests, 1 failure, 1.79 s]

```



---

archive/issue_comments_326193.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-24T08:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326194.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-24T08:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326194",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_326195.json:
```json
{
    "body": "oh, boy.. Ce ticket commence a me porter sur les nerfs.\n\nVincent, tu veux bien v\u00e9rifier que tous les tests du livre passent sur OsX, s'il te plait ?",
    "created_at": "2019-01-24T08:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326195",
    "user": "https://github.com/fchapoton"
}
```

oh, boy.. Ce ticket commence a me porter sur les nerfs.

Vincent, tu veux bien vérifier que tous les tests du livre passent sur OsX, s'il te plait ?



---

archive/issue_comments_326196.json:
```json
{
    "body": "H\u00e9las, \u00e7\u00e0 va prendre un peu de temps. Je n'ai pas dans l'imm\u00e9diat de mac install\u00e9 avec un sage sous la main.",
    "created_at": "2019-01-24T08:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326196",
    "user": "https://github.com/vinklein"
}
```

Hélas, çà va prendre un peu de temps. Je n'ai pas dans l'immédiat de mac installé avec un sage sous la main.



---

archive/issue_comments_326197.json:
```json
{
    "body": "`@`jhpalmieri \n\nJohn, would you by chance be able to run the doctests of the modified files on OsX ? If so, please do.",
    "created_at": "2019-01-24T13:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326197",
    "user": "https://github.com/fchapoton"
}
```

`@`jhpalmieri 

John, would you by chance be able to run the doctests of the modified files on OsX ? If so, please do.



---

archive/issue_comments_326198.json:
```json
{
    "body": "For the last commit, I personally think it would have been better to just replace `0.00000000000000000` by `0.0000000000000000` (as done in #26156). Using `...` implies that the test is somehow not deterministic, while it is.",
    "created_at": "2019-01-24T13:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326198",
    "user": "https://github.com/jdemeyer"
}
```

For the last commit, I personally think it would have been better to just replace `0.00000000000000000` by `0.0000000000000000` (as done in #26156). Using `...` implies that the test is somehow not deterministic, while it is.



---

archive/issue_comments_326199.json:
```json
{
    "body": "Just to clear things up: the failure from [comment:124] has nothing to do with OS X (I wonder why you think that).",
    "created_at": "2019-01-24T13:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326199",
    "user": "https://github.com/jdemeyer"
}
```

Just to clear things up: the failure from [comment:124] has nothing to do with OS X (I wonder why you think that).



---

archive/issue_comments_326200.json:
```json
{
    "body": "ok, right. No time to change my last commit right now",
    "created_at": "2019-01-24T13:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326200",
    "user": "https://github.com/fchapoton"
}
```

ok, right. No time to change my last commit right now



---

archive/issue_comments_326201.json:
```json
{
    "body": "Since it's a tiny change and it's my \"fault\", I'll fix it.",
    "created_at": "2019-01-24T14:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326201",
    "user": "https://github.com/jdemeyer"
}
```

Since it's a tiny change and it's my "fault", I'll fix it.



---

archive/issue_comments_326202.json:
```json
{
    "body": "Another question while I'm looking at the code: what's the meaning of `sol` in the directory name `src/sage/tests/books/sagebook/sol`? The way I understand it, that's the directory for the tests of the (old) french book, but I don't understand the name `sol`.",
    "created_at": "2019-01-24T15:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326202",
    "user": "https://github.com/jdemeyer"
}
```

Another question while I'm looking at the code: what's the meaning of `sol` in the directory name `src/sage/tests/books/sagebook/sol`? The way I understand it, that's the directory for the tests of the (old) french book, but I don't understand the name `sol`.



---

archive/issue_comments_326203.json:
```json
{
    "body": "Also the name `sagebook` is not very descriptive.",
    "created_at": "2019-01-24T15:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326203",
    "user": "https://github.com/jdemeyer"
}
```

Also the name `sagebook` is not very descriptive.



---

archive/issue_comments_326204.json:
```json
{
    "body": "**sol**utions of exercises ?",
    "created_at": "2019-01-24T15:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326204",
    "user": "https://github.com/fchapoton"
}
```

**sol**utions of exercises ?



---

archive/issue_comments_326205.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-24T15:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326206.json:
```json
{
    "body": "`@`chapoton It looks like you are right the examples under `sol` modules comes from \"Annex A. Solutions des exercises\" chapter of the French version. \\\\\nThis chapter is named  \"ANNEX A. ANSWERS TO EXERCISES\" in the English book. I let you decide if `ans` or `answers` or another thing would be a better module name.",
    "created_at": "2019-01-24T15:20:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326206",
    "user": "https://github.com/vinklein"
}
```

`@`chapoton It looks like you are right the examples under `sol` modules comes from "Annex A. Solutions des exercises" chapter of the French version. \\
This chapter is named  "ANNEX A. ANSWERS TO EXERCISES" in the English book. I let you decide if `ans` or `answers` or another thing would be a better module name.



---

archive/issue_comments_326207.json:
```json
{
    "body": "I confirm \"sol\" means \"solutions of exercises\". This part was also updated for the english version.",
    "created_at": "2019-01-24T15:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326207",
    "user": "https://github.com/zimmermann6"
}
```

I confirm "sol" means "solutions of exercises". This part was also updated for the english version.



---

archive/issue_comments_326208.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-24T15:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326209.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-24T15:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326209",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326210.json:
```json
{
    "body": "Sorry for this picky remark but `computational_mathematics_with_sagemath` would be a far more standard compliant name (`_` instead of `-`).",
    "created_at": "2019-01-24T15:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326210",
    "user": "https://github.com/vinklein"
}
```

Sorry for this picky remark but `computational_mathematics_with_sagemath` would be a far more standard compliant name (`_` instead of `-`).



---

archive/issue_comments_326211.json:
```json
{
    "body": "I get one doctest failure:\n\n```\nsage -t --warn-long 53.8 src/sage/tests/py3_syntax.py\n**********************************************************************\nFile \"src/sage/tests/py3_syntax.py\", line 80, in sage.tests.py3_syntax.SortedDirectoryWalkerABC.__iter__\nFailed example:\n    next(iter(test))\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.py3_syntax.SortedDirectoryWalkerABC.__iter__[2]>\", line 1, in <module>\n        next(iter(test))\n    StopIteration\n**********************************************************************\n1 item had failures:\n   1 of   4 in sage.tests.py3_syntax.SortedDirectoryWalkerABC.__iter__\n    [27 tests, 1 failure, 0.05 s]\n----------------------------------------------------------------------\nsage -t --warn-long 53.8 src/sage/tests/py3_syntax.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.1 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.1 seconds\n```",
    "created_at": "2019-01-24T18:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326211",
    "user": "https://github.com/jhpalmieri"
}
```

I get one doctest failure:

```
sage -t --warn-long 53.8 src/sage/tests/py3_syntax.py
**********************************************************************
File "src/sage/tests/py3_syntax.py", line 80, in sage.tests.py3_syntax.SortedDirectoryWalkerABC.__iter__
Failed example:
    next(iter(test))
Exception raised:
    Traceback (most recent call last):
      File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/jpalmier/Desktop/Sage/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.py3_syntax.SortedDirectoryWalkerABC.__iter__[2]>", line 1, in <module>
        next(iter(test))
    StopIteration
**********************************************************************
1 item had failures:
   1 of   4 in sage.tests.py3_syntax.SortedDirectoryWalkerABC.__iter__
    [27 tests, 1 failure, 0.05 s]
----------------------------------------------------------------------
sage -t --warn-long 53.8 src/sage/tests/py3_syntax.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 0.1 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.1 seconds
```



---

archive/issue_comments_326212.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-24T19:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326213.json:
```json
{
    "body": "my last fix is not correct yet",
    "created_at": "2019-01-25T07:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326213",
    "user": "https://github.com/fchapoton"
}
```

my last fix is not correct yet



---

archive/issue_comments_326214.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-25T08:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326215.json:
```json
{
    "body": "and now a bunch of ubuntu ppc failing doctests, just for the fun of it... :-(",
    "created_at": "2019-01-25T11:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326215",
    "user": "https://github.com/fchapoton"
}
```

and now a bunch of ubuntu ppc failing doctests, just for the fun of it... :-(



---

archive/issue_comments_326216.json:
```json
{
    "body": "Replying to [comment:146 chapoton]:\n> and now a bunch of ubuntu ppc failing doctests, just for the fun of it... :-(\n\n\nMost of those are numerical noise, not so bad.",
    "created_at": "2019-01-25T11:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326216",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:146 chapoton]:
> and now a bunch of ubuntu ppc failing doctests, just for the fun of it... :-(


Most of those are numerical noise, not so bad.



---

archive/issue_comments_326217.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-27T13:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326218.json:
```json
{
    "body": "There is one suspect doctest that I have not fixed.. Namely\n\n```\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py\", line 150, in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest\nFailed example:\n    x = V*lamb; x\nExpected:\n    (0.2370370370370367, 0.4518518518518521, 0.3703703703703702)\nGot:\n    (-2.083296832557597e+16, -1.0416484162787986e+16, 2.6041210406969964e+16)\n```",
    "created_at": "2019-01-27T13:47:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326218",
    "user": "https://github.com/fchapoton"
}
```

There is one suspect doctest that I have not fixed.. Namely

```
File "src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py", line 150, in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest
Failed example:
    x = V*lamb; x
Expected:
    (0.2370370370370367, 0.4518518518518521, 0.3703703703703702)
Got:
    (-2.083296832557597e+16, -1.0416484162787986e+16, 2.6041210406969964e+16)
```



---

archive/issue_comments_326219.json:
```json
{
    "body": "may I just tag this bad one with # known bug ?",
    "created_at": "2019-01-28T13:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326219",
    "user": "https://github.com/fchapoton"
}
```

may I just tag this bad one with # known bug ?



---

archive/issue_comments_326220.json:
```json
{
    "body": "Replying to [comment:150 chapoton]:\n> may I just tag this bad one with # known bug ?\n\n\nI cracked open my actual copy of the book to better understand the context to this example (being that I'm stupid it was not immediately obvious to me).  The purpose of the example is to demonstrate using single value decomposition to find an approximate solution to overdetermined system of equations.  I don't know exactly how SVD is implemented but the docs say that U and V are not guaranteed to be unique, and indeed the problem does not have an exact solution.\n\nSo for this test I would just mark it `# random` (I don't think it's a bug, it's just not guaranteed deterministic between systems).",
    "created_at": "2019-01-28T15:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326220",
    "user": "https://github.com/embray"
}
```

Replying to [comment:150 chapoton]:
> may I just tag this bad one with # known bug ?


I cracked open my actual copy of the book to better understand the context to this example (being that I'm stupid it was not immediately obvious to me).  The purpose of the example is to demonstrate using single value decomposition to find an approximate solution to overdetermined system of equations.  I don't know exactly how SVD is implemented but the docs say that U and V are not guaranteed to be unique, and indeed the problem does not have an exact solution.

So for this test I would just mark it `# random` (I don't think it's a bug, it's just not guaranteed deterministic between systems).



---

archive/issue_comments_326221.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-28T16:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326222.json:
```json
{
    "body": "can we now try to send it again to the buildbots, please ?",
    "created_at": "2019-01-29T17:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326222",
    "user": "https://github.com/fchapoton"
}
```

can we now try to send it again to the buildbots, please ?



---

archive/issue_comments_326223.json:
```json
{
    "body": "Sure, but I would like to see better commit messages.",
    "created_at": "2019-01-29T17:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326223",
    "user": "https://github.com/embray"
}
```

Sure, but I would like to see better commit messages.



---

archive/issue_comments_326224.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-29T17:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326225.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-29T17:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326225",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_326226.json:
```json
{
    "body": "```\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py\", line 208, in sage.tests.books.computational-mathematics-with-sagemath.float_doctest\nFailed example:\n    print(\"exact - classical summation: %.1f\" % (s-ii))\nExpected:\n    exact - classical summation: -45.5\nGot:\n    exact - classical summation: -45.6\n**********************************************************************\n1 item had failures:\n   1 of 142 in sage.tests.books.computational-mathematics-with-sagemath.float_doctest\n    [141 tests, 1 failure, 50.05 s]\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/integration_doctest.py\", line 109, in sage.tests.books.computational-mathematics-with-sagemath.integration_doctest\nFailed example:\n    gp('intnum(x=0, 1, x^(-99/100))') # abs tol 2e-16\nExpected:\n    73.62914262423378365\nGot:\n    67.28157752276430690714796980\nTolerance exceeded:\n    73.62914262423378365 vs 67.28157752276430690714796980, tolerance 7e0 > 2e-16\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/integration_doctest.py\", line 119, in sage.tests.books.computational-mathematics-with-sagemath.integration_doctest\nFailed example:\n    gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 2e-16\nExpected:\n    74.47274932028288503\nGot:\n    68.16118711180150288540450897\nTolerance exceeded:\n    74.47274932028288503 vs 68.16118711180150288540450897, tolerance 7e0 > 2e-16\n**********************************************************************\n1 item had failures:\n   2 of  87 in sage.tests.books.computational-mathematics-with-sagemath.integration_doctest\n    [86 tests, 2 failures, 28.58 s]\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py\", line 135, in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest\nFailed example:\n    Z.norm(Infinity)*(Z^-1).norm(Infinity) # abs tol 1e-11\nExpected:\n    1992.3750000000168\nGot:\n    1992.3750000000014\nTolerance exceeded:\n    1992.3750000000168 vs 1992.3750000000014, tolerance 2e-11 > 1e-11\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py\", line 180, in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest\nFailed example:\n    Q\nExpected:\n    [ 0.7612151656410958  0.6484993998439783]\n    [-0.6484993998439782  0.7612151656410955]\nGot:\n    [ 0.7612151656410957   0.648499399843978]\n    [-0.6484993998439779  0.7612151656410955]\n**********************************************************************\n1 item had failures:\n   2 of 132 in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest\n    [131 tests, 2 failures, 21.59 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py  # 1 doctest failed\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/integration_doctest.py  # 2 doctests failed\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-01-31T08:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326226",
    "user": "https://github.com/vbraun"
}
```

```
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py", line 208, in sage.tests.books.computational-mathematics-with-sagemath.float_doctest
Failed example:
    print("exact - classical summation: %.1f" % (s-ii))
Expected:
    exact - classical summation: -45.5
Got:
    exact - classical summation: -45.6
**********************************************************************
1 item had failures:
   1 of 142 in sage.tests.books.computational-mathematics-with-sagemath.float_doctest
    [141 tests, 1 failure, 50.05 s]
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/integration_doctest.py", line 109, in sage.tests.books.computational-mathematics-with-sagemath.integration_doctest
Failed example:
    gp('intnum(x=0, 1, x^(-99/100))') # abs tol 2e-16
Expected:
    73.62914262423378365
Got:
    67.28157752276430690714796980
Tolerance exceeded:
    73.62914262423378365 vs 67.28157752276430690714796980, tolerance 7e0 > 2e-16
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/integration_doctest.py", line 119, in sage.tests.books.computational-mathematics-with-sagemath.integration_doctest
Failed example:
    gp('intnum(x=[0, -1/42], 1, x^(-99/100))') # abs tol 2e-16
Expected:
    74.47274932028288503
Got:
    68.16118711180150288540450897
Tolerance exceeded:
    74.47274932028288503 vs 68.16118711180150288540450897, tolerance 7e0 > 2e-16
**********************************************************************
1 item had failures:
   2 of  87 in sage.tests.books.computational-mathematics-with-sagemath.integration_doctest
    [86 tests, 2 failures, 28.58 s]
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py", line 135, in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest
Failed example:
    Z.norm(Infinity)*(Z^-1).norm(Infinity) # abs tol 1e-11
Expected:
    1992.3750000000168
Got:
    1992.3750000000014
Tolerance exceeded:
    1992.3750000000168 vs 1992.3750000000014, tolerance 2e-11 > 1e-11
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py", line 180, in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest
Failed example:
    Q
Expected:
    [ 0.7612151656410958  0.6484993998439783]
    [-0.6484993998439782  0.7612151656410955]
Got:
    [ 0.7612151656410957   0.648499399843978]
    [-0.6484993998439779  0.7612151656410955]
**********************************************************************
1 item had failures:
   2 of 132 in sage.tests.books.computational-mathematics-with-sagemath.linsolve_doctest
    [131 tests, 2 failures, 21.59 s]
----------------------------------------------------------------------
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/float_doctest.py  # 1 doctest failed
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/integration_doctest.py  # 2 doctests failed
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/linsolve_doctest.py  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_326227.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-01-31T08:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326227",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_326228.json:
```json
{
    "body": "What platform??\n\nAlso, could you please make it a priority to merge this ticket?  Or else it will never get done.  As far as I know everyone who's worked on it has been able to get all the tests the pass just fine.",
    "created_at": "2019-01-31T11:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326228",
    "user": "https://github.com/embray"
}
```

What platform??

Also, could you please make it a priority to merge this ticket?  Or else it will never get done.  As far as I know everyone who's worked on it has been able to get all the tests the pass just fine.



---

archive/issue_comments_326229.json:
```json
{
    "body": "In other words, this suite of tests touches so many parts of the Sage code that it's unfair to merge this ticket along with a bunch of others, and then say this one \"failed\" because something was changed in one of those other tickets that caused some of these tests to fail.  If anything it's those tickets that should be marked as \"needs_work\" or they should add this ticket as a dependency.  \n\nOtherwise it is impossible for us to guess which other tickets you're going to integrate in with it, and thus impossible to predict how some example results will change.",
    "created_at": "2019-01-31T11:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326229",
    "user": "https://github.com/embray"
}
```

In other words, this suite of tests touches so many parts of the Sage code that it's unfair to merge this ticket along with a bunch of others, and then say this one "failed" because something was changed in one of those other tickets that caused some of these tests to fail.  If anything it's those tickets that should be marked as "needs_work" or they should add this ticket as a dependency.  

Otherwise it is impossible for us to guess which other tickets you're going to integrate in with it, and thus impossible to predict how some example results will change.



---

archive/issue_comments_326230.json:
```json
{
    "body": "Thats on 32-bit. It all seems to be numerical precision issues, just add the relevant #tol and we can try again.",
    "created_at": "2019-01-31T11:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326230",
    "user": "https://github.com/vbraun"
}
```

Thats on 32-bit. It all seems to be numerical precision issues, just add the relevant #tol and we can try again.



---

archive/issue_comments_326231.json:
```json
{
    "body": "Okay, thanks.  I don't think a lot of people are testing on 32-bit then.\n\nI wonder if we could just mark those tests `# 64-bit` actually.  I honestly don't care if they are tested on 32-bit.",
    "created_at": "2019-01-31T12:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326231",
    "user": "https://github.com/embray"
}
```

Okay, thanks.  I don't think a lot of people are testing on 32-bit then.

I wonder if we could just mark those tests `# 64-bit` actually.  I honestly don't care if they are tested on 32-bit.



---

archive/issue_comments_326232.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-31T15:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326232",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326233.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-31T15:40:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326233",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326234.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-31T15:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326235.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-31T19:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326235",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326236.json:
```json
{
    "body": "On my laptop, I get\n\n```\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/graphique_doctest.py\", line 112, in sage.tests.books.computational-mathematics-with-sagemath.graphique_doctest\nFailed example:\n    for i in srange(-2, 2, 0.2):\n        g += line(desolve_rk4(DE, y(x), ics=[1, i],\\\n                          step=0.05, end_points=[0,2]))\n        g += line(desolve_rk4(DE, y(x), ics=[-1, i],\\\n                          step=0.05, end_points=[-2,0]))\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.books.computational-mathematics-with-sagemath.graphique_doctest[50]>\", line 3, in <module>\n        step=RealNumber('0.05'), end_points=[Integer(0),Integer(2)]))\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/calculus/desolvers.py\", line 1378, in desolve_rk4\n        sol_2=maxima(cmd).sage()\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 1074, in sage\n        return self._sage_(*args, **kwds)\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py\", line 1238, in _sage_\n        maxima=self.parent())\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 2163, in symbolic_expression_from_maxima_string\n        raise TypeError(\"unable to make sense of Maxima expression '%s' in Sage\"%s)\n    TypeError: unable to make sense of Maxima expression '(kill(sage4)$o44)[[1.0,-2.0],[1.05,-2.149874965475482],[1.1,-2.298999939830521],[1.15,-2.446624921487998],[1.2,-2.591999909207452],[1.25,-2.7343749020044],[1.3,-2.872999899091065],[1.35,-3.007124899832311],[1.4,-3.135999903712506],[1.45,-3.258874910310362],[1.5,-3.374999919279643],[1.55,-3.483624930334245],[1.6,-3.58399994323656],[1.65,-3.675374957788335],[1.7,-3.756999973823437],[1.75,-3.828124991202094],[1.8,-3.888000009806273],[1.85,-3.935875029535953],[1.9,-3.971000050306113],[1.95,-3.992625072044261],[2.0,-4.000000094688424]]' in Sage\n```",
    "created_at": "2019-01-31T21:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326236",
    "user": "https://github.com/jdemeyer"
}
```

On my laptop, I get

```
File "src/sage/tests/books/computational-mathematics-with-sagemath/graphique_doctest.py", line 112, in sage.tests.books.computational-mathematics-with-sagemath.graphique_doctest
Failed example:
    for i in srange(-2, 2, 0.2):
        g += line(desolve_rk4(DE, y(x), ics=[1, i],\
                          step=0.05, end_points=[0,2]))
        g += line(desolve_rk4(DE, y(x), ics=[-1, i],\
                          step=0.05, end_points=[-2,0]))
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.books.computational-mathematics-with-sagemath.graphique_doctest[50]>", line 3, in <module>
        step=RealNumber('0.05'), end_points=[Integer(0),Integer(2)]))
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/calculus/desolvers.py", line 1378, in desolve_rk4
        sol_2=maxima(cmd).sage()
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 1074, in sage
        return self._sage_(*args, **kwds)
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py", line 1238, in _sage_
        maxima=self.parent())
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 2163, in symbolic_expression_from_maxima_string
        raise TypeError("unable to make sense of Maxima expression '%s' in Sage"%s)
    TypeError: unable to make sense of Maxima expression '(kill(sage4)$o44)[[1.0,-2.0],[1.05,-2.149874965475482],[1.1,-2.298999939830521],[1.15,-2.446624921487998],[1.2,-2.591999909207452],[1.25,-2.7343749020044],[1.3,-2.872999899091065],[1.35,-3.007124899832311],[1.4,-3.135999903712506],[1.45,-3.258874910310362],[1.5,-3.374999919279643],[1.55,-3.483624930334245],[1.6,-3.58399994323656],[1.65,-3.675374957788335],[1.7,-3.756999973823437],[1.75,-3.828124991202094],[1.8,-3.888000009806273],[1.85,-3.935875029535953],[1.9,-3.971000050306113],[1.95,-3.992625072044261],[2.0,-4.000000094688424]]' in Sage
```



---

archive/issue_comments_326237.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-31T21:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326238.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-31T22:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_326239.json:
```json
{
    "body": "All tests pass on 32 bits. I don't know what's up with Maxima in [comment:166]. That error is reproducible, but only on 1 system so far.",
    "created_at": "2019-01-31T22:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326239",
    "user": "https://github.com/jdemeyer"
}
```

All tests pass on 32 bits. I don't know what's up with Maxima in [comment:166]. That error is reproducible, but only on 1 system so far.



---

archive/issue_comments_326240.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-31T22:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326240",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_326241.json:
```json
{
    "body": "The error in [comment:166] is because of GC happening at the \"wrong\" time.",
    "created_at": "2019-01-31T22:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326241",
    "user": "https://github.com/jdemeyer"
}
```

The error in [comment:166] is because of GC happening at the "wrong" time.



---

archive/issue_comments_326242.json:
```json
{
    "body": "Ping. Needs review.",
    "created_at": "2019-02-04T08:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326242",
    "user": "https://github.com/jdemeyer"
}
```

Ping. Needs review.



---

archive/issue_comments_326243.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-05T19:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326243",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_326244.json:
```json
{
    "body": "ok, looks good enough. Let us try again",
    "created_at": "2019-02-05T19:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326244",
    "user": "https://github.com/fchapoton"
}
```

ok, looks good enough. Let us try again



---

archive/issue_comments_326245.json:
```json
{
    "body": "To the release manager: please merge this ASAP.",
    "created_at": "2019-02-07T08:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326245",
    "user": "https://github.com/jdemeyer"
}
```

To the release manager: please merge this ASAP.



---

archive/issue_comments_326246.json:
```json
{
    "body": "Please merge in #27066\n\n```\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/sol/polynomes_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/sol/polynomes_doctest.py\", line 79, in sage.tests.books.computational-mathematics-with-sagemath.sol.polynomes_doctest\nFailed example:\n    berlekamp_massey([1, 1, 2, 3, 8, 11, 34, 39, 148, 127])\nExpected:\n    x^3 - 5*x + 2\nGot:\n    doctest:warning\n      File \"/mnt/disk/home/release/Sage/src/bin/sage-runtests\", line 163, in <module>\n        err = DC.run()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 1225, in run\n        self.run_doctests()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 929, in run_doctests\n        self.dispatcher.dispatch()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2000, in dispatch\n        self.parallel_dispatch()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1897, in parallel_dispatch\n        w.start()  # This might take some time\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2183, in start\n        super(DocTestWorker, self).start()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/multiprocessing/process.py\", line 130, in start\n        self._popen = Popen(self)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/multiprocessing/forking.py\", line 126, in __init__\n        code = process_obj._bootstrap()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/multiprocessing/process.py\", line 267, in _bootstrap\n        self.run()\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2139, in run\n        task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2477, in __call__\n        doctests, extras = self._run(runner, options, results)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2526, in _run\n        result = runner.run(test)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 869, in run\n        return self._run(test, compileflags, out)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.books.computational-mathematics-with-sagemath.sol.polynomes_doctest[22]>\", line 1, in <module>\n        berlekamp_massey([Integer(1), Integer(1), Integer(2), Integer(3), Integer(8), Integer(11), Integer(34), Integer(39), Integer(148), Integer(127)])\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/misc/superseded.py\", line 102, in deprecation\n        warning(trac_number, message, DeprecationWarning, stacklevel)\n      File \"/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/misc/superseded.py\", line 148, in warning\n        warn(message, warning_class, stacklevel)\n    :\n    DeprecationWarning: \n    Importing berlekamp_massey from here is deprecated. If you need to use it, please import it directly from sage.matrix.berlekamp_massey\n    See https://trac.sagemath.org/27066 for details.\n    x^3 - 5*x + 2\n**********************************************************************\n1 item had failures:\n   1 of  33 in sage.tests.books.computational-mathematics-with-sagemath.sol.polynomes_doctest\n    [32 tests, 1 failure, 18.18 s]\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/combinat_doctest.py\n    [265 tests, 39.67 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/sol/polynomes_doctest.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-02-07T20:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326246",
    "user": "https://github.com/vbraun"
}
```

Please merge in #27066

```
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/sol/polynomes_doctest.py
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/sol/polynomes_doctest.py", line 79, in sage.tests.books.computational-mathematics-with-sagemath.sol.polynomes_doctest
Failed example:
    berlekamp_massey([1, 1, 2, 3, 8, 11, 34, 39, 148, 127])
Expected:
    x^3 - 5*x + 2
Got:
    doctest:warning
      File "/mnt/disk/home/release/Sage/src/bin/sage-runtests", line 163, in <module>
        err = DC.run()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1225, in run
        self.run_doctests()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 929, in run_doctests
        self.dispatcher.dispatch()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2000, in dispatch
        self.parallel_dispatch()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1897, in parallel_dispatch
        w.start()  # This might take some time
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2183, in start
        super(DocTestWorker, self).start()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/multiprocessing/process.py", line 267, in _bootstrap
        self.run()
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2139, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2477, in __call__
        doctests, extras = self._run(runner, options, results)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2526, in _run
        result = runner.run(test)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 869, in run
        return self._run(test, compileflags, out)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.books.computational-mathematics-with-sagemath.sol.polynomes_doctest[22]>", line 1, in <module>
        berlekamp_massey([Integer(1), Integer(1), Integer(2), Integer(3), Integer(8), Integer(11), Integer(34), Integer(39), Integer(148), Integer(127)])
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 102, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/misc/superseded.py", line 148, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: 
    Importing berlekamp_massey from here is deprecated. If you need to use it, please import it directly from sage.matrix.berlekamp_massey
    See https://trac.sagemath.org/27066 for details.
    x^3 - 5*x + 2
**********************************************************************
1 item had failures:
   1 of  33 in sage.tests.books.computational-mathematics-with-sagemath.sol.polynomes_doctest
    [32 tests, 1 failure, 18.18 s]
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/combinat_doctest.py
    [265 tests, 39.67 s]
----------------------------------------------------------------------
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/sol/polynomes_doctest.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_326247.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-02-07T20:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326247",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_326248.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-08T19:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326248",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326249.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-02-08T19:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326249",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_326250.json:
```json
{
    "body": "done and tested, setting back to positive\n\n---\nNew commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[2107963](https://git.sagemath.org/sage.git/commit?id=210796300b1f3e6d9537c825d9bac21bea937322)|`Merge branch 'public/french_book_python3' in 8.7.b2`|\n|[473c626](https://git.sagemath.org/sage.git/commit?id=473c626fdf3171defa77dd62a4fc5e9a2151f2b1)|`Merge branch 'u/chapoton/27066' in french book branch`|\n|[3e2e949](https://git.sagemath.org/sage.git/commit?id=3e2e949901b68c3da92ae266f9c5c274e272451c)|`fix doctest using berlekamp`|\n---\nNew commits:",
    "created_at": "2019-02-08T19:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326250",
    "user": "https://github.com/fchapoton"
}
```

done and tested, setting back to positive

---
New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[2107963](https://git.sagemath.org/sage.git/commit?id=210796300b1f3e6d9537c825d9bac21bea937322)|`Merge branch 'public/french_book_python3' in 8.7.b2`|
|[473c626](https://git.sagemath.org/sage.git/commit?id=473c626fdf3171defa77dd62a4fc5e9a2151f2b1)|`Merge branch 'u/chapoton/27066' in french book branch`|
|[3e2e949](https://git.sagemath.org/sage.git/commit?id=3e2e949901b68c3da92ae266f9c5c274e272451c)|`fix doctest using berlekamp`|
---
New commits:



---

archive/issue_comments_326251.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-02-09T13:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326251",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_326252.json:
```json
{
    "body": "Here is a (hopefully final) 32-bit numerical noise nugget:\n\n```\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/sol/integration_doctest.py\", line 53, in sage.tests.books.computational-mathematics-with-sagemath.sol.integration_doctest\nFailed example:\n    [N(QuadNC(lambda x: sqrt(1-x^2), 0, 1, n) - pi/4)\n     for n in [2, 8, 16]]\nExpected:\n    [-0.285398163397448, -0.00524656673640445, -0.00125482109302663]\nGot:\n    [-0.285398163397448, -0.00524656673640433, -0.00125482109302577]\n**********************************************************************\n1 item had failures:\n   1 of  13 in sage.tests.books.computational-mathematics-with-sagemath.sol.integration_doctest\n    [12 tests, 1 failure, 2.52 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/sol/integration_doctest.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 8302.0 seconds\n```",
    "created_at": "2019-02-09T13:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326252",
    "user": "https://github.com/vbraun"
}
```

Here is a (hopefully final) 32-bit numerical noise nugget:

```
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/sol/integration_doctest.py", line 53, in sage.tests.books.computational-mathematics-with-sagemath.sol.integration_doctest
Failed example:
    [N(QuadNC(lambda x: sqrt(1-x^2), 0, 1, n) - pi/4)
     for n in [2, 8, 16]]
Expected:
    [-0.285398163397448, -0.00524656673640445, -0.00125482109302663]
Got:
    [-0.285398163397448, -0.00524656673640433, -0.00125482109302577]
**********************************************************************
1 item had failures:
   1 of  13 in sage.tests.books.computational-mathematics-with-sagemath.sol.integration_doctest
    [12 tests, 1 failure, 2.52 s]
----------------------------------------------------------------------
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/sol/integration_doctest.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 8302.0 seconds
```



---

archive/issue_comments_326253.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-09T15:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_326254.json:
```json
{
    "body": "ok, done. This ticket is a pain..",
    "created_at": "2019-02-09T15:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326254",
    "user": "https://github.com/fchapoton"
}
```

ok, done. This ticket is a pain..



---

archive/issue_comments_326255.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-02-09T15:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326255",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_060400.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-10T12:55:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23335#event-60400"
}
```



---

archive/issue_comments_326256.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-10T12:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23335#issuecomment-326256",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
