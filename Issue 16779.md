# Issue 16779: Implement naive algorithm for factor_set method of a finite word

Issue created by migration from https://trac.sagemath.org/ticket/17016

Original creator: slabbe

Original creation time: 2014-09-20 16:34:02

CC:  vdelecroix




---

Comment by slabbe created at 2014-09-20 16:43:50

Changing status from new to needs_review.


---

Comment by slabbe created at 2014-09-20 16:43:50

Changing type from PLEASE CHANGE to enhancement.


---

Comment by slabbe created at 2014-09-20 16:43:50

New commits:


---

Comment by slabbe created at 2014-09-20 16:43:50

Changing component from PLEASE CHANGE to combinatorics.


---

Comment by vdelecroix created at 2014-09-20 17:04:19

Hello,

I do not understand your timings... on my computer

```
sage: w = Word([randint(0,2) for _ in range(10000)], alphabet=[0,1,2])
sage: %time L = [w.number_of_factors(i, algorithm='naive') for i in range(20)]
CPU times: user 4.8 s, sys: 48 ms, total: 4.85 s
Wall time: 4.8 s
sage: %time O = [w.number_of_factors(i, algorithm='suffix tree') for i in range(20)]
CPU times: user 396 ms, sys: 28 ms, total: 424 ms
Wall time: 376 ms
```

And the main reason is because the `suffix_tree` is a cached method.

Vincent


---

Comment by vdelecroix created at 2014-09-20 17:04:19

Changing status from needs_review to needs_info.


---

Comment by slabbe created at 2014-09-20 21:36:58

Changing status from needs_info to needs_review.


---

Comment by slabbe created at 2014-09-20 21:36:58

> I do not understand your timings... on my computer

You are right : I get similar timings as yours. My hypothesis is that I did my timings tests on top of #17013 before doing `git stash` and creating a specific branch for this actual ticket.

I moved the benchmark showing that sometime a naive algorithm is faster (with #17013) from the description of the ticket above to here::


```
    sage: w = Word([randint(0,2) for _ in range(10000)], alphabet=[0,1,2])
    sage: %time L = [w.number_of_factors(i, algorithm='naive') for i in range(20)]
    CPU times: user 356 ms, sys: 34.9 ms, total: 391 ms
    Wall time: 389 ms
    sage: %time O = [w.number_of_factors(i, algorithm='suffix tree') for i in range(20)]
    CPU times: user 676 ms, sys: 25.7 ms, total: 701 ms
    Wall time: 694 ms
```



---

Comment by vdelecroix created at 2014-09-20 21:55:35

The difference in timing is more impressive on

```
sage: W = Words([0,1,2,3])
sage: w = W(list(words.ThueMorseWord()[:10000]))
sage: %time w.number_of_factors(10, algorithm='naive')
CPU times: user 24 ms, sys: 0 ns, total: 24 ms
Wall time: 19.6 ms
28
sage: %time w.number_of_factors(10, algorithm='suffix tree')
CPU times: user 144 ms, sys: 20 ms, total: 164 ms
Wall time: 145 ms
28
```


But still, I am not sure this is the way to go. If you intend to do some computations on factors it is always better to build a good data structure for them (e.g. a SuffixTree). With small modifications it should be possible to adapt the current implementation with an upper bound on the length.

I set to positive review as this can be instructive for timings, but I am not sure there might be any real case usage.

Vincent


---

Comment by vdelecroix created at 2014-09-20 21:55:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-09-25 12:05:53

Resolution: fixed
