# Issue 16779: Implement naive algorithm for factor_set method of a finite word

archive/issues_016779.json:
```json
{
    "body": "CC:  vdelecroix\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/17016\n\n",
    "created_at": "2014-09-20T16:34:02Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Implement naive algorithm for factor_set method of a finite word",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16779",
    "user": "slabbe"
}
```
CC:  vdelecroix



Issue created by migration from https://trac.sagemath.org/ticket/17016





---

archive/issue_comments_221903.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-20T16:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221903",
    "user": "slabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_221904.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2014-09-20T16:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221904",
    "user": "slabbe"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_221905.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-09-20T16:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221905",
    "user": "slabbe"
}
```

New commits:



---

archive/issue_comments_221906.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2014-09-20T16:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221906",
    "user": "slabbe"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_221907.json:
```json
{
    "body": "Hello,\n\nI do not understand your timings... on my computer\n\n```\nsage: w = Word([randint(0,2) for _ in range(10000)], alphabet=[0,1,2])\nsage: %time L = [w.number_of_factors(i, algorithm='naive') for i in range(20)]\nCPU times: user 4.8 s, sys: 48 ms, total: 4.85 s\nWall time: 4.8 s\nsage: %time O = [w.number_of_factors(i, algorithm='suffix tree') for i in range(20)]\nCPU times: user 396 ms, sys: 28 ms, total: 424 ms\nWall time: 376 ms\n```\n\nAnd the main reason is because the `suffix_tree` is a cached method.\n\nVincent",
    "created_at": "2014-09-20T17:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221907",
    "user": "vdelecroix"
}
```

Hello,

I do not understand your timings... on my computer

```
sage: w = Word([randint(0,2) for _ in range(10000)], alphabet=[0,1,2])
sage: %time L = [w.number_of_factors(i, algorithm='naive') for i in range(20)]
CPU times: user 4.8 s, sys: 48 ms, total: 4.85 s
Wall time: 4.8 s
sage: %time O = [w.number_of_factors(i, algorithm='suffix tree') for i in range(20)]
CPU times: user 396 ms, sys: 28 ms, total: 424 ms
Wall time: 376 ms
```

And the main reason is because the `suffix_tree` is a cached method.

Vincent



---

archive/issue_comments_221908.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-09-20T17:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221908",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_221909.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-09-20T21:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221909",
    "user": "slabbe"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_221910.json:
```json
{
    "body": "> I do not understand your timings... on my computer\n\nYou are right : I get similar timings as yours. My hypothesis is that I did my timings tests on top of #17013 before doing `git stash` and creating a specific branch for this actual ticket.\n\nI moved the benchmark showing that sometime a naive algorithm is faster (with #17013) from the description of the ticket above to here::\n\n\n```\n    sage: w = Word([randint(0,2) for _ in range(10000)], alphabet=[0,1,2])\n    sage: %time L = [w.number_of_factors(i, algorithm='naive') for i in range(20)]\n    CPU times: user 356 ms, sys: 34.9 ms, total: 391 ms\n    Wall time: 389 ms\n    sage: %time O = [w.number_of_factors(i, algorithm='suffix tree') for i in range(20)]\n    CPU times: user 676 ms, sys: 25.7 ms, total: 701 ms\n    Wall time: 694 ms\n```\n",
    "created_at": "2014-09-20T21:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221910",
    "user": "slabbe"
}
```

> I do not understand your timings... on my computer

You are right : I get similar timings as yours. My hypothesis is that I did my timings tests on top of #17013 before doing `git stash` and creating a specific branch for this actual ticket.

I moved the benchmark showing that sometime a naive algorithm is faster (with #17013) from the description of the ticket above to here::


```
    sage: w = Word([randint(0,2) for _ in range(10000)], alphabet=[0,1,2])
    sage: %time L = [w.number_of_factors(i, algorithm='naive') for i in range(20)]
    CPU times: user 356 ms, sys: 34.9 ms, total: 391 ms
    Wall time: 389 ms
    sage: %time O = [w.number_of_factors(i, algorithm='suffix tree') for i in range(20)]
    CPU times: user 676 ms, sys: 25.7 ms, total: 701 ms
    Wall time: 694 ms
```




---

archive/issue_comments_221911.json:
```json
{
    "body": "The difference in timing is more impressive on\n\n```\nsage: W = Words([0,1,2,3])\nsage: w = W(list(words.ThueMorseWord()[:10000]))\nsage: %time w.number_of_factors(10, algorithm='naive')\nCPU times: user 24 ms, sys: 0 ns, total: 24 ms\nWall time: 19.6 ms\n28\nsage: %time w.number_of_factors(10, algorithm='suffix tree')\nCPU times: user 144 ms, sys: 20 ms, total: 164 ms\nWall time: 145 ms\n28\n```\n\n\nBut still, I am not sure this is the way to go. If you intend to do some computations on factors it is always better to build a good data structure for them (e.g. a SuffixTree). With small modifications it should be possible to adapt the current implementation with an upper bound on the length.\n\nI set to positive review as this can be instructive for timings, but I am not sure there might be any real case usage.\n\nVincent",
    "created_at": "2014-09-20T21:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221911",
    "user": "vdelecroix"
}
```

The difference in timing is more impressive on

```
sage: W = Words([0,1,2,3])
sage: w = W(list(words.ThueMorseWord()[:10000]))
sage: %time w.number_of_factors(10, algorithm='naive')
CPU times: user 24 ms, sys: 0 ns, total: 24 ms
Wall time: 19.6 ms
28
sage: %time w.number_of_factors(10, algorithm='suffix tree')
CPU times: user 144 ms, sys: 20 ms, total: 164 ms
Wall time: 145 ms
28
```


But still, I am not sure this is the way to go. If you intend to do some computations on factors it is always better to build a good data structure for them (e.g. a SuffixTree). With small modifications it should be possible to adapt the current implementation with an upper bound on the length.

I set to positive review as this can be instructive for timings, but I am not sure there might be any real case usage.

Vincent



---

archive/issue_comments_221912.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-20T21:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221912",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_221913.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-25T12:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16779",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16779#issuecomment-221913",
    "user": "vbraun"
}
```

Resolution: fixed
