# Issue 31915: Set up pyramid with both Vrep and Hrep

archive/issues_031915.json:
```json
{
    "body": "Keywords: polyhedron, double description, precomputed, pyramid\n\nWe set up the pyramid over a polyhedron with the double description. \n\nBefore:\n\n\n```\nsage: P = polytopes.permutahedron(6)                                                                                                                                                \nsage: %time Q = P.pyramid()                                                                                                                                                         \nCPU times: user 99.4 ms, sys: 0 ns, total: 99.4 ms\nWall time: 98 ms\nsage: P = polytopes.hypercube(8)                                                                                                                                                    \nsage: %time Q = P.pyramid()                                                                                                                                                         \nCPU times: user 34.2 ms, sys: 24 \u00b5s, total: 34.2 ms\nWall time: 33.3 ms\nsage: P = polytopes.cross_polytope(8)                                                                                                                                               \nsage: %time Q = P.pyramid()                                                                                                                                                         \nCPU times: user 40.5 ms, sys: 3.96 ms, total: 44.5 ms\nWall time: 43.3 ms\nsage: P = polytopes.hypercube(6, backend='field')                                                                                                                                   \nsage: %time Q = P.pyramid()                                                                                                                                                         \nCPU times: user 974 ms, sys: 0 ns, total: 974 ms\nWall time: 973 ms\n```\n\n\nAfter:\n\n```\nsage: P = polytopes.permutahedron(6)                                                                                                                                                                                                                                           \nsage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    \nCPU times: user 119 ms, sys: 197 \u00b5s, total: 120 ms\nWall time: 118 ms\nsage: P = polytopes.hypercube(8)                                                                                                                                                                                                                                               \nsage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    \nCPU times: user 30.5 ms, sys: 3.92 ms, total: 34.4 ms\nWall time: 33.4 ms\nsage: P = polytopes.cross_polytope(8)                                                                                                                                                                                                                                          \nsage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    \nCPU times: user 40.4 ms, sys: 0 ns, total: 40.4 ms\nWall time: 39.7 ms\nsage: P = polytopes.hypercube(6, backend='field')                                                                                                                                                                                                                              \nsage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    \nCPU times: user 8.04 ms, sys: 0 ns, total: 8.04 ms\nWall time: 7.99 ms\nsage: P = polytopes.hypercube(10, backend='field')                                                                                                                                                                                                                             \nsage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    \nCPU times: user 46.4 ms, sys: 98 \u00b5s, total: 46.5 ms\nWall time: 45.6 ms\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32152\n\n",
    "created_at": "2021-07-07T12:53:42Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Set up pyramid with both Vrep and Hrep",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31915",
    "user": "@kliem"
}
```
Keywords: polyhedron, double description, precomputed, pyramid

We set up the pyramid over a polyhedron with the double description. 

Before:


```
sage: P = polytopes.permutahedron(6)                                                                                                                                                
sage: %time Q = P.pyramid()                                                                                                                                                         
CPU times: user 99.4 ms, sys: 0 ns, total: 99.4 ms
Wall time: 98 ms
sage: P = polytopes.hypercube(8)                                                                                                                                                    
sage: %time Q = P.pyramid()                                                                                                                                                         
CPU times: user 34.2 ms, sys: 24 µs, total: 34.2 ms
Wall time: 33.3 ms
sage: P = polytopes.cross_polytope(8)                                                                                                                                               
sage: %time Q = P.pyramid()                                                                                                                                                         
CPU times: user 40.5 ms, sys: 3.96 ms, total: 44.5 ms
Wall time: 43.3 ms
sage: P = polytopes.hypercube(6, backend='field')                                                                                                                                   
sage: %time Q = P.pyramid()                                                                                                                                                         
CPU times: user 974 ms, sys: 0 ns, total: 974 ms
Wall time: 973 ms
```


After:

```
sage: P = polytopes.permutahedron(6)                                                                                                                                                                                                                                           
sage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    
CPU times: user 119 ms, sys: 197 µs, total: 120 ms
Wall time: 118 ms
sage: P = polytopes.hypercube(8)                                                                                                                                                                                                                                               
sage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    
CPU times: user 30.5 ms, sys: 3.92 ms, total: 34.4 ms
Wall time: 33.4 ms
sage: P = polytopes.cross_polytope(8)                                                                                                                                                                                                                                          
sage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    
CPU times: user 40.4 ms, sys: 0 ns, total: 40.4 ms
Wall time: 39.7 ms
sage: P = polytopes.hypercube(6, backend='field')                                                                                                                                                                                                                              
sage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    
CPU times: user 8.04 ms, sys: 0 ns, total: 8.04 ms
Wall time: 7.99 ms
sage: P = polytopes.hypercube(10, backend='field')                                                                                                                                                                                                                             
sage: %time Q = P.pyramid()                                                                                                                                                                                                                                                    
CPU times: user 46.4 ms, sys: 98 µs, total: 46.5 ms
Wall time: 45.6 ms
```


Issue created by migration from https://trac.sagemath.org/ticket/32152





---

archive/issue_comments_455962.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-07T12:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455962",
    "user": "@kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_455963.json:
```json
{
    "body": "Could there be a slowdown if we need to compute the number of inequalities, say if a polytope was given in terms of its vertices? Do we even want to bother checking if one or both of the representations have been done (and then choose accordingly)?\n\nI will have the same comment on #32150 and #32151.",
    "created_at": "2021-07-08T23:23:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455963",
    "user": "@tscrim"
}
```

Could there be a slowdown if we need to compute the number of inequalities, say if a polytope was given in terms of its vertices? Do we even want to bother checking if one or both of the representations have been done (and then choose accordingly)?

I will have the same comment on #32150 and #32151.



---

archive/issue_comments_455964.json:
```json
{
    "body": "Yes, there could be a slowdown and especially for something as simple as the pyramid, but not at the moment.\n\nCurrently, all polyhedra are immutable and non-interactive and the Vrepresentation and Hrepresentation is always already computed.\n\nWith mutable polyhedra (theoretically makes sense with `ppl`, `normaliz` and `polymake`) things will be a bit different. But then just embedding in higher dimension and adding a vertex would be the better approach anyway. So I would propose overwriting the pyramid method in the mutable case anyway.",
    "created_at": "2021-07-09T07:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455964",
    "user": "@kliem"
}
```

Yes, there could be a slowdown and especially for something as simple as the pyramid, but not at the moment.

Currently, all polyhedra are immutable and non-interactive and the Vrepresentation and Hrepresentation is always already computed.

With mutable polyhedra (theoretically makes sense with `ppl`, `normaliz` and `polymake`) things will be a bit different. But then just embedding in higher dimension and adding a vertex would be the better approach anyway. So I would propose overwriting the pyramid method in the mutable case anyway.



---

archive/issue_comments_455965.json:
```json
{
    "body": "Okay, I understand. Thank you for the explanation. LGTM.",
    "created_at": "2021-07-09T13:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455965",
    "user": "@tscrim"
}
```

Okay, I understand. Thank you for the explanation. LGTM.



---

archive/issue_comments_455966.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-09T13:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455966",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_455967.json:
```json
{
    "body": "Thank you.",
    "created_at": "2021-07-09T13:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455967",
    "user": "@kliem"
}
```

Thank you.



---

archive/issue_comments_455968.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-24T15:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31915#issuecomment-455968",
    "user": "@vbraun"
}
```

Resolution: fixed
