# Issue 11239: some q binomial coefficients should be zero

archive/issues_011239.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  chapoton sage-combinat\n\nI have found the following behaviour:\n\n\n```\nsage: import sage.combinat.q_analogues as qa\nsage: qa.q_binomial(2,-1)\n1/(q^2 + q + 1)\nsage: binomial(2,-1)\n0\nsage: qa.q_binomial(2,3)\n1/(q^2 + q + 1)\nsage: binomial(2,3)\n0\n```\n\nI think these q-binomials should rather be zero. The q-binomial is based on the q-factorial, where one finds the following behaviour\n\n\n```\nsage: [qa.q_factorial(-i) for i in range(6)]\n[1, 1, 1, 1, 1, 1]\n```\n\n\nThis seems to be rather wrong, as the factorial itself is infinite for negative integers.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11411\n\n",
    "created_at": "2011-05-31T12:32:13Z",
    "labels": [
        "combinatorics",
        "minor",
        "bug"
    ],
    "title": "some q binomial coefficients should be zero",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11239",
    "user": "chapoton"
}
```
Assignee: sage-combinat

CC:  chapoton sage-combinat

I have found the following behaviour:


```
sage: import sage.combinat.q_analogues as qa
sage: qa.q_binomial(2,-1)
1/(q^2 + q + 1)
sage: binomial(2,-1)
0
sage: qa.q_binomial(2,3)
1/(q^2 + q + 1)
sage: binomial(2,3)
0
```

I think these q-binomials should rather be zero. The q-binomial is based on the q-factorial, where one finds the following behaviour


```
sage: [qa.q_factorial(-i) for i in range(6)]
[1, 1, 1, 1, 1, 1]
```


This seems to be rather wrong, as the factorial itself is infinite for negative integers.

Issue created by migration from https://trac.sagemath.org/ticket/11411





---

archive/issue_comments_123796.json:
```json
{
    "body": "Attachment [correction_q_analogues_fc.patch](tarball://root/attachments/some-uuid/ticket11411/correction_q_analogues_fc.patch) by chapoton created at 2011-05-31 15:49:02",
    "created_at": "2011-05-31T15:49:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123796",
    "user": "chapoton"
}
```

Attachment [correction_q_analogues_fc.patch](tarball://root/attachments/some-uuid/ticket11411/correction_q_analogues_fc.patch) by chapoton created at 2011-05-31 15:49:02



---

archive/issue_comments_123797.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-31T15:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123797",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_123798.json:
```json
{
    "body": "Hi Fr\u00e9d\u00e9ric,\n\nWhen you write a patch which fixes a bug, you should add a doctest checking\nthat the bug is indeed fixed, together with the ticket number.\n\nI wrote a small review patch which does that. Your patch is Ok with me but\nsomeone must review mine. If you can do that and if my modification are Ok,\nyou can put a positive review on that one !",
    "created_at": "2011-06-02T15:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123798",
    "user": "hivert"
}
```

Hi Frédéric,

When you write a patch which fixes a bug, you should add a doctest checking
that the bug is indeed fixed, together with the ticket number.

I wrote a small review patch which does that. Your patch is Ok with me but
someone must review mine. If you can do that and if my modification are Ok,
you can put a positive review on that one !



---

archive/issue_comments_123799.json:
```json
{
    "body": "This seems to be ok, except the q_binomial procedure, where I have some concern.\n\nI think that, like the usual binomial coefficients, there is a natural extension of the q-binomial coefficients to the case (n,k) with negative k.\n\n\n```\nsage: binomial(-5,3) \n-35\n```\n\n\nEither one has to find this extension somewhere in the litterature, or we should leave the negative n case as NotImplemented. \n\nWell, I do not know. Maybe what you did is a correct temporary solution.",
    "created_at": "2011-06-02T16:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123799",
    "user": "chapoton"
}
```

This seems to be ok, except the q_binomial procedure, where I have some concern.

I think that, like the usual binomial coefficients, there is a natural extension of the q-binomial coefficients to the case (n,k) with negative k.


```
sage: binomial(-5,3) 
-35
```


Either one has to find this extension somewhere in the litterature, or we should leave the negative n case as NotImplemented. 

Well, I do not know. Maybe what you did is a correct temporary solution.



---

archive/issue_comments_123800.json:
```json
{
    "body": "oops, I was meaning \"negative n\"",
    "created_at": "2011-06-02T16:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123800",
    "user": "chapoton"
}
```

oops, I was meaning "negative n"



---

archive/issue_comments_123801.json:
```json
{
    "body": "Hi Fr\u00e9d\u00e9ric,\n\n> This seems to be ok, except the q_binomial procedure, where I have some concern.\n> \n> I think that, like the usual binomial coefficients, there is a natural extension of the q-binomial coefficients to the case (n,k) with negative k.\n>\n> Either one has to find this extension somewhere in the litterature, or we should leave the negative n case as NotImplemented. \n> \n> Well, I do not know. Maybe what you did is a correct temporary solution.\n\nA quick search on the web didn't gave me anything. So I have the impression\nthat this negative extension is not quite standard. Anyway, I corrected the\nerror messages.",
    "created_at": "2011-06-02T16:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123801",
    "user": "hivert"
}
```

Hi Frédéric,

> This seems to be ok, except the q_binomial procedure, where I have some concern.
> 
> I think that, like the usual binomial coefficients, there is a natural extension of the q-binomial coefficients to the case (n,k) with negative k.
>
> Either one has to find this extension somewhere in the litterature, or we should leave the negative n case as NotImplemented. 
> 
> Well, I do not know. Maybe what you did is a correct temporary solution.

A quick search on the web didn't gave me anything. So I have the impression
that this negative extension is not quite standard. Anyway, I corrected the
error messages.



---

archive/issue_comments_123802.json:
```json
{
    "body": "Attachment [trac_11411-q_analogues-review-fh.patch](tarball://root/attachments/some-uuid/ticket11411/trac_11411-q_analogues-review-fh.patch) by hivert created at 2011-06-02 16:48:03",
    "created_at": "2011-06-02T16:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123802",
    "user": "hivert"
}
```

Attachment [trac_11411-q_analogues-review-fh.patch](tarball://root/attachments/some-uuid/ticket11411/trac_11411-q_analogues-review-fh.patch) by hivert created at 2011-06-02 16:48:03



---

archive/issue_comments_123803.json:
```json
{
    "body": "ok, I see that you have changed the q_binomial. The changes are ok for me.\n\nBy the way, one could also check that n is a positive integer in the procedure qt-catalan-number, for coherence. What do you think ? I should have made that myself before.",
    "created_at": "2011-06-02T17:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123803",
    "user": "chapoton"
}
```

ok, I see that you have changed the q_binomial. The changes are ok for me.

By the way, one could also check that n is a positive integer in the procedure qt-catalan-number, for coherence. What do you think ? I should have made that myself before.



---

archive/issue_comments_123804.json:
```json
{
    "body": "> By the way, one could also check that n is a positive integer in the procedure qt-catalan-number, for coherence. What do you think ? I should have made that myself before.\n\nThat's probably a good idea. My wife is calling for dinner... Can you do it yourself ? Also to be nice to the release manager, it would be better to have only one patch, that is to include my patch into yours. This is called folding a patch: here is the way to go:\n\n```\nhg qgoto Your_patch\nhg qfold My_review_patch\n```\n\nYou can then finish to edit the file as usual. I'll review the final result.",
    "created_at": "2011-06-02T17:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123804",
    "user": "hivert"
}
```

> By the way, one could also check that n is a positive integer in the procedure qt-catalan-number, for coherence. What do you think ? I should have made that myself before.

That's probably a good idea. My wife is calling for dinner... Can you do it yourself ? Also to be nice to the release manager, it would be better to have only one patch, that is to include my patch into yours. This is called folding a patch: here is the way to go:

```
hg qgoto Your_patch
hg qfold My_review_patch
```

You can then finish to edit the file as usual. I'll review the final result.



---

archive/issue_comments_123805.json:
```json
{
    "body": "Attachment [trac_11411-correction_q_analogues_fc.patch](tarball://root/attachments/some-uuid/ticket11411/trac_11411-correction_q_analogues_fc.patch) by chapoton created at 2011-06-02 20:07:38\n\nfolded review patch and minor change in qt-catalan",
    "created_at": "2011-06-02T20:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123805",
    "user": "chapoton"
}
```

Attachment [trac_11411-correction_q_analogues_fc.patch](tarball://root/attachments/some-uuid/ticket11411/trac_11411-correction_q_analogues_fc.patch) by chapoton created at 2011-06-02 20:07:38

folded review patch and minor change in qt-catalan



---

archive/issue_comments_123806.json:
```json
{
    "body": "Trying to help the build bot to do its job :\n\nApply trac_11411-correction_q_analogues_fc.patch",
    "created_at": "2011-06-08T14:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123806",
    "user": "chapoton"
}
```

Trying to help the build bot to do its job :

Apply trac_11411-correction_q_analogues_fc.patch



---

archive/issue_comments_123807.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-06-14T21:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123807",
    "user": "hivert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_123808.json:
```json
{
    "body": "Everything looks good.",
    "created_at": "2011-06-14T21:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123808",
    "user": "hivert"
}
```

Everything looks good.



---

archive/issue_comments_123809.json:
```json
{
    "body": "thanks for the review !",
    "created_at": "2011-06-15T12:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123809",
    "user": "chapoton"
}
```

thanks for the review !



---

archive/issue_comments_123810.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-07-24T11:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-123810",
    "user": "jdemeyer"
}
```

Resolution: fixed
