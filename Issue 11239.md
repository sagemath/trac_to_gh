# Issue 11239: some q binomial coefficients should be zero

Issue created by migration from https://trac.sagemath.org/ticket/11411

Original creator: chapoton

Original creation time: 2011-05-31 12:32:13

Assignee: sage-combinat

CC:  chapoton sage-combinat

I have found the following behaviour:


```
sage: import sage.combinat.q_analogues as qa
sage: qa.q_binomial(2,-1)
1/(q^2 + q + 1)
sage: binomial(2,-1)
0
sage: qa.q_binomial(2,3)
1/(q^2 + q + 1)
sage: binomial(2,3)
0
```

I think these q-binomials should rather be zero. The q-binomial is based on the q-factorial, where one finds the following behaviour


```
sage: [qa.q_factorial(-i) for i in range(6)]
[1, 1, 1, 1, 1, 1]
```


This seems to be rather wrong, as the factorial itself is infinite for negative integers.


---

Attachment


---

Comment by chapoton created at 2011-05-31 15:50:29

Changing status from new to needs_review.


---

Comment by hivert created at 2011-06-02 15:11:33

Hi Frédéric,

When you write a patch which fixes a bug, you should add a doctest checking
that the bug is indeed fixed, together with the ticket number.

I wrote a small review patch which does that. Your patch is Ok with me but
someone must review mine. If you can do that and if my modification are Ok,
you can put a positive review on that one !


---

Comment by chapoton created at 2011-06-02 16:27:08

This seems to be ok, except the q_binomial procedure, where I have some concern.

I think that, like the usual binomial coefficients, there is a natural extension of the q-binomial coefficients to the case (n,k) with negative k.


```
sage: binomial(-5,3) 
-35
```


Either one has to find this extension somewhere in the litterature, or we should leave the negative n case as NotImplemented. 

Well, I do not know. Maybe what you did is a correct temporary solution.


---

Comment by chapoton created at 2011-06-02 16:28:00

oops, I was meaning "negative n"


---

Comment by hivert created at 2011-06-02 16:47:44

Hi Frédéric,

> This seems to be ok, except the q_binomial procedure, where I have some concern.
> 
> I think that, like the usual binomial coefficients, there is a natural extension of the q-binomial coefficients to the case (n,k) with negative k.
>
> Either one has to find this extension somewhere in the litterature, or we should leave the negative n case as NotImplemented. 
> 
> Well, I do not know. Maybe what you did is a correct temporary solution.

A quick search on the web didn't gave me anything. So I have the impression
that this negative extension is not quite standard. Anyway, I corrected the
error messages.


---

Attachment


---

Comment by chapoton created at 2011-06-02 17:01:28

ok, I see that you have changed the q_binomial. The changes are ok for me.

By the way, one could also check that n is a positive integer in the procedure qt-catalan-number, for coherence. What do you think ? I should have made that myself before.


---

Comment by hivert created at 2011-06-02 17:09:56

> By the way, one could also check that n is a positive integer in the procedure qt-catalan-number, for coherence. What do you think ? I should have made that myself before.

That's probably a good idea. My wife is calling for dinner... Can you do it yourself ? Also to be nice to the release manager, it would be better to have only one patch, that is to include my patch into yours. This is called folding a patch: here is the way to go:

```
hg qgoto Your_patch
hg qfold My_review_patch
```

You can then finish to edit the file as usual. I'll review the final result.


---

Attachment

folded review patch and minor change in qt-catalan


---

Comment by chapoton created at 2011-06-08 14:31:59

Trying to help the build bot to do its job :

Apply trac_11411-correction_q_analogues_fc.patch


---

Comment by hivert created at 2011-06-14 21:01:29

Changing status from needs_review to positive_review.


---

Comment by hivert created at 2011-06-14 21:01:29

Everything looks good.


---

Comment by chapoton created at 2011-06-15 12:06:04

thanks for the review !


---

Comment by jdemeyer created at 2011-07-24 11:16:52

Resolution: fixed
