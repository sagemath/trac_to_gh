# Issue 30314: Drop Python 3.6 support

archive/issues_030314.json:
```json
{
    "body": "CC:  chapoton mkoeppe mjo dimpase vbraun\n\nThis can be a dependency for other tickets.\n\nFor instance tickets updating dependencies to\nversions that dropped support for Python 3.6.\n\nAnd if we adopt the policy in #30384 then\nwe should soon drop support for Python 3.6.\n\nRelated:\n\n- #30384: Adopt \"time window-based\" Python versions support policy\n\nIssue created by migration from https://trac.sagemath.org/ticket/30551\n\n",
    "created_at": "2020-09-10T18:15:01Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Drop Python 3.6 support",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30314",
    "user": "slelievre"
}
```
CC:  chapoton mkoeppe mjo dimpase vbraun

This can be a dependency for other tickets.

For instance tickets updating dependencies to
versions that dropped support for Python 3.6.

And if we adopt the policy in #30384 then
we should soon drop support for Python 3.6.

Related:

- #30384: Adopt "time window-based" Python versions support policy

Issue created by migration from https://trac.sagemath.org/ticket/30551





---

archive/issue_comments_432397.json:
```json
{
    "body": "I don't think there is anything that says that we \"should\" drop Python 3.6 support.",
    "created_at": "2020-09-10T18:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432397",
    "user": "mkoeppe"
}
```

I don't think there is anything that says that we "should" drop Python 3.6 support.



---

archive/issue_comments_432398.json:
```json
{
    "body": "Replying to [comment:1 mkoeppe]:\n> I don't think there is anything that says\n> that we \"should\" drop Python 3.6 support.\n\nOh good, then let's support it as long as we can.\n\nBy the way #15530 and #15980 which started support\nfor Python 3.6 are almost ready to be closed.",
    "created_at": "2020-09-10T19:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432398",
    "user": "slelievre"
}
```

Replying to [comment:1 mkoeppe]:
> I don't think there is anything that says
> that we "should" drop Python 3.6 support.

Oh good, then let's support it as long as we can.

By the way #15530 and #15980 which started support
for Python 3.6 are almost ready to be closed.



---

archive/issue_comments_432399.json:
```json
{
    "body": "#30053 says that we must drop Python 3.6 - unless you want to have a go at it.\n\nit seems that some of our code related to docbuilding is too new for 3.6, and perhaps our Sphinx is too new too. \n\nBesides, the EOL for 3.6 is late 2021, which is soon.",
    "created_at": "2020-09-15T11:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432399",
    "user": "dimpase"
}
```

#30053 says that we must drop Python 3.6 - unless you want to have a go at it.

it seems that some of our code related to docbuilding is too new for 3.6, and perhaps our Sphinx is too new too. 

Besides, the EOL for 3.6 is late 2021, which is soon.



---

archive/issue_comments_432400.json:
```json
{
    "body": "What do you think about adopting the [Python version strategy](https://numpy.org/neps/nep-0029-deprecation_policy.html) of numpy, according to which \"a project with a major or minor version release in November 2020 should support Python 3.7 and newer\"?",
    "created_at": "2020-12-05T12:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432400",
    "user": "@tobiasdiez"
}
```

What do you think about adopting the [Python version strategy](https://numpy.org/neps/nep-0029-deprecation_policy.html) of numpy, according to which "a project with a major or minor version release in November 2020 should support Python 3.7 and newer"?



---

archive/issue_comments_432401.json:
```json
{
    "body": "Replying to [comment:6 gh-tobiasdiez]:\n> What do you think about adopting the [Python version strategy](https://numpy.org/neps/nep-0029-deprecation_policy.html) of numpy, according to which \"a project with a major or minor version release in November 2020 should support Python 3.7 and newer\"?\nThat's #30384",
    "created_at": "2020-12-05T17:33:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432401",
    "user": "mkoeppe"
}
```

Replying to [comment:6 gh-tobiasdiez]:
> What do you think about adopting the [Python version strategy](https://numpy.org/neps/nep-0029-deprecation_policy.html) of numpy, according to which "a project with a major or minor version release in November 2020 should support Python 3.7 and newer"?
That's #30384



---

archive/issue_comments_432402.json:
```json
{
    "body": "According to NEP 29, \"a project with a major or minor version release in November 2020 should support Python 3.7 and newer.\" and thus this ticket can be closed in my opinion.\n\n(Documentation for following NEP 29 is added in #30384.)",
    "created_at": "2020-12-07T22:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432402",
    "user": "@tobiasdiez"
}
```

According to NEP 29, "a project with a major or minor version release in November 2020 should support Python 3.7 and newer." and thus this ticket can be closed in my opinion.

(Documentation for following NEP 29 is added in #30384.)



---

archive/issue_comments_432403.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-07T22:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432403",
    "user": "@tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_432404.json:
```json
{
    "body": "??!\n\nThis ticket is for **dropping** support for Python 3.6 -- this involves changing what system python versions we accept (`build/pkgs/python3/spkg-configure.m4`) and removing python3.6 workarounds from the code.\n\nNEP 29 would already allow us to drop support now -- but I don't think we want to do it now (because of Sage's traditional role of providing a distribution that people can install onto ancient machines) -- hence the milestone is set to \"pending\".",
    "created_at": "2020-12-07T22:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432404",
    "user": "mkoeppe"
}
```

??!

This ticket is for **dropping** support for Python 3.6 -- this involves changing what system python versions we accept (`build/pkgs/python3/spkg-configure.m4`) and removing python3.6 workarounds from the code.

NEP 29 would already allow us to drop support now -- but I don't think we want to do it now (because of Sage's traditional role of providing a distribution that people can install onto ancient machines) -- hence the milestone is set to "pending".



---

archive/issue_comments_432405.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-07T22:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432405",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_432406.json:
```json
{
    "body": "Sorry, it wasn't clear to me from the ticket description that this is more than a placeholder to mark dependencies on Python 3.6.\n\nNEP 29 is actually quite explicit about that one should drop support after the 42 months, e.g \"On Jun 23, 2020 drop support for Python 3.6 (initially released on Dec 23, 2016)\". Of course, it could be sage's policy to support also older python versions, but that's then no longer NEP 29 (in it's strict form). However, one should also keep in mind that supporting old Python versions results in technical debt that might be bigger than the gains from supporting old systems.\n\nAlso correct me if I'm wrong, but since sage is also installing its own python version, sage can still be used on older systems, right? It is just that the system python is not used.\n\nAnyway, I've tried to locate all workarounds that are in place for Python 3.6 support, and removed them (I've probably missed a few, but maybe its good anyway to pay of the technical debt in follow up tickets). Moreover, I've upgraded the requirements to 3.7 (again, I might have missed something).\n----\nNew commits:",
    "created_at": "2020-12-07T23:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432406",
    "user": "@tobiasdiez"
}
```

Sorry, it wasn't clear to me from the ticket description that this is more than a placeholder to mark dependencies on Python 3.6.

NEP 29 is actually quite explicit about that one should drop support after the 42 months, e.g "On Jun 23, 2020 drop support for Python 3.6 (initially released on Dec 23, 2016)". Of course, it could be sage's policy to support also older python versions, but that's then no longer NEP 29 (in it's strict form). However, one should also keep in mind that supporting old Python versions results in technical debt that might be bigger than the gains from supporting old systems.

Also correct me if I'm wrong, but since sage is also installing its own python version, sage can still be used on older systems, right? It is just that the system python is not used.

Anyway, I've tried to locate all workarounds that are in place for Python 3.6 support, and removed them (I've probably missed a few, but maybe its good anyway to pay of the technical debt in follow up tickets). Moreover, I've upgraded the requirements to 3.7 (again, I might have missed something).
----
New commits:



---

archive/issue_comments_432407.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-07T23:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432407",
    "user": "@tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_432408.json:
```json
{
    "body": "Other projects dropping support for Python 3.6:\n\n- Networkx,\n  see [Networkx PR #4469 \"Drop Py3.6 support per NEP 29\"](https://github.com/networkx/networkx/pull/4469)\n  merged 2020-12-17\n- NumPy 1.20, see NumPy 1.20.rc1 released 2020-12-03\n- SciPy 1.6.0, see SciPy 1.6.0rc1 released 2020-12-11",
    "created_at": "2020-12-17T20:29:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432408",
    "user": "slelievre"
}
```

Other projects dropping support for Python 3.6:

- Networkx,
  see [Networkx PR #4469 "Drop Py3.6 support per NEP 29"](https://github.com/networkx/networkx/pull/4469)
  merged 2020-12-17
- NumPy 1.20, see NumPy 1.20.rc1 released 2020-12-03
- SciPy 1.6.0, see SciPy 1.6.0rc1 released 2020-12-11



---

archive/issue_comments_432409.json:
```json
{
    "body": "In this change:\n\n```\n - **ar** and **ranlib**: can be obtained as part of GNU binutils.\n - **tar**: GNU tar version 1.17 or later, or BSD tar.\n-- **python**: Python 3, 3.6 or later, or Python 2.7 (deprecated).\n+- **python**: Python 3.7 or later (Python 2.7 or Python <= 3.6 support is deprecated).\n```\n\nBoth the original text and the new one are not correct. This part refers to the `sage-bootstrap-python` which has much wider range of supported python versions, including Python >= 2.6 and Python >= 3.4 - according to `build/tox.ini`.",
    "created_at": "2020-12-19T00:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432409",
    "user": "mkoeppe"
}
```

In this change:

```
 - **ar** and **ranlib**: can be obtained as part of GNU binutils.
 - **tar**: GNU tar version 1.17 or later, or BSD tar.
-- **python**: Python 3, 3.6 or later, or Python 2.7 (deprecated).
+- **python**: Python 3.7 or later (Python 2.7 or Python <= 3.6 support is deprecated).
```

Both the original text and the new one are not correct. This part refers to the `sage-bootstrap-python` which has much wider range of supported python versions, including Python >= 2.6 and Python >= 3.4 - according to `build/tox.ini`.



---

archive/issue_comments_432410.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-19T09:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432410",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432411.json:
```json
{
    "body": "Replying to [comment:13 mkoeppe]:\n> In this change:\n> {{{\n>  - **ar** and **ranlib**: can be obtained as part of GNU binutils.\n>  - **tar**: GNU tar version 1.17 or later, or BSD tar.\n> -- **python**: Python 3, 3.6 or later, or Python 2.7 (deprecated).\n> +- **python**: Python 3.7 or later (Python 2.7 or Python <= 3.6 support is deprecated).\n> }}}\n> Both the original text and the new one are not correct. This part refers to the `sage-bootstrap-python` which has much wider range of supported python versions, including Python >= 2.6 and Python >= 3.4 - according to `build/tox.ini`.\n> \n\nI've changed the versions now.",
    "created_at": "2020-12-19T09:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432411",
    "user": "@tobiasdiez"
}
```

Replying to [comment:13 mkoeppe]:
> In this change:
> {{{
>  - **ar** and **ranlib**: can be obtained as part of GNU binutils.
>  - **tar**: GNU tar version 1.17 or later, or BSD tar.
> -- **python**: Python 3, 3.6 or later, or Python 2.7 (deprecated).
> +- **python**: Python 3.7 or later (Python 2.7 or Python <= 3.6 support is deprecated).
> }}}
> Both the original text and the new one are not correct. This part refers to the `sage-bootstrap-python` which has much wider range of supported python versions, including Python >= 2.6 and Python >= 3.4 - according to `build/tox.ini`.
> 

I've changed the versions now.



---

archive/issue_comments_432412.json:
```json
{
    "body": "\n```\n--- a/src/doc/en/installation/source.rst\n+++ b/src/doc/en/installation/source.rst\n@@ -88,7 +88,7 @@ computer:\n - **perl**: version 5.8.0 or later.\n - **ar** and **ranlib**: can be obtained as part of GNU binutils.\n - **tar**: GNU tar version 1.17 or later, or BSD tar.\n-- **python**: Python 3, 3.6 or later, or Python 2.7 (deprecated).\n+- **python**: Python 3.7 or later (Python >= 2.6 and <= 3.6 support is deprecated).\n \n Other versions of these may work, but they are untested.\n```\n\nI don't think we have deprecated anything regarding `sage-bootstrap-python` versions.\n(see #20023 - which proposes to drop support for 2.6)",
    "created_at": "2020-12-19T17:22:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432412",
    "user": "mkoeppe"
}
```


```
--- a/src/doc/en/installation/source.rst
+++ b/src/doc/en/installation/source.rst
@@ -88,7 +88,7 @@ computer:
 - **perl**: version 5.8.0 or later.
 - **ar** and **ranlib**: can be obtained as part of GNU binutils.
 - **tar**: GNU tar version 1.17 or later, or BSD tar.
-- **python**: Python 3, 3.6 or later, or Python 2.7 (deprecated).
+- **python**: Python 3.7 or later (Python >= 2.6 and <= 3.6 support is deprecated).
 
 Other versions of these may work, but they are untested.
```

I don't think we have deprecated anything regarding `sage-bootstrap-python` versions.
(see #20023 - which proposes to drop support for 2.6)



---

archive/issue_comments_432413.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-23T19:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432413",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_432414.json:
```json
{
    "body": "I'm splitting this documentation update out to #31192 to get it into Sage 9.3",
    "created_at": "2021-01-06T22:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432414",
    "user": "mkoeppe"
}
```

I'm splitting this documentation update out to #31192 to get it into Sage 9.3



---

archive/issue_comments_432415.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-07T01:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432415",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432416.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-01-12T21:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432416",
    "user": "@tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_432417.json:
```json
{
    "body": "what's going on in src/sage/combinat/subset.py change in this branch?",
    "created_at": "2021-01-15T14:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432417",
    "user": "dimpase"
}
```

what's going on in src/sage/combinat/subset.py change in this branch?



---

archive/issue_comments_432418.json:
```json
{
    "body": "That's a revert of commit \"Allow Sage to work with a system Python 3.6.\" abb5607710a2a5cc5415423489fa452965cbef68 which is introduced a workaround that is no longer required for Python 3.7.",
    "created_at": "2021-01-15T15:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432418",
    "user": "@tobiasdiez"
}
```

That's a revert of commit "Allow Sage to work with a system Python 3.6." abb5607710a2a5cc5415423489fa452965cbef68 which is introduced a workaround that is no longer required for Python 3.7.



---

archive/issue_comments_432419.json:
```json
{
    "body": "Replying to [comment:25 gh-tobiasdiez]:\n> That's a revert of commit \"Allow Sage to work with a system Python 3.6.\" abb5607710a2a5cc5415423489fa452965cbef68 which is introduced a workaround that is no longer required for Python 3.7.\n\nI mean, what's\n\n```\n    def __len__....\n...\n-        return int(self.cardinality())\n+        return Integer(1) << self._s.cardinality()\n+\n+    __len__ = cardinality\n```\n\nin \n\n```\ncommit 7d97a56c5aaab99af75de58b71b144a28d4f9dd3\nAuthor: Tobias Diez <code@tobiasdiez.com>\nDate:   Mon Dec 7 23:52:28 2020 +0100\n\n    Partially revert \"Allow Sage to work with a system Python 3.6.\"\n    \n```\n\n\nwhy do we need an implementation for `__len__` ?\n(before `abb5607710a` it was just `__len__ = cardinality`)",
    "created_at": "2021-01-16T08:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432419",
    "user": "dimpase"
}
```

Replying to [comment:25 gh-tobiasdiez]:
> That's a revert of commit "Allow Sage to work with a system Python 3.6." abb5607710a2a5cc5415423489fa452965cbef68 which is introduced a workaround that is no longer required for Python 3.7.

I mean, what's

```
    def __len__....
...
-        return int(self.cardinality())
+        return Integer(1) << self._s.cardinality()
+
+    __len__ = cardinality
```

in 

```
commit 7d97a56c5aaab99af75de58b71b144a28d4f9dd3
Author: Tobias Diez <code@tobiasdiez.com>
Date:   Mon Dec 7 23:52:28 2020 +0100

    Partially revert "Allow Sage to work with a system Python 3.6."
    
```


why do we need an implementation for `__len__` ?
(before `abb5607710a` it was just `__len__ = cardinality`)



---

archive/issue_comments_432420.json:
```json
{
    "body": "Sorry, I don't understand your question.\nIn pseudo-language:\n\nBefore abb5607710a: `__len__ = cardinality`\n\nAfter abb5607710a: `__len__ = int(cardinality)`\n\nAfter 7d97a56c5a (this ticket): `__len__ = cardinality`\n\nSo we are back to the original behavior before abb5607710a \"Allow Sage to work with a system Python 3.6.\"\n\nMaybe this representation of the diff is clearer: https://github.com/sagemath/sagetrac-mirror/commit/7d97a56c5aaab99af75de58b71b144a28d4f9dd3",
    "created_at": "2021-01-16T12:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432420",
    "user": "@tobiasdiez"
}
```

Sorry, I don't understand your question.
In pseudo-language:

Before abb5607710a: `__len__ = cardinality`

After abb5607710a: `__len__ = int(cardinality)`

After 7d97a56c5a (this ticket): `__len__ = cardinality`

So we are back to the original behavior before abb5607710a "Allow Sage to work with a system Python 3.6."

Maybe this representation of the diff is clearer: https://github.com/sagemath/sagetrac-mirror/commit/7d97a56c5aaab99af75de58b71b144a28d4f9dd3



---

archive/issue_comments_432421.json:
```json
{
    "body": "Oh, OK, I misread the diff, sorry.",
    "created_at": "2021-01-16T17:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432421",
    "user": "dimpase"
}
```

Oh, OK, I misread the diff, sorry.



---

archive/issue_comments_432422.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-04-19T19:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432422",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_432423.json:
```json
{
    "body": "Rebased on 9.3.rc4 and #30913 (which added relevant metadata).\n\nLet's merge this at the beginning of the 9.4 cycle.",
    "created_at": "2021-04-19T19:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432423",
    "user": "mkoeppe"
}
```

Rebased on 9.3.rc4 and #30913 (which added relevant metadata).

Let's merge this at the beginning of the 9.4 cycle.



---

archive/issue_comments_432424.json:
```json
{
    "body": "lgtm",
    "created_at": "2021-04-22T12:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432424",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_432425.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-22T12:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432425",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_432426.json:
```json
{
    "body": "Did you take into account that Ubuntu 18.04 (LTS supported until 2028) still uses Python 3.6 (see https://packages.ubuntu.com/bionic/python3)? I am not sure what they intend to do with Python though.",
    "created_at": "2021-05-16T21:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432426",
    "user": "vdelecroix"
}
```

Did you take into account that Ubuntu 18.04 (LTS supported until 2028) still uses Python 3.6 (see https://packages.ubuntu.com/bionic/python3)? I am not sure what they intend to do with Python though.



---

archive/issue_comments_432427.json:
```json
{
    "body": "Yes, these systems are out there. From Sage 9.4 on we will no longer be able to use the system python, but this will not stop Sage from building and running on this system.",
    "created_at": "2021-05-16T21:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432427",
    "user": "mkoeppe"
}
```

Yes, these systems are out there. From Sage 9.4 on we will no longer be able to use the system python, but this will not stop Sage from building and running on this system.



---

archive/issue_comments_432428.json:
```json
{
    "body": "There are two relevant Python minimum versions (see comment:13):\n\n- the minimum Python version Sage can use as its underlying Python\n- the minimum Python version Sage can use to bootstrap,\n  building is own Python if necessary\n\nOn Ubuntu 18.04, building from source will still work,\nbut if the system Python is 3.6, Sage will build a more\nrecent Python to base itself on.",
    "created_at": "2021-05-16T21:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432428",
    "user": "slelievre"
}
```

There are two relevant Python minimum versions (see comment:13):

- the minimum Python version Sage can use as its underlying Python
- the minimum Python version Sage can use to bootstrap,
  building is own Python if necessary

On Ubuntu 18.04, building from source will still work,
but if the system Python is 3.6, Sage will build a more
recent Python to base itself on.



---

archive/issue_comments_432429.json:
```json
{
    "body": "no need to build it on !Debian/Ubuntu, even the old LTS provide modern pythons. E.g.\n\n```\nsudo apt-get install python3.8 python3.8-dev python3.8-distutils python3.8-venv\n```\n\n\nand if you don't have root you can use pyenv to get modern python.\n\nWe should be thinking about stopping with shipping CPython sources, we don't patch them, and there are enough ways to get it in binary.",
    "created_at": "2021-05-17T07:31:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432429",
    "user": "dimpase"
}
```

no need to build it on !Debian/Ubuntu, even the old LTS provide modern pythons. E.g.

```
sudo apt-get install python3.8 python3.8-dev python3.8-distutils python3.8-venv
```


and if you don't have root you can use pyenv to get modern python.

We should be thinking about stopping with shipping CPython sources, we don't patch them, and there are enough ways to get it in binary.



---

archive/issue_comments_432430.json:
```json
{
    "body": "a slight inconvenience is that you'd need to specify the Python to use to `./configure`",
    "created_at": "2021-05-17T08:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432430",
    "user": "dimpase"
}
```

a slight inconvenience is that you'd need to specify the Python to use to `./configure`



---

archive/issue_comments_432431.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-05-18T02:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432431",
    "user": "mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_432432.json:
```json
{
    "body": "Commit 721ede18042cfee9ca044823599346e1ee7420f1 is not good.",
    "created_at": "2021-05-18T02:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432432",
    "user": "mkoeppe"
}
```

Commit 721ede18042cfee9ca044823599346e1ee7420f1 is not good.



---

archive/issue_comments_432433.json:
```json
{
    "body": "Replying to [comment:41 mkoeppe]:\n> Commit 721ede18042cfee9ca044823599346e1ee7420f1 is not good. \n\nthis is \n\n```diff\nAuthor: Tobias Diez <code@tobiasdiez.com>\nDate:   Tue Dec 8 00:05:41 2020 +0100\n\n    Partially revert #30008\n\ndiff --git a/build/bin/sage-bootstrap-python b/build/bin/sage-bootstrap-python\nindex faee444e8d..c3afc1261a 100755\n--- a/build/bin/sage-bootstrap-python\n+++ b/build/bin/sage-bootstrap-python\n@@ -30,15 +30,6 @@ fi\n # is accessible by this python; this is to guard on Cygwin against Pythons\n # installed somewhere else in Windows.\n \n-# Trac #30008: Make it work even if the environment tries to sabotage UTF-8\n-# operation in Python 3.0.x-3.6.x by setting LC_ALL=C or similar.\n-\n-if [ \"$LC_ALL\" = \"C\" -o \"$LANG\" = \"C\" -o \"$LC_CTYPE\" = \"C\" ]; then\n-    LC_ALL=$(locale -a | grep -E -i '^(c|en_us)[-.]utf-?8$' | head -n 1)\n-    LANG=$LC_ALL\n-    export LC_ALL\n-    export LANG\n-fi\n \n PYTHONS=\"python python3 python3.8 python3.7 python2.7 python3.6 python2\"\n for PY in $PYTHONS; do\n```\n\nwhat's the problem here?",
    "created_at": "2021-05-19T11:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432433",
    "user": "dimpase"
}
```

Replying to [comment:41 mkoeppe]:
> Commit 721ede18042cfee9ca044823599346e1ee7420f1 is not good. 

this is 

```diff
Author: Tobias Diez <code@tobiasdiez.com>
Date:   Tue Dec 8 00:05:41 2020 +0100

    Partially revert #30008

diff --git a/build/bin/sage-bootstrap-python b/build/bin/sage-bootstrap-python
index faee444e8d..c3afc1261a 100755
--- a/build/bin/sage-bootstrap-python
+++ b/build/bin/sage-bootstrap-python
@@ -30,15 +30,6 @@ fi
 # is accessible by this python; this is to guard on Cygwin against Pythons
 # installed somewhere else in Windows.
 
-# Trac #30008: Make it work even if the environment tries to sabotage UTF-8
-# operation in Python 3.0.x-3.6.x by setting LC_ALL=C or similar.
-
-if [ "$LC_ALL" = "C" -o "$LANG" = "C" -o "$LC_CTYPE" = "C" ]; then
-    LC_ALL=$(locale -a | grep -E -i '^(c|en_us)[-.]utf-?8$' | head -n 1)
-    LANG=$LC_ALL
-    export LC_ALL
-    export LANG
-fi
 
 PYTHONS="python python3 python3.8 python3.7 python2.7 python3.6 python2"
 for PY in $PYTHONS; do
```

what's the problem here?



---

archive/issue_comments_432434.json:
```json
{
    "body": "Replying to [comment:43 dimpase]:\n> what's the problem here?\n\nIt is a change to `sage-bootstrap-python`; but we are NOT changing support for bootstrapping with old Python versions.",
    "created_at": "2021-05-19T15:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432434",
    "user": "mkoeppe"
}
```

Replying to [comment:43 dimpase]:
> what's the problem here?

It is a change to `sage-bootstrap-python`; but we are NOT changing support for bootstrapping with old Python versions.



---

archive/issue_comments_432435.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-19T15:15:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432435",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_432436.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-19T15:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432436",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_432437.json:
```json
{
    "body": "`@`vbraun - if it's too late for this change, I can also put this reverting commit on a new ticket.",
    "created_at": "2021-05-19T15:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432437",
    "user": "mkoeppe"
}
```

`@`vbraun - if it's too late for this change, I can also put this reverting commit on a new ticket.



---

archive/issue_comments_432438.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-19T15:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432438",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_432439.json:
```json
{
    "body": "ok.",
    "created_at": "2021-05-19T15:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432439",
    "user": "dimpase"
}
```

ok.



---

archive/issue_comments_432440.json:
```json
{
    "body": "Looks like the earlier version, b06731c29501c81a35bba514ce11a957174732f0, was merged in 9.4.beta0.\n----\nNew commits:",
    "created_at": "2021-05-26T01:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432440",
    "user": "mkoeppe"
}
```

Looks like the earlier version, b06731c29501c81a35bba514ce11a957174732f0, was merged in 9.4.beta0.
----
New commits:



---

archive/issue_comments_432441.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-05-26T01:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432441",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_432442.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2021-05-26T01:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432442",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_432443.json:
```json
{
    "body": "I've put the missing commit on #31860.",
    "created_at": "2021-05-26T01:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432443",
    "user": "mkoeppe"
}
```

I've put the missing commit on #31860.



---

archive/issue_comments_432444.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-26T01:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432444",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_432445.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-05-27T20:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30314",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30314#issuecomment-432445",
    "user": "vbraun"
}
```

Resolution: fixed
