# Issue 28402: Polyhedron_normaliz: Initialize new cone from both Vrep and Hrep

archive/issues_028402.json:
```json
{
    "body": "CC:  @jplab @mkoeppe winfried\n\nKeywords: polyhedron, normaliz\n\nThis ticket implements a method to initialize a cone from vertices, rays, inequations and equalities.\n\nMore precisely\n- we outsource a new method `_cone_from_normaliz_data` from the existing method `_init_from_normaliz_data`.\n- Then we add a method `_cone_from_Vrepresentation_and_Hrepresentation`, which returns a cone form `vertices`, `rays`, `ieqs` and `eqns`.\n\nNote that lines must be recomputed, hence the cone might reorder them.\n\nThe trivial cases of neither rays nor lines or without inequalities are not covered by this method. In either case `None` is returned.\n\nAs a follow up we\n- fix `Polyhedron_normaliz.save` in #26363,\n- we allow converting to `'normaliz'` backend with both Vrep and Hrep in the spirit of #22701.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28639\n\n",
    "closed_at": "2019-12-08T21:19:39Z",
    "created_at": "2019-10-19T20:32:58Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Polyhedron_normaliz: Initialize new cone from both Vrep and Hrep",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28402",
    "user": "https://github.com/kliem"
}
```
CC:  @jplab @mkoeppe winfried

Keywords: polyhedron, normaliz

This ticket implements a method to initialize a cone from vertices, rays, inequations and equalities.

More precisely
- we outsource a new method `_cone_from_normaliz_data` from the existing method `_init_from_normaliz_data`.
- Then we add a method `_cone_from_Vrepresentation_and_Hrepresentation`, which returns a cone form `vertices`, `rays`, `ieqs` and `eqns`.

Note that lines must be recomputed, hence the cone might reorder them.

The trivial cases of neither rays nor lines or without inequalities are not covered by this method. In either case `None` is returned.

As a follow up we
- fix `Polyhedron_normaliz.save` in #26363,
- we allow converting to `'normaliz'` backend with both Vrep and Hrep in the spirit of #22701.

Issue created by migration from https://trac.sagemath.org/ticket/28639





---

archive/issue_comments_400686.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2019-10-19T20:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400686",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_400687.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-10-19T20:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400687",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_400688.json:
```json
{
    "body": "I have set up doctests to test whether the cone is correct. Are there critical/important examples missing there?",
    "created_at": "2019-10-19T20:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400688",
    "user": "https://github.com/kliem"
}
```

I have set up doctests to test whether the cone is correct. Are there critical/important examples missing there?



---

archive/issue_comments_400689.json:
```json
{
    "body": "I'm also a bit puzzled that it states that the equations are not precomputed from the data (see EXAMPLE block in the code). However, not giving the equations will lead to errors.",
    "created_at": "2019-10-19T20:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400689",
    "user": "https://github.com/kliem"
}
```

I'm also a bit puzzled that it states that the equations are not precomputed from the data (see EXAMPLE block in the code). However, not giving the equations will lead to errors.



---

archive/issue_comments_400690.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-21T09:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400691.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-10-21T09:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400691",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_400692.json:
```json
{
    "body": "Minor detail:\n\n```diff\n         - ``vertices`` -- list of point; each point can be specified\n-           as any iterable container of\n-           :meth:`~sage.geometry.polyhedron.base.base_ring` elements\n+          as any iterable container of\n+          :meth:`~sage.geometry.polyhedron.base.base_ring` elements\n```\nAlso, shouldn't `_cone_from_Vrepresentation_and_Hrepresentation` be called from somewhere in the code? Or is this done indirectly through the more general framework?",
    "created_at": "2019-12-01T22:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400692",
    "user": "https://github.com/tscrim"
}
```

Minor detail:

```diff
         - ``vertices`` -- list of point; each point can be specified
-           as any iterable container of
-           :meth:`~sage.geometry.polyhedron.base.base_ring` elements
+          as any iterable container of
+          :meth:`~sage.geometry.polyhedron.base.base_ring` elements
```
Also, shouldn't `_cone_from_Vrepresentation_and_Hrepresentation` be called from somewhere in the code? Or is this done indirectly through the more general framework?



---

archive/issue_comments_400693.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-12-02T08:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400693",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_400694.json:
```json
{
    "body": "I fixed the alignment error and also at the place, where I copied it from.\n\nThe method is not being used yet. I added a branch to #26363, which uses it in order to fix pickling/unpickling.\nInitializing from both `Vrep` and `Hrep` does not work yet. Eventually, we should open a new ticket and allow it at least when converting to backend normaliz.\n\nReplying to [comment:10 tscrim]:\n> Minor detail:\n> \n> ```diff\n>          - ``vertices`` -- list of point; each point can be specified\n> -           as any iterable container of\n> -           :meth:`~sage.geometry.polyhedron.base.base_ring` elements\n> +          as any iterable container of\n> +          :meth:`~sage.geometry.polyhedron.base.base_ring` elements\n> ```\n> Also, shouldn't `_cone_from_Vrepresentation_and_Hrepresentation` be called from somewhere in the code? Or is this done indirectly through the more general framework?",
    "created_at": "2019-12-02T10:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400694",
    "user": "https://github.com/kliem"
}
```

I fixed the alignment error and also at the place, where I copied it from.

The method is not being used yet. I added a branch to #26363, which uses it in order to fix pickling/unpickling.
Initializing from both `Vrep` and `Hrep` does not work yet. Eventually, we should open a new ticket and allow it at least when converting to backend normaliz.

Replying to [comment:10 tscrim]:
> Minor detail:
> 
> ```diff
>          - ``vertices`` -- list of point; each point can be specified
> -           as any iterable container of
> -           :meth:`~sage.geometry.polyhedron.base.base_ring` elements
> +          as any iterable container of
> +          :meth:`~sage.geometry.polyhedron.base.base_ring` elements
> ```
> Also, shouldn't `_cone_from_Vrepresentation_and_Hrepresentation` be called from somewhere in the code? Or is this done indirectly through the more general framework?



---

archive/issue_comments_400695.json:
```json
{
    "body": "Okay. Thanks. Then LGTM.",
    "created_at": "2019-12-03T02:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400695",
    "user": "https://github.com/tscrim"
}
```

Okay. Thanks. Then LGTM.



---

archive/issue_comments_400696.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-03T02:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400696",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_072118.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-08T21:19:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28402#event-72118"
}
```



---

archive/issue_comments_400697.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-08T21:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28402#issuecomment-400697",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
