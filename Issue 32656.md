# Issue 32656: Feature for palp

archive/issues_032656.json:
```json
{
    "body": "CC:  @kliem novoselt slabbe dimpase\n\n`palp` is a standard package, but with modularization that does not mean that everyone has it.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32893\n\n",
    "created_at": "2021-11-18T00:35:02Z",
    "labels": [
        "refactoring",
        "major",
        "enhancement"
    ],
    "title": "Feature for palp",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32656",
    "user": "mkoeppe"
}
```
CC:  @kliem novoselt slabbe dimpase

`palp` is a standard package, but with modularization that does not mean that everyone has it.

Issue created by migration from https://trac.sagemath.org/ticket/32893





---

archive/issue_comments_465863.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-02-22T07:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465863",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_465864.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-02-22T07:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465864",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_465865.json:
```json
{
    "body": "I find such markings ridiculous... If a module is useless without PALP, it would make much more sense to me to mark the module once as optional and not on every single line of examples.\n\nMy random guess is that modules for toric varieties will mostly stop working as well and again it would make much more sense to mark those modules as dependent on PALP and not each line.",
    "created_at": "2022-02-22T17:18:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465865",
    "user": "novoselt"
}
```

I find such markings ridiculous... If a module is useless without PALP, it would make much more sense to me to mark the module once as optional and not on every single line of examples.

My random guess is that modules for toric varieties will mostly stop working as well and again it would make much more sense to mark those modules as dependent on PALP and not each line.



---

archive/issue_comments_465866.json:
```json
{
    "body": "Thanks for the feedback. I wouldn't go so far as to call the module useless. The explicit interaction of the polytope with a lattice in this class is valuable design and code that is not tied to the choice of PALP as a backend.\n\nThere is a lot of duplication / proliferation of incompatible variants among `sage.geometry.lattice_polytope`, `sage.geometry.polyhedron.ppl_lattice_polytope`, `sage.geometry.polyhedron` that is calling for refactoring. To mark which lines of `lattice_polytope` actually depend on `palp` (about 1/3 of the `sage:` lines in this file) was a first step to inform possible such refactoring steps.\n\nMany of the `# optional` markings in tests for `NefPartition` could be avoided by constructing the example explicitly instead of using \n\n```\n        sage: o = lattice_polytope.cross_polytope(3)\n        sage: np = o.nef_partitions()[0]; np                                    # optional - palp\n```\n\nrepeatedly. Would this be agreeable?",
    "created_at": "2022-02-22T17:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465866",
    "user": "mkoeppe"
}
```

Thanks for the feedback. I wouldn't go so far as to call the module useless. The explicit interaction of the polytope with a lattice in this class is valuable design and code that is not tied to the choice of PALP as a backend.

There is a lot of duplication / proliferation of incompatible variants among `sage.geometry.lattice_polytope`, `sage.geometry.polyhedron.ppl_lattice_polytope`, `sage.geometry.polyhedron` that is calling for refactoring. To mark which lines of `lattice_polytope` actually depend on `palp` (about 1/3 of the `sage:` lines in this file) was a first step to inform possible such refactoring steps.

Many of the `# optional` markings in tests for `NefPartition` could be avoided by constructing the example explicitly instead of using 

```
        sage: o = lattice_polytope.cross_polytope(3)
        sage: np = o.nef_partitions()[0]; np                                    # optional - palp
```

repeatedly. Would this be agreeable?



---

archive/issue_comments_465867.json:
```json
{
    "body": "Since I am not doing any work anymore, it is up to the people who do to agree on ;-)",
    "created_at": "2022-02-22T18:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465867",
    "user": "novoselt"
}
```

Since I am not doing any work anymore, it is up to the people who do to agree on ;-)



---

archive/issue_comments_465868.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-22T20:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465868",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_465869.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-02-22T20:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465869",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_465870.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-22T20:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465870",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_465871.json:
```json
{
    "body": "Replying to [comment:6 mkoeppe]:\n>  To mark which lines of `lattice_polytope` actually depend on `palp` (about 1/3 of the `sage:` lines in this file)\n\ndown to less than 1/4 of the lines now",
    "created_at": "2022-02-22T21:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465871",
    "user": "mkoeppe"
}
```

Replying to [comment:6 mkoeppe]:
>  To mark which lines of `lattice_polytope` actually depend on `palp` (about 1/3 of the `sage:` lines in this file)

down to less than 1/4 of the lines now



---

archive/issue_comments_465872.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-22T21:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465872",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_465873.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-22T22:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465873",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_465874.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-23T00:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465874",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_465875.json:
```json
{
    "body": "Doctest failures are unrelated, needs review",
    "created_at": "2022-03-03T01:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465875",
    "user": "mkoeppe"
}
```

Doctest failures are unrelated, needs review



---

archive/issue_comments_465876.json:
```json
{
    "body": "lgtm",
    "created_at": "2022-03-05T10:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465876",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_465877.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-05T10:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465877",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_465878.json:
```json
{
    "body": "Thank you!",
    "created_at": "2022-03-05T18:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465878",
    "user": "mkoeppe"
}
```

Thank you!



---

archive/issue_comments_465879.json:
```json
{
    "body": "Follow-up: #33467",
    "created_at": "2022-03-05T20:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465879",
    "user": "mkoeppe"
}
```

Follow-up: #33467



---

archive/issue_comments_465880.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-03-09T23:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32656",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32656#issuecomment-465880",
    "user": "vbraun"
}
```

Resolution: fixed
