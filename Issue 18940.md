# Issue 18940: Make cluster_seed a new-style spkg

archive/issues_018940.json:
```json
{
    "body": "Assignee: tscrim\n\nCC:  egunawan gmoose05 vbraun jdemeyer stumpc5\n\nWe make the cluster_seed into a new-style database spkg.\n\nIssue created by migration from https://trac.sagemath.org/ticket/19177\n\n",
    "created_at": "2015-09-09T22:24:50Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Make cluster_seed a new-style spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18940",
    "user": "tscrim"
}
```
Assignee: tscrim

CC:  egunawan gmoose05 vbraun jdemeyer stumpc5

We make the cluster_seed into a new-style database spkg.

Issue created by migration from https://trac.sagemath.org/ticket/19177





---

archive/issue_comments_259600.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-09T23:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259600",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_259601.json:
```json
{
    "body": "Is there any place I need to change in the docs/scripts/etc. regarding the optional spkg name, or has that all become automated?\n----\nNew commits:",
    "created_at": "2015-09-09T23:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259601",
    "user": "tscrim"
}
```

Is there any place I need to change in the docs/scripts/etc. regarding the optional spkg name, or has that all become automated?
----
New commits:



---

archive/issue_comments_259602.json:
```json
{
    "body": "Replying to [comment:1 tscrim]:\n> Is there any place I need to change in the docs/scripts/etc. regarding the optional spkg name, or has that all become automated?\n\nNo need to change anything.\n\nJust a few small comments:\n1. is there any doctest or Sage interface to check that the package works?\n2. replace `$SAGE_LOCAL/share` by `$SAGE_SHARE`.\n3. add a file `build/pkgs/database_mutation_class/dependencies` (which could be just saying `# no dependencies`)",
    "created_at": "2015-09-10T12:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259602",
    "user": "jdemeyer"
}
```

Replying to [comment:1 tscrim]:
> Is there any place I need to change in the docs/scripts/etc. regarding the optional spkg name, or has that all become automated?

No need to change anything.

Just a few small comments:
1. is there any doctest or Sage interface to check that the package works?
2. replace `$SAGE_LOCAL/share` by `$SAGE_SHARE`.
3. add a file `build/pkgs/database_mutation_class/dependencies` (which could be just saying `# no dependencies`)



---

archive/issue_comments_259603.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-10T15:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259603",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_259604.json:
```json
{
    "body": "Replying to [comment:2 jdemeyer]:\n> Replying to [comment:1 tscrim]:\n> > Is there any place I need to change in the docs/scripts/etc. regarding the optional spkg name, or has that all become automated?\n> \n> No need to change anything.\n\nThanks for checking.\n\n> Just a few small comments:\n> 1. is there any doctest or Sage interface to check that the package works?\n> 2. replace `$SAGE_LOCAL/share` by `$SAGE_SHARE`.\n> 3. add a file `build/pkgs/database_mutation_class/dependencies` (which could be just saying `# no dependencies`)\n\n1. Yes, but it wasn't very explicit. I made it more so.\n2. Done.\n3. Done. Is this a new thing? Most of the spkg folders don't seem to have one unless they have an actual dependency.",
    "created_at": "2015-09-10T15:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259604",
    "user": "tscrim"
}
```

Replying to [comment:2 jdemeyer]:
> Replying to [comment:1 tscrim]:
> > Is there any place I need to change in the docs/scripts/etc. regarding the optional spkg name, or has that all become automated?
> 
> No need to change anything.

Thanks for checking.

> Just a few small comments:
> 1. is there any doctest or Sage interface to check that the package works?
> 2. replace `$SAGE_LOCAL/share` by `$SAGE_SHARE`.
> 3. add a file `build/pkgs/database_mutation_class/dependencies` (which could be just saying `# no dependencies`)

1. Yes, but it wasn't very explicit. I made it more so.
2. Done.
3. Done. Is this a new thing? Most of the spkg folders don't seem to have one unless they have an actual dependency.



---

archive/issue_comments_259605.json:
```json
{
    "body": "Replying to [comment:4 tscrim]:\n> 3. Done. Is this a new thing?\nWell, it was introduced at the same that `build/pkgs/$PKG/type` was introduced. Which is pretty recent indeed.\n\n> Most of the spkg folders don't seem to have one unless they have an actual dependency.\nIt's not a disaster. The default for optional packages is that they depend on every standard package. It's a safe default, but not really efficient, especially given that `sage -i` will install dependencies soon (#19101).",
    "created_at": "2015-09-10T16:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259605",
    "user": "jdemeyer"
}
```

Replying to [comment:4 tscrim]:
> 3. Done. Is this a new thing?
Well, it was introduced at the same that `build/pkgs/$PKG/type` was introduced. Which is pretty recent indeed.

> Most of the spkg folders don't seem to have one unless they have an actual dependency.
It's not a disaster. The default for optional packages is that they depend on every standard package. It's a safe default, but not really efficient, especially given that `sage -i` will install dependencies soon (#19101).



---

archive/issue_comments_259606.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-10T21:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259606",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_259607.json:
```json
{
    "body": "Where is the package?",
    "created_at": "2015-09-10T21:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259607",
    "user": "jdemeyer"
}
```

Where is the package?



---

archive/issue_comments_259608.json:
```json
{
    "body": "Attachment [database_mutation_class-1.0.tar.gz](tarball://root/attachments/some-uuid/ticket19177/database_mutation_class-1.0.tar.gz) by tscrim created at 2015-09-10 21:40:25",
    "created_at": "2015-09-10T21:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259608",
    "user": "tscrim"
}
```

Attachment [database_mutation_class-1.0.tar.gz](tarball://root/attachments/some-uuid/ticket19177/database_mutation_class-1.0.tar.gz) by tscrim created at 2015-09-10 21:40:25



---

archive/issue_comments_259609.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-10T21:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259609",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_259610.json:
```json
{
    "body": "Whoops, forgot to upload that.",
    "created_at": "2015-09-10T21:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259610",
    "user": "tscrim"
}
```

Whoops, forgot to upload that.



---

archive/issue_comments_259611.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/combinat/cluster_algebra_quiver/mutation_type.py\n**********************************************************************\nFile \"src/sage/combinat/cluster_algebra_quiver/mutation_type.py\", line 1226, in sage.combinat.cluster_algebra_quiver.mutation_type.load_data\nFailed example:\n    load_data(1)\nExpected:\n    {}\nGot:\n    {('A', 1): [('@?', ())]}\n**********************************************************************\nFile \"src/sage/combinat/cluster_algebra_quiver/mutation_type.py\", line 1228, in sage.combinat.cluster_algebra_quiver.mutation_type.load_data\nFailed example:\n    load_data(2) # optional database_mutation_class\nExpected:\n    {('G', 2): [('AO', (((0, 1), (1, -3)),)), ('AO', (((0, 1), (3, -1)),))]}\nGot:\n    {('A', 2): [('AO', ())],\n     ('A', (1, 1), 1): [('AO', (((0, 1), (2, -2)),))],\n     ('B', 2): [('AO', (((0, 1), (1, -2)),)), ('AO', (((0, 1), (2, -1)),))],\n     ('BC', 1, 1): [('AO', (((0, 1), (1, -4)),)), ('AO', (((0, 1), (4, -1)),))],\n     ('G', 2): [('AO', (((0, 1), (1, -3)),)), ('AO', (((0, 1), (3, -1)),))]}\n**********************************************************************\n```\n",
    "created_at": "2015-09-11T06:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259611",
    "user": "jdemeyer"
}
```


```
sage -t --long src/sage/combinat/cluster_algebra_quiver/mutation_type.py
**********************************************************************
File "src/sage/combinat/cluster_algebra_quiver/mutation_type.py", line 1226, in sage.combinat.cluster_algebra_quiver.mutation_type.load_data
Failed example:
    load_data(1)
Expected:
    {}
Got:
    {('A', 1): [('@?', ())]}
**********************************************************************
File "src/sage/combinat/cluster_algebra_quiver/mutation_type.py", line 1228, in sage.combinat.cluster_algebra_quiver.mutation_type.load_data
Failed example:
    load_data(2) # optional database_mutation_class
Expected:
    {('G', 2): [('AO', (((0, 1), (1, -3)),)), ('AO', (((0, 1), (3, -1)),))]}
Got:
    {('A', 2): [('AO', ())],
     ('A', (1, 1), 1): [('AO', (((0, 1), (2, -2)),))],
     ('B', 2): [('AO', (((0, 1), (1, -2)),)), ('AO', (((0, 1), (2, -1)),))],
     ('BC', 1, 1): [('AO', (((0, 1), (1, -4)),)), ('AO', (((0, 1), (4, -1)),))],
     ('G', 2): [('AO', (((0, 1), (1, -3)),)), ('AO', (((0, 1), (3, -1)),))]}
**********************************************************************
```




---

archive/issue_comments_259612.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-11T06:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259612",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_259613.json:
```json
{
    "body": "Also, I get the same doctest output with or without this package, what is going on?",
    "created_at": "2015-09-11T08:23:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259613",
    "user": "jdemeyer"
}
```

Also, I get the same doctest output with or without this package, what is going on?



---

archive/issue_comments_259614.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-11T17:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259614",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_259615.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-11T17:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259615",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_259616.json:
```json
{
    "body": "What is happening is that there is a test in one of the other files which saves some data to your `.sage` folder. This should fix things and isolates the tests specific to the database.\n\nChristian, I'm cc-ing you in case you have any opinions on the name of the database (and to let you know that it is changing).",
    "created_at": "2015-09-11T17:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259616",
    "user": "tscrim"
}
```

What is happening is that there is a test in one of the other files which saves some data to your `.sage` folder. This should fix things and isolates the tests specific to the database.

Christian, I'm cc-ing you in case you have any opinions on the name of the database (and to let you know that it is changing).



---

archive/issue_comments_259617.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-11T18:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259617",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_259618.json:
```json
{
    "body": "Isn't this actually a bug?\n\n```\n# random - depends on the data the user has stored\n```\n\nIf `load_data()` returns essentially random data, how can it be useful?\n\nIt wasn't the test which was broken (hence, no need for `test_database`), the function itself was broken.",
    "created_at": "2015-09-11T18:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259618",
    "user": "jdemeyer"
}
```

Isn't this actually a bug?

```
# random - depends on the data the user has stored
```

If `load_data()` returns essentially random data, how can it be useful?

It wasn't the test which was broken (hence, no need for `test_database`), the function itself was broken.



---

archive/issue_comments_259619.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2015-09-11T18:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259619",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_259620.json:
```json
{
    "body": "I don't consider it as one because it depends on if the user has already stored information for the rank 1 types or not. If the user hasn't computed and saved anything (or installed the database), then there is nothing to load. This is why you were getting the same output before and after, whereas I was getting less data in the output. (It also can't raise an error because it looks in 2 places for file data.)",
    "created_at": "2015-09-11T18:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259620",
    "user": "tscrim"
}
```

I don't consider it as one because it depends on if the user has already stored information for the rank 1 types or not. If the user hasn't computed and saved anything (or installed the database), then there is nothing to load. This is why you were getting the same output before and after, whereas I was getting less data in the output. (It also can't raise an error because it looks in 2 places for file data.)



---

archive/issue_comments_259621.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2015-09-11T18:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259621",
    "user": "tscrim"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_259622.json:
```json
{
    "body": "Replying to [comment:15 tscrim]:\n> I don't consider it as one because it depends on if the user has already stored information for the rank 1 types or not.\nI think it's a bug that it *does* depend on that.\n\nAnyway, I don't care much about this package. I will not set this ticket to needs_work for this, but I also won't set it to positive_review either.",
    "created_at": "2015-09-11T18:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259622",
    "user": "jdemeyer"
}
```

Replying to [comment:15 tscrim]:
> I don't consider it as one because it depends on if the user has already stored information for the rank 1 types or not.
I think it's a bug that it *does* depend on that.

Anyway, I don't care much about this package. I will not set this ticket to needs_work for this, but I also won't set it to positive_review either.



---

archive/issue_comments_259623.json:
```json
{
    "body": "For the patchbot, it is probably better if the tarball url appears in full.",
    "created_at": "2015-09-16T12:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259623",
    "user": "chapoton"
}
```

For the patchbot, it is probably better if the tarball url appears in full.



---

archive/issue_comments_259624.json:
```json
{
    "body": "tested, and good to go",
    "created_at": "2016-04-09T08:41:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259624",
    "user": "chapoton"
}
```

tested, and good to go



---

archive/issue_comments_259625.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-09T08:41:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259625",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_259626.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-10T15:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18940#issuecomment-259626",
    "user": "vbraun"
}
```

Resolution: fixed
