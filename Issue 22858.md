# Issue 22858: autogen/interpreters does NOT work

archive/issues_022858.json:
```json
{
    "body": "CC:  embray jpflori\n\nAfter making a minor change to `src/sage_setup/autogen/interpreters/generator.py`, the change did not take effect. I.e. the generated file `src/sage/ext/interpreters/wrapper_rdf.pyx` did *not* change.\n\nIn particular, the following should cause an error while building the interpreters, but it did not:\n\n```diff\ndiff --git a/src/sage_setup/autogen/interpreters/generator.py b/src/sage_setup/autogen/interpreters/generator.py\nindex 3af99b2..5a3bfbb 100644\n--- a/src/sage_setup/autogen/interpreters/generator.py\n+++ b/src/sage_setup/autogen/interpreters/generator.py\n@@ -316,6 +316,8 @@ class InterpreterGenerator(object):\n             sage: print(buff.getvalue())\n             # Automatically generated by ...\n         \"\"\"\n+        assert False\n+\n         s = self._spec\n         w = write\n         types = set()\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/23095\n\n",
    "created_at": "2017-05-29T12:39:18Z",
    "labels": [
        "build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "autogen/interpreters does NOT work",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22858",
    "user": "jdemeyer"
}
```
CC:  embray jpflori

After making a minor change to `src/sage_setup/autogen/interpreters/generator.py`, the change did not take effect. I.e. the generated file `src/sage/ext/interpreters/wrapper_rdf.pyx` did *not* change.

In particular, the following should cause an error while building the interpreters, but it did not:

```diff
diff --git a/src/sage_setup/autogen/interpreters/generator.py b/src/sage_setup/autogen/interpreters/generator.py
index 3af99b2..5a3bfbb 100644
--- a/src/sage_setup/autogen/interpreters/generator.py
+++ b/src/sage_setup/autogen/interpreters/generator.py
@@ -316,6 +316,8 @@ class InterpreterGenerator(object):
             sage: print(buff.getvalue())
             # Automatically generated by ...
         """
+        assert False
+
         s = self._spec
         w = write
         types = set()
```


Issue created by migration from https://trac.sagemath.org/ticket/23095





---

archive/issue_comments_319608.json:
```json
{
    "body": "I think at some earlier version of this (before it was merged) it did check all source files?  I don't know when it changed.",
    "created_at": "2017-05-29T13:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319608",
    "user": "embray"
}
```

I think at some earlier version of this (before it was merged) it did check all source files?  I don't know when it changed.



---

archive/issue_comments_319609.json:
```json
{
    "body": "I think there was one point where it was `src_files` but in one of the last rebases it got messed up.",
    "created_at": "2017-05-29T13:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319609",
    "user": "embray"
}
```

I think there was one point where it was `src_files` but in one of the last rebases it got messed up.



---

archive/issue_comments_319610.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-29T13:13:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319610",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_319611.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-05-29T13:13:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319611",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_319612.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-05-29T13:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319612",
    "user": "embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_319613.json:
```json
{
    "body": "I'm not sure why you're using `OSError` here.  ~~It doesn't really matter~~ (actually I'd say it does matter--I think a real OSError should be allowed to rise here, or at least be handled separately), but it looks odd.  If the point is just to catch some exception just a generic `Exception` would be fine.  Looks good to me otherwise; sorry for any inconvenience this might have caused.",
    "created_at": "2017-05-29T13:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319613",
    "user": "embray"
}
```

I'm not sure why you're using `OSError` here.  ~~It doesn't really matter~~ (actually I'd say it does matter--I think a real OSError should be allowed to rise here, or at least be handled separately), but it looks odd.  If the point is just to catch some exception just a generic `Exception` would be fine.  Looks good to me otherwise; sorry for any inconvenience this might have caused.



---

archive/issue_comments_319614.json:
```json
{
    "body": "At first, I created a separate exception class for this (say `class NeedToRebuild(Exception)`). But then I realized that it would be good to catch `OSError` too since there are various system calls in that block of code which could potentially `raise OSError`. Since this is only in determining whether to rebuild, I figured that it shouldn't be a fatal error.",
    "created_at": "2017-05-29T14:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319614",
    "user": "jdemeyer"
}
```

At first, I created a separate exception class for this (say `class NeedToRebuild(Exception)`). But then I realized that it would be good to catch `OSError` too since there are various system calls in that block of code which could potentially `raise OSError`. Since this is only in determining whether to rebuild, I figured that it shouldn't be a fatal error.



---

archive/issue_comments_319615.json:
```json
{
    "body": "I get that--I guess it doesn't need to be a fatal error then, but at least some more explanation surrounding an actual `OSError` would be good (just like \"checking if rebuild needed failed: <actual error>\").",
    "created_at": "2017-05-29T16:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319615",
    "user": "embray"
}
```

I get that--I guess it doesn't need to be a fatal error then, but at least some more explanation surrounding an actual `OSError` would be good (just like "checking if rebuild needed failed: <actual error>").



---

archive/issue_comments_319616.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-30T15:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319616",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_319617.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-30T15:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319617",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319618.json:
```json
{
    "body": "I don't want to make this more complicated than it needs to be. This is reverting to my original idea.",
    "created_at": "2017-05-30T15:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319618",
    "user": "jdemeyer"
}
```

I don't want to make this more complicated than it needs to be. This is reverting to my original idea.



---

archive/issue_comments_319619.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-31T10:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319619",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_319620.json:
```json
{
    "body": "Okay, seems fine.",
    "created_at": "2017-05-31T10:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319620",
    "user": "embray"
}
```

Okay, seems fine.



---

archive/issue_comments_319621.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-04T10:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22858#issuecomment-319621",
    "user": "vbraun"
}
```

Resolution: fixed
