# Issue 12516: Span method allows setting incompatible base ring, despite 'check=True'

Issue created by migration from Trac.

Original creator: rbeezer

Original creation time: 2012-03-18 18:20:53

Assignee: jason, was

CC:  novoselt

I discovered this while working on #12541.  Documentation says the `check` will "coerce entries of gens into base field."  This does not appear to be happening, and should.  

First example is the root problem - second just shows that the `check` flag seems ineffectual.  I haven't looked at the code yet.


```
sage: (QQ^2).span(gens=[vector(QQ, [1,1/2])], base_ring=ZZ, check=True)
Free module of degree 2 and rank 1 over Integer Ring
Echelon basis matrix:
[  1 1/2]
sage: (QQ^2).span(gens=[vector(QQ, [1,1/2])], base_ring=ZZ, check=False)
Free module of degree 2 and rank 1 over Integer Ring
Echelon basis matrix:
[  1 1/2]
```



---

Comment by rbeezer created at 2012-03-18 19:14:47

Changing priority from major to minor.


---

Comment by rbeezer created at 2012-03-18 19:14:47

Changing type from defect to enhancement.


---

Comment by rbeezer created at 2012-03-18 19:14:47

See some discussion on #12541.


---

Attachment


---

Comment by rbeezer created at 2012-03-19 05:24:00

Changing status from new to needs_review.


---

Comment by rbeezer created at 2012-03-19 05:24:00

Changing keywords from "" to "rd2".


---

Comment by rbeezer created at 2012-03-19 05:24:00

Patch is documentation only.  More thorough, and more in keeping with current documentation standards.


---

Comment by novoselt created at 2012-03-19 14:34:29

I'll look at it today/tomorrow if nobody beats me.

A side remark (for probably the next ticket?): while working on #12541 I had to fix several pieces of code that looked almost the same. In fact, I have removed exactly the same *wrong* lines from six places or so in different specializations of free modules. Perhaps these `span` and `submodule` methods can be somehow consolidated, e.g. have `span` only in the base class which calls `_span` of subclasses for actual work after all the typechecking and conversion. Or, if it is really necessary to have them everywhere, maybe there can be only 1 or 2 good long docstrings, as the one provided by Rob here, and others should just link to it?


---

Comment by novoselt created at 2012-03-19 21:45:15

Little picks:
 * "INPUTS" should be without "S" according to guidelines.
 * There also should be "OUTPUT" and perhaps it can precisely state here where the resulting submodule lives.

Otherwise looks good to me!


---

Comment by novoselt created at 2012-03-19 21:45:15

Changing status from needs_review to needs_work.


---

Comment by rbeezer created at 2012-03-22 04:31:18

Replying to [comment:5 novoselt]:
> Little picks:
>  * "INPUTS" should be without "S" according to guidelines.
>  * There also should be "OUTPUT" and perhaps it can precisely state here where the resulting submodule lives.


Thanks, Andrey.  I forget these in my rush to wrap it up.  I'll get an updated patch up soon, but it might be a couple days.

Rob


---

Comment by rbeezer created at 2012-03-22 04:41:08

Replying to [comment:4 novoselt]:
>  Perhaps these `span` and `submodule` methods can be somehow consolidated

I have not looked, but it would not surprise me if there was some beneficial consolidation.  Maybe at Bug Days in a few weeks I'll tackle this one.

Rob


---

Comment by novoselt created at 2012-03-22 04:43:59

Replying to [comment:7 rbeezer]:
> Replying to [comment:4 novoselt]:
> >  Perhaps these `span` and `submodule` methods can be somehow consolidated
> 
> I have not looked, but it would not surprise me if there was some beneficial consolidation.  Maybe at Bug Days in a few weeks I'll tackle this one.
> 
> Rob

Great, I'll be there too ;-)


---

Comment by novoselt created at 2012-05-25 00:10:34

Changing keywords from "rd2" to "rd2, sd40.5".


---

Comment by novoselt created at 2012-05-25 00:10:34

http://trac.sagemath.org/sage_trac/ticket/12688#comment:5 is still valid ;-)


---

Attachment

Address reviewer comments


---

Comment by rbeezer created at 2012-05-25 18:13:21

Changing status from needs_work to needs_review.


---

Comment by rbeezer created at 2012-05-25 18:13:21

Replying to [comment:5 novoselt]:

Thanks again - comments addressed in "update" patch.

Rob

> Little picks:
>  * "INPUTS" should be without "S" according to guidelines.
>  * There also should be "OUTPUT" and perhaps it can precisely state here where the resulting submodule lives.
> 
> Otherwise looks good to me!


---

Comment by novoselt created at 2012-05-26 19:54:13

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-06-18 10:23:34

Resolution: fixed
