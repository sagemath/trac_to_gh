# Issue 21579: The Sage kernel can no longer be used from system's notebook

Issue created by migration from Trac.

Original creator: charpent

Original creation time: 2016-11-04 14:17:53

CC:  chapoton

Keywords: notebook jupyter

A system Jupyter installation where Sage specific files have been symlinked as discussed [here](https://groups.google.com/forum/#!topic/sage-support/hRR5rpv1u7U) recently ceased to be able to use the R kernel.

Relevant lines seen in console :

```
charpent`@`SAP5057241:~$ jupyter notebook
[I 14:47:25.113 NotebookApp] Serving notebooks from local directory: /home/charpent
[I 14:47:25.113 NotebookApp] 0 active kernels 
[I 14:47:25.113 NotebookApp] The Jupyter Notebook is running at: http://localhost:8888/
[I 14:47:25.113 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).

[ ... ]

[I 14:47:30.601 NotebookApp] Creating new notebook in 
[I 14:47:31.913 NotebookApp] Kernel started: 7445d8ca-a4d1-44dc-b09f-a2aa328e2115
Error: You must set the SAGE_ROOT environment variable or run this
script from the SAGE_ROOT or SAGE_ROOT/local/bin/ directory.
Error setting environment variables by sourcing '/usr/local/sage-7/local/bin/sage-env';
possibly contact sage-devel (see http://groups.google.com/group/sage-devel).
[I 14:47:34.915 NotebookApp] KernelRestarter: restarting kernel (1/5)
Error: You must set the SAGE_ROOT environment variable or run this
script from the SAGE_ROOT or SAGE_ROOT/local/bin/ directory.
Error setting environment variables by sourcing '/usr/local/sage-7/local/bin/sage-env';
possibly contact sage-devel (see http://groups.google.com/group/sage-devel).
[I 14:47:37.921 NotebookApp] KernelRestarter: restarting kernel (2/5)

[ etc... a dozen times ]
```


The `restarting` loop stops when an error messagebox appears and I select not to restart...

Workaround :

```
charpent`@`SAP5057241:~$ SAGE_ROOT=/usr/local/sage jupyter notebook
[I 14:49:04.818 NotebookApp] Serving notebooks from local directory: /home/charpent
[I 14:49:04.818 NotebookApp] 0 active kernels 
[I 14:49:04.818 NotebookApp] The Jupyter Notebook is running at: http://localhost:8888/
[I 14:49:04.818 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).

[ ... ]

[I 14:49:10.499 NotebookApp] Creating new notebook in 
[I 14:49:11.770 NotebookApp] Kernel started: 808ec2be-d2ae-40c5-a518-3747ea1c36dd
Warning: overwriting SAGE_ROOT environment variable:
Old SAGE_ROOT=/usr/local/sage
New SAGE_ROOT=/usr/local/sage-7

```


Note that on my system, `/usr/local/sage` is a symlink to `/usr/local/sage-7`.

This is but a minor annoyance inmy case, but might be a symptom ome something more serious, possibly hampering other uses.


---

Comment by mkoeppe created at 2020-08-17 03:24:34

Likely outdated, and #30306 tracks the tasks of making Sage speak to system Jupyter


---

Comment by mkoeppe created at 2020-08-17 03:24:34

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-09-21 19:25:14

Resolution: invalid
