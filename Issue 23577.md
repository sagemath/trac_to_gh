# Issue 23577: Fix is_preperiodic function domain check

Issue created by migration from https://trac.sagemath.org/ticket/23814

Original creator: paulfili

Original creation time: 2017-09-09 18:04:05

CC:  bhutz

Currently, if we define a DynamicalSystem_projective without specifying the underlying domain (which is probably the most likely way the user will do this), the init function recreates the underlying projective space. As a result, any function that checks if the domain of a point "is" the domain of the map will fail, as is_preperiodic currently does:

```python
sage: R.<X> = PolynomialRing(QQ)
sage: K.<a> = NumberField(X^2 + X - 1)
sage: P.<x,y> = ProjectiveSpace(K,1)
sage: f = DynamicalSystem_projective([x^2-2*y^2, y^2])
sage: Q = P.point([a,1])
sage: f.nth_iterate(Q,2) == Q
True
sage: Q.is_preperiodic(f)
Traceback (most recent call last):
...
TypeError: point must be in domain of map
sage: f.domain() is P
False
sage: f.domain() == P # It's basically the same but the space is not uniquely represented in memory
True
```

Instead, is_preperiodic should be using == to check that the domains are equivalent, rather than exactly the same under "is", and then things will work as expected. This fix changes that.


---

Comment by paulfili created at 2017-09-09 18:12:34

Last 10 new commits:


---

Comment by paulfili created at 2017-09-09 18:12:34

Changing status from new to needs_review.


---

Comment by bhutz created at 2017-09-09 18:43:05

Changing status from needs_review to positive_review.


---

Comment by bhutz created at 2017-09-09 18:43:05

Looks fine. Just fixed a minor typo.
----
New commits:


---

Comment by bhutz created at 2017-09-11 23:40:20

merge conflict


---

Comment by bhutz created at 2017-09-11 23:40:20

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-09-11 23:43:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2017-09-11 23:44:16

fixed


---

Comment by bhutz created at 2017-09-11 23:44:16

Changing status from needs_work to needs_review.


---

Comment by paulfili created at 2017-09-18 18:58:15

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-09-24 13:03:51

Resolution: fixed
