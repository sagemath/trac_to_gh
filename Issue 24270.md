# Issue 24270: py3: minor fixes to sage.libs.pynac

Issue created by migration from https://trac.sagemath.org/ticket/24507

Original creator: embray

Original creation time: 2018-01-10 13:27:47

CC:  jdemeyer

This builds on top of a few existing fixes from #24223 and adds the remaining fixes I needed for all the tests in `sage.libs.pynac` to pass.


---

Comment by chapoton created at 2018-02-12 13:47:36

Changing status from new to needs_info.


---

Comment by chapoton created at 2018-02-12 13:47:36

is this ready for review ?
----
New commits:


---

Comment by git created at 2018-02-12 14:04:10

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2018-02-12 15:10:56

Changing status from needs_info to needs_work.


---

Comment by embray created at 2018-02-12 15:13:35

Let me simply rebase this.  Also, I think some of the `# py2` flags this added to some tests are unnecessary with #24559


---

Comment by embray created at 2018-02-12 15:25:14

Changing status from needs_work to needs_review.


---

Comment by embray created at 2018-02-12 15:25:14

Cleaned this up and rebased it.

Removed `# py2` flags in tests; indeed #24559 will make this unnecessary.
----
New commits:


---

Comment by chapoton created at 2018-02-13 07:30:21

Looks good to me. But is it normal to use sometimes "in integer_types" and sometimes "isinstance" ?

Jeroen, any comment ?


---

Comment by jdemeyer created at 2018-02-13 08:35:03

In a Cython file, I would avoid `six.integer_types`. Cython understands `int` and `long` and it's also going to be more efficient.


---

Comment by jdemeyer created at 2018-02-13 08:35:03

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-02-13 10:55:07

ok, done
----
New commits:


---

Comment by chapoton created at 2018-02-13 10:55:07

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-02-14 08:46:07

green bot


---

Comment by jdemeyer created at 2018-02-14 10:49:44

Replying to [comment:7 chapoton]:
> But is it normal to use sometimes "in integer_types" and sometimes "isinstance" ?

I also wonder why it is done that way. Typically, it is considered better style to use `isinstance` instead of comparing types directly.


---

Comment by jdemeyer created at 2018-02-14 10:56:12

By the way, the earliest of those exact type checks go back to #5930.


---

Comment by git created at 2018-02-14 11:12:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2018-02-14 11:27:13

OK, this commit uses `isinstance()` where it makes sense to do so.


---

Comment by chapoton created at 2018-02-14 14:34:42

okay, looks good to me. Jeroen, please set to positive if you agree.


---

Comment by jdemeyer created at 2018-02-14 14:47:10

Changing status from needs_review to positive_review.


---

Comment by embray created at 2018-02-14 15:14:14

I had just left it as exact because, well, that's what it was. I didn't look too closely at the context. Exact type checks are much faster where applicable.


---

Comment by embray created at 2018-02-14 15:17:09

For things like this:

```
if type(x) in [int, long]
```

use tuples instead of lists.


---

Comment by embray created at 2018-02-14 15:17:09

Changing status from positive_review to needs_work.


---

Comment by chapoton created at 2018-02-14 15:17:55

There is no longer any such thing, Erik..


---

Comment by embray created at 2018-02-14 15:19:38

Changing status from needs_work to positive_review.


---

Comment by embray created at 2018-02-14 15:19:38

My mistake, I was looking at an old commit.  For some reason git.sagemath.org is being extremely slow right now.


---

Comment by jdemeyer created at 2018-02-14 15:21:22

Replying to [comment:19 embray]:
> For things like this:
> {{{
> if type(x) in [int, long]
> }}}
> use tuples instead of lists.

In Cython, it doesn't matter. Cython optimizes that anyway to `t = type(x); t == int or t == long`.


---

Comment by vbraun created at 2018-02-16 23:38:50

Resolution: fixed
