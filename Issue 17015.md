# Issue 17015: bug fix in StrongTableaux.marked_CST_to_transposition_sequence

Issue created by migration from Trac.

Original creator: zabrocki

Original creation time: 2014-10-29 13:50:34

CC:  aschilling tscrim

Anne Schilling pointed out the following error in the algorithm to convert a strong marked column strict tableau to a sequence of transpositions:

```
sage: StrongTableaux.marked_CST_to_transposition_sequence([[-1,-2,-2,-2,-2],[-2,2],[2]],3)
[[4, 5], [3, 4], [2, 4], [2, 3], [1, 2], [0, 1]]
```

however the answer should be `[[4,5],[3,4],[2,3],[1,2],[-1,0],[0,1]]` and the problem arises because it was never clear in the algorithm for converting a marked column strict tableau into a sequence of transpositions what conditions I need to check to make sure I was applying a valid transposition.  In fact, there was a comment in the code that indicated my worry that one might be able to apply two transpositions and reduce the length by 1.

This is exactly what happens in this case because if you apply the sequence of transpositions t_{2,4} on t_{3,4} t_{4,5} T then in fact t_{2,4} does reduce the length of shape of the tableau by 1, but there are no cells of content 2 and 3 in the tableau t_{3,4} t_{4,5} T.

It looks like there are a couple of ways of catching this condition.  It might be sufficient to check that applying the transposition t_{2,4} is not valid (because it really should be applying t_{-2,0} instead).  That fix might or might not be sufficient (and a counterexample will be difficult to identify).  To be more thorough, I will verify that if t_{ij} decreases the length of the core by 1, then the labels of the cells in range(i,j) that are removed include exactly one negative label.


---

Comment by zabrocki created at 2014-10-29 14:58:48

New commits:


---

Comment by zabrocki created at 2014-10-29 15:03:24

Changing status from new to needs_review.


---

Comment by zabrocki created at 2014-10-29 16:06:39

More testing shows that checking the conditions in the ribbon is not sufficient.

Example:
Let
`T = [[-1, -2, -5, 5, -5, 5, -5], [-3, -4, 5, 5], [5]]`
if you apply the transposition t_{6,7} to T then the shape will be `[6,3]` leaving
`[[-1, -2, -5, 5, -5, 5], [-3, -4, 5]]`
and the marking is in cell (0,6) as hoped
if you apply the transposition t_{5,7} to T then the shape will be` [5,2,1]` leaving
`[[-1, -2, -5, 5, -5], [-3, -4], [5]]`

The markings in both cases are correct, but the right transposition to apply is the t_{5,7}.

The only way reason why you don't want to apply the t_{6,7} is just because no corner cell of t_{6,7} T has a marking.  But I can only hope that checking this catches all cases.


---

Comment by zabrocki created at 2014-10-29 16:06:39

Changing status from needs_review to needs_work.


---

Comment by zabrocki created at 2014-10-29 17:04:38

Testing if one of the corner cells has a mark is not sufficient because it could be that the next ribbon to remove is of shape (1,1) and the marked cell will not be on a corner.

I am coming to the conclusion that the test will need to be recursive.  That is, the transposition sequence begins in t_{ij} if t_{ij} is a removable ribbon and if t_{ij} T has a transposition sequence which reduces it to empty.


---

Comment by git created at 2014-10-29 19:48:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-10-29 20:29:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2014-10-29 21:04:02

I've been testing these functions and don't see any obvious change in speed, and this does seem to completely fix the bug.

The solution that I have posted is to make the function which converts a column strict marked tableau into a sequence of transpositions recursive.  The solution is to say that the transposition sequence which reduces a tableau T of shape \gamma to empty begins with t_{ij} if the cells of content j is negative -v and the other labels of are v (and this is what was being done before) and t_{ij} T can be reduced to an empty tableau (and this part is new).

I had to add this second condition because it seems that we can't decide if applying t_{ij} to a column strict marked tableau yields a valid column strict marked tableau just by looking it in any obvious way.  Examples need to be pretty large before this bug was triggered.


---

Comment by zabrocki created at 2014-10-29 21:04:02

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-10-29 21:44:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-10-30 05:17:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aschilling created at 2014-10-30 05:21:39

Hi Mike,

Thanks for the quick fix of this issue! I rebased the branch on top of the latest development version of Sage and will run some more tests.

Best,

Anne


---

Comment by aschilling created at 2014-10-30 05:22:08

Changing priority from minor to major.


---

Comment by aschilling created at 2014-10-30 05:22:08

Changing keywords from "" to "tableaux".


---

Comment by aschilling created at 2014-10-30 06:09:50

Looks good now!

Anne


---

Comment by aschilling created at 2014-10-30 06:10:01

Changing status from needs_review to positive_review.


---

Comment by zabrocki created at 2014-10-30 13:21:05

Thanks for reviewing and finding the bug.
-Mike


---

Comment by vbraun created at 2014-10-30 22:28:38

Resolution: fixed
