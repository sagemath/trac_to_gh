# Issue 28602: adding a minimal lgtm.yml file

Issue created by migration from https://trac.sagemath.org/ticket/28839

Original creator: chapoton

Original creation time: 2019-12-04 09:25:03

CC:  tscrim fbissey embray vbraun

This will tell LGTM to use Python3 during its code analysis.


---

Comment by chapoton created at 2019-12-04 09:25:29

New commits:


---

Comment by chapoton created at 2019-12-04 09:25:29

Changing status from new to needs_review.


---

Comment by fbissey created at 2019-12-04 09:36:11

That looks interesting.


---

Comment by chapoton created at 2019-12-04 09:41:59

The reports can be found here:

https://lgtm.com/projects/g/sagemath/sage/?mode=list

but the problem is that it only runs when "master" branch is updated..


---

Comment by embray created at 2019-12-04 14:06:06

I wonder if there is a setting to change the branch to track.


---

Comment by chapoton created at 2019-12-04 14:10:01

the only way seems to be : change our main branch on github to be "develop"


---

Comment by embray created at 2019-12-04 14:16:44

Replying to [comment:5 embray]:
> I wonder if there is a setting to change the branch to track.

ISTM that LGTM is reading from the [GitHub](GitHub) mirror of our repo, so I just need to change its default branch to the develop branch.  I don't *think* there will be any consequences to doing so, so I'll go ahead and do that.


---

Comment by embray created at 2019-12-04 14:34:17

I'm looking at this site, and while many of the alerts look useful, a great many of the "errors" reported are due to supposedly incorrect arguments to a class's `__init__`, except their analysis is not clever enough to consider classes which have a metaclass with a custom `__call__` (e.g. our `ClasscallMetaclass` which is used all over the place).

So perhaps while we're adding this file it might be helpful to globally exclude this and related errors as explained [here](https://help.semmle.com/lgtm-enterprise/user/help/showing-hiding-query-results.html).  For example, from what I'm seeing in the errors, we want at least:


```
queries:
    - exclude: py/call/wrong-named-class-argument
    - exclude: py/call/wrong-number-class-arguments
```


Of course, we can also suppress alerts on individual lines, but these two are so pervasive it would not be practical.  Suppressing them globally unfortunately could hide legitimate errors, though these errors are likely to be caught by tests in most cases.


---

Comment by git created at 2019-12-04 14:37:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-12-04 14:37:30

indeed. Done


---

Comment by embray created at 2019-12-04 14:51:11

Heh, actually it turns out the _actual_ majority of errors are of the class [py/unsafe-cyclic-import](https://lgtm.com/rules/3970092/).  We should probably globally disable that one as well :)


---

Comment by embray created at 2019-12-04 14:52:27

If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.


---

Comment by git created at 2019-12-04 14:53:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by embray created at 2019-12-04 14:53:21

Turns out there was already a recent [issue](https://github.com/Semmle/ql/issues/2445#issuecomment-561678026) for false positives due to custom metaclass `__call__`s.  I added some examples to it.
----
New commits:


---

Comment by embray created at 2019-12-04 14:55:40

Replying to [comment:12 embray]:
> If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.

LGTM :)

Though please consider either squashing your commits and/or adding some more details or link to this ticket.  "adding stuff to this file for no apparent reason"-type commit messages are not helpful :(


---

Comment by embray created at 2019-12-04 14:55:40

Changing status from needs_review to positive_review.


---

Comment by git created at 2019-12-04 14:59:41

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:


---

Comment by git created at 2019-12-04 14:59:41

Changing status from positive_review to needs_review.


---

Comment by chapoton created at 2019-12-04 15:00:01

ok, better like that ?


---

Comment by chapoton created at 2019-12-04 15:05:43

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-12-05 12:03:57

Thank you!


---

Comment by vbraun created at 2019-12-08 21:19:24

Resolution: fixed
