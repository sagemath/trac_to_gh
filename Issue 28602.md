# Issue 28602: adding a minimal lgtm.yml file

archive/issues_028602.json:
```json
{
    "body": "CC:  @tscrim @kiwifb @embray @vbraun\n\nThis will tell LGTM to use Python3 during its code analysis.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28839\n\n",
    "created_at": "2019-12-04T09:25:03Z",
    "labels": [
        "scripts",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "adding a minimal lgtm.yml file",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28602",
    "user": "@fchapoton"
}
```
CC:  @tscrim @kiwifb @embray @vbraun

This will tell LGTM to use Python3 during its code analysis.

Issue created by migration from https://trac.sagemath.org/ticket/28839





---

archive/issue_comments_403740.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-12-04T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403740",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_403741.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-12-04T09:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403741",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_403742.json:
```json
{
    "body": "That looks interesting.",
    "created_at": "2019-12-04T09:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403742",
    "user": "@kiwifb"
}
```

That looks interesting.



---

archive/issue_comments_403743.json:
```json
{
    "body": "The reports can be found here:\n\nhttps://lgtm.com/projects/g/sagemath/sage/?mode=list\n\nbut the problem is that it only runs when \"master\" branch is updated..",
    "created_at": "2019-12-04T09:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403743",
    "user": "@fchapoton"
}
```

The reports can be found here:

https://lgtm.com/projects/g/sagemath/sage/?mode=list

but the problem is that it only runs when "master" branch is updated..



---

archive/issue_comments_403744.json:
```json
{
    "body": "I wonder if there is a setting to change the branch to track.",
    "created_at": "2019-12-04T14:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403744",
    "user": "@embray"
}
```

I wonder if there is a setting to change the branch to track.



---

archive/issue_comments_403745.json:
```json
{
    "body": "the only way seems to be : change our main branch on github to be \"develop\"",
    "created_at": "2019-12-04T14:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403745",
    "user": "@fchapoton"
}
```

the only way seems to be : change our main branch on github to be "develop"



---

archive/issue_comments_403746.json:
```json
{
    "body": "Replying to [comment:5 embray]:\n> I wonder if there is a setting to change the branch to track.\n\nISTM that LGTM is reading from the [GitHub](GitHub) mirror of our repo, so I just need to change its default branch to the develop branch.  I don't *think* there will be any consequences to doing so, so I'll go ahead and do that.",
    "created_at": "2019-12-04T14:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403746",
    "user": "@embray"
}
```

Replying to [comment:5 embray]:
> I wonder if there is a setting to change the branch to track.

ISTM that LGTM is reading from the [GitHub](GitHub) mirror of our repo, so I just need to change its default branch to the develop branch.  I don't *think* there will be any consequences to doing so, so I'll go ahead and do that.



---

archive/issue_comments_403747.json:
```json
{
    "body": "I'm looking at this site, and while many of the alerts look useful, a great many of the \"errors\" reported are due to supposedly incorrect arguments to a class's `__init__`, except their analysis is not clever enough to consider classes which have a metaclass with a custom `__call__` (e.g. our `ClasscallMetaclass` which is used all over the place).\n\nSo perhaps while we're adding this file it might be helpful to globally exclude this and related errors as explained [here](https://help.semmle.com/lgtm-enterprise/user/help/showing-hiding-query-results.html).  For example, from what I'm seeing in the errors, we want at least:\n\n\n```\nqueries:\n    - exclude: py/call/wrong-named-class-argument\n    - exclude: py/call/wrong-number-class-arguments\n```\n\n\nOf course, we can also suppress alerts on individual lines, but these two are so pervasive it would not be practical.  Suppressing them globally unfortunately could hide legitimate errors, though these errors are likely to be caught by tests in most cases.",
    "created_at": "2019-12-04T14:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403747",
    "user": "@embray"
}
```

I'm looking at this site, and while many of the alerts look useful, a great many of the "errors" reported are due to supposedly incorrect arguments to a class's `__init__`, except their analysis is not clever enough to consider classes which have a metaclass with a custom `__call__` (e.g. our `ClasscallMetaclass` which is used all over the place).

So perhaps while we're adding this file it might be helpful to globally exclude this and related errors as explained [here](https://help.semmle.com/lgtm-enterprise/user/help/showing-hiding-query-results.html).  For example, from what I'm seeing in the errors, we want at least:


```
queries:
    - exclude: py/call/wrong-named-class-argument
    - exclude: py/call/wrong-number-class-arguments
```


Of course, we can also suppress alerts on individual lines, but these two are so pervasive it would not be practical.  Suppressing them globally unfortunately could hide legitimate errors, though these errors are likely to be caught by tests in most cases.



---

archive/issue_comments_403748.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-04T14:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403748",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_403749.json:
```json
{
    "body": "indeed. Done",
    "created_at": "2019-12-04T14:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403749",
    "user": "@fchapoton"
}
```

indeed. Done



---

archive/issue_comments_403750.json:
```json
{
    "body": "Heh, actually it turns out the *actual* majority of errors are of the class [py/unsafe-cyclic-import](https://lgtm.com/rules/3970092/).  We should probably globally disable that one as well :)",
    "created_at": "2019-12-04T14:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403750",
    "user": "@embray"
}
```

Heh, actually it turns out the *actual* majority of errors are of the class [py/unsafe-cyclic-import](https://lgtm.com/rules/3970092/).  We should probably globally disable that one as well :)



---

archive/issue_comments_403751.json:
```json
{
    "body": "If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.",
    "created_at": "2019-12-04T14:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403751",
    "user": "@embray"
}
```

If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.



---

archive/issue_comments_403752.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-04T14:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403752",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_403753.json:
```json
{
    "body": "Turns out there was already a recent [issue](https://github.com/Semmle/ql/issues/2445#issuecomment-561678026) for false positives due to custom metaclass `__call__`s.  I added some examples to it.\n----\nNew commits:",
    "created_at": "2019-12-04T14:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403753",
    "user": "@embray"
}
```

Turns out there was already a recent [issue](https://github.com/Semmle/ql/issues/2445#issuecomment-561678026) for false positives due to custom metaclass `__call__`s.  I added some examples to it.
----
New commits:



---

archive/issue_comments_403754.json:
```json
{
    "body": "Replying to [comment:12 embray]:\n> If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.\n\nLGTM :)\n\nThough please consider either squashing your commits and/or adding some more details or link to this ticket.  \"adding stuff to this file for no apparent reason\"-type commit messages are not helpful :(",
    "created_at": "2019-12-04T14:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403754",
    "user": "@embray"
}
```

Replying to [comment:12 embray]:
> If you add that too, can you please also include in your commit message a link to this discussion so that it's clearer why it was added.

LGTM :)

Though please consider either squashing your commits and/or adding some more details or link to this ticket.  "adding stuff to this file for no apparent reason"-type commit messages are not helpful :(



---

archive/issue_comments_403755.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-04T14:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403755",
    "user": "@embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_403756.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2019-12-04T14:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403756",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_403757.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-12-04T14:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403757",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_403758.json:
```json
{
    "body": "ok, better like that ?",
    "created_at": "2019-12-04T15:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403758",
    "user": "@fchapoton"
}
```

ok, better like that ?



---

archive/issue_comments_403759.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-04T15:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403759",
    "user": "@fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_403760.json:
```json
{
    "body": "Thank you!",
    "created_at": "2019-12-05T12:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403760",
    "user": "@embray"
}
```

Thank you!



---

archive/issue_comments_403761.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-08T21:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28602#issuecomment-403761",
    "user": "@vbraun"
}
```

Resolution: fixed
