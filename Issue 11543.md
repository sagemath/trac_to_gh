# Issue 11543: Upgrade matrix set_row() and set_column()

Issue created by migration from https://trac.sagemath.org/ticket/11715

Original creator: rbeezer

Original creation time: 2011-08-22 19:23:00

Assignee: jason, was

CC:  jason hds

I thought the previous error message for `set_row()` about lists of entries being the wrong length was a bit vague, since it just referenced "v", which does not even need to be a vector.

So while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.


---

Comment by rbeezer created at 2011-08-22 19:27:07

Changing keywords from "" to "beginner".


---

Comment by rbeezer created at 2011-08-22 19:27:07

Changing status from new to needs_review.


---

Comment by rbeezer created at 2011-08-25 19:02:36

Changing keywords from "beginner" to "beginner, sd32".


---

Comment by davidloeffler created at 2012-03-25 15:11:50

Changing status from needs_review to needs_work.


---

Comment by davidloeffler created at 2012-03-25 15:11:50

The following extract from the patch isn't valid Sphinx formatting (the first :: should be a single :)

```
1617	1626	        EXAMPLES:: 
 	1627	         
 	1628	        New entries may be contained in a vector.  :: 
```


There are a couple of these in the patch, see the output of "plugins.docbuild" in the patchbot logs.


---

Comment by hds created at 2013-02-12 13:04:02

I've updated Rob's patch file to fix the doc errors (I'm pretty sure there were just two). You only need to apply the new patch.


---

Comment by hds created at 2013-02-12 13:04:02

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2013-02-12 16:47:28

Well, here is the punishment for these good deeds.

Namely, if we're going to upgrade this documentation, we should probably also upgrade it to have tests for other things.  Before there was no excuse, but now we should just do it all.

```
sage: A = matrix([[1, 2], [3, 4]]); A
[1 2]
[3 4]
sage: A.set_row(1,[.1,3])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<snip>
TypeError: Attempt to coerce non-integral RealNumber to Integer
```

Etc.  

We should catch such errors and return a slightly more informative error message, just as we do with the wrong length list or wrong index, e.g. `TypeError: new row must have all elements in original ring.`  Unless we want to allow this and do an implicit `change_ring`?  Probably we should have an error message like in the doc for `A.set_col_to_multiple_of_col?`.


----

Minor comment - `TESTS:` needs two colons.


---

Comment by kcrisman created at 2013-02-12 16:48:18

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2013-02-12 16:48:18

hds - can you put your real name under reviewers?  You don't show up on the list at [the main Trac page](http://trac.sagemath.org/sage_trac/).


---

Comment by hds created at 2013-02-12 18:22:35

I added my name under reviewers, and on the main Trac page (hadn't done that yet as I only got the trac account today). Meanwhile, I'll look at some more informative errors for these coercion cases and such.


---

Comment by hds created at 2013-02-13 11:07:18

Updated set_row() and set_column for better error handling / reporting


---

Comment by hds created at 2013-02-13 11:10:22

Changing status from needs_work to needs_review.


---

Attachment

I've added error handling for TypeErrors that gives a more useful exception, suggesting that change_ring be used on the matrix first if the user wishes to set a row or column with elements from another ring.


```
sage: A = matrix(2, [1, 2, 3, 4])
sage: A.set_row(0, [1/3, 1]); A
Traceback (most recent call last):
...
TypeError: Cannot set row with Rational Field elements over Integer Ring, use change_ring first.
```



---

Comment by kcrisman created at 2013-03-13 14:09:56

Patchbot, apply trac_11715_matrix_set_row_column_docs_fixed.patch


---

Comment by kcrisman created at 2013-03-13 14:11:36

This looks pretty good and good work using Python 3 formatting :-)

Just waiting on the patchbot to make sure we're okay with respect to 5.8.beta4 or whatever the latest one is.


---

Comment by kcrisman created at 2013-03-14 19:13:44

I can't figure out how to reset patchbot and get it to test...

Patchbot, apply only trac_11715_matrix_set_row_column_docs_fixed.patch


---

Comment by kcrisman created at 2013-03-15 18:55:41

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2013-03-15 18:55:41

Patchbot never did anything, but I checked on 5.8.rc0 and it's fine.


---

Comment by jdemeyer created at 2013-03-20 14:43:29

Resolution: fixed
