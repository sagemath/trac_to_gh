# Issue 15811: dev docs: Inclusion Procedure for New and Updated Packages

archive/issues_015811.json:
```json
{
    "body": "As discussed in\n\nhttps://groups.google.com/forum/?hl=en#!topic/sage-devel/jopuoWO1Fvk\n\nclear documentation on the procedure is missing.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16048\n\n",
    "created_at": "2014-04-02T15:43:44Z",
    "labels": [
        "component: documentation",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "dev docs: Inclusion Procedure for New and Updated Packages",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15811",
    "user": "https://github.com/rwst"
}
```
As discussed in

https://groups.google.com/forum/?hl=en#!topic/sage-devel/jopuoWO1Fvk

clear documentation on the procedure is missing.

Issue created by migration from https://trac.sagemath.org/ticket/16048





---

archive/issue_comments_204888.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-02T16:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204889.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-02T16:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204889",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_204890.json:
```json
{
    "body": "There is a bit of redundancy in your first paragraph and the 3rd about a package requiring a year before it could be considered for a standard package. Additionally, experimental packages aren't really ever eligible to become standard packages since standard packages need to support all of Sage's supported platforms (and most things that fall into the experimental category are things that break on various platforms).\n\nAlso, I don't know if it is mentioned in any of the surrounding documentation, but standard packages need to be GPLv3+ compatible, so including that somewhere would be good.",
    "created_at": "2014-04-02T16:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204890",
    "user": "https://github.com/ohanar"
}
```

There is a bit of redundancy in your first paragraph and the 3rd about a package requiring a year before it could be considered for a standard package. Additionally, experimental packages aren't really ever eligible to become standard packages since standard packages need to support all of Sage's supported platforms (and most things that fall into the experimental category are things that break on various platforms).

Also, I don't know if it is mentioned in any of the surrounding documentation, but standard packages need to be GPLv3+ compatible, so including that somewhere would be good.



---

archive/issue_comments_204891.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-03T08:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204892.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-12T16:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204892",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204893.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-13T07:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204893",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204894.json:
```json
{
    "body": "Does having both a SPKG and a build/pkg/foo directory work? Which spkg-install script is being used? I don't even know if this works, but it shouldn't. You can either have a legacy spkg or make a git branch with an upstream tarball (gz/bz2).",
    "created_at": "2014-04-14T22:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204894",
    "user": "https://github.com/vbraun"
}
```

Does having both a SPKG and a build/pkg/foo directory work? Which spkg-install script is being used? I don't even know if this works, but it shouldn't. You can either have a legacy spkg or make a git branch with an upstream tarball (gz/bz2).



---

archive/issue_comments_204895.json:
```json
{
    "body": "OK, but what to do if the supporting files in the published SPKG are defect, see #15813?\n----\nNew commits:",
    "created_at": "2014-04-15T06:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204895",
    "user": "https://github.com/rwst"
}
```

OK, but what to do if the supporting files in the published SPKG are defect, see #15813?
----
New commits:



---

archive/issue_comments_204896.json:
```json
{
    "body": "I really don't understand what you're trying to say with\n\n```\nA special case where no patch would be necessary is when an author\nprovides an already fine SPKG on the net which includes all files\nneeded for ``SAGE_ROOT/build/pkgs/foo`` and the source in its ``src/``\nsubdirectory. Here it suffices to put the web link to the package\ninto the ticket. Alternatively, you would have to ask the author to\nmake a tarball of the ``src/`` subdirectory, and upload a branch with\n``SAGE_ROOT/build/pkgs/foo``.\n```\n\n\nThe first part of the patch is good for me.",
    "created_at": "2014-04-15T09:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204896",
    "user": "https://github.com/jdemeyer"
}
```

I really don't understand what you're trying to say with

```
A special case where no patch would be necessary is when an author
provides an already fine SPKG on the net which includes all files
needed for ``SAGE_ROOT/build/pkgs/foo`` and the source in its ``src/``
subdirectory. Here it suffices to put the web link to the package
into the ticket. Alternatively, you would have to ask the author to
make a tarball of the ``src/`` subdirectory, and upload a branch with
``SAGE_ROOT/build/pkgs/foo``.
```


The first part of the patch is good for me.



---

archive/issue_comments_204897.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-15T09:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204897",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_204898.json:
```json
{
    "body": "Hi,\n\n0) It would be nice to start with a section explaining how the installation procedure works (\"how does this work\" or \"the big picture\") and make appropriate pointers to the install scripts. Part of it is already explained in \"Directory structure\".\n\n1) There is a lot of intersection between your new section \"Procedure for ...\" and the \"Prerequisites\". It would make more sense to have only one.\n\n2) About \"Testing\". Firstly there is a typo !``SAGE_ROOT/upstream/` should be closed with two backquotes. Secondly, the name of the section is not very appropriate as it intersects with \"Self-test\". It would also be better if the content of this section appear inside \"how this work\" mentioned in 0).\n\nVincent",
    "created_at": "2014-04-16T11:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204898",
    "user": "https://github.com/videlec"
}
```

Hi,

0) It would be nice to start with a section explaining how the installation procedure works ("how does this work" or "the big picture") and make appropriate pointers to the install scripts. Part of it is already explained in "Directory structure".

1) There is a lot of intersection between your new section "Procedure for ..." and the "Prerequisites". It would make more sense to have only one.

2) About "Testing". Firstly there is a typo !``SAGE_ROOT/upstream/` should be closed with two backquotes. Secondly, the name of the section is not very appropriate as it intersects with "Self-test". It would also be better if the content of this section appear inside "how this work" mentioned in 0).

Vincent



---

archive/issue_comments_204899.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-17T13:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204899",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204900.json:
```json
{
    "body": "Thanks to all reviewers so far.\n\nReplying to [comment:11 vdelecroix]:\n> 1) There is a lot of intersection between your new section \"Procedure for ...\" and the \"Prerequisites\". It would make more sense to have only one.\nI will take the liberty to disagree here, for educational reasons.\n\nEverything else was fixed. Anything amiss in this section?",
    "created_at": "2014-04-17T13:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204900",
    "user": "https://github.com/rwst"
}
```

Thanks to all reviewers so far.

Replying to [comment:11 vdelecroix]:
> 1) There is a lot of intersection between your new section "Procedure for ..." and the "Prerequisites". It would make more sense to have only one.
I will take the liberty to disagree here, for educational reasons.

Everything else was fixed. Anything amiss in this section?



---

archive/issue_comments_204901.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-17T13:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204901",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204902.json:
```json
{
    "body": "I am very sorry to be very picky but I definitely think that the documentation is an important piece of a software. Please for each of my comment, say explicitly if you agree or not (you did it for my 1) before but you mostly eluded the other two). I am happy to make the changes you accept by myself if you prefer.\n\n**section \"Inclusion Procedure for New and Updated Packages\"**\n\nAs it is the case in all other sections, it would be nice if you add a line break after the title.\n\nFor the politics about tickets, I thought that:\n- experimental = does not build on all platforms officially supported => never be optional\n- optional = does build on all platforms => can possibly become standard after some time\n\nThe sentence \"In short, packages consist of a link to the original tarball with additional\ncode under !``SAGE_ROOT/build/pkgs!``\" is not meaningful at this stage of the document. It is not clear what is a \"package\" nor what is an \"original tarball\". I would simply remove the sentence as this section is purely about \"how do you submit\" and not \"how do you make your own package\". Moreover, I would would better put this section near the end of the document because before submitting a package you need to build one ;-).\n\n**section \"Directory structure\"**\n\nIn the sentence \"to package it in Sage\" you must uppercase the \"t\". At the very same place I suggest to put a comment in parenthesis \"... distribute a tarball !``foo-1.3.tar.gz!`` (that will be automatically placed in !``SAGE_ROOT/upstream!`` during the installation process)\" or something similar.\n\n**section \"Manual package build and installation\"**\n\nI think that the shell command\n\n```\n$ SAGE_CHECK=yes sage -f package_name\n```\n\nwill not do what you expect. You might either put a column between the `SAGE_CHECK=yes` and the `sage -f package_name` or put it in two lines.\n\nThere are at least 5 important missing things:\n\n- `sage -i PACKAGE_NAME` is the standard command to install a package \n- if a package is already installed, we can perform the tests only with `sage -i -c PACKAGE_NAME` (what the `-c` option does is that it set `SAGE_CHECK` to yes + some extra mystery about SAGE_CHECK_PACKAGES)\n- to force the reinstallation of a package we can do `sage -i -f PACKAGE_NAME` (and `sage -f PACKAGE_NAME` is a shortcut for it)\n- the install script is in $SAGE_ROOT/local/bin/install (and Sage reinvented the wheel here!!). It is relatively well documented and is worth to points its existence.",
    "created_at": "2014-04-17T15:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204902",
    "user": "https://github.com/videlec"
}
```

I am very sorry to be very picky but I definitely think that the documentation is an important piece of a software. Please for each of my comment, say explicitly if you agree or not (you did it for my 1) before but you mostly eluded the other two). I am happy to make the changes you accept by myself if you prefer.

**section "Inclusion Procedure for New and Updated Packages"**

As it is the case in all other sections, it would be nice if you add a line break after the title.

For the politics about tickets, I thought that:
- experimental = does not build on all platforms officially supported => never be optional
- optional = does build on all platforms => can possibly become standard after some time

The sentence "In short, packages consist of a link to the original tarball with additional
code under !``SAGE_ROOT/build/pkgs!``" is not meaningful at this stage of the document. It is not clear what is a "package" nor what is an "original tarball". I would simply remove the sentence as this section is purely about "how do you submit" and not "how do you make your own package". Moreover, I would would better put this section near the end of the document because before submitting a package you need to build one ;-).

**section "Directory structure"**

In the sentence "to package it in Sage" you must uppercase the "t". At the very same place I suggest to put a comment in parenthesis "... distribute a tarball !``foo-1.3.tar.gz!`` (that will be automatically placed in !``SAGE_ROOT/upstream!`` during the installation process)" or something similar.

**section "Manual package build and installation"**

I think that the shell command

```
$ SAGE_CHECK=yes sage -f package_name
```

will not do what you expect. You might either put a column between the `SAGE_CHECK=yes` and the `sage -f package_name` or put it in two lines.

There are at least 5 important missing things:

- `sage -i PACKAGE_NAME` is the standard command to install a package 
- if a package is already installed, we can perform the tests only with `sage -i -c PACKAGE_NAME` (what the `-c` option does is that it set `SAGE_CHECK` to yes + some extra mystery about SAGE_CHECK_PACKAGES)
- to force the reinstallation of a package we can do `sage -i -f PACKAGE_NAME` (and `sage -f PACKAGE_NAME` is a shortcut for it)
- the install script is in $SAGE_ROOT/local/bin/install (and Sage reinvented the wheel here!!). It is relatively well documented and is worth to points its existence.



---

archive/issue_comments_204903.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-17T15:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204903",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_204904.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-18T16:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204905.json:
```json
{
    "body": "Thanks for your review.\n\nReplying to [comment:14 vdelecroix]:\n> I am very sorry to be very picky\nDon't.\n> As it is the case in all other sections, it would be nice if you add a line break after the title.\nDone.\n>  - experimental = does not build on all platforms officially supported => never be optional\nYes, done.\n> The sentence \"In short, packages consist of a link to the original tarball with additional\n> code under !``SAGE_ROOT/build/pkgs!``\" is not meaningful at this stage of the document. It is not clear what is a \"package\" nor what is an \"original tarball\". I would simply remove the sentence as this section is purely about \"how do you submit\" and not \"how do you make your own package\".\nDone.\n> Moreover, I would would better put this section near the end of the document because before submitting a package you need to build one ;-).\nI was not sure how to do this.\n> In the sentence \"to package it in Sage\" you must uppercase the \"t\". At the very same place I suggest to put a comment in parenthesis \"... distribute a tarball !``foo-1.3.tar.gz!`` (that will be automatically placed in !``SAGE_ROOT/upstream!`` during the installation process)\" or something similar.\nBoth done.\n> {{{\n> $ SAGE_CHECK=yes sage -f package_name\n> }}}\n> will not do what you expect.\nI replaced it with `sage -i -c PACKAGE_NAME`.\n> There are at least 5 important missing things:\nI was unsure how to include this. Please feel free to add it and the other issue above yourself.",
    "created_at": "2014-04-18T16:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204905",
    "user": "https://github.com/rwst"
}
```

Thanks for your review.

Replying to [comment:14 vdelecroix]:
> I am very sorry to be very picky
Don't.
> As it is the case in all other sections, it would be nice if you add a line break after the title.
Done.
>  - experimental = does not build on all platforms officially supported => never be optional
Yes, done.
> The sentence "In short, packages consist of a link to the original tarball with additional
> code under !``SAGE_ROOT/build/pkgs!``" is not meaningful at this stage of the document. It is not clear what is a "package" nor what is an "original tarball". I would simply remove the sentence as this section is purely about "how do you submit" and not "how do you make your own package".
Done.
> Moreover, I would would better put this section near the end of the document because before submitting a package you need to build one ;-).
I was not sure how to do this.
> In the sentence "to package it in Sage" you must uppercase the "t". At the very same place I suggest to put a comment in parenthesis "... distribute a tarball !``foo-1.3.tar.gz!`` (that will be automatically placed in !``SAGE_ROOT/upstream!`` during the installation process)" or something similar.
Both done.
> {{{
> $ SAGE_CHECK=yes sage -f package_name
> }}}
> will not do what you expect.
I replaced it with `sage -i -c PACKAGE_NAME`.
> There are at least 5 important missing things:
I was unsure how to include this. Please feel free to add it and the other issue above yourself.



---

archive/issue_comments_204906.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-22T08:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204906",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204907.json:
```json
{
    "body": "Hi Ralf,\n\nI added few sentences in the introduction about the install script and the organization of the document. I also reorganize the sections (not changing them).\n\nIn my second commit I just set the line width to 72.\n\nTell me if you think it is better (as I am not a native english speaker there might be some mistakes). Otherwise we can just go back to the previous branch `public/spkg-devdoc-1` which is just two commits before.\n\nBest\nVincent\n----\nNew commits:",
    "created_at": "2014-04-22T08:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204907",
    "user": "https://github.com/videlec"
}
```

Hi Ralf,

I added few sentences in the introduction about the install script and the organization of the document. I also reorganize the sections (not changing them).

In my second commit I just set the line width to 72.

Tell me if you think it is better (as I am not a native english speaker there might be some mistakes). Otherwise we can just go back to the previous branch `public/spkg-devdoc-1` which is just two commits before.

Best
Vincent
----
New commits:



---

archive/issue_comments_204908.json:
```json
{
    "body": "I think this is fine and I like it better. If you don't mind I'll set the ticket fields accordingly.",
    "created_at": "2014-04-22T08:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204908",
    "user": "https://github.com/rwst"
}
```

I think this is fine and I like it better. If you don't mind I'll set the ticket fields accordingly.



---

archive/issue_comments_204909.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-22T08:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204909",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_204910.json:
```json
{
    "body": "Replying to [comment:18 rws]:\n> I think this is fine and I like it better. If you don't mind I'll set the ticket fields accordingly.\n\nPrefect, thanks!",
    "created_at": "2014-04-22T08:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204910",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:18 rws]:
> I think this is fine and I like it better. If you don't mind I'll set the ticket fields accordingly.

Prefect, thanks!



---

archive/issue_events_015413.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-22T17:55:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15811#event-15413"
}
```



---

archive/issue_comments_204911.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-22T17:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15811#issuecomment-204911",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
