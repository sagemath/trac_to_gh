# Issue 17813: Implement dual equivalence graphs

archive/issues_017813.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat @anneschilling @darijgr troby\n\nKeywords: dual equivalence graphs\n\nImplement methods for dual equivalence graphs coming from standard tableaux of a fixed shape and as weight 0 crystal spaces.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18050\n\n",
    "created_at": "2015-03-25T03:18:44Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Implement dual equivalence graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17813",
    "user": "@tscrim"
}
```
Assignee: sage-combinat

CC:  sage-combinat @anneschilling @darijgr troby

Keywords: dual equivalence graphs

Implement methods for dual equivalence graphs coming from standard tableaux of a fixed shape and as weight 0 crystal spaces.

Issue created by migration from https://trac.sagemath.org/ticket/18050





---

archive/issue_comments_238804.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-25T03:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238804",
    "user": "@tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_238805.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-03-25T03:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238805",
    "user": "@tscrim"
}
```

New commits:



---

archive/issue_comments_238806.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-25T16:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238806",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238807.json:
```json
{
    "body": "some failing doctests, see patchbot report",
    "created_at": "2015-04-01T18:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238807",
    "user": "@fchapoton"
}
```

some failing doctests, see patchbot report



---

archive/issue_comments_238808.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-01T18:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238808",
    "user": "@fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_238809.json:
```json
{
    "body": "In other news, here's something I've been long since curious about:\n\n```\n+ - :meth:`~sage.categories.regular_crystals.RegularCrystals.ParentMethods.dual_equivalence_graph`\n+ - :meth:`sage.combinat.partition.Partition.dual_equivalence_graph`\n```\n\nWhat is the difference between the syntax with the tilde and that without?",
    "created_at": "2015-04-01T18:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238809",
    "user": "@darijgr"
}
```

In other news, here's something I've been long since curious about:

```
+ - :meth:`~sage.categories.regular_crystals.RegularCrystals.ParentMethods.dual_equivalence_graph`
+ - :meth:`sage.combinat.partition.Partition.dual_equivalence_graph`
```

What is the difference between the syntax with the tilde and that without?



---

archive/issue_comments_238810.json:
```json
{
    "body": "The tilde only displays the last thing after a dot, without displays the entire path.",
    "created_at": "2015-04-01T18:52:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238810",
    "user": "@tscrim"
}
```

The tilde only displays the last thing after a dot, without displays the entire path.



---

archive/issue_comments_238811.json:
```json
{
    "body": "Ah, thank you!",
    "created_at": "2015-04-01T18:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238811",
    "user": "@darijgr"
}
```

Ah, thank you!



---

archive/issue_comments_238812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-01T19:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238812",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238813.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-01T19:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238813",
    "user": "@tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_238814.json:
```json
{
    "body": "Stupid question:\n\nAssuming that your dual equivalence graph is the graph `\\mathcal{G}(\\mathcal{X})` defined in Section 4 of the Assaf preprint you are citing, is your condition `\\varepsilon_j(b) = \\varphi_j(b)` really equivalent to her (4.1) ? If so, what are the connections between your `\\varepsilon` and `\\varphi` and her `\\varepsilon` and `\\delta`?",
    "created_at": "2015-04-01T20:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238814",
    "user": "@darijgr"
}
```

Stupid question:

Assuming that your dual equivalence graph is the graph `\mathcal{G}(\mathcal{X})` defined in Section 4 of the Assaf preprint you are citing, is your condition `\varepsilon_j(b) = \varphi_j(b)` really equivalent to her (4.1) ? If so, what are the connections between your `\varepsilon` and `\varphi` and her `\varepsilon` and `\delta`?



---

archive/issue_comments_238815.json:
```json
{
    "body": "The `\\varepsilon_j(b) = \\varphi_j(b)` comes from the crystal axiom `\\varphi_j(b) = \\varepsilon_j(b) + wt(b)` (`wt` is the weight) and we are looking at the `wt(b) = 0` elements. Her `\\varepsilon` is the same as mine and the `\\delta` is something related but slightly different (see towards the beginning of section 2).",
    "created_at": "2015-04-01T20:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238815",
    "user": "@tscrim"
}
```

The `\varepsilon_j(b) = \varphi_j(b)` comes from the crystal axiom `\varphi_j(b) = \varepsilon_j(b) + wt(b)` (`wt` is the weight) and we are looking at the `wt(b) = 0` elements. Her `\varepsilon` is the same as mine and the `\delta` is something related but slightly different (see towards the beginning of section 2).



---

archive/issue_comments_238816.json:
```json
{
    "body": "I think the docstring of `Partition.dual_equivalence_graph` could be clearer.  I suggest\n\n\n```\nTwo permutations `p` and `q` differ by an elementary dual Knuth\nrelation (of color `i`), when, in one line notation, the letter\n`i` does not occur between `i-1` and `i+1`, and `q` is obtained \nfrom `p` by switching the places of `i-1` and `i+1`.\n\nTwo standard Young tableaux of shape `\\lambda` differ by an\nelementary dual Knuth relation (of color `i`), if their content\nreading words differ by an elementary dual Knuth relation (of\ncolor `i`).\n\nThe *dual equivalence graph* is the edge-colored graph formed by\nthe set of standard Young tableaux of shape `\\lambda` where edges\ncolored by `i` are given by dual equivalences of color `i`.\n```\n",
    "created_at": "2015-04-01T21:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238816",
    "user": "@mantepse"
}
```

I think the docstring of `Partition.dual_equivalence_graph` could be clearer.  I suggest


```
Two permutations `p` and `q` differ by an elementary dual Knuth
relation (of color `i`), when, in one line notation, the letter
`i` does not occur between `i-1` and `i+1`, and `q` is obtained 
from `p` by switching the places of `i-1` and `i+1`.

Two standard Young tableaux of shape `\lambda` differ by an
elementary dual Knuth relation (of color `i`), if their content
reading words differ by an elementary dual Knuth relation (of
color `i`).

The *dual equivalence graph* is the edge-colored graph formed by
the set of standard Young tableaux of shape `\lambda` where edges
colored by `i` are given by dual equivalences of color `i`.
```




---

archive/issue_comments_238817.json:
```json
{
    "body": "Replying to [comment:11 tscrim]:\n> The `\\varepsilon_j(b) = \\varphi_j(b)` comes from the crystal axiom `\\varphi_j(b) = \\varepsilon_j(b) + wt(b)` (`wt` is the weight) and we are looking at the `wt(b) = 0` elements. Her `\\varepsilon` is the same as mine and the `\\delta` is something related but slightly different (see towards the beginning of section 2).\n\nOh. Is `\\delta_j(b)` the same as your `-\\varphi_j(b)`? And what does the `= 0 or 1` part of Assaf's (4.1) correspond to in your definition?",
    "created_at": "2015-04-01T21:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238817",
    "user": "@darijgr"
}
```

Replying to [comment:11 tscrim]:
> The `\varepsilon_j(b) = \varphi_j(b)` comes from the crystal axiom `\varphi_j(b) = \varepsilon_j(b) + wt(b)` (`wt` is the weight) and we are looking at the `wt(b) = 0` elements. Her `\varepsilon` is the same as mine and the `\delta` is something related but slightly different (see towards the beginning of section 2).

Oh. Is `\delta_j(b)` the same as your `-\varphi_j(b)`? And what does the `= 0 or 1` part of Assaf's (4.1) correspond to in your definition?



---

archive/issue_comments_238818.json:
```json
{
    "body": "Replying to [comment:13 darij]:\n> Oh. Is `\\delta_j(b)` the same as your `-\\varphi_j(b)`?\n\nYes.\n\n> And what does the `= 0 or 1` part of Assaf's (4.1) correspond to in your definition?\n\nIt means that we can do the `e_i` operation exactly 0 or 1 times before it falls off the crystal graph. In other words, these conditions state that if there is an `i`-arrow in the crystal graph going through `b`, then the entire chain of `i`-arrows containing `b` has length 2 with `b` in the middle.\n\n`@`mantepse I will make those changes in a minute.",
    "created_at": "2015-04-01T22:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238818",
    "user": "@tscrim"
}
```

Replying to [comment:13 darij]:
> Oh. Is `\delta_j(b)` the same as your `-\varphi_j(b)`?

Yes.

> And what does the `= 0 or 1` part of Assaf's (4.1) correspond to in your definition?

It means that we can do the `e_i` operation exactly 0 or 1 times before it falls off the crystal graph. In other words, these conditions state that if there is an `i`-arrow in the crystal graph going through `b`, then the entire chain of `i`-arrows containing `b` has length 2 with `b` in the middle.

`@`mantepse I will make those changes in a minute.



---

archive/issue_comments_238819.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-01T22:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238819",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238820.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-02T00:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238820",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238821.json:
```json
{
    "body": "I've been through (the easy) part of the code. Nice to see this going into Sage!\n\nMy question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?\n\nAlso, I had to change the meaning of \"head\" (of a directed edge) in the partitions.py method; please check whether it is correctly used in the other file.\n\nIn regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?",
    "created_at": "2015-04-02T00:52:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238821",
    "user": "@darijgr"
}
```

I've been through (the easy) part of the code. Nice to see this going into Sage!

My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?

Also, I had to change the meaning of "head" (of a directed edge) in the partitions.py method; please check whether it is correctly used in the other file.

In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?



---

archive/issue_comments_238822.json:
```json
{
    "body": "Replying to [comment:17 darij]:\n> I've been through (the easy) part of the code. Nice to see this going into Sage!\n\nThanks for doing the review.\n\n> My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?\n\nIt's in the code, see this line:\n\n```\nif x.epsilon(i) == 1 and x.epsilon(im) == 0:\n```\n\nNote that because I considered the directed, I make it slightly more specific than Assaf's definition by saying `\\varepsilon_j(b) = 1`. A similar statement appears in the doc.\n\n> Also, I had to change the meaning of \"head\" (of a directed edge) in the partitions.py method; please check whether it is correctly used in the other file.\n\nIt looks okay. I think instead of writing `a - b` we should do `a \\to b` in both files for directed edges (especially since it's in latex).\n\nI also feel this statement is too verbose:\n\n```\n- In the one-line notation of the permutation `p`, the letter\n  `i` appears either to the left of both `i-1` and `i+1`, or\n  to the right of both `i-1` and `i+1` (but not between the\n  two).\n```\n\nand we should just say `i` does not appear between `i-1` and `i+1`. Does this sound okay?\n\n> In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?\n\nNo, I wanted it to be as general as possible (at least this is what I needed for my research; I didn't necessarily know if my set of elements was the full dual equivalence class).",
    "created_at": "2015-04-02T05:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238822",
    "user": "@tscrim"
}
```

Replying to [comment:17 darij]:
> I've been through (the easy) part of the code. Nice to see this going into Sage!

Thanks for doing the review.

> My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?

It's in the code, see this line:

```
if x.epsilon(i) == 1 and x.epsilon(im) == 0:
```

Note that because I considered the directed, I make it slightly more specific than Assaf's definition by saying `\varepsilon_j(b) = 1`. A similar statement appears in the doc.

> Also, I had to change the meaning of "head" (of a directed edge) in the partitions.py method; please check whether it is correctly used in the other file.

It looks okay. I think instead of writing `a - b` we should do `a \to b` in both files for directed edges (especially since it's in latex).

I also feel this statement is too verbose:

```
- In the one-line notation of the permutation `p`, the letter
  `i` appears either to the left of both `i-1` and `i+1`, or
  to the right of both `i-1` and `i+1` (but not between the
  two).
```

and we should just say `i` does not appear between `i-1` and `i+1`. Does this sound okay?

> In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?

No, I wanted it to be as general as possible (at least this is what I needed for my research; I didn't necessarily know if my set of elements was the full dual equivalence class).



---

archive/issue_comments_238823.json:
```json
{
    "body": "Replying to [comment:18 tscrim]:\n> > My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?\n> \n> It's in the code, see this line:\n> {{{\n> if x.epsilon(i) == 1 and x.epsilon(im) == 0:\n> }}}\n\nBut what about the doc? Without this condition it sounds like your graph has a lot more (isolated) vertices than it should have.\n\n> Note that because I considered the directed, I make it slightly more specific than Assaf's definition by saying `\\varepsilon_j(b) = 1`. A similar statement appears in the doc.\n> \n> > Also, I had to change the meaning of \"head\" (of a directed edge) in the partitions.py method; please check whether it is correctly used in the other file.\n> \n> It looks okay. I think instead of writing `a - b` we should do `a \\to b` in both files for directed edges (especially since it's in latex).\n\nI think it's fine the way it is. The edge is undirected a priori; we direct it by assigning it a head. You'd have to reword my definition if you want to put an arrow there.\n\n> I also feel this statement is too verbose:\n> {{{\n> - In the one-line notation of the permutation `p`, the letter\n>   `i` appears either to the left of both `i-1` and `i+1`, or\n>   to the right of both `i-1` and `i+1` (but not between the\n>   two).\n> }}}\n> and we should just say `i` does not appear between `i-1` and `i+1`. Does this sound okay?\n\nThat's fine; feel free to change it (I won't return to this until tomorrow).\n\n> > In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?\n> \n> No, I wanted it to be as general as possible (at least this is what I needed for my research; I didn't necessarily know if my set of elements was the full dual equivalence class).\n\nOK, but it seems (from a brief glance) that if you don't have a union of equivalence classes, then your code can leak some non-X vertices into the graph by constructing edges one of whose endpoints is not in X. Is that OK to you?",
    "created_at": "2015-04-02T05:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238823",
    "user": "@darijgr"
}
```

Replying to [comment:18 tscrim]:
> > My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?
> 
> It's in the code, see this line:
> {{{
> if x.epsilon(i) == 1 and x.epsilon(im) == 0:
> }}}

But what about the doc? Without this condition it sounds like your graph has a lot more (isolated) vertices than it should have.

> Note that because I considered the directed, I make it slightly more specific than Assaf's definition by saying `\varepsilon_j(b) = 1`. A similar statement appears in the doc.
> 
> > Also, I had to change the meaning of "head" (of a directed edge) in the partitions.py method; please check whether it is correctly used in the other file.
> 
> It looks okay. I think instead of writing `a - b` we should do `a \to b` in both files for directed edges (especially since it's in latex).

I think it's fine the way it is. The edge is undirected a priori; we direct it by assigning it a head. You'd have to reword my definition if you want to put an arrow there.

> I also feel this statement is too verbose:
> {{{
> - In the one-line notation of the permutation `p`, the letter
>   `i` appears either to the left of both `i-1` and `i+1`, or
>   to the right of both `i-1` and `i+1` (but not between the
>   two).
> }}}
> and we should just say `i` does not appear between `i-1` and `i+1`. Does this sound okay?

That's fine; feel free to change it (I won't return to this until tomorrow).

> > In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?
> 
> No, I wanted it to be as general as possible (at least this is what I needed for my research; I didn't necessarily know if my set of elements was the full dual equivalence class).

OK, but it seems (from a brief glance) that if you don't have a union of equivalence classes, then your code can leak some non-X vertices into the graph by constructing edges one of whose endpoints is not in X. Is that OK to you?



---

archive/issue_comments_238824.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T13:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238824",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238825.json:
```json
{
    "body": "Replying to [comment:19 darij]:\n> Replying to [comment:18 tscrim]:\n> > > My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?\n> > \n> > It's in the code, see this line:\n> > {{{\n> > if x.epsilon(i) == 1 and x.epsilon(im) == 0:\n> > }}}\n> \n> But what about the doc? Without this condition it sounds like your graph has a lot more (isolated) vertices than it should have.\n\nI forgot to say that this is in the doc as well.\n\n> > It looks okay. I think instead of writing `a - b` we should do `a \\to b` in both files for directed edges (especially since it's in latex).\n> \n> I think it's fine the way it is. The edge is undirected a priori; we direct it by assigning it a head. You'd have to reword my definition if you want to put an arrow there.\n\nI made a change which I think is more clear. Comments welcomed.\n\n> > I also feel this statement is too verbose:\n> > {{{\n> > - In the one-line notation of the permutation `p`, the letter\n> >   `i` appears either to the left of both `i-1` and `i+1`, or\n> >   to the right of both `i-1` and `i+1` (but not between the\n> >   two).\n> > }}}\n> > and we should just say `i` does not appear between `i-1` and `i+1`. Does this sound okay?\n> \n> That's fine; feel free to change it (I won't return to this until tomorrow).\n\nI've made this change.\n\n> > > In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?\n> > \n> > No, I wanted it to be as general as possible (at least this is what I needed for my research; I didn't necessarily know if my set of elements was the full dual equivalence class).\n> \n> OK, but it seems (from a brief glance) that if you don't have a union of equivalence classes, then your code can leak some non-X vertices into the graph by constructing edges one of whose endpoints is not in X. Is that OK to you?\n\nEeek, you're right. I made changes so that non-X vertices are not added to the DEG.",
    "created_at": "2015-04-13T13:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238825",
    "user": "@tscrim"
}
```

Replying to [comment:19 darij]:
> Replying to [comment:18 tscrim]:
> > > My question is still standing: Where are the `= 0 or 1` conditions in Assaf's (4.1) reflected in your code and doc? Or are they redundant, or wrong, or your notion of dual equivalence graphs different?
> > 
> > It's in the code, see this line:
> > {{{
> > if x.epsilon(i) == 1 and x.epsilon(im) == 0:
> > }}}
> 
> But what about the doc? Without this condition it sounds like your graph has a lot more (isolated) vertices than it should have.

I forgot to say that this is in the doc as well.

> > It looks okay. I think instead of writing `a - b` we should do `a \to b` in both files for directed edges (especially since it's in latex).
> 
> I think it's fine the way it is. The edge is undirected a priori; we direct it by assigning it a head. You'd have to reword my definition if you want to put an arrow there.

I made a change which I think is more clear. Comments welcomed.

> > I also feel this statement is too verbose:
> > {{{
> > - In the one-line notation of the permutation `p`, the letter
> >   `i` appears either to the left of both `i-1` and `i+1`, or
> >   to the right of both `i-1` and `i+1` (but not between the
> >   two).
> > }}}
> > and we should just say `i` does not appear between `i-1` and `i+1`. Does this sound okay?
> 
> That's fine; feel free to change it (I won't return to this until tomorrow).

I've made this change.

> > > In regular_crystals.py, what is required of X ? Should it be closed under e_i and f_i?
> > 
> > No, I wanted it to be as general as possible (at least this is what I needed for my research; I didn't necessarily know if my set of elements was the full dual equivalence class).
> 
> OK, but it seems (from a brief glance) that if you don't have a union of equivalence classes, then your code can leak some non-X vertices into the graph by constructing edges one of whose endpoints is not in X. Is that OK to you?

Eeek, you're right. I made changes so that non-X vertices are not added to the DEG.



---

archive/issue_comments_238826.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T16:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238826",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238827.json:
```json
{
    "body": "Changing keywords from \"dual equivalence graphs\" to \"dual equivalence graphs, days67\".",
    "created_at": "2015-04-13T16:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238827",
    "user": "@darijgr"
}
```

Changing keywords from "dual equivalence graphs" to "dual equivalence graphs, days67".



---

archive/issue_comments_238828.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T16:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238828",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238829.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T16:25:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238829",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238830.json:
```json
{
    "body": "Changing keywords from \"dual equivalence graphs, days67\" to \"dual equivalence graphs, sd67\".",
    "created_at": "2015-04-13T16:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238830",
    "user": "@nthiery"
}
```

Changing keywords from "dual equivalence graphs, days67" to "dual equivalence graphs, sd67".



---

archive/issue_comments_238831.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T17:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238831",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238832.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T20:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238832",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238833.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T20:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238833",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238834.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T20:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238834",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238835.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-13T20:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238835",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238836.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-13T20:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238836",
    "user": "@darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_238837.json:
```json
{
    "body": "Positive review by Travis who was standing over my shoulders and explaining what I should not do. :P",
    "created_at": "2015-04-13T20:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238837",
    "user": "@darijgr"
}
```

Positive review by Travis who was standing over my shoulders and explaining what I should not do. :P



---

archive/issue_comments_238838.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2015-04-14T06:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238838",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_238839.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2015-04-14T06:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238839",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_238840.json:
```json
{
    "body": "Couldn't resist fixing a few docstrings which made an iterator sound like it was a list and lists pretend to be iterators. Can you review this last bit, Travis? Thanks!",
    "created_at": "2015-04-14T06:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238840",
    "user": "@darijgr"
}
```

Couldn't resist fixing a few docstrings which made an iterator sound like it was a list and lists pretend to be iterators. Can you review this last bit, Travis? Thanks!



---

archive/issue_comments_238841.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-14T13:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238841",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_238842.json:
```json
{
    "body": "NP.",
    "created_at": "2015-04-14T13:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238842",
    "user": "@tscrim"
}
```

NP.



---

archive/issue_comments_238843.json:
```json
{
    "body": "For your coloring scheme, why don't you do it with a dictionary rather than the long list of if statements?\n\nAnne",
    "created_at": "2015-04-14T14:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238843",
    "user": "@anneschilling"
}
```

For your coloring scheme, why don't you do it with a dictionary rather than the long list of if statements?

Anne



---

archive/issue_comments_238844.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2015-04-14T15:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238844",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_238845.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2015-04-14T15:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238845",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_238846.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-14T15:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238846",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238847.json:
```json
{
    "body": "That's a much better method to get the colors. I also pulled in #18032 because we needed to get immutable copies of the graph so I could write a custom cache which does not regenerate the graph when we only want a different coloring.\n\nI also marked a test as long since it took nearly 20s on my computer.\n\nSomeone check my changes please.",
    "created_at": "2015-04-14T15:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238847",
    "user": "@tscrim"
}
```

That's a much better method to get the colors. I also pulled in #18032 because we needed to get immutable copies of the graph so I could write a custom cache which does not regenerate the graph when we only want a different coloring.

I also marked a test as long since it took nearly 20s on my computer.

Someone check my changes please.



---

archive/issue_comments_238848.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-14T15:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238848",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_238849.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-14T16:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238849",
    "user": "@darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_238850.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-14T23:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17813",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17813#issuecomment-238850",
    "user": "@vbraun"
}
```

Resolution: fixed
