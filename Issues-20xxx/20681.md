# Issue 20681: Cythonize the special methods in the categories that handle coercion in arithmetic

archive/issues_020444.json:
```json
{
    "body": "Recall that the Sage categories provide implementations for Python's\nspecial methods for the basic arithmetic operations (e.g. `__mul__`,\n`__add__`), that dispatch to the coercion model or call Sage's special\nmethods (e.g. `_mul_`, `_add_`) for the internal\noperations. Furthermore, the default implementation for `_mul_` is to\ndelegate the work to the `product` method of the parent.\n\nBefore this ticket, those indirections induced an overhead of roughly\n100ns for `*`, 480ns for `__mul__` and 340ns for `_mul_`:\n\n```\n    sage: S = Semigroups().example()\n    sage: x = S.an_element()\n    sage: x*x\n    42\n    sage: sage: %timeit [x*x for i in range(1000)]\n    1000 loops, best of 3: 1.21 ms per loop\n    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n    1000 loops, best of 3: 1.12 ms per loop\n    sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n    1000 loops, best of 3: 643 \u00b5s per loop\n    sage: %timeit [S.product(x,x) for i in range(1000)]\n    1000 loops, best of 3: 300 \u00b5s per loop\n```\n\nAfter this ticket, which Cythonize those methods, the overhead is\nreduced to roughly 20ns for `*`, 100ns for `__mul__` and 160ms for\n`_mul_`, which is a speedup by a factor of 3 on the accumulated\noverhead, and an overall speedup by a factor of 2 for this particular\nparent:\n\n```\n    sage: %timeit [x*x for i in range(1000)]\n    1000 loops, best of 3: 596 \u00b5s per loop\n    sage: %timeit [x.__mul__(x) for i in range(1000)]\n    1000 loops, best of 3: 572 \u00b5s per loop\n    sage: %timeit [x._mul_(x) for i in range(1000)]\n    1000 loops, best of 3: 467 \u00b5s per loop\n    sage: %timeit [S.product(x,x) for i in range(1000)]\n    1000 loops, best of 3: 300 \u00b5s per loop\n```\n\n=Notes=\n\nThe average timings vary by about 5-10% from one run to the other.\n\nIn this parent, the product is trivial, and implemented as a plain\nPython `product` method in the parent. For a parent with a non trivial\nPython product, the overhead of the indirections is now of 20%, which\nis getting closer to acceptable::\n\n```\n    sage: S = Semigroups().Finite().example()\n    sage: x = S.an_element()\n    sage: %timeit [S.product(x,x) for i in range(1000)]\n    100 loops, best of 3: 4.39 ms per loop\n    sage: %timeit [x*x for i in range(1000)]\n    100 loops, best of 3: 5.28 ms per loop\n```\n\nFor comparison, here is the cost of the product of two (Sage)\nintegers::\n\n```\n    sage: x = 3\n    sage: %timeit [x*x for i in range(1000)]\n    1000 loops, best of 3: 162 \u00b5s per loop\n    sage: x = int(3)\n    sage: %timeit [x*x for i in range(1000)]\n    10000 loops, best of 3: 63.9 \u00b5s per loop\n```\n\nSo the 120ns overhead when using coercion methods `__mul__` provided\nby categories (rather than from a Cython super class) is of the same\norder of magnitude as the cost of a trivial multiplication.\n\n\nKeywords: performance\n\nReviewer: Travis Scrimshaw\n\nAuthor: Nicolas M. Thi\u00e9ry\n\nBranch: public/categories/cythonize_arithmetic_special_methods-20681\n\nCommit: 4e88e4c311b0108f21d28a2c3587193e364ee0fd\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20681\n\n",
    "closed_at": "2016-05-31T07:36:59Z",
    "created_at": "2016-05-25T21:59:29Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Cythonize the special methods in the categories that handle coercion in arithmetic",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20681",
    "user": "https://github.com/nthiery"
}
```
Recall that the Sage categories provide implementations for Python's
special methods for the basic arithmetic operations (e.g. `__mul__`,
`__add__`), that dispatch to the coercion model or call Sage's special
methods (e.g. `_mul_`, `_add_`) for the internal
operations. Furthermore, the default implementation for `_mul_` is to
delegate the work to the `product` method of the parent.

Before this ticket, those indirections induced an overhead of roughly
100ns for `*`, 480ns for `__mul__` and 340ns for `_mul_`:

```
    sage: S = Semigroups().example()
    sage: x = S.an_element()
    sage: x*x
    42
    sage: sage: %timeit [x*x for i in range(1000)]
    1000 loops, best of 3: 1.21 ms per loop
    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
    1000 loops, best of 3: 1.12 ms per loop
    sage: sage: %timeit [x._mul_(x) for i in range(1000)]
    1000 loops, best of 3: 643 µs per loop
    sage: %timeit [S.product(x,x) for i in range(1000)]
    1000 loops, best of 3: 300 µs per loop
```

After this ticket, which Cythonize those methods, the overhead is
reduced to roughly 20ns for `*`, 100ns for `__mul__` and 160ms for
`_mul_`, which is a speedup by a factor of 3 on the accumulated
overhead, and an overall speedup by a factor of 2 for this particular
parent:

```
    sage: %timeit [x*x for i in range(1000)]
    1000 loops, best of 3: 596 µs per loop
    sage: %timeit [x.__mul__(x) for i in range(1000)]
    1000 loops, best of 3: 572 µs per loop
    sage: %timeit [x._mul_(x) for i in range(1000)]
    1000 loops, best of 3: 467 µs per loop
    sage: %timeit [S.product(x,x) for i in range(1000)]
    1000 loops, best of 3: 300 µs per loop
```

=Notes=

The average timings vary by about 5-10% from one run to the other.

In this parent, the product is trivial, and implemented as a plain
Python `product` method in the parent. For a parent with a non trivial
Python product, the overhead of the indirections is now of 20%, which
is getting closer to acceptable::

```
    sage: S = Semigroups().Finite().example()
    sage: x = S.an_element()
    sage: %timeit [S.product(x,x) for i in range(1000)]
    100 loops, best of 3: 4.39 ms per loop
    sage: %timeit [x*x for i in range(1000)]
    100 loops, best of 3: 5.28 ms per loop
```

For comparison, here is the cost of the product of two (Sage)
integers::

```
    sage: x = 3
    sage: %timeit [x*x for i in range(1000)]
    1000 loops, best of 3: 162 µs per loop
    sage: x = int(3)
    sage: %timeit [x*x for i in range(1000)]
    10000 loops, best of 3: 63.9 µs per loop
```

So the 120ns overhead when using coercion methods `__mul__` provided
by categories (rather than from a Cython super class) is of the same
order of magnitude as the cost of a trivial multiplication.


Keywords: performance

Reviewer: Travis Scrimshaw

Author: Nicolas M. Thiéry

Branch: public/categories/cythonize_arithmetic_special_methods-20681

Commit: 4e88e4c311b0108f21d28a2c3587193e364ee0fd

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20681





---

archive/issue_comments_299812.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-25T22:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299812",
    "user": "https://github.com/nthiery"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_299813.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,35 @@\n+Recall that the Sage categories provide implementations for Python's\n+special methods for the basic arithmetic operations (e.g. \\`__mul__\\`,\n+\\`__add__\\`), that dispatch to the coercion model or call Sage's special\n+methods (e.g. \\`_mul_\\`, \\`_add_\\`) for the internal operations.\n+\n+Before this ticket, this indirection induces an overhead of roughly\n+500ns:\n+\n+\\`\\`\\`\n+sage: S = Semigroups().example()\n+sage: x = S.an_element()\n+\n+sage: sage: %timeit [x*x for i in range(1000)]\n+1000 loops, best of 3: 1.21 ms per loop\n+sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n+1000 loops, best of 3: 1.12 ms per loop\n+sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n+1000 loops, best of 3: 643 \u00b5s per loop\n+\\`\\`\\`\n+(the average timing don't vary much if we try again)\n+\n+After this ticket, which Cythonize those methods, the overhead is\n+reduced to roughly 260ns, which is a speedup by a factor of 2:\n+\n+\\`\\`\\`\n+sage: %timeit [x*x for i in range(1000)]\n+1000 loops, best of 3: 929 \u00b5s per loop\n+sage: %timeit [x.__mul__(x) for i in range(1000)]\n+1000 loops, best of 3: 884 \u00b5s per loop\n+sage: %timeit [x._mul_(x) for i in range(1000)]\n+1000 loops, best of 3: 624 \u00b5s per loop\n+\\`\\`\\`\n \n \n Author: Nicolas M. Thi\u00e9ry\n```\n",
    "created_at": "2016-05-25T22:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299813",
    "user": "https://github.com/nthiery"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,35 @@
+Recall that the Sage categories provide implementations for Python's
+special methods for the basic arithmetic operations (e.g. \`__mul__\`,
+\`__add__\`), that dispatch to the coercion model or call Sage's special
+methods (e.g. \`_mul_\`, \`_add_\`) for the internal operations.
+
+Before this ticket, this indirection induces an overhead of roughly
+500ns:
+
+\`\`\`
+sage: S = Semigroups().example()
+sage: x = S.an_element()
+
+sage: sage: %timeit [x*x for i in range(1000)]
+1000 loops, best of 3: 1.21 ms per loop
+sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
+1000 loops, best of 3: 1.12 ms per loop
+sage: sage: %timeit [x._mul_(x) for i in range(1000)]
+1000 loops, best of 3: 643 µs per loop
+\`\`\`
+(the average timing don't vary much if we try again)
+
+After this ticket, which Cythonize those methods, the overhead is
+reduced to roughly 260ns, which is a speedup by a factor of 2:
+
+\`\`\`
+sage: %timeit [x*x for i in range(1000)]
+1000 loops, best of 3: 929 µs per loop
+sage: %timeit [x.__mul__(x) for i in range(1000)]
+1000 loops, best of 3: 884 µs per loop
+sage: %timeit [x._mul_(x) for i in range(1000)]
+1000 loops, best of 3: 624 µs per loop
+\`\`\`
 
 
 Author: Nicolas M. Thiéry
```




---

archive/issue_comments_299814.json:
```json
{
    "body": "<a id='comment:3'></a>There is a doctest failure in `src/sage/categories/primer.py` due to the new location of `__mul__` for magmas, and I am not sure how you would want to change the primer to reflect that. Also if you could remove the two added blanklines in `finite_dimensional_modules_with_basis.py`. Thank you.\n\n---\nNew commits:",
    "created_at": "2016-05-26T06:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299814",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>There is a doctest failure in `src/sage/categories/primer.py` due to the new location of `__mul__` for magmas, and I am not sure how you would want to change the primer to reflect that. Also if you could remove the two added blanklines in `finite_dimensional_modules_with_basis.py`. Thank you.

---
New commits:



---

archive/issue_comments_299815.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-26T06:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299815",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_299816.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-26T07:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299816",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299817.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,77 @@\n+Recall that the Sage categories provide implementations for Python's\n+special methods for the basic arithmetic operations (e.g. \\`__mul__\\`,\n+\\`__add__\\`), that dispatch to the coercion model or call Sage's special\n+methods (e.g. \\`_mul_\\`, \\`_add_\\`) for the internal\n+operations. Furthermore, the default implementation for \\`_mul_\\` is to\n+delegate the work to the \\`product\\` method of the parent.\n+\n+Before this ticket, those indirections induced an overhead of roughly\n+100ns for \\`*\\`, 480ns for \\`__mul__\\` and 340ns for \\`_mul_\\`:\n+\n+\\`\\`\\`\n+    sage: S = Semigroups().example()\n+    sage: x = S.an_element()\n+    sage: x*x\n+    42\n+    sage: sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 1.21 ms per loop\n+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 1.12 ms per loop\n+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 643 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n+\\`\\`\\`\n+\n+After this ticket, which Cythonize those methods, the overhead is\n+reduced to roughly 20ns for \\`*\\`, 100ns for \\`__mul__\\` and 160ms for\n+\\`_mul_\\`, which is a speedup by a factor of 3 on the accumulated\n+overhead, and an overall speedup by a factor of 2 for this particular\n+parent:\n+\n+\\`\\`\\`\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 596 \u00b5s per loop\n+    sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 572 \u00b5s per loop\n+    sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 467 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n+\\`\\`\\`\n+\n+Notes\n+##### The average timings vary by about 5-10% from one run to the other.\n+\n+In this parent, the product is trivial, and implemented as a plain\n+Python \\`product\\` method in the parent. For a parent with a non trivial\n+Python product, the overhead of the indirections is now of 20%, which\n+is getting closer to acceptable::\n+\n+\\`\\`\\`\n+    sage: S = Semigroups().Finite().example()\n+    sage: x = S.an_element()\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    100 loops, best of 3: 4.39 ms per loop\n+    sage: %timeit [x*x for i in range(1000)]\n+    100 loops, best of 3: 5.28 ms per loop\n+\\`\\`\\`\n+\n+For comparison, here is the cost of the product of two (Sage)\n+integers::\n+\n+\\`\\`\\`\n+    sage: x = 3\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 162 \u00b5s per loop\n+    sage: x = int(3)\n+    sage: %timeit [x*x for i in range(1000)]\n+    10000 loops, best of 3: 63.9 \u00b5s per loop\n+\\`\\`\\`\n+\n+So the 120ns overhead when using coercion methods \\`__mul__\\` provided\n+by categories (rather than from a Cython super class) is of the same\n+order of magnitude as the cost of a trivial multiplication.\n \n \n Author: Nicolas M. Thi\u00e9ry\n```\n",
    "created_at": "2016-05-26T08:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299817",
    "user": "https://github.com/nthiery"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,77 @@
+Recall that the Sage categories provide implementations for Python's
+special methods for the basic arithmetic operations (e.g. \`__mul__\`,
+\`__add__\`), that dispatch to the coercion model or call Sage's special
+methods (e.g. \`_mul_\`, \`_add_\`) for the internal
+operations. Furthermore, the default implementation for \`_mul_\` is to
+delegate the work to the \`product\` method of the parent.
+
+Before this ticket, those indirections induced an overhead of roughly
+100ns for \`*\`, 480ns for \`__mul__\` and 340ns for \`_mul_\`:
+
+\`\`\`
+    sage: S = Semigroups().example()
+    sage: x = S.an_element()
+    sage: x*x
+    42
+    sage: sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 1.21 ms per loop
+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 1.12 ms per loop
+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 643 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
+\`\`\`
+
+After this ticket, which Cythonize those methods, the overhead is
+reduced to roughly 20ns for \`*\`, 100ns for \`__mul__\` and 160ms for
+\`_mul_\`, which is a speedup by a factor of 3 on the accumulated
+overhead, and an overall speedup by a factor of 2 for this particular
+parent:
+
+\`\`\`
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 596 µs per loop
+    sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 572 µs per loop
+    sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 467 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
+\`\`\`
+
+Notes
+##### The average timings vary by about 5-10% from one run to the other.
+
+In this parent, the product is trivial, and implemented as a plain
+Python \`product\` method in the parent. For a parent with a non trivial
+Python product, the overhead of the indirections is now of 20%, which
+is getting closer to acceptable::
+
+\`\`\`
+    sage: S = Semigroups().Finite().example()
+    sage: x = S.an_element()
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    100 loops, best of 3: 4.39 ms per loop
+    sage: %timeit [x*x for i in range(1000)]
+    100 loops, best of 3: 5.28 ms per loop
+\`\`\`
+
+For comparison, here is the cost of the product of two (Sage)
+integers::
+
+\`\`\`
+    sage: x = 3
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 162 µs per loop
+    sage: x = int(3)
+    sage: %timeit [x*x for i in range(1000)]
+    10000 loops, best of 3: 63.9 µs per loop
+\`\`\`
+
+So the 120ns overhead when using coercion methods \`__mul__\` provided
+by categories (rather than from a Cython super class) is of the same
+order of magnitude as the cost of a trivial multiplication.
 
 
 Author: Nicolas M. Thiéry
```




---

archive/issue_comments_299818.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-26T08:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299818",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299819.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-26T08:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299819",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299820.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,78 @@\n+Recall that the Sage categories provide implementations for Python's\n+special methods for the basic arithmetic operations (e.g. \\`__mul__\\`,\n+\\`__add__\\`), that dispatch to the coercion model or call Sage's special\n+methods (e.g. \\`_mul_\\`, \\`_add_\\`) for the internal\n+operations. Furthermore, the default implementation for \\`_mul_\\` is to\n+delegate the work to the \\`product\\` method of the parent.\n+\n+Before this ticket, those indirections induced an overhead of roughly\n+100ns for \\`*\\`, 480ns for \\`__mul__\\` and 340ns for \\`_mul_\\`:\n+\n+\\`\\`\\`\n+    sage: S = Semigroups().example()\n+    sage: x = S.an_element()\n+    sage: x*x\n+    42\n+    sage: sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 1.21 ms per loop\n+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 1.12 ms per loop\n+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 643 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n+\\`\\`\\`\n+\n+After this ticket, which Cythonize those methods, the overhead is\n+reduced to roughly 20ns for \\`*\\`, 100ns for \\`__mul__\\` and 160ms for\n+\\`_mul_\\`, which is a speedup by a factor of 3 on the accumulated\n+overhead, and an overall speedup by a factor of 2 for this particular\n+parent:\n+\n+\\`\\`\\`\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 596 \u00b5s per loop\n+    sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 572 \u00b5s per loop\n+    sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 467 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n+\\`\\`\\`\n+\n+*Notes*\n+\n+The average timings vary by about 5-10% from one run to the other.\n+\n+In this parent, the product is trivial, and implemented as a plain\n+Python \\`product\\` method in the parent. For a parent with a non trivial\n+Python product, the overhead of the indirections is now of 20%, which\n+is getting closer to acceptable::\n+\n+\\`\\`\\`\n+    sage: S = Semigroups().Finite().example()\n+    sage: x = S.an_element()\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    100 loops, best of 3: 4.39 ms per loop\n+    sage: %timeit [x*x for i in range(1000)]\n+    100 loops, best of 3: 5.28 ms per loop\n+\\`\\`\\`\n+\n+For comparison, here is the cost of the product of two (Sage)\n+integers::\n+\n+\\`\\`\\`\n+    sage: x = 3\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 162 \u00b5s per loop\n+    sage: x = int(3)\n+    sage: %timeit [x*x for i in range(1000)]\n+    10000 loops, best of 3: 63.9 \u00b5s per loop\n+\\`\\`\\`\n+\n+So the 120ns overhead when using coercion methods \\`__mul__\\` provided\n+by categories (rather than from a Cython super class) is of the same\n+order of magnitude as the cost of a trivial multiplication.\n \n \n Author: Nicolas M. Thi\u00e9ry\n```\n",
    "created_at": "2016-05-26T09:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299820",
    "user": "https://github.com/nthiery"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,78 @@
+Recall that the Sage categories provide implementations for Python's
+special methods for the basic arithmetic operations (e.g. \`__mul__\`,
+\`__add__\`), that dispatch to the coercion model or call Sage's special
+methods (e.g. \`_mul_\`, \`_add_\`) for the internal
+operations. Furthermore, the default implementation for \`_mul_\` is to
+delegate the work to the \`product\` method of the parent.
+
+Before this ticket, those indirections induced an overhead of roughly
+100ns for \`*\`, 480ns for \`__mul__\` and 340ns for \`_mul_\`:
+
+\`\`\`
+    sage: S = Semigroups().example()
+    sage: x = S.an_element()
+    sage: x*x
+    42
+    sage: sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 1.21 ms per loop
+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 1.12 ms per loop
+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 643 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
+\`\`\`
+
+After this ticket, which Cythonize those methods, the overhead is
+reduced to roughly 20ns for \`*\`, 100ns for \`__mul__\` and 160ms for
+\`_mul_\`, which is a speedup by a factor of 3 on the accumulated
+overhead, and an overall speedup by a factor of 2 for this particular
+parent:
+
+\`\`\`
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 596 µs per loop
+    sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 572 µs per loop
+    sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 467 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
+\`\`\`
+
+*Notes*
+
+The average timings vary by about 5-10% from one run to the other.
+
+In this parent, the product is trivial, and implemented as a plain
+Python \`product\` method in the parent. For a parent with a non trivial
+Python product, the overhead of the indirections is now of 20%, which
+is getting closer to acceptable::
+
+\`\`\`
+    sage: S = Semigroups().Finite().example()
+    sage: x = S.an_element()
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    100 loops, best of 3: 4.39 ms per loop
+    sage: %timeit [x*x for i in range(1000)]
+    100 loops, best of 3: 5.28 ms per loop
+\`\`\`
+
+For comparison, here is the cost of the product of two (Sage)
+integers::
+
+\`\`\`
+    sage: x = 3
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 162 µs per loop
+    sage: x = int(3)
+    sage: %timeit [x*x for i in range(1000)]
+    10000 loops, best of 3: 63.9 µs per loop
+\`\`\`
+
+So the 120ns overhead when using coercion methods \`__mul__\` provided
+by categories (rather than from a Cython super class) is of the same
+order of magnitude as the cost of a trivial multiplication.
 
 
 Author: Nicolas M. Thiéry
```




---

archive/issue_comments_299821.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-26T09:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299821",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_299822.json:
```json
{
    "body": "<a id='comment:10'></a>New commits:",
    "created_at": "2016-05-26T09:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299822",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>New commits:



---

archive/issue_comments_299823.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-26T10:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299823",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299824.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-26T10:15:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299824",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299825.json:
```json
{
    "body": "<a id='comment:13'></a>New commits:",
    "created_at": "2016-05-26T10:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299825",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:13'></a>New commits:



---

archive/issue_comments_299826.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,78 @@\n+Recall that the Sage categories provide implementations for Python's\n+special methods for the basic arithmetic operations (e.g. \\`__mul__\\`,\n+\\`__add__\\`), that dispatch to the coercion model or call Sage's special\n+methods (e.g. \\`_mul_\\`, \\`_add_\\`) for the internal\n+operations. Furthermore, the default implementation for \\`_mul_\\` is to\n+delegate the work to the \\`product\\` method of the parent.\n+\n+Before this ticket, those indirections induced an overhead of roughly\n+100ns for \\`*\\`, 480ns for \\`__mul__\\` and 340ns for \\`_mul_\\`:\n+\n+\\`\\`\\`\n+    sage: S = Semigroups().example()\n+    sage: x = S.an_element()\n+    sage: x*x\n+    42\n+    sage: sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 1.21 ms per loop\n+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 1.12 ms per loop\n+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 643 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n+\\`\\`\\`\n+\n+After this ticket, which Cythonize those methods, the overhead is\n+reduced to roughly 20ns for \\`*\\`, 100ns for \\`__mul__\\` and 160ms for\n+\\`_mul_\\`, which is a speedup by a factor of 3 on the accumulated\n+overhead, and an overall speedup by a factor of 2 for this particular\n+parent:\n+\n+\\`\\`\\`\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 596 \u00b5s per loop\n+    sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 572 \u00b5s per loop\n+    sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 467 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n+\\`\\`\\`\n+\n+=Notes=\n+\n+The average timings vary by about 5-10% from one run to the other.\n+\n+In this parent, the product is trivial, and implemented as a plain\n+Python \\`product\\` method in the parent. For a parent with a non trivial\n+Python product, the overhead of the indirections is now of 20%, which\n+is getting closer to acceptable::\n+\n+\\`\\`\\`\n+    sage: S = Semigroups().Finite().example()\n+    sage: x = S.an_element()\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    100 loops, best of 3: 4.39 ms per loop\n+    sage: %timeit [x*x for i in range(1000)]\n+    100 loops, best of 3: 5.28 ms per loop\n+\\`\\`\\`\n+\n+For comparison, here is the cost of the product of two (Sage)\n+integers::\n+\n+\\`\\`\\`\n+    sage: x = 3\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 162 \u00b5s per loop\n+    sage: x = int(3)\n+    sage: %timeit [x*x for i in range(1000)]\n+    10000 loops, best of 3: 63.9 \u00b5s per loop\n+\\`\\`\\`\n+\n+So the 120ns overhead when using coercion methods \\`__mul__\\` provided\n+by categories (rather than from a Cython super class) is of the same\n+order of magnitude as the cost of a trivial multiplication.\n \n \n Author: Nicolas M. Thi\u00e9ry\n```\n",
    "created_at": "2016-05-26T10:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299826",
    "user": "https://github.com/nthiery"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,78 @@
+Recall that the Sage categories provide implementations for Python's
+special methods for the basic arithmetic operations (e.g. \`__mul__\`,
+\`__add__\`), that dispatch to the coercion model or call Sage's special
+methods (e.g. \`_mul_\`, \`_add_\`) for the internal
+operations. Furthermore, the default implementation for \`_mul_\` is to
+delegate the work to the \`product\` method of the parent.
+
+Before this ticket, those indirections induced an overhead of roughly
+100ns for \`*\`, 480ns for \`__mul__\` and 340ns for \`_mul_\`:
+
+\`\`\`
+    sage: S = Semigroups().example()
+    sage: x = S.an_element()
+    sage: x*x
+    42
+    sage: sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 1.21 ms per loop
+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 1.12 ms per loop
+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 643 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
+\`\`\`
+
+After this ticket, which Cythonize those methods, the overhead is
+reduced to roughly 20ns for \`*\`, 100ns for \`__mul__\` and 160ms for
+\`_mul_\`, which is a speedup by a factor of 3 on the accumulated
+overhead, and an overall speedup by a factor of 2 for this particular
+parent:
+
+\`\`\`
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 596 µs per loop
+    sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 572 µs per loop
+    sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 467 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
+\`\`\`
+
+=Notes=
+
+The average timings vary by about 5-10% from one run to the other.
+
+In this parent, the product is trivial, and implemented as a plain
+Python \`product\` method in the parent. For a parent with a non trivial
+Python product, the overhead of the indirections is now of 20%, which
+is getting closer to acceptable::
+
+\`\`\`
+    sage: S = Semigroups().Finite().example()
+    sage: x = S.an_element()
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    100 loops, best of 3: 4.39 ms per loop
+    sage: %timeit [x*x for i in range(1000)]
+    100 loops, best of 3: 5.28 ms per loop
+\`\`\`
+
+For comparison, here is the cost of the product of two (Sage)
+integers::
+
+\`\`\`
+    sage: x = 3
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 162 µs per loop
+    sage: x = int(3)
+    sage: %timeit [x*x for i in range(1000)]
+    10000 loops, best of 3: 63.9 µs per loop
+\`\`\`
+
+So the 120ns overhead when using coercion methods \`__mul__\` provided
+by categories (rather than from a Cython super class) is of the same
+order of magnitude as the cost of a trivial multiplication.
 
 
 Author: Nicolas M. Thiéry
```




---

archive/issue_comments_299827.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-26T10:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299827",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_299828.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2016-05-26T11:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299828",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_299829.json:
```json
{
    "body": "<a id='comment:15'></a>I understand the point of this patch, but I think it's not the right thing to do. The methods you define now in `coercion_methods.pyx` are just copies of methods available in various subclasses of `Element` anyway (e.g. `ModuleElement`, `RingElement`).\n\nI think the right thing to do is just to get rid of the category framework for these arithmetic methods and just define them in `Element`. That will be even faster than the current patch.",
    "created_at": "2016-05-26T11:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299829",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>I understand the point of this patch, but I think it's not the right thing to do. The methods you define now in `coercion_methods.pyx` are just copies of methods available in various subclasses of `Element` anyway (e.g. `ModuleElement`, `RingElement`).

I think the right thing to do is just to get rid of the category framework for these arithmetic methods and just define them in `Element`. That will be even faster than the current patch.



---

archive/issue_comments_299830.json:
```json
{
    "body": "<a id='comment:16'></a>In other words: you write\n\n```\n# This could eventually be moved to SageObject\n```\nI think you should just do that instead (but for `Element` instead of `SageObject`).",
    "created_at": "2016-05-26T11:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299830",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>In other words: you write

```
# This could eventually be moved to SageObject
```
I think you should just do that instead (but for `Element` instead of `SageObject`).



---

archive/issue_comments_299831.json:
```json
{
    "body": "<a id='comment:17'></a>Note that I don't really have anything against this ticket (if it improves things, why not). So, feel free to set the ticket back to positive_review if you disagree with me.",
    "created_at": "2016-05-26T11:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299831",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>Note that I don't really have anything against this ticket (if it improves things, why not). So, feel free to set the ticket back to positive_review if you disagree with me.



---

archive/issue_comments_299832.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:16 jdemeyer]:\n> In other words: you write\n> \n> ```\n> # This could eventually be moved to SageObject\n> ```\n> I think you should just do that instead (but for `Element` instead of `SageObject`).\n\n\n(for the record: I just moved that comment which was already there).\n\nYes, I pondered about that, since we had this parallel discussion\nabout moving all the coercion methods up to Element. If we do the\nmove, we should do it for all coercion methods at once. However, given\nthat this moving is a non trivial API change and still under\ndiscussion, I prefer to postpone it to a later ticket.",
    "created_at": "2016-05-26T12:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299832",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:18'></a>Replying to [comment:16 jdemeyer]:
> In other words: you write
> 
> ```
> # This could eventually be moved to SageObject
> ```
> I think you should just do that instead (but for `Element` instead of `SageObject`).


(for the record: I just moved that comment which was already there).

Yes, I pondered about that, since we had this parallel discussion
about moving all the coercion methods up to Element. If we do the
move, we should do it for all coercion methods at once. However, given
that this moving is a non trivial API change and still under
discussion, I prefer to postpone it to a later ticket.



---

archive/issue_comments_299833.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2016-05-26T12:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299833",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_299834.json:
```json
{
    "body": "<a id='comment:19'></a>Thanks though for raising this!",
    "created_at": "2016-05-26T12:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299834",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:19'></a>Thanks though for raising this!



---

archive/issue_comments_299835.json:
```json
{
    "body": "<a id='comment:20'></a>see patchbot report",
    "created_at": "2016-05-27T23:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299835",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:20'></a>see patchbot report



---

archive/issue_comments_299836.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-05-27T23:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299836",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_299837.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-28T07:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299837",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299838.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-28T07:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299838",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_299839.json:
```json
{
    "body": "<a id='comment:22'></a>Nicolas, can you double check. Also are the referenced methods correct in the `__*mul__` doc?",
    "created_at": "2016-05-28T07:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299839",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>Nicolas, can you double check. Also are the referenced methods correct in the `__*mul__` doc?



---

archive/issue_comments_299840.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-28T08:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299840",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299841.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-28T08:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299841",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_299842.json:
```json
{
    "body": "<a id='comment:24'></a>Thanks for all the rest fixes! I had actually just about to start working on them :-)",
    "created_at": "2016-05-28T08:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299842",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:24'></a>Thanks for all the rest fixes! I had actually just about to start working on them :-)



---

archive/issue_comments_299843.json:
```json
{
    "body": "<a id='comment:25'></a>PDF docs still don't build",
    "created_at": "2016-05-28T14:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299843",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>PDF docs still don't build



---

archive/issue_comments_299844.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-05-28T14:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299844",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_299845.json:
```json
{
    "body": "<a id='comment:26'></a>My guess is that it doesn't like that `coercion_methods.pyx` does not have any public methods. We probably should `autodoc` those all in anyways...",
    "created_at": "2016-05-29T13:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299845",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>My guess is that it doesn't like that `coercion_methods.pyx` does not have any public methods. We probably should `autodoc` those all in anyways...



---

archive/issue_comments_299846.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-30T06:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299846",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_299847.json:
```json
{
    "body": "<a id='comment:28'></a>Do we want to include these functions into the html/pdf doc or keep them hidden?",
    "created_at": "2016-05-30T08:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299847",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>Do we want to include these functions into the html/pdf doc or keep them hidden?



---

archive/issue_comments_299848.json:
```json
{
    "body": "<a id='comment:29'></a>We definitely would want to have them appear in the doc of the original classes. But this will only happen when we finally configure Sphinx to include the special methods (which are not private methods!).\n\nFor the \"coercion_methods\" module, it does not really matter.\n\nThe pdf doc compiles on my machine after my latest rest fix.",
    "created_at": "2016-05-30T21:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299848",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:29'></a>We definitely would want to have them appear in the doc of the original classes. But this will only happen when we finally configure Sphinx to include the special methods (which are not private methods!).

For the "coercion_methods" module, it does not really matter.

The pdf doc compiles on my machine after my latest rest fix.



---

archive/issue_comments_299849.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-30T21:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299849",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_299850.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-30T21:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299850",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_299851.json:
```json
{
    "body": "<a id='comment:31'></a>Okay. Let's get this into Sage.",
    "created_at": "2016-05-30T21:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299851",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:31'></a>Okay. Let's get this into Sage.



---

archive/issue_comments_299852.json:
```json
{
    "body": "<a id='comment:32'></a>Part of this ticket was already merged in 7.3.beta2. Please take whatever else was on this ticket and move it to a new ticket.",
    "created_at": "2016-05-31T07:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299852",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:32'></a>Part of this ticket was already merged in 7.3.beta2. Please take whatever else was on this ticket and move it to a new ticket.



---

archive/issue_events_055657.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-31T07:36:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20681#event-55657"
}
```



---

archive/issue_comments_299853.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-31T07:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299853",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_299854.json:
```json
{
    "body": "<a id='comment:33'></a>See #20733",
    "created_at": "2016-05-31T13:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299854",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'></a>See #20733



---

archive/issue_comments_299855.json:
```json
{
    "body": "<a id='comment:34'></a>Follow-up: most of this new file will be removed in #20767. Only `_mul_parent` will remain.",
    "created_at": "2016-08-01T15:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20681#issuecomment-299855",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>Follow-up: most of this new file will be removed in #20767. Only `_mul_parent` will remain.
