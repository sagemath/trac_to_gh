# Issue 20681: Cythonize the special methods in the categories that handle coercion in arithmetic

archive/issues_020444.json:
```json
{
    "assignees": [],
    "body": "Recall that the Sage categories provide implementations for Python's\nspecial methods for the basic arithmetic operations (e.g. `__mul__`,\n`__add__`), that dispatch to the coercion model or call Sage's special\nmethods (e.g. `_mul_`, `_add_`) for the internal\noperations. Furthermore, the default implementation for `_mul_` is to\ndelegate the work to the `product` method of the parent.\n\nBefore this ticket, those indirections induced an overhead of roughly\n100ns for `*`, 480ns for `__mul__` and 340ns for `_mul_`:\n\n```\n    sage: S = Semigroups().example()\n    sage: x = S.an_element()\n    sage: x*x\n    42\n    sage: sage: %timeit [x*x for i in range(1000)]\n    1000 loops, best of 3: 1.21 ms per loop\n    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n    1000 loops, best of 3: 1.12 ms per loop\n    sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n    1000 loops, best of 3: 643 \u00b5s per loop\n    sage: %timeit [S.product(x,x) for i in range(1000)]\n    1000 loops, best of 3: 300 \u00b5s per loop\n```\n\nAfter this ticket, which Cythonize those methods, the overhead is\nreduced to roughly 20ns for `*`, 100ns for `__mul__` and 160ms for\n`_mul_`, which is a speedup by a factor of 3 on the accumulated\noverhead, and an overall speedup by a factor of 2 for this particular\nparent:\n\n```\n    sage: %timeit [x*x for i in range(1000)]\n    1000 loops, best of 3: 596 \u00b5s per loop\n    sage: %timeit [x.__mul__(x) for i in range(1000)]\n    1000 loops, best of 3: 572 \u00b5s per loop\n    sage: %timeit [x._mul_(x) for i in range(1000)]\n    1000 loops, best of 3: 467 \u00b5s per loop\n    sage: %timeit [S.product(x,x) for i in range(1000)]\n    1000 loops, best of 3: 300 \u00b5s per loop\n```\n\n=Notes=\n\nThe average timings vary by about 5-10% from one run to the other.\n\nIn this parent, the product is trivial, and implemented as a plain\nPython `product` method in the parent. For a parent with a non trivial\nPython product, the overhead of the indirections is now of 20%, which\nis getting closer to acceptable::\n\n```\n    sage: S = Semigroups().Finite().example()\n    sage: x = S.an_element()\n    sage: %timeit [S.product(x,x) for i in range(1000)]\n    100 loops, best of 3: 4.39 ms per loop\n    sage: %timeit [x*x for i in range(1000)]\n    100 loops, best of 3: 5.28 ms per loop\n```\n\nFor comparison, here is the cost of the product of two (Sage)\nintegers::\n\n```\n    sage: x = 3\n    sage: %timeit [x*x for i in range(1000)]\n    1000 loops, best of 3: 162 \u00b5s per loop\n    sage: x = int(3)\n    sage: %timeit [x*x for i in range(1000)]\n    10000 loops, best of 3: 63.9 \u00b5s per loop\n```\n\nSo the 120ns overhead when using coercion methods `__mul__` provided\nby categories (rather than from a Cython super class) is of the same\norder of magnitude as the cost of a trivial multiplication.\n\n\nKeywords: **performance**\n\nBranch/Commit: **[public/categories/cythonize_arithmetic_special_methods-20681](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/cythonize_arithmetic_special_methods-20681) @ [4e88e4c](https://github.com/sagemath/sagetrac-mirror/commit/4e88e4c311b0108f21d28a2c3587193e364ee0fd)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Nicolas M. Thi\u00e9ry**\n\nComponent: **categories**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20681_\n\n",
    "closed_at": "2016-05-31T07:36:59Z",
    "created_at": "2016-05-25T21:59:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20categories",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Cythonize the special methods in the categories that handle coercion in arithmetic",
    "type": "issue",
    "updated_at": "2016-08-01T15:16:27Z",
    "url": "https://github.com/sagemath/sage/issues/20681",
    "user": "https://github.com/nthiery"
}
```
Recall that the Sage categories provide implementations for Python's
special methods for the basic arithmetic operations (e.g. `__mul__`,
`__add__`), that dispatch to the coercion model or call Sage's special
methods (e.g. `_mul_`, `_add_`) for the internal
operations. Furthermore, the default implementation for `_mul_` is to
delegate the work to the `product` method of the parent.

Before this ticket, those indirections induced an overhead of roughly
100ns for `*`, 480ns for `__mul__` and 340ns for `_mul_`:

```
    sage: S = Semigroups().example()
    sage: x = S.an_element()
    sage: x*x
    42
    sage: sage: %timeit [x*x for i in range(1000)]
    1000 loops, best of 3: 1.21 ms per loop
    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
    1000 loops, best of 3: 1.12 ms per loop
    sage: sage: %timeit [x._mul_(x) for i in range(1000)]
    1000 loops, best of 3: 643 µs per loop
    sage: %timeit [S.product(x,x) for i in range(1000)]
    1000 loops, best of 3: 300 µs per loop
```

After this ticket, which Cythonize those methods, the overhead is
reduced to roughly 20ns for `*`, 100ns for `__mul__` and 160ms for
`_mul_`, which is a speedup by a factor of 3 on the accumulated
overhead, and an overall speedup by a factor of 2 for this particular
parent:

```
    sage: %timeit [x*x for i in range(1000)]
    1000 loops, best of 3: 596 µs per loop
    sage: %timeit [x.__mul__(x) for i in range(1000)]
    1000 loops, best of 3: 572 µs per loop
    sage: %timeit [x._mul_(x) for i in range(1000)]
    1000 loops, best of 3: 467 µs per loop
    sage: %timeit [S.product(x,x) for i in range(1000)]
    1000 loops, best of 3: 300 µs per loop
```

=Notes=

The average timings vary by about 5-10% from one run to the other.

In this parent, the product is trivial, and implemented as a plain
Python `product` method in the parent. For a parent with a non trivial
Python product, the overhead of the indirections is now of 20%, which
is getting closer to acceptable::

```
    sage: S = Semigroups().Finite().example()
    sage: x = S.an_element()
    sage: %timeit [S.product(x,x) for i in range(1000)]
    100 loops, best of 3: 4.39 ms per loop
    sage: %timeit [x*x for i in range(1000)]
    100 loops, best of 3: 5.28 ms per loop
```

For comparison, here is the cost of the product of two (Sage)
integers::

```
    sage: x = 3
    sage: %timeit [x*x for i in range(1000)]
    1000 loops, best of 3: 162 µs per loop
    sage: x = int(3)
    sage: %timeit [x*x for i in range(1000)]
    10000 loops, best of 3: 63.9 µs per loop
```

So the 120ns overhead when using coercion methods `__mul__` provided
by categories (rather than from a Cython super class) is of the same
order of magnitude as the cost of a trivial multiplication.


Keywords: **performance**

Branch/Commit: **[public/categories/cythonize_arithmetic_special_methods-20681](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/cythonize_arithmetic_special_methods-20681) @ [4e88e4c](https://github.com/sagemath/sagetrac-mirror/commit/4e88e4c311b0108f21d28a2c3587193e364ee0fd)**

Reviewer: **Travis Scrimshaw**

Author: **Nicolas M. Thiéry**

Component: **categories**

_Issue created by migration from https://trac.sagemath.org/ticket/20681_





---

archive/issue_events_291161.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-25T21:59:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291161"
}
```



---

archive/issue_events_291162.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-25T21:59:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20categories",
    "label_color": "0000ff",
    "label_name": "c: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291162"
}
```



---

archive/issue_events_291163.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-25T21:59:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291163"
}
```



---

archive/issue_events_291164.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-25T21:59:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291164"
}
```



---

archive/issue_events_291165.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-25T22:57:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291165"
}
```



---

archive/issue_comments_299093.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,33 @@\n+Recall that the Sage categories provide implementations for Python's\n+special methods for the basic arithmetic operations (e.g. `__mul__`,\n+`__add__`), that dispatch to the coercion model or call Sage's special\n+methods (e.g. `_mul_`, `_add_`) for the internal operations.\n \n+Before this ticket, this indirection induces an overhead of roughly\n+500ns:\n+\n+```\n+sage: S = Semigroups().example()\n+sage: x = S.an_element()\n+\n+sage: sage: %timeit [x*x for i in range(1000)]\n+1000 loops, best of 3: 1.21 ms per loop\n+sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n+1000 loops, best of 3: 1.12 ms per loop\n+sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n+1000 loops, best of 3: 643 \u00b5s per loop\n+```\n+(the average timing don't vary much if we try again)\n+\n+After this ticket, which Cythonize those methods, the overhead is\n+reduced to roughly 260ns, which is a speedup by a factor of 2:\n+\n+```\n+sage: %timeit [x*x for i in range(1000)]\n+1000 loops, best of 3: 929 \u00b5s per loop\n+sage: %timeit [x.__mul__(x) for i in range(1000)]\n+1000 loops, best of 3: 884 \u00b5s per loop\n+sage: %timeit [x._mul_(x) for i in range(1000)]\n+1000 loops, best of 3: 624 \u00b5s per loop\n+```\n+\n``````\n",
    "created_at": "2016-05-25T22:57:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299093",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,33 @@
+Recall that the Sage categories provide implementations for Python's
+special methods for the basic arithmetic operations (e.g. `__mul__`,
+`__add__`), that dispatch to the coercion model or call Sage's special
+methods (e.g. `_mul_`, `_add_`) for the internal operations.
 
+Before this ticket, this indirection induces an overhead of roughly
+500ns:
+
+```
+sage: S = Semigroups().example()
+sage: x = S.an_element()
+
+sage: sage: %timeit [x*x for i in range(1000)]
+1000 loops, best of 3: 1.21 ms per loop
+sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
+1000 loops, best of 3: 1.12 ms per loop
+sage: sage: %timeit [x._mul_(x) for i in range(1000)]
+1000 loops, best of 3: 643 µs per loop
+```
+(the average timing don't vary much if we try again)
+
+After this ticket, which Cythonize those methods, the overhead is
+reduced to roughly 260ns, which is a speedup by a factor of 2:
+
+```
+sage: %timeit [x*x for i in range(1000)]
+1000 loops, best of 3: 929 µs per loop
+sage: %timeit [x.__mul__(x) for i in range(1000)]
+1000 loops, best of 3: 884 µs per loop
+sage: %timeit [x._mul_(x) for i in range(1000)]
+1000 loops, best of 3: 624 µs per loop
+```
+
``````




---

archive/issue_events_291166.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-25T22:57:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "title_is": "Cythonize the special methods in the categories that handle coercion in arithmetic",
    "title_was": "Cythonize arithmetic special methods in the categories",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291166"
}
```



---

archive/issue_comments_299094.json:
```json
{
    "body": "Branch: **[u/nthiery/cythonize_arithmetic_special_methods_in_the_categories](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/cythonize_arithmetic_special_methods_in_the_categories)**",
    "created_at": "2016-05-25T23:02:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299094",
    "user": "https://github.com/nthiery"
}
```

Branch: **[u/nthiery/cythonize_arithmetic_special_methods_in_the_categories](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/cythonize_arithmetic_special_methods_in_the_categories)**



---

archive/issue_comments_299095.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere is a doctest failure in `src/sage/categories/primer.py` due to the new location of `__mul__` for magmas, and I am not sure how you would want to change the primer to reflect that. Also if you could remove the two added blanklines in `finite_dimensional_modules_with_basis.py`. Thank you.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e387d0dd88b75ca1564be37a27859f2ad87cd53\">8e387d0</a></td><td><code>20681: Cythonize the special methods in the categories that handle coercion in arithmetic</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ea790453bfae9af8027b716fb54e0b679f3ffd0\">8ea7904</a></td><td><code>20681: add new file to the documentation</code></td></tr></table>\n",
    "created_at": "2016-05-26T06:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299095",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

There is a doctest failure in `src/sage/categories/primer.py` due to the new location of `__mul__` for magmas, and I am not sure how you would want to change the primer to reflect that. Also if you could remove the two added blanklines in `finite_dimensional_modules_with_basis.py`. Thank you.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e387d0dd88b75ca1564be37a27859f2ad87cd53">8e387d0</a></td><td><code>20681: Cythonize the special methods in the categories that handle coercion in arithmetic</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ea790453bfae9af8027b716fb54e0b679f3ffd0">8ea7904</a></td><td><code>20681: add new file to the documentation</code></td></tr></table>




---

archive/issue_comments_299096.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2016-05-26T06:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299096",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_events_291167.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-26T06:02:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291167"
}
```



---

archive/issue_events_291168.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-26T06:02:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291168"
}
```



---

archive/issue_comments_299097.json:
```json
{
    "body": "Commit: **[8ea7904](https://github.com/sagemath/sagetrac-mirror/commit/8ea790453bfae9af8027b716fb54e0b679f3ffd0)**",
    "created_at": "2016-05-26T06:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299097",
    "user": "https://github.com/tscrim"
}
```

Commit: **[8ea7904](https://github.com/sagemath/sagetrac-mirror/commit/8ea790453bfae9af8027b716fb54e0b679f3ffd0)**



---

archive/issue_comments_299098.json:
```json
{
    "body": "Changed commit from **[8ea7904](https://github.com/sagemath/sagetrac-mirror/commit/8ea790453bfae9af8027b716fb54e0b679f3ffd0)** to **[2f83f59](https://github.com/sagemath/sagetrac-mirror/commit/2f83f598d7d08ee2002b749e6ba2f81d48983a25)**",
    "created_at": "2016-05-26T07:38:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299098",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8ea7904](https://github.com/sagemath/sagetrac-mirror/commit/8ea790453bfae9af8027b716fb54e0b679f3ffd0)** to **[2f83f59](https://github.com/sagemath/sagetrac-mirror/commit/2f83f598d7d08ee2002b749e6ba2f81d48983a25)**



---

archive/issue_comments_299099.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f83f598d7d08ee2002b749e6ba2f81d48983a25\">2f83f59</a></td><td><code>#20681: revert accidental addition of blank lines</code></td></tr></table>\n",
    "created_at": "2016-05-26T07:38:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299099",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f83f598d7d08ee2002b749e6ba2f81d48983a25">2f83f59</a></td><td><code>#20681: revert accidental addition of blank lines</code></td></tr></table>




---

archive/issue_comments_299100.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,33 +1,77 @@\n Recall that the Sage categories provide implementations for Python's\n special methods for the basic arithmetic operations (e.g. `__mul__`,\n `__add__`), that dispatch to the coercion model or call Sage's special\n-methods (e.g. `_mul_`, `_add_`) for the internal operations.\n+methods (e.g. `_mul_`, `_add_`) for the internal\n+operations. Furthermore, the default implementation for `_mul_` is to\n+delegate the work to the `product` method of the parent.\n \n-Before this ticket, this indirection induces an overhead of roughly\n-500ns:\n+Before this ticket, those indirections induced an overhead of roughly\n+100ns for `*`, 480ns for `__mul__` and 340ns for `_mul_`:\n \n ```\n-sage: S = Semigroups().example()\n-sage: x = S.an_element()\n-\n-sage: sage: %timeit [x*x for i in range(1000)]\n-1000 loops, best of 3: 1.21 ms per loop\n-sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n-1000 loops, best of 3: 1.12 ms per loop\n-sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n-1000 loops, best of 3: 643 \u00b5s per loop\n+    sage: S = Semigroups().example()\n+    sage: x = S.an_element()\n+    sage: x*x\n+    42\n+    sage: sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 1.21 ms per loop\n+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 1.12 ms per loop\n+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 643 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n ```\n-(the average timing don't vary much if we try again)\n \n After this ticket, which Cythonize those methods, the overhead is\n-reduced to roughly 260ns, which is a speedup by a factor of 2:\n+reduced to roughly 20ns for `*`, 100ns for `__mul__` and 160ms for\n+`_mul_`, which is a speedup by a factor of 3 on the accumulated\n+overhead, and an overall speedup by a factor of 2 for this particular\n+parent:\n \n ```\n-sage: %timeit [x*x for i in range(1000)]\n-1000 loops, best of 3: 929 \u00b5s per loop\n-sage: %timeit [x.__mul__(x) for i in range(1000)]\n-1000 loops, best of 3: 884 \u00b5s per loop\n-sage: %timeit [x._mul_(x) for i in range(1000)]\n-1000 loops, best of 3: 624 \u00b5s per loop\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 596 \u00b5s per loop\n+    sage: %timeit [x.__mul__(x) for i in range(1000)]\n+    1000 loops, best of 3: 572 \u00b5s per loop\n+    sage: %timeit [x._mul_(x) for i in range(1000)]\n+    1000 loops, best of 3: 467 \u00b5s per loop\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    1000 loops, best of 3: 300 \u00b5s per loop\n ```\n \n+Notes\n+=====\n+\n+The average timings vary by about 5-10% from one run to the other.\n+\n+In this parent, the product is trivial, and implemented as a plain\n+Python `product` method in the parent. For a parent with a non trivial\n+Python product, the overhead of the indirections is now of 20%, which\n+is getting closer to acceptable::\n+\n+```\n+    sage: S = Semigroups().Finite().example()\n+    sage: x = S.an_element()\n+    sage: %timeit [S.product(x,x) for i in range(1000)]\n+    100 loops, best of 3: 4.39 ms per loop\n+    sage: %timeit [x*x for i in range(1000)]\n+    100 loops, best of 3: 5.28 ms per loop\n+```\n+\n+For comparison, here is the cost of the product of two (Sage)\n+integers::\n+\n+```\n+    sage: x = 3\n+    sage: %timeit [x*x for i in range(1000)]\n+    1000 loops, best of 3: 162 \u00b5s per loop\n+    sage: x = int(3)\n+    sage: %timeit [x*x for i in range(1000)]\n+    10000 loops, best of 3: 63.9 \u00b5s per loop\n+```\n+\n+So the 120ns overhead when using coercion methods `__mul__` provided\n+by categories (rather than from a Cython super class) is of the same\n+order of magnitude as the cost of a trivial multiplication.\n+\n``````\n",
    "created_at": "2016-05-26T08:52:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299100",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,33 +1,77 @@
 Recall that the Sage categories provide implementations for Python's
 special methods for the basic arithmetic operations (e.g. `__mul__`,
 `__add__`), that dispatch to the coercion model or call Sage's special
-methods (e.g. `_mul_`, `_add_`) for the internal operations.
+methods (e.g. `_mul_`, `_add_`) for the internal
+operations. Furthermore, the default implementation for `_mul_` is to
+delegate the work to the `product` method of the parent.
 
-Before this ticket, this indirection induces an overhead of roughly
-500ns:
+Before this ticket, those indirections induced an overhead of roughly
+100ns for `*`, 480ns for `__mul__` and 340ns for `_mul_`:
 
 ```
-sage: S = Semigroups().example()
-sage: x = S.an_element()
-
-sage: sage: %timeit [x*x for i in range(1000)]
-1000 loops, best of 3: 1.21 ms per loop
-sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
-1000 loops, best of 3: 1.12 ms per loop
-sage: sage: %timeit [x._mul_(x) for i in range(1000)]
-1000 loops, best of 3: 643 µs per loop
+    sage: S = Semigroups().example()
+    sage: x = S.an_element()
+    sage: x*x
+    42
+    sage: sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 1.21 ms per loop
+    sage: sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 1.12 ms per loop
+    sage: sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 643 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
 ```
-(the average timing don't vary much if we try again)
 
 After this ticket, which Cythonize those methods, the overhead is
-reduced to roughly 260ns, which is a speedup by a factor of 2:
+reduced to roughly 20ns for `*`, 100ns for `__mul__` and 160ms for
+`_mul_`, which is a speedup by a factor of 3 on the accumulated
+overhead, and an overall speedup by a factor of 2 for this particular
+parent:
 
 ```
-sage: %timeit [x*x for i in range(1000)]
-1000 loops, best of 3: 929 µs per loop
-sage: %timeit [x.__mul__(x) for i in range(1000)]
-1000 loops, best of 3: 884 µs per loop
-sage: %timeit [x._mul_(x) for i in range(1000)]
-1000 loops, best of 3: 624 µs per loop
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 596 µs per loop
+    sage: %timeit [x.__mul__(x) for i in range(1000)]
+    1000 loops, best of 3: 572 µs per loop
+    sage: %timeit [x._mul_(x) for i in range(1000)]
+    1000 loops, best of 3: 467 µs per loop
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    1000 loops, best of 3: 300 µs per loop
 ```
 
+Notes
+=====
+
+The average timings vary by about 5-10% from one run to the other.
+
+In this parent, the product is trivial, and implemented as a plain
+Python `product` method in the parent. For a parent with a non trivial
+Python product, the overhead of the indirections is now of 20%, which
+is getting closer to acceptable::
+
+```
+    sage: S = Semigroups().Finite().example()
+    sage: x = S.an_element()
+    sage: %timeit [S.product(x,x) for i in range(1000)]
+    100 loops, best of 3: 4.39 ms per loop
+    sage: %timeit [x*x for i in range(1000)]
+    100 loops, best of 3: 5.28 ms per loop
+```
+
+For comparison, here is the cost of the product of two (Sage)
+integers::
+
+```
+    sage: x = 3
+    sage: %timeit [x*x for i in range(1000)]
+    1000 loops, best of 3: 162 µs per loop
+    sage: x = int(3)
+    sage: %timeit [x*x for i in range(1000)]
+    10000 loops, best of 3: 63.9 µs per loop
+```
+
+So the 120ns overhead when using coercion methods `__mul__` provided
+by categories (rather than from a Cython super class) is of the same
+order of magnitude as the cost of a trivial multiplication.
+
``````




---

archive/issue_comments_299101.json:
```json
{
    "body": "Changed commit from **[2f83f59](https://github.com/sagemath/sagetrac-mirror/commit/2f83f598d7d08ee2002b749e6ba2f81d48983a25)** to **[6ea0542](https://github.com/sagemath/sagetrac-mirror/commit/6ea05420b67b16f563fb2b1cedb098b0d6682b66)**",
    "created_at": "2016-05-26T08:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299101",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2f83f59](https://github.com/sagemath/sagetrac-mirror/commit/2f83f598d7d08ee2002b749e6ba2f81d48983a25)** to **[6ea0542](https://github.com/sagemath/sagetrac-mirror/commit/6ea05420b67b16f563fb2b1cedb098b0d6682b66)**



---

archive/issue_comments_299102.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86460abcc7250b602d6e60d62dcc119e7d28f0d9\">86460ab</a></td><td><code>20681: further optimized `__mul__`, and cythonize _mul_parent</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ea05420b67b16f563fb2b1cedb098b0d6682b66\">6ea0542</a></td><td><code>20681: updated the category primer according to the Cythonization of `__mul__` and _mul_parent</code></td></tr></table>\n",
    "created_at": "2016-05-26T08:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299102",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86460abcc7250b602d6e60d62dcc119e7d28f0d9">86460ab</a></td><td><code>20681: further optimized `__mul__`, and cythonize _mul_parent</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ea05420b67b16f563fb2b1cedb098b0d6682b66">6ea0542</a></td><td><code>20681: updated the category primer according to the Cythonization of `__mul__` and _mul_parent</code></td></tr></table>




---

archive/issue_comments_299103.json:
```json
{
    "body": "Changed commit from **[6ea0542](https://github.com/sagemath/sagetrac-mirror/commit/6ea05420b67b16f563fb2b1cedb098b0d6682b66)** to **[0698cf5](https://github.com/sagemath/sagetrac-mirror/commit/0698cf523f274626f4f1eabcd0dc224c623e3f47)**",
    "created_at": "2016-05-26T08:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299103",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6ea0542](https://github.com/sagemath/sagetrac-mirror/commit/6ea05420b67b16f563fb2b1cedb098b0d6682b66)** to **[0698cf5](https://github.com/sagemath/sagetrac-mirror/commit/0698cf523f274626f4f1eabcd0dc224c623e3f47)**



---

archive/issue_comments_299104.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0698cf523f274626f4f1eabcd0dc224c623e3f47\">0698cf5</a></td><td><code>20681: doctest fix</code></td></tr></table>\n",
    "created_at": "2016-05-26T08:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299104",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0698cf523f274626f4f1eabcd0dc224c623e3f47">0698cf5</a></td><td><code>20681: doctest fix</code></td></tr></table>




---

archive/issue_comments_299105.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -40,8 +40,7 @@\n     1000 loops, best of 3: 300 \u00b5s per loop\n ```\n \n-Notes\n-=====\n+*Notes*\n \n The average timings vary by about 5-10% from one run to the other.\n \n``````\n",
    "created_at": "2016-05-26T09:00:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299105",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -40,8 +40,7 @@
     1000 loops, best of 3: 300 µs per loop
 ```
 
-Notes
-=====
+*Notes*
 
 The average timings vary by about 5-10% from one run to the other.
 
``````




---

archive/issue_events_291169.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-26T09:00:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291169"
}
```



---

archive/issue_events_291170.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-26T09:00:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291170"
}
```



---

archive/issue_comments_299106.json:
```json
{
    "body": "Changed branch from **[u/nthiery/cythonize_arithmetic_special_methods_in_the_categories](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/cythonize_arithmetic_special_methods_in_the_categories)** to **[public/categories/cythonize_arithmetic_special_methods-20681](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/cythonize_arithmetic_special_methods-20681)**",
    "created_at": "2016-05-26T09:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299106",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/nthiery/cythonize_arithmetic_special_methods_in_the_categories](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/cythonize_arithmetic_special_methods_in_the_categories)** to **[public/categories/cythonize_arithmetic_special_methods-20681](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/cythonize_arithmetic_special_methods-20681)**



---

archive/issue_comments_299107.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8024147bc82c55fadd2baf7f02cfad9ea838885f\">8024147</a></td><td><code>Some little doc fixes while-we-are-at-it (tm).</code></td></tr></table>\n",
    "created_at": "2016-05-26T09:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299107",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8024147bc82c55fadd2baf7f02cfad9ea838885f">8024147</a></td><td><code>Some little doc fixes while-we-are-at-it (tm).</code></td></tr></table>




---

archive/issue_comments_299108.json:
```json
{
    "body": "Changed commit from **[0698cf5](https://github.com/sagemath/sagetrac-mirror/commit/0698cf523f274626f4f1eabcd0dc224c623e3f47)** to **[8024147](https://github.com/sagemath/sagetrac-mirror/commit/8024147bc82c55fadd2baf7f02cfad9ea838885f)**",
    "created_at": "2016-05-26T09:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299108",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[0698cf5](https://github.com/sagemath/sagetrac-mirror/commit/0698cf523f274626f4f1eabcd0dc224c623e3f47)** to **[8024147](https://github.com/sagemath/sagetrac-mirror/commit/8024147bc82c55fadd2baf7f02cfad9ea838885f)**



---

archive/issue_comments_299109.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f44f49d7b93d47e9c46b923725dea7ff7fff3d0\">9f44f49</a></td><td><code>20681: further improved the documentation of the coercion methods</code></td></tr></table>\n",
    "created_at": "2016-05-26T10:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299109",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f44f49d7b93d47e9c46b923725dea7ff7fff3d0">9f44f49</a></td><td><code>20681: further improved the documentation of the coercion methods</code></td></tr></table>




---

archive/issue_comments_299110.json:
```json
{
    "body": "Changed commit from **[8024147](https://github.com/sagemath/sagetrac-mirror/commit/8024147bc82c55fadd2baf7f02cfad9ea838885f)** to **[9f44f49](https://github.com/sagemath/sagetrac-mirror/commit/9f44f49d7b93d47e9c46b923725dea7ff7fff3d0)**",
    "created_at": "2016-05-26T10:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299110",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8024147](https://github.com/sagemath/sagetrac-mirror/commit/8024147bc82c55fadd2baf7f02cfad9ea838885f)** to **[9f44f49](https://github.com/sagemath/sagetrac-mirror/commit/9f44f49d7b93d47e9c46b923725dea7ff7fff3d0)**



---

archive/issue_comments_299111.json:
```json
{
    "body": "Changed commit from **[9f44f49](https://github.com/sagemath/sagetrac-mirror/commit/9f44f49d7b93d47e9c46b923725dea7ff7fff3d0)** to **[de62437](https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd)**",
    "created_at": "2016-05-26T10:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299111",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9f44f49](https://github.com/sagemath/sagetrac-mirror/commit/9f44f49d7b93d47e9c46b923725dea7ff7fff3d0)** to **[de62437](https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd)**



---

archive/issue_comments_299112.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd\">de62437</a></td><td><code>20681: ReST fixes</code></td></tr></table>\n",
    "created_at": "2016-05-26T10:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299112",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd">de62437</a></td><td><code>20681: ReST fixes</code></td></tr></table>




---

archive/issue_comments_299113.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd\">de62437</a></td><td><code>20681: ReST fixes</code></td></tr></table>\n",
    "created_at": "2016-05-26T10:16:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299113",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:13"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd">de62437</a></td><td><code>20681: ReST fixes</code></td></tr></table>




---

archive/issue_comments_299114.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -40,7 +40,7 @@\n     1000 loops, best of 3: 300 \u00b5s per loop\n ```\n \n-*Notes*\n+=Notes=\n \n The average timings vary by about 5-10% from one run to the other.\n \n``````\n",
    "created_at": "2016-05-26T10:16:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299114",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -40,7 +40,7 @@
     1000 loops, best of 3: 300 µs per loop
 ```
 
-*Notes*
+=Notes=
 
 The average timings vary by about 5-10% from one run to the other.
 
``````




---

archive/issue_events_291171.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-26T10:16:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291171"
}
```



---

archive/issue_events_291172.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-26T10:16:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291172"
}
```



---

archive/issue_events_291173.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-05-26T11:32:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291173"
}
```



---

archive/issue_events_291174.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-05-26T11:32:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291174"
}
```



---

archive/issue_comments_299115.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI understand the point of this patch, but I think it's not the right thing to do. The methods you define now in `coercion_methods.pyx` are just copies of methods available in various subclasses of `Element` anyway (e.g. `ModuleElement`, `RingElement`).\n\nI think the right thing to do is just to get rid of the category framework for these arithmetic methods and just define them in `Element`. That will be even faster than the current patch.",
    "created_at": "2016-05-26T11:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299115",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

I understand the point of this patch, but I think it's not the right thing to do. The methods you define now in `coercion_methods.pyx` are just copies of methods available in various subclasses of `Element` anyway (e.g. `ModuleElement`, `RingElement`).

I think the right thing to do is just to get rid of the category framework for these arithmetic methods and just define them in `Element`. That will be even faster than the current patch.



---

archive/issue_comments_299116.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nIn other words: you write\n\n```\n# This could eventually be moved to SageObject\n```\nI think you should just do that instead (but for `Element` instead of `SageObject`).",
    "created_at": "2016-05-26T11:35:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299116",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

In other words: you write

```
# This could eventually be moved to SageObject
```
I think you should just do that instead (but for `Element` instead of `SageObject`).



---

archive/issue_comments_299117.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nNote that I don't really have anything against this ticket (if it improves things, why not). So, feel free to set the ticket back to positive_review if you disagree with me.",
    "created_at": "2016-05-26T11:41:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299117",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Note that I don't really have anything against this ticket (if it improves things, why not). So, feel free to set the ticket back to positive_review if you disagree with me.



---

archive/issue_comments_299118.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jdemeyer](#comment:16):\n> In other words: you write\n> \n> ```\n> # This could eventually be moved to SageObject\n> ```\n> I think you should just do that instead (but for `Element` instead of `SageObject`).\n\n(for the record: I just moved that comment which was already there).\n\nYes, I pondered about that, since we had this parallel discussion\nabout moving all the coercion methods up to Element. If we do the\nmove, we should do it for all coercion methods at once. However, given\nthat this moving is a non trivial API change and still under\ndiscussion, I prefer to postpone it to a later ticket.",
    "created_at": "2016-05-26T12:57:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299118",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jdemeyer](#comment:16):
> In other words: you write
> 
> ```
> # This could eventually be moved to SageObject
> ```
> I think you should just do that instead (but for `Element` instead of `SageObject`).

(for the record: I just moved that comment which was already there).

Yes, I pondered about that, since we had this parallel discussion
about moving all the coercion methods up to Element. If we do the
move, we should do it for all coercion methods at once. However, given
that this moving is a non trivial API change and still under
discussion, I prefer to postpone it to a later ticket.



---

archive/issue_events_291175.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-26T12:58:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291175"
}
```



---

archive/issue_events_291176.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-26T12:58:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291176"
}
```



---

archive/issue_comments_299119.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThanks though for raising this!",
    "created_at": "2016-05-26T12:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299119",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:19" align="right">comment:19</div>

Thanks though for raising this!



---

archive/issue_comments_299120.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nsee patchbot report",
    "created_at": "2016-05-27T23:02:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299120",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:20" align="right">comment:20</div>

see patchbot report



---

archive/issue_events_291177.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-27T23:02:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291177"
}
```



---

archive/issue_events_291178.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-27T23:02:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291178"
}
```



---

archive/issue_comments_299121.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99f986867ea06d7fe494d315a11de955b189594d\">99f9868</a></td><td><code>Fixing documentation.</code></td></tr></table>\n",
    "created_at": "2016-05-28T07:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299121",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99f986867ea06d7fe494d315a11de955b189594d">99f9868</a></td><td><code>Fixing documentation.</code></td></tr></table>




---

archive/issue_comments_299122.json:
```json
{
    "body": "Changed commit from **[de62437](https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd)** to **[99f9868](https://github.com/sagemath/sagetrac-mirror/commit/99f986867ea06d7fe494d315a11de955b189594d)**",
    "created_at": "2016-05-28T07:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299122",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[de62437](https://github.com/sagemath/sagetrac-mirror/commit/de62437f434f282dd41256ff9529d4aca3d679fd)** to **[99f9868](https://github.com/sagemath/sagetrac-mirror/commit/99f986867ea06d7fe494d315a11de955b189594d)**



---

archive/issue_events_291179.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-28T07:43:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291179"
}
```



---

archive/issue_events_291180.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-28T07:43:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291180"
}
```



---

archive/issue_comments_299123.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nNicolas, can you double check. Also are the referenced methods correct in the `__*mul__` doc?",
    "created_at": "2016-05-28T07:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299123",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:22" align="right">comment:22</div>

Nicolas, can you double check. Also are the referenced methods correct in the `__*mul__` doc?



---

archive/issue_comments_299124.json:
```json
{
    "body": "Changed commit from **[99f9868](https://github.com/sagemath/sagetrac-mirror/commit/99f986867ea06d7fe494d315a11de955b189594d)** to **[6ad71d4](https://github.com/sagemath/sagetrac-mirror/commit/6ad71d48edfeb6743488810f416ae1d430ff5dff)**",
    "created_at": "2016-05-28T08:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299124",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[99f9868](https://github.com/sagemath/sagetrac-mirror/commit/99f986867ea06d7fe494d315a11de955b189594d)** to **[6ad71d4](https://github.com/sagemath/sagetrac-mirror/commit/6ad71d48edfeb6743488810f416ae1d430ff5dff)**



---

archive/issue_comments_299125.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ad71d48edfeb6743488810f416ae1d430ff5dff\">6ad71d4</a></td><td><code>20681: trivial space adjustment</code></td></tr></table>\n",
    "created_at": "2016-05-28T08:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299125",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ad71d48edfeb6743488810f416ae1d430ff5dff">6ad71d4</a></td><td><code>20681: trivial space adjustment</code></td></tr></table>




---

archive/issue_events_291181.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-28T08:36:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291181"
}
```



---

archive/issue_events_291182.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-28T08:36:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291182"
}
```



---

archive/issue_comments_299126.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThanks for all the rest fixes! I had actually just about to start working on them :-)",
    "created_at": "2016-05-28T08:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299126",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:24" align="right">comment:24</div>

Thanks for all the rest fixes! I had actually just about to start working on them :-)



---

archive/issue_comments_299127.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nPDF docs still don't build",
    "created_at": "2016-05-28T14:19:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299127",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

PDF docs still don't build



---

archive/issue_events_291183.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-28T14:19:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291183"
}
```



---

archive/issue_events_291184.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-28T14:19:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291184"
}
```



---

archive/issue_comments_299128.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nMy guess is that it doesn't like that `coercion_methods.pyx` does not have any public methods. We probably should `autodoc` those all in anyways...",
    "created_at": "2016-05-29T13:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299128",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">comment:26</div>

My guess is that it doesn't like that `coercion_methods.pyx` does not have any public methods. We probably should `autodoc` those all in anyways...



---

archive/issue_comments_299129.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e88e4c311b0108f21d28a2c3587193e364ee0fd\">4e88e4c</a></td><td><code>20681: ReST fix</code></td></tr></table>\n",
    "created_at": "2016-05-30T06:57:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299129",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e88e4c311b0108f21d28a2c3587193e364ee0fd">4e88e4c</a></td><td><code>20681: ReST fix</code></td></tr></table>




---

archive/issue_comments_299130.json:
```json
{
    "body": "Changed commit from **[6ad71d4](https://github.com/sagemath/sagetrac-mirror/commit/6ad71d48edfeb6743488810f416ae1d430ff5dff)** to **[4e88e4c](https://github.com/sagemath/sagetrac-mirror/commit/4e88e4c311b0108f21d28a2c3587193e364ee0fd)**",
    "created_at": "2016-05-30T06:57:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299130",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6ad71d4](https://github.com/sagemath/sagetrac-mirror/commit/6ad71d48edfeb6743488810f416ae1d430ff5dff)** to **[4e88e4c](https://github.com/sagemath/sagetrac-mirror/commit/4e88e4c311b0108f21d28a2c3587193e364ee0fd)**



---

archive/issue_comments_299131.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nDo we want to include these functions into the html/pdf doc or keep them hidden?",
    "created_at": "2016-05-30T08:21:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299131",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:28" align="right">comment:28</div>

Do we want to include these functions into the html/pdf doc or keep them hidden?



---

archive/issue_comments_299132.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nWe definitely would want to have them appear in the doc of the original classes. But this will only happen when we finally configure Sphinx to include the special methods (which are not private methods!).\n\nFor the \"coercion_methods\" module, it does not really matter.\n\nThe pdf doc compiles on my machine after my latest rest fix.",
    "created_at": "2016-05-30T21:50:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299132",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:29" align="right">comment:29</div>

We definitely would want to have them appear in the doc of the original classes. But this will only happen when we finally configure Sphinx to include the special methods (which are not private methods!).

For the "coercion_methods" module, it does not really matter.

The pdf doc compiles on my machine after my latest rest fix.



---

archive/issue_events_291185.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-30T21:50:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291185"
}
```



---

archive/issue_events_291186.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-30T21:50:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291186"
}
```



---

archive/issue_events_291187.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-30T21:52:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291187"
}
```



---

archive/issue_events_291188.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-30T21:52:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291188"
}
```



---

archive/issue_comments_299133.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nOkay. Let's get this into Sage.",
    "created_at": "2016-05-30T21:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299133",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:31" align="right">comment:31</div>

Okay. Let's get this into Sage.



---

archive/issue_comments_299134.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nPart of this ticket was already merged in 7.3.beta2. Please take whatever else was on this ticket and move it to a new ticket.",
    "created_at": "2016-05-31T07:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299134",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:32" align="right">comment:32</div>

Part of this ticket was already merged in 7.3.beta2. Please take whatever else was on this ticket and move it to a new ticket.



---

archive/issue_events_291189.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-31T07:36:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291189"
}
```



---

archive/issue_events_291190.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-31T07:36:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20681#event-291190"
}
```



---

archive/issue_comments_299135.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nSee #20733",
    "created_at": "2016-05-31T13:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299135",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

See #20733



---

archive/issue_comments_299136.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nFollow-up: most of this new file will be removed in #20767. Only `_mul_parent` will remain.",
    "created_at": "2016-08-01T15:16:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20681#issuecomment-299136",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Follow-up: most of this new file will be removed in #20767. Only `_mul_parent` will remain.
