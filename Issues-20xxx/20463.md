# Issue 20463: Pari segfault on Sage startup in Cygwin (2)

archive/issues_020226.json:
```json
{
    "body": "Due to a Cygwin bug https://cygwin.com/ml/cygwin/2016-05/msg00140.html there is a segmentation fault when the PARI maximum stack size is larger than 4GB.\n\nThe issue has also been reported to PARI: http://pari.math.u-bordeaux.fr/archives/pari-dev-1605/threads.html\n\nKeywords: cygwin windows\n\nBranch/Commit: 856f128777c04a88e4efe6295e98292a2f0cc7e2\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Jeroen Demeyer\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20463\n\n",
    "closed_at": "2016-09-10T09:00:27Z",
    "created_at": "2016-04-19T07:58:26Z",
    "labels": [
        "component: porting: cygwin",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Pari segfault on Sage startup in Cygwin (2)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20463",
    "user": "https://github.com/embray"
}
```
Due to a Cygwin bug https://cygwin.com/ml/cygwin/2016-05/msg00140.html there is a segmentation fault when the PARI maximum stack size is larger than 4GB.

The issue has also been reported to PARI: http://pari.math.u-bordeaux.fr/archives/pari-dev-1605/threads.html

Keywords: cygwin windows

Branch/Commit: 856f128777c04a88e4efe6295e98292a2f0cc7e2

Upstream: Fixed upstream, in a later stable release.

Reviewer: Jeroen Demeyer

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20463





---

archive/issue_comments_278328.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-12T13:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278328",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_278329.json:
```json
{
    "body": "Changing keywords from \"\" to \"cygwin windows\".",
    "created_at": "2016-05-12T13:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278329",
    "user": "https://github.com/embray"
}
```

Changing keywords from "" to "cygwin windows".



---

archive/issue_comments_278330.json:
```json
{
    "body": "<a id='comment:1'></a>I have discovered what I think is the cause of this issue, and have reported it upstream--I believe it to be an issue in Cygwin: https://cygwin.com/ml/cygwin/2016-05/msg00140.html\n\nI've attached a workaround for the issue from the Sage end.  I'm not terribly happy with it, because if I understand correctly PARI will automatically grow its stack size as needed, and if it grows beyond 4GB this bug *could* still occur (though I haven't tested this yet--anyone want to suggest to me a good way to test it?)\n\nI'm not sure how best to work around that though without completely taking over PARI's stack management.  Probably fine just to leave it as a known issue until there's a fix in Cygwin. It's more important that we don't immediately segfault as soon as the first PARI number is created.\n\n---\nNew commits:",
    "created_at": "2016-05-12T13:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278330",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>I have discovered what I think is the cause of this issue, and have reported it upstream--I believe it to be an issue in Cygwin: https://cygwin.com/ml/cygwin/2016-05/msg00140.html

I've attached a workaround for the issue from the Sage end.  I'm not terribly happy with it, because if I understand correctly PARI will automatically grow its stack size as needed, and if it grows beyond 4GB this bug *could* still occur (though I haven't tested this yet--anyone want to suggest to me a good way to test it?)

I'm not sure how best to work around that though without completely taking over PARI's stack management.  Probably fine just to leave it as a known issue until there's a fix in Cygwin. It's more important that we don't immediately segfault as soon as the first PARI number is created.

---
New commits:



---

archive/issue_comments_278331.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-05-12T13:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_278332.json:
```json
{
    "body": "<a id='comment:3'></a>(Oops, had a typo in the original commit)",
    "created_at": "2016-05-12T13:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278332",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>(Oops, had a typo in the original commit)



---

archive/issue_comments_278333.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:1 embray]:\n> if I understand correctly PARI will automatically grow its stack size as needed\n\n\nPARI will automatically grow its stack up to some user-provided maximum. The function is\n\n```\nparistack_setsize(size, vsize)       \n```\nwhere `size` is the actual size and `vsize` the maximum size.",
    "created_at": "2016-05-12T15:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278333",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Replying to [comment:1 embray]:
> if I understand correctly PARI will automatically grow its stack size as needed


PARI will automatically grow its stack up to some user-provided maximum. The function is

```
paristack_setsize(size, vsize)       
```
where `size` is the actual size and `vsize` the maximum size.



---

archive/issue_comments_278334.json:
```json
{
    "body": "<a id='comment:5'></a>...which implies that the correct work-around for Cygwin is simply to limit the second argument of `paristack_setsize()`.",
    "created_at": "2016-05-12T15:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278334",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>...which implies that the correct work-around for Cygwin is simply to limit the second argument of `paristack_setsize()`.



---

archive/issue_events_055334.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-05-12T15:06:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20463#event-55334"
}
```



---

archive/issue_comments_278335.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-12T15:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278335",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_278336.json:
```json
{
    "body": "<a id='comment:6'></a>Note also that *not* calling `paristack_setsize()` is not really an option: you would end up with a small stack which cannot be increased. I'm pretty sure that some Sage functionality assumes a PARI stack which is larger than the default size.",
    "created_at": "2016-05-12T15:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278336",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Note also that *not* calling `paristack_setsize()` is not really an option: you would end up with a small stack which cannot be increased. I'm pretty sure that some Sage functionality assumes a PARI stack which is larger than the default size.



---

archive/issue_comments_278337.json:
```json
{
    "body": "<a id='comment:7'></a>We should probably also report this to upstream PARI (I guess the problem can be reproduced inside PARI/GP itself), such that they might apply the workaround.",
    "created_at": "2016-05-12T20:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278337",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>We should probably also report this to upstream PARI (I guess the problem can be reproduced inside PARI/GP itself), such that they might apply the workaround.



---

archive/issue_comments_278338.json:
```json
{
    "body": "<a id='comment:9'></a>I was under the assumption that it would grow automatically as needed, but maybe I shouldn't assume that it works nicely....",
    "created_at": "2016-05-13T09:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278338",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>I was under the assumption that it would grow automatically as needed, but maybe I shouldn't assume that it works nicely....



---

archive/issue_comments_278339.json:
```json
{
    "body": "<a id='comment:11'></a>I have an update to this patch somewhere, I just haven't gotten around to pushing it yet.\n\nIn the meantime Cygwin has acknowledged the bug and pushed the fix.  I just confirmed that the fix seems to work (there's no segfault, at least): https://www.cygwin.com/ml/cygwin/2016-05/msg00240.html\n\nNot sure yet when the fix will be in a release.  I may update this to include a version check on Cygwin once it makes sense to.",
    "created_at": "2016-05-31T13:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278339",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>I have an update to this patch somewhere, I just haven't gotten around to pushing it yet.

In the meantime Cygwin has acknowledged the bug and pushed the fix.  I just confirmed that the fix seems to work (there's no segfault, at least): https://www.cygwin.com/ml/cygwin/2016-05/msg00240.html

Not sure yet when the fix will be in a release.  I may update this to include a version check on Cygwin once it makes sense to.



---

archive/issue_comments_278340.json:
```json
{
    "body": "<a id='comment:12'></a>Per [this commit](https://sourceware.org/git/gitweb.cgi?p=newlib-cygwin.git;a=blobdiff;f=winsup/cygwin/release/2.5.2;h=c60f0fc032e08ddbf3d5bb293afad10f777e7f06;hp=0ea77206faa62491b185f5a35200b389139548ed;hb=4e434bf223c301cd2690a3fe1cde2a84c0d5b624;hpb=0aa738220bb9dea2ad479e484560767b36701947), the fix for this should appear in Cygwin v2.5.2.",
    "created_at": "2016-05-31T13:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278340",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>Per [this commit](https://sourceware.org/git/gitweb.cgi?p=newlib-cygwin.git;a=blobdiff;f=winsup/cygwin/release/2.5.2;h=c60f0fc032e08ddbf3d5bb293afad10f777e7f06;hp=0ea77206faa62491b185f5a35200b389139548ed;hb=4e434bf223c301cd2690a3fe1cde2a84c0d5b624;hpb=0aa738220bb9dea2ad479e484560767b36701947), the fix for this should appear in Cygwin v2.5.2.



---

archive/issue_comments_278341.json:
```json
{
    "body": "<a id='comment:13'></a>If I were to put in a constant or function to get the Cygwin version (where relevant) where would be a good place to put that?  `sage.env`, maybe?",
    "created_at": "2016-05-31T14:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278341",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>If I were to put in a constant or function to get the Cygwin version (where relevant) where would be a good place to put that?  `sage.env`, maybe?



---

archive/issue_comments_278342.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-30T16:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278343.json:
```json
{
    "body": "<a id='comment:15'></a>Now always calls `paristack_setsize()`, but to a smaller value on platforms with this issue.\n\nAlso added an explicit check on the cygwin version, and does not invoke the workaround for Cygwin v2.5.2 where this is fixed.",
    "created_at": "2016-06-30T16:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278343",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>Now always calls `paristack_setsize()`, but to a smaller value on platforms with this issue.

Also added an explicit check on the cygwin version, and does not invoke the workaround for Cygwin v2.5.2 where this is fixed.



---

archive/issue_comments_278344.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-06-30T16:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278344",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_278345.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-27T09:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278345",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278346.json:
```json
{
    "body": "<a id='comment:18'></a>I would prefer something along the lines of\n\n```\nsizemax = mem.virtual_memory_limit() // 4\n\nif USING_BROKEN_VERSION_OF_CYGWIN and sizemax > KNOWN_WORKING_SIZE:\n    # Cygwin's mmap is broken for large mmaps (>~ 4GB):\n    # * https://trac.sagemath.org/ticket/20463\n    # * https://cygwin.com/ml/cygwin/2016-05/msg00140.html\n    #\n    # The underlying issue is fixed in Cygwin v2.5.2\n    sizemax = KNOWN_WORKING_SIZE\n\nparistack_setsize(size, sizemax)\n```",
    "created_at": "2016-07-27T10:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278346",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>I would prefer something along the lines of

```
sizemax = mem.virtual_memory_limit() // 4

if USING_BROKEN_VERSION_OF_CYGWIN and sizemax > KNOWN_WORKING_SIZE:
    # Cygwin's mmap is broken for large mmaps (>~ 4GB):
    # * https://trac.sagemath.org/ticket/20463
    # * https://cygwin.com/ml/cygwin/2016-05/msg00140.html
    #
    # The underlying issue is fixed in Cygwin v2.5.2
    sizemax = KNOWN_WORKING_SIZE

paristack_setsize(size, sizemax)
```



---

archive/issue_comments_278347.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-27T10:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278347",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_278348.json:
```json
{
    "body": "<a id='comment:19'></a>That's fine, but you don't literally mean `USING_BROKEN_VERSION_OF_CYGWIN` do you?  The explicit version check that's there is much clearer.",
    "created_at": "2016-07-27T11:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278348",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>That's fine, but you don't literally mean `USING_BROKEN_VERSION_OF_CYGWIN` do you?  The explicit version check that's there is much clearer.



---

archive/issue_comments_278349.json:
```json
{
    "body": "<a id='comment:20'></a>No, not literal. Replace `USING_BROKEN_VERSION_OF_CYGWIN` and `KNOWN_WORKING_SIZE` by whatever you want.",
    "created_at": "2016-07-27T12:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278349",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>No, not literal. Replace `USING_BROKEN_VERSION_OF_CYGWIN` and `KNOWN_WORKING_SIZE` by whatever you want.



---

archive/issue_comments_278350.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-16T13:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278351.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-16T13:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278351",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_278352.json:
```json
{
    "body": "<a id='comment:23'></a>Yes, this is better.\n\nI just don't understand why you talk of a limit of 4GB but then use 1GB (actually0x3fffffff) in the code?",
    "created_at": "2016-08-16T14:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278352",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Yes, this is better.

I just don't understand why you talk of a limit of 4GB but then use 1GB (actually0x3fffffff) in the code?



---

archive/issue_comments_278353.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-08-16T14:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278353",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_278354.json:
```json
{
    "body": "<a id='comment:24'></a>To be honest I'm not exactly sure why either, though I might have been at one time (it's not like I've really worked on this recently.  I know that for starters I was just going by how the default takes `mem.virtual_memory_limit() // 4` so I also divided by 4.  And then when I went much over that it still crashed so I just kept it at 1GB (minus 1)",
    "created_at": "2016-08-16T14:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278354",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>To be honest I'm not exactly sure why either, though I might have been at one time (it's not like I've really worked on this recently.  I know that for starters I was just going by how the default takes `mem.virtual_memory_limit() // 4` so I also divided by 4.  And then when I went much over that it still crashed so I just kept it at 1GB (minus 1)



---

archive/issue_comments_278355.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 embray]:\n> I was just going by how the default takes `mem.virtual_memory_limit() // 4`\n\n\nThat division by 4 is simply to determine how much memory should be used. It is a totally arbitrary number and it should be unrelated to the limit on Cygwin.\n\nDid you run full doctests (`make ptestlong`) on Cygwin with this patch?",
    "created_at": "2016-08-16T14:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278355",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Replying to [comment:24 embray]:
> I was just going by how the default takes `mem.virtual_memory_limit() // 4`


That division by 4 is simply to determine how much memory should be used. It is a totally arbitrary number and it should be unrelated to the limit on Cygwin.

Did you run full doctests (`make ptestlong`) on Cygwin with this patch?



---

archive/issue_comments_278356.json:
```json
{
    "body": "<a id='comment:26'></a>`make ptestlog` is kind of useless right now because many other tests are failing (though I'm closing to having them all fixed now).  That said, with this patch I haven't gotten any further segfaults from the Pari interface.\n\nI'll have to double check on the actual limit.  IIRC using just under 4 GB still didn't work, although possibly due to page alignment requirements, etc.  It's been a while since I experimented with it.  Another problem I remember having was there was a heisenbug where the pari interface segfaults *only* in gdb unless I remove the `paristack_setsize` call entirely.  Outside the debugger though it works.",
    "created_at": "2016-08-16T14:52:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278356",
    "user": "https://github.com/embray"
}
```

<a id='comment:26'></a>`make ptestlog` is kind of useless right now because many other tests are failing (though I'm closing to having them all fixed now).  That said, with this patch I haven't gotten any further segfaults from the Pari interface.

I'll have to double check on the actual limit.  IIRC using just under 4 GB still didn't work, although possibly due to page alignment requirements, etc.  It's been a while since I experimented with it.  Another problem I remember having was there was a heisenbug where the pari interface segfaults *only* in gdb unless I remove the `paristack_setsize` call entirely.  Outside the debugger though it works.



---

archive/issue_comments_278357.json:
```json
{
    "body": "<a id='comment:27'></a>Would a limit of, say `0xf0000000` (3.75 GB) work?",
    "created_at": "2016-08-16T14:56:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278357",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Would a limit of, say `0xf0000000` (3.75 GB) work?



---

archive/issue_comments_278358.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-05T12:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278359.json:
```json
{
    "body": "<a id='comment:29'></a>Confirmed that `0xf0000000` works, so that's close enough.\n\n---\nNew commits:",
    "created_at": "2016-09-05T12:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278359",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'></a>Confirmed that `0xf0000000` works, so that's close enough.

---
New commits:



---

archive/issue_comments_278360.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-09-05T12:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278360",
    "user": "https://github.com/embray"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_278361.json:
```json
{
    "body": "<a id='comment:30'></a>This comment does not really makes sense, I suggest to delete these 2 lines:\n\n```\n            # So we will just let the pari stack size grow as needed; if\n            # it grows beyond 4GB this issue could still be triggered\n```\nThe stack will only grow \"as needed\" up to the virtual stack size, which is at most `0xf0000000`.",
    "created_at": "2016-09-05T13:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278361",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>This comment does not really makes sense, I suggest to delete these 2 lines:

```
            # So we will just let the pari stack size grow as needed; if
            # it grows beyond 4GB this issue could still be triggered
```
The stack will only grow "as needed" up to the virtual stack size, which is at most `0xf0000000`.



---

archive/issue_comments_278362.json:
```json
{
    "body": "<a id='comment:31'></a>Oh, you're right. That's from an older version of the patch where it wasn't setting a max stack size at all.",
    "created_at": "2016-09-06T07:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278362",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'></a>Oh, you're right. That's from an older version of the patch where it wasn't setting a max stack size at all.



---

archive/issue_comments_278363.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-06T07:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278364.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-09-06T22:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278364",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055335.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-09-10T09:00:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20463#event-55335"
}
```



---

archive/issue_comments_278365.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-09-10T09:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20463#issuecomment-278365",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
