# Issue 20602: Deprecate MixedIntegerLinearProgram.gen(), __call__, linear_function, which do not do anything useful; add default_variable method

archive/issues_020365.json:
```json
{
    "body": "As observed in the comments in #20461:\n\n```\nsage: mip = MixedIntegerLinearProgram(solver='GLPK')\nsage: mip.gen(0)           ### Names a variable, but does not create it in the backend\nx_0\nsage: mip.number_of_variables()\n0\nsage: mip[0]                  ### This now creates a variable. It prints the same as the result of gen(0), but is different.\nx_0\nsage: mip.get_values(mip.gen(0))\n[...]\nTypeError: Not a MIPVariable: x_0\nsage: mip.is_real(mip.gen(0))\n[...]\nKeyError: x_0\nsage: mip.is_real(mip[0])\nTrue\n```\n\nTo summarize, the `gen` method pretends that it can refer to backend variables (and so do `linear_function` and the special `__call__` method that is identical to `linear_function`). In reality, these methods cannot be use for anything except for what is tested in the docstring: printing some meaningless stuff. \n\nThis patch deprecates these three methods and removes the corresponding confusing and useless examples from the class documentation.\n\nIn return, the notion of the \"default MIP variable\" (which `__getitem__` refers to) is explained; and it is exposed to the user by new method `default_variable`. \n\n\n\nCC:  @nbruin @dimpase @videlec @jdemeyer @fchapoton @novoselt\n\nKeywords: lp\n\nBranch/Commit: 684e91cad780b7dd2b0ec04e514b5ecf9ec95af0\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20602\n\n",
    "closed_at": "2016-07-16T20:06:42Z",
    "created_at": "2016-05-13T07:51:53Z",
    "labels": [
        "component: numerical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Deprecate MixedIntegerLinearProgram.gen(), __call__, linear_function, which do not do anything useful; add default_variable method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20602",
    "user": "https://github.com/mkoeppe"
}
```
As observed in the comments in #20461:

```
sage: mip = MixedIntegerLinearProgram(solver='GLPK')
sage: mip.gen(0)           ### Names a variable, but does not create it in the backend
x_0
sage: mip.number_of_variables()
0
sage: mip[0]                  ### This now creates a variable. It prints the same as the result of gen(0), but is different.
x_0
sage: mip.get_values(mip.gen(0))
[...]
TypeError: Not a MIPVariable: x_0
sage: mip.is_real(mip.gen(0))
[...]
KeyError: x_0
sage: mip.is_real(mip[0])
True
```

To summarize, the `gen` method pretends that it can refer to backend variables (and so do `linear_function` and the special `__call__` method that is identical to `linear_function`). In reality, these methods cannot be use for anything except for what is tested in the docstring: printing some meaningless stuff. 

This patch deprecates these three methods and removes the corresponding confusing and useless examples from the class documentation.

In return, the notion of the "default MIP variable" (which `__getitem__` refers to) is explained; and it is exposed to the user by new method `default_variable`. 



CC:  @nbruin @dimpase @videlec @jdemeyer @fchapoton @novoselt

Keywords: lp

Branch/Commit: 684e91cad780b7dd2b0ec04e514b5ecf9ec95af0

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20602





---

archive/issue_comments_298772.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -18,6 +18,12 @@\n True\n ```\n \n+I think mip.gen(i) should simply return the same variable that mip[i] returns (and like mip[i], it should create this variable in the backend if it does not exist yet). \n+\n+\n+\n+\n+\n Comment: 1\n \n Summary: MixedIntegerLinearProgram.gen() does not do anything useful\n```\n",
    "created_at": "2016-05-23T16:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298772",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -18,6 +18,12 @@
 True
 ```
 
+I think mip.gen(i) should simply return the same variable that mip[i] returns (and like mip[i], it should create this variable in the backend if it does not exist yet). 
+
+
+
+
+
 Comment: 1
 
 Summary: MixedIntegerLinearProgram.gen() does not do anything useful
```




---

archive/issue_comments_298773.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+As observed in the comments in #20461:\n+\n+```\n+sage: mip = MixedIntegerLinearProgram(solver='GLPK')\n+sage: mip.gen(0)           ### Names a variable, but does not create it in the backend\n+x_0\n+sage: mip.number_of_variables()\n+0\n+sage: mip[0]                  ### This now creates a variable. It prints the same as the result of gen(0), but is different.\n+x_0\n+sage: mip.get_values(mip.gen(0))\n+[...]\n+TypeError: Not a MIPVariable: x_0\n+sage: mip.is_real(mip.gen(0))\n+[...]\n+KeyError: x_0\n+sage: mip.is_real(mip[0])\n+True\n+```\n+\n+To summarize, the `gen` method pretends that it can refer to backend variables (and so do `linear_function` and the special `__call__` method that is identical to `linear_function`). In reality, these methods cannot be use for anything except for what is tested in the docstring: printing some meaningless stuff. \n+\n+This patch deprecates these three methods and removes the corresponding confusing and useless examples from the class documentation.\n+\n+In return, the notion of the \"default MIP variable\" (which `__getitem__` refers to) is explained; and it is exposed to the user by new method `default_variable`. \n+\n \n \n Comment: 1\n```\n",
    "created_at": "2016-06-27T01:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298773",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,29 @@
+As observed in the comments in #20461:
+
+```
+sage: mip = MixedIntegerLinearProgram(solver='GLPK')
+sage: mip.gen(0)           ### Names a variable, but does not create it in the backend
+x_0
+sage: mip.number_of_variables()
+0
+sage: mip[0]                  ### This now creates a variable. It prints the same as the result of gen(0), but is different.
+x_0
+sage: mip.get_values(mip.gen(0))
+[...]
+TypeError: Not a MIPVariable: x_0
+sage: mip.is_real(mip.gen(0))
+[...]
+KeyError: x_0
+sage: mip.is_real(mip[0])
+True
+```
+
+To summarize, the `gen` method pretends that it can refer to backend variables (and so do `linear_function` and the special `__call__` method that is identical to `linear_function`). In reality, these methods cannot be use for anything except for what is tested in the docstring: printing some meaningless stuff. 
+
+This patch deprecates these three methods and removes the corresponding confusing and useless examples from the class documentation.
+
+In return, the notion of the "default MIP variable" (which `__getitem__` refers to) is explained; and it is exposed to the user by new method `default_variable`. 
+
 
 
 Comment: 1
```




---

archive/issue_comments_298774.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2016-06-27T01:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298774",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_298775.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-27T01:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298775",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_298776.json:
```json
{
    "body": "<a id='comment:5'></a>If the old methods were indeed always broken and could not be used for anything useful, I say - just delete (or fix) them instead of deprecating...",
    "created_at": "2016-06-27T02:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298776",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>If the old methods were indeed always broken and could not be used for anything useful, I say - just delete (or fix) them instead of deprecating...



---

archive/issue_comments_298777.json:
```json
{
    "body": "<a id='comment:6'></a>It's possible that there's some user code around that uses these methods as part of a workaround for the many bugs that had to be fixed in `MixedIntegerLinearProgram` (see #20302 for a list). That's why I wanted to go the deprecation route with these methods.",
    "created_at": "2016-06-27T04:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298777",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>It's possible that there's some user code around that uses these methods as part of a workaround for the many bugs that had to be fixed in `MixedIntegerLinearProgram` (see #20302 for a list). That's why I wanted to go the deprecation route with these methods.



---

archive/issue_comments_298778.json:
```json
{
    "body": "<a id='comment:7'></a>doc does not build + failing doctests, see patchbot report\n\n```\nOSError: [numerical] docstring of sage.numerical.mip:115:\nWARNING: Inline interpreted text or phrase reference start-string\nwithout end-string.\n```",
    "created_at": "2016-06-27T15:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298778",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>doc does not build + failing doctests, see patchbot report

```
OSError: [numerical] docstring of sage.numerical.mip:115:
WARNING: Inline interpreted text or phrase reference start-string
without end-string.
```



---

archive/issue_comments_298779.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-27T20:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_298780.json:
```json
{
    "body": "<a id='comment:9'></a>Still 2 failing doctests",
    "created_at": "2016-06-28T06:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298780",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>Still 2 failing doctests



---

archive/issue_comments_298781.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-07-07T10:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298781",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_298782.json:
```json
{
    "body": "<a id='comment:11'></a>I've changed the doctests to no longer use the deprecated methods.\nWhile doing this, I noticed that `LinearTensor` had some doctests that were copied from `LinearFunction` and were not testing the methods; and one of the methods needed fixing; done.",
    "created_at": "2016-07-07T10:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298782",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>I've changed the doctests to no longer use the deprecated methods.
While doing this, I noticed that `LinearTensor` had some doctests that were copied from `LinearFunction` and were not testing the methods; and one of the methods needed fixing; done.



---

archive/issue_comments_298783.json:
```json
{
    "body": "<a id='comment:12'></a>ready for review.",
    "created_at": "2016-07-11T20:28:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298783",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>ready for review.



---

archive/issue_comments_298784.json:
```json
{
    "body": "<a id='comment:13'></a>patchbots report nonsense; errors in a line that does not exist in the file `src/sage/coding/guava.py`. How can this happen, I have no clue.",
    "created_at": "2016-07-11T21:16:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298784",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>patchbots report nonsense; errors in a line that does not exist in the file `src/sage/coding/guava.py`. How can this happen, I have no clue.



---

archive/issue_comments_298785.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 dimpase]:\n> patchbots report nonsense; errors in a line that does not exist in the file `src/sage/coding/guava.py`. How can this happen, I have no clue.\n\n\nThe patchbot report was for 7.3.b6, and there was a real issue with guava, which has since\nbeen solved. I am launching my own bot on the ticket, but this bot has its own fake failures for the moment (solved in the next beta).",
    "created_at": "2016-07-12T06:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298785",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>Replying to [comment:13 dimpase]:
> patchbots report nonsense; errors in a line that does not exist in the file `src/sage/coding/guava.py`. How can this happen, I have no clue.


The patchbot report was for 7.3.b6, and there was a real issue with guava, which has since
been solved. I am launching my own bot on the ticket, but this bot has its own fake failures for the moment (solved in the next beta).



---

archive/issue_comments_298786.json:
```json
{
    "body": "<a id='comment:15'></a>patchbot is green (the 4 failures are not related to this ticket)",
    "created_at": "2016-07-13T18:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298786",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>patchbot is green (the 4 failures are not related to this ticket)



---

archive/issue_comments_298787.json:
```json
{
    "body": "<a id='comment:16'></a>OK, looks good.",
    "created_at": "2016-07-15T12:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298787",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>OK, looks good.



---

archive/issue_comments_298788.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-15T12:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298788",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_298789.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 mkoeppe]:\n\noh, right...",
    "created_at": "2016-07-15T12:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298789",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>Replying to [comment:17 mkoeppe]:

oh, right...



---

archive/issue_events_055530.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-16T20:06:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20602#event-55530"
}
```



---

archive/issue_comments_298790.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-16T20:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20602#issuecomment-298790",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
