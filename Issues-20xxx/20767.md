# Issue 20767: Move coercion to Element

archive/issues_020530.json:
```json
{
    "assignees": [],
    "body": "This ticket has 2 main changes:\n\n1. Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.\n\nBecause of this, it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...\n\nOne difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.\n\nThis patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.\n\n2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` (rather than raise an error) if one argument is not a Sage `Element` and coercion fails.\n\nThis will cause Python to try the reversed operation (`__radd__` or `__add__` in Cython). This way, Sage has improved support for operations with non-Sage types.\n\nDepends on #21126\nDepends on #20686\nDepends on #21139\nDepends on #21140\nDepends on #21152\nDepends on #21153\nDepends on #21154\nDepends on #21441\n\nCC:  @nthiery @videlec @simon-king-jena\n\nBranch/Commit: **[25c9d7d](https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2)**\n\nReviewer: **Nicolas M. Thi\u00e9ry**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **coercion**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20767_\n\n",
    "closed_at": "2016-10-03T22:41:54Z",
    "created_at": "2016-06-03T09:30:32Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20coercion",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Move coercion to Element",
    "type": "issue",
    "updated_at": "2016-10-03T22:41:54Z",
    "url": "https://github.com/sagemath/sage/issues/20767",
    "user": "https://github.com/jdemeyer"
}
```
This ticket has 2 main changes:

1. Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.

Because of this, it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...

One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.

This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.

2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` (rather than raise an error) if one argument is not a Sage `Element` and coercion fails.

This will cause Python to try the reversed operation (`__radd__` or `__add__` in Cython). This way, Sage has improved support for operations with non-Sage types.

Depends on #21126
Depends on #20686
Depends on #21139
Depends on #21140
Depends on #21152
Depends on #21153
Depends on #21154
Depends on #21441

CC:  @nthiery @videlec @simon-king-jena

Branch/Commit: **[25c9d7d](https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2)**

Reviewer: **Nicolas M. Thi√©ry**

Author: **Jeroen Demeyer**

Component: **coercion**

_Issue created by migration from https://trac.sagemath.org/ticket/20767_





---

archive/issue_events_292369.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-03T09:30:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292369"
}
```



---

archive/issue_events_292370.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-03T09:30:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20coercion",
    "label_color": "0000ff",
    "label_name": "c: coercion",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292370"
}
```



---

archive/issue_events_292371.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-03T09:30:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292371"
}
```



---

archive/issue_events_292372.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-03T09:30:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292372"
}
```



---

archive/issue_comments_301170.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Move all coercion logic from `RingElement`, `ModuleElement` and the like down to `Element`.\n+Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.\n``````\n",
    "created_at": "2016-06-03T14:07:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301170",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Move all coercion logic from `RingElement`, `ModuleElement` and the like down to `Element`.
+Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.
``````




---

archive/issue_events_292373.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-06-03T14:07:12Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "title_is": "Move coercion to Element",
    "title_was": "Move coercion down to Element",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292373"
}
```



---

archive/issue_comments_301171.json:
```json
{
    "body": "Changed dependencies from **#269, #20740, #20753, #20761, #20757** to **#269, #20740, #20753, #20761, #20757, #20686**",
    "created_at": "2016-06-15T13:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301171",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#269, #20740, #20753, #20761, #20757** to **#269, #20740, #20753, #20761, #20757, #20686**



---

archive/issue_comments_301172.json:
```json
{
    "body": "Changed dependencies from **#269, #20740, #20753, #20761, #20757, #20686** to **#269, #20740, #20753, #20761, #20757, #20686, #20836**",
    "created_at": "2016-06-20T08:29:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301172",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#269, #20740, #20753, #20761, #20757, #20686** to **#269, #20740, #20753, #20761, #20757, #20686, #20836**



---

archive/issue_comments_301173.json:
```json
{
    "body": "Changed dependencies from **#269, #20740, #20753, #20761, #20757, #20686, #20836** to **#269, #20740, #20753, #20761, #20757, #20686, #20836, #20852**",
    "created_at": "2016-06-20T11:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301173",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#269, #20740, #20753, #20761, #20757, #20686, #20836** to **#269, #20740, #20753, #20761, #20757, #20686, #20836, #20852**



---

archive/issue_comments_301174.json:
```json
{
    "body": "Branch: **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)**",
    "created_at": "2016-06-21T09:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301174",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)**



---

archive/issue_comments_301175.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a1ff6e69a71ab4ab5fe1a2775af9d083bc931b4\">9a1ff6e</a></td><td><code>Improve getattr_from_other_class</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/744ffa62fc2f8e193f28ab7f4e636c6edc947e67\">744ffa6</a></td><td><code>Test that static methods work</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5361d972a61dcb60a76425264baa9e6d134e54b\">f5361d9</a></td><td><code>Improve _sage_src_lines_()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80795088d0774413d5cbb94459d95b430e9fe2ad\">8079508</a></td><td><code>Implement `__mod__` in the coercion model</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7856d59aa930a6a7b597b5e121fbe7b16f32ba8\">b7856d5</a></td><td><code>Merge commit 'f5361d972a61dcb60a76425264baa9e6d134e54b'; commit 'ccd5fcc16ac1708854a600cfc259c23d6c7568ff'; commit 'c41bc91addb41f593e4509d3fd6e9ce7c5789b39'; commit '80795088d0774413d5cbb94459d95b430e9fe2ad' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc84d88add1dab3576723d2a7b20c8df4deb0151\">dc84d88</a></td><td><code>Remove comments about \"private\" attributes with two underscores</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a4f48d047a06ef9fcb2a0e01b5198f7ef439f9b\">8a4f48d</a></td><td><code>Abstract away category lookup in cdef method getattr_from_category</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/20c8675c4112efc995c08c0b55aa54b0d39c9f2c\">20c8675</a></td><td><code>Merge remote-tracking branch 'origin/u/jdemeyer/optimize_method_lookup_from_the_categories_for_instances_of_cython_classes' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce70b30b0e05473aead282439474a176f09abe6c\">ce70b30</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-07-26T09:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301175",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a1ff6e69a71ab4ab5fe1a2775af9d083bc931b4">9a1ff6e</a></td><td><code>Improve getattr_from_other_class</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/744ffa62fc2f8e193f28ab7f4e636c6edc947e67">744ffa6</a></td><td><code>Test that static methods work</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5361d972a61dcb60a76425264baa9e6d134e54b">f5361d9</a></td><td><code>Improve _sage_src_lines_()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80795088d0774413d5cbb94459d95b430e9fe2ad">8079508</a></td><td><code>Implement `__mod__` in the coercion model</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7856d59aa930a6a7b597b5e121fbe7b16f32ba8">b7856d5</a></td><td><code>Merge commit 'f5361d972a61dcb60a76425264baa9e6d134e54b'; commit 'ccd5fcc16ac1708854a600cfc259c23d6c7568ff'; commit 'c41bc91addb41f593e4509d3fd6e9ce7c5789b39'; commit '80795088d0774413d5cbb94459d95b430e9fe2ad' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc84d88add1dab3576723d2a7b20c8df4deb0151">dc84d88</a></td><td><code>Remove comments about "private" attributes with two underscores</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a4f48d047a06ef9fcb2a0e01b5198f7ef439f9b">8a4f48d</a></td><td><code>Abstract away category lookup in cdef method getattr_from_category</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/20c8675c4112efc995c08c0b55aa54b0d39c9f2c">20c8675</a></td><td><code>Merge remote-tracking branch 'origin/u/jdemeyer/optimize_method_lookup_from_the_categories_for_instances_of_cython_classes' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce70b30b0e05473aead282439474a176f09abe6c">ce70b30</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301176.json:
```json
{
    "body": "Commit: **[ce70b30](https://github.com/sagemath/sagetrac-mirror/commit/ce70b30b0e05473aead282439474a176f09abe6c)**",
    "created_at": "2016-07-26T09:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301176",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[ce70b30](https://github.com/sagemath/sagetrac-mirror/commit/ce70b30b0e05473aead282439474a176f09abe6c)**



---

archive/issue_comments_301177.json:
```json
{
    "body": "Changed dependencies from **#269, #20740, #20753, #20761, #20757, #20686, #20836, #20852** to **#269, #20686, #15947**",
    "created_at": "2016-07-26T09:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301177",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#269, #20740, #20753, #20761, #20757, #20686, #20836, #20852** to **#269, #20686, #15947**



---

archive/issue_comments_301178.json:
```json
{
    "body": "Changed dependencies from **#269, #20686, #15947** to **#269, #20686**",
    "created_at": "2016-07-26T09:49:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301178",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#269, #20686, #15947** to **#269, #20686**



---

archive/issue_comments_301179.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88d975794bc54532e785bfa9e337f70ee7dd8811\">88d9757</a></td><td><code>Comment that getattr_from_other_class is cached</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7140ee389ac63921f356d5abc4cdc94a6bf48580\">7140ee3</a></td><td><code>Prefer absolute imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc6487cb02514a811cb1f7ccfd92bed177bb2dea\">fc6487c</a></td><td><code>Merge remote-tracking branch 'trac/u/jdemeyer/upgrade_to_cython_0_24_1' into t/20686/optimize_method_lookup_from_the_categories_for_instances_of_cython_classes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16d474363c051b081383dcdbc1944828e735c41e\">16d4743</a></td><td><code>EvaluationMethods should be a new-style class</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54ccd828cb20b1254aeaf55bf7edab4a73f1032a\">54ccd82</a></td><td><code>Remove `__dict__` attribute from ElementWrapper</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a71db1d938c4b43aeed2e2c68ee67c906a5ca54\">9a71db1</a></td><td><code>Merge commit '54ccd828cb20b1254aeaf55bf7edab4a73f1032a'; tag '7.3.beta9' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04d1ef594face8e9cebd99acae4252a7b9899d38\">04d1ef5</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-07-26T13:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301179",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88d975794bc54532e785bfa9e337f70ee7dd8811">88d9757</a></td><td><code>Comment that getattr_from_other_class is cached</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7140ee389ac63921f356d5abc4cdc94a6bf48580">7140ee3</a></td><td><code>Prefer absolute imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc6487cb02514a811cb1f7ccfd92bed177bb2dea">fc6487c</a></td><td><code>Merge remote-tracking branch 'trac/u/jdemeyer/upgrade_to_cython_0_24_1' into t/20686/optimize_method_lookup_from_the_categories_for_instances_of_cython_classes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16d474363c051b081383dcdbc1944828e735c41e">16d4743</a></td><td><code>EvaluationMethods should be a new-style class</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54ccd828cb20b1254aeaf55bf7edab4a73f1032a">54ccd82</a></td><td><code>Remove `__dict__` attribute from ElementWrapper</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a71db1d938c4b43aeed2e2c68ee67c906a5ca54">9a71db1</a></td><td><code>Merge commit '54ccd828cb20b1254aeaf55bf7edab4a73f1032a'; tag '7.3.beta9' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04d1ef594face8e9cebd99acae4252a7b9899d38">04d1ef5</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301180.json:
```json
{
    "body": "Changed commit from **[ce70b30](https://github.com/sagemath/sagetrac-mirror/commit/ce70b30b0e05473aead282439474a176f09abe6c)** to **[04d1ef5](https://github.com/sagemath/sagetrac-mirror/commit/04d1ef594face8e9cebd99acae4252a7b9899d38)**",
    "created_at": "2016-07-26T13:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301180",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ce70b30](https://github.com/sagemath/sagetrac-mirror/commit/ce70b30b0e05473aead282439474a176f09abe6c)** to **[04d1ef5](https://github.com/sagemath/sagetrac-mirror/commit/04d1ef594face8e9cebd99acae4252a7b9899d38)**



---

archive/issue_comments_301181.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ada2e74a6104e88da56b391e681500d3ebc88d3d\">ada2e74</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-07-26T15:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301181",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ada2e74a6104e88da56b391e681500d3ebc88d3d">ada2e74</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301182.json:
```json
{
    "body": "Changed commit from **[04d1ef5](https://github.com/sagemath/sagetrac-mirror/commit/04d1ef594face8e9cebd99acae4252a7b9899d38)** to **[ada2e74](https://github.com/sagemath/sagetrac-mirror/commit/ada2e74a6104e88da56b391e681500d3ebc88d3d)**",
    "created_at": "2016-07-26T15:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301182",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[04d1ef5](https://github.com/sagemath/sagetrac-mirror/commit/04d1ef594face8e9cebd99acae4252a7b9899d38)** to **[ada2e74](https://github.com/sagemath/sagetrac-mirror/commit/ada2e74a6104e88da56b391e681500d3ebc88d3d)**



---

archive/issue_comments_301183.json:
```json
{
    "body": "Changed commit from **[ada2e74](https://github.com/sagemath/sagetrac-mirror/commit/ada2e74a6104e88da56b391e681500d3ebc88d3d)** to **[b9a3614](https://github.com/sagemath/sagetrac-mirror/commit/b9a3614592e4a3a2f66ce2d2e52dcb0dcf013384)**",
    "created_at": "2016-07-27T15:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301183",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ada2e74](https://github.com/sagemath/sagetrac-mirror/commit/ada2e74a6104e88da56b391e681500d3ebc88d3d)** to **[b9a3614](https://github.com/sagemath/sagetrac-mirror/commit/b9a3614592e4a3a2f66ce2d2e52dcb0dcf013384)**



---

archive/issue_comments_301184.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9a3614592e4a3a2f66ce2d2e52dcb0dcf013384\">b9a3614</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-07-27T15:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301184",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9a3614592e4a3a2f66ce2d2e52dcb0dcf013384">b9a3614</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301185.json:
```json
{
    "body": "Changed commit from **[b9a3614](https://github.com/sagemath/sagetrac-mirror/commit/b9a3614592e4a3a2f66ce2d2e52dcb0dcf013384)** to **[9c4bdef](https://github.com/sagemath/sagetrac-mirror/commit/9c4bdefc8cbb6638699d620586d1bb707817094d)**",
    "created_at": "2016-07-29T13:27:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301185",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b9a3614](https://github.com/sagemath/sagetrac-mirror/commit/b9a3614592e4a3a2f66ce2d2e52dcb0dcf013384)** to **[9c4bdef](https://github.com/sagemath/sagetrac-mirror/commit/9c4bdefc8cbb6638699d620586d1bb707817094d)**



---

archive/issue_comments_301186.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c4bdefc8cbb6638699d620586d1bb707817094d\">9c4bdef</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-07-29T13:27:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301186",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c4bdefc8cbb6638699d620586d1bb707817094d">9c4bdef</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301187.json:
```json
{
    "body": "Changed dependencies from **#269, #20686** to **#21126, #20686**",
    "created_at": "2016-07-29T13:30:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301187",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#269, #20686** to **#21126, #20686**



---

archive/issue_comments_301188.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/093395e146c84a55a00ae0fcbb3b5eb9ee8915f4\">093395e</a></td><td><code>Add a Cython fix for cpdef methods</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/972533ac79f0015b20ce95bc7e7727610d318b69\">972533a</a></td><td><code>Merge commit '54ccd828cb20b1254aeaf55bf7edab4a73f1032a' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4919e05c644722170152603e6de769f201d5478\">e4919e0</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-07-29T13:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301188",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/093395e146c84a55a00ae0fcbb3b5eb9ee8915f4">093395e</a></td><td><code>Add a Cython fix for cpdef methods</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/972533ac79f0015b20ce95bc7e7727610d318b69">972533a</a></td><td><code>Merge commit '54ccd828cb20b1254aeaf55bf7edab4a73f1032a' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4919e05c644722170152603e6de769f201d5478">e4919e0</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301189.json:
```json
{
    "body": "Changed commit from **[9c4bdef](https://github.com/sagemath/sagetrac-mirror/commit/9c4bdefc8cbb6638699d620586d1bb707817094d)** to **[e4919e0](https://github.com/sagemath/sagetrac-mirror/commit/e4919e05c644722170152603e6de769f201d5478)**",
    "created_at": "2016-07-29T13:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301189",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9c4bdef](https://github.com/sagemath/sagetrac-mirror/commit/9c4bdefc8cbb6638699d620586d1bb707817094d)** to **[e4919e0](https://github.com/sagemath/sagetrac-mirror/commit/e4919e05c644722170152603e6de769f201d5478)**



---

archive/issue_comments_301190.json:
```json
{
    "body": "Changed dependencies from **#21126, #20686** to **#21126, #20686, #21139**",
    "created_at": "2016-08-01T09:30:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301190",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21126, #20686** to **#21126, #20686, #21139**



---

archive/issue_comments_301191.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b72af0ce946c5c2db433c7b5a382bc30a5483436\">b72af0c</a></td><td><code>Implement negation for modular forms</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1570a11911c8812f648369981182760767005cf3\">1570a11</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-01T09:30:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301191",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b72af0ce946c5c2db433c7b5a382bc30a5483436">b72af0c</a></td><td><code>Implement negation for modular forms</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1570a11911c8812f648369981182760767005cf3">1570a11</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301192.json:
```json
{
    "body": "Changed commit from **[e4919e0](https://github.com/sagemath/sagetrac-mirror/commit/e4919e05c644722170152603e6de769f201d5478)** to **[1570a11](https://github.com/sagemath/sagetrac-mirror/commit/1570a11911c8812f648369981182760767005cf3)**",
    "created_at": "2016-08-01T09:30:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301192",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e4919e0](https://github.com/sagemath/sagetrac-mirror/commit/e4919e05c644722170152603e6de769f201d5478)** to **[1570a11](https://github.com/sagemath/sagetrac-mirror/commit/1570a11911c8812f648369981182760767005cf3)**



---

archive/issue_comments_301193.json:
```json
{
    "body": "Changed dependencies from **#21126, #20686, #21139** to **#21126, #20686, #21139, #21140**",
    "created_at": "2016-08-01T09:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301193",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21126, #20686, #21139** to **#21126, #20686, #21139, #21140**



---

archive/issue_comments_301194.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0d5ec61fb9956025a9b9c03120d1f4bbee34970\">a0d5ec6</a></td><td><code>Implement negation for modular forms</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbcda3bc946a31e5d239d8fa28b77d8adcbd4c99\">fbcda3b</a></td><td><code>Merge branch 't/21139/implement_negation_for_modular_forms' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69d18c75875c8a9f770e9ef493d6e721854f4448\">69d18c7</a></td><td><code>Remove redundant `_lmul_` and `_rmul_` methods</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f8e1c92fdf8e11b5a1a0cc14a52e15492e34a53\">2f8e1c9</a></td><td><code>Merge commit '69d18c75875c8a9f770e9ef493d6e721854f4448' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/950d4ab0b6be3adfcb47b738dfc74a8b931b6cf1\">950d4ab</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-01T15:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301194",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0d5ec61fb9956025a9b9c03120d1f4bbee34970">a0d5ec6</a></td><td><code>Implement negation for modular forms</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbcda3bc946a31e5d239d8fa28b77d8adcbd4c99">fbcda3b</a></td><td><code>Merge branch 't/21139/implement_negation_for_modular_forms' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69d18c75875c8a9f770e9ef493d6e721854f4448">69d18c7</a></td><td><code>Remove redundant `_lmul_` and `_rmul_` methods</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f8e1c92fdf8e11b5a1a0cc14a52e15492e34a53">2f8e1c9</a></td><td><code>Merge commit '69d18c75875c8a9f770e9ef493d6e721854f4448' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/950d4ab0b6be3adfcb47b738dfc74a8b931b6cf1">950d4ab</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301195.json:
```json
{
    "body": "Changed commit from **[1570a11](https://github.com/sagemath/sagetrac-mirror/commit/1570a11911c8812f648369981182760767005cf3)** to **[950d4ab](https://github.com/sagemath/sagetrac-mirror/commit/950d4ab0b6be3adfcb47b738dfc74a8b931b6cf1)**",
    "created_at": "2016-08-01T15:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301195",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1570a11](https://github.com/sagemath/sagetrac-mirror/commit/1570a11911c8812f648369981182760767005cf3)** to **[950d4ab](https://github.com/sagemath/sagetrac-mirror/commit/950d4ab0b6be3adfcb47b738dfc74a8b931b6cf1)**



---

archive/issue_comments_301196.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c7f7293f38f324e77530c3fc565cf3e2a839458\">7c7f729</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-01T17:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301196",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c7f7293f38f324e77530c3fc565cf3e2a839458">7c7f729</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301197.json:
```json
{
    "body": "Changed commit from **[950d4ab](https://github.com/sagemath/sagetrac-mirror/commit/950d4ab0b6be3adfcb47b738dfc74a8b931b6cf1)** to **[7c7f729](https://github.com/sagemath/sagetrac-mirror/commit/7c7f7293f38f324e77530c3fc565cf3e2a839458)**",
    "created_at": "2016-08-01T17:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301197",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[950d4ab](https://github.com/sagemath/sagetrac-mirror/commit/950d4ab0b6be3adfcb47b738dfc74a8b931b6cf1)** to **[7c7f729](https://github.com/sagemath/sagetrac-mirror/commit/7c7f7293f38f324e77530c3fc565cf3e2a839458)**



---

archive/issue_comments_301198.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d82fb71ce86a9eb79a41595571f1105f13aee36\">4d82fb7</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-01T21:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301198",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d82fb71ce86a9eb79a41595571f1105f13aee36">4d82fb7</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301199.json:
```json
{
    "body": "Changed commit from **[7c7f729](https://github.com/sagemath/sagetrac-mirror/commit/7c7f7293f38f324e77530c3fc565cf3e2a839458)** to **[4d82fb7](https://github.com/sagemath/sagetrac-mirror/commit/4d82fb71ce86a9eb79a41595571f1105f13aee36)**",
    "created_at": "2016-08-01T21:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301199",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7c7f729](https://github.com/sagemath/sagetrac-mirror/commit/7c7f7293f38f324e77530c3fc565cf3e2a839458)** to **[4d82fb7](https://github.com/sagemath/sagetrac-mirror/commit/4d82fb71ce86a9eb79a41595571f1105f13aee36)**



---

archive/issue_comments_301200.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a67c31fc539dc21188dd36e5ce972be034d93b9f\">a67c31f</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-01T21:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301200",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a67c31fc539dc21188dd36e5ce972be034d93b9f">a67c31f</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301201.json:
```json
{
    "body": "Changed commit from **[4d82fb7](https://github.com/sagemath/sagetrac-mirror/commit/4d82fb71ce86a9eb79a41595571f1105f13aee36)** to **[a67c31f](https://github.com/sagemath/sagetrac-mirror/commit/a67c31fc539dc21188dd36e5ce972be034d93b9f)**",
    "created_at": "2016-08-01T21:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301201",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4d82fb7](https://github.com/sagemath/sagetrac-mirror/commit/4d82fb71ce86a9eb79a41595571f1105f13aee36)** to **[a67c31f](https://github.com/sagemath/sagetrac-mirror/commit/a67c31fc539dc21188dd36e5ce972be034d93b9f)**



---

archive/issue_comments_301202.json:
```json
{
    "body": "Changed commit from **[a67c31f](https://github.com/sagemath/sagetrac-mirror/commit/a67c31fc539dc21188dd36e5ce972be034d93b9f)** to **[bbc6e04](https://github.com/sagemath/sagetrac-mirror/commit/bbc6e049de5b9376f9fb8f37cf23850529448c5a)**",
    "created_at": "2016-08-02T14:39:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301202",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a67c31f](https://github.com/sagemath/sagetrac-mirror/commit/a67c31fc539dc21188dd36e5ce972be034d93b9f)** to **[bbc6e04](https://github.com/sagemath/sagetrac-mirror/commit/bbc6e049de5b9376f9fb8f37cf23850529448c5a)**



---

archive/issue_comments_301203.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbc6e049de5b9376f9fb8f37cf23850529448c5a\">bbc6e04</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-02T14:39:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301203",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbc6e049de5b9376f9fb8f37cf23850529448c5a">bbc6e04</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301204.json:
```json
{
    "body": "Changed commit from **[bbc6e04](https://github.com/sagemath/sagetrac-mirror/commit/bbc6e049de5b9376f9fb8f37cf23850529448c5a)** to **[59f2956](https://github.com/sagemath/sagetrac-mirror/commit/59f29566265b7ef0f559bf5fd95232c99e3f3a27)**",
    "created_at": "2016-08-02T15:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301204",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bbc6e04](https://github.com/sagemath/sagetrac-mirror/commit/bbc6e049de5b9376f9fb8f37cf23850529448c5a)** to **[59f2956](https://github.com/sagemath/sagetrac-mirror/commit/59f29566265b7ef0f559bf5fd95232c99e3f3a27)**



---

archive/issue_comments_301205.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59f29566265b7ef0f559bf5fd95232c99e3f3a27\">59f2956</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-02T15:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301205",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59f29566265b7ef0f559bf5fd95232c99e3f3a27">59f2956</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301206.json:
```json
{
    "body": "Changed commit from **[59f2956](https://github.com/sagemath/sagetrac-mirror/commit/59f29566265b7ef0f559bf5fd95232c99e3f3a27)** to **[8fc8d92](https://github.com/sagemath/sagetrac-mirror/commit/8fc8d924e856d831ef21451aed4f687cb0574c4d)**",
    "created_at": "2016-08-02T21:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301206",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[59f2956](https://github.com/sagemath/sagetrac-mirror/commit/59f29566265b7ef0f559bf5fd95232c99e3f3a27)** to **[8fc8d92](https://github.com/sagemath/sagetrac-mirror/commit/8fc8d924e856d831ef21451aed4f687cb0574c4d)**



---

archive/issue_comments_301207.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fc8d924e856d831ef21451aed4f687cb0574c4d\">8fc8d92</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-02T21:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301207",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fc8d924e856d831ef21451aed4f687cb0574c4d">8fc8d92</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301208.json:
```json
{
    "body": "Changed dependencies from **#21126, #20686, #21139, #21140** to **#21126, #20686, #21139, #21140, #21152**",
    "created_at": "2016-08-03T10:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301208",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21126, #20686, #21139, #21140** to **#21126, #20686, #21139, #21140, #21152**



---

archive/issue_comments_301209.json:
```json
{
    "body": "Changed commit from **[8fc8d92](https://github.com/sagemath/sagetrac-mirror/commit/8fc8d924e856d831ef21451aed4f687cb0574c4d)** to **[21aea97](https://github.com/sagemath/sagetrac-mirror/commit/21aea97e09005d62513b08c639ae086aa157af80)**",
    "created_at": "2016-08-03T10:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301209",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8fc8d92](https://github.com/sagemath/sagetrac-mirror/commit/8fc8d924e856d831ef21451aed4f687cb0574c4d)** to **[21aea97](https://github.com/sagemath/sagetrac-mirror/commit/21aea97e09005d62513b08c639ae086aa157af80)**



---

archive/issue_comments_301210.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12d9d3268f1eaeb8308f77666b56c9efb0549aec\">12d9d32</a></td><td><code>Implement unary operations in interfaces</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aae48bd951f3dee458fafb9de558e0b174296142\">aae48bd</a></td><td><code>Merge branch 'ticket/21152' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21aea97e09005d62513b08c639ae086aa157af80\">21aea97</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-03T10:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301210",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12d9d3268f1eaeb8308f77666b56c9efb0549aec">12d9d32</a></td><td><code>Implement unary operations in interfaces</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aae48bd951f3dee458fafb9de558e0b174296142">aae48bd</a></td><td><code>Merge branch 'ticket/21152' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21aea97e09005d62513b08c639ae086aa157af80">21aea97</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301211.json:
```json
{
    "body": "Changed dependencies from **#21126, #20686, #21139, #21140, #21152** to **#21126, #20686, #21139, #21140, #21152, #21153, #21154**",
    "created_at": "2016-08-03T12:43:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301211",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21126, #20686, #21139, #21140, #21152** to **#21126, #20686, #21139, #21140, #21152, #21153, #21154**



---

archive/issue_comments_301212.json:
```json
{
    "body": "Changed commit from **[21aea97](https://github.com/sagemath/sagetrac-mirror/commit/21aea97e09005d62513b08c639ae086aa157af80)** to **[16c545e](https://github.com/sagemath/sagetrac-mirror/commit/16c545efb9c09c7054ce7b7638312fcd36a55227)**",
    "created_at": "2016-08-03T13:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301212",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[21aea97](https://github.com/sagemath/sagetrac-mirror/commit/21aea97e09005d62513b08c639ae086aa157af80)** to **[16c545e](https://github.com/sagemath/sagetrac-mirror/commit/16c545efb9c09c7054ce7b7638312fcd36a55227)**



---

archive/issue_comments_301213.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a44b082f08c742fbe564c5afdd2f7309fabbb52\">0a44b08</a></td><td><code>Remove one doctest for __mul__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54b0fcdaf2fd69cd64978da526af6774b57a59a8\">54b0fcd</a></td><td><code>Various minor fixes for the coercion model</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2405dde75db35323a1e33890e999388203a81de7\">2405dde</a></td><td><code>Merge commit '0a44b082f08c742fbe564c5afdd2f7309fabbb52'; commit '54b0fcdaf2fd69cd64978da526af6774b57a59a8' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16c545efb9c09c7054ce7b7638312fcd36a55227\">16c545e</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-03T13:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301213",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a44b082f08c742fbe564c5afdd2f7309fabbb52">0a44b08</a></td><td><code>Remove one doctest for __mul__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54b0fcdaf2fd69cd64978da526af6774b57a59a8">54b0fcd</a></td><td><code>Various minor fixes for the coercion model</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2405dde75db35323a1e33890e999388203a81de7">2405dde</a></td><td><code>Merge commit '0a44b082f08c742fbe564c5afdd2f7309fabbb52'; commit '54b0fcdaf2fd69cd64978da526af6774b57a59a8' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16c545efb9c09c7054ce7b7638312fcd36a55227">16c545e</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301214.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2016-08-03T13:59:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301214",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_events_292374.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-03T13:59:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292374"
}
```



---

archive/issue_comments_301215.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1d2ba46574273ec4d358e654ed195a82b81a654\">e1d2ba4</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>\n",
    "created_at": "2016-08-03T14:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301215",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1d2ba46574273ec4d358e654ed195a82b81a654">e1d2ba4</a></td><td><code>Move arithmetic using coercion model to Element</code></td></tr></table>




---

archive/issue_comments_301216.json:
```json
{
    "body": "Changed commit from **[16c545e](https://github.com/sagemath/sagetrac-mirror/commit/16c545efb9c09c7054ce7b7638312fcd36a55227)** to **[e1d2ba4](https://github.com/sagemath/sagetrac-mirror/commit/e1d2ba46574273ec4d358e654ed195a82b81a654)**",
    "created_at": "2016-08-03T14:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301216",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[16c545e](https://github.com/sagemath/sagetrac-mirror/commit/16c545efb9c09c7054ce7b7638312fcd36a55227)** to **[e1d2ba4](https://github.com/sagemath/sagetrac-mirror/commit/e1d2ba46574273ec4d358e654ed195a82b81a654)**



---

archive/issue_comments_301217.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.\n+\n+The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...\n+\n+One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no default implementations.\n+\n+This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of certain arithmetic operations will override whatever is in the category. For the base class `Element`, this is not an issue since there are no default implementations.\n``````\n",
    "created_at": "2016-08-03T14:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301217",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,7 @@
 Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.
+
+The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...
+
+One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no default implementations.
+
+This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of certain arithmetic operations will override whatever is in the category. For the base class `Element`, this is not an issue since there are no default implementations.
``````




---

archive/issue_comments_301218.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...\n \n-One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no default implementations.\n+One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.\n \n-This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of certain arithmetic operations will override whatever is in the category. For the base class `Element`, this is not an issue since there are no default implementations.\n+This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.\n``````\n",
    "created_at": "2016-08-03T14:34:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301218",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...
 
-One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no default implementations.
+One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.
 
-This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of certain arithmetic operations will override whatever is in the category. For the base class `Element`, this is not an issue since there are no default implementations.
+This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.
``````




---

archive/issue_comments_301219.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...\n \n-One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.\n+One difference between `Element` and more specialized classes like `RingElement` remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.\n \n This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.\n``````\n",
    "created_at": "2016-08-04T06:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301219",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...
 
-One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.
+One difference between `Element` and more specialized classes like `RingElement` remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.
 
 This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.
``````




---

archive/issue_comments_301220.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,13 @@\n-Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.\n+This ticket has 2 main changes:\n \n-The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...\n+1. Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.\n \n-One difference between `Element` and more specialized classes like `RingElement` remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.\n+Because of this, it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...\n+\n+One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.\n \n This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.\n+\n+2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` if one argument is not a Sage `Element` and coercion fails.\n+\n+This will cause Python to try the reversed operation (`__radd__` or `__add__` in Cython). This way, Sage has improved support for operations with non-Sage types.\n``````\n",
    "created_at": "2016-08-04T06:55:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301220",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,13 @@
-Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.
+This ticket has 2 main changes:
 
-The main consequence is that it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...
+1. Move all coercion logic from `RingElement`, `ModuleElement` and the like to `Element`.
 
-One difference between `Element` and more specialized classes like `RingElement` remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.
+Because of this, it matters a lot less whether a class inherits from `Element` or from `ModuleElement`/`RingElement`/`FieldElement`...
+
+One difference remains: the more specialized classes have some default implementations for arithmetic. For example, `ModuleElement` implements unary negation as multiplication by -1. The base class `Element` has no such default implementations.
 
 This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.
+
+2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` if one argument is not a Sage `Element` and coercion fails.
+
+This will cause Python to try the reversed operation (`__radd__` or `__add__` in Cython). This way, Sage has improved support for operations with non-Sage types.
``````




---

archive/issue_comments_301221.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nIt would be interesting (to me) to see whether the coerce action business of #18756 can be used here as well.",
    "created_at": "2016-08-05T19:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301221",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:35" align="right">comment:35</div>

It would be interesting (to me) to see whether the coerce action business of #18756 can be used here as well.



---

archive/issue_comments_301222.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\n... and of #18758",
    "created_at": "2016-08-05T19:55:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301222",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:36" align="right">comment:36</div>

... and of #18758



---

archive/issue_comments_301223.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nWell, this ticket deals with the \"other side\" of the coercion framework: it changes how the coercion model is called, not how the coercion model implements arithmetic. It seems like the other tickets do the opposite. So the tickets look related but also quite independent.",
    "created_at": "2016-08-05T20:20:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301223",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">comment:37</div>

Well, this ticket deals with the "other side" of the coercion framework: it changes how the coercion model is called, not how the coercion model implements arithmetic. It seems like the other tickets do the opposite. So the tickets look related but also quite independent.



---

archive/issue_comments_301224.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nHi\n\nJust as a reminder: There are situation where we need ring element operations in a parent resp. for an element which is not really considered a ring element.\n\nExample:\n- Take a graded ring.\n- Take two elements from different weight-components.\n- Note that the elements by themself are considered elements of vector spaces\n  (which is what we want because we probably want to do operations that only make sense for the vector space, etc).\n- However we still want to be able to \"add\" `_and_` \"multiply\" such elements.\n  - Add would result in a ring element (unless the components are the same).\n  - Multiply would result in a vector in a higher weight-component.\n\nI had to deal with this when I implemented the graded rings of modular forms.\nSee src/sage/modular/modform_hecketriangle/element.py for more details.\nThere I solved it as follows:\nI derived the element from FormsRingElement (so it has the multiply methods) but the parent is still just a vector space. I also made sure that arithmetic operations with elements end up in the correct space.\n\nWill this still work with this ticket?\nCan you check the tests for this maybe?\n\nSide note: At the moment I don't really have time to actively develop, so I can't really promise much help.\n\n\nBest\nJonas",
    "created_at": "2016-08-06T11:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301224",
    "user": "https://github.com/jjermann"
}
```

<div id="comment:38" align="right">comment:38</div>

Hi

Just as a reminder: There are situation where we need ring element operations in a parent resp. for an element which is not really considered a ring element.

Example:
- Take a graded ring.
- Take two elements from different weight-components.
- Note that the elements by themself are considered elements of vector spaces
  (which is what we want because we probably want to do operations that only make sense for the vector space, etc).
- However we still want to be able to "add" `_and_` "multiply" such elements.
  - Add would result in a ring element (unless the components are the same).
  - Multiply would result in a vector in a higher weight-component.

I had to deal with this when I implemented the graded rings of modular forms.
See src/sage/modular/modform_hecketriangle/element.py for more details.
There I solved it as follows:
I derived the element from FormsRingElement (so it has the multiply methods) but the parent is still just a vector space. I also made sure that arithmetic operations with elements end up in the correct space.

Will this still work with this ticket?
Can you check the tests for this maybe?

Side note: At the moment I don't really have time to actively develop, so I can't really promise much help.


Best
Jonas



---

archive/issue_comments_301225.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThis ticket should not cause many functional differences for existing code, except for the fact that double-underscore methods can no longer be implemented in categories and some other minor things, like using `parent.one()` instead of `1`.\n\nAll doctests in Sage pass with this ticket (see for example the patchbot), so the code that you refer to should still work too.",
    "created_at": "2016-08-06T12:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301225",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

This ticket should not cause many functional differences for existing code, except for the fact that double-underscore methods can no longer be implemented in categories and some other minor things, like using `parent.one()` instead of `1`.

All doctests in Sage pass with this ticket (see for example the patchbot), so the code that you refer to should still work too.



---

archive/issue_events_292375.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-29T05:38:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292375"
}
```



---

archive/issue_events_292376.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-29T05:38:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292376"
}
```



---

archive/issue_comments_301226.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nDoctest failures with 7.4.beta2.",
    "created_at": "2016-08-29T05:38:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301226",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

Doctest failures with 7.4.beta2.



---

archive/issue_events_292377.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-29T05:38:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292377"
}
```



---

archive/issue_events_292378.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-29T05:38:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292378"
}
```



---

archive/issue_comments_301227.json:
```json
{
    "body": "<div id=\"comment:41\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bfd42ab7821cb8d9796b3b0b78bc7b80a58b629\">7bfd42a</a></td><td><code>Merge tag '7.4.beta2' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/343131a9951dc842c462809b9366b13416382dfc\">343131a</a></td><td><code>Fix doctest for Trac #20767</code></td></tr></table>\n",
    "created_at": "2016-08-30T10:31:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301227",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:41"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bfd42ab7821cb8d9796b3b0b78bc7b80a58b629">7bfd42a</a></td><td><code>Merge tag '7.4.beta2' into t/20767/move_coercion_to_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/343131a9951dc842c462809b9366b13416382dfc">343131a</a></td><td><code>Fix doctest for Trac #20767</code></td></tr></table>




---

archive/issue_comments_301228.json:
```json
{
    "body": "Changed commit from **[e1d2ba4](https://github.com/sagemath/sagetrac-mirror/commit/e1d2ba46574273ec4d358e654ed195a82b81a654)** to **[343131a](https://github.com/sagemath/sagetrac-mirror/commit/343131a9951dc842c462809b9366b13416382dfc)**",
    "created_at": "2016-08-30T10:31:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301228",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e1d2ba4](https://github.com/sagemath/sagetrac-mirror/commit/e1d2ba46574273ec4d358e654ed195a82b81a654)** to **[343131a](https://github.com/sagemath/sagetrac-mirror/commit/343131a9951dc842c462809b9366b13416382dfc)**



---

archive/issue_events_292379.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-30T10:32:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292379"
}
```



---

archive/issue_events_292380.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-30T10:32:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292380"
}
```



---

archive/issue_comments_301229.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,6 @@\n \n This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.\n \n-2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` if one argument is not a Sage `Element` and coercion fails.\n+2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` (rather than raise an error) if one argument is not a Sage `Element` and coercion fails.\n \n This will cause Python to try the reversed operation (`__radd__` or `__add__` in Cython). This way, Sage has improved support for operations with non-Sage types.\n``````\n",
    "created_at": "2016-09-06T07:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301229",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,6 @@
 
 This patch also affects lookup in categories: with this patch, double-underscore methods like `__add__` are never taken from the category. The `Element` classes take precedence over the category, so the default implementations of arithmetic operations will override whatever is in the category (this is existing behaviour, not affected by this patch). For the base class `Element`, this is not an issue since there are no default implementations.
 
-2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` if one argument is not a Sage `Element` and coercion fails.
+2. Change the implementation of double-underscore methods like `__add__` to return `NotImplemented` (rather than raise an error) if one argument is not a Sage `Element` and coercion fails.
 
 This will cause Python to try the reversed operation (`__radd__` or `__add__` in Cython). This way, Sage has improved support for operations with non-Sage types.
``````




---

archive/issue_comments_301230.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)** to **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)**",
    "created_at": "2016-09-06T10:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301230",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)** to **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)**



---

archive/issue_comments_301231.json:
```json
{
    "body": "Changed branch from **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)** to **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)**",
    "created_at": "2016-09-07T06:26:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301231",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)** to **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)**



---

archive/issue_comments_301232.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e8f9e4d29b444385dc507f516df90b7c2559cb9\">2e8f9e4</a></td><td><code>Return exception instead of error message</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59a04e46a93e6c0b4fe811fabf9c8eee7ed8e3e8\">59a04e4</a></td><td><code>Improve documentation and tests</code></td></tr></table>\n",
    "created_at": "2016-09-07T12:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301232",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e8f9e4d29b444385dc507f516df90b7c2559cb9">2e8f9e4</a></td><td><code>Return exception instead of error message</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59a04e46a93e6c0b4fe811fabf9c8eee7ed8e3e8">59a04e4</a></td><td><code>Improve documentation and tests</code></td></tr></table>




---

archive/issue_comments_301233.json:
```json
{
    "body": "Changed commit from **[343131a](https://github.com/sagemath/sagetrac-mirror/commit/343131a9951dc842c462809b9366b13416382dfc)** to **[59a04e4](https://github.com/sagemath/sagetrac-mirror/commit/59a04e46a93e6c0b4fe811fabf9c8eee7ed8e3e8)**",
    "created_at": "2016-09-07T12:00:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301233",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[343131a](https://github.com/sagemath/sagetrac-mirror/commit/343131a9951dc842c462809b9366b13416382dfc)** to **[59a04e4](https://github.com/sagemath/sagetrac-mirror/commit/59a04e46a93e6c0b4fe811fabf9c8eee7ed8e3e8)**



---

archive/issue_comments_301234.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nNicolas, I took care of your comments. If you are missing something, feel free to notify me or to make the change yourself.",
    "created_at": "2016-09-07T12:10:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301234",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

Nicolas, I took care of your comments. If you are missing something, feel free to notify me or to make the change yourself.



---

archive/issue_comments_301235.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)** to **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)**",
    "created_at": "2016-09-07T16:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301235",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)** to **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)**



---

archive/issue_comments_301236.json:
```json
{
    "body": "Changed commit from **[59a04e4](https://github.com/sagemath/sagetrac-mirror/commit/59a04e46a93e6c0b4fe811fabf9c8eee7ed8e3e8)** to **[2d40948](https://github.com/sagemath/sagetrac-mirror/commit/2d409484e23387d98d8a697aaac76a70017f53e8)**",
    "created_at": "2016-09-07T16:20:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301236",
    "user": "https://github.com/nthiery"
}
```

Changed commit from **[59a04e4](https://github.com/sagemath/sagetrac-mirror/commit/59a04e46a93e6c0b4fe811fabf9c8eee7ed8e3e8)** to **[2d40948](https://github.com/sagemath/sagetrac-mirror/commit/2d409484e23387d98d8a697aaac76a70017f53e8)**



---

archive/issue_comments_301237.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nI read your new documentation; that's a very nice addition to the Sage documentation. I have done some changes here and there, and added a draft of explanation of the `cdef _add_` trick. Please proofread. The `_add_long` and `_mul_long` protocols need to be documented and tested in element.pyx; see the TODO there.\n\nOther than this, I believe this is good to go. Thanks a lot Jeroen!\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d409484e23387d98d8a697aaac76a70017f53e8\">2d40948</a></td><td><code>20767: Proofreading doc + doc of cdef `_add_` trick + TODO about _add_long / _mul_long</code></td></tr></table>\n",
    "created_at": "2016-09-07T16:20:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301237",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:49" align="right">comment:49</div>

I read your new documentation; that's a very nice addition to the Sage documentation. I have done some changes here and there, and added a draft of explanation of the `cdef _add_` trick. Please proofread. The `_add_long` and `_mul_long` protocols need to be documented and tested in element.pyx; see the TODO there.

Other than this, I believe this is good to go. Thanks a lot Jeroen!

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d409484e23387d98d8a697aaac76a70017f53e8">2d40948</a></td><td><code>20767: Proofreading doc + doc of cdef `_add_` trick + TODO about _add_long / _mul_long</code></td></tr></table>




---

archive/issue_comments_301238.json:
```json
{
    "body": "Changed branch from **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)** to **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)**",
    "created_at": "2016-09-08T09:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301238",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/nthiery/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/move_coercion_to_element)** to **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)**



---

archive/issue_comments_301239.json:
```json
{
    "body": "Changed commit from **[2d40948](https://github.com/sagemath/sagetrac-mirror/commit/2d409484e23387d98d8a697aaac76a70017f53e8)** to **[25c9d7d](https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2)**",
    "created_at": "2016-09-08T09:55:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301239",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2d40948](https://github.com/sagemath/sagetrac-mirror/commit/2d409484e23387d98d8a697aaac76a70017f53e8)** to **[25c9d7d](https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2)**



---

archive/issue_comments_301240.json:
```json
{
    "body": "<div id=\"comment:51\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2\">25c9d7d</a></td><td><code>Add tests for _add_long and _mul_long</code></td></tr></table>\n",
    "created_at": "2016-09-08T09:55:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301240",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2">25c9d7d</a></td><td><code>Add tests for _add_long and _mul_long</code></td></tr></table>




---

archive/issue_comments_301241.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nDone, needs review.",
    "created_at": "2016-09-08T09:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301241",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">comment:52</div>

Done, needs review.



---

archive/issue_comments_301242.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThanks; I checked your commits and am happy with them.\n\nTwo small questions:\n- The documentation currently seems to suggest that it's only possible to implement `_add_long` and `_mul_long` within a Cython class. Is that right? Of course, in a Python class it's probably rarely relevant to implement `_add_long`, but if this works there is no reason to hide it in the doc.\n\n- ``Concrete implementations (of `_add_`) in subclasses should be ``cpdef`` or ``def`` methods``: do we need to be specific? cdef would actually work too, right? Or is it because with cdef, a Python level call to `x._add_(y)` would fail?\n\nOnce you have made up your mind on the above, you can set a positive review on my behalf (assuming of course all tests keep passing).\n\nThanks!\n\nCheers,\n                       Nicolas",
    "created_at": "2016-09-08T14:12:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301242",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:53" align="right">comment:53</div>

Thanks; I checked your commits and am happy with them.

Two small questions:
- The documentation currently seems to suggest that it's only possible to implement `_add_long` and `_mul_long` within a Cython class. Is that right? Of course, in a Python class it's probably rarely relevant to implement `_add_long`, but if this works there is no reason to hide it in the doc.

- ``Concrete implementations (of `_add_`) in subclasses should be ``cpdef`` or ``def`` methods``: do we need to be specific? cdef would actually work too, right? Or is it because with cdef, a Python level call to `x._add_(y)` would fail?

Once you have made up your mind on the above, you can set a positive review on my behalf (assuming of course all tests keep passing).

Thanks!

Cheers,
                       Nicolas



---

archive/issue_comments_301243.json:
```json
{
    "body": "Reviewer: **Nicolas M. Thi\u00e9ry**",
    "created_at": "2016-09-08T14:21:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301243",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Nicolas M. Thi√©ry**



---

archive/issue_comments_301244.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@nthiery](#comment:53):\n> - The documentation currently seems to suggest that it's only possible to implement `_add_long` and `_mul_long` within a Cython class. Is that right?\n\nYes, it's a `cdef` method, so it's Cython-only. Since it is only an optimization, it makes little sense to allow it to be a Python method. If you care about performance, you should be using Cython anyway.\n\n> - ``Concrete implementations (of `_add_`) in subclasses should be ``cpdef`` or ``def`` methods``: do we need to be specific? cdef would actually work too, right?\n> Or is it because with cdef, a Python level call to `x._add_(y)` would fail?\n\nIt would work for `x + y` yes. But I think it is expected that `x._add_(y)` also works. Anyway, that is how things were historically.\n\nMaybe one could argue that `x._add_(y)` should not be required to work from Python. But let's not change that in this ticket.",
    "created_at": "2016-09-08T14:21:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301244",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@nthiery](#comment:53):
> - The documentation currently seems to suggest that it's only possible to implement `_add_long` and `_mul_long` within a Cython class. Is that right?

Yes, it's a `cdef` method, so it's Cython-only. Since it is only an optimization, it makes little sense to allow it to be a Python method. If you care about performance, you should be using Cython anyway.

> - ``Concrete implementations (of `_add_`) in subclasses should be ``cpdef`` or ``def`` methods``: do we need to be specific? cdef would actually work too, right?
> Or is it because with cdef, a Python level call to `x._add_(y)` would fail?

It would work for `x + y` yes. But I think it is expected that `x._add_(y)` also works. Anyway, that is how things were historically.

Maybe one could argue that `x._add_(y)` should not be required to work from Python. But let's not change that in this ticket.



---

archive/issue_events_292381.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-09-08T14:21:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292381"
}
```



---

archive/issue_events_292382.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-09-08T14:21:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292382"
}
```



---

archive/issue_comments_301245.json:
```json
{
    "body": "Changed dependencies from **#21126, #20686, #21139, #21140, #21152, #21153, #21154** to **#21126, #20686, #21139, #21140, #21152, #21153, #21154, #21441**",
    "created_at": "2016-09-09T07:28:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301245",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21126, #20686, #21139, #21140, #21152, #21153, #21154** to **#21126, #20686, #21139, #21140, #21152, #21153, #21154, #21441**



---

archive/issue_comments_301246.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThis ticket is suffering also from #21441 (see patchbot)",
    "created_at": "2016-09-09T07:28:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301246",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

This ticket is suffering also from #21441 (see patchbot)



---

archive/issue_comments_301247.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@nthiery](#comment:53):\n> - Concrete implementations (of `_add_`) in subclasses should be ``cpdef`` or ``def`` methods``: do we need to be specific? cdef would actually work too, right? Or is it because with cdef, a Python level call to `x._add_(y)` would fail?\n\nA more complete answer: yes, they really should be `cpdef` or `def` methods because you want to allow Python subclasses to override them. A `cdef` method is Cython-only and cannot be overridden by a Python method. Of course, `Element._add_` is `cdef` but it \"manually\" checks for a Python `_add_` method.",
    "created_at": "2016-09-09T07:42:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301247",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@nthiery](#comment:53):
> - Concrete implementations (of `_add_`) in subclasses should be ``cpdef`` or ``def`` methods``: do we need to be specific? cdef would actually work too, right? Or is it because with cdef, a Python level call to `x._add_(y)` would fail?

A more complete answer: yes, they really should be `cpdef` or `def` methods because you want to allow Python subclasses to override them. A `cdef` method is Cython-only and cannot be overridden by a Python method. Of course, `Element._add_` is `cdef` but it "manually" checks for a Python `_add_` method.



---

archive/issue_comments_301248.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nAh, yes, That's a good point indeed. Thanks!",
    "created_at": "2016-09-09T07:47:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301248",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:57" align="right">comment:57</div>

Ah, yes, That's a good point indeed. Thanks!



---

archive/issue_events_292383.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-10-03T22:41:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292383"
}
```



---

archive/issue_events_292384.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "be7c0f889d4705d3968049b061153559992c3418",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-10-03T22:41:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20767#event-292384"
}
```



---

archive/issue_comments_301249.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)** to **[25c9d7d](https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2)**",
    "created_at": "2016-10-03T22:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20767",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20767#issuecomment-301249",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/move_coercion_to_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/move_coercion_to_element)** to **[25c9d7d](https://github.com/sagemath/sagetrac-mirror/commit/25c9d7d6effbc50e9aeb0d7e8a7e18d92da30aa2)**
