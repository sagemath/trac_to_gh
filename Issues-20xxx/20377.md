# Issue 20377: Minimize use of is_package_installed at runtime

archive/issues_020140.json:
```json
{
    "body": "This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.\n\nI raised this as part of Sage days 77.\n\nRelated tickets:\n- #20382 Replace is_package_installed with Features\n- #21289 Don't use is_package_installed('bliss')\n- #21291 speed regression in is_package_installed\n- #21355 Timeout in graphs/tutte_polynomial.py\n\n\n**CC:**  @slel\n\n**Keywords:** sagedays 77\n\n**Branch:** [u/fbissey/is_pkg_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/is_pkg_installed)\n\n**Commit:** [aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)\n\n**Author:** Fran\u00e7ois Bissey\n\nIssue created by migration from https://trac.sagemath.org/ticket/20377\n\n",
    "closed_at": "2018-03-19T20:28:33Z",
    "created_at": "2016-04-07T01:21:35Z",
    "labels": [
        "component: packages: optional",
        "duplicate"
    ],
    "title": "Minimize use of is_package_installed at runtime",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/20377",
    "user": "https://github.com/kiwifb"
}
```
This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.

I raised this as part of Sage days 77.

Related tickets:
- #20382 Replace is_package_installed with Features
- #21289 Don't use is_package_installed('bliss')
- #21291 speed regression in is_package_installed
- #21355 Timeout in graphs/tutte_polynomial.py


**CC:**  @slel

**Keywords:** sagedays 77

**Branch:** [u/fbissey/is_pkg_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/is_pkg_installed)

**Commit:** [aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)

**Author:** Fran√ßois Bissey

Issue created by migration from https://trac.sagemath.org/ticket/20377





---

archive/issue_events_182890.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T01:21:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182890"
}
```



---

archive/issue_comments_296390.json:
```json
{
    "body": "<a id='comment:2'></a>\nYour branch points to the latest beta, did you forget to push or something?",
    "created_at": "2016-04-07T07:25:53Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296390",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:2'></a>
Your branch points to the latest beta, did you forget to push or something?



---

archive/issue_events_182891.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2016-04-07T07:25:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "component: packages: optional",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182891"
}
```



---

archive/issue_events_182892.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T07:28:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182892"
}
```



---

archive/issue_events_182893.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T07:28:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182893"
}
```



---

archive/issue_comments_296391.json:
```json
{
    "body": "<a id='comment:4'></a>\nI forgot to commit :(",
    "created_at": "2016-04-07T07:37:29Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296391",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
I forgot to commit :(



---

archive/issue_comments_296392.json:
```json
{
    "body": "**Changing commit** from \"[7ffcdd1d2fa4cd1b8d7557cc1de7701b8692e18b](https://github.com/sagemath/sagetrac-mirror/commit/7ffcdd1d2fa4cd1b8d7557cc1de7701b8692e18b)\" to \"[a8e208712c611396a6f3a80f326fd20468f1b03b](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)\".",
    "created_at": "2016-04-07T07:39:41Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7ffcdd1d2fa4cd1b8d7557cc1de7701b8692e18b](https://github.com/sagemath/sagetrac-mirror/commit/7ffcdd1d2fa4cd1b8d7557cc1de7701b8692e18b)" to "[a8e208712c611396a6f3a80f326fd20468f1b03b](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)".



---

archive/issue_comments_296393.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b\">a8e2087</a></td><td><code>first draft of minimizing is_package_installed</code></td></tr></table>\n",
    "created_at": "2016-04-07T07:39:41Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b">a8e2087</a></td><td><code>first draft of minimizing is_package_installed</code></td></tr></table>




---

archive/issue_events_182894.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T07:54:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182894"
}
```



---

archive/issue_events_182895.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T07:54:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182895"
}
```



---

archive/issue_events_182896.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-07T15:27:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182896"
}
```



---

archive/issue_events_182897.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-07T15:27:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182897"
}
```



---

archive/issue_comments_296394.json:
```json
{
    "body": "<a id='comment:7'></a>\nYou forget a colon\n\n```\n  File \"/home/worker/sage-patchbot/local/lib/python2.7/site-packages/sage/groups/generic.py\", line 1407\n    if not os.path.isfile(os.path.join(SAGE_LOCAL, \"gap\", \"latest\", \"small\", \"readsml.g\"))\n```",
    "created_at": "2016-04-07T15:27:03Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296394",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>
You forget a colon

```
  File "/home/worker/sage-patchbot/local/lib/python2.7/site-packages/sage/groups/generic.py", line 1407
    if not os.path.isfile(os.path.join(SAGE_LOCAL, "gap", "latest", "small", "readsml.g"))
```



---

archive/issue_comments_296395.json:
```json
{
    "body": "**Changing commit** from \"[a8e208712c611396a6f3a80f326fd20468f1b03b](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)\" to \"[d7d84834331724874a3798541cf16d9aae64f123](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)\".",
    "created_at": "2016-04-07T21:54:36Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a8e208712c611396a6f3a80f326fd20468f1b03b](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)" to "[d7d84834331724874a3798541cf16d9aae64f123](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)".



---

archive/issue_comments_296396.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123\">d7d8483</a></td><td><code>Add forgotten \":\"</code></td></tr></table>\n",
    "created_at": "2016-04-07T21:54:36Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296396",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123">d7d8483</a></td><td><code>Add forgotten ":"</code></td></tr></table>




---

archive/issue_comments_296397.json:
```json
{
    "body": "<a id='comment:9'></a>\nIf that's all I forgot that's not a bad score. This particular one was different in sage-on-gentoo because I don't ship this database separately from `gap` like it is done in sage so it doesn't need testing.\nI'll still need to patch that one one way or another because the path will be different on gentoo. Alternative proposal welcome.",
    "created_at": "2016-04-07T21:57:54Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296397",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
If that's all I forgot that's not a bad score. This particular one was different in sage-on-gentoo because I don't ship this database separately from `gap` like it is done in sage so it doesn't need testing.
I'll still need to patch that one one way or another because the path will be different on gentoo. Alternative proposal welcome.



---

archive/issue_comments_296398.json:
```json
{
    "body": "**Changing commit** from \"[d7d84834331724874a3798541cf16d9aae64f123](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)\" to \"[aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)\".",
    "created_at": "2016-04-07T22:36:58Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d7d84834331724874a3798541cf16d9aae64f123](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)" to "[aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)".



---

archive/issue_comments_296399.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b\">aba00ce</a></td><td><code>Merge branch 'develop' into is_pkg_installed</code></td></tr></table>\n",
    "created_at": "2016-04-07T22:36:58Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296399",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b">aba00ce</a></td><td><code>Merge branch 'develop' into is_pkg_installed</code></td></tr></table>




---

archive/issue_comments_296400.json:
```json
{
    "body": "<a id='comment:11'></a>\nIt seems we are working on the same issue ;)\n#20382 does essentially the same, maybe you want to have a look.\n\nIt seems to me that my approach is slightly more generic but I am open for discussion.",
    "created_at": "2016-04-07T22:43:35Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296400",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:11'></a>
It seems we are working on the same issue ;)
#20382 does essentially the same, maybe you want to have a look.

It seems to me that my approach is slightly more generic but I am open for discussion.



---

archive/issue_comments_296401.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.\n \n-I raised this as part of sage days 77.\n+I raised this as part of Sage days 77.\n+\n+Related tickets:\n+- #20382 Replace is_package_installed with Features\n+- #21289 Don't use is_package_installed('bliss')\n+- #21291 speed regression in is_package_installed\n+- #21355 Timeout in graphs/tutte_polynomial.py\n+\n``````\n",
    "created_at": "2016-08-29T08:27:11Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296401",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
 This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.
 
-I raised this as part of sage days 77.
+I raised this as part of Sage days 77.
+
+Related tickets:
+- #20382 Replace is_package_installed with Features
+- #21289 Don't use is_package_installed('bliss')
+- #21291 speed regression in is_package_installed
+- #21355 Timeout in graphs/tutte_polynomial.py
+
``````




---

archive/issue_events_182898.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2016-08-29T08:27:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "rename": {
        "from": "minimizing the use of is_package_install at runtime",
        "to": "Minimize use of is_package_installed at runtime"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182898"
}
```



---

archive/issue_comments_296402.json:
```json
{
    "body": "<a id='comment:13'></a>\nIs this still relevant or should it be closed in the light of #20382?",
    "created_at": "2018-03-19T20:15:16Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296402",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Is this still relevant or should it be closed in the light of #20382?



---

archive/issue_events_182899.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-03-19T20:18:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182899"
}
```



---

archive/issue_events_182900.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-03-19T20:18:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182900"
}
```



---

archive/issue_comments_296403.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A13):\n> Is this still relevant or should it be closed in the light of #20382?\n\n\nI think I should have marked this one duplicate months ago. There is nothing in here that #20382 doesn't do better.",
    "created_at": "2018-03-19T20:18:24Z",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296403",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A13):
> Is this still relevant or should it be closed in the light of #20382?


I think I should have marked this one duplicate months ago. There is nothing in here that #20382 doesn't do better.



---

archive/issue_events_182901.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-03-19T20:18:24Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182901"
}
```



---

archive/issue_events_182902.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-19T20:28:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182902"
}
```



---

archive/issue_events_182903.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-19T20:28:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182903"
}
```



---

archive/issue_events_182904.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-19T20:28:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "duplicate",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-182904"
}
```
