# Issue 20377: Minimize use of is_package_installed at runtime

archive/issues_020140.json:
```json
{
    "assignees": [],
    "body": "This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.\n\nI raised this as part of Sage days 77.\n\nRelated tickets:\n- #20382 Replace is_package_installed with Features\n- #21289 Don't use is_package_installed('bliss')\n- #21291 speed regression in is_package_installed\n- #21355 Timeout in graphs/tutte_polynomial.py\n\n\nCC:  @slel\n\nKeywords: **sagedays 77**\n\nBranch/Commit: **[u/fbissey/is_pkg_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/is_pkg_installed) @ [aba00ce](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)**\n\nAuthor: **Fran\u00e7ois Bissey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20377_\n\n",
    "closed_at": "2018-03-19T20:28:33Z",
    "created_at": "2016-04-07T01:21:35Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Minimize use of is_package_installed at runtime",
    "type": "issue",
    "updated_at": "2018-03-19T20:28:33Z",
    "url": "https://github.com/sagemath/sage/issues/20377",
    "user": "https://github.com/kiwifb"
}
```
This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.

I raised this as part of Sage days 77.

Related tickets:
- #20382 Replace is_package_installed with Features
- #21289 Don't use is_package_installed('bliss')
- #21291 speed regression in is_package_installed
- #21355 Timeout in graphs/tutte_polynomial.py


CC:  @slel

Keywords: **sagedays 77**

Branch/Commit: **[u/fbissey/is_pkg_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/is_pkg_installed) @ [aba00ce](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)**

Author: **Fran√ßois Bissey**

_Issue created by migration from https://trac.sagemath.org/ticket/20377_





---

archive/issue_events_259880.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T01:21:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259880"
}
```



---

archive/issue_events_259881.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T01:21:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259881"
}
```



---

archive/issue_comments_296493.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nYour branch points to the latest beta, did you forget to push or something?",
    "created_at": "2016-04-07T07:25:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296493",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:2'>Comment 2:</a>
Your branch points to the latest beta, did you forget to push or something?



---

archive/issue_events_259882.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2016-04-07T07:25:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259882"
}
```



---

archive/issue_events_259883.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T07:28:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259883"
}
```



---

archive/issue_events_259884.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T07:28:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259884"
}
```



---

archive/issue_comments_296494.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI forgot to commit :(",
    "created_at": "2016-04-07T07:37:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296494",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'>Comment 4:</a>
I forgot to commit :(



---

archive/issue_comments_296495.json:
```json
{
    "body": "Changed commit from **[7ffcdd1](https://github.com/sagemath/sagetrac-mirror/commit/7ffcdd1d2fa4cd1b8d7557cc1de7701b8692e18b)** to **[a8e2087](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)**",
    "created_at": "2016-04-07T07:39:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296495",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7ffcdd1](https://github.com/sagemath/sagetrac-mirror/commit/7ffcdd1d2fa4cd1b8d7557cc1de7701b8692e18b)** to **[a8e2087](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)**



---

archive/issue_comments_296496.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b\">a8e2087</a></td><td><code>first draft of minimizing is_package_installed</code></td></tr></table>\n",
    "created_at": "2016-04-07T07:39:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296496",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b">a8e2087</a></td><td><code>first draft of minimizing is_package_installed</code></td></tr></table>




---

archive/issue_events_259885.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T07:54:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259885"
}
```



---

archive/issue_events_259886.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-04-07T07:54:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259886"
}
```



---

archive/issue_events_259887.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-07T15:27:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259887"
}
```



---

archive/issue_events_259888.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-07T15:27:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259888"
}
```



---

archive/issue_comments_296497.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nYou forget a colon\n\n```\n  File \"/home/worker/sage-patchbot/local/lib/python2.7/site-packages/sage/groups/generic.py\", line 1407\n    if not os.path.isfile(os.path.join(SAGE_LOCAL, \"gap\", \"latest\", \"small\", \"readsml.g\"))\n```",
    "created_at": "2016-04-07T15:27:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296497",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'>Comment 7:</a>
You forget a colon

```
  File "/home/worker/sage-patchbot/local/lib/python2.7/site-packages/sage/groups/generic.py", line 1407
    if not os.path.isfile(os.path.join(SAGE_LOCAL, "gap", "latest", "small", "readsml.g"))
```



---

archive/issue_comments_296498.json:
```json
{
    "body": "Changed commit from **[a8e2087](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)** to **[d7d8483](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)**",
    "created_at": "2016-04-07T21:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296498",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a8e2087](https://github.com/sagemath/sagetrac-mirror/commit/a8e208712c611396a6f3a80f326fd20468f1b03b)** to **[d7d8483](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)**



---

archive/issue_comments_296499.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123\">d7d8483</a></td><td><code>Add forgotten \":\"</code></td></tr></table>\n",
    "created_at": "2016-04-07T21:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296499",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'>Comment 8:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123">d7d8483</a></td><td><code>Add forgotten ":"</code></td></tr></table>




---

archive/issue_comments_296500.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nIf that's all I forgot that's not a bad score. This particular one was different in sage-on-gentoo because I don't ship this database separately from `gap` like it is done in sage so it doesn't need testing.\nI'll still need to patch that one one way or another because the path will be different on gentoo. Alternative proposal welcome.",
    "created_at": "2016-04-07T21:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296500",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'>Comment 9:</a>
If that's all I forgot that's not a bad score. This particular one was different in sage-on-gentoo because I don't ship this database separately from `gap` like it is done in sage so it doesn't need testing.
I'll still need to patch that one one way or another because the path will be different on gentoo. Alternative proposal welcome.



---

archive/issue_comments_296501.json:
```json
{
    "body": "Changed commit from **[d7d8483](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)** to **[aba00ce](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)**",
    "created_at": "2016-04-07T22:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296501",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d7d8483](https://github.com/sagemath/sagetrac-mirror/commit/d7d84834331724874a3798541cf16d9aae64f123)** to **[aba00ce](https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b)**



---

archive/issue_comments_296502.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b\">aba00ce</a></td><td><code>Merge branch 'develop' into is_pkg_installed</code></td></tr></table>\n",
    "created_at": "2016-04-07T22:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296502",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aba00ce5414227f4d1a2fb9fcb7af8ba8d81ea6b">aba00ce</a></td><td><code>Merge branch 'develop' into is_pkg_installed</code></td></tr></table>




---

archive/issue_comments_296503.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nIt seems we are working on the same issue ;)\n#20382 does essentially the same, maybe you want to have a look.\n\nIt seems to me that my approach is slightly more generic but I am open for discussion.",
    "created_at": "2016-04-07T22:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296503",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:11'>Comment 11:</a>
It seems we are working on the same issue ;)
#20382 does essentially the same, maybe you want to have a look.

It seems to me that my approach is slightly more generic but I am open for discussion.



---

archive/issue_comments_296504.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.\n \n-I raised this as part of sage days 77.\n+I raised this as part of Sage days 77.\n+\n+Related tickets:\n+- #20382 Replace is_package_installed with Features\n+- #21289 Don't use is_package_installed('bliss')\n+- #21291 speed regression in is_package_installed\n+- #21355 Timeout in graphs/tutte_polynomial.py\n+\n``````\n",
    "created_at": "2016-08-29T08:27:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296504",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
 This is helpful for sage-on-distributions. Typically sage-on-distribution do not want, or need, to call sage's internal packaging system.
 
-I raised this as part of sage days 77.
+I raised this as part of Sage days 77.
+
+Related tickets:
+- #20382 Replace is_package_installed with Features
+- #21289 Don't use is_package_installed('bliss')
+- #21291 speed regression in is_package_installed
+- #21355 Timeout in graphs/tutte_polynomial.py
+
``````




---

archive/issue_events_259889.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2016-08-29T08:27:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "title_is": "Minimize use of is_package_installed at runtime",
    "title_was": "minimizing the use of is_package_install at runtime",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259889"
}
```



---

archive/issue_comments_296505.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nIs this still relevant or should it be closed in the light of #20382?",
    "created_at": "2018-03-19T20:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296505",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'>Comment 13:</a>
Is this still relevant or should it be closed in the light of #20382?



---

archive/issue_events_259890.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-03-19T20:18:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259890"
}
```



---

archive/issue_events_259891.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-03-19T20:18:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259891"
}
```



---

archive/issue_comments_296506.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@jdemeyer](#comment%3A13):\n> Is this still relevant or should it be closed in the light of #20382?\n\nI think I should have marked this one duplicate months ago. There is nothing in here that #20382 doesn't do better.",
    "created_at": "2018-03-19T20:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20377#issuecomment-296506",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@jdemeyer](#comment%3A13):
> Is this still relevant or should it be closed in the light of #20382?

I think I should have marked this one duplicate months ago. There is nothing in here that #20382 doesn't do better.



---

archive/issue_events_259892.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-03-19T20:18:24Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "milestone_number": null,
    "milestone_title": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259892"
}
```



---

archive/issue_events_259893.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-19T20:28:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259893"
}
```



---

archive/issue_events_259894.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-19T20:28:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259894"
}
```



---

archive/issue_events_259895.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-19T20:28:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20377",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20377#event-259895"
}
```
