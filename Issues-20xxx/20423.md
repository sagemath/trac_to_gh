# Issue 20423: Updated patch for building MPFR on Cygwin

archive/issues_020186.json:
```json
{
    "body": "This is the update to #20380 with a new patch mirroring the upstream fix for the same issue.  The patch I added was taking [directly from SVN](https://gforge.inria.fr/scm/viewvc.php/mpfr/trunk/src/mpfr-impl.h?r1=10257&r2=10260&view=patch) and applies to the current version of MPFR in sage with some fuzz (I don't know if this matters or not).\n\nI confirmed that, as expected, like #20380 this fixes building MPFR on Cygwin.\n\nKeywords: windows cygwin days77\n\nUpstream: Fixed upstream, but not in a stable release.\n\nReviewer: Jeroen Demeyer\n\nAuthor: Erik Bray\n\nBranch: 88561528acf90120d298a14d21062ee7ede2600b\n\nCommit: 88561528acf90120d298a14d21062ee7ede2600b\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20423\n\n",
    "closed_at": "2016-04-14T21:56:54Z",
    "created_at": "2016-04-11T14:25:49Z",
    "labels": [
        "component: porting: cygwin",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Updated patch for building MPFR on Cygwin",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20423",
    "user": "https://github.com/embray"
}
```
This is the update to #20380 with a new patch mirroring the upstream fix for the same issue.  The patch I added was taking [directly from SVN](https://gforge.inria.fr/scm/viewvc.php/mpfr/trunk/src/mpfr-impl.h?r1=10257&r2=10260&view=patch) and applies to the current version of MPFR in sage with some fuzz (I don't know if this matters or not).

I confirmed that, as expected, like #20380 this fixes building MPFR on Cygwin.

Keywords: windows cygwin days77

Upstream: Fixed upstream, but not in a stable release.

Reviewer: Jeroen Demeyer

Author: Erik Bray

Branch: 88561528acf90120d298a14d21062ee7ede2600b

Commit: 88561528acf90120d298a14d21062ee7ede2600b

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20423





---

archive/issue_comments_277948.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-11T14:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277948",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_277949.json:
```json
{
    "body": "<a id='comment:2'></a>One detail: could you add some comment on the top of the patch file? In particular, a link to the SVN repo and this Sage ticket would be useful.\n\nI cannot test on Cygwin myself, but if you tell me that it works for you, then I'll believe that. I checked that it doesn't break anything on Linux.",
    "created_at": "2016-04-12T09:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277949",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>One detail: could you add some comment on the top of the patch file? In particular, a link to the SVN repo and this Sage ticket would be useful.

I cannot test on Cygwin myself, but if you tell me that it works for you, then I'll believe that. I checked that it doesn't break anything on Linux.



---

archive/issue_comments_277950.json:
```json
{
    "body": "<a id='comment:3'></a>Sure--perhaps something in the SPKG.txt as well?",
    "created_at": "2016-04-12T09:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277950",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>Sure--perhaps something in the SPKG.txt as well?



---

archive/issue_comments_277951.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 embray]:\n> Sure--perhaps something in the SPKG.txt as well?\n\n\nThat's not really needed. Better just document it in one place.",
    "created_at": "2016-04-12T09:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277951",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Replying to [comment:3 embray]:
> Sure--perhaps something in the SPKG.txt as well?


That's not really needed. Better just document it in one place.



---

archive/issue_comments_277952.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-12T09:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277952",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_277953.json:
```json
{
    "body": "Changing component from build to porting: Cygwin.",
    "created_at": "2016-04-12T09:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277953",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from build to porting: Cygwin.



---

archive/issue_comments_277954.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-12T09:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277954",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_277955.json:
```json
{
    "body": "<a id='comment:7'></a>merge conflict",
    "created_at": "2016-04-12T20:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277955",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>merge conflict



---

archive/issue_comments_277956.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-04-12T20:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277956",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_277957.json:
```json
{
    "body": "<a id='comment:8'></a>So my patch from #20380 *was* merged?  That was very non-obvious.",
    "created_at": "2016-04-13T12:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277957",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>So my patch from #20380 *was* merged?  That was very non-obvious.



---

archive/issue_comments_277958.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-04-13T12:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277958",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_277959.json:
```json
{
    "body": "<a id='comment:10'></a>Rebased.",
    "created_at": "2016-04-13T12:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277959",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>Rebased.



---

archive/issue_comments_277960.json:
```json
{
    "body": "<a id='comment:11'></a>If it's ready for review, change the status to `needs_review`.",
    "created_at": "2016-04-13T12:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277960",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>If it's ready for review, change the status to `needs_review`.



---

archive/issue_comments_277961.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:8 embray]:\n> So my patch from #20380 *was* merged?  That was very non-obvious.\n\n\nWhen a ticket is closed as \"fixed\", it means that it's merged in Volker's private branch https://github.com/vbraun/sage/tree/develop\nThis happens before buildbot testing.\n\nThis is really a private branch, which means that you should not use it for development. It is common for git history to be rewritten in that branch.\n\nAfter buildbot testing, Volker will release a new beta release and Volker's branch will become the \"real\" `develop` branch.",
    "created_at": "2016-04-13T12:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277961",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:8 embray]:
> So my patch from #20380 *was* merged?  That was very non-obvious.


When a ticket is closed as "fixed", it means that it's merged in Volker's private branch https://github.com/vbraun/sage/tree/develop
This happens before buildbot testing.

This is really a private branch, which means that you should not use it for development. It is common for git history to be rewritten in that branch.

After buildbot testing, Volker will release a new beta release and Volker's branch will become the "real" `develop` branch.



---

archive/issue_comments_277962.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-13T14:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277962",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_277963.json:
```json
{
    "body": "<a id='comment:13'></a>Thanks for the explanation--that explains why I didn't see it merged in `develop`.\n\nI'm no so sure how I feel about that. It would be nice to have a branch in the main repo representing what is currently merged, rather than on someone else's fork.  I'm also confused why it would be closed as \"fixed\" if buildbot testing hasn't run yet--isn't it possible the ticket will be reopened if the testing fails?",
    "created_at": "2016-04-13T14:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277963",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>Thanks for the explanation--that explains why I didn't see it merged in `develop`.

I'm no so sure how I feel about that. It would be nice to have a branch in the main repo representing what is currently merged, rather than on someone else's fork.  I'm also confused why it would be closed as "fixed" if buildbot testing hasn't run yet--isn't it possible the ticket will be reopened if the testing fails?



---

archive/issue_comments_277964.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 embray]:\n> isn't it possible the ticket will be reopened if the testing fails?\n\n\nYes, that's possible and it happens occasionally.",
    "created_at": "2016-04-13T14:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277964",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:13 embray]:
> isn't it possible the ticket will be reopened if the testing fails?


Yes, that's possible and it happens occasionally.



---

archive/issue_comments_277965.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-13T14:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277965",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_277966.json:
```json
{
    "body": "<a id='comment:16'></a>I'd suggest an additional workflow stage representing this.  To me something isn't \"fixed\" if the \"fix\" breaks the build.",
    "created_at": "2016-04-14T10:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277966",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>I'd suggest an additional workflow stage representing this.  To me something isn't "fixed" if the "fix" breaks the build.



---

archive/issue_comments_277967.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 embray]:\n> I'd suggest an additional workflow stage representing this.  To me something isn't \"fixed\" if the \"fix\" breaks the build.\n\n\nI would suggest no additional workflow stage, just to close the ticket as fixed only when it's actually going to be merged. That was how I operated as release manager.\n\nBut it's not my decision, you have to convince Volker.",
    "created_at": "2016-04-14T11:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277967",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>Replying to [comment:16 embray]:
> I'd suggest an additional workflow stage representing this.  To me something isn't "fixed" if the "fix" breaks the build.


I would suggest no additional workflow stage, just to close the ticket as fixed only when it's actually going to be merged. That was how I operated as release manager.

But it's not my decision, you have to convince Volker.



---

archive/issue_comments_277968.json:
```json
{
    "body": "<a id='comment:18'></a>Either way.",
    "created_at": "2016-04-14T11:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277968",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'></a>Either way.



---

archive/issue_comments_277969.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-14T21:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20423#issuecomment-277969",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_055276.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-14T21:56:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20423",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20423#event-55276"
}
```
