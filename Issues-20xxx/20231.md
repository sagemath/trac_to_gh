# Issue 20231: Blacklist GCC 4.8.x

archive/issues_019994.json:
```json
{
    "assignees": [],
    "body": "While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)\n\nSince this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.\n\nComponent: **build: configure**\n\nAuthor: **Jeroen Demeyer**\n\nBranch: **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20231_\n\n",
    "closed_at": "2016-03-23T12:46:40Z",
    "created_at": "2016-03-18T11:09:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Blacklist GCC 4.8.x",
    "type": "issue",
    "updated_at": "2016-05-11T19:31:29Z",
    "url": "https://github.com/sagemath/sage/issues/20231",
    "user": "https://github.com/jdemeyer"
}
```
While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)

Since this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.

Component: **build: configure**

Author: **Jeroen Demeyer**

Branch: **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)**

Reviewer: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/20231_





---

archive/issue_events_283106.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T11:09:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283106"
}
```



---

archive/issue_events_283107.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T11:09:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "0000b0",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283107"
}
```



---

archive/issue_events_283108.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T11:09:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283108"
}
```



---

archive/issue_events_283109.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T11:09:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283109"
}
```



---

archive/issue_comments_291073.json:
```json
{
    "body": "Branch: **[u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)**",
    "created_at": "2016-03-18T17:15:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291073",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)**



---

archive/issue_comments_291074.json:
```json
{
    "body": "Commit: **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)**",
    "created_at": "2016-03-18T17:38:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291074",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)**



---

archive/issue_comments_291075.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18\"><code>37defe3</code></a></td><td><code>Blacklist GCC versions 4.8.x</code></td></tr></table>\n",
    "created_at": "2016-03-18T17:38:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291075",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18"><code>37defe3</code></a></td><td><code>Blacklist GCC versions 4.8.x</code></td></tr></table>




---

archive/issue_events_283110.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T17:38:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283110"
}
```



---

archive/issue_events_283111.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-18T20:47:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283111"
}
```



---

archive/issue_events_283112.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-18T20:47:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283112"
}
```



---

archive/issue_comments_291076.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2016-03-18T20:47:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291076",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_291077.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nlooks good to me",
    "created_at": "2016-03-18T20:47:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291077",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

looks good to me



---

archive/issue_events_283113.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-21T12:25:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283113"
}
```



---

archive/issue_events_283114.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-21T12:25:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "milestone_number": null,
    "milestone_title": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283114"
}
```



---

archive/issue_comments_291078.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)** to **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)**",
    "created_at": "2016-03-23T12:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291078",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)** to **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)**



---

archive/issue_events_283115.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-23T12:46:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283115"
}
```



---

archive/issue_events_283116.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a7e9d37b9358b5d8c7b81ecf0994fe7b871a34b3",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-03-23T12:46:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-283116"
}
```



---

archive/issue_comments_291079.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nWas this announced in sage-devel?  After rebasing branch I was working in on the current develop sage suddenly wants to compile gcc because of this.  gcc 4.8 is the default version on Ubuntu 14.04 which is the current LTS (not counting 16.04 which hasn't quite yet been released).\n\nIt seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.  As a compromise, perhaps issue a loud warning when the workaround is used as it may affect performance, for anyone who cares.  It would only need to be enabled for those modules that need it.",
    "created_at": "2016-04-20T14:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291079",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

Was this announced in sage-devel?  After rebasing branch I was working in on the current develop sage suddenly wants to compile gcc because of this.  gcc 4.8 is the default version on Ubuntu 14.04 which is the current LTS (not counting 16.04 which hasn't quite yet been released).

It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.  As a compromise, perhaps issue a loud warning when the workaround is used as it may affect performance, for anyone who cares.  It would only need to be enabled for those modules that need it.



---

archive/issue_comments_291080.json:
```json
{
    "body": "Changed commit from **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)** to none",
    "created_at": "2016-04-20T14:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291080",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`37defe3`](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)** to none



---

archive/issue_comments_291081.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-While working on #20226, I got hit by a similar problem as #14460. Since that bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.\n+While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)\n+\n+Since this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.\n``````\n",
    "created_at": "2016-04-20T14:42:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291081",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-While working on #20226, I got hit by a similar problem as #14460. Since that bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.
+While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)
+
+Since this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.
``````




---

archive/issue_comments_291082.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@embray](#comment%3A6):\n> Was this announced in sage-devel?\n\nNo.\n\n> It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.\n\nThere is no simple workaround. The `-fno-tree-dominator-opts` workaround happens to fix one particular instance of the problem, not the problem in general. In particular, `-fno-tree-dominator-opts` does not fix the similar issue from #20226. I was too lazy to investigate yet another workaround for #20226.",
    "created_at": "2016-04-20T14:42:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291082",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@embray](#comment%3A6):
> Was this announced in sage-devel?

No.

> It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.

There is no simple workaround. The `-fno-tree-dominator-opts` workaround happens to fix one particular instance of the problem, not the problem in general. In particular, `-fno-tree-dominator-opts` does not fix the similar issue from #20226. I was too lazy to investigate yet another workaround for #20226.



---

archive/issue_comments_291083.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nDon't you think dropping support for an entire series of compiler versions that is still relatively commonly in use, without a deprecation process and without warning is a bit of a problem?\n\nI'm sure there's a workaround in the other case too.",
    "created_at": "2016-04-21T07:24:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291083",
    "user": "https://github.com/embray"
}
```

<div id="comment:8" align="right">comment:8</div>

Don't you think dropping support for an entire series of compiler versions that is still relatively commonly in use, without a deprecation process and without warning is a bit of a problem?

I'm sure there's a workaround in the other case too.



---

archive/issue_comments_291084.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nFor that matter even if it `-fno-tree-dominator-opts` were the workaround it doesn't need to be applied to the whole module. It could be applied at the function level too.  If there's some optimization that's producing incorrect code around `setjmp` that's not surprising but I'm sure we could see what it's doing and disable that.",
    "created_at": "2016-04-21T07:26:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291084",
    "user": "https://github.com/embray"
}
```

<div id="comment:9" align="right">comment:9</div>

For that matter even if it `-fno-tree-dominator-opts` were the workaround it doesn't need to be applied to the whole module. It could be applied at the function level too.  If there's some optimization that's producing incorrect code around `setjmp` that's not surprising but I'm sure we could see what it's doing and disable that.



---

archive/issue_comments_291085.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReverting in #20594.",
    "created_at": "2016-05-11T19:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-291085",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Reverting in #20594.
