# Issue 20231: Blacklist GCC 4.8.x

archive/issues_019994.json:
```json
{
    "body": "While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)\n\nSince this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.\n\n**Branch:** [37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/20231\n\n",
    "closed_at": "2016-03-23T12:46:40Z",
    "created_at": "2016-03-18T11:09:38Z",
    "labels": [
        "component: build: configure",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.2",
    "title": "Blacklist GCC 4.8.x",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/20231",
    "user": "https://github.com/jdemeyer"
}
```
While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)

Since this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.

**Branch:** [37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)

**Reviewer:** Frédéric Chapoton

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/20231





---

archive/issue_comments_293629.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)",
    "created_at": "2016-03-18T17:15:29Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293629",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)



---

archive/issue_comments_293630.json:
```json
{
    "body": "**Commit:** [37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)",
    "created_at": "2016-03-18T17:38:26Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293630",
    "user": "https://github.com/jdemeyer"
}
```

**Commit:** [37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)



---

archive/issue_comments_293631.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18\">37defe3</a></td><td><code>Blacklist GCC versions 4.8.x</code></td></tr></table>\n",
    "created_at": "2016-03-18T17:38:26Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293631",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18">37defe3</a></td><td><code>Blacklist GCC versions 4.8.x</code></td></tr></table>




---

archive/issue_events_181678.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-18T17:38:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181678"
}
```



---

archive/issue_events_181679.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-18T20:47:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181679"
}
```



---

archive/issue_events_181680.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-18T20:47:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181680"
}
```



---

archive/issue_comments_293632.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2016-03-18T20:47:35Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293632",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_293633.json:
```json
{
    "body": "<a id='comment:3'></a>\nlooks good to me",
    "created_at": "2016-03-18T20:47:35Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293633",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
looks good to me



---

archive/issue_events_181681.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-21T12:25:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181681"
}
```



---

archive/issue_events_181682.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-21T12:25:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181682"
}
```



---

archive/issue_comments_293634.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)\" to \"[37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)\".",
    "created_at": "2016-03-23T12:46:40Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293634",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/blacklist_gcc_4_8_x](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/blacklist_gcc_4_8_x)" to "[37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)".



---

archive/issue_events_181683.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-23T12:46:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181683"
}
```



---

archive/issue_events_181684.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a7e9d37b9358b5d8c7b81ecf0994fe7b871a34b3",
    "created_at": "2016-03-23T12:46:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20231#event-181684"
}
```



---

archive/issue_comments_293635.json:
```json
{
    "body": "<a id='comment:6'></a>\nWas this announced in sage-devel?  After rebasing branch I was working in on the current develop sage suddenly wants to compile gcc because of this.  gcc 4.8 is the default version on Ubuntu 14.04 which is the current LTS (not counting 16.04 which hasn't quite yet been released).\n\nIt seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.  As a compromise, perhaps issue a loud warning when the workaround is used as it may affect performance, for anyone who cares.  It would only need to be enabled for those modules that need it.",
    "created_at": "2016-04-20T14:27:23Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293635",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>
Was this announced in sage-devel?  After rebasing branch I was working in on the current develop sage suddenly wants to compile gcc because of this.  gcc 4.8 is the default version on Ubuntu 14.04 which is the current LTS (not counting 16.04 which hasn't quite yet been released).

It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.  As a compromise, perhaps issue a loud warning when the workaround is used as it may affect performance, for anyone who cares.  It would only need to be enabled for those modules that need it.



---

archive/issue_comments_293636.json:
```json
{
    "body": "**Changing commit** from \"[37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)\" to \"\".",
    "created_at": "2016-04-20T14:27:23Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293636",
    "user": "https://github.com/embray"
}
```

**Changing commit** from "[37defe3940307cd63a41d3d993715bba0c529c18](https://github.com/sagemath/sagetrac-mirror/commit/37defe3940307cd63a41d3d993715bba0c529c18)" to "".



---

archive/issue_comments_293637.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-While working on #20226, I got hit by a similar problem as #14460. Since that bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.\n+While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)\n+\n+Since this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.\n``````\n",
    "created_at": "2016-04-20T14:42:28Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293637",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-While working on #20226, I got hit by a similar problem as #14460. Since that bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.
+While working on #20226, I got hit by a similar problem as #14460, namely [https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982)
+
+Since this bug is supposed to be fixed upstream in GCC 4.9.0, I think the time has come to blacklist all GCC versions older than 4.9.
``````




---

archive/issue_comments_293638.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [embray](#comment%3A6):\n> Was this announced in sage-devel?\n\nNo.\n\n> It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.\n\nThere is no simple workaround. The `-fno-tree-dominator-opts` workaround happens to fix one particular instance of the problem, not the problem in general. In particular, `-fno-tree-dominator-opts` does not fix the similar issue from #20226. I was too lazy to investigate yet another workaround for #20226.",
    "created_at": "2016-04-20T14:42:28Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293638",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [embray](#comment%3A6):
> Was this announced in sage-devel?

No.

> It seems extreme to me to blacklist an entire compiler when there's a simple workaround (`-fno-tree-dominator-opts`) that can be applied only for that version.

There is no simple workaround. The `-fno-tree-dominator-opts` workaround happens to fix one particular instance of the problem, not the problem in general. In particular, `-fno-tree-dominator-opts` does not fix the similar issue from #20226. I was too lazy to investigate yet another workaround for #20226.



---

archive/issue_comments_293639.json:
```json
{
    "body": "<a id='comment:8'></a>\nDon't you think dropping support for an entire series of compiler versions that is still relatively commonly in use, without a deprecation process and without warning is a bit of a problem?\n\nI'm sure there's a workaround in the other case too.",
    "created_at": "2016-04-21T07:24:14Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293639",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
Don't you think dropping support for an entire series of compiler versions that is still relatively commonly in use, without a deprecation process and without warning is a bit of a problem?

I'm sure there's a workaround in the other case too.



---

archive/issue_comments_293640.json:
```json
{
    "body": "<a id='comment:9'></a>\nFor that matter even if it `-fno-tree-dominator-opts` were the workaround it doesn't need to be applied to the whole module. It could be applied at the function level too.  If there's some optimization that's producing incorrect code around `setjmp` that's not surprising but I'm sure we could see what it's doing and disable that.",
    "created_at": "2016-04-21T07:26:41Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293640",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
For that matter even if it `-fno-tree-dominator-opts` were the workaround it doesn't need to be applied to the whole module. It could be applied at the function level too.  If there's some optimization that's producing incorrect code around `setjmp` that's not surprising but I'm sure we could see what it's doing and disable that.



---

archive/issue_comments_293641.json:
```json
{
    "body": "<a id='comment:10'></a>\nReverting in #20594.",
    "created_at": "2016-05-11T19:31:29Z",
    "issue": "https://github.com/sagemath/sage/issues/20231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20231#issuecomment-293641",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Reverting in #20594.
