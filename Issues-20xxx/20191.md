# Issue 20191: implement SymPy Piecewise equivalent

archive/issues_019954.json:
```json
{
    "body": "This shows an equivalent to SymPy's `Piecewise` is missing in Sage:\n\n```\n        sage: _ = var('y, z')\n        sage: (x^y - z).integrate(y)\n        -y*z + x^y/log(x)\n        sage: (x^y - z).integrate(y, algorithm=\"sympy\")  # see Trac #14694\n        Traceback (most recent call last):\n        ...\n        AttributeError: 'ExprCondPair' object has no attribute '_sage_'\n\nSymPy-1.0:\n>>> integrate(x**y-z,y)\n       \u239b\u23a7  y     for log(x) = 0\u239e\n       \u239c\u23aa                      \u239f\n       \u239c\u23aa   y                  \u239f\n -y\u22c5z + \u239c\u23a8  x                   \u239f\n       \u239c\u23aa\u2500\u2500\u2500\u2500\u2500\u2500    otherwise   \u239f\n       \u239c\u23aalog(x)                \u239f\n       \u239d\u23a9                      \u23a0\n\n```\n`Piecewise` in SymPy is a held function of `ExprCondPair` arguments. It would be a superset of our `piecewise`. The name should not be confusable, a suggestion is `if_then([(log(x)==0, y), (x^y/log(x), 1)])`.\n\nWhen it is implemented a SymPy patch should be done for the `_sage_` method.\n\nEDIT: Maxima 5.38.1 returns a similar function for some integrals.\n\nCC:  @mforets\n\nBranch/Commit: 1929337bc3d226c2d490ce9e6727bb0f52d408a6\n\nReviewer: Travis Scrimshaw\n\nAuthor: Ralf Stephan\n\nDependencies: #23820\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20191\n\n",
    "closed_at": "2017-09-26T06:57:59Z",
    "created_at": "2016-03-11T08:24:24Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "implement SymPy Piecewise equivalent",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20191",
    "user": "https://github.com/rwst"
}
```
This shows an equivalent to SymPy's `Piecewise` is missing in Sage:

```
        sage: _ = var('y, z')
        sage: (x^y - z).integrate(y)
        -y*z + x^y/log(x)
        sage: (x^y - z).integrate(y, algorithm="sympy")  # see Trac #14694
        Traceback (most recent call last):
        ...
        AttributeError: 'ExprCondPair' object has no attribute '_sage_'

SymPy-1.0:
>>> integrate(x**y-z,y)
       ⎛⎧  y     for log(x) = 0⎞
       ⎜⎪                      ⎟
       ⎜⎪   y                  ⎟
 -y⋅z + ⎜⎨  x                   ⎟
       ⎜⎪──────    otherwise   ⎟
       ⎜⎪log(x)                ⎟
       ⎝⎩                      ⎠

```
`Piecewise` in SymPy is a held function of `ExprCondPair` arguments. It would be a superset of our `piecewise`. The name should not be confusable, a suggestion is `if_then([(log(x)==0, y), (x^y/log(x), 1)])`.

When it is implemented a SymPy patch should be done for the `_sage_` method.

EDIT: Maxima 5.38.1 returns a similar function for some integrals.

CC:  @mforets

Branch/Commit: 1929337bc3d226c2d490ce9e6727bb0f52d408a6

Reviewer: Travis Scrimshaw

Author: Ralf Stephan

Dependencies: #23820

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20191





---

archive/issue_comments_292270.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -22,6 +22,8 @@\n \\`\\`\\`\n When it is implemented a SymPy patch should be done for the \\`_sage_\\` method.\n \n+EDIT: Maxima 5.38.1 returns a similar function for some integrals.\n+\n Comment: 1\n \n Summary: implement ExprCondPair equivalent\n```\n",
    "created_at": "2016-11-14T13:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292270",
    "user": "https://github.com/rwst"
}
```

Description changed:
```diff
--- 
+++ 
@@ -22,6 +22,8 @@
 \`\`\`
 When it is implemented a SymPy patch should be done for the \`_sage_\` method.
 
+EDIT: Maxima 5.38.1 returns a similar function for some integrals.
+
 Comment: 1
 
 Summary: implement ExprCondPair equivalent
```




---

archive/issue_comments_292271.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,30 @@\n+This shows an equivalent to SymPy's \\`Piecewise\\` is missing in Sage:\n \n+\\`\\`\\`\n+        sage: _ = var('y, z')\n+        sage: (x^y - z).integrate(y)\n+        -y*z + x^y/log(x)\n+        sage: (x^y - z).integrate(y, algorithm=\"sympy\")  # see Trac #14694\n+        Traceback (most recent call last):\n+        ...\n+        AttributeError: 'ExprCondPair' object has no attribute '_sage_'\n+\n+SymPy-1.0:\n+>>> integrate(x**y-z,y)\n+       \u239b\u23a7  y     for log(x) = 0\u239e\n+       \u239c\u23aa                      \u239f\n+       \u239c\u23aa   y                  \u239f\n+-y\u22c5z + \u239c\u23a8  x                   \u239f\n+       \u239c\u23aa\u2500\u2500\u2500\u2500\u2500\u2500    otherwise   \u239f\n+       \u239c\u23aalog(x)                \u239f\n+       \u239d\u23a9                      \u23a0\n+\n+\\`\\`\\`\n+\\`Piecewise\\` in SymPy is a held function of \\`ExprCondPair\\` arguments. It would be a superset of our \\`piecewise\\`.\n+\n+When it is implemented a SymPy patch should be done for the \\`_sage_\\` method.\n+\n+EDIT: Maxima 5.38.1 returns a similar function for some integrals.\n \n Comment: 1\n \n```\n",
    "created_at": "2017-08-12T14:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292271",
    "user": "https://github.com/rwst"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,30 @@
+This shows an equivalent to SymPy's \`Piecewise\` is missing in Sage:
 
+\`\`\`
+        sage: _ = var('y, z')
+        sage: (x^y - z).integrate(y)
+        -y*z + x^y/log(x)
+        sage: (x^y - z).integrate(y, algorithm="sympy")  # see Trac #14694
+        Traceback (most recent call last):
+        ...
+        AttributeError: 'ExprCondPair' object has no attribute '_sage_'
+
+SymPy-1.0:
+>>> integrate(x**y-z,y)
+       ⎛⎧  y     for log(x) = 0⎞
+       ⎜⎪                      ⎟
+       ⎜⎪   y                  ⎟
+-y⋅z + ⎜⎨  x                   ⎟
+       ⎜⎪──────    otherwise   ⎟
+       ⎜⎪log(x)                ⎟
+       ⎝⎩                      ⎠
+
+\`\`\`
+\`Piecewise\` in SymPy is a held function of \`ExprCondPair\` arguments. It would be a superset of our \`piecewise\`.
+
+When it is implemented a SymPy patch should be done for the \`_sage_\` method.
+
+EDIT: Maxima 5.38.1 returns a similar function for some integrals.
 
 Comment: 1
 
```




---

archive/issue_events_054864.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-08-12T14:36:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20191#event-54864"
}
```



---

archive/issue_comments_292272.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,30 @@\n+This shows an equivalent to SymPy's \\`Piecewise\\` is missing in Sage:\n \n+\\`\\`\\`\n+        sage: _ = var('y, z')\n+        sage: (x^y - z).integrate(y)\n+        -y*z + x^y/log(x)\n+        sage: (x^y - z).integrate(y, algorithm=\"sympy\")  # see Trac #14694\n+        Traceback (most recent call last):\n+        ...\n+        AttributeError: 'ExprCondPair' object has no attribute '_sage_'\n+\n+SymPy-1.0:\n+>>> integrate(x**y-z,y)\n+       \u239b\u23a7  y     for log(x) = 0\u239e\n+       \u239c\u23aa                      \u239f\n+       \u239c\u23aa   y                  \u239f\n+ -y\u22c5z + \u239c\u23a8  x                   \u239f\n+       \u239c\u23aa\u2500\u2500\u2500\u2500\u2500\u2500    otherwise   \u239f\n+       \u239c\u23aalog(x)                \u239f\n+       \u239d\u23a9                      \u23a0\n+\n+\\`\\`\\`\n+\\`Piecewise\\` in SymPy is a held function of \\`ExprCondPair\\` arguments. It would be a superset of our \\`piecewise\\`. The name should not be confusable, a suggestion is \\`if_then([(log(x)==0, y), (x^y/log(x), 1)])\\`.\n+\n+When it is implemented a SymPy patch should be done for the \\`_sage_\\` method.\n+\n+EDIT: Maxima 5.38.1 returns a similar function for some integrals.\n \n Comment: 1\n \n```\n",
    "created_at": "2017-08-12T14:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292272",
    "user": "https://github.com/rwst"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,30 @@
+This shows an equivalent to SymPy's \`Piecewise\` is missing in Sage:
 
+\`\`\`
+        sage: _ = var('y, z')
+        sage: (x^y - z).integrate(y)
+        -y*z + x^y/log(x)
+        sage: (x^y - z).integrate(y, algorithm="sympy")  # see Trac #14694
+        Traceback (most recent call last):
+        ...
+        AttributeError: 'ExprCondPair' object has no attribute '_sage_'
+
+SymPy-1.0:
+>>> integrate(x**y-z,y)
+       ⎛⎧  y     for log(x) = 0⎞
+       ⎜⎪                      ⎟
+       ⎜⎪   y                  ⎟
+ -y⋅z + ⎜⎨  x                   ⎟
+       ⎜⎪──────    otherwise   ⎟
+       ⎜⎪log(x)                ⎟
+       ⎝⎩                      ⎠
+
+\`\`\`
+\`Piecewise\` in SymPy is a held function of \`ExprCondPair\` arguments. It would be a superset of our \`piecewise\`. The name should not be confusable, a suggestion is \`if_then([(log(x)==0, y), (x^y/log(x), 1)])\`.
+
+When it is implemented a SymPy patch should be done for the \`_sage_\` method.
+
+EDIT: Maxima 5.38.1 returns a similar function for some integrals.
 
 Comment: 1
 
```




---

archive/issue_comments_292273.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2017-08-19T14:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292273",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_292274.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-23T06:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292274",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_292275.json:
```json
{
    "body": "<a id='comment:9'></a>Does this solve the issue in the ticket description? If so, I feel like we should add that as a doctest. If not, then you can set a positive review and post in a comment here which ticket will actually address it.",
    "created_at": "2017-09-24T07:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292275",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>Does this solve the issue in the ticket description? If so, I feel like we should add that as a doctest. If not, then you can set a positive review and post in a comment here which ticket will actually address it.



---

archive/issue_comments_292276.json:
```json
{
    "body": "<a id='comment:10'></a>Right. #23923 depends on this.",
    "created_at": "2017-09-25T05:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292276",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>Right. #23923 depends on this.



---

archive/issue_comments_292277.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-25T05:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292277",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292278.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-26T06:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20191#issuecomment-292278",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054865.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-26T06:57:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20191",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20191#event-54865"
}
```
