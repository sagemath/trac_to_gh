# Issue 20922: Update Flask(-babel)

archive/issues_020685.json:
```json
{
    "body": "Flask 0.11.1 has a new dependency on https://pypi.python.org/simple/click/\n\nCC:  @jdemeyer @kcrisman @dimpase @timokau @mkoeppe\n\nReviewer: Matthias Koeppe\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/20922\n\n",
    "closed_at": "2021-03-05T17:24:57Z",
    "created_at": "2016-07-02T11:49:30Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Update Flask(-babel)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20922",
    "user": "https://github.com/vbraun"
}
```
Flask 0.11.1 has a new dependency on https://pypi.python.org/simple/click/

CC:  @jdemeyer @kcrisman @dimpase @timokau @mkoeppe

Reviewer: Matthias Koeppe

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/20922





---

archive/issue_comments_382158.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2016-07-02T11:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382158",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_382159.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2016-07-02T11:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382159",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_382160.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Flask 0.11.1 has a new dependency on https://pypi.python.org/simple/click/\n``````\n",
    "created_at": "2016-07-02T11:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382160",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Flask 0.11.1 has a new dependency on https://pypi.python.org/simple/click/
``````




---

archive/issue_comments_382161.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/update_flask__babel_\"",
    "created_at": "2016-07-02T11:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382161",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/update_flask__babel_"



---

archive/issue_comments_382162.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-02T11:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382162",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382163.json:
```json
{
    "body": "Changing commit from \"\" to \"ea5d90fddb95bc90e21796fdfe708cee4adc80e8\"",
    "created_at": "2016-07-02T11:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "ea5d90fddb95bc90e21796fdfe708cee4adc80e8"



---

archive/issue_comments_382164.json:
```json
{
    "body": "<a id='comment:4'></a>A bunch of sagenb failures with the new flask/babel:\n\n```\nsage -t --long local/lib/python2.7/site-packages/sagenb/notebook/cell.py  # 11 doctests failed\nsage -t --long local/lib/python2.7/site-packages/sagenb/notebook/worksheet.py  # 11 doctests failed\nsage -t --long local/lib/python2.7/site-packages/sagenb/notebook/notebook.py  # 17 doctests failed\nsage -t --long local/lib/python2.7/site-packages/sagenb/notebook/challenge.py  # 8 doctests failed\nsage -t --long local/lib/python2.7/site-packages/sagenb/notebook/template.py  # 8 doctests failed\n```\nbecause some stuff in flask was moved around:\n\n```\nsage -t --long local/lib/python2.7/site-packages/sagenb/notebook/challenge.py\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb/notebook/challenge.py\", line 451, in sagenb.notebook.challenge.reCAPTCHAChallenge.html\nFailed example:\n    from sagenb.flask_version import base # random output -- depends on warnings issued by other sage packages\nException raised:\n    Traceback (most recent call last):\n      File \"/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sagenb.notebook.challenge.reCAPTCHAChallenge.html[0]>\", line 1, in <module>\n        from sagenb.flask_version import base # random output -- depends on warnings issued by other sage packages\n      File \"/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sagenb/flask_version/base.py\", line 4, in <module>\n        from flask import Flask, Module, url_for, request, session, redirect, g, make_response, current_app, render_template\n    ImportError: cannot import name Module\n**********************************************************************\n```",
    "created_at": "2016-07-02T16:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382164",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>A bunch of sagenb failures with the new flask/babel:

```
sage -t --long local/lib/python2.7/site-packages/sagenb/notebook/cell.py  # 11 doctests failed
sage -t --long local/lib/python2.7/site-packages/sagenb/notebook/worksheet.py  # 11 doctests failed
sage -t --long local/lib/python2.7/site-packages/sagenb/notebook/notebook.py  # 17 doctests failed
sage -t --long local/lib/python2.7/site-packages/sagenb/notebook/challenge.py  # 8 doctests failed
sage -t --long local/lib/python2.7/site-packages/sagenb/notebook/template.py  # 8 doctests failed
```
because some stuff in flask was moved around:

```
sage -t --long local/lib/python2.7/site-packages/sagenb/notebook/challenge.py
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb/notebook/challenge.py", line 451, in sagenb.notebook.challenge.reCAPTCHAChallenge.html
Failed example:
    from sagenb.flask_version import base # random output -- depends on warnings issued by other sage packages
Exception raised:
    Traceback (most recent call last):
      File "/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sagenb.notebook.challenge.reCAPTCHAChallenge.html[0]>", line 1, in <module>
        from sagenb.flask_version import base # random output -- depends on warnings issued by other sage packages
      File "/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sagenb/flask_version/base.py", line 4, in <module>
        from flask import Flask, Module, url_for, request, session, redirect, g, make_response, current_app, render_template
    ImportError: cannot import name Module
**********************************************************************
```



---

archive/issue_comments_382165.json:
```json
{
    "body": "<a id='comment:5'></a>The replacement for \"Module\" may be \"Blueprint\", but the syntax is not quite the same.",
    "created_at": "2017-02-26T10:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382165",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>The replacement for "Module" may be "Blueprint", but the syntax is not quite the same.



---

archive/issue_comments_382166.json:
```json
{
    "body": "<a id='comment:6'></a>rebased on 7.6.b5\n\n---\nNew commits:",
    "created_at": "2017-03-02T14:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382166",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>rebased on 7.6.b5

---
New commits:



---

archive/issue_comments_382167.json:
```json
{
    "body": "Changing branch from \"u/vbraun/update_flask__babel_\" to \"public/20922\"",
    "created_at": "2017-03-02T14:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382167",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "u/vbraun/update_flask__babel_" to "public/20922"



---

archive/issue_comments_382168.json:
```json
{
    "body": "Changing commit from \"ea5d90fddb95bc90e21796fdfe708cee4adc80e8\" to \"98d7b94fd064200fedf3edb3611f219f8e556530\"",
    "created_at": "2017-03-02T14:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382168",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "ea5d90fddb95bc90e21796fdfe708cee4adc80e8" to "98d7b94fd064200fedf3edb3611f219f8e556530"



---

archive/issue_comments_382169.json:
```json
{
    "body": "<a id='comment:7'></a>Change from Module to Blueprint looks like that:\n\n```\n    class Module()\n    def __init__(self, import_name, name=None, url_prefix=None,\n                 static_path=None, subdomain=None):\n        Blueprint.__init__(self, name, import_name, url_prefix=url_prefix,\n                           subdomain=subdomain, template_folder='templates')\n```",
    "created_at": "2017-03-02T14:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382169",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>Change from Module to Blueprint looks like that:

```
    class Module()
    def __init__(self, import_name, name=None, url_prefix=None,
                 static_path=None, subdomain=None):
        Blueprint.__init__(self, name, import_name, url_prefix=url_prefix,
                           subdomain=subdomain, template_folder='templates')
```



---

archive/issue_comments_382170.json:
```json
{
    "body": "<a id='comment:8'></a>should we try to update ?",
    "created_at": "2018-01-23T16:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382170",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>should we try to update ?



---

archive/issue_comments_382171.json:
```json
{
    "body": "<a id='comment:9'></a>Sure, if the notebook will still work.  Is the code you have in comment:7 pretty standard as a workaround?",
    "created_at": "2018-01-23T17:07:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382171",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>Sure, if the notebook will still work.  Is the code you have in comment:7 pretty standard as a workaround?



---

archive/issue_comments_382172.json:
```json
{
    "body": "<a id='comment:10'></a>A priori, the changes suggested in comment:7 are included in the notebook since a long time, and should already be in the notebook version inside sage.\n\nSo indeed, the matter is just now to see if updating flask breaks sagenb or not..",
    "created_at": "2018-01-23T19:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382172",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>A priori, the changes suggested in comment:7 are included in the notebook since a long time, and should already be in the notebook version inside sage.

So indeed, the matter is just now to see if updating flask breaks sagenb or not..



---

archive/issue_comments_382173.json:
```json
{
    "body": "<a id='comment:11'></a>Dear me. I opened https://github.com/sagemath/sagenb/issues/437 because gentoo made a newer flask-babel stable. But then I have stuck sagenb with a dependency to an older version of flask.\nAfter updating flask and getting click I still get the stuff I posted in the github issue however. Plus I now have a deprecation warning that in `sagenb/notebook/conf.py` at line 13 `flask.ext.babel` should be changed to `flask_babel`.",
    "created_at": "2018-01-23T22:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382173",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>Dear me. I opened https://github.com/sagemath/sagenb/issues/437 because gentoo made a newer flask-babel stable. But then I have stuck sagenb with a dependency to an older version of flask.
After updating flask and getting click I still get the stuff I posted in the github issue however. Plus I now have a deprecation warning that in `sagenb/notebook/conf.py` at line 13 `flask.ext.babel` should be changed to `flask_babel`.



---

archive/issue_comments_382174.json:
```json
{
    "body": "<a id='comment:12'></a>Also #20627",
    "created_at": "2018-01-23T22:07:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382174",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:12'></a>Also #20627



---

archive/issue_comments_382175.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-24T08:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382176.json:
```json
{
    "body": "Changing commit from \"98d7b94fd064200fedf3edb3611f219f8e556530\" to \"d18c2f2d20189526f8752adc67b5a749779ab8f5\"",
    "created_at": "2018-01-24T08:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "98d7b94fd064200fedf3edb3611f219f8e556530" to "d18c2f2d20189526f8752adc67b5a749779ab8f5"



---

archive/issue_comments_382177.json:
```json
{
    "body": "<a id='comment:14'></a>Until https://github.com/sagemath/sagenb/issues/437 is resolved, this cannot go ahead.",
    "created_at": "2018-01-24T09:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382177",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>Until https://github.com/sagemath/sagenb/issues/437 is resolved, this cannot go ahead.



---

archive/issue_comments_382178.json:
```json
{
    "body": "<a id='comment:15'></a>Notebook has now a pull request to change some imports:\n\nhttps://github.com/sagemath/sagenb/pull/438",
    "created_at": "2018-01-24T09:11:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382178",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>Notebook has now a pull request to change some imports:

https://github.com/sagemath/sagenb/pull/438



---

archive/issue_comments_382179.json:
```json
{
    "body": "<a id='comment:17'></a>see https://github.com/sagemath/sagenb/pull/450",
    "created_at": "2018-07-12T12:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382179",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>see https://github.com/sagemath/sagenb/pull/450



---

archive/issue_comments_382180.json:
```json
{
    "body": "<a id='comment:18'></a>For this ticket, one has to first update to a new release of sagenb. Some pull requests in sagenb should probably be merged before this new release.",
    "created_at": "2018-07-12T12:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382180",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>For this ticket, one has to first update to a new release of sagenb. Some pull requests in sagenb should probably be merged before this new release.



---

archive/issue_events_056036.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-07-12T12:57:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20922#event-56036"
}
```



---

archive/issue_comments_382181.json:
```json
{
    "body": "Changing commit from \"d18c2f2d20189526f8752adc67b5a749779ab8f5\" to \"\"",
    "created_at": "2021-03-05T07:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382181",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "d18c2f2d20189526f8752adc67b5a749779ab8f5" to ""



---

archive/issue_comments_382182.json:
```json
{
    "body": "Changing branch from \"public/20922\" to \"\"",
    "created_at": "2021-03-05T07:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382182",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "public/20922" to ""



---

archive/issue_comments_382183.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-05T07:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382183",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_events_056037.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-05T07:33:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20922#event-56037"
}
```



---

archive/issue_events_056038.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-05T07:33:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20922#event-56038"
}
```



---

archive/issue_comments_382184.json:
```json
{
    "body": "<a id='comment:19'></a>obsolete, probably. Sagenb is gone, and flask is no longer a package.\n\nsee #29754",
    "created_at": "2021-03-05T07:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382184",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>obsolete, probably. Sagenb is gone, and flask is no longer a package.

see #29754



---

archive/issue_comments_382185.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-03-05T16:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382185",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_382186.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-03-05T16:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382186",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_056039.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-05T17:24:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20922#event-56039"
}
```



---

archive/issue_comments_382187.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-03-05T17:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20922#issuecomment-382187",
    "user": "https://github.com/fchapoton"
}
```

Resolution: invalid
