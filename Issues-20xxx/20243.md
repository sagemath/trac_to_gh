# Issue 20243: Count real roots of polynomials using Sturm sequences

archive/issues_020006.json:
```json
{
    "body": "We should expose PARI's functionality for counting roots of polynomials in a closed interval:\n\n```\nsage: P.<x> = PolynomialRing(ZZ)\nsage: pari((x-1)*(x-2)*(x-3)).polsturm(1,2)\n2\n```\nNote that the boundary behavior has changed from PARI 2.7 (which did not include the left endpoint of the interval as a root) to 2.8 (which does do so).\n\nAssignee: @kedlaya\n\nKeywords: polynomials, root-counting, days71\n\nBranch/Commit: [e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92](https://github.com/sagemath/sagetrac-mirror/commit/e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92)\n\nReviewer: Kevin Dilks, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Kiran Kedlaya\n\nDependencies: #20256\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20243\n\n",
    "closed_at": "2016-05-28T12:13:32Z",
    "created_at": "2016-03-21T15:40:23Z",
    "labels": [
        "component: algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Count real roots of polynomials using Sturm sequences",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20243",
    "user": "https://github.com/kedlaya"
}
```
We should expose PARI's functionality for counting roots of polynomials in a closed interval:

```
sage: P.<x> = PolynomialRing(ZZ)
sage: pari((x-1)*(x-2)*(x-3)).polsturm(1,2)
2
```
Note that the boundary behavior has changed from PARI 2.7 (which did not include the left endpoint of the interval as a root) to 2.8 (which does do so).

Assignee: @kedlaya

Keywords: polynomials, root-counting, days71

Branch/Commit: [e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92](https://github.com/sagemath/sagetrac-mirror/commit/e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92)

Reviewer: Kevin Dilks, Frédéric Chapoton

Author: Kiran Kedlaya

Dependencies: #20256

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20243





---

archive/issue_comments_369926.json:
```json
{
    "body": "Changing branch from \"\" to \"u/kedlaya/count_real_roots_of_polynomials_using_sturm_sequences\"",
    "created_at": "2016-03-22T04:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369926",
    "user": "https://github.com/kedlaya"
}
```

Changing branch from "" to "u/kedlaya/count_real_roots_of_polynomials_using_sturm_sequences"



---

archive/issue_comments_369927.json:
```json
{
    "body": "Set assignee to @kedlaya.",
    "created_at": "2016-03-22T04:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369927",
    "user": "https://github.com/kedlaya"
}
```

Set assignee to @kedlaya.



---

archive/issue_comments_369928.json:
```json
{
    "body": "Changing author from \"\" to \"Kiran Kedlaya\"",
    "created_at": "2016-03-22T04:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369928",
    "user": "https://github.com/kedlaya"
}
```

Changing author from "" to "Kiran Kedlaya"



---

archive/issue_comments_369929.json:
```json
{
    "body": "Changing commit from \"\" to \"9540f77d0957c1108c03b6090817400aca0f203f\"",
    "created_at": "2016-03-22T04:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369929",
    "user": "https://github.com/kedlaya"
}
```

Changing commit from "" to "9540f77d0957c1108c03b6090817400aca0f203f"



---

archive/issue_comments_369930.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-22T04:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369930",
    "user": "https://github.com/kedlaya"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_369931.json:
```json
{
    "body": "Changing keywords from \"polynomials, root-counting\" to \"polynomials, root-counting, days71\".",
    "created_at": "2016-03-22T17:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369931",
    "user": "https://github.com/kedlaya"
}
```

Changing keywords from "polynomials, root-counting" to "polynomials, root-counting, days71".



---

archive/issue_comments_369932.json:
```json
{
    "body": "<a id='comment:5'></a>\nRunning Patchbot overnight, will play with the code tomorrow. \n\nJust looking at the source, you're probably going to want to include a check in the code to make sure your polynomial has an appropriate base field, and a test making sure this check behaves properly. Easiest way would to be to check that self.base_field() is RR/QQ/ZZ. There's a potential issue if somebody's polynomial has real coefficients, but is constructed in a complex ring. That is something I may personally do, as testing the Cyclic Sieving Phenomenon involves evaluating polynomials with nonnegative integer coefficients at complex roots of unity. But I suppose the user can just change the base ring appropriately if they want to test for real roots in that case.\n\nAlso, there should be the option of having a be -\\infty and b being +\\infty (the Maxima code for counting number of real roots in an interval allows these options, not sure about pari). My main interest in this code would checking to see if all of a polynomial's roots are real, so I would personally want a simple alias 'is_real_rooted()' that returns 'all_roots_in_interval(-Inf,Inf)'.",
    "created_at": "2016-03-23T06:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369932",
    "user": "https://github.com/kevindilks"
}
```

<a id='comment:5'></a>
Running Patchbot overnight, will play with the code tomorrow. 

Just looking at the source, you're probably going to want to include a check in the code to make sure your polynomial has an appropriate base field, and a test making sure this check behaves properly. Easiest way would to be to check that self.base_field() is RR/QQ/ZZ. There's a potential issue if somebody's polynomial has real coefficients, but is constructed in a complex ring. That is something I may personally do, as testing the Cyclic Sieving Phenomenon involves evaluating polynomials with nonnegative integer coefficients at complex roots of unity. But I suppose the user can just change the base ring appropriately if they want to test for real roots in that case.

Also, there should be the option of having a be -\infty and b being +\infty (the Maxima code for counting number of real roots in an interval allows these options, not sure about pari). My main interest in this code would checking to see if all of a polynomial's roots are real, so I would personally want a simple alias 'is_real_rooted()' that returns 'all_roots_in_interval(-Inf,Inf)'.



---

archive/issue_comments_369933.json:
```json
{
    "body": "<a id='comment:6'></a>\n> Just looking at the source, you're probably going to want to include a check in the code to make sure your polynomial has an appropriate base field\n\n\nAgreed. However, it might be easier to do this check *after* converting to PARI.",
    "created_at": "2016-03-23T10:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369933",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
> Just looking at the source, you're probably going to want to include a check in the code to make sure your polynomial has an appropriate base field


Agreed. However, it might be easier to do this check *after* converting to PARI.



---

archive/issue_comments_369934.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#20256\"",
    "created_at": "2016-03-23T10:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369934",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#20256"



---

archive/issue_comments_369935.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-23T10:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369935",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369936.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[3f52ae0](https://github.com/sagemath/sagetrac-mirror/commit/3f52ae0a26e0c8427013c29c2f2262a3d5eaea84)|`Allow default arguments to polsturm`|",
    "created_at": "2016-03-23T10:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[3f52ae0](https://github.com/sagemath/sagetrac-mirror/commit/3f52ae0a26e0c8427013c29c2f2262a3d5eaea84)|`Allow default arguments to polsturm`|



---

archive/issue_comments_369937.json:
```json
{
    "body": "Changing commit from \"9540f77d0957c1108c03b6090817400aca0f203f\" to \"3f52ae0a26e0c8427013c29c2f2262a3d5eaea84\"",
    "created_at": "2016-03-23T10:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9540f77d0957c1108c03b6090817400aca0f203f" to "3f52ae0a26e0c8427013c29c2f2262a3d5eaea84"



---

archive/issue_comments_369938.json:
```json
{
    "body": "<a id='comment:8'></a>\nPARI's polsturm allows infinite arguments by omission: a first argument of None translates to -Infinity, a second argument of None translates to +Infinity. I just pushed a commit allowing these.\n\nI agree with adding an alias for all real roots, but I'm not sure what to call it. My first thought would be is_self-adjoint().\n\nI'm not sure what is the best way to check for a valid base ring. One option would be to force the coefficients into RR, but I really want this to be an exact computation on exact input. I suppose I could check for coefficients in QQ or ZZ, and in those cases pass exact coefficients, and in all other cases force the coefficients into RR. But then one should be careful not to clobber the precision of the input in case it is higher than usual.",
    "created_at": "2016-03-23T10:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369938",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:8'></a>
PARI's polsturm allows infinite arguments by omission: a first argument of None translates to -Infinity, a second argument of None translates to +Infinity. I just pushed a commit allowing these.

I agree with adding an alias for all real roots, but I'm not sure what to call it. My first thought would be is_self-adjoint().

I'm not sure what is the best way to check for a valid base ring. One option would be to force the coefficients into RR, but I really want this to be an exact computation on exact input. I suppose I could check for coefficients in QQ or ZZ, and in those cases pass exact coefficients, and in all other cases force the coefficients into RR. But then one should be careful not to clobber the precision of the input in case it is higher than usual.



---

archive/issue_comments_369939.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [kedlaya](#comment%3A8):\n> PARI's polsturm allows infinite arguments by omission: a first argument of None translates to -Infinity, a second argument of None translates to +Infinity. I just pushed a commit allowing these.\n\n\nThat's undocumented in PARI, so I think it's a bad idea to rely on that.",
    "created_at": "2016-03-23T11:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369939",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Replying to [kedlaya](#comment%3A8):
> PARI's polsturm allows infinite arguments by omission: a first argument of None translates to -Infinity, a second argument of None translates to +Infinity. I just pushed a commit allowing these.


That's undocumented in PARI, so I think it's a bad idea to rely on that.



---

archive/issue_comments_369940.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [jdemeyer](#comment%3A9):\n> Replying to [kedlaya](#comment%3A8):\n> > PARI's polsturm allows infinite arguments by omission: a first argument of None translates to -Infinity, a second argument of None translates to +Infinity. I just pushed a commit allowing these.\n\n> \n> That's undocumented in PARI, so I think it's a bad idea to rely on that.\n\n\nIt's in the 2.7 documentation:\n\n```\npolsturm(pol, {a}, {b}): Number of real roots of the real squarefree polynomial pol in the interval ]a,b], using Sturm's algorithm. a (resp. b) is taken to be -infinity (resp. +infinity) if omitted.\n```\nOr have you seen the 2.8 user guide yet (which I haven't found)? There does need to be a change of text to change the interval from ]a,b] (open on the left, closed on the right) to [a,b] (closed both sides).",
    "created_at": "2016-03-23T11:40:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369940",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:10'></a>
Replying to [jdemeyer](#comment%3A9):
> Replying to [kedlaya](#comment%3A8):
> > PARI's polsturm allows infinite arguments by omission: a first argument of None translates to -Infinity, a second argument of None translates to +Infinity. I just pushed a commit allowing these.

> 
> That's undocumented in PARI, so I think it's a bad idea to rely on that.


It's in the 2.7 documentation:

```
polsturm(pol, {a}, {b}): Number of real roots of the real squarefree polynomial pol in the interval ]a,b], using Sturm's algorithm. a (resp. b) is taken to be -infinity (resp. +infinity) if omitted.
```
Or have you seen the 2.8 user guide yet (which I haven't found)? There does need to be a change of text to change the interval from ]a,b] (open on the left, closed on the right) to [a,b] (closed both sides).



---

archive/issue_comments_369941.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [kedlaya](#comment%3A10):\n> Or have you seen the 2.8 user guide yet (which I haven't found)?\n\n\nPARI-2.7 is ancient. In PARI-2.8, the syntax has changed, you are supposed to use `polsturm(pol, [a,b])` instead.\n\nThe PARI-2.8 user guide might not be online, but you can access the documentation from Sage: run `./sage --gp` and then type `??polsturm`.\n\nI created #20257 to deprecate `pari(...).polsturm(a, b)` in Sage.",
    "created_at": "2016-03-23T12:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369941",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Replying to [kedlaya](#comment%3A10):
> Or have you seen the 2.8 user guide yet (which I haven't found)?


PARI-2.7 is ancient. In PARI-2.8, the syntax has changed, you are supposed to use `polsturm(pol, [a,b])` instead.

The PARI-2.8 user guide might not be online, but you can access the documentation from Sage: run `./sage --gp` and then type `??polsturm`.

I created #20257 to deprecate `pari(...).polsturm(a, b)` in Sage.



---

archive/issue_comments_369942.json:
```json
{
    "body": "Changing commit from \"3f52ae0a26e0c8427013c29c2f2262a3d5eaea84\" to \"a4450e755ba488d39261e808e8db295171c5edb0\"",
    "created_at": "2016-03-23T13:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3f52ae0a26e0c8427013c29c2f2262a3d5eaea84" to "a4450e755ba488d39261e808e8db295171c5edb0"



---

archive/issue_comments_369943.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[a4450e7](https://github.com/sagemath/sagetrac-mirror/commit/a4450e755ba488d39261e808e8db295171c5edb0)|`Updated polsturm call syntax`|",
    "created_at": "2016-03-23T13:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369943",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                              |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[a4450e7](https://github.com/sagemath/sagetrac-mirror/commit/a4450e755ba488d39261e808e8db295171c5edb0)|`Updated polsturm call syntax`|



---

archive/issue_comments_369944.json:
```json
{
    "body": "Changing commit from \"a4450e755ba488d39261e808e8db295171c5edb0\" to \"8998591fa591991cfe6e03f65b13291edda0f11e\"",
    "created_at": "2016-03-23T14:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369944",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a4450e755ba488d39261e808e8db295171c5edb0" to "8998591fa591991cfe6e03f65b13291edda0f11e"



---

archive/issue_comments_369945.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[8998591](https://github.com/sagemath/sagetrac-mirror/commit/8998591fa591991cfe6e03f65b13291edda0f11e)|`Allow arguments to be one interval or two numbers`|",
    "created_at": "2016-03-23T14:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[8998591](https://github.com/sagemath/sagetrac-mirror/commit/8998591fa591991cfe6e03f65b13291edda0f11e)|`Allow arguments to be one interval or two numbers`|



---

archive/issue_comments_369946.json:
```json
{
    "body": "<a id='comment:14'></a>\nOK, I changed the call syntax to polsturm. I also changed the call syntax for count_roots_in_interval and all_roots_in_interval: they now take a variable number of arguments, which should be either two numbers or one interval. Moreover, I allow passing either None or -Infinity as a left endpoint, and None or +Infinity as a right endpoint (converting them to the Pari infinities).\n\nI still haven't implemented an alias for all real roots (since I'm not settled on the name) or checking the argument type.",
    "created_at": "2016-03-23T14:32:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369946",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:14'></a>
OK, I changed the call syntax to polsturm. I also changed the call syntax for count_roots_in_interval and all_roots_in_interval: they now take a variable number of arguments, which should be either two numbers or one interval. Moreover, I allow passing either None or -Infinity as a left endpoint, and None or +Infinity as a right endpoint (converting them to the Pari infinities).

I still haven't implemented an alias for all real roots (since I'm not settled on the name) or checking the argument type.



---

archive/issue_comments_369947.json:
```json
{
    "body": "<a id='comment:15'></a>\nConversion to infinity should not happen here, but more generally in the Sage <-> PARI interface. Feel free to add a commit to #20256 to do that.",
    "created_at": "2016-03-23T14:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369947",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Conversion to infinity should not happen here, but more generally in the Sage <-> PARI interface. Feel free to add a commit to #20256 to do that.



---

archive/issue_comments_369948.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[4080765](https://github.com/sagemath/sagetrac-mirror/commit/40807652789f552f8962be80f1561af56639bf67)|`Remove conversion of infinities, add has_all_real_roots`|",
    "created_at": "2016-03-24T10:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369948",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[4080765](https://github.com/sagemath/sagetrac-mirror/commit/40807652789f552f8962be80f1561af56639bf67)|`Remove conversion of infinities, add has_all_real_roots`|



---

archive/issue_comments_369949.json:
```json
{
    "body": "Changing commit from \"8998591fa591991cfe6e03f65b13291edda0f11e\" to \"40807652789f552f8962be80f1561af56639bf67\"",
    "created_at": "2016-03-24T10:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369949",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8998591fa591991cfe6e03f65b13291edda0f11e" to "40807652789f552f8962be80f1561af56639bf67"



---

archive/issue_comments_369950.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[29ab5c4](https://github.com/sagemath/sagetrac-mirror/commit/29ab5c470b79a273d7c5cd06e6b849f9d0b98a85)|`Remove extraneous infinity conversion`|",
    "created_at": "2016-03-24T10:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369950",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[29ab5c4](https://github.com/sagemath/sagetrac-mirror/commit/29ab5c470b79a273d7c5cd06e6b849f9d0b98a85)|`Remove extraneous infinity conversion`|



---

archive/issue_comments_369951.json:
```json
{
    "body": "Changing commit from \"40807652789f552f8962be80f1561af56639bf67\" to \"29ab5c470b79a273d7c5cd06e6b849f9d0b98a85\"",
    "created_at": "2016-03-24T10:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369951",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "40807652789f552f8962be80f1561af56639bf67" to "29ab5c470b79a273d7c5cd06e6b849f9d0b98a85"



---

archive/issue_comments_369952.json:
```json
{
    "body": "<a id='comment:18'></a>\nThis commit should play nicely with #20256, but I'm still a novice with git-trac and haven't figured out how to test this yet.\n\nI added has_all_real_roots() to test for all roots in the real line. I'm open to changing that name if someone has a better idea.\n\nI still haven't implemented any sort of sanity checking on the input base ring.",
    "created_at": "2016-03-24T10:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369952",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:18'></a>
This commit should play nicely with #20256, but I'm still a novice with git-trac and haven't figured out how to test this yet.

I added has_all_real_roots() to test for all roots in the real line. I'm open to changing that name if someone has a better idea.

I still haven't implemented any sort of sanity checking on the input base ring.



---

archive/issue_comments_369953.json:
```json
{
    "body": "Changing commit from \"29ab5c470b79a273d7c5cd06e6b849f9d0b98a85\" to \"264f2b33a895463e71ad84739a5dc74952eb95bb\"",
    "created_at": "2016-03-24T14:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369953",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "29ab5c470b79a273d7c5cd06e6b849f9d0b98a85" to "264f2b33a895463e71ad84739a5dc74952eb95bb"



---

archive/issue_comments_369954.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[a73d039](https://github.com/sagemath/sagetrac-mirror/commit/a73d039f02f221124360733888363f6781267733)|`Fix conversion of infinity from Sage to PARI`|\n|[27357f9](https://github.com/sagemath/sagetrac-mirror/commit/27357f9c728618232f21ccc48807513319d8461b)|`Added infinity to type, gentoobj`|\n|[3832116](https://github.com/sagemath/sagetrac-mirror/commit/3832116557c63a1495e395d5eb3c9036ba701c1e)|`Add doctests to gen.pyx, make suggested edits to infinity.py`|\n|[264f2b3](https://github.com/sagemath/sagetrac-mirror/commit/264f2b33a895463e71ad84739a5dc74952eb95bb)|`Merge branch 'u/kedlaya/implement_conversion_infinity_____pari' of git://trac.sagemath.org/sage into t/20243/count_real_roots_of_polynomials_using_sturm_sequences`|",
    "created_at": "2016-03-24T14:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369954",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[a73d039](https://github.com/sagemath/sagetrac-mirror/commit/a73d039f02f221124360733888363f6781267733)|`Fix conversion of infinity from Sage to PARI`|
|[27357f9](https://github.com/sagemath/sagetrac-mirror/commit/27357f9c728618232f21ccc48807513319d8461b)|`Added infinity to type, gentoobj`|
|[3832116](https://github.com/sagemath/sagetrac-mirror/commit/3832116557c63a1495e395d5eb3c9036ba701c1e)|`Add doctests to gen.pyx, make suggested edits to infinity.py`|
|[264f2b3](https://github.com/sagemath/sagetrac-mirror/commit/264f2b33a895463e71ad84739a5dc74952eb95bb)|`Merge branch 'u/kedlaya/implement_conversion_infinity_____pari' of git://trac.sagemath.org/sage into t/20243/count_real_roots_of_polynomials_using_sturm_sequences`|



---

archive/issue_comments_369955.json:
```json
{
    "body": "<a id='comment:20'></a>\nMerged #20256 to do the Infinity conversion.\n\nI don't know what to do about type-checking. If you have a polynomial over C but whose coefficients actually belong to R, then PARI seems to handle this correctly (I added a doctest to this effect). However, we have trouble with inexact polynomials which are (apparently) not squarefree:\n\n```\nsage: P.<x> = PolynomialRing(RR)\nsage: pol = (x-1)^2*(x-2)^2*(x-3)\nsage: pol.is_squarefree() # Should be False\nTrue\nsage: pari(pol).issquarefree # Should be 0\n1\nsage: pol.count_roots_in_interval()\n...\nPariError: domain error in polsturm: issquarefree(pol) = 0\n```\nI created ticket #20282 for this issue, in case we decide not to deal with it here (which would be my preference).",
    "created_at": "2016-03-24T15:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369955",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:20'></a>
Merged #20256 to do the Infinity conversion.

I don't know what to do about type-checking. If you have a polynomial over C but whose coefficients actually belong to R, then PARI seems to handle this correctly (I added a doctest to this effect). However, we have trouble with inexact polynomials which are (apparently) not squarefree:

```
sage: P.<x> = PolynomialRing(RR)
sage: pol = (x-1)^2*(x-2)^2*(x-3)
sage: pol.is_squarefree() # Should be False
True
sage: pari(pol).issquarefree # Should be 0
1
sage: pol.count_roots_in_interval()
...
PariError: domain error in polsturm: issquarefree(pol) = 0
```
I created ticket #20282 for this issue, in case we decide not to deal with it here (which would be my preference).



---

archive/issue_comments_369956.json:
```json
{
    "body": "<a id='comment:21'></a>\nYou don't actually need this: `a1 = pari(a)` and `b1 = pari(b)`: PARI methods will automatically convert anyway.",
    "created_at": "2016-03-24T16:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369956",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
You don't actually need this: `a1 = pari(a)` and `b1 = pari(b)`: PARI methods will automatically convert anyway.



---

archive/issue_comments_369957.json:
```json
{
    "body": "Changing commit from \"264f2b33a895463e71ad84739a5dc74952eb95bb\" to \"dee973be07c543e5998f30dc247c968a8244267a\"",
    "created_at": "2016-03-24T16:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369957",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "264f2b33a895463e71ad84739a5dc74952eb95bb" to "dee973be07c543e5998f30dc247c968a8244267a"



---

archive/issue_comments_369958.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|\n|[dee973b](https://github.com/sagemath/sagetrac-mirror/commit/dee973be07c543e5998f30dc247c968a8244267a)|`Added inexact ring doctest`|",
    "created_at": "2016-03-24T16:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369958",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                            |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
|[dee973b](https://github.com/sagemath/sagetrac-mirror/commit/dee973be07c543e5998f30dc247c968a8244267a)|`Added inexact ring doctest`|



---

archive/issue_comments_369959.json:
```json
{
    "body": "Changing commit from \"dee973be07c543e5998f30dc247c968a8244267a\" to \"ac67b2ec431327f8f58e9a408a50f6d98c1ef528\"",
    "created_at": "2016-03-24T16:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369959",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dee973be07c543e5998f30dc247c968a8244267a" to "ac67b2ec431327f8f58e9a408a50f6d98c1ef528"



---

archive/issue_comments_369960.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[ac67b2e](https://github.com/sagemath/sagetrac-mirror/commit/ac67b2ec431327f8f58e9a408a50f6d98c1ef528)|`Remove extraneous PARI conversion of arguments`|",
    "created_at": "2016-03-24T16:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369960",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[ac67b2e](https://github.com/sagemath/sagetrac-mirror/commit/ac67b2ec431327f8f58e9a408a50f6d98c1ef528)|`Remove extraneous PARI conversion of arguments`|



---

archive/issue_comments_369961.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jdemeyer](#comment%3A21):\n> You don't actually need this: `a1 = pari(a)` and `b1 = pari(b)`: PARI methods will automatically convert anyway.\n\n\nChanged to `a1 = a` and `b1 = b`.",
    "created_at": "2016-03-24T16:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369961",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:24'></a>
Replying to [jdemeyer](#comment%3A21):
> You don't actually need this: `a1 = pari(a)` and `b1 = pari(b)`: PARI methods will automatically convert anyway.


Changed to `a1 = a` and `b1 = b`.



---

archive/issue_comments_369962.json:
```json
{
    "body": "<a id='comment:25'></a>\nYou don't need `a1` or `b1` either, just use `a` and `b`. And `foo == None` should be replaced by `foo is None`.",
    "created_at": "2016-03-24T16:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369962",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
You don't need `a1` or `b1` either, just use `a` and `b`. And `foo == None` should be replaced by `foo is None`.



---

archive/issue_comments_369963.json:
```json
{
    "body": "Changing commit from \"ac67b2ec431327f8f58e9a408a50f6d98c1ef528\" to \"f932dd3fef7fcf36a8ddd2a9f07cb3f4ae69bc33\"",
    "created_at": "2016-03-24T17:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369963",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ac67b2ec431327f8f58e9a408a50f6d98c1ef528" to "f932dd3fef7fcf36a8ddd2a9f07cb3f4ae69bc33"



---

archive/issue_comments_369964.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[f932dd3](https://github.com/sagemath/sagetrac-mirror/commit/f932dd3fef7fcf36a8ddd2a9f07cb3f4ae69bc33)|`Fix None comparison, remove extraneous variables`|",
    "created_at": "2016-03-24T17:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[f932dd3](https://github.com/sagemath/sagetrac-mirror/commit/f932dd3fef7fcf36a8ddd2a9f07cb3f4ae69bc33)|`Fix None comparison, remove extraneous variables`|



---

archive/issue_comments_369965.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jdemeyer](#comment%3A25):\n> You don't need `a1` or `b1` either, just use `a` and `b`. And `foo == None` should be replaced by `foo is None`.\n\n\nChanges made.",
    "created_at": "2016-03-24T17:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369965",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:27'></a>
Replying to [jdemeyer](#comment%3A25):
> You don't need `a1` or `b1` either, just use `a` and `b`. And `foo == None` should be replaced by `foo is None`.


Changes made.



---

archive/issue_comments_369966.json:
```json
{
    "body": "<a id='comment:28'></a>\nThe only thing that remains is to check that the coefficients are real. I see two approaches: either checking that the base_ring coerces to `RealField(2)` or checking the PARI types after conversion to PARI.",
    "created_at": "2016-03-24T18:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369966",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
The only thing that remains is to check that the coefficients are real. I see two approaches: either checking that the base_ring coerces to `RealField(2)` or checking the PARI types after conversion to PARI.



---

archive/issue_comments_369967.json:
```json
{
    "body": "<a id='comment:29'></a>\nI'm not sure checking the base ring is the right approach; one use case that was already suggested above is a polynomial over CC which happens to have real coefficients. One option is to attempt the coercion by calling `self.change_ring(RR)` and discarding the result (allowing a `TypeError` through if it comes up). Working on the PARI side eliminates this particular case:\n\n```\nsage: u = CC(1)\nsage: u.parent()\nComplex Field with 53 bits of precision\nsage: pari(u)\n1.00000000000000\nsage: pari(u).type()\n't_REAL'\n```\nThoughts?",
    "created_at": "2016-03-24T19:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369967",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:29'></a>
I'm not sure checking the base ring is the right approach; one use case that was already suggested above is a polynomial over CC which happens to have real coefficients. One option is to attempt the coercion by calling `self.change_ring(RR)` and discarding the result (allowing a `TypeError` through if it comes up). Working on the PARI side eliminates this particular case:

```
sage: u = CC(1)
sage: u.parent()
Complex Field with 53 bits of precision
sage: pari(u)
1.00000000000000
sage: pari(u).type()
't_REAL'
```
Thoughts?



---

archive/issue_comments_369968.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [kedlaya](#comment%3A29):\n> I'm not sure checking the base ring is the right approach; one use case that was already suggested above is a polynomial over CC which happens to have real coefficients.\n\n\nThe Sage philosophy is usually that the base ring matters. So, if the polynomial defined over CC happens to have real coefficients, that's an accident. It doens't mean that functions expecting real input should work.",
    "created_at": "2016-03-24T21:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369968",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Replying to [kedlaya](#comment%3A29):
> I'm not sure checking the base ring is the right approach; one use case that was already suggested above is a polynomial over CC which happens to have real coefficients.


The Sage philosophy is usually that the base ring matters. So, if the polynomial defined over CC happens to have real coefficients, that's an accident. It doens't mean that functions expecting real input should work.



---

archive/issue_comments_369969.json:
```json
{
    "body": "Changing commit from \"f932dd3fef7fcf36a8ddd2a9f07cb3f4ae69bc33\" to \"e0136a792224bd38b0219d9637686d748551a197\"",
    "created_at": "2016-03-25T12:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f932dd3fef7fcf36a8ddd2a9f07cb3f4ae69bc33" to "e0136a792224bd38b0219d9637686d748551a197"



---

archive/issue_comments_369970.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[3ae0de9](https://github.com/sagemath/sagetrac-mirror/commit/3ae0de960aacea9101185b3566bc980cb147aca1)|`Added type check, handling for complex polynomials`|\n|[e0136a7](https://github.com/sagemath/sagetrac-mirror/commit/e0136a792224bd38b0219d9637686d748551a197)|`Add documentation for real, complex conversion.`|",
    "created_at": "2016-03-25T12:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369970",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[3ae0de9](https://github.com/sagemath/sagetrac-mirror/commit/3ae0de960aacea9101185b3566bc980cb147aca1)|`Added type check, handling for complex polynomials`|
|[e0136a7](https://github.com/sagemath/sagetrac-mirror/commit/e0136a792224bd38b0219d9637686d748551a197)|`Add documentation for real, complex conversion.`|



---

archive/issue_comments_369971.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [jdemeyer](#comment%3A30):\n> Replying to [kedlaya](#comment%3A29):\n> > I'm not sure checking the base ring is the right approach; one use case that was already suggested above is a polynomial over CC which happens to have real coefficients.\n\n> \n> The Sage philosophy is usually that the base ring matters. So, if the polynomial defined over CC happens to have real coefficients, that's an accident. It doens't mean that functions expecting real input should work.\n\n\nHere is a better solution: make the function work on complex inputs! Now I first attempt a conversion to RR, and if no exception is raised I pass the (unconverted) input directly to PARI; that way, exact inputs stay exact. If that fails, I convert to CC (allowing an exception through if it occurs), and take the GCD of the polynomial with its conjugate (and strip off the leading coefficient) to get a polynomial with real coefficients and all the same real roots as before.",
    "created_at": "2016-03-25T12:09:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369971",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:32'></a>
Replying to [jdemeyer](#comment%3A30):
> Replying to [kedlaya](#comment%3A29):
> > I'm not sure checking the base ring is the right approach; one use case that was already suggested above is a polynomial over CC which happens to have real coefficients.

> 
> The Sage philosophy is usually that the base ring matters. So, if the polynomial defined over CC happens to have real coefficients, that's an accident. It doens't mean that functions expecting real input should work.


Here is a better solution: make the function work on complex inputs! Now I first attempt a conversion to RR, and if no exception is raised I pass the (unconverted) input directly to PARI; that way, exact inputs stay exact. If that fails, I convert to CC (allowing an exception through if it occurs), and take the GCD of the polynomial with its conjugate (and strip off the leading coefficient) to get a polynomial with real coefficients and all the same real roots as before.



---

archive/issue_comments_369972.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [kedlaya](#comment%3A32):\n> Here is a better solution: make the function work on complex inputs! Now I first attempt a conversion to RR, and if no exception is raised I pass the (unconverted) input directly to PARI; that way, exact inputs stay exact. If that fails, I convert to CC (allowing an exception through if it occurs), and take the GCD of the polynomial with its conjugate (and strip off the leading coefficient) to get a polynomial with real coefficients and all the same real roots as before.\n\n\nCan you document the stuff you wrote here in the code?\n\nI don't see why you need to convert to `CC`. Just conjugate without conversion. That way, you support much more base fields, in particular `QQbar`.",
    "created_at": "2016-03-25T12:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369972",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
Replying to [kedlaya](#comment%3A32):
> Here is a better solution: make the function work on complex inputs! Now I first attempt a conversion to RR, and if no exception is raised I pass the (unconverted) input directly to PARI; that way, exact inputs stay exact. If that fails, I convert to CC (allowing an exception through if it occurs), and take the GCD of the polynomial with its conjugate (and strip off the leading coefficient) to get a polynomial with real coefficients and all the same real roots as before.


Can you document the stuff you wrote here in the code?

I don't see why you need to convert to `CC`. Just conjugate without conversion. That way, you support much more base fields, in particular `QQbar`.



---

archive/issue_comments_369973.json:
```json
{
    "body": "Changing commit from \"e0136a792224bd38b0219d9637686d748551a197\" to \"716f4650f5288e639823caa5ec07da14751d094c\"",
    "created_at": "2016-03-25T13:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369973",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e0136a792224bd38b0219d9637686d748551a197" to "716f4650f5288e639823caa5ec07da14751d094c"



---

archive/issue_comments_369974.json:
```json
{
    "body": "<a id='comment:34'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[716f465](https://github.com/sagemath/sagetrac-mirror/commit/716f4650f5288e639823caa5ec07da14751d094c)|`Remove superfluous change_ring()`|",
    "created_at": "2016-03-25T13:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369974",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[716f465](https://github.com/sagemath/sagetrac-mirror/commit/716f4650f5288e639823caa5ec07da14751d094c)|`Remove superfluous change_ring()`|



---

archive/issue_comments_369975.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [jdemeyer](#comment%3A33):\n> Replying to [kedlaya](#comment%3A32):\n> > Here is a better solution: make the function work on complex inputs! Now I first attempt a conversion to RR, and if no exception is raised I pass the (unconverted) input directly to PARI; that way, exact inputs stay exact. If that fails, I convert to CC (allowing an exception through if it occurs), and take the GCD of the polynomial with its conjugate (and strip off the leading coefficient) to get a polynomial with real coefficients and all the same real roots as before.\n\n> \n> Can you document the stuff you wrote here in the code?\n> \n> I don't see why you need to convert to `CC`. Just conjugate without conversion. That way, you support much more base fields, in particular `QQbar`.\n\n\nDone. I also took out the conversion to RR, since anyway Pari will return an error if it doesn't like the input.",
    "created_at": "2016-03-25T13:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369975",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:35'></a>
Replying to [jdemeyer](#comment%3A33):
> Replying to [kedlaya](#comment%3A32):
> > Here is a better solution: make the function work on complex inputs! Now I first attempt a conversion to RR, and if no exception is raised I pass the (unconverted) input directly to PARI; that way, exact inputs stay exact. If that fails, I convert to CC (allowing an exception through if it occurs), and take the GCD of the polynomial with its conjugate (and strip off the leading coefficient) to get a polynomial with real coefficients and all the same real roots as before.

> 
> Can you document the stuff you wrote here in the code?
> 
> I don't see why you need to convert to `CC`. Just conjugate without conversion. That way, you support much more base fields, in particular `QQbar`.


Done. I also took out the conversion to RR, since anyway Pari will return an error if it doesn't like the input.



---

archive/issue_comments_369976.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-05T02:46:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369976",
    "user": "https://github.com/kedlaya"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369977.json:
```json
{
    "body": "<a id='comment:37'></a>\nPatchbot doesn't like something about the way errors are raised. I think it would be a bit more straightforward to make the arguments be `(self,lower_bound=None,upper_bound=None)`, and just not allow for the option of specifying the bounds as a two-element list.\n\nIn terms of the names of functions, I think `count_roots_in_interval` would make more sense as `number_of_roots_in_interval` (that's the naming convention used for most combinatorial statistics). And `has_all_real_roots` should probably be named `is_real_rooted`. Things that return a boolean almost always start with `is_`, and calling polynomials with all real roots \"real rooted\" is prevalent, at least in the literature that I read.",
    "created_at": "2016-04-06T02:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369977",
    "user": "https://github.com/kevindilks"
}
```

<a id='comment:37'></a>
Patchbot doesn't like something about the way errors are raised. I think it would be a bit more straightforward to make the arguments be `(self,lower_bound=None,upper_bound=None)`, and just not allow for the option of specifying the bounds as a two-element list.

In terms of the names of functions, I think `count_roots_in_interval` would make more sense as `number_of_roots_in_interval` (that's the naming convention used for most combinatorial statistics). And `has_all_real_roots` should probably be named `is_real_rooted`. Things that return a boolean almost always start with `is_`, and calling polynomials with all real roots "real rooted" is prevalent, at least in the literature that I read.



---

archive/issue_comments_369978.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-06T02:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369978",
    "user": "https://github.com/kevindilks"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369979.json:
```json
{
    "body": "Changing commit from \"716f4650f5288e639823caa5ec07da14751d094c\" to \"b4f61f40d5c5e6b62a765c2abe4ee628fdfc8e4f\"",
    "created_at": "2016-04-06T02:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369979",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "716f4650f5288e639823caa5ec07da14751d094c" to "b4f61f40d5c5e6b62a765c2abe4ee628fdfc8e4f"



---

archive/issue_comments_369980.json:
```json
{
    "body": "<a id='comment:38'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[b4f61f4](https://github.com/sagemath/sagetrac-mirror/commit/b4f61f40d5c5e6b62a765c2abe4ee628fdfc8e4f)|`Change call syntax, function names`|",
    "created_at": "2016-04-06T02:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369980",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[b4f61f4](https://github.com/sagemath/sagetrac-mirror/commit/b4f61f40d5c5e6b62a765c2abe4ee628fdfc8e4f)|`Change call syntax, function names`|



---

archive/issue_comments_369981.json:
```json
{
    "body": "Changing commit from \"b4f61f40d5c5e6b62a765c2abe4ee628fdfc8e4f\" to \"81e9366b072db5dc772f3ea9b91b54e20116504b\"",
    "created_at": "2016-04-06T02:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369981",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b4f61f40d5c5e6b62a765c2abe4ee628fdfc8e4f" to "81e9366b072db5dc772f3ea9b91b54e20116504b"



---

archive/issue_comments_369982.json:
```json
{
    "body": "<a id='comment:39'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[81e9366](https://github.com/sagemath/sagetrac-mirror/commit/81e9366b072db5dc772f3ea9b91b54e20116504b)|`Added number_of_real_roots method`|",
    "created_at": "2016-04-06T02:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369982",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[81e9366](https://github.com/sagemath/sagetrac-mirror/commit/81e9366b072db5dc772f3ea9b91b54e20116504b)|`Added number_of_real_roots method`|



---

archive/issue_comments_369983.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [kdilks](#comment%3A37):\n> Patchbot doesn't like something about the way errors are raised. I think it would be a bit more straightforward to make the arguments be `(self,lower_bound=None,upper_bound=None)`, and just not allow for the option of specifying the bounds as a two-element list.\n> \n\nSee if patchbot does better with this.\n\n> In terms of the names of functions, I think `count_roots_in_interval` would make more sense as `number_of_roots_in_interval` (that's the naming convention used for most combinatorial statistics). And `has_all_real_roots` should probably be named `is_real_rooted`. Things that return a boolean almost always start with `is_`, and calling polynomials with all real roots \"real rooted\" is prevalent, at least in the literature that I read.\n\n\nNot a term I had seen before. I suppose it's actually \"real-rooted\" (otherwise a \"real rooted polynomial\" would be a polynomial which is real and also \"rooted\"), but I think there is a convention to convert both spaces and hyphens into underscores in method names (as in `Matrix.is_skew_symmetric`). However, I don't have a suitable \"is\" reformulation of  `all_roots_in_interval`.\n\nBonus edit: I added `number_of_real_roots` as an alias for `number_of_roots_in_interval` with no arguments.",
    "created_at": "2016-04-06T03:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369983",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:40'></a>
Replying to [kdilks](#comment%3A37):
> Patchbot doesn't like something about the way errors are raised. I think it would be a bit more straightforward to make the arguments be `(self,lower_bound=None,upper_bound=None)`, and just not allow for the option of specifying the bounds as a two-element list.
> 

See if patchbot does better with this.

> In terms of the names of functions, I think `count_roots_in_interval` would make more sense as `number_of_roots_in_interval` (that's the naming convention used for most combinatorial statistics). And `has_all_real_roots` should probably be named `is_real_rooted`. Things that return a boolean almost always start with `is_`, and calling polynomials with all real roots "real rooted" is prevalent, at least in the literature that I read.


Not a term I had seen before. I suppose it's actually "real-rooted" (otherwise a "real rooted polynomial" would be a polynomial which is real and also "rooted"), but I think there is a convention to convert both spaces and hyphens into underscores in method names (as in `Matrix.is_skew_symmetric`). However, I don't have a suitable "is" reformulation of  `all_roots_in_interval`.

Bonus edit: I added `number_of_real_roots` as an alias for `number_of_roots_in_interval` with no arguments.



---

archive/issue_comments_369984.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Kevin Dilks\"",
    "created_at": "2016-04-06T19:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369984",
    "user": "https://github.com/kevindilks"
}
```

Changing reviewer from "" to "Kevin Dilks"



---

archive/issue_comments_369985.json:
```json
{
    "body": "<a id='comment:41'></a>\nI am happy with this ticket now, but I'll give `@`jdemeyer some time to weigh in before setting positive review.",
    "created_at": "2016-04-06T19:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369985",
    "user": "https://github.com/kevindilks"
}
```

<a id='comment:41'></a>
I am happy with this ticket now, but I'll give `@`jdemeyer some time to weigh in before setting positive review.



---

archive/issue_comments_369986.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-06T19:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369986",
    "user": "https://github.com/kevindilks"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369987.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-26T19:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369987",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369988.json:
```json
{
    "body": "<a id='comment:42'></a>\nmissing whiteline after `TESTS::`\n\notherwise looks good to me",
    "created_at": "2016-05-26T19:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369988",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:42'></a>
missing whiteline after `TESTS::`

otherwise looks good to me



---

archive/issue_comments_369989.json:
```json
{
    "body": "<a id='comment:43'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[e93f3b8](https://github.com/sagemath/sagetrac-mirror/commit/e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92)|`Added missing whitespace in docstring`|",
    "created_at": "2016-05-26T21:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[e93f3b8](https://github.com/sagemath/sagetrac-mirror/commit/e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92)|`Added missing whitespace in docstring`|



---

archive/issue_comments_369990.json:
```json
{
    "body": "Changing commit from \"81e9366b072db5dc772f3ea9b91b54e20116504b\" to \"e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92\"",
    "created_at": "2016-05-26T21:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "81e9366b072db5dc772f3ea9b91b54e20116504b" to "e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92"



---

archive/issue_comments_369991.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-26T21:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369991",
    "user": "https://github.com/kedlaya"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369992.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [chapoton](#comment%3A42):\n> missing whiteline after `TESTS::`\n> \n> otherwise looks good to me\n\n\nFixed, thanks.",
    "created_at": "2016-05-26T21:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369992",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:44'></a>
Replying to [chapoton](#comment%3A42):
> missing whiteline after `TESTS::`
> 
> otherwise looks good to me


Fixed, thanks.



---

archive/issue_comments_369993.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-27T06:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369993",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_369994.json:
```json
{
    "body": "Changing reviewer from \"Kevin Dilks\" to \"Kevin Dilks, Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2016-05-27T06:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369994",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "Kevin Dilks" to "Kevin Dilks, Frédéric Chapoton"



---

archive/issue_comments_369995.json:
```json
{
    "body": "<a id='comment:45'></a>\nok, let it be.",
    "created_at": "2016-05-27T06:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369995",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:45'></a>
ok, let it be.



---

archive/issue_comments_369996.json:
```json
{
    "body": "Changing branch from \"u/kedlaya/count_real_roots_of_polynomials_using_sturm_sequences\" to \"e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92\"",
    "created_at": "2016-05-28T12:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369996",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/kedlaya/count_real_roots_of_polynomials_using_sturm_sequences" to "e93f3b8319b5a05dd6d16e1aef2c5a98acbcfd92"



---

archive/issue_comments_369997.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-28T12:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20243#issuecomment-369997",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_062530.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-28T12:13:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20243",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20243#event-62530"
}
```
