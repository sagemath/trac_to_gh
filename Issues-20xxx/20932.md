# Issue 20932: Issues with p1list in modular symbols

archive/issues_020695.json:
```json
{
    "assignees": [
        "https://github.com/kedlaya"
    ],
    "body": "Two related issues with modular symbols, originally reported by robharron on sage-nt: [https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ](https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ).\n\nIssue 1:\n\n```\nsage: chi = kronecker_character(3*34603)\nsage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))\n...\nFile \"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/sage/modular/modsym/relation_matrix.py\", line 126, in modS_relations\n    assert j != -1\nAssertionError\n```\nThe underlying problem appears to be:\n\n```\nsage: import sage.modular.modsym.p1list as p1list\nsage: for (i,j) in p1list.P1List(103809):\nsage:    if i != 1 and i != 3: print (i,j)\n(0, 1) #should also return (34603, 1), (34603, 2), (34603, 3)\n```\n\nIssue 2:\n\n```\nsage: chi = kronecker_character(3*61379)\nsage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))\n...\n  File \"sage/rings/fast_arith.pyx\", line 381, in sage.rings.fast_arith.arith_llong.c_inverse_mod_longlong (/projects/sage/sage-6.10/src/build/cythonized/sage/rings/fast_arith.c:5546)\n    raise ArithmeticError(\"The inverse of %s modulo %s is not defined.\"%(a,m))\nArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.\n```\nThe underlying issue appears to be:\n\n```\nsage: import sage.modular.modsym.p1list as p1list\nsage: N = 3*61379\nsage: p1 = p1list.P1List(N)\nsage: p1.normalize_with_scalar(21, -1) \n...\nArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.\n\n\nCC:  @rharron\n\nKeywords: **modular symbols**\n\nBranch: **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)**\n\nReviewer: **Vincent Delecroix, John Cremona, Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Kiran Kedlaya**\n\nComponent: **modular forms**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20932_\n\n",
    "closed_at": "2017-08-21T19:24:09Z",
    "created_at": "2016-07-03T16:47:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20modular%20forms",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Issues with p1list in modular symbols",
    "type": "issue",
    "updated_at": "2017-12-08T14:53:50Z",
    "url": "https://github.com/sagemath/sage/issues/20932",
    "user": "https://github.com/kedlaya"
}
```
Two related issues with modular symbols, originally reported by robharron on sage-nt: [https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ](https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ).

Issue 1:

```
sage: chi = kronecker_character(3*34603)
sage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))
...
File "/projects/sage/sage-6.10/local/lib/python2.7/site-packages/sage/modular/modsym/relation_matrix.py", line 126, in modS_relations
    assert j != -1
AssertionError
```
The underlying problem appears to be:

```
sage: import sage.modular.modsym.p1list as p1list
sage: for (i,j) in p1list.P1List(103809):
sage:    if i != 1 and i != 3: print (i,j)
(0, 1) #should also return (34603, 1), (34603, 2), (34603, 3)
```

Issue 2:

```
sage: chi = kronecker_character(3*61379)
sage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))
...
  File "sage/rings/fast_arith.pyx", line 381, in sage.rings.fast_arith.arith_llong.c_inverse_mod_longlong (/projects/sage/sage-6.10/src/build/cythonized/sage/rings/fast_arith.c:5546)
    raise ArithmeticError("The inverse of %s modulo %s is not defined."%(a,m))
ArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.
```
The underlying issue appears to be:

```
sage: import sage.modular.modsym.p1list as p1list
sage: N = 3*61379
sage: p1 = p1list.P1List(N)
sage: p1.normalize_with_scalar(21, -1) 
...
ArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.


CC:  @rharron

Keywords: **modular symbols**

Branch: **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)**

Reviewer: **Vincent Delecroix, John Cremona, Frédéric Chapoton**

Author: **Kiran Kedlaya**

Component: **modular forms**

_Issue created by migration from https://trac.sagemath.org/ticket/20932_





---

archive/issue_events_294554.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-03T16:47:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294554"
}
```



---

archive/issue_events_294555.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-03T16:47:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20modular%20forms",
    "label_color": "0000ff",
    "label_name": "c: modular forms",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294555"
}
```



---

archive/issue_events_294556.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-03T16:47:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294556"
}
```



---

archive/issue_events_294557.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-03T16:47:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294557"
}
```



---

archive/issue_comments_304182.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nIn `p1list`, one finds different code depending on the size of the level. For levels in this range, the relevant subroutine is `p1list_llong`, which contains:\n\n```\n    cmax = N/2\n    if N%2:   # N odd, max divisor is <= N/3\n        if N%5:  # N not a multiple of 3 either, max is N/5\n            cmax = N/5\n        else:\n            cmax = N/3\n```\nbut `N%5` should be `N%3`.",
    "created_at": "2016-07-03T16:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304182",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:1" align="right">comment:1</div>

In `p1list`, one finds different code depending on the size of the level. For levels in this range, the relevant subroutine is `p1list_llong`, which contains:

```
    cmax = N/2
    if N%2:   # N odd, max divisor is <= N/3
        if N%5:  # N not a multiple of 3 either, max is N/5
            cmax = N/5
        else:
            cmax = N/3
```
but `N%5` should be `N%3`.



---

archive/issue_comments_304183.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nRe issue 2: the offending subroutine in `p1list` appears to be `c_p1_normalize_llong`, in which one finds:\n\n```\n    if compute_s:\n        ss[0] = <int> (arith_llong.c_inverse_mod_longlong(s*min_t, N) % ll_N)\n```\nAs written, this creates a 32-bit integer overflow. It should be:\n\n```\n    if compute_s:\n        ss[0] = <int> (arith_llong.c_inverse_mod_longlong((<llong> s)*(<llong> min_t), N) % ll_N)\n```",
    "created_at": "2016-07-04T15:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304183",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:2" align="right">comment:2</div>

Re issue 2: the offending subroutine in `p1list` appears to be `c_p1_normalize_llong`, in which one finds:

```
    if compute_s:
        ss[0] = <int> (arith_llong.c_inverse_mod_longlong(s*min_t, N) % ll_N)
```
As written, this creates a 32-bit integer overflow. It should be:

```
    if compute_s:
        ss[0] = <int> (arith_llong.c_inverse_mod_longlong((<llong> s)*(<llong> min_t), N) % ll_N)
```



---

archive/issue_comments_304184.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n-Originally reported by robharron on sage-nt: [https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ](https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ).\n+Two related issues with modular symbols, originally reported by robharron on sage-nt: [https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ](https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ).\n+\n+Issue 1:\n+\n+```\n+sage: chi = kronecker_character(3*34603)\n+sage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))\n+...\n+File \"/projects/sage/sage-6.10/local/lib/python2.7/site-packages/sage/modular/modsym/relation_matrix.py\", line 126, in modS_relations\n+    assert j != -1\n+AssertionError\n+```\n+The underlying problem appears to be:\n \n ```\n sage: import sage.modular.modsym.p1list as p1list\n@@ -7,3 +19,23 @@\n (0, 1) #should also return (34603, 1) and (34603, 2)\n ```\n \n+Issue 2:\n+\n+```\n+sage: chi = kronecker_character(3*61379)\n+sage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))\n+...\n+  File \"sage/rings/fast_arith.pyx\", line 381, in sage.rings.fast_arith.arith_llong.c_inverse_mod_longlong (/projects/sage/sage-6.10/src/build/cythonized/sage/rings/fast_arith.c:5546)\n+    raise ArithmeticError(\"The inverse of %s modulo %s is not defined.\"%(a,m))\n+ArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.\n+```\n+The underlying issue appears to be:\n+\n+```\n+sage: import sage.modular.modsym.p1list as p1list\n+sage: N = 3*61379\n+sage: p1 = p1list.P1List(N)\n+sage: p1.normalize_with_scalar(21, -1) \n+...\n+ArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.\n+\n``````\n",
    "created_at": "2016-07-04T15:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304184",
    "user": "https://github.com/kedlaya"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,16 @@
-Originally reported by robharron on sage-nt: [https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ](https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ).
+Two related issues with modular symbols, originally reported by robharron on sage-nt: [https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ](https://groups.google.com/forum/#!msg/sage-nt/5HYpZKFB2qA/fRXgDkaICAAJ).
+
+Issue 1:
+
+```
+sage: chi = kronecker_character(3*34603)
+sage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))
+...
+File "/projects/sage/sage-6.10/local/lib/python2.7/site-packages/sage/modular/modsym/relation_matrix.py", line 126, in modS_relations
+    assert j != -1
+AssertionError
+```
+The underlying problem appears to be:
 
 ```
 sage: import sage.modular.modsym.p1list as p1list
@@ -7,3 +19,23 @@
 (0, 1) #should also return (34603, 1) and (34603, 2)
 ```
 
+Issue 2:
+
+```
+sage: chi = kronecker_character(3*61379)
+sage: M = ModularSymbols(chi, 2, sign=1, base_ring=GF(3))
+...
+  File "sage/rings/fast_arith.pyx", line 381, in sage.rings.fast_arith.arith_llong.c_inverse_mod_longlong (/projects/sage/sage-6.10/src/build/cythonized/sage/rings/fast_arith.c:5546)
+    raise ArithmeticError("The inverse of %s modulo %s is not defined."%(a,m))
+ArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.
+```
+The underlying issue appears to be:
+
+```
+sage: import sage.modular.modsym.p1list as p1list
+sage: N = 3*61379
+sage: p1 = p1list.P1List(N)
+sage: p1.normalize_with_scalar(21, -1) 
+...
+ArithmeticError: The inverse of -2142142713 modulo 184137 is not defined.
+
``````




---

archive/issue_events_294558.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-04T15:28:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "title_is": "Issues with p1list in modular symbols",
    "title_was": "Incorrect generation of p1list in modular symbols",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294558"
}
```



---

archive/issue_comments_304185.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n sage: import sage.modular.modsym.p1list as p1list\n sage: for (i,j) in p1list.P1List(103809):\n sage:    if i != 1 and i != 3: print (i,j)\n-(0, 1) #should also return (34603, 1) and (34603, 2)\n+(0, 1) #should also return (34603, 1), (34603, 2), (34603, 3)\n ```\n \n Issue 2:\n``````\n",
    "created_at": "2016-07-04T15:38:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304185",
    "user": "https://github.com/kedlaya"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 sage: import sage.modular.modsym.p1list as p1list
 sage: for (i,j) in p1list.P1List(103809):
 sage:    if i != 1 and i != 3: print (i,j)
-(0, 1) #should also return (34603, 1) and (34603, 2)
+(0, 1) #should also return (34603, 1), (34603, 2), (34603, 3)
 ```
 
 Issue 2:
``````




---

archive/issue_comments_304186.json:
```json
{
    "body": "Author: **Kiran Kedlaya**",
    "created_at": "2016-07-04T20:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304186",
    "user": "https://github.com/kedlaya"
}
```

Author: **Kiran Kedlaya**



---

archive/issue_comments_304187.json:
```json
{
    "body": "Commit: **[`852b61b`](https://github.com/sagemath/sagetrac-mirror/commit/852b61bb0acf53fdc61a14637a243e8a5bcce7fe)**",
    "created_at": "2016-07-04T20:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304187",
    "user": "https://github.com/kedlaya"
}
```

Commit: **[`852b61b`](https://github.com/sagemath/sagetrac-mirror/commit/852b61bb0acf53fdc61a14637a243e8a5bcce7fe)**



---

archive/issue_comments_304188.json:
```json
{
    "body": "Branch: **[u/kedlaya/issues_with_p1list_in_modular_symbols](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/issues_with_p1list_in_modular_symbols)**",
    "created_at": "2016-07-04T20:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304188",
    "user": "https://github.com/kedlaya"
}
```

Branch: **[u/kedlaya/issues_with_p1list_in_modular_symbols](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/issues_with_p1list_in_modular_symbols)**



---

archive/issue_events_294559.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-04T20:34:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294559"
}
```



---

archive/issue_comments_304189.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis patch addresses both issues in the description. Besides doctesting the isolating code fragments, I added optional doctests for the construction of the spaces of modular symbols; however, these take far too long to be required even as long doctests.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/852b61bb0acf53fdc61a14637a243e8a5bcce7fe\"><code>852b61b</code></a></td><td><code>Corrections to p1list</code></td></tr></table>\n",
    "created_at": "2016-07-04T20:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304189",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:4" align="right">comment:4</div>

This patch addresses both issues in the description. Besides doctesting the isolating code fragments, I added optional doctests for the construction of the spaces of modular symbols; however, these take far too long to be required even as long doctests.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/852b61bb0acf53fdc61a14637a243e8a5bcce7fe"><code>852b61b</code></a></td><td><code>Corrections to p1list</code></td></tr></table>




---

archive/issue_comments_304190.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nApologies for the typo which git blame attributes to me in April 2009.",
    "created_at": "2016-07-10T21:05:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304190",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">comment:5</div>

Apologies for the typo which git blame attributes to me in April 2009.



---

archive/issue_comments_304191.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe following syntax is wrong\n\n```\n+    TESTS::\n+    \n+    This test reflects :trac:`20932`::\n+        sage: N = 3*61379\n```\nIt should be changed to\n\n```\n    TESTS:    <--- only one colon\n\n    This test reflects :trac`20932`::\n                                         <--- line break\n        sage: N = 3*61379\n```",
    "created_at": "2016-07-25T01:45:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304191",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

The following syntax is wrong

```
+    TESTS::
+    
+    This test reflects :trac:`20932`::
+        sage: N = 3*61379
```
It should be changed to

```
    TESTS:    <--- only one colon

    This test reflects :trac`20932`::
                                         <--- line break
        sage: N = 3*61379
```



---

archive/issue_comments_304192.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIn the doctest you mention <code>:trac:\\`20513\\`</code> which is another matter.",
    "created_at": "2016-07-25T01:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304192",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

In the doctest you mention <code>:trac:\`20513\`</code> which is another matter.



---

archive/issue_events_294560.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-25T01:47:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294560"
}
```



---

archive/issue_events_294561.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-25T01:47:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294561"
}
```



---

archive/issue_comments_304193.json:
```json
{
    "body": "Changed commit from **[`852b61b`](https://github.com/sagemath/sagetrac-mirror/commit/852b61bb0acf53fdc61a14637a243e8a5bcce7fe)** to **[`6e5e20a`](https://github.com/sagemath/sagetrac-mirror/commit/6e5e20a90d1272d7308811709a84db6fa2de062c)**",
    "created_at": "2016-07-25T21:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304193",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`852b61b`](https://github.com/sagemath/sagetrac-mirror/commit/852b61bb0acf53fdc61a14637a243e8a5bcce7fe)** to **[`6e5e20a`](https://github.com/sagemath/sagetrac-mirror/commit/6e5e20a90d1272d7308811709a84db6fa2de062c)**



---

archive/issue_comments_304194.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e5e20a90d1272d7308811709a84db6fa2de062c\"><code>6e5e20a</code></a></td><td><code>Correct doctest formatting</code></td></tr></table>\n",
    "created_at": "2016-07-25T21:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304194",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e5e20a90d1272d7308811709a84db6fa2de062c"><code>6e5e20a</code></a></td><td><code>Correct doctest formatting</code></td></tr></table>




---

archive/issue_events_294562.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-25T21:59:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294562"
}
```



---

archive/issue_events_294563.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2016-07-25T21:59:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294563"
}
```



---

archive/issue_comments_304195.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe formatting should be fixed now.",
    "created_at": "2016-07-25T21:59:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304195",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:9" align="right">comment:9</div>

The formatting should be fixed now.



---

archive/issue_comments_304196.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nwould it be possible to have faster (smaller) doctests ? 600s is too much and 1800s is *way* too much.. \n\nat worse, maybe keep only the 600s one..",
    "created_at": "2016-11-06T20:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304196",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

would it be possible to have faster (smaller) doctests ? 600s is too much and 1800s is *way* too much.. 

at worse, maybe keep only the 600s one..



---

archive/issue_comments_304197.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@fchapoton](#comment:10):\n> would it be possible to have faster (smaller) doctests ? 600s is too much and 1800s is *way* too much.. \n> \n> at worse, maybe keep only the 600s one..\n\n \nSadly no, this is precisely a bug that occurs only for large problem sizes (see comment 1), so any doctest that actually tests it will have to deal with large problems. Is it okay if all of the doctests that confirm the resolution of this issue are optional?",
    "created_at": "2016-11-06T20:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304197",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@fchapoton](#comment:10):
> would it be possible to have faster (smaller) doctests ? 600s is too much and 1800s is *way* too much.. 
> 
> at worse, maybe keep only the 600s one..

 
Sadly no, this is precisely a bug that occurs only for large problem sizes (see comment 1), so any doctest that actually tests it will have to deal with large problems. Is it okay if all of the doctests that confirm the resolution of this issue are optional?



---

archive/issue_comments_304198.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIf you want these 2 **long** tests to be never tested, they should be tagged `# not tested`, I think. In principle, `optional` should come with a parameter (like spkg name on which it depends), and will be tested whenever possible. As far as I know, there is no bare `optional`.",
    "created_at": "2016-11-07T20:59:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304198",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

If you want these 2 **long** tests to be never tested, they should be tagged `# not tested`, I think. In principle, `optional` should come with a parameter (like spkg name on which it depends), and will be tested whenever possible. As far as I know, there is no bare `optional`.



---

archive/issue_comments_304199.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f631070e48df2bfb6fff420b7dc3831ec9dd0e26\"><code>f631070</code></a></td><td><code>Corrections to p1list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05369688810d4c1684353b60b345354a0d722273\"><code>0536968</code></a></td><td><code>Correct doctest formatting</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ebd477b226a070e9d4f015bc7df6662cdab5eb75\"><code>ebd477b</code></a></td><td><code>Doctests marked as \"not tested\" due to excess runtime</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93a4b889e4a18ca7ce4ff9123c357b541816ee30\"><code>93a4b88</code></a></td><td><code>Merge branch 'u/kedlaya/issues_with_p1list_in_modular_symbols' of git://trac.sagemath.org/sage into t/20932/incorrect_generation_of_p1list_in_modular_symbols</code></td></tr></table>\n",
    "created_at": "2017-08-14T19:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304199",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f631070e48df2bfb6fff420b7dc3831ec9dd0e26"><code>f631070</code></a></td><td><code>Corrections to p1list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05369688810d4c1684353b60b345354a0d722273"><code>0536968</code></a></td><td><code>Correct doctest formatting</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ebd477b226a070e9d4f015bc7df6662cdab5eb75"><code>ebd477b</code></a></td><td><code>Doctests marked as "not tested" due to excess runtime</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93a4b889e4a18ca7ce4ff9123c357b541816ee30"><code>93a4b88</code></a></td><td><code>Merge branch 'u/kedlaya/issues_with_p1list_in_modular_symbols' of git://trac.sagemath.org/sage into t/20932/incorrect_generation_of_p1list_in_modular_symbols</code></td></tr></table>




---

archive/issue_comments_304200.json:
```json
{
    "body": "Changed commit from **[`6e5e20a`](https://github.com/sagemath/sagetrac-mirror/commit/6e5e20a90d1272d7308811709a84db6fa2de062c)** to **[`93a4b88`](https://github.com/sagemath/sagetrac-mirror/commit/93a4b889e4a18ca7ce4ff9123c357b541816ee30)**",
    "created_at": "2017-08-14T19:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304200",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6e5e20a`](https://github.com/sagemath/sagetrac-mirror/commit/6e5e20a90d1272d7308811709a84db6fa2de062c)** to **[`93a4b88`](https://github.com/sagemath/sagetrac-mirror/commit/93a4b889e4a18ca7ce4ff9123c357b541816ee30)**



---

archive/issue_comments_304201.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI rebased and marked the doctests as \"not tested\".",
    "created_at": "2017-08-14T20:01:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304201",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:14" align="right">comment:14</div>

I rebased and marked the doctests as "not tested".



---

archive/issue_events_294564.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2017-08-14T20:01:27Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "subject": "https://github.com/kedlaya",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294564"
}
```



---

archive/issue_comments_304202.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThere still remains 2 very long tests in src/sage/modular/modsym/modsym.py. I guess they should also be marked as \"not tested\".",
    "created_at": "2017-08-19T16:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304202",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

There still remains 2 very long tests in src/sage/modular/modsym/modsym.py. I guess they should also be marked as "not tested".



---

archive/issue_comments_304203.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nLook, there was a bug (my old typo); it has been fixed; there are doctests to show this which are marked \"not tested\" for good reasons.  That should be enough for this to pass.  If there are issues with different doctests i nthis file that should be made into a separate issue.  So I am giving this a positive review.",
    "created_at": "2017-08-19T16:51:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304203",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">comment:16</div>

Look, there was a bug (my old typo); it has been fixed; there are doctests to show this which are marked "not tested" for good reasons.  That should be enough for this to pass.  If there are issues with different doctests i nthis file that should be made into a separate issue.  So I am giving this a positive review.



---

archive/issue_comments_304204.json:
```json
{
    "body": "Reviewer: **Vincent Delacroix, John Cremona, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2017-08-19T16:51:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304204",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **Vincent Delacroix, John Cremona, Frédéric Chapoton**



---

archive/issue_events_294565.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2017-08-19T16:51:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294565"
}
```



---

archive/issue_events_294566.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2017-08-19T16:51:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294566"
}
```



---

archive/issue_comments_304205.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9\"><code>cc5333f</code></a></td><td><code>Marked doctests in modsym.py as not tested</code></td></tr></table>\n",
    "created_at": "2017-08-19T17:09:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304205",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9"><code>cc5333f</code></a></td><td><code>Marked doctests in modsym.py as not tested</code></td></tr></table>




---

archive/issue_comments_304206.json:
```json
{
    "body": "Changed commit from **[`93a4b88`](https://github.com/sagemath/sagetrac-mirror/commit/93a4b889e4a18ca7ce4ff9123c357b541816ee30)** to **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)**",
    "created_at": "2017-08-19T17:09:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304206",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`93a4b88`](https://github.com/sagemath/sagetrac-mirror/commit/93a4b889e4a18ca7ce4ff9123c357b541816ee30)** to **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)**



---

archive/issue_events_294567.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2017-08-19T17:09:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294567"
}
```



---

archive/issue_events_294568.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2017-08-19T17:09:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294568"
}
```



---

archive/issue_comments_304207.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nPoint taken, when I changed the two doctests in p1list.pyx I should have also touched modsym.py. This is now done, but someone other than me should set this back to positive review.",
    "created_at": "2017-08-19T17:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304207",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:18" align="right">comment:18</div>

Point taken, when I changed the two doctests in p1list.pyx I should have also touched modsym.py. This is now done, but someone other than me should set this back to positive review.



---

archive/issue_events_294569.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2017-08-19T17:23:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294569"
}
```



---

archive/issue_events_294570.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2017-08-19T17:23:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294570"
}
```



---

archive/issue_comments_304208.json:
```json
{
    "body": "Changed branch from **[u/kedlaya/issues_with_p1list_in_modular_symbols](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/issues_with_p1list_in_modular_symbols)** to **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)**",
    "created_at": "2017-08-21T19:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304208",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/kedlaya/issues_with_p1list_in_modular_symbols](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/issues_with_p1list_in_modular_symbols)** to **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)**



---

archive/issue_events_294571.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-21T19:24:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294571"
}
```



---

archive/issue_events_294572.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "efaeac41d123c71a54bd821dceba75dda1ffb4e0",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-08-21T19:24:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20932#event-294572"
}
```



---

archive/issue_comments_304209.json:
```json
{
    "body": "Changed reviewer from **Vincent Delacroix, John Cremona, Fr\u00e9d\u00e9ric Chapoton** to **Vincent Delecroix, John Cremona, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2017-12-08T14:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304209",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Vincent Delacroix, John Cremona, Frédéric Chapoton** to **Vincent Delecroix, John Cremona, Frédéric Chapoton**



---

archive/issue_comments_304210.json:
```json
{
    "body": "Changed commit from **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)** to none",
    "created_at": "2017-12-08T14:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20932#issuecomment-304210",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`cc5333f`](https://github.com/sagemath/sagetrac-mirror/commit/cc5333fc4ff9b6664704e365c58067915ef18da9)** to none
