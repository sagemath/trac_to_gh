# Issue 20861: numbers.Rational, numbers.Integer, etc. interfaces not implemented correctly

archive/issues_020624.json:
```json
{
    "assignees": [],
    "body": "The file numbers_abc.py registers some Sage classes as instances of numbers.Rational, numbers.Integer, etc.  However, none of these classes implement the interfaces entirely correctly, because members that the interface expects to be properties (e. g. numerator and denominator in numbers.Rational) are instead functions.\n\nAttempts to use these interfaces will fail in a way that may be confusing to the user:\n\n```\nsage: import fractions\nsage: fractions.Fraction(1/2)\nFraction(<built-in method numerator of sage.rings.rational.Rational object at 0x7f4268425b30>, <built-in method denominator of sage.rings.rational.Rational object at 0x7f4268425b30>)\nsage: fractions.Fraction(1,2)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-cee53c78dd93> in <module>()\n----> 1 fractions.Fraction(Integer(1),Integer(2))\n\n/home/dan/SageMath/local/lib/python/fractions.pyc in __new__(cls, numerator, denominator)\n    152             isinstance(denominator, Rational)):\n    153             numerator, denominator = (\n--> 154                 numerator.numerator * denominator.denominator,\n    155                 denominator.numerator * numerator.denominator\n    156                 )\n\nTypeError: unsupported operand type(s) for *: 'builtin_function_or_method' and 'builtin_function_or_method'\n```\n\nCC:  @jdemeyer @sagetrac-mcbell @slel\n\nKeywords: **rational, numerator, denominator**\n\nReviewer: **Samuel Leli\u00e8vre**\n\nComponent: **basic arithmetic**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20861_\n\n",
    "closed_at": "2019-08-02T20:18:34Z",
    "created_at": "2016-06-22T14:05:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "numbers.Rational, numbers.Integer, etc. interfaces not implemented correctly",
    "type": "issue",
    "updated_at": "2019-08-02T20:18:34Z",
    "url": "https://github.com/sagemath/sage/issues/20861",
    "user": "https://github.com/sagetrac-dgulotta"
}
```
The file numbers_abc.py registers some Sage classes as instances of numbers.Rational, numbers.Integer, etc.  However, none of these classes implement the interfaces entirely correctly, because members that the interface expects to be properties (e. g. numerator and denominator in numbers.Rational) are instead functions.

Attempts to use these interfaces will fail in a way that may be confusing to the user:

```
sage: import fractions
sage: fractions.Fraction(1/2)
Fraction(<built-in method numerator of sage.rings.rational.Rational object at 0x7f4268425b30>, <built-in method denominator of sage.rings.rational.Rational object at 0x7f4268425b30>)
sage: fractions.Fraction(1,2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-cee53c78dd93> in <module>()
----> 1 fractions.Fraction(Integer(1),Integer(2))

/home/dan/SageMath/local/lib/python/fractions.pyc in __new__(cls, numerator, denominator)
    152             isinstance(denominator, Rational)):
    153             numerator, denominator = (
--> 154                 numerator.numerator * denominator.denominator,
    155                 denominator.numerator * numerator.denominator
    156                 )

TypeError: unsupported operand type(s) for *: 'builtin_function_or_method' and 'builtin_function_or_method'
```

CC:  @jdemeyer @sagetrac-mcbell @slel

Keywords: **rational, numerator, denominator**

Reviewer: **Samuel Lelièvre**

Component: **basic arithmetic**

_Issue created by migration from https://trac.sagemath.org/ticket/20861_





---

archive/issue_events_293563.json:
```json
{
    "actor": "https://github.com/sagetrac-dgulotta",
    "created_at": "2016-06-22T14:05:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293563"
}
```



---

archive/issue_events_293564.json:
```json
{
    "actor": "https://github.com/sagetrac-dgulotta",
    "created_at": "2016-06-22T14:05:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293564"
}
```



---

archive/issue_events_293565.json:
```json
{
    "actor": "https://github.com/sagetrac-dgulotta",
    "created_at": "2016-06-22T14:05:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293565"
}
```



---

archive/issue_events_293566.json:
```json
{
    "actor": "https://github.com/sagetrac-dgulotta",
    "created_at": "2016-06-22T14:05:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293566"
}
```



---

archive/issue_comments_302523.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHonestly, I don't think this is easy to fix. Sage has a history of using methods for these and related things. So either we drop internal consistency within Sage or we drop compatibility with the numbers ABC.",
    "created_at": "2016-06-22T14:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302523",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:1" align="right">comment:1</div>

Honestly, I don't think this is easy to fix. Sage has a history of using methods for these and related things. So either we drop internal consistency within Sage or we drop compatibility with the numbers ABC.



---

archive/issue_comments_302524.json:
```json
{
    "body": "Changed keywords from none to **rational, numerator, denominator**",
    "created_at": "2019-07-23T15:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302524",
    "user": "https://github.com/slel"
}
```

Changed keywords from none to **rational, numerator, denominator**



---

archive/issue_comments_302525.json:
```json
{
    "body": "Reviewer: **Samuel Leli\u00e8vre**",
    "created_at": "2019-07-23T15:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302525",
    "user": "https://github.com/slel"
}
```

Reviewer: **Samuel Lelièvre**



---

archive/issue_events_293567.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-07-23T15:42:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293567"
}
```



---

archive/issue_events_293568.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-07-23T15:42:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293568"
}
```



---

archive/issue_events_293569.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-07-23T15:42:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293569"
}
```



---

archive/issue_events_293570.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-07-23T15:42:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293570"
}
```



---

archive/issue_comments_302526.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nProposing to close as a duplicate of #28234 where a solution is being proposed.",
    "created_at": "2019-07-23T15:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302526",
    "user": "https://github.com/slel"
}
```

<div id="comment:2" align="right">comment:2</div>

Proposing to close as a duplicate of #28234 where a solution is being proposed.



---

archive/issue_comments_302527.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nTo the OP: why do you care about Python fractions? It's a serious question since Guido van Rossum seems quite negative about them (see https://discuss.python.org/t/pep-3141-ratio-instead-of-numerator-denominator/2037/27?u=jdemeyer)",
    "created_at": "2019-08-02T17:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302527",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

To the OP: why do you care about Python fractions? It's a serious question since Guido van Rossum seems quite negative about them (see https://discuss.python.org/t/pep-3141-ratio-instead-of-numerator-denominator/2037/27?u=jdemeyer)



---

archive/issue_comments_302528.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI filed the bug mainly because it seems like a bad idea to claim to implement interfaces that are not actually implemented.  I probably should have been more clear about this, but I would consider just not registering the instances to be a solution to the problem.",
    "created_at": "2019-08-02T18:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302528",
    "user": "https://github.com/sagetrac-dgulotta"
}
```

<div id="comment:4" align="right">comment:4</div>

I filed the bug mainly because it seems like a bad idea to claim to implement interfaces that are not actually implemented.  I probably should have been more clear about this, but I would consider just not registering the instances to be a solution to the problem.



---

archive/issue_events_293571.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-08-02T20:18:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293571"
}
```



---

archive/issue_events_293572.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-08-02T20:18:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293572"
}
```



---

archive/issue_events_293573.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2019-08-02T20:18:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20861#event-293573"
}
```



---

archive/issue_comments_302529.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOK, thanks for that info, it's useful to know! I'm closing this now as duplicate of #28234.",
    "created_at": "2019-08-02T20:18:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20861#issuecomment-302529",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

OK, thanks for that info, it's useful to know! I'm closing this now as duplicate of #28234.
