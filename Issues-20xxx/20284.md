# Issue 20284: A class to manage embedding between non-prime fields

archive/issues_020047.json:
```json
{
    "body": "In Sage, there is no general mechanism to manage the embedding of elements of a finite extension field in one of its subfields.\n\nWe propose here a class which takes care of that.\n\nConsidering a big, non-prime field `Fqm` and one of its subfields `Fq`, this class is able to give either a polynomial or a vectorial representation of an element of `Fqm` in `Fq`.\n\nCC:  @johanrosenkilde jpflori @defeo\n\nReviewer: Arpit Merchant\n\nAuthor: David Lucas\n\nBranch: 2492c313523014a07d88bc9af3809b96bf595700\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20284\n\n",
    "closed_at": "2016-06-09T16:14:09Z",
    "created_at": "2016-03-25T08:47:16Z",
    "labels": [
        "component: finite rings"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "A class to manage embedding between non-prime fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20284",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```
In Sage, there is no general mechanism to manage the embedding of elements of a finite extension field in one of its subfields.

We propose here a class which takes care of that.

Considering a big, non-prime field `Fqm` and one of its subfields `Fq`, this class is able to give either a polynomial or a vectorial representation of an element of `Fqm` in `Fq`.

CC:  @johanrosenkilde jpflori @defeo

Reviewer: Arpit Merchant

Author: David Lucas

Branch: 2492c313523014a07d88bc9af3809b96bf595700

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20284





---

archive/issue_comments_293788.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-25T08:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293788",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_293789.json:
```json
{
    "body": "<a id='comment:2'></a>I pushed my code, and I open this ticket for review.\n\n---\nNew commits:",
    "created_at": "2016-03-25T08:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293789",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:2'></a>I pushed my code, and I open this ticket for review.

---
New commits:



---

archive/issue_comments_293790.json:
```json
{
    "body": "<a id='comment:3'></a>By the way, as I'm not sure where to put my code, I left it (for now) in `sage/coding`...",
    "created_at": "2016-03-25T08:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293790",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:3'></a>By the way, as I'm not sure where to put my code, I left it (for now) in `sage/coding`...



---

archive/issue_comments_293791.json:
```json
{
    "body": "<a id='comment:4'></a>Just to be precise: Sage already supports embedding a small field `GF(p^s)` into a larger one `GF(p^(sm))` (by using `Fsmall.extension(m, map=True)`). It also supports the inverse map (returned by the `section()` method on the embedding map).\n\nThe new functionality of this ticket is to support representing any `GF(p^(sm))` element in a basis over `GF(p^s)`. AFAIK, the current implementation supports this with only one particular choice of bases: if `1, beta, ..., beta^(sm-1)` is the basis of `GF(p^(sm))` that Sage currently uses natively, then it is always the case that `1, beta, ..., beta^(m-1)` is a basis of `GF(p^(sm))` over `GF(p^s)`. This is the basis employed by the current ticket.\n\nMore precisely, it gives a function that takes an element `e` in `GF(p^(sm))` and returns a vector `(v[0],...,v[m-1]) in GF(p<sup>s)</sup>m`, such that\n\n```\n    e = sum_{i=0}^{m-1} phi(v[i]) * beta^i\n```\n\nwhere `phi` is a given embedding from `GF(p^s)` into `GF(p^(sm))`.\n\nBest,\nJohan",
    "created_at": "2016-03-25T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293791",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:4'></a>Just to be precise: Sage already supports embedding a small field `GF(p^s)` into a larger one `GF(p^(sm))` (by using `Fsmall.extension(m, map=True)`). It also supports the inverse map (returned by the `section()` method on the embedding map).

The new functionality of this ticket is to support representing any `GF(p^(sm))` element in a basis over `GF(p^s)`. AFAIK, the current implementation supports this with only one particular choice of bases: if `1, beta, ..., beta^(sm-1)` is the basis of `GF(p^(sm))` that Sage currently uses natively, then it is always the case that `1, beta, ..., beta^(m-1)` is a basis of `GF(p^(sm))` over `GF(p^s)`. This is the basis employed by the current ticket.

More precisely, it gives a function that takes an element `e` in `GF(p^(sm))` and returns a vector `(v[0],...,v[m-1]) in GF(p<sup>s)</sup>m`, such that

```
    e = sum_{i=0}^{m-1} phi(v[i]) * beta^i
```

where `phi` is a given embedding from `GF(p^s)` into `GF(p^(sm))`.

Best,
Johan



---

archive/issue_comments_293792.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-31T14:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_293793.json:
```json
{
    "body": "<a id='comment:6'></a>Hello,\n\nI made some changes to the class:\n\n- I completely changed its nomenclature, which is now based on the one defined for [relative extensions](http://doc.sagemath.org/html/en/thematic_tutorials/explicit_methods_in_number_theory/nf_orders.html#relative-extensions).\n- I changed the behaviour of some methods.\n- I added a method to check if an element of the \"big field\" is in the relative field under the embedding.\n\nThis is still open for review.\n\nBest,\n\nDavid",
    "created_at": "2016-05-31T14:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293793",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:6'></a>Hello,

I made some changes to the class:

- I completely changed its nomenclature, which is now based on the one defined for [relative extensions](http://doc.sagemath.org/html/en/thematic_tutorials/explicit_methods_in_number_theory/nf_orders.html#relative-extensions).
- I changed the behaviour of some methods.
- I added a method to check if an element of the "big field" is in the relative field under the embedding.

This is still open for review.

Best,

David



---

archive/issue_events_055041.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/dlucas",
    "created_at": "2016-05-31T14:51:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20284#event-55041"
}
```



---

archive/issue_comments_293794.json:
```json
{
    "body": "<a id='comment:7'></a>Two naive questions:\n\n- Why is this in sage/coding?\n- Why not extending the preceding existing embedding class?\n\nVincent",
    "created_at": "2016-05-31T16:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293794",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>Two naive questions:

- Why is this in sage/coding?
- Why not extending the preceding existing embedding class?

Vincent



---

archive/issue_comments_293795.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 vdelecroix]:\n> Two naive questions:\n> \n> - Why is this in sage/coding?\n> - Why not extending the preceding existing embedding class?\n\n\nBecause we did not know where to put it, and we didn't get input from anyone. We need the functionality for several things in sage/coding, so we just wanted to add it. And it's on the agenda for Sage Days 75 to merge it much more sensibly with the rest of Sage.\n\nIncidentally, will you be coming for SD75?",
    "created_at": "2016-05-31T19:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293795",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:8'></a>Replying to [comment:7 vdelecroix]:
> Two naive questions:
> 
> - Why is this in sage/coding?
> - Why not extending the preceding existing embedding class?


Because we did not know where to put it, and we didn't get input from anyone. We need the functionality for several things in sage/coding, so we just wanted to add it. And it's on the agenda for Sage Days 75 to merge it much more sensibly with the rest of Sage.

Incidentally, will you be coming for SD75?



---

archive/issue_comments_293796.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 jsrn]:\n> Replying to [comment:7 vdelecroix]:\n> > Two naive questions:\n> > \n> > - Why is this in sage/coding?\n> > - Why not extending the preceding existing embedding class?\n \n> \n> Because we did not know where to put it, and we didn't get input from anyone. We need the functionality for several things in sage/coding, so we just wanted to add it. And it's on the agenda for Sage Days 75 to merge it much more sensibly with the rest of Sage.\n\n\nWould make more sense with everything about finite field, no? That is to say `sage/rings/finite_rings/`.\n\n> Incidentally, will you be coming for SD75?\n\n\nSadly not. I will be in Chile at that time.",
    "created_at": "2016-05-31T20:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293796",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Replying to [comment:8 jsrn]:
> Replying to [comment:7 vdelecroix]:
> > Two naive questions:
> > 
> > - Why is this in sage/coding?
> > - Why not extending the preceding existing embedding class?
 
> 
> Because we did not know where to put it, and we didn't get input from anyone. We need the functionality for several things in sage/coding, so we just wanted to add it. And it's on the agenda for Sage Days 75 to merge it much more sensibly with the rest of Sage.


Would make more sense with everything about finite field, no? That is to say `sage/rings/finite_rings/`.

> Incidentally, will you be coming for SD75?


Sadly not. I will be in Chile at that time.



---

archive/issue_comments_293797.json:
```json
{
    "body": "<a id='comment:10'></a>I'll be there at sd75.\nAnd I do agree it would nice to use such functionalities in a more general setting.\nWe could still put it in `coding` first and move it later.",
    "created_at": "2016-06-01T06:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293797",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:10'></a>I'll be there at sd75.
And I do agree it would nice to use such functionalities in a more general setting.
We could still put it in `coding` first and move it later.



---

archive/issue_comments_293798.json:
```json
{
    "body": "<a id='comment:11'></a>Hello,\n\n> And I do agree it would nice to use such functionalities in a more general setting.\n> We could still put it in `coding` first and move it later.\n\n\nI would indeed prefer to put it in `coding` first, as it locks several very useful tickets for us (#20039, #20100, #20335) while it's not reviewed. Furthermore, we need it for our GSoC project on rank-metric codes.\n\nI can put an experimental warning in it: this way, we will be able to move it later on without being worried by deprecation warnings.\n\nBest,\n\nDavid",
    "created_at": "2016-06-01T08:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293798",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:11'></a>Hello,

> And I do agree it would nice to use such functionalities in a more general setting.
> We could still put it in `coding` first and move it later.


I would indeed prefer to put it in `coding` first, as it locks several very useful tickets for us (#20039, #20100, #20335) while it's not reviewed. Furthermore, we need it for our GSoC project on rank-metric codes.

I can put an experimental warning in it: this way, we will be able to move it later on without being worried by deprecation warnings.

Best,

David



---

archive/issue_comments_293799.json:
```json
{
    "body": "<a id='comment:12'></a>> I can put an experimental warning in it: this way, we will be able to move it later on without being worried by deprecation warnings.\n\n\n+1",
    "created_at": "2016-06-01T13:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293799",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:12'></a>> I can put an experimental warning in it: this way, we will be able to move it later on without being worried by deprecation warnings.


+1



---

archive/issue_comments_293800.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T13:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_293801.json:
```json
{
    "body": "<a id='comment:14'></a>I added this experimental warning to the class.\n\nI also added this module in `sage.coding`'s index.",
    "created_at": "2016-06-01T13:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293801",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:14'></a>I added this experimental warning to the class.

I also added this module in `sage.coding`'s index.



---

archive/issue_comments_293802.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-08T16:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293802",
    "user": "https://github.com/arpitdm"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_293803.json:
```json
{
    "body": "<a id='comment:15'></a>I went through the reviewer's checklist and all the tests pass. The naming conventions are quite suitable and make it easier to interpret the functions. Giving it a positive review.",
    "created_at": "2016-06-08T16:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293803",
    "user": "https://github.com/arpitdm"
}
```

<a id='comment:15'></a>I went through the reviewer's checklist and all the tests pass. The naming conventions are quite suitable and make it easier to interpret the functions. Giving it a positive review.



---

archive/issue_events_055042.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-09T16:14:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20284#event-55042"
}
```



---

archive/issue_comments_293804.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-09T16:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293804",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_293805.json:
```json
{
    "body": "<a id='comment:17'></a>Was there ever a follow up ticket created?",
    "created_at": "2017-09-08T09:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293805",
    "user": "https://github.com/koffie"
}
```

<a id='comment:17'></a>Was there ever a follow up ticket created?



---

archive/issue_comments_293806.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 mderickx]:\n> Was there ever a follow up ticket created?\n\n\nI don't think so. At least the code is still there in `sage/coding/relative_finite_field_extension.py`.\n\n<rant start>\nIt is a pitty that this ticket has been merged despite my objections in [comment:7 comment:7]. It should have definitely be a file in `sage/rings/finite_field/` so that people actually working with finite field would have noticed. Putting a blob of general purpose functionalities in a specialized repository is not the way to proceed. People are free to do that on their home git repository but would better avoid such practice in a large public open source software.\n<rant end>",
    "created_at": "2017-09-10T20:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293806",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>Replying to [comment:17 mderickx]:
> Was there ever a follow up ticket created?


I don't think so. At least the code is still there in `sage/coding/relative_finite_field_extension.py`.

<rant start>
It is a pitty that this ticket has been merged despite my objections in [comment:7 comment:7]. It should have definitely be a file in `sage/rings/finite_field/` so that people actually working with finite field would have noticed. Putting a blob of general purpose functionalities in a specialized repository is not the way to proceed. People are free to do that on their home git repository but would better avoid such practice in a large public open source software.
<rant end>



---

archive/issue_comments_293807.json:
```json
{
    "body": "<a id='comment:19'></a>So let's create one: #23828.\n\nThere is also the old and somehow useless #8751.\nAnd related works: https://github.com/wbhart/flint2/issues/366",
    "created_at": "2017-09-11T08:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293807",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:19'></a>So let's create one: #23828.

There is also the old and somehow useless #8751.
And related works: https://github.com/wbhart/flint2/issues/366



---

archive/issue_comments_293808.json:
```json
{
    "body": "<a id='comment:20'></a>The follow-up ticket is #21413. It was created shortly after SD75 following discussion between Xavier Caruso, Luca De Feo, Nicola Thierry, Bruno Grenet and myself. The main difficulty in moving the code to `/sage/rings/` is to find the proper and general interface. Xavier in particular came up with centering these kinds of embeddings around the algebra induced by the field extension `L/K`.\n\nThe ticket #21413 then stalled because of lack of time, I think, and because we hit a snag wrt. implicit coercion vs use of multiplication btw. elements of the `L/K` algebra and elements of `K` leading to (perhaps) unintuitive non-commutative behaviour. See the discussion on that ticket for a more precise description.",
    "created_at": "2017-09-11T08:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293808",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:20'></a>The follow-up ticket is #21413. It was created shortly after SD75 following discussion between Xavier Caruso, Luca De Feo, Nicola Thierry, Bruno Grenet and myself. The main difficulty in moving the code to `/sage/rings/` is to find the proper and general interface. Xavier in particular came up with centering these kinds of embeddings around the algebra induced by the field extension `L/K`.

The ticket #21413 then stalled because of lack of time, I think, and because we hit a snag wrt. implicit coercion vs use of multiplication btw. elements of the `L/K` algebra and elements of `K` leading to (perhaps) unintuitive non-commutative behaviour. See the discussion on that ticket for a more precise description.



---

archive/issue_comments_293809.json:
```json
{
    "body": "<a id='comment:21'></a>Argh then let's already close #23828.",
    "created_at": "2017-09-11T08:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293809",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:21'></a>Argh then let's already close #23828.



---

archive/issue_comments_293810.json:
```json
{
    "body": "<a id='comment:22'></a>See also #24170",
    "created_at": "2017-11-12T11:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20284",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20284#issuecomment-293810",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>See also #24170
