# Issue 20512: 0 by 0 minor of a matrix should belong to the base ring

archive/issues_020275.json:
```json
{
    "body": "This shouldn't return an error:\n\n```\nsage: P.<x,y,z> = ProjectiveSpace(2, QQ)\nsage: X = P.subscheme([])\nsage: X.Jacobian_matrix() # This works\n[]\nsage: X.Jacobian() #This doesn't\n...\nAttributeError: 'sage.rings.integer.Integer' object has no attribute 'reduce'\n```\nI think the mathematically correct answer is that X.Jacobian() should equal the ideal (1). This is consistent with the definition in the docstring:\n\n```\n  * the `d\\times d` minors of the Jacobian matrix, where `d` is\n    the :meth:`codimension` of the algebraic scheme, and\n\n  * the defining polynomials of the algebraic scheme. Note that\n    some authors do not include these in the definition of the\n    Jacobian ideal. An example of a reference that does include\n    the defining equations is [LazarsfeldJacobian].\n```\nIn this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1. And anyway, the Jacobian ideal of the full ambient space should cut out the empty subscheme.\n\n\nKeywords: schemes, Jacobian, matrix, minors\n\nBranch/Commit: 06a432a988286bfae4a86e140e53022a9cbc4fc1\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Kiran Kedlaya\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20512\n\n",
    "closed_at": "2016-05-01T16:30:29Z",
    "created_at": "2016-04-27T23:09:06Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "0 by 0 minor of a matrix should belong to the base ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20512",
    "user": "https://github.com/kedlaya"
}
```
This shouldn't return an error:

```
sage: P.<x,y,z> = ProjectiveSpace(2, QQ)
sage: X = P.subscheme([])
sage: X.Jacobian_matrix() # This works
[]
sage: X.Jacobian() #This doesn't
...
AttributeError: 'sage.rings.integer.Integer' object has no attribute 'reduce'
```
I think the mathematically correct answer is that X.Jacobian() should equal the ideal (1). This is consistent with the definition in the docstring:

```
  * the `d\times d` minors of the Jacobian matrix, where `d` is
    the :meth:`codimension` of the algebraic scheme, and

  * the defining polynomials of the algebraic scheme. Note that
    some authors do not include these in the definition of the
    Jacobian ideal. An example of a reference that does include
    the defining equations is [LazarsfeldJacobian].
```
In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1. And anyway, the Jacobian ideal of the full ambient space should cut out the empty subscheme.


Keywords: schemes, Jacobian, matrix, minors

Branch/Commit: 06a432a988286bfae4a86e140e53022a9cbc4fc1

Reviewer: Frédéric Chapoton

Author: Kiran Kedlaya

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20512





---

archive/issue_comments_372517.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n ...\n AttributeError: 'sage.rings.integer.Integer' object has no attribute 'reduce'\n ```\n-I think the mathematically correct answer is that X.Jacobian() should again equal X (i.e., P viewed as a closed subscheme of itself). However, this is not consistent with the definition in the docstring:\n+I think the mathematically correct answer is that X.Jacobian() should equal the ideal (1). This is consistent with the definition in the docstring:\n \n ```\n   * the `d\\times d` minors of the Jacobian matrix, where `d` is\n@@ -20,4 +20,4 @@\n     Jacobian ideal. An example of a reference that does include\n     the defining equations is [LazarsfeldJacobian].\n ```\n-In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1.\n+In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1. And anyway, the Jacobian ideal of the full ambient space should cut out the empty subscheme.\n``````\n",
    "created_at": "2016-04-27T23:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372517",
    "user": "https://github.com/kedlaya"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 ...
 AttributeError: 'sage.rings.integer.Integer' object has no attribute 'reduce'
 ```
-I think the mathematically correct answer is that X.Jacobian() should again equal X (i.e., P viewed as a closed subscheme of itself). However, this is not consistent with the definition in the docstring:
+I think the mathematically correct answer is that X.Jacobian() should equal the ideal (1). This is consistent with the definition in the docstring:
 
 ```
   * the `d\times d` minors of the Jacobian matrix, where `d` is
@@ -20,4 +20,4 @@
     Jacobian ideal. An example of a reference that does include
     the defining equations is [LazarsfeldJacobian].
 ```
-In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1.
+In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1. And anyway, the Jacobian ideal of the full ambient space should cut out the empty subscheme.
``````




---

archive/issue_comments_372518.json:
```json
{
    "body": "Changing keywords from \"schemes, Jacobian\" to \"schemes, Jacobian, matrix, minors\".",
    "created_at": "2016-04-27T23:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372518",
    "user": "https://github.com/kedlaya"
}
```

Changing keywords from "schemes, Jacobian" to "schemes, Jacobian, matrix, minors".



---

archive/issue_comments_372519.json:
```json
{
    "body": "<a id='comment:2'></a>In fact, the problem seems to be that the 0 by 0 minor of a matrix is returned as 1 in the ring of integers, not the base ring of the matrix. Retitled and reclassified accordingly.",
    "created_at": "2016-04-27T23:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372519",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:2'></a>In fact, the problem seems to be that the 0 by 0 minor of a matrix is returned as 1 in the ring of integers, not the base ring of the matrix. Retitled and reclassified accordingly.



---

archive/issue_comments_372520.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,4 @@\n     the defining equations is [LazarsfeldJacobian].\n ```\n In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1. And anyway, the Jacobian ideal of the full ambient space should cut out the empty subscheme.\n+\n``````\n",
    "created_at": "2016-04-27T23:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372520",
    "user": "https://github.com/kedlaya"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,4 @@
     the defining equations is [LazarsfeldJacobian].
 ```
 In this case d=0, and the unique 0 by 0 minor of any matrix (empty or not) is equal to 1. And anyway, the Jacobian ideal of the full ambient space should cut out the empty subscheme.
+
``````




---

archive/issue_comments_372521.json:
```json
{
    "body": "Changing component from algebraic geometry to linear algebra.",
    "created_at": "2016-04-27T23:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372521",
    "user": "https://github.com/kedlaya"
}
```

Changing component from algebraic geometry to linear algebra.



---

archive/issue_comments_372522.json:
```json
{
    "body": "Changing branch from \"\" to \"u/kedlaya/jacobian_of_the_tautologous_subscheme_of_a_toric_variety_is_broken\"",
    "created_at": "2016-04-28T00:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372522",
    "user": "https://github.com/kedlaya"
}
```

Changing branch from "" to "u/kedlaya/jacobian_of_the_tautologous_subscheme_of_a_toric_variety_is_broken"



---

archive/issue_comments_372523.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-28T00:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372523",
    "user": "https://github.com/kedlaya"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_372524.json:
```json
{
    "body": "Changing commit from \"\" to \"d2f604fa8ae2d4b16b4f3f38b4abd078268de401\"",
    "created_at": "2016-04-28T00:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372524",
    "user": "https://github.com/kedlaya"
}
```

Changing commit from "" to "d2f604fa8ae2d4b16b4f3f38b4abd078268de401"



---

archive/issue_comments_372525.json:
```json
{
    "body": "<a id='comment:4'></a>I changed matrix/matrix2.pyx to fix the underlying issue with minors, and added a doctest to schemes/generic/algebraic_scheme.py to confirm that Jacobian is no longer broken.\n\n---\nNew commits:",
    "created_at": "2016-04-28T00:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372525",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:4'></a>I changed matrix/matrix2.pyx to fix the underlying issue with minors, and added a doctest to schemes/generic/algebraic_scheme.py to confirm that Jacobian is no longer broken.

---
New commits:



---

archive/issue_comments_372526.json:
```json
{
    "body": "Changing author from \"\" to \"Kiran Kedlaya\"",
    "created_at": "2016-04-28T00:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372526",
    "user": "https://github.com/kedlaya"
}
```

Changing author from "" to "Kiran Kedlaya"



---

archive/issue_comments_372527.json:
```json
{
    "body": "<a id='comment:5'></a>* doc is not formatted correctly, the line before the tests should end with `::` and be followed by a blank line\n\n* please also use `:trac:`20512`` instead of the bare `#20512`\n\n* you should rather use `.base_ring().one()` instead of `.base_ring()(1)`",
    "created_at": "2016-04-28T07:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372527",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>* doc is not formatted correctly, the line before the tests should end with `::` and be followed by a blank line

* please also use `:trac:`20512`` instead of the bare `#20512`

* you should rather use `.base_ring().one()` instead of `.base_ring()(1)`



---

archive/issue_comments_372528.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-28T15:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372528",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_372529.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-28T18:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372529",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372530.json:
```json
{
    "body": "Changing commit from \"d2f604fa8ae2d4b16b4f3f38b4abd078268de401\" to \"06a432a988286bfae4a86e140e53022a9cbc4fc1\"",
    "created_at": "2016-04-28T18:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372530",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d2f604fa8ae2d4b16b4f3f38b4abd078268de401" to "06a432a988286bfae4a86e140e53022a9cbc4fc1"



---

archive/issue_comments_372531.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:5 chapoton]:\n> * doc is not formatted correctly, the line before the tests should end with `::` and be followed by a blank line\n> \n> * please also use `:trac:`20512`` instead of the bare `#20512`\n> \n> * you should rather use `.base_ring().one()` instead of `.base_ring()(1)`\n> \n \nAll done. Also, I noticed that my fix wasn't actually sufficient: in `algebraic_scheme`, the `Jacobian_matrix()` method also needs to be forced to produce a matrix in the correct ring. The last commit does this.",
    "created_at": "2016-04-28T18:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372531",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:8'></a>Replying to [comment:5 chapoton]:
> * doc is not formatted correctly, the line before the tests should end with `::` and be followed by a blank line
> 
> * please also use `:trac:`20512`` instead of the bare `#20512`
> 
> * you should rather use `.base_ring().one()` instead of `.base_ring()(1)`
> 
 
All done. Also, I noticed that my fix wasn't actually sufficient: in `algebraic_scheme`, the `Jacobian_matrix()` method also needs to be forced to produce a matrix in the correct ring. The last commit does this.



---

archive/issue_comments_372532.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-28T18:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372532",
    "user": "https://github.com/kedlaya"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372533.json:
```json
{
    "body": "<a id='comment:10'></a>ok, thanks. Good to go.",
    "created_at": "2016-04-29T06:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372533",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>ok, thanks. Good to go.



---

archive/issue_comments_372534.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2016-04-29T06:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372534",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton"



---

archive/issue_comments_372535.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-29T06:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372535",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_372536.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-01T16:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372536",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_055406.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-01T16:30:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20512#event-55406"
}
```



---

archive/issue_comments_372537.json:
```json
{
    "body": "Changing branch from \"u/kedlaya/jacobian_of_the_tautologous_subscheme_of_a_toric_variety_is_broken\" to \"06a432a988286bfae4a86e140e53022a9cbc4fc1\"",
    "created_at": "2016-05-01T16:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20512",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20512#issuecomment-372537",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/kedlaya/jacobian_of_the_tautologous_subscheme_of_a_toric_variety_is_broken" to "06a432a988286bfae4a86e140e53022a9cbc4fc1"
