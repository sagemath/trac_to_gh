# Issue 20690: Live documentation in Jupyter using Thebe

archive/issues_020453.json:
```json
{
    "assignees": [],
    "body": "Thebe is a Jupyter javascript plugin for static sites that allows for\nrendering selected divs of the HTML as live cells connected to a\nJupyter server:\n\n  https://oreillymedia.github.io/thebe/\n\nThe goal of this ticket is to use this technology to implement live\ndocumentation in the Jupyter notebook as we had in the legacy Sage\nnotebook.\n\nKudos to Rob Beezer for pointing us to Thebe in his presentation of\nMathBookXML at Sage Days 77.\n\nSteps:\n- [X] Configure Sphinx to add the Thebe javascript library in the static page\n- [X] Configure Sphinx to add a small header to our html page with:\n  - [X] Inclusion of the Thebe javascript\n  - [X] Thebe configuration: which divs to make live\n\n    Currently, we include all <pre> tags that contain the \"sage:\" prompt.\n\n    TODO: shall we change to <pre> tags that start with the \"sage:\" prompt?\n\nTODO:\n- [X] Only activate Thebe if the page is served by a Jupyter instance\n\n  Currently we check that the protocol is http\n- [X] A button to activate live cells\n- [X] Configure the Jupyter notebook in Sage to somehow provide the\n  server configuration to Thebe (not needed in fact)\n- [X] Preparse or customize/configure Thebe to support Sage's doctest syntax:\n  - [X] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n  - [X] Strip out the outputs\n\n    Bonus: show the included outputs below the cell until the new output is computed\n\n    What's been done here is: output is show until the \"activate\" button is clicked.\n\n- [X] Support doctests with several commands by spliting into several cells\n- [X] Ship Thebe from a dedicated spkg (#21309).\n\nThis ticket solves #17269. Follow-up ticket for possible improvements: #20893.\n\n\nDepends on #21309\n\nCC:  @videlec @vbraun @rbeezer @slel @sagetrac-tmonteil\n\nKeywords: **days77, jupyter, thebe, notebook, sd75**\n\nBranch: **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)**\n\nReviewer: **Vincent Delecroix, Thierry Monteil**\n\nAuthor: **Florent Cayr\u00e9, Nicolas M. Thi\u00e9ry**\n\nComponent: **documentation**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20690_\n\n",
    "closed_at": "2016-09-10T09:00:23Z",
    "created_at": "2016-05-27T08:42:15Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20documentation",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Live documentation in Jupyter using Thebe",
    "type": "issue",
    "updated_at": "2017-02-27T11:58:29Z",
    "url": "https://github.com/sagemath/sage/issues/20690",
    "user": "https://github.com/nthiery"
}
```
Thebe is a Jupyter javascript plugin for static sites that allows for
rendering selected divs of the HTML as live cells connected to a
Jupyter server:

  https://oreillymedia.github.io/thebe/

The goal of this ticket is to use this technology to implement live
documentation in the Jupyter notebook as we had in the legacy Sage
notebook.

Kudos to Rob Beezer for pointing us to Thebe in his presentation of
MathBookXML at Sage Days 77.

Steps:
- [X] Configure Sphinx to add the Thebe javascript library in the static page
- [X] Configure Sphinx to add a small header to our html page with:
  - [X] Inclusion of the Thebe javascript
  - [X] Thebe configuration: which divs to make live

    Currently, we include all <pre> tags that contain the "sage:" prompt.

    TODO: shall we change to <pre> tags that start with the "sage:" prompt?

TODO:
- [X] Only activate Thebe if the page is served by a Jupyter instance

  Currently we check that the protocol is http
- [X] A button to activate live cells
- [X] Configure the Jupyter notebook in Sage to somehow provide the
  server configuration to Thebe (not needed in fact)
- [X] Preparse or customize/configure Thebe to support Sage's doctest syntax:
  - [X] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
  - [X] Strip out the outputs

    Bonus: show the included outputs below the cell until the new output is computed

    What's been done here is: output is show until the "activate" button is clicked.

- [X] Support doctests with several commands by spliting into several cells
- [X] Ship Thebe from a dedicated spkg (#21309).

This ticket solves #17269. Follow-up ticket for possible improvements: #20893.


Depends on #21309

CC:  @videlec @vbraun @rbeezer @slel @sagetrac-tmonteil

Keywords: **days77, jupyter, thebe, notebook, sd75**

Branch: **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)**

Reviewer: **Vincent Delecroix, Thierry Monteil**

Author: **Florent Cayré, Nicolas M. Thiéry**

Component: **documentation**

_Issue created by migration from https://trac.sagemath.org/ticket/20690_





---

archive/issue_events_288726.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-27T08:42:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288726"
}
```



---

archive/issue_events_288727.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-27T08:42:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288727"
}
```



---

archive/issue_events_288728.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-27T08:42:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288728"
}
```



---

archive/issue_events_288729.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-27T08:42:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288729"
}
```



---

archive/issue_comments_299229.json:
```json
{
    "body": "Branch: **[u/nthiery/live_documentation_in_jupyter_using_thebe](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/live_documentation_in_jupyter_using_thebe)**",
    "created_at": "2016-05-27T08:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299229",
    "user": "https://github.com/nthiery"
}
```

Branch: **[u/nthiery/live_documentation_in_jupyter_using_thebe](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/live_documentation_in_jupyter_using_thebe)**



---

archive/issue_comments_299230.json:
```json
{
    "body": "Changed branch from **[u/nthiery/live_documentation_in_jupyter_using_thebe](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/live_documentation_in_jupyter_using_thebe)** to **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)**",
    "created_at": "2016-05-27T08:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299230",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[u/nthiery/live_documentation_in_jupyter_using_thebe](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/live_documentation_in_jupyter_using_thebe)** to **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)**



---

archive/issue_comments_299231.json:
```json
{
    "body": "Commit: **[`19f31f8`](https://github.com/sagemath/sagetrac-mirror/commit/19f31f8567ac77094d2ee483e7adf9d6963a8dd7)**",
    "created_at": "2016-05-27T09:07:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299231",
    "user": "https://github.com/nthiery"
}
```

Commit: **[`19f31f8`](https://github.com/sagemath/sagetrac-mirror/commit/19f31f8567ac77094d2ee483e7adf9d6963a8dd7)**



---

archive/issue_comments_299232.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,18 @@\n+Thebe is a Jupyter javascript plugin for static sites that allows for rendering selected divs of the HTML as live cells connected to a Jupyter server:\n \n+  https://oreillymedia.github.io/thebe/\n+\n+The idea is to use this technology to make\n+\n+Steps:\n+- Configure Sphinx to add the Thebe javascript library in the static page\n+- Configure Sphinx to add a small header to our html page with:\n+  - Inclusion of the Thebe javascript\n+  - Thebe configuration: which divs to make live, which server to use\n+  - A button to turn on live cells\n+  - Possibly a menu or other widgets for user customization of the server configuration\n+- Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.\n+- Customize/configure Thebe to support Sage's doctest syntax:\n+  - Stripping out the prompts\n+  - Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)\n+  - Bonus: support doctests with several commands by split into several cells \n``````\n",
    "created_at": "2016-05-27T09:07:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299232",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,18 @@
+Thebe is a Jupyter javascript plugin for static sites that allows for rendering selected divs of the HTML as live cells connected to a Jupyter server:
 
+  https://oreillymedia.github.io/thebe/
+
+The idea is to use this technology to make
+
+Steps:
+- Configure Sphinx to add the Thebe javascript library in the static page
+- Configure Sphinx to add a small header to our html page with:
+  - Inclusion of the Thebe javascript
+  - Thebe configuration: which divs to make live, which server to use
+  - A button to turn on live cells
+  - Possibly a menu or other widgets for user customization of the server configuration
+- Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.
+- Customize/configure Thebe to support Sage's doctest syntax:
+  - Stripping out the prompts
+  - Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)
+  - Bonus: support doctests with several commands by split into several cells 
``````




---

archive/issue_comments_299233.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19f31f8567ac77094d2ee483e7adf9d6963a8dd7\"><code>19f31f8</code></a></td><td><code>20690: added some examples of sage code in a fast-to-compile document. DONT MERGE IN SAGE</code></td></tr></table>\n",
    "created_at": "2016-05-27T09:07:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299233",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19f31f8567ac77094d2ee483e7adf9d6963a8dd7"><code>19f31f8</code></a></td><td><code>20690: added some examples of sage code in a fast-to-compile document. DONT MERGE IN SAGE</code></td></tr></table>




---

archive/issue_events_288730.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2016-05-27T09:07:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "title_is": "Live documentation in Jupyter using Thebe",
    "title_was": "Live documentation in Jupyter using thebe",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288730"
}
```



---

archive/issue_comments_299234.json:
```json
{
    "body": "Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)** to **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)**",
    "created_at": "2016-05-27T09:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299234",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)** to **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)**



---

archive/issue_comments_299235.json:
```json
{
    "body": "Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)** to **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)**",
    "created_at": "2016-05-27T09:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299235",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)** to **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)**



---

archive/issue_comments_299236.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe current branch is not to be merged in Sage, as it contains some edits in the Sage's faq that are just here for quick testing (compiling the faq is fast!).",
    "created_at": "2016-05-27T09:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299236",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:5" align="right">comment:5</div>

The current branch is not to be merged in Sage, as it contains some edits in the Sage's faq that are just here for quick testing (compiling the faq is fast!).



---

archive/issue_comments_299237.json:
```json
{
    "body": "Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)** to **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)**",
    "created_at": "2016-05-27T13:03:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299237",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690)** to **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)**



---

archive/issue_comments_299238.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,14 +5,14 @@\n The idea is to use this technology to make\n \n Steps:\n-- Configure Sphinx to add the Thebe javascript library in the static page\n-- Configure Sphinx to add a small header to our html page with:\n-  - Inclusion of the Thebe javascript\n-  - Thebe configuration: which divs to make live, which server to use\n-  - A button to turn on live cells\n-  - Possibly a menu or other widgets for user customization of the server configuration\n-- Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.\n+- [X] Configure Sphinx to add the Thebe javascript library in the static page\n+- [/] Configure Sphinx to add a small header to our html page with:\n+  - [X] Inclusion of the Thebe javascript\n+  - [ ] Thebe configuration: which divs to make live, which server to use\n+  - [ ] A button to activate live cells\n+  - [ ] Possibly a menu or other widgets for user customization of the server configuration\n+- [?] Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.\n - Customize/configure Thebe to support Sage's doctest syntax:\n-  - Stripping out the prompts\n-  - Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)\n-  - Bonus: support doctests with several commands by split into several cells \n+  - [ ] Stripping out the prompts\n+  - [ ] Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)\n+  - [ ] Support doctests with several commands by split into several cells \n``````\n",
    "created_at": "2016-05-27T13:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299238",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,14 +5,14 @@
 The idea is to use this technology to make
 
 Steps:
-- Configure Sphinx to add the Thebe javascript library in the static page
-- Configure Sphinx to add a small header to our html page with:
-  - Inclusion of the Thebe javascript
-  - Thebe configuration: which divs to make live, which server to use
-  - A button to turn on live cells
-  - Possibly a menu or other widgets for user customization of the server configuration
-- Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.
+- [X] Configure Sphinx to add the Thebe javascript library in the static page
+- [/] Configure Sphinx to add a small header to our html page with:
+  - [X] Inclusion of the Thebe javascript
+  - [ ] Thebe configuration: which divs to make live, which server to use
+  - [ ] A button to activate live cells
+  - [ ] Possibly a menu or other widgets for user customization of the server configuration
+- [?] Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.
 - Customize/configure Thebe to support Sage's doctest syntax:
-  - Stripping out the prompts
-  - Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)
-  - Bonus: support doctests with several commands by split into several cells 
+  - [ ] Stripping out the prompts
+  - [ ] Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)
+  - [ ] Support doctests with several commands by split into several cells 
``````




---

archive/issue_comments_299239.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,13 +6,18 @@\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n-- [/] Configure Sphinx to add a small header to our html page with:\n+- [ / ] Configure Sphinx to add a small header to our html page with:\n   - [X] Inclusion of the Thebe javascript\n-  - [ ] Thebe configuration: which divs to make live, which server to use\n-  - [ ] A button to activate live cells\n+  - [x] Thebe configuration: which divs to make live\n+        Currently, we include all <pre> tags that contain sage:\n+  - [ ] Thebe configuration: use the Jupyter instance serving the page\n+        We use window.location.origin; is this the right thing to do?\n+  - [ ] Only activate Thebe if running inside a Jupyter server\n+  - [x] A button to activate live cells\n   - [ ] Possibly a menu or other widgets for user customization of the server configuration\n - [?] Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.\n - Customize/configure Thebe to support Sage's doctest syntax:\n   - [ ] Stripping out the prompts\n   - [ ] Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)\n-  - [ ] Support doctests with several commands by split into several cells \n+  - [ ] Support doctests with several commands by spliting into several cells\n+\n``````\n",
    "created_at": "2016-05-27T15:10:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299239",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,13 +6,18 @@
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
-- [/] Configure Sphinx to add a small header to our html page with:
+- [ / ] Configure Sphinx to add a small header to our html page with:
   - [X] Inclusion of the Thebe javascript
-  - [ ] Thebe configuration: which divs to make live, which server to use
-  - [ ] A button to activate live cells
+  - [x] Thebe configuration: which divs to make live
+        Currently, we include all <pre> tags that contain sage:
+  - [ ] Thebe configuration: use the Jupyter instance serving the page
+        We use window.location.origin; is this the right thing to do?
+  - [ ] Only activate Thebe if running inside a Jupyter server
+  - [x] A button to activate live cells
   - [ ] Possibly a menu or other widgets for user customization of the server configuration
 - [?] Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.
 - Customize/configure Thebe to support Sage's doctest syntax:
   - [ ] Stripping out the prompts
   - [ ] Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)
-  - [ ] Support doctests with several commands by split into several cells 
+  - [ ] Support doctests with several commands by spliting into several cells
+
``````




---

archive/issue_comments_299240.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5016cd83634381cd6be0f42154ea759744a7b272\"><code>5016cd8</code></a></td><td><code>20690: First implementation of a live documentation in Jupyter using Thebe</code></td></tr></table>\n",
    "created_at": "2016-05-27T15:43:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299240",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5016cd83634381cd6be0f42154ea759744a7b272"><code>5016cd8</code></a></td><td><code>20690: First implementation of a live documentation in Jupyter using Thebe</code></td></tr></table>




---

archive/issue_comments_299241.json:
```json
{
    "body": "Changed commit from **[`19f31f8`](https://github.com/sagemath/sagetrac-mirror/commit/19f31f8567ac77094d2ee483e7adf9d6963a8dd7)** to **[`5016cd8`](https://github.com/sagemath/sagetrac-mirror/commit/5016cd83634381cd6be0f42154ea759744a7b272)**",
    "created_at": "2016-05-27T15:43:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299241",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`19f31f8`](https://github.com/sagemath/sagetrac-mirror/commit/19f31f8567ac77094d2ee483e7adf9d6963a8dd7)** to **[`5016cd8`](https://github.com/sagemath/sagetrac-mirror/commit/5016cd83634381cd6be0f42154ea759744a7b272)**



---

archive/issue_comments_299242.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,23 +1,82 @@\n-Thebe is a Jupyter javascript plugin for static sites that allows for rendering selected divs of the HTML as live cells connected to a Jupyter server:\n+Thebe is a Jupyter javascript plugin for static sites that allows for\n+rendering selected divs of the HTML as live cells connected to a\n+Jupyter server:\n \n   https://oreillymedia.github.io/thebe/\n \n-The idea is to use this technology to make\n+The goal of this ticket is to use this technology to implement live\n+documentation in the Jupyter notebook as we had in the legacy Sage\n+notebook.\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n - [ / ] Configure Sphinx to add a small header to our html page with:\n   - [X] Inclusion of the Thebe javascript\n   - [x] Thebe configuration: which divs to make live\n-        Currently, we include all <pre> tags that contain sage:\n+        Currently, we include all <pre> tags that contain the \"sage:\" prompt\n+        TODO: shall we change to <pre> tags that start with the \"sage:\" prompt ?\n   - [ ] Thebe configuration: use the Jupyter instance serving the page\n-        We use window.location.origin; is this the right thing to do?\n-  - [ ] Only activate Thebe if running inside a Jupyter server\n+        We currently use window.location.origin; is this the right thing to do?\n+  - [x] Only activate Thebe if the page is served by a Jupyter instance\n+        Currently we check that the protocol is http\n   - [x] A button to activate live cells\n-  - [ ] Possibly a menu or other widgets for user customization of the server configuration\n-- [?] Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.\n-- Customize/configure Thebe to support Sage's doctest syntax:\n-  - [ ] Stripping out the prompts\n-  - [ ] Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)\n+\n+- [X] Configure the Jupyter notebook in Sage to somehow provide the\n+      server configuration to Thebe (not needed in fact)\n+\n+- Preparse or customize/configure Thebe to support Sage's doctest syntax:\n+  - [ ] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n+  - [ ] Strip out the outputs\n+        Bonus: show the included outputs below the cell until the new output is computed\n   - [ ] Support doctests with several commands by spliting into several cells\n \n+- Check what's the right way for including thebe.js in the Sage\n+  sources. Should we have a spkg? (to be discussed at Sage Days 74\n+  with Volker).\n+\n+Steps for later tickets:\n+\n+- [ ] Currently it takes 10s for 100 prompts while some sage files\n+      contain up to 1000 prompts. Profile Thebe and optimize it or use\n+      a separate thread to properly support large files.\n+\n+- [ ] Expand the activate button with a menu or other widgets for user\n+      customization of the Jupyter server. This typically would\n+      let the user choose between:\n+      - tmpnb (will only be useful for Sage when tmpnb will include a\n+        Sage kernel)\n+      - A local Jupyter server\n+      - Whichever Jupyter server the browser is currently connected to?\n+      - a user specified server\n+\n+- [ ] Check whether Jupyter could be configured to dynamically\n+      negotiate incoming connections that don't fall within the\n+      -NotebookApp.allow_origin pattern, by opening a user dialog such\n+      as \"Page xxx requests starting a new kernel on this server; do\n+      you accept? yes/no/always for this site\"\n+\n+- [ ] Add support in Thebe for customizable (continuation) prompts, with\n+      striping and splitting as above, and automatic setting of the kernel.\n+      The customization option could look like:\n+\n+      ```\n+         prompts = {\n+            \"sage: \": {continuations=[\"....:\", \"...  \"], kernel=\"sagemath\"},\n+            \">>>> \": {continuation=\"...  \", kernel=\"python\"}\n+         }\n+      ```\n+\n+- [ ] Contribute support for Thebe upstream in Sphinx, with:\n+\n+      - [ ] Explicit markup to specify which code blocks are editable\n+            and with which kernel, or setup kernel auto-detection from\n+            the prompt.\n+\n+      - [ ] The possibility for setting a default value for the above\n+\n+- [ ] Refactor the Sage sphinx configuration to use the above\n+\n+- [ ] Add support in Thebe for basic export to Jupyter notebooks. A\n+      quality loss (in particular in terms of the hierarchical\n+      structure) is acceptable.\n+\n``````\n",
    "created_at": "2016-05-28T09:10:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299242",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,23 +1,82 @@
-Thebe is a Jupyter javascript plugin for static sites that allows for rendering selected divs of the HTML as live cells connected to a Jupyter server:
+Thebe is a Jupyter javascript plugin for static sites that allows for
+rendering selected divs of the HTML as live cells connected to a
+Jupyter server:
 
   https://oreillymedia.github.io/thebe/
 
-The idea is to use this technology to make
+The goal of this ticket is to use this technology to implement live
+documentation in the Jupyter notebook as we had in the legacy Sage
+notebook.
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
 - [ / ] Configure Sphinx to add a small header to our html page with:
   - [X] Inclusion of the Thebe javascript
   - [x] Thebe configuration: which divs to make live
-        Currently, we include all <pre> tags that contain sage:
+        Currently, we include all <pre> tags that contain the "sage:" prompt
+        TODO: shall we change to <pre> tags that start with the "sage:" prompt ?
   - [ ] Thebe configuration: use the Jupyter instance serving the page
-        We use window.location.origin; is this the right thing to do?
-  - [ ] Only activate Thebe if running inside a Jupyter server
+        We currently use window.location.origin; is this the right thing to do?
+  - [x] Only activate Thebe if the page is served by a Jupyter instance
+        Currently we check that the protocol is http
   - [x] A button to activate live cells
-  - [ ] Possibly a menu or other widgets for user customization of the server configuration
-- [?] Configure the Jupyter notebook in Sage to somehow provide the server configuration to Thebe.
-- Customize/configure Thebe to support Sage's doctest syntax:
-  - [ ] Stripping out the prompts
-  - [ ] Stripping out the included outputs (bonus: show the included outputs below the cell until the new output is computed)
+
+- [X] Configure the Jupyter notebook in Sage to somehow provide the
+      server configuration to Thebe (not needed in fact)
+
+- Preparse or customize/configure Thebe to support Sage's doctest syntax:
+  - [ ] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
+  - [ ] Strip out the outputs
+        Bonus: show the included outputs below the cell until the new output is computed
   - [ ] Support doctests with several commands by spliting into several cells
 
+- Check what's the right way for including thebe.js in the Sage
+  sources. Should we have a spkg? (to be discussed at Sage Days 74
+  with Volker).
+
+Steps for later tickets:
+
+- [ ] Currently it takes 10s for 100 prompts while some sage files
+      contain up to 1000 prompts. Profile Thebe and optimize it or use
+      a separate thread to properly support large files.
+
+- [ ] Expand the activate button with a menu or other widgets for user
+      customization of the Jupyter server. This typically would
+      let the user choose between:
+      - tmpnb (will only be useful for Sage when tmpnb will include a
+        Sage kernel)
+      - A local Jupyter server
+      - Whichever Jupyter server the browser is currently connected to?
+      - a user specified server
+
+- [ ] Check whether Jupyter could be configured to dynamically
+      negotiate incoming connections that don't fall within the
+      -NotebookApp.allow_origin pattern, by opening a user dialog such
+      as "Page xxx requests starting a new kernel on this server; do
+      you accept? yes/no/always for this site"
+
+- [ ] Add support in Thebe for customizable (continuation) prompts, with
+      striping and splitting as above, and automatic setting of the kernel.
+      The customization option could look like:
+
+      ```
+         prompts = {
+            "sage: ": {continuations=["....:", "...  "], kernel="sagemath"},
+            ">>>> ": {continuation="...  ", kernel="python"}
+         }
+      ```
+
+- [ ] Contribute support for Thebe upstream in Sphinx, with:
+
+      - [ ] Explicit markup to specify which code blocks are editable
+            and with which kernel, or setup kernel auto-detection from
+            the prompt.
+
+      - [ ] The possibility for setting a default value for the above
+
+- [ ] Refactor the Sage sphinx configuration to use the above
+
+- [ ] Add support in Thebe for basic export to Jupyter notebooks. A
+      quality loss (in particular in terms of the hierarchical
+      structure) is acceptable.
+
``````




---

archive/issue_comments_299243.json:
```json
{
    "body": "Changed keywords from none to **days77, jupyter, thebe, notebook**",
    "created_at": "2016-05-28T09:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299243",
    "user": "https://github.com/nthiery"
}
```

Changed keywords from none to **days77, jupyter, thebe, notebook**



---

archive/issue_comments_299244.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,6 +7,8 @@\n The goal of this ticket is to use this technology to implement live\n documentation in the Jupyter notebook as we had in the legacy Sage\n notebook.\n+\n+Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML.\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n``````\n",
    "created_at": "2016-05-28T09:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299244",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,6 +7,8 @@
 The goal of this ticket is to use this technology to implement live
 documentation in the Jupyter notebook as we had in the legacy Sage
 notebook.
+
+Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML.
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
``````




---

archive/issue_comments_299245.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n documentation in the Jupyter notebook as we had in the legacy Sage\n notebook.\n \n-Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML.\n+Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n``````\n",
    "created_at": "2016-05-28T09:14:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299245",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 documentation in the Jupyter notebook as we had in the legacy Sage
 notebook.
 
-Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML.
+Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
``````




---

archive/issue_comments_299246.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32c9e6426cc1dd492590f89d94b2329d7c78b507\"><code>32c9e64</code></a></td><td><code>20690: Only show the activate button when there are cells to be activated</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d6aaed29f9b8dedecdec37589893c9877e94785a\"><code>d6aaed2</code></a></td><td><code>20690: Disable the activate button once clicked</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5e95e47d85a743c30b498f13823080bbf532ad4\"><code>b5e95e4</code></a></td><td><code>20690: Factor out a thebe-sage setup function before complexifying it for upcoming functionalities</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07035fd4b6db42b55131c19026f274e4e624f33b\"><code>07035fd</code></a></td><td><code>20690: On live doc activation, hide expected results and add a Run button before them</code></td></tr></table>\n",
    "created_at": "2016-06-15T20:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299246",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32c9e6426cc1dd492590f89d94b2329d7c78b507"><code>32c9e64</code></a></td><td><code>20690: Only show the activate button when there are cells to be activated</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d6aaed29f9b8dedecdec37589893c9877e94785a"><code>d6aaed2</code></a></td><td><code>20690: Disable the activate button once clicked</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5e95e47d85a743c30b498f13823080bbf532ad4"><code>b5e95e4</code></a></td><td><code>20690: Factor out a thebe-sage setup function before complexifying it for upcoming functionalities</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07035fd4b6db42b55131c19026f274e4e624f33b"><code>07035fd</code></a></td><td><code>20690: On live doc activation, hide expected results and add a Run button before them</code></td></tr></table>




---

archive/issue_comments_299247.json:
```json
{
    "body": "Changed commit from **[`5016cd8`](https://github.com/sagemath/sagetrac-mirror/commit/5016cd83634381cd6be0f42154ea759744a7b272)** to **[`07035fd`](https://github.com/sagemath/sagetrac-mirror/commit/07035fd4b6db42b55131c19026f274e4e624f33b)**",
    "created_at": "2016-06-15T20:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299247",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5016cd8`](https://github.com/sagemath/sagetrac-mirror/commit/5016cd83634381cd6be0f42154ea759744a7b272)** to **[`07035fd`](https://github.com/sagemath/sagetrac-mirror/commit/07035fd4b6db42b55131c19026f274e4e624f33b)**



---

archive/issue_comments_299248.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nEverything seems to work (nice!). Some naive questions from a user point of view:\n\n- would it be possible to remove the \"sage: \" string in the cells? It would be convenient since it perturb the editor. It would even be worse with the continuation \"....:\" since these are not ignored by the sage preparser...\n\nLess importantly:\n\n- why did you decide to have this \"Run\" and \"Run Again\" buttons? These do not exist in the standard Jupyter notebook. Would it be possible to simply remove them?\n\n- the cells are properly executed when pressing \"Shift + Enter\" but, contrarily to the case of the notebook, after pressing \"Shift + Enter\" the focus is kept in the same cell. Not sure that it is desirable to move the focus (since the next cell might be very far).",
    "created_at": "2016-06-27T08:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299248",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

Everything seems to work (nice!). Some naive questions from a user point of view:

- would it be possible to remove the "sage: " string in the cells? It would be convenient since it perturb the editor. It would even be worse with the continuation "....:" since these are not ignored by the sage preparser...

Less importantly:

- why did you decide to have this "Run" and "Run Again" buttons? These do not exist in the standard Jupyter notebook. Would it be possible to simply remove them?

- the cells are properly executed when pressing "Shift + Enter" but, contrarily to the case of the notebook, after pressing "Shift + Enter" the focus is kept in the same cell. Not sure that it is desirable to move the focus (since the next cell might be very far).



---

archive/issue_comments_299249.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,31 +12,32 @@\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n-- [ / ] Configure Sphinx to add a small header to our html page with:\n+- [X] Configure Sphinx to add a small header to our html page with:\n   - [X] Inclusion of the Thebe javascript\n-  - [x] Thebe configuration: which divs to make live\n+  - [X] Thebe configuration: which divs to make live\n         Currently, we include all <pre> tags that contain the \"sage:\" prompt\n         TODO: shall we change to <pre> tags that start with the \"sage:\" prompt ?\n-  - [ ] Thebe configuration: use the Jupyter instance serving the page\n-        We currently use window.location.origin; is this the right thing to do?\n-  - [x] Only activate Thebe if the page is served by a Jupyter instance\n-        Currently we check that the protocol is http\n-  - [x] A button to activate live cells\n+to do?\n+- [X] Only activate Thebe if the page is served by a Jupyter instance\n+      Currently we check that the protocol is http\n+- [X] A button to activate live cells\n \n - [X] Configure the Jupyter notebook in Sage to somehow provide the\n       server configuration to Thebe (not needed in fact)\n \n - Preparse or customize/configure Thebe to support Sage's doctest syntax:\n   - [ ] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n-  - [ ] Strip out the outputs\n+  - [X] Strip out the outputs\n         Bonus: show the included outputs below the cell until the new output is computed\n-  - [ ] Support doctests with several commands by spliting into several cells\n+  - [X] Support doctests with several commands by spliting into several cells\n \n - Check what's the right way for including thebe.js in the Sage\n   sources. Should we have a spkg? (to be discussed at Sage Days 74\n   with Volker).\n \n Steps for later tickets:\n+\n+- [  ] Configure Sphinx to add a small header to our html page with Thebe configuration: use the Jupyter instance serving the page. We currently use `window.location.origin`; is this the right thing?\n \n - [ ] Currently it takes 10s for 100 prompts while some sage files\n       contain up to 1000 prompts. Profile Thebe and optimize it or use\n@@ -53,7 +54,7 @@\n \n - [ ] Check whether Jupyter could be configured to dynamically\n       negotiate incoming connections that don't fall within the\n-      -NotebookApp.allow_origin pattern, by opening a user dialog such\n+      `-NotebookApp.allow_origin pattern`, by opening a user dialog such\n       as \"Page xxx requests starting a new kernel on this server; do\n       you accept? yes/no/always for this site\"\n \n@@ -81,4 +82,3 @@\n - [ ] Add support in Thebe for basic export to Jupyter notebooks. A\n       quality loss (in particular in terms of the hierarchical\n       structure) is acceptable.\n-\n``````\n",
    "created_at": "2016-06-27T16:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299249",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,31 +12,32 @@
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
-- [ / ] Configure Sphinx to add a small header to our html page with:
+- [X] Configure Sphinx to add a small header to our html page with:
   - [X] Inclusion of the Thebe javascript
-  - [x] Thebe configuration: which divs to make live
+  - [X] Thebe configuration: which divs to make live
         Currently, we include all <pre> tags that contain the "sage:" prompt
         TODO: shall we change to <pre> tags that start with the "sage:" prompt ?
-  - [ ] Thebe configuration: use the Jupyter instance serving the page
-        We currently use window.location.origin; is this the right thing to do?
-  - [x] Only activate Thebe if the page is served by a Jupyter instance
-        Currently we check that the protocol is http
-  - [x] A button to activate live cells
+to do?
+- [X] Only activate Thebe if the page is served by a Jupyter instance
+      Currently we check that the protocol is http
+- [X] A button to activate live cells
 
 - [X] Configure the Jupyter notebook in Sage to somehow provide the
       server configuration to Thebe (not needed in fact)
 
 - Preparse or customize/configure Thebe to support Sage's doctest syntax:
   - [ ] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
-  - [ ] Strip out the outputs
+  - [X] Strip out the outputs
         Bonus: show the included outputs below the cell until the new output is computed
-  - [ ] Support doctests with several commands by spliting into several cells
+  - [X] Support doctests with several commands by spliting into several cells
 
 - Check what's the right way for including thebe.js in the Sage
   sources. Should we have a spkg? (to be discussed at Sage Days 74
   with Volker).
 
 Steps for later tickets:
+
+- [  ] Configure Sphinx to add a small header to our html page with Thebe configuration: use the Jupyter instance serving the page. We currently use `window.location.origin`; is this the right thing?
 
 - [ ] Currently it takes 10s for 100 prompts while some sage files
       contain up to 1000 prompts. Profile Thebe and optimize it or use
@@ -53,7 +54,7 @@
 
 - [ ] Check whether Jupyter could be configured to dynamically
       negotiate incoming connections that don't fall within the
-      -NotebookApp.allow_origin pattern, by opening a user dialog such
+      `-NotebookApp.allow_origin pattern`, by opening a user dialog such
       as "Page xxx requests starting a new kernel on this server; do
       you accept? yes/no/always for this site"
 
@@ -81,4 +82,3 @@
 - [ ] Add support in Thebe for basic export to Jupyter notebooks. A
       quality loss (in particular in terms of the hierarchical
       structure) is acceptable.
-
``````




---

archive/issue_comments_299250.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,60 +25,14 @@\n - [X] Configure the Jupyter notebook in Sage to somehow provide the\n       server configuration to Thebe (not needed in fact)\n \n-- Preparse or customize/configure Thebe to support Sage's doctest syntax:\n+- [/] Preparse or customize/configure Thebe to support Sage's doctest syntax:\n   - [ ] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n   - [X] Strip out the outputs\n         Bonus: show the included outputs below the cell until the new output is computed\n   - [X] Support doctests with several commands by spliting into several cells\n \n-- Check what's the right way for including thebe.js in the Sage\n+- [X] Check what's the right way for including thebe.js in the Sage\n   sources. Should we have a spkg? (to be discussed at Sage Days 74\n   with Volker).\n \n-Steps for later tickets:\n-\n-- [  ] Configure Sphinx to add a small header to our html page with Thebe configuration: use the Jupyter instance serving the page. We currently use `window.location.origin`; is this the right thing?\n-\n-- [ ] Currently it takes 10s for 100 prompts while some sage files\n-      contain up to 1000 prompts. Profile Thebe and optimize it or use\n-      a separate thread to properly support large files.\n-\n-- [ ] Expand the activate button with a menu or other widgets for user\n-      customization of the Jupyter server. This typically would\n-      let the user choose between:\n-      - tmpnb (will only be useful for Sage when tmpnb will include a\n-        Sage kernel)\n-      - A local Jupyter server\n-      - Whichever Jupyter server the browser is currently connected to?\n-      - a user specified server\n-\n-- [ ] Check whether Jupyter could be configured to dynamically\n-      negotiate incoming connections that don't fall within the\n-      `-NotebookApp.allow_origin pattern`, by opening a user dialog such\n-      as \"Page xxx requests starting a new kernel on this server; do\n-      you accept? yes/no/always for this site\"\n-\n-- [ ] Add support in Thebe for customizable (continuation) prompts, with\n-      striping and splitting as above, and automatic setting of the kernel.\n-      The customization option could look like:\n-\n-      ```\n-         prompts = {\n-            \"sage: \": {continuations=[\"....:\", \"...  \"], kernel=\"sagemath\"},\n-            \">>>> \": {continuation=\"...  \", kernel=\"python\"}\n-         }\n-      ```\n-\n-- [ ] Contribute support for Thebe upstream in Sphinx, with:\n-\n-      - [ ] Explicit markup to specify which code blocks are editable\n-            and with which kernel, or setup kernel auto-detection from\n-            the prompt.\n-\n-      - [ ] The possibility for setting a default value for the above\n-\n-- [ ] Refactor the Sage sphinx configuration to use the above\n-\n-- [ ] Add support in Thebe for basic export to Jupyter notebooks. A\n-      quality loss (in particular in terms of the hierarchical\n-      structure) is acceptable.\n+following ticket for possible improvement: #20893\n``````\n",
    "created_at": "2016-06-27T16:17:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299250",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,60 +25,14 @@
 - [X] Configure the Jupyter notebook in Sage to somehow provide the
       server configuration to Thebe (not needed in fact)
 
-- Preparse or customize/configure Thebe to support Sage's doctest syntax:
+- [/] Preparse or customize/configure Thebe to support Sage's doctest syntax:
   - [ ] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
   - [X] Strip out the outputs
         Bonus: show the included outputs below the cell until the new output is computed
   - [X] Support doctests with several commands by spliting into several cells
 
-- Check what's the right way for including thebe.js in the Sage
+- [X] Check what's the right way for including thebe.js in the Sage
   sources. Should we have a spkg? (to be discussed at Sage Days 74
   with Volker).
 
-Steps for later tickets:
-
-- [  ] Configure Sphinx to add a small header to our html page with Thebe configuration: use the Jupyter instance serving the page. We currently use `window.location.origin`; is this the right thing?
-
-- [ ] Currently it takes 10s for 100 prompts while some sage files
-      contain up to 1000 prompts. Profile Thebe and optimize it or use
-      a separate thread to properly support large files.
-
-- [ ] Expand the activate button with a menu or other widgets for user
-      customization of the Jupyter server. This typically would
-      let the user choose between:
-      - tmpnb (will only be useful for Sage when tmpnb will include a
-        Sage kernel)
-      - A local Jupyter server
-      - Whichever Jupyter server the browser is currently connected to?
-      - a user specified server
-
-- [ ] Check whether Jupyter could be configured to dynamically
-      negotiate incoming connections that don't fall within the
-      `-NotebookApp.allow_origin pattern`, by opening a user dialog such
-      as "Page xxx requests starting a new kernel on this server; do
-      you accept? yes/no/always for this site"
-
-- [ ] Add support in Thebe for customizable (continuation) prompts, with
-      striping and splitting as above, and automatic setting of the kernel.
-      The customization option could look like:
-
-      ```
-         prompts = {
-            "sage: ": {continuations=["....:", "...  "], kernel="sagemath"},
-            ">>>> ": {continuation="...  ", kernel="python"}
-         }
-      ```
-
-- [ ] Contribute support for Thebe upstream in Sphinx, with:
-
-      - [ ] Explicit markup to specify which code blocks are editable
-            and with which kernel, or setup kernel auto-detection from
-            the prompt.
-
-      - [ ] The possibility for setting a default value for the above
-
-- [ ] Refactor the Sage sphinx configuration to use the above
-
-- [ ] Add support in Thebe for basic export to Jupyter notebooks. A
-      quality loss (in particular in terms of the hierarchical
-      structure) is acceptable.
+following ticket for possible improvement: #20893
``````




---

archive/issue_comments_299251.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2016-06-27T16:17:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299251",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_299252.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI moved the part related to improvements to #20893. I definitely think that we should try to have something ready for the next beta release. And it is in good shape!",
    "created_at": "2016-06-27T16:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299252",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">comment:18</div>

I moved the part related to improvements to #20893. I definitely think that we should try to have something ready for the next beta release. And it is in good shape!



---

archive/issue_comments_299253.json:
```json
{
    "body": "Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)** to **[u/fcayre/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/fcayre/thebe-20690)**",
    "created_at": "2016-06-30T22:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299253",
    "user": "https://github.com/sagetrac-fcayre"
}
```

Changed branch from **[public/live_documentation_in_jupyter_using_thebe-20690-experimental](https://github.com/sagemath/sagetrac-mirror/tree/public/live_documentation_in_jupyter_using_thebe-20690-experimental)** to **[u/fcayre/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/fcayre/thebe-20690)**



---

archive/issue_comments_299254.json:
```json
{
    "body": "Changed commit from **[`07035fd`](https://github.com/sagemath/sagetrac-mirror/commit/07035fd4b6db42b55131c19026f274e4e624f33b)** to **[`5f9fc0e`](https://github.com/sagemath/sagetrac-mirror/commit/5f9fc0e62bfe1c37f6a3419e9170ef0159f615f8)**",
    "created_at": "2016-06-30T22:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299254",
    "user": "https://github.com/sagetrac-fcayre"
}
```

Changed commit from **[`07035fd`](https://github.com/sagemath/sagetrac-mirror/commit/07035fd4b6db42b55131c19026f274e4e624f33b)** to **[`5f9fc0e`](https://github.com/sagemath/sagetrac-mirror/commit/5f9fc0e62bfe1c37f6a3419e9170ef0159f615f8)**



---

archive/issue_comments_299255.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,10 +25,13 @@\n - [X] Configure the Jupyter notebook in Sage to somehow provide the\n       server configuration to Thebe (not needed in fact)\n \n-- [/] Preparse or customize/configure Thebe to support Sage's doctest syntax:\n-  - [ ] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n+- [X] Preparse or customize/configure Thebe to support Sage's doctest syntax:\n+  - [X] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n   - [X] Strip out the outputs\n         Bonus: show the included outputs below the cell until the new output is computed\n+\n+        What's been done here is: output is show until the \"activate\" button is clicked.\n+\n   - [X] Support doctests with several commands by spliting into several cells\n \n - [X] Check what's the right way for including thebe.js in the Sage\n``````\n",
    "created_at": "2016-06-30T22:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299255",
    "user": "https://github.com/sagetrac-fcayre"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,10 +25,13 @@
 - [X] Configure the Jupyter notebook in Sage to somehow provide the
       server configuration to Thebe (not needed in fact)
 
-- [/] Preparse or customize/configure Thebe to support Sage's doctest syntax:
-  - [ ] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
+- [X] Preparse or customize/configure Thebe to support Sage's doctest syntax:
+  - [X] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
   - [X] Strip out the outputs
         Bonus: show the included outputs below the cell until the new output is computed
+
+        What's been done here is: output is show until the "activate" button is clicked.
+
   - [X] Support doctests with several commands by spliting into several cells
 
 - [X] Check what's the right way for including thebe.js in the Sage
``````




---

archive/issue_comments_299256.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAs discussed with Florent (by mail) the first step should be ready (see #20893 for next steps). I am going through the changes and testing this version.",
    "created_at": "2016-07-01T06:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299256",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

As discussed with Florent (by mail) the first step should be ready (see #20893 for next steps). I am going through the changes and testing this version.



---

archive/issue_events_288731.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-01T06:49:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288731"
}
```



---

archive/issue_comments_299257.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n documentation in the Jupyter notebook as we had in the legacy Sage\n notebook.\n \n-Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.\n+Kudos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n@@ -38,4 +38,5 @@\n   sources. Should we have a spkg? (to be discussed at Sage Days 74\n   with Volker).\n \n-following ticket for possible improvement: #20893\n+Follow-up ticket for possible improvement: #20893.\n+This ticket solves #17269.\n``````\n",
    "created_at": "2016-08-22T13:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299257",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 documentation in the Jupyter notebook as we had in the legacy Sage
 notebook.
 
-Kuddos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.
+Kudos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
@@ -38,4 +38,5 @@
   sources. Should we have a spkg? (to be discussed at Sage Days 74
   with Volker).
 
-following ticket for possible improvement: #20893
+Follow-up ticket for possible improvement: #20893.
+This ticket solves #17269.
``````




---

archive/issue_comments_299258.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThis ticket solves #17269.",
    "created_at": "2016-08-22T13:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299258",
    "user": "https://github.com/slel"
}
```

<div id="comment:21" align="right">comment:21</div>

This ticket solves #17269.



---

archive/issue_comments_299259.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@slel](#comment:21):\n> This ticket solves #17269.\n\nThanks for letting me know about the current ticket. This is indeed a blocker to leave sage notebook for good (this, and the fact that jupyter doen not handle `.rst` files as worksheets, let me continue to use the former during tutorials).",
    "created_at": "2016-08-22T13:55:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299259",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@slel](#comment:21):
> This ticket solves #17269.

Thanks for letting me know about the current ticket. This is indeed a blocker to leave sage notebook for good (this, and the fact that jupyter doen not handle `.rst` files as worksheets, let me continue to use the former during tutorials).



---

archive/issue_comments_299260.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nWith the current version, the button `activate` does not appear in all situation. It does for the reference manual but not for `Help -> Thematic Tutorials -> Tutorial: Sage Introductory Programming (PREP)`.",
    "created_at": "2016-08-22T14:08:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299260",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

With the current version, the button `activate` does not appear in all situation. It does for the reference manual but not for `Help -> Thematic Tutorials -> Tutorial: Sage Introductory Programming (PREP)`.



---

archive/issue_events_288732.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-22T14:08:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288732"
}
```



---

archive/issue_events_288733.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-22T14:08:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288733"
}
```



---

archive/issue_events_288734.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-22T14:08:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288734"
}
```



---

archive/issue_events_288735.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-22T14:08:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288735"
}
```



---

archive/issue_comments_299261.json:
```json
{
    "body": "Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Thierry Monteil**",
    "created_at": "2016-08-22T14:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299261",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Thierry Monteil**



---

archive/issue_comments_299262.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n`thebe.js` should not be raw copied to Sage source code. Instead, it should be installed as a Sage package, so that it is easier to keep it up-to-date. Typically, the script you copied is adapted to Jupyter 4.0.5.",
    "created_at": "2016-08-22T14:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299262",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:24" align="right">comment:24</div>

`thebe.js` should not be raw copied to Sage source code. Instead, it should be installed as a Sage package, so that it is easier to keep it up-to-date. Typically, the script you copied is adapted to Jupyter 4.0.5.



---

archive/issue_comments_299263.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nHi Thierry,\n\nThanks for looking at this!\n\nIt was Volker's suggestion to just raw copy thebe.js in the sources.\n\nOne part of the rationale is simplicity. The other is that, once jupyterlab will have matured out, thebe.js is likely to become a thin layer on top of it, if not just a part of it. So it's not that crucial to take the efforts of a super clean long term solution.\n\nBut I don't have a strong opinion either.",
    "created_at": "2016-08-22T15:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299263",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:25" align="right">comment:25</div>

Hi Thierry,

Thanks for looking at this!

It was Volker's suggestion to just raw copy thebe.js in the sources.

One part of the rationale is simplicity. The other is that, once jupyterlab will have matured out, thebe.js is likely to become a thin layer on top of it, if not just a part of it. So it's not that crucial to take the efforts of a super clean long term solution.

But I don't have a strong opinion either.



---

archive/issue_comments_299264.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nHaving a dedicated spkg is not such a huge effort, and there are tons of temporary things in Sage that wait to be cleaned for years, let us not make things worse when we can avoid it. Let me just give a try.",
    "created_at": "2016-08-22T19:03:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299264",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:26" align="right">comment:26</div>

Having a dedicated spkg is not such a huge effort, and there are tons of temporary things in Sage that wait to be cleaned for years, let us not make things worse when we can avoid it. Let me just give a try.



---

archive/issue_comments_299265.json:
```json
{
    "body": "Changed branch from **[u/fcayre/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/fcayre/thebe-20690)** to **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)**",
    "created_at": "2016-08-22T19:32:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299265",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed branch from **[u/fcayre/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/fcayre/thebe-20690)** to **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)**



---

archive/issue_comments_299266.json:
```json
{
    "body": "Dependencies: **#21309**",
    "created_at": "2016-08-22T19:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299266",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Dependencies: **#21309**



---

archive/issue_comments_299267.json:
```json
{
    "body": "Changed commit from **[`5f9fc0e`](https://github.com/sagemath/sagetrac-mirror/commit/5f9fc0e62bfe1c37f6a3419e9170ef0159f615f8)** to **[`ef6657d`](https://github.com/sagemath/sagetrac-mirror/commit/ef6657d0dbd9c0008c5dae50bf18e47bee6f2e6c)**",
    "created_at": "2016-08-22T19:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299267",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed commit from **[`5f9fc0e`](https://github.com/sagemath/sagetrac-mirror/commit/5f9fc0e62bfe1c37f6a3419e9170ef0159f615f8)** to **[`ef6657d`](https://github.com/sagemath/sagetrac-mirror/commit/ef6657d0dbd9c0008c5dae50bf18e47bee6f2e6c)**



---

archive/issue_comments_299268.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -34,9 +34,8 @@\n \n   - [X] Support doctests with several commands by spliting into several cells\n \n-- [X] Check what's the right way for including thebe.js in the Sage\n-  sources. Should we have a spkg? (to be discussed at Sage Days 74\n-  with Volker).\n+- [X] Ship thebe.js from a dedicated spkg (#21309).\n \n Follow-up ticket for possible improvement: #20893.\n This ticket solves #17269.\n+\n``````\n",
    "created_at": "2016-08-22T19:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299268",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -34,9 +34,8 @@
 
   - [X] Support doctests with several commands by spliting into several cells
 
-- [X] Check what's the right way for including thebe.js in the Sage
-  sources. Should we have a spkg? (to be discussed at Sage Days 74
-  with Volker).
+- [X] Ship thebe.js from a dedicated spkg (#21309).
 
 Follow-up ticket for possible improvement: #20893.
 This ticket solves #17269.
+
``````




---

archive/issue_comments_299269.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI wrote #21309 to package thebe.js (needs review) and let the current branch depend on that one (i.e. i replaced the hardcoded code to a symlink to the file provided by the spkg). It works well on my machine.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d4fe864b00482ed97a0fc1f98a8150e5c83fc84\"><code>7d4fe86</code></a></td><td><code>#21309 : package thebejs.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f508730b7f834a1d62f2c516e9a5f00a931ade46\"><code>f508730</code></a></td><td><code>Merge branch 'u/fcayre/thebe-20690' of trac.sagemath.org:sage into t/21309/package_thebe_js</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef6657d0dbd9c0008c5dae50bf18e47bee6f2e6c\"><code>ef6657d</code></a></td><td><code>#20690 : use thebe.js from the thebejs package instead of the hardcoded one.</code></td></tr></table>\n",
    "created_at": "2016-08-22T19:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299269",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:28" align="right">comment:28</div>

I wrote #21309 to package thebe.js (needs review) and let the current branch depend on that one (i.e. i replaced the hardcoded code to a symlink to the file provided by the spkg). It works well on my machine.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d4fe864b00482ed97a0fc1f98a8150e5c83fc84"><code>7d4fe86</code></a></td><td><code>#21309 : package thebejs.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f508730b7f834a1d62f2c516e9a5f00a931ade46"><code>f508730</code></a></td><td><code>Merge branch 'u/fcayre/thebe-20690' of trac.sagemath.org:sage into t/21309/package_thebe_js</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef6657d0dbd9c0008c5dae50bf18e47bee6f2e6c"><code>ef6657d</code></a></td><td><code>#20690 : use thebe.js from the thebejs package instead of the hardcoded one.</code></td></tr></table>




---

archive/issue_comments_299270.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@videlec](#comment:23):\n> With the current version, the button `activate` does not appear in all situation. It does for the reference manual but not for `Help -> Thematic Tutorials -> Tutorial: Sage Introductory Programming (PREP)`.\n\nI double checked this. Actually, the button does not appear when the pages do  not have cells (the first pages of the PREP are just pictures, no computations), but it does otherwise (see e.g. the \"Calculus 1\" page), so it is somehow a good feature.",
    "created_at": "2016-08-22T20:32:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299270",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@videlec](#comment:23):
> With the current version, the button `activate` does not appear in all situation. It does for the reference manual but not for `Help -> Thematic Tutorials -> Tutorial: Sage Introductory Programming (PREP)`.

I double checked this. Actually, the button does not appear when the pages do  not have cells (the first pages of the PREP are just pictures, no computations), but it does otherwise (see e.g. the "Calculus 1" page), so it is somehow a good feature.



---

archive/issue_events_288736.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2016-08-22T20:32:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288736"
}
```



---

archive/issue_events_288737.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2016-08-22T20:32:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288737"
}
```



---

archive/issue_comments_299271.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@sagetrac-tmonteil](#comment:28):\n> I wrote #21309 to package thebe.js (needs review) and let the current branch depend on that one (i.e. i replaced the hardcoded code to a symlink to the file provided by the spkg). It works well on my machine.\n\n\u00c7a c'est gentil!\n\nFor the record, I had Florent Cayr\u00e9 on the phone this morning. He started looking at this, but somehow he has a technical issue posting messages on trac which we did not manage to debug. Anyway, we should be able to review this shortly (e.g. tomorrow during the Sage Days).",
    "created_at": "2016-08-23T15:21:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299271",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@sagetrac-tmonteil](#comment:28):
> I wrote #21309 to package thebe.js (needs review) and let the current branch depend on that one (i.e. i replaced the hardcoded code to a symlink to the file provided by the spkg). It works well on my machine.

Ça c'est gentil!

For the record, I had Florent Cayré on the phone this morning. He started looking at this, but somehow he has a technical issue posting messages on trac which we did not manage to debug. Anyway, we should be able to review this shortly (e.g. tomorrow during the Sage Days).



---

archive/issue_comments_299272.json:
```json
{
    "body": "Changed keywords from **days77, jupyter, thebe, notebook** to **days77, jupyter, thebe, notebook, sd75**",
    "created_at": "2016-08-23T17:55:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299272",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed keywords from **days77, jupyter, thebe, notebook** to **days77, jupyter, thebe, notebook, sd75**



---

archive/issue_comments_299273.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nGreat ! (i just arrived at Cernay, barbecue tonight!)",
    "created_at": "2016-08-23T17:55:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299273",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:31" align="right">comment:31</div>

Great ! (i just arrived at Cernay, barbecue tonight!)



---

archive/issue_comments_299274.json:
```json
{
    "body": "Changed branch from **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)** to **[u/nthiery/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/thebe-20690)**",
    "created_at": "2016-08-25T17:13:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299274",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)** to **[u/nthiery/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/thebe-20690)**



---

archive/issue_comments_299275.json:
```json
{
    "body": "Changed commit from **[`ef6657d`](https://github.com/sagemath/sagetrac-mirror/commit/ef6657d0dbd9c0008c5dae50bf18e47bee6f2e6c)** to **[`4278753`](https://github.com/sagemath/sagetrac-mirror/commit/427875361ce7799bcce2b06641ba8624184b42c9)**",
    "created_at": "2016-08-25T17:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299275",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ef6657d`](https://github.com/sagemath/sagetrac-mirror/commit/ef6657d0dbd9c0008c5dae50bf18e47bee6f2e6c)** to **[`4278753`](https://github.com/sagemath/sagetrac-mirror/commit/427875361ce7799bcce2b06641ba8624184b42c9)**



---

archive/issue_comments_299276.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/427875361ce7799bcce2b06641ba8624184b42c9\"><code>4278753</code></a></td><td><code>20690: Added comment about Thebe and Sage's thebejs package</code></td></tr></table>\n",
    "created_at": "2016-08-25T17:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299276",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/427875361ce7799bcce2b06641ba8624184b42c9"><code>4278753</code></a></td><td><code>20690: Added comment about Thebe and Sage's thebejs package</code></td></tr></table>




---

archive/issue_comments_299277.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,34 +8,36 @@\n documentation in the Jupyter notebook as we had in the legacy Sage\n notebook.\n \n-Kudos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.\n+Kudos to Rob Beezer for pointing us to Thebe in his presentation of\n+MathBookXML at Sage Days 77.\n \n Steps:\n - [X] Configure Sphinx to add the Thebe javascript library in the static page\n - [X] Configure Sphinx to add a small header to our html page with:\n   - [X] Inclusion of the Thebe javascript\n   - [X] Thebe configuration: which divs to make live\n-        Currently, we include all <pre> tags that contain the \"sage:\" prompt\n-        TODO: shall we change to <pre> tags that start with the \"sage:\" prompt ?\n-to do?\n+\n+    Currently, we include all <pre> tags that contain the \"sage:\" prompt.\n+\n+    TODO: shall we change to <pre> tags that start with the \"sage:\" prompt?\n+\n+TODO:\n - [X] Only activate Thebe if the page is served by a Jupyter instance\n-      Currently we check that the protocol is http\n+\n+  Currently we check that the protocol is http\n - [X] A button to activate live cells\n-\n - [X] Configure the Jupyter notebook in Sage to somehow provide the\n-      server configuration to Thebe (not needed in fact)\n-\n+  server configuration to Thebe (not needed in fact)\n - [X] Preparse or customize/configure Thebe to support Sage's doctest syntax:\n   - [X] Strip out the \"sage: \" prompts and \"....:\" and \"...  \" continuation prompts\n   - [X] Strip out the outputs\n-        Bonus: show the included outputs below the cell until the new output is computed\n \n-        What's been done here is: output is show until the \"activate\" button is clicked.\n+    Bonus: show the included outputs below the cell until the new output is computed\n \n-  - [X] Support doctests with several commands by spliting into several cells\n+    What's been done here is: output is show until the \"activate\" button is clicked.\n \n-- [X] Ship thebe.js from a dedicated spkg (#21309).\n+- [X] Support doctests with several commands by spliting into several cells\n+- [X] Ship Thebe from a dedicated spkg (#21309).\n \n-Follow-up ticket for possible improvement: #20893.\n-This ticket solves #17269.\n+This ticket solves #17269. Follow-up ticket for possible improvements: #20893.\n \n``````\n",
    "created_at": "2016-08-30T09:21:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299277",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,34 +8,36 @@
 documentation in the Jupyter notebook as we had in the legacy Sage
 notebook.
 
-Kudos to Rob Beezer for pointing us to Thebe in his presentation of MathBookXML at Sage Days 77.
+Kudos to Rob Beezer for pointing us to Thebe in his presentation of
+MathBookXML at Sage Days 77.
 
 Steps:
 - [X] Configure Sphinx to add the Thebe javascript library in the static page
 - [X] Configure Sphinx to add a small header to our html page with:
   - [X] Inclusion of the Thebe javascript
   - [X] Thebe configuration: which divs to make live
-        Currently, we include all <pre> tags that contain the "sage:" prompt
-        TODO: shall we change to <pre> tags that start with the "sage:" prompt ?
-to do?
+
+    Currently, we include all <pre> tags that contain the "sage:" prompt.
+
+    TODO: shall we change to <pre> tags that start with the "sage:" prompt?
+
+TODO:
 - [X] Only activate Thebe if the page is served by a Jupyter instance
-      Currently we check that the protocol is http
+
+  Currently we check that the protocol is http
 - [X] A button to activate live cells
-
 - [X] Configure the Jupyter notebook in Sage to somehow provide the
-      server configuration to Thebe (not needed in fact)
-
+  server configuration to Thebe (not needed in fact)
 - [X] Preparse or customize/configure Thebe to support Sage's doctest syntax:
   - [X] Strip out the "sage: " prompts and "....:" and "...  " continuation prompts
   - [X] Strip out the outputs
-        Bonus: show the included outputs below the cell until the new output is computed
 
-        What's been done here is: output is show until the "activate" button is clicked.
+    Bonus: show the included outputs below the cell until the new output is computed
 
-  - [X] Support doctests with several commands by spliting into several cells
+    What's been done here is: output is show until the "activate" button is clicked.
 
-- [X] Ship thebe.js from a dedicated spkg (#21309).
+- [X] Support doctests with several commands by spliting into several cells
+- [X] Ship Thebe from a dedicated spkg (#21309).
 
-Follow-up ticket for possible improvement: #20893.
-This ticket solves #17269.
+This ticket solves #17269. Follow-up ticket for possible improvements: #20893.
 
``````




---

archive/issue_comments_299278.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\n(Just editing ticket description, fixing formatting.)",
    "created_at": "2016-08-30T09:21:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299278",
    "user": "https://github.com/slel"
}
```

<div id="comment:34" align="right">comment:34</div>

(Just editing ticket description, fixing formatting.)



---

archive/issue_comments_299279.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nHi Vincent, Thierry,\nBesides merging the latest #21309 when it's polished, do you consider this as ready to go?\nIt would be nice to be done with this!\nThanks,",
    "created_at": "2016-09-04T15:34:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299279",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:35" align="right">comment:35</div>

Hi Vincent, Thierry,
Besides merging the latest #21309 when it's polished, do you consider this as ready to go?
It would be nice to be done with this!
Thanks,



---

archive/issue_comments_299280.json:
```json
{
    "body": "Changed branch from **[u/nthiery/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/thebe-20690)** to **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)**",
    "created_at": "2016-09-04T21:46:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299280",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed branch from **[u/nthiery/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/thebe-20690)** to **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)**



---

archive/issue_comments_299281.json:
```json
{
    "body": "Changed commit from **[`4278753`](https://github.com/sagemath/sagetrac-mirror/commit/427875361ce7799bcce2b06641ba8624184b42c9)** to **[`11720b4`](https://github.com/sagemath/sagetrac-mirror/commit/11720b4c7f8bfdfb06f678c02a677754e7870553)**",
    "created_at": "2016-09-04T21:57:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299281",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed commit from **[`4278753`](https://github.com/sagemath/sagetrac-mirror/commit/427875361ce7799bcce2b06641ba8624184b42c9)** to **[`11720b4`](https://github.com/sagemath/sagetrac-mirror/commit/11720b4c7f8bfdfb06f678c02a677754e7870553)**



---

archive/issue_comments_299282.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nI changed the symlink from `local/share/thebejs/thebe.js` to `local/share/thebe/thebe.js` according to the renaming done in #21309. Since the two branches were completely entangled (lot of merges), i went back to the last Florent's commit, fixed the symlink and added (and updated) Nicola's comment in `thebe-sage.js` header. Now the two branches are completely independant, apart from the very last merge.\n\nIf you plan to modify something in the current ticket or in #21309, please undo the last merge before, or it will start to knit again.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4768dfb3d1f45ef78609ba3915135723e6845c0\"><code>e4768df</code></a></td><td><code>#20690 : use thebe.js from the thebe package instead of the hardcoded one.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71999791dddc2f149a12ca5ce06cc0166ee57398\"><code>7199979</code></a></td><td><code>#20690 : report updated version of Nicola's change in the disentangled branch.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/520cdd0796488eebc64c3796e7030504ab941661\"><code>520cdd0</code></a></td><td><code>#21309 : thebejs -> thebe ; use hash in pkg name ; link to trac URL.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/11720b4c7f8bfdfb06f678c02a677754e7870553\"><code>11720b4</code></a></td><td><code>Merge branch 't/21309/package_thebe_js' into t/20690/thebe-20690</code></td></tr></table>\n",
    "created_at": "2016-09-04T21:57:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299282",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:37" align="right">comment:37</div>

I changed the symlink from `local/share/thebejs/thebe.js` to `local/share/thebe/thebe.js` according to the renaming done in #21309. Since the two branches were completely entangled (lot of merges), i went back to the last Florent's commit, fixed the symlink and added (and updated) Nicola's comment in `thebe-sage.js` header. Now the two branches are completely independant, apart from the very last merge.

If you plan to modify something in the current ticket or in #21309, please undo the last merge before, or it will start to knit again.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4768dfb3d1f45ef78609ba3915135723e6845c0"><code>e4768df</code></a></td><td><code>#20690 : use thebe.js from the thebe package instead of the hardcoded one.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71999791dddc2f149a12ca5ce06cc0166ee57398"><code>7199979</code></a></td><td><code>#20690 : report updated version of Nicola's change in the disentangled branch.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/520cdd0796488eebc64c3796e7030504ab941661"><code>520cdd0</code></a></td><td><code>#21309 : thebejs -> thebe ; use hash in pkg name ; link to trac URL.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/11720b4c7f8bfdfb06f678c02a677754e7870553"><code>11720b4</code></a></td><td><code>Merge branch 't/21309/package_thebe_js' into t/20690/thebe-20690</code></td></tr></table>




---

archive/issue_comments_299283.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@nthiery](#comment:35):\n> Hi Vincent, Thierry,\n> Besides merging the latest #21309 when it's polished, do you consider this as ready to go?\n> It would be nice to be done with this!\n> Thanks,\n\nI did not inspect `thebe-sage.js` as i would have done for Python files. But its behaviour corresponds to the claimed feature and the code seem not malicious. So i guess it will be OK for me once the dependencies will be satisfied.",
    "created_at": "2016-09-04T22:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299283",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@nthiery](#comment:35):
> Hi Vincent, Thierry,
> Besides merging the latest #21309 when it's polished, do you consider this as ready to go?
> It would be nice to be done with this!
> Thanks,

I did not inspect `thebe-sage.js` as i would have done for Python files. But its behaviour corresponds to the claimed feature and the code seem not malicious. So i guess it will be OK for me once the dependencies will be satisfied.



---

archive/issue_comments_299284.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThanks Thierry for the final version of #21309 (Jeroen is double checking it right now) and for cleaning the history.\n\nI agree that we are on a thin line here since we don't have strong review standards set for js files like this one. For example we are missing tests! However writing such tests would take some infrastructure; we should discuss how to setup such infrastructure with the Jupyter people at some point, but for now I guess that's ok.\n\nVincent, any further comment?\n\nCheers,\n                                 Nicolas",
    "created_at": "2016-09-05T07:01:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299284",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:39" align="right">comment:39</div>

Thanks Thierry for the final version of #21309 (Jeroen is double checking it right now) and for cleaning the history.

I agree that we are on a thin line here since we don't have strong review standards set for js files like this one. For example we are missing tests! However writing such tests would take some infrastructure; we should discuss how to setup such infrastructure with the Jupyter people at some point, but for now I guess that's ok.

Vincent, any further comment?

Cheers,
                                 Nicolas



---

archive/issue_events_288738.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2016-09-05T08:07:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288738"
}
```



---

archive/issue_events_288739.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2016-09-05T08:07:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288739"
}
```



---

archive/issue_comments_299285.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI have a doubt: to avoid race condition, i guess we should add thebe to the doc build dependencies.",
    "created_at": "2016-09-05T08:07:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299285",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:40" align="right">comment:40</div>

I have a doubt: to avoid race condition, i guess we should add thebe to the doc build dependencies.



---

archive/issue_comments_299286.json:
```json
{
    "body": "<div id=\"comment:41\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8a7f321f02a58beb7ae69dab87dc3d4e089537e\"><code>b8a7f32</code></a></td><td><code>Merge branch 'develop' into t/20690/thebe-20690</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22ae6378d820d7ad644c452c15ba335c27b1a6ab\"><code>22ae637</code></a></td><td><code>#20690 : let the doc build depend on thebe.</code></td></tr></table>\n",
    "created_at": "2016-09-05T10:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299286",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:41"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8a7f321f02a58beb7ae69dab87dc3d4e089537e"><code>b8a7f32</code></a></td><td><code>Merge branch 'develop' into t/20690/thebe-20690</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22ae6378d820d7ad644c452c15ba335c27b1a6ab"><code>22ae637</code></a></td><td><code>#20690 : let the doc build depend on thebe.</code></td></tr></table>




---

archive/issue_comments_299287.json:
```json
{
    "body": "Changed commit from **[`11720b4`](https://github.com/sagemath/sagetrac-mirror/commit/11720b4c7f8bfdfb06f678c02a677754e7870553)** to **[`22ae637`](https://github.com/sagemath/sagetrac-mirror/commit/22ae6378d820d7ad644c452c15ba335c27b1a6ab)**",
    "created_at": "2016-09-05T10:05:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299287",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`11720b4`](https://github.com/sagemath/sagetrac-mirror/commit/11720b4c7f8bfdfb06f678c02a677754e7870553)** to **[`22ae637`](https://github.com/sagemath/sagetrac-mirror/commit/22ae6378d820d7ad644c452c15ba335c27b1a6ab)**



---

archive/issue_comments_299288.json:
```json
{
    "body": "Changed commit from **[`22ae637`](https://github.com/sagemath/sagetrac-mirror/commit/22ae6378d820d7ad644c452c15ba335c27b1a6ab)** to **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)**",
    "created_at": "2016-09-05T10:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299288",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`22ae637`](https://github.com/sagemath/sagetrac-mirror/commit/22ae6378d820d7ad644c452c15ba335c27b1a6ab)** to **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)**



---

archive/issue_comments_299289.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d4fe864b00482ed97a0fc1f98a8150e5c83fc84\"><code>7d4fe86</code></a></td><td><code>#21309 : package thebejs.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28346f68abb4f6cc409346b6e3270de12c4c121d\"><code>28346f6</code></a></td><td><code>21309: added a brief line stating why Sage uses thebe</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/520cdd0796488eebc64c3796e7030504ab941661\"><code>520cdd0</code></a></td><td><code>#21309 : thebejs -> thebe ; use hash in pkg name ; link to trac URL.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a\"><code>8c8e731</code></a></td><td><code>Merge branch 't/21309/package_thebe_js' into t/20690/thebe-20690</code></td></tr></table>\n",
    "created_at": "2016-09-05T10:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299289",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d4fe864b00482ed97a0fc1f98a8150e5c83fc84"><code>7d4fe86</code></a></td><td><code>#21309 : package thebejs.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28346f68abb4f6cc409346b6e3270de12c4c121d"><code>28346f6</code></a></td><td><code>21309: added a brief line stating why Sage uses thebe</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/520cdd0796488eebc64c3796e7030504ab941661"><code>520cdd0</code></a></td><td><code>#21309 : thebejs -> thebe ; use hash in pkg name ; link to trac URL.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a"><code>8c8e731</code></a></td><td><code>Merge branch 't/21309/package_thebe_js' into t/20690/thebe-20690</code></td></tr></table>




---

archive/issue_comments_299290.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@sagetrac-tmonteil](#comment:40):\n> I have a doubt: to avoid race condition, i guess we should add thebe to the doc build dependencies.\n\nFor this, i had to merge with sage.7.3 because the exact same line in `build/make/deps` changed there. Let us test the build like this (it might take some time). Again, if you plan to do some modifications, do not forget to undo the very last merge (with #21309) before.",
    "created_at": "2016-09-05T10:10:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299290",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@sagetrac-tmonteil](#comment:40):
> I have a doubt: to avoid race condition, i guess we should add thebe to the doc build dependencies.

For this, i had to merge with sage.7.3 because the exact same line in `build/make/deps` changed there. Let us test the build like this (it might take some time). Again, if you plan to do some modifications, do not forget to undo the very last merge (with #21309) before.



---

archive/issue_comments_299291.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@sagetrac-tmonteil](#comment:43):\n> Replying to [@sagetrac-tmonteil](#comment:40):\n> > I have a doubt: to avoid race condition, i guess we should add thebe to the doc build dependencies.\n\n> \n> For this, i had to merge with sage.7.3 because the exact same line in `build/make/deps` changed there. Let us test the build like this (it might take some time).\n\nOk, thanks!\n\n> Again, if you plan to do some modifications, do not forget to undo the very last merge (with #21309) before.\n\nWe discussed this with Jeroen this morning. Unless Vincent has a specific requestion, we don't plan for further modifications.",
    "created_at": "2016-09-05T13:58:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299291",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@sagetrac-tmonteil](#comment:43):
> Replying to [@sagetrac-tmonteil](#comment:40):
> > I have a doubt: to avoid race condition, i guess we should add thebe to the doc build dependencies.

> 
> For this, i had to merge with sage.7.3 because the exact same line in `build/make/deps` changed there. Let us test the build like this (it might take some time).

Ok, thanks!

> Again, if you plan to do some modifications, do not forget to undo the very last merge (with #21309) before.

We discussed this with Jeroen this morning. Unless Vincent has a specific requestion, we don't plan for further modifications.



---

archive/issue_comments_299292.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\n(good for me)",
    "created_at": "2016-09-05T15:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299292",
    "user": "https://github.com/videlec"
}
```

<div id="comment:45" align="right">comment:45</div>

(good for me)



---

archive/issue_events_288740.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2016-09-05T16:01:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288740"
}
```



---

archive/issue_events_288741.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2016-09-05T16:01:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288741"
}
```



---

archive/issue_comments_299293.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nI don't want to remove the positive review but I would like some info about `/src/doc/common/themes/sage/static/thebe.js` which reads\n\n```\n../../../../../../local/share/thebe/thebe.js\n```\nWould there be a better way to refer to the `thebe.js` file installed by the `thebe` package? The above assume a particular sage install. I don't usually let people get away with putting `/local/` in anything these days as it is bad for stuff like sage-on-gentoo and more broadly sage-on-distro.",
    "created_at": "2016-09-06T23:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299293",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:47" align="right">comment:47</div>

I don't want to remove the positive review but I would like some info about `/src/doc/common/themes/sage/static/thebe.js` which reads

```
../../../../../../local/share/thebe/thebe.js
```
Would there be a better way to refer to the `thebe.js` file installed by the `thebe` package? The above assume a particular sage install. I don't usually let people get away with putting `/local/` in anything these days as it is bad for stuff like sage-on-gentoo and more broadly sage-on-distro.



---

archive/issue_comments_299294.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI have no idea on how to do that. This kind of symlink already appears for `mathjax`, but the symlink is done when sagenb is installed. Unfortunately, there is no `sage_documentation` package where we could add a `spkg-install` script to install the symlink at build time. I you have an idea to improve this situation, it would be nice to implement it here and for mathjax as well.",
    "created_at": "2016-09-07T09:39:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299294",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:48" align="right">comment:48</div>

I have no idea on how to do that. This kind of symlink already appears for `mathjax`, but the symlink is done when sagenb is installed. Unfortunately, there is no `sage_documentation` package where we could add a `spkg-install` script to install the symlink at build time. I you have an idea to improve this situation, it would be nice to implement it here and for mathjax as well.



---

archive/issue_comments_299295.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nI have no solution right now. I will have to find a way to live with it. I'll come up with something, I usually do in the end. It doesn't always make sense in vanilla sage unfortunately.",
    "created_at": "2016-09-07T09:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299295",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:49" align="right">comment:49</div>

I have no solution right now. I will have to find a way to live with it. I'll come up with something, I usually do in the end. It doesn't always make sense in vanilla sage unfortunately.



---

archive/issue_events_288742.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-09-10T09:00:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288742"
}
```



---

archive/issue_events_288743.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "af82d8abc834b1dc960036a6f688c60332e8f613",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-09-10T09:00:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20690#event-288743"
}
```



---

archive/issue_comments_299296.json:
```json
{
    "body": "Changed branch from **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)** to **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)**",
    "created_at": "2016-09-10T09:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299296",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tmonteil/thebe-20690](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/thebe-20690)** to **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)**



---

archive/issue_comments_299297.json:
```json
{
    "body": "Changed commit from **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)** to none",
    "created_at": "2016-09-18T11:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299297",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`8c8e731`](https://github.com/sagemath/sagetrac-mirror/commit/8c8e731a11790c135c906dbdf00dffd9fe616a9a)** to none



---

archive/issue_comments_299298.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nAdding a symbolic link from the sources to some installation directory really makes no sense, especially because it is hardcoded. Having it installed by the `thebe` package would at least make slightly more sense. Of course, ideally we would just use `thebe.js` from the installation directory.",
    "created_at": "2016-09-18T11:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299298",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">comment:51</div>

Adding a symbolic link from the sources to some installation directory really makes no sense, especially because it is hardcoded. Having it installed by the `thebe` package would at least make slightly more sense. Of course, ideally we would just use `thebe.js` from the installation directory.



---

archive/issue_comments_299299.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nSee #21527 for a follow-up on the symbolic link issue.",
    "created_at": "2016-09-18T19:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299299",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">comment:52</div>

See #21527 for a follow-up on the symbolic link issue.



---

archive/issue_comments_299300.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nHere is some feedback after real-life testing. I am currently teaching for a 3-week Sage tutorial, and there is a workflow issue, somehow `thebe.js` miss the main point of the sagenb live documentation.\n\nOn sagenb notebook, say the students work on some thematic tutorial, they do some tests, copy some lecturer's examples and want to keep their changes. What they can do is to click on `File` (top left) and then `Copy worksheet` so that the live documentation becomes a true sagenb worksheet they can save to come back on it later.\n\nIn the current case, we can do some tests and modifications (which is great), but all the work is lost when we close the webpage. We should have a button to export the current state into a (possibly degradated, we do not really care about the subtle html structure) `.ipynb` file that can then be saved.",
    "created_at": "2016-10-16T19:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299300",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:53" align="right">comment:53</div>

Here is some feedback after real-life testing. I am currently teaching for a 3-week Sage tutorial, and there is a workflow issue, somehow `thebe.js` miss the main point of the sagenb live documentation.

On sagenb notebook, say the students work on some thematic tutorial, they do some tests, copy some lecturer's examples and want to keep their changes. What they can do is to click on `File` (top left) and then `Copy worksheet` so that the live documentation becomes a true sagenb worksheet they can save to come back on it later.

In the current case, we can do some tests and modifications (which is great), but all the work is lost when we close the webpage. We should have a button to export the current state into a (possibly degradated, we do not really care about the subtle html structure) `.ipynb` file that can then be saved.



---

archive/issue_comments_299301.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nThanks Thierry for the feedback!\n\nYes, this is a very desirable feature, which we had already listed on #20893:\n\n> - [ ] Add support in Thebe for basic export to Jupyter notebooks. A\n>   quality loss (in particular in terms of the hierarchical\n>   structure) is acceptable.\n\nDo you mind merging this item with the new one you added there?",
    "created_at": "2016-10-17T07:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299301",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:54" align="right">comment:54</div>

Thanks Thierry for the feedback!

Yes, this is a very desirable feature, which we had already listed on #20893:

> - [ ] Add support in Thebe for basic export to Jupyter notebooks. A
>   quality loss (in particular in terms of the hierarchical
>   structure) is acceptable.

Do you mind merging this item with the new one you added there?



---

archive/issue_comments_299302.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nWhile preparing the report for OpenDreamKit, I just noticed that this is completely broken: #22458",
    "created_at": "2017-02-27T11:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20690#issuecomment-299302",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

While preparing the report for OpenDreamKit, I just noticed that this is completely broken: #22458
