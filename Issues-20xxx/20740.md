# Issue 20740: Drop return type from arithmetic methods in coercion model

archive/issues_020503.json:
```json
{
    "body": "Replace\n\n```\ncpdef ModuleElement _add_(left, ModuleElement right)\n```\nby\n\n```\ncpdef _add_(left, ModuleElement right)\n```\nand similar. The return type serves no purpose:\n1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.\n2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.\n\nAlso remove the superfluous declarations of these methods in other `.pxd` files.\n\nCC:  @videlec\n\nKeywords: days74\n\nBranch: [56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)\n\nReviewer: Marc Mezzarobba\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20740\n\n",
    "closed_at": "2016-06-15T18:47:37Z",
    "created_at": "2016-05-31T20:56:56Z",
    "labels": [
        "component: coercion",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Drop return type from arithmetic methods in coercion model",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20740",
    "user": "https://github.com/jdemeyer"
}
```
Replace

```
cpdef ModuleElement _add_(left, ModuleElement right)
```
by

```
cpdef _add_(left, ModuleElement right)
```
and similar. The return type serves no purpose:
1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.
2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.

Also remove the superfluous declarations of these methods in other `.pxd` files.

CC:  @videlec

Keywords: days74

Branch: [56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)

Reviewer: Marc Mezzarobba

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20740





---

archive/issue_comments_381039.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,5 @@\n cpdef _add_(left, ModuleElement right)\n ```\n and similar. The return type serves absolutely no purpose.\n+\n+Also remove the superfluous declarations of these methods in other `.pxd` files.\n``````\n",
    "created_at": "2016-05-31T21:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381039",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,5 @@
 cpdef _add_(left, ModuleElement right)
 ```
 and similar. The return type serves absolutely no purpose.
+
+Also remove the superfluous declarations of these methods in other `.pxd` files.
``````




---

archive/issue_comments_381040.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,8 @@\n ```\n cpdef _add_(left, ModuleElement right)\n ```\n-and similar. The return type serves absolutely no purpose.\n+and similar. The return type serves no purpose:\n+1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.\n+2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.\n \n Also remove the superfluous declarations of these methods in other `.pxd` files.\n``````\n",
    "created_at": "2016-06-01T08:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381040",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,8 @@
 ```
 cpdef _add_(left, ModuleElement right)
 ```
-and similar. The return type serves absolutely no purpose.
+and similar. The return type serves no purpose:
+1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.
+2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.
 
 Also remove the superfluous declarations of these methods in other `.pxd` files.
``````




---

archive/issue_comments_381041.json:
```json
{
    "body": "<a id='comment:3'></a>\n(edit: wrong ticket)",
    "created_at": "2016-06-01T08:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381041",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
(edit: wrong ticket)



---

archive/issue_comments_381042.json:
```json
{
    "body": "Branch: [u/jdemeyer/drop_return_type](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/drop_return_type)",
    "created_at": "2016-06-01T10:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381042",
    "user": "https://github.com/jdemeyer"
}
```

Branch: [u/jdemeyer/drop_return_type](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/drop_return_type)



---

archive/issue_comments_381043.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew commits:\n|                                                                                                                                          |                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[56776e2](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)|`Drop return type from single-underscore arithmetic methods`|",
    "created_at": "2016-06-01T10:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381043",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
New commits:
|                                                                                                                                          |                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[56776e2](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)|`Drop return type from single-underscore arithmetic methods`|



---

archive/issue_comments_381044.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-01T10:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381044",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_381045.json:
```json
{
    "body": "Commit: [56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)",
    "created_at": "2016-06-01T10:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381045",
    "user": "https://github.com/jdemeyer"
}
```

Commit: [56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)



---

archive/issue_comments_381046.json:
```json
{
    "body": "Changing keywords from \"\" to \"days74\".",
    "created_at": "2016-06-02T13:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381046",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "days74".



---

archive/issue_comments_381047.json:
```json
{
    "body": "<a id='comment:7'></a>\nSounds convincing, though I would have preferred someone with stronger Cython-fu than me to review the ticket `:-)`. This does make a few generated C files a couple hundred lines smaller, but I didn't notice any significant performance change (either way).",
    "created_at": "2016-06-14T16:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381047",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:7'></a>
Sounds convincing, though I would have preferred someone with stronger Cython-fu than me to review the ticket `:-)`. This does make a few generated C files a couple hundred lines smaller, but I didn't notice any significant performance change (either way).



---

archive/issue_comments_381048.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-14T16:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381048",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_381049.json:
```json
{
    "body": "Reviewer: Marc Mezzarobba",
    "created_at": "2016-06-14T16:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381049",
    "user": "https://github.com/mezzarobba"
}
```

Reviewer: Marc Mezzarobba



---

archive/issue_comments_381050.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [mmezzarobba](#comment%3A7):\n> but I didn't notice any significant performance change (either way).\n\n\nI'm not surprised. The overhead of these checks should be small compared to the actual operation.\n\nThanks for the review of this and related tickets.",
    "created_at": "2016-06-14T20:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381050",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Replying to [mmezzarobba](#comment%3A7):
> but I didn't notice any significant performance change (either way).


I'm not surprised. The overhead of these checks should be small compared to the actual operation.

Thanks for the review of this and related tickets.



---

archive/issue_events_063378.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "rename": {
        "from": "Drop return type from single-underscore arithmetic methods",
        "to": "Drop return type from arithmetic methods in coercion model"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20740#event-63378"
}
```



---

archive/issue_events_063379.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-15T18:47:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20740#event-63379"
}
```



---

archive/issue_comments_381051.json:
```json
{
    "body": "Changing branch from \"[u/jdemeyer/drop_return_type](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/drop_return_type)\" to \"[56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)\"",
    "created_at": "2016-06-15T18:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381051",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/jdemeyer/drop_return_type](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/drop_return_type)" to "[56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)"



---

archive/issue_comments_381052.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-15T18:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381052",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_381053.json:
```json
{
    "body": "Changing commit from \"[56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)\" to \"\"",
    "created_at": "2016-06-15T18:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381053",
    "user": "https://github.com/williamstein"
}
```

Changing commit from "[56776e26371ba92fcab8aaa33500835b78ad64fa](https://github.com/sagemath/sagetrac-mirror/commit/56776e26371ba92fcab8aaa33500835b78ad64fa)" to ""



---

archive/issue_comments_381054.json:
```json
{
    "body": "<a id='comment:12'></a>\ntest",
    "created_at": "2016-06-15T18:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-381054",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:12'></a>
test
