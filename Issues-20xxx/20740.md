# Issue 20740: Drop return type from arithmetic methods in coercion model

archive/issues_020503.json:
```json
{
    "body": "Replace\n\n```\ncpdef ModuleElement _add_(left, ModuleElement right)\n```\nby\n\n```\ncpdef _add_(left, ModuleElement right)\n```\nand similar. The return type serves no purpose:\n1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.\n2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.\n\nAlso remove the superfluous declarations of these methods in other `.pxd` files.\n\nCC:  @videlec\n\nKeywords: days74\n\nReviewer: Marc Mezzarobba\n\nAuthor: Jeroen Demeyer\n\nBranch: 56776e26371ba92fcab8aaa33500835b78ad64fa\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20740\n\n",
    "closed_at": "2016-06-15T18:47:37Z",
    "created_at": "2016-05-31T20:56:56Z",
    "labels": [
        "component: coercion",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Drop return type from arithmetic methods in coercion model",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20740",
    "user": "https://github.com/jdemeyer"
}
```
Replace

```
cpdef ModuleElement _add_(left, ModuleElement right)
```
by

```
cpdef _add_(left, ModuleElement right)
```
and similar. The return type serves no purpose:
1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.
2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.

Also remove the superfluous declarations of these methods in other `.pxd` files.

CC:  @videlec

Keywords: days74

Reviewer: Marc Mezzarobba

Author: Jeroen Demeyer

Branch: 56776e26371ba92fcab8aaa33500835b78ad64fa

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20740





---

archive/issue_comments_301179.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -10,6 +10,8 @@\n ```\n and similar. The return type serves absolutely no purpose.\n \n+Also remove the superfluous declarations of these methods in other `.pxd` files.\n+\n Author: Jeroen Demeyer\n \n Comment: 1\n```\n",
    "created_at": "2016-05-31T21:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301179",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -10,6 +10,8 @@
 ```
 and similar. The return type serves absolutely no purpose.
 
+Also remove the superfluous declarations of these methods in other `.pxd` files.
+
 Author: Jeroen Demeyer
 
 Comment: 1
```




---

archive/issue_comments_301180.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n+Replace\n \n+```\n+cpdef ModuleElement _add_(left, ModuleElement right)\n+```\n+by\n+\n+```\n+cpdef _add_(left, ModuleElement right)\n+```\n+and similar. The return type serves no purpose:\n+1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.\n+2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.\n+\n+Also remove the superfluous declarations of these methods in other `.pxd` files.\n \n Author: Jeroen Demeyer\n \n```\n",
    "created_at": "2016-06-01T08:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301180",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,18 @@
+Replace
 
+```
+cpdef ModuleElement _add_(left, ModuleElement right)
+```
+by
+
+```
+cpdef _add_(left, ModuleElement right)
+```
+and similar. The return type serves no purpose:
+1. if you really do need any information of the return type, then something like `ModuleElement` is too generic anyway.
+2. it forces Cython to add some checks that the returned value is of the correct type, so it might actually slow down things.
+
+Also remove the superfluous declarations of these methods in other `.pxd` files.
 
 Author: Jeroen Demeyer
 
```




---

archive/issue_comments_301181.json:
```json
{
    "body": "<a id='comment:3'></a>(edit: wrong ticket)",
    "created_at": "2016-06-01T08:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301181",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>(edit: wrong ticket)



---

archive/issue_comments_301182.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2016-06-01T10:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301182",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_301183.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-01T10:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301183",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_301184.json:
```json
{
    "body": "Changing keywords from \"\" to \"days74\".",
    "created_at": "2016-06-02T13:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301184",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "days74".



---

archive/issue_comments_301185.json:
```json
{
    "body": "<a id='comment:7'></a>Sounds convincing, though I would have preferred someone with stronger Cython-fu than me to review the ticket `:-)`. This does make a few generated C files a couple hundred lines smaller, but I didn't notice any significant performance change (either way).",
    "created_at": "2016-06-14T16:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301185",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:7'></a>Sounds convincing, though I would have preferred someone with stronger Cython-fu than me to review the ticket `:-)`. This does make a few generated C files a couple hundred lines smaller, but I didn't notice any significant performance change (either way).



---

archive/issue_comments_301186.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-14T16:26:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301186",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_301187.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 mmezzarobba]:\n> but I didn't notice any significant performance change (either way).\n\n\nI'm not surprised. The overhead of these checks should be small compared to the actual operation.\n\nThanks for the review of this and related tickets.",
    "created_at": "2016-06-14T20:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301187",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>Replying to [comment:7 mmezzarobba]:
> but I didn't notice any significant performance change (either way).


I'm not surprised. The overhead of these checks should be small compared to the actual operation.

Thanks for the review of this and related tickets.



---

archive/issue_events_055737.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-15T18:47:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20740#event-55737"
}
```



---

archive/issue_comments_301188.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-15T18:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301188",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_301189.json:
```json
{
    "body": "<a id='comment:12'></a>test",
    "created_at": "2016-06-15T18:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20740",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20740#issuecomment-301189",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:12'></a>test
