# Issue 20471: Change all classic divisions to true divisions in combinat folder

archive/issues_020234.json:
```json
{
    "body": "after #20468, let us take care of the rest of the combinat folder\nso that all test pass when running\n\n```\nexport PYTHONIOENCODING=\"utf-8\"\npython -Qnew $(which sage-runtests) src/sage/combinat/*.py \n```\nin a sage shell.\n\nKeywords: python3, combinat\n\nBranch/Commit: cbeeb2c6514f9b3dcf2d27f04e2e675e93e931fd\n\nReviewer: Jeroen Demeyer, Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nDependencies: #20468\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20471\n\n",
    "closed_at": "2016-04-22T07:13:01Z",
    "created_at": "2016-04-19T20:33:06Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Change all classic divisions to true divisions in combinat folder",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20471",
    "user": "https://github.com/fchapoton"
}
```
after #20468, let us take care of the rest of the combinat folder
so that all test pass when running

```
export PYTHONIOENCODING="utf-8"
python -Qnew $(which sage-runtests) src/sage/combinat/*.py 
```
in a sage shell.

Keywords: python3, combinat

Branch/Commit: cbeeb2c6514f9b3dcf2d27f04e2e675e93e931fd

Reviewer: Jeroen Demeyer, Travis Scrimshaw

Author: Frédéric Chapoton

Dependencies: #20468

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20471





---

archive/issue_comments_371721.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-19T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371721",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_371722.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/20471\"",
    "created_at": "2016-04-19T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371722",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/20471"



---

archive/issue_comments_371723.json:
```json
{
    "body": "Changing commit from \"\" to \"4688e6411e5506ccbcdd70d690658c4d3f26a522\"",
    "created_at": "2016-04-19T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371723",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "4688e6411e5506ccbcdd70d690658c4d3f26a522"



---

archive/issue_comments_371724.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2016-04-19T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371724",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_371725.json:
```json
{
    "body": "<a id='comment:2'></a>General suggestion: add `from __future__ import division` on top of modules which have been fully converted. That way we know for sure that there are no old-style divisions left in that module.",
    "created_at": "2016-04-20T05:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371725",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>General suggestion: add `from __future__ import division` on top of modules which have been fully converted. That way we know for sure that there are no old-style divisions left in that module.



---

archive/issue_comments_371726.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,6 @@\n \n ```\n export PYTHONIOENCODING=\"utf-8\"\n-python -Qwarnall $(which sage-runtests) src/sage/combinat/*.py \n+python -Qnew $(which sage-runtests) src/sage/combinat/*.py \n ```\n in a sage shell.\n``````\n",
    "created_at": "2016-04-20T07:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371726",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,6 @@
 
 ```
 export PYTHONIOENCODING="utf-8"
-python -Qwarnall $(which sage-runtests) src/sage/combinat/*.py 
+python -Qnew $(which sage-runtests) src/sage/combinat/*.py 
 ```
 in a sage shell.
``````




---

archive/issue_comments_371727.json:
```json
{
    "body": "<a id='comment:3'></a>well, I understand, but I only took care of the failing doctests, not of the warnings (that often come from another part of sage, in fact)",
    "created_at": "2016-04-20T07:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371727",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>well, I understand, but I only took care of the failing doctests, not of the warnings (that often come from another part of sage, in fact)



---

archive/issue_comments_371728.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-04-20T08:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371728",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_371729.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:3 chapoton]:\n> I only took care of the failing doctests, not of the warnings (that often come from another part of sage, in fact)\n\n\nI really do not understand what you mean. In fact, it makes me doubt that you understood what I meant:\n\nif you have removed all classic divisions from the `combinat` folder, I recommend to put `from __future__ import division` in the source code of the `sage/combinat/*.py(x)` files. Doing that will ensure that no old-style division can sneak in with future changes. It also makes it very explicit that no further work needs to be done with division in those modules.",
    "created_at": "2016-04-20T08:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371729",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Replying to [comment:3 chapoton]:
> I only took care of the failing doctests, not of the warnings (that often come from another part of sage, in fact)


I really do not understand what you mean. In fact, it makes me doubt that you understood what I meant:

if you have removed all classic divisions from the `combinat` folder, I recommend to put `from __future__ import division` in the source code of the `sage/combinat/*.py(x)` files. Doing that will ensure that no old-style division can sneak in with future changes. It also makes it very explicit that no further work needs to be done with division in those modules.



---

archive/issue_comments_371730.json:
```json
{
    "body": "<a id='comment:7'></a>What I mean is the following.\n\nWith my branch, running `python -Qnew $(which sage-runtests) src/sage/combinat/*.py`\ngives no failing doctests.\n\nBur running `python -Qwarnall $(which sage-runtests) src/sage/combinat/*.py`\nstill gives many warnings. Most of these warnings are related to classic division\nhappening in other parts of sage, but there could be some still happening in /combinat\nwithout affecting the doctests.\n\nI could try to add the `from future import` everywhere in all \\combinat files and\nsee if no problem occurs. Would this be a good idea ?",
    "created_at": "2016-04-20T08:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371730",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>What I mean is the following.

With my branch, running `python -Qnew $(which sage-runtests) src/sage/combinat/*.py`
gives no failing doctests.

Bur running `python -Qwarnall $(which sage-runtests) src/sage/combinat/*.py`
still gives many warnings. Most of these warnings are related to classic division
happening in other parts of sage, but there could be some still happening in /combinat
without affecting the doctests.

I could try to add the `from future import` everywhere in all \combinat files and
see if no problem occurs. Would this be a good idea ?



---

archive/issue_comments_371731.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 chapoton]:\n> Bur running `python -Qwarnall $(which sage-runtests) src/sage/combinat/*.py`\n> still gives many warnings. Most of these warnings are related to classic division\n> happening in other parts of sage\n\nThat does not matter.\n\n> but there could be some still happening in /combinat\n> without affecting the doctests.\n\nThat could only happen if there are divisions which are not executed by any doctest. Let's hope this is not the case... in any case, it is hard to check otherwise.\n\n> I could try to add the `from future import` everywhere in all \\combinat files and\n> see if no problem occurs. Would this be a good idea ?\n\nYes, that is what I meant.",
    "created_at": "2016-04-20T08:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371731",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [comment:7 chapoton]:
> Bur running `python -Qwarnall $(which sage-runtests) src/sage/combinat/*.py`
> still gives many warnings. Most of these warnings are related to classic division
> happening in other parts of sage

That does not matter.

> but there could be some still happening in /combinat
> without affecting the doctests.

That could only happen if there are divisions which are not executed by any doctest. Let's hope this is not the case... in any case, it is hard to check otherwise.

> I could try to add the `from future import` everywhere in all \combinat files and
> see if no problem occurs. Would this be a good idea ?

Yes, that is what I meant.



---

archive/issue_comments_371732.json:
```json
{
    "body": "<a id='comment:9'></a>Question: should I add the `from future` import in **all** of the combinat files, or only in the ones changed here or in #20468 ?",
    "created_at": "2016-04-20T08:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371732",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>Question: should I add the `from future` import in **all** of the combinat files, or only in the ones changed here or in #20468 ?



---

archive/issue_comments_371733.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#20468\"",
    "created_at": "2016-04-20T08:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371733",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#20468"



---

archive/issue_comments_371734.json:
```json
{
    "body": "<a id='comment:10'></a>I thought you checked all of them... in that case: all of them obviously.",
    "created_at": "2016-04-20T08:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371734",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>I thought you checked all of them... in that case: all of them obviously.



---

archive/issue_comments_371735.json:
```json
{
    "body": "Changing commit from \"4688e6411e5506ccbcdd70d690658c4d3f26a522\" to \"fb736f3818af93f9849949f2c7eb97080c4fce27\"",
    "created_at": "2016-04-20T09:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371735",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4688e6411e5506ccbcdd70d690658c4d3f26a522" to "fb736f3818af93f9849949f2c7eb97080c4fce27"



---

archive/issue_comments_371736.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-20T09:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371736",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371737.json:
```json
{
    "body": "<a id='comment:12'></a>But many of them do not use division at all !\n\nWouldn't it be enough to just mark those where I did change something in the divisions ?\n\nOr are we planning to have `from future import division` in **every** single python file in sage ?",
    "created_at": "2016-04-20T09:06:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371737",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>But many of them do not use division at all !

Wouldn't it be enough to just mark those where I did change something in the divisions ?

Or are we planning to have `from future import division` in **every** single python file in sage ?



---

archive/issue_comments_371738.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 chapoton]:\n> Or are we planning to have `from future import division` in **every** single python file in sage ?\n\n\nThis hasn't really been formally discussed. I would be in favour of having it in every module.",
    "created_at": "2016-04-20T09:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371738",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Replying to [comment:12 chapoton]:
> Or are we planning to have `from future import division` in **every** single python file in sage ?


This hasn't really been formally discussed. I would be in favour of having it in every module.



---

archive/issue_comments_371739.json:
```json
{
    "body": "<a id='comment:14'></a>I would prefer not to make a patchbomb right here. \n\nWe maybe can discuss on sage-devel the general question of adding `from future import division` everywhere.\n\nWould you still agree to give a positive review for this ticket in its current state ?",
    "created_at": "2016-04-20T15:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371739",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>I would prefer not to make a patchbomb right here. 

We maybe can discuss on sage-devel the general question of adding `from future import division` everywhere.

Would you still agree to give a positive review for this ticket in its current state ?



---

archive/issue_comments_371740.json:
```json
{
    "body": "<a id='comment:15'></a>In `alternating_sign_matrix`, replace `int(2)` by `2`.",
    "created_at": "2016-04-21T08:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371740",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>In `alternating_sign_matrix`, replace `int(2)` by `2`.



---

archive/issue_comments_371741.json:
```json
{
    "body": "<a id='comment:16'></a>You changed this to really weird spacing: `range(1,len(tst) // 2+1)`\n\nUsually, I don't mind spacing but I just noticed because you actually *changed* it.",
    "created_at": "2016-04-21T08:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371741",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>You changed this to really weird spacing: `range(1,len(tst) // 2+1)`

Usually, I don't mind spacing but I just noticed because you actually *changed* it.



---

archive/issue_comments_371742.json:
```json
{
    "body": "<a id='comment:17'></a>All fine except for the two comments above and the change in `src/sage/combinat/perfect_matching.py` (not because it is wrong, but because it is a non-obvious change that I still need to check).",
    "created_at": "2016-04-21T08:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371742",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>All fine except for the two comments above and the change in `src/sage/combinat/perfect_matching.py` (not because it is wrong, but because it is a non-obvious change that I still need to check).



---

archive/issue_comments_371743.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2016-04-21T08:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371743",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_371744.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2016-04-21T08:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371744",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_371745.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-21T08:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371745",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_371746.json:
```json
{
    "body": "Changing commit from \"fb736f3818af93f9849949f2c7eb97080c4fce27\" to \"cbeeb2c6514f9b3dcf2d27f04e2e675e93e931fd\"",
    "created_at": "2016-04-21T08:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371746",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fb736f3818af93f9849949f2c7eb97080c4fce27" to "cbeeb2c6514f9b3dcf2d27f04e2e675e93e931fd"



---

archive/issue_comments_371747.json:
```json
{
    "body": "<a id='comment:20'></a>The change in `perfect_matching.py` looks okay to me.\n\nIs this ready for review again Fr\u00e9d\u00e9ric?",
    "created_at": "2016-04-21T14:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371747",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>The change in `perfect_matching.py` looks okay to me.

Is this ready for review again Frédéric?



---

archive/issue_comments_371748.json:
```json
{
    "body": "<a id='comment:21'></a>yes, please",
    "created_at": "2016-04-21T14:47:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371748",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>yes, please



---

archive/issue_comments_371749.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-21T14:47:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371749",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_371750.json:
```json
{
    "body": "Changing reviewer from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Travis Scrimshaw\"",
    "created_at": "2016-04-21T14:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371750",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Jeroen Demeyer" to "Jeroen Demeyer, Travis Scrimshaw"



---

archive/issue_comments_371751.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-21T14:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371751",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055359.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-22T07:13:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20471#event-55359"
}
```



---

archive/issue_comments_371752.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-22T07:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371752",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_371753.json:
```json
{
    "body": "Changing branch from \"u/chapoton/20471\" to \"cbeeb2c6514f9b3dcf2d27f04e2e675e93e931fd\"",
    "created_at": "2016-04-22T07:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20471",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20471#issuecomment-371753",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/20471" to "cbeeb2c6514f9b3dcf2d27f04e2e675e93e931fd"
