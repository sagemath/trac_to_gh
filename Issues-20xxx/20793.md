# Issue 20793: Coefficients of a modular form don't coerce into the Hecke eigenfield

archive/issues_020556.json:
```json
{
    "assignees": [],
    "body": "Reported by Kiran Kedlaya on [sage-nt](https://groups.google.com/forum/#!topic/sage-nt/lDu23r0bAYk):\n\n```\nsage: N = Newforms(83,2, names=\"a\")\nsage: f = N[1]\nsage: K = f.hecke_eigenvalue_field()\nsage: print K\nNumber Field in a1 with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8\nsage: l = f.coefficients(20)\nsage: print l[-1].parent()\nNumber Field in alpha with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8\nsage: K(l[-1])\nTraceback (most recent call last):\n...\nTypeError: No compatible natural embeddings found for Number Field in a1 with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8 and Number Field in alpha with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8\n```\nThis can be fixed by returning the coefficients as number field elements in the variable name of the Hecke eigenvalue field instead of `alpha`.\n\nCC:  @kedlaya\n\nBranch/Commit: **[beb2562](https://github.com/sagemath/sagetrac-mirror/commit/beb2562c2c749fcb38891fc551de4e7f1d557f24)**\n\nReviewer: **Julian R\u00fcth, Kiran Kedlaya**\n\nAuthor: **Peter Bruin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20793_\n\n",
    "closed_at": "2016-06-11T22:28:25Z",
    "created_at": "2016-06-09T11:38:15Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20modular%20forms",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Coefficients of a modular form don't coerce into the Hecke eigenfield",
    "type": "issue",
    "updated_at": "2016-06-11T22:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/20793",
    "user": "https://github.com/pjbruin"
}
```
Reported by Kiran Kedlaya on [sage-nt](https://groups.google.com/forum/#!topic/sage-nt/lDu23r0bAYk):

```
sage: N = Newforms(83,2, names="a")
sage: f = N[1]
sage: K = f.hecke_eigenvalue_field()
sage: print K
Number Field in a1 with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8
sage: l = f.coefficients(20)
sage: print l[-1].parent()
Number Field in alpha with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8
sage: K(l[-1])
Traceback (most recent call last):
...
TypeError: No compatible natural embeddings found for Number Field in a1 with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8 and Number Field in alpha with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8
```
This can be fixed by returning the coefficients as number field elements in the variable name of the Hecke eigenvalue field instead of `alpha`.

CC:  @kedlaya

Branch/Commit: **[beb2562](https://github.com/sagemath/sagetrac-mirror/commit/beb2562c2c749fcb38891fc551de4e7f1d557f24)**

Reviewer: **Julian Rüth, Kiran Kedlaya**

Author: **Peter Bruin**

_Issue created by migration from https://trac.sagemath.org/ticket/20793_





---

archive/issue_events_264954.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T11:38:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264954"
}
```



---

archive/issue_events_264955.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T11:38:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20modular%20forms",
    "label_color": "0000ff",
    "label_name": "component: modular forms",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264955"
}
```



---

archive/issue_events_264956.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T11:38:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264956"
}
```



---

archive/issue_events_264957.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T11:38:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264957"
}
```



---

archive/issue_comments_304245.json:
```json
{
    "body": "Commit: **[beb2562](https://github.com/sagemath/sagetrac-mirror/commit/beb2562c2c749fcb38891fc551de4e7f1d557f24)**",
    "created_at": "2016-06-09T11:45:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304245",
    "user": "https://github.com/pjbruin"
}
```

Commit: **[beb2562](https://github.com/sagemath/sagetrac-mirror/commit/beb2562c2c749fcb38891fc551de4e7f1d557f24)**



---

archive/issue_comments_304246.json:
```json
{
    "body": "Branch: **[u/pbruin/20793-Newform_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/20793-Newform_coefficients)**",
    "created_at": "2016-06-09T11:45:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304246",
    "user": "https://github.com/pjbruin"
}
```

Branch: **[u/pbruin/20793-Newform_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/20793-Newform_coefficients)**



---

archive/issue_events_264958.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T11:45:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264958"
}
```



---

archive/issue_comments_304247.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nMy local sage does not build right now so I could not test this. Feel free to set it to positive review yourself once the patchbot tested it or if you have run all tests yourself.",
    "created_at": "2016-06-09T15:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304247",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:2'>Comment 2:</a>
My local sage does not build right now so I could not test this. Feel free to set it to positive review yourself once the patchbot tested it or if you have run all tests yourself.



---

archive/issue_comments_304248.json:
```json
{
    "body": "Reviewer: **Julian R\u00fcth**",
    "created_at": "2016-06-09T15:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304248",
    "user": "https://github.com/saraedum"
}
```

Reviewer: **Julian Rüth**



---

archive/issue_comments_304249.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nReplying to [@saraedum](#comment%3A2):\n> My local sage does not build right now so I could not test this. Feel free to set it to positive review yourself once the patchbot tested it or if you have run all tests yourself.\n\nTests pass, thanks for your review.",
    "created_at": "2016-06-09T16:27:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304249",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:3'>Comment 3:</a>
Replying to [@saraedum](#comment%3A2):
> My local sage does not build right now so I could not test this. Feel free to set it to positive review yourself once the patchbot tested it or if you have run all tests yourself.

Tests pass, thanks for your review.



---

archive/issue_events_264959.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T16:27:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264959"
}
```



---

archive/issue_events_264960.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2016-06-09T16:27:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264960"
}
```



---

archive/issue_comments_304250.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI will run `make ptestlong` on my local build just to confirm, but it looks fine to me too.",
    "created_at": "2016-06-09T18:14:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304250",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:4'>Comment 4:</a>
I will run `make ptestlong` on my local build just to confirm, but it looks fine to me too.



---

archive/issue_comments_304251.json:
```json
{
    "body": "Changed reviewer from **Julian R\u00fcth** to **Julian R\u00fcth, Kiran Kedlaya**",
    "created_at": "2016-06-09T20:34:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304251",
    "user": "https://github.com/kedlaya"
}
```

Changed reviewer from **Julian Rüth** to **Julian Rüth, Kiran Kedlaya**



---

archive/issue_comments_304252.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\n... and indeed all tests pass for me.",
    "created_at": "2016-06-09T20:34:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304252",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:5'>Comment 5:</a>
... and indeed all tests pass for me.



---

archive/issue_events_264961.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-11T22:28:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264961"
}
```



---

archive/issue_events_264962.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b58ef95005d773b92949eb75403786990047adfd",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-06-11T22:28:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20793#event-264962"
}
```



---

archive/issue_comments_304253.json:
```json
{
    "body": "Changed branch from **[u/pbruin/20793-Newform_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/20793-Newform_coefficients)** to **[beb2562](https://github.com/sagemath/sagetrac-mirror/commit/beb2562c2c749fcb38891fc551de4e7f1d557f24)**",
    "created_at": "2016-06-11T22:28:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20793#issuecomment-304253",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/pbruin/20793-Newform_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/20793-Newform_coefficients)** to **[beb2562](https://github.com/sagemath/sagetrac-mirror/commit/beb2562c2c749fcb38891fc551de4e7f1d557f24)**
