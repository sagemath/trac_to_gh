# Issue 20788: Compute dimensions of individual generalized eigenspaces

archive/issues_020551.json:
```json
{
    "body": "Given a square matrix `M` over a field and an element `t` of the field, it is easy to compute the dimension of the left eigenspace of `M` with eigenvalue `t`, by computing the rank of `M-t` and subtracting it from the dimension of `M`. There should be a method for this.\n\nComputing the multiplicity of the generalized eigenspace is slightly more involved, but also not difficult. There should be a method for this too; I already have it written and will get it onto this ticket soon.\n\nIt would also be useful to have methods returning eigenspaces and generalized eigenspaces for individual eigenvalues, without computing all of them.\n\nCC:  gregorybard\n\nKeywords: matrices, eigenspaces, dimension, days88, IMA coding sprints\n\nBranch/Commit: 675cc94a41e3d79576619b20830d5190e3ea439c\n\nReviewer: Travis Scrimshaw\n\nAuthor: Kiran Kedlaya\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20788\n\n",
    "closed_at": "2017-09-10T11:56:35Z",
    "created_at": "2016-06-09T00:13:55Z",
    "labels": [
        "component: linear algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Compute dimensions of individual generalized eigenspaces",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20788",
    "user": "https://github.com/kedlaya"
}
```
Given a square matrix `M` over a field and an element `t` of the field, it is easy to compute the dimension of the left eigenspace of `M` with eigenvalue `t`, by computing the rank of `M-t` and subtracting it from the dimension of `M`. There should be a method for this.

Computing the multiplicity of the generalized eigenspace is slightly more involved, but also not difficult. There should be a method for this too; I already have it written and will get it onto this ticket soon.

It would also be useful to have methods returning eigenspaces and generalized eigenspaces for individual eigenvalues, without computing all of them.

CC:  gregorybard

Keywords: matrices, eigenspaces, dimension, days88, IMA coding sprints

Branch/Commit: 675cc94a41e3d79576619b20830d5190e3ea439c

Reviewer: Travis Scrimshaw

Author: Kiran Kedlaya

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20788





---

archive/issue_comments_379183.json:
```json
{
    "body": "Changing commit from \"\" to \"567e5ddbe0fc299760efbc51a397dd401ab7bc55\"",
    "created_at": "2016-08-22T03:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379183",
    "user": "https://github.com/kedlaya"
}
```

Changing commit from "" to "567e5ddbe0fc299760efbc51a397dd401ab7bc55"



---

archive/issue_comments_379184.json:
```json
{
    "body": "<a id='comment:1'></a>Here is a patch with the function I proposed. I could use some more robust doctests; any suggestions?\n\n---\nNew commits:",
    "created_at": "2016-08-22T03:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379184",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:1'></a>Here is a patch with the function I proposed. I could use some more robust doctests; any suggestions?

---
New commits:



---

archive/issue_comments_379185.json:
```json
{
    "body": "Changing branch from \"\" to \"u/kedlaya/compute_dimensions_of_individual_generalized_eigenspaces\"",
    "created_at": "2016-08-22T03:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379185",
    "user": "https://github.com/kedlaya"
}
```

Changing branch from "" to "u/kedlaya/compute_dimensions_of_individual_generalized_eigenspaces"



---

archive/issue_comments_379186.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-22T03:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379186",
    "user": "https://github.com/kedlaya"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_379187.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-22T03:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379188.json:
```json
{
    "body": "Changing commit from \"567e5ddbe0fc299760efbc51a397dd401ab7bc55\" to \"48f84b02664dc7f5be4f5ac508d960bb1cada924\"",
    "created_at": "2016-08-22T03:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "567e5ddbe0fc299760efbc51a397dd401ab7bc55" to "48f84b02664dc7f5be4f5ac508d960bb1cada924"



---

archive/issue_comments_379189.json:
```json
{
    "body": "<a id='comment:3'></a>Some experimental evidence suggests that this function leaks memory in a serious way; presumably one of the steps is at fault, but I haven't been able to isolate which one. Might be a job for valgrind here.",
    "created_at": "2016-08-29T00:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379189",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:3'></a>Some experimental evidence suggests that this function leaks memory in a serious way; presumably one of the steps is at fault, but I haven't been able to isolate which one. Might be a job for valgrind here.



---

archive/issue_comments_379190.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-03T19:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379191.json:
```json
{
    "body": "Changing commit from \"48f84b02664dc7f5be4f5ac508d960bb1cada924\" to \"f99e384d196f210e3fc1379cb00e3d167032c14f\"",
    "created_at": "2016-09-03T19:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "48f84b02664dc7f5be4f5ac508d960bb1cada924" to "f99e384d196f210e3fc1379cb00e3d167032c14f"



---

archive/issue_comments_379192.json:
```json
{
    "body": "<a id='comment:5'></a>I added a step to square the matrix at each iteration; this reduces the dependence on the nilpotency index from linear to logarithmic. I think this is a win on average: the only issue is doing extra matrix mults when the index is small, but this isn't too costly compared to the echelonization anyway.",
    "created_at": "2016-09-03T19:57:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379192",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:5'></a>I added a step to square the matrix at each iteration; this reduces the dependence on the nilpotency index from linear to logarithmic. I think this is a win on average: the only issue is doing extra matrix mults when the index is small, but this isn't too costly compared to the echelonization anyway.



---

archive/issue_comments_379193.json:
```json
{
    "body": "Changing commit from \"f99e384d196f210e3fc1379cb00e3d167032c14f\" to \"f3ec6e07810fa5b6ca41aeff71430220d191d02b\"",
    "created_at": "2017-04-17T09:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379193",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "f99e384d196f210e3fc1379cb00e3d167032c14f" to "f3ec6e07810fa5b6ca41aeff71430220d191d02b"



---

archive/issue_comments_379194.json:
```json
{
    "body": "<a id='comment:6'></a>I added a few doctests.\n\n---\nNew commits:",
    "created_at": "2017-04-17T09:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379194",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>I added a few doctests.

---
New commits:



---

archive/issue_comments_379195.json:
```json
{
    "body": "Changing branch from \"u/kedlaya/compute_dimensions_of_individual_generalized_eigenspaces\" to \"public/20788\"",
    "created_at": "2017-04-17T09:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379195",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "u/kedlaya/compute_dimensions_of_individual_generalized_eigenspaces" to "public/20788"



---

archive/issue_events_055806.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-17T09:16:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20788#event-55806"
}
```



---

archive/issue_comments_379196.json:
```json
{
    "body": "<a id='comment:8'></a>Those doctests look good to me.",
    "created_at": "2017-08-23T15:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379196",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:8'></a>Those doctests look good to me.



---

archive/issue_comments_379197.json:
```json
{
    "body": "Changing author from \"\" to \"Kiran Kedlaya\"",
    "created_at": "2017-08-23T15:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379197",
    "user": "https://github.com/kedlaya"
}
```

Changing author from "" to "Kiran Kedlaya"



---

archive/issue_comments_379198.json:
```json
{
    "body": "Changing commit from \"f3ec6e07810fa5b6ca41aeff71430220d191d02b\" to \"a4be0dec3aed81e4380cdf0459a1eb54b62eef91\"",
    "created_at": "2017-08-23T18:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f3ec6e07810fa5b6ca41aeff71430220d191d02b" to "a4be0dec3aed81e4380cdf0459a1eb54b62eef91"



---

archive/issue_comments_379199.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-23T18:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379200.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-23T18:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379200",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379201.json:
```json
{
    "body": "Changing commit from \"a4be0dec3aed81e4380cdf0459a1eb54b62eef91\" to \"fe830a56aebd717d817d8671bc0ecaefd050a674\"",
    "created_at": "2017-08-23T18:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379201",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a4be0dec3aed81e4380cdf0459a1eb54b62eef91" to "fe830a56aebd717d817d8671bc0ecaefd050a674"



---

archive/issue_events_055807.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-23T19:10:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20788#event-55807"
}
```



---

archive/issue_events_055808.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-23T19:10:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20788#event-55808"
}
```



---

archive/issue_comments_379202.json:
```json
{
    "body": "<a id='comment:11'></a>One trivial thing: ``s`` -> ```s``` since the `s` is considered in that as code. Once done, you can set a positive review on my behalf.",
    "created_at": "2017-08-23T19:10:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379202",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>One trivial thing: ``s`` -> ```s``` since the `s` is considered in that as code. Once done, you can set a positive review on my behalf.



---

archive/issue_comments_379203.json:
```json
{
    "body": "Changing keywords from \"matrices, eigenspaces, dimension\" to \"matrices, eigenspaces, dimension, days88, IME coding sprints\".",
    "created_at": "2017-08-23T19:10:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379203",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "matrices, eigenspaces, dimension" to "matrices, eigenspaces, dimension, days88, IME coding sprints".



---

archive/issue_comments_379204.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-08-23T19:10:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379204",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_379205.json:
```json
{
    "body": "Changing keywords from \"matrices, eigenspaces, dimension, days88, IME coding sprints\" to \"matrices, eigenspaces, dimension, days88, IMA coding sprints\".",
    "created_at": "2017-08-23T19:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379205",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "matrices, eigenspaces, dimension, days88, IME coding sprints" to "matrices, eigenspaces, dimension, days88, IMA coding sprints".



---

archive/issue_comments_379206.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-23T20:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379207.json:
```json
{
    "body": "Changing commit from \"fe830a56aebd717d817d8671bc0ecaefd050a674\" to \"675cc94a41e3d79576619b20830d5190e3ea439c\"",
    "created_at": "2017-08-23T20:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fe830a56aebd717d817d8671bc0ecaefd050a674" to "675cc94a41e3d79576619b20830d5190e3ea439c"



---

archive/issue_comments_379208.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [tscrim](#comment%3A11):\n> One trivial thing: ``s`` -> ```s``` since the `s` is considered in that as code. Once done, you can set a positive review on my behalf.\n\n\nDone and done.",
    "created_at": "2017-08-23T20:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379208",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:14'></a>Replying to [tscrim](#comment%3A11):
> One trivial thing: ``s`` -> ```s``` since the `s` is considered in that as code. Once done, you can set a positive review on my behalf.


Done and done.



---

archive/issue_comments_379209.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-23T20:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379209",
    "user": "https://github.com/kedlaya"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-10T11:56:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20788#event-55809"
}
```



---

archive/issue_comments_379210.json:
```json
{
    "body": "Changing branch from \"public/20788\" to \"675cc94a41e3d79576619b20830d5190e3ea439c\"",
    "created_at": "2017-09-10T11:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379210",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/20788" to "675cc94a41e3d79576619b20830d5190e3ea439c"



---

archive/issue_comments_379211.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-10T11:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20788#issuecomment-379211",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
