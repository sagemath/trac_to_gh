# Issue 20226: Implement conversion PARI <-> Python int/long without GMP/MPIR

archive/issues_019989.json:
```json
{
    "body": "Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.\n\nCC:  @defeo jpflori\n\nKeywords: days77, days74\n\nBranch/Commit: b55085547315715f292fd08ce74ad5a437abc6a5\n\nReviewer: Luca De Feo, Vincent Delecroix\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20226\n\n",
    "closed_at": "2016-05-31T22:53:55Z",
    "created_at": "2016-03-17T09:46:36Z",
    "labels": [
        "component: interfaces"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Implement conversion PARI <-> Python int/long without GMP/MPIR",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20226",
    "user": "https://github.com/jdemeyer"
}
```
Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.

CC:  @defeo jpflori

Keywords: days77, days74

Branch/Commit: b55085547315715f292fd08ce74ad5a437abc6a5

Reviewer: Luca De Feo, Vincent Delecroix

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20226





---

archive/issue_comments_366244.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/ticket/20226\"",
    "created_at": "2016-03-18T11:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366244",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/ticket/20226"



---

archive/issue_comments_366245.json:
```json
{
    "body": "Changing commit from \"\" to \"e871a64ead4b259543612e2c247a9aaf0cf1bf12\"",
    "created_at": "2016-03-18T11:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366245",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "e871a64ead4b259543612e2c247a9aaf0cf1bf12"



---

archive/issue_comments_366246.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Convert PARI integers to/from Python integers without relying on the GMP/MPIR library.\n+Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.\n``````\n",
    "created_at": "2016-03-18T11:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366246",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Convert PARI integers to/from Python integers without relying on the GMP/MPIR library.
+Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.
``````




---

archive/issue_comments_366247.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[03458ea](http://git.sagemath.org/sage.git/commit/?id=03458ea28f8d10c4103f6cdecbf018115c71e889)|`Upgrade cysignals package`|\n|[dce67fc](http://git.sagemath.org/sage.git/commit/?id=dce67fca49e515ce610539263e1e7a6f26c7bc69)|`Move memory functions to cysignals`|\n|[4bb8337](http://git.sagemath.org/sage.git/commit/?id=4bb8337295ed82c93d1a9c9f7173a4c36f97151d)|`Rename sage_malloc -> sig_malloc and friends`|\n|[5ab73c1](http://git.sagemath.org/sage.git/commit/?id=5ab73c1c098478da766a061109a2a248d741e49e)|`Get rid of factorint_withproof_sage in PARI interface`|\n|[c0ed97a](http://git.sagemath.org/sage.git/commit/?id=c0ed97a0b2a036c3a4677d8e5dbabf6b2a6d54fc)|`Stop using deprecated PARI factoring features`|\n|[edc5ce2](http://git.sagemath.org/sage.git/commit/?id=edc5ce28655f157a13f27d2d94ae2e5d5d731bd6)|`Merge branch 't/20205/get_rid_of_factorint_withproof_sage_in_pari_interface' into HEAD`|\n|[5fb408d](http://git.sagemath.org/sage.git/commit/?id=5fb408dedb22e4147ee68ae5656e643b4f1df06c)|`Replace pari_catch_sig_on by sig_on`|\n|[d5c934c](http://git.sagemath.org/sage.git/commit/?id=d5c934c5164255e352cee9ddbc780d0759b6e185)|`Deprecate PARI nth_prime and prime_list`|\n|[d7d2d7d](http://git.sagemath.org/sage.git/commit/?id=d7d2d7df24760cdecf0d6585972d2bf6140c1123)|`Remove redundant functions from pari_instance.pyx`|\n|[e871a64](http://git.sagemath.org/sage.git/commit/?id=e871a64ead4b259543612e2c247a9aaf0cf1bf12)|`Implement conversion PARI <-> Python int/long without mpz`|",
    "created_at": "2016-03-18T11:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366247",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                           |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[03458ea](http://git.sagemath.org/sage.git/commit/?id=03458ea28f8d10c4103f6cdecbf018115c71e889)|`Upgrade cysignals package`|
|[dce67fc](http://git.sagemath.org/sage.git/commit/?id=dce67fca49e515ce610539263e1e7a6f26c7bc69)|`Move memory functions to cysignals`|
|[4bb8337](http://git.sagemath.org/sage.git/commit/?id=4bb8337295ed82c93d1a9c9f7173a4c36f97151d)|`Rename sage_malloc -> sig_malloc and friends`|
|[5ab73c1](http://git.sagemath.org/sage.git/commit/?id=5ab73c1c098478da766a061109a2a248d741e49e)|`Get rid of factorint_withproof_sage in PARI interface`|
|[c0ed97a](http://git.sagemath.org/sage.git/commit/?id=c0ed97a0b2a036c3a4677d8e5dbabf6b2a6d54fc)|`Stop using deprecated PARI factoring features`|
|[edc5ce2](http://git.sagemath.org/sage.git/commit/?id=edc5ce28655f157a13f27d2d94ae2e5d5d731bd6)|`Merge branch 't/20205/get_rid_of_factorint_withproof_sage_in_pari_interface' into HEAD`|
|[5fb408d](http://git.sagemath.org/sage.git/commit/?id=5fb408dedb22e4147ee68ae5656e643b4f1df06c)|`Replace pari_catch_sig_on by sig_on`|
|[d5c934c](http://git.sagemath.org/sage.git/commit/?id=d5c934c5164255e352cee9ddbc780d0759b6e185)|`Deprecate PARI nth_prime and prime_list`|
|[d7d2d7d](http://git.sagemath.org/sage.git/commit/?id=d7d2d7df24760cdecf0d6585972d2bf6140c1123)|`Remove redundant functions from pari_instance.pyx`|
|[e871a64](http://git.sagemath.org/sage.git/commit/?id=e871a64ead4b259543612e2c247a9aaf0cf1bf12)|`Implement conversion PARI <-> Python int/long without mpz`|



---

archive/issue_comments_366248.json:
```json
{
    "body": "Changing dependencies from \"#20210, #20205, #20213, #20216, #20217\" to \"#20210, #20205, #20213, #20216, #20217, #20231\"",
    "created_at": "2016-03-18T14:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366248",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#20210, #20205, #20213, #20216, #20217" to "#20210, #20205, #20213, #20216, #20217, #20231"



---

archive/issue_comments_366249.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-18T17:59:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366249",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_366250.json:
```json
{
    "body": "Changing commit from \"e871a64ead4b259543612e2c247a9aaf0cf1bf12\" to \"c5f9892d7db87ba858c4cc6131e379796cbe7769\"",
    "created_at": "2016-04-03T19:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e871a64ead4b259543612e2c247a9aaf0cf1bf12" to "c5f9892d7db87ba858c4cc6131e379796cbe7769"



---

archive/issue_comments_366251.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[c5f9892](http://git.sagemath.org/sage.git/commit/?id=c5f9892d7db87ba858c4cc6131e379796cbe7769)|`Implement conversion PARI <-> Python int/long without mpz`|",
    "created_at": "2016-04-03T19:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[c5f9892](http://git.sagemath.org/sage.git/commit/?id=c5f9892d7db87ba858c4cc6131e379796cbe7769)|`Implement conversion PARI <-> Python int/long without mpz`|



---

archive/issue_comments_366252.json:
```json
{
    "body": "Changing dependencies from \"#20210, #20205, #20213, #20216, #20217, #20231\" to \"\"",
    "created_at": "2016-04-03T19:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366252",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#20210, #20205, #20213, #20216, #20217, #20231" to ""



---

archive/issue_events_054950.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-03T19:07:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54950"
}
```



---

archive/issue_comments_366253.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt runs ok and all tests pass.\n\nMinor drawbacks:\n- it would be useful to have links to the Python and Pari longint specs.\n- I am personally against `from ... import *`, but won't block the ticket if you want to keep it.",
    "created_at": "2016-04-05T09:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366253",
    "user": "https://github.com/defeo"
}
```

<a id='comment:7'></a>
It runs ok and all tests pass.

Minor drawbacks:
- it would be useful to have links to the Python and Pari longint specs.
- I am personally against `from ... import *`, but won't block the ticket if you want to keep it.



---

archive/issue_comments_366254.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[fa2081d](http://git.sagemath.org/sage.git/commit/?id=fa2081de3e7b906b60909ed6ea7988ee496d3a59)|`Add some documentation for PARI conversion`|",
    "created_at": "2016-04-05T11:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366254",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[fa2081d](http://git.sagemath.org/sage.git/commit/?id=fa2081de3e7b906b60909ed6ea7988ee496d3a59)|`Add some documentation for PARI conversion`|



---

archive/issue_comments_366255.json:
```json
{
    "body": "Changing commit from \"c5f9892d7db87ba858c4cc6131e379796cbe7769\" to \"fa2081de3e7b906b60909ed6ea7988ee496d3a59\"",
    "created_at": "2016-04-05T11:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c5f9892d7db87ba858c4cc6131e379796cbe7769" to "fa2081de3e7b906b60909ed6ea7988ee496d3a59"



---

archive/issue_comments_366256.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-05T14:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366256",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_366257.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Luca De Feo\"",
    "created_at": "2016-04-05T14:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366257",
    "user": "https://github.com/defeo"
}
```

Changing reviewer from "" to "Luca De Feo"



---

archive/issue_comments_366258.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks",
    "created_at": "2016-04-05T14:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366258",
    "user": "https://github.com/defeo"
}
```

<a id='comment:9'></a>
Thanks



---

archive/issue_comments_366259.json:
```json
{
    "body": "<a id='comment:10'></a>\n\n```\nsage -t --long src/sage/libs/pari/gen.pyx\n**********************************************************************\nFile \"src/sage/libs/pari/gen.pyx\", line 1343, in sage.libs.pari.gen.gen.__int__\nFailed example:\n    int(pari(-2^31))\nExpected:\n    -2147483648\nGot:\n    -2147483648L\n**********************************************************************\n```",
    "created_at": "2016-04-06T07:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366259",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>

```
sage -t --long src/sage/libs/pari/gen.pyx
**********************************************************************
File "src/sage/libs/pari/gen.pyx", line 1343, in sage.libs.pari.gen.gen.__int__
Failed example:
    int(pari(-2^31))
Expected:
    -2147483648
Got:
    -2147483648L
**********************************************************************
```



---

archive/issue_comments_366260.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-04-06T08:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366260",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_366261.json:
```json
{
    "body": "<a id='comment:12'></a>\nThat's a PARI bug...",
    "created_at": "2016-04-06T10:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366261",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
That's a PARI bug...



---

archive/issue_comments_366262.json:
```json
{
    "body": "Changing commit from \"fa2081de3e7b906b60909ed6ea7988ee496d3a59\" to \"47df94cc7c5181f99717d164b1929c516d039ec1\"",
    "created_at": "2016-04-06T16:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fa2081de3e7b906b60909ed6ea7988ee496d3a59" to "47df94cc7c5181f99717d164b1929c516d039ec1"



---

archive/issue_comments_366263.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[47df94c](http://git.sagemath.org/sage.git/commit/?id=47df94cc7c5181f99717d164b1929c516d039ec1)|`Fix conversion of pari(LONG_MIN) to Python int`|",
    "created_at": "2016-04-06T16:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366263",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[47df94c](http://git.sagemath.org/sage.git/commit/?id=47df94cc7c5181f99717d164b1929c516d039ec1)|`Fix conversion of pari(LONG_MIN) to Python int`|



---

archive/issue_comments_366264.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-06T16:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366264",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_366265.json:
```json
{
    "body": "<a id='comment:15'></a>\nIt's not a PARI bug, it's a PARI *feature* :-)",
    "created_at": "2016-04-06T16:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366265",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
It's not a PARI bug, it's a PARI *feature* :-)



---

archive/issue_comments_366266.json:
```json
{
    "body": "Changing keywords from \"\" to \"days77\".",
    "created_at": "2016-04-08T20:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366266",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "days77".



---

archive/issue_comments_366267.json:
```json
{
    "body": "<a id='comment:17'></a>\nWould it be possible to test the subtle `LONG_MIN` case in `gen_to_integer`? Maybe along\n\n```\nsage: a = gen_to_integer(pari(\"2^63-1\")); a; type(a)\n9223372036854775807\n<type 'int'>\nsage: a = gen_to_integer(pari(\"2^63\")); a; type(a)\n9223372036854775808L\n<type 'long'>\nsage: a = gen_to_integer(pari(\"-2^63\")); a; type(a)\n-9223372036854775808\n<type 'int'>\nsage: a = gen_to_integer(pari(\"-2^63-1\")); a; type(a)\n-9223372036854775809L\n<type 'long'>\n```\n\nWhat do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.",
    "created_at": "2016-04-15T18:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366267",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
Would it be possible to test the subtle `LONG_MIN` case in `gen_to_integer`? Maybe along

```
sage: a = gen_to_integer(pari("2^63-1")); a; type(a)
9223372036854775807
<type 'int'>
sage: a = gen_to_integer(pari("2^63")); a; type(a)
9223372036854775808L
<type 'long'>
sage: a = gen_to_integer(pari("-2^63")); a; type(a)
-9223372036854775808
<type 'int'>
sage: a = gen_to_integer(pari("-2^63-1")); a; type(a)
-9223372036854775809L
<type 'long'>
```

What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.



---

archive/issue_comments_366268.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [vdelecroix](#comment%3A17):\n> What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.\n\n\nAre you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?",
    "created_at": "2016-04-15T18:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366268",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [vdelecroix](#comment%3A17):
> What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.


Are you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?



---

archive/issue_comments_366269.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-15T18:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366269",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_366270.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jdemeyer](#comment%3A18):\n> Replying to [vdelecroix](#comment%3A17):\n> > What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.\n\n> \n> Are you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?\n\n\nSadly not (I am until september in Santiago de Chile). However, I can submit a patch if not already done.",
    "created_at": "2016-04-15T19:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366270",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>
Replying to [jdemeyer](#comment%3A18):
> Replying to [vdelecroix](#comment%3A17):
> > What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.

> 
> Are you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?


Sadly not (I am until september in Santiago de Chile). However, I can submit a patch if not already done.



---

archive/issue_comments_366271.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [vdelecroix](#comment%3A20):\n> Sadly not (I am until september in Santiago de Chile).\n\n\nDoesn't sound so sad :-)\n\n> However, I can submit a patch if not already done.\n\n\nFor the moment, I lack the mental energy to try to push yet another patch to upstream PARI...",
    "created_at": "2016-04-15T19:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366271",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Replying to [vdelecroix](#comment%3A20):
> Sadly not (I am until september in Santiago de Chile).


Doesn't sound so sad :-)

> However, I can submit a patch if not already done.


For the moment, I lack the mental energy to try to push yet another patch to upstream PARI...



---

archive/issue_comments_366272.json:
```json
{
    "body": "Changing reviewer from \"Luca De Feo\" to \"Luca De Feo, Vincent Delecroix\"",
    "created_at": "2016-04-20T10:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366272",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Luca De Feo" to "Luca De Feo, Vincent Delecroix"



---

archive/issue_comments_366273.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[8668603](http://git.sagemath.org/sage.git/commit/?id=8668603e309601df7321762e499c1a2063c35fa3)|`Add doctests for corner cases`|",
    "created_at": "2016-04-20T10:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366273",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[8668603](http://git.sagemath.org/sage.git/commit/?id=8668603e309601df7321762e499c1a2063c35fa3)|`Add doctests for corner cases`|



---

archive/issue_comments_366274.json:
```json
{
    "body": "Changing commit from \"47df94cc7c5181f99717d164b1929c516d039ec1\" to \"8668603e309601df7321762e499c1a2063c35fa3\"",
    "created_at": "2016-04-20T10:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366274",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "47df94cc7c5181f99717d164b1929c516d039ec1" to "8668603e309601df7321762e499c1a2063c35fa3"



---

archive/issue_comments_366275.json:
```json
{
    "body": "<a id='comment:24'></a>\nI added a test which checks that the conversion of integers via PARI is the same as the Python conversion `str -> int`. By checking that the result is the same as Python, we don't need to special-case 32-bit vs. 64-bit.",
    "created_at": "2016-04-20T10:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366275",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
I added a test which checks that the conversion of integers via PARI is the same as the Python conversion `str -> int`. By checking that the result is the same as Python, we don't need to special-case 32-bit vs. 64-bit.



---

archive/issue_comments_366276.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-20T10:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366276",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_366277.json:
```json
{
    "body": "<a id='comment:25'></a>\nSo, what specifically was the issue with this that it required blacklisting GCC 4.8?  Is there a simple way to reproduce the issue, or at least a specific doctest that exhibits it that I could run?",
    "created_at": "2016-04-22T13:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366277",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
So, what specifically was the issue with this that it required blacklisting GCC 4.8?  Is there a simple way to reproduce the issue, or at least a specific doctest that exhibits it that I could run?



---

archive/issue_comments_366278.json:
```json
{
    "body": "<a id='comment:26'></a>\nIt was some doctest in `src/sage/libs/pari/convert.pyx`. Let me know if you're unable to reproduce it.",
    "created_at": "2016-04-22T13:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366278",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
It was some doctest in `src/sage/libs/pari/convert.pyx`. Let me know if you're unable to reproduce it.



---

archive/issue_comments_366279.json:
```json
{
    "body": "<a id='comment:27'></a>\nOkay, I'll give it a look.  I appreciate the need for the blacklisting *for now* just to get moving on things.  But it will be good to fix if I can. I have set `SAGE_INSTALL_GCC=no` on my system, but that will mean I'll ultimately have a broken Sage if we can't resolve this :(",
    "created_at": "2016-04-25T10:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366279",
    "user": "https://github.com/embray"
}
```

<a id='comment:27'></a>
Okay, I'll give it a look.  I appreciate the need for the blacklisting *for now* just to get moving on things.  But it will be good to fix if I can. I have set `SAGE_INSTALL_GCC=no` on my system, but that will mean I'll ultimately have a broken Sage if we can't resolve this :(



---

archive/issue_comments_366280.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[c2305c0](http://git.sagemath.org/sage.git/commit/?id=c2305c0758b40062bcba18a183105a3e73ba2019)|`Merge tag '7.2' into t/20226/ticket/20226`|\n|[b550855](http://git.sagemath.org/sage.git/commit/?id=b55085547315715f292fd08ce74ad5a437abc6a5)|`Fix compiler flag for GCC 4.8 issue`|",
    "created_at": "2016-05-17T12:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366280",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[c2305c0](http://git.sagemath.org/sage.git/commit/?id=c2305c0758b40062bcba18a183105a3e73ba2019)|`Merge tag '7.2' into t/20226/ticket/20226`|
|[b550855](http://git.sagemath.org/sage.git/commit/?id=b55085547315715f292fd08ce74ad5a437abc6a5)|`Fix compiler flag for GCC 4.8 issue`|



---

archive/issue_comments_366281.json:
```json
{
    "body": "Changing commit from \"8668603e309601df7321762e499c1a2063c35fa3\" to \"b55085547315715f292fd08ce74ad5a437abc6a5\"",
    "created_at": "2016-05-17T12:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366281",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8668603e309601df7321762e499c1a2063c35fa3" to "b55085547315715f292fd08ce74ad5a437abc6a5"



---

archive/issue_comments_366282.json:
```json
{
    "body": "<a id='comment:30'></a>\nI'm now using the flag `-fno-tree-copyrename` which seems to fix all instances of the GCC 4.8 problem.",
    "created_at": "2016-05-17T19:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366282",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
I'm now using the flag `-fno-tree-copyrename` which seems to fix all instances of the GCC 4.8 problem.



---

archive/issue_comments_366283.json:
```json
{
    "body": "<a id='comment:31'></a>\nInteresting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.\n\nThis might have something to do with it: https://gcc.gnu.org/ml/gcc-patches/2015-03/msg01460.html",
    "created_at": "2016-05-19T10:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366283",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'></a>
Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.

This might have something to do with it: https://gcc.gnu.org/ml/gcc-patches/2015-03/msg01460.html



---

archive/issue_comments_366284.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [embray](#comment%3A31):\n> Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.\n\n\nThe problem is indeed fixed in GCC-4.9, see http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982",
    "created_at": "2016-05-19T11:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366284",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>
Replying to [embray](#comment%3A31):
> Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.


The problem is indeed fixed in GCC-4.9, see http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982



---

archive/issue_comments_366285.json:
```json
{
    "body": "<a id='comment:33'></a>\nCould you use the macro `Py_SIZE` instead of calling `py_long_object->ob_size`? In particular, it will simplify the switch to Python3. Sadly, Cython does not accept the macro expansion `Py_SIZE(my_object) = whatever` and the C-API does not document an alternative way of doing things.",
    "created_at": "2016-05-30T09:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366285",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'></a>
Could you use the macro `Py_SIZE` instead of calling `py_long_object->ob_size`? In particular, it will simplify the switch to Python3. Sadly, Cython does not accept the macro expansion `Py_SIZE(my_object) = whatever` and the C-API does not document an alternative way of doing things.



---

archive/issue_comments_366286.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [vdelecroix](#comment%3A33):\n> In particular, it will simplify the switch to Python3.\n\n\nI don't understand why: `ob_size` still exists in Python 3.\n\nEspecially given that we cannot assign to `Py_SIZE()`, I don't really see the point.",
    "created_at": "2016-05-30T09:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366286",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
Replying to [vdelecroix](#comment%3A33):
> In particular, it will simplify the switch to Python3.


I don't understand why: `ob_size` still exists in Python 3.

Especially given that we cannot assign to `Py_SIZE()`, I don't really see the point.



---

archive/issue_comments_366287.json:
```json
{
    "body": "<a id='comment:35'></a>\nIn Python 3 `(<PyLongObject*>x).ob_size` just doesn't compile\n\n```\n.../cython_test.c: In function \u2018__pyx_pf_11cython_test_f\u2019:\n.../cython_test.c:593:61: error: \u2018PyLongObject\u2019 has no member named \u2018ob_size\u2019\n   __pyx_t_1 = PyInt_FromSsize_t(((PyLongObject *)__pyx_v_s)->ob_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}                                           \n```",
    "created_at": "2016-05-30T10:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366287",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>
In Python 3 `(<PyLongObject*>x).ob_size` just doesn't compile

```
.../cython_test.c: In function ‘__pyx_pf_11cython_test_f’:
.../cython_test.c:593:61: error: ‘PyLongObject’ has no member named ‘ob_size’
   __pyx_t_1 = PyInt_FromSsize_t(((PyLongObject *)__pyx_v_s)->ob_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}                                           
```



---

archive/issue_comments_366288.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-30T10:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366288",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_366289.json:
```json
{
    "body": "<a id='comment:36'></a>\nI see. Python 3 adds an extra level of indirection `ob_base->ob_size`.",
    "created_at": "2016-05-30T10:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366289",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>
I see. Python 3 adds an extra level of indirection `ob_base->ob_size`.



---

archive/issue_comments_366290.json:
```json
{
    "body": "<a id='comment:37'></a>\nOn the other hand, to avoid getting stuck, I would prefer to defer the Python 3 porting to a new ticket.",
    "created_at": "2016-05-31T09:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366290",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>
On the other hand, to avoid getting stuck, I would prefer to defer the Python 3 porting to a new ticket.



---

archive/issue_comments_366291.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-31T09:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366291",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_054951.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-31T10:01:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54951"
}
```



---

archive/issue_events_054952.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-31T10:01:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54952"
}
```



---

archive/issue_comments_366292.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-31T10:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366292",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_366293.json:
```json
{
    "body": "Changing keywords from \"days77\" to \"days77, days74\".",
    "created_at": "2016-05-31T10:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366293",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "days77" to "days77, days74".



---

archive/issue_comments_366294.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/20226\" to \"b55085547315715f292fd08ce74ad5a437abc6a5\"",
    "created_at": "2016-05-31T22:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366294",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/ticket/20226" to "b55085547315715f292fd08ce74ad5a437abc6a5"



---

archive/issue_comments_366295.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-31T22:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-366295",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054953.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-31T22:53:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54953"
}
```
