# Issue 20226: Implement conversion PARI <-> Python int/long without GMP/MPIR

archive/issues_019989.json:
```json
{
    "body": "Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.\n\nCC:  @defeo jpflori\n\nKeywords: days77, days74\n\nBranch/Commit: b55085547315715f292fd08ce74ad5a437abc6a5\n\nReviewer: Luca De Feo, Vincent Delecroix\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20226\n\n",
    "closed_at": "2016-05-31T22:53:55Z",
    "created_at": "2016-03-17T09:46:36Z",
    "labels": [
        "component: interfaces"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Implement conversion PARI <-> Python int/long without GMP/MPIR",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20226",
    "user": "https://github.com/jdemeyer"
}
```
Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.

CC:  @defeo jpflori

Keywords: days77, days74

Branch/Commit: b55085547315715f292fd08ce74ad5a437abc6a5

Reviewer: Luca De Feo, Vincent Delecroix

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20226





---

archive/issue_comments_292855.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Convert PARI integers to/from Python integers without relying on the GMP/MPIR library.\n+Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.\n \n Author: Jeroen Demeyer\n \n```\n",
    "created_at": "2016-03-18T11:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292855",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Convert PARI integers to/from Python integers without relying on the GMP/MPIR library.
+Convert PARI integers to/from Python integers without taking a detour via `mpz_t`.
 
 Author: Jeroen Demeyer
 
```




---

archive/issue_comments_292856.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2016-03-18T11:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292856",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_292857.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-18T17:59:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292857",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_292858.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-04-03T19:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_054950.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-03T19:07:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54950"
}
```



---

archive/issue_comments_292859.json:
```json
{
    "body": "<a id='comment:7'></a>It runs ok and all tests pass.\n\nMinor drawbacks:\n- it would be useful to have links to the Python and Pari longint specs.\n- I am personally against `from ... import *`, but won't block the ticket if you want to keep it.",
    "created_at": "2016-04-05T09:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292859",
    "user": "https://github.com/defeo"
}
```

<a id='comment:7'></a>It runs ok and all tests pass.

Minor drawbacks:
- it would be useful to have links to the Python and Pari longint specs.
- I am personally against `from ... import *`, but won't block the ticket if you want to keep it.



---

archive/issue_comments_292860.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-05T11:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292860",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_292861.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-05T14:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292861",
    "user": "https://github.com/defeo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292862.json:
```json
{
    "body": "<a id='comment:9'></a>Thanks",
    "created_at": "2016-04-05T14:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292862",
    "user": "https://github.com/defeo"
}
```

<a id='comment:9'></a>Thanks



---

archive/issue_comments_292863.json:
```json
{
    "body": "<a id='comment:10'></a>\n```\nsage -t --long src/sage/libs/pari/gen.pyx\n**********************************************************************\nFile \"src/sage/libs/pari/gen.pyx\", line 1343, in sage.libs.pari.gen.gen.__int__\nFailed example:\n    int(pari(-2^31))\nExpected:\n    -2147483648\nGot:\n    -2147483648L\n**********************************************************************\n```",
    "created_at": "2016-04-06T07:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292863",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>
```
sage -t --long src/sage/libs/pari/gen.pyx
**********************************************************************
File "src/sage/libs/pari/gen.pyx", line 1343, in sage.libs.pari.gen.gen.__int__
Failed example:
    int(pari(-2^31))
Expected:
    -2147483648
Got:
    -2147483648L
**********************************************************************
```



---

archive/issue_comments_292864.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-04-06T08:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292864",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_292865.json:
```json
{
    "body": "<a id='comment:12'></a>That's a PARI bug...",
    "created_at": "2016-04-06T10:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292865",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>That's a PARI bug...



---

archive/issue_comments_292866.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-06T16:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_292867.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-06T16:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292867",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_292868.json:
```json
{
    "body": "<a id='comment:15'></a>It's not a PARI bug, it's a PARI *feature* :-)",
    "created_at": "2016-04-06T16:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292868",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>It's not a PARI bug, it's a PARI *feature* :-)



---

archive/issue_comments_292869.json:
```json
{
    "body": "Changing keywords from \"\" to \"days77\".",
    "created_at": "2016-04-08T20:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292869",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "days77".



---

archive/issue_comments_292870.json:
```json
{
    "body": "<a id='comment:17'></a>Would it be possible to test the subtle `LONG_MIN` case in `gen_to_integer`? Maybe along\n\n```\nsage: a = gen_to_integer(pari(\"2^63-1\")); a; type(a)\n9223372036854775807\n<type 'int'>\nsage: a = gen_to_integer(pari(\"2^63\")); a; type(a)\n9223372036854775808L\n<type 'long'>\nsage: a = gen_to_integer(pari(\"-2^63\")); a; type(a)\n-9223372036854775808\n<type 'int'>\nsage: a = gen_to_integer(pari(\"-2^63-1\")); a; type(a)\n-9223372036854775809L\n<type 'long'>\n```\n\nWhat do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.",
    "created_at": "2016-04-15T18:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292870",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>Would it be possible to test the subtle `LONG_MIN` case in `gen_to_integer`? Maybe along

```
sage: a = gen_to_integer(pari("2^63-1")); a; type(a)
9223372036854775807
<type 'int'>
sage: a = gen_to_integer(pari("2^63")); a; type(a)
9223372036854775808L
<type 'long'>
sage: a = gen_to_integer(pari("-2^63")); a; type(a)
-9223372036854775808
<type 'int'>
sage: a = gen_to_integer(pari("-2^63-1")); a; type(a)
-9223372036854775809L
<type 'long'>
```

What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.



---

archive/issue_comments_292871.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 vdelecroix]:\n> What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.\n\n\nAre you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?",
    "created_at": "2016-04-15T18:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292871",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>Replying to [comment:17 vdelecroix]:
> What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.


Are you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?



---

archive/issue_comments_292872.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-15T18:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292872",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_292873.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:18 jdemeyer]:\n> Replying to [comment:17 vdelecroix]:\n> > What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.\n\n> \n> Are you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?\n\n\nSadly not (I am until september in Santiago de Chile). However, I can submit a patch if not already done.",
    "created_at": "2016-04-15T19:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292873",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Replying to [comment:18 jdemeyer]:
> Replying to [comment:17 vdelecroix]:
> > What do you think of moving `gtoi` into PARI (not necessarily for this ticket)? This function is only about PARI's internal.

> 
> Are you still in Bordeaux physically? If so, maybe you could talk to PARI upstream about this?


Sadly not (I am until september in Santiago de Chile). However, I can submit a patch if not already done.



---

archive/issue_comments_292874.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:20 vdelecroix]:\n> Sadly not (I am until september in Santiago de Chile).\n\n\nDoesn't sound so sad :-)\n\n> However, I can submit a patch if not already done.\n\n\nFor the moment, I lack the mental energy to try to push yet another patch to upstream PARI...",
    "created_at": "2016-04-15T19:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292874",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Replying to [comment:20 vdelecroix]:
> Sadly not (I am until september in Santiago de Chile).


Doesn't sound so sad :-)

> However, I can submit a patch if not already done.


For the moment, I lack the mental energy to try to push yet another patch to upstream PARI...



---

archive/issue_comments_292875.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-20T10:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292875",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_292876.json:
```json
{
    "body": "<a id='comment:24'></a>I added a test which checks that the conversion of integers via PARI is the same as the Python conversion `str -> int`. By checking that the result is the same as Python, we don't need to special-case 32-bit vs. 64-bit.",
    "created_at": "2016-04-20T10:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292876",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>I added a test which checks that the conversion of integers via PARI is the same as the Python conversion `str -> int`. By checking that the result is the same as Python, we don't need to special-case 32-bit vs. 64-bit.



---

archive/issue_comments_292877.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-20T10:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292877",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_292878.json:
```json
{
    "body": "<a id='comment:25'></a>So, what specifically was the issue with this that it required blacklisting GCC 4.8?  Is there a simple way to reproduce the issue, or at least a specific doctest that exhibits it that I could run?",
    "created_at": "2016-04-22T13:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292878",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>So, what specifically was the issue with this that it required blacklisting GCC 4.8?  Is there a simple way to reproduce the issue, or at least a specific doctest that exhibits it that I could run?



---

archive/issue_comments_292879.json:
```json
{
    "body": "<a id='comment:26'></a>It was some doctest in `src/sage/libs/pari/convert.pyx`. Let me know if you're unable to reproduce it.",
    "created_at": "2016-04-22T13:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292879",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>It was some doctest in `src/sage/libs/pari/convert.pyx`. Let me know if you're unable to reproduce it.



---

archive/issue_comments_292880.json:
```json
{
    "body": "<a id='comment:27'></a>Okay, I'll give it a look.  I appreciate the need for the blacklisting *for now* just to get moving on things.  But it will be good to fix if I can. I have set `SAGE_INSTALL_GCC=no` on my system, but that will mean I'll ultimately have a broken Sage if we can't resolve this :(",
    "created_at": "2016-04-25T10:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292880",
    "user": "https://github.com/embray"
}
```

<a id='comment:27'></a>Okay, I'll give it a look.  I appreciate the need for the blacklisting *for now* just to get moving on things.  But it will be good to fix if I can. I have set `SAGE_INSTALL_GCC=no` on my system, but that will mean I'll ultimately have a broken Sage if we can't resolve this :(



---

archive/issue_comments_292881.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-17T12:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_292882.json:
```json
{
    "body": "<a id='comment:30'></a>I'm now using the flag `-fno-tree-copyrename` which seems to fix all instances of the GCC 4.8 problem.",
    "created_at": "2016-05-17T19:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292882",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>I'm now using the flag `-fno-tree-copyrename` which seems to fix all instances of the GCC 4.8 problem.



---

archive/issue_comments_292883.json:
```json
{
    "body": "<a id='comment:31'></a>Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.\n\nThis might have something to do with it: https://gcc.gnu.org/ml/gcc-patches/2015-03/msg01460.html",
    "created_at": "2016-05-19T10:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292883",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'></a>Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.

This might have something to do with it: https://gcc.gnu.org/ml/gcc-patches/2015-03/msg01460.html



---

archive/issue_comments_292884.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 embray]:\n> Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.\n\n\nThe problem is indeed fixed in GCC-4.9, see http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982",
    "created_at": "2016-05-19T11:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292884",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>Replying to [comment:31 embray]:
> Interesting--not sure why that would do it but okay.  But if it's not a problem on newer GCC versions maybe whatever the problem is is since fixed.


The problem is indeed fixed in GCC-4.9, see http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982



---

archive/issue_comments_292885.json:
```json
{
    "body": "<a id='comment:33'></a>Could you use the macro `Py_SIZE` instead of calling `py_long_object->ob_size`? In particular, it will simplify the switch to Python3. Sadly, Cython does not accept the macro expansion `Py_SIZE(my_object) = whatever` and the C-API does not document an alternative way of doing things.",
    "created_at": "2016-05-30T09:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292885",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'></a>Could you use the macro `Py_SIZE` instead of calling `py_long_object->ob_size`? In particular, it will simplify the switch to Python3. Sadly, Cython does not accept the macro expansion `Py_SIZE(my_object) = whatever` and the C-API does not document an alternative way of doing things.



---

archive/issue_comments_292886.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:33 vdelecroix]:\n> In particular, it will simplify the switch to Python3.\n\n\nI don't understand why: `ob_size` still exists in Python 3.\n\nEspecially given that we cannot assign to `Py_SIZE()`, I don't really see the point.",
    "created_at": "2016-05-30T09:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292886",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>Replying to [comment:33 vdelecroix]:
> In particular, it will simplify the switch to Python3.


I don't understand why: `ob_size` still exists in Python 3.

Especially given that we cannot assign to `Py_SIZE()`, I don't really see the point.



---

archive/issue_comments_292887.json:
```json
{
    "body": "<a id='comment:35'></a>In Python 3 `(<PyLongObject*>x).ob_size` just doesn't compile\n\n```\n.../cython_test.c: In function \u2018__pyx_pf_11cython_test_f\u2019:\n.../cython_test.c:593:61: error: \u2018PyLongObject\u2019 has no member named \u2018ob_size\u2019\n   __pyx_t_1 = PyInt_FromSsize_t(((PyLongObject *)__pyx_v_s)->ob_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}                                           \n```",
    "created_at": "2016-05-30T10:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292887",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>In Python 3 `(<PyLongObject*>x).ob_size` just doesn't compile

```
.../cython_test.c: In function ‘__pyx_pf_11cython_test_f’:
.../cython_test.c:593:61: error: ‘PyLongObject’ has no member named ‘ob_size’
   __pyx_t_1 = PyInt_FromSsize_t(((PyLongObject *)__pyx_v_s)->ob_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}                                           
```



---

archive/issue_comments_292888.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-30T10:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292888",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_292889.json:
```json
{
    "body": "<a id='comment:36'></a>I see. Python 3 adds an extra level of indirection `ob_base->ob_size`.",
    "created_at": "2016-05-30T10:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292889",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>I see. Python 3 adds an extra level of indirection `ob_base->ob_size`.



---

archive/issue_comments_292890.json:
```json
{
    "body": "<a id='comment:37'></a>On the other hand, to avoid getting stuck, I would prefer to defer the Python 3 porting to a new ticket.",
    "created_at": "2016-05-31T09:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292890",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>On the other hand, to avoid getting stuck, I would prefer to defer the Python 3 porting to a new ticket.



---

archive/issue_comments_292891.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-31T09:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292891",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_054951.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-31T10:01:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54951"
}
```



---

archive/issue_events_054952.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-31T10:01:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54952"
}
```



---

archive/issue_comments_292892.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-31T10:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292892",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292893.json:
```json
{
    "body": "Changing keywords from \"days77\" to \"days77, days74\".",
    "created_at": "2016-05-31T10:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292893",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "days77" to "days77, days74".



---

archive/issue_comments_292894.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-31T22:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20226#issuecomment-292894",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054953.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-31T22:53:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20226",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20226#event-54953"
}
```
