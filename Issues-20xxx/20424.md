# Issue 20424: More tests for common MIP TestSuite: add_col, solve; some fixes for backends

archive/issues_020187.json:
```json
{
    "body": "Split out from #20323.\n\nThis patch adds new _test methods for `add_col`, `solve`, and for #18572 (but disabled for CVXOPT, where it fails). \nTo make the new test methods happy, \n- implement `add_col` for Gurobi;\n- fix the implementation of `add_col` for COIN;\n- fix Gurobi's treatment of unbounded variables; \n- fix CPLEX unboundedness detection.\n\nIf anyone at all cares about the CVXOPT backend, perhaps they could fix it?\n\n\nFrom dimpase:\n I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. \u200b   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.\n\n\n\nCC:  @dimpase @videlec @jdemeyer @fchapoton @nbruin\n\nKeywords: lp\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: 97c4542ebaf4585cec9b2a3f56da4d32ab016def\n\nDependencies: #20323,#20600,#20325\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20424\n\n",
    "closed_at": "2016-06-26T07:30:14Z",
    "created_at": "2016-04-11T19:08:53Z",
    "labels": [
        "component: numerical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "More tests for common MIP TestSuite: add_col, solve; some fixes for backends",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20424",
    "user": "https://github.com/mkoeppe"
}
```
Split out from #20323.

This patch adds new _test methods for `add_col`, `solve`, and for #18572 (but disabled for CVXOPT, where it fails). 
To make the new test methods happy, 
- implement `add_col` for Gurobi;
- fix the implementation of `add_col` for COIN;
- fix Gurobi's treatment of unbounded variables; 
- fix CPLEX unboundedness detection.

If anyone at all cares about the CVXOPT backend, perhaps they could fix it?


From dimpase:
 I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. ​   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.



CC:  @dimpase @videlec @jdemeyer @fchapoton @nbruin

Keywords: lp

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Branch: 97c4542ebaf4585cec9b2a3f56da4d32ab016def

Dependencies: #20323,#20600,#20325

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20424





---

archive/issue_comments_296159.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n-Split out from #20323\n+Split out from #20323.\n+\n+From dimpase:\n+ I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. \u200b   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.\n+\n+\n \n Author: Matthias Koeppe\n \n```\n",
    "created_at": "2016-04-11T19:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296159",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,9 @@
-Split out from #20323
+Split out from #20323.
+
+From dimpase:
+ I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. ​   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.
+
+
 
 Author: Matthias Koeppe
 
```




---

archive/issue_comments_296160.json:
```json
{
    "body": "<a id='comment:3'></a>Branch is on top of #20323.\n\n---\nLast 10 new commits:",
    "created_at": "2016-04-12T05:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296160",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Branch is on top of #20323.

---
Last 10 new commits:



---

archive/issue_comments_296161.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2016-04-13T22:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_296162.json:
```json
{
    "body": "<a id='comment:5'></a>Rebased on top of #20323 branch on top of 7.2.beta4",
    "created_at": "2016-04-13T22:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296162",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Rebased on top of #20323 branch on top of 7.2.beta4



---

archive/issue_comments_296163.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-04-21T22:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_296164.json:
```json
{
    "body": "<a id='comment:7'></a>Rebased on top of 7.2.beta5.\nDropped \"Test backend.copy() rather than copy(backend)\".",
    "created_at": "2016-04-21T22:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296164",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Rebased on top of 7.2.beta5.
Dropped "Test backend.copy() rather than copy(backend)".



---

archive/issue_comments_296165.json:
```json
{
    "body": "<a id='comment:8'></a>How do you do test autogeneration (mentioned in 850b817) ?",
    "created_at": "2016-04-27T08:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296165",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>How do you do test autogeneration (mentioned in 850b817) ?



---

archive/issue_comments_296166.json:
```json
{
    "body": "<a id='comment:9'></a>The test method added in this commit is the raw output from #20376 (`LoggingBackend`) when run on the testcase of #18572.",
    "created_at": "2016-04-27T08:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296166",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>The test method added in this commit is the raw output from #20376 (`LoggingBackend`) when run on the testcase of #18572.



---

archive/issue_comments_296167.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-04-29T06:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296167",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_296168.json:
```json
{
    "body": "<a id='comment:11'></a>rebased on 7.2.beta6",
    "created_at": "2016-04-29T06:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296168",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>rebased on 7.2.beta6



---

archive/issue_comments_296169.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2016-05-26T18:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_296170.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-26T18:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296170",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_296171.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+Split out from #20323.\n+\n+This patch adds new _test methods for `add_col`, `solve`, and for #18572 (but disabled for CVXOPT, where it fails). \n+To make the new test methods happy, \n+- implement `add_col` for Gurobi;\n+- fix Gurobi's treatment of unbounded variables; \n+- fix CPLEX unboundedness detection.\n+\n+From dimpase:\n+ I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. \u200b   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.\n+\n \n \n Author: Matthias Koeppe\n```\n",
    "created_at": "2016-05-26T19:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296171",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,14 @@
+Split out from #20323.
+
+This patch adds new _test methods for `add_col`, `solve`, and for #18572 (but disabled for CVXOPT, where it fails). 
+To make the new test methods happy, 
+- implement `add_col` for Gurobi;
+- fix Gurobi's treatment of unbounded variables; 
+- fix CPLEX unboundedness detection.
+
+From dimpase:
+ I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. ​   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.
+
 
 
 Author: Matthias Koeppe
```




---

archive/issue_comments_296172.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-30T20:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_296173.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,18 @@\n+Split out from #20323.\n+\n+This patch adds new _test methods for `add_col`, `solve`, and for #18572 (but disabled for CVXOPT, where it fails). \n+To make the new test methods happy, \n+- implement `add_col` for Gurobi;\n+- fix the implementation of `add_col` for COIN;\n+- fix Gurobi's treatment of unbounded variables; \n+- fix CPLEX unboundedness detection.\n+\n+If anyone at all cares about the CVXOPT backend, perhaps they could fix it?\n+\n+\n+From dimpase:\n+ I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. \u200b   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.\n+\n \n \n Author: Matthias Koeppe\n```\n",
    "created_at": "2016-05-30T20:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296173",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,18 @@
+Split out from #20323.
+
+This patch adds new _test methods for `add_col`, `solve`, and for #18572 (but disabled for CVXOPT, where it fails). 
+To make the new test methods happy, 
+- implement `add_col` for Gurobi;
+- fix the implementation of `add_col` for COIN;
+- fix Gurobi's treatment of unbounded variables; 
+- fix CPLEX unboundedness detection.
+
+If anyone at all cares about the CVXOPT backend, perhaps they could fix it?
+
+
+From dimpase:
+ I recall asking how one deals with different backends producing different, albeit equivalent, outputs. E.g. some of  them would even introduce extra variables for some constraints (see e.g. ​   http://trac.sagemath.org/ticket/13148#comment:2). Some backends assign names to constraints automatically.
+
 
 
 Author: Matthias Koeppe
```




---

archive/issue_comments_296174.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2016-06-25T00:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_296175.json:
```json
{
    "body": "<a id='comment:18'></a>rebased on 7.3.beta5",
    "created_at": "2016-06-25T00:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296175",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>rebased on 7.3.beta5



---

archive/issue_comments_296176.json:
```json
{
    "body": "<a id='comment:19'></a>looks good to me",
    "created_at": "2016-06-25T14:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296176",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>looks good to me



---

archive/issue_events_055277.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-06-25T14:21:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20424#event-55277"
}
```



---

archive/issue_comments_296177.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-25T14:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296177",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055278.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-26T07:30:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20424#event-55278"
}
```



---

archive/issue_comments_296178.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-26T07:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296178",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_296179.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:17 git]:\n> |                                                                                                                                          |                                                          |\n> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n> |[d4eccf6](http://git.sagemath.org/sage.git/commit/?id=d4eccf6591dc17fd8a2487abd90bca55f31582f9)|`GurobiBackend.add_variable: Support coefficients keyword`|\n\n\nAre there any plans to support this for other backends? I noticed that it's not even documented in `add_variable.__doc__` for the Gurobi backend.\n\nThe interface between backends should be consistent, so even just `raise NotImplementedError(\"the foo backend does not support the 'coefficients' argument\")` in other backends would be good to have. What do you think?",
    "created_at": "2017-08-09T10:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296179",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Replying to [comment:17 git]:
> |                                                                                                                                          |                                                          |
> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
> |[d4eccf6](http://git.sagemath.org/sage.git/commit/?id=d4eccf6591dc17fd8a2487abd90bca55f31582f9)|`GurobiBackend.add_variable: Support coefficients keyword`|


Are there any plans to support this for other backends? I noticed that it's not even documented in `add_variable.__doc__` for the Gurobi backend.

The interface between backends should be consistent, so even just `raise NotImplementedError("the foo backend does not support the 'coefficients' argument")` in other backends would be good to have. What do you think?



---

archive/issue_comments_296180.json:
```json
{
    "body": "<a id='comment:22'></a>IMHO different backends might have different features, which might be impossible to have for each backend.\n\nOnly if there are multiple backend supporting this, we can think of adding it to the generic backend, with the default implementation as you propose.",
    "created_at": "2017-08-09T19:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296180",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>IMHO different backends might have different features, which might be impossible to have for each backend.

Only if there are multiple backend supporting this, we can think of adding it to the generic backend, with the default implementation as you propose.



---

archive/issue_comments_296181.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:21 jdemeyer]:\n> Replying to [comment:17 git]:\n> > |                                                                                                                                          |                                                          |\n> > |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n> > |[d4eccf6](http://git.sagemath.org/sage.git/commit/?id=d4eccf6591dc17fd8a2487abd90bca55f31582f9)|`GurobiBackend.add_variable: Support coefficients keyword`|\n\n> \n> Are there any plans to support this for other backends? I noticed that it's not even documented in `add_variable.__doc__` for the Gurobi backend.\n\n\nYes, there is a plan, see #20324.",
    "created_at": "2017-08-09T20:07:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20424#issuecomment-296181",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Replying to [comment:21 jdemeyer]:
> Replying to [comment:17 git]:
> > |                                                                                                                                          |                                                          |
> > |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
> > |[d4eccf6](http://git.sagemath.org/sage.git/commit/?id=d4eccf6591dc17fd8a2487abd90bca55f31582f9)|`GurobiBackend.add_variable: Support coefficients keyword`|

> 
> Are there any plans to support this for other backends? I noticed that it's not even documented in `add_variable.__doc__` for the Gurobi backend.


Yes, there is a plan, see #20324.
