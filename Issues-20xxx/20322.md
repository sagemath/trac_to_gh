# Issue 20322: use SAGE_BANNER to propose a bare banner with no utf8

archive/issues_020085.json:
```json
{
    "body": "The pretty colored banner for sage uses utf8, and this\nposes problem for the docker patchbot.\n\nLet us use SAGE_BANNER to propose a shorten banner when needed.\n\nCC:  @nthiery @embray @jdemeyer\n\nReviewer: Jeroen Demeyer\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nBranch: 5b87f1aca7a38d0c5ef80b8e12b16822039a7360\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20322\n\n",
    "closed_at": "2016-04-01T15:10:59Z",
    "created_at": "2016-03-30T15:23:07Z",
    "labels": [
        "component: user interface"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "use SAGE_BANNER to propose a bare banner with no utf8",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20322",
    "user": "https://github.com/fchapoton"
}
```
The pretty colored banner for sage uses utf8, and this
poses problem for the docker patchbot.

Let us use SAGE_BANNER to propose a shorten banner when needed.

CC:  @nthiery @embray @jdemeyer

Reviewer: Jeroen Demeyer

Author: Frédéric Chapoton

Branch: 5b87f1aca7a38d0c5ef80b8e12b16822039a7360

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20322





---

archive/issue_comments_363582.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-30T15:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363582",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_363583.json:
```json
{
    "body": "Changing commit from \"\" to \"465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf\"",
    "created_at": "2016-03-30T15:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363583",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf"



---

archive/issue_comments_363584.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/20322\"",
    "created_at": "2016-03-30T15:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363584",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/20322"



---

archive/issue_comments_363585.json:
```json
{
    "body": "<a id='comment:1'></a>\nsetting SAGE_BANNER to \"bare\" should give the expected result\n\n---\nNew commits:\n|                                                                                                                                          |                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[465db90](https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf)|`trac #20322 quick solution for a shorten banner`|",
    "created_at": "2016-03-30T15:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363585",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
setting SAGE_BANNER to "bare" should give the expected result

---
New commits:
|                                                                                                                                          |                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[465db90](https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf)|`trac #20322 quick solution for a shorten banner`|



---

archive/issue_comments_363586.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2016-03-30T15:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363586",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_363587.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-31T08:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363587",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_363588.json:
```json
{
    "body": "<a id='comment:3'></a>\nCan you use consistent indentation?",
    "created_at": "2016-03-31T08:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363588",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Can you use consistent indentation?



---

archive/issue_comments_363589.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------|\n|[c2d0ff3](https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4)|`indentation`|",
    "created_at": "2016-03-31T08:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |             |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------|
|[c2d0ff3](https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4)|`indentation`|



---

archive/issue_comments_363590.json:
```json
{
    "body": "Changing commit from \"465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf\" to \"c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4\"",
    "created_at": "2016-03-31T08:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363590",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf" to "c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4"



---

archive/issue_comments_363591.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-31T08:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363591",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_363592.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2016-03-31T09:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363592",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_363593.json:
```json
{
    "body": "<a id='comment:6'></a>\nI am adding a commit to make the bare and full banners more consistent...",
    "created_at": "2016-03-31T09:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363593",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
I am adding a commit to make the bare and full banners more consistent...



---

archive/issue_comments_363594.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-31T09:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363594",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_363595.json:
```json
{
    "body": "<a id='comment:7'></a>\noh well, bare means \"without bells and dingles\"\n\nall what is needed to have the tests pass in the docker container is that it contains the text of VERSION.txt",
    "created_at": "2016-03-31T09:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363595",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>
oh well, bare means "without bells and dingles"

all what is needed to have the tests pass in the docker container is that it contains the text of VERSION.txt



---

archive/issue_comments_363596.json:
```json
{
    "body": "Changing branch from \"u/chapoton/20322\" to \"u/jdemeyer/20322\"",
    "created_at": "2016-03-31T09:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363596",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/chapoton/20322" to "u/jdemeyer/20322"



---

archive/issue_comments_363597.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-31T09:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363597",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_363598.json:
```json
{
    "body": "Changing commit from \"c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4\" to \"846e21de218ace07322ac24a64341ec71141578e\"",
    "created_at": "2016-03-31T09:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363598",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4" to "846e21de218ace07322ac24a64341ec71141578e"



---

archive/issue_comments_363599.json:
```json
{
    "body": "<a id='comment:9'></a>\nNew commits:\n|                                                                                                                                          |                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[846e21d](https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e)|`Make full and bare banner consistent`|",
    "created_at": "2016-03-31T09:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363599",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
New commits:
|                                                                                                                                          |                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[846e21d](https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e)|`Make full and bare banner consistent`|



---

archive/issue_comments_363600.json:
```json
{
    "body": "<a id='comment:10'></a>\nRunning full doctests now with `SAGE_BANNER=bare`...",
    "created_at": "2016-03-31T09:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363600",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Running full doctests now with `SAGE_BANNER=bare`...



---

archive/issue_comments_363601.json:
```json
{
    "body": "Changing commit from \"846e21de218ace07322ac24a64341ec71141578e\" to \"8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f\"",
    "created_at": "2016-03-31T10:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "846e21de218ace07322ac24a64341ec71141578e" to "8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f"



---

archive/issue_comments_363602.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[8b1c369](https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f)|`Ensure that SAGE_BANNER=no is not exported`|",
    "created_at": "2016-03-31T10:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363602",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[8b1c369](https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f)|`Ensure that SAGE_BANNER=no is not exported`|



---

archive/issue_comments_363603.json:
```json
{
    "body": "<a id='comment:12'></a>\nDoctests pass: positive_review from my part.",
    "created_at": "2016-03-31T12:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363603",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Doctests pass: positive_review from my part.



---

archive/issue_comments_363604.json:
```json
{
    "body": "<a id='comment:13'></a>\nok, let it be",
    "created_at": "2016-03-31T12:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363604",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
ok, let it be



---

archive/issue_comments_363605.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-31T12:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363605",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_363606.json:
```json
{
    "body": "<a id='comment:14'></a>\nOut of curiosity, in what context did this come up?  I reported the following issue upstream to Docker: https://github.com/docker/docker/issues/21323  But AFAICT this only affects the Docker client on Windows.",
    "created_at": "2016-03-31T12:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363606",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
Out of curiosity, in what context did this come up?  I reported the following issue upstream to Docker: https://github.com/docker/docker/issues/21323  But AFAICT this only affects the Docker client on Windows.



---

archive/issue_comments_363607.json:
```json
{
    "body": "<a id='comment:15'></a>\n`@`embray\n\nThis was just to help **you** to make the sage-patchbot docker container work.",
    "created_at": "2016-03-31T12:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363607",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>
`@`embray

This was just to help **you** to make the sage-patchbot docker container work.



---

archive/issue_comments_363608.json:
```json
{
    "body": "<a id='comment:16'></a>\nI just haven't had this problem specifically since I'm not trying to run the sage-patchbot container on Windows.  In the meantime I just disabled the SAGE_BANNER for the docker images in [sagemath/docker-images`@`2c90e030 ](https://github.com/sagemath/docker-images/commit/2c90e030305d09f50dcd547f39ef8e5bac4bb628#diff-f5f0fb89d617ccbbde8261257e6dd358). So I was just curious how this came about since I wasn't explicitly asking for it (not that I'm against it).",
    "created_at": "2016-03-31T12:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363608",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
I just haven't had this problem specifically since I'm not trying to run the sage-patchbot container on Windows.  In the meantime I just disabled the SAGE_BANNER for the docker images in [sagemath/docker-images`@`2c90e030 ](https://github.com/sagemath/docker-images/commit/2c90e030305d09f50dcd547f39ef8e5bac4bb628#diff-f5f0fb89d617ccbbde8261257e6dd358). So I was just curious how this came about since I wasn't explicitly asking for it (not that I'm against it).



---

archive/issue_comments_363609.json:
```json
{
    "body": "<a id='comment:17'></a>\nThis is the disabling of the banner that causes some failing doctests:\n\nhttp://patchbot.sagemath.org/log/0/Ubuntu/15.10/x86_64/3.13.0-43-generic/62744a2b1a07/2016-03-28%2022:18:21\n\nthe other failing doctest is in sagedev, but not yet understood.\n\nSO PLEASE, once the next release is out, use SAGE_BANNER=bare instead of \"no\"",
    "created_at": "2016-03-31T12:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363609",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
This is the disabling of the banner that causes some failing doctests:

http://patchbot.sagemath.org/log/0/Ubuntu/15.10/x86_64/3.13.0-43-generic/62744a2b1a07/2016-03-28%2022:18:21

the other failing doctest is in sagedev, but not yet understood.

SO PLEASE, once the next release is out, use SAGE_BANNER=bare instead of "no"



---

archive/issue_comments_363610.json:
```json
{
    "body": "<a id='comment:18'></a>\nAh, I see. Though maybe those tests should check the actual value of the environment variable and skip if it's different, or just set it explicitly beforehand.",
    "created_at": "2016-03-31T12:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363610",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'></a>
Ah, I see. Though maybe those tests should check the actual value of the environment variable and skip if it's different, or just set it explicitly beforehand.



---

archive/issue_comments_363611.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-03-31T21:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363611",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_363612.json:
```json
{
    "body": "<a id='comment:19'></a>\n\n```\nsage -t --long src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 106, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 114, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   2 of 235 in sage.tests.cmdline.test_executable\n    [234 tests, 2 failures, 63.86 s]\n```",
    "created_at": "2016-03-31T21:19:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363612",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:19'></a>

```
sage -t --long src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 106, in sage.tests.cmdline.test_executable
Failed example:
    out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/tests/cmdline.py", line 114, in sage.tests.cmdline.test_executable
Failed example:
    out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   2 of 235 in sage.tests.cmdline.test_executable
    [234 tests, 2 failures, 63.86 s]
```



---

archive/issue_comments_363613.json:
```json
{
    "body": "<a id='comment:20'></a>\nHum, I think this just needs a banner and VERSION.txt refreshment to work.\n\nSo this is a rather special kind of ticket. Maybe to merge just before a beta release ?",
    "created_at": "2016-04-01T07:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363613",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>
Hum, I think this just needs a banner and VERSION.txt refreshment to work.

So this is a rather special kind of ticket. Maybe to merge just before a beta release ?



---

archive/issue_comments_363614.json:
```json
{
    "body": "<a id='comment:21'></a>\nI guess this is yet another \"the bug is not in the ticket but in the buildbot\".",
    "created_at": "2016-04-01T08:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363614",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
I guess this is yet another "the bug is not in the ticket but in the buildbot".



---

archive/issue_comments_363615.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-04-01T08:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363615",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_363616.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2016-04-01T08:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_363617.json:
```json
{
    "body": "Changing commit from \"8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f\" to \"5b87f1aca7a38d0c5ef80b8e12b16822039a7360\"",
    "created_at": "2016-04-01T08:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f" to "5b87f1aca7a38d0c5ef80b8e12b16822039a7360"



---

archive/issue_comments_363618.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                          |                                                                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|\n|[5b87f1a](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)|`Updated [SageMath](SageMath) version to 7.2.beta1`|",
    "created_at": "2016-04-01T08:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                          |                                                                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|
|[5b87f1a](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)|`Updated [SageMath](SageMath) version to 7.2.beta1`|



---

archive/issue_comments_363619.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-01T08:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363619",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_363620.json:
```json
{
    "body": "<a id='comment:24'></a>\nThe last commit isn't really needed, it's just to make the buildbot happy.",
    "created_at": "2016-04-01T08:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363620",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
The last commit isn't really needed, it's just to make the buildbot happy.



---

archive/issue_comments_363621.json:
```json
{
    "body": "<a id='comment:25'></a>\nI still think that if a test is expecting something particular about the environment that it should set that environment for the test.  For example something like\n\n```diff\ndiff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py\nindex 534436d..1d0395e 100644\n--- a/src/sage/tests/cmdline.py\n+++ b/src/sage/tests/cmdline.py\n@@ -57,7 +57,7 @@ from subprocess import *\n import os, select\n \n \n-def test_executable(args, input=\"\", timeout=100.0, **kwds):\n+def test_executable(args, input=\"\", timeout=100.0, env={}, **kwds):\n     r\"\"\"\n     Run the program defined by ``args`` using the string ``input`` on\n     the standard input.\n@@ -102,7 +102,7 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n \n     Run Sage itself with various options::\n \n-        sage: (out, err, ret) = test_executable([\"sage\"])\n+        sage: (out, err, ret) = test_executable([\"sage\"], env={'SAGE_BANNER': 'bare'})\n         sage: out.find(version()) >= 0\n         True\n         sage: err\n@@ -110,7 +110,7 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         sage: ret\n         0\n \n-        sage: (out, err, ret) = test_executable([\"sage\"], \"3^33\\n\")\n+        sage: (out, err, ret) = test_executable([\"sage\"], \"3^33\\n\", env={'SAGE_BANNER': 'bare'})\n         sage: out.find(version()) >= 0\n         True\n         sage: out.find(\"5559060566555523\") >= 0\n@@ -120,7 +120,7 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         sage: ret\n         0\n \n-        sage: (out, err, ret) = test_executable([\"sage\", \"-q\"], \"3^33\\n\")\n+        sage: (out, err, ret) = test_executable([\"sage\", \"-q\"], \"3^33\\n\", env={'SAGE_BANNER': 'bare'})\n         sage: out.find(version()) >= 0\n         False\n         sage: out.find(\"5559060566555523\") >= 0\n@@ -728,6 +728,9 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         del pexpect_env[\"TERM\"]\n     except KeyError:\n         pass\n+\n+    pexpect_env.update(env)\n+\n     p = Popen(args, stdin=PIPE, stdout=PIPE, stderr=PIPE, env=pexpect_env, **kwds)\n     if input:\n         p.stdin.write(input)\n\n```",
    "created_at": "2016-04-01T12:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363621",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
I still think that if a test is expecting something particular about the environment that it should set that environment for the test.  For example something like

```diff
diff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py
index 534436d..1d0395e 100644
--- a/src/sage/tests/cmdline.py
+++ b/src/sage/tests/cmdline.py
@@ -57,7 +57,7 @@ from subprocess import *
 import os, select
 
 
-def test_executable(args, input="", timeout=100.0, **kwds):
+def test_executable(args, input="", timeout=100.0, env={}, **kwds):
     r"""
     Run the program defined by ``args`` using the string ``input`` on
     the standard input.
@@ -102,7 +102,7 @@ def test_executable(args, input="", timeout=100.0, **kwds):
 
     Run Sage itself with various options::
 
-        sage: (out, err, ret) = test_executable(["sage"])
+        sage: (out, err, ret) = test_executable(["sage"], env={'SAGE_BANNER': 'bare'})
         sage: out.find(version()) >= 0
         True
         sage: err
@@ -110,7 +110,7 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         sage: ret
         0
 
-        sage: (out, err, ret) = test_executable(["sage"], "3^33\n")
+        sage: (out, err, ret) = test_executable(["sage"], "3^33\n", env={'SAGE_BANNER': 'bare'})
         sage: out.find(version()) >= 0
         True
         sage: out.find("5559060566555523") >= 0
@@ -120,7 +120,7 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         sage: ret
         0
 
-        sage: (out, err, ret) = test_executable(["sage", "-q"], "3^33\n")
+        sage: (out, err, ret) = test_executable(["sage", "-q"], "3^33\n", env={'SAGE_BANNER': 'bare'})
         sage: out.find(version()) >= 0
         False
         sage: out.find("5559060566555523") >= 0
@@ -728,6 +728,9 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         del pexpect_env["TERM"]
     except KeyError:
         pass
+
+    pexpect_env.update(env)
+
     p = Popen(args, stdin=PIPE, stdout=PIPE, stderr=PIPE, env=pexpect_env, **kwds)
     if input:
         p.stdin.write(input)

```



---

archive/issue_comments_363622.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-01T15:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363622",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_363623.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/20322\" to \"5b87f1aca7a38d0c5ef80b8e12b16822039a7360\"",
    "created_at": "2016-04-01T15:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363623",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/20322" to "5b87f1aca7a38d0c5ef80b8e12b16822039a7360"



---

archive/issue_events_070499.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-01T15:10:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20322#event-70499"
}
```



---

archive/issue_comments_363624.json:
```json
{
    "body": "<a id='comment:27'></a>\nIncidentally, the patchbot has its own unicode banner that is causing Docker client to crash: https://github.com/robertwb/sage-patchbot/blob/master/src/patchbot.py#L455  I will open a separate issue.",
    "created_at": "2016-04-04T09:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363624",
    "user": "https://github.com/embray"
}
```

<a id='comment:27'></a>
Incidentally, the patchbot has its own unicode banner that is causing Docker client to crash: https://github.com/robertwb/sage-patchbot/blob/master/src/patchbot.py#L455  I will open a separate issue.



---

archive/issue_comments_363625.json:
```json
{
    "body": "Changing commit from \"5b87f1aca7a38d0c5ef80b8e12b16822039a7360\" to \"\"",
    "created_at": "2016-04-04T09:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363625",
    "user": "https://github.com/embray"
}
```

Changing commit from "5b87f1aca7a38d0c5ef80b8e12b16822039a7360" to ""



---

archive/issue_comments_363626.json:
```json
{
    "body": "<a id='comment:28'></a>\nI have submitted an issue regarding the patchbot's banner to https://github.com/robertwb/sage-patchbot/pull/78",
    "created_at": "2016-04-04T21:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20322#issuecomment-363626",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>
I have submitted an issue regarding the patchbot's banner to https://github.com/robertwb/sage-patchbot/pull/78
