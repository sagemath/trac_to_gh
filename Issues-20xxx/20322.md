# Issue 20322: use SAGE_BANNER to propose a bare banner with no utf8

archive/issues_020085.json:
```json
{
    "assignees": [],
    "body": "The pretty colored banner for sage uses utf8, and this\nposes problem for the docker patchbot.\n\nLet us use SAGE_BANNER to propose a shorten banner when needed.\n\nCC:  @nthiery @embray @jdemeyer\n\nComponent: **user interface**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nBranch: **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)**\n\nReviewer: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20322_\n\n",
    "closed_at": "2016-04-01T15:10:59Z",
    "created_at": "2016-03-30T15:23:07Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "use SAGE_BANNER to propose a bare banner with no utf8",
    "type": "issue",
    "updated_at": "2016-04-04T21:13:51Z",
    "url": "https://github.com/sagemath/sage/issues/20322",
    "user": "https://github.com/fchapoton"
}
```
The pretty colored banner for sage uses utf8, and this
poses problem for the docker patchbot.

Let us use SAGE_BANNER to propose a shorten banner when needed.

CC:  @nthiery @embray @jdemeyer

Component: **user interface**

Author: **Frédéric Chapoton**

Branch: **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)**

Reviewer: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/20322_





---

archive/issue_events_284281.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-30T15:23:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "milestone_number": null,
    "milestone_title": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284281"
}
```



---

archive/issue_events_284282.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-30T15:23:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284282"
}
```



---

archive/issue_events_284283.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-30T15:34:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284283"
}
```



---

archive/issue_comments_292854.json:
```json
{
    "body": "Commit: **[`465db90`](https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf)**",
    "created_at": "2016-03-30T15:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292854",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`465db90`](https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf)**



---

archive/issue_comments_292855.json:
```json
{
    "body": "Branch: **[u/chapoton/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/20322)**",
    "created_at": "2016-03-30T15:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292855",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/20322)**



---

archive/issue_comments_292856.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nsetting SAGE_BANNER to \"bare\" should give the expected result\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf\"><code>465db90</code></a></td><td><code>trac #20322 quick solution for a shorten banner</code></td></tr></table>\n",
    "created_at": "2016-03-30T15:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292856",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">comment:1</div>

setting SAGE_BANNER to "bare" should give the expected result

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf"><code>465db90</code></a></td><td><code>trac #20322 quick solution for a shorten banner</code></td></tr></table>




---

archive/issue_comments_292857.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2016-03-30T15:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292857",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_284284.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T08:42:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284284"
}
```



---

archive/issue_events_284285.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T08:42:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284285"
}
```



---

archive/issue_events_284286.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T08:42:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284286"
}
```



---

archive/issue_comments_292858.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nCan you use consistent indentation?",
    "created_at": "2016-03-31T08:42:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292858",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Can you use consistent indentation?



---

archive/issue_events_284287.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T08:42:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284287"
}
```



---

archive/issue_comments_292859.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4\"><code>c2d0ff3</code></a></td><td><code>indentation</code></td></tr></table>\n",
    "created_at": "2016-03-31T08:46:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292859",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4"><code>c2d0ff3</code></a></td><td><code>indentation</code></td></tr></table>




---

archive/issue_comments_292860.json:
```json
{
    "body": "Changed commit from **[`465db90`](https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf)** to **[`c2d0ff3`](https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4)**",
    "created_at": "2016-03-31T08:46:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292860",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`465db90`](https://github.com/sagemath/sagetrac-mirror/commit/465db90b975dbf2c2ada8d8b1c8f33ea4f048fcf)** to **[`c2d0ff3`](https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4)**



---

archive/issue_events_284288.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-31T08:47:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284288"
}
```



---

archive/issue_events_284289.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-31T08:47:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284289"
}
```



---

archive/issue_comments_292861.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2016-03-31T09:00:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292861",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_292862.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI am adding a commit to make the bare and full banners more consistent...",
    "created_at": "2016-03-31T09:00:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292862",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I am adding a commit to make the bare and full banners more consistent...



---

archive/issue_events_284290.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T09:00:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284290"
}
```



---

archive/issue_events_284291.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T09:00:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284291"
}
```



---

archive/issue_comments_292863.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\noh well, bare means \"without bells and dingles\"\n\nall what is needed to have the tests pass in the docker container is that it contains the text of VERSION.txt",
    "created_at": "2016-03-31T09:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292863",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

oh well, bare means "without bells and dingles"

all what is needed to have the tests pass in the docker container is that it contains the text of VERSION.txt



---

archive/issue_comments_292864.json:
```json
{
    "body": "Changed branch from **[u/chapoton/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/20322)** to **[u/jdemeyer/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/20322)**",
    "created_at": "2016-03-31T09:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292864",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/chapoton/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/20322)** to **[u/jdemeyer/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/20322)**



---

archive/issue_events_284292.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T09:08:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284292"
}
```



---

archive/issue_events_284293.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-03-31T09:08:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284293"
}
```



---

archive/issue_comments_292865.json:
```json
{
    "body": "Changed commit from **[`c2d0ff3`](https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4)** to **[`846e21d`](https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e)**",
    "created_at": "2016-03-31T09:08:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292865",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`c2d0ff3`](https://github.com/sagemath/sagetrac-mirror/commit/c2d0ff3df2b0543fbab75c9c24e067d9bd6d48e4)** to **[`846e21d`](https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e)**



---

archive/issue_comments_292866.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e\"><code>846e21d</code></a></td><td><code>Make full and bare banner consistent</code></td></tr></table>\n",
    "created_at": "2016-03-31T09:08:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292866",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e"><code>846e21d</code></a></td><td><code>Make full and bare banner consistent</code></td></tr></table>




---

archive/issue_comments_292867.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nRunning full doctests now with `SAGE_BANNER=bare`...",
    "created_at": "2016-03-31T09:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292867",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Running full doctests now with `SAGE_BANNER=bare`...



---

archive/issue_comments_292868.json:
```json
{
    "body": "Changed commit from **[`846e21d`](https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e)** to **[`8b1c369`](https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f)**",
    "created_at": "2016-03-31T10:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292868",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`846e21d`](https://github.com/sagemath/sagetrac-mirror/commit/846e21de218ace07322ac24a64341ec71141578e)** to **[`8b1c369`](https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f)**



---

archive/issue_comments_292869.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f\"><code>8b1c369</code></a></td><td><code>Ensure that SAGE_BANNER=no is not exported</code></td></tr></table>\n",
    "created_at": "2016-03-31T10:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292869",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f"><code>8b1c369</code></a></td><td><code>Ensure that SAGE_BANNER=no is not exported</code></td></tr></table>




---

archive/issue_comments_292870.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nDoctests pass: positive_review from my part.",
    "created_at": "2016-03-31T12:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292870",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Doctests pass: positive_review from my part.



---

archive/issue_comments_292871.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nok, let it be",
    "created_at": "2016-03-31T12:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292871",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

ok, let it be



---

archive/issue_events_284294.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-31T12:05:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284294"
}
```



---

archive/issue_events_284295.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-31T12:05:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284295"
}
```



---

archive/issue_comments_292872.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOut of curiosity, in what context did this come up?  I reported the following issue upstream to Docker: https://github.com/docker/docker/issues/21323  But AFAICT this only affects the Docker client on Windows.",
    "created_at": "2016-03-31T12:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292872",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Out of curiosity, in what context did this come up?  I reported the following issue upstream to Docker: https://github.com/docker/docker/issues/21323  But AFAICT this only affects the Docker client on Windows.



---

archive/issue_comments_292873.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n@embray\n\nThis was just to help **you** to make the sage-patchbot docker container work.",
    "created_at": "2016-03-31T12:09:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292873",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

@embray

This was just to help **you** to make the sage-patchbot docker container work.



---

archive/issue_comments_292874.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI just haven't had this problem specifically since I'm not trying to run the sage-patchbot container on Windows.  In the meantime I just disabled the SAGE_BANNER for the docker images in [sagemath/docker-images@2c90e030 ](https://github.com/sagemath/docker-images/commit/2c90e030305d09f50dcd547f39ef8e5bac4bb628#diff-f5f0fb89d617ccbbde8261257e6dd358). So I was just curious how this came about since I wasn't explicitly asking for it (not that I'm against it).",
    "created_at": "2016-03-31T12:21:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292874",
    "user": "https://github.com/embray"
}
```

<div id="comment:16" align="right">comment:16</div>

I just haven't had this problem specifically since I'm not trying to run the sage-patchbot container on Windows.  In the meantime I just disabled the SAGE_BANNER for the docker images in [sagemath/docker-images@2c90e030 ](https://github.com/sagemath/docker-images/commit/2c90e030305d09f50dcd547f39ef8e5bac4bb628#diff-f5f0fb89d617ccbbde8261257e6dd358). So I was just curious how this came about since I wasn't explicitly asking for it (not that I'm against it).



---

archive/issue_comments_292875.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThis is the disabling of the banner that causes some failing doctests:\n\nhttp://patchbot.sagemath.org/log/0/Ubuntu/15.10/x86_64/3.13.0-43-generic/62744a2b1a07/2016-03-28%2022:18:21\n\nthe other failing doctest is in sagedev, but not yet understood.\n\nSO PLEASE, once the next release is out, use SAGE_BANNER=bare instead of \"no\"",
    "created_at": "2016-03-31T12:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292875",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

This is the disabling of the banner that causes some failing doctests:

http://patchbot.sagemath.org/log/0/Ubuntu/15.10/x86_64/3.13.0-43-generic/62744a2b1a07/2016-03-28%2022:18:21

the other failing doctest is in sagedev, but not yet understood.

SO PLEASE, once the next release is out, use SAGE_BANNER=bare instead of "no"



---

archive/issue_comments_292876.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAh, I see. Though maybe those tests should check the actual value of the environment variable and skip if it's different, or just set it explicitly beforehand.",
    "created_at": "2016-03-31T12:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292876",
    "user": "https://github.com/embray"
}
```

<div id="comment:18" align="right">comment:18</div>

Ah, I see. Though maybe those tests should check the actual value of the environment variable and skip if it's different, or just set it explicitly beforehand.



---

archive/issue_events_284296.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-31T21:19:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284296"
}
```



---

archive/issue_events_284297.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-31T21:19:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284297"
}
```



---

archive/issue_comments_292877.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n\n```\nsage -t --long src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 106, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 114, in sage.tests.cmdline.test_executable\nFailed example:\n    out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   2 of 235 in sage.tests.cmdline.test_executable\n    [234 tests, 2 failures, 63.86 s]\n```",
    "created_at": "2016-03-31T21:19:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292877",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>


```
sage -t --long src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 106, in sage.tests.cmdline.test_executable
Failed example:
    out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/tests/cmdline.py", line 114, in sage.tests.cmdline.test_executable
Failed example:
    out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   2 of 235 in sage.tests.cmdline.test_executable
    [234 tests, 2 failures, 63.86 s]
```



---

archive/issue_comments_292878.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHum, I think this just needs a banner and VERSION.txt refreshment to work.\n\nSo this is a rather special kind of ticket. Maybe to merge just before a beta release ?",
    "created_at": "2016-04-01T07:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292878",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

Hum, I think this just needs a banner and VERSION.txt refreshment to work.

So this is a rather special kind of ticket. Maybe to merge just before a beta release ?



---

archive/issue_comments_292879.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI guess this is yet another \"the bug is not in the ticket but in the buildbot\".",
    "created_at": "2016-04-01T08:31:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292879",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

I guess this is yet another "the bug is not in the ticket but in the buildbot".



---

archive/issue_events_284298.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-01T08:31:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284298"
}
```



---

archive/issue_events_284299.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-01T08:31:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284299"
}
```



---

archive/issue_events_284300.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-04-01T08:40:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284300"
}
```



---

archive/issue_events_284301.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-04-01T08:40:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284301"
}
```



---

archive/issue_comments_292880.json:
```json
{
    "body": "Changed commit from **[`8b1c369`](https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f)** to **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)**",
    "created_at": "2016-04-01T08:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292880",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8b1c369`](https://github.com/sagemath/sagetrac-mirror/commit/8b1c3697418043b7c1a6c4547d5e412a2ebe0e5f)** to **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)**



---

archive/issue_comments_292881.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360\"><code>5b87f1a</code></a></td><td><code>Updated [SageMath](../wiki/SageMath) version to 7.2.beta1</code></td></tr></table>\n",
    "created_at": "2016-04-01T08:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292881",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360"><code>5b87f1a</code></a></td><td><code>Updated [SageMath](../wiki/SageMath) version to 7.2.beta1</code></td></tr></table>




---

archive/issue_events_284302.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-01T08:41:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284302"
}
```



---

archive/issue_events_284303.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-01T08:41:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284303"
}
```



---

archive/issue_comments_292882.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThe last commit isn't really needed, it's just to make the buildbot happy.",
    "created_at": "2016-04-01T08:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292882",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

The last commit isn't really needed, it's just to make the buildbot happy.



---

archive/issue_comments_292883.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI still think that if a test is expecting something particular about the environment that it should set that environment for the test.  For example something like\n\n```diff\ndiff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py\nindex 534436d..1d0395e 100644\n--- a/src/sage/tests/cmdline.py\n+++ b/src/sage/tests/cmdline.py\n@@ -57,7 +57,7 @@ from subprocess import *\n import os, select\n \n \n-def test_executable(args, input=\"\", timeout=100.0, **kwds):\n+def test_executable(args, input=\"\", timeout=100.0, env={}, **kwds):\n     r\"\"\"\n     Run the program defined by ``args`` using the string ``input`` on\n     the standard input.\n@@ -102,7 +102,7 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n \n     Run Sage itself with various options::\n \n-        sage: (out, err, ret) = test_executable([\"sage\"])\n+        sage: (out, err, ret) = test_executable([\"sage\"], env={'SAGE_BANNER': 'bare'})\n         sage: out.find(version()) >= 0\n         True\n         sage: err\n@@ -110,7 +110,7 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         sage: ret\n         0\n \n-        sage: (out, err, ret) = test_executable([\"sage\"], \"3^33\\n\")\n+        sage: (out, err, ret) = test_executable([\"sage\"], \"3^33\\n\", env={'SAGE_BANNER': 'bare'})\n         sage: out.find(version()) >= 0\n         True\n         sage: out.find(\"5559060566555523\") >= 0\n@@ -120,7 +120,7 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         sage: ret\n         0\n \n-        sage: (out, err, ret) = test_executable([\"sage\", \"-q\"], \"3^33\\n\")\n+        sage: (out, err, ret) = test_executable([\"sage\", \"-q\"], \"3^33\\n\", env={'SAGE_BANNER': 'bare'})\n         sage: out.find(version()) >= 0\n         False\n         sage: out.find(\"5559060566555523\") >= 0\n@@ -728,6 +728,9 @@ def test_executable(args, input=\"\", timeout=100.0, **kwds):\n         del pexpect_env[\"TERM\"]\n     except KeyError:\n         pass\n+\n+    pexpect_env.update(env)\n+\n     p = Popen(args, stdin=PIPE, stdout=PIPE, stderr=PIPE, env=pexpect_env, **kwds)\n     if input:\n         p.stdin.write(input)\n\n```",
    "created_at": "2016-04-01T12:03:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292883",
    "user": "https://github.com/embray"
}
```

<div id="comment:25" align="right">comment:25</div>

I still think that if a test is expecting something particular about the environment that it should set that environment for the test.  For example something like

```diff
diff --git a/src/sage/tests/cmdline.py b/src/sage/tests/cmdline.py
index 534436d..1d0395e 100644
--- a/src/sage/tests/cmdline.py
+++ b/src/sage/tests/cmdline.py
@@ -57,7 +57,7 @@ from subprocess import *
 import os, select
 
 
-def test_executable(args, input="", timeout=100.0, **kwds):
+def test_executable(args, input="", timeout=100.0, env={}, **kwds):
     r"""
     Run the program defined by ``args`` using the string ``input`` on
     the standard input.
@@ -102,7 +102,7 @@ def test_executable(args, input="", timeout=100.0, **kwds):
 
     Run Sage itself with various options::
 
-        sage: (out, err, ret) = test_executable(["sage"])
+        sage: (out, err, ret) = test_executable(["sage"], env={'SAGE_BANNER': 'bare'})
         sage: out.find(version()) >= 0
         True
         sage: err
@@ -110,7 +110,7 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         sage: ret
         0
 
-        sage: (out, err, ret) = test_executable(["sage"], "3^33\n")
+        sage: (out, err, ret) = test_executable(["sage"], "3^33\n", env={'SAGE_BANNER': 'bare'})
         sage: out.find(version()) >= 0
         True
         sage: out.find("5559060566555523") >= 0
@@ -120,7 +120,7 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         sage: ret
         0
 
-        sage: (out, err, ret) = test_executable(["sage", "-q"], "3^33\n")
+        sage: (out, err, ret) = test_executable(["sage", "-q"], "3^33\n", env={'SAGE_BANNER': 'bare'})
         sage: out.find(version()) >= 0
         False
         sage: out.find("5559060566555523") >= 0
@@ -728,6 +728,9 @@ def test_executable(args, input="", timeout=100.0, **kwds):
         del pexpect_env["TERM"]
     except KeyError:
         pass
+
+    pexpect_env.update(env)
+
     p = Popen(args, stdin=PIPE, stdout=PIPE, stderr=PIPE, env=pexpect_env, **kwds)
     if input:
         p.stdin.write(input)

```



---

archive/issue_comments_292884.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/20322)** to **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)**",
    "created_at": "2016-04-01T15:10:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292884",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/20322](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/20322)** to **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)**



---

archive/issue_events_284304.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-01T15:10:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284304"
}
```



---

archive/issue_events_284305.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a29c4d0e00684e720fb2aec561f6a14ad4d7f227",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-04-01T15:10:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20322#event-284305"
}
```



---

archive/issue_comments_292885.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nIncidentally, the patchbot has its own unicode banner that is causing Docker client to crash: https://github.com/robertwb/sage-patchbot/blob/master/src/patchbot.py#L455  I will open a separate issue.",
    "created_at": "2016-04-04T09:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292885",
    "user": "https://github.com/embray"
}
```

<div id="comment:27" align="right">comment:27</div>

Incidentally, the patchbot has its own unicode banner that is causing Docker client to crash: https://github.com/robertwb/sage-patchbot/blob/master/src/patchbot.py#L455  I will open a separate issue.



---

archive/issue_comments_292886.json:
```json
{
    "body": "Changed commit from **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)** to none",
    "created_at": "2016-04-04T09:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292886",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`5b87f1a`](https://github.com/sagemath/sagetrac-mirror/commit/5b87f1aca7a38d0c5ef80b8e12b16822039a7360)** to none



---

archive/issue_comments_292887.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI have submitted an issue regarding the patchbot's banner to https://github.com/robertwb/sage-patchbot/pull/78",
    "created_at": "2016-04-04T21:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20322#issuecomment-292887",
    "user": "https://github.com/embray"
}
```

<div id="comment:28" align="right">comment:28</div>

I have submitted an issue regarding the patchbot's banner to https://github.com/robertwb/sage-patchbot/pull/78
