# Issue 20110: Speed up Polyhedron_base.graph()

archive/issues_019873.json:
```json
{
    "assignees": [],
    "body": "Currently, `Polyhedron_base.graph()` intersects with the base set of all vertices in every of the *n* over 2 loop iterations in line 3321, where *n* is the number of vertices. This is useless as far as I can see, because the sets that are being intersected cannot possibly ever contain something that is not a vertex.\n\nLeaving out this additional intersection speeds up the process of constructing the graph significantly. I tested it on a 4 GHz machine for the polyhedron `polytopes.associahedron(['E', 7])`, and with my patch it only took close to two minutes instead of 5:15. Other examples like `polytopes.associahedron(['E', 8])` also suggest a *significant* speedup, although I don't have precise measurements from the same machine.\n\nI also tested that the resulting graph is actually the same for some polyhedra.\n\nBranch/Commit: **[`0a2602f`](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)**\n\nReviewer: **Volker Braun**\n\nAuthor: **Jan-Philipp Litza**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20110_\n\n",
    "closed_at": "2016-02-28T00:52:27Z",
    "created_at": "2016-02-25T09:22:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%205%20%E2%80%93%20trivial",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Speed up Polyhedron_base.graph()",
    "type": "issue",
    "updated_at": "2016-02-28T00:52:27Z",
    "url": "https://github.com/sagemath/sage/issues/20110",
    "user": "https://github.com/jplitza"
}
```
Currently, `Polyhedron_base.graph()` intersects with the base set of all vertices in every of the *n* over 2 loop iterations in line 3321, where *n* is the number of vertices. This is useless as far as I can see, because the sets that are being intersected cannot possibly ever contain something that is not a vertex.

Leaving out this additional intersection speeds up the process of constructing the graph significantly. I tested it on a 4 GHz machine for the polyhedron `polytopes.associahedron(['E', 7])`, and with my patch it only took close to two minutes instead of 5:15. Other examples like `polytopes.associahedron(['E', 8])` also suggest a *significant* speedup, although I don't have precise measurements from the same machine.

I also tested that the resulting graph is actually the same for some polyhedra.

Branch/Commit: **[`0a2602f`](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)**

Reviewer: **Volker Braun**

Author: **Jan-Philipp Litza**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/20110_





---

archive/issue_events_284073.json:
```json
{
    "actor": "https://github.com/jplitza",
    "created_at": "2016-02-25T09:22:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284073"
}
```



---

archive/issue_events_284074.json:
```json
{
    "actor": "https://github.com/jplitza",
    "created_at": "2016-02-25T09:22:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284074"
}
```



---

archive/issue_events_284075.json:
```json
{
    "actor": "https://github.com/jplitza",
    "created_at": "2016-02-25T09:22:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/p%3A%205%20%E2%80%93%20trivial",
    "label_color": "fff9e5",
    "label_name": "p: 5 \u2013 trivial",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284075"
}
```



---

archive/issue_events_284076.json:
```json
{
    "actor": "https://github.com/jplitza",
    "created_at": "2016-02-25T09:22:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284076"
}
```



---

archive/issue_comments_288711.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nLooks good to me. I assume tests pass. You should set tickets to \"needs review\" when you are ready...",
    "created_at": "2016-02-25T17:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20110#issuecomment-288711",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">comment:1</div>

Looks good to me. I assume tests pass. You should set tickets to "needs review" when you are ready...



---

archive/issue_events_284077.json:
```json
{
    "actor": "https://github.com/jplitza",
    "created_at": "2016-02-26T07:06:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284077"
}
```



---

archive/issue_comments_288712.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2016-02-26T09:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20110#issuecomment-288712",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_288713.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nCan you fill in the \"Author\" field with your real name?",
    "created_at": "2016-02-26T09:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20110#issuecomment-288713",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">comment:3</div>

Can you fill in the "Author" field with your real name?



---

archive/issue_comments_288714.json:
```json
{
    "body": "Author: **Jan-Philipp Litza**",
    "created_at": "2016-02-27T10:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20110#issuecomment-288714",
    "user": "https://github.com/jplitza"
}
```

Author: **Jan-Philipp Litza**



---

archive/issue_events_284078.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-27T11:30:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284078"
}
```



---

archive/issue_events_284079.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-27T11:30:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284079"
}
```



---

archive/issue_comments_288715.json:
```json
{
    "body": "Changed branch from **[u/jplitza/polyhedron_graph](https://github.com/sagemath/sagetrac-mirror/tree/u/jplitza/polyhedron_graph)** to **[`0a2602f`](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)**",
    "created_at": "2016-02-28T00:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20110#issuecomment-288715",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jplitza/polyhedron_graph](https://github.com/sagemath/sagetrac-mirror/tree/u/jplitza/polyhedron_graph)** to **[`0a2602f`](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)**



---

archive/issue_events_284080.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-28T00:52:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284080"
}
```



---

archive/issue_events_284081.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "42eb68dff22070903e374e7f5879665326ce7780",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-02-28T00:52:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20110",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20110#event-284081"
}
```
