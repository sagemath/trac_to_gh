# Issue 20110: Speed up Polyhedron_base.graph()

archive/issues_019873.json:
```json
{
    "body": "Currently, `Polyhedron_base.graph()` intersects with the base set of all vertices in every of the *n* over 2 loop iterations in line 3321, where *n* is the number of vertices. This is useless as far as I can see, because the sets that are being intersected cannot possibly ever contain something that is not a vertex.\n\nLeaving out this additional intersection speeds up the process of constructing the graph significantly. I tested it on a 4 GHz machine for the polyhedron `polytopes.associahedron(['E', 7])`, and with my patch it only took close to two minutes instead of 5:15. Other examples like `polytopes.associahedron(['E', 8])` also suggest a *significant* speedup, although I don't have precise measurements from the same machine.\n\nI also tested that the resulting graph is actually the same for some polyhedra.\n\nBranch/Commit: [0a2602fcba8d18b204dbcd23f8a106f9bc63d55d](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)\n\nReviewer: Volker Braun\n\nAuthor: Jan-Philipp Litza\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20110\n\n",
    "closed_at": "2016-02-28T00:52:27Z",
    "created_at": "2016-02-25T09:22:26Z",
    "labels": [
        "component: geometry",
        "trivial"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Speed up Polyhedron_base.graph()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20110",
    "user": "https://github.com/jplitza"
}
```
Currently, `Polyhedron_base.graph()` intersects with the base set of all vertices in every of the *n* over 2 loop iterations in line 3321, where *n* is the number of vertices. This is useless as far as I can see, because the sets that are being intersected cannot possibly ever contain something that is not a vertex.

Leaving out this additional intersection speeds up the process of constructing the graph significantly. I tested it on a 4 GHz machine for the polyhedron `polytopes.associahedron(['E', 7])`, and with my patch it only took close to two minutes instead of 5:15. Other examples like `polytopes.associahedron(['E', 8])` also suggest a *significant* speedup, although I don't have precise measurements from the same machine.

I also tested that the resulting graph is actually the same for some polyhedra.

Branch/Commit: [0a2602fcba8d18b204dbcd23f8a106f9bc63d55d](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)

Reviewer: Volker Braun

Author: Jan-Philipp Litza

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20110





---

archive/issue_comments_366633.json:
```json
{
    "body": "<a id='comment:1'></a>\nLooks good to me. I assume tests pass. You should set tickets to \"needs review\" when you are ready...",
    "created_at": "2016-02-25T17:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366633",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:1'></a>
Looks good to me. I assume tests pass. You should set tickets to "needs review" when you are ready...



---

archive/issue_comments_366634.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-26T07:06:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366634",
    "user": "https://github.com/jplitza"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_366635.json:
```json
{
    "body": "Reviewer: Volker Braun",
    "created_at": "2016-02-26T09:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366635",
    "user": "https://github.com/vbraun"
}
```

Reviewer: Volker Braun



---

archive/issue_comments_366636.json:
```json
{
    "body": "<a id='comment:3'></a>\nCan you fill in the \"Author\" field with your real name?",
    "created_at": "2016-02-26T09:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366636",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>
Can you fill in the "Author" field with your real name?



---

archive/issue_comments_366637.json:
```json
{
    "body": "Author: Jan-Philipp Litza",
    "created_at": "2016-02-27T10:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366637",
    "user": "https://github.com/jplitza"
}
```

Author: Jan-Philipp Litza



---

archive/issue_comments_366638.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-27T11:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366638",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_366639.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-02-28T00:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366639",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_366640.json:
```json
{
    "body": "Changing branch from \"[u/jplitza/polyhedron_graph](https://github.com/sagemath/sagetrac-mirror/tree/u/jplitza/polyhedron_graph)\" to \"[0a2602fcba8d18b204dbcd23f8a106f9bc63d55d](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)\"",
    "created_at": "2016-02-28T00:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20110#issuecomment-366640",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/jplitza/polyhedron_graph](https://github.com/sagemath/sagetrac-mirror/tree/u/jplitza/polyhedron_graph)" to "[0a2602fcba8d18b204dbcd23f8a106f9bc63d55d](https://github.com/sagemath/sagetrac-mirror/commit/0a2602fcba8d18b204dbcd23f8a106f9bc63d55d)"



---

archive/issue_events_062257.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-28T00:52:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20110",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20110#event-62257"
}
```
