# Issue 20310: change for p-adic rings

archive/issues_020073.json:
```json
{
    "body": "Started as a proposal to change precision of rings, this is now a more general `change` method.\n\nCC:  @saraedum @roed314\n\nKeywords: precision\n\nBranch/Commit: 86b58de413e57a646288c2d0ac38db75e6d04430\n\nReviewer: Julian R\u00fcth, Xavier Caruso\n\nAuthor: David Roe\n\nDependencies: #23331\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20310\n\n",
    "closed_at": "2017-08-11T18:18:12Z",
    "created_at": "2016-03-27T21:42:44Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "change for p-adic rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20310",
    "user": "https://github.com/xcaruso"
}
```
Started as a proposal to change precision of rings, this is now a more general `change` method.

CC:  @saraedum @roed314

Keywords: precision

Branch/Commit: 86b58de413e57a646288c2d0ac38db75e6d04430

Reviewer: Julian RÃ¼th, Xavier Caruso

Author: David Roe

Dependencies: #23331

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20310





---

archive/issue_comments_294217.json:
```json
{
    "body": "<a id='comment:1'></a>As discussed in Sage Days 71, I tried to implement this method using the construction functor but it seems that the latter is only defined for Zp or Qp but not for extensions.\nSo, what should I do? Implement the methods `construction` as well? Something else?",
    "created_at": "2016-03-27T21:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294217",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:1'></a>As discussed in Sage Days 71, I tried to implement this method using the construction functor but it seems that the latter is only defined for Zp or Qp but not for extensions.
So, what should I do? Implement the methods `construction` as well? Something else?



---

archive/issue_comments_294218.json:
```json
{
    "body": "<a id='comment:3'></a>Implementing `construction` is a good idea anyway, since they're used in coercion.  And until we change extensions to be defined by exact polynomials, you'll need to raise the precision of the base ring as well, so it's probably necessary.\n\n---\nNew commits:",
    "created_at": "2016-03-27T22:31:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294218",
    "user": "https://github.com/roed314"
}
```

<a id='comment:3'></a>Implementing `construction` is a good idea anyway, since they're used in coercion.  And until we change extensions to be defined by exact polynomials, you'll need to raise the precision of the base ring as well, so it's probably necessary.

---
New commits:



---

archive/issue_comments_294219.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-14T08:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294219",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294220.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-15T07:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294220",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294221.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-15T21:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294222.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-15T22:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294223.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-15T22:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294223",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294224.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-15T22:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294224",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_294225.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-I propose to implement a method change_precision for p-adic rings/fields (which is supposed the same ring/field with a different precision).\n+Started as a proposal to change precision of rings, this is now a more general `change` method.\n \n Comment: 1\n \n``````\n",
    "created_at": "2017-06-16T04:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294225",
    "user": "https://github.com/saraedum"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-I propose to implement a method change_precision for p-adic rings/fields (which is supposed the same ring/field with a different precision).
+Started as a proposal to change precision of rings, this is now a more general `change` method.
 
 Comment: 1
 
``````




---

archive/issue_comments_294226.json:
```json
{
    "body": "<a id='comment:12'></a>I'm a bit sceptical about the possibility of changing `p` (and even `q`). Can you show me a situation where this can be needed?\n\nAdding `show_prec` is nice but is it really the subject of this ticket?\n\nDoctests implying the keyword `base` are missing. The same is true for `show_prec`. More generally, I suggest to add many more doctests ensuring that your code works in a wide range of situations (for ramified, unramified extensions, for extensions constructing via `CompletionFunction` and `AlgebraicExtensionFunctor`, etc.)",
    "created_at": "2017-06-16T05:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294226",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:12'></a>I'm a bit sceptical about the possibility of changing `p` (and even `q`). Can you show me a situation where this can be needed?

Adding `show_prec` is nice but is it really the subject of this ticket?

Doctests implying the keyword `base` are missing. The same is true for `show_prec`. More generally, I suggest to add many more doctests ensuring that your code works in a wide range of situations (for ramified, unramified extensions, for extensions constructing via `CompletionFunction` and `AlgebraicExtensionFunctor`, etc.)



---

archive/issue_comments_294227.json:
```json
{
    "body": "<a id='comment:13'></a>Xavier: Thanks for having a look at this as well. We discussed the changing of `p` and `q` briefly and actually I find it very useful. Often I am only really interested in the ramified part of a tower of extensions (on my fork that already does more general towers.) But for some computation to work out, I need a certain unramified element at the bottom, so I don't want to manually reconstruct the whole tower, so raising and lowering `q` is quite useful. Changing `p` is mostly interesting in general extensions where you want to see how a certain polynomial behaves wrt to different primes. For the Eisenstein extensions that we support atm it is not too useful.\n\nI think it's Ok to put the `show_prec` in here, I'm fine with reviewing it at least :)\n\nI agree that doctests for `base` and `show_prec` should be added. However, I think that in general not all possible cases should be covered by explicit doctests. It usually makes the documentation overwhelming. If we want to have coverage, we should write unit tests for that instead. That's btw one of the topics that we want to push in Burlington! Imho, the testing for `change` is Ok except for the untested keywords.",
    "created_at": "2017-06-16T06:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294227",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:13'></a>Xavier: Thanks for having a look at this as well. We discussed the changing of `p` and `q` briefly and actually I find it very useful. Often I am only really interested in the ramified part of a tower of extensions (on my fork that already does more general towers.) But for some computation to work out, I need a certain unramified element at the bottom, so I don't want to manually reconstruct the whole tower, so raising and lowering `q` is quite useful. Changing `p` is mostly interesting in general extensions where you want to see how a certain polynomial behaves wrt to different primes. For the Eisenstein extensions that we support atm it is not too useful.

I think it's Ok to put the `show_prec` in here, I'm fine with reviewing it at least :)

I agree that doctests for `base` and `show_prec` should be added. However, I think that in general not all possible cases should be covered by explicit doctests. It usually makes the documentation overwhelming. If we want to have coverage, we should write unit tests for that instead. That's btw one of the topics that we want to push in Burlington! Imho, the testing for `change` is Ok except for the untested keywords.



---

archive/issue_comments_294228.json:
```json
{
    "body": "<a id='comment:14'></a>David: should `get_key_base` set `show_prec`? Otherwise, `show_prec=None` and `show_prec=True/False` produces two non-identical parents for the same ring I think.",
    "created_at": "2017-06-16T06:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294228",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:14'></a>David: should `get_key_base` set `show_prec`? Otherwise, `show_prec=None` and `show_prec=True/False` produces two non-identical parents for the same ring I think.



---

archive/issue_comments_294229.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-16T06:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294229",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_294230.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-16T08:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294230",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294231.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-16T08:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294231",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_294232.json:
```json
{
    "body": "<a id='comment:17'></a>I fixed the show_prec issue.",
    "created_at": "2017-06-16T08:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294232",
    "user": "https://github.com/roed314"
}
```

<a id='comment:17'></a>I fixed the show_prec issue.



---

archive/issue_comments_294233.json:
```json
{
    "body": "<a id='comment:18'></a>Looks good to me. Feel free to set this to positive review if the tests pass.",
    "created_at": "2017-06-16T11:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294233",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:18'></a>Looks good to me. Feel free to set this to positive review if the tests pass.



---

archive/issue_comments_294234.json:
```json
{
    "body": "<a id='comment:19'></a>\n```\nsage: R = Zp(5)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-1247c7c70bf9> in <module>()\n----> 1 R = Zp(Integer(5))\n\n/home/xavier/sage/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (/home/xavier/sage/src/build/cythonized/sage/structure/factory.c:1728)()\n    360             False\n    361         \"\"\"\n--> 362         key, kwds = self.create_key_and_extra_args(*args, **kwds)\n    363         version = self.get_version(sage_version)\n    364         return self.get_object(version, key, kwds)\n\n/home/xavier/sage/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.create_key_and_extra_args (/home/xavier/sage/src/build/cythonized/sage/structure/factory.c:2921)()\n    458             ((3, ('x',), None, 'modn', \"{'foo': 'value'}\", 3, 1, True), {'foo': 'value'})\n    459         \"\"\"\n--> 460         return self.create_key(*args, **kwds), {}\n    461 \n    462     def create_key(self, *args, **kwds):\n\n/home/xavier/sage/local/lib/python2.7/site-packages/sage/rings/padics/factory.pyc in create_key(self, p, prec, type, print_mode, halt, names, ram_name, print_pos, print_sep, print_alphabet, print_max_terms, show_prec, check)\n   1608         \"\"\"\n   1609         return get_key_base(p, prec, type, print_mode, halt, names, ram_name, print_pos, print_sep, print_alphabet,\n-> 1610                             print_max_terms, show_prec, check, ['capped-rel', 'fixed-mod', 'capped-abs', 'floating-point'])\n   1611 \n   1612     def create_object(self, version, key):\n\n/home/xavier/sage/local/lib/python2.7/site-packages/sage/rings/padics/factory.pyc in get_key_base(p, prec, type, print_mode, halt, names, ram_name, print_pos, print_sep, print_alphabet, print_max_terms, show_prec, check, valid_non_lazy_types)\n    161         if type == 'floating-point':\n    162             show_prec = False\n--> 163         elif print_mode ('series', 'terse', 'val-unit'):\n    164             show_prec = True\n    165         else:\n\nTypeError: 'str' object is not callable\n```",
    "created_at": "2017-06-16T20:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294234",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:19'></a>
```
sage: R = Zp(5)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-1247c7c70bf9> in <module>()
----> 1 R = Zp(Integer(5))

/home/xavier/sage/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (/home/xavier/sage/src/build/cythonized/sage/structure/factory.c:1728)()
    360             False
    361         """
--> 362         key, kwds = self.create_key_and_extra_args(*args, **kwds)
    363         version = self.get_version(sage_version)
    364         return self.get_object(version, key, kwds)

/home/xavier/sage/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.create_key_and_extra_args (/home/xavier/sage/src/build/cythonized/sage/structure/factory.c:2921)()
    458             ((3, ('x',), None, 'modn', "{'foo': 'value'}", 3, 1, True), {'foo': 'value'})
    459         """
--> 460         return self.create_key(*args, **kwds), {}
    461 
    462     def create_key(self, *args, **kwds):

/home/xavier/sage/local/lib/python2.7/site-packages/sage/rings/padics/factory.pyc in create_key(self, p, prec, type, print_mode, halt, names, ram_name, print_pos, print_sep, print_alphabet, print_max_terms, show_prec, check)
   1608         """
   1609         return get_key_base(p, prec, type, print_mode, halt, names, ram_name, print_pos, print_sep, print_alphabet,
-> 1610                             print_max_terms, show_prec, check, ['capped-rel', 'fixed-mod', 'capped-abs', 'floating-point'])
   1611 
   1612     def create_object(self, version, key):

/home/xavier/sage/local/lib/python2.7/site-packages/sage/rings/padics/factory.pyc in get_key_base(p, prec, type, print_mode, halt, names, ram_name, print_pos, print_sep, print_alphabet, print_max_terms, show_prec, check, valid_non_lazy_types)
    161         if type == 'floating-point':
    162             show_prec = False
--> 163         elif print_mode ('series', 'terse', 'val-unit'):
    164             show_prec = True
    165         else:

TypeError: 'str' object is not callable
```



---

archive/issue_comments_294235.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-16T20:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294235",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_294236.json:
```json
{
    "body": "<a id='comment:20'></a>By the way, I guess that your changes is not compatible with ticket #22103. \n\nIt's of course not that annoying (and, as I've already said, I'm fine with adding the keyword `show_prec`) but maybe we could have a discussion about the \"right way\" to print p-adic numbers.",
    "created_at": "2017-06-16T20:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294236",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:20'></a>By the way, I guess that your changes is not compatible with ticket #22103. 

It's of course not that annoying (and, as I've already said, I'm fine with adding the keyword `show_prec`) but maybe we could have a discussion about the "right way" to print p-adic numbers.



---

archive/issue_comments_294237.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-16T21:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294238.json:
```json
{
    "body": "<a id='comment:22'></a>I just fixed various doctest issues and added some code for the case of changing print_mode (show_prec was not changed).  I ran all tests on the result, and they all pass, but I think I need someone to take a look rather than just setting it to positive review.",
    "created_at": "2017-06-16T21:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294238",
    "user": "https://github.com/roed314"
}
```

<a id='comment:22'></a>I just fixed various doctest issues and added some code for the case of changing print_mode (show_prec was not changed).  I ran all tests on the result, and they all pass, but I think I need someone to take a look rather than just setting it to positive review.



---

archive/issue_comments_294239.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-16T21:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294239",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_294240.json:
```json
{
    "body": "<a id='comment:23'></a>Well, I'm still not that convinced by changing `p`. You say that \"it is mostly interesting in general extensions where you want to see how a certain polynomial behaves wrt to different primes\" but I guess that the modulus is just stored modulo `p^prec`, so converting it in others `Z_p`'s may lead to very unexpected behaviours, no?\nI nevertheless agree that changing `q` (keeping the same `p`) makes more sense.\n\nAnyway, changing `p` actually does not work in many cases:\n\n```\nsage: R.<a> = Zq(5^3)\nsage: R.change(p=7)\n...\nNotImplementedError: conversion between padic extensions not implemented\n```\n\nFor ramified extensions, something very stange happens:\n\n```\nsage: R.<a> = Zp(5).extension(x^3 + 5)\nsage: R\nEisenstein Extension of 5-adic Ring with capped relative precision 20 in a defined by  (1 + O(5^20))*x^3 + (O(5^21))*x^2 + (O(5^21))*x + (5 + O(5^21))\n\nsage: S = R.change(p=7)\nsage: S\nUnramified Extension of 7-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (O(5^20))*x + (5 + O(5^20))\n```\n\nLook at the modulus, it is still written with some `O(5^20)`'s (whereas we are supposed to be on a 7-adic ring). Even more stranger:\n\n```\nsage: c = S.modulus()[0]; c\n5 + O(5^20)\nsage: c.parent()\n7-adic Ring with capped relative precision 20\n\nsage: c.parent() is Zp(7)\nFalse\n```\n\nAs a conclusion, I would be in favour to remove this feature.",
    "created_at": "2017-06-17T02:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294240",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:23'></a>Well, I'm still not that convinced by changing `p`. You say that "it is mostly interesting in general extensions where you want to see how a certain polynomial behaves wrt to different primes" but I guess that the modulus is just stored modulo `p^prec`, so converting it in others `Z_p`'s may lead to very unexpected behaviours, no?
I nevertheless agree that changing `q` (keeping the same `p`) makes more sense.

Anyway, changing `p` actually does not work in many cases:

```
sage: R.<a> = Zq(5^3)
sage: R.change(p=7)
...
NotImplementedError: conversion between padic extensions not implemented
```

For ramified extensions, something very stange happens:

```
sage: R.<a> = Zp(5).extension(x^3 + 5)
sage: R
Eisenstein Extension of 5-adic Ring with capped relative precision 20 in a defined by  (1 + O(5^20))*x^3 + (O(5^21))*x^2 + (O(5^21))*x + (5 + O(5^21))

sage: S = R.change(p=7)
sage: S
Unramified Extension of 7-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (O(5^20))*x + (5 + O(5^20))
```

Look at the modulus, it is still written with some `O(5^20)`'s (whereas we are supposed to be on a 7-adic ring). Even more stranger:

```
sage: c = S.modulus()[0]; c
5 + O(5^20)
sage: c.parent()
7-adic Ring with capped relative precision 20

sage: c.parent() is Zp(7)
False
```

As a conclusion, I would be in favour to remove this feature.



---

archive/issue_comments_294241.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-17T02:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294241",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_294242.json:
```json
{
    "body": "<a id='comment:24'></a>Other issues with the change of precision:\n\n```\nsage: R.<a> = Zq(5^3)\nsage: S = R.change(prec=50)\nsage: S\nUnramified Extension of 5-adic Ring with capped relative precision 50 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (3 + O(5^20))*x + (3 + O(5^20))\n```\n\nThe defining polynomial has not been lifted to precision 50.\n\nIn fact, it seems that we cannot compute at all at precision 50 is `S`:\n\n```\nsage: S.gen()\na + O(5^20)\nsage: S.precision_cap()\n20\n```\n\nFor ramified extensions, the precision on the modulus decreases:\n\n```\nsage: R.<a> = Zp(5).extension(x^3 + 5)\nsage: R\nEisenstein Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^21))*x^2 + (O(5^21))*x + (5 + O(5^21))\nsage: S = R.change(prec=50)\nsage: S\nEisenstein Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^18))*x^3 + (O(5^18))*x^2 + (O(5^18))*x + (5 + O(5^18))\n```\n\nbut (unexpectedly) computations in `S` seem to be fine.",
    "created_at": "2017-06-17T02:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294242",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:24'></a>Other issues with the change of precision:

```
sage: R.<a> = Zq(5^3)
sage: S = R.change(prec=50)
sage: S
Unramified Extension of 5-adic Ring with capped relative precision 50 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (3 + O(5^20))*x + (3 + O(5^20))
```

The defining polynomial has not been lifted to precision 50.

In fact, it seems that we cannot compute at all at precision 50 is `S`:

```
sage: S.gen()
a + O(5^20)
sage: S.precision_cap()
20
```

For ramified extensions, the precision on the modulus decreases:

```
sage: R.<a> = Zp(5).extension(x^3 + 5)
sage: R
Eisenstein Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^21))*x^2 + (O(5^21))*x + (5 + O(5^21))
sage: S = R.change(prec=50)
sage: S
Eisenstein Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^18))*x^3 + (O(5^18))*x^2 + (O(5^18))*x + (5 + O(5^18))
```

but (unexpectedly) computations in `S` seem to be fine.



---

archive/issue_comments_294243.json:
```json
{
    "body": "<a id='comment:25'></a>Good points.  We've also been thinking about switching defining polynomials to being exact, in which case some of the precision issues go away.\n\nI'll take a look at this when I'm back, in a week and a half or so.",
    "created_at": "2017-06-17T07:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294243",
    "user": "https://github.com/roed314"
}
```

<a id='comment:25'></a>Good points.  We've also been thinking about switching defining polynomials to being exact, in which case some of the precision issues go away.

I'll take a look at this when I'm back, in a week and a half or so.



---

archive/issue_comments_294244.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-28T01:15:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294245.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-28T01:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294246.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-28T02:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294247.json:
```json
{
    "body": "<a id='comment:29'></a>I fixed the printing problem that was causing the weird behavior you observed when changing p.  If the defining polynomial is defined over the integers, then changing p works; if not it doesn't.\n\nI also added an error if you try to increase the precision above the limit imposed by the defining polynomial.",
    "created_at": "2017-06-28T02:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294247",
    "user": "https://github.com/roed314"
}
```

<a id='comment:29'></a>I fixed the printing problem that was causing the weird behavior you observed when changing p.  If the defining polynomial is defined over the integers, then changing p works; if not it doesn't.

I also added an error if you try to increase the precision above the limit imposed by the defining polynomial.



---

archive/issue_comments_294248.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-28T02:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294248",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_294249.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-28T02:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294249",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294250.json:
```json
{
    "body": "<a id='comment:31'></a>All tests pass for me.",
    "created_at": "2017-06-28T02:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294250",
    "user": "https://github.com/roed314"
}
```

<a id='comment:31'></a>All tests pass for me.



---

archive/issue_comments_294251.json:
```json
{
    "body": "<a id='comment:32'></a>Not a complete review, but I noticed the following:\n\nIn the doctest of the method `change`, some items are introduced by `--` instead of `-`.\n\nWhen creating an unramified extension, we cannot specify the variable name using the keyword `unram_name`:\n\n```\nsage: R = Zp(5)\nsage: R.change(q=25, unram_name='a')\n...\nTypeError: You must specify the name of the generator\n\nsage: R2.<a> = Zq(5^2)\nsage: R2.change(q=125,unram_name='b')\nUnramified Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (3 + O(5^20))*x + (3 + O(5^20))\n```\n\n(Note nevertheless than using `names` instead of `unram_name` works fine.)\n\nI am a bit lost with exact VS inexact defining polynomials. For instance:\n\n```\nsage: var('x')\nx\nsage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R.change(p=11)\nUnramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))\n\nsage: ZX.<x> = ZZ[]\nsage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R.change(p=11)\n...\nNotImplementedError: conversion between padic extensions not implemented\n```\n\nBy the way, even when the defining polynomial is exact, the methods `modulus` and `defining_polynomial` return an inexact polynomial. Is there a method that returns the exact defining polynomial (i.e. the content of the attribute `_pre_poly` as far as I understand)?",
    "created_at": "2017-06-28T20:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294251",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:32'></a>Not a complete review, but I noticed the following:

In the doctest of the method `change`, some items are introduced by `--` instead of `-`.

When creating an unramified extension, we cannot specify the variable name using the keyword `unram_name`:

```
sage: R = Zp(5)
sage: R.change(q=25, unram_name='a')
...
TypeError: You must specify the name of the generator

sage: R2.<a> = Zq(5^2)
sage: R2.change(q=125,unram_name='b')
Unramified Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (3 + O(5^20))*x + (3 + O(5^20))
```

(Note nevertheless than using `names` instead of `unram_name` works fine.)

I am a bit lost with exact VS inexact defining polynomials. For instance:

```
sage: var('x')
x
sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R.change(p=11)
Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))

sage: ZX.<x> = ZZ[]
sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R.change(p=11)
...
NotImplementedError: conversion between padic extensions not implemented
```

By the way, even when the defining polynomial is exact, the methods `modulus` and `defining_polynomial` return an inexact polynomial. Is there a method that returns the exact defining polynomial (i.e. the content of the attribute `_pre_poly` as far as I understand)?



---

archive/issue_comments_294252.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-28T20:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294252",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_294253.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-28T22:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294254.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:32 caruso]:\n> Not a complete review, but I noticed the following:\n> \n> In the doctest of the method `change`, some items are introduced by `--` instead of `-`.\n\n\nFixed, thanks.\n\n> When creating an unramified extension, we cannot specify the variable name using the keyword `unram_name`:\n> \n> \n> ```\n> sage: R = Zp(5)\n> sage: R.change(q=25, unram_name='a')\n> ...\n> TypeError: You must specify the name of the generator\n> \n> sage: R2.<a> = Zq(5^2)\n> sage: R2.change(q=125,unram_name='b')\n> Unramified Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (3 + O(5^20))*x + (3 + O(5^20))\n> ```\n> \n> (Note nevertheless than using `names` instead of `unram_name` works fine.)\n\n\nFixed.\n\n> I am a bit lost with exact VS inexact defining polynomials. For instance:\n> \n> \n> ```\n> sage: var('x')\n> x\n> sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)\n> sage: R.change(p=11)\n> Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))\n> \n> sage: ZX.<x> = ZZ[]\n> sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)\n> sage: R.change(p=11)\n> ...\n> NotImplementedError: conversion between padic extensions not implemented\n> ```\n\n\nI get that both of these work.  It's possible that your cache has been poisoned by trying to first create R using a p-adic modulus, and then later with a modulus over Z?  This is the kind of thing that might be alleviated by #23331.\n\n> By the way, even when the defining polynomial is exact, the methods `modulus` and `defining_polynomial` return an inexact polynomial. Is there a method that returns the exact defining polynomial (i.e. the content of the attribute `_pre_poly` as far as I understand)?\n\n\nI don't think there's currently a method to get `_pre_poly`. I would suggest holding off on that change until #23331.",
    "created_at": "2017-06-28T23:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294254",
    "user": "https://github.com/roed314"
}
```

<a id='comment:34'></a>Replying to [comment:32 caruso]:
> Not a complete review, but I noticed the following:
> 
> In the doctest of the method `change`, some items are introduced by `--` instead of `-`.


Fixed, thanks.

> When creating an unramified extension, we cannot specify the variable name using the keyword `unram_name`:
> 
> 
> ```
> sage: R = Zp(5)
> sage: R.change(q=25, unram_name='a')
> ...
> TypeError: You must specify the name of the generator
> 
> sage: R2.<a> = Zq(5^2)
> sage: R2.change(q=125,unram_name='b')
> Unramified Extension of 5-adic Ring with capped relative precision 20 in a defined by (1 + O(5^20))*x^3 + (O(5^20))*x^2 + (3 + O(5^20))*x + (3 + O(5^20))
> ```
> 
> (Note nevertheless than using `names` instead of `unram_name` works fine.)


Fixed.

> I am a bit lost with exact VS inexact defining polynomials. For instance:
> 
> 
> ```
> sage: var('x')
> x
> sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)
> sage: R.change(p=11)
> Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))
> 
> sage: ZX.<x> = ZZ[]
> sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)
> sage: R.change(p=11)
> ...
> NotImplementedError: conversion between padic extensions not implemented
> ```


I get that both of these work.  It's possible that your cache has been poisoned by trying to first create R using a p-adic modulus, and then later with a modulus over Z?  This is the kind of thing that might be alleviated by #23331.

> By the way, even when the defining polynomial is exact, the methods `modulus` and `defining_polynomial` return an inexact polynomial. Is there a method that returns the exact defining polynomial (i.e. the content of the attribute `_pre_poly` as far as I understand)?


I don't think there's currently a method to get `_pre_poly`. I would suggest holding off on that change until #23331.



---

archive/issue_comments_294255.json:
```json
{
    "body": "<a id='comment:35'></a>> I get that both of these work. It's possible that your cache has been poisoned by trying to first create R using a p-adic modulus, and then later with a modulus over Z? This is the kind of thing that might be alleviated by #23331. \n\n\nGood point. With a fresh session of sage, I have:\n\n```\nsage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R.change(p=11)\nUnramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))\nsage: \nsage: ZX.<x> = ZZ[]\nsage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R.change(p=11)\nUnramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))\n```\n\nbut:\n\n```\nsage: ZpX.<x> = Zp(5)[]\nsage: R1.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R1.change(p=11)\n...\nNotImplementedError: conversion between padic extensions not implemented\n\nsage: ZX.<x> = ZZ[]\nsage: R2.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R2.change(p=11)\n...\nNotImplementedError: conversion between padic extensions not implemented\n```\n\nand conversely:\n\n```\nsage: ZX.<x> = ZZ[]\nsage: R2.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R2.change(p=11)\nUnramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))\n\nsage: ZpX.<x> = Zp(5)[]\nsage: R1.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R1.change(p=11)\nUnramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))\n```\n\nI guess that the problem comes from the factory because, in the above examples, `R1` is the same as `R2` (i.e. `R1 is R2` answers `True`).",
    "created_at": "2017-06-29T05:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294255",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:35'></a>> I get that both of these work. It's possible that your cache has been poisoned by trying to first create R using a p-adic modulus, and then later with a modulus over Z? This is the kind of thing that might be alleviated by #23331. 


Good point. With a fresh session of sage, I have:

```
sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R.change(p=11)
Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))
sage: 
sage: ZX.<x> = ZZ[]
sage: R.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R.change(p=11)
Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))
```

but:

```
sage: ZpX.<x> = Zp(5)[]
sage: R1.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R1.change(p=11)
...
NotImplementedError: conversion between padic extensions not implemented

sage: ZX.<x> = ZZ[]
sage: R2.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R2.change(p=11)
...
NotImplementedError: conversion between padic extensions not implemented
```

and conversely:

```
sage: ZX.<x> = ZZ[]
sage: R2.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R2.change(p=11)
Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))

sage: ZpX.<x> = Zp(5)[]
sage: R1.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R1.change(p=11)
Unramified Extension of 11-adic Ring with capped relative precision 20 in a defined by (1 + O(11^20))*x^2 + (2 + O(11^20))*x + (4 + O(11^20))
```

I guess that the problem comes from the factory because, in the above examples, `R1` is the same as `R2` (i.e. `R1 is R2` answers `True`).



---

archive/issue_comments_294256.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-30T04:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294256",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_294257.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-02T02:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294257",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294258.json:
```json
{
    "body": "<a id='comment:37'></a>Unless Xavier has any objections of course.",
    "created_at": "2017-07-02T02:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294258",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:37'></a>Unless Xavier has any objections of course.



---

archive/issue_comments_294259.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-02T04:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294259",
    "user": "https://github.com/xcaruso"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_294260.json:
```json
{
    "body": "<a id='comment:38'></a>Well, I am a bit worried to give a positive review after comment 35 (which is clearly a bug for me).\n\nI am fine with fixing this in ticket #23331 but, in that case, I would wait for #23331 to be written and positively reviewed before giving a positive review to the current ticket (#20310)",
    "created_at": "2017-07-02T04:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294260",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:38'></a>Well, I am a bit worried to give a positive review after comment 35 (which is clearly a bug for me).

I am fine with fixing this in ticket #23331 but, in that case, I would wait for #23331 to be written and positively reviewed before giving a positive review to the current ticket (#20310)



---

archive/issue_comments_294261.json:
```json
{
    "body": "<a id='comment:39'></a>I don't see how this is related to this ticket really. This is just a bug in the factory that has always been there. The same problem at least happens on a stable sage\n\n```\nsage: ZpX.<x> = Zp(5)[]\nsage: R1.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: ZX.<x> = ZZ[]\nsage: R2.<a> = Zq(5^2, modulus=x^2+2*x+4)\nsage: R1 is R2\nTrue\n```\n\nI guess my point is that you could use this to construct problems with many methods in Sage. I do not see why we should have `change()` be blocked by this now. (We should of course fix this, nevertheless\u2026)",
    "created_at": "2017-07-03T05:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294261",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:39'></a>I don't see how this is related to this ticket really. This is just a bug in the factory that has always been there. The same problem at least happens on a stable sage

```
sage: ZpX.<x> = Zp(5)[]
sage: R1.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: ZX.<x> = ZZ[]
sage: R2.<a> = Zq(5^2, modulus=x^2+2*x+4)
sage: R1 is R2
True
```

I guess my point is that you could use this to construct problems with many methods in Sage. I do not see why we should have `change()` be blocked by this now. (We should of course fix this, neverthelessâ¦)



---

archive/issue_comments_294262.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-03T05:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294262",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_294263.json:
```json
{
    "body": "<a id='comment:41'></a>I do not agree. This was not a bug until this ticket implemented a method, namely `change`, that decides to treat differently extensions defined by exact and inexact polynomials.",
    "created_at": "2017-07-03T06:23:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294263",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:41'></a>I do not agree. This was not a bug until this ticket implemented a method, namely `change`, that decides to treat differently extensions defined by exact and inexact polynomials.



---

archive/issue_comments_294264.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-03T06:43:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294264",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294265.json:
```json
{
    "body": "<a id='comment:42'></a>Ok. I guess you're right that this was much more unlikely to cause trouble before.\n\nI still don't think that this should block this ticket, but I guess we have to wait for #23331 then.",
    "created_at": "2017-07-03T06:43:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294265",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:42'></a>Ok. I guess you're right that this was much more unlikely to cause trouble before.

I still don't think that this should block this ticket, but I guess we have to wait for #23331 then.



---

archive/issue_comments_294266.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-07-19T07:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294266",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_294267.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-07-19T07:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294267",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_294268.json:
```json
{
    "body": "<a id='comment:44'></a>I merged in the dependency #23331; all tests pass.",
    "created_at": "2017-07-19T07:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294268",
    "user": "https://github.com/roed314"
}
```

<a id='comment:44'></a>I merged in the dependency #23331; all tests pass.



---

archive/issue_comments_294269.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-19T21:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294269",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294270.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-19T23:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294270",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294271.json:
```json
{
    "body": "<a id='comment:48'></a>positive review once the patchbot is happy.\n\n---\nNew commits:",
    "created_at": "2017-07-20T02:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294271",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:48'></a>positive review once the patchbot is happy.

---
New commits:



---

archive/issue_comments_294272.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-20T17:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294272",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294273.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-20T19:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294273",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294274.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-08-02T18:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294274",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_294275.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-08-02T18:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294275",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_294276.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-02T20:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294276",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294277.json:
```json
{
    "body": "<a id='comment:53'></a>I just merged in the updated #23331.",
    "created_at": "2017-08-02T20:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294277",
    "user": "https://github.com/roed314"
}
```

<a id='comment:53'></a>I just merged in the updated #23331.



---

archive/issue_comments_294278.json:
```json
{
    "body": "<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-08-02T20:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294278",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_294279.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-08-02T20:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294279",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_294280.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-02T20:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294280",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294281.json:
```json
{
    "body": "Diff against 23331",
    "created_at": "2017-08-03T02:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294281",
    "user": "https://github.com/roed314"
}
```

Diff against 23331



---

archive/issue_comments_294282.json:
```json
{
    "body": "<a id='comment:56'></a>Attachment [20310_over_23331.diff](tarball://root/attachments/some-uuid/ticket20310/20310_over_23331.diff) by @roed314 created at 2017-08-03 02:02:36\n\nFor ease of reviewing, I've attached a diff against #23331.",
    "created_at": "2017-08-03T02:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294282",
    "user": "https://github.com/roed314"
}
```

<a id='comment:56'></a>Attachment [20310_over_23331.diff](tarball://root/attachments/some-uuid/ticket20310/20310_over_23331.diff) by @roed314 created at 2017-08-03 02:02:36

For ease of reviewing, I've attached a diff against #23331.



---

archive/issue_comments_294283.json:
```json
{
    "body": "<a id='comment:57'></a>PDF docs don't build",
    "created_at": "2017-08-05T15:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294283",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:57'></a>PDF docs don't build



---

archive/issue_comments_294284.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-05T15:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294284",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_294285.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-05T18:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294285",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294286.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-06T05:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294286",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_294287.json:
```json
{
    "body": "<a id='comment:60'></a>Alright, `make` succeeds at building the docs now.",
    "created_at": "2017-08-08T17:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294287",
    "user": "https://github.com/roed314"
}
```

<a id='comment:60'></a>Alright, `make` succeeds at building the docs now.



---

archive/issue_comments_294288.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-08T17:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294288",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_294289.json:
```json
{
    "body": "<a id='comment:61'></a>daucher still reports a failing docbuild. I guess that's because I told it not to clean the docs when rebuilding.",
    "created_at": "2017-08-08T17:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294289",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:61'></a>daucher still reports a failing docbuild. I guess that's because I told it not to clean the docs when rebuilding.



---

archive/issue_comments_294290.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-08T17:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294290",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_294291.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-11T18:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20310#issuecomment-294291",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_055120.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-11T18:18:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20310",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20310#event-55120"
}
```
