# Issue 20930: Generalize multiplicity() and intersection_multiplicity() for subschemes

archive/issues_020693.json:
```json
{
    "body": "Currently there is a `multiplicity()` function for algebraic curves which computes the multiplicity of a point on a curve as the multiplicity of the maximal ideal in the local ring of the curve corresponding to that point. This definition still works for arbitrary projective/affine subschemes and it would be good to implement it in the more general case.\n\nAlso, by using affine patches, it is possible to compute multiplicities and intersection multiplicities of points of subschemes of products of projective spaces, so it would be good to implement that here as well.\n\nThese implementations should be made available to both the subscheme classes and corresponding point classes.\n\nCC:  @bhutz @miguelmarco\n\nKeywords: gsoc2016\n\nBranch/Commit: 7801dcc6598fae3ef8cbbf20f7d07b78430a108a\n\nReviewer: Ben Hutz\n\nAuthor: Grayson Jorgenson\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20930\n\n",
    "closed_at": "2016-07-23T18:38:22Z",
    "created_at": "2016-07-03T14:01:16Z",
    "labels": [
        "component: algebraic geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Generalize multiplicity() and intersection_multiplicity() for subschemes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20930",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```
Currently there is a `multiplicity()` function for algebraic curves which computes the multiplicity of a point on a curve as the multiplicity of the maximal ideal in the local ring of the curve corresponding to that point. This definition still works for arbitrary projective/affine subschemes and it would be good to implement it in the more general case.

Also, by using affine patches, it is possible to compute multiplicities and intersection multiplicities of points of subschemes of products of projective spaces, so it would be good to implement that here as well.

These implementations should be made available to both the subscheme classes and corresponding point classes.

CC:  @bhutz @miguelmarco

Keywords: gsoc2016

Branch/Commit: 7801dcc6598fae3ef8cbbf20f7d07b78430a108a

Reviewer: Ben Hutz

Author: Grayson Jorgenson

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20930





---

archive/issue_comments_382379.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gjorgenson/ticket/20930\"",
    "created_at": "2016-07-09T06:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382379",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing branch from "" to "u/gjorgenson/ticket/20930"



---

archive/issue_comments_382380.json:
```json
{
    "body": "Changing commit from \"\" to \"2ca3713691a83889f9ecbd23382cf2e89ffede24\"",
    "created_at": "2016-07-09T06:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382380",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "2ca3713691a83889f9ecbd23382cf2e89ffede24"



---

archive/issue_comments_382381.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-09T06:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382382.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-09T20:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382382",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382383.json:
```json
{
    "body": "Changing commit from \"2ca3713691a83889f9ecbd23382cf2e89ffede24\" to \"a655e09cec3ca127364d471d3c71ffab04122eea\"",
    "created_at": "2016-07-09T20:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2ca3713691a83889f9ecbd23382cf2e89ffede24" to "a655e09cec3ca127364d471d3c71ffab04122eea"



---

archive/issue_comments_382384.json:
```json
{
    "body": "<a id='comment:4'></a>I had forgotten that intersection_multiplicity functions were already implemented for points in #20811. I merged with 7.3 beta7 and added checks to give nicer errors if multiplicity or intersection_multiplicity are called for an ambient space point.",
    "created_at": "2016-07-09T20:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382384",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:4'></a>I had forgotten that intersection_multiplicity functions were already implemented for points in #20811. I merged with 7.3 beta7 and added checks to give nicer errors if multiplicity or intersection_multiplicity are called for an ambient space point.



---

archive/issue_comments_382385.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Currently there is a `multiplicity()` function for algebraic curves which computes the multiplicity of a point on a curve as the multiplicity of the maximal ideal in the local ring of the curve corresponding to that point. This definition still works for arbitrary projective/affine subschemes and it would be good to implement it in the more general case.\n \n-Also, by using affine patches, it is possible to compute intersection multiplicities for subschemes of products of projective spaces, so it would be good to implement that here as well.\n+Also, by using affine patches, it is possible to compute multiplicities and intersection multiplicities of points of subschemes of products of projective spaces, so it would be good to implement that here as well.\n \n These implementations should be made available to both the subscheme classes and corresponding point classes.\n \n``````\n",
    "created_at": "2016-07-09T20:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382385",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Currently there is a `multiplicity()` function for algebraic curves which computes the multiplicity of a point on a curve as the multiplicity of the maximal ideal in the local ring of the curve corresponding to that point. This definition still works for arbitrary projective/affine subschemes and it would be good to implement it in the more general case.
 
-Also, by using affine patches, it is possible to compute intersection multiplicities for subschemes of products of projective spaces, so it would be good to implement that here as well.
+Also, by using affine patches, it is possible to compute multiplicities and intersection multiplicities of points of subschemes of products of projective spaces, so it would be good to implement that here as well.
 
 These implementations should be made available to both the subscheme classes and corresponding point classes.
 
``````




---

archive/issue_comments_382386.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-09T20:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382386",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_382387.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-21T14:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382387",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_382388.json:
```json
{
    "body": "<a id='comment:5'></a>I see just a couple minor things here.\n\nIn the descriptions: It is the multiplicity of the point, not the subscheme. For example 'Return the multiplicity of the codomain of this point at this point.' would be better as 'Return the multiplicity of this point in its codomain.' This occurs in a number of places.\n\nAlso, the example I tried in 20811 which you used here was actually not quite what I had in mind. It is better with\n\n```\nG = PP.subscheme([(x^2 - 2*y^2)*v - y^2*u])\n```\nthen you can (and should) describe it as finding the fixed points of `z^2-2`.",
    "created_at": "2016-07-21T14:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382388",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:5'></a>I see just a couple minor things here.

In the descriptions: It is the multiplicity of the point, not the subscheme. For example 'Return the multiplicity of the codomain of this point at this point.' would be better as 'Return the multiplicity of this point in its codomain.' This occurs in a number of places.

Also, the example I tried in 20811 which you used here was actually not quite what I had in mind. It is better with

```
G = PP.subscheme([(x^2 - 2*y^2)*v - y^2*u])
```
then you can (and should) describe it as finding the fixed points of `z^2-2`.



---

archive/issue_comments_382389.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ben Hutz\"",
    "created_at": "2016-07-21T14:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382389",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "" to "Ben Hutz"



---

archive/issue_comments_382390.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-22T06:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382391.json:
```json
{
    "body": "Changing commit from \"a655e09cec3ca127364d471d3c71ffab04122eea\" to \"7801dcc6598fae3ef8cbbf20f7d07b78430a108a\"",
    "created_at": "2016-07-22T06:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a655e09cec3ca127364d471d3c71ffab04122eea" to "7801dcc6598fae3ef8cbbf20f7d07b78430a108a"



---

archive/issue_comments_382392.json:
```json
{
    "body": "<a id='comment:7'></a>Thanks, made the changes. I also modified the example slightly to use the map `z^2 + 1/4` to test what happens for a double fixed point.",
    "created_at": "2016-07-22T06:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382392",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:7'></a>Thanks, made the changes. I also modified the example slightly to use the map `z^2 + 1/4` to test what happens for a double fixed point.



---

archive/issue_comments_382393.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-22T06:49:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382393",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_382394.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-22T18:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382394",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_382395.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-23T18:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382395",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_382396.json:
```json
{
    "body": "Changing branch from \"u/gjorgenson/ticket/20930\" to \"7801dcc6598fae3ef8cbbf20f7d07b78430a108a\"",
    "created_at": "2016-07-23T18:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20930#issuecomment-382396",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gjorgenson/ticket/20930" to "7801dcc6598fae3ef8cbbf20f7d07b78430a108a"



---

archive/issue_events_056054.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-23T18:38:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20930",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20930#event-56054"
}
```
