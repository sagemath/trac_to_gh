# Issue 20414: Add copy/__copy__ methods to CVXOPT, PPL, InteractiveLP backends, and __deepcopy__ to MixedIntegerLinearProgram and backends

archive/issues_020177.json:
```json
{
    "body": "The COIN, CPLEX, GLPK, and Gurobi backends supply a `copy` method. \nBut it's not documented as a backend interface method in `GenericBackend`, and the CVXOPT, PPL, InteractiveLP backends do not implement it. \nIt is used by `MixedIntegerLinearProgram.__copy__`.\n\nThe backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html\n\nThe branch on the ticket does this.\n\nWe also add `__deepcopy__` methods to `MixedIntegerLinearProgram` and the backends. \nThis fixes #15159, though the semantics of `copy` and `deepcopy` of a `MixedIntegerLinearProgram` remains questionable due to its interaction with `MIPVariable`; see #15159 and #19523.\n\nSee also #20323 (in which copying a backend could be the basis for more diverse tests).\n\nCC:  @videlec @vbraun @dimpase\n\nKeywords: lp\n\nBranch/Commit: 3117b01e595febc8fc6de90eeb3cf19a7e97c7bd\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20414\n\n",
    "closed_at": "2016-04-20T22:26:38Z",
    "created_at": "2016-04-11T01:37:33Z",
    "labels": [
        "component: numerical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Add copy/__copy__ methods to CVXOPT, PPL, InteractiveLP backends, and __deepcopy__ to MixedIntegerLinearProgram and backends",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20414",
    "user": "https://github.com/mkoeppe"
}
```
The COIN, CPLEX, GLPK, and Gurobi backends supply a `copy` method. 
But it's not documented as a backend interface method in `GenericBackend`, and the CVXOPT, PPL, InteractiveLP backends do not implement it. 
It is used by `MixedIntegerLinearProgram.__copy__`.

The backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html

The branch on the ticket does this.

We also add `__deepcopy__` methods to `MixedIntegerLinearProgram` and the backends. 
This fixes #15159, though the semantics of `copy` and `deepcopy` of a `MixedIntegerLinearProgram` remains questionable due to its interaction with `MIPVariable`; see #15159 and #19523.

See also #20323 (in which copying a backend could be the basis for more diverse tests).

CC:  @videlec @vbraun @dimpase

Keywords: lp

Branch/Commit: 3117b01e595febc8fc6de90eeb3cf19a7e97c7bd

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20414





---

archive/issue_comments_370785.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/add_copy___copy___methods_to_cvxopt__ppl__interactivelp_backends\"",
    "created_at": "2016-04-14T06:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370785",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/add_copy___copy___methods_to_cvxopt__ppl__interactivelp_backends"



---

archive/issue_comments_370786.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-04-15T02:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370786",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_370787.json:
```json
{
    "body": "Changing commit from \"\" to \"cdd159d165c33eff92e006f435a3a0c7384a2487\"",
    "created_at": "2016-04-15T02:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370787",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "cdd159d165c33eff92e006f435a3a0c7384a2487"



---

archive/issue_comments_370788.json:
```json
{
    "body": "Changing commit from \"cdd159d165c33eff92e006f435a3a0c7384a2487\" to \"4b9fd051aa512b59351de115b21c744d9c312e8e\"",
    "created_at": "2016-04-15T02:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cdd159d165c33eff92e006f435a3a0c7384a2487" to "4b9fd051aa512b59351de115b21c744d9c312e8e"



---

archive/issue_comments_370789.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-15T02:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370789",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_370790.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-15T07:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370790",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_370791.json:
```json
{
    "body": "Changing commit from \"4b9fd051aa512b59351de115b21c744d9c312e8e\" to \"580e913062ab40b595fdb508d94b06c44a384f40\"",
    "created_at": "2016-04-15T07:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4b9fd051aa512b59351de115b21c744d9c312e8e" to "580e913062ab40b595fdb508d94b06c44a384f40"



---

archive/issue_comments_370792.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-15T07:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370792",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_370793.json:
```json
{
    "body": "<a id='comment:5'></a>The branch is on top of #20323 (Common `TestSuite` for MIP backends).\nThe `_test_copy_some_mips` method exposed a bug in `CoinBackend`, which I have fixed on the way.",
    "created_at": "2016-04-15T07:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370793",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>The branch is on top of #20323 (Common `TestSuite` for MIP backends).
The `_test_copy_some_mips` method exposed a bug in `CoinBackend`, which I have fixed on the way.



---

archive/issue_comments_370794.json:
```json
{
    "body": "Changing commit from \"580e913062ab40b595fdb508d94b06c44a384f40\" to \"38c6be9df03439d604f7b6c476cbebd6e606e7fd\"",
    "created_at": "2016-04-17T00:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "580e913062ab40b595fdb508d94b06c44a384f40" to "38c6be9df03439d604f7b6c476cbebd6e606e7fd"



---

archive/issue_comments_370795.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-17T00:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_370796.json:
```json
{
    "body": "<a id='comment:7'></a>Now also contains a fix for #15159 (see description). \nNeeds review.",
    "created_at": "2016-04-17T00:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370796",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Now also contains a fix for #15159 (see description). 
Needs review.



---

archive/issue_comments_370797.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,12 @@\n \n The backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html\n \n-See also #15159 (which may indicate that we may need a `__deepcopy__` method as well) and #20323 (in which copying a backend could be the basis for more diverse tests)\n+The branch on the ticket does this.\n+\n+We also add `__deepcopy__` methods to `MixedIntegerLinearProgram` and the backends. \n+This fixes #15159, though the semantics of `copy` and `deepcopy` of a `MixedIntegerLinearProgram` remains questionable due to its interaction with `MIPVariable`; see #15159 and #19523.\n+\n+See also #20323 (in which copying a backend could be the basis for more diverse tests).\n \n Comment: 1\n \n``````\n",
    "created_at": "2016-04-17T00:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370797",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,12 @@
 
 The backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html
 
-See also #15159 (which may indicate that we may need a `__deepcopy__` method as well) and #20323 (in which copying a backend could be the basis for more diverse tests)
+The branch on the ticket does this.
+
+We also add `__deepcopy__` methods to `MixedIntegerLinearProgram` and the backends. 
+This fixes #15159, though the semantics of `copy` and `deepcopy` of a `MixedIntegerLinearProgram` remains questionable due to its interaction with `MIPVariable`; see #15159 and #19523.
+
+See also #20323 (in which copying a backend could be the basis for more diverse tests).
 
 Comment: 1
 
``````




---

archive/issue_comments_370798.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2016-04-17T00:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370798",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_370799.json:
```json
{
    "body": "<a id='comment:10'></a>How reliable is `__deepcopy__` here? Is it just working now?",
    "created_at": "2016-04-18T11:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370799",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>How reliable is `__deepcopy__` here? Is it just working now?



---

archive/issue_comments_370800.json:
```json
{
    "body": "Changing commit from \"38c6be9df03439d604f7b6c476cbebd6e606e7fd\" to \"3117b01e595febc8fc6de90eeb3cf19a7e97c7bd\"",
    "created_at": "2016-04-18T18:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "38c6be9df03439d604f7b6c476cbebd6e606e7fd" to "3117b01e595febc8fc6de90eeb3cf19a7e97c7bd"



---

archive/issue_comments_370801.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-18T18:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370801",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_370802.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 dimpase]:\n> How reliable is `__deepcopy__` here? Is it just working now?\n\n\nIt's working. I've added another test to illustrate deepcopy semantics.",
    "created_at": "2016-04-18T18:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370802",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Replying to [comment:10 dimpase]:
> How reliable is `__deepcopy__` here? Is it just working now?


It's working. I've added another test to illustrate deepcopy semantics.



---

archive/issue_comments_370803.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 mkoeppe]:\n> Replying to [comment:10 dimpase]:\n> > How reliable is `__deepcopy__` here? Is it just working now?\n\n> \n> It's working. I've added another test to illustrate deepcopy semantics.\n\n\nwas there something about variables that are (not) copied?",
    "created_at": "2016-04-18T19:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370803",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 dimpase]:
> > How reliable is `__deepcopy__` here? Is it just working now?

> 
> It's working. I've added another test to illustrate deepcopy semantics.


was there something about variables that are (not) copied?



---

archive/issue_comments_370804.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 dimpase]:\n> was there something about variables that are (not) copied?\n\n\nBefore this patch, deepcopy didn't even copy the backend of a MIP. \nNow it does, simply by doing the same as copy.\n\nBoth copy and deepcopy have weird semantics in relation to the MIPVariables in a problems -- because a MIP does not have an API to gain access to its variables; and trying to use the old MIPVariables with the copy is questionable and definitely broken if one creates new components of this variable, see #15159, #19523. Fixing this would require a redesign; a possible stopgap would be to stop all MIPVariables from creating new components when they have been subjected to copy().",
    "created_at": "2016-04-18T19:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370804",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [comment:13 dimpase]:
> was there something about variables that are (not) copied?


Before this patch, deepcopy didn't even copy the backend of a MIP. 
Now it does, simply by doing the same as copy.

Both copy and deepcopy have weird semantics in relation to the MIPVariables in a problems -- because a MIP does not have an API to gain access to its variables; and trying to use the old MIPVariables with the copy is questionable and definitely broken if one creates new components of this variable, see #15159, #19523. Fixing this would require a redesign; a possible stopgap would be to stop all MIPVariables from creating new components when they have been subjected to copy().



---

archive/issue_comments_370805.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-18T21:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370805",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_370806.json:
```json
{
    "body": "<a id='comment:15'></a>ok, fine.",
    "created_at": "2016-04-18T21:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370806",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>ok, fine.



---

archive/issue_comments_370807.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2016-04-18T21:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370807",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_370808.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 dimpase]:\n> ok, fine.\n\n\nThanks for reviewing.\n\nI've created a new ticket, #20461, for solving the issue with the variables of a copied MIP. Please take a look when you have a chance.",
    "created_at": "2016-04-19T04:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370808",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [comment:15 dimpase]:
> ok, fine.


Thanks for reviewing.

I've created a new ticket, #20461, for solving the issue with the variables of a copied MIP. Please take a look when you have a chance.



---

archive/issue_comments_370809.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-20T22:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370809",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_055264.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-20T22:26:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20414#event-55264"
}
```



---

archive/issue_comments_370810.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/add_copy___copy___methods_to_cvxopt__ppl__interactivelp_backends\" to \"3117b01e595febc8fc6de90eeb3cf19a7e97c7bd\"",
    "created_at": "2016-04-20T22:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20414#issuecomment-370810",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/add_copy___copy___methods_to_cvxopt__ppl__interactivelp_backends" to "3117b01e595febc8fc6de90eeb3cf19a7e97c7bd"
