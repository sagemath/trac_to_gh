# Issue 20285: make OSX binary distros useful for development

archive/issues_020048.json:
```json
{
    "body": "see the discussion here:\nhttps://groups.google.com/d/msg/sage-devel/Q76TxYT7vaU/N2Yp7JELDgAJ\n\nOSX binary installs do not allow installing extra packages (breaking after make is run).\n\nTo reproduce (as described in the posts linked):\n\ndownload binary distro (to an OSX machine with Sage dev environment ready), install it by untarring and running ./sage once.\n\nThen do \n   ./sage -i gap_packages \n   make\n\nget an error and ./sage that crashes\n\n**CC:**  @JohnCremona\n\n**Author:** Volker Braun\n\nIssue created by migration from https://trac.sagemath.org/ticket/20285\n\n",
    "closed_at": "2016-06-12T12:02:30Z",
    "created_at": "2016-03-25T10:25:27Z",
    "labels": [
        "component: distribution",
        "bug",
        "invalid"
    ],
    "title": "make OSX binary distros useful for development",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20285",
    "user": "https://github.com/dimpase"
}
```
see the discussion here:
https://groups.google.com/d/msg/sage-devel/Q76TxYT7vaU/N2Yp7JELDgAJ

OSX binary installs do not allow installing extra packages (breaking after make is run).

To reproduce (as described in the posts linked):

download binary distro (to an OSX machine with Sage dev environment ready), install it by untarring and running ./sage once.

Then do 
   ./sage -i gap_packages 
   make

get an error and ./sage that crashes

**CC:**  @JohnCremona

**Author:** Volker Braun

Issue created by migration from https://trac.sagemath.org/ticket/20285





---

archive/issue_comments_296279.json:
```json
{
    "body": "<a id='comment:1'></a>\nSteps to reproduce?",
    "created_at": "2016-03-25T11:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296279",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:1'></a>
Steps to reproduce?



---

archive/issue_events_185611.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-25T11:25:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185611"
}
```



---

archive/issue_comments_296280.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,3 +2,13 @@\n https://groups.google.com/d/msg/sage-devel/Q76TxYT7vaU/N2Yp7JELDgAJ\n \n OSX binary installs do not allow installing extra packages (breaking after make is run).\n+\n+To reproduce (as described in the posts linked):\n+\n+download binary distro (to an OSX machine with Sage dev environment ready), install it by untarring and running ./sage once.\n+\n+Then do \n+   ./sage -i gap_packages \n+   make\n+\n+get an error and ./sage that crashes\n``````\n",
    "created_at": "2016-03-25T11:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296280",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,3 +2,13 @@
 https://groups.google.com/d/msg/sage-devel/Q76TxYT7vaU/N2Yp7JELDgAJ
 
 OSX binary installs do not allow installing extra packages (breaking after make is run).
+
+To reproduce (as described in the posts linked):
+
+download binary distro (to an OSX machine with Sage dev environment ready), install it by untarring and running ./sage once.
+
+Then do 
+   ./sage -i gap_packages 
+   make
+
+get an error and ./sage that crashes
``````




---

archive/issue_events_185612.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-03-25T11:37:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185612"
}
```



---

archive/issue_events_185613.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-03-25T11:37:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185613"
}
```



---

archive/issue_comments_296281.json:
```json
{
    "body": "<a id='comment:4'></a>\n\n```\n$ pkg-config --libs gsl\n/Users/vbraun/Desktop/SageMath/local/bin/pkg-config: line 16: /Users/buildslave-sage/slave/binary_pkg/build/tools/binary-pkg/bin/pkg-config: No such file or directory\n/Users/vbraun/Desktop/SageMath/local/bin/pkg-config: line 16: exec: /Users/buildslave-sage/slave/binary_pkg/build/tools/binary-pkg/bin/pkg-config: cannot execute: No such file or directory\n```\nThe compile step picks up the binary builder's tools. We should scrub the path before executing the compile script.",
    "created_at": "2016-03-25T16:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296281",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>

```
$ pkg-config --libs gsl
/Users/vbraun/Desktop/SageMath/local/bin/pkg-config: line 16: /Users/buildslave-sage/slave/binary_pkg/build/tools/binary-pkg/bin/pkg-config: No such file or directory
/Users/vbraun/Desktop/SageMath/local/bin/pkg-config: line 16: exec: /Users/buildslave-sage/slave/binary_pkg/build/tools/binary-pkg/bin/pkg-config: cannot execute: No such file or directory
```
The compile step picks up the binary builder's tools. We should scrub the path before executing the compile script.



---

archive/issue_comments_296282.json:
```json
{
    "body": "<a id='comment:5'></a>\nwell, I need to read on pkg-config, and understand its role in Sage, before I can make full sense of this comment.",
    "created_at": "2016-03-25T17:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296282",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
well, I need to read on pkg-config, and understand its role in Sage, before I can make full sense of this comment.



---

archive/issue_comments_296283.json:
```json
{
    "body": "<a id='comment:6'></a>\nI'll take care of it",
    "created_at": "2016-03-25T18:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296283",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'></a>
I'll take care of it



---

archive/issue_events_185614.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-25T23:38:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185614"
}
```



---

archive/issue_events_185615.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-25T23:38:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185615"
}
```



---

archive/issue_events_185616.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-25T23:38:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185616"
}
```



---

archive/issue_events_185617.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-25T23:38:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185617"
}
```



---

archive/issue_comments_296284.json:
```json
{
    "body": "**Author:** Volker Braun",
    "created_at": "2016-03-25T23:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296284",
    "user": "https://github.com/vbraun"
}
```

**Author:** Volker Braun



---

archive/issue_comments_296285.json:
```json
{
    "body": "<a id='comment:7'></a>\nFixed in https://github.com/sagemath/binary-pkg/commit/8f412120497816727429fd1905ced094f660ffcb\n\nPS: the patching step is much faster now if you haven't noticed yet...",
    "created_at": "2016-03-25T23:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296285",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
Fixed in https://github.com/sagemath/binary-pkg/commit/8f412120497816727429fd1905ced094f660ffcb

PS: the patching step is much faster now if you haven't noticed yet...



---

archive/issue_comments_296286.json:
```json
{
    "body": "<a id='comment:8'></a>\nYes, I noticed that patching is faster. How do you want this to be reviewed? I can test some tarballs on OSX.\n\nSomething else - IMHO a tighter integration of binary-pkg with Sage would be great.\nPerhaps via a git submodule?",
    "created_at": "2016-03-25T23:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296286",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
Yes, I noticed that patching is faster. How do you want this to be reviewed? I can test some tarballs on OSX.

Something else - IMHO a tighter integration of binary-pkg with Sage would be great.
Perhaps via a git submodule?



---

archive/issue_comments_296287.json:
```json
{
    "body": "<a id='comment:9'></a>\nI uploaded updated OSX tarballs (for beta0)\n\nIMHO tooling should not be integrated, it sounds good but really you are going to bite your own tail all the time. For starters, its written in Python 3 and uses some python packages that are not part of Sage (and don't make any sense in Sage). Of course you are welcome to review the code on github...\n\nThere is nothing to be done here, just close as \"fixed\".",
    "created_at": "2016-03-26T09:15:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296287",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>
I uploaded updated OSX tarballs (for beta0)

IMHO tooling should not be integrated, it sounds good but really you are going to bite your own tail all the time. For starters, its written in Python 3 and uses some python packages that are not part of Sage (and don't make any sense in Sage). Of course you are welcome to review the code on github...

There is nothing to be done here, just close as "fixed".



---

archive/issue_comments_296288.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [vbraun](#comment%3A9):\n> I uploaded updated OSX tarballs (for beta0)\n> \n> IMHO tooling should not be integrated, it sounds good but really you are going to bite your own tail all the time. \n\n\nI did not say \"integrating into Sage\". I meant \"make it less weird to use, and easier to install properly\". (Same applies to git trac, by the way).\nThey are parts of a wider \"Sage dev/release tools\" project, and I only have arguments for it to be less loose than it is now, so that just one or two git commands in the Sage repo is all you need to get them installed/updated; less strictly necessary reading to do to configure them properly\n(e.g. currently we have an unwritten requirement that binary-pkg must not be installed via git to be useful, cf https://github.com/sagemath/binary-pkg/issues/6)\n\nThey would remain quite independent from Sage, with their own requirements etc.",
    "created_at": "2016-03-26T11:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296288",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
Replying to [vbraun](#comment%3A9):
> I uploaded updated OSX tarballs (for beta0)
> 
> IMHO tooling should not be integrated, it sounds good but really you are going to bite your own tail all the time. 


I did not say "integrating into Sage". I meant "make it less weird to use, and easier to install properly". (Same applies to git trac, by the way).
They are parts of a wider "Sage dev/release tools" project, and I only have arguments for it to be less loose than it is now, so that just one or two git commands in the Sage repo is all you need to get them installed/updated; less strictly necessary reading to do to configure them properly
(e.g. currently we have an unwritten requirement that binary-pkg must not be installed via git to be useful, cf https://github.com/sagemath/binary-pkg/issues/6)

They would remain quite independent from Sage, with their own requirements etc.



---

archive/issue_events_185618.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-03-26T11:03:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185618"
}
```



---

archive/issue_events_185619.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-03-26T11:03:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185619"
}
```



---

archive/issue_comments_296289.json:
```json
{
    "body": "<a id='comment:12'></a>\ngit-trac can be installed as a Sage optional package, what else do you want?\n\nHaving binary-pkg in Sage would mean that its dependencies would also become packaged in binary tarballs.",
    "created_at": "2016-03-26T11:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296289",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
git-trac can be installed as a Sage optional package, what else do you want?

Having binary-pkg in Sage would mean that its dependencies would also become packaged in binary tarballs.



---

archive/issue_comments_296290.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [vbraun](#comment%3A12):\n> git-trac can be installed as a Sage optional package, what else do you want?\n\nah, I didn't even know that, or forgot. I assumed it is in the same status as binary-pkg.\n(I'd say it's a bit of a bloat...)\n> \n> Having binary-pkg in Sage would mean that its dependencies would also become packaged in binary tarballs.\n\n\nAgain, I do not say \"make it a Sage package\".",
    "created_at": "2016-03-26T12:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20285#issuecomment-296290",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>
Replying to [vbraun](#comment%3A12):
> git-trac can be installed as a Sage optional package, what else do you want?

ah, I didn't even know that, or forgot. I assumed it is in the same status as binary-pkg.
(I'd say it's a bit of a bloat...)
> 
> Having binary-pkg in Sage would mean that its dependencies would also become packaged in binary tarballs.


Again, I do not say "make it a Sage package".



---

archive/issue_events_185620.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-12T12:02:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185620"
}
```



---

archive/issue_events_185621.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-12T12:02:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20285",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20285#event-185621"
}
```
