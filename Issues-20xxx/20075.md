# Issue 20075: rising_factorial and falling_factorial should accept Python integers

archive/issues_019838.json:
```json
{
    "body": "See the bug reported at\nhttp://ask.sagemath.org/question/32565/error-in-rising_factorial/\n\n```\nsage: [rising_factorial(n,n) for n in range(6)]\nAttributeError: 'int' object has no attribute 'parent'\n```\n\nKeywords: factorial\n\nBranch/Commit: e77247ce49586565c975e1a5181b2954afab0532\n\nReviewer: Vincent Delecroix\n\nAuthor: Eric Gourgoulhon\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20075\n\n",
    "closed_at": "2016-03-10T13:40:12Z",
    "created_at": "2016-02-17T09:48:58Z",
    "labels": [
        "component: basic arithmetic",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "rising_factorial and falling_factorial should accept Python integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20075",
    "user": "https://github.com/egourgoulhon"
}
```
See the bug reported at
http://ask.sagemath.org/question/32565/error-in-rising_factorial/

```
sage: [rising_factorial(n,n) for n in range(6)]
AttributeError: 'int' object has no attribute 'parent'
```

Keywords: factorial

Branch/Commit: e77247ce49586565c975e1a5181b2954afab0532

Reviewer: Vincent Delecroix

Author: Eric Gourgoulhon

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20075





---

archive/issue_comments_357396.json:
```json
{
    "body": "Changing keywords from \"\" to \"factorial\".",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357396",
    "user": "https://github.com/egourgoulhon"
}
```

Changing keywords from "" to "factorial".



---

archive/issue_comments_357397.json:
```json
{
    "body": "Changing commit from \"\" to \"11fd5e6099e732148bf385adbbeb99c04cd8a335\"",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357397",
    "user": "https://github.com/egourgoulhon"
}
```

Changing commit from "" to "11fd5e6099e732148bf385adbbeb99c04cd8a335"



---

archive/issue_comments_357398.json:
```json
{
    "body": "Changing branch from \"\" to \"public/20075\"",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357398",
    "user": "https://github.com/egourgoulhon"
}
```

Changing branch from "" to "public/20075"



---

archive/issue_comments_357399.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357399",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_357400.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[11fd5e6](https://github.com/sagemath/sagetrac-mirror/commit/11fd5e6099e732148bf385adbbeb99c04cd8a335)|`rising_factorial accepts Python integers`|",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357400",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[11fd5e6](https://github.com/sagemath/sagetrac-mirror/commit/11fd5e6099e732148bf385adbbeb99c04cd8a335)|`rising_factorial accepts Python integers`|



---

archive/issue_comments_357401.json:
```json
{
    "body": "<a id='comment:2'></a>\nSince there is a belief that the input could be a `long`, I think you should also check against that as well.",
    "created_at": "2016-02-17T14:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357401",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
Since there is a belief that the input could be a `long`, I think you should also check against that as well.



---

archive/issue_comments_357402.json:
```json
{
    "body": "Changing commit from \"11fd5e6099e732148bf385adbbeb99c04cd8a335\" to \"23fb2b1857cdba07e431c0e7521490c12e857ff5\"",
    "created_at": "2016-02-17T15:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357402",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "11fd5e6099e732148bf385adbbeb99c04cd8a335" to "23fb2b1857cdba07e431c0e7521490c12e857ff5"



---

archive/issue_comments_357403.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[23fb2b1](https://github.com/sagemath/sagetrac-mirror/commit/23fb2b1857cdba07e431c0e7521490c12e857ff5)|`rising_factorial and falling_factorial accept Python integers (int, long)`|",
    "created_at": "2016-02-17T15:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357403",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[23fb2b1](https://github.com/sagemath/sagetrac-mirror/commit/23fb2b1857cdba07e431c0e7521490c12e857ff5)|`rising_factorial and falling_factorial accept Python integers (int, long)`|



---

archive/issue_comments_357404.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [tscrim](#comment%3A2):\n> Since there is a belief that the input could be a `long`, I think you should also check against that as well.\n\nDone in the above commit. Btw, I've also modified `falling_factorial` for consistency.",
    "created_at": "2016-02-17T15:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357404",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:4'></a>
Replying to [tscrim](#comment%3A2):
> Since there is a belief that the input could be a `long`, I think you should also check against that as well.

Done in the above commit. Btw, I've also modified `falling_factorial` for consistency.



---

archive/issue_events_069954.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "rename": {
        "from": "rising_factorial should accept Python integers",
        "to": "rising_factorial and falling_factorial should accept Python integers"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20075#event-69954"
}
```



---

archive/issue_comments_357405.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-02-17T15:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357405",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_357406.json:
```json
{
    "body": "<a id='comment:5'></a>\nYou would better use `sage.structure.coerce.py_scalar_to_element`. For example you forgot about numpy integers. You can simply add the line `x = py_scalar_to_element(x)` at the begining.",
    "created_at": "2016-02-17T15:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357406",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
You would better use `sage.structure.coerce.py_scalar_to_element`. For example you forgot about numpy integers. You can simply add the line `x = py_scalar_to_element(x)` at the begining.



---

archive/issue_comments_357407.json:
```json
{
    "body": "<a id='comment:6'></a>\nAnd since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.",
    "created_at": "2016-02-17T15:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357407",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.



---

archive/issue_comments_357408.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [vdelecroix](#comment%3A6):\n> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.\n\n\nThe first check is `x` and the second is `a`.",
    "created_at": "2016-02-17T16:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357408",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
Replying to [vdelecroix](#comment%3A6):
> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.


The first check is `x` and the second is `a`.



---

archive/issue_comments_357409.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [vdelecroix](#comment%3A6):\n> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.\n\nWhat do you mean? In the code of these functions, there is no second pass for `x` (the other checks regard `a`, not `x`).",
    "created_at": "2016-02-17T16:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357409",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:8'></a>
Replying to [vdelecroix](#comment%3A6):
> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.

What do you mean? In the code of these functions, there is no second pass for `x` (the other checks regard `a`, not `x`).



---

archive/issue_comments_357410.json:
```json
{
    "body": "<a id='comment:9'></a>\nyep. I read too fast. Sorry for that.\n\nBut [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).",
    "created_at": "2016-02-17T16:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357410",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
yep. I read too fast. Sorry for that.

But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).



---

archive/issue_comments_357411.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [vdelecroix](#comment%3A9):\n> yep. I read too fast. Sorry for that.\n> \n> But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).\n\nIn the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?",
    "created_at": "2016-02-17T16:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357411",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:10'></a>
Replying to [vdelecroix](#comment%3A9):
> yep. I read too fast. Sorry for that.
> 
> But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).

In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?



---

archive/issue_comments_357412.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [egourgoulhon](#comment%3A10):\n> In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?\n\n\nPS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).",
    "created_at": "2016-02-17T16:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357412",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:11'></a>
Replying to [egourgoulhon](#comment%3A10):
> In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?


PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).



---

archive/issue_comments_357413.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [egourgoulhon](#comment%3A11):\n> Replying to [egourgoulhon](#comment%3A10):\n> > In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?\n\n> \n> PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).  \n\n\nAre you sure? What kind of numpy integers did you try?\n\n```\nsage: import numpy\nsage: a = numpy.int8(10)\nsage: b = numpy.int(5)\nsage: isinstance(a, int)\nFalse\nsage: isinstance(b, int)\nTrue\n```",
    "created_at": "2016-02-17T17:12:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357413",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>
Replying to [egourgoulhon](#comment%3A11):
> Replying to [egourgoulhon](#comment%3A10):
> > In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?

> 
> PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).  


Are you sure? What kind of numpy integers did you try?

```
sage: import numpy
sage: a = numpy.int8(10)
sage: b = numpy.int(5)
sage: isinstance(a, int)
False
sage: isinstance(b, int)
True
```



---

archive/issue_comments_357414.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [vdelecroix](#comment%3A12):\n> Are you sure? What kind of numpy integers did you try?\n> \n> ```\n> sage: import numpy\n> sage: a = numpy.int8(10)\n> sage: b = numpy.int(5)\n> sage: isinstance(a, int)\n> False\n> sage: isinstance(b, int)\n> True\n> ```\n\n\nBoth work:\n\n```\nsage: import numpy\nsage: a = numpy.int8(4)\nsage: rising_factorial(3, a)\n360\nsage: a = numpy.int(4)\nsage: rising_factorial(3, a)\n360\n```",
    "created_at": "2016-02-17T17:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357414",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:13'></a>
Replying to [vdelecroix](#comment%3A12):
> Are you sure? What kind of numpy integers did you try?
> 
> ```
> sage: import numpy
> sage: a = numpy.int8(10)
> sage: b = numpy.int(5)
> sage: isinstance(a, int)
> False
> sage: isinstance(b, int)
> True
> ```


Both work:

```
sage: import numpy
sage: a = numpy.int8(4)
sage: rising_factorial(3, a)
360
sage: a = numpy.int(4)
sage: rising_factorial(3, a)
360
```



---

archive/issue_comments_357415.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|\n|[e77247c](https://github.com/sagemath/sagetrac-mirror/commit/e77247ce49586565c975e1a5181b2954afab0532)|`Use py_scalar_to_element in rising_factorial and falling_factorial`|",
    "created_at": "2016-02-17T17:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357415",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
|[e77247c](https://github.com/sagemath/sagetrac-mirror/commit/e77247ce49586565c975e1a5181b2954afab0532)|`Use py_scalar_to_element in rising_factorial and falling_factorial`|



---

archive/issue_comments_357416.json:
```json
{
    "body": "Changing commit from \"23fb2b1857cdba07e431c0e7521490c12e857ff5\" to \"e77247ce49586565c975e1a5181b2954afab0532\"",
    "created_at": "2016-02-17T17:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357416",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "23fb2b1857cdba07e431c0e7521490c12e857ff5" to "e77247ce49586565c975e1a5181b2954afab0532"



---

archive/issue_comments_357417.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-02-17T17:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357417",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_357418.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-09T18:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357418",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_357419.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2016-03-09T18:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357419",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_comments_357420.json:
```json
{
    "body": "<a id='comment:16'></a>\nSorry for the long delay...",
    "created_at": "2016-03-09T18:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357420",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>
Sorry for the long delay...



---

archive/issue_comments_357421.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [vdelecroix](#comment%3A16):\n> Sorry for the long delay...\n\nNo problem. Thank you Vincent !",
    "created_at": "2016-03-09T20:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357421",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:17'></a>
Replying to [vdelecroix](#comment%3A16):
> Sorry for the long delay...

No problem. Thank you Vincent !



---

archive/issue_events_069955.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-10T13:40:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20075#event-69955"
}
```



---

archive/issue_comments_357422.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-10T13:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357422",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_357423.json:
```json
{
    "body": "Changing branch from \"public/20075\" to \"e77247ce49586565c975e1a5181b2954afab0532\"",
    "created_at": "2016-03-10T13:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20075#issuecomment-357423",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/20075" to "e77247ce49586565c975e1a5181b2954afab0532"
