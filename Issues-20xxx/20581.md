# Issue 20581: Upgrade PARI to latest master

archive/issues_020344.json:
```json
{
    "body": "Some recent fixes needed to correctly count points on hyperelliptic curves.\n\n**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2771-gb70b447.tar.gz\n\nCC:  @jdemeyer @kedlaya @kiwifb\n\nKeywords: days74\n\nBranch/Commit: bedff7be09d52fc7eba721074eaab6ad5607876b\n\nReviewer: Jean-Pierre Flori, Peter Bruin\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20581\n\n",
    "closed_at": "2016-06-23T17:14:00Z",
    "created_at": "2016-05-09T22:45:28Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Upgrade PARI to latest master",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20581",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```
Some recent fixes needed to correctly count points on hyperelliptic curves.

**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2771-gb70b447.tar.gz

CC:  @jdemeyer @kedlaya @kiwifb

Keywords: days74

Branch/Commit: bedff7be09d52fc7eba721074eaab6ad5607876b

Reviewer: Jean-Pierre Flori, Peter Bruin

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20581





---

archive/issue_comments_374186.json:
```json
{
    "body": "<a id='comment:1'></a>\n`@`Jeroen: you already did the upgrade a bunch of time IIRC.\nI could try to review the ticket (which should be trivial) while I have some time this week.\n(Later than that I can not promise anything.)",
    "created_at": "2016-05-09T22:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374186",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:1'></a>
`@`Jeroen: you already did the upgrade a bunch of time IIRC.
I could try to review the ticket (which should be trivial) while I have some time this week.
(Later than that I can not promise anything.)



---

archive/issue_comments_374187.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2016-05-10T07:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374187",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_374188.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Some recent fixes needed to correctly count points on hyperelliptic curves.\n+\n+**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2670-g9b4a64c.tar.gz\n``````\n",
    "created_at": "2016-05-10T08:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374188",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Some recent fixes needed to correctly count points on hyperelliptic curves.
+
+**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2670-g9b4a64c.tar.gz
``````




---

archive/issue_comments_374189.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/upgrade_pari_to_latest_master\"",
    "created_at": "2016-05-10T16:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374189",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/upgrade_pari_to_latest_master"



---

archive/issue_comments_374190.json:
```json
{
    "body": "<a id='comment:6'></a>\nNew commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[1f90f95](http://git.sagemath.org/sage.git/commit/?id=1f90f95e7c12901dba8078c84a588d9b3cd231a7)|`Upgrade PARI to latest master`|",
    "created_at": "2016-05-10T16:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374190",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[1f90f95](http://git.sagemath.org/sage.git/commit/?id=1f90f95e7c12901dba8078c84a588d9b3cd231a7)|`Upgrade PARI to latest master`|



---

archive/issue_comments_374191.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-10T16:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374191",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_374192.json:
```json
{
    "body": "Changing commit from \"\" to \"1f90f95e7c12901dba8078c84a588d9b3cd231a7\"",
    "created_at": "2016-05-10T16:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374192",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "1f90f95e7c12901dba8078c84a588d9b3cd231a7"



---

archive/issue_comments_374193.json:
```json
{
    "body": "<a id='comment:7'></a>\nI see a lot of functions' signatures changed because of the addition of the const modifier.\nWas it on purpose? (IIRC Cython does not care about constness anyway.)",
    "created_at": "2016-05-11T15:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374193",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:7'></a>
I see a lot of functions' signatures changed because of the addition of the const modifier.
Was it on purpose? (IIRC Cython does not care about constness anyway.)



---

archive/issue_comments_374194.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jpflori](#comment%3A7):\n> Was it on purpose? (IIRC Cython does not care about constness anyway.)\n\n\nWell, I just took the declarations from PARI and they have `const` in them. And it's true that it probably does not matter for Cython anyway.",
    "created_at": "2016-05-11T15:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374194",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [jpflori](#comment%3A7):
> Was it on purpose? (IIRC Cython does not care about constness anyway.)


Well, I just took the declarations from PARI and they have `const` in them. And it's true that it probably does not matter for Cython anyway.



---

archive/issue_comments_374195.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-11T22:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374195",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_374196.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jean-Pierre Flori\"",
    "created_at": "2016-05-11T22:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374196",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing reviewer from "" to "Jean-Pierre Flori"



---

archive/issue_comments_374197.json:
```json
{
    "body": "<a id='comment:10'></a>\nI'm getting failures on OSX\n\n```\nIn file included from /Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/libs/pari/handle_error.c:324:0:\n/Users/buildslave-sage/slave/sage_git/build/local/include/pari/paripriv.h:16:48: error: unknown type name 'ulong'\n hashtable *hashstr_import_static(hashentry *e, ulong size);\n                                                ^\nIn file included from /Users/buildslave-sage/slave/sage_git/build/local/include/pari/pari.h:39:0,\n                 from /Users/buildslave-sage/slave/sage_git/build/src/sage/libs/pari/parisage.h:3,\n                 from /Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/libs/pari/handle_error.c:320:\n/Users/buildslave-sage/slave/sage_git/build/local/include/pari/paripriv.h: In function 'clone_lock':\n/Users/buildslave-sage/slave/sage_git/build/local/include/pari/paripriv.h:36:25: error: 'ulong' undeclared (first use in this function)\n clone_lock(GEN C) { if (isclone(C)) ++bl_refc(C); }\n\n```",
    "created_at": "2016-05-19T17:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374197",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>
I'm getting failures on OSX

```
In file included from /Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/libs/pari/handle_error.c:324:0:
/Users/buildslave-sage/slave/sage_git/build/local/include/pari/paripriv.h:16:48: error: unknown type name 'ulong'
 hashtable *hashstr_import_static(hashentry *e, ulong size);
                                                ^
In file included from /Users/buildslave-sage/slave/sage_git/build/local/include/pari/pari.h:39:0,
                 from /Users/buildslave-sage/slave/sage_git/build/src/sage/libs/pari/parisage.h:3,
                 from /Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/libs/pari/handle_error.c:320:
/Users/buildslave-sage/slave/sage_git/build/local/include/pari/paripriv.h: In function 'clone_lock':
/Users/buildslave-sage/slave/sage_git/build/local/include/pari/paripriv.h:36:25: error: 'ulong' undeclared (first use in this function)
 clone_lock(GEN C) { if (isclone(C)) ++bl_refc(C); }

```



---

archive/issue_comments_374198.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-05-19T17:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374198",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_374199.json:
```json
{
    "body": "<a id='comment:11'></a>\nFLINT and PARI `ulong` mess...\nI guess that `handle_error.pxd` pulls the PARI headers and `parisage.h` which undefs `ulong` and when `handle_error.pyx` is treated and pulls in `paripriv.h` which wants `ulong` we lose...\nNot sure what the cleanest solution would be.\nMaybe `#define pari_ulong` in `parisage.h` and define/undefine `ulong` in a custom `pariprivsage.h` which pulls `paripriv.h` in (just as `parisage.h` does for `pari.h`).",
    "created_at": "2016-05-23T08:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374199",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:11'></a>
FLINT and PARI `ulong` mess...
I guess that `handle_error.pxd` pulls the PARI headers and `parisage.h` which undefs `ulong` and when `handle_error.pyx` is treated and pulls in `paripriv.h` which wants `ulong` we lose...
Not sure what the cleanest solution would be.
Maybe `#define pari_ulong` in `parisage.h` and define/undefine `ulong` in a custom `pariprivsage.h` which pulls `paripriv.h` in (just as `parisage.h` does for `pari.h`).



---

archive/issue_comments_374200.json:
```json
{
    "body": "<a id='comment:12'></a>\nI don't understand why anything would change on OS X...\n\nI do plan to investigate this, but maybe not this week.",
    "created_at": "2016-05-23T08:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374200",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
I don't understand why anything would change on OS X...

I do plan to investigate this, but maybe not this week.



---

archive/issue_comments_374201.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jdemeyer](#comment%3A12):\n> I don't understand why anything would change on OS X...\n\nYes that's a mystery as well.",
    "created_at": "2016-05-23T08:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374201",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:13'></a>
Replying to [jdemeyer](#comment%3A12):
> I don't understand why anything would change on OS X...

Yes that's a mystery as well.



---

archive/issue_comments_374202.json:
```json
{
    "body": "<a id='comment:14'></a>\n`@`Volker: can you post the generated C file (`handle_error.c`)?",
    "created_at": "2016-05-23T08:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374202",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:14'></a>
`@`Volker: can you post the generated C file (`handle_error.c`)?



---

archive/issue_comments_374203.json:
```json
{
    "body": "<a id='comment:15'></a>\nYou have an account on the OSX buildbot, right?",
    "created_at": "2016-05-23T09:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374203",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
You have an account on the OSX buildbot, right?



---

archive/issue_comments_374204.json:
```json
{
    "body": "<a id='comment:16'></a>\nCannot remember if I have one, nor it's name...",
    "created_at": "2016-05-23T09:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374204",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:16'></a>
Cannot remember if I have one, nor it's name...



---

archive/issue_comments_374205.json:
```json
{
    "body": "<a id='comment:17'></a>\nOk apparently not... if you send me privately your desired account name and Apple ID (for login) then I can make one.",
    "created_at": "2016-05-23T11:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374205",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>
Ok apparently not... if you send me privately your desired account name and Apple ID (for login) then I can make one.



---

archive/issue_comments_374206.json:
```json
{
    "body": "<a id='comment:18'></a>\nThis works by accident on Linux due to this bit in `/usr/include/sys/types.h`:\n\n```\n#ifdef __USE_MISC\n/* Old compatibility names for C types.  */\ntypedef unsigned long int ulong;\ntypedef unsigned short int ushort;\ntypedef unsigned int uint;\n#endif\n```",
    "created_at": "2016-05-30T15:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374206",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
This works by accident on Linux due to this bit in `/usr/include/sys/types.h`:

```
#ifdef __USE_MISC
/* Old compatibility names for C types.  */
typedef unsigned long int ulong;
typedef unsigned short int ushort;
typedef unsigned int uint;
#endif
```



---

archive/issue_comments_374207.json:
```json
{
    "body": "Changing commit from \"1f90f95e7c12901dba8078c84a588d9b3cd231a7\" to \"7690e7cfc166d6026e8be2c09c24ee80ef73426b\"",
    "created_at": "2016-05-30T15:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1f90f95e7c12901dba8078c84a588d9b3cd231a7" to "7690e7cfc166d6026e8be2c09c24ee80ef73426b"



---

archive/issue_comments_374208.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[b1a2888](http://git.sagemath.org/sage.git/commit/?id=b1a28882be7edf2d938a5abc22cf2f1e3e6b8398)|`Upgrade PARI to latest master`|\n|[7690e7c](http://git.sagemath.org/sage.git/commit/?id=7690e7cfc166d6026e8be2c09c24ee80ef73426b)|`Safely include paripriv.h`|",
    "created_at": "2016-05-30T15:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[b1a2888](http://git.sagemath.org/sage.git/commit/?id=b1a28882be7edf2d938a5abc22cf2f1e3e6b8398)|`Upgrade PARI to latest master`|
|[7690e7c](http://git.sagemath.org/sage.git/commit/?id=7690e7cfc166d6026e8be2c09c24ee80ef73426b)|`Safely include paripriv.h`|



---

archive/issue_comments_374209.json:
```json
{
    "body": "Changing commit from \"7690e7cfc166d6026e8be2c09c24ee80ef73426b\" to \"3b7c89077f2319c88fc92297685e47ced319aa87\"",
    "created_at": "2016-05-31T08:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374209",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7690e7cfc166d6026e8be2c09c24ee80ef73426b" to "3b7c89077f2319c88fc92297685e47ced319aa87"



---

archive/issue_comments_374210.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[3b7c890](http://git.sagemath.org/sage.git/commit/?id=3b7c89077f2319c88fc92297685e47ced319aa87)|`Undefining ulong does not work`|",
    "created_at": "2016-05-31T08:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[3b7c890](http://git.sagemath.org/sage.git/commit/?id=3b7c89077f2319c88fc92297685e47ced319aa87)|`Undefining ulong does not work`|



---

archive/issue_comments_374211.json:
```json
{
    "body": "<a id='comment:21'></a>\nIs that because of typedef?",
    "created_at": "2016-05-31T08:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374211",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:21'></a>
Is that because of typedef?



---

archive/issue_comments_374212.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jpflori](#comment%3A21):\n> Is that because of typedef?\n\n\nNo, the problem is that `ulong` appears also indirectly in macros. For example, the `typ()` macro in PARI uses `ulong`.",
    "created_at": "2016-05-31T09:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374212",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [jpflori](#comment%3A21):
> Is that because of typedef?


No, the problem is that `ulong` appears also indirectly in macros. For example, the `typ()` macro in PARI uses `ulong`.



---

archive/issue_comments_374213.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-31T09:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374213",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_374214.json:
```json
{
    "body": "Changing keywords from \"\" to \"days74\".",
    "created_at": "2016-06-01T05:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374214",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "" to "days74".



---

archive/issue_comments_374215.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[e9a3a3e](http://git.sagemath.org/sage.git/commit/?id=e9a3a3e7c3dd7e4071b7a4285321080b2f09f6c9)|`Upgrade PARI to latest master`|\n|[5a46139](http://git.sagemath.org/sage.git/commit/?id=5a461395244933a16e9b578eeca63b586f861e91)|`Undefining ulong does not work`|",
    "created_at": "2016-06-15T13:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[e9a3a3e](http://git.sagemath.org/sage.git/commit/?id=e9a3a3e7c3dd7e4071b7a4285321080b2f09f6c9)|`Upgrade PARI to latest master`|
|[5a46139](http://git.sagemath.org/sage.git/commit/?id=5a461395244933a16e9b578eeca63b586f861e91)|`Undefining ulong does not work`|



---

archive/issue_comments_374216.json:
```json
{
    "body": "Changing commit from \"3b7c89077f2319c88fc92297685e47ced319aa87\" to \"5a461395244933a16e9b578eeca63b586f861e91\"",
    "created_at": "2016-06-15T13:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3b7c89077f2319c88fc92297685e47ced319aa87" to "5a461395244933a16e9b578eeca63b586f861e91"



---

archive/issue_comments_374217.json:
```json
{
    "body": "<a id='comment:26'></a>\nRebased on latest develop.",
    "created_at": "2016-06-15T13:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374217",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Rebased on latest develop.



---

archive/issue_comments_374218.json:
```json
{
    "body": "<a id='comment:27'></a>\nNote in case you intend to update this ticket to the very latest PARI version: if you do so, you can remove `build/pkgs/pari/patches/do_QXQ_eval.patch` (added in #20749, corresponding to upstream commit 6db8fba).",
    "created_at": "2016-06-15T13:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374218",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:27'></a>
Note in case you intend to update this ticket to the very latest PARI version: if you do so, you can remove `build/pkgs/pari/patches/do_QXQ_eval.patch` (added in #20749, corresponding to upstream commit 6db8fba).



---

archive/issue_comments_374219.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Some recent fixes needed to correctly count points on hyperelliptic curves.\n \n-**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2670-g9b4a64c.tar.gz\n+**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2771-gb70b447.tar.gz\n``````\n",
    "created_at": "2016-06-15T15:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374219",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Some recent fixes needed to correctly count points on hyperelliptic curves.
 
-**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2670-g9b4a64c.tar.gz
+**Tarball**: http://sage.ugent.be/www/jdemeyer/sage/pari-2.8-2771-gb70b447.tar.gz
``````




---

archive/issue_comments_374220.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-06-15T15:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374220",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_374221.json:
```json
{
    "body": "Changing commit from \"5a461395244933a16e9b578eeca63b586f861e91\" to \"e796224eafee210bc2711d67afc9ffc59779208c\"",
    "created_at": "2016-06-15T16:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5a461395244933a16e9b578eeca63b586f861e91" to "e796224eafee210bc2711d67afc9ffc59779208c"



---

archive/issue_comments_374222.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[e796224](http://git.sagemath.org/sage.git/commit/?id=e796224eafee210bc2711d67afc9ffc59779208c)|`Upgrade PARI to latest master`|",
    "created_at": "2016-06-15T16:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[e796224](http://git.sagemath.org/sage.git/commit/?id=e796224eafee210bc2711d67afc9ffc59779208c)|`Upgrade PARI to latest master`|



---

archive/issue_comments_374223.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-06-15T16:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374223",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_374224.json:
```json
{
    "body": "<a id='comment:30'></a>\nUpgraded to really latest master.",
    "created_at": "2016-06-15T16:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374224",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Upgraded to really latest master.



---

archive/issue_comments_374225.json:
```json
{
    "body": "Changing reviewer from \"Jean-Pierre Flori\" to \"Jean-Pierre Flori, Peter Bruin\"",
    "created_at": "2016-06-20T09:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374225",
    "user": "https://github.com/pjbruin"
}
```

Changing reviewer from "Jean-Pierre Flori" to "Jean-Pierre Flori, Peter Bruin"



---

archive/issue_comments_374226.json:
```json
{
    "body": "Changing commit from \"e796224eafee210bc2711d67afc9ffc59779208c\" to \"bedff7be09d52fc7eba721074eaab6ad5607876b\"",
    "created_at": "2016-06-20T09:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374226",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "e796224eafee210bc2711d67afc9ffc59779208c" to "bedff7be09d52fc7eba721074eaab6ad5607876b"



---

archive/issue_comments_374227.json:
```json
{
    "body": "<a id='comment:31'></a>\nTwo small patches; the second one mirrors the changes to `paridecl.h` made in upstream commit 0d28865 (split FpXQX_factor.c from FpX_factor.c).",
    "created_at": "2016-06-20T09:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374227",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:31'></a>
Two small patches; the second one mirrors the changes to `paridecl.h` made in upstream commit 0d28865 (split FpXQX_factor.c from FpX_factor.c).



---

archive/issue_comments_374228.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/upgrade_pari_to_latest_master\" to \"u/pbruin/20581-upgrade_pari_to_latest_master\"",
    "created_at": "2016-06-20T09:06:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374228",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "u/jdemeyer/upgrade_pari_to_latest_master" to "u/pbruin/20581-upgrade_pari_to_latest_master"



---

archive/issue_comments_374229.json:
```json
{
    "body": "<a id='comment:32'></a>\nLooks good to me, and doctests pass on GNU/Linux x86_64.  If you are happy with the above patches and the `ulong` problem on OSX has been resolved, this can get a positive review as far as I'm concerned.",
    "created_at": "2016-06-20T09:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374229",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:32'></a>
Looks good to me, and doctests pass on GNU/Linux x86_64.  If you are happy with the above patches and the `ulong` problem on OSX has been resolved, this can get a positive review as far as I'm concerned.



---

archive/issue_comments_374230.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-20T10:01:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374230",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_374231.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-06-21T20:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374231",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_374232.json:
```json
{
    "body": "<a id='comment:34'></a>\n\n```\nsage -t --long src/sage/modular/dirichlet.py  # 1 doctest failed\nsage -t --long src/sage/modular/overconvergent/weightspace.py  # 2 doctests failed\n```",
    "created_at": "2016-06-21T20:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374232",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>

```
sage -t --long src/sage/modular/dirichlet.py  # 1 doctest failed
sage -t --long src/sage/modular/overconvergent/weightspace.py  # 2 doctests failed
```



---

archive/issue_comments_374233.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [vbraun](#comment%3A34):\n> {{{\n> sage -t --long src/sage/modular/dirichlet.py  # 1 doctest failed\n> sage -t --long src/sage/modular/overconvergent/weightspace.py  # 2 doctests failed\n> }}}\n\n\nI honestly thought those were caused by #15692 rather than this one.",
    "created_at": "2016-06-21T20:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374233",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:35'></a>
Replying to [vbraun](#comment%3A34):
> {{{
> sage -t --long src/sage/modular/dirichlet.py  # 1 doctest failed
> sage -t --long src/sage/modular/overconvergent/weightspace.py  # 2 doctests failed
> }}}


I honestly thought those were caused by #15692 rather than this one.



---

archive/issue_comments_374234.json:
```json
{
    "body": "<a id='comment:36'></a>\nmaybe, let me double check...",
    "created_at": "2016-06-21T20:56:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374234",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>
maybe, let me double check...



---

archive/issue_comments_374235.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-06-21T21:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374235",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_374236.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-23T17:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374236",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_374237.json:
```json
{
    "body": "Changing branch from \"u/pbruin/20581-upgrade_pari_to_latest_master\" to \"bedff7be09d52fc7eba721074eaab6ad5607876b\"",
    "created_at": "2016-06-23T17:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20581#issuecomment-374237",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/pbruin/20581-upgrade_pari_to_latest_master" to "bedff7be09d52fc7eba721074eaab6ad5607876b"



---

archive/issue_events_055496.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-23T17:14:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20581",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20581#event-55496"
}
```
