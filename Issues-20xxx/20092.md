# Issue 20092: Inconsistent doc for Graph.matching() and fixing Edmonds algorithm with labeled graphs

archive/issues_019855.json:
```json
{
    "body": "In the method Graph.matching(), the doc says:\n\n```\n- ``use_edge_labels`` -- boolean (default: ``False``)\n```\nBut in fact `use_edge_labels` is set to `True` by default. This ticket changes the default behavior to `False` to match the documentation.\n\nWe also fix a bug with Edmonds algorithm always using edge labels:\n\n```\nsage: gw = Graph([(0,1,1),(1,2,99),(2,3,1)])\nsage: gw.matching(use_edge_labels=False)\n[(1, 2, 99)]\n```\n\n\nCC:  @tscrim @nathanncohen\n\nKeywords: matching, graph\n\nBranch/Commit: 523f40fd94e98776193877af2464d2fb5167c900\n\nReviewer: Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Emily Gunawan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20092\n\n",
    "closed_at": "2017-01-18T20:39:58Z",
    "created_at": "2016-02-21T17:23:26Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Inconsistent doc for Graph.matching() and fixing Edmonds algorithm with labeled graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20092",
    "user": "https://github.com/egunawan"
}
```
In the method Graph.matching(), the doc says:

```
- ``use_edge_labels`` -- boolean (default: ``False``)
```
But in fact `use_edge_labels` is set to `True` by default. This ticket changes the default behavior to `False` to match the documentation.

We also fix a bug with Edmonds algorithm always using edge labels:

```
sage: gw = Graph([(0,1,1),(1,2,99),(2,3,1)])
sage: gw.matching(use_edge_labels=False)
[(1, 2, 99)]
```


CC:  @tscrim @nathanncohen

Keywords: matching, graph

Branch/Commit: 523f40fd94e98776193877af2464d2fb5167c900

Reviewer: Travis Scrimshaw, Frédéric Chapoton

Author: Emily Gunawan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20092





---

archive/issue_comments_290354.json:
```json
{
    "body": "<a id='comment:1'></a>To me, having it fixed in any way is good for as long as it is fixed. I would personally enforce in the code what the doc says, for I expect graph functions to not try to understand the labels unless I explicitly want it to. I'm likely to have my edges labelled with things that make sense to me (color classes for example) and that would not make any sense if understood as a weight.\n\nThough that's only me.\n\nNathann",
    "created_at": "2016-02-21T18:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290354",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>To me, having it fixed in any way is good for as long as it is fixed. I would personally enforce in the code what the doc says, for I expect graph functions to not try to understand the labels unless I explicitly want it to. I'm likely to have my edges labelled with things that make sense to me (color classes for example) and that would not make any sense if understood as a weight.

Though that's only me.

Nathann



---

archive/issue_comments_290355.json:
```json
{
    "body": "<a id='comment:2'></a>IMO the least surprising thing (i.e., least likely to break 3rd party code) is to change the default listed in doc so that it matches the code. However, given the extra data that needs to be processed and Nathann's comment (plus my own personal use cases), I think the best thing to do is just change the default value to `False`.",
    "created_at": "2016-02-23T23:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290355",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>IMO the least surprising thing (i.e., least likely to break 3rd party code) is to change the default listed in doc so that it matches the code. However, given the extra data that needs to be processed and Nathann's comment (plus my own personal use cases), I think the best thing to do is just change the default value to `False`.



---

archive/issue_comments_290356.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2016-02-29T00:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290356",
    "user": "https://github.com/egunawan"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_290357.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-29T00:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290357",
    "user": "https://github.com/egunawan"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_290358.json:
```json
{
    "body": "<a id='comment:4'></a>Can you explain what the bug was (including the code which resulted in the bug)? Also could you explain this change to me? I don't see the point in creating a new graph and if this is necessary, why don't you cal `copy`?\n\n```diff\n-                g = self.networkx_graph(copy=False)\n+                g = Graph(self.edges(labels=False))\n+                g = g.networkx_graph(copy=False)\n```\nAlso I don't think this change is good\n\n```diff\n-                    return Integer(len(d)/2)\n+                    return len(d)/2\n```\nas now the output is not guaranteed to be a Sage integer. We try to make sure python `int`s don't escape to the user.",
    "created_at": "2016-02-29T06:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290358",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>Can you explain what the bug was (including the code which resulted in the bug)? Also could you explain this change to me? I don't see the point in creating a new graph and if this is necessary, why don't you cal `copy`?

```diff
-                g = self.networkx_graph(copy=False)
+                g = Graph(self.edges(labels=False))
+                g = g.networkx_graph(copy=False)
```
Also I don't think this change is good

```diff
-                    return Integer(len(d)/2)
+                    return len(d)/2
```
as now the output is not guaranteed to be a Sage integer. We try to make sure python `int`s don't escape to the user.



---

archive/issue_comments_290359.json:
```json
{
    "body": "<a id='comment:5'></a>This is the bug: currently the method takes into account the weights of the edges, if `use_edge_labels=False`:\n\n```\nsage: g=Graph([(0,1),(1,2),(2,3)])\nsage: g.matching()\n[(0, 1, None), (2, 3, None)]\n\nsage: gw=Graph([(0,1,1),(1,2,99),(2,3,1)])\nsage: gw.matching(use_edge_labels=False)\n[(1, 2, 99)]\n```",
    "created_at": "2016-02-29T06:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290359",
    "user": "https://github.com/egunawan"
}
```

<a id='comment:5'></a>This is the bug: currently the method takes into account the weights of the edges, if `use_edge_labels=False`:

```
sage: g=Graph([(0,1),(1,2),(2,3)])
sage: g.matching()
[(0, 1, None), (2, 3, None)]

sage: gw=Graph([(0,1,1),(1,2,99),(2,3,1)])
sage: gw.matching(use_edge_labels=False)
[(1, 2, 99)]
```



---

archive/issue_comments_290360.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-02-29T06:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290360",
    "user": "https://github.com/egunawan"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_290361.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-29T07:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290362.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2016-03-02T15:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290362",
    "user": "https://github.com/tscrim"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_290363.json:
```json
{
    "body": "<a id='comment:8'></a>I made some changes (and rebased to 7.1.beta5) to improve the speed/memory usage, standardize the doc, and make the output types more consistent/compatible. If you agree with my changes, then you can set a positive review.\n\n---\nNew commits:",
    "created_at": "2016-03-02T15:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290363",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>I made some changes (and rebased to 7.1.beta5) to improve the speed/memory usage, standardize the doc, and make the output types more consistent/compatible. If you agree with my changes, then you can set a positive review.

---
New commits:



---

archive/issue_comments_290364.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -3,11 +3,16 @@\n \\`\\`\\`\n - \\`\\`use_edge_labels\\`\\` -- boolean (default: \\`\\`False\\`\\`)\n \\`\\`\\`\n-But in fact \\`use_edge_labels\\` is set to True by default.\n+But in fact \\`use_edge_labels\\` is set to \\`True\\` by default. This ticket changes the default behavior to \\`False\\` to match the documentation.\n \n-Question: Should the doc be changed or should the default value be changed?\n+We also fix a bug with Edmonds algorithm always using edge labels:\n \n-Currently working with Sage version 7.1.beta3\n+\\`\\`\\`\n+sage: gw = Graph([(0,1,1),(1,2,99),(2,3,1)])\n+sage: gw.matching(use_edge_labels=False)\n+[(1, 2, 99)]\n+\\`\\`\\`\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2016-03-02T15:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290364",
    "user": "https://github.com/tscrim"
}
```

Description changed:
```diff
--- 
+++ 
@@ -3,11 +3,16 @@
 \`\`\`
 - \`\`use_edge_labels\`\` -- boolean (default: \`\`False\`\`)
 \`\`\`
-But in fact \`use_edge_labels\` is set to True by default.
+But in fact \`use_edge_labels\` is set to \`True\` by default. This ticket changes the default behavior to \`False\` to match the documentation.
 
-Question: Should the doc be changed or should the default value be changed?
+We also fix a bug with Edmonds algorithm always using edge labels:
 
-Currently working with Sage version 7.1.beta3
+\`\`\`
+sage: gw = Graph([(0,1,1),(1,2,99),(2,3,1)])
+sage: gw.matching(use_edge_labels=False)
+[(1, 2, 99)]
+\`\`\`
+
 
 Comment: 1
 
```




---

archive/issue_comments_290365.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-02T15:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290365",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_290366.json:
```json
{
    "body": "<a id='comment:9'></a>ok, let it be",
    "created_at": "2017-01-05T12:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290366",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>ok, let it be



---

archive/issue_comments_290367.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-01-05T12:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290367",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_054693.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-05T16:14:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20092#event-54693"
}
```



---

archive/issue_comments_290368.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-01-18T20:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20092#issuecomment-290368",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054694.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-18T20:39:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20092",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20092#event-54694"
}
```
