# Issue 20604: failing doctest with coxeter3

archive/issues_020367.json:
```json
{
    "body": "CC:  @jdemeyer @tscrim stumpc5\n\nNeeds to solve that\n\n```\nFile \"src/sage/libs/coxeter3/coxeter_group.py\", line 44, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.__init__\nFailed example:\n    TestSuite(CoxeterGroup(['A',2])).run()                    # optional - coxeter3\nExpected nothing\n...\nThe following tests failed: _test_codegrees, _test_degrees\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/20604\n\n",
    "closed_at": "2016-05-15T18:58:41Z",
    "created_at": "2016-05-13T12:09:00Z",
    "labels": [
        "component: packages: optional",
        "blocker"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "failing doctest with coxeter3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20604",
    "user": "https://github.com/fchapoton"
}
```
CC:  @jdemeyer @tscrim stumpc5

Needs to solve that

```
File "src/sage/libs/coxeter3/coxeter_group.py", line 44, in sage.libs.coxeter3.coxeter_group.CoxeterGroup.__init__
Failed example:
    TestSuite(CoxeterGroup(['A',2])).run()                    # optional - coxeter3
Expected nothing
...
The following tests failed: _test_codegrees, _test_degrees
```

Issue created by migration from https://trac.sagemath.org/ticket/20604





---

archive/issue_comments_280478.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-05-13T12:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280478",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_280479.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-13T12:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280479",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_280480.json:
```json
{
    "body": "Am I correct that this is tested since it goes into the category `FiniteCoxeterGroups`?\n\nFr\u00e9d\u00e9ric, could you remind me where your generic code for the degrees go - couldn't we use that here as well (and for finite Coxeter groups, the codegrees are just two less than the degrees).",
    "created_at": "2016-05-13T12:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280480",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Am I correct that this is tested since it goes into the category `FiniteCoxeterGroups`?

Frédéric, could you remind me where your generic code for the degrees go - couldn't we use that here as well (and for finite Coxeter groups, the codegrees are just two less than the degrees).



---

archive/issue_comments_280481.json:
```json
{
    "body": "Failure comes from the absence of the matrix method:\n\n```\n    Failure in _test_codegrees:\n    Traceback (most recent call last):\n      File \"/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_complex_reflection_groups.py\", line 283, in _test_codegrees\n        codegrees = self.codegrees()\n      File \"/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py\", line 285, in codegrees\n        return tuple(d - 2 for d in self.degrees())\n      File \"/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py\", line 259, in degrees\n        for I in self.irreducible_component_index_sets()), ())\n      File \"/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py\", line 259, in <genexpr>\n        for I in self.irreducible_component_index_sets()), ())\n      File \"/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py\", line 250, in degrees_of_irreducible_component\n        roots = c.matrix().change_ring(QQbar).charpoly().roots()\n      File \"sage/structure/element.pyx\", line 413, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4649)\n        return getattr_from_other_class(self, P._abstract_element_class, name)\n      File \"sage/structure/misc.pyx\", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1763)\n        raise dummy_attribute_error\n    AttributeError: 'CoxeterGroup_with_category.element_class' object has no attribute 'matrix'\n```\nwhen trying to compute `c.matrix().change_ring(QQbar).charpoly().roots()`",
    "created_at": "2016-05-13T12:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280481",
    "user": "https://github.com/fchapoton"
}
```

Failure comes from the absence of the matrix method:

```
    Failure in _test_codegrees:
    Traceback (most recent call last):
      File "/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_complex_reflection_groups.py", line 283, in _test_codegrees
        codegrees = self.codegrees()
      File "/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py", line 285, in codegrees
        return tuple(d - 2 for d in self.degrees())
      File "/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py", line 259, in degrees
        for I in self.irreducible_component_index_sets()), ())
      File "/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py", line 259, in <genexpr>
        for I in self.irreducible_component_index_sets()), ())
      File "/home/patchbot/sage-patchbot/local/lib/python2.7/site-packages/sage/categories/finite_coxeter_groups.py", line 250, in degrees_of_irreducible_component
        roots = c.matrix().change_ring(QQbar).charpoly().roots()
      File "sage/structure/element.pyx", line 413, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4649)
        return getattr_from_other_class(self, P._abstract_element_class, name)
      File "sage/structure/misc.pyx", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1763)
        raise dummy_attribute_error
    AttributeError: 'CoxeterGroup_with_category.element_class' object has no attribute 'matrix'
```
when trying to compute `c.matrix().change_ring(QQbar).charpoly().roots()`



---

archive/issue_comments_280482.json:
```json
{
    "body": "I didn't mention this, but it my latest patchbot tests on `arando` and `sage4` I installed all doctested optional packages and then I got the above failure.",
    "created_at": "2016-05-13T12:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280482",
    "user": "https://github.com/jdemeyer"
}
```

I didn't mention this, but it my latest patchbot tests on `arando` and `sage4` I installed all doctested optional packages and then I got the above failure.



---

archive/issue_comments_280483.json:
```json
{
    "body": "I don't seem to be able to test:\n\n```\n$ sage-git -i coxeter3\n...\nSuccessfully installed coxeter3-1.1\n...\nsage: from sage.libs.coxeter3.coxeter_group import CoxeterGroup\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n...\nImportError: No module named coxeter\n```\nI am either fine with this, or we quickly implement the matrices for `Coxeter3` Coxeter groups, if that is easy to be done.",
    "created_at": "2016-05-13T12:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280483",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

I don't seem to be able to test:

```
$ sage-git -i coxeter3
...
Successfully installed coxeter3-1.1
...
sage: from sage.libs.coxeter3.coxeter_group import CoxeterGroup
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
...
ImportError: No module named coxeter
```
I am either fine with this, or we quickly implement the matrices for `Coxeter3` Coxeter groups, if that is easy to be done.



---

archive/issue_comments_280484.json:
```json
{
    "body": "I have no time for a better fix. Let us keep that simple.",
    "created_at": "2016-05-13T12:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280484",
    "user": "https://github.com/fchapoton"
}
```

I have no time for a better fix. Let us keep that simple.



---

archive/issue_comments_280485.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-13T12:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280485",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_280486.json:
```json
{
    "body": "Given our policy for opinional doctests, shouldn't this be a blocker?",
    "created_at": "2016-05-13T12:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280486",
    "user": "https://github.com/tscrim"
}
```

Given our policy for opinional doctests, shouldn't this be a blocker?



---

archive/issue_comments_280487.json:
```json
{
    "body": "I love the term *opinional*!",
    "created_at": "2016-05-13T12:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280487",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

I love the term *opinional*!



---

archive/issue_comments_280488.json:
```json
{
    "body": "Got to love autocorrect on my phone... *optional* is what I meant of course.",
    "created_at": "2016-05-13T13:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280488",
    "user": "https://github.com/tscrim"
}
```

Got to love autocorrect on my phone... *optional* is what I meant of course.



---

archive/issue_comments_280489.json:
```json
{
    "body": "Replying to [comment:5 stumpc5]:\n> I don't seem to be able to test:\n\n\nDid you forget to run `make`?",
    "created_at": "2016-05-13T15:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280489",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 stumpc5]:
> I don't seem to be able to test:


Did you forget to run `make`?



---

archive/issue_comments_280490.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> Did you forget to run `make`?\n\n\nworks now -- I didn't know that I have to rerun `make` after installing an optional package (or did I possibly by accident forget to run make",
    "created_at": "2016-05-14T19:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280490",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Replying to [comment:11 jdemeyer]:
> Did you forget to run `make`?


works now -- I didn't know that I have to rerun `make` after installing an optional package (or did I possibly by accident forget to run make



---

archive/issue_comments_280491.json:
```json
{
    "body": "Replying to [comment:12 stumpc5]:\n> Replying to [comment:11 jdemeyer]:\n> > Did you forget to run `make`?\n\n> \n> works now -- I didn't know that I have to rerun `make` after installing an optional package (or did I possibly by accident forget to run make \n\n\nIt is because there are the cython files that need to be compiled, which are only done so when the optional spkg is installed.",
    "created_at": "2016-05-15T03:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280491",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:12 stumpc5]:
> Replying to [comment:11 jdemeyer]:
> > Did you forget to run `make`?

> 
> works now -- I didn't know that I have to rerun `make` after installing an optional package (or did I possibly by accident forget to run make 


It is because there are the cython files that need to be compiled, which are only done so when the optional spkg is installed.



---

archive/issue_comments_280492.json:
```json
{
    "body": "Rule of thumb: you always have to run `make` after changing anything in your Sage installation.",
    "created_at": "2016-05-15T06:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280492",
    "user": "https://github.com/jdemeyer"
}
```

Rule of thumb: you always have to run `make` after changing anything in your Sage installation.



---

archive/issue_comments_280493.json:
```json
{
    "body": "Replying to [comment:14 jdemeyer]:\n> Rule of thumb: you always have to run `make` after changing anything in your Sage installation.\n\n\nWouldn't that be good to be added to http://doc.sagemath.org/html/en/reference/misc/sage/misc/package.html ?",
    "created_at": "2016-05-15T07:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280493",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Replying to [comment:14 jdemeyer]:
> Rule of thumb: you always have to run `make` after changing anything in your Sage installation.


Wouldn't that be good to be added to http://doc.sagemath.org/html/en/reference/misc/sage/misc/package.html ?



---

archive/issue_comments_280494.json:
```json
{
    "body": "I'm upgrading this to a 7.2 blocker so all optional doctests pass as per our policy.",
    "created_at": "2016-05-15T14:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280494",
    "user": "https://github.com/tscrim"
}
```

I'm upgrading this to a 7.2 blocker so all optional doctests pass as per our policy.



---

archive/issue_events_055532.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-05-15T14:14:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20604#event-55532"
}
```



---

archive/issue_comments_280495.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2016-05-15T14:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280495",
    "user": "https://github.com/tscrim"
}
```

Changing priority from major to blocker.



---

archive/issue_events_055533.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-15T18:58:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20604#event-55533"
}
```



---

archive/issue_comments_280496.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-15T18:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20604",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20604#issuecomment-280496",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
