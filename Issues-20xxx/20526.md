# Issue 20526: A benchmarking tool for linear codes

archive/issues_020289.json:
```json
{
    "body": "This ticket proposes a tool to easily run experiments on linear codes (encoding, decoding...), gather data and process it.\n\nCC:  @johanrosenkilde @ClementPernet\n\nBranch: u/dlucas/benchmarking_tool\n\nStatus: needs_info\n\nCommit: fe0b956386ad3fc684e5ae306254fb814fdc76e5\n\nIssue created by migration from https://trac.sagemath.org/ticket/20526\n\n",
    "created_at": "2016-05-01T07:38:36Z",
    "labels": [
        "component: coding theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "A benchmarking tool for linear codes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20526",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```
This ticket proposes a tool to easily run experiments on linear codes (encoding, decoding...), gather data and process it.

CC:  @johanrosenkilde @ClementPernet

Branch: u/dlucas/benchmarking_tool

Status: needs_info

Commit: fe0b956386ad3fc684e5ae306254fb814fdc76e5

Issue created by migration from https://trac.sagemath.org/ticket/20526





---

archive/issue_comments_279349.json:
```json
{
    "body": "<a id='comment:2'></a>I pushed the first version. Some minor issues still exist, I'll fix these in the next few days.\n\n---\nNew commits:",
    "created_at": "2016-05-01T07:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279349",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:2'></a>I pushed the first version. Some minor issues still exist, I'll fix these in the next few days.

---
New commits:



---

archive/issue_comments_279350.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-03T11:15:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279351.json:
```json
{
    "body": "<a id='comment:4'></a>Hello,\n\nI made some changes:\n\n- I removed the code, the encoder, the decoder and the channel from the dictionary `experimental_data`, as this never changes through the tests for a given benchmark.\n- I strengthened how empty benchmarks are managed in addition. Consider `B1` and `B2` two benchmarks. If:\n    - `B1` and `B2` are empty, an exception is returned,\n    - `B1` or `B2` are empty, the empty benchmark is ignored.\n\nThis is still under new state as there's some remaining bugs (e.g. \"experimental\" warning is called everytime a Benchmark is constructed, even inside the same session).",
    "created_at": "2016-05-03T11:20:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279351",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:4'></a>Hello,

I made some changes:

- I removed the code, the encoder, the decoder and the channel from the dictionary `experimental_data`, as this never changes through the tests for a given benchmark.
- I strengthened how empty benchmarks are managed in addition. Consider `B1` and `B2` two benchmarks. If:
    - `B1` and `B2` are empty, an exception is returned,
    - `B1` or `B2` are empty, the empty benchmark is ignored.

This is still under new state as there's some remaining bugs (e.g. "experimental" warning is called everytime a Benchmark is constructed, even inside the same session).



---

archive/issue_comments_279352.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-11T13:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279353.json:
```json
{
    "body": "<a id='comment:7'></a>Hello,\n\nHere's a change log for this ticket:\n\n- I removed `encoder` from this class. One cannot pass an encoder to a benchmark anymore, and all related methods have been deleted. Instead, I replaced the old call `Benchmark(E, D, Chan)` by `Benchmark(C, D, Chan)`. \n\n- Adding two empty benchmarks now returns an empty benchmark and no longer an exception.\n\n- I added better messages in case one tries to manipulate an empty benchmark: for instance. calling `Benchmark.run()` now returns a proper message which explains that nothing will be done.\n\n- I refined the notion of \"success rate\". It now considers decoding errors (when the decoder fails at returning anything) and decoding failures (when the decoder returns a codeword which is not the expected one). I also enhanced `decoding_success_rate`, which now allows the user to select between success rate wrt. failures or errors.\n\n- I globally improved the documentation.\n\nOne problem remains: the experimental warning triggered by the decorator ``@`experimental` activates every time one creates a benchmark, which is annoying and also breaks all my doctests.\nThis is quite weird as the [documentation for this decorator](http://doc.sagemath.org/html/en/reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental) says it will only be triggered once/session.\nStill investigating on this...\n\nDavid",
    "created_at": "2016-05-11T13:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279353",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:7'></a>Hello,

Here's a change log for this ticket:

- I removed `encoder` from this class. One cannot pass an encoder to a benchmark anymore, and all related methods have been deleted. Instead, I replaced the old call `Benchmark(E, D, Chan)` by `Benchmark(C, D, Chan)`. 

- Adding two empty benchmarks now returns an empty benchmark and no longer an exception.

- I added better messages in case one tries to manipulate an empty benchmark: for instance. calling `Benchmark.run()` now returns a proper message which explains that nothing will be done.

- I refined the notion of "success rate". It now considers decoding errors (when the decoder fails at returning anything) and decoding failures (when the decoder returns a codeword which is not the expected one). I also enhanced `decoding_success_rate`, which now allows the user to select between success rate wrt. failures or errors.

- I globally improved the documentation.

One problem remains: the experimental warning triggered by the decorator ``@`experimental` activates every time one creates a benchmark, which is annoying and also breaks all my doctests.
This is quite weird as the [documentation for this decorator](http://doc.sagemath.org/html/en/reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental) says it will only be triggered once/session.
Still investigating on this...

David



---

archive/issue_comments_279354.json:
```json
{
    "body": "<a id='comment:8'></a>Sounds good! Quick remark (didn't check the code yet): In \"A Course In Error-Correcting Codes\" by Justesen and H\u00f8holdt then \"decoding error\" is defined as the decoder returning a codeword which was not the intended, and \"decoding failure\" is defined as the decoder not returning the wanted codeword (i.e. either returning nothing or returning a wrong one).\n\nThat is, `P(failure) >= P(error) and P(failure) - P(error) = P(not returning anything)`.\n\nPerhaps this implementation should reflect this (non-universally adopted) convention.",
    "created_at": "2016-05-11T16:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279354",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:8'></a>Sounds good! Quick remark (didn't check the code yet): In "A Course In Error-Correcting Codes" by Justesen and HÃ¸holdt then "decoding error" is defined as the decoder returning a codeword which was not the intended, and "decoding failure" is defined as the decoder not returning the wanted codeword (i.e. either returning nothing or returning a wrong one).

That is, `P(failure) >= P(error) and P(failure) - P(error) = P(not returning anything)`.

Perhaps this implementation should reflect this (non-universally adopted) convention.



---

archive/issue_comments_279355.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-12T08:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279355",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279356.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-12T08:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279356",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279357.json:
```json
{
    "body": "<a id='comment:11'></a>Hello,\n\n> Sounds good! Quick remark (didn't check the code yet): In \"A Course In Error-Correcting Codes\" by Justesen and H\u00f8holdt then \"decoding error\" is defined as the decoder returning a codeword which was not the intended, and \"decoding failure\" is defined as the decoder not returning the wanted codeword (i.e. either returning nothing or returning a wrong one).\n\n\nOops, I wanted to do that, but confused the definition of decoding error and decoding failure. Fixed now.\nBTW, the exception thrown when something wrong occurs during decoding is called `DecodingError`... Which is actually a bit confusing. But it follows the template to name exceptions.\n\nDavid",
    "created_at": "2016-05-12T08:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279357",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:11'></a>Hello,

> Sounds good! Quick remark (didn't check the code yet): In "A Course In Error-Correcting Codes" by Justesen and HÃ¸holdt then "decoding error" is defined as the decoder returning a codeword which was not the intended, and "decoding failure" is defined as the decoder not returning the wanted codeword (i.e. either returning nothing or returning a wrong one).


Oops, I wanted to do that, but confused the definition of decoding error and decoding failure. Fixed now.
BTW, the exception thrown when something wrong occurs during decoding is called `DecodingError`... Which is actually a bit confusing. But it follows the template to name exceptions.

David



---

archive/issue_comments_279358.json:
```json
{
    "body": "<a id='comment:12'></a>> BTW, the exception thrown when something wrong occurs during decoding is called `DecodingError`... Which is actually a bit confusing. But it follows the template to name exceptions.\n\n\nHmm, probably that's the reason I called that exception `DecodingFailedError` in Codinglib :-)",
    "created_at": "2016-05-12T08:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279358",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:12'></a>> BTW, the exception thrown when something wrong occurs during decoding is called `DecodingError`... Which is actually a bit confusing. But it follows the template to name exceptions.


Hmm, probably that's the reason I called that exception `DecodingFailedError` in Codinglib :-)



---

archive/issue_comments_279359.json:
```json
{
    "body": "<a id='comment:13'></a>> Hmm, probably that's the reason I called that exception DecodingFailedError in Codinglib :-)\n\n\nYes, that's much better! Do you think changing its name is worth the deprecation warning?",
    "created_at": "2016-05-12T09:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279359",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:13'></a>> Hmm, probably that's the reason I called that exception DecodingFailedError in Codinglib :-)


Yes, that's much better! Do you think changing its name is worth the deprecation warning?



---

archive/issue_comments_279360.json:
```json
{
    "body": "<a id='comment:14'></a>I've looked at the problem with the `@`experimental warning. The problem seems simply to be that (almost all) warnings in Sage currently issue a message *every* time the offending code is being run. Try `LinearCode.decode` for an example.\n\nSo why doesn't `AsymptoticRing` and friends behave like this with the `@`experimental warning? It's because all the classes inherit from `UniqueRepresentation`, so if multiple instantiations are called with the same arguments, the `__init__` is actually only called once. This is why their `TESTS` block at the module top level turns off the `FutureWarning` in all the individual doc-tests later on.\n\nI've asked about this on sage-devel: https://groups.google.com/forum/#!topic/sage-devel/RxMNjVWBeI0\n\nBtw: how did I find out about this? I took the file `growth_groups.py` in `sage.rings.asymptotic_ring`, copied it and reduced it to a minimal working class that behaved well. Then I tried to remove code lines from it one-by-one until I found the line that made the doc-tests work. This turned out to be inheriting from `UniqueRepresentation`.\n\nBest,\nJohan",
    "created_at": "2016-05-12T10:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279360",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:14'></a>I've looked at the problem with the `@`experimental warning. The problem seems simply to be that (almost all) warnings in Sage currently issue a message *every* time the offending code is being run. Try `LinearCode.decode` for an example.

So why doesn't `AsymptoticRing` and friends behave like this with the `@`experimental warning? It's because all the classes inherit from `UniqueRepresentation`, so if multiple instantiations are called with the same arguments, the `__init__` is actually only called once. This is why their `TESTS` block at the module top level turns off the `FutureWarning` in all the individual doc-tests later on.

I've asked about this on sage-devel: https://groups.google.com/forum/#!topic/sage-devel/RxMNjVWBeI0

Btw: how did I find out about this? I took the file `growth_groups.py` in `sage.rings.asymptotic_ring`, copied it and reduced it to a minimal working class that behaved well. Then I tried to remove code lines from it one-by-one until I found the line that made the doc-tests work. This turned out to be inheriting from `UniqueRepresentation`.

Best,
Johan



---

archive/issue_comments_279361.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:13 dlucas]:\n> > Hmm, probably that's the reason I called that exception DecodingFailedError in Codinglib :-)\n\n> \n> Yes, that's much better! Do you think changing its name is worth the deprecation warning?\n\n\nHmm, how would you even deprecate this? Issue a deprecation warning only when the error is thrown?\n\nBut, thinking more about it, this name is also no good: the exception is used by a decoding algorithm when it realises that something went wrong, e.g. the polynomial division in Berlekamp-Welch doesn't go well. But this is exactly a case of `DecodingFailure\\DecodingError` where `\\` indicates set difference; that is, it is a decoding failure that is surely not a decoding error (since no codeword is returned).\n\nJustesen and H\u00f8holdt do not give a name to this event, but we need such a name for the decoding exception.\n\n`DecodingException`? `DecodeAbortError`? `DecodingAborted`?",
    "created_at": "2016-05-12T11:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279361",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:15'></a>Replying to [comment:13 dlucas]:
> > Hmm, probably that's the reason I called that exception DecodingFailedError in Codinglib :-)

> 
> Yes, that's much better! Do you think changing its name is worth the deprecation warning?


Hmm, how would you even deprecate this? Issue a deprecation warning only when the error is thrown?

But, thinking more about it, this name is also no good: the exception is used by a decoding algorithm when it realises that something went wrong, e.g. the polynomial division in Berlekamp-Welch doesn't go well. But this is exactly a case of `DecodingFailure\DecodingError` where `\` indicates set difference; that is, it is a decoding failure that is surely not a decoding error (since no codeword is returned).

Justesen and HÃ¸holdt do not give a name to this event, but we need such a name for the decoding exception.

`DecodingException`? `DecodeAbortError`? `DecodingAborted`?



---

archive/issue_comments_279362.json:
```json
{
    "body": "<a id='comment:16'></a>If you rebase on top of #20601 then all doc-tests pass now and the ``@`experimental` problem is gone.",
    "created_at": "2016-05-13T08:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279362",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:16'></a>If you rebase on top of #20601 then all doc-tests pass now and the ``@`experimental` problem is gone.



---

archive/issue_comments_279363.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-13T11:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279364.json:
```json
{
    "body": "<a id='comment:18'></a>Hello,\n\n> If you rebase on top of #20601 then all doc-tests pass now and the `@`experimental problem is gone.\n\n\nThanks, it works fine!\n\nThis ticket is now open for review.",
    "created_at": "2016-05-13T11:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279364",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:18'></a>Hello,

> If you rebase on top of #20601 then all doc-tests pass now and the `@`experimental problem is gone.


Thanks, it works fine!

This ticket is now open for review.



---

archive/issue_comments_279365.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-13T11:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279365",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_events_055426.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/dlucas",
    "created_at": "2016-05-13T11:57:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20526#event-55426"
}
```



---

archive/issue_comments_279366.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-09-02T12:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279366",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_279367.json:
```json
{
    "body": "<a id='comment:19'></a>This will probably be superseded by the [BleacherMark project](https://github.com/miguelmarco/bleachermark).",
    "created_at": "2016-09-02T12:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20526",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20526#issuecomment-279367",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:19'></a>This will probably be superseded by the [BleacherMark project](https://github.com/miguelmarco/bleachermark).
