# Issue 20916: Optional linking Pynac with libgiac on Debian needs unrelated libraries

archive/issues_020679.json:
```json
{
    "body": "Apparently on Debian / Ubuntu a libgiac dependency may not be installed with the giac install and is somehow needed when installing Pynac in Sage (which optionally has giac installed).\n\nTo prevent unwanted linking and to reduce confusion `--with-giac=no` should be set in the Pynac spkg.\n\nDetails: https://groups.google.com/forum/?hl=en#!topic/sage-release/jQmE2nsnbDI\n\nUpstream: Not yet reported upstream; Will do shortly.\n\nReviewer: Volker Braun\n\nAuthor: Ralf Stephan\n\nBranch: 3b033396af5d0a6e7f18e41aa8d9a99404f2b157\n\nCommit: 3b033396af5d0a6e7f18e41aa8d9a99404f2b157\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20916\n\n",
    "closed_at": "2016-07-02T08:49:07Z",
    "created_at": "2016-07-01T07:28:14Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Optional linking Pynac with libgiac on Debian needs unrelated libraries",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20916",
    "user": "https://github.com/rwst"
}
```
Apparently on Debian / Ubuntu a libgiac dependency may not be installed with the giac install and is somehow needed when installing Pynac in Sage (which optionally has giac installed).

To prevent unwanted linking and to reduce confusion `--with-giac=no` should be set in the Pynac spkg.

Details: https://groups.google.com/forum/?hl=en#!topic/sage-release/jQmE2nsnbDI

Upstream: Not yet reported upstream; Will do shortly.

Reviewer: Volker Braun

Author: Ralf Stephan

Branch: 3b033396af5d0a6e7f18e41aa8d9a99404f2b157

Commit: 3b033396af5d0a6e7f18e41aa8d9a99404f2b157

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20916





---

archive/issue_comments_285370.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2016-07-01T07:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285370",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_285371.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-01T07:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285371",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_285372.json:
```json
{
    "body": "<a id='comment:3'></a>Hi Ralf,\n\nCould you put a link to upstream report?",
    "created_at": "2016-07-01T07:42:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285372",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>Hi Ralf,

Could you put a link to upstream report?



---

archive/issue_comments_285373.json:
```json
{
    "body": "<a id='comment:5'></a>I have no idea what to report since it doesn't happen on my system. FWIW, it could even be that it's because William has giac installed in system instead of via `sage -i`.",
    "created_at": "2016-07-01T07:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285373",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>I have no idea what to report since it doesn't happen on my system. FWIW, it could even be that it's because William has giac installed in system instead of via `sage -i`.



---

archive/issue_comments_285374.json:
```json
{
    "body": "<a id='comment:7'></a>lgtm, please set to positive review after filling the author name in",
    "created_at": "2016-07-01T07:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285374",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>lgtm, please set to positive review after filling the author name in



---

archive/issue_comments_285375.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-01T08:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285376.json:
```json
{
    "body": "<a id='comment:9'></a>Unfortunately this will only work as is on systems without giac. With giac, the optional test is done which (if not linked with pynac as was removed with the first commit) will trigger a Pynac bug.\n\nSo the optional doctest must be removed as well. Still positive?",
    "created_at": "2016-07-01T08:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285376",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'></a>Unfortunately this will only work as is on systems without giac. With giac, the optional test is done which (if not linked with pynac as was removed with the first commit) will trigger a Pynac bug.

So the optional doctest must be removed as well. Still positive?



---

archive/issue_comments_285377.json:
```json
{
    "body": "<a id='comment:10'></a>You can mark it as `# known bug`",
    "created_at": "2016-07-01T08:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285377",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>You can mark it as `# known bug`



---

archive/issue_comments_285378.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-01T08:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285378",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285379.json:
```json
{
    "body": "<a id='comment:12'></a>That works, thanks.",
    "created_at": "2016-07-01T08:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285379",
    "user": "https://github.com/rwst"
}
```

<a id='comment:12'></a>That works, thanks.



---

archive/issue_comments_285380.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-01T08:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285380",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_285381.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:5 rws]:\n> I have no idea what to report since it doesn't happen on my system. FWIW, it could even be that it's because William has giac installed in system instead of via `sage -i`.\n\n\nWell, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to *link to it* on Linux -- as opposed to *building giac*, you listed giac's *build dependencies* in the thread -- explicitly list also libao-dev.)",
    "created_at": "2016-07-01T09:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285381",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>Replying to [comment:5 rws]:
> I have no idea what to report since it doesn't happen on my system. FWIW, it could even be that it's because William has giac installed in system instead of via `sage -i`.


Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to *link to it* on Linux -- as opposed to *building giac*, you listed giac's *build dependencies* in the thread -- explicitly list also libao-dev.)



---

archive/issue_comments_285382.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 leif]:\n> Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to *link to it* on Linux -- as opposed to *building giac*, you listed giac's *build dependencies* in the thread -- explicitly list also libao-dev.)\n\n\nAs you say it applies to Debian only---here on OpenSuSE libao is sufficient and there should be no reason why Pynac would need something that isn't already there after `sage -i giac` has finished. If `-lao` is needed by Sage then already then, isn't it?",
    "created_at": "2016-07-01T09:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285382",
    "user": "https://github.com/rwst"
}
```

<a id='comment:14'></a>Replying to [comment:13 leif]:
> Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to *link to it* on Linux -- as opposed to *building giac*, you listed giac's *build dependencies* in the thread -- explicitly list also libao-dev.)


As you say it applies to Debian only---here on OpenSuSE libao is sufficient and there should be no reason why Pynac would need something that isn't already there after `sage -i giac` has finished. If `-lao` is needed by Sage then already then, isn't it?



---

archive/issue_comments_285383.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 rws]:\n> Replying to [comment:13 leif]:\n> > Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to *link to it* on Linux -- as opposed to *building giac*, you listed giac's *build dependencies* in the thread -- explicitly list also libao-dev.)\n\n> \n> As you say it applies to Debian only---here on OpenSuSE libao is sufficient and there should be no reason why Pynac would need something that isn't already there after `sage -i giac` has finished.\n\n\nYep, (vanilla) giac's configure instructions do not mention libao either.  But if building pynac *may* fail on !Debian/Ubuntu (hardly anyone uses these distros, I know), pynac's configure should catch that case (either by disabling giac, or giving an appropriate error message).\n\nI'd say solve it upstream if you find the time, and we can eventually revert the changes here with one of the next releases of pynac.\n\nOr we could make Sage's giac package a standard one.\n\n\\\\\n\n> If `-lao` is needed by Sage then already then, isn't it?\n\n\nCan't parse that... 8-)",
    "created_at": "2016-07-01T09:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285383",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>Replying to [comment:14 rws]:
> Replying to [comment:13 leif]:
> > Well, it seems the checks for giac (more precisely, linking to the library) in `configure` aren't sufficient.  (The [instructions](http://www-fourier.ujf-grenoble.fr/~parisse/giac_compile.html) to *link to it* on Linux -- as opposed to *building giac*, you listed giac's *build dependencies* in the thread -- explicitly list also libao-dev.)

> 
> As you say it applies to Debian only---here on OpenSuSE libao is sufficient and there should be no reason why Pynac would need something that isn't already there after `sage -i giac` has finished.


Yep, (vanilla) giac's configure instructions do not mention libao either.  But if building pynac *may* fail on !Debian/Ubuntu (hardly anyone uses these distros, I know), pynac's configure should catch that case (either by disabling giac, or giving an appropriate error message).

I'd say solve it upstream if you find the time, and we can eventually revert the changes here with one of the next releases of pynac.

Or we could make Sage's giac package a standard one.

\\

> If `-lao` is needed by Sage then already then, isn't it?


Can't parse that... 8-)



---

archive/issue_comments_285384.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-02T08:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20916#issuecomment-285384",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_056031.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-02T08:49:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20916",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20916#event-56031"
}
```
