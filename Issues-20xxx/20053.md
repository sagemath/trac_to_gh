# Issue 20053: Singularity analysis for given singular expansions

archive/issues_019816.json:
```json
{
    "body": "Refactor `coefficients_of_generating_function` (#20056) so that the part working with one singular expansion is now a separate method of an asymptotic expansion.\n\nThis allows to perform singularity analysis also in situations where the singular expansion has been obtained by other means than the simple approach for explicit generating functions of #19944 (and follow-ups #20040 and #20056), even while #20050 is not implemented.\n\nFor now, this is a hidden method because the input will change once #20050 is done.\n\nOnce #20050 is implemented, the dual choice of output of `coefficients_of_generating_function` may be changed: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.\n\nSee #17601 for the asymptotic expansions meta ticket.\n\nCC:  @dkrenn @behackl\n\nKeywords: singularity analysis\n\nBranch/Commit: b42bb05ee54ac7f70df77470b4c4c81a1631f0b2\n\nReviewer: Benjamin Hackl\n\nAuthor: Clemens Heuberger\n\nDependencies: #20056, #19540\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20053\n\n",
    "closed_at": "2016-03-10T21:25:06Z",
    "created_at": "2016-02-14T14:49:06Z",
    "labels": [
        "component: asymptotic expansions",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Singularity analysis for given singular expansions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20053",
    "user": "https://github.com/cheuberg"
}
```
Refactor `coefficients_of_generating_function` (#20056) so that the part working with one singular expansion is now a separate method of an asymptotic expansion.

This allows to perform singularity analysis also in situations where the singular expansion has been obtained by other means than the simple approach for explicit generating functions of #19944 (and follow-ups #20040 and #20056), even while #20050 is not implemented.

For now, this is a hidden method because the input will change once #20050 is done.

Once #20050 is implemented, the dual choice of output of `coefficients_of_generating_function` may be changed: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.

See #17601 for the asymptotic expansions meta ticket.

CC:  @dkrenn @behackl

Keywords: singularity analysis

Branch/Commit: b42bb05ee54ac7f70df77470b4c4c81a1631f0b2

Reviewer: Benjamin Hackl

Author: Clemens Heuberger

Dependencies: #20056, #19540

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20053





---

archive/issue_comments_289772.json:
```json
{
    "body": "<a id='comment:2'></a>That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.\n\n---\nLast 10 new commits:",
    "created_at": "2016-02-15T11:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289772",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:2'></a>That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.

---
Last 10 new commits:



---

archive/issue_comments_289773.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-15T11:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289773",
    "user": "https://github.com/cheuberg"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_289774.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-15T11:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_289775.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:2 cheuberg]:\n> That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.\n\n\nThis extensions does not work with more than one singularity as the same singular expansion is used for each singularity.",
    "created_at": "2016-02-15T13:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289775",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:5'></a>Replying to [comment:2 cheuberg]:
> That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.


This extensions does not work with more than one singularity as the same singular expansion is used for each singularity.



---

archive/issue_comments_289776.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 dkrenn]:\n> Replying to [comment:2 cheuberg]:\n> > That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.\n\n> \n> This extensions does not work with more than one singularity as the same singular expansion is used for each singularity.\n\n\n* Option 1: forbid more than one singularity\n* Option 2: `function` could be a list of singular expansions\n* Option 3: `function` could be a dictionary, as it is the case for the output when selected.\n\nI do not like option 3, as it is not relevant once #20050 is implemented.",
    "created_at": "2016-02-15T13:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289776",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:6'></a>Replying to [comment:5 dkrenn]:
> Replying to [comment:2 cheuberg]:
> > That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.

> 
> This extensions does not work with more than one singularity as the same singular expansion is used for each singularity.


* Option 1: forbid more than one singularity
* Option 2: `function` could be a list of singular expansions
* Option 3: `function` could be a dictionary, as it is the case for the output when selected.

I do not like option 3, as it is not relevant once #20050 is implemented.



---

archive/issue_comments_289777.json:
```json
{
    "body": "<a id='comment:7'></a>A completely different option would be to have `singularity_analysis` as a method of an `AsymptoticExpansion` and to call `singular_expansion.singularity_analysis('n', precision=5)`. However, we would then have `AsymptoticRing.singularity_analysis` which ends up in that ring and `AsymptoticExpansion.singularity_analysis` which would end up somewhere else.",
    "created_at": "2016-02-15T14:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289777",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:7'></a>A completely different option would be to have `singularity_analysis` as a method of an `AsymptoticExpansion` and to call `singular_expansion.singularity_analysis('n', precision=5)`. However, we would then have `AsymptoticRing.singularity_analysis` which ends up in that ring and `AsymptoticExpansion.singularity_analysis` which would end up somewhere else.



---

archive/issue_comments_289778.json:
```json
{
    "body": "<a id='comment:8'></a>Proposal: rename `AsymptoticRing.singularity_analysis` to `AsymptoticRing.coefficients_of_generating_function` and have `AsymptoticExpansion._singularity_analysis_` and make this method public once #20050 is done.",
    "created_at": "2016-02-15T14:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289778",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:8'></a>Proposal: rename `AsymptoticRing.singularity_analysis` to `AsymptoticRing.coefficients_of_generating_function` and have `AsymptoticExpansion._singularity_analysis_` and make this method public once #20050 is done.



---

archive/issue_comments_289779.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 cheuberg]:\n> Proposal: rename `AsymptoticRing.singularity_analysis` to `AsymptoticRing.coefficients_of_generating_function` and have `AsymptoticExpansion._singularity_analysis_` and make this method public once #20050 is done.\n\n\n+1",
    "created_at": "2016-02-15T14:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289779",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:9'></a>Replying to [comment:8 cheuberg]:
> Proposal: rename `AsymptoticRing.singularity_analysis` to `AsymptoticRing.coefficients_of_generating_function` and have `AsymptoticExpansion._singularity_analysis_` and make this method public once #20050 is done.


+1



---

archive/issue_comments_289780.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-16T14:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289780",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_289781.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n-Refactor `singularity_analysis` (#19944) so that it accepts a singular expansion obtained by other means. Without #20050, this is a bit hard to explain. In the end, with #20050 implemented, the dual choice of output (with singular expansions) could be omitted: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.\n+Refactor `coefficients_of_generating_function` (#20056) so that the part working with one singular expansion is now a separate method of an asymptotic expansion.\n+\n+This allows to perform singularity analysis also in situations where the singular expansion has been obtained by other means than the simple approach for explicit generating functions of #19944 (and follow-ups #20040 and #20056), even while #20050 is not implemented.\n+\n+For now, this is a hidden method because the input will change once #20050 is done.\n+\n+Once #20050 is implemented, the dual choice of output of `coefficients_of_generating_function` may be changed: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.\n \n See #17601 for the asymptotic expansions meta ticket.\n \n``````\n",
    "created_at": "2016-02-16T14:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289781",
    "user": "https://github.com/cheuberg"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
-Refactor `singularity_analysis` (#19944) so that it accepts a singular expansion obtained by other means. Without #20050, this is a bit hard to explain. In the end, with #20050 implemented, the dual choice of output (with singular expansions) could be omitted: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.
+Refactor `coefficients_of_generating_function` (#20056) so that the part working with one singular expansion is now a separate method of an asymptotic expansion.
+
+This allows to perform singularity analysis also in situations where the singular expansion has been obtained by other means than the simple approach for explicit generating functions of #19944 (and follow-ups #20040 and #20056), even while #20050 is not implemented.
+
+For now, this is a hidden method because the input will change once #20050 is done.
+
+Once #20050 is implemented, the dual choice of output of `coefficients_of_generating_function` may be changed: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.
 
 See #17601 for the asymptotic expansions meta ticket.
 
``````




---

archive/issue_comments_289782.json:
```json
{
    "body": "<a id='comment:11'></a>This is now a complete rewrite following yesterday's discussions and #20056.\n\nI now think that this is basically the point that we can reach without #20050, so this now awaits your review.",
    "created_at": "2016-02-16T14:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289782",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:11'></a>This is now a complete rewrite following yesterday's discussions and #20056.

I now think that this is basically the point that we can reach without #20050, so this now awaits your review.



---

archive/issue_comments_289783.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-02-16T16:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_289784.json:
```json
{
    "body": "<a id='comment:15'></a>I've reviewed this implementation, and I only have one comment:\n\nCould you revise the docstring of `AsymptoticExpansion._singularity_analysis_`? Because \n\n1. `var` can also be the generator of an asymptotic ring, \n2. `zeta` is the location of the singularity, and \n3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.\n\nDo we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.\n\nOther than that, `positive_review` form my side.",
    "created_at": "2016-03-08T18:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289784",
    "user": "https://github.com/behackl"
}
```

<a id='comment:15'></a>I've reviewed this implementation, and I only have one comment:

Could you revise the docstring of `AsymptoticExpansion._singularity_analysis_`? Because 

1. `var` can also be the generator of an asymptotic ring, 
2. `zeta` is the location of the singularity, and 
3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.

Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.

Other than that, `positive_review` form my side.



---

archive/issue_comments_289785.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-09T16:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289785",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_289786.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 behackl]:\n> 1. `var` can also be the generator of an asymptotic ring, \n\n\ndocumented and doctested\n\n> 2. `zeta` is the location of the singularity, and \n  \ndone.\n\n> 3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.\n> \n> Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.\n\n\nWe cannot directly use the precision of this element, because we have no elegant means of defining the precision of an element (we will not introspect the group). Thus IMHO the only sensible default is the default precision of the parent of this element. Thus the behaviour is now changed.\n\nThe method `coefficients_of_generating_function` does not handle the precision, either, but that could be another ticket, if you want to open one. In any case, this is unrelated to this method here.",
    "created_at": "2016-03-09T16:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289786",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:17'></a>Replying to [comment:15 behackl]:
> 1. `var` can also be the generator of an asymptotic ring, 


documented and doctested

> 2. `zeta` is the location of the singularity, and 
  
done.

> 3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.
> 
> Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.


We cannot directly use the precision of this element, because we have no elegant means of defining the precision of an element (we will not introspect the group). Thus IMHO the only sensible default is the default precision of the parent of this element. Thus the behaviour is now changed.

The method `coefficients_of_generating_function` does not handle the precision, either, but that could be another ticket, if you want to open one. In any case, this is unrelated to this method here.



---

archive/issue_comments_289787.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 cheuberg]:\n> Replying to [comment:15 behackl]:\n> > 1. `var` can also be the generator of an asymptotic ring, \n  \n> \n> documented and doctested\n> \n> > 2. `zeta` is the location of the singularity, and \n  \n> done.\n> \n> > 3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.\n> > \n> > Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.\n\n> \n> We cannot directly use the precision of this element, because we have no elegant means of defining the precision of an element (we will not introspect the group). Thus IMHO the only sensible default is the default precision of the parent of this element. Thus the behaviour is now changed.\n\n\nThat is what I originally meant, thank you.\n\n> \n> The method `coefficients_of_generating_function` does not handle the precision, either, but that could be another ticket, if you want to open one. In any case, this is unrelated to this method here.\n\n\nYes, this would certainly be a new ticket, and I think that this is definitely worth opening one.\n\nIn any case: your changes look good to me, and I'll just wait for the patchbot before I set this to `positive_review`. Thank you!",
    "created_at": "2016-03-09T16:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289787",
    "user": "https://github.com/behackl"
}
```

<a id='comment:18'></a>Replying to [comment:17 cheuberg]:
> Replying to [comment:15 behackl]:
> > 1. `var` can also be the generator of an asymptotic ring, 
  
> 
> documented and doctested
> 
> > 2. `zeta` is the location of the singularity, and 
  
> done.
> 
> > 3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.
> > 
> > Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.

> 
> We cannot directly use the precision of this element, because we have no elegant means of defining the precision of an element (we will not introspect the group). Thus IMHO the only sensible default is the default precision of the parent of this element. Thus the behaviour is now changed.


That is what I originally meant, thank you.

> 
> The method `coefficients_of_generating_function` does not handle the precision, either, but that could be another ticket, if you want to open one. In any case, this is unrelated to this method here.


Yes, this would certainly be a new ticket, and I think that this is definitely worth opening one.

In any case: your changes look good to me, and I'll just wait for the patchbot before I set this to `positive_review`. Thank you!



---

archive/issue_comments_289788.json:
```json
{
    "body": "<a id='comment:19'></a>The patchbot is happy, and so am I. :-)",
    "created_at": "2016-03-09T19:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289788",
    "user": "https://github.com/behackl"
}
```

<a id='comment:19'></a>The patchbot is happy, and so am I. :-)



---

archive/issue_comments_289789.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-09T19:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289789",
    "user": "https://github.com/behackl"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_289790.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-03-09T22:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289790",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_289791.json:
```json
{
    "body": "<a id='comment:20'></a>Reviewer name is missing",
    "created_at": "2016-03-09T22:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289791",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:20'></a>Reviewer name is missing



---

archive/issue_comments_289792.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-03-10T05:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289792",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_054636.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-10T21:25:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20053#event-54636"
}
```



---

archive/issue_comments_289793.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-10T21:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20053",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20053#issuecomment-289793",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
