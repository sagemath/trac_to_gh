# Issue 20141: Cysignals tests fail

archive/issues_019904.json:
```json
{
    "body": "Unter certain conditions cysignal tests fail (building with `SAGE_CHECK=yes`). This is on the buildbot so directories are the same as always. Possibly triggered by a full rebuild:\n\n```\n[...]\npython -m doctest src/cysignals/*.pyx\ncd example && python setup.py build\nsys:1: RuntimeWarning: not adding directory '' to sys.path since it's writable by an untrusted group.\nUntrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory\nCompiling cysignals_example.pyx because it changed.\n[1/1] Cythonizing cysignals_example.pyx\nrunning build\nrunning build_ext\nbuilding 'cysignals_example' extension\ncreating build\ncreating build/temp.macosx-10.9-x86_64-2.7\ngcc -fno-strict-aliasing -I/Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/python2-2.7.10.p0/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.c -o build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o\ncreating build/lib.macosx-10.9-x86_64-2.7\ngcc -bundle -undefined dynamic_lookup -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o -L/Users/buildslave-sage/slave/sage_git/build/local/lib -o build/lib.macosx-10.9-x86_64-2.7/cysignals_example.so -lpari -Ddummy\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 494, in tests.pyx\nFailed example:\n    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS\nExpected:\n    ------------------------------------------------------------------------\n    ...\n    ------------------------------------------------------------------------\n    <BLANKLINE>\nGot:\n    sys:1: RuntimeWarning: not adding directory '' to sys.path since it's writable by an untrusted group.\n    Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory\n    ------------------------------------------------------------------------\n    0   signals.so                          0x0000000108971885 print_backtrace + 37\n    ------------------------------------------------------------------------\n    <BLANKLINE>\n**********************************************************************\n```\nPS: as always the cysignals.log is useless since it has many different compilations mashed together and there is no indication where it happened the first time.\n\n**Upstream bug**: https://github.com/sagemath/cysignals/issues/26\n\n**Tarball**: https://github.com/sagemath/cysignals/releases/download/1.0.1/cysignals-1.0.1.tar.bz2\n\nCC:  @jdemeyer @videlec @kiwifb @malb\n\nBranch/Commit: a1a7c69e904b5c77bc13070066e8442d9d30cf9a\n\nUpstream: Completely fixed; Fix reported upstream\n\nReviewer: Martin Albrecht\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20141\n\n",
    "closed_at": "2016-03-02T08:27:46Z",
    "created_at": "2016-02-29T19:49:38Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Cysignals tests fail",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20141",
    "user": "https://github.com/vbraun"
}
```
Unter certain conditions cysignal tests fail (building with `SAGE_CHECK=yes`). This is on the buildbot so directories are the same as always. Possibly triggered by a full rebuild:

```
[...]
python -m doctest src/cysignals/*.pyx
cd example && python setup.py build
sys:1: RuntimeWarning: not adding directory '' to sys.path since it's writable by an untrusted group.
Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory
Compiling cysignals_example.pyx because it changed.
[1/1] Cythonizing cysignals_example.pyx
running build
running build_ext
building 'cysignals_example' extension
creating build
creating build/temp.macosx-10.9-x86_64-2.7
gcc -fno-strict-aliasing -I/Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/python2-2.7.10.p0/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.c -o build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o
creating build/lib.macosx-10.9-x86_64-2.7
gcc -bundle -undefined dynamic_lookup -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o -L/Users/buildslave-sage/slave/sage_git/build/local/lib -o build/lib.macosx-10.9-x86_64-2.7/cysignals_example.so -lpari -Ddummy
**********************************************************************
File "src/cysignals/tests.pyx", line 494, in tests.pyx
Failed example:
    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS
Expected:
    ------------------------------------------------------------------------
    ...
    ------------------------------------------------------------------------
    <BLANKLINE>
Got:
    sys:1: RuntimeWarning: not adding directory '' to sys.path since it's writable by an untrusted group.
    Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory
    ------------------------------------------------------------------------
    0   signals.so                          0x0000000108971885 print_backtrace + 37
    ------------------------------------------------------------------------
    <BLANKLINE>
**********************************************************************
```
PS: as always the cysignals.log is useless since it has many different compilations mashed together and there is no indication where it happened the first time.

**Upstream bug**: https://github.com/sagemath/cysignals/issues/26

**Tarball**: https://github.com/sagemath/cysignals/releases/download/1.0.1/cysignals-1.0.1.tar.bz2

CC:  @jdemeyer @videlec @kiwifb @malb

Branch/Commit: a1a7c69e904b5c77bc13070066e8442d9d30cf9a

Upstream: Completely fixed; Fix reported upstream

Reviewer: Martin Albrecht

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20141





---

archive/issue_comments_364192.json:
```json
{
    "body": "<a id='comment:1'></a>Doesn't that message come from one of the patches sage is adding to python? It looks like the folder where the test is run is at fault.",
    "created_at": "2016-02-29T20:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364192",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>Doesn't that message come from one of the patches sage is adding to python? It looks like the folder where the test is run is at fault.



---

archive/issue_comments_364193.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2016-02-29T21:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364193",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_364194.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2016-02-29T21:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364194",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "N/A" to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_364195.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -35,3 +35,5 @@\n **********************************************************************\n ```\n PS: as always the cysignals.log is useless since it has many different compilations mashed together and there is no indication where it happened the first time.\n+\n+**Upstream bug**: https://github.com/sagemath/cysignals/issues/26\n``````\n",
    "created_at": "2016-02-29T21:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364195",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -35,3 +35,5 @@
 **********************************************************************
 ```
 PS: as always the cysignals.log is useless since it has many different compilations mashed together and there is no indication where it happened the first time.
+
+**Upstream bug**: https://github.com/sagemath/cysignals/issues/26
``````




---

archive/issue_comments_364196.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -37,3 +37,5 @@\n PS: as always the cysignals.log is useless since it has many different compilations mashed together and there is no indication where it happened the first time.\n \n **Upstream bug**: https://github.com/sagemath/cysignals/issues/26\n+\n+**Tarball**: https://github.com/sagemath/cysignals/releases/download/1.0.1/cysignals-1.0.1.tar.bz2\n``````\n",
    "created_at": "2016-03-01T10:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364196",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -37,3 +37,5 @@
 PS: as always the cysignals.log is useless since it has many different compilations mashed together and there is no indication where it happened the first time.
 
 **Upstream bug**: https://github.com/sagemath/cysignals/issues/26
+
+**Tarball**: https://github.com/sagemath/cysignals/releases/download/1.0.1/cysignals-1.0.1.tar.bz2
``````




---

archive/issue_comments_364197.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2016-03-01T10:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364197",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_364198.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Completely fixed; Fix reported upstream\"",
    "created_at": "2016-03-01T10:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364198",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Completely fixed; Fix reported upstream"



---

archive/issue_comments_364199.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/cysignals_tests_fail\"",
    "created_at": "2016-03-01T10:42:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364199",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/cysignals_tests_fail"



---

archive/issue_comments_364200.json:
```json
{
    "body": "Changing commit from \"\" to \"a1a7c69e904b5c77bc13070066e8442d9d30cf9a\"",
    "created_at": "2016-03-01T10:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364200",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "a1a7c69e904b5c77bc13070066e8442d9d30cf9a"



---

archive/issue_comments_364201.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-01T10:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364201",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_364202.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2016-03-01T10:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364202",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_comments_364203.json:
```json
{
    "body": "<a id='comment:7'></a>This looks good to me.",
    "created_at": "2016-03-01T11:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364203",
    "user": "https://github.com/malb"
}
```

<a id='comment:7'></a>This looks good to me.



---

archive/issue_comments_364204.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Martin Albrecht\"",
    "created_at": "2016-03-01T11:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364204",
    "user": "https://github.com/malb"
}
```

Changing reviewer from "" to "Martin Albrecht"



---

archive/issue_comments_364205.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-01T11:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364205",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_054779.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-02T08:27:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20141#event-54779"
}
```



---

archive/issue_comments_364206.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/cysignals_tests_fail\" to \"a1a7c69e904b5c77bc13070066e8442d9d30cf9a\"",
    "created_at": "2016-03-02T08:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364206",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/cysignals_tests_fail" to "a1a7c69e904b5c77bc13070066e8442d9d30cf9a"



---

archive/issue_comments_364207.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-02T08:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20141#issuecomment-364207",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
