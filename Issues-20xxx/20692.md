# Issue 20692: Add sage-apply-patches helper script for use in spkg-install scripts

archive/issues_020455.json:
```json
{
    "assignees": [],
    "body": "This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.\n\nI'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.\n\nBranch: **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Erik Bray**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/20692_\n\n",
    "closed_at": "2016-11-30T19:36:11Z",
    "created_at": "2016-05-27T11:33:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add sage-apply-patches helper script for use in spkg-install scripts",
    "type": "issue",
    "updated_at": "2016-12-02T10:37:29Z",
    "url": "https://github.com/sagemath/sage/issues/20692",
    "user": "https://github.com/embray"
}
```
This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.

I'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.

Branch: **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)**

Reviewer: **Jeroen Demeyer**

Author: **Erik Bray**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/20692_





---

archive/issue_events_288753.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-05-27T11:33:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288753"
}
```



---

archive/issue_events_288754.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-05-27T11:33:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288754"
}
```



---

archive/issue_events_288755.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-05-27T11:33:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288755"
}
```



---

archive/issue_events_288756.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-05-27T11:33:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288756"
}
```



---

archive/issue_events_288757.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-05-27T11:33:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288757"
}
```



---

archive/issue_comments_299309.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nSeems I have to undust my `bash` scripting skills...\n\nWhy is it an error if there are no patches to apply? I would remove\n\n```\nif [[ -r \"${patches[0]}\" ]]; then\nelse\n    >&2 echo \"No patch files found in $patchdir\"\n    exit 1\nfi\n```\nand just apply all patches, which may be the empty set.",
    "created_at": "2016-05-27T15:06:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299309",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Seems I have to undust my `bash` scripting skills...

Why is it an error if there are no patches to apply? I would remove

```
if [[ -r "${patches[0]}" ]]; then
else
    >&2 echo "No patch files found in $patchdir"
    exit 1
fi
```
and just apply all patches, which may be the empty set.



---

archive/issue_comments_299310.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nA minor thing: I would prefer to remove the `-pNUM` option. It's better if we consistently use `-p1` in all cases. That's also how `git` generates its patches.",
    "created_at": "2016-05-27T15:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299310",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

A minor thing: I would prefer to remove the `-pNUM` option. It's better if we consistently use `-p1` in all cases. That's also how `git` generates its patches.



---

archive/issue_comments_299311.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI don't get this:\n\n```\nand it is assumed that the patches are being applied from\nthe root of the package source\n```",
    "created_at": "2016-05-27T15:10:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299311",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

I don't get this:

```
and it is assumed that the patches are being applied from
the root of the package source
```



---

archive/issue_comments_299312.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWhy not always use the option `--no-backup-if-mismatch` instead of only for PARI?",
    "created_at": "2016-05-27T15:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299312",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Why not always use the option `--no-backup-if-mismatch` instead of only for PARI?



---

archive/issue_events_288758.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-05-27T15:12:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288758"
}
```



---

archive/issue_events_288759.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-05-27T15:12:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288759"
}
```



---

archive/issue_comments_299313.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2016-05-27T15:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299313",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_299314.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFollowing up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.",
    "created_at": "2016-05-27T15:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299314",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Following up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.



---

archive/issue_comments_299315.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment:7):\n> Following up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.\n\nI guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.  Granted, when this was inline in every script it didn't require a process creation (more on that in a followup).  I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.  If they forget to do that, well, then they clearly didn't test that their patch applies at build time :)\n\nAs for it being an error when no patches are found, I have no strong feelings.  I liked that it was explicit, but it could just as will either print a message, or go completely silent.\n\n> A minor thing: I would prefer to remove the -pNUM option. It's better if we consistently use -p1 in all cases. That's also how git generates its patches.\n\nThat's fine by me.  I think there was one case, maybe two where it was needed, but it would be just as easy to update those patch files and keep things consistent throughout.\n\n> Why not always use the option `--no-backup-if-mismatch` instead of only for PARI?\n\nI figured maybe there was a reason to prefer to keep backups in general.  Would be fine with me to apply in general though.  Previously there was one other case where additional arguments had to be passed to `patch`, but then I realized that package had no patches anymore.\n\n> I don't get this:\n\n   and it is assumed that the patches are being applied from\n   the root of the package source\n\nMeaning the patches are applied after `cd`-ing into the upstream source, hence the default path to search for patches being `../patches`.  No reason it has to be that way but it was the most minimal change from the existing code.",
    "created_at": "2016-05-27T16:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299315",
    "user": "https://github.com/embray"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment:7):
> Following up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.

I guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.  Granted, when this was inline in every script it didn't require a process creation (more on that in a followup).  I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.  If they forget to do that, well, then they clearly didn't test that their patch applies at build time :)

As for it being an error when no patches are found, I have no strong feelings.  I liked that it was explicit, but it could just as will either print a message, or go completely silent.

> A minor thing: I would prefer to remove the -pNUM option. It's better if we consistently use -p1 in all cases. That's also how git generates its patches.

That's fine by me.  I think there was one case, maybe two where it was needed, but it would be just as easy to update those patch files and keep things consistent throughout.

> Why not always use the option `--no-backup-if-mismatch` instead of only for PARI?

I figured maybe there was a reason to prefer to keep backups in general.  Would be fine with me to apply in general though.  Previously there was one other case where additional arguments had to be passed to `patch`, but then I realized that package had no patches anymore.

> I don't get this:

   and it is assumed that the patches are being applied from
   the root of the package source

Meaning the patches are applied after `cd`-ing into the upstream source, hence the default path to search for patches being `../patches`.  No reason it has to be that way but it was the most minimal change from the existing code.



---

archive/issue_comments_299316.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAn alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.\n\nI'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)",
    "created_at": "2016-05-27T16:06:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299316",
    "user": "https://github.com/embray"
}
```

<div id="comment:9" align="right">comment:9</div>

An alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.

I'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)



---

archive/issue_comments_299317.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@embray](#comment:8):\n> I guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.\n\nHow much slower is it really? Surely it's negligible compared to the time to build Sage.\n\n> I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.\n\nThat's really annoying. Please keep the call to `spkg-apply-patches` even when there are no patches.",
    "created_at": "2016-05-28T20:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299317",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@embray](#comment:8):
> I guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.

How much slower is it really? Surely it's negligible compared to the time to build Sage.

> I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.

That's really annoying. Please keep the call to `spkg-apply-patches` even when there are no patches.



---

archive/issue_comments_299318.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nIf you feel that strongly about it. I think it's pointless.  Especially considering that it was already inconsistent.  Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)",
    "created_at": "2016-05-30T08:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299318",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

If you feel that strongly about it. I think it's pointless.  Especially considering that it was already inconsistent.  Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)



---

archive/issue_comments_299319.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@embray](#comment:11):\n> Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)\n\nWell, that's essentially what I wrote in [comment:7].\n\nAnd yes, I feel strongly about because I don't want to always add/remove the call to `spkg-apply-patches` depending on whether or not the number of patches to apply equals zero.\n\nDetail: for consistency, I would prefer the script to be called `spkg-apply-patches` instead of `sage-apply-patches`.",
    "created_at": "2016-05-30T09:10:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299319",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@embray](#comment:11):
> Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)

Well, that's essentially what I wrote in [comment:7].

And yes, I feel strongly about because I don't want to always add/remove the call to `spkg-apply-patches` depending on whether or not the number of patches to apply equals zero.

Detail: for consistency, I would prefer the script to be called `spkg-apply-patches` instead of `sage-apply-patches`.



---

archive/issue_comments_299320.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWhat would that be consistent with?  Every other script in `build/bin` starts with `sage-`.  In fact very nearly every, if not every executable installed by sage starts with `sage-` which is good and consistent, and completely free of potential for overlap with anything else.",
    "created_at": "2016-05-30T09:40:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299320",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">comment:13</div>

What would that be consistent with?  Every other script in `build/bin` starts with `sage-`.  In fact very nearly every, if not every executable installed by sage starts with `sage-` which is good and consistent, and completely free of potential for overlap with anything else.



---

archive/issue_comments_299321.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nConsistent with `spkg-install`, `spkg-check`, `spkg-src`. Basically, anything related to building Sage packages.",
    "created_at": "2016-05-30T09:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299321",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Consistent with `spkg-install`, `spkg-check`, `spkg-src`. Basically, anything related to building Sage packages.



---

archive/issue_comments_299322.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThose scripts are only ever in spkg directories though and are specific to each spkg. They are not in bin/ paths added to `$PATH`.  This is a helper script used in installation like the rest in build/bin, all of which (sensibly) start with `sage-`.\n\nI'm probably also going to add a `sage-spkg-python` (or something, I don't care what it's called) that will be exec'd by the `spkg-install` for most Python packages since the vast majority of them are cookie-cutter anyways (especially if you also want to have every one of them calling `whatever-apply-patches` by default).  This would be to provide a solution for #16897 which also calls out this fact.  (I think it's important for every package to have a file called `spkg-install`, but it's fine if its sole function is to call some other generic script).",
    "created_at": "2016-05-30T09:53:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299322",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

Those scripts are only ever in spkg directories though and are specific to each spkg. They are not in bin/ paths added to `$PATH`.  This is a helper script used in installation like the rest in build/bin, all of which (sensibly) start with `sage-`.

I'm probably also going to add a `sage-spkg-python` (or something, I don't care what it's called) that will be exec'd by the `spkg-install` for most Python packages since the vast majority of them are cookie-cutter anyways (especially if you also want to have every one of them calling `whatever-apply-patches` by default).  This would be to provide a solution for #16897 which also calls out this fact.  (I think it's important for every package to have a file called `spkg-install`, but it's fine if its sole function is to call some other generic script).



---

archive/issue_comments_299323.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nFor the record: I just wanted to comment over the name, I'm not going to reject this patch over such bikeshedding.",
    "created_at": "2016-05-30T09:56:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299323",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

For the record: I just wanted to comment over the name, I'm not going to reject this patch over such bikeshedding.



---

archive/issue_comments_299324.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nWhile I am OK with the stuff as it is, I have a bold suggestion for further work: may be it should be put in `sage-spkg` and always be run. We already leave it when there is no patches anymore. What would be the overhead of always running it?",
    "created_at": "2016-05-30T10:31:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299324",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

While I am OK with the stuff as it is, I have a bold suggestion for further work: may be it should be put in `sage-spkg` and always be run. We already leave it when there is no patches anymore. What would be the overhead of always running it?



---

archive/issue_comments_299325.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@kiwifb](#comment:17):\n> may be it should be put in `sage-spkg` and always be run.\n\nNot easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.",
    "created_at": "2016-05-30T10:33:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299325",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@kiwifb](#comment:17):
> may be it should be put in `sage-spkg` and always be run.

Not easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.



---

archive/issue_comments_299326.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@jdemeyer](#comment:18):\n> Replying to [@kiwifb](#comment:17):\n> > may be it should be put in `sage-spkg` and always be run.\n\n> \n> Not easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.\n\nTricky. I didn't remember we had those outliers.",
    "created_at": "2016-05-30T11:06:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299326",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@jdemeyer](#comment:18):
> Replying to [@kiwifb](#comment:17):
> > may be it should be put in `sage-spkg` and always be run.

> 
> Not easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.

Tricky. I didn't remember we had those outliers.



---

archive/issue_comments_299327.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nLet me think about that a bit more though.  If it were done in `sage-spkg` it would do away with the need for a separate script entirely, and would cut down that much more on the duplication which is what I want.\n\nOne possibility would be to rewrite the patch files to include the source directory in the paths, but that could be annoying and error-prone.  The other would be to standardize `src`.  I knew there were outliers but I never looked into why.  Is there really no way those could be changed?",
    "created_at": "2016-05-30T11:18:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299327",
    "user": "https://github.com/embray"
}
```

<div id="comment:20" align="right">comment:20</div>

Let me think about that a bit more though.  If it were done in `sage-spkg` it would do away with the need for a separate script entirely, and would cut down that much more on the duplication which is what I want.

One possibility would be to rewrite the patch files to include the source directory in the paths, but that could be annoying and error-prone.  The other would be to standardize `src`.  I knew there were outliers but I never looked into why.  Is there really no way those could be changed?



---

archive/issue_comments_299328.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n`sage-spkg` contains the following:\n\n```\n     # Strip file extension from the archive file and hope (as per\n     # automake standards) that this is the same as the directory name\n     # inside; move the directory to \"src\".  (This goes wrong for\n     # upstream package archives that have been renamed to appease some\n     # other Sage script, such as \"latte-int\", whose archive is renamed\n     # to \"latte_int\".)\n     mv \"$(echo \"$PKG_NAME_UPSTREAM\" | sed 's/\\.zip$//g;s/\\.tgz$//g;s/\\.tar\\.    gz$//g;s/\\.tar\\.xz$//g;s/\\.tar\\.lz$//g;s/\\.tar\\.bz2$//g;s/\\.tar$//g')\"* src\n```\n\nMaybe this should be redone.  There are a number of ways it might be done differently.  One possibility is that it could be made `sage-uncompress-spkg`'s job to always extract to `src`.  It could handle checking for the top-level directory in the archive and extracting it instead as `src`.  For those handful of packages (are there any? I suspect probably...) that don't have a top-level directory it would create `src` and extract all the archive contents into it.",
    "created_at": "2016-05-30T11:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299328",
    "user": "https://github.com/embray"
}
```

<div id="comment:21" align="right">comment:21</div>

`sage-spkg` contains the following:

```
     # Strip file extension from the archive file and hope (as per
     # automake standards) that this is the same as the directory name
     # inside; move the directory to "src".  (This goes wrong for
     # upstream package archives that have been renamed to appease some
     # other Sage script, such as "latte-int", whose archive is renamed
     # to "latte_int".)
     mv "$(echo "$PKG_NAME_UPSTREAM" | sed 's/\.zip$//g;s/\.tgz$//g;s/\.tar\.    gz$//g;s/\.tar\.xz$//g;s/\.tar\.lz$//g;s/\.tar\.bz2$//g;s/\.tar$//g')"* src
```

Maybe this should be redone.  There are a number of ways it might be done differently.  One possibility is that it could be made `sage-uncompress-spkg`'s job to always extract to `src`.  It could handle checking for the top-level directory in the archive and extracting it instead as `src`.  For those handful of packages (are there any? I suspect probably...) that don't have a top-level directory it would create `src` and extract all the archive contents into it.



---

archive/issue_comments_299329.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThis is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?",
    "created_at": "2016-05-30T11:38:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299329",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

This is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?



---

archive/issue_comments_299330.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@kiwifb](#comment:22):\n> This is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?\n\nI was going to suggest the same.  Though I might address the subject of extracting to a standard location before coming back to and reworking this ticket.  I've gone through the list of spkgs that *don't* wind up with their sources in `src` and in each case there's no good reason really, except that the hack above doesn't work for it (or the last time the file was touched predates that hack).\n\nI think a patch to `sage-uncompress-spkg` would be a good idea and I'll put something to that effect in a separate ticket.",
    "created_at": "2016-05-30T11:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299330",
    "user": "https://github.com/embray"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@kiwifb](#comment:22):
> This is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?

I was going to suggest the same.  Though I might address the subject of extracting to a standard location before coming back to and reworking this ticket.  I've gone through the list of spkgs that *don't* wind up with their sources in `src` and in each case there's no good reason really, except that the hack above doesn't work for it (or the last time the file was touched predates that hack).

I think a patch to `sage-uncompress-spkg` would be a good idea and I'll put something to that effect in a separate ticket.



---

archive/issue_comments_299331.json:
```json
{
    "body": "Dependencies: **#20721**",
    "created_at": "2016-05-30T17:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299331",
    "user": "https://github.com/embray"
}
```

Dependencies: **#20721**



---

archive/issue_comments_299332.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI think #20721, or something like it, should be a prerequisite to this ticket (or any like it depending on how much I end up reworking this).",
    "created_at": "2016-05-30T17:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299332",
    "user": "https://github.com/embray"
}
```

<div id="comment:24" align="right">comment:24</div>

I think #20721, or something like it, should be a prerequisite to this ticket (or any like it depending on how much I end up reworking this).



---

archive/issue_comments_299333.json:
```json
{
    "body": "Changed dependencies from **#20721** to **#20721 20837**",
    "created_at": "2016-06-16T15:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299333",
    "user": "https://github.com/embray"
}
```

Changed dependencies from **#20721** to **#20721 20837**



---

archive/issue_comments_299334.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n#20837 cleans up the handful of spkgs that don't conform to a format where calling `patch -p1 < ../patches/*.patch` should work from within the source root.\n\nThen we can move forward on appling `sage-apply-patches` by default on all spkgs.",
    "created_at": "2016-06-16T15:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299334",
    "user": "https://github.com/embray"
}
```

<div id="comment:25" align="right">comment:25</div>

#20837 cleans up the handful of spkgs that don't conform to a format where calling `patch -p1 < ../patches/*.patch` should work from within the source root.

Then we can move forward on appling `sage-apply-patches` by default on all spkgs.



---

archive/issue_comments_299335.json:
```json
{
    "body": "Changed dependencies from **#20721 20837** to **#20721, #20837**",
    "created_at": "2016-06-25T05:56:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299335",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#20721 20837** to **#20721, #20837**



---

archive/issue_comments_299336.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nWhat remains to be done for this ticket?\nWould be good to use this for #20892.",
    "created_at": "2016-06-28T04:02:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299336",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

What remains to be done for this ticket?
Would be good to use this for #20892.



---

archive/issue_comments_299337.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nMainly: `sage-apply-patches` needs to be changed to fail quietly if no patches are found (I think I already did this; might still be on a local branch)\n\nThen remove all, or almost all calls to `sage-apply-patches` from individual `spkg-install` scripts, and instead call it on all packages as a standard step in `sage-spkg`.\n\nI can get this done soon.",
    "created_at": "2016-06-28T08:49:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299337",
    "user": "https://github.com/embray"
}
```

<div id="comment:28" align="right">comment:28</div>

Mainly: `sage-apply-patches` needs to be changed to fail quietly if no patches are found (I think I already did this; might still be on a local branch)

Then remove all, or almost all calls to `sage-apply-patches` from individual `spkg-install` scripts, and instead call it on all packages as a standard step in `sage-spkg`.

I can get this done soon.



---

archive/issue_comments_299338.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nStrange, I thought I rebased this.  Maybe I just forgot to push.",
    "created_at": "2016-07-04T09:32:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299338",
    "user": "https://github.com/embray"
}
```

<div id="comment:29" align="right">comment:29</div>

Strange, I thought I rebased this.  Maybe I just forgot to push.



---

archive/issue_comments_299339.json:
```json
{
    "body": "Changed dependencies from **#20721, #20837** to **#20721, #20837, #20933**",
    "created_at": "2016-07-04T10:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299339",
    "user": "https://github.com/embray"
}
```

Changed dependencies from **#20721, #20837** to **#20721, #20837, #20933**



---

archive/issue_comments_299340.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nTurns out the patches for MathJax needed a bit more tweaking, as they were not uniform with the other packages.",
    "created_at": "2016-07-04T10:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299340",
    "user": "https://github.com/embray"
}
```

<div id="comment:30" align="right">comment:30</div>

Turns out the patches for MathJax needed a bit more tweaking, as they were not uniform with the other packages.



---

archive/issue_comments_299341.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nShould there be a way to control the order in which patches are applied?\nFor example Debian uses a file \"series\" that controls this. See for example #20901, for which I'd like to lift the patches from debian.",
    "created_at": "2016-07-07T05:10:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299341",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Should there be a way to control the order in which patches are applied?
For example Debian uses a file "series" that controls this. See for example #20901, for which I'd like to lift the patches from debian.



---

archive/issue_comments_299342.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nCould we just prefix the patch filenames with numbers?",
    "created_at": "2016-07-07T09:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299342",
    "user": "https://github.com/embray"
}
```

<div id="comment:32" align="right">comment:32</div>

Could we just prefix the patch filenames with numbers?



---

archive/issue_comments_299343.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@embray](#comment:32):\n> Could we just prefix the patch filenames with numbers?\n\n+1 that's the easiest way to get order.",
    "created_at": "2016-07-07T10:01:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299343",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@embray](#comment:32):
> Could we just prefix the patch filenames with numbers?

+1 that's the easiest way to get order.



---

archive/issue_comments_299344.json:
```json
{
    "body": "Changed commit from **[`29bd199`](https://github.com/sagemath/sagetrac-mirror/commit/29bd19903b16289c178e9468194318e5d1017dad)** to **[`2c1ec4f`](https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717)**",
    "created_at": "2016-08-16T13:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299344",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`29bd199`](https://github.com/sagemath/sagetrac-mirror/commit/29bd19903b16289c178e9468194318e5d1017dad)** to **[`2c1ec4f`](https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717)**



---

archive/issue_comments_299345.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/589144877739dd0c9b491ca210d458e707af8151\"><code>5891448</code></a></td><td><code>Clean up patching of rubiks</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18139d85c47cd9c6a6d1ca14020f34c00cfa4e0d\"><code>18139d8</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a46a816ed30a3da4952b6094599836e4c3ce3398\"><code>a46a816</code></a></td><td><code>Fix accidental duplication of patch_subdir.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54589594446ca0571cebc67dd7d4dc15c4c1a693\"><code>5458959</code></a></td><td><code>Forgot to change this to loop over the full list when I made $patches into a list.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39645a98d1271dc416a9b3eaf67ae90e7b36f196\"><code>39645a9</code></a></td><td><code>Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78a151b3fa1d2ef100589c488987dc3e240e2e37\"><code>78a151b</code></a></td><td><code>None of these packages currently have patches to apply.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d15fb437a2a59ff3896057048514bd2a6a991b69\"><code>d15fb43</code></a></td><td><code>Add license notice.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca832e3395c923302f4b82c32770b9eed79c2742\"><code>ca832e3</code></a></td><td><code>Warn but don't fail if there are no patches to apply</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717\"><code>2c1ec4f</code></a></td><td><code>Apply sage-apply-patches standard on all packages during spkg-install</code></td></tr></table>\n",
    "created_at": "2016-08-16T13:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299345",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/589144877739dd0c9b491ca210d458e707af8151"><code>5891448</code></a></td><td><code>Clean up patching of rubiks</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18139d85c47cd9c6a6d1ca14020f34c00cfa4e0d"><code>18139d8</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a46a816ed30a3da4952b6094599836e4c3ce3398"><code>a46a816</code></a></td><td><code>Fix accidental duplication of patch_subdir.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54589594446ca0571cebc67dd7d4dc15c4c1a693"><code>5458959</code></a></td><td><code>Forgot to change this to loop over the full list when I made $patches into a list.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39645a98d1271dc416a9b3eaf67ae90e7b36f196"><code>39645a9</code></a></td><td><code>Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78a151b3fa1d2ef100589c488987dc3e240e2e37"><code>78a151b</code></a></td><td><code>None of these packages currently have patches to apply.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d15fb437a2a59ff3896057048514bd2a6a991b69"><code>d15fb43</code></a></td><td><code>Add license notice.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca832e3395c923302f4b82c32770b9eed79c2742"><code>ca832e3</code></a></td><td><code>Warn but don't fail if there are no patches to apply</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717"><code>2c1ec4f</code></a></td><td><code>Apply sage-apply-patches standard on all packages during spkg-install</code></td></tr></table>




---

archive/issue_comments_299346.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nLast I poked at this not all the dependencies were satisfied.  Now they are, and I have rebased the branch again on develop.\n\nJust did a test build of this on Linux and everything (modulo optional packages which were not tested) works, but YMMV?",
    "created_at": "2016-08-16T13:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299346",
    "user": "https://github.com/embray"
}
```

<div id="comment:35" align="right">comment:35</div>

Last I poked at this not all the dependencies were satisfied.  Now they are, and I have rebased the branch again on develop.

Just did a test build of this on Linux and everything (modulo optional packages which were not tested) works, but YMMV?



---

archive/issue_events_288760.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-08-16T13:27:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288760"
}
```



---

archive/issue_events_288761.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-08-16T13:27:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288761"
}
```



---

archive/issue_events_288762.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-16T13:28:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288762"
}
```



---

archive/issue_events_288763.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-16T13:28:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288763"
}
```



---

archive/issue_comments_299347.json:
```json
{
    "body": "Changed dependencies from **#20721, #20837, #20933** to **#21103**",
    "created_at": "2016-08-16T13:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299347",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#20721, #20837, #20933** to **#21103**



---

archive/issue_comments_299348.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThis should still depend on #21103.",
    "created_at": "2016-08-16T13:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299348",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">comment:37</div>

This should still depend on #21103.



---

archive/issue_comments_299349.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nNote that I might look at #21103 and this ticket, but not right now since I'm working on #20218 and #21256.",
    "created_at": "2016-08-16T13:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299349",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Note that I might look at #21103 and this ticket, but not right now since I'm working on #20218 and #21256.



---

archive/issue_comments_299350.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@embray](#comment:9):\n> An alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.\n> \n> I'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)\n\n+1  (You're not the first suggesting this...)",
    "created_at": "2016-08-27T17:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299350",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@embray](#comment:9):
> An alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.
> 
> I'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)

+1  (You're not the first suggesting this...)



---

archive/issue_comments_299351.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nP.S.:  The main problem to that time was that (legacy) spkgs didn't depend on the Sage version, so we would have had to add fall-backs first (if the script to source from wasn't available).\n\nError-handling (i.e., the messages) is another thing that should be standardized.",
    "created_at": "2016-08-27T17:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299351",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:40" align="right">comment:40</div>

P.S.:  The main problem to that time was that (legacy) spkgs didn't depend on the Sage version, so we would have had to add fall-backs first (if the script to source from wasn't available).

Error-handling (i.e., the messages) is another thing that should be standardized.



---

archive/issue_comments_299352.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nSounds good--I'll revisit that later in a separate ticket.  As it is this is a step in the right direction since it just standardizes the \"apply patches (if any)\" step across all spkgs.",
    "created_at": "2016-08-29T10:47:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299352",
    "user": "https://github.com/embray"
}
```

<div id="comment:41" align="right">comment:41</div>

Sounds good--I'll revisit that later in a separate ticket.  As it is this is a step in the right direction since it just standardizes the "apply patches (if any)" step across all spkgs.



---

archive/issue_comments_299353.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6bee0dfa5f9c779c1049fe569828d4d20ca97379\"><code>6bee0df</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc0d29469dee5d2688bd3716379ac5b2223f5a62\"><code>fc0d294</code></a></td><td><code>Fix accidental duplication of patch_subdir.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e1b32cd8166303f2856afefd330389654d28a8b\"><code>0e1b32c</code></a></td><td><code>Forgot to change this to loop over the full list when I made $patches into a list.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47c69f113560cf18c9e629699474f52d584f79b9\"><code>47c69f1</code></a></td><td><code>Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2f3eaa159663dd06d33a5bb756f33f04054c466\"><code>d2f3eaa</code></a></td><td><code>None of these packages currently have patches to apply.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27cc968cd38843efe132a5981b69f8f6efca9e5f\"><code>27cc968</code></a></td><td><code>Add license notice.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c9d6d1df2f8cef29ee9e575409241ee4618e289\"><code>6c9d6d1</code></a></td><td><code>Warn but don't fail if there are no patches to apply</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/229199fc1ccde3034a9d6f58d016456423da16c5\"><code>229199f</code></a></td><td><code>Apply sage-apply-patches standard on all packages during spkg-install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b00b256eabda6e610a9a09c9eeebac5549ea8b8\"><code>5b00b25</code></a></td><td><code>Fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3\"><code>5343f3b</code></a></td><td><code>Use sage-apply-patches in more packages.</code></td></tr></table>\n",
    "created_at": "2016-10-14T12:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299353",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6bee0dfa5f9c779c1049fe569828d4d20ca97379"><code>6bee0df</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc0d29469dee5d2688bd3716379ac5b2223f5a62"><code>fc0d294</code></a></td><td><code>Fix accidental duplication of patch_subdir.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e1b32cd8166303f2856afefd330389654d28a8b"><code>0e1b32c</code></a></td><td><code>Forgot to change this to loop over the full list when I made $patches into a list.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47c69f113560cf18c9e629699474f52d584f79b9"><code>47c69f1</code></a></td><td><code>Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2f3eaa159663dd06d33a5bb756f33f04054c466"><code>d2f3eaa</code></a></td><td><code>None of these packages currently have patches to apply.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27cc968cd38843efe132a5981b69f8f6efca9e5f"><code>27cc968</code></a></td><td><code>Add license notice.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c9d6d1df2f8cef29ee9e575409241ee4618e289"><code>6c9d6d1</code></a></td><td><code>Warn but don't fail if there are no patches to apply</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/229199fc1ccde3034a9d6f58d016456423da16c5"><code>229199f</code></a></td><td><code>Apply sage-apply-patches standard on all packages during spkg-install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b00b256eabda6e610a9a09c9eeebac5549ea8b8"><code>5b00b25</code></a></td><td><code>Fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3"><code>5343f3b</code></a></td><td><code>Use sage-apply-patches in more packages.</code></td></tr></table>




---

archive/issue_comments_299354.json:
```json
{
    "body": "Changed commit from **[`2c1ec4f`](https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717)** to **[`5343f3b`](https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3)**",
    "created_at": "2016-10-14T12:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299354",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2c1ec4f`](https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717)** to **[`5343f3b`](https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3)**



---

archive/issue_events_288764.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T12:31:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288764"
}
```



---

archive/issue_comments_299355.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nRebased this yet again, incorporating changes for new packages that were added or updated.  Did a build/test of this branch on Linux and everything looks fine.\n\nI'm clearing the old milestone--will leave it to the release manager to set an appropriate one.",
    "created_at": "2016-10-14T12:31:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299355",
    "user": "https://github.com/embray"
}
```

<div id="comment:43" align="right">comment:43</div>

Rebased this yet again, incorporating changes for new packages that were added or updated.  Did a build/test of this branch on Linux and everything looks fine.

I'm clearing the old milestone--will leave it to the release manager to set an appropriate one.



---

archive/issue_events_288765.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T12:31:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288765"
}
```



---

archive/issue_events_288766.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T12:31:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288766"
}
```



---

archive/issue_comments_299356.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nFrom reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?",
    "created_at": "2016-10-14T12:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299356",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

From reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?



---

archive/issue_comments_299357.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nIn `build/pkgs/openblas/spkg-install`, you make a non-trivial change. Why that?",
    "created_at": "2016-10-14T13:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299357",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

In `build/pkgs/openblas/spkg-install`, you make a non-trivial change. Why that?



---

archive/issue_events_288767.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-14T13:05:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288767"
}
```



---

archive/issue_events_288768.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-14T13:05:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288768"
}
```



---

archive/issue_comments_299358.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nAlso, you are deleting `rubiks` patches...",
    "created_at": "2016-10-14T13:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299358",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

Also, you are deleting `rubiks` patches...



---

archive/issue_comments_299359.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nAnd since you rewrote `git` history anyway, you might as well squash everything to 1 commit.",
    "created_at": "2016-10-14T13:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299359",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

And since you rewrote `git` history anyway, you might as well squash everything to 1 commit.



---

archive/issue_comments_299360.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nThe change in openblas is a mistake made in resolving a merge conflict; will revert.",
    "created_at": "2016-10-14T13:51:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299360",
    "user": "https://github.com/embray"
}
```

<div id="comment:48" align="right">comment:48</div>

The change in openblas is a mistake made in resolving a merge conflict; will revert.



---

archive/issue_comments_299361.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@jdemeyer](#comment:44):\n> From reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?\n\nI think earlier, before #20837, it was more necessary to have separate arguments.  But I still kind of like it as is.\n\nThe assumption here is that there is a standard root for patches to a package with *may* have subdirectories.  The reason it's useful to have separate arguments is that `spkg-install` scripts don't need to care where the patch root is, but sometimes it's useful to select subdirectories within it from which to apply other patches.\n\nI'm open to other ideas though.",
    "created_at": "2016-10-14T13:55:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299361",
    "user": "https://github.com/embray"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@jdemeyer](#comment:44):
> From reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?

I think earlier, before #20837, it was more necessary to have separate arguments.  But I still kind of like it as is.

The assumption here is that there is a standard root for patches to a package with *may* have subdirectories.  The reason it's useful to have separate arguments is that `spkg-install` scripts don't need to care where the patch root is, but sometimes it's useful to select subdirectories within it from which to apply other patches.

I'm open to other ideas though.



---

archive/issue_comments_299362.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@jdemeyer](#comment:46):\n> Also, you are deleting `rubiks` patches...\n\nLooks like that's left over from before #21103--it wasn't intentional.  What's odd is that everything worked fine without them so now I question whether they're even necessary but I won't think about that for now.",
    "created_at": "2016-10-14T13:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299362",
    "user": "https://github.com/embray"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@jdemeyer](#comment:46):
> Also, you are deleting `rubiks` patches...

Looks like that's left over from before #21103--it wasn't intentional.  What's odd is that everything worked fine without them so now I question whether they're even necessary but I won't think about that for now.



---

archive/issue_comments_299363.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nAs you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.",
    "created_at": "2016-10-14T14:02:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299363",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">comment:51</div>

As you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.



---

archive/issue_comments_299364.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7\"><code>b058fae</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr></table>\n",
    "created_at": "2016-10-14T14:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299364",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7"><code>b058fae</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr></table>




---

archive/issue_comments_299365.json:
```json
{
    "body": "Changed commit from **[`5343f3b`](https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3)** to **[`b058fae`](https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7)**",
    "created_at": "2016-10-14T14:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299365",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5343f3b`](https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3)** to **[`b058fae`](https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7)**



---

archive/issue_comments_299366.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI reverted the accidental changes and squashed.  I also want to add documentation about this to the developer docs for maintaining packages.",
    "created_at": "2016-10-14T14:11:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299366",
    "user": "https://github.com/embray"
}
```

<div id="comment:53" align="right">comment:53</div>

I reverted the accidental changes and squashed.  I also want to add documentation about this to the developer docs for maintaining packages.



---

archive/issue_comments_299367.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@jdemeyer](#comment:51):\n> As you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.\n\nI see what you mean about using it inconsistently--well really there's one case of that in singular.  There's a reason for that though.  The way the `spkg-install` for singular is written (talk about \"needless complexity\") is it has a bunch of sub-routine that executes in a loop.  Before each subroutine it cd's in to the `src/` directory (of the *singular* sources, so from the point of view of `spkg-install` that's `src/src` which is different from the default assumption made in `sage-apply-patches`.  \n\nReally if I were using `sage-apply-patches` as I intended here, it should call `sage-apply-patches -d debug \"$PATCH\"` :)  (though it looks like I `cd ..` first, so I guess the `$PATCH` part can go away, maybe...)",
    "created_at": "2016-10-14T14:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299367",
    "user": "https://github.com/embray"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@jdemeyer](#comment:51):
> As you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.

I see what you mean about using it inconsistently--well really there's one case of that in singular.  There's a reason for that though.  The way the `spkg-install` for singular is written (talk about "needless complexity") is it has a bunch of sub-routine that executes in a loop.  Before each subroutine it cd's in to the `src/` directory (of the *singular* sources, so from the point of view of `spkg-install` that's `src/src` which is different from the default assumption made in `sage-apply-patches`.  

Really if I were using `sage-apply-patches` as I intended here, it should call `sage-apply-patches -d debug "$PATCH"` :)  (though it looks like I `cd ..` first, so I guess the `$PATCH` part can go away, maybe...)



---

archive/issue_comments_299368.json:
```json
{
    "body": "Changed commit from **[`b058fae`](https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7)** to **[`f92d0ef`](https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9)**",
    "created_at": "2016-10-14T14:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299368",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b058fae`](https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7)** to **[`f92d0ef`](https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9)**



---

archive/issue_comments_299369.json:
```json
{
    "body": "<div id=\"comment:55\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9\"><code>f92d0ef</code></a></td><td><code>Use the -d argument to sage-apply-patches instead</code></td></tr></table>\n",
    "created_at": "2016-10-14T14:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299369",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:55"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9"><code>f92d0ef</code></a></td><td><code>Use the -d argument to sage-apply-patches instead</code></td></tr></table>




---

archive/issue_comments_299370.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nAs for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).\n\nThat said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is \"needless complexity\".",
    "created_at": "2016-10-14T14:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299370",
    "user": "https://github.com/embray"
}
```

<div id="comment:56" align="right">comment:56</div>

As for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).

That said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is "needless complexity".



---

archive/issue_events_288769.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T14:31:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288769"
}
```



---

archive/issue_events_288770.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T14:31:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288770"
}
```



---

archive/issue_comments_299371.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@embray](#comment:56):\n> As for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).\n> \n> That said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is \"needless complexity\".\n\n(FWIW if I were to choose one to remove it would be `patch-dir` since now it's not used.)\n\nAlso setting back to needs_work because I still need to update the documentation.",
    "created_at": "2016-10-14T14:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299371",
    "user": "https://github.com/embray"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@embray](#comment:56):
> As for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).
> 
> That said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is "needless complexity".

(FWIW if I were to choose one to remove it would be `patch-dir` since now it's not used.)

Also setting back to needs_work because I still need to update the documentation.



---

archive/issue_events_288771.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T14:43:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288771"
}
```



---

archive/issue_events_288772.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-14T14:43:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288772"
}
```



---

archive/issue_comments_299372.json:
```json
{
    "body": "Changed commit from **[`f92d0ef`](https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9)** to **[`ed68c76`](https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b)**",
    "created_at": "2016-10-17T11:48:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299372",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f92d0ef`](https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9)** to **[`ed68c76`](https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b)**



---

archive/issue_comments_299373.json:
```json
{
    "body": "<div id=\"comment:59\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/928528c64944f5f64a4d97eccf037ef2ad6e0dc6\"><code>928528c</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f76324a8781aedfdca7dba9966ce48e217ddaa3\"><code>5f76324</code></a></td><td><code>Use the -d argument to sage-apply-patches instead</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b\"><code>ed68c76</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr></table>\n",
    "created_at": "2016-10-17T11:48:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299373",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:59"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/928528c64944f5f64a4d97eccf037ef2ad6e0dc6"><code>928528c</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f76324a8781aedfdca7dba9966ce48e217ddaa3"><code>5f76324</code></a></td><td><code>Use the -d argument to sage-apply-patches instead</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b"><code>ed68c76</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr></table>




---

archive/issue_events_288773.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-17T11:51:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288773"
}
```



---

archive/issue_events_288774.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-10-17T11:51:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288774"
}
```



---

archive/issue_comments_299374.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nRebased again, and updated the docs.  Can we please move forward on merging this before I have to rebase again?  If you *really* want to change something about `sage-apply-patches` we can do that separately, but this works now as-is.",
    "created_at": "2016-10-17T11:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299374",
    "user": "https://github.com/embray"
}
```

<div id="comment:60" align="right">comment:60</div>

Rebased again, and updated the docs.  Can we please move forward on merging this before I have to rebase again?  If you *really* want to change something about `sage-apply-patches` we can do that separately, but this works now as-is.



---

archive/issue_comments_299375.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nNote to self: double-check `fricas`, `frobby`, `gap3`, `gfan`, `scipoptsuite`",
    "created_at": "2016-10-18T08:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299375",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:61" align="right">comment:61</div>

Note to self: double-check `fricas`, `frobby`, `gap3`, `gfan`, `scipoptsuite`



---

archive/issue_events_288775.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-18T10:33:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288775"
}
```



---

archive/issue_events_288776.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-18T10:33:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288776"
}
```



---

archive/issue_comments_299376.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nThis conflicts with #17254. I suggest that you merge that branch.",
    "created_at": "2016-10-18T10:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299376",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:62" align="right">comment:62</div>

This conflicts with #17254. I suggest that you merge that branch.



---

archive/issue_comments_299377.json:
```json
{
    "body": "Changed dependencies from **#21103** to **#17254**",
    "created_at": "2016-10-18T10:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299377",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21103** to **#17254**



---

archive/issue_comments_299378.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nAlso, since you have to change this branch anyway: could you remove the line `echo \"Applying Sage-specific patches\"` from `sage-spkg`? That is not needed since `sage-apply-patches` is sufficiently verbose. That message could actually be confusing if there are no patches to apply.",
    "created_at": "2016-10-18T10:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299378",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">comment:63</div>

Also, since you have to change this branch anyway: could you remove the line `echo "Applying Sage-specific patches"` from `sage-spkg`? That is not needed since `sage-apply-patches` is sufficiently verbose. That message could actually be confusing if there are no patches to apply.



---

archive/issue_comments_299379.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nAnother detail: the `pushd`/`popd` is also verbose:\n\n```\n[gsl-2.1] Finished extraction\n[gsl-2.1] Applying Sage-specific patches\n[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1/src /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1\n[gsl-2.1] No patch files found in ../patches\n[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1\n[gsl-2.1] ****************************************************\n```\nThis should be silenced",
    "created_at": "2016-10-18T11:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299379",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:64" align="right">comment:64</div>

Another detail: the `pushd`/`popd` is also verbose:

```
[gsl-2.1] Finished extraction
[gsl-2.1] Applying Sage-specific patches
[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1/src /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1
[gsl-2.1] No patch files found in ../patches
[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1
[gsl-2.1] ****************************************************
```
This should be silenced



---

archive/issue_comments_299380.json:
```json
{
    "body": "Changed dependencies from **#17254** to **#17254, #21721**",
    "created_at": "2016-10-18T13:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299380",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#17254** to **#17254, #21721**



---

archive/issue_comments_299381.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nSome packages still use non-standard patching: #21721",
    "created_at": "2016-10-18T13:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299381",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:65" align="right">comment:65</div>

Some packages still use non-standard patching: #21721



---

archive/issue_comments_299382.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nIn `build/pkgs/scipoptsuite/spkg-install`, you are still using both directory arguments:\n\n```\nsage-apply-patches -d scip $SPKGDIR/patches || exit 1\n```\nThis could be\n\n```\nsage-apply-patches \"$SPKGDIR/patches/scip\" || exit $?\n```",
    "created_at": "2016-10-18T13:34:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299382",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:66" align="right">comment:66</div>

In `build/pkgs/scipoptsuite/spkg-install`, you are still using both directory arguments:

```
sage-apply-patches -d scip $SPKGDIR/patches || exit 1
```
This could be

```
sage-apply-patches "$SPKGDIR/patches/scip" || exit $?
```



---

archive/issue_comments_299383.json:
```json
{
    "body": "Changed dependencies from **#17254, #21721** to **#17254, #21721, #21722**",
    "created_at": "2016-10-18T14:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299383",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#17254, #21721** to **#17254, #21721, #21722**



---

archive/issue_comments_299384.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\n`gap3` had more issues, so I created a separate ticket: #21722",
    "created_at": "2016-10-18T14:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299384",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:67" align="right">comment:67</div>

`gap3` had more issues, so I created a separate ticket: #21722



---

archive/issue_comments_299385.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently).  It also updates those `spkg-install`s to use it where appropriate.\n+This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.\n \n I'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.\n``````\n",
    "created_at": "2016-10-28T23:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299385",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently).  It also updates those `spkg-install`s to use it where appropriate.
+This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.
 
 I'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.
``````




---

archive/issue_comments_299386.json:
```json
{
    "body": "Changed dependencies from **#17254, #21721, #21722** to **#21721, #21722**",
    "created_at": "2016-10-28T23:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299386",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#17254, #21721, #21722** to **#21721, #21722**



---

archive/issue_comments_299387.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nAll dependencies are merged now, so please rebase to latest `7.5.beta1`.",
    "created_at": "2016-10-31T21:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299387",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:69" align="right">comment:69</div>

All dependencies are merged now, so please rebase to latest `7.5.beta1`.



---

archive/issue_comments_299388.json:
```json
{
    "body": "Changed dependencies from **#21721, #21722** to none",
    "created_at": "2016-10-31T21:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299388",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21721, #21722** to none



---

archive/issue_comments_299389.json:
```json
{
    "body": "Dependencies: **#21676, #21792**",
    "created_at": "2016-11-01T09:12:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299389",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#21676, #21792**



---

archive/issue_comments_299390.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nAll dependencies are not merged now....",
    "created_at": "2016-11-07T13:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299390",
    "user": "https://github.com/embray"
}
```

<div id="comment:71" align="right">comment:71</div>

All dependencies are not merged now....



---

archive/issue_comments_299391.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@embray](#comment:71):\n> All dependencies are not merged now....\n\nNo, because I added two dependencies which would otherwise conflict.",
    "created_at": "2016-11-07T13:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299391",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@embray](#comment:71):
> All dependencies are not merged now....

No, because I added two dependencies which would otherwise conflict.



---

archive/issue_comments_299392.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nYou could just merge those two dependencies in this branch.",
    "created_at": "2016-11-07T13:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299392",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:73" align="right">comment:73</div>

You could just merge those two dependencies in this branch.



---

archive/issue_comments_299393.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nneeds rebasing",
    "created_at": "2016-11-18T01:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299393",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:74" align="right">comment:74</div>

needs rebasing



---

archive/issue_comments_299394.json:
```json
{
    "body": "Changed dependencies from **#21676, #21792** to none",
    "created_at": "2016-11-18T06:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299394",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#21676, #21792** to none



---

archive/issue_comments_299395.json:
```json
{
    "body": "Changed commit from **[`ed68c76`](https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b)** to **[`0968ec0`](https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930)**",
    "created_at": "2016-11-21T14:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299395",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ed68c76`](https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b)** to **[`0968ec0`](https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930)**



---

archive/issue_comments_299396.json:
```json
{
    "body": "<div id=\"comment:76\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f187f9ccb5faed5b15eb0c22673de25956935c35\"><code>f187f9c</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930\"><code>0968ec0</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr></table>\n",
    "created_at": "2016-11-21T14:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299396",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:76"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f187f9ccb5faed5b15eb0c22673de25956935c35"><code>f187f9c</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930"><code>0968ec0</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr></table>




---

archive/issue_comments_299397.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nRebased again.",
    "created_at": "2016-11-21T14:58:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299397",
    "user": "https://github.com/embray"
}
```

<div id="comment:77" align="right">comment:77</div>

Rebased again.



---

archive/issue_events_288777.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-21T14:58:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288777"
}
```



---

archive/issue_events_288778.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-21T14:58:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288778"
}
```



---

archive/issue_events_288779.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-21T14:58:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288779"
}
```



---

archive/issue_events_288780.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-21T14:58:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288780"
}
```



---

archive/issue_events_288781.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-21T14:58:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288781"
}
```



---

archive/issue_events_288782.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-21T14:58:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288782"
}
```



---

archive/issue_comments_299398.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nSorry--misclicked.",
    "created_at": "2016-11-21T14:58:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299398",
    "user": "https://github.com/embray"
}
```

<div id="comment:79" align="right">comment:79</div>

Sorry--misclicked.



---

archive/issue_comments_299399.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nPlease fix [comment:63], [comment:64], [comment:66]. Those are trivial things which can easily be fixed.",
    "created_at": "2016-11-22T16:04:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299399",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:80" align="right">comment:80</div>

Please fix [comment:63], [comment:64], [comment:66]. Those are trivial things which can easily be fixed.



---

archive/issue_events_288783.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-22T16:04:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288783"
}
```



---

archive/issue_events_288784.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-22T16:04:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288784"
}
```



---

archive/issue_comments_299400.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nThe way `sage-apply-patches` is being invoked in scipoptsuite/spkg-install is actually exactly how those options are meant to be used but whatever.",
    "created_at": "2016-11-23T10:53:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299400",
    "user": "https://github.com/embray"
}
```

<div id="comment:81" align="right">comment:81</div>

The way `sage-apply-patches` is being invoked in scipoptsuite/spkg-install is actually exactly how those options are meant to be used but whatever.



---

archive/issue_comments_299401.json:
```json
{
    "body": "Changed commit from **[`0968ec0`](https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930)** to **[`addd3ee`](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)**",
    "created_at": "2016-11-23T10:55:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299401",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0968ec0`](https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930)** to **[`addd3ee`](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)**



---

archive/issue_comments_299402.json:
```json
{
    "body": "<div id=\"comment:82\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c\"><code>e842689</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57\"><code>02e8b04</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0\"><code>addd3ee</code></a></td><td><code>Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.</code></td></tr></table>\n",
    "created_at": "2016-11-23T10:55:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299402",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:82"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c"><code>e842689</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57"><code>02e8b04</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0"><code>addd3ee</code></a></td><td><code>Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.</code></td></tr></table>




---

archive/issue_comments_299403.json:
```json
{
    "body": "<div id=\"comment:83\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c\"><code>e842689</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57\"><code>02e8b04</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0\"><code>addd3ee</code></a></td><td><code>Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.</code></td></tr></table>\n",
    "created_at": "2016-11-23T10:55:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299403",
    "user": "https://github.com/embray"
}
```

<div id="comment:83"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c"><code>e842689</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57"><code>02e8b04</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0"><code>addd3ee</code></a></td><td><code>Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.</code></td></tr></table>




---

archive/issue_events_288785.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-23T10:55:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288785"
}
```



---

archive/issue_events_288786.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-23T10:55:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288786"
}
```



---

archive/issue_comments_299404.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nI have no further objections. I'm currently building Sage from scratch with this branch. If this works fine, I will set this to positive_review (hoping that there are no conflicts).",
    "created_at": "2016-11-23T14:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299404",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:84" align="right">comment:84</div>

I have no further objections. I'm currently building Sage from scratch with this branch. If this works fine, I will set this to positive_review (hoping that there are no conflicts).



---

archive/issue_comments_299405.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nAwesome, thanks!",
    "created_at": "2016-11-23T15:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299405",
    "user": "https://github.com/embray"
}
```

<div id="comment:85" align="right">comment:85</div>

Awesome, thanks!



---

archive/issue_events_288787.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-23T21:59:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288787"
}
```



---

archive/issue_events_288788.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-23T21:59:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288788"
}
```



---

archive/issue_events_288789.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-23T21:59:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288789"
}
```



---

archive/issue_comments_299406.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nMerge conflict",
    "created_at": "2016-11-24T23:43:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299406",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:87" align="right">comment:87</div>

Merge conflict



---

archive/issue_events_288790.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-11-24T23:43:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288790"
}
```



---

archive/issue_events_288791.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-11-24T23:43:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288791"
}
```



---

archive/issue_comments_299407.json:
```json
{
    "body": "<div id=\"comment:88\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad5dcd6c07baf4550b20c4b6d78002659ae8095f\"><code>ad5dcd6</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2858b5f1b7077c354a39777a440d2f08e2afd8c5\"><code>2858b5f</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391\"><code>52a8ca0</code></a></td><td><code>Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.</code></td></tr></table>\n",
    "created_at": "2016-11-29T09:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299407",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:88"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad5dcd6c07baf4550b20c4b6d78002659ae8095f"><code>ad5dcd6</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2858b5f1b7077c354a39777a440d2f08e2afd8c5"><code>2858b5f</code></a></td><td><code>Added some updated documentation about how to apply patches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391"><code>52a8ca0</code></a></td><td><code>Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.</code></td></tr></table>




---

archive/issue_comments_299408.json:
```json
{
    "body": "Changed commit from **[`addd3ee`](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)** to **[`52a8ca0`](https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391)**",
    "created_at": "2016-11-29T09:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299408",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`addd3ee`](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)** to **[`52a8ca0`](https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391)**



---

archive/issue_comments_299409.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nRebased.",
    "created_at": "2016-11-29T09:42:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299409",
    "user": "https://github.com/embray"
}
```

<div id="comment:89" align="right">comment:89</div>

Rebased.



---

archive/issue_events_288792.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-29T09:42:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288792"
}
```



---

archive/issue_events_288793.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-11-29T09:42:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288793"
}
```



---

archive/issue_comments_299410.json:
```json
{
    "body": "Changed branch from **[u/embray/patch-cleanup](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/patch-cleanup)** to **[u/jdemeyer/patch-cleanup](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/patch-cleanup)**",
    "created_at": "2016-11-29T11:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299410",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/embray/patch-cleanup](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/patch-cleanup)** to **[u/jdemeyer/patch-cleanup](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/patch-cleanup)**



---

archive/issue_comments_299411.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nI fixed a minor bikeshed: I prefer no newline after `./configure` in\n\n```\n./configure ...\n\nif [ $? -ne 0 ]; then\n    ...\nfi\n```\nIt makes it more clear that the `if` really belongs with the `./configure`.\n\nI don't know if you intentionally added a newline there in `build/pkgs/cysignals/spkg-install`, but I removed it now. I also squashed the commits together.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c\"><code>b6b33cd</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr></table>\n",
    "created_at": "2016-11-29T11:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299411",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:91" align="right">comment:91</div>

I fixed a minor bikeshed: I prefer no newline after `./configure` in

```
./configure ...

if [ $? -ne 0 ]; then
    ...
fi
```
It makes it more clear that the `if` really belongs with the `./configure`.

I don't know if you intentionally added a newline there in `build/pkgs/cysignals/spkg-install`, but I removed it now. I also squashed the commits together.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c"><code>b6b33cd</code></a></td><td><code>Adds a new sage-apply-patches script.</code></td></tr></table>




---

archive/issue_comments_299412.json:
```json
{
    "body": "Changed commit from **[`52a8ca0`](https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391)** to **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)**",
    "created_at": "2016-11-29T11:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299412",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`52a8ca0`](https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391)** to **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)**



---

archive/issue_events_288794.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-11-30T19:36:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288794"
}
```



---

archive/issue_events_288795.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4baf341dfaa6c290a246bd2406c83712960eae42",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-11-30T19:36:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/20692#event-288795"
}
```



---

archive/issue_comments_299413.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/patch-cleanup](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/patch-cleanup)** to **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)**",
    "created_at": "2016-11-30T19:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299413",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/patch-cleanup](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/patch-cleanup)** to **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)**



---

archive/issue_comments_299414.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nFinally merged, thanks Erik!",
    "created_at": "2016-12-02T06:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299414",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:93" align="right">comment:93</div>

Finally merged, thanks Erik!



---

archive/issue_comments_299415.json:
```json
{
    "body": "Changed commit from **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)** to none",
    "created_at": "2016-12-02T06:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299415",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`b6b33cd`](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)** to none



---

archive/issue_comments_299416.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nHooray!\n*pours you a champagne*",
    "created_at": "2016-12-02T10:37:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/20692#issuecomment-299416",
    "user": "https://github.com/embray"
}
```

<div id="comment:94" align="right">comment:94</div>

Hooray!
*pours you a champagne*
