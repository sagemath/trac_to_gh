# Issue 20692: Add sage-apply-patches helper script for use in spkg-install scripts

archive/issues_020455.json:
```json
{
    "body": "This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.\n\nI'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.\n\nReviewer: Jeroen Demeyer\n\nAuthor: Erik Bray\n\nBranch: b6b33cdbb33ba7eb856cb283c296250976e1638c\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20692\n\n",
    "closed_at": "2016-11-30T19:36:11Z",
    "created_at": "2016-05-27T11:33:29Z",
    "labels": [
        "component: build",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "Add sage-apply-patches helper script for use in spkg-install scripts",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20692",
    "user": "https://github.com/embray"
}
```
This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.

I'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.

Reviewer: Jeroen Demeyer

Author: Erik Bray

Branch: b6b33cdbb33ba7eb856cb283c296250976e1638c

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20692





---

archive/issue_comments_371435.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-27T11:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371435",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_371436.json:
```json
{
    "body": "<a id='comment:2'></a>\nSeems I have to undust my `bash` scripting skills...\n\nWhy is it an error if there are no patches to apply? I would remove\n\n```\nif [[ -r \"${patches[0]}\" ]]; then\nelse\n    >&2 echo \"No patch files found in $patchdir\"\n    exit 1\nfi\n```\nand just apply all patches, which may be the empty set.",
    "created_at": "2016-05-27T15:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371436",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Seems I have to undust my `bash` scripting skills...

Why is it an error if there are no patches to apply? I would remove

```
if [[ -r "${patches[0]}" ]]; then
else
    >&2 echo "No patch files found in $patchdir"
    exit 1
fi
```
and just apply all patches, which may be the empty set.



---

archive/issue_comments_371437.json:
```json
{
    "body": "<a id='comment:3'></a>\nA minor thing: I would prefer to remove the `-pNUM` option. It's better if we consistently use `-p1` in all cases. That's also how `git` generates its patches.",
    "created_at": "2016-05-27T15:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371437",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
A minor thing: I would prefer to remove the `-pNUM` option. It's better if we consistently use `-p1` in all cases. That's also how `git` generates its patches.



---

archive/issue_comments_371438.json:
```json
{
    "body": "<a id='comment:4'></a>\nI don't get this:\n\n```\nand it is assumed that the patches are being applied from\nthe root of the package source\n```",
    "created_at": "2016-05-27T15:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371438",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
I don't get this:

```
and it is assumed that the patches are being applied from
the root of the package source
```



---

archive/issue_comments_371439.json:
```json
{
    "body": "<a id='comment:5'></a>\nWhy not always use the option `--no-backup-if-mismatch` instead of only for PARI?",
    "created_at": "2016-05-27T15:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371439",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
Why not always use the option `--no-backup-if-mismatch` instead of only for PARI?



---

archive/issue_comments_371440.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-27T15:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371440",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_371441.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2016-05-27T15:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371441",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_371442.json:
```json
{
    "body": "<a id='comment:7'></a>\nFollowing up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.",
    "created_at": "2016-05-27T15:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371442",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Following up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.



---

archive/issue_comments_371443.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jdemeyer](#comment%3A7):\n> Following up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.\n\n\nI guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.  Granted, when this was inline in every script it didn't require a process creation (more on that in a followup).  I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.  If they forget to do that, well, then they clearly didn't test that their patch applies at build time :)\n\nAs for it being an error when no patches are found, I have no strong feelings.  I liked that it was explicit, but it could just as will either print a message, or go completely silent.\n\n> A minor thing: I would prefer to remove the -pNUM option. It's better if we consistently use -p1 in all cases. That's also how git generates its patches.\n\n\nThat's fine by me.  I think there was one case, maybe two where it was needed, but it would be just as easy to update those patch files and keep things consistent throughout.\n\n> Why not always use the option `--no-backup-if-mismatch` instead of only for PARI?\n\n\nI figured maybe there was a reason to prefer to keep backups in general.  Would be fine with me to apply in general though.  Previously there was one other case where additional arguments had to be passed to `patch`, but then I realized that package had no patches anymore.\n\n> I don't get this:\n\n   and it is assumed that the patches are being applied from\n   the root of the package source\n\nMeaning the patches are applied after `cd`-ing into the upstream source, hence the default path to search for patches being `../patches`.  No reason it has to be that way but it was the most minimal change from the existing code.",
    "created_at": "2016-05-27T16:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371443",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
Replying to [jdemeyer](#comment%3A7):
> Following up on [comment:2]: it's very useful to support an empty set of patches. For example, when upgrading a package, it can happen that all patches need to be removed. You don't want that to break the build. That is also the reason why many packages have code to apply patches when they don't have patches. I would not remove such code since it allows easily adding a new patch. Ideally, every `spkg-install` script would call `spkg-apply-patches`.


I guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.  Granted, when this was inline in every script it didn't require a process creation (more on that in a followup).  I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.  If they forget to do that, well, then they clearly didn't test that their patch applies at build time :)

As for it being an error when no patches are found, I have no strong feelings.  I liked that it was explicit, but it could just as will either print a message, or go completely silent.

> A minor thing: I would prefer to remove the -pNUM option. It's better if we consistently use -p1 in all cases. That's also how git generates its patches.


That's fine by me.  I think there was one case, maybe two where it was needed, but it would be just as easy to update those patch files and keep things consistent throughout.

> Why not always use the option `--no-backup-if-mismatch` instead of only for PARI?


I figured maybe there was a reason to prefer to keep backups in general.  Would be fine with me to apply in general though.  Previously there was one other case where additional arguments had to be passed to `patch`, but then I realized that package had no patches anymore.

> I don't get this:

   and it is assumed that the patches are being applied from
   the root of the package source

Meaning the patches are applied after `cd`-ing into the upstream source, hence the default path to search for patches being `../patches`.  No reason it has to be that way but it was the most minimal change from the existing code.



---

archive/issue_comments_371444.json:
```json
{
    "body": "<a id='comment:9'></a>\nAn alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.\n\nI'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)",
    "created_at": "2016-05-27T16:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371444",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
An alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.

I'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)



---

archive/issue_comments_371445.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [embray](#comment%3A8):\n> I guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.\n\n\nHow much slower is it really? Surely it's negligible compared to the time to build Sage.\n\n> I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.\n\n\nThat's really annoying. Please keep the call to `spkg-apply-patches` even when there are no patches.",
    "created_at": "2016-05-28T20:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371445",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Replying to [embray](#comment%3A8):
> I guess I was thinking it was wasteful to call a process (especially on Windows where process creation is much slower) when it's not needed.


How much slower is it really? Surely it's negligible compared to the time to build Sage.

> I think if someone wants to add a patch to a package they should explicitly add `spkg-appy-patches` as well.


That's really annoying. Please keep the call to `spkg-apply-patches` even when there are no patches.



---

archive/issue_comments_371446.json:
```json
{
    "body": "<a id='comment:11'></a>\nIf you feel that strongly about it. I think it's pointless.  Especially considering that it was already inconsistent.  Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)",
    "created_at": "2016-05-30T08:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371446",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
If you feel that strongly about it. I think it's pointless.  Especially considering that it was already inconsistent.  Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)



---

archive/issue_comments_371447.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [embray](#comment%3A11):\n> Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)\n\n\nWell, that's essentially what I wrote in [comment:7].\n\nAnd yes, I feel strongly about because I don't want to always add/remove the call to `spkg-apply-patches` depending on whether or not the number of patches to apply equals zero.\n\nDetail: for consistency, I would prefer the script to be called `spkg-apply-patches` instead of `sage-apply-patches`.",
    "created_at": "2016-05-30T09:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371447",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Replying to [embray](#comment%3A11):
> Instead you should be asking me to put `sage-apply-patches` in every `spkg-install` that didn't have it before :)


Well, that's essentially what I wrote in [comment:7].

And yes, I feel strongly about because I don't want to always add/remove the call to `spkg-apply-patches` depending on whether or not the number of patches to apply equals zero.

Detail: for consistency, I would prefer the script to be called `spkg-apply-patches` instead of `sage-apply-patches`.



---

archive/issue_comments_371448.json:
```json
{
    "body": "<a id='comment:13'></a>\nWhat would that be consistent with?  Every other script in `build/bin` starts with `sage-`.  In fact very nearly every, if not every executable installed by sage starts with `sage-` which is good and consistent, and completely free of potential for overlap with anything else.",
    "created_at": "2016-05-30T09:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371448",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>
What would that be consistent with?  Every other script in `build/bin` starts with `sage-`.  In fact very nearly every, if not every executable installed by sage starts with `sage-` which is good and consistent, and completely free of potential for overlap with anything else.



---

archive/issue_comments_371449.json:
```json
{
    "body": "<a id='comment:14'></a>\nConsistent with `spkg-install`, `spkg-check`, `spkg-src`. Basically, anything related to building Sage packages.",
    "created_at": "2016-05-30T09:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371449",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Consistent with `spkg-install`, `spkg-check`, `spkg-src`. Basically, anything related to building Sage packages.



---

archive/issue_comments_371450.json:
```json
{
    "body": "<a id='comment:15'></a>\nThose scripts are only ever in spkg directories though and are specific to each spkg. They are not in bin/ paths added to `$PATH`.  This is a helper script used in installation like the rest in build/bin, all of which (sensibly) start with `sage-`.\n\nI'm probably also going to add a `sage-spkg-python` (or something, I don't care what it's called) that will be exec'd by the `spkg-install` for most Python packages since the vast majority of them are cookie-cutter anyways (especially if you also want to have every one of them calling `whatever-apply-patches` by default).  This would be to provide a solution for #16897 which also calls out this fact.  (I think it's important for every package to have a file called `spkg-install`, but it's fine if its sole function is to call some other generic script).",
    "created_at": "2016-05-30T09:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371450",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Those scripts are only ever in spkg directories though and are specific to each spkg. They are not in bin/ paths added to `$PATH`.  This is a helper script used in installation like the rest in build/bin, all of which (sensibly) start with `sage-`.

I'm probably also going to add a `sage-spkg-python` (or something, I don't care what it's called) that will be exec'd by the `spkg-install` for most Python packages since the vast majority of them are cookie-cutter anyways (especially if you also want to have every one of them calling `whatever-apply-patches` by default).  This would be to provide a solution for #16897 which also calls out this fact.  (I think it's important for every package to have a file called `spkg-install`, but it's fine if its sole function is to call some other generic script).



---

archive/issue_comments_371451.json:
```json
{
    "body": "<a id='comment:16'></a>\nFor the record: I just wanted to comment over the name, I'm not going to reject this patch over such bikeshedding.",
    "created_at": "2016-05-30T09:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371451",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
For the record: I just wanted to comment over the name, I'm not going to reject this patch over such bikeshedding.



---

archive/issue_comments_371452.json:
```json
{
    "body": "<a id='comment:17'></a>\nWhile I am OK with the stuff as it is, I have a bold suggestion for further work: may be it should be put in `sage-spkg` and always be run. We already leave it when there is no patches anymore. What would be the overhead of always running it?",
    "created_at": "2016-05-30T10:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371452",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
While I am OK with the stuff as it is, I have a bold suggestion for further work: may be it should be put in `sage-spkg` and always be run. We already leave it when there is no patches anymore. What would be the overhead of always running it?



---

archive/issue_comments_371453.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [fbissey](#comment%3A17):\n> may be it should be put in `sage-spkg` and always be run.\n\n\nNot easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.",
    "created_at": "2016-05-30T10:33:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371453",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [fbissey](#comment%3A17):
> may be it should be put in `sage-spkg` and always be run.


Not easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.



---

archive/issue_comments_371454.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [jdemeyer](#comment%3A18):\n> Replying to [fbissey](#comment%3A17):\n> > may be it should be put in `sage-spkg` and always be run.\n\n> \n> Not easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.\n\n\nTricky. I didn't remember we had those outliers.",
    "created_at": "2016-05-30T11:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371454",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Replying to [jdemeyer](#comment%3A18):
> Replying to [fbissey](#comment%3A17):
> > may be it should be put in `sage-spkg` and always be run.

> 
> Not easily. We need to guess in which source directory to run the script. Usually, it's `src` but not always.


Tricky. I didn't remember we had those outliers.



---

archive/issue_comments_371455.json:
```json
{
    "body": "<a id='comment:20'></a>\nLet me think about that a bit more though.  If it were done in `sage-spkg` it would do away with the need for a separate script entirely, and would cut down that much more on the duplication which is what I want.\n\nOne possibility would be to rewrite the patch files to include the source directory in the paths, but that could be annoying and error-prone.  The other would be to standardize `src`.  I knew there were outliers but I never looked into why.  Is there really no way those could be changed?",
    "created_at": "2016-05-30T11:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371455",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>
Let me think about that a bit more though.  If it were done in `sage-spkg` it would do away with the need for a separate script entirely, and would cut down that much more on the duplication which is what I want.

One possibility would be to rewrite the patch files to include the source directory in the paths, but that could be annoying and error-prone.  The other would be to standardize `src`.  I knew there were outliers but I never looked into why.  Is there really no way those could be changed?



---

archive/issue_comments_371456.json:
```json
{
    "body": "<a id='comment:21'></a>\n`sage-spkg` contains the following:\n\n```\n     # Strip file extension from the archive file and hope (as per\n     # automake standards) that this is the same as the directory name\n     # inside; move the directory to \"src\".  (This goes wrong for\n     # upstream package archives that have been renamed to appease some\n     # other Sage script, such as \"latte-int\", whose archive is renamed\n     # to \"latte_int\".)\n     mv \"$(echo \"$PKG_NAME_UPSTREAM\" | sed 's/\\.zip$//g;s/\\.tgz$//g;s/\\.tar\\.    gz$//g;s/\\.tar\\.xz$//g;s/\\.tar\\.lz$//g;s/\\.tar\\.bz2$//g;s/\\.tar$//g')\"* src\n```\n\nMaybe this should be redone.  There are a number of ways it might be done differently.  One possibility is that it could be made `sage-uncompress-spkg`'s job to always extract to `src`.  It could handle checking for the top-level directory in the archive and extracting it instead as `src`.  For those handful of packages (are there any? I suspect probably...) that don't have a top-level directory it would create `src` and extract all the archive contents into it.",
    "created_at": "2016-05-30T11:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371456",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'></a>
`sage-spkg` contains the following:

```
     # Strip file extension from the archive file and hope (as per
     # automake standards) that this is the same as the directory name
     # inside; move the directory to "src".  (This goes wrong for
     # upstream package archives that have been renamed to appease some
     # other Sage script, such as "latte-int", whose archive is renamed
     # to "latte_int".)
     mv "$(echo "$PKG_NAME_UPSTREAM" | sed 's/\.zip$//g;s/\.tgz$//g;s/\.tar\.    gz$//g;s/\.tar\.xz$//g;s/\.tar\.lz$//g;s/\.tar\.bz2$//g;s/\.tar$//g')"* src
```

Maybe this should be redone.  There are a number of ways it might be done differently.  One possibility is that it could be made `sage-uncompress-spkg`'s job to always extract to `src`.  It could handle checking for the top-level directory in the archive and extracting it instead as `src`.  For those handful of packages (are there any? I suspect probably...) that don't have a top-level directory it would create `src` and extract all the archive contents into it.



---

archive/issue_comments_371457.json:
```json
{
    "body": "<a id='comment:22'></a>\nThis is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?",
    "created_at": "2016-05-30T11:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371457",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:22'></a>
This is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?



---

archive/issue_comments_371458.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [fbissey](#comment%3A22):\n> This is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?\n\n\nI was going to suggest the same.  Though I might address the subject of extracting to a standard location before coming back to and reworking this ticket.  I've gone through the list of spkgs that *don't* wind up with their sources in `src` and in each case there's no good reason really, except that the hack above doesn't work for it (or the last time the file was touched predates that hack).\n\nI think a patch to `sage-uncompress-spkg` would be a good idea and I'll put something to that effect in a separate ticket.",
    "created_at": "2016-05-30T11:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371458",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'></a>
Replying to [fbissey](#comment%3A22):
> This is getting out of the original scope (and I am sorry to have started it) but it would be a good idea to have something more robust for unpacking in a standard folder. May be we should just get this in now and move that idea to another ticket?


I was going to suggest the same.  Though I might address the subject of extracting to a standard location before coming back to and reworking this ticket.  I've gone through the list of spkgs that *don't* wind up with their sources in `src` and in each case there's no good reason really, except that the hack above doesn't work for it (or the last time the file was touched predates that hack).

I think a patch to `sage-uncompress-spkg` would be a good idea and I'll put something to that effect in a separate ticket.



---

archive/issue_comments_371459.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#20721\"",
    "created_at": "2016-05-30T17:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371459",
    "user": "https://github.com/embray"
}
```

Changing dependencies from "" to "#20721"



---

archive/issue_comments_371460.json:
```json
{
    "body": "<a id='comment:24'></a>\nI think #20721, or something like it, should be a prerequisite to this ticket (or any like it depending on how much I end up reworking this).",
    "created_at": "2016-05-30T17:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371460",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>
I think #20721, or something like it, should be a prerequisite to this ticket (or any like it depending on how much I end up reworking this).



---

archive/issue_comments_371461.json:
```json
{
    "body": "Changing dependencies from \"#20721\" to \"#20721 20837\"",
    "created_at": "2016-06-16T15:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371461",
    "user": "https://github.com/embray"
}
```

Changing dependencies from "#20721" to "#20721 20837"



---

archive/issue_comments_371462.json:
```json
{
    "body": "<a id='comment:25'></a>\n#20837 cleans up the handful of spkgs that don't conform to a format where calling `patch -p1 < ../patches/*.patch` should work from within the source root.\n\nThen we can move forward on appling `sage-apply-patches` by default on all spkgs.",
    "created_at": "2016-06-16T15:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371462",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
#20837 cleans up the handful of spkgs that don't conform to a format where calling `patch -p1 < ../patches/*.patch` should work from within the source root.

Then we can move forward on appling `sage-apply-patches` by default on all spkgs.



---

archive/issue_comments_371463.json:
```json
{
    "body": "Changing dependencies from \"#20721 20837\" to \"#20721, #20837\"",
    "created_at": "2016-06-25T05:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371463",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#20721 20837" to "#20721, #20837"



---

archive/issue_comments_371464.json:
```json
{
    "body": "<a id='comment:27'></a>\nWhat remains to be done for this ticket?\nWould be good to use this for #20892.",
    "created_at": "2016-06-28T04:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371464",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
What remains to be done for this ticket?
Would be good to use this for #20892.



---

archive/issue_comments_371465.json:
```json
{
    "body": "<a id='comment:28'></a>\nMainly: `sage-apply-patches` needs to be changed to fail quietly if no patches are found (I think I already did this; might still be on a local branch)\n\nThen remove all, or almost all calls to `sage-apply-patches` from individual `spkg-install` scripts, and instead call it on all packages as a standard step in `sage-spkg`.\n\nI can get this done soon.",
    "created_at": "2016-06-28T08:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371465",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>
Mainly: `sage-apply-patches` needs to be changed to fail quietly if no patches are found (I think I already did this; might still be on a local branch)

Then remove all, or almost all calls to `sage-apply-patches` from individual `spkg-install` scripts, and instead call it on all packages as a standard step in `sage-spkg`.

I can get this done soon.



---

archive/issue_comments_371466.json:
```json
{
    "body": "<a id='comment:29'></a>\nStrange, I thought I rebased this.  Maybe I just forgot to push.",
    "created_at": "2016-07-04T09:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371466",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'></a>
Strange, I thought I rebased this.  Maybe I just forgot to push.



---

archive/issue_comments_371467.json:
```json
{
    "body": "Changing dependencies from \"#20721, #20837\" to \"#20721, #20837, #20933\"",
    "created_at": "2016-07-04T10:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371467",
    "user": "https://github.com/embray"
}
```

Changing dependencies from "#20721, #20837" to "#20721, #20837, #20933"



---

archive/issue_comments_371468.json:
```json
{
    "body": "<a id='comment:30'></a>\nTurns out the patches for MathJax needed a bit more tweaking, as they were not uniform with the other packages.",
    "created_at": "2016-07-04T10:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371468",
    "user": "https://github.com/embray"
}
```

<a id='comment:30'></a>
Turns out the patches for MathJax needed a bit more tweaking, as they were not uniform with the other packages.



---

archive/issue_comments_371469.json:
```json
{
    "body": "<a id='comment:31'></a>\nShould there be a way to control the order in which patches are applied?\nFor example Debian uses a file \"series\" that controls this. See for example #20901, for which I'd like to lift the patches from debian.",
    "created_at": "2016-07-07T05:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371469",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
Should there be a way to control the order in which patches are applied?
For example Debian uses a file "series" that controls this. See for example #20901, for which I'd like to lift the patches from debian.



---

archive/issue_comments_371470.json:
```json
{
    "body": "<a id='comment:32'></a>\nCould we just prefix the patch filenames with numbers?",
    "created_at": "2016-07-07T09:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371470",
    "user": "https://github.com/embray"
}
```

<a id='comment:32'></a>
Could we just prefix the patch filenames with numbers?



---

archive/issue_comments_371471.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [embray](#comment%3A32):\n> Could we just prefix the patch filenames with numbers?\n\n+1 that's the easiest way to get order.",
    "created_at": "2016-07-07T10:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371471",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:33'></a>
Replying to [embray](#comment%3A32):
> Could we just prefix the patch filenames with numbers?

+1 that's the easiest way to get order.



---

archive/issue_comments_371472.json:
```json
{
    "body": "Changing commit from \"29bd19903b16289c178e9468194318e5d1017dad\" to \"2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717\"",
    "created_at": "2016-08-16T13:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371472",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "29bd19903b16289c178e9468194318e5d1017dad" to "2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717"



---

archive/issue_comments_371473.json:
```json
{
    "body": "<a id='comment:34'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[5891448](https://github.com/sagemath/sagetrac-mirror/commit/589144877739dd0c9b491ca210d458e707af8151)|`Clean up patching of rubiks`|\n|[18139d8](https://github.com/sagemath/sagetrac-mirror/commit/18139d85c47cd9c6a6d1ca14020f34c00cfa4e0d)|`Adds a new sage-apply-patches script.`|\n|[a46a816](https://github.com/sagemath/sagetrac-mirror/commit/a46a816ed30a3da4952b6094599836e4c3ce3398)|`Fix accidental duplication of patch_subdir.`|\n|[5458959](https://github.com/sagemath/sagetrac-mirror/commit/54589594446ca0571cebc67dd7d4dc15c4c1a693)|`Forgot to change this to loop over the full list when I made $patches into a list.`|\n|[39645a9](https://github.com/sagemath/sagetrac-mirror/commit/39645a98d1271dc416a9b3eaf67ae90e7b36f196)|`Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.`|\n|[78a151b](https://github.com/sagemath/sagetrac-mirror/commit/78a151b3fa1d2ef100589c488987dc3e240e2e37)|`None of these packages currently have patches to apply.`|\n|[d15fb43](https://github.com/sagemath/sagetrac-mirror/commit/d15fb437a2a59ff3896057048514bd2a6a991b69)|`Add license notice.`|\n|[ca832e3](https://github.com/sagemath/sagetrac-mirror/commit/ca832e3395c923302f4b82c32770b9eed79c2742)|`Warn but don't fail if there are no patches to apply`|\n|[2c1ec4f](https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717)|`Apply sage-apply-patches standard on all packages during spkg-install`|",
    "created_at": "2016-08-16T13:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[5891448](https://github.com/sagemath/sagetrac-mirror/commit/589144877739dd0c9b491ca210d458e707af8151)|`Clean up patching of rubiks`|
|[18139d8](https://github.com/sagemath/sagetrac-mirror/commit/18139d85c47cd9c6a6d1ca14020f34c00cfa4e0d)|`Adds a new sage-apply-patches script.`|
|[a46a816](https://github.com/sagemath/sagetrac-mirror/commit/a46a816ed30a3da4952b6094599836e4c3ce3398)|`Fix accidental duplication of patch_subdir.`|
|[5458959](https://github.com/sagemath/sagetrac-mirror/commit/54589594446ca0571cebc67dd7d4dc15c4c1a693)|`Forgot to change this to loop over the full list when I made $patches into a list.`|
|[39645a9](https://github.com/sagemath/sagetrac-mirror/commit/39645a98d1271dc416a9b3eaf67ae90e7b36f196)|`Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.`|
|[78a151b](https://github.com/sagemath/sagetrac-mirror/commit/78a151b3fa1d2ef100589c488987dc3e240e2e37)|`None of these packages currently have patches to apply.`|
|[d15fb43](https://github.com/sagemath/sagetrac-mirror/commit/d15fb437a2a59ff3896057048514bd2a6a991b69)|`Add license notice.`|
|[ca832e3](https://github.com/sagemath/sagetrac-mirror/commit/ca832e3395c923302f4b82c32770b9eed79c2742)|`Warn but don't fail if there are no patches to apply`|
|[2c1ec4f](https://github.com/sagemath/sagetrac-mirror/commit/2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717)|`Apply sage-apply-patches standard on all packages during spkg-install`|



---

archive/issue_comments_371474.json:
```json
{
    "body": "<a id='comment:35'></a>\nLast I poked at this not all the dependencies were satisfied.  Now they are, and I have rebased the branch again on develop.\n\nJust did a test build of this on Linux and everything (modulo optional packages which were not tested) works, but YMMV?",
    "created_at": "2016-08-16T13:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371474",
    "user": "https://github.com/embray"
}
```

<a id='comment:35'></a>
Last I poked at this not all the dependencies were satisfied.  Now they are, and I have rebased the branch again on develop.

Just did a test build of this on Linux and everything (modulo optional packages which were not tested) works, but YMMV?



---

archive/issue_comments_371475.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-16T13:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371475",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_371476.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-16T13:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371476",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_371477.json:
```json
{
    "body": "Changing dependencies from \"#20721, #20837, #20933\" to \"#21103\"",
    "created_at": "2016-08-16T13:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371477",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#20721, #20837, #20933" to "#21103"



---

archive/issue_comments_371478.json:
```json
{
    "body": "<a id='comment:37'></a>\nThis should still depend on #21103.",
    "created_at": "2016-08-16T13:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371478",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>
This should still depend on #21103.



---

archive/issue_comments_371479.json:
```json
{
    "body": "<a id='comment:38'></a>\nNote that I might look at #21103 and this ticket, but not right now since I'm working on #20218 and #21256.",
    "created_at": "2016-08-16T13:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371479",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>
Note that I might look at #21103 and this ticket, but not right now since I'm working on #20218 and #21256.



---

archive/issue_comments_371480.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [embray](#comment%3A9):\n> An alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.\n> \n> I'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)\n\n\n+1  (You're not the first suggesting this...)",
    "created_at": "2016-08-27T17:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371480",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:39'></a>
Replying to [embray](#comment%3A9):
> An alternative I considered to adding a new script was to create a little library of functions that is sourced in every spkg-install.  It would include `sage-apply-patches` reimplemented as a function, along with a few other bits that are repeated a lot.  This would save on process creations too.
> 
> I'd still be happy to revisit that idea too if it sounds good, but right now I just wanted to focus on the patch thing since that's what was irking me specifically :)


+1  (You're not the first suggesting this...)



---

archive/issue_comments_371481.json:
```json
{
    "body": "<a id='comment:40'></a>\nP.S.:  The main problem to that time was that (legacy) spkgs didn't depend on the Sage version, so we would have had to add fall-backs first (if the script to source from wasn't available).\n\nError-handling (i.e., the messages) is another thing that should be standardized.",
    "created_at": "2016-08-27T17:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371481",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:40'></a>
P.S.:  The main problem to that time was that (legacy) spkgs didn't depend on the Sage version, so we would have had to add fall-backs first (if the script to source from wasn't available).

Error-handling (i.e., the messages) is another thing that should be standardized.



---

archive/issue_comments_371482.json:
```json
{
    "body": "<a id='comment:41'></a>\nSounds good--I'll revisit that later in a separate ticket.  As it is this is a step in the right direction since it just standardizes the \"apply patches (if any)\" step across all spkgs.",
    "created_at": "2016-08-29T10:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371482",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>
Sounds good--I'll revisit that later in a separate ticket.  As it is this is a step in the right direction since it just standardizes the "apply patches (if any)" step across all spkgs.



---

archive/issue_comments_371483.json:
```json
{
    "body": "<a id='comment:42'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[6bee0df](https://github.com/sagemath/sagetrac-mirror/commit/6bee0dfa5f9c779c1049fe569828d4d20ca97379)|`Adds a new sage-apply-patches script.`|\n|[fc0d294](https://github.com/sagemath/sagetrac-mirror/commit/fc0d29469dee5d2688bd3716379ac5b2223f5a62)|`Fix accidental duplication of patch_subdir.`|\n|[0e1b32c](https://github.com/sagemath/sagetrac-mirror/commit/0e1b32cd8166303f2856afefd330389654d28a8b)|`Forgot to change this to loop over the full list when I made $patches into a list.`|\n|[47c69f1](https://github.com/sagemath/sagetrac-mirror/commit/47c69f113560cf18c9e629699474f52d584f79b9)|`Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.`|\n|[d2f3eaa](https://github.com/sagemath/sagetrac-mirror/commit/d2f3eaa159663dd06d33a5bb756f33f04054c466)|`None of these packages currently have patches to apply.`|\n|[27cc968](https://github.com/sagemath/sagetrac-mirror/commit/27cc968cd38843efe132a5981b69f8f6efca9e5f)|`Add license notice.`|\n|[6c9d6d1](https://github.com/sagemath/sagetrac-mirror/commit/6c9d6d1df2f8cef29ee9e575409241ee4618e289)|`Warn but don't fail if there are no patches to apply`|\n|[229199f](https://github.com/sagemath/sagetrac-mirror/commit/229199fc1ccde3034a9d6f58d016456423da16c5)|`Apply sage-apply-patches standard on all packages during spkg-install`|\n|[5b00b25](https://github.com/sagemath/sagetrac-mirror/commit/5b00b256eabda6e610a9a09c9eeebac5549ea8b8)|`Fixup`|\n|[5343f3b](https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3)|`Use sage-apply-patches in more packages.`|",
    "created_at": "2016-10-14T12:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371483",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[6bee0df](https://github.com/sagemath/sagetrac-mirror/commit/6bee0dfa5f9c779c1049fe569828d4d20ca97379)|`Adds a new sage-apply-patches script.`|
|[fc0d294](https://github.com/sagemath/sagetrac-mirror/commit/fc0d29469dee5d2688bd3716379ac5b2223f5a62)|`Fix accidental duplication of patch_subdir.`|
|[0e1b32c](https://github.com/sagemath/sagetrac-mirror/commit/0e1b32cd8166303f2856afefd330389654d28a8b)|`Forgot to change this to loop over the full list when I made $patches into a list.`|
|[47c69f1](https://github.com/sagemath/sagetrac-mirror/commit/47c69f113560cf18c9e629699474f52d584f79b9)|`Mathjax doesn't have a source directory to cd into, so uses a different default patch path from most packages.`|
|[d2f3eaa](https://github.com/sagemath/sagetrac-mirror/commit/d2f3eaa159663dd06d33a5bb756f33f04054c466)|`None of these packages currently have patches to apply.`|
|[27cc968](https://github.com/sagemath/sagetrac-mirror/commit/27cc968cd38843efe132a5981b69f8f6efca9e5f)|`Add license notice.`|
|[6c9d6d1](https://github.com/sagemath/sagetrac-mirror/commit/6c9d6d1df2f8cef29ee9e575409241ee4618e289)|`Warn but don't fail if there are no patches to apply`|
|[229199f](https://github.com/sagemath/sagetrac-mirror/commit/229199fc1ccde3034a9d6f58d016456423da16c5)|`Apply sage-apply-patches standard on all packages during spkg-install`|
|[5b00b25](https://github.com/sagemath/sagetrac-mirror/commit/5b00b256eabda6e610a9a09c9eeebac5549ea8b8)|`Fixup`|
|[5343f3b](https://github.com/sagemath/sagetrac-mirror/commit/5343f3bef75da86de5bf2d9d8fffc1ab39f76de3)|`Use sage-apply-patches in more packages.`|



---

archive/issue_comments_371484.json:
```json
{
    "body": "Changing commit from \"2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717\" to \"5343f3bef75da86de5bf2d9d8fffc1ab39f76de3\"",
    "created_at": "2016-10-14T12:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371484",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2c1ec4f6d168d43c3cde20b5b3b7fcb39450b717" to "5343f3bef75da86de5bf2d9d8fffc1ab39f76de3"



---

archive/issue_comments_371485.json:
```json
{
    "body": "<a id='comment:43'></a>\nRebased this yet again, incorporating changes for new packages that were added or updated.  Did a build/test of this branch on Linux and everything looks fine.\n\nI'm clearing the old milestone--will leave it to the release manager to set an appropriate one.",
    "created_at": "2016-10-14T12:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371485",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>
Rebased this yet again, incorporating changes for new packages that were added or updated.  Did a build/test of this branch on Linux and everything looks fine.

I'm clearing the old milestone--will leave it to the release manager to set an appropriate one.



---

archive/issue_comments_371486.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-10-14T12:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371486",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_371487.json:
```json
{
    "body": "<a id='comment:44'></a>\nFrom reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?",
    "created_at": "2016-10-14T12:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371487",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
From reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?



---

archive/issue_comments_371488.json:
```json
{
    "body": "<a id='comment:45'></a>\nIn `build/pkgs/openblas/spkg-install`, you make a non-trivial change. Why that?",
    "created_at": "2016-10-14T13:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371488",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>
In `build/pkgs/openblas/spkg-install`, you make a non-trivial change. Why that?



---

archive/issue_comments_371489.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-10-14T13:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371489",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_371490.json:
```json
{
    "body": "<a id='comment:46'></a>\nAlso, you are deleting `rubiks` patches...",
    "created_at": "2016-10-14T13:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371490",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:46'></a>
Also, you are deleting `rubiks` patches...



---

archive/issue_comments_371491.json:
```json
{
    "body": "<a id='comment:47'></a>\nAnd since you rewrote `git` history anyway, you might as well squash everything to 1 commit.",
    "created_at": "2016-10-14T13:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371491",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>
And since you rewrote `git` history anyway, you might as well squash everything to 1 commit.



---

archive/issue_comments_371492.json:
```json
{
    "body": "<a id='comment:48'></a>\nThe change in openblas is a mistake made in resolving a merge conflict; will revert.",
    "created_at": "2016-10-14T13:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371492",
    "user": "https://github.com/embray"
}
```

<a id='comment:48'></a>
The change in openblas is a mistake made in resolving a merge conflict; will revert.



---

archive/issue_comments_371493.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [jdemeyer](#comment%3A44):\n> From reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?\n\n\nI think earlier, before #20837, it was more necessary to have separate arguments.  But I still kind of like it as is.\n\nThe assumption here is that there is a standard root for patches to a package with *may* have subdirectories.  The reason it's useful to have separate arguments is that `spkg-install` scripts don't need to care where the patch root is, but sometimes it's useful to select subdirectories within it from which to apply other patches.\n\nI'm open to other ideas though.",
    "created_at": "2016-10-14T13:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371493",
    "user": "https://github.com/embray"
}
```

<a id='comment:49'></a>
Replying to [jdemeyer](#comment%3A44):
> From reading the documentation in `sage-apply-patches`, I don't quite understand the meaning of the `[-d patch-subdir]` and `[patch-dir]` arguments. Are these arguments related? If yes, why is it not just 1 argument?


I think earlier, before #20837, it was more necessary to have separate arguments.  But I still kind of like it as is.

The assumption here is that there is a standard root for patches to a package with *may* have subdirectories.  The reason it's useful to have separate arguments is that `spkg-install` scripts don't need to care where the patch root is, but sometimes it's useful to select subdirectories within it from which to apply other patches.

I'm open to other ideas though.



---

archive/issue_comments_371494.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [jdemeyer](#comment%3A46):\n> Also, you are deleting `rubiks` patches...\n\n\nLooks like that's left over from before #21103--it wasn't intentional.  What's odd is that everything worked fine without them so now I question whether they're even necessary but I won't think about that for now.",
    "created_at": "2016-10-14T13:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371494",
    "user": "https://github.com/embray"
}
```

<a id='comment:50'></a>
Replying to [jdemeyer](#comment%3A46):
> Also, you are deleting `rubiks` patches...


Looks like that's left over from before #21103--it wasn't intentional.  What's odd is that everything worked fine without them so now I question whether they're even necessary but I won't think about that for now.



---

archive/issue_comments_371495.json:
```json
{
    "body": "<a id='comment:51'></a>\nAs you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.",
    "created_at": "2016-10-14T14:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371495",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>
As you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.



---

archive/issue_comments_371496.json:
```json
{
    "body": "<a id='comment:52'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[b058fae](https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7)|`Adds a new sage-apply-patches script.`|",
    "created_at": "2016-10-14T14:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371496",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[b058fae](https://github.com/sagemath/sagetrac-mirror/commit/b058fae6f1be3ca0a85007a3a3eb48daff97dab7)|`Adds a new sage-apply-patches script.`|



---

archive/issue_comments_371497.json:
```json
{
    "body": "Changing commit from \"5343f3bef75da86de5bf2d9d8fffc1ab39f76de3\" to \"b058fae6f1be3ca0a85007a3a3eb48daff97dab7\"",
    "created_at": "2016-10-14T14:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5343f3bef75da86de5bf2d9d8fffc1ab39f76de3" to "b058fae6f1be3ca0a85007a3a3eb48daff97dab7"



---

archive/issue_comments_371498.json:
```json
{
    "body": "<a id='comment:53'></a>\nI reverted the accidental changes and squashed.  I also want to add documentation about this to the developer docs for maintaining packages.",
    "created_at": "2016-10-14T14:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371498",
    "user": "https://github.com/embray"
}
```

<a id='comment:53'></a>
I reverted the accidental changes and squashed.  I also want to add documentation about this to the developer docs for maintaining packages.



---

archive/issue_comments_371499.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [jdemeyer](#comment%3A51):\n> As you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.\n\n\nI see what you mean about using it inconsistently--well really there's one case of that in singular.  There's a reason for that though.  The way the `spkg-install` for singular is written (talk about \"needless complexity\") is it has a bunch of sub-routine that executes in a loop.  Before each subroutine it cd's in to the `src/` directory (of the *singular* sources, so from the point of view of `spkg-install` that's `src/src` which is different from the default assumption made in `sage-apply-patches`.  \n\nReally if I were using `sage-apply-patches` as I intended here, it should call `sage-apply-patches -d debug \"$PATCH\"` :)  (though it looks like I `cd ..` first, so I guess the `$PATCH` part can go away, maybe...)",
    "created_at": "2016-10-14T14:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371499",
    "user": "https://github.com/embray"
}
```

<a id='comment:54'></a>
Replying to [jdemeyer](#comment%3A51):
> As you probably know, I absolutely hate needless complexity. I see no reason to have two arguments doing essentially the same thing. In your current branch, both kinds of arguments are used, but all use cases could be done with either the `-d patch-subdir` argument or the `patch-dir` argument. So just pick one.


I see what you mean about using it inconsistently--well really there's one case of that in singular.  There's a reason for that though.  The way the `spkg-install` for singular is written (talk about "needless complexity") is it has a bunch of sub-routine that executes in a loop.  Before each subroutine it cd's in to the `src/` directory (of the *singular* sources, so from the point of view of `spkg-install` that's `src/src` which is different from the default assumption made in `sage-apply-patches`.  

Really if I were using `sage-apply-patches` as I intended here, it should call `sage-apply-patches -d debug "$PATCH"` :)  (though it looks like I `cd ..` first, so I guess the `$PATCH` part can go away, maybe...)



---

archive/issue_comments_371500.json:
```json
{
    "body": "Changing commit from \"b058fae6f1be3ca0a85007a3a3eb48daff97dab7\" to \"f92d0eff9c063c6f418208ac25ac9f42bf4502a9\"",
    "created_at": "2016-10-14T14:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b058fae6f1be3ca0a85007a3a3eb48daff97dab7" to "f92d0eff9c063c6f418208ac25ac9f42bf4502a9"



---

archive/issue_comments_371501.json:
```json
{
    "body": "<a id='comment:55'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[f92d0ef](https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9)|`Use the -d argument to sage-apply-patches instead`|",
    "created_at": "2016-10-14T14:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[f92d0ef](https://github.com/sagemath/sagetrac-mirror/commit/f92d0eff9c063c6f418208ac25ac9f42bf4502a9)|`Use the -d argument to sage-apply-patches instead`|



---

archive/issue_comments_371502.json:
```json
{
    "body": "<a id='comment:56'></a>\nAs for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).\n\nThat said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is \"needless complexity\".",
    "created_at": "2016-10-14T14:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371502",
    "user": "https://github.com/embray"
}
```

<a id='comment:56'></a>
As for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).

That said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is "needless complexity".



---

archive/issue_comments_371503.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-10-14T14:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371503",
    "user": "https://github.com/embray"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_371504.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [embray](#comment%3A56):\n> As for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).\n> \n> That said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is \"needless complexity\".\n\n\n(FWIW if I were to choose one to remove it would be `patch-dir` since now it's not used.)\n\nAlso setting back to needs_work because I still need to update the documentation.",
    "created_at": "2016-10-14T14:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371504",
    "user": "https://github.com/embray"
}
```

<a id='comment:58'></a>
Replying to [embray](#comment%3A56):
> As for the arguments I think I'll leave them as is.  As of now the `patch-dir` argument is not used explicitly which is *good*, as it implies uniformity across the `spkg-installs` (previously there was less uniformity and I think both use cases were used).
> 
> That said, it would be more work now to remove it than to leave it as is, as it is completely harmless.  And not having it limits the script's applicability to other problems that may arise in the future.  I do not think it is "needless complexity".


(FWIW if I were to choose one to remove it would be `patch-dir` since now it's not used.)

Also setting back to needs_work because I still need to update the documentation.



---

archive/issue_comments_371505.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-10-14T14:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371505",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_371506.json:
```json
{
    "body": "Changing commit from \"f92d0eff9c063c6f418208ac25ac9f42bf4502a9\" to \"ed68c76ed23b611db471f60aac37b5222b4f740b\"",
    "created_at": "2016-10-17T11:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f92d0eff9c063c6f418208ac25ac9f42bf4502a9" to "ed68c76ed23b611db471f60aac37b5222b4f740b"



---

archive/issue_comments_371507.json:
```json
{
    "body": "<a id='comment:59'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[928528c](https://github.com/sagemath/sagetrac-mirror/commit/928528c64944f5f64a4d97eccf037ef2ad6e0dc6)|`Adds a new sage-apply-patches script.`|\n|[5f76324](https://github.com/sagemath/sagetrac-mirror/commit/5f76324a8781aedfdca7dba9966ce48e217ddaa3)|`Use the -d argument to sage-apply-patches instead`|\n|[ed68c76](https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b)|`Added some updated documentation about how to apply patches`|",
    "created_at": "2016-10-17T11:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371507",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[928528c](https://github.com/sagemath/sagetrac-mirror/commit/928528c64944f5f64a4d97eccf037ef2ad6e0dc6)|`Adds a new sage-apply-patches script.`|
|[5f76324](https://github.com/sagemath/sagetrac-mirror/commit/5f76324a8781aedfdca7dba9966ce48e217ddaa3)|`Use the -d argument to sage-apply-patches instead`|
|[ed68c76](https://github.com/sagemath/sagetrac-mirror/commit/ed68c76ed23b611db471f60aac37b5222b4f740b)|`Added some updated documentation about how to apply patches`|



---

archive/issue_comments_371508.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-10-17T11:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371508",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_371509.json:
```json
{
    "body": "<a id='comment:60'></a>\nRebased again, and updated the docs.  Can we please move forward on merging this before I have to rebase again?  If you *really* want to change something about `sage-apply-patches` we can do that separately, but this works now as-is.",
    "created_at": "2016-10-17T11:51:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371509",
    "user": "https://github.com/embray"
}
```

<a id='comment:60'></a>
Rebased again, and updated the docs.  Can we please move forward on merging this before I have to rebase again?  If you *really* want to change something about `sage-apply-patches` we can do that separately, but this works now as-is.



---

archive/issue_comments_371510.json:
```json
{
    "body": "<a id='comment:61'></a>\nNote to self: double-check `fricas`, `frobby`, `gap3`, `gfan`, `scipoptsuite`",
    "created_at": "2016-10-18T08:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371510",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:61'></a>
Note to self: double-check `fricas`, `frobby`, `gap3`, `gfan`, `scipoptsuite`



---

archive/issue_comments_371511.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-10-18T10:33:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371511",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_371512.json:
```json
{
    "body": "<a id='comment:62'></a>\nThis conflicts with #17254. I suggest that you merge that branch.",
    "created_at": "2016-10-18T10:33:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371512",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:62'></a>
This conflicts with #17254. I suggest that you merge that branch.



---

archive/issue_comments_371513.json:
```json
{
    "body": "Changing dependencies from \"#21103\" to \"#17254\"",
    "created_at": "2016-10-18T10:33:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371513",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#21103" to "#17254"



---

archive/issue_comments_371514.json:
```json
{
    "body": "<a id='comment:63'></a>\nAlso, since you have to change this branch anyway: could you remove the line `echo \"Applying Sage-specific patches\"` from `sage-spkg`? That is not needed since `sage-apply-patches` is sufficiently verbose. That message could actually be confusing if there are no patches to apply.",
    "created_at": "2016-10-18T10:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371514",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:63'></a>
Also, since you have to change this branch anyway: could you remove the line `echo "Applying Sage-specific patches"` from `sage-spkg`? That is not needed since `sage-apply-patches` is sufficiently verbose. That message could actually be confusing if there are no patches to apply.



---

archive/issue_comments_371515.json:
```json
{
    "body": "<a id='comment:64'></a>\nAnother detail: the `pushd`/`popd` is also verbose:\n\n```\n[gsl-2.1] Finished extraction\n[gsl-2.1] Applying Sage-specific patches\n[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1/src /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1\n[gsl-2.1] No patch files found in ../patches\n[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1\n[gsl-2.1] ****************************************************\n```\nThis should be silenced",
    "created_at": "2016-10-18T11:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371515",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:64'></a>
Another detail: the `pushd`/`popd` is also verbose:

```
[gsl-2.1] Finished extraction
[gsl-2.1] Applying Sage-specific patches
[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1/src /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1
[gsl-2.1] No patch files found in ../patches
[gsl-2.1] /usr/local/src/sage-git/local/var/tmp/sage/build/gsl-2.1
[gsl-2.1] ****************************************************
```
This should be silenced



---

archive/issue_comments_371516.json:
```json
{
    "body": "Changing dependencies from \"#17254\" to \"#17254, #21721\"",
    "created_at": "2016-10-18T13:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371516",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#17254" to "#17254, #21721"



---

archive/issue_comments_371517.json:
```json
{
    "body": "<a id='comment:65'></a>\nSome packages still use non-standard patching: #21721",
    "created_at": "2016-10-18T13:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371517",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:65'></a>
Some packages still use non-standard patching: #21721



---

archive/issue_comments_371518.json:
```json
{
    "body": "<a id='comment:66'></a>\nIn `build/pkgs/scipoptsuite/spkg-install`, you are still using both directory arguments:\n\n```\nsage-apply-patches -d scip $SPKGDIR/patches || exit 1\n```\nThis could be\n\n```\nsage-apply-patches \"$SPKGDIR/patches/scip\" || exit $?\n```",
    "created_at": "2016-10-18T13:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371518",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:66'></a>
In `build/pkgs/scipoptsuite/spkg-install`, you are still using both directory arguments:

```
sage-apply-patches -d scip $SPKGDIR/patches || exit 1
```
This could be

```
sage-apply-patches "$SPKGDIR/patches/scip" || exit $?
```



---

archive/issue_comments_371519.json:
```json
{
    "body": "Changing dependencies from \"#17254, #21721\" to \"#17254, #21721, #21722\"",
    "created_at": "2016-10-18T14:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371519",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#17254, #21721" to "#17254, #21721, #21722"



---

archive/issue_comments_371520.json:
```json
{
    "body": "<a id='comment:67'></a>\n`gap3` had more issues, so I created a separate ticket: #21722",
    "created_at": "2016-10-18T14:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371520",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:67'></a>
`gap3` had more issues, so I created a separate ticket: #21722



---

archive/issue_comments_371521.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently).  It also updates those `spkg-install`s to use it where appropriate.\n+This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.\n \n I'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.\n``````\n",
    "created_at": "2016-10-28T23:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371521",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently).  It also updates those `spkg-install`s to use it where appropriate.
+This adds a new script to `build/bin` called `sage-apply-patches` which implements the same code that is copy/pasted through many of the `spkg-install` scripts (albeit often inconsistently). The patches in `build/pkgs/PKGNAME/patches` are now applied automatically.
 
 I'm not attached to any of the details of how the script works--the implementation was designed mostly to make it easiest to automatically replace the existing repeated code snippet with minimal effort.
``````




---

archive/issue_comments_371522.json:
```json
{
    "body": "Changing dependencies from \"#17254, #21721, #21722\" to \"#21721, #21722\"",
    "created_at": "2016-10-28T23:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371522",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#17254, #21721, #21722" to "#21721, #21722"



---

archive/issue_comments_371523.json:
```json
{
    "body": "<a id='comment:69'></a>\nAll dependencies are merged now, so please rebase to latest `7.5.beta1`.",
    "created_at": "2016-10-31T21:09:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371523",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:69'></a>
All dependencies are merged now, so please rebase to latest `7.5.beta1`.



---

archive/issue_comments_371524.json:
```json
{
    "body": "Changing dependencies from \"#21721, #21722\" to \"\"",
    "created_at": "2016-10-31T21:09:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371524",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#21721, #21722" to ""



---

archive/issue_comments_371525.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#21676, #21792\"",
    "created_at": "2016-11-01T09:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371525",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#21676, #21792"



---

archive/issue_comments_371526.json:
```json
{
    "body": "<a id='comment:71'></a>\nAll dependencies are not merged now....",
    "created_at": "2016-11-07T13:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371526",
    "user": "https://github.com/embray"
}
```

<a id='comment:71'></a>
All dependencies are not merged now....



---

archive/issue_comments_371527.json:
```json
{
    "body": "<a id='comment:72'></a>\nReplying to [embray](#comment%3A71):\n> All dependencies are not merged now....\n\n\nNo, because I added two dependencies which would otherwise conflict.",
    "created_at": "2016-11-07T13:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371527",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:72'></a>
Replying to [embray](#comment%3A71):
> All dependencies are not merged now....


No, because I added two dependencies which would otherwise conflict.



---

archive/issue_comments_371528.json:
```json
{
    "body": "<a id='comment:73'></a>\nYou could just merge those two dependencies in this branch.",
    "created_at": "2016-11-07T13:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371528",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:73'></a>
You could just merge those two dependencies in this branch.



---

archive/issue_comments_371529.json:
```json
{
    "body": "<a id='comment:74'></a>\nneeds rebasing",
    "created_at": "2016-11-18T01:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371529",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:74'></a>
needs rebasing



---

archive/issue_comments_371530.json:
```json
{
    "body": "Changing dependencies from \"#21676, #21792\" to \"\"",
    "created_at": "2016-11-18T06:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371530",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#21676, #21792" to ""



---

archive/issue_comments_371531.json:
```json
{
    "body": "Changing commit from \"ed68c76ed23b611db471f60aac37b5222b4f740b\" to \"0968ec08336fe9d90df740a514c39e91495a9930\"",
    "created_at": "2016-11-21T14:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371531",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ed68c76ed23b611db471f60aac37b5222b4f740b" to "0968ec08336fe9d90df740a514c39e91495a9930"



---

archive/issue_comments_371532.json:
```json
{
    "body": "<a id='comment:76'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[f187f9c](https://github.com/sagemath/sagetrac-mirror/commit/f187f9ccb5faed5b15eb0c22673de25956935c35)|`Adds a new sage-apply-patches script.`|\n|[0968ec0](https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930)|`Added some updated documentation about how to apply patches`|",
    "created_at": "2016-11-21T14:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371532",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:76'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[f187f9c](https://github.com/sagemath/sagetrac-mirror/commit/f187f9ccb5faed5b15eb0c22673de25956935c35)|`Adds a new sage-apply-patches script.`|
|[0968ec0](https://github.com/sagemath/sagetrac-mirror/commit/0968ec08336fe9d90df740a514c39e91495a9930)|`Added some updated documentation about how to apply patches`|



---

archive/issue_comments_371533.json:
```json
{
    "body": "<a id='comment:77'></a>\nRebased again.",
    "created_at": "2016-11-21T14:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371533",
    "user": "https://github.com/embray"
}
```

<a id='comment:77'></a>
Rebased again.



---

archive/issue_comments_371534.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-11-21T14:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371534",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_371535.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-11-21T14:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371535",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_371536.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-21T14:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371536",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_371537.json:
```json
{
    "body": "<a id='comment:79'></a>\nSorry--misclicked.",
    "created_at": "2016-11-21T14:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371537",
    "user": "https://github.com/embray"
}
```

<a id='comment:79'></a>
Sorry--misclicked.



---

archive/issue_comments_371538.json:
```json
{
    "body": "<a id='comment:80'></a>\nPlease fix [comment:63], [comment:64], [comment:66]. Those are trivial things which can easily be fixed.",
    "created_at": "2016-11-22T16:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371538",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:80'></a>
Please fix [comment:63], [comment:64], [comment:66]. Those are trivial things which can easily be fixed.



---

archive/issue_comments_371539.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-11-22T16:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371539",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_371540.json:
```json
{
    "body": "<a id='comment:81'></a>\nThe way `sage-apply-patches` is being invoked in scipoptsuite/spkg-install is actually exactly how those options are meant to be used but whatever.",
    "created_at": "2016-11-23T10:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371540",
    "user": "https://github.com/embray"
}
```

<a id='comment:81'></a>
The way `sage-apply-patches` is being invoked in scipoptsuite/spkg-install is actually exactly how those options are meant to be used but whatever.



---

archive/issue_comments_371541.json:
```json
{
    "body": "Changing commit from \"0968ec08336fe9d90df740a514c39e91495a9930\" to \"addd3ee9804571bcca63da0667100a7bce4fffe0\"",
    "created_at": "2016-11-23T10:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371541",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0968ec08336fe9d90df740a514c39e91495a9930" to "addd3ee9804571bcca63da0667100a7bce4fffe0"



---

archive/issue_comments_371542.json:
```json
{
    "body": "<a id='comment:82'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[e842689](https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c)|`Adds a new sage-apply-patches script.`|\n|[02e8b04](https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57)|`Added some updated documentation about how to apply patches`|\n|[addd3ee](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)|`Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.`|",
    "created_at": "2016-11-23T10:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:82'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[e842689](https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c)|`Adds a new sage-apply-patches script.`|
|[02e8b04](https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57)|`Added some updated documentation about how to apply patches`|
|[addd3ee](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)|`Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.`|



---

archive/issue_comments_371543.json:
```json
{
    "body": "<a id='comment:83'></a>\nNew commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[e842689](https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c)|`Adds a new sage-apply-patches script.`|\n|[02e8b04](https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57)|`Added some updated documentation about how to apply patches`|\n|[addd3ee](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)|`Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.`|",
    "created_at": "2016-11-23T10:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371543",
    "user": "https://github.com/embray"
}
```

<a id='comment:83'></a>
New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[e842689](https://github.com/sagemath/sagetrac-mirror/commit/e8426898c5869f6e6ecd653aa75f759ebfd0d35c)|`Adds a new sage-apply-patches script.`|
|[02e8b04](https://github.com/sagemath/sagetrac-mirror/commit/02e8b04173662bc2ead0284a2cb37f9891375c57)|`Added some updated documentation about how to apply patches`|
|[addd3ee](https://github.com/sagemath/sagetrac-mirror/commit/addd3ee9804571bcca63da0667100a7bce4fffe0)|`Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.`|



---

archive/issue_comments_371544.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-23T10:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371544",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_371545.json:
```json
{
    "body": "<a id='comment:84'></a>\nI have no further objections. I'm currently building Sage from scratch with this branch. If this works fine, I will set this to positive_review (hoping that there are no conflicts).",
    "created_at": "2016-11-23T14:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371545",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:84'></a>
I have no further objections. I'm currently building Sage from scratch with this branch. If this works fine, I will set this to positive_review (hoping that there are no conflicts).



---

archive/issue_comments_371546.json:
```json
{
    "body": "<a id='comment:85'></a>\nAwesome, thanks!",
    "created_at": "2016-11-23T15:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371546",
    "user": "https://github.com/embray"
}
```

<a id='comment:85'></a>
Awesome, thanks!



---

archive/issue_comments_371547.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-11-23T21:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371547",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_071108.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-23T21:59:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20692#event-71108"
}
```



---

archive/issue_comments_371548.json:
```json
{
    "body": "<a id='comment:87'></a>\nMerge conflict",
    "created_at": "2016-11-24T23:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371548",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:87'></a>
Merge conflict



---

archive/issue_comments_371549.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-11-24T23:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371549",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_371550.json:
```json
{
    "body": "<a id='comment:88'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[ad5dcd6](https://github.com/sagemath/sagetrac-mirror/commit/ad5dcd6c07baf4550b20c4b6d78002659ae8095f)|`Adds a new sage-apply-patches script.`|\n|[2858b5f](https://github.com/sagemath/sagetrac-mirror/commit/2858b5f1b7077c354a39777a440d2f08e2afd8c5)|`Added some updated documentation about how to apply patches`|\n|[52a8ca0](https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391)|`Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.`|",
    "created_at": "2016-11-29T09:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371550",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:88'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[ad5dcd6](https://github.com/sagemath/sagetrac-mirror/commit/ad5dcd6c07baf4550b20c4b6d78002659ae8095f)|`Adds a new sage-apply-patches script.`|
|[2858b5f](https://github.com/sagemath/sagetrac-mirror/commit/2858b5f1b7077c354a39777a440d2f08e2afd8c5)|`Added some updated documentation about how to apply patches`|
|[52a8ca0](https://github.com/sagemath/sagetrac-mirror/commit/52a8ca0bafb373c7af7955f9b979fa9438b9d391)|`Reduce verbosity--no need for the 'Applying' message, and no real need to use pushd/popd either since sage-apply-patches does not change directories.`|



---

archive/issue_comments_371551.json:
```json
{
    "body": "Changing commit from \"addd3ee9804571bcca63da0667100a7bce4fffe0\" to \"52a8ca0bafb373c7af7955f9b979fa9438b9d391\"",
    "created_at": "2016-11-29T09:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371551",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "addd3ee9804571bcca63da0667100a7bce4fffe0" to "52a8ca0bafb373c7af7955f9b979fa9438b9d391"



---

archive/issue_comments_371552.json:
```json
{
    "body": "<a id='comment:89'></a>\nRebased.",
    "created_at": "2016-11-29T09:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371552",
    "user": "https://github.com/embray"
}
```

<a id='comment:89'></a>
Rebased.



---

archive/issue_comments_371553.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-11-29T09:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371553",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_371554.json:
```json
{
    "body": "Changing branch from \"u/embray/patch-cleanup\" to \"u/jdemeyer/patch-cleanup\"",
    "created_at": "2016-11-29T11:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371554",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/embray/patch-cleanup" to "u/jdemeyer/patch-cleanup"



---

archive/issue_comments_371555.json:
```json
{
    "body": "<a id='comment:91'></a>\nI fixed a minor bikeshed: I prefer no newline after `./configure` in\n\n```\n./configure ...\n\nif [ $? -ne 0 ]; then\n    ...\nfi\n```\nIt makes it more clear that the `if` really belongs with the `./configure`.\n\nI don't know if you intentionally added a newline there in `build/pkgs/cysignals/spkg-install`, but I removed it now. I also squashed the commits together.\n\n---\nNew commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[b6b33cd](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)|`Adds a new sage-apply-patches script.`|",
    "created_at": "2016-11-29T11:21:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371555",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:91'></a>
I fixed a minor bikeshed: I prefer no newline after `./configure` in

```
./configure ...

if [ $? -ne 0 ]; then
    ...
fi
```
It makes it more clear that the `if` really belongs with the `./configure`.

I don't know if you intentionally added a newline there in `build/pkgs/cysignals/spkg-install`, but I removed it now. I also squashed the commits together.

---
New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[b6b33cd](https://github.com/sagemath/sagetrac-mirror/commit/b6b33cdbb33ba7eb856cb283c296250976e1638c)|`Adds a new sage-apply-patches script.`|



---

archive/issue_comments_371556.json:
```json
{
    "body": "Changing commit from \"52a8ca0bafb373c7af7955f9b979fa9438b9d391\" to \"b6b33cdbb33ba7eb856cb283c296250976e1638c\"",
    "created_at": "2016-11-29T11:21:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371556",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "52a8ca0bafb373c7af7955f9b979fa9438b9d391" to "b6b33cdbb33ba7eb856cb283c296250976e1638c"



---

archive/issue_events_071109.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-11-30T19:36:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20692#event-71109"
}
```



---

archive/issue_comments_371557.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-30T19:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371557",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_371558.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/patch-cleanup\" to \"b6b33cdbb33ba7eb856cb283c296250976e1638c\"",
    "created_at": "2016-11-30T19:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371558",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/patch-cleanup" to "b6b33cdbb33ba7eb856cb283c296250976e1638c"



---

archive/issue_comments_371559.json:
```json
{
    "body": "<a id='comment:93'></a>\nFinally merged, thanks Erik!",
    "created_at": "2016-12-02T06:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371559",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:93'></a>
Finally merged, thanks Erik!



---

archive/issue_comments_371560.json:
```json
{
    "body": "Changing commit from \"b6b33cdbb33ba7eb856cb283c296250976e1638c\" to \"\"",
    "created_at": "2016-12-02T06:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371560",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "b6b33cdbb33ba7eb856cb283c296250976e1638c" to ""



---

archive/issue_comments_371561.json:
```json
{
    "body": "<a id='comment:94'></a>\nHooray!\n*pours you a champagne*",
    "created_at": "2016-12-02T10:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20692",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20692#issuecomment-371561",
    "user": "https://github.com/embray"
}
```

<a id='comment:94'></a>
Hooray!
*pours you a champagne*
