# Issue 20901: Upgrade bliss package to 0.73 with Debian patches; install header files in location expected by polymake

archive/issues_020664.json:
```json
{
    "body": "New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)\n\nUpstream bliss does not have a proper build system (in particular no 'make install').\n\"spkg-install\" installs header files with generic names such as \"graph.hh\" flat into $SAGE_LOCAL/include/\n\nDebian has https://packages.debian.org/sid/math/bliss\nwhich autotoolizes the package and adjust the include file location.\nThis matches where Polymake (#20892) expects the header files.\n\nOn https://github.com/mkoeppe/bliss in branch `sage_package` I have applied the Debian patches and a few more patches for Sage. The `spkg-src` script clones from there and builds a distribution. The result is available here: \n\ntarball: https://github.com/mkoeppe/bliss/releases/download/sage_package%2F0.73%2Bdebian-1%2Bsage-2016-08-02/bliss-0.73.debian-1.sage-2016-08-02.tar.gz (rename to `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`)\n\n\n\nCC:  azi @jdemeyer @videlec @kcrisman @dimpase @fchapoton stumpc5 @mo271 @vbraun\n\nUpstream: Reported upstream. No feedback yet.\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: c0c0427e4e4f728380b5b23d9fbbd870a0ba30fa\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20901\n\n",
    "closed_at": "2016-08-07T20:01:33Z",
    "created_at": "2016-06-28T23:54:15Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Upgrade bliss package to 0.73 with Debian patches; install header files in location expected by polymake",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20901",
    "user": "https://github.com/mkoeppe"
}
```
New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)

Upstream bliss does not have a proper build system (in particular no 'make install').
"spkg-install" installs header files with generic names such as "graph.hh" flat into $SAGE_LOCAL/include/

Debian has https://packages.debian.org/sid/math/bliss
which autotoolizes the package and adjust the include file location.
This matches where Polymake (#20892) expects the header files.

On https://github.com/mkoeppe/bliss in branch `sage_package` I have applied the Debian patches and a few more patches for Sage. The `spkg-src` script clones from there and builds a distribution. The result is available here: 

tarball: https://github.com/mkoeppe/bliss/releases/download/sage_package%2F0.73%2Bdebian-1%2Bsage-2016-08-02/bliss-0.73.debian-1.sage-2016-08-02.tar.gz (rename to `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`)



CC:  azi @jdemeyer @videlec @kcrisman @dimpase @fchapoton stumpc5 @mo271 @vbraun

Upstream: Reported upstream. No feedback yet.

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Branch: c0c0427e4e4f728380b5b23d9fbbd870a0ba30fa

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20901





---

archive/issue_comments_303677.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-15T19:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303677",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_303678.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -7,7 +7,10 @@\n which autotoolizes the package and adjust the include file location.\n This matches where Polymake (#20892) expects the header files.\n \n-We should really be using Debian as our upstream for this package.\n+Autotoolized package using the Debian patches is available here: \n+https://github.com/mkoeppe/bliss/releases/download/apply_debian_patches%2F0.73-1/bliss-0.73.debian-1.tar.gz\n+\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2016-07-15T19:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303678",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -7,7 +7,10 @@
 which autotoolizes the package and adjust the include file location.
 This matches where Polymake (#20892) expects the header files.
 
-We should really be using Debian as our upstream for this package.
+Autotoolized package using the Debian patches is available here: 
+https://github.com/mkoeppe/bliss/releases/download/apply_debian_patches%2F0.73-1/bliss-0.73.debian-1.tar.gz
+
+
 
 Comment: 1
 
```




---

archive/issue_comments_303679.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2016-07-15T19:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303679",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_303680.json:
```json
{
    "body": "<a id='comment:5'></a>Needs review. Prerequisite for polymake (#20892).",
    "created_at": "2016-07-16T12:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303680",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Needs review. Prerequisite for polymake (#20892).



---

archive/issue_comments_303681.json:
```json
{
    "body": "<a id='comment:6'></a>what are the new goodies? a shared library?",
    "created_at": "2016-07-16T14:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303681",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>what are the new goodies? a shared library?



---

archive/issue_comments_303682.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 dimpase]:\n> what are the new goodies? a shared library?\n\n\nA shared library, proper include files location, and as a result works as a prerequisite for polymake.\nNew upstream version -- but upstream is silent about what has changed compared to 0.72.",
    "created_at": "2016-07-16T16:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303682",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Replying to [comment:6 dimpase]:
> what are the new goodies? a shared library?


A shared library, proper include files location, and as a result works as a prerequisite for polymake.
New upstream version -- but upstream is silent about what has changed compared to 0.72.



---

archive/issue_comments_303683.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-16T18:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303683",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_303684.json:
```json
{
    "body": "<a id='comment:9'></a>The usual way to ship packages in Sage is to start from the original unmodified sources and then apply patches (either at packaging time or at build time). Here, you are instead forking upstream for no clear reason.",
    "created_at": "2016-07-17T07:33:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303684",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>The usual way to ship packages in Sage is to start from the original unmodified sources and then apply patches (either at packaging time or at build time). Here, you are instead forking upstream for no clear reason.



---

archive/issue_comments_303685.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-17T09:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303685",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_303686.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:9 jdemeyer]:\n> The usual way to ship packages in Sage is to start from the original unmodified sources and then apply patches (either at packaging time or at build time). Here, you are instead forking upstream for no clear reason.\n\n\nOK, I've changed it to using upstream + a patch.\nUnfortunately our patches cannot be as elegant as Debian's because we cannot rely on the availability of autotools. So my patch has to ship the whole autogenerated build system.",
    "created_at": "2016-07-17T09:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303686",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>Replying to [comment:9 jdemeyer]:
> The usual way to ship packages in Sage is to start from the original unmodified sources and then apply patches (either at packaging time or at build time). Here, you are instead forking upstream for no clear reason.


OK, I've changed it to using upstream + a patch.
Unfortunately our patches cannot be as elegant as Debian's because we cannot rely on the availability of autotools. So my patch has to ship the whole autogenerated build system.



---

archive/issue_comments_303687.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,15 @@\n+New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)\n+\n+Upstream bliss does not have a proper build system (in particular no 'make install').\n+\"spkg-install\" installs header files with generic names such as \"graph.hh\" flat into $SAGE_LOCAL/include/\n+\n+Debian has https://packages.debian.org/sid/math/bliss\n+which autotoolizes the package and adjust the include file location.\n+This matches where Polymake (#20892) expects the header files.\n+\n+The patch in this package is generated by making a diff from the original tarball with the distribution here: \n+https://github.com/mkoeppe/bliss/releases/download/apply_debian_patches%2F0.73-1/bliss-0.73.debian-1.tar.gz\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2016-07-17T09:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303687",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,15 @@
+New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)
+
+Upstream bliss does not have a proper build system (in particular no 'make install').
+"spkg-install" installs header files with generic names such as "graph.hh" flat into $SAGE_LOCAL/include/
+
+Debian has https://packages.debian.org/sid/math/bliss
+which autotoolizes the package and adjust the include file location.
+This matches where Polymake (#20892) expects the header files.
+
+The patch in this package is generated by making a diff from the original tarball with the distribution here: 
+https://github.com/mkoeppe/bliss/releases/download/apply_debian_patches%2F0.73-1/bliss-0.73.debian-1.tar.gz
+
 
 
 Comment: 1
```




---

archive/issue_comments_303688.json:
```json
{
    "body": "<a id='comment:12'></a>Learn to write a `spkg-src` file like for `ecl` \nhttps://github.com/sagemath/sage/blob/master/build/pkgs/ecl/spkg-src\nor `glpk` at #20710. It will require you to produce a new tarball and host it somewhere until the ticket is merged.",
    "created_at": "2016-07-18T11:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303688",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:12'></a>Learn to write a `spkg-src` file like for `ecl` 
https://github.com/sagemath/sage/blob/master/build/pkgs/ecl/spkg-src
or `glpk` at #20710. It will require you to produce a new tarball and host it somewhere until the ticket is merged.



---

archive/issue_comments_303689.json:
```json
{
    "body": "<a id='comment:13'></a>yeah, `spkg-src` is important, as you don't want to become the only one in state to perform an update...",
    "created_at": "2016-07-20T08:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303689",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>yeah, `spkg-src` is important, as you don't want to become the only one in state to perform an update...



---

archive/issue_comments_303690.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-26T07:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303690",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_303691.json:
```json
{
    "body": "<a id='comment:14'></a>Unfortunately this update causes some tests to fail with segfault.\n\n```\nage:             sage: g3 = polytopes.hypercube(3).vertex_graph(); g3\nGraph on 8 vertices\nsage:             sage: g3.automorphism_group().cardinality()\npython(2197,0x7fff7b8f9000) malloc: *** error for object 0x1001d3fff: pointer being realloc'd was not allocated\n*** set a breakpoint in malloc_error_break to debug\n\nProgram received signal SIGABRT, Aborted.\n0x00007fff8b2cff06 in __pthread_kill () from /usr/lib/system/libsystem_kernel.dylib\n(gdb) where\n#0  0x00007fff8b2cff06 in __pthread_kill () from /usr/lib/system/libsystem_kernel.dylib\n#1  0x00007fff92ea14ec in pthread_kill () from /usr/lib/system/libsystem_pthread.dylib\n#2  0x00007fff8ec5c6e7 in abort () from /usr/lib/system/libsystem_c.dylib\n#3  0x00007fff933d879d in realloc () from /usr/lib/system/libsystem_malloc.dylib\n#4  0x0000000107284ddd in __pyx_f_4sage_3ext_6memory_sage_sig_realloc () from /Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/ext/memory.so\n#5  0x0000000106afca01 in __gmpz_realloc () from /Users/mkoeppe/cvs/sage/local/lib/libgmp.16.dylib\n#6  0x0000000106af8c0e in __gmpz_mul_si () from /Users/mkoeppe/cvs/sage/local/lib/libgmp.16.dylib\n#7  0x00000001aefad6f0 in ?? () from /Users/mkoeppe/cvs/sage/local/lib/libbliss.2.dylib\n#8  0x00000001aefaf43c in ?? () from /Users/mkoeppe/cvs/sage/local/lib/libbliss.2.dylib\n#9  0x00000001aef96e13 in __pyx_pw_4sage_6graphs_5bliss_1automorphism_group(_object*, _object*, _object*) ()\n   from /Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/graphs/bliss.so\n#10 0x00000001000e92a4 in PyEval_EvalFrameEx () from /Users/mkoeppe/cvs/sage/local/lib/libpython2.7.dylib\n#\n```\nI could use some help here.",
    "created_at": "2016-07-26T07:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303691",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Unfortunately this update causes some tests to fail with segfault.

```
age:             sage: g3 = polytopes.hypercube(3).vertex_graph(); g3
Graph on 8 vertices
sage:             sage: g3.automorphism_group().cardinality()
python(2197,0x7fff7b8f9000) malloc: *** error for object 0x1001d3fff: pointer being realloc'd was not allocated
*** set a breakpoint in malloc_error_break to debug

Program received signal SIGABRT, Aborted.
0x00007fff8b2cff06 in __pthread_kill () from /usr/lib/system/libsystem_kernel.dylib
(gdb) where
#0  0x00007fff8b2cff06 in __pthread_kill () from /usr/lib/system/libsystem_kernel.dylib
#1  0x00007fff92ea14ec in pthread_kill () from /usr/lib/system/libsystem_pthread.dylib
#2  0x00007fff8ec5c6e7 in abort () from /usr/lib/system/libsystem_c.dylib
#3  0x00007fff933d879d in realloc () from /usr/lib/system/libsystem_malloc.dylib
#4  0x0000000107284ddd in __pyx_f_4sage_3ext_6memory_sage_sig_realloc () from /Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/ext/memory.so
#5  0x0000000106afca01 in __gmpz_realloc () from /Users/mkoeppe/cvs/sage/local/lib/libgmp.16.dylib
#6  0x0000000106af8c0e in __gmpz_mul_si () from /Users/mkoeppe/cvs/sage/local/lib/libgmp.16.dylib
#7  0x00000001aefad6f0 in ?? () from /Users/mkoeppe/cvs/sage/local/lib/libbliss.2.dylib
#8  0x00000001aefaf43c in ?? () from /Users/mkoeppe/cvs/sage/local/lib/libbliss.2.dylib
#9  0x00000001aef96e13 in __pyx_pw_4sage_6graphs_5bliss_1automorphism_group(_object*, _object*, _object*) ()
   from /Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/graphs/bliss.so
#10 0x00000001000e92a4 in PyEval_EvalFrameEx () from /Users/mkoeppe/cvs/sage/local/lib/libpython2.7.dylib
#
```
I could use some help here.



---

archive/issue_comments_303692.json:
```json
{
    "body": "<a id='comment:15'></a>Well known problem. Disable `gmp` in `bliss` that's the culprit.",
    "created_at": "2016-07-26T07:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303692",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'></a>Well known problem. Disable `gmp` in `bliss` that's the culprit.



---

archive/issue_comments_303693.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 fbissey]:\n> Well known problem. Disable `gmp` in `bliss` that's the culprit.\n\nThanks!",
    "created_at": "2016-07-26T08:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303693",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [comment:15 fbissey]:
> Well known problem. Disable `gmp` in `bliss` that's the culprit.

Thanks!



---

archive/issue_comments_303694.json:
```json
{
    "body": "<a id='comment:17'></a>Why would `bliss` need `gmp`? Looks strange to me.",
    "created_at": "2016-07-26T09:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303694",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>Why would `bliss` need `gmp`? Looks strange to me.



---

archive/issue_comments_303695.json:
```json
{
    "body": "<a id='comment:18'></a>It's a build option, ask the author.",
    "created_at": "2016-07-26T09:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303695",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:18'></a>It's a build option, ask the author.



---

archive/issue_comments_303696.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,16 @@\n+New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)\n+\n+Upstream bliss does not have a proper build system (in particular no 'make install').\n+\"spkg-install\" installs header files with generic names such as \"graph.hh\" flat into $SAGE_LOCAL/include/\n+\n+Debian has https://packages.debian.org/sid/math/bliss\n+which autotoolizes the package and adjust the include file location.\n+This matches where Polymake (#20892) expects the header files.\n+\n+On https://github.com/mkoeppe/bliss in branch `sage_package` I have applied the Debian patches and a few more patches for Sage. The `spkg-src` script clones from there and builds a distribution. The result is available here: \n+\n+tarball: https://github.com/mkoeppe/bliss/releases/download/sage_package%2F0.73%2Bdebian-1%2Bsage-2016-08-02/bliss-0.73.debian-1.sage-2016-08-02.tar.gz\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2016-08-03T06:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303696",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,16 @@
+New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)
+
+Upstream bliss does not have a proper build system (in particular no 'make install').
+"spkg-install" installs header files with generic names such as "graph.hh" flat into $SAGE_LOCAL/include/
+
+Debian has https://packages.debian.org/sid/math/bliss
+which autotoolizes the package and adjust the include file location.
+This matches where Polymake (#20892) expects the header files.
+
+On https://github.com/mkoeppe/bliss in branch `sage_package` I have applied the Debian patches and a few more patches for Sage. The `spkg-src` script clones from there and builds a distribution. The result is available here: 
+
+tarball: https://github.com/mkoeppe/bliss/releases/download/sage_package%2F0.73%2Bdebian-1%2Bsage-2016-08-02/bliss-0.73.debian-1.sage-2016-08-02.tar.gz
+
 
 
 Comment: 1
```




---

archive/issue_comments_303697.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-03T07:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_303698.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:12 fbissey]:\n> Learn to write a `spkg-src` file \n\n\nThanks, done.\n\nReady for review.",
    "created_at": "2016-08-03T07:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303698",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Replying to [comment:12 fbissey]:
> Learn to write a `spkg-src` file 


Thanks, done.

Ready for review.



---

archive/issue_comments_303699.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-03T07:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303699",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_303700.json:
```json
{
    "body": "<a id='comment:22'></a>there is something funny with tarball name: if I do  sage -i bliss it looks for `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`, while wget with your URL gives `bliss-0.73.debian-1.sage-2016-08-02.tar.gz`.\n\nOK, I renamed the tarball, and was able to run `sage -i bliss`, but the following make fails:\n\n```\n[sagelib-7.3.rc0] building 'sage.graphs.bliss' extension\n[sagelib-7.3.rc0] Executing 1 command (using 1 thread)\n[sagelib-7.3.rc0] [1/1] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/scratch/dimpase/sage/sage/local/include -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -I/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/numpy/core/include -I/home/scratch/dimpase/sage/sage/src -I/home/scratch/dimpase/sage/sage/src/sage/ext -I/home/scratch/dimpase/sage/sage/src/build/cythonized -I/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/ext -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -c /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp -o build/temp.linux-x86_64-2.7/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.o -fno-strict-aliasing\n[sagelib-7.3.rc0] /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp:317:20: fatal error: graph.hh: No such file or directory\n[sagelib-7.3.rc0] compilation terminated.\n[sagelib-7.3.rc0] error: command 'gcc' failed with exit status 1\n```\n\nThis is on Fedora23, Sage 7.3.rc0, with gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC).",
    "created_at": "2016-08-03T08:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303700",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>there is something funny with tarball name: if I do  sage -i bliss it looks for `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`, while wget with your URL gives `bliss-0.73.debian-1.sage-2016-08-02.tar.gz`.

OK, I renamed the tarball, and was able to run `sage -i bliss`, but the following make fails:

```
[sagelib-7.3.rc0] building 'sage.graphs.bliss' extension
[sagelib-7.3.rc0] Executing 1 command (using 1 thread)
[sagelib-7.3.rc0] [1/1] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/scratch/dimpase/sage/sage/local/include -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -I/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/numpy/core/include -I/home/scratch/dimpase/sage/sage/src -I/home/scratch/dimpase/sage/sage/src/sage/ext -I/home/scratch/dimpase/sage/sage/src/build/cythonized -I/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/ext -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -c /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp -o build/temp.linux-x86_64-2.7/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.o -fno-strict-aliasing
[sagelib-7.3.rc0] /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp:317:20: fatal error: graph.hh: No such file or directory
[sagelib-7.3.rc0] compilation terminated.
[sagelib-7.3.rc0] error: command 'gcc' failed with exit status 1
```

This is on Fedora23, Sage 7.3.rc0, with gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC).



---

archive/issue_comments_303701.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 dimpase]:\n> there is something funny with tarball name: if I do  sage -i bliss it looks for `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`, while wget with your URL gives `bliss-0.73.debian-1.sage-2016-08-02.tar.gz`.\n\n\nIt's a limitation of github, it renames `+` to `.`\n\n> OK, I renamed the tarball, and was able to run `sage -i bliss`, but the following make fails:\n> \n> ```\n> [sagelib-7.3.rc0] building 'sage.graphs.bliss' extension\n> [sagelib-7.3.rc0] Executing 1 command (using 1 thread)\n> [sagelib-7.3.rc0] [1/1] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/scratch/dimpase/sage/sage/local/include -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -I/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/numpy/core/include -I/home/scratch/dimpase/sage/sage/src -I/home/scratch/dimpase/sage/sage/src/sage/ext -I/home/scratch/dimpase/sage/sage/src/build/cythonized -I/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/ext -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -c /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp -o build/temp.linux-x86_64-2.7/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.o -fno-strict-aliasing\n> [sagelib-7.3.rc0] /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp:317:20: fatal error: graph.hh: No such file or directory\n> [sagelib-7.3.rc0] compilation terminated.\n> [sagelib-7.3.rc0] error: command 'gcc' failed with exit status 1\n> ```\n> \n> This is on Fedora23, Sage 7.3.rc0, with gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC).\n\n\nThanks for catching this. Fix coming shortly.",
    "created_at": "2016-08-03T08:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303701",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Replying to [comment:22 dimpase]:
> there is something funny with tarball name: if I do  sage -i bliss it looks for `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`, while wget with your URL gives `bliss-0.73.debian-1.sage-2016-08-02.tar.gz`.


It's a limitation of github, it renames `+` to `.`

> OK, I renamed the tarball, and was able to run `sage -i bliss`, but the following make fails:
> 
> ```
> [sagelib-7.3.rc0] building 'sage.graphs.bliss' extension
> [sagelib-7.3.rc0] Executing 1 command (using 1 thread)
> [sagelib-7.3.rc0] [1/1] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/home/scratch/dimpase/sage/sage/local/include -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -I/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/numpy/core/include -I/home/scratch/dimpase/sage/sage/src -I/home/scratch/dimpase/sage/sage/src/sage/ext -I/home/scratch/dimpase/sage/sage/src/build/cythonized -I/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/ext -I/home/scratch/dimpase/sage/sage/local/include/python2.7 -c /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp -o build/temp.linux-x86_64-2.7/home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.o -fno-strict-aliasing
> [sagelib-7.3.rc0] /home/scratch/dimpase/sage/sage/src/build/cythonized/sage/graphs/bliss.cpp:317:20: fatal error: graph.hh: No such file or directory
> [sagelib-7.3.rc0] compilation terminated.
> [sagelib-7.3.rc0] error: command 'gcc' failed with exit status 1
> ```
> 
> This is on Fedora23, Sage 7.3.rc0, with gcc version 5.3.1 20160406 (Red Hat 5.3.1-6) (GCC).


Thanks for catching this. Fix coming shortly.



---

archive/issue_comments_303702.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-03T10:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_303703.json:
```json
{
    "body": "<a id='comment:25'></a>Fixed.",
    "created_at": "2016-08-03T10:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303703",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>Fixed.



---

archive/issue_comments_303704.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,16 @@\n+New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)\n+\n+Upstream bliss does not have a proper build system (in particular no 'make install').\n+\"spkg-install\" installs header files with generic names such as \"graph.hh\" flat into $SAGE_LOCAL/include/\n+\n+Debian has https://packages.debian.org/sid/math/bliss\n+which autotoolizes the package and adjust the include file location.\n+This matches where Polymake (#20892) expects the header files.\n+\n+On https://github.com/mkoeppe/bliss in branch `sage_package` I have applied the Debian patches and a few more patches for Sage. The `spkg-src` script clones from there and builds a distribution. The result is available here: \n+\n+tarball: https://github.com/mkoeppe/bliss/releases/download/sage_package%2F0.73%2Bdebian-1%2Bsage-2016-08-02/bliss-0.73.debian-1.sage-2016-08-02.tar.gz (rename to `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`)\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2016-08-03T10:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303704",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,16 @@
+New upstream archive: http://www.tcs.hut.fi/Software/bliss/bliss-0.73.zip (we have 0.72)
+
+Upstream bliss does not have a proper build system (in particular no 'make install').
+"spkg-install" installs header files with generic names such as "graph.hh" flat into $SAGE_LOCAL/include/
+
+Debian has https://packages.debian.org/sid/math/bliss
+which autotoolizes the package and adjust the include file location.
+This matches where Polymake (#20892) expects the header files.
+
+On https://github.com/mkoeppe/bliss in branch `sage_package` I have applied the Debian patches and a few more patches for Sage. The `spkg-src` script clones from there and builds a distribution. The result is available here: 
+
+tarball: https://github.com/mkoeppe/bliss/releases/download/sage_package%2F0.73%2Bdebian-1%2Bsage-2016-08-02/bliss-0.73.debian-1.sage-2016-08-02.tar.gz (rename to `bliss-0.73+debian-1+sage-2016-08-02.tar.gz`)
+
 
 
 Comment: 1
```




---

archive/issue_comments_303705.json:
```json
{
    "body": "<a id='comment:27'></a>OK, this works. In order to keep the release manager happy, I suggest that you put the tarball somewhere where it can be wget'ed without renaming hassle...",
    "created_at": "2016-08-03T10:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303705",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>OK, this works. In order to keep the release manager happy, I suggest that you put the tarball somewhere where it can be wget'ed without renaming hassle...



---

archive/issue_comments_303706.json:
```json
{
    "body": "<a id='comment:28'></a>Is this a \"positive_review\"?",
    "created_at": "2016-08-04T19:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303706",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>Is this a "positive_review"?



---

archive/issue_comments_303707.json:
```json
{
    "body": "<a id='comment:29'></a>I trust you are able to put the tarball somewhere where the name mangling does not happen. :-)",
    "created_at": "2016-08-04T19:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303707",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>I trust you are able to put the tarball somewhere where the name mangling does not happen. :-)



---

archive/issue_comments_303708.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-04T19:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303708",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_303709.json:
```json
{
    "body": "<a id='comment:30'></a>Thanks, Dima.\n\nVolker - does the upload location of the tarball work for you?",
    "created_at": "2016-08-04T19:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303709",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>Thanks, Dima.

Volker - does the upload location of the tarball work for you?



---

archive/issue_comments_303710.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-07T20:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303710",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_056000.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-07T20:01:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20901#event-56000"
}
```



---

archive/issue_comments_303711.json:
```json
{
    "body": "<a id='comment:33'></a>some patchbots meet compilation problems:\n\n```\n[sagelib-7.4.beta1] /home/worker/sage-patchbot/src/build/cythonized/sage/graphs/bliss.cpp:317:26: fatal error: bliss/graph.hh: No such file or directory\n[sagelib-7.4.beta1]  #include \"bliss/graph.hh\"\n[sagelib-7.4.beta1]                           ^\n[sagelib-7.4.beta1] compilation terminated.\n```",
    "created_at": "2016-08-18T10:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303711",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'></a>some patchbots meet compilation problems:

```
[sagelib-7.4.beta1] /home/worker/sage-patchbot/src/build/cythonized/sage/graphs/bliss.cpp:317:26: fatal error: bliss/graph.hh: No such file or directory
[sagelib-7.4.beta1]  #include "bliss/graph.hh"
[sagelib-7.4.beta1]                           ^
[sagelib-7.4.beta1] compilation terminated.
```



---

archive/issue_comments_303712.json:
```json
{
    "body": "<a id='comment:34'></a>Well, the install location of this header file changed with this upgrade, so the patchbots will have to reinstall the package.",
    "created_at": "2016-08-18T16:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303712",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>Well, the install location of this header file changed with this upgrade, so the patchbots will have to reinstall the package.



---

archive/issue_comments_303713.json:
```json
{
    "body": "<a id='comment:35'></a>I hope that #21288 will fix this.",
    "created_at": "2016-08-19T09:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20901#issuecomment-303713",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>I hope that #21288 will fix this.
