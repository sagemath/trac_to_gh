# Issue 20469: Implement Ariki-Koike algebras

archive/issues_020232.json:
```json
{
    "body": "An Ariki-Koike algebra is the Hecke algebra of the complex reflection group G(r,1,n).\n\nAssignee: sage-combinat\n\nCC:  sage-combinat stumpc5 @AndrewAtLarge @tscrim\n\nKeywords: hecke algebra, complex reflection group, ariki-koike, days93.51\n\nBranch/Commit: daf777ec27554610ab39c5bbe31f74673238c58c\n\nReviewer: Andrew Mathas, Travis Scrimshaw, Sebastian Oehms\n\nAuthor: Travis Scrimshaw, Andrew Mathas\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20469\n\n",
    "closed_at": "2020-03-29T00:24:23Z",
    "created_at": "2016-04-19T19:07:57Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Implement Ariki-Koike algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20469",
    "user": "https://github.com/tscrim"
}
```
An Ariki-Koike algebra is the Hecke algebra of the complex reflection group G(r,1,n).

Assignee: sage-combinat

CC:  sage-combinat stumpc5 @AndrewAtLarge @tscrim

Keywords: hecke algebra, complex reflection group, ariki-koike, days93.51

Branch/Commit: daf777ec27554610ab39c5bbe31f74673238c58c

Reviewer: Andrew Mathas, Travis Scrimshaw, Sebastian Oehms

Author: Travis Scrimshaw, Andrew Mathas

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20469





---

archive/issue_comments_374758.json:
```json
{
    "body": "Changing branch from \"\" to \"public/algebras/ariki_koike_algebras-20469\"",
    "created_at": "2016-05-06T03:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374758",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/algebras/ariki_koike_algebras-20469"



---

archive/issue_comments_374759.json:
```json
{
    "body": "<a id='comment:2'></a>\nHere is the first version. I still have to convert from Ariki-Koike's version to the Hu-Mathas definition, but this version seems to work (in particular, it passed a few of my associativity tests and the relations I tested). There is also more documentation that needs to be added. I'm also not completely satisfied with the default base ring. However, I wanted to get feedback.\n\nNote that the multiplication is highly recursive. In particular, once there is an l<sub>i</sub><sup>r</sup> occurring, it can easily run into Python's recursion limit. It might be possible to work this out with handling the manipulations within the code here or doing parts of the multiplication in bigger chunks. However, this would take a lot of work I think to improve and the code works.\n\nI am also planning on implementing the isomorphism with type A<sub>n</sub>/B<sub>n</sub> Hecke algebras shortly too.\n\n---\nNew commits:\n|                                                                                                                                          |                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[f644c20](https://github.com/sagemath/sagetrac-mirror/commit/f644c20f0c297faf9dc98e4bab70c5985131d390)|`Initial implementation of Ariki-Koike alegbras.`|",
    "created_at": "2016-05-06T03:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374759",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
Here is the first version. I still have to convert from Ariki-Koike's version to the Hu-Mathas definition, but this version seems to work (in particular, it passed a few of my associativity tests and the relations I tested). There is also more documentation that needs to be added. I'm also not completely satisfied with the default base ring. However, I wanted to get feedback.

Note that the multiplication is highly recursive. In particular, once there is an l<sub>i</sub><sup>r</sup> occurring, it can easily run into Python's recursion limit. It might be possible to work this out with handling the manipulations within the code here or doing parts of the multiplication in bigger chunks. However, this would take a lot of work I think to improve and the code works.

I am also planning on implementing the isomorphism with type A<sub>n</sub>/B<sub>n</sub> Hecke algebras shortly too.

---
New commits:
|                                                                                                                                          |                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[f644c20](https://github.com/sagemath/sagetrac-mirror/commit/f644c20f0c297faf9dc98e4bab70c5985131d390)|`Initial implementation of Ariki-Koike alegbras.`|



---

archive/issue_comments_374760.json:
```json
{
    "body": "Changing commit from \"\" to \"f644c20f0c297faf9dc98e4bab70c5985131d390\"",
    "created_at": "2016-05-06T03:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374760",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "f644c20f0c297faf9dc98e4bab70c5985131d390"



---

archive/issue_comments_374761.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks Travis. This looks interesting. I will have a play with it and see if I can improve the multiplication with the tricks that I know about these algebras -- I am not promising that this will be possible, only to look!\n\nSome initial comments: \n- It would be better to use `L1`,`...`,`Ln` for the Jucys-Murphy elements as this is what is commonly used in the literature and it's also consistent with using `T1`,`T2`,`...` for the Hecke generators. Using `l1`,`...`,`ln` looks strange to me.\n- I am not sure that it is worth the effort to define the Hu-Mathas as the algebras that we defined are different to these when `q=1` and, more importantly, the conversion between the two is easy in principle but messy in practice. \n- The default base ring should be the smallest ring that contains `q`, `u0`,...,`ur`.\n- At some stage I will polish the code that I have which implements the Specht modules for these algebras. Given this it would probably be a good idea to put this code in its own subdirectory so that the module code. Similarly, my graded Specht module could go in here to.",
    "created_at": "2016-05-06T04:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374761",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:3'></a>
Thanks Travis. This looks interesting. I will have a play with it and see if I can improve the multiplication with the tricks that I know about these algebras -- I am not promising that this will be possible, only to look!

Some initial comments: 
- It would be better to use `L1`,`...`,`Ln` for the Jucys-Murphy elements as this is what is commonly used in the literature and it's also consistent with using `T1`,`T2`,`...` for the Hecke generators. Using `l1`,`...`,`ln` looks strange to me.
- I am not sure that it is worth the effort to define the Hu-Mathas as the algebras that we defined are different to these when `q=1` and, more importantly, the conversion between the two is easy in principle but messy in practice. 
- The default base ring should be the smallest ring that contains `q`, `u0`,...,`ur`.
- At some stage I will polish the code that I have which implements the Specht modules for these algebras. Given this it would probably be a good idea to put this code in its own subdirectory so that the module code. Similarly, my graded Specht module could go in here to.



---

archive/issue_comments_374762.json:
```json
{
    "body": "Changing commit from \"f644c20f0c297faf9dc98e4bab70c5985131d390\" to \"21a49dfec02d086a07e888ecef48529dffa302b6\"",
    "created_at": "2016-05-06T16:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374762",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f644c20f0c297faf9dc98e4bab70c5985131d390" to "21a49dfec02d086a07e888ecef48529dffa302b6"



---

archive/issue_comments_374763.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------|\n|[79cc757](https://github.com/sagemath/sagetrac-mirror/commit/79cc75797008bca028a95ffecb24b4d37a05997b)|`Changing l -> L.`|\n|[c4b3588](https://github.com/sagemath/sagetrac-mirror/commit/c4b3588a2a37ff1da086aa9189164a158b6b32ec)|`Moving Ariki-Koike algebras to new subfolder for Hecke algebras.`|\n|[fd0097f](https://github.com/sagemath/sagetrac-mirror/commit/fd0097fc53d83f8ccb3f067ae38402bee74660bb)|`Adding more documentation and examples. Doing some fixes.`|\n|[21a49df](https://github.com/sagemath/sagetrac-mirror/commit/21a49dfec02d086a07e888ecef48529dffa302b6)|`Fixing an error with multiplication of the T_i generators.`|",
    "created_at": "2016-05-06T16:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374763",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------|
|[79cc757](https://github.com/sagemath/sagetrac-mirror/commit/79cc75797008bca028a95ffecb24b4d37a05997b)|`Changing l -> L.`|
|[c4b3588](https://github.com/sagemath/sagetrac-mirror/commit/c4b3588a2a37ff1da086aa9189164a158b6b32ec)|`Moving Ariki-Koike algebras to new subfolder for Hecke algebras.`|
|[fd0097f](https://github.com/sagemath/sagetrac-mirror/commit/fd0097fc53d83f8ccb3f067ae38402bee74660bb)|`Adding more documentation and examples. Doing some fixes.`|
|[21a49df](https://github.com/sagemath/sagetrac-mirror/commit/21a49dfec02d086a07e888ecef48529dffa302b6)|`Fixing an error with multiplication of the T_i generators.`|



---

archive/issue_comments_374764.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [andrew.mathas](#comment%3A3):\n> Thanks Travis. This looks interesting. I will have a play with it and see if I can improve the multiplication with the tricks that I know about these algebras -- I am not promising that this will be possible, only to look!\n\n\nGreat, thanks. It is currently so recursive that it fails for `L2 * L1 * L2` in `H(2,2)` (although `L1 * (L2)^2` works).\n\n> - It would be better to use `L1`,`...`,`Ln` for the Jucys-Murphy elements as this is what is commonly used in the literature and it's also consistent with using `T1`,`T2`,`...` for the Hecke generators. Using `l1`,`...`,`ln` looks strange to me.\n\n\nDone.\n\n> - I am not sure that it is worth the effort to define the Hu-Mathas as the algebras that we defined are different to these when `q=1` and, more importantly, the conversion between the two is easy in principle but messy in practice.\n\n\nThis also leads to a question of what do we want to call the Hu-Mathas variant? In the future, we can also add another basis to this for `q \\neq 1`. We also should probably add the basis indexed by the colored permutations (i.e., monomials in `T_0, ..., T_{n-1}`).\n\n> - The default base ring should be the smallest ring that contains `q`, `u0`,...,`ur`.\n\n\nWith `q` invertible, that is what it currently does (just in a slightly funky way that groups the `u`'s together then the `q`'s).\n\n> - At some stage I will polish the code that I have which implements the Specht modules for these algebras. Given this it would probably be a good idea to put this code in its own subdirectory so that the module code. Similarly, my graded Specht module could go in here to.\n\n\nI have moved this into a `hecke_algebras` folder to start. We can move the rest of the Hecke algebras (e.g., Iwahori and Yokonuma) to this folder on a followup ticket.\n\nWhile adding the documentation, I also found some errors with the multiplication that I have fixed.",
    "created_at": "2016-05-06T16:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374764",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Replying to [andrew.mathas](#comment%3A3):
> Thanks Travis. This looks interesting. I will have a play with it and see if I can improve the multiplication with the tricks that I know about these algebras -- I am not promising that this will be possible, only to look!


Great, thanks. It is currently so recursive that it fails for `L2 * L1 * L2` in `H(2,2)` (although `L1 * (L2)^2` works).

> - It would be better to use `L1`,`...`,`Ln` for the Jucys-Murphy elements as this is what is commonly used in the literature and it's also consistent with using `T1`,`T2`,`...` for the Hecke generators. Using `l1`,`...`,`ln` looks strange to me.


Done.

> - I am not sure that it is worth the effort to define the Hu-Mathas as the algebras that we defined are different to these when `q=1` and, more importantly, the conversion between the two is easy in principle but messy in practice.


This also leads to a question of what do we want to call the Hu-Mathas variant? In the future, we can also add another basis to this for `q \neq 1`. We also should probably add the basis indexed by the colored permutations (i.e., monomials in `T_0, ..., T_{n-1}`).

> - The default base ring should be the smallest ring that contains `q`, `u0`,...,`ur`.


With `q` invertible, that is what it currently does (just in a slightly funky way that groups the `u`'s together then the `q`'s).

> - At some stage I will polish the code that I have which implements the Specht modules for these algebras. Given this it would probably be a good idea to put this code in its own subdirectory so that the module code. Similarly, my graded Specht module could go in here to.


I have moved this into a `hecke_algebras` folder to start. We can move the rest of the Hecke algebras (e.g., Iwahori and Yokonuma) to this folder on a followup ticket.

While adding the documentation, I also found some errors with the multiplication that I have fixed.



---

archive/issue_comments_374765.json:
```json
{
    "body": "Changing commit from \"21a49dfec02d086a07e888ecef48529dffa302b6\" to \"76e643fe3b04ff5f78d882311688e92b2aafddd6\"",
    "created_at": "2016-05-07T02:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374765",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "21a49dfec02d086a07e888ecef48529dffa302b6" to "76e643fe3b04ff5f78d882311688e92b2aafddd6"



---

archive/issue_comments_374766.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[76e643f](https://github.com/sagemath/sagetrac-mirror/commit/76e643fe3b04ff5f78d882311688e92b2aafddd6)|`Fixing multiplication the other way.`|",
    "created_at": "2016-05-07T02:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374766",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[76e643f](https://github.com/sagemath/sagetrac-mirror/commit/76e643fe3b04ff5f78d882311688e92b2aafddd6)|`Fixing multiplication the other way.`|



---

archive/issue_comments_374767.json:
```json
{
    "body": "Changing commit from \"76e643fe3b04ff5f78d882311688e92b2aafddd6\" to \"e9b6a594ae1e089b51b37081f35743402447a960\"",
    "created_at": "2016-07-12T22:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374767",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "76e643fe3b04ff5f78d882311688e92b2aafddd6" to "e9b6a594ae1e089b51b37081f35743402447a960"



---

archive/issue_comments_374768.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[bcd1ef4](https://github.com/sagemath/sagetrac-mirror/commit/bcd1ef47513863a6c065cb101373a00dcd3f2308)|`Initial implementation of Ariki-Koike alegbras.`|\n|[93b57ff](https://github.com/sagemath/sagetrac-mirror/commit/93b57ff5687ee39b75014ca323cd5a17a3f3cca5)|`Changing l -> L.`|\n|[a98d138](https://github.com/sagemath/sagetrac-mirror/commit/a98d138d39e89b3d521d2b8d1161c04ce4412361)|`Moving Ariki-Koike algebras to new subfolder for Hecke algebras.`|\n|[5e739ba](https://github.com/sagemath/sagetrac-mirror/commit/5e739babc03cf6694ffa574118b59e007f0fd8b6)|`Adding more documentation and examples. Doing some fixes.`|\n|[f5f5795](https://github.com/sagemath/sagetrac-mirror/commit/f5f5795774a550477928886e346e06e5be723e2c)|`Fixing an error with multiplication of the T_i generators.`|\n|[13fdc45](https://github.com/sagemath/sagetrac-mirror/commit/13fdc45a7344c34370b3fdfb360d1d68fdcb627b)|`Fixing multiplication the other way.`|\n|[dae0031](https://github.com/sagemath/sagetrac-mirror/commit/dae0031049f5bd6e51576a57308c57fd71a3fe92)|`Initial review`|\n|[f9cd185](https://github.com/sagemath/sagetrac-mirror/commit/f9cd18563894ad05eec3019dfb92d5dffc031e11)|`Merge branch 'develop' into t/20469/public/algebras/ariki_koike_algebras-20469`|\n|[7282c37](https://github.com/sagemath/sagetrac-mirror/commit/7282c3777ac147f6bfed6f95d3305a8b8e150635)|`Rewriting product code to avoid recursion`|\n|[e9b6a59](https://github.com/sagemath/sagetrac-mirror/commit/e9b6a594ae1e089b51b37081f35743402447a960)|`Merging with remote`|",
    "created_at": "2016-07-12T22:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374768",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[bcd1ef4](https://github.com/sagemath/sagetrac-mirror/commit/bcd1ef47513863a6c065cb101373a00dcd3f2308)|`Initial implementation of Ariki-Koike alegbras.`|
|[93b57ff](https://github.com/sagemath/sagetrac-mirror/commit/93b57ff5687ee39b75014ca323cd5a17a3f3cca5)|`Changing l -> L.`|
|[a98d138](https://github.com/sagemath/sagetrac-mirror/commit/a98d138d39e89b3d521d2b8d1161c04ce4412361)|`Moving Ariki-Koike algebras to new subfolder for Hecke algebras.`|
|[5e739ba](https://github.com/sagemath/sagetrac-mirror/commit/5e739babc03cf6694ffa574118b59e007f0fd8b6)|`Adding more documentation and examples. Doing some fixes.`|
|[f5f5795](https://github.com/sagemath/sagetrac-mirror/commit/f5f5795774a550477928886e346e06e5be723e2c)|`Fixing an error with multiplication of the T_i generators.`|
|[13fdc45](https://github.com/sagemath/sagetrac-mirror/commit/13fdc45a7344c34370b3fdfb360d1d68fdcb627b)|`Fixing multiplication the other way.`|
|[dae0031](https://github.com/sagemath/sagetrac-mirror/commit/dae0031049f5bd6e51576a57308c57fd71a3fe92)|`Initial review`|
|[f9cd185](https://github.com/sagemath/sagetrac-mirror/commit/f9cd18563894ad05eec3019dfb92d5dffc031e11)|`Merge branch 'develop' into t/20469/public/algebras/ariki_koike_algebras-20469`|
|[7282c37](https://github.com/sagemath/sagetrac-mirror/commit/7282c3777ac147f6bfed6f95d3305a8b8e150635)|`Rewriting product code to avoid recursion`|
|[e9b6a59](https://github.com/sagemath/sagetrac-mirror/commit/e9b6a594ae1e089b51b37081f35743402447a960)|`Merging with remote`|



---

archive/issue_comments_374769.json:
```json
{
    "body": "<a id='comment:8'></a>\nHi Travis,\n\nI have been through your code and fixed the recursion issue. It was actually an infinite recursion loop. The problem was that as the terms in the products `....T_i L_k...` were being put into standard form \"letter-by-letter\" (so changing the previous expression to `\\sum ... L_m T_j...`) you sometimes ended up going around in circles by pushing a `T_i` past an `L_k` that then created a large power of some `L_m` that, when reduced, got you back to the previous situation. I have rewritten the `product_on_basis` code to avoid this, so I'm afraid that I've replaced this section of your code. The product code is now less recursive with terms largely being rewritten into standard form \"in place\". \n\nOn top of this I proved a formula for the expansion of `L_k^m` that, embarrassingly, I later found in one of my papers. This was my first guess for improving the multiplication issues but once I'd made this change I discovered the recursion loop. The other main change is that I rescaled `L_k` to `q**{1-k}*L_k`, in [AK] notation, because this renormalisation is what is normally used in the literature as it works better with the combinatorics.\n\nI have made a start at adding the documentation.  As a result of the rescaling of the `L_k`'s quite a lot of doc-tests are currently failing, being off by the corresponding power of `q`. I am happy to fix these. I left them in only so that you can compare if you wish. I am also happy to fill out the documentation as I know this area quite well.\n\nOther issues that we could think about are:\n- whether to allow the two parameter version: `(T_i-q1)(T_i+q2)=0`. Probably quite painful as all of the product formulas will change\n- whether to implement the degenerate algebras. This might be easy as it could be done as a derived class with slightly different `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` methods\n- I think having a slightly shorter `_repr_` string would be a good idea: `Ariki-Koike algebra of rank 5 with parameters q,u0,u2,u3` is enough I think\n- implementing other bases? This is probably best left for another ticket...especially as I think that the realisations code currently requires that the same indexing sets be used(?)\n\nAny way, I think that the code now works. Please have a look and let me know what you think. Happy to be a reviewer or coauthor on the ticket as you think best.\n\nAndrew",
    "created_at": "2016-07-12T23:12:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374769",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:8'></a>
Hi Travis,

I have been through your code and fixed the recursion issue. It was actually an infinite recursion loop. The problem was that as the terms in the products `....T_i L_k...` were being put into standard form "letter-by-letter" (so changing the previous expression to `\sum ... L_m T_j...`) you sometimes ended up going around in circles by pushing a `T_i` past an `L_k` that then created a large power of some `L_m` that, when reduced, got you back to the previous situation. I have rewritten the `product_on_basis` code to avoid this, so I'm afraid that I've replaced this section of your code. The product code is now less recursive with terms largely being rewritten into standard form "in place". 

On top of this I proved a formula for the expansion of `L_k^m` that, embarrassingly, I later found in one of my papers. This was my first guess for improving the multiplication issues but once I'd made this change I discovered the recursion loop. The other main change is that I rescaled `L_k` to `q**{1-k}*L_k`, in [AK] notation, because this renormalisation is what is normally used in the literature as it works better with the combinatorics.

I have made a start at adding the documentation.  As a result of the rescaling of the `L_k`'s quite a lot of doc-tests are currently failing, being off by the corresponding power of `q`. I am happy to fix these. I left them in only so that you can compare if you wish. I am also happy to fill out the documentation as I know this area quite well.

Other issues that we could think about are:
- whether to allow the two parameter version: `(T_i-q1)(T_i+q2)=0`. Probably quite painful as all of the product formulas will change
- whether to implement the degenerate algebras. This might be easy as it could be done as a derived class with slightly different `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` methods
- I think having a slightly shorter `_repr_` string would be a good idea: `Ariki-Koike algebra of rank 5 with parameters q,u0,u2,u3` is enough I think
- implementing other bases? This is probably best left for another ticket...especially as I think that the realisations code currently requires that the same indexing sets be used(?)

Any way, I think that the code now works. Please have a look and let me know what you think. Happy to be a reviewer or coauthor on the ticket as you think best.

Andrew



---

archive/issue_comments_374770.json:
```json
{
    "body": "<a id='comment:9'></a>\nps. With the degenerate algebras, the other option would be to use the Hu-Mathas presentation for the \"main\" algebra (this combines the Ariki-Koike algebras with `q\\ne1` and the degenerate AK algebras (when `q=1`) and then implement the `q=1` version of the Ariki-Koike algebras as the \"extra\" case. I am biased, but personally I think that makes more sense because the Hu-M. presentation fits with the KLR categorifiction of integrable highest weight modules perfectly whereas the Ariki-Koike presentation does not.",
    "created_at": "2016-07-12T23:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374770",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:9'></a>
ps. With the degenerate algebras, the other option would be to use the Hu-Mathas presentation for the "main" algebra (this combines the Ariki-Koike algebras with `q\ne1` and the degenerate AK algebras (when `q=1`) and then implement the `q=1` version of the Ariki-Koike algebras as the "extra" case. I am biased, but personally I think that makes more sense because the Hu-M. presentation fits with the KLR categorifiction of integrable highest weight modules perfectly whereas the Ariki-Koike presentation does not.



---

archive/issue_comments_374771.json:
```json
{
    "body": "Changing author from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Andrew Mathas\"",
    "created_at": "2016-07-13T02:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374771",
    "user": "https://github.com/tscrim"
}
```

Changing author from "Travis Scrimshaw" to "Travis Scrimshaw, Andrew Mathas"



---

archive/issue_events_062935.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-07-13T02:19:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62935"
}
```



---

archive/issue_comments_374772.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Andrew Mathas, Travis Scrimshaw\"",
    "created_at": "2016-07-13T02:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374772",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Andrew Mathas, Travis Scrimshaw"



---

archive/issue_comments_374773.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [andrew.mathas](#comment%3A8):\n> I have been through your code and fixed the recursion issue. It was actually an infinite recursion loop. The problem was that as the terms in the products `....T_i L_k...` were being put into standard form \"letter-by-letter\" (so changing the previous expression to `\\sum ... L_m T_j...`) you sometimes ended up going around in circles by pushing a `T_i` past an `L_k` that then created a large power of some `L_m` that, when reduced, got you back to the previous situation. I have rewritten the `product_on_basis` code to avoid this, so I'm afraid that I've replaced this section of your code. The product code is now less recursive with terms largely being rewritten into standard form \"in place\". \n\n\nThank you very much for looking through this code and fixing the problem(s). Sorry it ended up being a bit of a mess. I'm very happy you were able to improve it.\n\n> On top of this I proved a formula for the expansion of `L_k^m` that, embarrassingly, I later found in one of my papers. This was my first guess for improving the multiplication issues but once I'd made this change I discovered the recursion loop. The other main change is that I rescaled `L_k` to `q**{1-k}*L_k`, in [AK] notation, because this renormalisation is what is normally used in the literature as it works better with the combinatorics.\n\n\nI probably could have looked harder in the literature. I'm okay with the renormalization (especially since I have more of an interest in the combinatorics too). I just kept the [AK] normalization since I was using that as my reference and didn't trust myself to correctly handle the renormalization.\n\n> I have made a start at adding the documentation.  As a result of the rescaling of the `L_k`'s quite a lot of doc-tests are currently failing, being off by the corresponding power of `q`. I am happy to fix these. I left them in only so that you can compare if you wish. I am also happy to fill out the documentation as I know this area quite well.\n\n\nI would appreciate all of your expertise in writing the documentation. I can go over it and do any necessary formatting. I can also fix the doctests afterwards.\n\n> Other issues that we could think about are:\n> - whether to allow the two parameter version: `(T_i-q1)(T_i+q2)=0`. Probably quite painful as all of the product formulas will change\n\n\nI think it is good to try and be as general as possible when it is not much work. I agree, I think it would be very annoying to switch because we would have to redo all of the product formulas (at least, I would have to put some thought on how to do this to make everything consistent). So, I think this is plenty good for now.\n\n> - whether to implement the degenerate algebras. This might be easy as it could be done as a derived class with slightly different `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` methods\n\n\n> - I think having a slightly shorter `_repr_` string would be a good idea: `Ariki-Koike algebra of rank 5 with parameters q,u0,u2,u3` is enough I think\n\n\nI think we should give the base ring to better differentiate the instances. Plus this is consistent with what we do elsewhere in Sage. One slight issue is the default ring is a polynomial ring over a polynomial ring, and it is this that makes the repr very long. I decided to do this for the default ring so the q's would be grouped together.\n\n> - implementing other bases? This is probably best left for another ticket...especially as I think that the realisations code currently requires that the same indexing sets be used(?)\n\n\nI agree; this should be another ticket unless you have code ready. The realizations code itself does not require the same indexing set, but you have to do a bit more with the morphisms. For an example, see the descent algebra (`combinat/descent_algebra.py`).\n\n> Any way, I think that the code now works. Please have a look and let me know what you think. Happy to be a reviewer or coauthor on the ticket as you think best.\n\n\nI will play around with in shortly. We will both be both coauthors and reviewers (yet again :P).\n\nReplying to [andrew.mathas](#comment%3A9):\n> ps. With the degenerate algebras, the other option would be to use the Hu-Mathas presentation for the \"main\" algebra (this combines the Ariki-Koike algebras with `q\\ne1` and the degenerate AK algebras (when `q=1`) and then implement the `q=1` version of the Ariki-Koike algebras as the \"extra\" case. I am biased, but personally I think that makes more sense because the Hu-M. presentation fits with the KLR categorifiction of integrable highest weight modules perfectly whereas the Ariki-Koike presentation does not. \n\n\nI'm +1 for getting things closer to the KLR algebra (something that I hope to eventually get into Sage at some point). Otherwise I don't have an opinion on which presentation we use. How much would have to be changed in order to move to the Hu-Mathas presentation?",
    "created_at": "2016-07-13T02:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374773",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
Replying to [andrew.mathas](#comment%3A8):
> I have been through your code and fixed the recursion issue. It was actually an infinite recursion loop. The problem was that as the terms in the products `....T_i L_k...` were being put into standard form "letter-by-letter" (so changing the previous expression to `\sum ... L_m T_j...`) you sometimes ended up going around in circles by pushing a `T_i` past an `L_k` that then created a large power of some `L_m` that, when reduced, got you back to the previous situation. I have rewritten the `product_on_basis` code to avoid this, so I'm afraid that I've replaced this section of your code. The product code is now less recursive with terms largely being rewritten into standard form "in place". 


Thank you very much for looking through this code and fixing the problem(s). Sorry it ended up being a bit of a mess. I'm very happy you were able to improve it.

> On top of this I proved a formula for the expansion of `L_k^m` that, embarrassingly, I later found in one of my papers. This was my first guess for improving the multiplication issues but once I'd made this change I discovered the recursion loop. The other main change is that I rescaled `L_k` to `q**{1-k}*L_k`, in [AK] notation, because this renormalisation is what is normally used in the literature as it works better with the combinatorics.


I probably could have looked harder in the literature. I'm okay with the renormalization (especially since I have more of an interest in the combinatorics too). I just kept the [AK] normalization since I was using that as my reference and didn't trust myself to correctly handle the renormalization.

> I have made a start at adding the documentation.  As a result of the rescaling of the `L_k`'s quite a lot of doc-tests are currently failing, being off by the corresponding power of `q`. I am happy to fix these. I left them in only so that you can compare if you wish. I am also happy to fill out the documentation as I know this area quite well.


I would appreciate all of your expertise in writing the documentation. I can go over it and do any necessary formatting. I can also fix the doctests afterwards.

> Other issues that we could think about are:
> - whether to allow the two parameter version: `(T_i-q1)(T_i+q2)=0`. Probably quite painful as all of the product formulas will change


I think it is good to try and be as general as possible when it is not much work. I agree, I think it would be very annoying to switch because we would have to redo all of the product formulas (at least, I would have to put some thought on how to do this to make everything consistent). So, I think this is plenty good for now.

> - whether to implement the degenerate algebras. This might be easy as it could be done as a derived class with slightly different `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` methods


> - I think having a slightly shorter `_repr_` string would be a good idea: `Ariki-Koike algebra of rank 5 with parameters q,u0,u2,u3` is enough I think


I think we should give the base ring to better differentiate the instances. Plus this is consistent with what we do elsewhere in Sage. One slight issue is the default ring is a polynomial ring over a polynomial ring, and it is this that makes the repr very long. I decided to do this for the default ring so the q's would be grouped together.

> - implementing other bases? This is probably best left for another ticket...especially as I think that the realisations code currently requires that the same indexing sets be used(?)


I agree; this should be another ticket unless you have code ready. The realizations code itself does not require the same indexing set, but you have to do a bit more with the morphisms. For an example, see the descent algebra (`combinat/descent_algebra.py`).

> Any way, I think that the code now works. Please have a look and let me know what you think. Happy to be a reviewer or coauthor on the ticket as you think best.


I will play around with in shortly. We will both be both coauthors and reviewers (yet again :P).

Replying to [andrew.mathas](#comment%3A9):
> ps. With the degenerate algebras, the other option would be to use the Hu-Mathas presentation for the "main" algebra (this combines the Ariki-Koike algebras with `q\ne1` and the degenerate AK algebras (when `q=1`) and then implement the `q=1` version of the Ariki-Koike algebras as the "extra" case. I am biased, but personally I think that makes more sense because the Hu-M. presentation fits with the KLR categorifiction of integrable highest weight modules perfectly whereas the Ariki-Koike presentation does not. 


I'm +1 for getting things closer to the KLR algebra (something that I hope to eventually get into Sage at some point). Otherwise I don't have an opinion on which presentation we use. How much would have to be changed in order to move to the Hu-Mathas presentation?



---

archive/issue_comments_374774.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [tscrim](#comment%3A10):\n> Replying to [andrew.mathas](#comment%3A8):\n\n\n> I'm +1 for getting things closer to the KLR algebra (something that I hope to eventually get into Sage at some point). Otherwise I don't have an opinion on which presentation we use. How much would have to be changed in order to move to the Hu-Mathas presentation?\n\n\nWith all of these things it is mainly a matter of implementing appropriate analogues of the three methods `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` that underpin the multiplication. Replacing `q` with a two variable version may be the hardest option as we'd have to think what the appropriate normalisation of the Jucys-Murphy elements is. This said, I would prefer to have the more symmetric relations `(T_i-q)(T_i+q^{-1})=0`, so I will have a think about this.\n\nRegarding KLR algebras, implementing the \"affine\" KLR algebras is reasonably straightforward. I know now of a way to do the cyclotomic quotients in a few cases and I will implement them at some point, although the isomorphism to the ungraded algebras is much harder to do.",
    "created_at": "2016-07-13T14:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374774",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:11'></a>
Replying to [tscrim](#comment%3A10):
> Replying to [andrew.mathas](#comment%3A8):


> I'm +1 for getting things closer to the KLR algebra (something that I hope to eventually get into Sage at some point). Otherwise I don't have an opinion on which presentation we use. How much would have to be changed in order to move to the Hu-Mathas presentation?


With all of these things it is mainly a matter of implementing appropriate analogues of the three methods `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` that underpin the multiplication. Replacing `q` with a two variable version may be the hardest option as we'd have to think what the appropriate normalisation of the Jucys-Murphy elements is. This said, I would prefer to have the more symmetric relations `(T_i-q)(T_i+q^{-1})=0`, so I will have a think about this.

Regarding KLR algebras, implementing the "affine" KLR algebras is reasonably straightforward. I know now of a way to do the cyclotomic quotients in a few cases and I will implement them at some point, although the isomorphism to the ungraded algebras is much harder to do.



---

archive/issue_comments_374775.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [andrew.mathas](#comment%3A11):\n> Replying to [tscrim](#comment%3A10):\n> > Replying to [andrew.mathas](#comment%3A8):\n\n> \n> > I'm +1 for getting things closer to the KLR algebra (something that I hope to eventually get into Sage at some point). Otherwise I don't have an opinion on which presentation we use. How much would have to be changed in order to move to the Hu-Mathas presentation?\n\n> \n> With all of these things it is mainly a matter of implementing appropriate analogues of the three methods `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` that underpin the multiplication. Replacing `q` with a two variable version may be the hardest option as we'd have to think what the appropriate normalisation of the Jucys-Murphy elements is. This said, I would prefer to have the more symmetric relations `(T_i-q)(T_i+q^{-1})=0`, so I will have a think about this.\n\n\nI believe I've said this above, but to be pedantic, I have no preference as to what quadratic relation is. How much could be obtained by looking at the affine Hecke algebra and passing to the quotient?\n\n> Regarding KLR algebras, implementing the \"affine\" KLR algebras is reasonably straightforward. I know now of a way to do the cyclotomic quotients in a few cases and I will implement them at some point, although the isomorphism to the ungraded algebras is much harder to do.\n\n\nPlease cc me on that ticket when you create it. I would be happy to review it.",
    "created_at": "2016-07-15T03:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374775",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Replying to [andrew.mathas](#comment%3A11):
> Replying to [tscrim](#comment%3A10):
> > Replying to [andrew.mathas](#comment%3A8):

> 
> > I'm +1 for getting things closer to the KLR algebra (something that I hope to eventually get into Sage at some point). Otherwise I don't have an opinion on which presentation we use. How much would have to be changed in order to move to the Hu-Mathas presentation?

> 
> With all of these things it is mainly a matter of implementing appropriate analogues of the three methods `_product_LTwTv`, `_product_Tw_L`, and `_Li_power` that underpin the multiplication. Replacing `q` with a two variable version may be the hardest option as we'd have to think what the appropriate normalisation of the Jucys-Murphy elements is. This said, I would prefer to have the more symmetric relations `(T_i-q)(T_i+q^{-1})=0`, so I will have a think about this.


I believe I've said this above, but to be pedantic, I have no preference as to what quadratic relation is. How much could be obtained by looking at the affine Hecke algebra and passing to the quotient?

> Regarding KLR algebras, implementing the "affine" KLR algebras is reasonably straightforward. I know now of a way to do the cyclotomic quotients in a few cases and I will implement them at some point, although the isomorphism to the ungraded algebras is much harder to do.


Please cc me on that ticket when you create it. I would be happy to review it.



---

archive/issue_comments_374776.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|\n|[abe8764](https://github.com/sagemath/sagetrac-mirror/commit/abe87649263a7e66b73b6a06905c6222d1c9a8da)|`Merge branch 'public/algebras/ariki_koike_algebras-20469' of trac.sagemath.org:sage into public/algebras/ariki_koike_algebras-20469`|\n|[0345a42](https://github.com/sagemath/sagetrac-mirror/commit/0345a42e7b30dd457087183fceb055bb9675bfae)|`Merge branch 'develop' into public/algebras/ariki_koike_algebras-20469`|\n|[0ec4023](https://github.com/sagemath/sagetrac-mirror/commit/0ec4023bda1fa3f055f92a88ab4f4d2b199475bd)|`Merge branch 'develop' into public/algebras/ariki_koike_algebras-20469`|\n|[f39c139](https://github.com/sagemath/sagetrac-mirror/commit/f39c1399357d574109fb152cf456d8690fadde1b)|`Merge branch 'develop' into public/algebras/ariki_koike_algebras-20469`|",
    "created_at": "2017-08-09T05:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
|[abe8764](https://github.com/sagemath/sagetrac-mirror/commit/abe87649263a7e66b73b6a06905c6222d1c9a8da)|`Merge branch 'public/algebras/ariki_koike_algebras-20469' of trac.sagemath.org:sage into public/algebras/ariki_koike_algebras-20469`|
|[0345a42](https://github.com/sagemath/sagetrac-mirror/commit/0345a42e7b30dd457087183fceb055bb9675bfae)|`Merge branch 'develop' into public/algebras/ariki_koike_algebras-20469`|
|[0ec4023](https://github.com/sagemath/sagetrac-mirror/commit/0ec4023bda1fa3f055f92a88ab4f4d2b199475bd)|`Merge branch 'develop' into public/algebras/ariki_koike_algebras-20469`|
|[f39c139](https://github.com/sagemath/sagetrac-mirror/commit/f39c1399357d574109fb152cf456d8690fadde1b)|`Merge branch 'develop' into public/algebras/ariki_koike_algebras-20469`|



---

archive/issue_comments_374777.json:
```json
{
    "body": "Changing commit from \"e9b6a594ae1e089b51b37081f35743402447a960\" to \"f39c1399357d574109fb152cf456d8690fadde1b\"",
    "created_at": "2017-08-09T05:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374777",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e9b6a594ae1e089b51b37081f35743402447a960" to "f39c1399357d574109fb152cf456d8690fadde1b"



---

archive/issue_events_062936.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-09T14:17:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62936"
}
```



---

archive/issue_events_062937.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-09T14:17:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62937"
}
```



---

archive/issue_comments_374778.json:
```json
{
    "body": "Changing commit from \"f39c1399357d574109fb152cf456d8690fadde1b\" to \"738616df7442862e6062c78d5120e641b9461ebf\"",
    "created_at": "2017-08-09T14:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374778",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f39c1399357d574109fb152cf456d8690fadde1b" to "738616df7442862e6062c78d5120e641b9461ebf"



---

archive/issue_comments_374779.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|\n|[738616d](https://github.com/sagemath/sagetrac-mirror/commit/738616df7442862e6062c78d5120e641b9461ebf)|`Merge commit 'e9b6a594ae1e089b51b37081f35743402447a960' into public/algebras/ariki_koike_algebras-20469_2`|",
    "created_at": "2017-08-09T14:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
|[738616d](https://github.com/sagemath/sagetrac-mirror/commit/738616df7442862e6062c78d5120e641b9461ebf)|`Merge commit 'e9b6a594ae1e089b51b37081f35743402447a960' into public/algebras/ariki_koike_algebras-20469_2`|



---

archive/issue_comments_374780.json:
```json
{
    "body": "Changing commit from \"738616df7442862e6062c78d5120e641b9461ebf\" to \"08f90379eeb5ccb670d36e3cdbed2c07cdc78068\"",
    "created_at": "2018-05-02T04:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374780",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "738616df7442862e6062c78d5120e641b9461ebf" to "08f90379eeb5ccb670d36e3cdbed2c07cdc78068"



---

archive/issue_comments_374781.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|\n|[21b9e6b](https://github.com/sagemath/sagetrac-mirror/commit/21b9e6b86c88df69114812e005bbc58cab6f61df)|`Merge branch 'public/algebras/ariki_koike_algebras-20469' of git://trac.sagemath.org/sage into public/algebras/ariki_koike_algebras-20469`|\n|[08f9037](https://github.com/sagemath/sagetrac-mirror/commit/08f90379eeb5ccb670d36e3cdbed2c07cdc78068)|`Fixing bugs and minor cleanup.`|",
    "created_at": "2018-05-02T04:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374781",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
|[21b9e6b](https://github.com/sagemath/sagetrac-mirror/commit/21b9e6b86c88df69114812e005bbc58cab6f61df)|`Merge branch 'public/algebras/ariki_koike_algebras-20469' of git://trac.sagemath.org/sage into public/algebras/ariki_koike_algebras-20469`|
|[08f9037](https://github.com/sagemath/sagetrac-mirror/commit/08f90379eeb5ccb670d36e3cdbed2c07cdc78068)|`Fixing bugs and minor cleanup.`|



---

archive/issue_comments_374782.json:
```json
{
    "body": "<a id='comment:17'></a>\nI've found and fixed 2 bugs with the multiplication:\n\n1. In `_product_LTwTv`, the coefficient `c` was not being multiplied in the second term.\n2. In `_Li_power`, the formula was suppose to be q<sup>-1</sup> (q - 1) = 1 - q<sup>-1</sup>, but instead it was q - q<sup>-1</sup>. This fixes the associativity test.\n\nNow all doctests are currently passing.",
    "created_at": "2018-05-02T04:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374782",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
I've found and fixed 2 bugs with the multiplication:

1. In `_product_LTwTv`, the coefficient `c` was not being multiplied in the second term.
2. In `_Li_power`, the formula was suppose to be q<sup>-1</sup> (q - 1) = 1 - q<sup>-1</sup>, but instead it was q - q<sup>-1</sup>. This fixes the associativity test.

Now all doctests are currently passing.



---

archive/issue_comments_374783.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[7eafefd](https://github.com/sagemath/sagetrac-mirror/commit/7eafefd89eb4f1d5a0343bd6db0d08fafa2e10e4)|`Finished initial pass of cleanup.`|\n|[f074dad](https://github.com/sagemath/sagetrac-mirror/commit/f074dadaa0f51400152c52b91a97dc66153b95ca)|`Some multiplication optimizations by not creating as many transient elements.`|\n|[a6c8908](https://github.com/sagemath/sagetrac-mirror/commit/a6c89080e871eac1ab7d67d12855aee00d3183d3)|`A little bit more touchups and cosmetic changes.`|",
    "created_at": "2018-05-02T05:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[7eafefd](https://github.com/sagemath/sagetrac-mirror/commit/7eafefd89eb4f1d5a0343bd6db0d08fafa2e10e4)|`Finished initial pass of cleanup.`|
|[f074dad](https://github.com/sagemath/sagetrac-mirror/commit/f074dadaa0f51400152c52b91a97dc66153b95ca)|`Some multiplication optimizations by not creating as many transient elements.`|
|[a6c8908](https://github.com/sagemath/sagetrac-mirror/commit/a6c89080e871eac1ab7d67d12855aee00d3183d3)|`A little bit more touchups and cosmetic changes.`|



---

archive/issue_comments_374784.json:
```json
{
    "body": "Changing commit from \"08f90379eeb5ccb670d36e3cdbed2c07cdc78068\" to \"a6c89080e871eac1ab7d67d12855aee00d3183d3\"",
    "created_at": "2018-05-02T05:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "08f90379eeb5ccb670d36e3cdbed2c07cdc78068" to "a6c89080e871eac1ab7d67d12855aee00d3183d3"



---

archive/issue_comments_374785.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-30T11:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374785",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_events_062938.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-05-30T11:02:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62938"
}
```



---

archive/issue_events_062939.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-05-30T11:02:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62939"
}
```



---

archive/issue_comments_374786.json:
```json
{
    "body": "<a id='comment:19'></a>\nHere is a version with 2 bases: the `T` basis given by BM and `LT` basis given by AK.\n\nFrom some testing, the `T` basis implementation is (currently) clearly the better basis:\n\n```\nsage: def test(B):\n....:     for b in B:\n....:         for bp in B:\n....:             b * bp\n....:             \nsage: H = algebras.ArikiKoike(3, 3)\nsage: LT = H.LT()\nsage: T = H.T()\nsage: %time test(LT.basis())\nCPU times: user 4min 30s, sys: 1.64 s, total: 4min 31s\nWall time: 4min 31s\nsage: %time test(T.basis())\nCPU times: user 1min 40s, sys: 739 ms, total: 1min 41s\nWall time: 1min 40s\n```\nIn particular, this `LT` basis computation took over 5GB of RAM, whereas the `T` basis computation took less than 2GB. (The computation above involves all 26244 possible products.) The speed difference also holds for smaller dimensional spaces.",
    "created_at": "2018-05-30T11:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374786",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>
Here is a version with 2 bases: the `T` basis given by BM and `LT` basis given by AK.

From some testing, the `T` basis implementation is (currently) clearly the better basis:

```
sage: def test(B):
....:     for b in B:
....:         for bp in B:
....:             b * bp
....:             
sage: H = algebras.ArikiKoike(3, 3)
sage: LT = H.LT()
sage: T = H.T()
sage: %time test(LT.basis())
CPU times: user 4min 30s, sys: 1.64 s, total: 4min 31s
Wall time: 4min 31s
sage: %time test(T.basis())
CPU times: user 1min 40s, sys: 739 ms, total: 1min 41s
Wall time: 1min 40s
```
In particular, this `LT` basis computation took over 5GB of RAM, whereas the `T` basis computation took less than 2GB. (The computation above involves all 26244 possible products.) The speed difference also holds for smaller dimensional spaces.



---

archive/issue_comments_374787.json:
```json
{
    "body": "Changing keywords from \"hecke algebra, complex reflection group, ariki-koike\" to \"hecke algebra, complex reflection group, ariki-koike, days93.51\".",
    "created_at": "2018-05-30T11:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374787",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "hecke algebra, complex reflection group, ariki-koike" to "hecke algebra, complex reflection group, ariki-koike, days93.51".



---

archive/issue_comments_374788.json:
```json
{
    "body": "Changing commit from \"a6c89080e871eac1ab7d67d12855aee00d3183d3\" to \"6d1ac2c8f1e94ff3483b5f66182c43d061aec22b\"",
    "created_at": "2018-05-31T07:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374788",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "a6c89080e871eac1ab7d67d12855aee00d3183d3" to "6d1ac2c8f1e94ff3483b5f66182c43d061aec22b"



---

archive/issue_comments_374789.json:
```json
{
    "body": "Changing branch from \"public/algebras/ariki_koike_algebras-20469\" to \"public/algebras/ariki_koike_algebras_with_bases-20469\"",
    "created_at": "2018-05-31T07:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374789",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "public/algebras/ariki_koike_algebras-20469" to "public/algebras/ariki_koike_algebras_with_bases-20469"



---

archive/issue_comments_374790.json:
```json
{
    "body": "<a id='comment:21'></a>\nLast 10 new commits:\n|                                                                                                                                          |                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[429b0f9](https://github.com/sagemath/sagetrac-mirror/commit/429b0f9b6982ad682421ae42a458cc94cc897863)|`Fixing an error with multiplication of the T_i generators.`|\n|[7317e86](https://github.com/sagemath/sagetrac-mirror/commit/7317e86f7699a4e2fb6eaddd840d3029668d54b9)|`Fixing multiplication the other way.`|\n|[c504826](https://github.com/sagemath/sagetrac-mirror/commit/c504826002288ebb0620a86f1112ff58ef8426e6)|`Initial review`|\n|[21822a2](https://github.com/sagemath/sagetrac-mirror/commit/21822a22cccd8384914a8da12a4086e36472f97d)|`Rewriting product code to avoid recursion`|\n|[f366691](https://github.com/sagemath/sagetrac-mirror/commit/f366691e3928c3ef0c6f7ae668a0eeb5e6d26770)|`Fixing bugs and minor cleanup.`|\n|[3af6dcc](https://github.com/sagemath/sagetrac-mirror/commit/3af6dcc7ca43fef1c8ccc4864a5f1a3c67f871e7)|`Finished initial pass of cleanup.`|\n|[59d9583](https://github.com/sagemath/sagetrac-mirror/commit/59d95836a472f78b70ada5b5c1a91a38c6c80060)|`Some multiplication optimizations by not creating as many transient elements.`|\n|[3e94fea](https://github.com/sagemath/sagetrac-mirror/commit/3e94feae4edc10cc9a92c4e92007d109a4811d0a)|`A little bit more touchups and cosmetic changes.`|\n|[1d92cb7](https://github.com/sagemath/sagetrac-mirror/commit/1d92cb71b3d6c5767282dffa1d15ae7d33085a82)|`Implementation of T basis following [BM1997]_.`|\n|[6d1ac2c](https://github.com/sagemath/sagetrac-mirror/commit/6d1ac2c8f1e94ff3483b5f66182c43d061aec22b)|`Use cartesian_product as the indices for the basis.`|",
    "created_at": "2018-05-31T07:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374790",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
Last 10 new commits:
|                                                                                                                                          |                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[429b0f9](https://github.com/sagemath/sagetrac-mirror/commit/429b0f9b6982ad682421ae42a458cc94cc897863)|`Fixing an error with multiplication of the T_i generators.`|
|[7317e86](https://github.com/sagemath/sagetrac-mirror/commit/7317e86f7699a4e2fb6eaddd840d3029668d54b9)|`Fixing multiplication the other way.`|
|[c504826](https://github.com/sagemath/sagetrac-mirror/commit/c504826002288ebb0620a86f1112ff58ef8426e6)|`Initial review`|
|[21822a2](https://github.com/sagemath/sagetrac-mirror/commit/21822a22cccd8384914a8da12a4086e36472f97d)|`Rewriting product code to avoid recursion`|
|[f366691](https://github.com/sagemath/sagetrac-mirror/commit/f366691e3928c3ef0c6f7ae668a0eeb5e6d26770)|`Fixing bugs and minor cleanup.`|
|[3af6dcc](https://github.com/sagemath/sagetrac-mirror/commit/3af6dcc7ca43fef1c8ccc4864a5f1a3c67f871e7)|`Finished initial pass of cleanup.`|
|[59d9583](https://github.com/sagemath/sagetrac-mirror/commit/59d95836a472f78b70ada5b5c1a91a38c6c80060)|`Some multiplication optimizations by not creating as many transient elements.`|
|[3e94fea](https://github.com/sagemath/sagetrac-mirror/commit/3e94feae4edc10cc9a92c4e92007d109a4811d0a)|`A little bit more touchups and cosmetic changes.`|
|[1d92cb7](https://github.com/sagemath/sagetrac-mirror/commit/1d92cb71b3d6c5767282dffa1d15ae7d33085a82)|`Implementation of T basis following [BM1997]_.`|
|[6d1ac2c](https://github.com/sagemath/sagetrac-mirror/commit/6d1ac2c8f1e94ff3483b5f66182c43d061aec22b)|`Use cartesian_product as the indices for the basis.`|



---

archive/issue_comments_374791.json:
```json
{
    "body": "Changing commit from \"6d1ac2c8f1e94ff3483b5f66182c43d061aec22b\" to \"712a76a071c1910f8f102f179e47cf43cb770146\"",
    "created_at": "2018-05-31T15:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6d1ac2c8f1e94ff3483b5f66182c43d061aec22b" to "712a76a071c1910f8f102f179e47cf43cb770146"



---

archive/issue_comments_374792.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[712a76a](https://github.com/sagemath/sagetrac-mirror/commit/712a76a071c1910f8f102f179e47cf43cb770146)|`Fixing documentation.`|",
    "created_at": "2018-05-31T15:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[712a76a](https://github.com/sagemath/sagetrac-mirror/commit/712a76a071c1910f8f102f179e47cf43cb770146)|`Fixing documentation.`|



---

archive/issue_comments_374793.json:
```json
{
    "body": "Changing commit from \"712a76a071c1910f8f102f179e47cf43cb770146\" to \"829576c0e9f6136a0f921e9c69a49e1a5c087307\"",
    "created_at": "2018-06-01T10:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374793",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "712a76a071c1910f8f102f179e47cf43cb770146" to "829576c0e9f6136a0f921e9c69a49e1a5c087307"



---

archive/issue_comments_374794.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[829576c](https://github.com/sagemath/sagetrac-mirror/commit/829576c0e9f6136a0f921e9c69a49e1a5c087307)|`Removing duplicate reference.`|",
    "created_at": "2018-06-01T10:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[829576c](https://github.com/sagemath/sagetrac-mirror/commit/829576c0e9f6136a0f921e9c69a49e1a5c087307)|`Removing duplicate reference.`|



---

archive/issue_comments_374795.json:
```json
{
    "body": "Changing commit from \"829576c0e9f6136a0f921e9c69a49e1a5c087307\" to \"c8a9c2f468c6832750ba0898257fab53e7996192\"",
    "created_at": "2018-06-01T10:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "829576c0e9f6136a0f921e9c69a49e1a5c087307" to "c8a9c2f468c6832750ba0898257fab53e7996192"



---

archive/issue_comments_374796.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[c8a9c2f](https://github.com/sagemath/sagetrac-mirror/commit/c8a9c2f468c6832750ba0898257fab53e7996192)|`Last little tweaks to the documentation.`|",
    "created_at": "2018-06-01T10:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[c8a9c2f](https://github.com/sagemath/sagetrac-mirror/commit/c8a9c2f468c6832750ba0898257fab53e7996192)|`Last little tweaks to the documentation.`|



---

archive/issue_events_062940.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62940"
}
```



---

archive/issue_events_062941.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62941"
}
```



---

archive/issue_comments_374797.json:
```json
{
    "body": "<a id='comment:25'></a>\nupdate milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374797",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
update milestone 8.3 -> 8.4



---

archive/issue_comments_374798.json:
```json
{
    "body": "<a id='comment:26'></a>\nsome typos:\n\n```\nOUPTUT\n```\n\n```\nThese element different by a power of `q` from the corresponding\n```\n\n```\nan tuple\n```\nmissing `\\` in \n\n```\n+.. [BM1997] K. Bremke and G. Malle,\n```",
    "created_at": "2018-08-11T18:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374798",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'></a>
some typos:

```
OUPTUT
```

```
These element different by a power of `q` from the corresponding
```

```
an tuple
```
missing `\` in 

```
+.. [BM1997] K. Bremke and G. Malle,
```



---

archive/issue_comments_374799.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-09-29T12:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374799",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_374800.json:
```json
{
    "body": "<a id='comment:27'></a>\nbranch is red",
    "created_at": "2018-09-29T12:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374800",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>
branch is red



---

archive/issue_comments_374801.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|\n|[ebb2c1b](https://github.com/sagemath/sagetrac-mirror/commit/ebb2c1b6ac2f6efa06cc76e3ce7fc55ff0be2e05)|`Merge branch 'public/algebras/ariki_koike_algebras_with_bases-20469' in 8.5.b6`|",
    "created_at": "2018-12-07T19:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374801",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
|[ebb2c1b](https://github.com/sagemath/sagetrac-mirror/commit/ebb2c1b6ac2f6efa06cc76e3ce7fc55ff0be2e05)|`Merge branch 'public/algebras/ariki_koike_algebras_with_bases-20469' in 8.5.b6`|



---

archive/issue_comments_374802.json:
```json
{
    "body": "Changing commit from \"c8a9c2f468c6832750ba0898257fab53e7996192\" to \"ebb2c1b6ac2f6efa06cc76e3ce7fc55ff0be2e05\"",
    "created_at": "2018-12-07T19:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c8a9c2f468c6832750ba0898257fab53e7996192" to "ebb2c1b6ac2f6efa06cc76e3ce7fc55ff0be2e05"



---

archive/issue_comments_374803.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------|\n|[0a058b5](https://github.com/sagemath/sagetrac-mirror/commit/0a058b5ee014946497148939e53e6ffc9ecba67a)|`one detail`|",
    "created_at": "2018-12-07T19:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[0a058b5](https://github.com/sagemath/sagetrac-mirror/commit/0a058b5ee014946497148939e53e6ffc9ecba67a)|`one detail`|



---

archive/issue_comments_374804.json:
```json
{
    "body": "Changing commit from \"ebb2c1b6ac2f6efa06cc76e3ce7fc55ff0be2e05\" to \"0a058b5ee014946497148939e53e6ffc9ecba67a\"",
    "created_at": "2018-12-07T19:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374804",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ebb2c1b6ac2f6efa06cc76e3ce7fc55ff0be2e05" to "0a058b5ee014946497148939e53e6ffc9ecba67a"



---

archive/issue_comments_374805.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-07T19:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374805",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_062942.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-07T19:48:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62942"
}
```



---

archive/issue_events_062943.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-07T19:48:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62943"
}
```



---

archive/issue_comments_374806.json:
```json
{
    "body": "<a id='comment:31'></a>\none failing doctest, see patchbot",
    "created_at": "2019-01-16T07:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374806",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'></a>
one failing doctest, see patchbot



---

archive/issue_comments_374807.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-16T07:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374807",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_374808.json:
```json
{
    "body": "<a id='comment:32'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[82da4c4](https://github.com/sagemath/sagetrac-mirror/commit/82da4c45986b6b399252e4386561a695eab508db)|`Merge branch 'public/algebras/ariki_koike_algebras_with_bases-20469' of git://trac.sagemath.org/sage into public/algebras/ariki_koike_algebras_with_bases-20469`|\n|[5aac3c2](https://github.com/sagemath/sagetrac-mirror/commit/5aac3c21109cee43d1382e2d6ef04839b73e7b64)|`Fixing multiplication in the T basis. Other misc cleanup.`|",
    "created_at": "2020-03-13T11:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374808",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
|[82da4c4](https://github.com/sagemath/sagetrac-mirror/commit/82da4c45986b6b399252e4386561a695eab508db)|`Merge branch 'public/algebras/ariki_koike_algebras_with_bases-20469' of git://trac.sagemath.org/sage into public/algebras/ariki_koike_algebras_with_bases-20469`|
|[5aac3c2](https://github.com/sagemath/sagetrac-mirror/commit/5aac3c21109cee43d1382e2d6ef04839b73e7b64)|`Fixing multiplication in the T basis. Other misc cleanup.`|



---

archive/issue_comments_374809.json:
```json
{
    "body": "Changing commit from \"0a058b5ee014946497148939e53e6ffc9ecba67a\" to \"5aac3c21109cee43d1382e2d6ef04839b73e7b64\"",
    "created_at": "2020-03-13T11:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374809",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0a058b5ee014946497148939e53e6ffc9ecba67a" to "5aac3c21109cee43d1382e2d6ef04839b73e7b64"



---

archive/issue_comments_374810.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-03-13T11:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374810",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_374811.json:
```json
{
    "body": "<a id='comment:33'></a>\nThanks to Sebastian doing some very thorough testing in looking at changing the index set, I came across a subtle bug in the T multiplication. When performing the reduction of the T<sub>0</sub><sup>r</sup> in T<sub>k,a</sub>, we can have a T<sub>0</sub><sup>0</sup>, which we want to \"represent\" as T<sub>k,0</sub>, but this is defined as `1`. So we have lost track of the s<sub>k-1</sub> ... s<sub>1</sub> permutation. This has now been fixed.",
    "created_at": "2020-03-13T11:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374811",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'></a>
Thanks to Sebastian doing some very thorough testing in looking at changing the index set, I came across a subtle bug in the T multiplication. When performing the reduction of the T<sub>0</sub><sup>r</sup> in T<sub>k,a</sub>, we can have a T<sub>0</sub><sup>0</sup>, which we want to "represent" as T<sub>k,0</sub>, but this is defined as `1`. So we have lost track of the s<sub>k-1</sub> ... s<sub>1</sub> permutation. This has now been fixed.



---

archive/issue_comments_374812.json:
```json
{
    "body": "<a id='comment:34'></a>\nThere seems to be some missing `r\"\"\"` that cause 3 \"invalid escape sequences\", see patchbot report.",
    "created_at": "2020-03-14T19:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374812",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'></a>
There seems to be some missing `r"""` that cause 3 "invalid escape sequences", see patchbot report.



---

archive/issue_comments_374813.json:
```json
{
    "body": "Changing commit from \"5aac3c21109cee43d1382e2d6ef04839b73e7b64\" to \"9a12b94c1a28b60baa0d4d5b9fb91529d49cd82f\"",
    "created_at": "2020-03-15T22:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374813",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5aac3c21109cee43d1382e2d6ef04839b73e7b64" to "9a12b94c1a28b60baa0d4d5b9fb91529d49cd82f"



---

archive/issue_comments_374814.json:
```json
{
    "body": "<a id='comment:35'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[9a12b94](https://github.com/sagemath/sagetrac-mirror/commit/9a12b94c1a28b60baa0d4d5b9fb91529d49cd82f)|`Making things raw strings to fix invalid escape sequences.`|",
    "created_at": "2020-03-15T22:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374814",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[9a12b94](https://github.com/sagemath/sagetrac-mirror/commit/9a12b94c1a28b60baa0d4d5b9fb91529d49cd82f)|`Making things raw strings to fix invalid escape sequences.`|



---

archive/issue_comments_374815.json:
```json
{
    "body": "<a id='comment:36'></a>\nThanks. Fixed.",
    "created_at": "2020-03-15T22:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374815",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'></a>
Thanks. Fixed.



---

archive/issue_comments_374816.json:
```json
{
    "body": "<a id='comment:37'></a>\nIt seems that you missed to fix this:\n\n```\nsage: H = algebras.ArikiKoike(3, 4)\nsage: LT = H.LT()\nsage: LT.inject_variables()\nDefining L1, L2, L3, L4, T1, T2, T3\nsage: LT._Li_power(2,4) == L2 * LT._Li_power(2,3)\nFalse\n```",
    "created_at": "2020-03-17T15:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374816",
    "user": "https://github.com/soehms"
}
```

<a id='comment:37'></a>
It seems that you missed to fix this:

```
sage: H = algebras.ArikiKoike(3, 4)
sage: LT = H.LT()
sage: LT.inject_variables()
Defining L1, L2, L3, L4, T1, T2, T3
sage: LT._Li_power(2,4) == L2 * LT._Li_power(2,3)
False
```



---

archive/issue_comments_374817.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [soehms](#comment%3A37):\n> It seems that you missed to fix this:\n> \n> \n> ```\n> sage: H = algebras.ArikiKoike(3, 4)\n> sage: LT = H.LT()\n> sage: LT.inject_variables()\n> Defining L1, L2, L3, L4, T1, T2, T3\n> sage: LT._Li_power(2,4) == L2 * LT._Li_power(2,3)\n> False\n> ```\n\n\nI do not think there is need to fix that because `_Li_power` is only used in the internal multiplication, which ultimately cancels or resolves out the issues with not doing proper reduction of the the L<sub>i</sub><sup>k</sup>. By not doing as many resolutions (which can generate large number of terms), it should be faster. Should I add something to the `_Li_power` docstring about this or run some timings to confirm?",
    "created_at": "2020-03-17T22:46:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374817",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:38'></a>
Replying to [soehms](#comment%3A37):
> It seems that you missed to fix this:
> 
> 
> ```
> sage: H = algebras.ArikiKoike(3, 4)
> sage: LT = H.LT()
> sage: LT.inject_variables()
> Defining L1, L2, L3, L4, T1, T2, T3
> sage: LT._Li_power(2,4) == L2 * LT._Li_power(2,3)
> False
> ```


I do not think there is need to fix that because `_Li_power` is only used in the internal multiplication, which ultimately cancels or resolves out the issues with not doing proper reduction of the the L<sub>i</sub><sup>k</sup>. By not doing as many resolutions (which can generate large number of terms), it should be faster. Should I add something to the `_Li_power` docstring about this or run some timings to confirm?



---

archive/issue_comments_374818.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [tscrim](#comment%3A38):\n> Replying to [soehms](#comment%3A37):\n> > It seems that you missed to fix this:\n> > \n> > \n> > ```\n> > sage: H = algebras.ArikiKoike(3, 4)\n> > sage: LT = H.LT()\n> > sage: LT.inject_variables()\n> > Defining L1, L2, L3, L4, T1, T2, T3\n> > sage: LT._Li_power(2,4) == L2 * LT._Li_power(2,3)\n> > False\n> > ```\n\n> \n> I do not think there is need to fix that because `_Li_power` is only used in the internal multiplication, which ultimately cancels or resolves out the issues with not doing proper reduction of the the L<sub>i</sub><sup>k</sup>. By not doing as many resolutions (which can generate large number of terms), it should be faster.\n\n\nAh, I forgot about that explanation!\n\n> Should I add something to the `_Li_power` docstring about this or run some timings to confirm?\n\n\nI think a comment on that would make sense, since `LT._Li_power(2,4) == L2**4` giving `False` is quite irritating.",
    "created_at": "2020-03-18T11:06:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374818",
    "user": "https://github.com/soehms"
}
```

<a id='comment:39'></a>
Replying to [tscrim](#comment%3A38):
> Replying to [soehms](#comment%3A37):
> > It seems that you missed to fix this:
> > 
> > 
> > ```
> > sage: H = algebras.ArikiKoike(3, 4)
> > sage: LT = H.LT()
> > sage: LT.inject_variables()
> > Defining L1, L2, L3, L4, T1, T2, T3
> > sage: LT._Li_power(2,4) == L2 * LT._Li_power(2,3)
> > False
> > ```

> 
> I do not think there is need to fix that because `_Li_power` is only used in the internal multiplication, which ultimately cancels or resolves out the issues with not doing proper reduction of the the L<sub>i</sub><sup>k</sup>. By not doing as many resolutions (which can generate large number of terms), it should be faster.


Ah, I forgot about that explanation!

> Should I add something to the `_Li_power` docstring about this or run some timings to confirm?


I think a comment on that would make sense, since `LT._Li_power(2,4) == L2**4` giving `False` is quite irritating.



---

archive/issue_comments_374819.json:
```json
{
    "body": "<a id='comment:40'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[ff1ad86](https://github.com/sagemath/sagetrac-mirror/commit/ff1ad8647d1bca65f348db804383a71c39e2b724)|`A hybrid approach to an _Li_power computation.`|",
    "created_at": "2020-03-19T00:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374819",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[ff1ad86](https://github.com/sagemath/sagetrac-mirror/commit/ff1ad8647d1bca65f348db804383a71c39e2b724)|`A hybrid approach to an _Li_power computation.`|



---

archive/issue_comments_374820.json:
```json
{
    "body": "Changing commit from \"9a12b94c1a28b60baa0d4d5b9fb91529d49cd82f\" to \"ff1ad8647d1bca65f348db804383a71c39e2b724\"",
    "created_at": "2020-03-19T00:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374820",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9a12b94c1a28b60baa0d4d5b9fb91529d49cd82f" to "ff1ad8647d1bca65f348db804383a71c39e2b724"



---

archive/issue_comments_374821.json:
```json
{
    "body": "<a id='comment:41'></a>\nI ran some timings to confirm my suspicions, and here is what I found:\n\n```\nsage: def test(LT):\n....:     B = LT.basis()\n....:     for b in B:\n....:         for bp in B:\n....:             dummy = b * bp\nsage: H = algebras.ArikiKoike(4, 2)\nsage: LT = H.LT()\nsage: %time test(LT)\nCPU times: user 3.49 s, sys: 6.16 ms, total: 3.5 s\nWall time: 3.5 s\nsage: H = algebras.ArikiKoike(5, 2)\nsage: LT = H.LT()\nsage: %time test(LT)\nCPU times: user 2min 50s, sys: 446 ms, total: 2min 51s\nWall time: 2min 51s\n```\nversus always resolving it out:\n\n```\nsage: H = algebras.ArikiKoike(4, 2)\nsage: LT = H.LT()\nsage: %time test(LT)\nCPU times: user 3.16 s, sys: 23.5 ms, total: 3.18 s\nWall time: 3.18 s\nsage: H = algebras.ArikiKoike(5, 2)\nsage: LT = H.LT()\nsage: %time test(LT)\nCPU times: user 3min 14s, sys: 463 ms, total: 3min 14s\nWall time: 3min 14s\n```\nSo it seems to be inconsistent with which one is better strangely enough. Memory-wise they seem to be similar. The latter is ~11% slower. So I implemented a hybrid approach and here is the timings for that:\n\n```\nsage: H = algebras.ArikiKoike(4, 2)\nsage: LT = H.LT()\nsage: %time test(LT)\nCPU times: user 3.27 s, sys: 25.4 ms, total: 3.29 s\nWall time: 3.33 s\nsage: H = algebras.ArikiKoike(5, 2)\nsage: LT = H.LT()\nsage: %time test(LT)\nCPU times: user 3min 17s, sys: 389 ms, total: 3min 17s\nWall time: 3min 17s\n```\nSo I think I will go with the hybrid, trying keep some of the benefits of both (less multiplication and strict correctness at intermediate steps). I suspect the last timing is a little skewed because I was doing a few other things on my computer at the time.",
    "created_at": "2020-03-19T00:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374821",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:41'></a>
I ran some timings to confirm my suspicions, and here is what I found:

```
sage: def test(LT):
....:     B = LT.basis()
....:     for b in B:
....:         for bp in B:
....:             dummy = b * bp
sage: H = algebras.ArikiKoike(4, 2)
sage: LT = H.LT()
sage: %time test(LT)
CPU times: user 3.49 s, sys: 6.16 ms, total: 3.5 s
Wall time: 3.5 s
sage: H = algebras.ArikiKoike(5, 2)
sage: LT = H.LT()
sage: %time test(LT)
CPU times: user 2min 50s, sys: 446 ms, total: 2min 51s
Wall time: 2min 51s
```
versus always resolving it out:

```
sage: H = algebras.ArikiKoike(4, 2)
sage: LT = H.LT()
sage: %time test(LT)
CPU times: user 3.16 s, sys: 23.5 ms, total: 3.18 s
Wall time: 3.18 s
sage: H = algebras.ArikiKoike(5, 2)
sage: LT = H.LT()
sage: %time test(LT)
CPU times: user 3min 14s, sys: 463 ms, total: 3min 14s
Wall time: 3min 14s
```
So it seems to be inconsistent with which one is better strangely enough. Memory-wise they seem to be similar. The latter is ~11% slower. So I implemented a hybrid approach and here is the timings for that:

```
sage: H = algebras.ArikiKoike(4, 2)
sage: LT = H.LT()
sage: %time test(LT)
CPU times: user 3.27 s, sys: 25.4 ms, total: 3.29 s
Wall time: 3.33 s
sage: H = algebras.ArikiKoike(5, 2)
sage: LT = H.LT()
sage: %time test(LT)
CPU times: user 3min 17s, sys: 389 ms, total: 3min 17s
Wall time: 3min 17s
```
So I think I will go with the hybrid, trying keep some of the benefits of both (less multiplication and strict correctness at intermediate steps). I suspect the last timing is a little skewed because I was doing a few other things on my computer at the time.



---

archive/issue_comments_374822.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [tscrim](#comment%3A41):\n\n> So I think I will go with the hybrid, trying keep some of the benefits of both (less multiplication and strict correctness at intermediate steps). I suspect the last timing is a little skewed because I was doing a few other things on my computer at the time.\n\n\nAre you sure you want to keep the hybrid version? I repeated your test and the timing comparison was even worse.\n\nWhat about the following suggestion: Rename `_Li_power` as something like `_prepare_Li_power` to avoid such irritation. In addition, leave your new test in the docstring returning `False` as an example that this method does not give the final result (but for this purpose you have to run it for `algebras.ArikiKoike(3, 4)`).\n\nFurthermore, the local function `L` in `_Li_power` seems not to be used any more. Can't we delete it?",
    "created_at": "2020-03-20T20:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374822",
    "user": "https://github.com/soehms"
}
```

<a id='comment:42'></a>
Replying to [tscrim](#comment%3A41):

> So I think I will go with the hybrid, trying keep some of the benefits of both (less multiplication and strict correctness at intermediate steps). I suspect the last timing is a little skewed because I was doing a few other things on my computer at the time.


Are you sure you want to keep the hybrid version? I repeated your test and the timing comparison was even worse.

What about the following suggestion: Rename `_Li_power` as something like `_prepare_Li_power` to avoid such irritation. In addition, leave your new test in the docstring returning `False` as an example that this method does not give the final result (but for this purpose you have to run it for `algebras.ArikiKoike(3, 4)`).

Furthermore, the local function `L` in `_Li_power` seems not to be used any more. Can't we delete it?



---

archive/issue_comments_374823.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [soehms](#comment%3A42):\n> Replying to [tscrim](#comment%3A41):\n> \n> > So I think I will go with the hybrid, trying keep some of the benefits of both (less multiplication and strict correctness at intermediate steps). I suspect the last timing is a little skewed because I was doing a few other things on my computer at the time.\n\n> \n> Are you sure you want to keep the hybrid version? I repeated your test and the timing comparison was even worse.\n\n\nWhich timings? I agree this will probably be worse than the previous version, but it cannot be worse than the fully-reduced-to-basis version.\n\n> What about the following suggestion: Rename `_Li_power` as something like `_prepare_Li_power` to avoid such irritation. In addition, leave your new test in the docstring returning `False` as an example that this method does not give the final result (but for this purpose you have to run it for `algebras.ArikiKoike(3, 4)`).\n\n\nI think that name is less descriptive. Plus it gives the correct result, just not necessarily in the basis elements, which is okay for an internal function not visible to the standard user. So if we decide revert the change, then I think just a warning would be sufficient.\n\n> Furthermore, the local function `L` in `_Li_power` seems not to be used any more. Can't we delete it?\n\n\nYes, we can delete it.",
    "created_at": "2020-03-20T21:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374823",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:43'></a>
Replying to [soehms](#comment%3A42):
> Replying to [tscrim](#comment%3A41):
> 
> > So I think I will go with the hybrid, trying keep some of the benefits of both (less multiplication and strict correctness at intermediate steps). I suspect the last timing is a little skewed because I was doing a few other things on my computer at the time.

> 
> Are you sure you want to keep the hybrid version? I repeated your test and the timing comparison was even worse.


Which timings? I agree this will probably be worse than the previous version, but it cannot be worse than the fully-reduced-to-basis version.

> What about the following suggestion: Rename `_Li_power` as something like `_prepare_Li_power` to avoid such irritation. In addition, leave your new test in the docstring returning `False` as an example that this method does not give the final result (but for this purpose you have to run it for `algebras.ArikiKoike(3, 4)`).


I think that name is less descriptive. Plus it gives the correct result, just not necessarily in the basis elements, which is okay for an internal function not visible to the standard user. So if we decide revert the change, then I think just a warning would be sufficient.

> Furthermore, the local function `L` in `_Li_power` seems not to be used any more. Can't we delete it?


Yes, we can delete it.



---

archive/issue_comments_374824.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [tscrim](#comment%3A43):\n> Which timings? I agree this will probably be worse than the previous version, but it cannot be worse than the fully-reduced-to-basis version.\n\n\nOf course, I meant in the comparison with the previous version!\n\n> So if we decide revert the change, then I think just a warning would be sufficient.\n\n\nAgreed! \n\nOnce this is done from my point of view we can let the ticket pass.",
    "created_at": "2020-03-21T15:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374824",
    "user": "https://github.com/soehms"
}
```

<a id='comment:44'></a>
Replying to [tscrim](#comment%3A43):
> Which timings? I agree this will probably be worse than the previous version, but it cannot be worse than the fully-reduced-to-basis version.


Of course, I meant in the comparison with the previous version!

> So if we decide revert the change, then I think just a warning would be sufficient.


Agreed! 

Once this is done from my point of view we can let the ticket pass.



---

archive/issue_comments_374825.json:
```json
{
    "body": "<a id='comment:45'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[2e11e63](https://github.com/sagemath/sagetrac-mirror/commit/2e11e63d49686fc133ddfb221f01cbb6f8e67f50)|`Reverting to original method for _Li_power and added warning.`|",
    "created_at": "2020-03-22T22:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374825",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[2e11e63](https://github.com/sagemath/sagetrac-mirror/commit/2e11e63d49686fc133ddfb221f01cbb6f8e67f50)|`Reverting to original method for _Li_power and added warning.`|



---

archive/issue_comments_374826.json:
```json
{
    "body": "Changing commit from \"ff1ad8647d1bca65f348db804383a71c39e2b724\" to \"2e11e63d49686fc133ddfb221f01cbb6f8e67f50\"",
    "created_at": "2020-03-22T22:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374826",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ff1ad8647d1bca65f348db804383a71c39e2b724" to "2e11e63d49686fc133ddfb221f01cbb6f8e67f50"



---

archive/issue_comments_374827.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [soehms](#comment%3A44):\n> Replying to [tscrim](#comment%3A43):\n> > So if we decide revert the change, then I think just a warning would be sufficient.\n\n> \n> Agreed! \n> \n> Once this is done from my point of view we can let the ticket pass.\n\n\nDone. Thank you! Please set to a final positive review if you are happy with my changes.",
    "created_at": "2020-03-22T22:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374827",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:46'></a>
Replying to [soehms](#comment%3A44):
> Replying to [tscrim](#comment%3A43):
> > So if we decide revert the change, then I think just a warning would be sufficient.

> 
> Agreed! 
> 
> Once this is done from my point of view we can let the ticket pass.


Done. Thank you! Please set to a final positive review if you are happy with my changes.



---

archive/issue_comments_374828.json:
```json
{
    "body": "<a id='comment:47'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|\n|[ed667cc](https://github.com/sagemath/sagetrac-mirror/commit/ed667ccee09c6e0f088d2d84eefd6866344ba094)|`Merge branch 'public/algebras/ariki_koike_algebras_with_bases-20469' of git://trac.sagemath.org/sage into ariki_koike_alg_20469`|\n|[bbe4874](https://github.com/sagemath/sagetrac-mirror/commit/bbe4874c2e1b013020de51553be87b2448767cc4)|`20469: fixed pyflakes hint`|",
    "created_at": "2020-03-23T06:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374828",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
|[ed667cc](https://github.com/sagemath/sagetrac-mirror/commit/ed667ccee09c6e0f088d2d84eefd6866344ba094)|`Merge branch 'public/algebras/ariki_koike_algebras_with_bases-20469' of git://trac.sagemath.org/sage into ariki_koike_alg_20469`|
|[bbe4874](https://github.com/sagemath/sagetrac-mirror/commit/bbe4874c2e1b013020de51553be87b2448767cc4)|`20469: fixed pyflakes hint`|



---

archive/issue_comments_374829.json:
```json
{
    "body": "Changing commit from \"2e11e63d49686fc133ddfb221f01cbb6f8e67f50\" to \"bbe4874c2e1b013020de51553be87b2448767cc4\"",
    "created_at": "2020-03-23T06:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374829",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2e11e63d49686fc133ddfb221f01cbb6f8e67f50" to "bbe4874c2e1b013020de51553be87b2448767cc4"



---

archive/issue_comments_374830.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-23T07:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374830",
    "user": "https://github.com/soehms"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_374831.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [tscrim](#comment%3A46):\n> Done. Thank you! Please set to a final positive review if you are happy with my changes.\n\n\nYes, I am (just fixed a patchbot hint)! Thanks, as well.",
    "created_at": "2020-03-23T07:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374831",
    "user": "https://github.com/soehms"
}
```

<a id='comment:48'></a>
Replying to [tscrim](#comment%3A46):
> Done. Thank you! Please set to a final positive review if you are happy with my changes.


Yes, I am (just fixed a patchbot hint)! Thanks, as well.



---

archive/issue_comments_374832.json:
```json
{
    "body": "Changing reviewer from \"Andrew Mathas, Travis Scrimshaw\" to \"Andrew Mathas, Travis Scrimshaw, Sebastian Oehms\"",
    "created_at": "2020-03-23T07:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374832",
    "user": "https://github.com/soehms"
}
```

Changing reviewer from "Andrew Mathas, Travis Scrimshaw" to "Andrew Mathas, Travis Scrimshaw, Sebastian Oehms"



---

archive/issue_comments_374833.json:
```json
{
    "body": "Changing commit from \"bbe4874c2e1b013020de51553be87b2448767cc4\" to \"daf777ec27554610ab39c5bbe31f74673238c58c\"",
    "created_at": "2020-03-23T07:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374833",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "bbe4874c2e1b013020de51553be87b2448767cc4" to "daf777ec27554610ab39c5bbe31f74673238c58c"



---

archive/issue_comments_374834.json:
```json
{
    "body": "<a id='comment:49'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[daf777e](https://github.com/sagemath/sagetrac-mirror/commit/daf777ec27554610ab39c5bbe31f74673238c58c)|`20469: redundant local function `L` deleted`|",
    "created_at": "2020-03-23T07:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374834",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[daf777e](https://github.com/sagemath/sagetrac-mirror/commit/daf777ec27554610ab39c5bbe31f74673238c58c)|`20469: redundant local function `L` deleted`|



---

archive/issue_comments_374835.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-03-23T07:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374835",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_374836.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-03-23T08:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374836",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_374837.json:
```json
{
    "body": "<a id='comment:50'></a>\nThank you.",
    "created_at": "2020-03-23T08:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374837",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:50'></a>
Thank you.



---

archive/issue_events_062944.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-23T08:19:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62944"
}
```



---

archive/issue_events_062945.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-03-23T08:19:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62945"
}
```



---

archive/issue_events_062946.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-29T00:24:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20469#event-62946"
}
```



---

archive/issue_comments_374838.json:
```json
{
    "body": "Changing branch from \"public/algebras/ariki_koike_algebras_with_bases-20469\" to \"daf777ec27554610ab39c5bbe31f74673238c58c\"",
    "created_at": "2020-03-29T00:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374838",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/algebras/ariki_koike_algebras_with_bases-20469" to "daf777ec27554610ab39c5bbe31f74673238c58c"



---

archive/issue_comments_374839.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-29T00:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20469",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20469#issuecomment-374839",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
