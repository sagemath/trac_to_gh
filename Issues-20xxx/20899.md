# Issue 20899: `AbstractLinearCode` should throw sensible error messages on printing

archive/issues_020662.json:
```json
{
    "body": "The doc explicitly says that to create a new class of linear codes, you must override `_repr_` and `_latex_`. However, if the user forgets, a bizarre error seems to be thrown when trying to print an instance of the new code class:\n\n```\n%cpaste\nfrom sage.coding.linear_code import AbstractLinearCode\nfrom sage.coding.encoder import Encoder\n\nclass MyCode(AbstractLinearCode):\n    _registered_encoders = {}\n    _registered_decoders = {}\n    def __init__(self):\n        super(MyCode, self).__init__(GF(5), 10, \"Monkey\", \"Syndrome\")\n        self._dimension = 2\n\nclass MonkeyEncoder(Encoder):\n    def __init__(self, C):    \n        super(MonkeyEncoder, self).__init__(C)\n    @cached_method\n    def generator_matrix(self): \n        return matrix(GF(5), 2, 10, [ [1]*5 + [0]*5, [0]*5 + [1]*5 ])\nMyCode._registered_encoders[\"Monkey\"] = MonkeyEncoder\nMyCode._registered_decoders[\"Syndrome\"] = codes.decoders.LinearCodeSyndromeDecoder\n--\nsage: C = MyCode()\nsage: C\n<BOOM with bizarre error>\n```\n\nIf `AbstractLinearCode` had a `_repr_` and a `_latex_` method which both threw sensible error messages, this would be much more helpful to the user.\n\n\nCC:  dlucas\n\nKeywords: linear code, error messages, rd3\n\nBranch/Commit: b0bca6f978580b57129256264b338e6b0adb6cc1\n\nReviewer: Bruno Grenet\n\nAuthor: David Lucas\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20899\n\n",
    "closed_at": "2017-02-08T22:48:49Z",
    "created_at": "2016-06-28T15:38:33Z",
    "labels": [
        "component: coding theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "`AbstractLinearCode` should throw sensible error messages on printing",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20899",
    "user": "https://github.com/johanrosenkilde"
}
```
The doc explicitly says that to create a new class of linear codes, you must override `_repr_` and `_latex_`. However, if the user forgets, a bizarre error seems to be thrown when trying to print an instance of the new code class:

```
%cpaste
from sage.coding.linear_code import AbstractLinearCode
from sage.coding.encoder import Encoder

class MyCode(AbstractLinearCode):
    _registered_encoders = {}
    _registered_decoders = {}
    def __init__(self):
        super(MyCode, self).__init__(GF(5), 10, "Monkey", "Syndrome")
        self._dimension = 2

class MonkeyEncoder(Encoder):
    def __init__(self, C):    
        super(MonkeyEncoder, self).__init__(C)
    @cached_method
    def generator_matrix(self): 
        return matrix(GF(5), 2, 10, [ [1]*5 + [0]*5, [0]*5 + [1]*5 ])
MyCode._registered_encoders["Monkey"] = MonkeyEncoder
MyCode._registered_decoders["Syndrome"] = codes.decoders.LinearCodeSyndromeDecoder
--
sage: C = MyCode()
sage: C
<BOOM with bizarre error>
```

If `AbstractLinearCode` had a `_repr_` and a `_latex_` method which both threw sensible error messages, this would be much more helpful to the user.


CC:  dlucas

Keywords: linear code, error messages, rd3

Branch/Commit: b0bca6f978580b57129256264b338e6b0adb6cc1

Reviewer: Bruno Grenet

Author: David Lucas

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20899





---

archive/issue_comments_285017.json:
```json
{
    "body": "<a id='comment:1'></a>Fixed amusing spelling mistake in the title...",
    "created_at": "2016-06-29T08:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285017",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:1'></a>Fixed amusing spelling mistake in the title...



---

archive/issue_comments_285018.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-29T13:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285018",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_285019.json:
```json
{
    "body": "<a id='comment:3'></a>Hello,\n\nI pushed a fix for this ticket.\n\nTwo remarks:\n\n- I used `RuntimeError` instead of `NotImplementedError` because using `NotImplementedError` prints a poorly formatted error message (you don't get any traceback).\n\n- Because `_repr_` to always returns a string, it returns a string message including the hexadecimal address of the objects which raised the error after the usual error traceback... Because this address changes everytime, I had to set a flag `#random` to the related doctest.\n\nBest,\n\nDavid \n\n---\nNew commits:",
    "created_at": "2016-06-29T13:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285019",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:3'></a>Hello,

I pushed a fix for this ticket.

Two remarks:

- I used `RuntimeError` instead of `NotImplementedError` because using `NotImplementedError` prints a poorly formatted error message (you don't get any traceback).

- Because `_repr_` to always returns a string, it returns a string message including the hexadecimal address of the objects which raised the error after the usual error traceback... Because this address changes everytime, I had to set a flag `#random` to the related doctest.

Best,

David 

---
New commits:



---

archive/issue_comments_285020.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-07T10:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285020",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_285021.json:
```json
{
    "body": "<a id='comment:4'></a>Two changes and a comment/question in `_repr_` and `_latex_` of `AbstractLinearCode`:\n\n* `Returns` should be `Return` (in both docstrings)\n* It would be better to use Python3's print for the future: Please replace `\"Please override _repr_ in the implementation of %s\" % self.parent()` by `\"Please override _repr_ in the implementation of {}\".format(self.parent())`, and similarly in `_latex_`.\n* Is it possible to get the error\n  {{{#!python\n  RuntimeError: Please override _repr_ in the implementation of MyCode\n  }}}\n  instead of \n  {{{#!python\n  RuntimeError: Please override _repr_ in the implementation of <class __main__.MyCode_with_category'>\n  }}}",
    "created_at": "2017-02-07T10:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285021",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:4'></a>Two changes and a comment/question in `_repr_` and `_latex_` of `AbstractLinearCode`:

* `Returns` should be `Return` (in both docstrings)
* It would be better to use Python3's print for the future: Please replace `"Please override _repr_ in the implementation of %s" % self.parent()` by `"Please override _repr_ in the implementation of {}".format(self.parent())`, and similarly in `_latex_`.
* Is it possible to get the error
  {{{#!python
  RuntimeError: Please override _repr_ in the implementation of MyCode
  }}}
  instead of 
  {{{#!python
  RuntimeError: Please override _repr_ in the implementation of <class __main__.MyCode_with_category'>
  }}}



---

archive/issue_comments_285022.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T10:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285023.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-07T10:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285023",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285024.json:
```json
{
    "body": "<a id='comment:6'></a>I fixed what you asked, except for your third comment, as I'm not sure it's possible to do that.",
    "created_at": "2017-02-07T10:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285024",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:6'></a>I fixed what you asked, except for your third comment, as I'm not sure it's possible to do that.



---

archive/issue_comments_285025.json:
```json
{
    "body": "Changing keywords from \"linear code, error messages\" to \"linear code, error messages, rd3\".",
    "created_at": "2017-02-07T10:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285025",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing keywords from "linear code, error messages" to "linear code, error messages, rd3".



---

archive/issue_comments_285026.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-07T13:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285026",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_285027.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 dlucas]:\n> I fixed what you asked, except for your third comment, as I'm not sure it's possible to do that.\n\n\nNice. One could use the attribute `__name__` to get rid of the `<class ...>` but it wouldn't be perfect at all: one would get \n\n```python\nRuntimeError: Please override _repr_ in the implementation of MyCode_with_category\n```\nI am not sure this is actually better. So I think the current ticket in its current form is already a sufficient improvement over the current state.",
    "created_at": "2017-02-07T13:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285027",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:7'></a>Replying to [comment:6 dlucas]:
> I fixed what you asked, except for your third comment, as I'm not sure it's possible to do that.


Nice. One could use the attribute `__name__` to get rid of the `<class ...>` but it wouldn't be perfect at all: one would get 

```python
RuntimeError: Please override _repr_ in the implementation of MyCode_with_category
```
I am not sure this is actually better. So I think the current ticket in its current form is already a sufficient improvement over the current state.



---

archive/issue_comments_285028.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-08T22:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20899#issuecomment-285028",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_055999.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-02-08T22:48:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20899",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20899#event-55999"
}
```
