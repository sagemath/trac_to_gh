# Issue 20174: Avoid recomputing vacancy numbers for rigged configurations

archive/issues_019937.json:
```json
{
    "body": "Many of rigged configuration operations, such as `e()` and `f()`, needlessly recompute the vacancy numbers. We simply need to tell the constructor to avoid doing these computations.\n\nAlso, because the Cartan matrices are sparse and general matrix implementation details, it is relatively expensive to iterate over the row. Instead, it is much fast to get the specific entry by `CM[i,j]`.\n\nAssignee: sage-combinat\n\nCC:  sage-combinat @anneschilling @bsalisbury1\n\nKeywords: rigged configurations\n\nBranch/Commit: 8591c4aca549ef8d0e8e487878a1efe4cad02456\n\nReviewer: Anne Schilling\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20174\n\n",
    "closed_at": "2016-03-26T11:30:54Z",
    "created_at": "2016-03-07T08:25:05Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Avoid recomputing vacancy numbers for rigged configurations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20174",
    "user": "https://github.com/tscrim"
}
```
Many of rigged configuration operations, such as `e()` and `f()`, needlessly recompute the vacancy numbers. We simply need to tell the constructor to avoid doing these computations.

Also, because the Cartan matrices are sparse and general matrix implementation details, it is relatively expensive to iterate over the row. Instead, it is much fast to get the specific entry by `CM[i,j]`.

Assignee: sage-combinat

CC:  sage-combinat @anneschilling @bsalisbury1

Keywords: rigged configurations

Branch/Commit: 8591c4aca549ef8d0e8e487878a1efe4cad02456

Reviewer: Anne Schilling

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20174





---

archive/issue_comments_360010.json:
```json
{
    "body": "<a id='comment:1'></a>\nWith branch:\n\n```\nsage: RC = RiggedConfigurations(['B',4,1], [[2,1],[3,1]])\nsage: %time len(list(RC))\nCPU times: user 3.33 s, sys: 19.6 ms, total: 3.35 s\nWall time: 3.33 s\n3441\nsage: RC = RiggedConfigurations(['A',4,1], [[2,1],[3,1]])\nsage: %time len(list(RC))\nCPU times: user 41.9 ms, sys: 4.27 ms, total: 46.1 ms\nWall time: 38.8 ms\n100\nsage: RC = RiggedConfigurations(['D',6,1], [[2,1],[3,1]])\nsage: %time len(list(RC))\nCPU times: user 7.17 s, sys: 36 ms, total: 7.21 s\nWall time: 7.19 s\n15544\n```\nvs old version\n\n```\nsage: RC = RiggedConfigurations(['B',4,1], [[2,1],[3,1]])\nsage: %time len(list(RC))\nCPU times: user 12.5 s, sys: 45 ms, total: 12.5 s\nWall time: 12.5 s\n3441\nsage: RC = RiggedConfigurations(['A',4,1], [[2,1],[3,1]])\nsage: %time len(list(RC))\nCPU times: user 97.5 ms, sys: 4.16 ms, total: 102 ms\nWall time: 88.4 ms\n100\nsage: RC = RiggedConfigurations(['D',6,1], [[2,1],[3,1]])\nsage: %time len(list(RC))\nCPU times: user 26.5 s, sys: 52.1 ms, total: 26.6 s\nWall time: 26.5 s\n15544\n```\n\nSlightly annoying how simple changes these were and resulting in such a large speed gain...\n\n---\nNew commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[8d2decd](https://github.com/sagemath/sagetrac-mirror/commit/8d2decd5b0d1bfb2be47af7da2d27e789842dfbc)|`Avoid needlessly recomputing the vacancy numbers.`|",
    "created_at": "2016-03-07T08:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360010",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
With branch:

```
sage: RC = RiggedConfigurations(['B',4,1], [[2,1],[3,1]])
sage: %time len(list(RC))
CPU times: user 3.33 s, sys: 19.6 ms, total: 3.35 s
Wall time: 3.33 s
3441
sage: RC = RiggedConfigurations(['A',4,1], [[2,1],[3,1]])
sage: %time len(list(RC))
CPU times: user 41.9 ms, sys: 4.27 ms, total: 46.1 ms
Wall time: 38.8 ms
100
sage: RC = RiggedConfigurations(['D',6,1], [[2,1],[3,1]])
sage: %time len(list(RC))
CPU times: user 7.17 s, sys: 36 ms, total: 7.21 s
Wall time: 7.19 s
15544
```
vs old version

```
sage: RC = RiggedConfigurations(['B',4,1], [[2,1],[3,1]])
sage: %time len(list(RC))
CPU times: user 12.5 s, sys: 45 ms, total: 12.5 s
Wall time: 12.5 s
3441
sage: RC = RiggedConfigurations(['A',4,1], [[2,1],[3,1]])
sage: %time len(list(RC))
CPU times: user 97.5 ms, sys: 4.16 ms, total: 102 ms
Wall time: 88.4 ms
100
sage: RC = RiggedConfigurations(['D',6,1], [[2,1],[3,1]])
sage: %time len(list(RC))
CPU times: user 26.5 s, sys: 52.1 ms, total: 26.6 s
Wall time: 26.5 s
15544
```

Slightly annoying how simple changes these were and resulting in such a large speed gain...

---
New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[8d2decd](https://github.com/sagemath/sagetrac-mirror/commit/8d2decd5b0d1bfb2be47af7da2d27e789842dfbc)|`Avoid needlessly recomputing the vacancy numbers.`|



---

archive/issue_comments_360011.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-07T08:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360011",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_360012.json:
```json
{
    "body": "Changing commit from \"\" to \"8d2decd5b0d1bfb2be47af7da2d27e789842dfbc\"",
    "created_at": "2016-03-07T08:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360012",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "8d2decd5b0d1bfb2be47af7da2d27e789842dfbc"



---

archive/issue_comments_360013.json:
```json
{
    "body": "Changing branch from \"\" to \"public/rigged_configurations/speedup_crystal_ops-20174\"",
    "created_at": "2016-03-07T08:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360013",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/rigged_configurations/speedup_crystal_ops-20174"



---

archive/issue_comments_360014.json:
```json
{
    "body": "Changing commit from \"8d2decd5b0d1bfb2be47af7da2d27e789842dfbc\" to \"8591c4aca549ef8d0e8e487878a1efe4cad02456\"",
    "created_at": "2016-03-07T08:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360014",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8d2decd5b0d1bfb2be47af7da2d27e789842dfbc" to "8591c4aca549ef8d0e8e487878a1efe4cad02456"



---

archive/issue_comments_360015.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|\n|[8591c4a](https://github.com/sagemath/sagetrac-mirror/commit/8591c4aca549ef8d0e8e487878a1efe4cad02456)|`Some other similar tweaks for highest weight/B(oo) RC crystals.`|",
    "created_at": "2016-03-07T08:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360015",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
|[8591c4a](https://github.com/sagemath/sagetrac-mirror/commit/8591c4aca549ef8d0e8e487878a1efe4cad02456)|`Some other similar tweaks for highest weight/B(oo) RC crystals.`|



---

archive/issue_comments_360016.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Many of rigged configuration operations, such as `e()` and `f()`, needlessly recompute the vacancy numbers. We simply need to tell the constructor to avoid doing these computations.\n+\n+Also, because the Cartan matrices are sparse and general matrix implementation details, it is relatively expensive to iterate over the row. Instead, it is much fast to get the specific entry by `CM[i,j]`.\n``````\n",
    "created_at": "2016-03-07T08:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360016",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Many of rigged configuration operations, such as `e()` and `f()`, needlessly recompute the vacancy numbers. We simply need to tell the constructor to avoid doing these computations.
+
+Also, because the Cartan matrices are sparse and general matrix implementation details, it is relatively expensive to iterate over the row. Instead, it is much fast to get the specific entry by `CM[i,j]`.
``````




---

archive/issue_comments_360017.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-25T05:56:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360017",
    "user": "https://github.com/anneschilling"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_360018.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Anne Schilling\"",
    "created_at": "2016-03-25T05:56:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360018",
    "user": "https://github.com/anneschilling"
}
```

Changing reviewer from "" to "Anne Schilling"



---

archive/issue_events_070160.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2016-03-25T05:56:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20174#event-70160"
}
```



---

archive/issue_events_070161.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-03-26T11:30:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20174#event-70161"
}
```



---

archive/issue_comments_360019.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-26T11:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360019",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_360020.json:
```json
{
    "body": "Changing branch from \"public/rigged_configurations/speedup_crystal_ops-20174\" to \"8591c4aca549ef8d0e8e487878a1efe4cad02456\"",
    "created_at": "2016-03-26T11:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20174#issuecomment-360020",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/rigged_configurations/speedup_crystal_ops-20174" to "8591c4aca549ef8d0e8e487878a1efe4cad02456"
