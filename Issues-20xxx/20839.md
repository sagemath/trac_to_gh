# Issue 20839: Basic intersection analysis for algebraic curves

archive/issues_020602.json:
```json
{
    "body": "Implement basic intersection analysis, such as when given two curves and a point, determine if the point is in the intersection of the two curves, and if so, compute the intersection multiplicity of the curves at that point if defined. Also, given a projective curve, determine if it is a complete intersection.\n\nCC:  @bhutz @miguelmarco\n\nKeywords: gsoc2016\n\nBranch/Commit: cae16fe73a6db14d63156e509c48b160ae17094e\n\nReviewer: Ben Hutz\n\nAuthor: Grayson Jorgenson\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20839\n\n",
    "closed_at": "2016-06-26T07:30:25Z",
    "created_at": "2016-06-17T05:55:10Z",
    "labels": [
        "component: algebraic geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Basic intersection analysis for algebraic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20839",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```
Implement basic intersection analysis, such as when given two curves and a point, determine if the point is in the intersection of the two curves, and if so, compute the intersection multiplicity of the curves at that point if defined. Also, given a projective curve, determine if it is a complete intersection.

CC:  @bhutz @miguelmarco

Keywords: gsoc2016

Branch/Commit: cae16fe73a6db14d63156e509c48b160ae17094e

Reviewer: Ben Hutz

Author: Grayson Jorgenson

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20839





---

archive/issue_comments_374987.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gjorgenson/ticket/20839\"",
    "created_at": "2016-06-17T05:55:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374987",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing branch from "" to "u/gjorgenson/ticket/20839"



---

archive/issue_comments_374988.json:
```json
{
    "body": "Changing commit from \"\" to \"f775a0ffaa6a969b5c3c4dc7a03862f0e71fdc58\"",
    "created_at": "2016-06-20T02:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "f775a0ffaa6a969b5c3c4dc7a03862f0e71fdc58"



---

archive/issue_comments_374989.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[f775a0f](https://github.com/sagemath/sagetrac-mirror/commit/f775a0ffaa6a969b5c3c4dc7a03862f0e71fdc58)|`20839: first implementation attempt.`|",
    "created_at": "2016-06-20T02:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[f775a0f](https://github.com/sagemath/sagetrac-mirror/commit/f775a0ffaa6a969b5c3c4dc7a03862f0e71fdc58)|`20839: first implementation attempt.`|



---

archive/issue_comments_374990.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-20T05:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374990",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_374991.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ben Hutz\"",
    "created_at": "2016-06-20T20:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374991",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "" to "Ben Hutz"



---

archive/issue_comments_374992.json:
```json
{
    "body": "<a id='comment:4'></a>\n- intersects_at(): why not but both attempts in the same try block?\n\n\n- is_complete_intersection: Boolean can go on the same line at OUTPUT\nnot the radical ideal per our discussion today\n\nhere is another noncomplete intersection example\n\n```\nP.<x,y,z,w>=ProjectiveSpace(QQ,3)\nX= Curve([x*z-y^2,z*(y*w-z^2) - w*(x*w-y*z)])\nX.is_complete_intersection()\n```\n\n- intersection_multiplicity: an integer can go on the same line as OUTPUT\n\ngood these add up to 4 as bezout's theorem implies\n\n```\nK.<i>=QuadraticField(-1)\nA.<x,y>=AffineSpace(K,2)\nC = Curve([x^2-y])\nD = Curve([x^2+y^2])\nfor t in C.intersection(D).rational_points():\n    C.intersection_multiplicity(D,t)\n```\n\nalso good\n\n```\nK.<i>=QuadraticField(-1)\nA.<x,y>=AffineSpace(K,2)\nC = Curve([y^2-x^3])\nD = Curve([(x^2+y^2)^2 - 4*x^2*y^2])\nfor t in C.intersection(D).rational_points():\n    C.intersection_multiplicity(D,t)\n```\n\nso for plane curves this looks ok. Does this really work in dimension greater than 2? I don't think it does, I think the intersection number possibly has lower order terms.  Regardless, in looking at this, the following  example died\n\n```\nK.<i>=QuadraticField(-1)\nA.<x,y,z>=AffineSpace(K,3)\nC = Curve([x^2-y,z^2+x^2])\nD = Curve([x^2+y^2,x^2+z])\nfor t in C.intersection(D).rational_points():\n    C.intersection_multiplicity(D,p)\n```\n\n\n\n- I think an transverse check would be nice too:\n\nis_transverse() - Returns true if and only if the point p is a nonsingular point of both plane curves C and D and the curves have distinct tangents there.",
    "created_at": "2016-06-20T20:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374992",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:4'></a>
- intersects_at(): why not but both attempts in the same try block?


- is_complete_intersection: Boolean can go on the same line at OUTPUT
not the radical ideal per our discussion today

here is another noncomplete intersection example

```
P.<x,y,z,w>=ProjectiveSpace(QQ,3)
X= Curve([x*z-y^2,z*(y*w-z^2) - w*(x*w-y*z)])
X.is_complete_intersection()
```

- intersection_multiplicity: an integer can go on the same line as OUTPUT

good these add up to 4 as bezout's theorem implies

```
K.<i>=QuadraticField(-1)
A.<x,y>=AffineSpace(K,2)
C = Curve([x^2-y])
D = Curve([x^2+y^2])
for t in C.intersection(D).rational_points():
    C.intersection_multiplicity(D,t)
```

also good

```
K.<i>=QuadraticField(-1)
A.<x,y>=AffineSpace(K,2)
C = Curve([y^2-x^3])
D = Curve([(x^2+y^2)^2 - 4*x^2*y^2])
for t in C.intersection(D).rational_points():
    C.intersection_multiplicity(D,t)
```

so for plane curves this looks ok. Does this really work in dimension greater than 2? I don't think it does, I think the intersection number possibly has lower order terms.  Regardless, in looking at this, the following  example died

```
K.<i>=QuadraticField(-1)
A.<x,y,z>=AffineSpace(K,3)
C = Curve([x^2-y,z^2+x^2])
D = Curve([x^2+y^2,x^2+z])
for t in C.intersection(D).rational_points():
    C.intersection_multiplicity(D,p)
```



- I think an transverse check would be nice too:

is_transverse() - Returns true if and only if the point p is a nonsingular point of both plane curves C and D and the curves have distinct tangents there.



---

archive/issue_comments_374993.json:
```json
{
    "body": "Changing commit from \"f775a0ffaa6a969b5c3c4dc7a03862f0e71fdc58\" to \"09eea02208e31ac7a3d829fd307c01d133ed0c08\"",
    "created_at": "2016-06-21T07:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374993",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f775a0ffaa6a969b5c3c4dc7a03862f0e71fdc58" to "09eea02208e31ac7a3d829fd307c01d133ed0c08"



---

archive/issue_comments_374994.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                          |                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[bbffa39](https://github.com/sagemath/sagetrac-mirror/commit/bbffa39d8de7842bc04d556aff61c42f0dfeb350)|`20774: Merge this ticket with 20697.`|\n|[4fce7ed](https://github.com/sagemath/sagetrac-mirror/commit/4fce7ed8dd40a6e6956947983e3aed08019a30ab)|`20774: Merge this ticket with 20676.`|\n|[4655c72](https://github.com/sagemath/sagetrac-mirror/commit/4655c72f7de4b9b251d0837cabf1f81a41454182)|`20774: Implement multiplicity, tangents, and is_ordinary_singularity`|\n|[e1f1529](https://github.com/sagemath/sagetrac-mirror/commit/e1f15291034546dd48d91284790df481af5aacdf)|`20774: Merge with 7.3 beta3`|\n|[e6f1a93](https://github.com/sagemath/sagetrac-mirror/commit/e6f1a9364395b0507ba872b4addf5b11d3e17ef8)|`20774: Changes from first review.`|\n|[1f0d7ab](https://github.com/sagemath/sagetrac-mirror/commit/1f0d7ab498a3c21aefa651b83a752d0f05d8d121)|`20774: Merge with 7.3 beta4.`|\n|[bfcd05e](https://github.com/sagemath/sagetrac-mirror/commit/bfcd05e6885d0f66ee55556deaf2dacc792a8c96)|`20774: Added some error tests, and updated error messages.`|\n|[4282a4f](https://github.com/sagemath/sagetrac-mirror/commit/4282a4ff695ae038c1b3268255e23f2f580af6c5)|`20774: addressed small bug with point search`|\n|[6564724](https://github.com/sagemath/sagetrac-mirror/commit/6564724eb1167aec8a30d966257fb75ea636473a)|`20839: merge with ticket 20774`|\n|[09eea02](https://github.com/sagemath/sagetrac-mirror/commit/09eea02208e31ac7a3d829fd307c01d133ed0c08)|`20839: some remaining changes from review`|",
    "created_at": "2016-06-21T07:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374994",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                          |                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[bbffa39](https://github.com/sagemath/sagetrac-mirror/commit/bbffa39d8de7842bc04d556aff61c42f0dfeb350)|`20774: Merge this ticket with 20697.`|
|[4fce7ed](https://github.com/sagemath/sagetrac-mirror/commit/4fce7ed8dd40a6e6956947983e3aed08019a30ab)|`20774: Merge this ticket with 20676.`|
|[4655c72](https://github.com/sagemath/sagetrac-mirror/commit/4655c72f7de4b9b251d0837cabf1f81a41454182)|`20774: Implement multiplicity, tangents, and is_ordinary_singularity`|
|[e1f1529](https://github.com/sagemath/sagetrac-mirror/commit/e1f15291034546dd48d91284790df481af5aacdf)|`20774: Merge with 7.3 beta3`|
|[e6f1a93](https://github.com/sagemath/sagetrac-mirror/commit/e6f1a9364395b0507ba872b4addf5b11d3e17ef8)|`20774: Changes from first review.`|
|[1f0d7ab](https://github.com/sagemath/sagetrac-mirror/commit/1f0d7ab498a3c21aefa651b83a752d0f05d8d121)|`20774: Merge with 7.3 beta4.`|
|[bfcd05e](https://github.com/sagemath/sagetrac-mirror/commit/bfcd05e6885d0f66ee55556deaf2dacc792a8c96)|`20774: Added some error tests, and updated error messages.`|
|[4282a4f](https://github.com/sagemath/sagetrac-mirror/commit/4282a4ff695ae038c1b3268255e23f2f580af6c5)|`20774: addressed small bug with point search`|
|[6564724](https://github.com/sagemath/sagetrac-mirror/commit/6564724eb1167aec8a30d966257fb75ea636473a)|`20839: merge with ticket 20774`|
|[09eea02](https://github.com/sagemath/sagetrac-mirror/commit/09eea02208e31ac7a3d829fd307c01d133ed0c08)|`20839: some remaining changes from review`|



---

archive/issue_comments_374995.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks, I made most of the changes, but haven't yet addressed the intersection_multiplicity issue. Is there a good way to generalize the intersection multiplicity computations to work for space curves, or would it be best to make them specific to plane curves?\n\nI really don't have much homological algebra background, but if I understand correctly, I think a general definition of intersection multiplicity is given by Serre's Tor formula. I think Singular has some functionality for working with the needed constructions, but I'm not sure whether it's enough to be able to do multiplicity computations.",
    "created_at": "2016-06-21T08:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374995",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:6'></a>
Thanks, I made most of the changes, but haven't yet addressed the intersection_multiplicity issue. Is there a good way to generalize the intersection multiplicity computations to work for space curves, or would it be best to make them specific to plane curves?

I really don't have much homological algebra background, but if I understand correctly, I think a general definition of intersection multiplicity is given by Serre's Tor formula. I think Singular has some functionality for working with the needed constructions, but I'm not sure whether it's enough to be able to do multiplicity computations.



---

archive/issue_comments_374996.json:
```json
{
    "body": "<a id='comment:7'></a>\nNew commit didn't automatically appear.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|\n|[4b9ab0a](https://github.com/sagemath/sagetrac-mirror/commit/4b9ab0a8d1744f35fa507ff46da2cf032d7405d7)|`20839: implemented Serre intersection multiplicity for affine/projective subschemes`|",
    "created_at": "2016-06-23T20:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374996",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:7'></a>
New commit didn't automatically appear.

---
New commits:
|                                                                                                                                          |                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
|[4b9ab0a](https://github.com/sagemath/sagetrac-mirror/commit/4b9ab0a8d1744f35fa507ff46da2cf032d7405d7)|`20839: implemented Serre intersection multiplicity for affine/projective subschemes`|



---

archive/issue_comments_374997.json:
```json
{
    "body": "Changing commit from \"09eea02208e31ac7a3d829fd307c01d133ed0c08\" to \"4b9ab0a8d1744f35fa507ff46da2cf032d7405d7\"",
    "created_at": "2016-06-23T20:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374997",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing commit from "09eea02208e31ac7a3d829fd307c01d133ed0c08" to "4b9ab0a8d1744f35fa507ff46da2cf032d7405d7"



---

archive/issue_comments_374998.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-06-23T20:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374998",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_374999.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis looks fine except that is_transverse should return False when one of the points is singular.",
    "created_at": "2016-06-23T20:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-374999",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>
This looks fine except that is_transverse should return False when one of the points is singular.



---

archive/issue_comments_375000.json:
```json
{
    "body": "Changing commit from \"4b9ab0a8d1744f35fa507ff46da2cf032d7405d7\" to \"cae16fe73a6db14d63156e509c48b160ae17094e\"",
    "created_at": "2016-06-24T02:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-375000",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing commit from "4b9ab0a8d1744f35fa507ff46da2cf032d7405d7" to "cae16fe73a6db14d63156e509c48b160ae17094e"



---

archive/issue_comments_375001.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-06-24T02:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-375001",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375002.json:
```json
{
    "body": "<a id='comment:9'></a>\nNew commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[cae16fe](https://github.com/sagemath/sagetrac-mirror/commit/cae16fe73a6db14d63156e509c48b160ae17094e)|`20839: improved is_transverse`|",
    "created_at": "2016-06-24T02:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-375002",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:9'></a>
New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[cae16fe](https://github.com/sagemath/sagetrac-mirror/commit/cae16fe73a6db14d63156e509c48b160ae17094e)|`20839: improved is_transverse`|



---

archive/issue_comments_375003.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-24T13:16:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-375003",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_071338.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-26T07:30:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20839#event-71338"
}
```



---

archive/issue_comments_375004.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-26T07:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-375004",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_375005.json:
```json
{
    "body": "Changing branch from \"u/gjorgenson/ticket/20839\" to \"cae16fe73a6db14d63156e509c48b160ae17094e\"",
    "created_at": "2016-06-26T07:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20839",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20839#issuecomment-375005",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gjorgenson/ticket/20839" to "cae16fe73a6db14d63156e509c48b160ae17094e"
