# Issue 20885: Normaliz/PyNormaliz interface: Fast backend for polyhedra, integral_points, integral_hull

archive/issues_020648.json:
```json
{
    "body": "Normaliz is an excellent library for computations in affine monoids, vector configurations, lattice polytopes, and rational cones. There's a command-line program and a library (libnormaliz).\n\nWe already have normaliz as an optional package. \nThis ticket:\n- makes a shared library build of normaliz (using the new autotools build system of normaliz)\n- adds the [PyNormaliz](https://github.com/sebasguts/PyNormaliz) package\n- adds a Polyhedron_normaliz class (requested using backend='normaliz')\n- ... which has fast implementations of `Polyhedron.integral_points()` (cf. #18029), `Polyhedron.integral_hull()`\n\nTo install both, put the upstream archives:   \n- https://github.com/Normaliz/Normaliz/releases/download/v3.1.4/normaliz-3.1.4.tar.gz \n- https://pypi.python.org/packages/8b/d3/46d35aa05d8d1b82c24d0e37905f9df7fed17ae41b78623e1d253c2f3b15/PyNormaliz-1.0.tar.gz#md5=27a5f7d3fa0d96766d4f811495b0f5ce\ninto `upstream/`\nand then use:\n\n```\n   ./sage -f pynormaliz\n```\n\nSee the examples in the `Polyhedron_normaliz` documentation.\n\nOn follow-up tickets, should:\n- provide fast implementations of existing methods of Polyhedron, Cone, triangulations, ...\n- provide new methods for Normaliz's additional features.\n\nAdding these methods would not require Cython programming and would happen on several separate tickets. All it takes is reading the [Normaliz manual](https://www.normaliz.uni-osnabrueck.de/wp-content/uploads/2016/04/Normaliz3.1.1Documentation.pdf)\n\n\n\nCC:  @tscrim @dimpase @yuan-zhou @novoselt winfried @nthiery @videlec @mo271 @jplab @mmasdeu\n\nReviewer: Travis Scrimshaw, Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: 6f583841aa771839f9ecbcb8186e34cad07fa014\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20885\n\n",
    "closed_at": "2016-12-13T23:55:43Z",
    "created_at": "2016-06-27T05:02:46Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "Normaliz/PyNormaliz interface: Fast backend for polyhedra, integral_points, integral_hull",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20885",
    "user": "https://github.com/mkoeppe"
}
```
Normaliz is an excellent library for computations in affine monoids, vector configurations, lattice polytopes, and rational cones. There's a command-line program and a library (libnormaliz).

We already have normaliz as an optional package. 
This ticket:
- makes a shared library build of normaliz (using the new autotools build system of normaliz)
- adds the [PyNormaliz](https://github.com/sebasguts/PyNormaliz) package
- adds a Polyhedron_normaliz class (requested using backend='normaliz')
- ... which has fast implementations of `Polyhedron.integral_points()` (cf. #18029), `Polyhedron.integral_hull()`

To install both, put the upstream archives:   
- https://github.com/Normaliz/Normaliz/releases/download/v3.1.4/normaliz-3.1.4.tar.gz 
- https://pypi.python.org/packages/8b/d3/46d35aa05d8d1b82c24d0e37905f9df7fed17ae41b78623e1d253c2f3b15/PyNormaliz-1.0.tar.gz#md5=27a5f7d3fa0d96766d4f811495b0f5ce
into `upstream/`
and then use:

```
   ./sage -f pynormaliz
```

See the examples in the `Polyhedron_normaliz` documentation.

On follow-up tickets, should:
- provide fast implementations of existing methods of Polyhedron, Cone, triangulations, ...
- provide new methods for Normaliz's additional features.

Adding these methods would not require Cython programming and would happen on several separate tickets. All it takes is reading the [Normaliz manual](https://www.normaliz.uni-osnabrueck.de/wp-content/uploads/2016/04/Normaliz3.1.1Documentation.pdf)



CC:  @tscrim @dimpase @yuan-zhou @novoselt winfried @nthiery @videlec @mo271 @jplab @mmasdeu

Reviewer: Travis Scrimshaw, Dima Pasechnik

Author: Matthias Koeppe

Branch: 6f583841aa771839f9ecbcb8186e34cad07fa014

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20885





---

archive/issue_comments_284655.json:
```json
{
    "body": "Changing type from task to enhancement.",
    "created_at": "2016-07-23T21:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284655",
    "user": "https://github.com/mkoeppe"
}
```

Changing type from task to enhancement.



---

archive/issue_comments_284656.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2016-07-23T23:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284656",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_284657.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-18T05:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_055968.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-10-18T05:43:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20885#event-55968"
}
```



---

archive/issue_comments_284658.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-28T05:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284658",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_284659.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-28T22:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284659",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284660.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-11-18T00:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284660",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_284661.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T06:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284662.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T23:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284662",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284663.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-26T06:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284663",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284664.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-27T02:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284665.json:
```json
{
    "body": "<a id='comment:23'></a>Why did you remove the content of SPKG.txt (commit `5e87434`)?",
    "created_at": "2016-11-27T08:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284665",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>Why did you remove the content of SPKG.txt (commit `5e87434`)?



---

archive/issue_comments_284666.json:
```json
{
    "body": "<a id='comment:24'></a>Why don't you provide a package for pynormaliz? Downloading a non-specified version from github looks sloppy to me.",
    "created_at": "2016-11-27T08:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284666",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>Why don't you provide a package for pynormaliz? Downloading a non-specified version from github looks sloppy to me.



---

archive/issue_comments_284667.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:23 vdelecroix]:\n> Why did you remove the content of SPKG.txt (commit `5e87434`)?\n\n\nI've removed information that no longer applies\nand removed the change log because to my understanding we no longer do change logs but rather rely on git history for packages.",
    "created_at": "2016-11-27T21:35:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284667",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>Replying to [comment:23 vdelecroix]:
> Why did you remove the content of SPKG.txt (commit `5e87434`)?


I've removed information that no longer applies
and removed the change log because to my understanding we no longer do change logs but rather rely on git history for packages.



---

archive/issue_comments_284668.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:24 vdelecroix]:\n> Why don't you provide a package for pynormaliz? Downloading a non-specified version from github looks sloppy to me.\n\nYes, will do when it has stabilized.",
    "created_at": "2016-11-27T21:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284668",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>Replying to [comment:24 vdelecroix]:
> Why don't you provide a package for pynormaliz? Downloading a non-specified version from github looks sloppy to me.

Yes, will do when it has stabilized.



---

archive/issue_comments_284669.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-29T18:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284669",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284670.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-29T20:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284670",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284671.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-12-03T05:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284671",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_284672.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-12-08T18:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284673.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-12-08T18:56:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284673",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_284674.json:
```json
{
    "body": "<a id='comment:35'></a>I was able to install everything without problems and run some examples (such as my E<sub>8</sub> polytope, which runs in under 150ms compared to 12+s without this interface). I made some reviewer changes to the documentation. The setup for the spkgs LGTM. I'm willing to set a positive review, provided my changes are good, but I would appreciate if someone else looked over the packaging side of things.\n\n---\nNew commits:",
    "created_at": "2016-12-09T05:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284674",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:35'></a>I was able to install everything without problems and run some examples (such as my E<sub>8</sub> polytope, which runs in under 150ms compared to 12+s without this interface). I made some reviewer changes to the documentation. The setup for the spkgs LGTM. I'm willing to set a positive review, provided my changes are good, but I would appreciate if someone else looked over the packaging side of things.

---
New commits:



---

archive/issue_comments_284675.json:
```json
{
    "body": "<a id='comment:36'></a>These changes are fine with me.",
    "created_at": "2016-12-09T06:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284675",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>These changes are fine with me.



---

archive/issue_comments_284676.json:
```json
{
    "body": "<a id='comment:37'></a>All the info regarding how to create the Sage package from the sources seems to be gone now. Can it be put back (suitably updated)?",
    "created_at": "2016-12-11T16:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284676",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>All the info regarding how to create the Sage package from the sources seems to be gone now. Can it be put back (suitably updated)?



---

archive/issue_comments_284677.json:
```json
{
    "body": "<a id='comment:38'></a>It's using the upstream distributions. No repackaging involved.",
    "created_at": "2016-12-11T16:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284677",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>It's using the upstream distributions. No repackaging involved.



---

archive/issue_comments_284678.json:
```json
{
    "body": "<a id='comment:39'></a>ok, good.",
    "created_at": "2016-12-11T16:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284678",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>ok, good.



---

archive/issue_comments_284679.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-12-11T16:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284679",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055969.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-12-13T23:55:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20885#event-55969"
}
```



---

archive/issue_comments_284680.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-12-13T23:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284680",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_284681.json:
```json
{
    "body": "<a id='comment:42'></a>Something looks like wrong\n\n    https://groups.google.com/forum/#!topic/sage-devel/IMlNMe5Xk5A",
    "created_at": "2016-12-23T09:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284681",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>Something looks like wrong

    https://groups.google.com/forum/#!topic/sage-devel/IMlNMe5Xk5A



---

archive/issue_comments_284682.json:
```json
{
    "body": "<a id='comment:43'></a>I've created #22093 for this",
    "created_at": "2016-12-23T18:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20885",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20885#issuecomment-284682",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>I've created #22093 for this
