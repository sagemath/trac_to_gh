# Issue 20182: Automatic doctest for external softwares

archive/issues_019945.json:
```json
{
    "body": "Many doctests depend on softwares external to Sage (including \"internet\") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests for the softwares available.\n\nWith the patch,\n\n\"sage -t --optional=PKGS\": only run doctests including one of the \"# optional - xxx\" tags where xxx is listed in         PKGS; \n    if \"sage\" is listed, will also run the standard doctests;\n    if \"optional\" is listed, will also run tests for installed optional (new-style) packages;\n    if \"external\" is listed, will also run tests for available external softwares;\n    if set to \"all\", then all tests will be run\n\nThis is a rewrite of #18904 and #13540.\n\n**Branch/Commit:** [c4e48bd22aa1f018436795c14efbdc78a47673e1](https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1)\n\n**Reviewer:** John Palmieri\n\n**Author:** Kwankyu Lee\n\nIssue created by migration from https://trac.sagemath.org/ticket/20182\n\n",
    "closed_at": "2016-04-26T12:58:41Z",
    "created_at": "2016-03-09T15:45:46Z",
    "labels": [
        "component: doctest framework",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Automatic doctest for external softwares",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20182",
    "user": "https://github.com/kwankyu"
}
```
Many doctests depend on softwares external to Sage (including "internet") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests for the softwares available.

With the patch,

"sage -t --optional=PKGS": only run doctests including one of the "# optional - xxx" tags where xxx is listed in         PKGS; 
    if "sage" is listed, will also run the standard doctests;
    if "optional" is listed, will also run tests for installed optional (new-style) packages;
    if "external" is listed, will also run tests for available external softwares;
    if set to "all", then all tests will be run

This is a rewrite of #18904 and #13540.

**Branch/Commit:** [c4e48bd22aa1f018436795c14efbdc78a47673e1](https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1)

**Reviewer:** John Palmieri

**Author:** Kwankyu Lee

Issue created by migration from https://trac.sagemath.org/ticket/20182





---

archive/issue_comments_294172.json:
```json
{
    "body": "**Branch:** [public/20182](https://github.com/sagemath/sagetrac-mirror/tree/public/20182)",
    "created_at": "2016-03-09T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294172",
    "user": "https://github.com/kwankyu"
}
```

**Branch:** [public/20182](https://github.com/sagemath/sagetrac-mirror/tree/public/20182)



---

archive/issue_comments_294173.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0df81845fd4b85ed411ce322ce879ac84e2df52\">a0df818</a></td><td><code>Rewrite of automatic doctests for nonpackages</code></td></tr></table>\n",
    "created_at": "2016-03-09T15:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0df81845fd4b85ed411ce322ce879ac84e2df52">a0df818</a></td><td><code>Rewrite of automatic doctests for nonpackages</code></td></tr></table>




---

archive/issue_comments_294174.json:
```json
{
    "body": "**Commit:** [a0df81845fd4b85ed411ce322ce879ac84e2df52](https://github.com/sagemath/sagetrac-mirror/commit/a0df81845fd4b85ed411ce322ce879ac84e2df52)",
    "created_at": "2016-03-09T15:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [a0df81845fd4b85ed411ce322ce879ac84e2df52](https://github.com/sagemath/sagetrac-mirror/commit/a0df81845fd4b85ed411ce322ce879ac84e2df52)



---

archive/issue_comments_294175.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe patch is a draft or a proof of concept.",
    "created_at": "2016-03-09T15:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294175",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:3'></a>
The patch is a draft or a proof of concept.



---

archive/issue_comments_294176.json:
```json
{
    "body": "<a id='comment:4'></a>\nDon't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.",
    "created_at": "2016-03-09T16:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294176",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.



---

archive/issue_comments_294177.json:
```json
{
    "body": "<a id='comment:5'></a>\nI don't like the fact that you *explicitly* need to specify `--optional=nonpackages`. That's almost as much \"effort\" as writing `--optional=latex,magma,internet`. Also the name \"nonpackages\" is a bit strange: why is \"octave\" a nonpackage?\n\nAlso, I don't believe that `have_latex()` is a sufficient test to check that `latex` works. You should really run `latex` to be sure. All the other tests actually run the optional program.",
    "created_at": "2016-03-09T16:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294177",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`. That's almost as much "effort" as writing `--optional=latex,magma,internet`. Also the name "nonpackages" is a bit strange: why is "octave" a nonpackage?

Also, I don't believe that `have_latex()` is a sufficient test to check that `latex` works. You should really run `latex` to be sure. All the other tests actually run the optional program.



---

archive/issue_comments_294178.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n sage -t --optional=nonpackages ./src/sage/repl/rich_output/pretty_print.py\n \n-This is a rewrite of #18904.\n+This is a rewrite of #18904 and #13540.\n``````\n",
    "created_at": "2016-03-09T16:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294178",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 sage -t --optional=nonpackages ./src/sage/repl/rich_output/pretty_print.py
 
-This is a rewrite of #18904.
+This is a rewrite of #18904 and #13540.
``````




---

archive/issue_comments_294179.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe intention is to test the doctests of the form \"#optional - xxx\" where xxx is not a Sage package. So I think internet is also a \"nonpackage\" :-)",
    "created_at": "2016-03-09T16:10:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294179",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'></a>
The intention is to test the doctests of the form "#optional - xxx" where xxx is not a Sage package. So I think internet is also a "nonpackage" :-)



---

archive/issue_comments_294180.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n sage -t --optional=nonpackages ./src/sage/repl/rich_output/pretty_print.py\n \n-This is a rewrite of #18904 and #13540.\n+This is a rewrite of #18904.\n``````\n",
    "created_at": "2016-03-09T16:10:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294180",
    "user": "https://github.com/kwankyu"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 sage -t --optional=nonpackages ./src/sage/repl/rich_output/pretty_print.py
 
-This is a rewrite of #18904 and #13540.
+This is a rewrite of #18904.
``````




---

archive/issue_comments_294181.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jdemeyer](#comment%3A5):\n> I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.\n\n\nTo be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.",
    "created_at": "2016-03-09T16:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294181",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [jdemeyer](#comment%3A5):
> I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.


To be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.



---

archive/issue_comments_294182.json:
```json
{
    "body": "<a id='comment:9'></a>\nIt would be cool if this would automatically go over all test functions instead of this ugly error-prone code:\n\n```\n    if test_latex(): pkgs.append('latex')\n    if test_magma(): pkgs.append('magma')\n    if test_matlab(): pkgs.append('matlab')     \n    if test_mathematica(): pkgs.append('mathematica')  \n    if test_macaulay2(): pkgs.append('macaulay2')  \n    if test_octave(): pkgs.append('octave')  \n    if test_scilab(): pkgs.append('scilab')  \n    if test_maple(): pkgs.append('maple')\n    if test_cplex(): pkgs.append('cplex')  \n    if test_gurobi(): pkgs.append('gurobi')\n```",
    "created_at": "2016-03-09T16:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294182",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:

```
    if test_latex(): pkgs.append('latex')
    if test_magma(): pkgs.append('magma')
    if test_matlab(): pkgs.append('matlab')     
    if test_mathematica(): pkgs.append('mathematica')  
    if test_macaulay2(): pkgs.append('macaulay2')  
    if test_octave(): pkgs.append('octave')  
    if test_scilab(): pkgs.append('scilab')  
    if test_maple(): pkgs.append('maple')
    if test_cplex(): pkgs.append('cplex')  
    if test_gurobi(): pkgs.append('gurobi')
```



---

archive/issue_comments_294183.json:
```json
{
    "body": "<a id='comment:10'></a>\nYou should also consider performance issues. I don't want to run all these tests every time I doctest something. You should look at #13540, which uses a lazy mechanism for testing optional tags.",
    "created_at": "2016-03-09T16:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294183",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
You should also consider performance issues. I don't want to run all these tests every time I doctest something. You should look at #13540, which uses a lazy mechanism for testing optional tags.



---

archive/issue_comments_294184.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jdemeyer](#comment%3A8):\n> Replying to [jdemeyer](#comment%3A5):\n> > I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.\n\n> \n> To be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.\n\n\nCurrently doctests for Sage optional packages, if installed on the system, are automatically run only if \"--optional\" is given. Doctests for nonpackages are run only if \"--optional=nonpackages\" is given. Perhaps we should keep this ability because of the performance issues that you mention...",
    "created_at": "2016-03-09T16:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294184",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:11'></a>
Replying to [jdemeyer](#comment%3A8):
> Replying to [jdemeyer](#comment%3A5):
> > I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.

> 
> To be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.


Currently doctests for Sage optional packages, if installed on the system, are automatically run only if "--optional" is given. Doctests for nonpackages are run only if "--optional=nonpackages" is given. Perhaps we should keep this ability because of the performance issues that you mention...



---

archive/issue_comments_294185.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jdemeyer](#comment%3A9):\n> It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:\n> \n> ```\n>     if test_latex(): pkgs.append('latex')\n>     if test_magma(): pkgs.append('magma')\n>     if test_matlab(): pkgs.append('matlab')     \n>     if test_mathematica(): pkgs.append('mathematica')  \n>     if test_macaulay2(): pkgs.append('macaulay2')  \n>     if test_octave(): pkgs.append('octave')  \n>     if test_scilab(): pkgs.append('scilab')  \n>     if test_maple(): pkgs.append('maple')\n>     if test_cplex(): pkgs.append('cplex')  \n>     if test_gurobi(): pkgs.append('gurobi')\n> ```\n\n\nI totally agree! But I needed to write the code before I go to sleep, as I am living on the other side of the globe :-) You can help!",
    "created_at": "2016-03-09T16:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294185",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:12'></a>
Replying to [jdemeyer](#comment%3A9):
> It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:
> 
> ```
>     if test_latex(): pkgs.append('latex')
>     if test_magma(): pkgs.append('magma')
>     if test_matlab(): pkgs.append('matlab')     
>     if test_mathematica(): pkgs.append('mathematica')  
>     if test_macaulay2(): pkgs.append('macaulay2')  
>     if test_octave(): pkgs.append('octave')  
>     if test_scilab(): pkgs.append('scilab')  
>     if test_maple(): pkgs.append('maple')
>     if test_cplex(): pkgs.append('cplex')  
>     if test_gurobi(): pkgs.append('gurobi')
> ```


I totally agree! But I needed to write the code before I go to sleep, as I am living on the other side of the globe :-) You can help!



---

archive/issue_comments_294186.json:
```json
{
    "body": "<a id='comment:13'></a>\nI think this is only really useful if \"nonpackages\" are tested by default.",
    "created_at": "2016-03-09T16:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294186",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
I think this is only really useful if "nonpackages" are tested by default.



---

archive/issue_comments_294187.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [kcrisman](#comment%3A4):\n> Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.\n\n\nThere were [ticket:16252#comment:32 some concerns] about running internet tests whenever possible. I'm not sure I agree with those, but maybe there are other reasons not to do these all the time. (What if I lose my internet connection after testing testing connectivity but in the middle of doctesting? Do we have to test connectivity before every internet test?) But I think some of the patchbots could use the `internet` flag when doctesting.",
    "created_at": "2016-03-09T18:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294187",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
Replying to [kcrisman](#comment%3A4):
> Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.


There were [ticket:16252#comment:32 some concerns] about running internet tests whenever possible. I'm not sure I agree with those, but maybe there are other reasons not to do these all the time. (What if I lose my internet connection after testing testing connectivity but in the middle of doctesting? Do we have to test connectivity before every internet test?) But I think some of the patchbots could use the `internet` flag when doctesting.



---

archive/issue_comments_294188.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [klee](#comment%3A11):\n> Currently doctests for Sage optional packages, if installed on the system, are automatically run only if \"--optional\" is given.\n\n\nI don't think this is correct. When I run doctests without any extra flags, I see (after installing a few optional packages for testing purposes)\n\n```\n$ sage -tp src/sage/homology/\n...\nUsing --optional=ccache,database_gap,gcc,mpir,ore_algebra,python2,sage\n...\n```",
    "created_at": "2016-03-09T18:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294188",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Replying to [klee](#comment%3A11):
> Currently doctests for Sage optional packages, if installed on the system, are automatically run only if "--optional" is given.


I don't think this is correct. When I run doctests without any extra flags, I see (after installing a few optional packages for testing purposes)

```
$ sage -tp src/sage/homology/
...
Using --optional=ccache,database_gap,gcc,mpir,ore_algebra,python2,sage
...
```



---

archive/issue_comments_294189.json:
```json
{
    "body": "<a id='comment:16'></a>\nI would prefer \"external\" instead of \"nonpackage\", otherwise the `--optional=nonpackages` has a confusing double negation vibe.",
    "created_at": "2016-03-09T23:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294189",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>
I would prefer "external" instead of "nonpackage", otherwise the `--optional=nonpackages` has a confusing double negation vibe.



---

archive/issue_comments_294190.json:
```json
{
    "body": "<a id='comment:17'></a>\nThe behavior \"--optional\" tag has changed after the merged ticket: http://trac.sagemath.org/ticket/18558, but the developer's manual seems not updated completely to reflect the changes. The following is from experiments and the documentation. So would you verify my understanding?\n\n(1) \"-t\" : tests all ordinary doctests and also doctests about installed optional packages, in effect equivalent to \"-t --optional=optional\".\n(2) \"-t --optional\": no-op\n(3) \"-t --optional=PKGS\":   only run doctests including one of the \"# optional - xxx\" tags where xxx is listed in PKGS; \n                                     if \"sage\" is listed will also test the standard doctests; \n                                     if \"optional\" is listed will also test all available(installed) optional packages; \n                                     if set to \"all\", then all tests will be run; \nIf this is correct, then\n\n(A)  Via this ticket I want to add one more line to (3):\n\n                                    if \"external\" is listed, then also include all doctests  with \"# optional - xxx\" where xxx is an available external softwares and resources like \"magma\", \"matlab\", \"internet\", \"latex\", etc (basically everything that is not a Sage standard or optional package).\n\n(B) Also we can change (1) to equate \"-t\" to \"-t --optional=optional,external\".\n\nDo you agree?",
    "created_at": "2016-03-10T05:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294190",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:17'></a>
The behavior "--optional" tag has changed after the merged ticket: http://trac.sagemath.org/ticket/18558, but the developer's manual seems not updated completely to reflect the changes. The following is from experiments and the documentation. So would you verify my understanding?

(1) "-t" : tests all ordinary doctests and also doctests about installed optional packages, in effect equivalent to "-t --optional=optional".
(2) "-t --optional": no-op
(3) "-t --optional=PKGS":   only run doctests including one of the "# optional - xxx" tags where xxx is listed in PKGS; 
                                     if "sage" is listed will also test the standard doctests; 
                                     if "optional" is listed will also test all available(installed) optional packages; 
                                     if set to "all", then all tests will be run; 
If this is correct, then

(A)  Via this ticket I want to add one more line to (3):

                                    if "external" is listed, then also include all doctests  with "# optional - xxx" where xxx is an available external softwares and resources like "magma", "matlab", "internet", "latex", etc (basically everything that is not a Sage standard or optional package).

(B) Also we can change (1) to equate "-t" to "-t --optional=optional,external".

Do you agree?



---

archive/issue_comments_294191.json:
```json
{
    "body": "<a id='comment:18'></a>\nThis seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details).  Should \"-t --optional\" be equivalent to \"-t\" or is the desired behavior still thus?\n\n```\nsage-runtests: error: --optional option requires an argument\n```",
    "created_at": "2016-03-10T14:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294191",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>
This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details).  Should "-t --optional" be equivalent to "-t" or is the desired behavior still thus?

```
sage-runtests: error: --optional option requires an argument
```



---

archive/issue_comments_294192.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [kcrisman](#comment%3A18):\n> This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details). \n\n\nAgree. We definitely need to implement a lazy mechanism like that in #13540. I am reading the related codes in Sage.\n\n> Should \"-t --optional\" be equivalent to \"-t\" or is the desired behavior still thus?\n> \n> ```\n> sage-runtests: error: --optional option requires an argument\n> ```\n\n\nOnce we implement \"external\", \"all\" will mean \"sage\"+\"optional\"+\"external\". Then we may set \"-t --optional\" to mean \"-t --optional=all\".",
    "created_at": "2016-03-11T01:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294192",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:19'></a>
Replying to [kcrisman](#comment%3A18):
> This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details). 


Agree. We definitely need to implement a lazy mechanism like that in #13540. I am reading the related codes in Sage.

> Should "-t --optional" be equivalent to "-t" or is the desired behavior still thus?
> 
> ```
> sage-runtests: error: --optional option requires an argument
> ```


Once we implement "external", "all" will mean "sage"+"optional"+"external". Then we may set "-t --optional" to mean "-t --optional=all".



---

archive/issue_comments_294193.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61b5136679b79cbf72f7d3c269e63568a4fd1bf1\">61b5136</a></td><td><code>Merge Sage 7.1.rc0 into trac20182</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/126e4e50e2270ba43b3cfd026f0405f568fff9be\">126e4e5</a></td><td><code>Initial implementaion using the lazyset mechanism</code></td></tr></table>\n",
    "created_at": "2016-03-11T07:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61b5136679b79cbf72f7d3c269e63568a4fd1bf1">61b5136</a></td><td><code>Merge Sage 7.1.rc0 into trac20182</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/126e4e50e2270ba43b3cfd026f0405f568fff9be">126e4e5</a></td><td><code>Initial implementaion using the lazyset mechanism</code></td></tr></table>




---

archive/issue_comments_294194.json:
```json
{
    "body": "**Changing commit** from \"[a0df81845fd4b85ed411ce322ce879ac84e2df52](https://github.com/sagemath/sagetrac-mirror/commit/a0df81845fd4b85ed411ce322ce879ac84e2df52)\" to \"[126e4e50e2270ba43b3cfd026f0405f568fff9be](https://github.com/sagemath/sagetrac-mirror/commit/126e4e50e2270ba43b3cfd026f0405f568fff9be)\".",
    "created_at": "2016-03-11T07:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a0df81845fd4b85ed411ce322ce879ac84e2df52](https://github.com/sagemath/sagetrac-mirror/commit/a0df81845fd4b85ed411ce322ce879ac84e2df52)" to "[126e4e50e2270ba43b3cfd026f0405f568fff9be](https://github.com/sagemath/sagetrac-mirror/commit/126e4e50e2270ba43b3cfd026f0405f568fff9be)".



---

archive/issue_comments_294195.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,11 @@\n-Many doctests depend on nonpackages (softwares external to Sage) installed and available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests if the nonpackages are available, when you include \"nonpackages\" value to the \"--optional\" tag, as in the following example.\n+Many doctests depend on softwares external to Sage (including \"internet\") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests if the softwares are available.\n \n-sage -t --optional=nonpackages ./src/sage/repl/rich_output/pretty_print.py\n+With the patch,\n \n-This is a rewrite of #18904.\n+\"sage -t --optional=PKGS\": only run doctests including one of the \"# optional - xxx\" tags where xxx is listed in         PKGS; \n+if \"sage\" is listed, will also test the standard doctests; \n+if \"optional\" is listed, will also test all installed optional packages; \n+if \"external\" is listed, will also test all available external softwares;\n+if set to \"all\", then all tests will be run. \n+\n+This is a rewrite of #18904 and #13540.\n``````\n",
    "created_at": "2016-03-11T07:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294195",
    "user": "https://github.com/kwankyu"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,11 @@
-Many doctests depend on nonpackages (softwares external to Sage) installed and available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests if the nonpackages are available, when you include "nonpackages" value to the "--optional" tag, as in the following example.
+Many doctests depend on softwares external to Sage (including "internet") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests if the softwares are available.
 
-sage -t --optional=nonpackages ./src/sage/repl/rich_output/pretty_print.py
+With the patch,
 
-This is a rewrite of #18904.
+"sage -t --optional=PKGS": only run doctests including one of the "# optional - xxx" tags where xxx is listed in         PKGS; 
+if "sage" is listed, will also test the standard doctests; 
+if "optional" is listed, will also test all installed optional packages; 
+if "external" is listed, will also test all available external softwares;
+if set to "all", then all tests will be run. 
+
+This is a rewrite of #18904 and #13540.
``````




---

archive/issue_events_184664.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-11T07:42:38Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "rename": {
        "from": "Automatic doctest for nonpackages",
        "to": "Automatic doctest for external softwares"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184664"
}
```



---

archive/issue_comments_294196.json:
```json
{
    "body": "**Author:** Kwankyu Lee",
    "created_at": "2016-03-11T07:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294196",
    "user": "https://github.com/kwankyu"
}
```

**Author:** Kwankyu Lee



---

archive/issue_events_184665.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-11T07:42:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "label": "minor",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184665"
}
```



---

archive/issue_comments_294197.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2098dd0b60081231baa95475b879f2a38cfc6f55\">2098dd0</a></td><td><code>Fixed gross logical bugs</code></td></tr></table>\n",
    "created_at": "2016-03-11T11:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2098dd0b60081231baa95475b879f2a38cfc6f55">2098dd0</a></td><td><code>Fixed gross logical bugs</code></td></tr></table>




---

archive/issue_comments_294198.json:
```json
{
    "body": "**Changing commit** from \"[126e4e50e2270ba43b3cfd026f0405f568fff9be](https://github.com/sagemath/sagetrac-mirror/commit/126e4e50e2270ba43b3cfd026f0405f568fff9be)\" to \"[2098dd0b60081231baa95475b879f2a38cfc6f55](https://github.com/sagemath/sagetrac-mirror/commit/2098dd0b60081231baa95475b879f2a38cfc6f55)\".",
    "created_at": "2016-03-11T11:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[126e4e50e2270ba43b3cfd026f0405f568fff9be](https://github.com/sagemath/sagetrac-mirror/commit/126e4e50e2270ba43b3cfd026f0405f568fff9be)" to "[2098dd0b60081231baa95475b879f2a38cfc6f55](https://github.com/sagemath/sagetrac-mirror/commit/2098dd0b60081231baa95475b879f2a38cfc6f55)".



---

archive/issue_comments_294199.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82d58ebf89b13e168af232dc4f10e92fe48ee205\">82d58eb</a></td><td><code>Fixed a bug and the doc</code></td></tr></table>\n",
    "created_at": "2016-03-11T15:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82d58ebf89b13e168af232dc4f10e92fe48ee205">82d58eb</a></td><td><code>Fixed a bug and the doc</code></td></tr></table>




---

archive/issue_comments_294200.json:
```json
{
    "body": "**Changing commit** from \"[2098dd0b60081231baa95475b879f2a38cfc6f55](https://github.com/sagemath/sagetrac-mirror/commit/2098dd0b60081231baa95475b879f2a38cfc6f55)\" to \"[82d58ebf89b13e168af232dc4f10e92fe48ee205](https://github.com/sagemath/sagetrac-mirror/commit/82d58ebf89b13e168af232dc4f10e92fe48ee205)\".",
    "created_at": "2016-03-11T15:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294200",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2098dd0b60081231baa95475b879f2a38cfc6f55](https://github.com/sagemath/sagetrac-mirror/commit/2098dd0b60081231baa95475b879f2a38cfc6f55)" to "[82d58ebf89b13e168af232dc4f10e92fe48ee205](https://github.com/sagemath/sagetrac-mirror/commit/82d58ebf89b13e168af232dc4f10e92fe48ee205)".



---

archive/issue_comments_294201.json:
```json
{
    "body": "**Changing commit** from \"[82d58ebf89b13e168af232dc4f10e92fe48ee205](https://github.com/sagemath/sagetrac-mirror/commit/82d58ebf89b13e168af232dc4f10e92fe48ee205)\" to \"[b95936b7af18809d2c169da70ad14a9456b0f09b](https://github.com/sagemath/sagetrac-mirror/commit/b95936b7af18809d2c169da70ad14a9456b0f09b)\".",
    "created_at": "2016-03-11T15:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294201",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[82d58ebf89b13e168af232dc4f10e92fe48ee205](https://github.com/sagemath/sagetrac-mirror/commit/82d58ebf89b13e168af232dc4f10e92fe48ee205)" to "[b95936b7af18809d2c169da70ad14a9456b0f09b](https://github.com/sagemath/sagetrac-mirror/commit/b95936b7af18809d2c169da70ad14a9456b0f09b)".



---

archive/issue_comments_294202.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b95936b7af18809d2c169da70ad14a9456b0f09b\">b95936b</a></td><td><code>Fixed a typo</code></td></tr></table>\n",
    "created_at": "2016-03-11T15:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294202",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b95936b7af18809d2c169da70ad14a9456b0f09b">b95936b</a></td><td><code>Fixed a typo</code></td></tr></table>




---

archive/issue_comments_294203.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca3f0d92fac1d8b718cfe5b710a83816332c6678\">ca3f0d9</a></td><td><code>Modified the help text for --optional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a0ec28d83e64256a8803587306f60f7643e608c\">4a0ec28</a></td><td><code>Corrected the help text for --optional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c56e94f1f317083b6bd8e09b7c33b3a73758174e\">c56e94f</a></td><td><code>Corrected the help text a bit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/20f692a848b3b373ab555c7dcddffb1c63e03361\">20f692a</a></td><td><code>Added more doctests</code></td></tr></table>\n",
    "created_at": "2016-03-11T16:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294203",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca3f0d92fac1d8b718cfe5b710a83816332c6678">ca3f0d9</a></td><td><code>Modified the help text for --optional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a0ec28d83e64256a8803587306f60f7643e608c">4a0ec28</a></td><td><code>Corrected the help text for --optional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c56e94f1f317083b6bd8e09b7c33b3a73758174e">c56e94f</a></td><td><code>Corrected the help text a bit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/20f692a848b3b373ab555c7dcddffb1c63e03361">20f692a</a></td><td><code>Added more doctests</code></td></tr></table>




---

archive/issue_comments_294204.json:
```json
{
    "body": "**Changing commit** from \"[b95936b7af18809d2c169da70ad14a9456b0f09b](https://github.com/sagemath/sagetrac-mirror/commit/b95936b7af18809d2c169da70ad14a9456b0f09b)\" to \"[20f692a848b3b373ab555c7dcddffb1c63e03361](https://github.com/sagemath/sagetrac-mirror/commit/20f692a848b3b373ab555c7dcddffb1c63e03361)\".",
    "created_at": "2016-03-11T16:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294204",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b95936b7af18809d2c169da70ad14a9456b0f09b](https://github.com/sagemath/sagetrac-mirror/commit/b95936b7af18809d2c169da70ad14a9456b0f09b)" to "[20f692a848b3b373ab555c7dcddffb1c63e03361](https://github.com/sagemath/sagetrac-mirror/commit/20f692a848b3b373ab555c7dcddffb1c63e03361)".



---

archive/issue_comments_294205.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39e7390be155409d19a2b972a1af860f24e86b40\">39e7390</a></td><td><code>Fixed a doctest failure</code></td></tr></table>\n",
    "created_at": "2016-03-11T16:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39e7390be155409d19a2b972a1af860f24e86b40">39e7390</a></td><td><code>Fixed a doctest failure</code></td></tr></table>




---

archive/issue_comments_294206.json:
```json
{
    "body": "**Changing commit** from \"[20f692a848b3b373ab555c7dcddffb1c63e03361](https://github.com/sagemath/sagetrac-mirror/commit/20f692a848b3b373ab555c7dcddffb1c63e03361)\" to \"[39e7390be155409d19a2b972a1af860f24e86b40](https://github.com/sagemath/sagetrac-mirror/commit/39e7390be155409d19a2b972a1af860f24e86b40)\".",
    "created_at": "2016-03-11T16:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[20f692a848b3b373ab555c7dcddffb1c63e03361](https://github.com/sagemath/sagetrac-mirror/commit/20f692a848b3b373ab555c7dcddffb1c63e03361)" to "[39e7390be155409d19a2b972a1af860f24e86b40](https://github.com/sagemath/sagetrac-mirror/commit/39e7390be155409d19a2b972a1af860f24e86b40)".



---

archive/issue_comments_294207.json:
```json
{
    "body": "**Changing commit** from \"[39e7390be155409d19a2b972a1af860f24e86b40](https://github.com/sagemath/sagetrac-mirror/commit/39e7390be155409d19a2b972a1af860f24e86b40)\" to \"[ee257470f2bf355efff9065b4d6da6ac4b23829e](https://github.com/sagemath/sagetrac-mirror/commit/ee257470f2bf355efff9065b4d6da6ac4b23829e)\".",
    "created_at": "2016-03-11T16:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[39e7390be155409d19a2b972a1af860f24e86b40](https://github.com/sagemath/sagetrac-mirror/commit/39e7390be155409d19a2b972a1af860f24e86b40)" to "[ee257470f2bf355efff9065b4d6da6ac4b23829e](https://github.com/sagemath/sagetrac-mirror/commit/ee257470f2bf355efff9065b4d6da6ac4b23829e)".



---

archive/issue_comments_294208.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee257470f2bf355efff9065b4d6da6ac4b23829e\">ee25747</a></td><td><code>Trimmed the codes and removed whitespaces</code></td></tr></table>\n",
    "created_at": "2016-03-11T16:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee257470f2bf355efff9065b4d6da6ac4b23829e">ee25747</a></td><td><code>Trimmed the codes and removed whitespaces</code></td></tr></table>




---

archive/issue_comments_294209.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,11 +1,11 @@\n-Many doctests depend on softwares external to Sage (including \"internet\") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests if the softwares are available.\n+Many doctests depend on softwares external to Sage (including \"internet\") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests for the softwares available.\n \n With the patch,\n \n \"sage -t --optional=PKGS\": only run doctests including one of the \"# optional - xxx\" tags where xxx is listed in         PKGS; \n-if \"sage\" is listed, will also test the standard doctests; \n-if \"optional\" is listed, will also test all installed optional packages; \n-if \"external\" is listed, will also test all available external softwares;\n-if set to \"all\", then all tests will be run. \n+    if \"sage\" is listed, will also run the standard doctests;\n+    if \"optional\" is listed, will also run tests for installed optional (new-style) packages;\n+    if \"external\" is listed, will also run tests for available external softwares;\n+    if set to \"all\", then all tests will be run\n \n This is a rewrite of #18904 and #13540.\n``````\n",
    "created_at": "2016-03-11T17:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294209",
    "user": "https://github.com/kwankyu"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,11 +1,11 @@
-Many doctests depend on softwares external to Sage (including "internet") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests if the softwares are available.
+Many doctests depend on softwares external to Sage (including "internet") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests for the softwares available.
 
 With the patch,
 
 "sage -t --optional=PKGS": only run doctests including one of the "# optional - xxx" tags where xxx is listed in         PKGS; 
-if "sage" is listed, will also test the standard doctests; 
-if "optional" is listed, will also test all installed optional packages; 
-if "external" is listed, will also test all available external softwares;
-if set to "all", then all tests will be run. 
+    if "sage" is listed, will also run the standard doctests;
+    if "optional" is listed, will also run tests for installed optional (new-style) packages;
+    if "external" is listed, will also run tests for available external softwares;
+    if set to "all", then all tests will be run
 
 This is a rewrite of #18904 and #13540.
``````




---

archive/issue_comments_294210.json:
```json
{
    "body": "<a id='comment:29'></a>\nWhy does `LazySet` inherit from `set`? Are you actually using any `set` functionality?",
    "created_at": "2016-03-11T17:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294210",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?



---

archive/issue_comments_294211.json:
```json
{
    "body": "<a id='comment:30'></a>\nIf I do `sage -tp --optional=sage,optional,external ...`, then instead of printing\n\n```\nUsing --optional=...,external,...\n```\nit would be nice if it printed\n\n```\nUsing --optional=...,internet,latex,maple,...\n```",
    "created_at": "2016-03-11T18:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294211",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>
If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing

```
Using --optional=...,external,...
```
it would be nice if it printed

```
Using --optional=...,internet,latex,maple,...
```



---

archive/issue_comments_294212.json:
```json
{
    "body": "**Changing commit** from \"[ee257470f2bf355efff9065b4d6da6ac4b23829e](https://github.com/sagemath/sagetrac-mirror/commit/ee257470f2bf355efff9065b4d6da6ac4b23829e)\" to \"[86a7e6f8cb3845aa4551422941ee081cfc46f713](https://github.com/sagemath/sagetrac-mirror/commit/86a7e6f8cb3845aa4551422941ee081cfc46f713)\".",
    "created_at": "2016-03-11T22:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ee257470f2bf355efff9065b4d6da6ac4b23829e](https://github.com/sagemath/sagetrac-mirror/commit/ee257470f2bf355efff9065b4d6da6ac4b23829e)" to "[86a7e6f8cb3845aa4551422941ee081cfc46f713](https://github.com/sagemath/sagetrac-mirror/commit/86a7e6f8cb3845aa4551422941ee081cfc46f713)".



---

archive/issue_comments_294213.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86a7e6f8cb3845aa4551422941ee081cfc46f713\">86a7e6f</a></td><td><code>Removed set inheritance of LazySet</code></td></tr></table>\n",
    "created_at": "2016-03-11T22:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294213",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86a7e6f8cb3845aa4551422941ee081cfc46f713">86a7e6f</a></td><td><code>Removed set inheritance of LazySet</code></td></tr></table>




---

archive/issue_comments_294214.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [jdemeyer](#comment%3A29):\n> Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?\n\n\nNo. I was not. See the last commit.",
    "created_at": "2016-03-11T22:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294214",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:32'></a>
Replying to [jdemeyer](#comment%3A29):
> Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?


No. I was not. See the last commit.



---

archive/issue_comments_294215.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [jhpalmieri](#comment%3A30):\n> If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing\n> \n> ```\n> Using --optional=...,external,...\n> ```\n> it would be nice if it printed\n> \n> ```\n> Using --optional=...,internet,latex,maple,...\n> ```\n\n\nHmmm. It seems possible... But what do you think it means that \"maple\" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? Then this is very different from an optional package, say gcc or mpir, appearing in the list.",
    "created_at": "2016-03-11T22:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294215",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:33'></a>
Replying to [jhpalmieri](#comment%3A30):
> If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing
> 
> ```
> Using --optional=...,external,...
> ```
> it would be nice if it printed
> 
> ```
> Using --optional=...,internet,latex,maple,...
> ```


Hmmm. It seems possible... But what do you think it means that "maple" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? Then this is very different from an optional package, say gcc or mpir, appearing in the list.



---

archive/issue_comments_294216.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [klee](#comment%3A33):\n> Replying to [jhpalmieri](#comment%3A30):\n> > If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing\n> > \n> > ```\n> > Using --optional=...,external,...\n> > ```\n> > it would be nice if it printed\n> > \n> > ```\n> > Using --optional=...,internet,latex,maple,...\n> > ```\n\n> \n> Hmmm. It seems possible... But what do you think it means that \"maple\" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? \n\n\nI say no to the last question. I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).",
    "created_at": "2016-03-11T23:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294216",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
Replying to [klee](#comment%3A33):
> Replying to [jhpalmieri](#comment%3A30):
> > If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing
> > 
> > ```
> > Using --optional=...,external,...
> > ```
> > it would be nice if it printed
> > 
> > ```
> > Using --optional=...,internet,latex,maple,...
> > ```

> 
> Hmmm. It seems possible... But what do you think it means that "maple" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? 


I say no to the last question. I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).



---

archive/issue_comments_294217.json:
```json
{
    "body": "<a id='comment:35'></a>\n> I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. \n\n\nBecause of the lazyset mechanism, at least one test was run for an external software detected in most cases. There may be exceptional cases to this, but is this important? By the way, I prefer \"external software\" than \"external package\". Internet is rather a software than a package :-)\n\n\n> I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).\n\n \nI agree. Perhaps we can list the detected softwares at the end of doctesting as you suggested.",
    "created_at": "2016-03-12T05:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294217",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:35'></a>
> I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. 


Because of the lazyset mechanism, at least one test was run for an external software detected in most cases. There may be exceptional cases to this, but is this important? By the way, I prefer "external software" than "external package". Internet is rather a software than a package :-)


> I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).

 
I agree. Perhaps we can list the detected softwares at the end of doctesting as you suggested.



---

archive/issue_comments_294218.json:
```json
{
    "body": "<a id='comment:36'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/60bc96d74c0a29c6a4fb93dbb58c5df744c8f30d\">60bc96d</a></td><td><code>Reimplement for parallel testing</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/245e4737bdb24524f9ab1a1e07ecb72fc7bdb944\">245e473</a></td><td><code>Merged with the previous commit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f58377af2e7a7ac9e08335a42e52c31736e49626\">f58377a</a></td><td><code>The tag all also turns on external</code></td></tr></table>\n",
    "created_at": "2016-03-15T04:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/60bc96d74c0a29c6a4fb93dbb58c5df744c8f30d">60bc96d</a></td><td><code>Reimplement for parallel testing</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/245e4737bdb24524f9ab1a1e07ecb72fc7bdb944">245e473</a></td><td><code>Merged with the previous commit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f58377af2e7a7ac9e08335a42e52c31736e49626">f58377a</a></td><td><code>The tag all also turns on external</code></td></tr></table>




---

archive/issue_comments_294219.json:
```json
{
    "body": "**Changing commit** from \"[86a7e6f8cb3845aa4551422941ee081cfc46f713](https://github.com/sagemath/sagetrac-mirror/commit/86a7e6f8cb3845aa4551422941ee081cfc46f713)\" to \"[f58377af2e7a7ac9e08335a42e52c31736e49626](https://github.com/sagemath/sagetrac-mirror/commit/f58377af2e7a7ac9e08335a42e52c31736e49626)\".",
    "created_at": "2016-03-15T04:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294219",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[86a7e6f8cb3845aa4551422941ee081cfc46f713](https://github.com/sagemath/sagetrac-mirror/commit/86a7e6f8cb3845aa4551422941ee081cfc46f713)" to "[f58377af2e7a7ac9e08335a42e52c31736e49626](https://github.com/sagemath/sagetrac-mirror/commit/f58377af2e7a7ac9e08335a42e52c31736e49626)".



---

archive/issue_comments_294220.json:
```json
{
    "body": "**Changing commit** from \"[f58377af2e7a7ac9e08335a42e52c31736e49626](https://github.com/sagemath/sagetrac-mirror/commit/f58377af2e7a7ac9e08335a42e52c31736e49626)\" to \"[f4df0b843b9afcc8eebd7dd6267bf5045481a8f0](https://github.com/sagemath/sagetrac-mirror/commit/f4df0b843b9afcc8eebd7dd6267bf5045481a8f0)\".",
    "created_at": "2016-03-15T04:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294220",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f58377af2e7a7ac9e08335a42e52c31736e49626](https://github.com/sagemath/sagetrac-mirror/commit/f58377af2e7a7ac9e08335a42e52c31736e49626)" to "[f4df0b843b9afcc8eebd7dd6267bf5045481a8f0](https://github.com/sagemath/sagetrac-mirror/commit/f4df0b843b9afcc8eebd7dd6267bf5045481a8f0)".



---

archive/issue_comments_294221.json:
```json
{
    "body": "<a id='comment:37'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4df0b843b9afcc8eebd7dd6267bf5045481a8f0\">f4df0b8</a></td><td><code>Cleaned up util</code></td></tr></table>\n",
    "created_at": "2016-03-15T04:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4df0b843b9afcc8eebd7dd6267bf5045481a8f0">f4df0b8</a></td><td><code>Cleaned up util</code></td></tr></table>




---

archive/issue_comments_294222.json:
```json
{
    "body": "<a id='comment:38'></a>\nThe latest patch copes with the multiprocessing of Sage doctesting.",
    "created_at": "2016-03-15T04:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294222",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:38'></a>
The latest patch copes with the multiprocessing of Sage doctesting.



---

archive/issue_comments_294223.json:
```json
{
    "body": "<a id='comment:39'></a>\nThis is silly:\n\n```\nraise Exception # should not happen!\n```\n\nReplace it by something like\n\n```\nraise AssertionError(\"invalid value for self.seen\")\n```",
    "created_at": "2016-03-15T07:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294223",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>
This is silly:

```
raise Exception # should not happen!
```

Replace it by something like

```
raise AssertionError("invalid value for self.seen")
```



---

archive/issue_comments_294224.json:
```json
{
    "body": "<a id='comment:40'></a>\nCan you add a timeout (using `alarm()`) for this:\n\n```\nurllib.request.urlopen(\"http://www.sagemath.org\")\n```",
    "created_at": "2016-03-15T07:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294224",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
Can you add a timeout (using `alarm()`) for this:

```
urllib.request.urlopen("http://www.sagemath.org")
```



---

archive/issue_comments_294225.json:
```json
{
    "body": "<a id='comment:41'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d360016e067bc0035aac4a9c324e371953360f9\">6d36001</a></td><td><code>Improved the raise statement</code></td></tr></table>\n",
    "created_at": "2016-03-15T08:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294225",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d360016e067bc0035aac4a9c324e371953360f9">6d36001</a></td><td><code>Improved the raise statement</code></td></tr></table>




---

archive/issue_comments_294226.json:
```json
{
    "body": "**Changing commit** from \"[f4df0b843b9afcc8eebd7dd6267bf5045481a8f0](https://github.com/sagemath/sagetrac-mirror/commit/f4df0b843b9afcc8eebd7dd6267bf5045481a8f0)\" to \"[6d360016e067bc0035aac4a9c324e371953360f9](https://github.com/sagemath/sagetrac-mirror/commit/6d360016e067bc0035aac4a9c324e371953360f9)\".",
    "created_at": "2016-03-15T08:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294226",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f4df0b843b9afcc8eebd7dd6267bf5045481a8f0](https://github.com/sagemath/sagetrac-mirror/commit/f4df0b843b9afcc8eebd7dd6267bf5045481a8f0)" to "[6d360016e067bc0035aac4a9c324e371953360f9](https://github.com/sagemath/sagetrac-mirror/commit/6d360016e067bc0035aac4a9c324e371953360f9)".



---

archive/issue_comments_294227.json:
```json
{
    "body": "**Changing commit** from \"[6d360016e067bc0035aac4a9c324e371953360f9](https://github.com/sagemath/sagetrac-mirror/commit/6d360016e067bc0035aac4a9c324e371953360f9)\" to \"[781796004587c55aaa385754f69498c1cecfea0d](https://github.com/sagemath/sagetrac-mirror/commit/781796004587c55aaa385754f69498c1cecfea0d)\".",
    "created_at": "2016-03-15T09:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294227",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6d360016e067bc0035aac4a9c324e371953360f9](https://github.com/sagemath/sagetrac-mirror/commit/6d360016e067bc0035aac4a9c324e371953360f9)" to "[781796004587c55aaa385754f69498c1cecfea0d](https://github.com/sagemath/sagetrac-mirror/commit/781796004587c55aaa385754f69498c1cecfea0d)".



---

archive/issue_comments_294228.json:
```json
{
    "body": "<a id='comment:42'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61c37271c7397ac1c0c30ebca714e36f148585d9\">61c3727</a></td><td><code>Add timeout to internet test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/781796004587c55aaa385754f69498c1cecfea0d\">7817960</a></td><td><code>Fixed a doctest failure</code></td></tr></table>\n",
    "created_at": "2016-03-15T09:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294228",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61c37271c7397ac1c0c30ebca714e36f148585d9">61c3727</a></td><td><code>Add timeout to internet test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/781796004587c55aaa385754f69498c1cecfea0d">7817960</a></td><td><code>Fixed a doctest failure</code></td></tr></table>




---

archive/issue_comments_294229.json:
```json
{
    "body": "<a id='comment:43'></a>\nOn my computer, doctesting the file `external.py` causes two windows to open up, showing the results from `view('2+3')`. Try to find another way to test whether latex is present and functional, maybe something like this:\n\n```diff\ndiff --git a/src/sage/doctest/external.py b/src/sage/doctest/external.py\nindex f05bc8d..463413a 100644\n--- a/src/sage/doctest/external.py\n+++ b/src/sage/doctest/external.py\n@@ -59,9 +59,14 @@ def has_latex():\n         sage: has_latex() # random\n         True\n     \"\"\"\n-    from sage.misc.latex import view\n+    from sage.misc.latex import _run_latex_, _latex_file_\n+    from sage.misc.temporary_file import tmp_filename\n     try:\n-        view('2+3')\n+        f = tmp_filename(ext='.tex')\n+        O = open(f, 'w')\n+        O.write(_latex_file_('3'))\n+        O.close()\n+        _run_latex_(f)\n         return True\n     except Exception:\n         return False\n```\n\nAlso, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.",
    "created_at": "2016-03-15T22:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294229",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'></a>
On my computer, doctesting the file `external.py` causes two windows to open up, showing the results from `view('2+3')`. Try to find another way to test whether latex is present and functional, maybe something like this:

```diff
diff --git a/src/sage/doctest/external.py b/src/sage/doctest/external.py
index f05bc8d..463413a 100644
--- a/src/sage/doctest/external.py
+++ b/src/sage/doctest/external.py
@@ -59,9 +59,14 @@ def has_latex():
         sage: has_latex() # random
         True
     """
-    from sage.misc.latex import view
+    from sage.misc.latex import _run_latex_, _latex_file_
+    from sage.misc.temporary_file import tmp_filename
     try:
-        view('2+3')
+        f = tmp_filename(ext='.tex')
+        O = open(f, 'w')
+        O.write(_latex_file_('3'))
+        O.close()
+        _run_latex_(f)
         return True
     except Exception:
         return False
```

Also, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.



---

archive/issue_comments_294230.json:
```json
{
    "body": "<a id='comment:44'></a>\nAlso, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?",
    "created_at": "2016-03-15T23:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294230",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'></a>
Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?



---

archive/issue_comments_294231.json:
```json
{
    "body": "<a id='comment:45'></a>\n> Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?\n\n\nYes.  Like #16302.  Are the ones (OEIS) in #16252 at least still fixed?",
    "created_at": "2016-03-16T02:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294231",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:45'></a>
> Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?


Yes.  Like #16302.  Are the ones (OEIS) in #16252 at least still fixed?



---

archive/issue_comments_294232.json:
```json
{
    "body": "<a id='comment:46'></a>\nI had to make this change in `oeis.py` to fix one failure:\n\n```diff\ndiff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py\nindex ff88286..b8de905 100644\n--- a/src/sage/databases/oeis.py\n+++ b/src/sage/databases/oeis.py\n@@ -841,7 +841,7 @@ class OEISSequence(SageObject):\n             A000045: Fibonacci numbers: F(n) = F(n-1) + F(n-2) with F(0) = 0 and F(1) = 1.\n \n             sage: f.keywords()                          # optional -- internet\n-            ('core', 'nonn', 'nice', 'easy', 'hear')\n+            ('core', 'nonn', 'nice', 'easy', 'hear', 'changed')\n \n         TESTS::\n \n```",
    "created_at": "2016-03-16T02:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294232",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:46'></a>
I had to make this change in `oeis.py` to fix one failure:

```diff
diff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py
index ff88286..b8de905 100644
--- a/src/sage/databases/oeis.py
+++ b/src/sage/databases/oeis.py
@@ -841,7 +841,7 @@ class OEISSequence(SageObject):
             A000045: Fibonacci numbers: F(n) = F(n-1) + F(n-2) with F(0) = 0 and F(1) = 1.
 
             sage: f.keywords()                          # optional -- internet
-            ('core', 'nonn', 'nice', 'easy', 'hear')
+            ('core', 'nonn', 'nice', 'easy', 'hear', 'changed')
 
         TESTS::
 
```



---

archive/issue_comments_294233.json:
```json
{
    "body": "<a id='comment:47'></a>\nI think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.",
    "created_at": "2016-03-16T02:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294233",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:47'></a>
I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.



---

archive/issue_comments_294234.json:
```json
{
    "body": "**Changing commit** from \"[781796004587c55aaa385754f69498c1cecfea0d](https://github.com/sagemath/sagetrac-mirror/commit/781796004587c55aaa385754f69498c1cecfea0d)\" to \"[4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664](https://github.com/sagemath/sagetrac-mirror/commit/4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664)\".",
    "created_at": "2016-03-16T05:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[781796004587c55aaa385754f69498c1cecfea0d](https://github.com/sagemath/sagetrac-mirror/commit/781796004587c55aaa385754f69498c1cecfea0d)" to "[4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664](https://github.com/sagemath/sagetrac-mirror/commit/4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664)".



---

archive/issue_comments_294235.json:
```json
{
    "body": "<a id='comment:48'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc0b8857b4ad6b1694b270246986af1f8561f5e3\">fc0b885</a></td><td><code>Improved latex detection</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664\">4dc6df1</a></td><td><code>Fixed a bug; trimmed the docs</code></td></tr></table>\n",
    "created_at": "2016-03-16T05:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294235",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc0b8857b4ad6b1694b270246986af1f8561f5e3">fc0b885</a></td><td><code>Improved latex detection</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664">4dc6df1</a></td><td><code>Fixed a bug; trimmed the docs</code></td></tr></table>




---

archive/issue_comments_294236.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [jhpalmieri](#comment%3A43):\n\n> Also, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.\n\n\nFor this ticket, I will stop at providing the framework for tests requiring external softwares.  Thus\n\n(1) Any expert is cordially invited to contribute commits for better and new `has_xxx` tester for the software `xxx`.\n\n(2) Turning on `external` by default should be dealt with in another ticket.\n\n(3) Fixing all doctest failures that result from changing the default should be dealt with separate tickets.",
    "created_at": "2016-03-16T05:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294236",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:49'></a>
Replying to [jhpalmieri](#comment%3A43):

> Also, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.


For this ticket, I will stop at providing the framework for tests requiring external softwares.  Thus

(1) Any expert is cordially invited to contribute commits for better and new `has_xxx` tester for the software `xxx`.

(2) Turning on `external` by default should be dealt with in another ticket.

(3) Fixing all doctest failures that result from changing the default should be dealt with separate tickets.



---

archive/issue_comments_294237.json:
```json
{
    "body": "**Changing commit** from \"[4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664](https://github.com/sagemath/sagetrac-mirror/commit/4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664)\" to \"[82b20cac6b47ecebc3852a21bfad1142635a73bd](https://github.com/sagemath/sagetrac-mirror/commit/82b20cac6b47ecebc3852a21bfad1142635a73bd)\".",
    "created_at": "2016-03-16T07:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664](https://github.com/sagemath/sagetrac-mirror/commit/4dc6df1f078cd58a8cc1c0f25dd941b94dbe5664)" to "[82b20cac6b47ecebc3852a21bfad1142635a73bd](https://github.com/sagemath/sagetrac-mirror/commit/82b20cac6b47ecebc3852a21bfad1142635a73bd)".



---

archive/issue_comments_294238.json:
```json
{
    "body": "<a id='comment:50'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82b20cac6b47ecebc3852a21bfad1142635a73bd\">82b20ca</a></td><td><code>Added a doctest</code></td></tr></table>\n",
    "created_at": "2016-03-16T07:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82b20cac6b47ecebc3852a21bfad1142635a73bd">82b20ca</a></td><td><code>Added a doctest</code></td></tr></table>




---

archive/issue_comments_294239.json:
```json
{
    "body": "<a id='comment:51'></a>\nOr perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`",
    "created_at": "2016-03-16T08:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294239",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>
Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`



---

archive/issue_comments_294240.json:
```json
{
    "body": "**Changing commit** from \"[82b20cac6b47ecebc3852a21bfad1142635a73bd](https://github.com/sagemath/sagetrac-mirror/commit/82b20cac6b47ecebc3852a21bfad1142635a73bd)\" to \"[36b4f7aefaab9453600f93e0bce43998e19da50d](https://github.com/sagemath/sagetrac-mirror/commit/36b4f7aefaab9453600f93e0bce43998e19da50d)\".",
    "created_at": "2016-03-16T09:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294240",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[82b20cac6b47ecebc3852a21bfad1142635a73bd](https://github.com/sagemath/sagetrac-mirror/commit/82b20cac6b47ecebc3852a21bfad1142635a73bd)" to "[36b4f7aefaab9453600f93e0bce43998e19da50d](https://github.com/sagemath/sagetrac-mirror/commit/36b4f7aefaab9453600f93e0bce43998e19da50d)".



---

archive/issue_comments_294241.json:
```json
{
    "body": "<a id='comment:52'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/36b4f7aefaab9453600f93e0bce43998e19da50d\">36b4f7a</a></td><td><code>Define make (p)testall(long) to use --optional=sage,optional,external</code></td></tr></table>\n",
    "created_at": "2016-03-16T09:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294241",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/36b4f7aefaab9453600f93e0bce43998e19da50d">36b4f7a</a></td><td><code>Define make (p)testall(long) to use --optional=sage,optional,external</code></td></tr></table>




---

archive/issue_comments_294242.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [jdemeyer](#comment%3A51):\n> Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`\n\n\nDone. What about `make (p)testoptional(long)`? Perhaps `--optional=sage,optional`?",
    "created_at": "2016-03-16T09:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294242",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:53'></a>
Replying to [jdemeyer](#comment%3A51):
> Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`


Done. What about `make (p)testoptional(long)`? Perhaps `--optional=sage,optional`?



---

archive/issue_comments_294243.json:
```json
{
    "body": "<a id='comment:54'></a>\n> I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.\n\n\nAgreed.  (In your example, presumably `'core' in f.keywords()` would be better?)  But I also think we *must* enable the internet testing within some framework people will test relatively often - if `make testall` is that place, that's fine.  Otherwise untested is broken - between OEIS and some of the timeseries stuff there is probably a lot eventually broken.",
    "created_at": "2016-03-16T12:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294243",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:54'></a>
> I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.


Agreed.  (In your example, presumably `'core' in f.keywords()` would be better?)  But I also think we *must* enable the internet testing within some framework people will test relatively often - if `make testall` is that place, that's fine.  Otherwise untested is broken - between OEIS and some of the timeseries stuff there is probably a lot eventually broken.



---

archive/issue_comments_294244.json:
```json
{
    "body": "**Changing commit** from \"[36b4f7aefaab9453600f93e0bce43998e19da50d](https://github.com/sagemath/sagetrac-mirror/commit/36b4f7aefaab9453600f93e0bce43998e19da50d)\" to \"[6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c](https://github.com/sagemath/sagetrac-mirror/commit/6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c)\".",
    "created_at": "2016-03-17T00:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[36b4f7aefaab9453600f93e0bce43998e19da50d](https://github.com/sagemath/sagetrac-mirror/commit/36b4f7aefaab9453600f93e0bce43998e19da50d)" to "[6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c](https://github.com/sagemath/sagetrac-mirror/commit/6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c)".



---

archive/issue_comments_294245.json:
```json
{
    "body": "<a id='comment:55'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c\">6d7d3d5</a></td><td><code>Define make (p)testoptional(long) to use --optional=sage,optional</code></td></tr></table>\n",
    "created_at": "2016-03-17T00:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c">6d7d3d5</a></td><td><code>Define make (p)testoptional(long) to use --optional=sage,optional</code></td></tr></table>




---

archive/issue_events_184666.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-17T00:51:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184666"
}
```



---

archive/issue_events_184667.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-22T01:24:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184667"
}
```



---

archive/issue_events_184668.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-22T01:24:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184668"
}
```



---

archive/issue_comments_294246.json:
```json
{
    "body": "<a id='comment:58'></a>\nWhy the patchbot is not working on this ticket? Since I made changes on `Makefile`?",
    "created_at": "2016-03-25T02:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294246",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:58'></a>
Why the patchbot is not working on this ticket? Since I made changes on `Makefile`?



---

archive/issue_comments_294247.json:
```json
{
    "body": "<a id='comment:59'></a>\nI am working on a more generic way of checking for features of the system (including nice error messages) at #20382. klee: What do you think about it? You could potentially rebase your code to use the features there or I could do that once #20182 got merged.",
    "created_at": "2016-04-11T02:18:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294247",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:59'></a>
I am working on a more generic way of checking for features of the system (including nice error messages) at #20382. klee: What do you think about it? You could potentially rebase your code to use the features there or I could do that once #20182 got merged.



---

archive/issue_comments_294248.json:
```json
{
    "body": "<a id='comment:60'></a>\nAs this ticket is related to #20382, but independent from it. I think this ticket could be reviewed and merged independently, though still no one bothers reviewing it. Then I would be happy that you open a new ticket to use your features once #20382 got merged.\n\nIf #20382 is merged first, then I would also be very happy that you rebase this ticket to #20382.",
    "created_at": "2016-04-11T07:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294248",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:60'></a>
As this ticket is related to #20382, but independent from it. I think this ticket could be reviewed and merged independently, though still no one bothers reviewing it. Then I would be happy that you open a new ticket to use your features once #20382 got merged.

If #20382 is merged first, then I would also be very happy that you rebase this ticket to #20382.



---

archive/issue_comments_294249.json:
```json
{
    "body": "<a id='comment:61'></a>\nThis doctest should be marked \"random\":\n\n```\n        sage: available_softwares.seen()\n        ['internet', 'latex', 'magma']\n```\nAlso, throughout, \"softwares\" should be \"software\" -- \"which software do you have installed\" is correct, for example, not \"which softwares do you have installed\".",
    "created_at": "2016-04-12T16:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294249",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:61'></a>
This doctest should be marked "random":

```
        sage: available_softwares.seen()
        ['internet', 'latex', 'magma']
```
Also, throughout, "softwares" should be "software" -- "which software do you have installed" is correct, for example, not "which softwares do you have installed".



---

archive/issue_comments_294250.json:
```json
{
    "body": "<a id='comment:62'></a>\nWhat should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. Anyone else have opinions? \n\nFor example:\n\n```\nsage -t src/sage/plot/graphics.py\n**********************************************************************\nFile \"src/sage/plot/graphics.py\", line 1624, in sage.plot.graphics.Graphics.show\nFailed example:\n    plot(x, typeset='latex') # optional - latex\nExpected nothing\nGot:\n    Graphics object consisting of 1 graphics primitive\n**********************************************************************\nFile \"src/sage/plot/graphics.py\", line 1630, in sage.plot.graphics.Graphics.show\nFailed example:\n    plot(x, typeset='type1') # optional - latex\nExpected nothing\nGot:\n    Graphics object consisting of 1 graphics primitive\n**********************************************************************\n1 item had failures:\n   2 of  87 in sage.plot.graphics.Graphics.show\n```\nI get this at the end of `make ptestall`:\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/plot/graphics.py  # 2 doctests failed\nsage -t src/sage/plot/plot.py  # 1 doctest failed\nsage -t src/sage/arith/misc.py  # 1 doctest failed\nsage -t src/sage/tests/cmdline.py  # 1 doctest failed\nsage -t src/sage/dev/sagedev.py  # 2 doctests failed\nsage -t src/sage/structure/sage_object.pyx  # 2 doctests failed\nsage -t src/sage/combinat/designs/bibd.py  # 1 doctest failed\nsage -t src/sage/misc/package.py  # 6 doctests failed\nsage -t src/sage/doctest/external.py  # 1 doctest failed\nsage -t src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed\nsage -t src/sage/dev/trac_interface.py  # 5 doctests failed\nsage -t src/sage/repl/load.py  # 2 doctests failed\nsage -t src/doc/en/developer/coding_basics.rst  # 1 doctest failed\nsage -t src/sage/dev/patch.py  # 3 doctests failed\nsage -t src/sage/databases/oeis.py  # 2 doctests failed\nsage -t src/sage/combinat/integer_lists/invlex.pyx  # 1 doctest failed\nsage -t src/sage/dev/digest_transport.py  # 1 doctest failed\nsage -t src/sage/finance/stock.py  # 2 doctests failed\nsage -t src/sage/misc/remote_file.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 1929.7 seconds\n    cpu time: 3833.1 seconds\n    cumulative wall time: 7184.9 seconds\nExternal softwares detected for doctesting: internet,latex\n```",
    "created_at": "2016-04-12T18:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294250",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:62'></a>
What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. Anyone else have opinions? 

For example:

```
sage -t src/sage/plot/graphics.py
**********************************************************************
File "src/sage/plot/graphics.py", line 1624, in sage.plot.graphics.Graphics.show
Failed example:
    plot(x, typeset='latex') # optional - latex
Expected nothing
Got:
    Graphics object consisting of 1 graphics primitive
**********************************************************************
File "src/sage/plot/graphics.py", line 1630, in sage.plot.graphics.Graphics.show
Failed example:
    plot(x, typeset='type1') # optional - latex
Expected nothing
Got:
    Graphics object consisting of 1 graphics primitive
**********************************************************************
1 item had failures:
   2 of  87 in sage.plot.graphics.Graphics.show
```
I get this at the end of `make ptestall`:

```
----------------------------------------------------------------------
sage -t src/sage/plot/graphics.py  # 2 doctests failed
sage -t src/sage/plot/plot.py  # 1 doctest failed
sage -t src/sage/arith/misc.py  # 1 doctest failed
sage -t src/sage/tests/cmdline.py  # 1 doctest failed
sage -t src/sage/dev/sagedev.py  # 2 doctests failed
sage -t src/sage/structure/sage_object.pyx  # 2 doctests failed
sage -t src/sage/combinat/designs/bibd.py  # 1 doctest failed
sage -t src/sage/misc/package.py  # 6 doctests failed
sage -t src/sage/doctest/external.py  # 1 doctest failed
sage -t src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed
sage -t src/sage/dev/trac_interface.py  # 5 doctests failed
sage -t src/sage/repl/load.py  # 2 doctests failed
sage -t src/doc/en/developer/coding_basics.rst  # 1 doctest failed
sage -t src/sage/dev/patch.py  # 3 doctests failed
sage -t src/sage/databases/oeis.py  # 2 doctests failed
sage -t src/sage/combinat/integer_lists/invlex.pyx  # 1 doctest failed
sage -t src/sage/dev/digest_transport.py  # 1 doctest failed
sage -t src/sage/finance/stock.py  # 2 doctests failed
sage -t src/sage/misc/remote_file.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 1929.7 seconds
    cpu time: 3833.1 seconds
    cumulative wall time: 7184.9 seconds
External softwares detected for doctesting: internet,latex
```



---

archive/issue_comments_294251.json:
```json
{
    "body": "<a id='comment:63'></a>\nminor remark: there is a timeout optional argument for `urlopen` (that will gives you a `URLError` in case of failure). And in this particular test, why are you catching `Exception`?",
    "created_at": "2016-04-12T23:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294251",
    "user": "https://github.com/videlec"
}
```

<a id='comment:63'></a>
minor remark: there is a timeout optional argument for `urlopen` (that will gives you a `URLError` in case of failure). And in this particular test, why are you catching `Exception`?



---

archive/issue_comments_294252.json:
```json
{
    "body": "<a id='comment:64'></a>\nReplying to [jhpalmieri](#comment%3A62):\n> What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. \n\n\nThis patch can be safely merged as long as the patchbot and the people checking a new Sage release use `make ptestlong`,  which I think is the current practice. Then we need to open a ticket for the failing doctests for each external software, before we at some point switch to use `make ptestall` for a new release.",
    "created_at": "2016-04-13T06:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294252",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:64'></a>
Replying to [jhpalmieri](#comment%3A62):
> What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. 


This patch can be safely merged as long as the patchbot and the people checking a new Sage release use `make ptestlong`,  which I think is the current practice. Then we need to open a ticket for the failing doctests for each external software, before we at some point switch to use `make ptestall` for a new release.



---

archive/issue_comments_294253.json:
```json
{
    "body": "**Changing commit** from \"[6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c](https://github.com/sagemath/sagetrac-mirror/commit/6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c)\" to \"[b243bd6365aebb2bac096eedf262ed961a862f07](https://github.com/sagemath/sagetrac-mirror/commit/b243bd6365aebb2bac096eedf262ed961a862f07)\".",
    "created_at": "2016-04-13T08:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c](https://github.com/sagemath/sagetrac-mirror/commit/6d7d3d5b9bb1f1ba3e068fdd5a3766a5415dd41c)" to "[b243bd6365aebb2bac096eedf262ed961a862f07](https://github.com/sagemath/sagetrac-mirror/commit/b243bd6365aebb2bac096eedf262ed961a862f07)".



---

archive/issue_comments_294254.json:
```json
{
    "body": "<a id='comment:65'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/306067a861a2016b1be614c970ee04d8590187ad\">306067a</a></td><td><code>Minor fixes and URLError for internet timeout</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b243bd6365aebb2bac096eedf262ed961a862f07\">b243bd6</a></td><td><code>Merge branch Sage 7.2.beta4 into trac20182</code></td></tr></table>\n",
    "created_at": "2016-04-13T08:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294254",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/306067a861a2016b1be614c970ee04d8590187ad">306067a</a></td><td><code>Minor fixes and URLError for internet timeout</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b243bd6365aebb2bac096eedf262ed961a862f07">b243bd6</a></td><td><code>Merge branch Sage 7.2.beta4 into trac20182</code></td></tr></table>




---

archive/issue_comments_294255.json:
```json
{
    "body": "<a id='comment:66'></a>\nEvery function and method needs documentation and doctests.\n\n```\n$ sage --coverage src/sage/doctest/external.py \n------------------------------------------------------------------------\nSCORE src/sage/doctest/external.py: 64.7% (11 of 17)\n\nMissing documentation:\n     * line 272: def __init__(self)\n     * line 277: def __contains__(self, item)\n\nMissing doctests:\n     * line 224: def external_software()\n     * line 236: def _lookup(software)\n     * line 294: def issuperset(self, other)\n     * line 303: def seen(self)\n------------------------------------------------------------------------\n```",
    "created_at": "2016-04-13T15:09:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294255",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:66'></a>
Every function and method needs documentation and doctests.

```
$ sage --coverage src/sage/doctest/external.py 
------------------------------------------------------------------------
SCORE src/sage/doctest/external.py: 64.7% (11 of 17)

Missing documentation:
     * line 272: def __init__(self)
     * line 277: def __contains__(self, item)

Missing doctests:
     * line 224: def external_software()
     * line 236: def _lookup(software)
     * line 294: def issuperset(self, other)
     * line 303: def seen(self)
------------------------------------------------------------------------
```



---

archive/issue_comments_294256.json:
```json
{
    "body": "<a id='comment:67'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/308643a1d25c8683d1945d94f5ae182035f32025\">308643a</a></td><td><code>Add and trim docstrings</code></td></tr></table>\n",
    "created_at": "2016-04-14T01:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:67'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/308643a1d25c8683d1945d94f5ae182035f32025">308643a</a></td><td><code>Add and trim docstrings</code></td></tr></table>




---

archive/issue_comments_294257.json:
```json
{
    "body": "**Changing commit** from \"[b243bd6365aebb2bac096eedf262ed961a862f07](https://github.com/sagemath/sagetrac-mirror/commit/b243bd6365aebb2bac096eedf262ed961a862f07)\" to \"[308643a1d25c8683d1945d94f5ae182035f32025](https://github.com/sagemath/sagetrac-mirror/commit/308643a1d25c8683d1945d94f5ae182035f32025)\".",
    "created_at": "2016-04-14T01:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294257",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b243bd6365aebb2bac096eedf262ed961a862f07](https://github.com/sagemath/sagetrac-mirror/commit/b243bd6365aebb2bac096eedf262ed961a862f07)" to "[308643a1d25c8683d1945d94f5ae182035f32025](https://github.com/sagemath/sagetrac-mirror/commit/308643a1d25c8683d1945d94f5ae182035f32025)".



---

archive/issue_comments_294258.json:
```json
{
    "body": "**Changing commit** from \"[308643a1d25c8683d1945d94f5ae182035f32025](https://github.com/sagemath/sagetrac-mirror/commit/308643a1d25c8683d1945d94f5ae182035f32025)\" to \"[08aca6e4b275abe7f86adffc6deeb047a68dedab](https://github.com/sagemath/sagetrac-mirror/commit/08aca6e4b275abe7f86adffc6deeb047a68dedab)\".",
    "created_at": "2016-04-18T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294258",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[308643a1d25c8683d1945d94f5ae182035f32025](https://github.com/sagemath/sagetrac-mirror/commit/308643a1d25c8683d1945d94f5ae182035f32025)" to "[08aca6e4b275abe7f86adffc6deeb047a68dedab](https://github.com/sagemath/sagetrac-mirror/commit/08aca6e4b275abe7f86adffc6deeb047a68dedab)".



---

archive/issue_comments_294259.json:
```json
{
    "body": "<a id='comment:68'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08aca6e4b275abe7f86adffc6deeb047a68dedab\">08aca6e</a></td><td><code>trac 20182: minor rewording, remove \"random\" from one doctest</code></td></tr></table>\n",
    "created_at": "2016-04-18T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294259",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08aca6e4b275abe7f86adffc6deeb047a68dedab">08aca6e</a></td><td><code>trac 20182: minor rewording, remove "random" from one doctest</code></td></tr></table>




---

archive/issue_comments_294260.json:
```json
{
    "body": "<a id='comment:69'></a>\nHere are a few minor rewordings. The only possibly significant change is removing \"# random\" from one doctest, but the same thing is doctested later in the same file (in `AvailableSoftware`) without that marking.\n\nI am happy with this now. Does anyone else have any comments?",
    "created_at": "2016-04-18T20:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294260",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:69'></a>
Here are a few minor rewordings. The only possibly significant change is removing "# random" from one doctest, but the same thing is doctested later in the same file (in `AvailableSoftware`) without that marking.

I am happy with this now. Does anyone else have any comments?



---

archive/issue_comments_294261.json:
```json
{
    "body": "**Changing commit** from \"[08aca6e4b275abe7f86adffc6deeb047a68dedab](https://github.com/sagemath/sagetrac-mirror/commit/08aca6e4b275abe7f86adffc6deeb047a68dedab)\" to \"[c4e48bd22aa1f018436795c14efbdc78a47673e1](https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1)\".",
    "created_at": "2016-04-19T00:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294261",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[08aca6e4b275abe7f86adffc6deeb047a68dedab](https://github.com/sagemath/sagetrac-mirror/commit/08aca6e4b275abe7f86adffc6deeb047a68dedab)" to "[c4e48bd22aa1f018436795c14efbdc78a47673e1](https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1)".



---

archive/issue_comments_294262.json:
```json
{
    "body": "<a id='comment:70'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69bcf2165bcacd1ed38aef0d78e6ba367cd6e495\">69bcf21</a></td><td><code>Change one doctest to be nonrandom</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1\">c4e48bd</a></td><td><code>Merge with other modifications</code></td></tr></table>\n",
    "created_at": "2016-04-19T00:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:70'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69bcf2165bcacd1ed38aef0d78e6ba367cd6e495">69bcf21</a></td><td><code>Change one doctest to be nonrandom</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1">c4e48bd</a></td><td><code>Merge with other modifications</code></td></tr></table>




---

archive/issue_comments_294263.json:
```json
{
    "body": "<a id='comment:71'></a>\nThe list \"external_software\" should not be random. For convenience of later modification, I changed one of the duplicate doctests. Thank you for elaborate review!",
    "created_at": "2016-04-19T00:32:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294263",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:71'></a>
The list "external_software" should not be random. For convenience of later modification, I changed one of the duplicate doctests. Thank you for elaborate review!



---

archive/issue_comments_294264.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2016-04-25T17:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294264",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_events_184669.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-04-25T17:51:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184669"
}
```



---

archive/issue_events_184670.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-04-25T17:51:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184670"
}
```



---

archive/issue_events_184671.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-26T12:58:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184671"
}
```



---

archive/issue_events_184672.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-26T12:58:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-184672"
}
```



---

archive/issue_comments_294265.json:
```json
{
    "body": "**Changing branch** from \"[public/20182](https://github.com/sagemath/sagetrac-mirror/tree/public/20182)\" to \"[c4e48bd22aa1f018436795c14efbdc78a47673e1](https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1)\".",
    "created_at": "2016-04-26T12:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-294265",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/20182](https://github.com/sagemath/sagetrac-mirror/tree/public/20182)" to "[c4e48bd22aa1f018436795c14efbdc78a47673e1](https://github.com/sagemath/sagetrac-mirror/commit/c4e48bd22aa1f018436795c14efbdc78a47673e1)".
