# Issue 20182: Automatic doctest for external softwares

archive/issues_019945.json:
```json
{
    "body": "Many doctests depend on softwares external to Sage (including \"internet\") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests for the softwares available.\n\nWith the patch,\n\n\"sage -t --optional=PKGS\": only run doctests including one of the \"# optional - xxx\" tags where xxx is listed in         PKGS; \n    if \"sage\" is listed, will also run the standard doctests;\n    if \"optional\" is listed, will also run tests for installed optional (new-style) packages;\n    if \"external\" is listed, will also run tests for available external softwares;\n    if set to \"all\", then all tests will be run\n\nThis is a rewrite of #18904 and #13540.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20182\n\n",
    "closed_at": "2016-04-26T12:58:41Z",
    "created_at": "2016-03-09T15:45:46Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Automatic doctest for external softwares",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20182",
    "user": "https://github.com/kwankyu"
}
```
Many doctests depend on softwares external to Sage (including "internet") available on the system, such as latex, magma, mathematica, maple, etc. This patch allows to run the optional doctests for the softwares available.

With the patch,

"sage -t --optional=PKGS": only run doctests including one of the "# optional - xxx" tags where xxx is listed in         PKGS; 
    if "sage" is listed, will also run the standard doctests;
    if "optional" is listed, will also run tests for installed optional (new-style) packages;
    if "external" is listed, will also run tests for available external softwares;
    if set to "all", then all tests will be run

This is a rewrite of #18904 and #13540.

Issue created by migration from https://trac.sagemath.org/ticket/20182





---

archive/issue_comments_274186.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-09T15:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274186",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274187.json:
```json
{
    "body": "The patch is a draft or a proof of concept.",
    "created_at": "2016-03-09T15:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274187",
    "user": "https://github.com/kwankyu"
}
```

The patch is a draft or a proof of concept.



---

archive/issue_comments_274188.json:
```json
{
    "body": "Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.",
    "created_at": "2016-03-09T16:04:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274188",
    "user": "https://github.com/kcrisman"
}
```

Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.



---

archive/issue_comments_274189.json:
```json
{
    "body": "I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`. That's almost as much \"effort\" as writing `--optional=latex,magma,internet`. Also the name \"nonpackages\" is a bit strange: why is \"octave\" a nonpackage?\n\nAlso, I don't believe that `have_latex()` is a sufficient test to check that `latex` works. You should really run `latex` to be sure. All the other tests actually run the optional program.",
    "created_at": "2016-03-09T16:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274189",
    "user": "https://github.com/jdemeyer"
}
```

I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`. That's almost as much "effort" as writing `--optional=latex,magma,internet`. Also the name "nonpackages" is a bit strange: why is "octave" a nonpackage?

Also, I don't believe that `have_latex()` is a sufficient test to check that `latex` works. You should really run `latex` to be sure. All the other tests actually run the optional program.



---

archive/issue_comments_274190.json:
```json
{
    "body": "The intention is to test the doctests of the form \"#optional - xxx\" where xxx is not a Sage package. So I think internet is also a \"nonpackage\" :-)",
    "created_at": "2016-03-09T16:10:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274190",
    "user": "https://github.com/kwankyu"
}
```

The intention is to test the doctests of the form "#optional - xxx" where xxx is not a Sage package. So I think internet is also a "nonpackage" :-)



---

archive/issue_comments_274191.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n> I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.\n\n\nTo be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.",
    "created_at": "2016-03-09T16:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274191",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 jdemeyer]:
> I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.


To be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.



---

archive/issue_comments_274192.json:
```json
{
    "body": "It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:\n\n```\n    if test_latex(): pkgs.append('latex')\n    if test_magma(): pkgs.append('magma')\n    if test_matlab(): pkgs.append('matlab')     \n    if test_mathematica(): pkgs.append('mathematica')  \n    if test_macaulay2(): pkgs.append('macaulay2')  \n    if test_octave(): pkgs.append('octave')  \n    if test_scilab(): pkgs.append('scilab')  \n    if test_maple(): pkgs.append('maple')\n    if test_cplex(): pkgs.append('cplex')  \n    if test_gurobi(): pkgs.append('gurobi')\n```",
    "created_at": "2016-03-09T16:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274192",
    "user": "https://github.com/jdemeyer"
}
```

It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:

```
    if test_latex(): pkgs.append('latex')
    if test_magma(): pkgs.append('magma')
    if test_matlab(): pkgs.append('matlab')     
    if test_mathematica(): pkgs.append('mathematica')  
    if test_macaulay2(): pkgs.append('macaulay2')  
    if test_octave(): pkgs.append('octave')  
    if test_scilab(): pkgs.append('scilab')  
    if test_maple(): pkgs.append('maple')
    if test_cplex(): pkgs.append('cplex')  
    if test_gurobi(): pkgs.append('gurobi')
```



---

archive/issue_comments_274193.json:
```json
{
    "body": "You should also consider performance issues. I don't want to run all these tests every time I doctest something. You should look at #13540, which uses a lazy mechanism for testing optional tags.",
    "created_at": "2016-03-09T16:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274193",
    "user": "https://github.com/jdemeyer"
}
```

You should also consider performance issues. I don't want to run all these tests every time I doctest something. You should look at #13540, which uses a lazy mechanism for testing optional tags.



---

archive/issue_comments_274194.json:
```json
{
    "body": "Replying to [comment:8 jdemeyer]:\n> Replying to [comment:5 jdemeyer]:\n> > I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.\n\n> \n> To be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.\n\n\nCurrently doctests for Sage optional packages, if installed on the system, are automatically run only if \"--optional\" is given. Doctests for nonpackages are run only if \"--optional=nonpackages\" is given. Perhaps we should keep this ability because of the performance issues that you mention...",
    "created_at": "2016-03-09T16:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274194",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:8 jdemeyer]:
> Replying to [comment:5 jdemeyer]:
> > I don't like the fact that you *explicitly* need to specify `--optional=nonpackages`.

> 
> To be clear, I meant that `nonpackages` should be passed by default if no `--optional` argument is given.


Currently doctests for Sage optional packages, if installed on the system, are automatically run only if "--optional" is given. Doctests for nonpackages are run only if "--optional=nonpackages" is given. Perhaps we should keep this ability because of the performance issues that you mention...



---

archive/issue_comments_274195.json:
```json
{
    "body": "Replying to [comment:9 jdemeyer]:\n> It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:\n> \n> ```\n>     if test_latex(): pkgs.append('latex')\n>     if test_magma(): pkgs.append('magma')\n>     if test_matlab(): pkgs.append('matlab')     \n>     if test_mathematica(): pkgs.append('mathematica')  \n>     if test_macaulay2(): pkgs.append('macaulay2')  \n>     if test_octave(): pkgs.append('octave')  \n>     if test_scilab(): pkgs.append('scilab')  \n>     if test_maple(): pkgs.append('maple')\n>     if test_cplex(): pkgs.append('cplex')  \n>     if test_gurobi(): pkgs.append('gurobi')\n> ```\n\n\nI totally agree! But I needed to write the code before I go to sleep, as I am living on the other side of the globe :-) You can help!",
    "created_at": "2016-03-09T16:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274195",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:9 jdemeyer]:
> It would be cool if this would automatically go over all test functions instead of this ugly error-prone code:
> 
> ```
>     if test_latex(): pkgs.append('latex')
>     if test_magma(): pkgs.append('magma')
>     if test_matlab(): pkgs.append('matlab')     
>     if test_mathematica(): pkgs.append('mathematica')  
>     if test_macaulay2(): pkgs.append('macaulay2')  
>     if test_octave(): pkgs.append('octave')  
>     if test_scilab(): pkgs.append('scilab')  
>     if test_maple(): pkgs.append('maple')
>     if test_cplex(): pkgs.append('cplex')  
>     if test_gurobi(): pkgs.append('gurobi')
> ```


I totally agree! But I needed to write the code before I go to sleep, as I am living on the other side of the globe :-) You can help!



---

archive/issue_comments_274196.json:
```json
{
    "body": "I think this is only really useful if \"nonpackages\" are tested by default.",
    "created_at": "2016-03-09T16:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274196",
    "user": "https://github.com/jdemeyer"
}
```

I think this is only really useful if "nonpackages" are tested by default.



---

archive/issue_comments_274197.json:
```json
{
    "body": "Replying to [comment:4 kcrisman]:\n> Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.\n\n\nThere were [some concerns](http://trac.sagemath.org/ticket/16252#comment:32) about running internet tests whenever possible. I'm not sure I agree with those, but maybe there are other reasons not to do these all the time. (What if I lose my internet connection after testing testing connectivity but in the middle of doctesting? Do we have to test connectivity before every internet test?) But I think some of the patchbots could use the `internet` flag when doctesting.",
    "created_at": "2016-03-09T18:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274197",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:4 kcrisman]:
> Don't forget internet - or should that be its own ticket, since it's a different kind of non-package?  One could presumably do some connectivity test and if it failed, *not* run the internet tests - they should really nearly always be run.


There were [some concerns](http://trac.sagemath.org/ticket/16252#comment:32) about running internet tests whenever possible. I'm not sure I agree with those, but maybe there are other reasons not to do these all the time. (What if I lose my internet connection after testing testing connectivity but in the middle of doctesting? Do we have to test connectivity before every internet test?) But I think some of the patchbots could use the `internet` flag when doctesting.



---

archive/issue_comments_274198.json:
```json
{
    "body": "Replying to [comment:11 klee]:\n> Currently doctests for Sage optional packages, if installed on the system, are automatically run only if \"--optional\" is given.\n\n\nI don't think this is correct. When I run doctests without any extra flags, I see (after installing a few optional packages for testing purposes)\n\n```\n$ sage -tp src/sage/homology/\n...\nUsing --optional=ccache,database_gap,gcc,mpir,ore_algebra,python2,sage\n...\n```",
    "created_at": "2016-03-09T18:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274198",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:11 klee]:
> Currently doctests for Sage optional packages, if installed on the system, are automatically run only if "--optional" is given.


I don't think this is correct. When I run doctests without any extra flags, I see (after installing a few optional packages for testing purposes)

```
$ sage -tp src/sage/homology/
...
Using --optional=ccache,database_gap,gcc,mpir,ore_algebra,python2,sage
...
```



---

archive/issue_comments_274199.json:
```json
{
    "body": "I would prefer \"external\" instead of \"nonpackage\", otherwise the `--optional=nonpackages` has a confusing double negation vibe.",
    "created_at": "2016-03-09T23:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274199",
    "user": "https://github.com/vbraun"
}
```

I would prefer "external" instead of "nonpackage", otherwise the `--optional=nonpackages` has a confusing double negation vibe.



---

archive/issue_comments_274200.json:
```json
{
    "body": "The behavior \"--optional\" tag has changed after the merged ticket: http://trac.sagemath.org/ticket/18558, but the developer's manual seems not updated completely to reflect the changes. The following is from experiments and the documentation. So would you verify my understanding?\n\n(1) \"-t\" : tests all ordinary doctests and also doctests about installed optional packages, in effect equivalent to \"-t --optional=optional\".\n(2) \"-t --optional\": no-op\n(3) \"-t --optional=PKGS\":   only run doctests including one of the \"# optional - xxx\" tags where xxx is listed in PKGS; \n                                     if \"sage\" is listed will also test the standard doctests; \n                                     if \"optional\" is listed will also test all available(installed) optional packages; \n                                     if set to \"all\", then all tests will be run; \nIf this is correct, then\n\n(A)  Via this ticket I want to add one more line to (3):\n\n                                    if \"external\" is listed, then also include all doctests  with \"# optional - xxx\" where xxx is an available external softwares and resources like \"magma\", \"matlab\", \"internet\", \"latex\", etc (basically everything that is not a Sage standard or optional package).\n\n(B) Also we can change (1) to equate \"-t\" to \"-t --optional=optional,external\".\n\nDo you agree?",
    "created_at": "2016-03-10T05:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274200",
    "user": "https://github.com/kwankyu"
}
```

The behavior "--optional" tag has changed after the merged ticket: http://trac.sagemath.org/ticket/18558, but the developer's manual seems not updated completely to reflect the changes. The following is from experiments and the documentation. So would you verify my understanding?

(1) "-t" : tests all ordinary doctests and also doctests about installed optional packages, in effect equivalent to "-t --optional=optional".
(2) "-t --optional": no-op
(3) "-t --optional=PKGS":   only run doctests including one of the "# optional - xxx" tags where xxx is listed in PKGS; 
                                     if "sage" is listed will also test the standard doctests; 
                                     if "optional" is listed will also test all available(installed) optional packages; 
                                     if set to "all", then all tests will be run; 
If this is correct, then

(A)  Via this ticket I want to add one more line to (3):

                                    if "external" is listed, then also include all doctests  with "# optional - xxx" where xxx is an available external softwares and resources like "magma", "matlab", "internet", "latex", etc (basically everything that is not a Sage standard or optional package).

(B) Also we can change (1) to equate "-t" to "-t --optional=optional,external".

Do you agree?



---

archive/issue_comments_274201.json:
```json
{
    "body": "This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details).  Should \"-t --optional\" be equivalent to \"-t\" or is the desired behavior still thus?\n\n```\nsage-runtests: error: --optional option requires an argument\n```",
    "created_at": "2016-03-10T14:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274201",
    "user": "https://github.com/kcrisman"
}
```

This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details).  Should "-t --optional" be equivalent to "-t" or is the desired behavior still thus?

```
sage-runtests: error: --optional option requires an argument
```



---

archive/issue_comments_274202.json:
```json
{
    "body": "Replying to [comment:18 kcrisman]:\n> This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details). \n\n\nAgree. We definitely need to implement a lazy mechanism like that in #13540. I am reading the related codes in Sage.\n\n> Should \"-t --optional\" be equivalent to \"-t\" or is the desired behavior still thus?\n> \n> ```\n> sage-runtests: error: --optional option requires an argument\n> ```\n\n\nOnce we implement \"external\", \"all\" will mean \"sage\"+\"optional\"+\"external\". Then we may set \"-t --optional\" to mean \"-t --optional=all\".",
    "created_at": "2016-03-11T01:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274202",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:18 kcrisman]:
> This seems reasonable to me as a concept (implementation of (B) shouldn't slow things down ridiculously, though, so the devil may be in the details). 


Agree. We definitely need to implement a lazy mechanism like that in #13540. I am reading the related codes in Sage.

> Should "-t --optional" be equivalent to "-t" or is the desired behavior still thus?
> 
> ```
> sage-runtests: error: --optional option requires an argument
> ```


Once we implement "external", "all" will mean "sage"+"optional"+"external". Then we may set "-t --optional" to mean "-t --optional=all".



---

archive/issue_comments_274203.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T07:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274203",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274204.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T11:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274204",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274205.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T15:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274206.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T15:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274207.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T16:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274208.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T16:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274209.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T16:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274209",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274210.json:
```json
{
    "body": "Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?",
    "created_at": "2016-03-11T17:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274210",
    "user": "https://github.com/jdemeyer"
}
```

Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?



---

archive/issue_comments_274211.json:
```json
{
    "body": "If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing\n\n```\nUsing --optional=...,external,...\n```\nit would be nice if it printed\n\n```\nUsing --optional=...,internet,latex,maple,...\n```",
    "created_at": "2016-03-11T18:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274211",
    "user": "https://github.com/jhpalmieri"
}
```

If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing

```
Using --optional=...,external,...
```
it would be nice if it printed

```
Using --optional=...,internet,latex,maple,...
```



---

archive/issue_comments_274212.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-11T22:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274213.json:
```json
{
    "body": "Replying to [comment:29 jdemeyer]:\n> Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?\n\n\nNo. I was not. See the last commit.",
    "created_at": "2016-03-11T22:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274213",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:29 jdemeyer]:
> Why does `LazySet` inherit from `set`? Are you actually using any `set` functionality?


No. I was not. See the last commit.



---

archive/issue_comments_274214.json:
```json
{
    "body": "Replying to [comment:30 jhpalmieri]:\n> If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing\n> \n> ```\n> Using --optional=...,external,...\n> ```\n> it would be nice if it printed\n> \n> ```\n> Using --optional=...,internet,latex,maple,...\n> ```\n\n\nHmmm. It seems possible... But what do you think it means that \"maple\" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? Then this is very different from an optional package, say gcc or mpir, appearing in the list.",
    "created_at": "2016-03-11T22:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274214",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:30 jhpalmieri]:
> If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing
> 
> ```
> Using --optional=...,external,...
> ```
> it would be nice if it printed
> 
> ```
> Using --optional=...,internet,latex,maple,...
> ```


Hmmm. It seems possible... But what do you think it means that "maple" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? Then this is very different from an optional package, say gcc or mpir, appearing in the list.



---

archive/issue_comments_274215.json:
```json
{
    "body": "Replying to [comment:33 klee]:\n> Replying to [comment:30 jhpalmieri]:\n> > If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing\n> > \n> > ```\n> > Using --optional=...,external,...\n> > ```\n> > it would be nice if it printed\n> > \n> > ```\n> > Using --optional=...,internet,latex,maple,...\n> > ```\n\n> \n> Hmmm. It seems possible... But what do you think it means that \"maple\" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? \n\n\nI say no to the last question. I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).",
    "created_at": "2016-03-11T23:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274215",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:33 klee]:
> Replying to [comment:30 jhpalmieri]:
> > If I do `sage -tp --optional=sage,optional,external ...`, then instead of printing
> > 
> > ```
> > Using --optional=...,external,...
> > ```
> > it would be nice if it printed
> > 
> > ```
> > Using --optional=...,internet,latex,maple,...
> > ```

> 
> Hmmm. It seems possible... But what do you think it means that "maple" appears in the list? Does it mean that maple is available and tests depending on it will be tested. This behavior defeats the lazy mechanism. Does it simply mean that any doctests depending on maple will run if maple turns out to be available lazily and not otherwise? 


I say no to the last question. I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).



---

archive/issue_comments_274216.json:
```json
{
    "body": "> I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. \n\n\nBecause of the lazyset mechanism, at least one test was run for an external software detected in most cases. There may be exceptional cases to this, but is this important? By the way, I prefer \"external software\" than \"external package\". Internet is rather a software than a package :-)\n\n\n> I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).\n\n \nI agree. Perhaps we can list the detected softwares at the end of doctesting as you suggested.",
    "created_at": "2016-03-12T05:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274216",
    "user": "https://github.com/kwankyu"
}
```

> I don't know how to balance the laziness with what I'm looking for. Maybe a summary at the *end* of doctesting of which external packages were detected, or (even better) the intersection of those external packages which were detected and those for which a test was run. 


Because of the lazyset mechanism, at least one test was run for an external software detected in most cases. There may be exceptional cases to this, but is this important? By the way, I prefer "external software" than "external package". Internet is rather a software than a package :-)


> I think it is important to provide feedback about this in order to debug failed tests (or slow tests, etc.).

 
I agree. Perhaps we can list the detected softwares at the end of doctesting as you suggested.



---

archive/issue_comments_274217.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-15T04:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274218.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-15T04:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274219.json:
```json
{
    "body": "The latest patch copes with the multiprocessing of Sage doctesting.",
    "created_at": "2016-03-15T04:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274219",
    "user": "https://github.com/kwankyu"
}
```

The latest patch copes with the multiprocessing of Sage doctesting.



---

archive/issue_comments_274220.json:
```json
{
    "body": "This is silly:\n\n```\nraise Exception # should not happen!\n```\n\nReplace it by something like\n\n```\nraise AssertionError(\"invalid value for self.seen\")\n```",
    "created_at": "2016-03-15T07:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274220",
    "user": "https://github.com/jdemeyer"
}
```

This is silly:

```
raise Exception # should not happen!
```

Replace it by something like

```
raise AssertionError("invalid value for self.seen")
```



---

archive/issue_comments_274221.json:
```json
{
    "body": "Can you add a timeout (using `alarm()`) for this:\n\n```\nurllib.request.urlopen(\"http://www.sagemath.org\")\n```",
    "created_at": "2016-03-15T07:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274221",
    "user": "https://github.com/jdemeyer"
}
```

Can you add a timeout (using `alarm()`) for this:

```
urllib.request.urlopen("http://www.sagemath.org")
```



---

archive/issue_comments_274222.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-15T08:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274223.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-15T09:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274223",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274224.json:
```json
{
    "body": "On my computer, doctesting the file `external.py` causes two windows to open up, showing the results from `view('2+3')`. Try to find another way to test whether latex is present and functional, maybe something like this:\n\n```diff\ndiff --git a/src/sage/doctest/external.py b/src/sage/doctest/external.py\nindex f05bc8d..463413a 100644\n--- a/src/sage/doctest/external.py\n+++ b/src/sage/doctest/external.py\n@@ -59,9 +59,14 @@ def has_latex():\n         sage: has_latex() # random\n         True\n     \"\"\"\n-    from sage.misc.latex import view\n+    from sage.misc.latex import _run_latex_, _latex_file_\n+    from sage.misc.temporary_file import tmp_filename\n     try:\n-        view('2+3')\n+        f = tmp_filename(ext='.tex')\n+        O = open(f, 'w')\n+        O.write(_latex_file_('3'))\n+        O.close()\n+        _run_latex_(f)\n         return True\n     except Exception:\n         return False\n```\n\nAlso, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.",
    "created_at": "2016-03-15T22:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274224",
    "user": "https://github.com/jhpalmieri"
}
```

On my computer, doctesting the file `external.py` causes two windows to open up, showing the results from `view('2+3')`. Try to find another way to test whether latex is present and functional, maybe something like this:

```diff
diff --git a/src/sage/doctest/external.py b/src/sage/doctest/external.py
index f05bc8d..463413a 100644
--- a/src/sage/doctest/external.py
+++ b/src/sage/doctest/external.py
@@ -59,9 +59,14 @@ def has_latex():
         sage: has_latex() # random
         True
     """
-    from sage.misc.latex import view
+    from sage.misc.latex import _run_latex_, _latex_file_
+    from sage.misc.temporary_file import tmp_filename
     try:
-        view('2+3')
+        f = tmp_filename(ext='.tex')
+        O = open(f, 'w')
+        O.write(_latex_file_('3'))
+        O.close()
+        _run_latex_(f)
         return True
     except Exception:
         return False
```

Also, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.



---

archive/issue_comments_274225.json:
```json
{
    "body": "Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?",
    "created_at": "2016-03-15T23:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274225",
    "user": "https://github.com/jhpalmieri"
}
```

Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?



---

archive/issue_comments_274226.json:
```json
{
    "body": "> Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?\n\n\nYes.  Like #16302.  Are the ones (OEIS) in #16252 at least still fixed?",
    "created_at": "2016-03-16T02:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274226",
    "user": "https://github.com/kcrisman"
}
```

> Also, I'm getting a lot of failed `internet` doctests, and some for `latex`, too. If we enable testing those by default, Sage won't pass doctests anymore. They need to be fixed: on separate tickets?


Yes.  Like #16302.  Are the ones (OEIS) in #16252 at least still fixed?



---

archive/issue_comments_274227.json:
```json
{
    "body": "I had to make this change in `oeis.py` to fix one failure:\n\n```diff\ndiff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py\nindex ff88286..b8de905 100644\n--- a/src/sage/databases/oeis.py\n+++ b/src/sage/databases/oeis.py\n@@ -841,7 +841,7 @@ class OEISSequence(SageObject):\n             A000045: Fibonacci numbers: F(n) = F(n-1) + F(n-2) with F(0) = 0 and F(1) = 1.\n \n             sage: f.keywords()                          # optional -- internet\n-            ('core', 'nonn', 'nice', 'easy', 'hear')\n+            ('core', 'nonn', 'nice', 'easy', 'hear', 'changed')\n \n         TESTS::\n \n```",
    "created_at": "2016-03-16T02:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274227",
    "user": "https://github.com/jhpalmieri"
}
```

I had to make this change in `oeis.py` to fix one failure:

```diff
diff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py
index ff88286..b8de905 100644
--- a/src/sage/databases/oeis.py
+++ b/src/sage/databases/oeis.py
@@ -841,7 +841,7 @@ class OEISSequence(SageObject):
             A000045: Fibonacci numbers: F(n) = F(n-1) + F(n-2) with F(0) = 0 and F(1) = 1.
 
             sage: f.keywords()                          # optional -- internet
-            ('core', 'nonn', 'nice', 'easy', 'hear')
+            ('core', 'nonn', 'nice', 'easy', 'hear', 'changed')
 
         TESTS::
 
```



---

archive/issue_comments_274228.json:
```json
{
    "body": "I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.",
    "created_at": "2016-03-16T02:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274228",
    "user": "https://github.com/jhpalmieri"
}
```

I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.



---

archive/issue_comments_274229.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-16T05:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274229",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274230.json:
```json
{
    "body": "Replying to [comment:43 jhpalmieri]:\n\n> Also, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.\n\n\nFor this ticket, I will stop at providing the framework for tests requiring external softwares.  Thus\n\n(1) Any expert is cordially invited to contribute commits for better and new `has_xxx` tester for the software `xxx`.\n\n(2) Turning on `external` by default should be dealt with in another ticket.\n\n(3) Fixing all doctest failures that result from changing the default should be dealt with separate tickets.",
    "created_at": "2016-03-16T05:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274230",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:43 jhpalmieri]:

> Also, you might consider adding `ImageMagick` (and in particular the `convert` command) to the set of external programs to be tested.


For this ticket, I will stop at providing the framework for tests requiring external softwares.  Thus

(1) Any expert is cordially invited to contribute commits for better and new `has_xxx` tester for the software `xxx`.

(2) Turning on `external` by default should be dealt with in another ticket.

(3) Fixing all doctest failures that result from changing the default should be dealt with separate tickets.



---

archive/issue_comments_274231.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-16T07:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274232.json:
```json
{
    "body": "Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`",
    "created_at": "2016-03-16T08:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274232",
    "user": "https://github.com/jdemeyer"
}
```

Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`



---

archive/issue_comments_274233.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-16T09:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274233",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274234.json:
```json
{
    "body": "Replying to [comment:51 jdemeyer]:\n> Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`\n\n\nDone. What about `make (p)testoptional(long)`? Perhaps `--optional=sage,optional`?",
    "created_at": "2016-03-16T09:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274234",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:51 jdemeyer]:
> Or perhaps you should indeed define `make (p)testall(long)` to use `--optional=sage,optional,external`


Done. What about `make (p)testoptional(long)`? Perhaps `--optional=sage,optional`?



---

archive/issue_comments_274235.json:
```json
{
    "body": "> I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.\n\n\nAgreed.  (In your example, presumably `'core' in f.keywords()` would be better?)  But I also think we *must* enable the internet testing within some framework people will test relatively often - if `make testall` is that place, that's fine.  Otherwise untested is broken - between OEIS and some of the timeseries stuff there is probably a lot eventually broken.",
    "created_at": "2016-03-16T12:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274235",
    "user": "https://github.com/kcrisman"
}
```

> I think that the `internet` doctests have to be robust enough that if an external website changes something, our tests will still pass. I tried to argue for this at #16252, but there was disagreement. I think it's either that or we don't enable `internet` testing by default.


Agreed.  (In your example, presumably `'core' in f.keywords()` would be better?)  But I also think we *must* enable the internet testing within some framework people will test relatively often - if `make testall` is that place, that's fine.  Otherwise untested is broken - between OEIS and some of the timeseries stuff there is probably a lot eventually broken.



---

archive/issue_comments_274236.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-17T00:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274236",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274237.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-17T00:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274237",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_events_054847.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-03-22T01:24:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-54847"
}
```



---

archive/issue_comments_274238.json:
```json
{
    "body": "Why the patchbot is not working on this ticket? Since I made changes on `Makefile`?",
    "created_at": "2016-03-25T02:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274238",
    "user": "https://github.com/kwankyu"
}
```

Why the patchbot is not working on this ticket? Since I made changes on `Makefile`?



---

archive/issue_comments_274239.json:
```json
{
    "body": "I am working on a more generic way of checking for features of the system (including nice error messages) at #20382. klee: What do you think about it? You could potentially rebase your code to use the features there or I could do that once #20182 got merged.",
    "created_at": "2016-04-11T02:18:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274239",
    "user": "https://github.com/saraedum"
}
```

I am working on a more generic way of checking for features of the system (including nice error messages) at #20382. klee: What do you think about it? You could potentially rebase your code to use the features there or I could do that once #20182 got merged.



---

archive/issue_comments_274240.json:
```json
{
    "body": "As this ticket is related to #20382, but independent from it. I think this ticket could be reviewed and merged independently, though still no one bothers reviewing it. Then I would be happy that you open a new ticket to use your features once #20382 got merged.\n\nIf #20382 is merged first, then I would also be very happy that you rebase this ticket to #20382.",
    "created_at": "2016-04-11T07:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274240",
    "user": "https://github.com/kwankyu"
}
```

As this ticket is related to #20382, but independent from it. I think this ticket could be reviewed and merged independently, though still no one bothers reviewing it. Then I would be happy that you open a new ticket to use your features once #20382 got merged.

If #20382 is merged first, then I would also be very happy that you rebase this ticket to #20382.



---

archive/issue_comments_274241.json:
```json
{
    "body": "This doctest should be marked \"random\":\n\n```\n        sage: available_softwares.seen()\n        ['internet', 'latex', 'magma']\n```\nAlso, throughout, \"softwares\" should be \"software\" -- \"which software do you have installed\" is correct, for example, not \"which softwares do you have installed\".",
    "created_at": "2016-04-12T16:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274241",
    "user": "https://github.com/jhpalmieri"
}
```

This doctest should be marked "random":

```
        sage: available_softwares.seen()
        ['internet', 'latex', 'magma']
```
Also, throughout, "softwares" should be "software" -- "which software do you have installed" is correct, for example, not "which softwares do you have installed".



---

archive/issue_comments_274242.json:
```json
{
    "body": "What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. Anyone else have opinions? \n\nFor example:\n\n```\nsage -t src/sage/plot/graphics.py\n**********************************************************************\nFile \"src/sage/plot/graphics.py\", line 1624, in sage.plot.graphics.Graphics.show\nFailed example:\n    plot(x, typeset='latex') # optional - latex\nExpected nothing\nGot:\n    Graphics object consisting of 1 graphics primitive\n**********************************************************************\nFile \"src/sage/plot/graphics.py\", line 1630, in sage.plot.graphics.Graphics.show\nFailed example:\n    plot(x, typeset='type1') # optional - latex\nExpected nothing\nGot:\n    Graphics object consisting of 1 graphics primitive\n**********************************************************************\n1 item had failures:\n   2 of  87 in sage.plot.graphics.Graphics.show\n```\nI get this at the end of `make ptestall`:\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/plot/graphics.py  # 2 doctests failed\nsage -t src/sage/plot/plot.py  # 1 doctest failed\nsage -t src/sage/arith/misc.py  # 1 doctest failed\nsage -t src/sage/tests/cmdline.py  # 1 doctest failed\nsage -t src/sage/dev/sagedev.py  # 2 doctests failed\nsage -t src/sage/structure/sage_object.pyx  # 2 doctests failed\nsage -t src/sage/combinat/designs/bibd.py  # 1 doctest failed\nsage -t src/sage/misc/package.py  # 6 doctests failed\nsage -t src/sage/doctest/external.py  # 1 doctest failed\nsage -t src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed\nsage -t src/sage/dev/trac_interface.py  # 5 doctests failed\nsage -t src/sage/repl/load.py  # 2 doctests failed\nsage -t src/doc/en/developer/coding_basics.rst  # 1 doctest failed\nsage -t src/sage/dev/patch.py  # 3 doctests failed\nsage -t src/sage/databases/oeis.py  # 2 doctests failed\nsage -t src/sage/combinat/integer_lists/invlex.pyx  # 1 doctest failed\nsage -t src/sage/dev/digest_transport.py  # 1 doctest failed\nsage -t src/sage/finance/stock.py  # 2 doctests failed\nsage -t src/sage/misc/remote_file.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 1929.7 seconds\n    cpu time: 3833.1 seconds\n    cumulative wall time: 7184.9 seconds\nExternal softwares detected for doctesting: internet,latex\n```",
    "created_at": "2016-04-12T18:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274242",
    "user": "https://github.com/jhpalmieri"
}
```

What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. Anyone else have opinions? 

For example:

```
sage -t src/sage/plot/graphics.py
**********************************************************************
File "src/sage/plot/graphics.py", line 1624, in sage.plot.graphics.Graphics.show
Failed example:
    plot(x, typeset='latex') # optional - latex
Expected nothing
Got:
    Graphics object consisting of 1 graphics primitive
**********************************************************************
File "src/sage/plot/graphics.py", line 1630, in sage.plot.graphics.Graphics.show
Failed example:
    plot(x, typeset='type1') # optional - latex
Expected nothing
Got:
    Graphics object consisting of 1 graphics primitive
**********************************************************************
1 item had failures:
   2 of  87 in sage.plot.graphics.Graphics.show
```
I get this at the end of `make ptestall`:

```
----------------------------------------------------------------------
sage -t src/sage/plot/graphics.py  # 2 doctests failed
sage -t src/sage/plot/plot.py  # 1 doctest failed
sage -t src/sage/arith/misc.py  # 1 doctest failed
sage -t src/sage/tests/cmdline.py  # 1 doctest failed
sage -t src/sage/dev/sagedev.py  # 2 doctests failed
sage -t src/sage/structure/sage_object.pyx  # 2 doctests failed
sage -t src/sage/combinat/designs/bibd.py  # 1 doctest failed
sage -t src/sage/misc/package.py  # 6 doctests failed
sage -t src/sage/doctest/external.py  # 1 doctest failed
sage -t src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed
sage -t src/sage/dev/trac_interface.py  # 5 doctests failed
sage -t src/sage/repl/load.py  # 2 doctests failed
sage -t src/doc/en/developer/coding_basics.rst  # 1 doctest failed
sage -t src/sage/dev/patch.py  # 3 doctests failed
sage -t src/sage/databases/oeis.py  # 2 doctests failed
sage -t src/sage/combinat/integer_lists/invlex.pyx  # 1 doctest failed
sage -t src/sage/dev/digest_transport.py  # 1 doctest failed
sage -t src/sage/finance/stock.py  # 2 doctests failed
sage -t src/sage/misc/remote_file.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 1929.7 seconds
    cpu time: 3833.1 seconds
    cumulative wall time: 7184.9 seconds
External softwares detected for doctesting: internet,latex
```



---

archive/issue_comments_274243.json:
```json
{
    "body": "minor remark: there is a timeout optional argument for `urlopen` (that will gives you a `URLError` in case of failure). And in this particular test, why are you catching `Exception`?",
    "created_at": "2016-04-12T23:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274243",
    "user": "https://github.com/videlec"
}
```

minor remark: there is a timeout optional argument for `urlopen` (that will gives you a `URLError` in case of failure). And in this particular test, why are you catching `Exception`?



---

archive/issue_comments_274244.json:
```json
{
    "body": "Replying to [comment:62 jhpalmieri]:\n> What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. \n\n\nThis patch can be safely merged as long as the patchbot and the people checking a new Sage release use `make ptestlong`,  which I think is the current practice. Then we need to open a ticket for the failing doctests for each external software, before we at some point switch to use `make ptestall` for a new release.",
    "created_at": "2016-04-13T06:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274244",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:62 jhpalmieri]:
> What should happen with failing doctests? klee's opinion is that they should be fixed on another ticket. I guess that's okay as long as they are not run by default. 


This patch can be safely merged as long as the patchbot and the people checking a new Sage release use `make ptestlong`,  which I think is the current practice. Then we need to open a ticket for the failing doctests for each external software, before we at some point switch to use `make ptestall` for a new release.



---

archive/issue_comments_274245.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-13T08:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274246.json:
```json
{
    "body": "Every function and method needs documentation and doctests.\n\n```\n$ sage --coverage src/sage/doctest/external.py \n------------------------------------------------------------------------\nSCORE src/sage/doctest/external.py: 64.7% (11 of 17)\n\nMissing documentation:\n     * line 272: def __init__(self)\n     * line 277: def __contains__(self, item)\n\nMissing doctests:\n     * line 224: def external_software()\n     * line 236: def _lookup(software)\n     * line 294: def issuperset(self, other)\n     * line 303: def seen(self)\n------------------------------------------------------------------------\n```",
    "created_at": "2016-04-13T15:09:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274246",
    "user": "https://github.com/jhpalmieri"
}
```

Every function and method needs documentation and doctests.

```
$ sage --coverage src/sage/doctest/external.py 
------------------------------------------------------------------------
SCORE src/sage/doctest/external.py: 64.7% (11 of 17)

Missing documentation:
     * line 272: def __init__(self)
     * line 277: def __contains__(self, item)

Missing doctests:
     * line 224: def external_software()
     * line 236: def _lookup(software)
     * line 294: def issuperset(self, other)
     * line 303: def seen(self)
------------------------------------------------------------------------
```



---

archive/issue_comments_274247.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-14T01:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274248.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-18T20:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274248",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274249.json:
```json
{
    "body": "Here are a few minor rewordings. The only possibly significant change is removing \"# random\" from one doctest, but the same thing is doctested later in the same file (in `AvailableSoftware`) without that marking.\n\nI am happy with this now. Does anyone else have any comments?",
    "created_at": "2016-04-18T20:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274249",
    "user": "https://github.com/jhpalmieri"
}
```

Here are a few minor rewordings. The only possibly significant change is removing "# random" from one doctest, but the same thing is doctested later in the same file (in `AvailableSoftware`) without that marking.

I am happy with this now. Does anyone else have any comments?



---

archive/issue_comments_274250.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-19T00:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_274251.json:
```json
{
    "body": "The list \"external_software\" should not be random. For convenience of later modification, I changed one of the duplicate doctests. Thank you for elaborate review!",
    "created_at": "2016-04-19T00:32:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274251",
    "user": "https://github.com/kwankyu"
}
```

The list "external_software" should not be random. For convenience of later modification, I changed one of the duplicate doctests. Thank you for elaborate review!



---

archive/issue_comments_274252.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-25T17:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274252",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_054848.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-26T12:58:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20182#event-54848"
}
```



---

archive/issue_comments_274253.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-26T12:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20182",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20182#issuecomment-274253",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
