# Issue 20370: generic GCD-free basis

archive/issues_020133.json:
```json
{
    "body": "\n\nBranch/Commit: 49660c68deb9f70de6772a383c1dd8845c9e74ce\n\nReviewer: Bruno Grenet\n\nAuthor: Marc Mezzarobba\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/20370\n\n",
    "closed_at": "2016-05-19T22:38:59Z",
    "created_at": "2016-04-06T12:12:53Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "generic GCD-free basis",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20370",
    "user": "https://github.com/mezzarobba"
}
```


Branch/Commit: 49660c68deb9f70de6772a383c1dd8845c9e74ce

Reviewer: Bruno Grenet

Author: Marc Mezzarobba

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/20370





---

archive/issue_comments_369632.json:
```json
{
    "body": "Changing commit from \"\" to \"a0a246ad399f4e2bd9c69d32e91fd8de1321c7fa\"",
    "created_at": "2016-04-06T12:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369632",
    "user": "https://github.com/mezzarobba"
}
```

Changing commit from "" to "a0a246ad399f4e2bd9c69d32e91fd8de1321c7fa"



---

archive/issue_comments_369633.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mmezzarobba/20370-gcd_free_basis\"",
    "created_at": "2016-04-06T12:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369633",
    "user": "https://github.com/mezzarobba"
}
```

Changing branch from "" to "u/mmezzarobba/20370-gcd_free_basis"



---

archive/issue_comments_369634.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-06T12:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369634",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_369635.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2016-04-06T12:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369635",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_369636.json:
```json
{
    "body": "Changing author from \"\" to \"Marc Mezzarobba\"",
    "created_at": "2016-04-06T12:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369636",
    "user": "https://github.com/mezzarobba"
}
```

Changing author from "" to "Marc Mezzarobba"



---

archive/issue_comments_369637.json:
```json
{
    "body": "<a id='comment:2'></a>Salut Marc ! I have doubts concerning the return type of this new function. First, I always wonder one should use Python's `set` or Sage's `Set`. But also I wonder whether these bases should be returned as sets: In all cases I've found (\u2260 all cases, probably), bases are returned as lists (or `PolynomialSequence_generic` for polynomials) and not sets. Wouldn't it be more consistent to return a list there too?",
    "created_at": "2016-04-18T09:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369637",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:2'></a>Salut Marc ! I have doubts concerning the return type of this new function. First, I always wonder one should use Python's `set` or Sage's `Set`. But also I wonder whether these bases should be returned as sets: In all cases I've found (≠ all cases, probably), bases are returned as lists (or `PolynomialSequence_generic` for polynomials) and not sets. Wouldn't it be more consistent to return a list there too?



---

archive/issue_comments_369638.json:
```json
{
    "body": "<a id='comment:3'></a>Hi Bruno,\n\nReplying to [bruno](#comment%3A2):\n> Salut Marc ! I have doubts concerning the return type of this new function. First, I always wonder one should use Python's `set` or Sage's `Set`. But also I wonder whether these bases should be returned as sets: In all cases I've found (\u2260 all cases, probably), bases are returned as lists (or `PolynomialSequence_generic` for polynomials) and not sets. Wouldn't it be more consistent to return a list there too?\n\n\nThanks for your comment. I have no opinion on the matter, and I'd be happy to change the return type to whatever you prefer.",
    "created_at": "2016-04-18T11:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369638",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:3'></a>Hi Bruno,

Replying to [bruno](#comment%3A2):
> Salut Marc ! I have doubts concerning the return type of this new function. First, I always wonder one should use Python's `set` or Sage's `Set`. But also I wonder whether these bases should be returned as sets: In all cases I've found (≠ all cases, probably), bases are returned as lists (or `PolynomialSequence_generic` for polynomials) and not sets. Wouldn't it be more consistent to return a list there too?


Thanks for your comment. I have no opinion on the matter, and I'd be happy to change the return type to whatever you prefer.



---

archive/issue_comments_369639.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [mmezzarobba](#comment%3A3):\n> Hi Bruno,\n> \n> Replying to [bruno](#comment%3A2):\n> > Salut Marc ! I have doubts concerning the return type of this new function. First, I always wonder one should use Python's `set` or Sage's `Set`. But also I wonder whether these bases should be returned as sets: In all cases I've found (\u2260 all cases, probably), bases are returned as lists (or `PolynomialSequence_generic` for polynomials) and not sets. Wouldn't it be more consistent to return a list there too?\n\n> \n> Thanks for your comment. I have no opinion on the matter, and I'd be happy to change the return type to whatever you prefer.\n\n\nI propose you to return a `Sequence` with `universe=self`. \n\nAnother (minor) point: If the elements in the sequence do not belong to `self`, the exception is not very clear. For instance:\n\n```python\nsage: R.<x> = QQ[]\nsage: QQ.gcd_free_basis([x+1,x+2])\nTraceback (most recent call last):\n...\nTypeError: not a constant polynomial\n```\n\nYou may catch the exception and raise your own `TypeError: the elements you provided do not belong to QQ` (or something similar). Actually I ran into the exact example I paste above...\n\nApart from this remarks, this looks good to me!",
    "created_at": "2016-04-19T08:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369639",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:4'></a>Replying to [mmezzarobba](#comment%3A3):
> Hi Bruno,
> 
> Replying to [bruno](#comment%3A2):
> > Salut Marc ! I have doubts concerning the return type of this new function. First, I always wonder one should use Python's `set` or Sage's `Set`. But also I wonder whether these bases should be returned as sets: In all cases I've found (≠ all cases, probably), bases are returned as lists (or `PolynomialSequence_generic` for polynomials) and not sets. Wouldn't it be more consistent to return a list there too?

> 
> Thanks for your comment. I have no opinion on the matter, and I'd be happy to change the return type to whatever you prefer.


I propose you to return a `Sequence` with `universe=self`. 

Another (minor) point: If the elements in the sequence do not belong to `self`, the exception is not very clear. For instance:

```python
sage: R.<x> = QQ[]
sage: QQ.gcd_free_basis([x+1,x+2])
Traceback (most recent call last):
...
TypeError: not a constant polynomial
```

You may catch the exception and raise your own `TypeError: the elements you provided do not belong to QQ` (or something similar). Actually I ran into the exact example I paste above...

Apart from this remarks, this looks good to me!



---

archive/issue_comments_369640.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-05-18T08:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369641.json:
```json
{
    "body": "Changing commit from \"a0a246ad399f4e2bd9c69d32e91fd8de1321c7fa\" to \"e0895632b8cc12e990f859dbdbb0d086601a6afe\"",
    "created_at": "2016-05-18T08:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369641",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a0a246ad399f4e2bd9c69d32e91fd8de1321c7fa" to "e0895632b8cc12e990f859dbdbb0d086601a6afe"



---

archive/issue_comments_369642.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [bruno](#comment%3A4):\n> I propose you to return a `Sequence` with `universe=self`. \n\n\nDone.\n\n> You may catch the exception and raise your own `TypeError: the elements you provided do not belong to QQ` (or something similar). Actually I ran into the exact example I paste above...\n\n\nI improved `Sequence()` itself instead. Of course, I can move the corresponding commits to another ticket if you don't feel like reviewing them.",
    "created_at": "2016-05-18T09:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369642",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:6'></a>Replying to [bruno](#comment%3A4):
> I propose you to return a `Sequence` with `universe=self`. 


Done.

> You may catch the exception and raise your own `TypeError: the elements you provided do not belong to QQ` (or something similar). Actually I ran into the exact example I paste above...


I improved `Sequence()` itself instead. Of course, I can move the corresponding commits to another ticket if you don't feel like reviewing them.



---

archive/issue_comments_369643.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [mmezzarobba](#comment%3A6):\n> > You may catch the exception and raise your own `TypeError: the elements you provided do not belong to QQ` (or something similar). Actually I ran into the exact example I paste above...\n\n> \n> I improved `Sequence()` itself instead. Of course, I can move the corresponding commits to another ticket if you don't feel like reviewing them.\n\n\nI would prefer another ticket: As it is, if you remove the commits about `Sequence()`, I am ready to set it to positive review. I am much less confident on the code involving `Sequence` and need more time (or another reviewer...)!\n\nA comment still on the `Sequence()` part: Should'nt the error message explicitly mention that there is a conflict with the universe? Something like \n`unable to convert {} to an element of the universe ({})\".format(x[i], universe))`",
    "created_at": "2016-05-18T13:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369643",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:7'></a>Replying to [mmezzarobba](#comment%3A6):
> > You may catch the exception and raise your own `TypeError: the elements you provided do not belong to QQ` (or something similar). Actually I ran into the exact example I paste above...

> 
> I improved `Sequence()` itself instead. Of course, I can move the corresponding commits to another ticket if you don't feel like reviewing them.


I would prefer another ticket: As it is, if you remove the commits about `Sequence()`, I am ready to set it to positive review. I am much less confident on the code involving `Sequence` and need more time (or another reviewer...)!

A comment still on the `Sequence()` part: Should'nt the error message explicitly mention that there is a conflict with the universe? Something like 
`unable to convert {} to an element of the universe ({})".format(x[i], universe))`



---

archive/issue_comments_369644.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-05-18T13:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369644",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369645.json:
```json
{
    "body": "Changing commit from \"e0895632b8cc12e990f859dbdbb0d086601a6afe\" to \"49660c68deb9f70de6772a383c1dd8845c9e74ce\"",
    "created_at": "2016-05-18T13:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e0895632b8cc12e990f859dbdbb0d086601a6afe" to "49660c68deb9f70de6772a383c1dd8845c9e74ce"



---

archive/issue_comments_369646.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-18T13:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369646",
    "user": "https://github.com/bgrenet"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_369647.json:
```json
{
    "body": "<a id='comment:9'></a>Looks good to me!",
    "created_at": "2016-05-18T13:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369647",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:9'></a>Looks good to me!



---

archive/issue_comments_369648.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Bruno Grenet\"",
    "created_at": "2016-05-18T13:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369648",
    "user": "https://github.com/bgrenet"
}
```

Changing reviewer from "" to "Bruno Grenet"



---

archive/issue_comments_369649.json:
```json
{
    "body": "Changing reviewer from \"Bruno Grenet\" to \"\"",
    "created_at": "2016-05-18T13:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369649",
    "user": "https://github.com/mezzarobba"
}
```

Changing reviewer from "Bruno Grenet" to ""



---

archive/issue_comments_369650.json:
```json
{
    "body": "<a id='comment:11'></a>Thanks for the review!\n\nReplying to [bruno](#comment%3A7):\n> I would prefer another ticket: As it is, if you remove the commits about `Sequence()`, I am ready to set it to positive review. I am much less confident on the code involving `Sequence` and need more time (or another reviewer...)!\n\n\nDone (#20621).\n\n> A comment still on the `Sequence()` part: Should'nt the error message explicitly mention that there is a conflict with the universe? Something like \n> `unable to convert {} to an element of the universe ({})\".format(x[i], universe))` \n\n\nI don't think so: when `Sequence()` is used internally by another function (e.g. in the present case), it will be clear that the function needs to somehow convert some elements to a given parent, but it doesn't matter that this parent is the universe of some Sequence (and that may even make the error more confusing to casual users)...",
    "created_at": "2016-05-18T13:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369650",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:11'></a>Thanks for the review!

Replying to [bruno](#comment%3A7):
> I would prefer another ticket: As it is, if you remove the commits about `Sequence()`, I am ready to set it to positive review. I am much less confident on the code involving `Sequence` and need more time (or another reviewer...)!


Done (#20621).

> A comment still on the `Sequence()` part: Should'nt the error message explicitly mention that there is a conflict with the universe? Something like 
> `unable to convert {} to an element of the universe ({})".format(x[i], universe))` 


I don't think so: when `Sequence()` is used internally by another function (e.g. in the present case), it will be clear that the function needs to somehow convert some elements to a given parent, but it doesn't matter that this parent is the universe of some Sequence (and that may even make the error more confusing to casual users)...



---

archive/issue_comments_369651.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Bruno Grenet\"",
    "created_at": "2016-05-18T13:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369651",
    "user": "https://github.com/mezzarobba"
}
```

Changing reviewer from "" to "Bruno Grenet"



---

archive/issue_events_055197.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-19T22:38:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20370#event-55197"
}
```



---

archive/issue_comments_369652.json:
```json
{
    "body": "Changing branch from \"u/mmezzarobba/20370-gcd_free_basis\" to \"49660c68deb9f70de6772a383c1dd8845c9e74ce\"",
    "created_at": "2016-05-19T22:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369652",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mmezzarobba/20370-gcd_free_basis" to "49660c68deb9f70de6772a383c1dd8845c9e74ce"



---

archive/issue_comments_369653.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-19T22:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20370",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20370#issuecomment-369653",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
