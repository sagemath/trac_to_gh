# Issue 23857: Effective Resistance for Graphs

Issue created by migration from Trac.

Original creator: afrancis

Original creation time: 2017-10-24 00:29:16

Keywords: effective resistance, resitance distance, graphs, link prediction, sd90

Calculate effective resistances between pairs of nodes in a graph. 


---

Comment by git created at 2017-10-24 22:13:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-10-24 23:02:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by afrancis created at 2017-10-24 23:05:49

Changing status from new to needs_review.


---

Comment by dcoudert created at 2017-10-25 07:57:05

Changing status from needs_review to needs_work.


---

Comment by dcoudert created at 2017-10-25 07:57:05

Welcome to Sagemath.

I have several comments on your ticket, some on the presentation and some on the algorithms you use.

Let's start with general comments, mostly on the presentation. I give them for the first method, but you should do the same for the other methods.
- `effective_resistance(self,i,j)` -> `effective_resistance(self, i, j)`
- `Returns the effective resistance between nodes i and j` -> `Return the effective resistance between nodes `i` and `j`.`
- Please add a description of the notion of effective resistance. What is it?
- You could add a link to the wikipedia page (e.g., in the seealso block). Should be `See :wikipedia:`Resistance_distance`` for more details
- Text lines (comments, definition, etc. must be in 80 columns format. Some code editors like emacs help you to do that without effort

- `a straight linear 2-tree on 6 vertices`. Well, I assume it's a Path graph of order 6, no?
- then you can use: `G1 = graphs.PathGraph(6)`
- replace `G1` with `G` since you don't have `G2`

- in the test with the complete graph, you check only 1 edge. I assume you want to should that the resistance of each edge is `1/2`, right? so you could do instead:

```
sage: G = graphs.CompleteGraph(4)
sage: all(G.effective_resistance(u, v) == 1/2 for u,v in G.edge_iterator(labels=0))
True
```

- Since I'm not familiar with this definition, it is not easy to tell which tests are important or not.
- Could you tell us what is the expected behavior if the graph has loops, multiple edges, is empty, is not connected ?

We will get to the algorithmic part latter. I need to understand the definition first. I have the feeling that we can do something faster, may be in another ticket.


---

Comment by git created at 2017-10-25 20:37:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by afrancis created at 2017-10-25 21:06:56

Thanks for your very helpful comments! I think I made all the presentation changes you submitted

>a straight linear 2-tree on 6 vertices. Well, I assume it's a Path graph of order 6, no? then you can use: G1 = graphs.PathGraph(6)

No, a straight linear 2-tree is like a ladder made out of triangles, not a path. 

>Since I'm not familiar with this definition, it is not easy to tell which tests are important or not.
>Could you tell us what is the expected behavior if the graph has loops, multiple edges, is empty, is not connected ?

Multiple edges should lower the effective resistance between pairs of nodes. A 'parallel' network transformation demonstrates how this works, but this is another method we are working on implementing at this Sagedays!

An empty graph has no node pairs, so an error should be returned for effective_resistance, and an empty matrix for effective_resistance_matrix. 

I hadn't thought about connected graphs.  Effective resistance between edges in different components should be infinity or return an error.  I'll work on that. Also, loops should not be allowed.  I'll fix that as well. 

>We will get to the algorithmic part latter. I need to understand the definition first. I have the feeling that we can do something faster, may be in another ticket.

Interesting, I would be happy to find out that this is true!


---

Comment by dcoudert created at 2017-10-25 21:53:52

In the description of the method, use ``i`` instead of just `i`. This indicates that this is math code. It will be handled when generating the html documentation and so well displayed. You can also put latex equations if you like (e.g., `\sqrt{x^3+1} \leq 2`).

For wikipedia links, the `_` in `:wikipedia:`Resistance_Distance`` is needed. If corresponds to the name of the page you see in the url [https://en.wikipedia.org/wiki/Resistance_distance](https://en.wikipedia.org/wiki/Resistance_distance)

When you have parameters with default value, don't put spaces. So `def effective_resistance_matrix(self, nonedgesonly = True):` -> `def effective_resistance_matrix(self, nonedgesonly=True):`. The same when you call the method.

`if ``True`` eliminate pairs of adjacent vertices`. Well, you don't eliminate pairs, you assign them value 0. It's different, no?

I prefer `self.order()` to `self.num_verts()`.


For `least_effective_resistance`, you should rewrite like that (should be much faster).

```
    self._scream_if_not_simple()
    if nonedgesonly and self.is_clique():
        return []
    S = self.effective_resistance_matrix(nonedgesonly=nonedgesonly)
    if nonedgesonly:
        edges = self.complement().edges(labels=0)
    else:
        edges = [(i,j) for i in range(n) for j in range(i+1,n)]
    rmin = min(S[e] for e in edges)
    return [e for e in edges if S[e] == rmin]
```

The `self._scream_if_not_simple()` will raise an error if the graph has loops or multiple edges. You don't need to add specific tests for that.

For `effective_resistance(self, i, j):`, you have to decide of what to do when `i == j` and you should check `if not i in self or not j in self:`. 

The case of non connected should be treated at some point. 
- method 1: if not in same component return `+oo` or 0. Otherwise, do computation only on that component
- method 2: you can certainly build the matrix from the results on each connected components
- method 3: You can do computations independently on each components and collect the result (faster than working on a big matrix)


---

Comment by dcoudert created at 2017-10-25 21:57:31

you can also decide that the graph must be connected. I don't know what is best.


---

Comment by @rajat1433 created at 2019-03-09 05:42:00

According to wikipedia definition:
In graph theory, the resistance distance between two vertices of a simple connected graph, G, is equal to the resistance between two equivalent points on an electrical network, constructed so as to correspond to G, with each edge being replaced by a 1 ohm resistance. It is a metric on graphs. 

It assumes graph to be simple and connected, so I guess we can do the same here.

Can I work further on this ticket, if nobody else is working based on the proposed changes in the review above?


---

Comment by dcoudert created at 2019-03-09 08:25:15

Yes, you can.


---

Comment by @rajat1433 created at 2019-03-09 08:35:08

Set assignee to @rajat1433.
