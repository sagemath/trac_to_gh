# Issue 21212: CoinBackend: _test_solve fails on 32-bit

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2016-09-08 11:16:59

CC:  mkoeppe

On `Linux arando 3.13.0-95-generic #142-Ubuntu SMP Fri Aug 12 17:05:16 UTC 2016 i686 i686 i686 GNU/Linux`:

```
**********************************************************************
File "src/sage/numerical/backends/coin_backend.pyx", line 39, in sage.numerical.backends.coin_backend.CoinBackend
Failed example:
    TestSuite(p).run(skip="_test_pickling")               # optional - cbc
Expected nothing
Got:
    Failure in _test_solve:
    Traceback (most recent call last):
      File "/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/numerical/backends/generic_backend.pyx", line 697, in sage.numerical.backends.generic_backend.GenericBackend._test_solve (build/cythonized/sage/numerical/backends/generic_backend.c:8748)
        with tester.assertRaises(MIPSolverException) as cm:   # unbounded
      File "/home/jdemeyer/sage-git/local/lib/python/unittest/case.py", line 116, in __exit__
        "{0} not raised".format(exc_name))
    AssertionError: MIPSolverException not raised
    ------------------------------------------------------------
    The following tests failed: _test_solve
**********************************************************************
```



---

Comment by jdemeyer created at 2016-09-08 11:20:33

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2016-09-08 11:20:33

New commits:


---

Comment by git created at 2016-09-08 11:32:31

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2016-09-08 17:47:35

"known bug on 32 bit" -- to whom is this bug known?


---

Comment by jdemeyer created at 2016-09-08 17:49:14

Replying to [comment:4 mkoeppe]:
> "known bug on 32 bit" -- to whom is this bug known? 

To you now :-)


---

Comment by tmonteil created at 2016-09-08 23:00:07

I also fall on this problem. I see that the fix is to ignore the doctest for 32bit systems. How do you know that the doctest failure does not mean that there is a problem somewhere (that should be addressed) ?


---

Comment by mkoeppe created at 2016-09-08 23:06:43

There definitely is a problem, and it should NOT be ignored.


---

Comment by jdemeyer created at 2016-09-09 06:07:39

Replying to [comment:6 tmonteil]:
> How do you know that the doctest failure does not mean that there is a problem somewhere

I am not claiming that. I am adding `# known bug`, which means that I agree that there is a problem somewhere.

Of course, if the real bug can be fixed, that would be better. But in the mean time, just to have all doctests formally passing (and make a 32-bit patchbot useful), I propose to add the `# known bug`.


---

Comment by tmonteil created at 2016-09-13 16:40:52

If Mathias is OK with that, i am also in favor to set this ticket to positive review (i confirm that the patch fixes the doctest on my 32bit VM).

If someone has an idea where the bug comes from and how to fix it, that would be great.


---

Comment by mkoeppe created at 2016-09-13 16:55:30

I am building a 32-bit environment at the moment to look at what's going on here.


---

Comment by mkoeppe created at 2016-09-15 01:53:20

Upgrading CBC to 2.9.8 (latest) does NOT fix this problem.


---

Comment by tmonteil created at 2016-09-16 21:58:30

Replying to [comment:12 mkoeppe]:
> Upgrading CBC to 2.9.8 (latest) does NOT fix this problem.

Do you have an idea about where the problem comes from ? Does upstream say something about this ?


---

Comment by mkoeppe created at 2016-09-16 23:00:53

I haven't checked with upstream yet.
I am actually not sure yet if this a problem with the library or with our Cython wrapper.


---

Comment by tmonteil created at 2016-09-20 19:16:08

Replying to [comment:14 mkoeppe]:
> I haven't checked with upstream yet.
> I am actually not sure yet if this a problem with the library or with our Cython wrapper.

So shall we accept the current fix and postpone a real fix for when we understant more the situation ?


---

Comment by mkoeppe created at 2016-09-20 21:34:24

The patch at least needs to include reference to a ticket; and when this ticket is closed a follow-up tickets for an actual fix needs to be opened.


---

Comment by jdemeyer created at 2016-09-21 07:34:32

I created a new ticket at #21550 (details to be filled in) and added a reference to that ticket in the doctest.


---

Comment by git created at 2016-09-21 07:34:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2016-09-21 09:34:43

I am surprised to see that `sys.float_info` returns the same on 32-bit and on 64-bit Linux. On 32-bit:

```
dima`@`arando:~$ python
Python 2.7.6 (default, Jun 22 2015, 18:00:18) 
[GCC 4.8.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.float_info
sys.float_info(max=1.7976931348623157e+308, max_exp=1024, max_10_exp=308, min=2.2250738585072014e-308, min_exp=-1021, min_10_exp=-307, dig=15, mant_dig=53, epsilon=2.220446049250313e-16, radix=2, rounds=1)
```

anyhow we might be hitting a classic like https://gcc.gnu.org/bugzilla/show_bug.cgi?id=323


---

Comment by jdemeyer created at 2016-09-21 10:00:17

Replying to [comment:19 dimpase]:
> I am surprised to see that `sys.float_info` returns the same on 32-bit and on 64-bit Linux. On 32-bit:

Why? The C type `double` is the same on 32-bit and 64-bit architectures.


---

Comment by tmonteil created at 2016-09-21 10:18:30

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-09-24 14:32:10

Resolution: fixed


---

Comment by tmonteil created at 2019-08-27 19:45:19

Changing keywords from "" to "sdl".
