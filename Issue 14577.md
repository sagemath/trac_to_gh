# Issue 14577: untracked files in spkgs should all be under src

Issue created by migration from https://trac.sagemath.org/ticket/14781

Original creator: ohanar

Original creation time: 2013-06-20 01:02:57

Assignee: jdemeyer

CC:  jdemeyer

This is a requirement for making minimal changes to the build system for the git transition. The alternatives all would require expanding the functionality of the git build system, further differentiating it from the current one.

The standard spkgs that currently violate this assumption:

1. atlas-3.10.x (autotools output and lapack tarball)
1. mpfr (upstream patches)
1. singular (shared directory)
1. ntl (custom libtool)
1. cliquer (some of the patch files)

The proposed solution is to track all patches, and for directories/tarballs, move `src` to `src/pkgname` down one layer and move the extra directories/tarballs to be under `src`.




---

Comment by leif created at 2013-06-20 05:04:16

OMG...


---

Comment by jdemeyer created at 2013-06-20 06:47:06

Doesn't git support untracked files? :-)


---

Comment by ohanar created at 2013-06-20 07:42:29

Replying to [comment:2 jdemeyer]:
> Doesn't git support untracked files? :-)
Sure and you are welcome to work on extending the build system to handle all these inconsistent untracked files that are hidden behind the archiving process in the current structure (but which is gone in the unified git repository). I just have no interest in continuing to extend the (IMO) very hackish current build system in such ways when it can easily be resolved using a simpler hack.


---

Comment by vbraun created at 2013-06-26 01:08:04

So just to be clear, the proposed solution is to 
  1. move all non-patch files into `src/` 
  1. tar the resulting `src` directory up as our "source tarball" 
  1. postpone any further work on the build system until after the git transition
That sounds reasonable to me.


---

Comment by ohanar created at 2013-06-28 19:27:42

Yes, with the slight modification

1. for each un-tracked file, either begin tracking it, or move it into `src/`

There are two packages (cliquer and mpfr) that have untracked patch files, which also cause issue.


---

Comment by vbraun created at 2013-07-07 14:05:40

I've modified the ATLAS spkg along these lines on #14754


---

Comment by vbraun created at 2013-07-08 21:05:47

I've made #14869 to deal with MPFR, and cliquer will be fixed at #14349


---

Comment by vbraun created at 2013-07-10 14:01:20

NTL is at #14876


---

Comment by vbraun created at 2013-07-10 18:20:05

The NTL fix is at #14692. The version bump to ntl-6.0.0 will be dealt with at #14876


---

Comment by vbraun created at 2013-07-10 19:54:56

Singular fix is at #14737


---

Comment by vbraun created at 2013-07-15 04:55:35

I've decided to split the "fix everything that is wrong with cliquer" ticket, all we need for the git transition is #14892


---

Comment by vbraun created at 2013-07-15 04:55:48

Changing type from defect to task.


---

Comment by vbraun created at 2013-07-18 18:46:32

Task has been completed ;-)


---

Comment by vbraun created at 2013-07-18 18:46:32

Changing status from new to needs_review.


---

Comment by ohanar created at 2013-07-18 23:32:22

Thanks for looking into this.

Review in progress :)


---

Comment by ohanar created at 2013-07-19 13:11:11

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-08-16 21:12:26

Resolution: fixed
