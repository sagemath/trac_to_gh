# Issue 28096: spkg-configure.m4 for eclib

archive/issues_028096.json:
```json
{
    "body": "CC:  @embray @kiwifb @isuruf\n\nthe main issue here is how to check that the version installed on the system is good enough.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28333\n\n",
    "created_at": "2019-08-08T16:06:07Z",
    "labels": [
        "build: configure",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "spkg-configure.m4 for eclib",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28096",
    "user": "@dimpase"
}
```
CC:  @embray @kiwifb @isuruf

the main issue here is how to check that the version installed on the system is good enough.

Issue created by migration from https://trac.sagemath.org/ticket/28333





---

archive/issue_comments_396940.json:
```json
{
    "body": "while at it, we should fix eclib's `spkg-install`, which should always have `--with-flint`, otherwise flint is not linked it (causing worse performance I guess).",
    "created_at": "2019-08-08T16:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396940",
    "user": "@dimpase"
}
```

while at it, we should fix eclib's `spkg-install`, which should always have `--with-flint`, otherwise flint is not linked it (causing worse performance I guess).



---

archive/issue_comments_396941.json:
```json
{
    "body": "see https://github.com/JohnCremona/eclib/issues/56 for the version issue",
    "created_at": "2019-08-08T16:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396941",
    "user": "@dimpase"
}
```

see https://github.com/JohnCremona/eclib/issues/56 for the version issue



---

archive/issue_comments_396942.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-08-08T20:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396942",
    "user": "@dimpase"
}
```

New commits:



---

archive/issue_comments_396943.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-08-08T20:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396943",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396944.json:
```json
{
    "body": "The current Debian eclib is too old, one needs to rule it out using something like\nhttps://github.com/JohnCremona/eclib/issues/56#issuecomment-519813168\n----\nNew commits:",
    "created_at": "2019-08-09T07:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396944",
    "user": "@dimpase"
}
```

The current Debian eclib is too old, one needs to rule it out using something like
https://github.com/JohnCremona/eclib/issues/56#issuecomment-519813168
----
New commits:



---

archive/issue_comments_396945.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-09T08:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396945",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396946.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-09T09:23:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396946",
    "user": "@dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396947.json:
```json
{
    "body": "To test this, I checked that eclib from Debian 10 does not get picked up (as it should be). Then I uninstalled the system's eclib and installed the current eclib into /usr/local (with the configure parameters as in spkg-install), and it got picked up just fine.",
    "created_at": "2019-08-09T10:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396947",
    "user": "@dimpase"
}
```

To test this, I checked that eclib from Debian 10 does not get picked up (as it should be). Then I uninstalled the system's eclib and installed the current eclib into /usr/local (with the configure parameters as in spkg-install), and it got picked up just fine.



---

archive/issue_comments_396948.json:
```json
{
    "body": "\n```\nconfigure:12023: /projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/bin/x86_64-conda_cos6-linux-gnu-c++ -std=gnu++11 -o conftest -fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -I/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -I/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/include -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -L/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/lib -Wl,-rpath,/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/lib -lec conftest.cpp -lmpfr -lgmp -lm  -lntl >&5\n/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/bin/../lib/gcc/x86_64-conda_cos6-linux-gnu/7.3.0/../../../../x86_64-conda_cos6-linux-gnu/bin/ld: /tmp/ccEA25VC.o: in function `main':\nconftest.cpp:(.text.startup.main+0x11): undefined reference to `show_version()'\n```\n\n\nNote that `-lec` comes before `conftest.cpp` and not after like the other libs.",
    "created_at": "2019-08-09T17:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396948",
    "user": "@isuruf"
}
```


```
configure:12023: /projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/bin/x86_64-conda_cos6-linux-gnu-c++ -std=gnu++11 -o conftest -fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -I/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -I/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/include -Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -L/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/lib -Wl,-rpath,/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/lib -lec conftest.cpp -lmpfr -lgmp -lm  -lntl >&5
/projects/66d93023-00f0-4c12-8a25-5d6d4e486740/sage-build/bin/../lib/gcc/x86_64-conda_cos6-linux-gnu/7.3.0/../../../../x86_64-conda_cos6-linux-gnu/bin/ld: /tmp/ccEA25VC.o: in function `main':
conftest.cpp:(.text.startup.main+0x11): undefined reference to `show_version()'
```


Note that `-lec` comes before `conftest.cpp` and not after like the other libs.



---

archive/issue_comments_396949.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-08-09T17:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396949",
    "user": "@isuruf"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_396950.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-09T19:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396950",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396951.json:
```json
{
    "body": "OK, I've fixed this, it was a really bad bug there, not the least wrong number of parameters used for AC_RUN_IFELSE.",
    "created_at": "2019-08-09T19:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396951",
    "user": "@dimpase"
}
```

OK, I've fixed this, it was a really bad bug there, not the least wrong number of parameters used for AC_RUN_IFELSE.



---

archive/issue_comments_396952.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-08-09T19:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396952",
    "user": "@dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_396953.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-08-09T20:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396953",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396954.json:
```json
{
    "body": "rebased over updated #28242",
    "created_at": "2019-08-09T20:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396954",
    "user": "@dimpase"
}
```

rebased over updated #28242



---

archive/issue_comments_396955.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-10T04:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396955",
    "user": "@isuruf"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396956.json:
```json
{
    "body": "Works for me in conda",
    "created_at": "2019-08-10T04:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396956",
    "user": "@isuruf"
}
```

Works for me in conda



---

archive/issue_comments_396957.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-11T16:43:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28096",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28096#issuecomment-396957",
    "user": "@vbraun"
}
```

Resolution: fixed
