# Issue 23901: Use echelonize() instead of echelon_form in right_kernel_matrix echelon basis

Issue created by migration from https://trac.sagemath.org/ticket/24138

Original creator: tscrim

Original creation time: 2017-11-01 06:23:09

We do not need to create another copy of `M` as it was created locally to keep memory usage down (including putting it in a cache) and because it is faster.


---

Comment by tscrim created at 2017-11-01 06:31:57

I just added this into #24122. This ticket can be recycled if anyone wants it.


---

Comment by tscrim created at 2017-11-01 06:31:57

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-11-01 06:32:02

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-11-01 07:09:19

Actually, I can recycle this.


---

Comment by tscrim created at 2017-11-01 07:09:19

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2017-11-01 07:57:24

I am making an assumption, that the kernel of a sparse matrix will still generally be sparse. It will probably increase in density, but I do not think by enough in general to warrant the result being a dense matrix. On an example I tested:

```
0.000136661807580175
0.00566007653061225
```

where the top is the original density and the bottom is the density of the `right_kernel_matrix`.
----
New commits:


---

Comment by tscrim created at 2017-11-01 07:57:24

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2019-03-27 14:11:44

Changing status from needs_review to needs_work.


---

Comment by dkrenn created at 2019-03-27 14:11:44

1. Some doctests are failing.
2. The code itself looks good. As always, I tend to say blank after a comma (PEP8)

```diff
+                    entries[cur_row,i] = one
[...]
+                    for r,p in enumerate(pivots):
[...]
+            if i >= nrows or d[i,i] == 0:
```


Summary: LGTM once the failing doctests are investigated.


---

Comment by git created at 2019-04-17 04:10:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-04-17 04:11:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2019-04-17 04:15:23

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2019-04-17 04:15:23

Thanks for looking at this.

This takes care of the failing doctest. So my tacit understanding why simply updating the doctest is okay is because the algorithm is now better and doesn't change those entries, meaning they stay at exactly 0 rather than approximately 0.

I don't entirely agree with the comma space (same reasoning as on #27442), but I added it. I also did a few other little PEP8 and maintenance things.


---

Comment by dkrenn created at 2019-04-17 07:34:46

LGTM.


---

Comment by dkrenn created at 2019-04-17 07:34:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-04-18 19:56:53

Resolution: fixed
