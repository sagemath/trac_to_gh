# Issue 24884: Matrix-related fixes in differential geometry

archive/issues_024647.json:
```json
{
    "assignees": [],
    "body": "These are changes which are needed because of #24742.\n\n1. `src/sage/schemes/riemann_surfaces/riemann_surface.py`: #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly. The fix is easy: pass actual elements of the ring instead of the generator names. This is clearly the right thing to do.\n\n2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does. I also got rid of the evil `try`/`except` block trying to construct a matrix but happily returning a list if that failed.\n\n3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.\n\nCC:  @egourgoulhon @tscrim\n\nBranch/Commit: **[6ae84f1](https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Jeroen Demeyer, Eric Gourgoulhon**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24884_\n\n",
    "closed_at": "2018-03-08T00:02:39Z",
    "created_at": "2018-03-02T10:05:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Matrix-related fixes in differential geometry",
    "type": "issue",
    "updated_at": "2018-03-08T00:02:39Z",
    "url": "https://github.com/sagemath/sage/issues/24884",
    "user": "https://github.com/jdemeyer"
}
```
These are changes which are needed because of #24742.

1. `src/sage/schemes/riemann_surfaces/riemann_surface.py`: #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly. The fix is easy: pass actual elements of the ring instead of the generator names. This is clearly the right thing to do.

2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does. I also got rid of the evil `try`/`except` block trying to construct a matrix but happily returning a list if that failed.

3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.

CC:  @egourgoulhon @tscrim

Branch/Commit: **[6ae84f1](https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227)**

Reviewer: **Travis Scrimshaw**

Author: **Jeroen Demeyer, Eric Gourgoulhon**

_Issue created by migration from https://trac.sagemath.org/ticket/24884_





---

archive/issue_events_326255.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T10:05:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326255"
}
```



---

archive/issue_events_326256.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T10:05:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326256"
}
```



---

archive/issue_events_326257.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T10:05:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326257"
}
```



---

archive/issue_events_326258.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T10:05:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326258"
}
```



---

archive/issue_comments_381097.json:
```json
{
    "body": "Branch: **[u/jdemeyer/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/matrix_related_fixes_in_differential_geometry)**",
    "created_at": "2018-03-02T10:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381097",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/matrix_related_fixes_in_differential_geometry)**



---

archive/issue_comments_381098.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd532ab6734f5a87df0c237f75105c92c1158c3d\">bd532ab</a></td><td><code>Matrix-related fixes in differential geometry</code></td></tr></table>\n",
    "created_at": "2018-03-02T10:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381098",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">Comment 2</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd532ab6734f5a87df0c237f75105c92c1158c3d">bd532ab</a></td><td><code>Matrix-related fixes in differential geometry</code></td></tr></table>




---

archive/issue_events_326259.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T10:11:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326259"
}
```



---

archive/issue_comments_381099.json:
```json
{
    "body": "Commit: **[bd532ab](https://github.com/sagemath/sagetrac-mirror/commit/bd532ab6734f5a87df0c237f75105c92c1158c3d)**",
    "created_at": "2018-03-02T10:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381099",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[bd532ab](https://github.com/sagemath/sagetrac-mirror/commit/bd532ab6734f5a87df0c237f75105c92c1158c3d)**



---

archive/issue_comments_381100.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n These are changes which are needed because of #24742.\n+\n+1. `src/sage/schemes/riemann_surfaces/riemann_surface.py` are needed because #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly.\n+\n+2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests, not because it's the right thing to do. I also added some documentation to reflect better what the `_get_list()` method does.\n+\n+3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.\n``````\n",
    "created_at": "2018-03-02T10:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381100",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,7 @@
 These are changes which are needed because of #24742.
+
+1. `src/sage/schemes/riemann_surfaces/riemann_surface.py` are needed because #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly.
+
+2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests, not because it's the right thing to do. I also added some documentation to reflect better what the `_get_list()` method does.
+
+3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.
``````




---

archive/issue_comments_381101.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n These are changes which are needed because of #24742.\n \n-1. `src/sage/schemes/riemann_surfaces/riemann_surface.py` are needed because #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly.\n+1. `src/sage/schemes/riemann_surfaces/riemann_surface.py`: #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly. The fix is easy: pass actual elements of the ring instead of the generator names. This is clearly the right thing to do.\n \n-2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests, not because it's the right thing to do. I also added some documentation to reflect better what the `_get_list()` method does.\n+2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does.\n \n 3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.\n``````\n",
    "created_at": "2018-03-02T10:13:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381101",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 These are changes which are needed because of #24742.
 
-1. `src/sage/schemes/riemann_surfaces/riemann_surface.py` are needed because #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly.
+1. `src/sage/schemes/riemann_surfaces/riemann_surface.py`: #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly. The fix is easy: pass actual elements of the ring instead of the generator names. This is clearly the right thing to do.
 
-2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests, not because it's the right thing to do. I also added some documentation to reflect better what the `_get_list()` method does.
+2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does.
 
 3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.
``````




---

archive/issue_comments_381102.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n 1. `src/sage/schemes/riemann_surfaces/riemann_surface.py`: #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly. The fix is easy: pass actual elements of the ring instead of the generator names. This is clearly the right thing to do.\n \n-2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does.\n+2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does. I also got rid of the evil `try`/`except` block trying to construct a matrix but happily returning a list if that failed.\n \n 3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.\n``````\n",
    "created_at": "2018-03-02T10:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381102",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 1. `src/sage/schemes/riemann_surfaces/riemann_surface.py`: #24742 will disallow passing strings to the matrix constructor. It's a rarely used feature and hard to get right properly. The fix is easy: pass actual elements of the ring instead of the generator names. This is clearly the right thing to do.
 
-2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does.
+2. `src/sage/tensor/modules/comp.py`: I needed to change `_get_list()` but I have to say that I don't understand what the code is supposed to do. I wrote the code the way I did mainly to pass doctests. I also added some documentation to reflect better what the `_get_list()` method does. I also got rid of the evil `try`/`except` block trying to construct a matrix but happily returning a list if that failed.
 
 3. `src/sage/manifolds/differentiable/metric.py`: this is a consequence of the change in 2. and it looks like a sensible change.
``````




---

archive/issue_comments_381103.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nChanges LGTM (Eric, if you see something you do not like, feel free to revert).",
    "created_at": "2018-03-02T22:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381103",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">Comment 5</div>

Changes LGTM (Eric, if you see something you do not like, feel free to revert).



---

archive/issue_comments_381104.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2018-03-02T22:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381104",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_events_326260.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-03-02T22:45:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326260"
}
```



---

archive/issue_events_326261.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-03-02T22:45:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326261"
}
```



---

archive/issue_events_326262.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-03-02T22:56:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326262"
}
```



---

archive/issue_events_326263.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-03-02T22:56:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326263"
}
```



---

archive/issue_comments_381105.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@tscrim](#comment%3A5):\n> Changes LGTM (Eric, if you see something you do not like, feel free to revert).\n\nHi Travis, I was just looking to the ticket, at the same time as you apparently! The change in the doctest of `src/sage/manifold/differentiable/metric.py` (point 3 in the ticket description) is not desirable: it results from a forced conversion of SymPy to `SR` due to the change in `src/sage/tensor/modules/comp.py` (point 2). Jeroen, the line \n\n```\nreturn matrix(SR, resu)\n```\nforces the conversion of elements of the list `resu` to `SR` elements, while they can actually belong to something else, like SymPy. Is there a good reason for this? Do we have now to explicitly specify the ring as the first argument of `matrix`? Since SymPy elements do not constitute a ring in Sage, one cannot construct a matrix for them. I plan to improve this in the short future, by implementing a ring of SymPy coordinate functions. But for the time being, I would say it is preferable to return a list of SymPy elements instead of a  matrix of `SR` elements.",
    "created_at": "2018-03-02T23:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381105",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@tscrim](#comment%3A5):
> Changes LGTM (Eric, if you see something you do not like, feel free to revert).

Hi Travis, I was just looking to the ticket, at the same time as you apparently! The change in the doctest of `src/sage/manifold/differentiable/metric.py` (point 3 in the ticket description) is not desirable: it results from a forced conversion of SymPy to `SR` due to the change in `src/sage/tensor/modules/comp.py` (point 2). Jeroen, the line 

```
return matrix(SR, resu)
```
forces the conversion of elements of the list `resu` to `SR` elements, while they can actually belong to something else, like SymPy. Is there a good reason for this? Do we have now to explicitly specify the ring as the first argument of `matrix`? Since SymPy elements do not constitute a ring in Sage, one cannot construct a matrix for them. I plan to improve this in the short future, by implementing a ring of SymPy coordinate functions. But for the time being, I would say it is preferable to return a list of SymPy elements instead of a  matrix of `SR` elements.



---

archive/issue_comments_381106.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nReplying to [@egourgoulhon](#comment%3A7):\n> Jeroen, the line \n> \n> ```\n> return matrix(SR, resu)\n> ```\n> forces the conversion of elements of the list `resu` to `SR` elements, while they can actually belong to something else, like SymPy. Is there a good reason for this?\n\nI just did that to be consistent with the documentation. The documentation never said \"return a matrix, except when using the SymPy backend\". I did make an exception for the `str` formatter, because that was documented (not in this method but elsewhere).\n\n> Do we have now to explicitly specify the ring as the first argument of `matrix`?\n\nNo, that won't be required. But again, it's good for consistency that you always get the same kind of object back (a symbolic matrix).\n\n> I would say it is preferable to return a list of SymPy elements instead of a  matrix of `SR` elements.\n\nThat is fine for me, but then SymPy elements should *always* return a list. The main thing that I do not like about the current code is this `try`/`except` block:\n\n```python\n            try:\n                for i in range(self._dim):\n                    for j in range(self._dim):\n                        a = resu[i][j]\n                        if hasattr(a, '_express'):\n                            resu[i][j] = a.expr()\n                resu = matrix(resu)  # for a nicer output\n            except TypeError:\n                pass\n```\nWith this code, you really have no idea whether a matrix or a list will be returned. And if it's a matrix, you don't know over which base ring.\n\nTravis, what do you think?",
    "created_at": "2018-03-03T08:36:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381106",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">Comment 8</div>

Replying to [@egourgoulhon](#comment%3A7):
> Jeroen, the line 
> 
> ```
> return matrix(SR, resu)
> ```
> forces the conversion of elements of the list `resu` to `SR` elements, while they can actually belong to something else, like SymPy. Is there a good reason for this?

I just did that to be consistent with the documentation. The documentation never said "return a matrix, except when using the SymPy backend". I did make an exception for the `str` formatter, because that was documented (not in this method but elsewhere).

> Do we have now to explicitly specify the ring as the first argument of `matrix`?

No, that won't be required. But again, it's good for consistency that you always get the same kind of object back (a symbolic matrix).

> I would say it is preferable to return a list of SymPy elements instead of a  matrix of `SR` elements.

That is fine for me, but then SymPy elements should *always* return a list. The main thing that I do not like about the current code is this `try`/`except` block:

```python
            try:
                for i in range(self._dim):
                    for j in range(self._dim):
                        a = resu[i][j]
                        if hasattr(a, '_express'):
                            resu[i][j] = a.expr()
                resu = matrix(resu)  # for a nicer output
            except TypeError:
                pass
```
With this code, you really have no idea whether a matrix or a list will be returned. And if it's a matrix, you don't know over which base ring.

Travis, what do you think?



---

archive/issue_comments_381107.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227\">6ae84f1</a></td><td><code>Improve treatment of matrix output in sage.tensor.modules.comp.Components._get_list.</code></td></tr></table>\n",
    "created_at": "2018-03-03T14:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381107",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:9" align="right">Comment 9</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227">6ae84f1</a></td><td><code>Improve treatment of matrix output in sage.tensor.modules.comp.Components._get_list.</code></td></tr></table>




---

archive/issue_comments_381108.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/matrix_related_fixes_in_differential_geometry)** to **[public/manifolds/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/matrix_related_fixes_in_differential_geometry)**",
    "created_at": "2018-03-03T14:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381108",
    "user": "https://github.com/egourgoulhon"
}
```

Changed branch from **[u/jdemeyer/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/matrix_related_fixes_in_differential_geometry)** to **[public/manifolds/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/matrix_related_fixes_in_differential_geometry)**



---

archive/issue_comments_381109.json:
```json
{
    "body": "Changed commit from **[bd532ab](https://github.com/sagemath/sagetrac-mirror/commit/bd532ab6734f5a87df0c237f75105c92c1158c3d)** to **[6ae84f1](https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227)**",
    "created_at": "2018-03-03T14:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381109",
    "user": "https://github.com/egourgoulhon"
}
```

Changed commit from **[bd532ab](https://github.com/sagemath/sagetrac-mirror/commit/bd532ab6734f5a87df0c237f75105c92c1158c3d)** to **[6ae84f1](https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227)**



---

archive/issue_events_326264.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-03-03T14:12:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326264"
}
```



---

archive/issue_events_326265.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-03-03T14:12:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326265"
}
```



---

archive/issue_comments_381110.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@jdemeyer](#comment%3A8):\n> I just did that to be consistent with the documentation. The documentation never said \"return a matrix, except when using the SymPy backend\". I did make an exception for the `str` formatter, because that was documented (not in this method but elsewhere).\n\nI agree the documentation of the method `_get_list` is pretty poor (but this is a \"private\" (underscored) method). Sorry about this. Note that the class `Components` to which it belongs does not know anything about SR or SymPy: it manipulates only elements of a ring. The SymPy or `str` objects appear only through the output formatter. \n\n> \n> > Do we have now to explicitly specify the ring as the first argument of `matrix`?\n\n> \n> No, that won't be required. But again, it's good for consistency that you always get the same kind of object back (a symbolic matrix).\n\nOK, thanks.\n\n> \n> That is fine for me, but then SymPy elements should *always* return a list. The main thing that I do not like about the current code is this `try`/`except` block:\n> With this code, you really have no idea whether a matrix or a list will be returned. And if it's a matrix, you don't know over which base ring.\n\nI agree, this piece of code was not very good. Actually it pertains to the early time of the SageManifolds project, where the elements stored in `Components` where not guaranteed to belong to any ring. This is no longer the case for the `Components` used in tensor calculus: they all belong to the algebra of scalar fields and, after being processed by `self._output_formatter`, they belong to the ring of chart functions, `sage.manifolds.chart_func.ChartFunctionRing` whatever their internal representation (`SR` or Sympy). I've therefore modified the code of `Components._get_list` to\n\n```\n        if self._nid == 2:\n            # 2-dim case: convert to matrix for a nicer output\n            from sage.matrix.constructor import matrix\n            from sage.structure.element import parent\n            from sage.categories.rings import Rings\n            if parent(resu[0][0]) in Rings():\n                return matrix(resu)\n        return resu\n```\nIn this way, there is no special treatment for strings or whatever else that is not a ring, since the test `if parent(resu[0][0]) in Rings()` will return false in this case. For tensor field components, the treatment is now at the level of `ChartFunctionRing` (there is no longer any reference to the internal representation via `_express` and `expr()`), so it works for both `SR` and SymPy. In particular the doctest in `src/sage/manifolds/differentiable/metric.py` now displays a matrix of SymPy objects, and no longer a list, which is an improvement! Thanks for having triggered it!\n\nI've pushed these changes in the new branch `public/manifolds/matrix_related_fixes_in_differential_geometry`, which is based on your branch (simply one commit ahead). I am attaching it to the ticket.",
    "created_at": "2018-03-03T14:39:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381110",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@jdemeyer](#comment%3A8):
> I just did that to be consistent with the documentation. The documentation never said "return a matrix, except when using the SymPy backend". I did make an exception for the `str` formatter, because that was documented (not in this method but elsewhere).

I agree the documentation of the method `_get_list` is pretty poor (but this is a "private" (underscored) method). Sorry about this. Note that the class `Components` to which it belongs does not know anything about SR or SymPy: it manipulates only elements of a ring. The SymPy or `str` objects appear only through the output formatter. 

> 
> > Do we have now to explicitly specify the ring as the first argument of `matrix`?

> 
> No, that won't be required. But again, it's good for consistency that you always get the same kind of object back (a symbolic matrix).

OK, thanks.

> 
> That is fine for me, but then SymPy elements should *always* return a list. The main thing that I do not like about the current code is this `try`/`except` block:
> With this code, you really have no idea whether a matrix or a list will be returned. And if it's a matrix, you don't know over which base ring.

I agree, this piece of code was not very good. Actually it pertains to the early time of the SageManifolds project, where the elements stored in `Components` where not guaranteed to belong to any ring. This is no longer the case for the `Components` used in tensor calculus: they all belong to the algebra of scalar fields and, after being processed by `self._output_formatter`, they belong to the ring of chart functions, `sage.manifolds.chart_func.ChartFunctionRing` whatever their internal representation (`SR` or Sympy). I've therefore modified the code of `Components._get_list` to

```
        if self._nid == 2:
            # 2-dim case: convert to matrix for a nicer output
            from sage.matrix.constructor import matrix
            from sage.structure.element import parent
            from sage.categories.rings import Rings
            if parent(resu[0][0]) in Rings():
                return matrix(resu)
        return resu
```
In this way, there is no special treatment for strings or whatever else that is not a ring, since the test `if parent(resu[0][0]) in Rings()` will return false in this case. For tensor field components, the treatment is now at the level of `ChartFunctionRing` (there is no longer any reference to the internal representation via `_express` and `expr()`), so it works for both `SR` and SymPy. In particular the doctest in `src/sage/manifolds/differentiable/metric.py` now displays a matrix of SymPy objects, and no longer a list, which is an improvement! Thanks for having triggered it!

I've pushed these changes in the new branch `public/manifolds/matrix_related_fixes_in_differential_geometry`, which is based on your branch (simply one commit ahead). I am attaching it to the ticket.



---

archive/issue_comments_381111.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@egourgoulhon](#comment%3A10):\n\nAn alternative to\n> \n> ```\n>             if parent(resu[0][0]) in Rings():\n>                 return matrix(resu)\n> ```\n\nis\n\n```\n            R = parent(resu[0][0])\n            if R in Rings():\n                return matrix(R, resu)\n```\nI don't know which form is preferable. Note that in the latter, the ring is passed as the first argument to `matrix`.",
    "created_at": "2018-03-03T16:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381111",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@egourgoulhon](#comment%3A10):

An alternative to
> 
> ```
>             if parent(resu[0][0]) in Rings():
>                 return matrix(resu)
> ```

is

```
            R = parent(resu[0][0])
            if R in Rings():
                return matrix(R, resu)
```
I don't know which form is preferable. Note that in the latter, the ring is passed as the first argument to `matrix`.



---

archive/issue_comments_381112.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nIMO, a more ideal form is\n\n```python\n            R = parent(resu[0][0])\n            if R in Rings():\n                return MatrixSpace(R,2)(resu)\n```\nGiven [comment:7](#comment%3A7)\n\n> I plan to improve this in the short future, by implementing a ring of SymPy coordinate functions\n\nI would also add a comment to the code saying to remove the `Rings` check once SymPy coordinate functions are a ring.\n\nI think this also addresses Jeroen's comment about code flow clarity and the code LBTM (B for better). Any other comments Jeroen?",
    "created_at": "2018-03-03T22:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381112",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">Comment 12</div>

IMO, a more ideal form is

```python
            R = parent(resu[0][0])
            if R in Rings():
                return MatrixSpace(R,2)(resu)
```
Given [comment:7](#comment%3A7)

> I plan to improve this in the short future, by implementing a ring of SymPy coordinate functions

I would also add a comment to the code saying to remove the `Rings` check once SymPy coordinate functions are a ring.

I think this also addresses Jeroen's comment about code flow clarity and the code LBTM (B for better). Any other comments Jeroen?



---

archive/issue_comments_381113.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nInstead of asking whether the parent is a ring, it seems more sensible to check for a Sage `Element`. i.e. I would suggest to replace\n\n```\nparent(x) in Rings()\n```\nby\n\n```\nisinstance(x, Element)\n```",
    "created_at": "2018-03-04T08:34:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381113",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">Comment 13</div>

Instead of asking whether the parent is a ring, it seems more sensible to check for a Sage `Element`. i.e. I would suggest to replace

```
parent(x) in Rings()
```
by

```
isinstance(x, Element)
```



---

archive/issue_comments_381114.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@tscrim](#comment%3A12):\n> IMO, a more ideal form is\n> \n> ```python\n>             R = parent(resu[0][0])\n>             if R in Rings():\n>                 return MatrixSpace(R,2)(resu)\n> ```\n\nWhat if the different elements have different parents? Is there a guarantee that the parent of `resu[0][0]` is the same as the parent of `resu[0][1]`? So `matrix(resu)` will auto-detect the correct parent (using the coercion model) and that looks better.\n\nOf course the same argument could be made for the `isinstance(resu[0][0], Element)` check. But it seems less likely to mix Elements and non-Elements than to mix different parents.",
    "created_at": "2018-03-04T08:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381114",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@tscrim](#comment%3A12):
> IMO, a more ideal form is
> 
> ```python
>             R = parent(resu[0][0])
>             if R in Rings():
>                 return MatrixSpace(R,2)(resu)
> ```

What if the different elements have different parents? Is there a guarantee that the parent of `resu[0][0]` is the same as the parent of `resu[0][1]`? So `matrix(resu)` will auto-detect the correct parent (using the coercion model) and that looks better.

Of course the same argument could be made for the `isinstance(resu[0][0], Element)` check. But it seems less likely to mix Elements and non-Elements than to mix different parents.



---

archive/issue_events_326266.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-04T09:17:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326266"
}
```



---

archive/issue_events_326267.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-04T09:17:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326267"
}
```



---

archive/issue_comments_381115.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@tscrim](#comment%3A12):\n> \n> I would also add a comment to the code saying to remove the `Rings` check once SymPy coordinate functions are a ring.\n> \n\nActually, with the latest version, it works with SymPy, i.e. it does generate a matrix, the elements of which are chart functions, which are displayed as SymPy objects when SymPy is used as the symbolic engine (see the matrix containing `x**2` and `y**2` instead of `x^2` and `y^2` in the doctest in `metric.py`).\nThe `Rings` check is then for other possible cases, not involving chart functions (I don't have any precise use case at the moment, except for the `str` output formatter used as illustration in the doctests). SymPy was a problem in the previous version of the code, where the matrix construction was attempted directly at the level of symbolic representations, either `SR` or SymPy. Now the matrix construction is at the (higher) level of chart functions, and, thanks to you IIRC ;-), chart functions now forms a ring, so that the matrix construction always succeeds.",
    "created_at": "2018-03-04T14:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381115",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@tscrim](#comment%3A12):
> 
> I would also add a comment to the code saying to remove the `Rings` check once SymPy coordinate functions are a ring.
> 

Actually, with the latest version, it works with SymPy, i.e. it does generate a matrix, the elements of which are chart functions, which are displayed as SymPy objects when SymPy is used as the symbolic engine (see the matrix containing `x**2` and `y**2` instead of `x^2` and `y^2` in the doctest in `metric.py`).
The `Rings` check is then for other possible cases, not involving chart functions (I don't have any precise use case at the moment, except for the `str` output formatter used as illustration in the doctests). SymPy was a problem in the previous version of the code, where the matrix construction was attempted directly at the level of symbolic representations, either `SR` or SymPy. Now the matrix construction is at the (higher) level of chart functions, and, thanks to you IIRC ;-), chart functions now forms a ring, so that the matrix construction always succeeds.



---

archive/issue_comments_381116.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@jdemeyer](#comment%3A14):\n> \n> What if the different elements have different parents? Is there a guarantee that the parent of `resu[0][0]` is the same as the parent of `resu[0][1]`? So `matrix(resu)` will auto-detect the correct parent (using the coercion model) and that looks better.\n\nOK.\n> \n> Of course the same argument could be made for the `isinstance(resu[0][0], Element)` check. But it seems less likely to mix Elements and non-Elements than to mix different parents.\n\nA priori, all elements of `resu` should have the same parent: this is guaranted if no  output formatter is used: the parent is nothing but the ring on which the `Components` object is constructed. If some output formatter is used, it is likely that its output is of a fixed type, hence giving rise to the same parent (in the extended sense, i.e. the parent default to the Python type if the object has no Sage Parent), like for instance the `str` output formatter. My concern with the `Element` check is that it does not guarantee that the parent is a ring. If it is not, then the matrix construction will fail.",
    "created_at": "2018-03-04T14:47:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381116",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@jdemeyer](#comment%3A14):
> 
> What if the different elements have different parents? Is there a guarantee that the parent of `resu[0][0]` is the same as the parent of `resu[0][1]`? So `matrix(resu)` will auto-detect the correct parent (using the coercion model) and that looks better.

OK.
> 
> Of course the same argument could be made for the `isinstance(resu[0][0], Element)` check. But it seems less likely to mix Elements and non-Elements than to mix different parents.

A priori, all elements of `resu` should have the same parent: this is guaranted if no  output formatter is used: the parent is nothing but the ring on which the `Components` object is constructed. If some output formatter is used, it is likely that its output is of a fixed type, hence giving rise to the same parent (in the extended sense, i.e. the parent default to the Python type if the object has no Sage Parent), like for instance the `str` output formatter. My concern with the `Element` check is that it does not guarantee that the parent is a ring. If it is not, then the matrix construction will fail.



---

archive/issue_events_326268.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-05T11:46:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326268"
}
```



---

archive/issue_events_326269.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-05T11:46:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326269"
}
```



---

archive/issue_comments_381117.json:
```json
{
    "body": "Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, Eric Gourgoulhon**",
    "created_at": "2018-03-05T11:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381117",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, Eric Gourgoulhon**



---

archive/issue_comments_381118.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@egourgoulhon](#comment%3A17):\n> If it is not, then the matrix construction will fail. \n\nI didn't know that, but you are right. If you ask me, that's a silly artificial restriction.\n\nIn that case, maybe Eric's code is fine. Travis, what do you think?",
    "created_at": "2018-03-05T11:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381118",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@egourgoulhon](#comment%3A17):
> If it is not, then the matrix construction will fail. 

I didn't know that, but you are right. If you ask me, that's a silly artificial restriction.

In that case, maybe Eric's code is fine. Travis, what do you think?



---

archive/issue_comments_381119.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nMy understanding is that they should all be of the same parent. Yet, I don't hold a stake in this code, so I don't really care either way. I doubt this will ever make a difference in the wild (barring very esoteric uses).",
    "created_at": "2018-03-05T12:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381119",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">Comment 19</div>

My understanding is that they should all be of the same parent. Yet, I don't hold a stake in this code, so I don't really care either way. I doubt this will ever make a difference in the wild (barring very esoteric uses).



---

archive/issue_comments_381120.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@tscrim](#comment%3A19):\n> My understanding is that they should all be of the same parent. Yet, I don't hold a stake in this code, so I don't really care either way. I doubt this will ever make a difference in the wild (barring very esoteric uses).\n\nYes, I think it's pretty safe to leave the code in the current state.",
    "created_at": "2018-03-05T16:15:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381120",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@tscrim](#comment%3A19):
> My understanding is that they should all be of the same parent. Yet, I don't hold a stake in this code, so I don't really care either way. I doubt this will ever make a difference in the wild (barring very esoteric uses).

Yes, I think it's pretty safe to leave the code in the current state.



---

archive/issue_events_326270.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-06T11:17:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326270"
}
```



---

archive/issue_events_326271.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-06T11:17:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326271"
}
```



---

archive/issue_comments_381121.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nI'm taking that as positive review :-)",
    "created_at": "2018-03-06T11:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381121",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">Comment 21</div>

I'm taking that as positive review :-)



---

archive/issue_comments_381122.json:
```json
{
    "body": "Changed branch from **[public/manifolds/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/matrix_related_fixes_in_differential_geometry)** to **[6ae84f1](https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227)**",
    "created_at": "2018-03-08T00:02:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24884#issuecomment-381122",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/manifolds/matrix_related_fixes_in_differential_geometry](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/matrix_related_fixes_in_differential_geometry)** to **[6ae84f1](https://github.com/sagemath/sagetrac-mirror/commit/6ae84f147a2209e0396d508c77b4c86e706f3227)**



---

archive/issue_events_326272.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-08T00:02:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326272"
}
```



---

archive/issue_events_326273.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2b6ad723cb2c531dd6b13346a002e7446e659d9c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-03-08T00:02:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24884",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24884#event-326273"
}
```
