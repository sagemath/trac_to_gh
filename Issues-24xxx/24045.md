# Issue 24045: Generator of Paley digraphs

archive/issues_023808.json:
```json
{
    "body": "We already have undirected Paley graph generator. Here we add the directed version.\n\nReviewer: Travis Scrimshaw\n\nAuthor: David Coudert\n\nBranch: 561100d8aab4f2356e62b12e5b7b9d328913dc27\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24045\n\n",
    "closed_at": "2017-10-21T19:01:14Z",
    "created_at": "2017-10-14T12:47:06Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Generator of Paley digraphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24045",
    "user": "https://github.com/dcoudert"
}
```
We already have undirected Paley graph generator. Here we add the directed version.

Reviewer: Travis Scrimshaw

Author: David Coudert

Branch: 561100d8aab4f2356e62b12e5b7b9d328913dc27

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24045





---

archive/issue_comments_454419.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[0c93ed1](https://git.sagemath.org/sage.git/commit?id=0c93ed1c815a980cd8eca51adfbd67e41269dfbf)|`trac #24045: generator of Paley digraphs`|\n|[3270d3d](https://git.sagemath.org/sage.git/commit?id=3270d3dc3a6f6415aa41986ea7527b4e5f77d1dc)|`trac #24045: small issues`|",
    "created_at": "2017-10-14T12:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454419",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[0c93ed1](https://git.sagemath.org/sage.git/commit?id=0c93ed1c815a980cd8eca51adfbd67e41269dfbf)|`trac #24045: generator of Paley digraphs`|
|[3270d3d](https://git.sagemath.org/sage.git/commit?id=3270d3dc3a6f6415aa41986ea7527b4e5f77d1dc)|`trac #24045: small issues`|



---

archive/issue_comments_454420.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dcoudert/24045\"",
    "created_at": "2017-10-14T12:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454420",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "u/dcoudert/24045"



---

archive/issue_comments_454421.json:
```json
{
    "body": "Changing commit from \"\" to \"3270d3dc3a6f6415aa41986ea7527b4e5f77d1dc\"",
    "created_at": "2017-10-14T12:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454421",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "" to "3270d3dc3a6f6415aa41986ea7527b4e5f77d1dc"



---

archive/issue_comments_454422.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-14T12:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454422",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_454423.json:
```json
{
    "body": "<a id='comment:2'></a>\nYou should not use `assert` to check user input as those should be something that is always true. Instead, do an `if` with a `raise ValueError`. Also, add a period/full-stop to the end of the 1-line docstring description.",
    "created_at": "2017-10-14T15:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454423",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
You should not use `assert` to check user input as those should be something that is always true. Instead, do an `if` with a `raise ValueError`. Also, add a period/full-stop to the end of the 1-line docstring description.



---

archive/issue_comments_454424.json:
```json
{
    "body": "Changing commit from \"3270d3dc3a6f6415aa41986ea7527b4e5f77d1dc\" to \"de96bdbbe5b20e210664f223b771bf34a99f33f0\"",
    "created_at": "2017-10-14T17:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3270d3dc3a6f6415aa41986ea7527b4e5f77d1dc" to "de96bdbbe5b20e210664f223b771bf34a99f33f0"



---

archive/issue_comments_454425.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[7203e7b](https://git.sagemath.org/sage.git/commit/?id=7203e7b33da072fc939b5df349ff1999c50da3b8)|`trac #24045: reviewers comments`|\n|[de96bdb](https://git.sagemath.org/sage.git/commit/?id=de96bdbbe5b20e210664f223b771bf34a99f33f0)|`trac #24045: also remove assert from PaleyGraph generator`|",
    "created_at": "2017-10-14T17:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[7203e7b](https://git.sagemath.org/sage.git/commit/?id=7203e7b33da072fc939b5df349ff1999c50da3b8)|`trac #24045: reviewers comments`|
|[de96bdb](https://git.sagemath.org/sage.git/commit/?id=de96bdbbe5b20e210664f223b771bf34a99f33f0)|`trac #24045: also remove assert from PaleyGraph generator`|



---

archive/issue_comments_454426.json:
```json
{
    "body": "<a id='comment:4'></a>\nI have implemented all your comments. I also took the opportunity to remove `assert` from the `PaleyGraph` generator. The methods are almost the same.",
    "created_at": "2017-10-14T17:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454426",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>
I have implemented all your comments. I also took the opportunity to remove `assert` from the `PaleyGraph` generator. The methods are almost the same.



---

archive/issue_comments_454427.json:
```json
{
    "body": "<a id='comment:5'></a>\nOne last little thing (sorry for not mentioning it earlier), the error messages should start with a lowercase letter (this is consistent with Python, which does not consider them to be full sentences).",
    "created_at": "2017-10-14T17:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454427",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
One last little thing (sorry for not mentioning it earlier), the error messages should start with a lowercase letter (this is consistent with Python, which does not consider them to be full sentences).



---

archive/issue_comments_454428.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[c1e12c4](https://git.sagemath.org/sage.git/commit/?id=c1e12c42ff12f110e05ead0755659817aac9ca33)|`trac #24045: error messages start with lower case`|",
    "created_at": "2017-10-14T18:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454428",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[c1e12c4](https://git.sagemath.org/sage.git/commit/?id=c1e12c42ff12f110e05ead0755659817aac9ca33)|`trac #24045: error messages start with lower case`|



---

archive/issue_comments_454429.json:
```json
{
    "body": "Changing commit from \"de96bdbbe5b20e210664f223b771bf34a99f33f0\" to \"c1e12c42ff12f110e05ead0755659817aac9ca33\"",
    "created_at": "2017-10-14T18:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "de96bdbbe5b20e210664f223b771bf34a99f33f0" to "c1e12c42ff12f110e05ead0755659817aac9ca33"



---

archive/issue_comments_454430.json:
```json
{
    "body": "<a id='comment:7'></a>\nRight. I have forgotten this convention.",
    "created_at": "2017-10-14T18:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454430",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>
Right. I have forgotten this convention.



---

archive/issue_comments_454431.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-10-14T19:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454431",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_454432.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-14T19:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454432",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454433.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks. LGTM.",
    "created_at": "2017-10-14T19:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454433",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
Thanks. LGTM.



---

archive/issue_comments_454434.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe indentation of the seealso block is not correct.",
    "created_at": "2017-10-15T09:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454434",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:9'></a>
The indentation of the seealso block is not correct.



---

archive/issue_comments_454435.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-15T09:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454435",
    "user": "https://github.com/dcoudert"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_454436.json:
```json
{
    "body": "Changing commit from \"c1e12c42ff12f110e05ead0755659817aac9ca33\" to \"561100d8aab4f2356e62b12e5b7b9d328913dc27\"",
    "created_at": "2017-10-15T09:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454436",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c1e12c42ff12f110e05ead0755659817aac9ca33" to "561100d8aab4f2356e62b12e5b7b9d328913dc27"



---

archive/issue_comments_454437.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[561100d](https://git.sagemath.org/sage.git/commit/?id=561100d8aab4f2356e62b12e5b7b9d328913dc27)|`trac #24045: correct indentation of seealso block`|",
    "created_at": "2017-10-15T09:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[561100d](https://git.sagemath.org/sage.git/commit/?id=561100d8aab4f2356e62b12e5b7b9d328913dc27)|`trac #24045: correct indentation of seealso block`|



---

archive/issue_comments_454438.json:
```json
{
    "body": "<a id='comment:11'></a>\nBetter now. Sorry.",
    "created_at": "2017-10-15T09:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454438",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>
Better now. Sorry.



---

archive/issue_comments_454439.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-15T09:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454439",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_454440.json:
```json
{
    "body": "<a id='comment:12'></a>\nGood catch.",
    "created_at": "2017-10-15T15:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454440",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Good catch.



---

archive/issue_comments_454441.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-15T15:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454441",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454442.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-21T19:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454442",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_454443.json:
```json
{
    "body": "Changing branch from \"u/dcoudert/24045\" to \"561100d8aab4f2356e62b12e5b7b9d328913dc27\"",
    "created_at": "2017-10-21T19:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454443",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/dcoudert/24045" to "561100d8aab4f2356e62b12e5b7b9d328913dc27"



---

archive/issue_events_061118.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-21T19:01:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24045#event-61118"
}
```



---

archive/issue_comments_454444.json:
```json
{
    "body": "<a id='comment:14'></a>\nIn all respect, this is code bloat, if you ask me... Indeed, Paley digraphs (and, more generally, tournaments with the same spectral properties as of Payley ones) are essential for constructing Hadamard matrices (and Pasechnik graphs ;-)), and in fact the following lines (only few lines down\nfrom your patch) in \n`src/sage/graphs/generators/families.py`\nconstruct the (Seidel, i.e -1,1) adjacency matrix of such a digraph---and more, they do it for more values of 4n-1 than these which are prime powers, e.g. for n=4.\n\n```\n    from sage.combinat.matrices.hadamard_matrix import skew_hadamard_matrix\n    from sage.matrix.constructor import identity_matrix, matrix\n    H = skew_hadamard_matrix(4*n)\n    M = H[1:].T[1:] - identity_matrix(4*n-1)\n```",
    "created_at": "2017-10-22T20:39:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454444",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
In all respect, this is code bloat, if you ask me... Indeed, Paley digraphs (and, more generally, tournaments with the same spectral properties as of Payley ones) are essential for constructing Hadamard matrices (and Pasechnik graphs ;-)), and in fact the following lines (only few lines down
from your patch) in 
`src/sage/graphs/generators/families.py`
construct the (Seidel, i.e -1,1) adjacency matrix of such a digraph---and more, they do it for more values of 4n-1 than these which are prime powers, e.g. for n=4.

```
    from sage.combinat.matrices.hadamard_matrix import skew_hadamard_matrix
    from sage.matrix.constructor import identity_matrix, matrix
    H = skew_hadamard_matrix(4*n)
    M = H[1:].T[1:] - identity_matrix(4*n-1)
```



---

archive/issue_comments_454445.json:
```json
{
    "body": "Changing commit from \"561100d8aab4f2356e62b12e5b7b9d328913dc27\" to \"\"",
    "created_at": "2017-10-22T20:39:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454445",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "561100d8aab4f2356e62b12e5b7b9d328913dc27" to ""



---

archive/issue_comments_454446.json:
```json
{
    "body": "<a id='comment:15'></a>\nSo what do you suggest?",
    "created_at": "2017-10-22T21:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454446",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:15'></a>
So what do you suggest?



---

archive/issue_comments_454447.json:
```json
{
    "body": "<a id='comment:16'></a>\nWhen I worked on this a couple of years ago I thought long and hard whether I should do a public  interface to this code, and thought it's too much trouble, for noone cares. Wrong :-)\n\n \nAnyhow, the generalisation of Paley digraphs I am talking about is due to A.Duval, [J.Comb.Th. 47(1988) pp. 71-100](http://www.sciencedirect.com/science/article/pii/009731658890043X) \nand is nowadays called strongly regular digraph. We can do a ticket constructing examples---using code in comment 14 above, and Paley would be a subcase (in fact, this code will give you Paley if 4n-1 happens to be a prime power).",
    "created_at": "2017-10-22T21:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454447",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
When I worked on this a couple of years ago I thought long and hard whether I should do a public  interface to this code, and thought it's too much trouble, for noone cares. Wrong :-)

 
Anyhow, the generalisation of Paley digraphs I am talking about is due to A.Duval, [J.Comb.Th. 47(1988) pp. 71-100](http://www.sciencedirect.com/science/article/pii/009731658890043X) 
and is nowadays called strongly regular digraph. We can do a ticket constructing examples---using code in comment 14 above, and Paley would be a subcase (in fact, this code will give you Paley if 4n-1 happens to be a prime power).



---

archive/issue_comments_454448.json:
```json
{
    "body": "<a id='comment:17'></a>\nThat would certainly be useful.",
    "created_at": "2017-10-25T12:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454448",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:17'></a>
That would certainly be useful.



---

archive/issue_comments_454449.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [dcoudert](#comment%3A17):\n> That would certainly be useful.\n\nI've opened #24682 to follow this up.",
    "created_at": "2018-02-07T11:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24045",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24045#issuecomment-454449",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>
Replying to [dcoudert](#comment%3A17):
> That would certainly be useful.

I've opened #24682 to follow this up.
