# Issue 24961: Followup to #21524 -- upgrade broken when gcc spkg is installed

archive/issues_024724.json:
```json
{
    "body": "\n\n**Branch/Commit:** [861a6169213b065fd38240e12e19147009b354c0](https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0)\n\n**Reviewer:** John Palmieri\n\n**Author:** Erik Bray\n\nIssue created by migration from https://trac.sagemath.org/ticket/24961\n\n",
    "closed_at": "2018-03-19T07:57:40Z",
    "created_at": "2018-03-12T19:52:52Z",
    "labels": [
        "component: build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Followup to #21524 -- upgrade broken when gcc spkg is installed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24961",
    "user": "https://github.com/embray"
}
```


**Branch/Commit:** [861a6169213b065fd38240e12e19147009b354c0](https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0)

**Reviewer:** John Palmieri

**Author:** Erik Bray

Issue created by migration from https://trac.sagemath.org/ticket/24961





---

archive/issue_events_225235.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-12T19:53:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225235"
}
```



---

archive/issue_comments_384242.json:
```json
{
    "body": "<a id='comment:2'></a>\nThere was a change in a recent beta to use clang instead of gcc when available. As a result, I have machines which used to build gcc, and indeed in which `$SAGE_LOCAL/bin/gcc` exists, but which now use clang according to Sage's configure:\n\n```\nconfigure:8250: result:     gcc-7.2.0 not installed (configure check)\n```\nSo should you check whether `$(SAGE_LOCAL)/bin/gcc` exists, or should you check whether gcc is going to be installed?",
    "created_at": "2018-03-12T20:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384242",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
There was a change in a recent beta to use clang instead of gcc when available. As a result, I have machines which used to build gcc, and indeed in which `$SAGE_LOCAL/bin/gcc` exists, but which now use clang according to Sage's configure:

```
configure:8250: result:     gcc-7.2.0 not installed (configure check)
```
So should you check whether `$(SAGE_LOCAL)/bin/gcc` exists, or should you check whether gcc is going to be installed?



---

archive/issue_comments_384243.json:
```json
{
    "body": "<a id='comment:3'></a>\nI also don't understand the spacing. I am guessing that the leading space in `GCC_DEP` was put there intentionally in #24703 (maybe so people could concatenate dependencies without worrying about the sort of issue that arose here), so why delete it? It doesn't harm anything, right?",
    "created_at": "2018-03-12T23:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384243",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
I also don't understand the spacing. I am guessing that the leading space in `GCC_DEP` was put there intentionally in #24703 (maybe so people could concatenate dependencies without worrying about the sort of issue that arose here), so why delete it? It doesn't harm anything, right?



---

archive/issue_comments_384244.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [jhpalmieri](#comment%3A3):\n> I also don't understand the spacing. I am guessing that the leading space in `GCC_DEP` was put there intentionally in #24703 (maybe so people could concatenate dependencies without worrying about the sort of issue that arose here), so why delete it? It doesn't harm anything, right?\n\n\nThat leading space was actually needed in the old code, but it's superfluous (albeit harmless, as you say) in the new code.",
    "created_at": "2018-03-13T14:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384244",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
Replying to [jhpalmieri](#comment%3A3):
> I also don't understand the spacing. I am guessing that the leading space in `GCC_DEP` was put there intentionally in #24703 (maybe so people could concatenate dependencies without worrying about the sort of issue that arose here), so why delete it? It doesn't harm anything, right?


That leading space was actually needed in the old code, but it's superfluous (albeit harmless, as you say) in the new code.



---

archive/issue_events_225236.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-03-13T16:37:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225236"
}
```



---

archive/issue_events_225237.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-03-13T16:37:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225237"
}
```



---

archive/issue_comments_384245.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2018-03-13T16:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384245",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_comments_384246.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0\">861a616</a></td><td><code>Fix missing space here</code></td></tr></table>\n",
    "created_at": "2018-03-16T16:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0">861a616</a></td><td><code>Fix missing space here</code></td></tr></table>




---

archive/issue_events_225238.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2018-03-16T16:40:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225238"
}
```



---

archive/issue_events_225239.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2018-03-16T16:40:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225239"
}
```



---

archive/issue_comments_384247.json:
```json
{
    "body": "**Changing commit** from \"[4be4011aed91b29cf6be96f2e482bb6093a49679](https://github.com/sagemath/sagetrac-mirror/commit/4be4011aed91b29cf6be96f2e482bb6093a49679)\" to \"[861a6169213b065fd38240e12e19147009b354c0](https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0)\".",
    "created_at": "2018-03-16T16:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4be4011aed91b29cf6be96f2e482bb6093a49679](https://github.com/sagemath/sagetrac-mirror/commit/4be4011aed91b29cf6be96f2e482bb6093a49679)" to "[861a6169213b065fd38240e12e19147009b354c0](https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0)".



---

archive/issue_comments_384248.json:
```json
{
    "body": "<a id='comment:8'></a>\nWhile we're at it, since this wasn't merged yet here's a quick fix to another bug I found.",
    "created_at": "2018-03-16T16:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384248",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
While we're at it, since this wasn't merged yet here's a quick fix to another bug I found.



---

archive/issue_events_225240.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-16T16:41:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225240"
}
```



---

archive/issue_events_225241.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-16T16:41:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225241"
}
```



---

archive/issue_comments_384249.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/build/makefile-in](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/makefile-in)\" to \"[861a6169213b065fd38240e12e19147009b354c0](https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0)\".",
    "created_at": "2018-03-19T07:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24961#issuecomment-384249",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/embray/build/makefile-in](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/makefile-in)" to "[861a6169213b065fd38240e12e19147009b354c0](https://github.com/sagemath/sagetrac-mirror/commit/861a6169213b065fd38240e12e19147009b354c0)".



---

archive/issue_events_225242.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-19T07:57:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225242"
}
```



---

archive/issue_events_225243.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-19T07:57:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24961",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24961#event-225243"
}
```
