# Issue 24703: Everything should be rebuilt after GCC upgrade

archive/issues_024466.json:
```json
{
    "body": "Due to C++ ABI incompatibilities, problems occur if code built with earlier versions of GCC is linked against code built with newer versions of GCC. This leads for example to patchbot failures mentioned below.\n\nThe simplest solution is to make *every* package depend on the GCC executable. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a big problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).\n\n---\n\nSee [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0. It involves brial and C++ strings.\n\nThe following doctests fail:\n\n```\nsage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to abort\nsage -t --warn-long 67.1 src/sage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # Killed due to abort\nsage -t --warn-long 67.1 src/sage/rings/polynomial/polynomial_ring_constructor.py  # Killed due to abort\n```\n\n**CC:**  @kiwifb @embray\n\n**Branch:** [70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\n\n**Reviewer:** Fran\u00e7ois Bissey\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/24703\n\n",
    "closed_at": "2018-03-02T22:07:32Z",
    "created_at": "2018-02-10T11:32:21Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "title": "Everything should be rebuilt after GCC upgrade",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/24703",
    "user": "https://github.com/jdemeyer"
}
```
Due to C++ ABI incompatibilities, problems occur if code built with earlier versions of GCC is linked against code built with newer versions of GCC. This leads for example to patchbot failures mentioned below.

The simplest solution is to make *every* package depend on the GCC executable. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a big problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).

---

See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0. It involves brial and C++ strings.

The following doctests fail:

```
sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to abort
sage -t --warn-long 67.1 src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # Killed due to abort
sage -t --warn-long 67.1 src/sage/rings/polynomial/polynomial_ring_constructor.py  # Killed due to abort
```

**CC:**  @kiwifb @embray

**Branch:** [70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)

**Reviewer:** François Bissey

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/24703





---

archive/attachments_021738.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "crash_zrVXNw.log",
    "asset_url": "tarball://root/attachments/ticket24703/crash_zrVXNw.log",
    "created_at": "2018-02-10T11:32:30Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_377977.json:
```json
{
    "body": "**Attachment:** [crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log)",
    "created_at": "2018-02-10T11:32:30Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377977",
    "user": "https://github.com/jdemeyer"
}
```

**Attachment:** [crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log)



---

archive/issue_comments_377978.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log)\n``````\n",
    "created_at": "2018-02-10T11:32:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377978",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log)
``````




---

archive/issue_comments_377979.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log)\n+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando patchbot.\n``````\n",
    "created_at": "2018-02-10T11:33:02Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377979",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log)
+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando patchbot.
``````




---

archive/issue_comments_377980.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,8 @@\n-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando patchbot.\n+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot. The following doctests fail:\n+\n+```\n+sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to abort\n+sage -t --warn-long 67.1 src/sage/rings/polynomial/pbori.pyx  # Killed due to abort\n+sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # Killed due to abort\n+sage -t --warn-long 67.1 src/sage/rings/polynomial/polynomial_ring_constructor.py  # Killed due to abort\n+```\n``````\n",
    "created_at": "2018-02-10T11:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377980",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,8 @@
-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando patchbot.
+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot. The following doctests fail:
+
+```
+sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to abort
+sage -t --warn-long 67.1 src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
+sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_libsingular.pyx  # Killed due to abort
+sage -t --warn-long 67.1 src/sage/rings/polynomial/polynomial_ring_constructor.py  # Killed due to abort
+```
``````




---

archive/issue_comments_377981.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot. The following doctests fail:\n+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0.\n+\n+The following doctests fail:\n \n ```\n sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to abort\n``````\n",
    "created_at": "2018-02-10T12:48:50Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377981",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot. The following doctests fail:
+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0.
+
+The following doctests fail:
 
 ```
 sage -t --warn-long 67.1 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to abort
``````




---

archive/issue_events_218993.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-10T12:48:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "rename": {
        "from": "SIGABRT on i686 involving polybori and strings",
        "to": "SIGABRT on i686 involving polybori and C++ strings"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218993"
}
```



---

archive/issue_comments_377982.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2018-02-12T09:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377982",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_comments_377983.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n+Due to C++ ABI incompatibilities, problems occur if code built with earlier versions of GCC is linked against code built with newer versions of GCC. This leads for example to patchbot failures mentioned below.\n+\n+The simplest solution is to make *every* package depend on GCC. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a huge problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).\n+\n+---\n+\n See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0.\n \n The following doctests fail:\n``````\n",
    "created_at": "2018-02-12T09:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377983",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
+Due to C++ ABI incompatibilities, problems occur if code built with earlier versions of GCC is linked against code built with newer versions of GCC. This leads for example to patchbot failures mentioned below.
+
+The simplest solution is to make *every* package depend on GCC. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a huge problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).
+
+---
+
 See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0.
 
 The following doctests fail:
``````




---

archive/issue_events_218994.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-12T09:58:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "rename": {
        "from": "SIGABRT on i686 involving polybori and C++ strings",
        "to": "Everything should be rebuilt after GCC upgrade"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218994"
}
```



---

archive/issue_comments_377984.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n ---\n \n-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0.\n+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0. It involves brial and C++ strings.\n \n The following doctests fail:\n \n``````\n",
    "created_at": "2018-02-12T09:59:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377984",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 ---
 
-See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0.
+See [attachment:crash_zrVXNw.log](https://github.com/sagemath/sage/files/ticket24703/crash_zrVXNw.log) for a crash log from the arando i686 patchbot with Sage 8.2.beta5 using GCC 7.2.0. It involves brial and C++ strings.
 
 The following doctests fail:
 
``````




---

archive/issue_comments_377985.json:
```json
{
    "body": "<a id='comment:7'></a>\nYup, pretty much anything that use C++ has to be rebuilt when you move to gcc-5. gcc dev have made some commitments to ABI stability for the time being. But then you also have the change of ABI for gfortran at gcc-7. The only thing that's rock solid for almost ever is C.",
    "created_at": "2018-02-12T10:03:12Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377985",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
Yup, pretty much anything that use C++ has to be rebuilt when you move to gcc-5. gcc dev have made some commitments to ABI stability for the time being. But then you also have the change of ABI for gfortran at gcc-7. The only thing that's rock solid for almost ever is C.



---

archive/issue_comments_377986.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)",
    "created_at": "2018-02-14T10:31:58Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377986",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)



---

archive/issue_comments_377987.json:
```json
{
    "body": "**Commit:** [c59430df6ba5b9e7b6ba0c29aa077a12a97e748e](https://github.com/sagemath/sagetrac-mirror/commit/c59430df6ba5b9e7b6ba0c29aa077a12a97e748e)",
    "created_at": "2018-02-14T11:30:38Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [c59430df6ba5b9e7b6ba0c29aa077a12a97e748e](https://github.com/sagemath/sagetrac-mirror/commit/c59430df6ba5b9e7b6ba0c29aa077a12a97e748e)



---

archive/issue_comments_377988.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c59430df6ba5b9e7b6ba0c29aa077a12a97e748e\">c59430d</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>\n",
    "created_at": "2018-02-14T11:30:38Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c59430df6ba5b9e7b6ba0c29aa077a12a97e748e">c59430d</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>




---

archive/issue_comments_377989.json:
```json
{
    "body": "**Changing commit** from \"[c59430df6ba5b9e7b6ba0c29aa077a12a97e748e](https://github.com/sagemath/sagetrac-mirror/commit/c59430df6ba5b9e7b6ba0c29aa077a12a97e748e)\" to \"[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)\".",
    "created_at": "2018-02-14T11:32:51Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c59430df6ba5b9e7b6ba0c29aa077a12a97e748e](https://github.com/sagemath/sagetrac-mirror/commit/c59430df6ba5b9e7b6ba0c29aa077a12a97e748e)" to "[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)".



---

archive/issue_comments_377990.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af\">057b434</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>\n",
    "created_at": "2018-02-14T11:32:51Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af">057b434</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>




---

archive/issue_events_218995.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-14T12:44:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218995"
}
```



---

archive/issue_comments_377991.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Due to C++ ABI incompatibilities, problems occur if code built with earlier versions of GCC is linked against code built with newer versions of GCC. This leads for example to patchbot failures mentioned below.\n \n-The simplest solution is to make *every* package depend on GCC. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a huge problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).\n+The simplest solution is to make *every* package depend on the GCC executable. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a big problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).\n \n ---\n \n``````\n",
    "created_at": "2018-02-16T19:03:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377991",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Due to C++ ABI incompatibilities, problems occur if code built with earlier versions of GCC is linked against code built with newer versions of GCC. This leads for example to patchbot failures mentioned below.
 
-The simplest solution is to make *every* package depend on GCC. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a huge problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).
+The simplest solution is to make *every* package depend on the GCC executable. This way, a GCC upgrade will force everything to be rebuilt. This may be overkill, but it's not a big problem in practice since GCC is upgraded rarely (unlikely other Sage packages, it is never automatically rebuilt except if absolutely needed, see for example #24599).
 
 ---
 
``````




---

archive/issue_events_218996.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-02-18T21:15:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218996"
}
```



---

archive/issue_events_218997.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-02-18T21:15:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218997"
}
```



---

archive/issue_comments_377992.json:
```json
{
    "body": "**Reviewer:** Fran\u00e7ois Bissey",
    "created_at": "2018-02-18T21:15:38Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377992",
    "user": "https://github.com/kiwifb"
}
```

**Reviewer:** François Bissey



---

archive/issue_comments_377993.json:
```json
{
    "body": "<a id='comment:13'></a>\nNot sure why the patchbot is failing but the stuff looks good me, and we should include it ASAP.",
    "created_at": "2018-02-18T21:15:38Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377993",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>
Not sure why the patchbot is failing but the stuff looks good me, and we should include it ASAP.



---

archive/issue_comments_377994.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [fbissey](#comment%3A13):\n> Not sure why the patchbot is failing but the stuff looks good me, and we should include it ASAP.\n\n\nI need to upgrade that patchbot.  It's running an old version of the patchbot package that has a bug when testing \"unsafe\" tickets.",
    "created_at": "2018-02-19T16:40:33Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377994",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
Replying to [fbissey](#comment%3A13):
> Not sure why the patchbot is failing but the stuff looks good me, and we should include it ASAP.


I need to upgrade that patchbot.  It's running an old version of the patchbot package that has a bug when testing "unsafe" tickets.



---

archive/issue_comments_377995.json:
```json
{
    "body": "<a id='comment:15'></a>\nOkay, I don't really care since I'm not in the habit of building gcc anyways, but I would appreciate if someone sign off on #21524 so I don't have to keep upgrading it to incorporate changes like this.",
    "created_at": "2018-02-19T16:43:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377995",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>
Okay, I don't really care since I'm not in the habit of building gcc anyways, but I would appreciate if someone sign off on #21524 so I don't have to keep upgrading it to incorporate changes like this.



---

archive/issue_comments_377996.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)\" to \"[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)\".",
    "created_at": "2018-02-20T23:08:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377996",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)" to "[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)".



---

archive/issue_events_218998.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-20T23:08:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218998"
}
```



---

archive/issue_events_218999.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-20T23:08:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-218999"
}
```



---

archive/issue_comments_377997.json:
```json
{
    "body": "**Changing commit** from \"[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)\" to \"\".",
    "created_at": "2018-02-28T07:50:10Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377997",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)" to "".



---

archive/issue_comments_377998.json:
```json
{
    "body": "<a id='comment:17'></a>\nBreaks full build on Debian 7 (both 32 and 64 bit)\n\nPPL: \n\n```\nconfigure: error: Cannot find GMP version 4.1.3 or higher.\nGMP is the GNU Multi-Precision library:\nsee http://www.swox.com/gmp/ for more information.\nWhen compiling the GMP library, do not forget to enable the C++ interface:\nadd --enable-cxx to the configuration options.\nError configuring the Parma Polyhedra Library.\n```\n\nGivaro:\n\n```\nchecking for GMP library... yes\nchecking gmpxx.h usability... no\nchecking gmpxx.h presence... no\nchecking for gmpxx.h... no\nyour GMP does not have c++ support. Compile GMP with --enable-cxx\n********************************************************************************\nError configuring givaro-4.0.4\n********************************************************************************\n```",
    "created_at": "2018-02-28T07:50:10Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377998",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>
Breaks full build on Debian 7 (both 32 and 64 bit)

PPL: 

```
configure: error: Cannot find GMP version 4.1.3 or higher.
GMP is the GNU Multi-Precision library:
see http://www.swox.com/gmp/ for more information.
When compiling the GMP library, do not forget to enable the C++ interface:
add --enable-cxx to the configuration options.
Error configuring the Parma Polyhedra Library.
```

Givaro:

```
checking for GMP library... yes
checking gmpxx.h usability... no
checking gmpxx.h presence... no
checking for gmpxx.h... no
your GMP does not have c++ support. Compile GMP with --enable-cxx
********************************************************************************
Error configuring givaro-4.0.4
********************************************************************************
```



---

archive/issue_comments_377999.json:
```json
{
    "body": "<a id='comment:18'></a>\nDo you happen to have the `install.log` file?",
    "created_at": "2018-02-28T08:38:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-377999",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Do you happen to have the `install.log` file?



---

archive/issue_comments_378000.json:
```json
{
    "body": "**Changing branch** from \"[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)\" to \"[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)\".",
    "created_at": "2018-02-28T13:25:24Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378000",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)" to "[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)".



---

archive/issue_comments_378001.json:
```json
{
    "body": "**Commit:** [70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)",
    "created_at": "2018-02-28T13:28:15Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378001",
    "user": "https://github.com/jdemeyer"
}
```

**Commit:** [70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)



---

archive/issue_events_219000.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T13:28:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219000"
}
```



---

archive/issue_comments_378002.json:
```json
{
    "body": "<a id='comment:21'></a>\nReverted this:\n\n```diff\n--- a/build/pkgs/gcc/spkg-install\n+++ b/build/pkgs/gcc/spkg-install\n@@ -124,7 +124,7 @@ $MAKE install\n \n # Mark gfortran as not installed in case gfortran was installed earlier\n cd \"$SAGE_SPKG_INST\"\n-rm -f gmp-* mpir-* mpfr-* mpc-* gfortran-*\n+rm -f gfortran-*\n \n # Force re-configuration: the next time that \"make\" is run, we need to\n # rebuild all packages (#24703) but we should not rebuild gcc (#19324)\n```\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d\">70ff832</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>\n",
    "created_at": "2018-02-28T13:28:15Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378002",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Reverted this:

```diff
--- a/build/pkgs/gcc/spkg-install
+++ b/build/pkgs/gcc/spkg-install
@@ -124,7 +124,7 @@ $MAKE install
 
 # Mark gfortran as not installed in case gfortran was installed earlier
 cd "$SAGE_SPKG_INST"
-rm -f gmp-* mpir-* mpfr-* mpc-* gfortran-*
+rm -f gfortran-*
 
 # Force re-configuration: the next time that "make" is run, we need to
 # rebuild all packages (#24703) but we should not rebuild gcc (#19324)
```

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d">70ff832</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>




---

archive/issue_events_219001.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T13:28:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219001"
}
```



---

archive/issue_events_219002.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-28T13:28:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219002"
}
```



---

archive/issue_events_219003.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-28T22:53:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219003"
}
```



---

archive/issue_events_219004.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "c6fc4193d4359967f60759501cbf30aaa648ba05",
    "created_at": "2018-02-28T22:53:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219004"
}
```



---

archive/issue_comments_378003.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)\" to \"[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\".",
    "created_at": "2018-02-28T22:53:09Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378003",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)" to "[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)".



---

archive/issue_comments_378004.json:
```json
{
    "body": "**Changing commit** from \"[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\" to \"\".",
    "created_at": "2018-03-01T23:10:36Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378004",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)" to "".



---

archive/issue_comments_378005.json:
```json
{
    "body": "<a id='comment:24'></a>\nhttp://build.sagemath.org/#/builders/30/builds/6/steps/6/logs/matplotlib\n\nBuilding matplotlib still fails on Debian 7 64-bit with \n\n```\n    gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -DPY_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__image_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/home/buildbot/slave/sage_git/build/local/include -I. -Iextern/agg24-svn/include -I/home/buildbot/slave/sage_git/build/local/include/python2.7 -c src/py_converters.cpp -o build/temp.linux-x86_64-2.7/src/py_converters.o\n    In file included from /home/buildbot/slave/sage_git/build/local/include/python2.7/Python.h:19:0,\n                     from src/py_converters.h:16,\n                     from src/py_converters.cpp:3:\n    /usr/include/limits.h:125:26: error: no include path in which to search for limits.h\n     # include_next <limits.h>\n                              ^\n    In file included from src/py_converters.h:16:0,\n                     from src/py_converters.cpp:3:\n    /home/buildbot/slave/sage_git/build/local/include/python2.7/Python.h:22:2: error: #error \"Something's broken.  UCHAR_MAX should be defined in limits.h.\"\n     #error \"Something's broken.  UCHAR_MAX should be defined in limits.h.\"\n```",
    "created_at": "2018-03-01T23:10:36Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378005",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>
http://build.sagemath.org/#/builders/30/builds/6/steps/6/logs/matplotlib

Building matplotlib still fails on Debian 7 64-bit with 

```
    gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -DPY_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__image_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/home/buildbot/slave/sage_git/build/local/include -I. -Iextern/agg24-svn/include -I/home/buildbot/slave/sage_git/build/local/include/python2.7 -c src/py_converters.cpp -o build/temp.linux-x86_64-2.7/src/py_converters.o
    In file included from /home/buildbot/slave/sage_git/build/local/include/python2.7/Python.h:19:0,
                     from src/py_converters.h:16,
                     from src/py_converters.cpp:3:
    /usr/include/limits.h:125:26: error: no include path in which to search for limits.h
     # include_next <limits.h>
                              ^
    In file included from src/py_converters.h:16:0,
                     from src/py_converters.cpp:3:
    /home/buildbot/slave/sage_git/build/local/include/python2.7/Python.h:22:2: error: #error "Something's broken.  UCHAR_MAX should be defined in limits.h."
     #error "Something's broken.  UCHAR_MAX should be defined in limits.h."
```



---

archive/issue_comments_378006.json:
```json
{
    "body": "<a id='comment:25'></a>\nI don't see how that error is related to this ticket.",
    "created_at": "2018-03-02T09:01:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378006",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
I don't see how that error is related to this ticket.



---

archive/issue_comments_378007.json:
```json
{
    "body": "<a id='comment:26'></a>\nApparently the build was interleaved with gcc, which shouldn't happen. This also happens after backing out the ticket so its either a preexisting issue or the makefile isn't regenerated. This is the second build of gcc, it builds in parallel with everything else.",
    "created_at": "2018-03-02T10:49:32Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378007",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>
Apparently the build was interleaved with gcc, which shouldn't happen. This also happens after backing out the ticket so its either a preexisting issue or the makefile isn't regenerated. This is the second build of gcc, it builds in parallel with everything else.



---

archive/issue_comments_378008.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [vbraun](#comment%3A26):\n> This also happens after backing out the ticket\n\n\nI think it's a bug in the *previous* version of this ticket then.\n\n> This is the second build of gcc\n\n\nThere shouldn't be a second build of gcc.\n\nIt would be very useful to see the auto-generated `build/make/Makefile` from the failed build to understand what is happening.",
    "created_at": "2018-03-02T12:36:51Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378008",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Replying to [vbraun](#comment%3A26):
> This also happens after backing out the ticket


I think it's a bug in the *previous* version of this ticket then.

> This is the second build of gcc


There shouldn't be a second build of gcc.

It would be very useful to see the auto-generated `build/make/Makefile` from the failed build to understand what is happening.



---

archive/issue_events_219005.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T12:36:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219005"
}
```



---

archive/issue_events_219006.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T12:36:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219006"
}
```



---

archive/issue_events_219007.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-02T12:36:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219007"
}
```



---

archive/attachments_021739.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "Makefile",
    "asset_url": "tarball://root/attachments/ticket24703/Makefile",
    "created_at": "2018-03-02T13:55:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket24703/Makefile",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_378009.json:
```json
{
    "body": "**Attachment:** [Makefile](https://github.com/sagemath/sage/files/ticket24703/Makefile)",
    "created_at": "2018-03-02T13:55:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378009",
    "user": "https://github.com/vbraun"
}
```

**Attachment:** [Makefile](https://github.com/sagemath/sage/files/ticket24703/Makefile)



---

archive/issue_comments_378010.json:
```json
{
    "body": "<a id='comment:29'></a>\nI attached the makefile...",
    "created_at": "2018-03-02T13:56:04Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378010",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:29'></a>
I attached the makefile...



---

archive/issue_comments_378011.json:
```json
{
    "body": "<a id='comment:30'></a>\nI checked out just this ticket and ran `make distclean && make` and gcc builds twice\n\n```\nbuildbot@sagebd07_64s02:~/slave/sage_git/build$ grep 'Found local metadata for gcc' logs/install.log \n[gcc-7.2.0] Found local metadata for gcc-7.2.0\n[gcc-7.2.0] Found local metadata for gcc-7.2.0\n```\nand the second time is in parallel with lots of other stuff...",
    "created_at": "2018-03-02T14:42:00Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378011",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'></a>
I checked out just this ticket and ran `make distclean && make` and gcc builds twice

```
buildbot@sagebd07_64s02:~/slave/sage_git/build$ grep 'Found local metadata for gcc' logs/install.log 
[gcc-7.2.0] Found local metadata for gcc-7.2.0
[gcc-7.2.0] Found local metadata for gcc-7.2.0
```
and the second time is in parallel with lots of other stuff...



---

archive/issue_comments_378012.json:
```json
{
    "body": "<a id='comment:31'></a>\nOK, I think I know what happened: there is indeed a serious bug that GCC is installed twice.\n\nBut that bug is not because of this ticket, it is most likely happening since #24599. I think you are just unlucky to hit this bug now and not before.",
    "created_at": "2018-03-02T19:35:36Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378012",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>
OK, I think I know what happened: there is indeed a serious bug that GCC is installed twice.

But that bug is not because of this ticket, it is most likely happening since #24599. I think you are just unlucky to hit this bug now and not before.



---

archive/issue_comments_378013.json:
```json
{
    "body": "<a id='comment:32'></a>\nI would rather prefer to merge this ticket anyway and then deal with further fixes to the GCC build process in a future ticket.",
    "created_at": "2018-03-02T19:37:14Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378013",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>
I would rather prefer to merge this ticket anyway and then deal with further fixes to the GCC build process in a future ticket.



---

archive/issue_comments_378014.json:
```json
{
    "body": "<a id='comment:33'></a>\nSure, did you open a followup ticket?",
    "created_at": "2018-03-02T22:04:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378014",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'></a>
Sure, did you open a followup ticket?



---

archive/issue_comments_378015.json:
```json
{
    "body": "**Changing branch** from \"[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\" to \"[u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)\".",
    "created_at": "2018-03-02T22:05:56Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378015",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)" to "[u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)".



---

archive/issue_comments_378016.json:
```json
{
    "body": "**Commit:** [057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)",
    "created_at": "2018-03-02T22:05:56Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378016",
    "user": "https://github.com/vbraun"
}
```

**Commit:** [057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)



---

archive/issue_comments_378017.json:
```json
{
    "body": "<a id='comment:34'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af\">057b434</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>\n",
    "created_at": "2018-03-02T22:05:56Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378017",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af">057b434</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>




---

archive/issue_comments_378018.json:
```json
{
    "body": "<a id='comment:35'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d\">70ff832</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>\n",
    "created_at": "2018-03-02T22:06:53Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378018",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:35'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d">70ff832</a></td><td><code>Everything should be rebuilt after GCC upgrade</code></td></tr></table>




---

archive/issue_comments_378019.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)\" to \"[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)\".",
    "created_at": "2018-03-02T22:06:53Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378019",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/everything_should_be_rebuilt_after_gcc_upgrade)" to "[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)".



---

archive/issue_comments_378020.json:
```json
{
    "body": "**Changing commit** from \"[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)\" to \"[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\".",
    "created_at": "2018-03-02T22:06:53Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378020",
    "user": "https://github.com/vbraun"
}
```

**Changing commit** from "[057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/commit/057b434babb6ec6eaa7bae4afad4255a7481b1af)" to "[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)".



---

archive/issue_events_219008.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-02T22:07:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219008"
}
```



---

archive/issue_events_219009.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "c6fc4193d4359967f60759501cbf30aaa648ba05",
    "created_at": "2018-03-02T22:07:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24703#event-219009"
}
```



---

archive/issue_comments_378021.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)\" to \"[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\".",
    "created_at": "2018-03-02T22:07:32Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378021",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/057b434babb6ec6eaa7bae4afad4255a7481b1af)" to "[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)".



---

archive/issue_comments_378022.json:
```json
{
    "body": "<a id='comment:37'></a>\nA question related to #24961: should we be checking that `x$SAGE_INSTALL_GCC = xexists` or that `x$SAGE_INSTALL_GCC = xyes`? On an OS X machine, I have Sage's gcc installed (from a few betas ago), but now Sage uses clang instead of gcc, so Sage's gcc will not be rebuilt as I upgraded Sage.",
    "created_at": "2018-03-12T23:42:07Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378022",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:37'></a>
A question related to #24961: should we be checking that `x$SAGE_INSTALL_GCC = xexists` or that `x$SAGE_INSTALL_GCC = xyes`? On an OS X machine, I have Sage's gcc installed (from a few betas ago), but now Sage uses clang instead of gcc, so Sage's gcc will not be rebuilt as I upgraded Sage.



---

archive/issue_comments_378023.json:
```json
{
    "body": "**Changing commit** from \"[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)\" to \"\".",
    "created_at": "2018-03-12T23:42:07Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378023",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing commit** from "[70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d](https://github.com/sagemath/sagetrac-mirror/commit/70ff832bc5ca84610c1b3b8fab34c4564ea6cc3d)" to "".



---

archive/issue_comments_378024.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [jhpalmieri](#comment%3A37):\n> A question related to #24961: should we be checking that `x$SAGE_INSTALL_GCC = xexists` or that `x$SAGE_INSTALL_GCC = xyes`? On an OS X machine, I have Sage's gcc installed (from a few betas ago), but now Sage uses clang instead of gcc, so Sage's gcc will not be rebuilt as I upgraded Sage.\n\n\nReally, you need to check both, with the caveat that if you installed with clang and want to switch to gcc you will break your install. So, unfortunately, a not so stupid user could break things.",
    "created_at": "2018-03-13T00:02:02Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378024",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:38'></a>
Replying to [jhpalmieri](#comment%3A37):
> A question related to #24961: should we be checking that `x$SAGE_INSTALL_GCC = xexists` or that `x$SAGE_INSTALL_GCC = xyes`? On an OS X machine, I have Sage's gcc installed (from a few betas ago), but now Sage uses clang instead of gcc, so Sage's gcc will not be rebuilt as I upgraded Sage.


Really, you need to check both, with the caveat that if you installed with clang and want to switch to gcc you will break your install. So, unfortunately, a not so stupid user could break things.



---

archive/issue_comments_378025.json:
```json
{
    "body": "<a id='comment:39'></a>\nIn my case, I switched from gcc (the default) to clang (the new default), and upgrading to the most recent beta broke things, because this test ended up adding bad stuff to `build/make/Makefile`, as reported in sage-release and #21524, and now being fixed in #24961.",
    "created_at": "2018-03-13T02:24:43Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378025",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:39'></a>
In my case, I switched from gcc (the default) to clang (the new default), and upgrading to the most recent beta broke things, because this test ended up adding bad stuff to `build/make/Makefile`, as reported in sage-release and #21524, and now being fixed in #24961.



---

archive/issue_comments_378026.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [jhpalmieri](#comment%3A39):\n> In my case, I switched from gcc (the default) to clang (the new default)\n\n\nAre you sure? If the GCC spkg is installed, it should be used by Sage. If this is not the case, I consider that a bug.",
    "created_at": "2018-03-13T09:02:07Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378026",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
Replying to [jhpalmieri](#comment%3A39):
> In my case, I switched from gcc (the default) to clang (the new default)


Are you sure? If the GCC spkg is installed, it should be used by Sage. If this is not the case, I consider that a bug.



---

archive/issue_comments_378027.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [fbissey](#comment%3A38):\n> Replying to [jhpalmieri](#comment%3A37):\n> > A question related to #24961: should we be checking that `x$SAGE_INSTALL_GCC = xexists` or that `x$SAGE_INSTALL_GCC = xyes`? On an OS X machine, I have Sage's gcc installed (from a few betas ago), but now Sage uses clang instead of gcc, so Sage's gcc will not be rebuilt as I upgraded Sage.\n\n> \n> Really, you need to check both\n\n\nI don't see why, but maybe I'm missing something?",
    "created_at": "2018-03-13T09:04:41Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378027",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>
Replying to [fbissey](#comment%3A38):
> Replying to [jhpalmieri](#comment%3A37):
> > A question related to #24961: should we be checking that `x$SAGE_INSTALL_GCC = xexists` or that `x$SAGE_INSTALL_GCC = xyes`? On an OS X machine, I have Sage's gcc installed (from a few betas ago), but now Sage uses clang instead of gcc, so Sage's gcc will not be rebuilt as I upgraded Sage.

> 
> Really, you need to check both


I don't see why, but maybe I'm missing something?



---

archive/issue_comments_378028.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [jdemeyer](#comment%3A40):\n> Replying to [jhpalmieri](#comment%3A39):\n> > In my case, I switched from gcc (the default) to clang (the new default)\n\n> \n> Are you sure? If the GCC spkg is installed, it should be used by Sage. If this is not the case, I consider that a bug.\n\n\nI guess you're right, gcc is used, but `configure` tells me that `gcc` will not be installed.",
    "created_at": "2018-03-13T14:45:26Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378028",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:42'></a>
Replying to [jdemeyer](#comment%3A40):
> Replying to [jhpalmieri](#comment%3A39):
> > In my case, I switched from gcc (the default) to clang (the new default)

> 
> Are you sure? If the GCC spkg is installed, it should be used by Sage. If this is not the case, I consider that a bug.


I guess you're right, gcc is used, but `configure` tells me that `gcc` will not be installed.



---

archive/issue_comments_378029.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [jhpalmieri](#comment%3A42):\n> `configure` tells me that `gcc` will not be installed.\n\n\nIt won't be installed if it's already installed. Consider that a feature.",
    "created_at": "2018-03-13T14:51:36Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378029",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'></a>
Replying to [jhpalmieri](#comment%3A42):
> `configure` tells me that `gcc` will not be installed.


It won't be installed if it's already installed. Consider that a feature.



---

archive/issue_comments_378030.json:
```json
{
    "body": "<a id='comment:44'></a>\nI also consider it a feature if it's not installed because clang is going to be used instead. `configure` does not give a reason for it not being installed, leaving me to guess as to what's going on.",
    "created_at": "2018-03-13T15:02:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378030",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'></a>
I also consider it a feature if it's not installed because clang is going to be used instead. `configure` does not give a reason for it not being installed, leaving me to guess as to what's going on.



---

archive/issue_comments_378031.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [jhpalmieri](#comment%3A44):\n> I also consider it a feature if it's not installed because clang is going to be used instead.\n\n\nOf course. But that should work now, right?",
    "created_at": "2018-03-13T15:05:08Z",
    "issue": "https://github.com/sagemath/sage/issues/24703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24703#issuecomment-378031",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>
Replying to [jhpalmieri](#comment%3A44):
> I also consider it a feature if it's not installed because clang is going to be used instead.


Of course. But that should work now, right?
