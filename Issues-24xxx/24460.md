# Issue 24460: py3: fixes to sage.libs.gap

archive/issues_024223.json:
```json
{
    "body": "These are the minimal fixes I needed to get all the tests passing for `sage.libs.gap` (to be clear, this required fixes in other modules as well--these are just the fixes in `sage.libs.gap` itself).\n\nMostly just minor string conversion fixes, and one or two other little things.\n\nKeywords: libs gap libgap\n\nBranch/Commit: 9577dc890a118e24a8f62f52a5b1b52756136a6b\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24460\n\n",
    "closed_at": "2018-05-14T17:36:09Z",
    "created_at": "2018-01-02T13:12:05Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "py3: fixes to sage.libs.gap",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24460",
    "user": "https://github.com/embray"
}
```
These are the minimal fixes I needed to get all the tests passing for `sage.libs.gap` (to be clear, this required fixes in other modules as well--these are just the fixes in `sage.libs.gap` itself).

Mostly just minor string conversion fixes, and one or two other little things.

Keywords: libs gap libgap

Branch/Commit: 9577dc890a118e24a8f62f52a5b1b52756136a6b

Reviewer: Frédéric Chapoton

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24460





---

archive/issue_comments_463029.json:
```json
{
    "body": "Changing commit from \"\" to \"f0ac52efe5c4733c326c0caf4f79146e69c2a2bc\"",
    "created_at": "2018-01-02T13:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463029",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "f0ac52efe5c4733c326c0caf4f79146e69c2a2bc"



---

archive/issue_comments_463030.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-02T13:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_463031.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-23T14:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463031",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_463032.json:
```json
{
    "body": "<a id='comment:2'></a>This was just waiting on #24313 which is now closed.",
    "created_at": "2018-02-23T14:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463032",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'></a>This was just waiting on #24313 which is now closed.



---

archive/issue_comments_463033.json:
```json
{
    "body": "Changing dependencies from \"#24313\" to \"#24313 #24559\"",
    "created_at": "2018-02-23T14:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463033",
    "user": "https://github.com/embray"
}
```

Changing dependencies from "#24313" to "#24313 #24559"



---

archive/issue_comments_463034.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-23T14:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463034",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_463035.json:
```json
{
    "body": "<a id='comment:3'></a>Upon giving this another look over, some of the test fixes in this branch won't be necessary with #24559.",
    "created_at": "2018-02-23T14:19:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463035",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>Upon giving this another look over, some of the test fixes in this branch won't be necessary with #24559.



---

archive/issue_comments_463036.json:
```json
{
    "body": "Changing commit from \"f0ac52efe5c4733c326c0caf4f79146e69c2a2bc\" to \"6a3074777ee9bf7d8d100d0f0416dfe8c49634cb\"",
    "created_at": "2018-02-23T16:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463036",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f0ac52efe5c4733c326c0caf4f79146e69c2a2bc" to "6a3074777ee9bf7d8d100d0f0416dfe8c49634cb"



---

archive/issue_comments_463037.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2018-02-23T16:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463037",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_463038.json:
```json
{
    "body": "Changing commit from \"6a3074777ee9bf7d8d100d0f0416dfe8c49634cb\" to \"a05e28e80c38c67967a7d57832b01ae1508900c9\"",
    "created_at": "2018-02-23T16:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463038",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6a3074777ee9bf7d8d100d0f0416dfe8c49634cb" to "a05e28e80c38c67967a7d57832b01ae1508900c9"



---

archive/issue_comments_463039.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-02-23T16:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_463040.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-23T16:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463040",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_463041.json:
```json
{
    "body": "<a id='comment:6'></a>Slightly reworked the test changes--by incorporating #24559 this doesn't require any `# py2` or `# py3` flags.",
    "created_at": "2018-02-23T16:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463041",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>Slightly reworked the test changes--by incorporating #24559 this doesn't require any `# py2` or `# py3` flags.



---

archive/issue_comments_463042.json:
```json
{
    "body": "Changing commit from \"a05e28e80c38c67967a7d57832b01ae1508900c9\" to \"9577dc890a118e24a8f62f52a5b1b52756136a6b\"",
    "created_at": "2018-03-16T13:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463042",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a05e28e80c38c67967a7d57832b01ae1508900c9" to "9577dc890a118e24a8f62f52a5b1b52756136a6b"



---

archive/issue_comments_463043.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-16T13:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463043",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_463044.json:
```json
{
    "body": "<a id='comment:8'></a>This still has a soft dependency on #24559 in order for some of the tests to pass on Python 3, but I didn't include it explicitly in this branch (since it might still evolve).",
    "created_at": "2018-03-16T13:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463044",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>This still has a soft dependency on #24559 in order for some of the tests to pass on Python 3, but I didn't include it explicitly in this branch (since it might still evolve).



---

archive/issue_comments_463045.json:
```json
{
    "body": "<a id='comment:9'></a>I'm not getting it all clear\n\n```\nsage -t src/sage/libs/gap/element.pyx  # 21 doctests failed\nsage -t src/sage/libs/gap/libgap.pyx  # 4 doctests failed\n```",
    "created_at": "2018-03-16T13:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463045",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>I'm not getting it all clear

```
sage -t src/sage/libs/gap/element.pyx  # 21 doctests failed
sage -t src/sage/libs/gap/libgap.pyx  # 4 doctests failed
```



---

archive/issue_comments_463046.json:
```json
{
    "body": "Changing keywords from \"\" to \"libs gap libgap\".",
    "created_at": "2018-03-16T13:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463046",
    "user": "https://github.com/embray"
}
```

Changing keywords from "" to "libs gap libgap".



---

archive/issue_comments_463047.json:
```json
{
    "body": "<a id='comment:11'></a>I see things like\n\n```\nFile \"src/sage/libs/gap/element.pyx\", line 1562, in sage.libs.gap.element.GapElement_FiniteField.sage\nFailed example:\n    n.sage()\nExpected:\n    a + 3\nGot:\n    1.6*a + 3\n```\nwhich make no sense whatsoever (fields are finite here, `1.6` does not belong there.\nCould it be #24559 ?",
    "created_at": "2018-03-16T13:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463047",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>I see things like

```
File "src/sage/libs/gap/element.pyx", line 1562, in sage.libs.gap.element.GapElement_FiniteField.sage
Failed example:
    n.sage()
Expected:
    a + 3
Got:
    1.6*a + 3
```
which make no sense whatsoever (fields are finite here, `1.6` does not belong there.
Could it be #24559 ?



---

archive/issue_comments_463048.json:
```json
{
    "body": "Changing keywords from \"libs gap libgap\" to \"\".",
    "created_at": "2018-03-16T13:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463048",
    "user": "https://github.com/dimpase"
}
```

Changing keywords from "libs gap libgap" to "".



---

archive/issue_comments_463049.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [gh-dimpase](#comment%3A9):\n> I'm not getting it all clear\n> \n> ```\n> sage -t src/sage/libs/gap/element.pyx  # 21 doctests failed\n> sage -t src/sage/libs/gap/libgap.pyx  # 4 doctests failed\n> ```\n\n\nIf you're applying this just on top of the develop branch (or even develop + a few other branches) you won't get all tests passing.  \n\nOn my Python 3 branch where I have *lots* of other fixes merged in, all the tests pass, but if you just test this ticket on its own it won't fix everything, because there are other errors that come from outside `sage.libs.gap`.  This just applies the fixes specifically in that package needed for that package to pass.",
    "created_at": "2018-03-16T13:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463049",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>Replying to [gh-dimpase](#comment%3A9):
> I'm not getting it all clear
> 
> ```
> sage -t src/sage/libs/gap/element.pyx  # 21 doctests failed
> sage -t src/sage/libs/gap/libgap.pyx  # 4 doctests failed
> ```


If you're applying this just on top of the develop branch (or even develop + a few other branches) you won't get all tests passing.  

On my Python 3 branch where I have *lots* of other fixes merged in, all the tests pass, but if you just test this ticket on its own it won't fix everything, because there are other errors that come from outside `sage.libs.gap`.  This just applies the fixes specifically in that package needed for that package to pass.



---

archive/issue_comments_463050.json:
```json
{
    "body": "Changing keywords from \"\" to \"libs gap libgap\".",
    "created_at": "2018-03-16T13:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463050",
    "user": "https://github.com/embray"
}
```

Changing keywords from "" to "libs gap libgap".



---

archive/issue_comments_463051.json:
```json
{
    "body": "<a id='comment:13'></a>Well, I do merge all the dependencies you provide...\nI cannot review something unpublished, you know :-)",
    "created_at": "2018-03-16T14:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463051",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>Well, I do merge all the dependencies you provide...
I cannot review something unpublished, you know :-)



---

archive/issue_comments_463052.json:
```json
{
    "body": "<a id='comment:14'></a>It would be more than just the dependencies listed on this ticket.  There are still *lots* of bugs on python 3 and most of them are unrelated to each other in terms of the fixes.  But if you run the test suite for some large package then of course you'll get test failures due to other bugs in other packages.",
    "created_at": "2018-03-16T16:27:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463052",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>It would be more than just the dependencies listed on this ticket.  There are still *lots* of bugs on python 3 and most of them are unrelated to each other in terms of the fixes.  But if you run the test suite for some large package then of course you'll get test failures due to other bugs in other packages.



---

archive/issue_comments_463053.json:
```json
{
    "body": "<a id='comment:15'></a>well, sure, I also took #24559 and its dependencies. Anything else?",
    "created_at": "2018-03-16T17:16:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463053",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>well, sure, I also took #24559 and its dependencies. Anything else?



---

archive/issue_comments_463054.json:
```json
{
    "body": "<a id='comment:16'></a>~~Although, I also don't much see the downside to wrapping *most* `mpz_` functions with `sig_block/unblock()`--any that modify the internal datastructures of one or more of its arguments--and that aren't expected to take long to run.  Of course, this would be tedious, so we'd have to generate the wrappers automatically.~~\n\nOops, wrong ticket.",
    "created_at": "2018-03-19T11:08:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463054",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>~~Although, I also don't much see the downside to wrapping *most* `mpz_` functions with `sig_block/unblock()`--any that modify the internal datastructures of one or more of its arguments--and that aren't expected to take long to run.  Of course, this would be tedious, so we'd have to generate the wrappers automatically.~~

Oops, wrong ticket.



---

archive/issue_events_061752.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-26T12:13:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24460#event-61752"
}
```



---

archive/issue_comments_463055.json:
```json
{
    "body": "Changing dependencies from \"#24313 #24559\" to \"\"",
    "created_at": "2018-05-11T12:13:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463055",
    "user": "https://github.com/fchapoton"
}
```

Changing dependencies from "#24313 #24559" to ""



---

archive/issue_comments_463056.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-11T17:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463056",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_463057.json:
```json
{
    "body": "<a id='comment:19'></a>ok, let it be",
    "created_at": "2018-05-11T17:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463057",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>ok, let it be



---

archive/issue_comments_463058.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2018-05-11T17:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463058",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton"



---

archive/issue_events_061753.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-14T17:36:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24460#event-61753"
}
```



---

archive/issue_comments_463059.json:
```json
{
    "body": "Changing branch from \"u/embray/python3/sage-libs-gap\" to \"9577dc890a118e24a8f62f52a5b1b52756136a6b\"",
    "created_at": "2018-05-14T17:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463059",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/embray/python3/sage-libs-gap" to "9577dc890a118e24a8f62f52a5b1b52756136a6b"



---

archive/issue_comments_463060.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-14T17:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24460",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24460#issuecomment-463060",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
