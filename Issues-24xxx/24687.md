# Issue 24687: Fix wrong peirce_summand

archive/issues_024450.json:
```json
{
    "assignees": [],
    "body": "The Peirce summand in finite dimensional algebra is wrong. If the summand eAe\nfor an idempotent e is of dimension 1, then the summand is the span of the\nidempotent iself. Before the fix::\n\n```\nsage: from sage.monoids.hecke_monoid import HeckeMonoid\nsage: M = HeckeMonoid(SymmetricGroup(4))\nsage: A = M.algebra(QQ)\nsage: e = A.orthogonal_idempotents_central_mod_radical()[0]\nsage: e.coefficient(M.one())\n0\nsage: len(e)\n1\n```\nThe following demonstrate that e does not belong to its own summand which is wrong\n\n```\nsage: A.peirce_summand(e, e)\nFree module generated by {0} over Rational Field\nsage: f = A.peirce_summand(e, e).basis()[0].lift()\nsage: f.coefficient(M.one())\n1\nsage: len(f)\n24\n```\nThe reason is that some matrix is not properly read. \n\n\nCC:  @nthiery @saliola\n\nKeywords: **Finite dimensional algebra, Peirce summand**\n\nBranch/Commit: **[`12327e4`](https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Florent Hivert**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24687_\n\n",
    "closed_at": "2018-02-11T13:04:03Z",
    "created_at": "2018-02-07T20:07:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix wrong peirce_summand",
    "type": "issue",
    "updated_at": "2018-02-11T13:04:03Z",
    "url": "https://github.com/sagemath/sage/issues/24687",
    "user": "https://github.com/hivert"
}
```
The Peirce summand in finite dimensional algebra is wrong. If the summand eAe
for an idempotent e is of dimension 1, then the summand is the span of the
idempotent iself. Before the fix::

```
sage: from sage.monoids.hecke_monoid import HeckeMonoid
sage: M = HeckeMonoid(SymmetricGroup(4))
sage: A = M.algebra(QQ)
sage: e = A.orthogonal_idempotents_central_mod_radical()[0]
sage: e.coefficient(M.one())
0
sage: len(e)
1
```
The following demonstrate that e does not belong to its own summand which is wrong

```
sage: A.peirce_summand(e, e)
Free module generated by {0} over Rational Field
sage: f = A.peirce_summand(e, e).basis()[0].lift()
sage: f.coefficient(M.one())
1
sage: len(f)
24
```
The reason is that some matrix is not properly read. 


CC:  @nthiery @saliola

Keywords: **Finite dimensional algebra, Peirce summand**

Branch/Commit: **[`12327e4`](https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865)**

Reviewer: **Travis Scrimshaw**

Author: **Florent Hivert**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/24687_





---

archive/issue_events_341790.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-07T20:07:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341790"
}
```



---

archive/issue_events_341791.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-07T20:07:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341791"
}
```



---

archive/issue_comments_375137.json:
```json
{
    "body": "Branch: **[u/hivert/fix_wrong_peirce_summand](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/fix_wrong_peirce_summand)**",
    "created_at": "2018-02-07T20:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375137",
    "user": "https://github.com/hivert"
}
```

Branch: **[u/hivert/fix_wrong_peirce_summand](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/fix_wrong_peirce_summand)**



---

archive/issue_comments_375138.json:
```json
{
    "body": "Commit: **[`1e5c702`](https://github.com/sagemath/sagetrac-mirror/commit/1e5c7027942edc9573dbbb550a83a8c012cb7825)**",
    "created_at": "2018-02-07T20:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375138",
    "user": "https://github.com/hivert"
}
```

Commit: **[`1e5c702`](https://github.com/sagemath/sagetrac-mirror/commit/1e5c7027942edc9573dbbb550a83a8c012cb7825)**



---

archive/issue_events_341792.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-07T20:29:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341792"
}
```



---

archive/issue_events_341793.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-07T20:29:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341793"
}
```



---

archive/issue_events_341794.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-07T20:29:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341794"
}
```



---

archive/issue_comments_375139.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e5c7027942edc9573dbbb550a83a8c012cb7825\"><code>1e5c702</code></a></td><td><code>Fix wrong Peirce summand</code></td></tr></table>\n",
    "created_at": "2018-02-07T20:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375139",
    "user": "https://github.com/hivert"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e5c7027942edc9573dbbb550a83a8c012cb7825"><code>1e5c702</code></a></td><td><code>Fix wrong Peirce summand</code></td></tr></table>




---

archive/issue_comments_375140.json:
```json
{
    "body": "Changed keywords from none to **Finite dimensional algebra, Peirce summand**",
    "created_at": "2018-02-07T20:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375140",
    "user": "https://github.com/hivert"
}
```

Changed keywords from none to **Finite dimensional algebra, Peirce summand**



---

archive/issue_comments_375141.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,27 @@\n+The Peirce summand in finite dimensional algebra is wrong. If the summand eAe\n+for an idempotent e is of dimension 1, then the summand is the span of the\n+idempotent iself. Before the fix::\n \n+```\n+sage: from sage.monoids.hecke_monoid import HeckeMonoid\n+sage: M = HeckeMonoid(SymmetricGroup(4))\n+sage: A = M.algebra(QQ)\n+sage: e = A.orthogonal_idempotents_central_mod_radical()[0]\n+sage: e.coefficient(M.one())\n+0\n+sage: len(e)\n+1\n+```\n+The following demonstrate that e does not belong to its own summand which is wrong\n+\n+```\n+sage: A.peirce_summand(e, e)\n+Free module generated by {0} over Rational Field\n+sage: f = A.peirce_summand(e, e).basis()[0].lift()\n+sage: f.coefficient(M.one())\n+1\n+sage: len(f)\n+24\n+```\n+The reason is that some matrix is not properly read. \n+\n``````\n",
    "created_at": "2018-02-07T20:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375141",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,27 @@
+The Peirce summand in finite dimensional algebra is wrong. If the summand eAe
+for an idempotent e is of dimension 1, then the summand is the span of the
+idempotent iself. Before the fix::
 
+```
+sage: from sage.monoids.hecke_monoid import HeckeMonoid
+sage: M = HeckeMonoid(SymmetricGroup(4))
+sage: A = M.algebra(QQ)
+sage: e = A.orthogonal_idempotents_central_mod_radical()[0]
+sage: e.coefficient(M.one())
+0
+sage: len(e)
+1
+```
+The following demonstrate that e does not belong to its own summand which is wrong
+
+```
+sage: A.peirce_summand(e, e)
+Free module generated by {0} over Rational Field
+sage: f = A.peirce_summand(e, e).basis()[0].lift()
+sage: f.coefficient(M.one())
+1
+sage: len(f)
+24
+```
+The reason is that some matrix is not properly read. 
+
``````




---

archive/issue_comments_375142.json:
```json
{
    "body": "Author: **Florent Hivert**",
    "created_at": "2018-02-07T20:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375142",
    "user": "https://github.com/hivert"
}
```

Author: **Florent Hivert**



---

archive/issue_comments_375143.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis test seems a little fragile to me:\n\n```\nsage: f = S.basis()[0].lift()\nsage: e == f\nTrue\n```\nI think a better test is to scale `f` by `e.leading_coefficient() / f.leading_coefficient()`. Otherwise LGTM.",
    "created_at": "2018-02-07T23:00:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375143",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

This test seems a little fragile to me:

```
sage: f = S.basis()[0].lift()
sage: e == f
True
```
I think a better test is to scale `f` by `e.leading_coefficient() / f.leading_coefficient()`. Otherwise LGTM.



---

archive/issue_comments_375144.json:
```json
{
    "body": "Changed commit from **[`1e5c702`](https://github.com/sagemath/sagetrac-mirror/commit/1e5c7027942edc9573dbbb550a83a8c012cb7825)** to **[`7e8e805`](https://github.com/sagemath/sagetrac-mirror/commit/7e8e805bdd8fa19aa94ccbc11cab6292640a39d2)**",
    "created_at": "2018-02-07T23:35:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375144",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1e5c702`](https://github.com/sagemath/sagetrac-mirror/commit/1e5c7027942edc9573dbbb550a83a8c012cb7825)** to **[`7e8e805`](https://github.com/sagemath/sagetrac-mirror/commit/7e8e805bdd8fa19aa94ccbc11cab6292640a39d2)**



---

archive/issue_comments_375145.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e8e805bdd8fa19aa94ccbc11cab6292640a39d2\"><code>7e8e805</code></a></td><td><code>Travis fagility comment</code></td></tr></table>\n",
    "created_at": "2018-02-07T23:35:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375145",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e8e805bdd8fa19aa94ccbc11cab6292640a39d2"><code>7e8e805</code></a></td><td><code>Travis fagility comment</code></td></tr></table>




---

archive/issue_comments_375146.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@tscrim](#comment:3):\n> I think a better test is to scale `f` by `e.leading_coefficient() / f.leading_coefficient()`. Otherwise LGTM.\n\nFixed ! But If you go that way there is another fragile assumption: the fact that the 0-th idempotent is one whose bi-sided Peirce summand is of dimension 1. I'm checking this fact, but There is no waranty that the algorithm wil allway return the idempotent in the same order. For H4 among the 8 idempotents two of them have summand of dimension 2. Do you think I should write a loop to find such an idempotent ?",
    "created_at": "2018-02-07T23:43:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375146",
    "user": "https://github.com/hivert"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@tscrim](#comment:3):
> I think a better test is to scale `f` by `e.leading_coefficient() / f.leading_coefficient()`. Otherwise LGTM.

Fixed ! But If you go that way there is another fragile assumption: the fact that the 0-th idempotent is one whose bi-sided Peirce summand is of dimension 1. I'm checking this fact, but There is no waranty that the algorithm wil allway return the idempotent in the same order. For H4 among the 8 idempotents two of them have summand of dimension 2. Do you think I should write a loop to find such an idempotent ?



---

archive/issue_comments_375147.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@hivert](#comment:5):\n> Replying to [@tscrim](#comment:3):\n> > I think a better test is to scale `f` by `e.leading_coefficient() / f.leading_coefficient()`. Otherwise LGTM.\n\n> \n> Fixed ! But If you go that way there is another fragile assumption: the fact that the 0-th idempotent is one whose bi-sided Peirce summand is of dimension 1. I'm checking this fact, but There is no waranty that the algorithm wil allway return the idempotent in the same order. For H4 among the 8 idempotents two of them have summand of dimension 2. Do you think I should write a loop to find such an idempotent ?\n\nThat's a good point. Well, how about doing something more simple and just printing the dimension of `S` to emphasize that we are using (and sort of testing) that property?",
    "created_at": "2018-02-07T23:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375147",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@hivert](#comment:5):
> Replying to [@tscrim](#comment:3):
> > I think a better test is to scale `f` by `e.leading_coefficient() / f.leading_coefficient()`. Otherwise LGTM.

> 
> Fixed ! But If you go that way there is another fragile assumption: the fact that the 0-th idempotent is one whose bi-sided Peirce summand is of dimension 1. I'm checking this fact, but There is no waranty that the algorithm wil allway return the idempotent in the same order. For H4 among the 8 idempotents two of them have summand of dimension 2. Do you think I should write a loop to find such an idempotent ?

That's a good point. Well, how about doing something more simple and just printing the dimension of `S` to emphasize that we are using (and sort of testing) that property?



---

archive/issue_comments_375148.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@tscrim](#comment:6):\n\n> That's a good point. Well, how about doing something more simple and just printing the dimension of `S` to emphasize that we are using (and sort of testing) that property?\n\nThat's exactly what the line\n\n```\nsage: S = A.peirce_summand(e, e); S\nFree module generated by {0} over Rational Field\n```\nis doing.",
    "created_at": "2018-02-08T00:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375148",
    "user": "https://github.com/hivert"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@tscrim](#comment:6):

> That's a good point. Well, how about doing something more simple and just printing the dimension of `S` to emphasize that we are using (and sort of testing) that property?

That's exactly what the line

```
sage: S = A.peirce_summand(e, e); S
Free module generated by {0} over Rational Field
```
is doing.



---

archive/issue_comments_375149.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2018-02-08T00:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375149",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_375150.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@hivert](#comment:7):\n> Replying to [@tscrim](#comment:6):\n> \n> > That's a good point. Well, how about doing something more simple and just printing the dimension of `S` to emphasize that we are using (and sort of testing) that property?\n\n> \n> That's exactly what the line\n> \n> ```\n> sage: S = A.peirce_summand(e, e); S\n> Free module generated by {0} over Rational Field\n> ```\n> is doing.\n\nAh, right. Actually, we are overthinking this:\n\n```\nsage: S.retract(e) in S\nTrue\n```\nIdeally we should not need the retract, but that is a separate deficiency IMO of `SubmoduleWithBasis` (instead using `CombinatorialFreeModule.__contains__`, which just checks the `parent(x) == self`).",
    "created_at": "2018-02-08T00:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375150",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@hivert](#comment:7):
> Replying to [@tscrim](#comment:6):
> 
> > That's a good point. Well, how about doing something more simple and just printing the dimension of `S` to emphasize that we are using (and sort of testing) that property?

> 
> That's exactly what the line
> 
> ```
> sage: S = A.peirce_summand(e, e); S
> Free module generated by {0} over Rational Field
> ```
> is doing.

Ah, right. Actually, we are overthinking this:

```
sage: S.retract(e) in S
True
```
Ideally we should not need the retract, but that is a separate deficiency IMO of `SubmoduleWithBasis` (instead using `CombinatorialFreeModule.__contains__`, which just checks the `parent(x) == self`).



---

archive/issue_comments_375151.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7464ad071c3c7fef44beea071f7414800794997\"><code>b7464ad</code></a></td><td><code>Simpler, wider and more robust test</code></td></tr></table>\n",
    "created_at": "2018-02-08T12:45:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375151",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7464ad071c3c7fef44beea071f7414800794997"><code>b7464ad</code></a></td><td><code>Simpler, wider and more robust test</code></td></tr></table>




---

archive/issue_comments_375152.json:
```json
{
    "body": "Changed commit from **[`7e8e805`](https://github.com/sagemath/sagetrac-mirror/commit/7e8e805bdd8fa19aa94ccbc11cab6292640a39d2)** to **[`b7464ad`](https://github.com/sagemath/sagetrac-mirror/commit/b7464ad071c3c7fef44beea071f7414800794997)**",
    "created_at": "2018-02-08T12:45:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375152",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7e8e805`](https://github.com/sagemath/sagetrac-mirror/commit/7e8e805bdd8fa19aa94ccbc11cab6292640a39d2)** to **[`b7464ad`](https://github.com/sagemath/sagetrac-mirror/commit/b7464ad071c3c7fef44beea071f7414800794997)**



---

archive/issue_comments_375153.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@tscrim](#comment:8):\n> Ah, right. Actually, we are overthinking this:\n> \n> ```\n> sage: S.retract(e) in S\n> True\n> ```\n\nThis is a much better tests. Actually the `in S` is not needed. Retract breaks:\n\n```\nValueError: B[map: ...] is not in the image\n```\nI left it anyway. And fixed a typo elsewhere by the way.",
    "created_at": "2018-02-08T12:48:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375153",
    "user": "https://github.com/hivert"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@tscrim](#comment:8):
> Ah, right. Actually, we are overthinking this:
> 
> ```
> sage: S.retract(e) in S
> True
> ```

This is a much better tests. Actually the `in S` is not needed. Retract breaks:

```
ValueError: B[map: ...] is not in the image
```
I left it anyway. And fixed a typo elsewhere by the way.



---

archive/issue_comments_375154.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@hivert](#comment:10):\n> Replying to [@tscrim](#comment:8):\n> > Ah, right. Actually, we are overthinking this:\n> > \n> > ```\n> > sage: S.retract(e) in S\n> > True\n> > ```\n\n> This is a much better tests. Actually the `in S` is not needed. Retract breaks:\n> \n> ```\n> ValueError: B[map: ...] is not in the image\n> ```\n> I left it anyway.\n\nThank you. Like I said, ideally the test would just be `e in S`, but that is a separate issue.\n\n> And fixed a typo elsewhere by the way.\n\nLGTM modulo `TESTS::` -> `TESTS:` since you have plain-text after it. Addendum: also capitalize Pierce in the `TESTS:` block. Once fixed, you can set a positive review on my behalf.",
    "created_at": "2018-02-08T12:59:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375154",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@hivert](#comment:10):
> Replying to [@tscrim](#comment:8):
> > Ah, right. Actually, we are overthinking this:
> > 
> > ```
> > sage: S.retract(e) in S
> > True
> > ```

> This is a much better tests. Actually the `in S` is not needed. Retract breaks:
> 
> ```
> ValueError: B[map: ...] is not in the image
> ```
> I left it anyway.

Thank you. Like I said, ideally the test would just be `e in S`, but that is a separate issue.

> And fixed a typo elsewhere by the way.

LGTM modulo `TESTS::` -> `TESTS:` since you have plain-text after it. Addendum: also capitalize Pierce in the `TESTS:` block. Once fixed, you can set a positive review on my behalf.



---

archive/issue_comments_375155.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e000281b09bbafcc4477924e9810a8b538b6da53\"><code>e000281</code></a></td><td><code>Typo</code></td></tr></table>\n",
    "created_at": "2018-02-08T13:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375155",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e000281b09bbafcc4477924e9810a8b538b6da53"><code>e000281</code></a></td><td><code>Typo</code></td></tr></table>




---

archive/issue_comments_375156.json:
```json
{
    "body": "Changed commit from **[`b7464ad`](https://github.com/sagemath/sagetrac-mirror/commit/b7464ad071c3c7fef44beea071f7414800794997)** to **[`e000281`](https://github.com/sagemath/sagetrac-mirror/commit/e000281b09bbafcc4477924e9810a8b538b6da53)**",
    "created_at": "2018-02-08T13:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375156",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b7464ad`](https://github.com/sagemath/sagetrac-mirror/commit/b7464ad071c3c7fef44beea071f7414800794997)** to **[`e000281`](https://github.com/sagemath/sagetrac-mirror/commit/e000281b09bbafcc4477924e9810a8b538b6da53)**



---

archive/issue_events_341795.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-08T19:03:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341795"
}
```



---

archive/issue_events_341796.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-02-08T19:03:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341796"
}
```



---

archive/issue_events_341797.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2018-02-08T19:07:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341797"
}
```



---

archive/issue_events_341798.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2018-02-08T19:07:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341798"
}
```



---

archive/issue_comments_375157.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865\"><code>12327e4</code></a></td><td><code>typo (2)</code></td></tr></table>\n",
    "created_at": "2018-02-08T19:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375157",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865"><code>12327e4</code></a></td><td><code>typo (2)</code></td></tr></table>




---

archive/issue_comments_375158.json:
```json
{
    "body": "Changed commit from **[`e000281`](https://github.com/sagemath/sagetrac-mirror/commit/e000281b09bbafcc4477924e9810a8b538b6da53)** to **[`12327e4`](https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865)**",
    "created_at": "2018-02-08T19:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375158",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e000281`](https://github.com/sagemath/sagetrac-mirror/commit/e000281b09bbafcc4477924e9810a8b538b6da53)** to **[`12327e4`](https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865)**



---

archive/issue_comments_375159.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThank you.",
    "created_at": "2018-02-08T20:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375159",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

Thank you.



---

archive/issue_events_341799.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-02-08T20:03:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341799"
}
```



---

archive/issue_events_341800.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-02-08T20:03:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341800"
}
```



---

archive/issue_events_341801.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-11T13:04:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341801"
}
```



---

archive/issue_events_341802.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9254fd6b91472d5a561508181264cd1075836cf7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-02-11T13:04:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24687#event-341802"
}
```



---

archive/issue_comments_375160.json:
```json
{
    "body": "Changed branch from **[u/hivert/fix_wrong_peirce_summand](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/fix_wrong_peirce_summand)** to **[`12327e4`](https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865)**",
    "created_at": "2018-02-11T13:04:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24687",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24687#issuecomment-375160",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/hivert/fix_wrong_peirce_summand](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/fix_wrong_peirce_summand)** to **[`12327e4`](https://github.com/sagemath/sagetrac-mirror/commit/12327e477763bc013aabc28c2364608140b58865)**
