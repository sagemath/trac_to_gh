# Issue 24690: Install Cython source files

archive/issues_024453.json:
```json
{
    "assignees": [],
    "body": "The various Cython files (`.pyx`, `.pxd`, `.pxi`) from the Sage library should be *installed* in `site-packages`. In fact, we already do this for `.pxd` and `.pxi` files.\n\nTickets #21480 and #24681 discuss reasons why we should do that: it allows displaying the traceback of Cython source files without accessing `SAGE_SRC`, which is a good thing for distributions.\n\nCC:  @kiwifb @embray @mkoeppe\n\nBranch: **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Erik Bray, Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24690_\n\n",
    "closed_at": "2018-02-11T13:03:57Z",
    "created_at": "2018-02-08T13:40:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Install Cython source files",
    "type": "issue",
    "updated_at": "2018-02-15T16:54:17Z",
    "url": "https://github.com/sagemath/sage/issues/24690",
    "user": "https://github.com/jdemeyer"
}
```
The various Cython files (`.pyx`, `.pxd`, `.pxi`) from the Sage library should be *installed* in `site-packages`. In fact, we already do this for `.pxd` and `.pxi` files.

Tickets #21480 and #24681 discuss reasons why we should do that: it allows displaying the traceback of Cython source files without accessing `SAGE_SRC`, which is a good thing for distributions.

CC:  @kiwifb @embray @mkoeppe

Branch: **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)**

Reviewer: **François Bissey**

Author: **Erik Bray, Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/24690_





---

archive/issue_events_323808.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-08T13:40:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323808"
}
```



---

archive/issue_events_323809.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-08T13:40:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323809"
}
```



---

archive/issue_events_323810.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-08T13:40:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323810"
}
```



---

archive/issue_events_323811.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-08T13:40:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323811"
}
```



---

archive/issue_comments_377875.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2018-02-08T13:44:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377875",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_377876.json:
```json
{
    "body": "Changed author from **Jeroen Demeyer** to **Erik Bray, Jeroen Demeyer**",
    "created_at": "2018-02-08T13:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377876",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Jeroen Demeyer** to **Erik Bray, Jeroen Demeyer**



---

archive/issue_comments_377877.json:
```json
{
    "body": "Branch: **[u/jdemeyer/install_cython_source_files](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_cython_source_files)**",
    "created_at": "2018-02-08T13:48:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377877",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/install_cython_source_files](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_cython_source_files)**



---

archive/issue_events_323812.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-08T13:49:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323812"
}
```



---

archive/issue_comments_377878.json:
```json
{
    "body": "Commit: **[996759c](https://github.com/sagemath/sagetrac-mirror/commit/996759c97d6dd747e2d61fc5b2bb71f00119e597)**",
    "created_at": "2018-02-08T13:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377878",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[996759c](https://github.com/sagemath/sagetrac-mirror/commit/996759c97d6dd747e2d61fc5b2bb71f00119e597)**



---

archive/issue_comments_377879.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bf128ec5f0540d7ec81f4df9ff106fe48f88cba\">1bf128e</a></td><td><code>Install the .pyx files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/996759c97d6dd747e2d61fc5b2bb71f00119e597\">996759c</a></td><td><code>No longer add SAGE_SRC to sys.path</code></td></tr></table>\n",
    "created_at": "2018-02-08T13:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377879",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">Comment 4</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bf128ec5f0540d7ec81f4df9ff106fe48f88cba">1bf128e</a></td><td><code>Install the .pyx files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/996759c97d6dd747e2d61fc5b2bb71f00119e597">996759c</a></td><td><code>No longer add SAGE_SRC to sys.path</code></td></tr></table>




---

archive/issue_comments_377880.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nLooks like something I had in sage-on-gentoo for several years.",
    "created_at": "2018-02-08T18:53:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377880",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">Comment 5</div>

Looks like something I had in sage-on-gentoo for several years.



---

archive/issue_comments_377881.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2018-02-08T18:53:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377881",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_events_323813.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-02-08T18:53:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323813"
}
```



---

archive/issue_events_323814.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-02-08T18:53:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323814"
}
```



---

archive/issue_events_323815.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-10T12:13:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323815"
}
```



---

archive/issue_events_323816.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-10T12:13:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323816"
}
```



---

archive/issue_comments_377882.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nTest fails, see patchbot",
    "created_at": "2018-02-10T12:13:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377882",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">Comment 6</div>

Test fails, see patchbot



---

archive/issue_comments_377883.json:
```json
{
    "body": "Changed commit from **[996759c](https://github.com/sagemath/sagetrac-mirror/commit/996759c97d6dd747e2d61fc5b2bb71f00119e597)** to **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)**",
    "created_at": "2018-02-10T12:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377883",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[996759c](https://github.com/sagemath/sagetrac-mirror/commit/996759c97d6dd747e2d61fc5b2bb71f00119e597)** to **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)**



---

archive/issue_comments_377884.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93\">68022a4</a></td><td><code>Sources in traceback are no longer in src</code></td></tr></table>\n",
    "created_at": "2018-02-10T12:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377884",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7" align="right">Comment 7</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93">68022a4</a></td><td><code>Sources in traceback are no longer in src</code></td></tr></table>




---

archive/issue_events_323817.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-10T12:47:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323817"
}
```



---

archive/issue_events_323818.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-10T12:47:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323818"
}
```



---

archive/issue_comments_377885.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThis is breaking patchbots.",
    "created_at": "2018-02-10T13:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377885",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">Comment 9</div>

This is breaking patchbots.



---

archive/issue_events_323819.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-10T13:18:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323819"
}
```



---

archive/issue_events_323820.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-10T13:18:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323820"
}
```



---

archive/issue_events_323821.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-02-10T20:21:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323821"
}
```



---

archive/issue_events_323822.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-02-10T20:21:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323822"
}
```



---

archive/issue_comments_377886.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@sagetrac-git](#comment%3A7):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93\">68022a4</a></td><td><code>Sources in traceback are no longer in src</code></td></tr></table>\n\nStupid me, I always thought this failure was linked to something else that I couldn't identify. But then it looks like I have a different issue on top of this one (i.e. this test fails in sage-on-gentoo because of two things and this will only fix one). No wonder I couldn't find a single cause to the issue.",
    "created_at": "2018-02-10T20:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377886",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@sagetrac-git](#comment%3A7):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93">68022a4</a></td><td><code>Sources in traceback are no longer in src</code></td></tr></table>

Stupid me, I always thought this failure was linked to something else that I couldn't identify. But then it looks like I have a different issue on top of this one (i.e. this test fails in sage-on-gentoo because of two things and this will only fix one). No wonder I couldn't find a single cause to the issue.



---

archive/issue_comments_377887.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/install_cython_source_files](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_cython_source_files)** to **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)**",
    "created_at": "2018-02-11T13:03:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377887",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/install_cython_source_files](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_cython_source_files)** to **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)**



---

archive/issue_events_323823.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-11T13:03:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323823"
}
```



---

archive/issue_events_323824.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "fccaf230e87db301d461de89867ca0beddb2d03c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-02-11T13:03:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24690#event-323824"
}
```



---

archive/issue_comments_377888.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nThis happened faster than I could comment, but certainly +1 from me.",
    "created_at": "2018-02-12T10:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377888",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">Comment 12</div>

This happened faster than I could comment, but certainly +1 from me.



---

archive/issue_comments_377889.json:
```json
{
    "body": "Changed commit from **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)** to none",
    "created_at": "2018-02-12T10:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377889",
    "user": "https://github.com/embray"
}
```

Changed commit from **[68022a4](https://github.com/sagemath/sagetrac-mirror/commit/68022a4d114951c39f63962c4b35b3feed405f93)** to none



---

archive/issue_comments_377890.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nThis broke some patchbots:\n\n```\nsage -t --long src/sage/repl/interpreter.py\n**********************************************************************\nFile \"src/sage/repl/interpreter.py\", line 77, in sage.repl.interpreter\nFailed example:\n    shell.run_cell('1/0')\nExpected:\n    ---------------------------------------------------------------------------\n    ZeroDivisionError                         Traceback (most recent call last)\n    <ipython-input-...> in <module>()\n    ----> 1 Integer(1)/Integer(0)\n    <BLANKLINE>\n    .../src/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (.../cythonized/sage/rings/integer.c:...)()\n       ...        if type(left) is type(right):\n       ...            if mpz_sgn((<Integer>right).value) == 0:\n    -> ...                  raise ZeroDivisionError(\"rational division by zero\")\n       ...            x = <Rational> Rational.__new__(Rational)\n       ...            mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)\n    <BLANKLINE>\n    ZeroDivisionError: rational division by zero\nGot:\n    ---------------------------------------------------------------------------\n    ZeroDivisionError                         Traceback (most recent call last)\n    <ipython-input-1-72ac74c5f414> in <module>()\n    ----> 1 Integer(1)/Integer(0)\n    <BLANKLINE>\n    /home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (build/cythonized/sage/rings/integer.c:13246)()\n       1909         if type(left) is type(right):\n       1910             if mpz_sgn((<Integer>right).value) == 0:\n    -> 1911                 raise ZeroDivisionError(\"rational division by zero\")\n       1912             x = <Rational> Rational.__new__(Rational)\n       1913             mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)\n    <BLANKLINE>\n    ZeroDivisionError: rational division by zero\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.repl.interpreter\n    [131 tests, 1 failure, 2.42 s]\n```\n\nthe new location of the source files means this string comparison failed slightly...",
    "created_at": "2018-02-14T16:43:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377890",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">Comment 13</div>

This broke some patchbots:

```
sage -t --long src/sage/repl/interpreter.py
**********************************************************************
File "src/sage/repl/interpreter.py", line 77, in sage.repl.interpreter
Failed example:
    shell.run_cell('1/0')
Expected:
    ---------------------------------------------------------------------------
    ZeroDivisionError                         Traceback (most recent call last)
    <ipython-input-...> in <module>()
    ----> 1 Integer(1)/Integer(0)
    <BLANKLINE>
    .../src/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (.../cythonized/sage/rings/integer.c:...)()
       ...        if type(left) is type(right):
       ...            if mpz_sgn((<Integer>right).value) == 0:
    -> ...                  raise ZeroDivisionError("rational division by zero")
       ...            x = <Rational> Rational.__new__(Rational)
       ...            mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)
    <BLANKLINE>
    ZeroDivisionError: rational division by zero
Got:
    ---------------------------------------------------------------------------
    ZeroDivisionError                         Traceback (most recent call last)
    <ipython-input-1-72ac74c5f414> in <module>()
    ----> 1 Integer(1)/Integer(0)
    <BLANKLINE>
    /home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (build/cythonized/sage/rings/integer.c:13246)()
       1909         if type(left) is type(right):
       1910             if mpz_sgn((<Integer>right).value) == 0:
    -> 1911                 raise ZeroDivisionError("rational division by zero")
       1912             x = <Rational> Rational.__new__(Rational)
       1913             mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)
    <BLANKLINE>
    ZeroDivisionError: rational division by zero
**********************************************************************
1 item had failures:
   1 of   5 in sage.repl.interpreter
    [131 tests, 1 failure, 2.42 s]
```

the new location of the source files means this string comparison failed slightly...



---

archive/issue_comments_377891.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@embray](#comment%3A13):\n> This broke some patchbots:\n> \n> ```\n> sage -t --long src/sage/repl/interpreter.py\n> **********************************************************************\n> File \"src/sage/repl/interpreter.py\", line 77, in sage.repl.interpreter\n> Failed example:\n>     shell.run_cell('1/0')\n> Expected:\n>     ---------------------------------------------------------------------------\n>     ZeroDivisionError                         Traceback (most recent call last)\n>     <ipython-input-...> in <module>()\n>     ----> 1 Integer(1)/Integer(0)\n>     <BLANKLINE>\n>     .../src/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (.../cythonized/sage/rings/integer.c:...)()\n>        ...        if type(left) is type(right):\n>        ...            if mpz_sgn((<Integer>right).value) == 0:\n>     -> ...                  raise ZeroDivisionError(\"rational division by zero\")\n>        ...            x = <Rational> Rational.__new__(Rational)\n>        ...            mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)\n>     <BLANKLINE>\n>     ZeroDivisionError: rational division by zero\n> Got:\n>     ---------------------------------------------------------------------------\n>     ZeroDivisionError                         Traceback (most recent call last)\n>     <ipython-input-1-72ac74c5f414> in <module>()\n>     ----> 1 Integer(1)/Integer(0)\n>     <BLANKLINE>\n>     /home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (build/cythonized/sage/rings/integer.c:13246)()\n>        1909         if type(left) is type(right):\n>        1910             if mpz_sgn((<Integer>right).value) == 0:\n>     -> 1911                 raise ZeroDivisionError(\"rational division by zero\")\n>        1912             x = <Rational> Rational.__new__(Rational)\n>        1913             mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)\n>     <BLANKLINE>\n>     ZeroDivisionError: rational division by zero\n> **********************************************************************\n> 1 item had failures:\n>    1 of   5 in sage.repl.interpreter\n>     [131 tests, 1 failure, 2.42 s]\n> ```\n> \n> the new location of the source files means this string comparison failed slightly...\n\nThat was fixed in the latest commit. You must be looking at old reports.",
    "created_at": "2018-02-14T20:19:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377891",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@embray](#comment%3A13):
> This broke some patchbots:
> 
> ```
> sage -t --long src/sage/repl/interpreter.py
> **********************************************************************
> File "src/sage/repl/interpreter.py", line 77, in sage.repl.interpreter
> Failed example:
>     shell.run_cell('1/0')
> Expected:
>     ---------------------------------------------------------------------------
>     ZeroDivisionError                         Traceback (most recent call last)
>     <ipython-input-...> in <module>()
>     ----> 1 Integer(1)/Integer(0)
>     <BLANKLINE>
>     .../src/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (.../cythonized/sage/rings/integer.c:...)()
>        ...        if type(left) is type(right):
>        ...            if mpz_sgn((<Integer>right).value) == 0:
>     -> ...                  raise ZeroDivisionError("rational division by zero")
>        ...            x = <Rational> Rational.__new__(Rational)
>        ...            mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)
>     <BLANKLINE>
>     ZeroDivisionError: rational division by zero
> Got:
>     ---------------------------------------------------------------------------
>     ZeroDivisionError                         Traceback (most recent call last)
>     <ipython-input-1-72ac74c5f414> in <module>()
>     ----> 1 Integer(1)/Integer(0)
>     <BLANKLINE>
>     /home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__div__ (build/cythonized/sage/rings/integer.c:13246)()
>        1909         if type(left) is type(right):
>        1910             if mpz_sgn((<Integer>right).value) == 0:
>     -> 1911                 raise ZeroDivisionError("rational division by zero")
>        1912             x = <Rational> Rational.__new__(Rational)
>        1913             mpq_div_zz(x.value, (<Integer>left).value, (<Integer>right).value)
>     <BLANKLINE>
>     ZeroDivisionError: rational division by zero
> **********************************************************************
> 1 item had failures:
>    1 of   5 in sage.repl.interpreter
>     [131 tests, 1 failure, 2.42 s]
> ```
> 
> the new location of the source files means this string comparison failed slightly...

That was fixed in the latest commit. You must be looking at old reports.



---

archive/issue_comments_377892.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nActually I'm not sure that's exactly it.  I think that what's happening is that any patchbots that tested this ticket now have the `.pyx` files installed into their `site-packages`, but when they switch branches again to test older tickets, it's not deleting those `.pyx` files (after all, the old branches don't know what they should be there in the first place) so those patchbots are failing.\n\nI suppose there's not much we can do about that other than be aware of the problem, and eventually it will normalize...",
    "created_at": "2018-02-15T16:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24690#issuecomment-377892",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">Comment 15</div>

Actually I'm not sure that's exactly it.  I think that what's happening is that any patchbots that tested this ticket now have the `.pyx` files installed into their `site-packages`, but when they switch branches again to test older tickets, it's not deleting those `.pyx` files (after all, the old branches don't know what they should be there in the first place) so those patchbots are failing.

I suppose there's not much we can do about that other than be aware of the problem, and eventually it will normalize...
