# Issue 24861: Option to hold for derivative

archive/issues_024624.json:
```json
{
    "body": "It would be nice to have the output of\n\n```\n(x^3).diff(x, hold=True)\n```\nlook like\n\n```\n$$ \\frac{\\partial}{\\partial x}x^3 $$\n```\n\n\nKeywords: hold\n\nAuthor: Ralf Stephan\n\nBranch: u/rws/option_to_hold_for_derivative\n\nStatus: needs_work\n\nCommit: 453cf14cdc3615d781d0dcd57daa95b9e45d5b5a\n\nIssue created by migration from https://trac.sagemath.org/ticket/24861\n\n",
    "created_at": "2018-02-27T21:13:13Z",
    "labels": [
        "component: calculus",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Option to hold for derivative",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24861",
    "user": "https://github.com/vaibhavkarve"
}
```
It would be nice to have the output of

```
(x^3).diff(x, hold=True)
```
look like

```
$$ \frac{\partial}{\partial x}x^3 $$
```


Keywords: hold

Author: Ralf Stephan

Branch: u/rws/option_to_hold_for_derivative

Status: needs_work

Commit: 453cf14cdc3615d781d0dcd57daa95b9e45d5b5a

Issue created by migration from https://trac.sagemath.org/ticket/24861





---

archive/issue_comments_472473.json:
```json
{
    "body": "<a id='comment:1'></a>Although we don't exactly have already a ticket for this, see the related #17445 and #15021.",
    "created_at": "2018-03-25T07:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472473",
    "user": "https://github.com/rwst"
}
```

<a id='comment:1'></a>Although we don't exactly have already a ticket for this, see the related #17445 and #15021.



---

archive/issue_comments_472474.json:
```json
{
    "body": "Changing branch from \"\" to \"u/rws/option_to_hold_for_derivative\"",
    "created_at": "2018-03-25T14:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472474",
    "user": "https://github.com/rwst"
}
```

Changing branch from "" to "u/rws/option_to_hold_for_derivative"



---

archive/issue_comments_472475.json:
```json
{
    "body": "Changing commit from \"\" to \"453cf14cdc3615d781d0dcd57daa95b9e45d5b5a\"",
    "created_at": "2018-03-25T15:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472475",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "453cf14cdc3615d781d0dcd57daa95b9e45d5b5a"



---

archive/issue_comments_472476.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-25T15:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472476",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_062462.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-03-25T15:56:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24861#event-62462"
}
```



---

archive/issue_comments_472477.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-25T15:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472477",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_472478.json:
```json
{
    "body": "<a id='comment:4'></a>Thanks for the report. This will be a useful addition to Sage.",
    "created_at": "2018-03-25T15:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472478",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>Thanks for the report. This will be a useful addition to Sage.



---

archive/issue_comments_472479.json:
```json
{
    "body": "Changing author from \"\" to \"Ralf Stephan\"",
    "created_at": "2018-03-25T15:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472479",
    "user": "https://github.com/rwst"
}
```

Changing author from "" to "Ralf Stephan"



---

archive/issue_comments_472480.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-01T02:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472480",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_062463.json:
```json
{
    "actor": "https://github.com/bryangingechen",
    "created_at": "2018-08-01T02:04:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24861#event-62463"
}
```



---

archive/issue_events_062464.json:
```json
{
    "actor": "https://github.com/bryangingechen",
    "created_at": "2018-08-01T02:04:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24861#event-62464"
}
```



---

archive/issue_comments_472481.json:
```json
{
    "body": "<a id='comment:5'></a>I agree this would be a nice addition; thanks for addressing this. Here are some comments.\n\nIn `src/sage/functions/other.py`:\n- Something like `(x).diff(x*x, hold=True)` returns `diff(x, x^2)` instead of an error. Note also that `latex((x).diff(x*x, hold=True))` causes a segfault.\n- The error message `wrong argument in diff` could be made more helpful; perhaps something like `all arguments to diff must be symbols or numerical values`. This should be tested as well.\n- The LaTeX output should include parentheses around the expression (probably with `\\left` and `\\right`), otherwise something like `latex((x^3+y).diff(x,2,y,2, hold=True))` returns `{\\frac{\\partial^{4}}{{\\partial x^2}{\\partial y^2}} x^{3} + y}` which is incorrect.\n\nIn `src/sage/symbolic/expression.pyx`:\n- the `hold` parameter should be added to the docstring of `derivative`. I also noticed a typo in the first line of the docstring as well: `this expressions` -> `this expression`.",
    "created_at": "2018-08-01T02:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24861",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24861#issuecomment-472481",
    "user": "https://github.com/bryangingechen"
}
```

<a id='comment:5'></a>I agree this would be a nice addition; thanks for addressing this. Here are some comments.

In `src/sage/functions/other.py`:
- Something like `(x).diff(x*x, hold=True)` returns `diff(x, x^2)` instead of an error. Note also that `latex((x).diff(x*x, hold=True))` causes a segfault.
- The error message `wrong argument in diff` could be made more helpful; perhaps something like `all arguments to diff must be symbols or numerical values`. This should be tested as well.
- The LaTeX output should include parentheses around the expression (probably with `\left` and `\right`), otherwise something like `latex((x^3+y).diff(x,2,y,2, hold=True))` returns `{\frac{\partial^{4}}{{\partial x^2}{\partial y^2}} x^{3} + y}` which is incorrect.

In `src/sage/symbolic/expression.pyx`:
- the `hold` parameter should be added to the docstring of `derivative`. I also noticed a typo in the first line of the docstring as well: `this expressions` -> `this expression`.
