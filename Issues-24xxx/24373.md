# Issue 24373: fix building Sage's Mac-app on OSX 10.13

archive/issues_024136.json:
```json
{
    "assignees": [],
    "body": "It is [confirmed](https://groups.google.com/d/msg/sage-devel/OF6-I4lMkQE/3i-Qk8WGCgAJ) broken; a fix appears to be a small change in its makefile:\n\n```\ndiff --git a/src/mac-app/Makefile b/src/mac-app/Makefile\nindex 430121647a..d0c8238cbc 100644\n--- a/src/mac-app/Makefile\n+++ b/src/mac-app/Makefile\n@@ -103,7 +103,7 @@ $(TARGET)/README.txt: $(SAGE_ROOT)/src/bin/sage-README-osx.txt\n \n non_app_files: $(TARGET)/README.txt $(TARGET)/.background/sage.png $(TARGET)/Applications\n \n-sage_symlink: $(APP)/Contents/Resources/sage/sage\n+sage_symlink: $(APP)/Contents/Resources/sage\n        rm -f $(APP)/sage\n        ln -s Contents/Resources/sage/sage $(APP)/sage\n```\n\nCC:  @jhpalmieri @unhyperbolic\n\nKeywords: **OSX**\n\nBranch/Commit: **[`84861cd`](https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8)**\n\nReviewer: **John Palmieri, Karl-Dieter Crisman**\n\nAuthor: **Dima Pasechnik**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24373_\n\n",
    "closed_at": "2018-01-14T10:14:33Z",
    "created_at": "2017-12-14T09:46:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix building Sage's Mac-app on OSX 10.13",
    "type": "issue",
    "updated_at": "2018-01-14T10:14:33Z",
    "url": "https://github.com/sagemath/sage/issues/24373",
    "user": "https://github.com/dimpase"
}
```
It is [confirmed](https://groups.google.com/d/msg/sage-devel/OF6-I4lMkQE/3i-Qk8WGCgAJ) broken; a fix appears to be a small change in its makefile:

```
diff --git a/src/mac-app/Makefile b/src/mac-app/Makefile
index 430121647a..d0c8238cbc 100644
--- a/src/mac-app/Makefile
+++ b/src/mac-app/Makefile
@@ -103,7 +103,7 @@ $(TARGET)/README.txt: $(SAGE_ROOT)/src/bin/sage-README-osx.txt
 
 non_app_files: $(TARGET)/README.txt $(TARGET)/.background/sage.png $(TARGET)/Applications
 
-sage_symlink: $(APP)/Contents/Resources/sage/sage
+sage_symlink: $(APP)/Contents/Resources/sage
        rm -f $(APP)/sage
        ln -s Contents/Resources/sage/sage $(APP)/sage
```

CC:  @jhpalmieri @unhyperbolic

Keywords: **OSX**

Branch/Commit: **[`84861cd`](https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8)**

Reviewer: **John Palmieri, Karl-Dieter Crisman**

Author: **Dima Pasechnik**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/24373_





---

archive/issue_events_334991.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-14T09:46:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334991"
}
```



---

archive/issue_events_334992.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-14T09:46:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334992"
}
```



---

archive/issue_events_334993.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-14T09:46:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334993"
}
```



---

archive/issue_events_334994.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-14T09:46:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334994"
}
```



---

archive/issue_comments_369066.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nOK, this works on 10.12 as well. Anyone to test on OSX 10.11 ? (We most probably don't need to go any further)\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8\"><code>84861cd</code></a></td><td><code>fix to make OSX 10.13 happy - see #24373</code></td></tr></table>\n",
    "created_at": "2017-12-14T10:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369066",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

OK, this works on 10.12 as well. Anyone to test on OSX 10.11 ? (We most probably don't need to go any further)

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8"><code>84861cd</code></a></td><td><code>fix to make OSX 10.13 happy - see #24373</code></td></tr></table>




---

archive/issue_comments_369067.json:
```json
{
    "body": "Commit: **[`84861cd`](https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8)**",
    "created_at": "2017-12-14T10:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369067",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`84861cd`](https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8)**



---

archive/issue_comments_369068.json:
```json
{
    "body": "Branch: **[u/dimpase/mac-appfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/mac-appfix)**",
    "created_at": "2017-12-14T10:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369068",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/mac-appfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/mac-appfix)**



---

archive/issue_events_334995.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-14T10:28:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334995"
}
```



---

archive/issue_comments_369069.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nJust a build fix, not a run fix?  Remind me the process for testing this and I can try it out.",
    "created_at": "2017-12-15T13:22:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369069",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:2" align="right">comment:2</div>

Just a build fix, not a run fix?  Remind me the process for testing this and I can try it out.



---

archive/issue_comments_369070.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@kcrisman](#comment:2):\n> Just a build fix, not a run fix?  Remind me the process for testing this and I can try it out.\n\nafter building Sage, cd to src/mac-app/ and type `make`. After a while you'd get a `sage-8*.dmg` file which you can test by opening, installing (in the usual OSX way) and running.",
    "created_at": "2017-12-15T13:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369070",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@kcrisman](#comment:2):
> Just a build fix, not a run fix?  Remind me the process for testing this and I can try it out.

after building Sage, cd to src/mac-app/ and type `make`. After a while you'd get a `sage-8*.dmg` file which you can test by opening, installing (in the usual OSX way) and running.



---

archive/issue_comments_369071.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n> after building Sage, cd to src/mac-app/ and type `make`. After a while you'd get a `sage-8*.dmg` file which you can test by opening, installing (in the usual OSX way) and running.\n\nGreat, I just upgraded to the first beta so I can try this quite soon.",
    "created_at": "2017-12-16T00:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369071",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

> after building Sage, cd to src/mac-app/ and type `make`. After a while you'd get a `sage-8*.dmg` file which you can test by opening, installing (in the usual OSX way) and running.

Great, I just upgraded to the first beta so I can try this quite soon.



---

archive/issue_comments_369072.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt works for me on OS X 10.13, as reported on sage-devel. (Actually, there I just reported building correctly, but it also unpacks and then runs successfully.)",
    "created_at": "2017-12-16T01:02:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369072",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

It works for me on OS X 10.13, as reported on sage-devel. (Actually, there I just reported building correctly, but it also unpacks and then runs successfully.)



---

archive/issue_comments_369073.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIt seems to work on 10.11, but I got\n\n```\nERROR:  The Sage installation tree has moved\n\nfrom /Users/.../sage\n  to /Applications/SageMath-8.2.beta0.app/Contents/Resources/sage\n\nThis is not supported, and Sage will not work.\n```\nwhich is weird because I took the dmg in question, opened it, then dragged the Sage app to `/Applications` so it shouldn't have run before that.  I guess only `binary-pkg` can make even that minimal relocation work.  But in that case I'm not sure how to test it running properly.  If it helps, the app part opens fine - it's only running Sage itself from that binary that doesn't for that reason.  So my guess is we are fine.\n\nBy the way, what's up with the file `tmp-sage-8.2.beta0-OSX_10.11.6_x86_64.app.dmg` worth 8.2 GB when I finish `make`?  Shouldn't that disappear at some point?  It seems obscenely huge ... though I guess the unpacked app is that big, too.  Why is 8.1.rc2.app about 3.5 GB but this is more than twice as big? Maybe because I didn't use `binary-pkg` for the current test?",
    "created_at": "2017-12-16T05:06:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369073",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

It seems to work on 10.11, but I got

```
ERROR:  The Sage installation tree has moved

from /Users/.../sage
  to /Applications/SageMath-8.2.beta0.app/Contents/Resources/sage

This is not supported, and Sage will not work.
```
which is weird because I took the dmg in question, opened it, then dragged the Sage app to `/Applications` so it shouldn't have run before that.  I guess only `binary-pkg` can make even that minimal relocation work.  But in that case I'm not sure how to test it running properly.  If it helps, the app part opens fine - it's only running Sage itself from that binary that doesn't for that reason.  So my guess is we are fine.

By the way, what's up with the file `tmp-sage-8.2.beta0-OSX_10.11.6_x86_64.app.dmg` worth 8.2 GB when I finish `make`?  Shouldn't that disappear at some point?  It seems obscenely huge ... though I guess the unpacked app is that big, too.  Why is 8.1.rc2.app about 3.5 GB but this is more than twice as big? Maybe because I didn't use `binary-pkg` for the current test?



---

archive/issue_comments_369074.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@kcrisman](#comment:6):\n> It seems to work on 10.11, but I got\n> \n> ```\n> ERROR:  The Sage installation tree has moved\n> ```\n\nDoes it work on 10.11 if you revert this branch back?\nIt is not hard to detect the version and use the code that\nworks for each version...\n\nOr perhaps it's broken on 10.11 anyway?\nThe  [binary-pkg](https://github.com/sagemath/binary-pkg) is a completely different story, and has nothing to do on this ticket.\n\n\n---\nSo I gather that the patch is needed and works on 10.12 and 10.13, and it remains to see what's happening on 10.11 (whether it causes a regression or not)",
    "created_at": "2017-12-16T08:30:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369074",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@kcrisman](#comment:6):
> It seems to work on 10.11, but I got
> 
> ```
> ERROR:  The Sage installation tree has moved
> ```

Does it work on 10.11 if you revert this branch back?
It is not hard to detect the version and use the code that
works for each version...

Or perhaps it's broken on 10.11 anyway?
The  [binary-pkg](https://github.com/sagemath/binary-pkg) is a completely different story, and has nothing to do on this ticket.


---
So I gather that the patch is needed and works on 10.12 and 10.13, and it remains to see what's happening on 10.11 (whether it causes a regression or not)



---

archive/issue_comments_369075.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe whole story is probably due to the format changes in .DS_store that happened as 10.12 was released.\nSee https://bitbucket.org/al45tair/ds_store/issues/7",
    "created_at": "2017-12-16T10:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369075",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

The whole story is probably due to the format changes in .DS_store that happened as 10.12 was released.
See https://bitbucket.org/al45tair/ds_store/issues/7



---

archive/issue_comments_369076.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n> Does it work on 10.11 if you revert this branch back?\n\nI'll check that out - hopefully my power cord will work properly ;-)\n> Or perhaps it's broken on 10.11 anyway?\n\nI highly doubt it, since I built 8.1.rc2 with `binary-pkg` and tested the binary and it seemed to work fine.\n> The  [binary-pkg](https://github.com/sagemath/binary-pkg) is a completely different story, and has nothing to do on this ticket.\n\nWell, it does in the sense that both of them build the Mac app if requested.  I think that since my only issue is the relocation that this is probably why it didn't work.  Where did you open your app.dmg (what folder)?",
    "created_at": "2017-12-16T14:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369076",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:9" align="right">comment:9</div>

> Does it work on 10.11 if you revert this branch back?

I'll check that out - hopefully my power cord will work properly ;-)
> Or perhaps it's broken on 10.11 anyway?

I highly doubt it, since I built 8.1.rc2 with `binary-pkg` and tested the binary and it seemed to work fine.
> The  [binary-pkg](https://github.com/sagemath/binary-pkg) is a completely different story, and has nothing to do on this ticket.

Well, it does in the sense that both of them build the Mac app if requested.  I think that since my only issue is the relocation that this is probably why it didn't work.  Where did you open your app.dmg (what folder)?



---

archive/issue_comments_369077.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@kcrisman](#comment:9):\n> > Does it work on 10.11 if you revert this branch back?\n\n> I'll check that out - hopefully my power cord will work properly ;-)\n> > Or perhaps it's broken on 10.11 anyway?\n\n> I highly doubt it, since I built 8.1.rc2 with `binary-pkg` and tested the binary and it seemed to work fine.\n> > The  [binary-pkg](https://github.com/sagemath/binary-pkg) is a completely different story, and has nothing to do on this ticket.\n\nWell, I mean it is an extra level of complexity that should not be mixed up with the issue at hand.\n\n> Well, it does in the sense that both of them build the Mac app if requested.  I think that since my only issue is the relocation that this is probably why it didn't work.  Where did you open your app.dmg (what folder)?\n\nI have installed the resulting dmg into /Applications (i.e. you open it, it gets checked and mounted, you see an invitation to move Sage into /Applications, you do it, then you\nopen Sage.app in /Applications).\n\nPS. As I said I won't be surprised if 10.11 needs to be handled differently from the later versions.",
    "created_at": "2017-12-16T15:11:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369077",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@kcrisman](#comment:9):
> > Does it work on 10.11 if you revert this branch back?

> I'll check that out - hopefully my power cord will work properly ;-)
> > Or perhaps it's broken on 10.11 anyway?

> I highly doubt it, since I built 8.1.rc2 with `binary-pkg` and tested the binary and it seemed to work fine.
> > The  [binary-pkg](https://github.com/sagemath/binary-pkg) is a completely different story, and has nothing to do on this ticket.

Well, I mean it is an extra level of complexity that should not be mixed up with the issue at hand.

> Well, it does in the sense that both of them build the Mac app if requested.  I think that since my only issue is the relocation that this is probably why it didn't work.  Where did you open your app.dmg (what folder)?

I have installed the resulting dmg into /Applications (i.e. you open it, it gets checked and mounted, you see an invitation to move Sage into /Applications, you do it, then you
open Sage.app in /Applications).

PS. As I said I won't be surprised if 10.11 needs to be handled differently from the later versions.



---

archive/issue_comments_369078.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nEven if I open the binary that isn't in the app, but the one created in `src/mac-app` before compression, I get\n\n```\nERROR:  The Sage installation tree has moved\n\nfrom /Users/.../sage\n  to /Users/.../sage/src/mac-app/sage-8.2.beta0-OSX_10.11.6_x86_64/SageMath-8.2.beta0.app/Contents/Resources/sage\n```\nAnyway, you may be right that 10.11 needs different handling.  \n> I have installed the resulting dmg into /Applications (i.e. you open it, it gets checked and mounted, you see an invitation to move Sage into /Applications, you do it, then you open Sage.app in /Applications).\n\nYup, that's exactly what I did.\n\nAnyway, trying again without this change (had to delete all previous long Sage-named folders and app.dmg first).  Probably can report back tonight EST.",
    "created_at": "2017-12-16T15:25:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369078",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:11" align="right">comment:11</div>

Even if I open the binary that isn't in the app, but the one created in `src/mac-app` before compression, I get

```
ERROR:  The Sage installation tree has moved

from /Users/.../sage
  to /Users/.../sage/src/mac-app/sage-8.2.beta0-OSX_10.11.6_x86_64/SageMath-8.2.beta0.app/Contents/Resources/sage
```
Anyway, you may be right that 10.11 needs different handling.  
> I have installed the resulting dmg into /Applications (i.e. you open it, it gets checked and mounted, you see an invitation to move Sage into /Applications, you do it, then you open Sage.app in /Applications).

Yup, that's exactly what I did.

Anyway, trying again without this change (had to delete all previous long Sage-named folders and app.dmg first).  Probably can report back tonight EST.



---

archive/issue_comments_369079.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIn fact, if you have a look at the Makefile in question, you will see that it explicitly sets Sage.app to be located in `/Applications`. Other locations won't work (it's something not well-documented it seems).\nA [better installer](https://stackoverflow.com/questions/11487596/making-os-x-installer-packages-like-a-pro-xcode-developer-id-ready-pkg) would directly move Sage.app to `/Applications`, rather than \ninviting to move it there. Something for another ticket.\n\nAs well, the existing Sage tree, related to this build, must not be moved/deleted.",
    "created_at": "2017-12-16T19:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369079",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

In fact, if you have a look at the Makefile in question, you will see that it explicitly sets Sage.app to be located in `/Applications`. Other locations won't work (it's something not well-documented it seems).
A [better installer](https://stackoverflow.com/questions/11487596/making-os-x-installer-packages-like-a-pro-xcode-developer-id-ready-pkg) would directly move Sage.app to `/Applications`, rather than 
inviting to move it there. Something for another ticket.

As well, the existing Sage tree, related to this build, must not be moved/deleted.



---

archive/issue_comments_369080.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIt doesn't work this way for me without this patch either, so I guess we are okay.  (I checked the package `Contents/Resources/sage/src/mac-app/Makefile` just to be sure it really was the \"right\" one.)\n> In fact, if you have a look at the Makefile in question, you will see that it explicitly sets Sage.app to be located in `/Applications`. Other locations won't work (it's something not well-documented it seems).\n> As well, the existing Sage tree, related to this build, must not be moved/deleted.\n\n?  Here is my exact procedure:\n* I have stuff in `Downloads/sage`\n* I `git pull trac develop`, and the switched branches or not ...\n* I `cd src/mac-app` and `make` as you said\n* There is a magically appearing couple of `app.dmg`.\n* I double-click on the appropriate one, which verifies fine and opens to the window suggesting dragging to `Applications`\n* I do so\n* Opening the app to start Jupyter works (at least, it serves up Jupyter, I didn't try to evaluate anything) and if I have the binary pointing to `Downloads/sage/sage` it works fine\n* But letting it point to the default confuses it because it thinks it's supposed to live in `Downloads/sage/sage`, even though I thought it lived in `src/mac-app`.  (As described above.)\nAgain, as data point, when I use `binary-pkg` to create a binary I don't have problems with relocation, so there is something I'm doing wrong in this process.  Maybe because my original Sage doesn't live in `Applications`?  But I don't want it there, because it's not an app, it's the command line and my \"development\" version.",
    "created_at": "2017-12-17T00:53:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369080",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:13" align="right">comment:13</div>

It doesn't work this way for me without this patch either, so I guess we are okay.  (I checked the package `Contents/Resources/sage/src/mac-app/Makefile` just to be sure it really was the "right" one.)
> In fact, if you have a look at the Makefile in question, you will see that it explicitly sets Sage.app to be located in `/Applications`. Other locations won't work (it's something not well-documented it seems).
> As well, the existing Sage tree, related to this build, must not be moved/deleted.

?  Here is my exact procedure:
* I have stuff in `Downloads/sage`
* I `git pull trac develop`, and the switched branches or not ...
* I `cd src/mac-app` and `make` as you said
* There is a magically appearing couple of `app.dmg`.
* I double-click on the appropriate one, which verifies fine and opens to the window suggesting dragging to `Applications`
* I do so
* Opening the app to start Jupyter works (at least, it serves up Jupyter, I didn't try to evaluate anything) and if I have the binary pointing to `Downloads/sage/sage` it works fine
* But letting it point to the default confuses it because it thinks it's supposed to live in `Downloads/sage/sage`, even though I thought it lived in `src/mac-app`.  (As described above.)
Again, as data point, when I use `binary-pkg` to create a binary I don't have problems with relocation, so there is something I'm doing wrong in this process.  Maybe because my original Sage doesn't live in `Applications`?  But I don't want it there, because it's not an app, it's the command line and my "development" version.



---

archive/issue_comments_369081.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nBy the way, I think it's worth having a ticket that this creates a `tmp-...` dmg file in `src/mac-app` that is not eventually trashed.\n\nSeparately, I have no idea why making the app this way makes one that is 7.3 GB and not the usual 3.4 GB; something is being doubled, probably by the way I'm doing it, but I have no idea what.  Maybe it's packaging up an extra dmg in the dmg, who knows.",
    "created_at": "2017-12-17T00:56:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369081",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:14" align="right">comment:14</div>

By the way, I think it's worth having a ticket that this creates a `tmp-...` dmg file in `src/mac-app` that is not eventually trashed.

Separately, I have no idea why making the app this way makes one that is 7.3 GB and not the usual 3.4 GB; something is being doubled, probably by the way I'm doing it, but I have no idea what.  Maybe it's packaging up an extra dmg in the dmg, who knows.



---

archive/issue_comments_369082.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAbout comment 14: the tmp-...dmg file is read-write so that we can mount it and call AppleScript in the mounted directory to set the background image. Read-write dmg's cannot be compressed. After we call AppleScript, we can compress it resulting in a read-only dmg.\n\nI refer to comment 2 in Ticket #23426 for more.",
    "created_at": "2017-12-17T01:50:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369082",
    "user": "https://github.com/unhyperbolic"
}
```

<div id="comment:15" align="right">comment:15</div>

About comment 14: the tmp-...dmg file is read-write so that we can mount it and call AppleScript in the mounted directory to set the background image. Read-write dmg's cannot be compressed. After we call AppleScript, we can compress it resulting in a read-only dmg.

I refer to comment 2 in Ticket #23426 for more.



---

archive/issue_comments_369083.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@kcrisman](#comment:13):\n> It doesn't work this way for me without this patch either, so I guess we are okay.  (I checked the package `Contents/Resources/sage/src/mac-app/Makefile` just to be sure it really was the \"right\" one.)\n> > In fact, if you have a look at the Makefile in question, you will see that it explicitly sets Sage.app to be located in `/Applications`. Other locations won't work (it's something not well-documented it seems).\n> > As well, the existing Sage tree, related to this build, must not be moved/deleted.\n\n> ?  Here is my exact procedure:\n> * I have stuff in `Downloads/sage`\n> * I `git pull trac develop`, and the switched branches or not ...\n\nyou have to build Sage first, and only after that\nbuild mac-app.\n\n> * I `cd src/mac-app` and `make` as you said\n\n> * There is a magically appearing couple of `app.dmg`.\n> * I double-click on the appropriate one, which verifies fine and opens to the window suggesting dragging to `Applications`\n> * I do so\n> * Opening the app to start Jupyter works (at least, it serves up Jupyter, I didn't try to evaluate anything) and if I have the binary pointing to `Downloads/sage/sage` it works fine\n> * But letting it point to the default confuses it because it thinks it's supposed to live in `Downloads/sage/sage`, even though I thought it lived in `src/mac-app`.  (As described above.)\n> Again, as data point, when I use `binary-pkg` to create a binary I don't have problems with relocation, so there is something I'm doing wrong in this process.  Maybe because my original Sage doesn't live in `Applications`?  But I don't want it there, because it's not an app, it's the command line and my \"development\" version.\n\nNo, the original Sage does not have to be in /Applications",
    "created_at": "2017-12-17T02:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369083",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@kcrisman](#comment:13):
> It doesn't work this way for me without this patch either, so I guess we are okay.  (I checked the package `Contents/Resources/sage/src/mac-app/Makefile` just to be sure it really was the "right" one.)
> > In fact, if you have a look at the Makefile in question, you will see that it explicitly sets Sage.app to be located in `/Applications`. Other locations won't work (it's something not well-documented it seems).
> > As well, the existing Sage tree, related to this build, must not be moved/deleted.

> ?  Here is my exact procedure:
> * I have stuff in `Downloads/sage`
> * I `git pull trac develop`, and the switched branches or not ...

you have to build Sage first, and only after that
build mac-app.

> * I `cd src/mac-app` and `make` as you said

> * There is a magically appearing couple of `app.dmg`.
> * I double-click on the appropriate one, which verifies fine and opens to the window suggesting dragging to `Applications`
> * I do so
> * Opening the app to start Jupyter works (at least, it serves up Jupyter, I didn't try to evaluate anything) and if I have the binary pointing to `Downloads/sage/sage` it works fine
> * But letting it point to the default confuses it because it thinks it's supposed to live in `Downloads/sage/sage`, even though I thought it lived in `src/mac-app`.  (As described above.)
> Again, as data point, when I use `binary-pkg` to create a binary I don't have problems with relocation, so there is something I'm doing wrong in this process.  Maybe because my original Sage doesn't live in `Applications`?  But I don't want it there, because it's not an app, it's the command line and my "development" version.

No, the original Sage does not have to be in /Applications



---

archive/issue_comments_369084.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n> > * I `git pull trac develop`, and the switched branches or not ...\n\n> \n> you have to build Sage first, and only after that\n> build mac-app.\n\nRight, I did do that but forgot to say so.\n\n> > Again, as data point, when I use `binary-pkg` to create a binary I don't have problems with relocation, so there is something I'm doing wrong in this process.  Maybe because my original Sage doesn't live in `Applications`?  But I don't want it there, because it's not an app, it's the command line and my \"development\" version.\n\n> \n> No, the original Sage does not have to be in /Applications\n\nThen I have no explanation for this behavior.",
    "created_at": "2017-12-19T19:18:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369084",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:17" align="right">comment:17</div>

> > * I `git pull trac develop`, and the switched branches or not ...

> 
> you have to build Sage first, and only after that
> build mac-app.

Right, I did do that but forgot to say so.

> > Again, as data point, when I use `binary-pkg` to create a binary I don't have problems with relocation, so there is something I'm doing wrong in this process.  Maybe because my original Sage doesn't live in `Applications`?  But I don't want it there, because it's not an app, it's the command line and my "development" version.

> 
> No, the original Sage does not have to be in /Applications

Then I have no explanation for this behavior.



---

archive/issue_comments_369085.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI am told that Mac-app building does not work on OSX 10.11 without the patch.\nThus the question whether this patch introduces a regression there is moot.",
    "created_at": "2018-01-08T15:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369085",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

I am told that Mac-app building does not work on OSX 10.11 without the patch.
Thus the question whether this patch introduces a regression there is moot.



---

archive/issue_comments_369086.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThat's weird because I am successful on 10.11.  But go ahead and I can test it once merged too - let me know.",
    "created_at": "2018-01-08T18:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369086",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:19" align="right">comment:19</div>

That's weird because I am successful on 10.11.  But go ahead and I can test it once merged too - let me know.



---

archive/issue_comments_369087.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kcrisman](#comment:19):\n> That's weird because I am successful on 10.11.  But go ahead and I can test it once merged too - let me know.\n\nthis ticket needs a reviewer :-)\n\ndo you say that this patch breaks is for you on 10.11 ?",
    "created_at": "2018-01-08T18:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369087",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kcrisman](#comment:19):
> That's weird because I am successful on 10.11.  But go ahead and I can test it once merged too - let me know.

this ticket needs a reviewer :-)

do you say that this patch breaks is for you on 10.11 ?



---

archive/issue_comments_369088.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@dimpase](#comment:20):\n> Replying to [@kcrisman](#comment:19):\n> > That's weird because I am successful on 10.11.  But go ahead and I can test it once merged too - let me know.\n\n> \n> this ticket needs a reviewer :-)\n\nI thought that was you.\n> \n> do you say that this patch breaks is for you on 10.11 ?\n\nNot at all, I'm saying that I wasn't able to test it properly for some reason alluded to above I don't fully understand.  But once it's merged I can use binary-pkg to test it.",
    "created_at": "2018-01-09T02:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369088",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@dimpase](#comment:20):
> Replying to [@kcrisman](#comment:19):
> > That's weird because I am successful on 10.11.  But go ahead and I can test it once merged too - let me know.

> 
> this ticket needs a reviewer :-)

I thought that was you.
> 
> do you say that this patch breaks is for you on 10.11 ?

Not at all, I'm saying that I wasn't able to test it properly for some reason alluded to above I don't fully understand.  But once it's merged I can use binary-pkg to test it.



---

archive/issue_comments_369089.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nthe ticket has fields author and reviewer, check them :-)\n\nwhy would you need it merged for testing?",
    "created_at": "2018-01-09T08:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369089",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

the ticket has fields author and reviewer, check them :-)

why would you need it merged for testing?



---

archive/issue_comments_369090.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n> the ticket has fields author and reviewer, check them :-)\n\nSorry, I wasn't paying attention to that.  Since I don't have access to 10.12/13 and I couldn't get it to work on 10.11, I can't give that review.  Though John said it was okay on 10.13.\n> why would you need it merged for testing?\n\nI don't understand it either, but for some reason it is not working for me following the directions you provided.  When I use `binary-pkg`, which requires me to provide either the `develop` or `master` branch on Trac, then I can build the mac app in such a fashion that I can put it in `Applications/` and test it.  I don't know what (if anything) I'm doing wrong, but don't have time to mess around with it, unfortunately.",
    "created_at": "2018-01-09T13:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369090",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:23" align="right">comment:23</div>

> the ticket has fields author and reviewer, check them :-)

Sorry, I wasn't paying attention to that.  Since I don't have access to 10.12/13 and I couldn't get it to work on 10.11, I can't give that review.  Though John said it was okay on 10.13.
> why would you need it merged for testing?

I don't understand it either, but for some reason it is not working for me following the directions you provided.  When I use `binary-pkg`, which requires me to provide either the `develop` or `master` branch on Trac, then I can build the mac app in such a fashion that I can put it in `Applications/` and test it.  I don't know what (if anything) I'm doing wrong, but don't have time to mess around with it, unfortunately.



---

archive/issue_comments_369091.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@kcrisman](#comment:23):\n> > the ticket has fields author and reviewer, check them :-)\n\n> Sorry, I wasn't paying attention to that.  Since I don't have access to 10.12/13 and I couldn't get it to work on 10.11, I can't give that review.  Though John said it was okay on 10.13.\n> > why would you need it merged for testing?\n\n> I don't understand it either, but for some reason it is not working for me following the directions you provided.  When I use `binary-pkg`, which requires me to provide either the `develop` or `master` branch on Trac, then I can build the mac app in such a fashion that I can put it in `Applications/` and test it.\n\ngit branch and repo used by `binary-pkg` is controlled by lines 3 and 4 of [sage.yaml](https://github.com/sagemath/binary-pkg/blob/master/sage.yaml) - you can change them to whatever you like.\n\nNamely, setting  them to \n\n```\nrepository: https://github.com/sagemath/sagetrac-mirror.git\nbranch: u/dimpase/mac-appfix\n```\nshould do the trick.",
    "created_at": "2018-01-09T14:09:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369091",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@kcrisman](#comment:23):
> > the ticket has fields author and reviewer, check them :-)

> Sorry, I wasn't paying attention to that.  Since I don't have access to 10.12/13 and I couldn't get it to work on 10.11, I can't give that review.  Though John said it was okay on 10.13.
> > why would you need it merged for testing?

> I don't understand it either, but for some reason it is not working for me following the directions you provided.  When I use `binary-pkg`, which requires me to provide either the `develop` or `master` branch on Trac, then I can build the mac app in such a fashion that I can put it in `Applications/` and test it.

git branch and repo used by `binary-pkg` is controlled by lines 3 and 4 of [sage.yaml](https://github.com/sagemath/binary-pkg/blob/master/sage.yaml) - you can change them to whatever you like.

Namely, setting  them to 

```
repository: https://github.com/sagemath/sagetrac-mirror.git
branch: u/dimpase/mac-appfix
```
should do the trick.



---

archive/issue_comments_369092.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n> git branch and repo used by `binary-pkg` is controlled by lines 3 and 4 of [sage.yaml](https://github.com/sagemath/binary-pkg/blob/master/sage.yaml) - you can change them to whatever you like.\n> \n> Namely, setting  them to \n> \n> ```\n> repository: https://github.com/sagemath/sagetrac-mirror.git\n> branch: u/dimpase/mac-appfix\n> ```\n> should do the trick.\n\nAh, I didn't know I could access the branch that way!  I do edit this file but typically only in stupid ways.  There was another thread where we were warned not to use `sagetrac-mirror` ;-) but this is a good use of it.\n\nWith some luck before I leave work today I might have something useful to say about this on 10.11.",
    "created_at": "2018-01-09T16:18:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369092",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:25" align="right">comment:25</div>

> git branch and repo used by `binary-pkg` is controlled by lines 3 and 4 of [sage.yaml](https://github.com/sagemath/binary-pkg/blob/master/sage.yaml) - you can change them to whatever you like.
> 
> Namely, setting  them to 
> 
> ```
> repository: https://github.com/sagemath/sagetrac-mirror.git
> branch: u/dimpase/mac-appfix
> ```
> should do the trick.

Ah, I didn't know I could access the branch that way!  I do edit this file but typically only in stupid ways.  There was another thread where we were warned not to use `sagetrac-mirror` ;-) but this is a good use of it.

With some luck before I leave work today I might have something useful to say about this on 10.11.



---

archive/issue_comments_369093.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n\n```\nsubprocess.CalledProcessError: Command '['git', 'checkout', 'u/dimpase/mac-appfix']' returned non-zero exit status 1\n```",
    "created_at": "2018-01-09T16:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369093",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:26" align="right">comment:26</div>


```
subprocess.CalledProcessError: Command '['git', 'checkout', 'u/dimpase/mac-appfix']' returned non-zero exit status 1
```



---

archive/issue_comments_369094.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAre you trying with a fresh clone of https://github.com/sagemath/binary-pkg ?\nDoes it work with these lines in sage.yaml unchanged?\n\nIt works for me on Linux and on OSX 10.13:\n\n1) change these lines in sage.yaml as follows:\n\n```\nrepository: https://github.com/sagemath/sagetrac-mirror.git\nbranch: u/dimpase/mac-appfix\n```\n\n2) run `make package-sage`\n\n3) ...",
    "created_at": "2018-01-09T16:57:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369094",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

Are you trying with a fresh clone of https://github.com/sagemath/binary-pkg ?
Does it work with these lines in sage.yaml unchanged?

It works for me on Linux and on OSX 10.13:

1) change these lines in sage.yaml as follows:

```
repository: https://github.com/sagemath/sagetrac-mirror.git
branch: u/dimpase/mac-appfix
```

2) run `make package-sage`

3) ...



---

archive/issue_comments_369095.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI didn't have an updated `binary-pkg`.  After doing so, now I get\n\n```\n  File \"/Users/.../binary-pkg/binary_pkg/os_information.py\", line 4, in <module>\n    import ld\nModuleNotFoundError: No module named 'ld'\nmake[1]: *** [checkout-sage] Error 1\nmake: *** [bdist-sage-osx] Error 2\n```\n\nSo I just completely did a new `git clone`.  Hopefully this will do better!",
    "created_at": "2018-01-09T17:43:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369095",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:28" align="right">comment:28</div>

I didn't have an updated `binary-pkg`.  After doing so, now I get

```
  File "/Users/.../binary-pkg/binary_pkg/os_information.py", line 4, in <module>
    import ld
ModuleNotFoundError: No module named 'ld'
make[1]: *** [checkout-sage] Error 1
make: *** [bdist-sage-osx] Error 2
```

So I just completely did a new `git clone`.  Hopefully this will do better!



---

archive/issue_comments_369096.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nIndeed, binary-pkg installs a miniconda to get a good python, and perhaps some stale files prevented this from being updated properly. On OSX 10.13 I see\n\n```\n$ ./tools/binary-pkg/bin/python\nPython 3.6.4 | packaged by conda-forge | (default, Dec 23 2017, 16:54:01) \n[GCC 4.2.1 Compatible Apple LLVM 6.1.0 (clang-602.0.53)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import ld\n>>> \n```\nworking.",
    "created_at": "2018-01-09T18:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369096",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

Indeed, binary-pkg installs a miniconda to get a good python, and perhaps some stale files prevented this from being updated properly. On OSX 10.13 I see

```
$ ./tools/binary-pkg/bin/python
Python 3.6.4 | packaged by conda-forge | (default, Dec 23 2017, 16:54:01) 
[GCC 4.2.1 Compatible Apple LLVM 6.1.0 (clang-602.0.53)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import ld
>>> 
```
working.



---

archive/issue_comments_369097.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nProbably that's what happened.  Currently building, but of course `SAGE_INSTALL_GCC='yes'` or something in `binary-pkg` and I didn't want to mess with that setting, so this will take a **long** time.",
    "created_at": "2018-01-09T19:12:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369097",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:30" align="right">comment:30</div>

Probably that's what happened.  Currently building, but of course `SAGE_INSTALL_GCC='yes'` or something in `binary-pkg` and I didn't want to mess with that setting, so this will take a **long** time.



---

archive/issue_comments_369098.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI presume you do `make package-sage PACKAGE=\"OSX mac app\"` - I forgot abou the last parameter.",
    "created_at": "2018-01-09T19:14:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369098",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

I presume you do `make package-sage PACKAGE="OSX mac app"` - I forgot abou the last parameter.



---

archive/issue_comments_369099.json:
```json
{
    "body": "Reviewer: **John Palmieri, Karl-Dieter Crisman**",
    "created_at": "2018-01-12T21:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369099",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **John Palmieri, Karl-Dieter Crisman**



---

archive/issue_comments_369100.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nNot only did it work, it saved my ... rear end, because the wireless at the Joint Meetings was sketchy enough I couldn't have given my talk using Sage in number theory without running my local Sage, which ended up being this very dmg :-)",
    "created_at": "2018-01-12T21:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369100",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:32" align="right">comment:32</div>

Not only did it work, it saved my ... rear end, because the wireless at the Joint Meetings was sketchy enough I couldn't have given my talk using Sage in number theory without running my local Sage, which ended up being this very dmg :-)



---

archive/issue_comments_369101.json:
```json
{
    "body": "Changed work issues from **check that this change works on older OSXs** to none",
    "created_at": "2018-01-12T21:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369101",
    "user": "https://github.com/kcrisman"
}
```

Changed work issues from **check that this change works on older OSXs** to none



---

archive/issue_events_334996.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2018-01-12T21:40:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334996"
}
```



---

archive/issue_events_334997.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2018-01-12T21:40:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334997"
}
```



---

archive/issue_comments_369102.json:
```json
{
    "body": "Changed branch from **[u/dimpase/mac-appfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/mac-appfix)** to **[`84861cd`](https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8)**",
    "created_at": "2018-01-14T10:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24373#issuecomment-369102",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dimpase/mac-appfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/mac-appfix)** to **[`84861cd`](https://github.com/sagemath/sagetrac-mirror/commit/84861cdd2b9215863e3e4d11794422539fcc83d8)**



---

archive/issue_events_334998.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:14:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334998"
}
```



---

archive/issue_events_334999.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3b974324e7379f22a737a298aebbf7e8991553aa",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-01-14T10:14:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24373",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24373#event-334999"
}
```
