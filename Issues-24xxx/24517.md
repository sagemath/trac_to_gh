# Issue 24517: random failure in sage/geometry/cone.py

archive/issues_024280.json:
```json
{
    "body": "Sometimes, patchbot report errord with the following test in `src/sage/geometry/cone.py`. The cause is running out of memory.\n\n```\n        sage: K = random_cone(min_ambient_dim=3, # long time\n        ....:                 max_ambient_dim=3, # long time\n        ....:                 min_rays=7)        # long time\n```\n\nSometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.\n\nThe code seems to generate a random cone with a random unbounded(!) number of rays until it finds a good cone. This is obviously asking for trouble.\n\nPatchbot reports:\n\n- [https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02](https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02)\n\n- [quasar 2018-01-11%2015:44:33](https://patchbot.sagemath.org/log/24511/Ubuntu/16.04/x86_64/4.4.0-104-generic/quasar/2018-01-11%2015:44:33?short)\n\n**CC:**  @orlitzky\n\n**Branch/Commit:** [2683d071d904469a01ce3949dacff8768f8df711](https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/24517\n\n",
    "closed_at": "2018-02-01T19:13:37Z",
    "created_at": "2018-01-11T16:06:45Z",
    "labels": [
        "component: doctest coverage",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "title": "random failure in sage/geometry/cone.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/24517",
    "user": "https://github.com/videlec"
}
```
Sometimes, patchbot report errord with the following test in `src/sage/geometry/cone.py`. The cause is running out of memory.

```
        sage: K = random_cone(min_ambient_dim=3, # long time
        ....:                 max_ambient_dim=3, # long time
        ....:                 min_rays=7)        # long time
```

Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.

The code seems to generate a random cone with a random unbounded(!) number of rays until it finds a good cone. This is obviously asking for trouble.

Patchbot reports:

- [https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02](https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02)

- [quasar 2018-01-11%2015:44:33](https://patchbot.sagemath.org/log/24511/Ubuntu/16.04/x86_64/4.4.0-104-generic/quasar/2018-01-11%2015:44:33?short)

**CC:**  @orlitzky

**Branch/Commit:** [2683d071d904469a01ce3949dacff8768f8df711](https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711)

**Reviewer:** Frédéric Chapoton

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/24517





---

archive/issue_comments_373712.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis traceback line\n\n```\n#8  __pyx_f_4sage_3ext_6memory_alloc_error (__pyx_v_size=__pyx_v_size@entry=8) at build/cythonized/sage/ext/memory.c:1169\n```\nshows that it is happening because of lack of memory. So either this particular patchbot is low on memory or this doctest does something which requires lots of memory.\n\nNow this out-of-memory situation is not gracefully handled. I could change the code to `raise MemoryError` instead of crashing, but that won't solve the underlying issue that it is running out of memory.",
    "created_at": "2018-01-11T16:26:52Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373712",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
This traceback line

```
#8  __pyx_f_4sage_3ext_6memory_alloc_error (__pyx_v_size=__pyx_v_size@entry=8) at build/cythonized/sage/ext/memory.c:1169
```
shows that it is happening because of lack of memory. So either this particular patchbot is low on memory or this doctest does something which requires lots of memory.

Now this out-of-memory situation is not gracefully handled. I could change the code to `raise MemoryError` instead of crashing, but that won't solve the underlying issue that it is running out of memory.



---

archive/issue_comments_373713.json:
```json
{
    "body": "<a id='comment:2'></a>\nquasar is 8G memory (though tests are run in parallel). For me these are two problems:\n- the crash when doctesting\n- the fact that the `random_cone` method is not careful with the size of the generated cone\n\nWhich one do you want to deal with on this ticket?",
    "created_at": "2018-01-11T16:30:50Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373713",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
quasar is 8G memory (though tests are run in parallel). For me these are two problems:
- the crash when doctesting
- the fact that the `random_cone` method is not careful with the size of the generated cone

Which one do you want to deal with on this ticket?



---

archive/issue_comments_373714.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [vdelecroix](#comment%3A2):\n> quasar is 8G memory (though tests are run in parallel). For me these are two problems:\n> - the crash when doctesting\n> - the fact that the `random_cone` method is not careful with the size of the generated cone\n> \n> Which one do you want to deal with on this ticket?\n\n\nThe last one.",
    "created_at": "2018-01-11T16:32:59Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373714",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
Replying to [vdelecroix](#comment%3A2):
> quasar is 8G memory (though tests are run in parallel). For me these are two problems:
> - the crash when doctesting
> - the fact that the `random_cone` method is not careful with the size of the generated cone
> 
> Which one do you want to deal with on this ticket?


The last one.



---

archive/issue_comments_373715.json:
```json
{
    "body": "<a id='comment:4'></a>\nI would argue not to the fix the first issue. It happened in `Rational.__new__()`. If there is not enough space for that, then surely stuff will break anyway sooner or later. Second, adding error checking would mean adding `sig_on()` and `sig_off()` which causes some loss of performance every time that a new `Rational` is created.",
    "created_at": "2018-01-11T16:36:39Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373715",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
I would argue not to the fix the first issue. It happened in `Rational.__new__()`. If there is not enough space for that, then surely stuff will break anyway sooner or later. Second, adding error checking would mean adding `sig_on()` and `sig_off()` which causes some loss of performance every time that a new `Rational` is created.



---

archive/issue_events_217363.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-16T22:57:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "component: documentation",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217363"
}
```



---

archive/issue_events_217364.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-16T22:57:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "component: doctest coverage",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217364"
}
```



---

archive/issue_events_217365.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-16T22:57:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217365"
}
```



---

archive/issue_comments_373716.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,9 @@\n-Sometimes, patchbot reports a `sig_error() without sig_on()` when tests are run on `sage/geometry/cone.py`.\n+Sometimes, patchbot report error with the `random_cone` test in `src/sage/geometry/cone.py`. The cause is running out of memory.\n \n-See:\n+Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.\n+\n+Patchbot reports:\n+\n+- [https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02](https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02)\n \n - [quasar 2018-01-11%2015:44:33](https://patchbot.sagemath.org/log/24511/Ubuntu/16.04/x86_64/4.4.0-104-generic/quasar/2018-01-11%2015:44:33?short)\n``````\n",
    "created_at": "2018-01-16T22:57:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373716",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,9 @@
-Sometimes, patchbot reports a `sig_error() without sig_on()` when tests are run on `sage/geometry/cone.py`.
+Sometimes, patchbot report error with the `random_cone` test in `src/sage/geometry/cone.py`. The cause is running out of memory.
 
-See:
+Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.
+
+Patchbot reports:
+
+- [https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02](https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02)
 
 - [quasar 2018-01-11%2015:44:33](https://patchbot.sagemath.org/log/24511/Ubuntu/16.04/x86_64/4.4.0-104-generic/quasar/2018-01-11%2015:44:33?short)
``````




---

archive/issue_comments_373717.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n-Sometimes, patchbot report error with the `random_cone` test in `src/sage/geometry/cone.py`. The cause is running out of memory.\n+Sometimes, patchbot report errord with the following test in `src/sage/geometry/cone.py`. The cause is running out of memory.\n+\n+```\n+        sage: K = random_cone(min_ambient_dim=3, # long time\n+        ....:                 max_ambient_dim=3, # long time\n+        ....:                 min_rays=7)        # long time\n+```\n \n Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.\n \n``````\n",
    "created_at": "2018-01-16T23:04:08Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373717",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
-Sometimes, patchbot report error with the `random_cone` test in `src/sage/geometry/cone.py`. The cause is running out of memory.
+Sometimes, patchbot report errord with the following test in `src/sage/geometry/cone.py`. The cause is running out of memory.
+
+```
+        sage: K = random_cone(min_ambient_dim=3, # long time
+        ....:                 max_ambient_dim=3, # long time
+        ....:                 min_rays=7)        # long time
+```
 
 Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.
 
``````




---

archive/issue_comments_373718.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,6 +8,8 @@\n \n Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.\n \n+The code seems to generate a random cone with a random unbounded(!) number of rays until it finds a good cone. This is obviously asking for trouble.\n+\n Patchbot reports:\n \n - [https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02](https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02)\n``````\n",
    "created_at": "2018-01-16T23:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373718",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,6 +8,8 @@
 
 Sometimes, the test simply gives a `MemoryError` and sometimes a more severe crash, like `sig_error() without sig_on()`.
 
+The code seems to generate a random cone with a random unbounded(!) number of rays until it finds a good cone. This is obviously asking for trouble.
+
 Patchbot reports:
 
 - [https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02](https://patchbot.sagemath.org/log/24549/debian/stretch/sid/x86_64/4.4.0-45-generic/fermat/2018-01-16%2019:07:02)
``````




---

archive/issue_comments_373719.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/random_failure_in_sage_geometry_cone_py](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/random_failure_in_sage_geometry_cone_py)",
    "created_at": "2018-01-16T23:14:40Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373719",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/random_failure_in_sage_geometry_cone_py](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/random_failure_in_sage_geometry_cone_py)



---

archive/issue_comments_373720.json:
```json
{
    "body": "**Commit:** [e6334598576c96a65dc6a6ca34d794cd37dea049](https://github.com/sagemath/sagetrac-mirror/commit/e6334598576c96a65dc6a6ca34d794cd37dea049)",
    "created_at": "2018-01-16T23:16:00Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [e6334598576c96a65dc6a6ca34d794cd37dea049](https://github.com/sagemath/sagetrac-mirror/commit/e6334598576c96a65dc6a6ca34d794cd37dea049)



---

archive/issue_comments_373721.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6334598576c96a65dc6a6ca34d794cd37dea049\">e633459</a></td><td><code>Bound number of rays in doctest</code></td></tr></table>\n",
    "created_at": "2018-01-16T23:16:00Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6334598576c96a65dc6a6ca34d794cd37dea049">e633459</a></td><td><code>Bound number of rays in doctest</code></td></tr></table>




---

archive/issue_comments_373722.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2018-01-16T23:16:18Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373722",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_events_217366.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-16T23:16:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217366"
}
```



---

archive/issue_comments_373723.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis test shouldn't generate a cone with an unbounded number of rays. The `random_cone` method is capable of \"resetting\" itself, and this test is meant to check that \"reset\" behavior.\n\nIf I want a random cone in three dimensions with 7 extreme rays, I will start generating random rays and adding them to my cone, starting with the trivial cone. But eventually, what will likely happen is that I'll wind up with all of `R^3`, which needs only six generators. At that point, the approach is doomed: if I generate more rays and add them to `R^3`, I still get `R^3`. So what can be done? Throw it out and start over!\n\nThere do exist cones in `R^3` with 7 extreme rays, it just takes some luck to find them using the approach that `random_cone` takes. So this test ensures that we will throw out a \"doomed\" cone and start over when we arrive at one.\n\nThe test should succeed as soon as it gets 7 rays, and not an unbounded number. Instead, I think there's probably a little bit of memory that isn't getting freed when we throw out the old, doomed random cone and start over.\n\nDo I need some trick like `K = None` when we're going to loop?",
    "created_at": "2018-01-16T23:42:43Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373723",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:11'></a>
This test shouldn't generate a cone with an unbounded number of rays. The `random_cone` method is capable of "resetting" itself, and this test is meant to check that "reset" behavior.

If I want a random cone in three dimensions with 7 extreme rays, I will start generating random rays and adding them to my cone, starting with the trivial cone. But eventually, what will likely happen is that I'll wind up with all of `R^3`, which needs only six generators. At that point, the approach is doomed: if I generate more rays and add them to `R^3`, I still get `R^3`. So what can be done? Throw it out and start over!

There do exist cones in `R^3` with 7 extreme rays, it just takes some luck to find them using the approach that `random_cone` takes. So this test ensures that we will throw out a "doomed" cone and start over when we arrive at one.

The test should succeed as soon as it gets 7 rays, and not an unbounded number. Instead, I think there's probably a little bit of memory that isn't getting freed when we throw out the old, doomed random cone and start over.

Do I need some trick like `K = None` when we're going to loop?



---

archive/issue_comments_373724.json:
```json
{
    "body": "<a id='comment:12'></a>\nTo be specific, we loop until the random cone (in progress) K \"is valid\",\n\n```\nif is_valid(K):\n    # Loop if we don't have a valid cone.\n    return K\n```\n\nBut that will be true as soon as this is true,\n\n```\nall([\n    K.nrays() >= min_rays,\n    K.nrays() <= max_rays or max_rays is None,\n    K.is_solid() == solid or solid is None,\n    K.is_strictly_convex() == strictly_convex or strictly_convex is None\n])\n```\n\nAnd in this case, since everything but `min_rays` is `None`, all we need is `K.nrays() >= min_rays`. Since we add them one-at-a-time, I would hope that we always get 7.",
    "created_at": "2018-01-16T23:52:23Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373724",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:12'></a>
To be specific, we loop until the random cone (in progress) K "is valid",

```
if is_valid(K):
    # Loop if we don't have a valid cone.
    return K
```

But that will be true as soon as this is true,

```
all([
    K.nrays() >= min_rays,
    K.nrays() <= max_rays or max_rays is None,
    K.is_solid() == solid or solid is None,
    K.is_strictly_convex() == strictly_convex or strictly_convex is None
])
```

And in this case, since everything but `min_rays` is `None`, all we need is `K.nrays() >= min_rays`. Since we add them one-at-a-time, I would hope that we always get 7.



---

archive/issue_comments_373725.json:
```json
{
    "body": "<a id='comment:13'></a>\nAaaaaaaaand nevermind. The default for `max_rays` is `None`, which is a priori fine. The random cone generation works like I said it does above: if you try to add a million rays, you'll usually get to the sixth or seventh before you've got all of `R^3`, and then the whole thing will restart.\n\nBut there's this little snippet, which tries to construct a decent number of starting rays before we begin to generate and add them one at a time:\n\n```\nr = random_min_max(min_rays, max_rays)\nrays = [L.random_element() for i in range(r)]\n```\n\nI would bet that the problem is right there, where we can generate a huge list of random rays, even if rays 7 through N will get thrown out as being redundant.\n\nI think that's a bug in my implementation.",
    "created_at": "2018-01-17T00:09:57Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373725",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:13'></a>
Aaaaaaaaand nevermind. The default for `max_rays` is `None`, which is a priori fine. The random cone generation works like I said it does above: if you try to add a million rays, you'll usually get to the sixth or seventh before you've got all of `R^3`, and then the whole thing will restart.

But there's this little snippet, which tries to construct a decent number of starting rays before we begin to generate and add them one at a time:

```
r = random_min_max(min_rays, max_rays)
rays = [L.random_element() for i in range(r)]
```

I would bet that the problem is right there, where we can generate a huge list of random rays, even if rays 7 through N will get thrown out as being redundant.

I think that's a bug in my implementation.



---

archive/issue_comments_373726.json:
```json
{
    "body": "<a id='comment:14'></a>\nProposed fix: replace,\n\n```\nrays = [L.random_element() for i in range(r)]\n```\n\nwith\n\n```\nrays = [L.random_element() for i in range(min_rays)]\n```\n\nThat will be a tiny bit slower in some cases, but far more sane when `max_rays` is `None`.\n\nIt will take me a day or two to build sage (it's been a while), so you have plenty of time to let me know if that does the trick =)",
    "created_at": "2018-01-17T00:41:49Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373726",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:14'></a>
Proposed fix: replace,

```
rays = [L.random_element() for i in range(r)]
```

with

```
rays = [L.random_element() for i in range(min_rays)]
```

That will be a tiny bit slower in some cases, but far more sane when `max_rays` is `None`.

It will take me a day or two to build sage (it's been a while), so you have plenty of time to let me know if that does the trick =)



---

archive/issue_comments_373727.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436\">8bba349</a></td><td><code>Start with \"min_rays\" rays in random_cone()</code></td></tr></table>\n",
    "created_at": "2018-01-17T13:00:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373727",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436">8bba349</a></td><td><code>Start with "min_rays" rays in random_cone()</code></td></tr></table>




---

archive/issue_comments_373728.json:
```json
{
    "body": "**Changing commit** from \"[e6334598576c96a65dc6a6ca34d794cd37dea049](https://github.com/sagemath/sagetrac-mirror/commit/e6334598576c96a65dc6a6ca34d794cd37dea049)\" to \"[8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436](https://github.com/sagemath/sagetrac-mirror/commit/8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436)\".",
    "created_at": "2018-01-17T13:00:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373728",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e6334598576c96a65dc6a6ca34d794cd37dea049](https://github.com/sagemath/sagetrac-mirror/commit/e6334598576c96a65dc6a6ca34d794cd37dea049)" to "[8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436](https://github.com/sagemath/sagetrac-mirror/commit/8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436)".



---

archive/issue_comments_373729.json:
```json
{
    "body": "<a id='comment:16'></a>\nI tried to fix it using your suggestion. Needs review.",
    "created_at": "2018-01-17T13:17:54Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373729",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
I tried to fix it using your suggestion. Needs review.



---

archive/issue_comments_373730.json:
```json
{
    "body": "**Changing commit** from \"[8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436](https://github.com/sagemath/sagetrac-mirror/commit/8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436)\" to \"[6f9be50a05a2ed71fff5634fd207b326a59887c4](https://github.com/sagemath/sagetrac-mirror/commit/6f9be50a05a2ed71fff5634fd207b326a59887c4)\".",
    "created_at": "2018-01-18T18:24:44Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373730",
    "user": "https://github.com/orlitzky"
}
```

**Changing commit** from "[8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436](https://github.com/sagemath/sagetrac-mirror/commit/8bba3491d8d9cdff1b2b7d3a0bd9459ec5514436)" to "[6f9be50a05a2ed71fff5634fd207b326a59887c4](https://github.com/sagemath/sagetrac-mirror/commit/6f9be50a05a2ed71fff5634fd207b326a59887c4)".



---

archive/issue_comments_373731.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/random_failure_in_sage_geometry_cone_py](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/random_failure_in_sage_geometry_cone_py)\" to \"[u/mjo/ticket/24517](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/24517)\".",
    "created_at": "2018-01-18T18:24:44Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373731",
    "user": "https://github.com/orlitzky"
}
```

**Changing branch** from "[u/jdemeyer/random_failure_in_sage_geometry_cone_py](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/random_failure_in_sage_geometry_cone_py)" to "[u/mjo/ticket/24517](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/24517)".



---

archive/issue_comments_373732.json:
```json
{
    "body": "<a id='comment:17'></a>\nI think we should keep your original fix, too, and specify `max_rays=9` in the test. The code for `max_rays=None` should not go insane, obviously, but the test case shouldn't loop more than is necessary either.\n\nI also added an \"if\" statement to retain the original behavior when `max_rays` is not `None`. There's a trade-off here; namely that the user can still cause himself pain and suffering by specifying e.g. `max_rays=1000000` in a three-dimensional space (basically, the problem in this ticket). On the other hand, we would like to avoid generating rays and checking the cone's validity one ray at a time if `min_rays=1` and `max_rays=1000` in a thousand-dimensional space. If we pick `r=500` in that case, we're much better off generating 500 random rays at the start.\n\nIn any case, this shouldn't cause problems for the test suite any longer.\n\nI didn't notice the rest of your comment changes before working on this, but it looks like they all followed from the `r` -> `min_rays` change, which is now only conditional, so please let me know if there's any other comment fix I should pull.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f9be50a05a2ed71fff5634fd207b326a59887c4\">6f9be50</a></td><td><code>Trac #24517: improve random_cone() performance when max_rays is None.</code></td></tr></table>\n",
    "created_at": "2018-01-18T18:24:44Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373732",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:17'></a>
I think we should keep your original fix, too, and specify `max_rays=9` in the test. The code for `max_rays=None` should not go insane, obviously, but the test case shouldn't loop more than is necessary either.

I also added an "if" statement to retain the original behavior when `max_rays` is not `None`. There's a trade-off here; namely that the user can still cause himself pain and suffering by specifying e.g. `max_rays=1000000` in a three-dimensional space (basically, the problem in this ticket). On the other hand, we would like to avoid generating rays and checking the cone's validity one ray at a time if `min_rays=1` and `max_rays=1000` in a thousand-dimensional space. If we pick `r=500` in that case, we're much better off generating 500 random rays at the start.

In any case, this shouldn't cause problems for the test suite any longer.

I didn't notice the rest of your comment changes before working on this, but it looks like they all followed from the `r` -> `min_rays` change, which is now only conditional, so please let me know if there's any other comment fix I should pull.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f9be50a05a2ed71fff5634fd207b326a59887c4">6f9be50</a></td><td><code>Trac #24517: improve random_cone() performance when max_rays is None.</code></td></tr></table>




---

archive/issue_comments_373733.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7954f91d3266fbaf8476fa699d6027604148afe\">a7954f9</a></td><td><code>Trac #24517: drop an erroneous claim from a random_cone() comment.</code></td></tr></table>\n",
    "created_at": "2018-01-18T18:30:02Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373733",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7954f91d3266fbaf8476fa699d6027604148afe">a7954f9</a></td><td><code>Trac #24517: drop an erroneous claim from a random_cone() comment.</code></td></tr></table>




---

archive/issue_comments_373734.json:
```json
{
    "body": "**Changing commit** from \"[6f9be50a05a2ed71fff5634fd207b326a59887c4](https://github.com/sagemath/sagetrac-mirror/commit/6f9be50a05a2ed71fff5634fd207b326a59887c4)\" to \"[a7954f91d3266fbaf8476fa699d6027604148afe](https://github.com/sagemath/sagetrac-mirror/commit/a7954f91d3266fbaf8476fa699d6027604148afe)\".",
    "created_at": "2018-01-18T18:30:02Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6f9be50a05a2ed71fff5634fd207b326a59887c4](https://github.com/sagemath/sagetrac-mirror/commit/6f9be50a05a2ed71fff5634fd207b326a59887c4)" to "[a7954f91d3266fbaf8476fa699d6027604148afe](https://github.com/sagemath/sagetrac-mirror/commit/a7954f91d3266fbaf8476fa699d6027604148afe)".



---

archive/issue_comments_373735.json:
```json
{
    "body": "<a id='comment:19'></a>\nI can squash that later, I wasn't thinking straight when I wrote the comment.",
    "created_at": "2018-01-18T18:31:33Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373735",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:19'></a>
I can squash that later, I wasn't thinking straight when I wrote the comment.



---

archive/issue_comments_373736.json:
```json
{
    "body": "**Changing commit** from \"[a7954f91d3266fbaf8476fa699d6027604148afe](https://github.com/sagemath/sagetrac-mirror/commit/a7954f91d3266fbaf8476fa699d6027604148afe)\" to \"[1991f6fb4f69f449780769189492702b3d8db945](https://github.com/sagemath/sagetrac-mirror/commit/1991f6fb4f69f449780769189492702b3d8db945)\".",
    "created_at": "2018-01-18T20:50:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373736",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a7954f91d3266fbaf8476fa699d6027604148afe](https://github.com/sagemath/sagetrac-mirror/commit/a7954f91d3266fbaf8476fa699d6027604148afe)" to "[1991f6fb4f69f449780769189492702b3d8db945](https://github.com/sagemath/sagetrac-mirror/commit/1991f6fb4f69f449780769189492702b3d8db945)".



---

archive/issue_comments_373737.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1991f6fb4f69f449780769189492702b3d8db945\">1991f6f</a></td><td><code>Trac #24517: simplify the random_cone() performance fix in 6f9be50.</code></td></tr></table>\n",
    "created_at": "2018-01-18T20:50:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1991f6fb4f69f449780769189492702b3d8db945">1991f6f</a></td><td><code>Trac #24517: simplify the random_cone() performance fix in 6f9be50.</code></td></tr></table>




---

archive/issue_comments_373738.json:
```json
{
    "body": "<a id='comment:21'></a>\n> There's a trade-off here; namely that the user can still cause himself pain and suffering by specifying e.g. max_rays=1000000 in a three-dimensional space (basically, the problem in this ticket). On the other hand, we would like to avoid generating rays and checking the cone's validity one ray at a time if min_rays=1 and max_rays=1000 in a thousand-dimensional space. If we pick r=500 in that case, we're much better off generating 500 random rays at the start. \n\n\\\\\nI think I was able to address both of these in the latest commit. Naturally, there's some other side-effect -- more predictability when you ask for more than `2*dim` rays -- but that's an edge case and I think it's better to have the implementation less crashy.",
    "created_at": "2018-01-18T20:53:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373738",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:21'></a>
> There's a trade-off here; namely that the user can still cause himself pain and suffering by specifying e.g. max_rays=1000000 in a three-dimensional space (basically, the problem in this ticket). On the other hand, we would like to avoid generating rays and checking the cone's validity one ray at a time if min_rays=1 and max_rays=1000 in a thousand-dimensional space. If we pick r=500 in that case, we're much better off generating 500 random rays at the start. 

\\
I think I was able to address both of these in the latest commit. Naturally, there's some other side-effect -- more predictability when you ask for more than `2*dim` rays -- but that's an edge case and I think it's better to have the implementation less crashy.



---

archive/issue_events_217367.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-18T21:36:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217367"
}
```



---

archive/issue_events_217368.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-18T21:36:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217368"
}
```



---

archive/issue_comments_373739.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [mjo](#comment%3A17):\n> I think we should keep your original fix, too, and specify `max_rays=9` in the test.\n\n\nWhy? You convinced me that it was not the right fix and I agreed with you :-)\n\nNote that without `max_rays=9` the number of rays won't get very large anyway since the `while` loop which adds rays will early abort once we reach the full space. In a 3-dimensional space it would be quite unlikely already to have even 10 rays not spanning the whole space. So I do think that my original fix was sufficient. And also a better test because there is no need to artificially limit the number of rays.",
    "created_at": "2018-01-18T21:36:26Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373739",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [mjo](#comment%3A17):
> I think we should keep your original fix, too, and specify `max_rays=9` in the test.


Why? You convinced me that it was not the right fix and I agreed with you :-)

Note that without `max_rays=9` the number of rays won't get very large anyway since the `while` loop which adds rays will early abort once we reach the full space. In a 3-dimensional space it would be quite unlikely already to have even 10 rays not spanning the whole space. So I do think that my original fix was sufficient. And also a better test because there is no need to artificially limit the number of rays.



---

archive/issue_comments_373740.json:
```json
{
    "body": "<a id='comment:23'></a>\nAlso: use normal plain text syntax, not Sphinx syntax like <code>:trac:\\`24517\\`</code> in comments.",
    "created_at": "2018-01-18T21:38:46Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373740",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
Also: use normal plain text syntax, not Sphinx syntax like <code>:trac:\`24517\`</code> in comments.



---

archive/issue_comments_373741.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jdemeyer](#comment%3A22):\n> Replying to [mjo](#comment%3A17):\n> > I think we should keep your original fix, too, and specify `max_rays=9` in the test.\n\n> \n> Why? You convinced me that it was not the right fix and I agreed with you :-)\n> \n> Note that without `max_rays=9` the number of rays won't get very large anyway since the `while` loop which adds rays will early abort once we reach the full space. In a 3-dimensional space it would be quite unlikely already to have even 10 rays not spanning the whole space. So I do think that my original fix was sufficient. And also a better test because there is no need to artificially limit the number of rays.\n\n\nIt's just faster for the poor folks who run ptestlong. I saw about a 5 second average improvement with `max_rays=9`, mentioned at the bottom of the commit message.\n\nThe problem with leaving it unbounded is that you wind up looping...\n\n1. A random, large upper bound is chosen.\n2. We choose `r` between 7 and that large number; also generally large.\n3. We try to attain `r` rays, by adding one at a time...\n4. We wind up with the full space, and GOTO 1.\n\nWith `max_rays=9`, the picture is only a little different:\n\n1. We choose `r` between 7 and 9 (much more reasonable!)\n2. We try to attain `r` rays, by adding one at a time...\n3. We usually wind up with the full space and GOTO 1, but, more often than before we can achieve 7, 8, or 9 rays.\n\nIn the second scenario, you don't have to get lucky and choose a small random number.",
    "created_at": "2018-01-18T22:12:58Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373741",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:24'></a>
Replying to [jdemeyer](#comment%3A22):
> Replying to [mjo](#comment%3A17):
> > I think we should keep your original fix, too, and specify `max_rays=9` in the test.

> 
> Why? You convinced me that it was not the right fix and I agreed with you :-)
> 
> Note that without `max_rays=9` the number of rays won't get very large anyway since the `while` loop which adds rays will early abort once we reach the full space. In a 3-dimensional space it would be quite unlikely already to have even 10 rays not spanning the whole space. So I do think that my original fix was sufficient. And also a better test because there is no need to artificially limit the number of rays.


It's just faster for the poor folks who run ptestlong. I saw about a 5 second average improvement with `max_rays=9`, mentioned at the bottom of the commit message.

The problem with leaving it unbounded is that you wind up looping...

1. A random, large upper bound is chosen.
2. We choose `r` between 7 and that large number; also generally large.
3. We try to attain `r` rays, by adding one at a time...
4. We wind up with the full space, and GOTO 1.

With `max_rays=9`, the picture is only a little different:

1. We choose `r` between 7 and 9 (much more reasonable!)
2. We try to attain `r` rays, by adding one at a time...
3. We usually wind up with the full space and GOTO 1, but, more often than before we can achieve 7, 8, or 9 rays.

In the second scenario, you don't have to get lucky and choose a small random number.



---

archive/issue_comments_373742.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5740814745244aa50e3844cb89f1063529934202\">5740814</a></td><td><code>Trac #24517: improve random_cone() performance when max_rays is None.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f5ceefdfa53e9a2f030479384e844f7d7dc2a8c\">7f5ceef</a></td><td><code>Trac #24517: simplify the random_cone() performance fix in 5ff0391.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bbe362b425368340e59271c6cf48a6c0240e1c8\">7bbe362</a></td><td><code>Trac #24517: remove RST markup from non-docstring random_cone() comments.</code></td></tr></table>\n",
    "created_at": "2018-01-22T20:47:05Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373742",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5740814745244aa50e3844cb89f1063529934202">5740814</a></td><td><code>Trac #24517: improve random_cone() performance when max_rays is None.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f5ceefdfa53e9a2f030479384e844f7d7dc2a8c">7f5ceef</a></td><td><code>Trac #24517: simplify the random_cone() performance fix in 5ff0391.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bbe362b425368340e59271c6cf48a6c0240e1c8">7bbe362</a></td><td><code>Trac #24517: remove RST markup from non-docstring random_cone() comments.</code></td></tr></table>




---

archive/issue_comments_373743.json:
```json
{
    "body": "**Changing commit** from \"[1991f6fb4f69f449780769189492702b3d8db945](https://github.com/sagemath/sagetrac-mirror/commit/1991f6fb4f69f449780769189492702b3d8db945)\" to \"[7bbe362b425368340e59271c6cf48a6c0240e1c8](https://github.com/sagemath/sagetrac-mirror/commit/7bbe362b425368340e59271c6cf48a6c0240e1c8)\".",
    "created_at": "2018-01-22T20:47:05Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373743",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1991f6fb4f69f449780769189492702b3d8db945](https://github.com/sagemath/sagetrac-mirror/commit/1991f6fb4f69f449780769189492702b3d8db945)" to "[7bbe362b425368340e59271c6cf48a6c0240e1c8](https://github.com/sagemath/sagetrac-mirror/commit/7bbe362b425368340e59271c6cf48a6c0240e1c8)".



---

archive/issue_comments_373744.json:
```json
{
    "body": "**Changing commit** from \"[7bbe362b425368340e59271c6cf48a6c0240e1c8](https://github.com/sagemath/sagetrac-mirror/commit/7bbe362b425368340e59271c6cf48a6c0240e1c8)\" to \"[2683d071d904469a01ce3949dacff8768f8df711](https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711)\".",
    "created_at": "2018-01-22T20:50:12Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373744",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7bbe362b425368340e59271c6cf48a6c0240e1c8](https://github.com/sagemath/sagetrac-mirror/commit/7bbe362b425368340e59271c6cf48a6c0240e1c8)" to "[2683d071d904469a01ce3949dacff8768f8df711](https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711)".



---

archive/issue_comments_373745.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca2b0f925e62e03d011b55a5003ae2ae2cc3e342\">ca2b0f9</a></td><td><code>Trac #24517: simplify the recent random_cone() performance fix.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711\">2683d07</a></td><td><code>Trac #24517: remove RST markup from non-docstring random_cone() comments.</code></td></tr></table>\n",
    "created_at": "2018-01-22T20:50:12Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373745",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca2b0f925e62e03d011b55a5003ae2ae2cc3e342">ca2b0f9</a></td><td><code>Trac #24517: simplify the recent random_cone() performance fix.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711">2683d07</a></td><td><code>Trac #24517: remove RST markup from non-docstring random_cone() comments.</code></td></tr></table>




---

archive/issue_comments_373746.json:
```json
{
    "body": "<a id='comment:27'></a>\nTrying to mention a commit hash during `rebase -i` is not working out for me...\n\nI'll put the original test case back if you like, but I think it's making an already-long test even longer for not much benefit.",
    "created_at": "2018-01-22T20:51:37Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373746",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:27'></a>
Trying to mention a commit hash during `rebase -i` is not working out for me...

I'll put the original test case back if you like, but I think it's making an already-long test even longer for not much benefit.



---

archive/issue_events_217369.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2018-01-22T20:52:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217369"
}
```



---

archive/issue_events_217370.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2018-01-22T20:52:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217370"
}
```



---

archive/issue_comments_373747.json:
```json
{
    "body": "<a id='comment:29'></a>\nlooks good to me. Jeroen, do you agree ?",
    "created_at": "2018-01-27T12:33:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373747",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:29'></a>
looks good to me. Jeroen, do you agree ?



---

archive/issue_events_217371.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-29T16:31:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217371"
}
```



---

archive/issue_events_217372.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-29T16:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217372"
}
```



---

archive/issue_comments_373748.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2018-01-29T16:31:11Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373748",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_373749.json:
```json
{
    "body": "<a id='comment:30'></a>\nI am setting this to positive. If there are any objections, please shout out loud.",
    "created_at": "2018-01-29T16:31:11Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373749",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'></a>
I am setting this to positive. If there are any objections, please shout out loud.



---

archive/issue_comments_373750.json:
```json
{
    "body": "<a id='comment:31'></a>\nNo objections here...",
    "created_at": "2018-01-29T16:40:09Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373750",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>
No objections here...



---

archive/issue_comments_373751.json:
```json
{
    "body": "**Changing branch** from \"[u/mjo/ticket/24517](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/24517)\" to \"[2683d071d904469a01ce3949dacff8768f8df711](https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711)\".",
    "created_at": "2018-02-01T19:13:37Z",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24517#issuecomment-373751",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mjo/ticket/24517](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/24517)" to "[2683d071d904469a01ce3949dacff8768f8df711](https://github.com/sagemath/sagetrac-mirror/commit/2683d071d904469a01ce3949dacff8768f8df711)".



---

archive/issue_events_217373.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-01T19:13:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217373"
}
```



---

archive/issue_events_217374.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-01T19:13:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24517",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24517#event-217374"
}
```
