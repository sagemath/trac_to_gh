# Issue 24091: Bug in order of points on elliptic curves

archive/issues_023854.json:
```json
{
    "body": "In this example we construct a point of order 2 which thinks its order is infinity:\n\n```\nsage: E = EllipticCurve([0,0,0,0,-2])\nsage: E.torsion_order()\n1\nsage: K.<a> = NumberField(x^3-2)\nsage: P = E.lift_x(a)\nsage: P.order()\n+Infinity\nsage: 2*P\n(0 : 1 : 0)\n```\nIt's fine if we construct the point differently:\n\n```\nsage: EK = E.change_ring(K)\nsage: P = EK([a,0])\nsage: P.order()\n2\n```\nand arises since in the first construction P.curve() is the curve over QQ, not the extension.  Hence the error is in the lift_x() function.  Which means that it is probably my fault since I think I wrote that.\n\nBranch/Commit: d27370265f82a525966ef95b0d71d696b7eb88dc\n\nReviewer: David Roe\n\nAuthor: John Cremona\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24091\n\n",
    "closed_at": "2018-01-14T10:14:41Z",
    "created_at": "2017-10-23T16:11:11Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Bug in order of points on elliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24091",
    "user": "https://github.com/JohnCremona"
}
```
In this example we construct a point of order 2 which thinks its order is infinity:

```
sage: E = EllipticCurve([0,0,0,0,-2])
sage: E.torsion_order()
1
sage: K.<a> = NumberField(x^3-2)
sage: P = E.lift_x(a)
sage: P.order()
+Infinity
sage: 2*P
(0 : 1 : 0)
```
It's fine if we construct the point differently:

```
sage: EK = E.change_ring(K)
sage: P = EK([a,0])
sage: P.order()
2
```
and arises since in the first construction P.curve() is the curve over QQ, not the extension.  Hence the error is in the lift_x() function.  Which means that it is probably my fault since I think I wrote that.

Branch/Commit: d27370265f82a525966ef95b0d71d696b7eb88dc

Reviewer: David Roe

Author: John Cremona

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24091





---

archive/issue_comments_457849.json:
```json
{
    "body": "<a id='comment:1'></a>\nWhat happens is that the code correctly computes the y-coordinate (in the example it is 0 ) and then constructs the points using self.point(coords, check=False).  Switching off the check is to save time testing that the corordinates satisfy the equation of the curve.  But we should check that the x-coordinate given lies in the base field of the curve.\n\nIn the example it would be better if an error was raised; to construct this point the user should first construct the base-change of E from QQ to K and then construct the point on that.",
    "created_at": "2017-10-24T12:32:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457849",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:1'></a>
What happens is that the code correctly computes the y-coordinate (in the example it is 0 ) and then constructs the points using self.point(coords, check=False).  Switching off the check is to save time testing that the corordinates satisfy the equation of the curve.  But we should check that the x-coordinate given lies in the base field of the curve.

In the example it would be better if an error was raised; to construct this point the user should first construct the base-change of E from QQ to K and then construct the point on that.



---

archive/issue_comments_457850.json:
```json
{
    "body": "<a id='comment:3'></a>\nI can easily fix this by adding lines of the form\n\n```\n       K = self.base_ring()\n        try:\n            x = K(x)\n        except TypeError:\n            raise TypeError('x must be coercible into the base ring of the curve')\n```\nbut then 2 tests fail since the tests include a couple where the x supplied is in an extension of the base field.  However these examples, such as \n\n```\nsage: E = EllipticCurve('37a');\nsage: P = E.lift_x(pAdicField(17, 5)(6))\n```\nare bad since the resulting point has the wrong parent:\n\n```\nsage: P.parent()\nAbelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field\n```\n\nA good way to fix this would be to allow the user to give an x which lies in some extension, tested by checking (if the x=K(x) fails) that E1 = E.change_ring(x.parent()) works and if so running lift_x() there, giving the same point as before but with the correct parent.  Note that the problem arises in the first place since the point returned is constructed with check=False.\n\nIf this is deemed to be useful (as I think it is), should we make it automatic, or require an additional parameter extend=False and only do the base-change when it is set to True?  This could be misleading since we must distinguish between cases where a base-change is needed to include x, and one where the y-coordinate is in a further extension.  So it's really a 3-way division: extend=False could result in failure unless both the given x and the computed y are in the original base_ring K;  extend='x' allows any x with parent L such that self.change_ring(L) is possible and returns a point over L provided that the y coordinate is also in L; and extend='xy' would be like extend='x' except that a further base-change would be made to include the y-coordinates.  Actually there's a 4th case extend='y' where we require x in the base ring but will make a quadratic extension if necessary to include the y-coordinates.\n\nI am beginning to think that we should leave the lift_x() as it is (with the stricter test that x=K(x) works, and removing the two subsequently failing tests) and add a new method with these 4 options.\n\nComments?",
    "created_at": "2017-11-10T15:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457850",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>
I can easily fix this by adding lines of the form

```
       K = self.base_ring()
        try:
            x = K(x)
        except TypeError:
            raise TypeError('x must be coercible into the base ring of the curve')
```
but then 2 tests fail since the tests include a couple where the x supplied is in an extension of the base field.  However these examples, such as 

```
sage: E = EllipticCurve('37a');
sage: P = E.lift_x(pAdicField(17, 5)(6))
```
are bad since the resulting point has the wrong parent:

```
sage: P.parent()
Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field
```

A good way to fix this would be to allow the user to give an x which lies in some extension, tested by checking (if the x=K(x) fails) that E1 = E.change_ring(x.parent()) works and if so running lift_x() there, giving the same point as before but with the correct parent.  Note that the problem arises in the first place since the point returned is constructed with check=False.

If this is deemed to be useful (as I think it is), should we make it automatic, or require an additional parameter extend=False and only do the base-change when it is set to True?  This could be misleading since we must distinguish between cases where a base-change is needed to include x, and one where the y-coordinate is in a further extension.  So it's really a 3-way division: extend=False could result in failure unless both the given x and the computed y are in the original base_ring K;  extend='x' allows any x with parent L such that self.change_ring(L) is possible and returns a point over L provided that the y coordinate is also in L; and extend='xy' would be like extend='x' except that a further base-change would be made to include the y-coordinates.  Actually there's a 4th case extend='y' where we require x in the base ring but will make a quadratic extension if necessary to include the y-coordinates.

I am beginning to think that we should leave the lift_x() as it is (with the stricter test that x=K(x) works, and removing the two subsequently failing tests) and add a new method with these 4 options.

Comments?



---

archive/issue_comments_457851.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-11-11T18:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457851",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_457852.json:
```json
{
    "body": "Changing branch from \"\" to \"u/cremona/24091\"",
    "created_at": "2017-11-11T18:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457852",
    "user": "https://github.com/JohnCremona"
}
```

Changing branch from "" to "u/cremona/24091"



---

archive/issue_comments_457853.json:
```json
{
    "body": "Changing commit from \"\" to \"a0cd1923164b95e52fa898c52d520b7ad8c9091e\"",
    "created_at": "2017-11-11T18:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457853",
    "user": "https://github.com/JohnCremona"
}
```

Changing commit from "" to "a0cd1923164b95e52fa898c52d520b7ad8c9091e"



---

archive/issue_comments_457854.json:
```json
{
    "body": "<a id='comment:4'></a>\nFixed the bug and added all the optional extension possibilities described above, with more examples.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|\n|[a0cd192](https://github.com/sagemath/sagetrac-mirror/commit/a0cd1923164b95e52fa898c52d520b7ad8c9091e)|`#24091 fix the bug and add several base-extension options to the elliptic curve lift_x() method`|",
    "created_at": "2017-11-11T18:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457854",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'></a>
Fixed the bug and added all the optional extension possibilities described above, with more examples.

---
New commits:
|                                                                                                                                          |                                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
|[a0cd192](https://github.com/sagemath/sagetrac-mirror/commit/a0cd1923164b95e52fa898c52d520b7ad8c9091e)|`#24091 fix the bug and add several base-extension options to the elliptic curve lift_x() method`|



---

archive/issue_comments_457855.json:
```json
{
    "body": "Changing author from \"\" to \"John Cremona\"",
    "created_at": "2017-11-11T18:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457855",
    "user": "https://github.com/JohnCremona"
}
```

Changing author from "" to "John Cremona"



---

archive/issue_comments_457856.json:
```json
{
    "body": "<a id='comment:5'></a>\nA couple comments:\n\n* I think the right condition to check is what you have in the code: that there is a coercion from `K` to `L`.  But it's not what you describe in the documentation: that `x` is converted into the base ring.  The difference occurs for p-adics for example:\n\n```\nsage: a = Qp(5)(82748127); a\n2 + 2*5^4 + 4*5^5 + 4*5^7 + 5^8 + 2*5^9 + 3*5^10 + 5^11 + O(5^20)\nsage: QQ(a)\n-639974/5762513\n```\n\n* When there is an extension, the right ring should probably be the pushout of the parent of `x` and the base ring of the curve.\n\nOtherwise, I'm pretty happy with these changes.",
    "created_at": "2017-11-11T20:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457856",
    "user": "https://github.com/roed314"
}
```

<a id='comment:5'></a>
A couple comments:

* I think the right condition to check is what you have in the code: that there is a coercion from `K` to `L`.  But it's not what you describe in the documentation: that `x` is converted into the base ring.  The difference occurs for p-adics for example:

```
sage: a = Qp(5)(82748127); a
2 + 2*5^4 + 4*5^5 + 4*5^7 + 5^8 + 2*5^9 + 3*5^10 + 5^11 + O(5^20)
sage: QQ(a)
-639974/5762513
```

* When there is an extension, the right ring should probably be the pushout of the parent of `x` and the base ring of the curve.

Otherwise, I'm pretty happy with these changes.



---

archive/issue_comments_457857.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks for looking at this.  I can correct the docstring.\n\nI did think of pushouts but decided that was overkill, though at present this fails:\n\n```\nsage: E = EllipticCurve([0,0,0,0,2])\nsage: x = polygen(ZZ)\nsage: E.lift_x(x, extend='xy')\n...\nTypeError: Unable to base-change from Rational Field to Univariate Polynomial Ring in x over Integer Ring\n```\n\nAfter more thought I was also wondering whether it would not be simpler to to the x-extension always and let the extend parameter just be True or False and control whether or not to make the quadratic extension to include the y-coordinate where necessary.  That way you could give any reasonable x with no additional stuff and get a point defined over an extension (assuming that the y-coordinate exists in the pushout of the base ring and x's parent).\n\nI'll try out the pushout idea anyway, making sure that everything still works, only using the pushout construction when sef.base_ring() and x.parent() are different.",
    "created_at": "2017-11-12T12:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457857",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'></a>
Thanks for looking at this.  I can correct the docstring.

I did think of pushouts but decided that was overkill, though at present this fails:

```
sage: E = EllipticCurve([0,0,0,0,2])
sage: x = polygen(ZZ)
sage: E.lift_x(x, extend='xy')
...
TypeError: Unable to base-change from Rational Field to Univariate Polynomial Ring in x over Integer Ring
```

After more thought I was also wondering whether it would not be simpler to to the x-extension always and let the extend parameter just be True or False and control whether or not to make the quadratic extension to include the y-coordinate where necessary.  That way you could give any reasonable x with no additional stuff and get a point defined over an extension (assuming that the y-coordinate exists in the pushout of the base ring and x's parent).

I'll try out the pushout idea anyway, making sure that everything still works, only using the pushout construction when sef.base_ring() and x.parent() are different.



---

archive/issue_comments_457858.json:
```json
{
    "body": "<a id='comment:7'></a>\nUsing pushout is not so great.  If you take the pushout of two real quadratic number fields it returns Algebraic Real Field but with no coercion from the two fields into it.  Firstly I was expecting the pushout to be another number field, and secondly I thought th whole point of pushouts was that there would be maps from the constituents into it?",
    "created_at": "2017-11-12T12:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457858",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>
Using pushout is not so great.  If you take the pushout of two real quadratic number fields it returns Algebraic Real Field but with no coercion from the two fields into it.  Firstly I was expecting the pushout to be another number field, and secondly I thought th whole point of pushouts was that there would be maps from the constituents into it?



---

archive/issue_comments_457859.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-11-12T15:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457859",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_457860.json:
```json
{
    "body": "<a id='comment:8'></a>\nI had only tested the one file but clearly need to do more.",
    "created_at": "2017-11-12T15:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457860",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>
I had only tested the one file but clearly need to do more.



---

archive/issue_comments_457861.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [cremona](#comment%3A7):\n> Using pushout is not so great.  If you take the pushout of two real quadratic number fields it returns Algebraic Real Field but with no coercion from the two fields into it.  Firstly I was expecting the pushout to be another number field, and secondly I thought th whole point of pushouts was that there would be maps from the constituents into it?\n\n\nYeah, that sounds like a problem with pushout.  I don't think it's unreasonable for the pushout to be Algebraic Real Field, since in general there's not a canonical choice for the number field and we don't have general tensor products of number fields.  There should be coercions, but I can also see why it would be hard in this case.  Each number field can only have one embedding, and adding coercion maps to Algebraic Real Field will be tricky.  Maybe real quadratic fields could be special cased, since there's not really a problem choosing a number field as a pushout....\n\nAnyway, feel free to drop the pushout idea if you like.",
    "created_at": "2017-11-12T17:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457861",
    "user": "https://github.com/roed314"
}
```

<a id='comment:9'></a>
Replying to [cremona](#comment%3A7):
> Using pushout is not so great.  If you take the pushout of two real quadratic number fields it returns Algebraic Real Field but with no coercion from the two fields into it.  Firstly I was expecting the pushout to be another number field, and secondly I thought th whole point of pushouts was that there would be maps from the constituents into it?


Yeah, that sounds like a problem with pushout.  I don't think it's unreasonable for the pushout to be Algebraic Real Field, since in general there's not a canonical choice for the number field and we don't have general tensor products of number fields.  There should be coercions, but I can also see why it would be hard in this case.  Each number field can only have one embedding, and adding coercion maps to Algebraic Real Field will be tricky.  Maybe real quadratic fields could be special cased, since there's not really a problem choosing a number field as a pushout....

Anyway, feel free to drop the pushout idea if you like.



---

archive/issue_comments_457862.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [cremona](#comment%3A6):\n> After more thought I was also wondering whether it would not be simpler to to the x-extension always and let the extend parameter just be True or False and control whether or not to make the quadratic extension to include the y-coordinate where necessary.  That way you could give any reasonable x with no additional stuff and get a point defined over an extension (assuming that the y-coordinate exists in the pushout of the base ring and x's parent).\n\n\nYeah, I think this would be reasonable.  If someone provides an x-coordinate that's not in the field, there's some chance that they'll have an error somewhere else and will be glad to learn about it.  But I think it's more likely that they'd rather have it just work.",
    "created_at": "2017-11-12T17:12:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457862",
    "user": "https://github.com/roed314"
}
```

<a id='comment:10'></a>
Replying to [cremona](#comment%3A6):
> After more thought I was also wondering whether it would not be simpler to to the x-extension always and let the extend parameter just be True or False and control whether or not to make the quadratic extension to include the y-coordinate where necessary.  That way you could give any reasonable x with no additional stuff and get a point defined over an extension (assuming that the y-coordinate exists in the pushout of the base ring and x's parent).


Yeah, I think this would be reasonable.  If someone provides an x-coordinate that's not in the field, there's some chance that they'll have an error somewhere else and will be glad to learn about it.  But I think it's more likely that they'd rather have it just work.



---

archive/issue_comments_457863.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [roed](#comment%3A10):\n> Replying to [cremona](#comment%3A6):\n> > After more thought I was also wondering whether it would not be simpler to to the x-extension always and let the extend parameter just be True or False and control whether or not to make the quadratic extension to include the y-coordinate where necessary.  That way you could give any reasonable x with no additional stuff and get a point defined over an extension (assuming that the y-coordinate exists in the pushout of the base ring and x's parent).\n\n> \n> Yeah, I think this would be reasonable.  If someone provides an x-coordinate that's not in the field, there's some chance that they'll have an error somewhere else and will be glad to learn about it.  But I think it's more likely that they'd rather have it just work.\n\n\nThere are two different use cases really.   Interactively we would like things to be simple with helpful defaults, but this method is used in several places in the library where silently changing the point's parent from the original curve is possibly dangerous.\n\nWhat Magma does is to make the point's parent something like E(L) where L is an extension of the base rather than E itself.  For Sage to switch to that philosophy would be a lot of work.",
    "created_at": "2017-11-12T17:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457863",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:11'></a>
Replying to [roed](#comment%3A10):
> Replying to [cremona](#comment%3A6):
> > After more thought I was also wondering whether it would not be simpler to to the x-extension always and let the extend parameter just be True or False and control whether or not to make the quadratic extension to include the y-coordinate where necessary.  That way you could give any reasonable x with no additional stuff and get a point defined over an extension (assuming that the y-coordinate exists in the pushout of the base ring and x's parent).

> 
> Yeah, I think this would be reasonable.  If someone provides an x-coordinate that's not in the field, there's some chance that they'll have an error somewhere else and will be glad to learn about it.  But I think it's more likely that they'd rather have it just work.


There are two different use cases really.   Interactively we would like things to be simple with helpful defaults, but this method is used in several places in the library where silently changing the point's parent from the original curve is possibly dangerous.

What Magma does is to make the point's parent something like E(L) where L is an extension of the base rather than E itself.  For Sage to switch to that philosophy would be a lot of work.



---

archive/issue_comments_457864.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[119f3c1](https://github.com/sagemath/sagetrac-mirror/commit/119f3c13fd70425411a490c3e3151a6552708302)|`#24091: add pushout to methods attempted when extending x`|\n|[bcd750e](https://github.com/sagemath/sagetrac-mirror/commit/bcd750e3b3aaaabe3b0a9a9dfd7c242ff42fa74e)|`#24091: simplify extend options to True/False for y (always extend to include x), remove pushout code`|",
    "created_at": "2017-11-13T10:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457864",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[119f3c1](https://github.com/sagemath/sagetrac-mirror/commit/119f3c13fd70425411a490c3e3151a6552708302)|`#24091: add pushout to methods attempted when extending x`|
|[bcd750e](https://github.com/sagemath/sagetrac-mirror/commit/bcd750e3b3aaaabe3b0a9a9dfd7c242ff42fa74e)|`#24091: simplify extend options to True/False for y (always extend to include x), remove pushout code`|



---

archive/issue_comments_457865.json:
```json
{
    "body": "Changing commit from \"a0cd1923164b95e52fa898c52d520b7ad8c9091e\" to \"bcd750e3b3aaaabe3b0a9a9dfd7c242ff42fa74e\"",
    "created_at": "2017-11-13T10:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a0cd1923164b95e52fa898c52d520b7ad8c9091e" to "bcd750e3b3aaaabe3b0a9a9dfd7c242ff42fa74e"



---

archive/issue_comments_457866.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe latest version removes pushout stuff (in the previous commit) and simplifies the extend parameter to True/False, indicating whether or not to make a quadratic extension to include the y-coordinates.  Unlike the first commit here, the base will always be extended to include x if there is a coercion from x.parent() into self.base_ring() (unless there is a coercion from x.parent()  into the original base ring), with no option needing to be set.  This is closer to the old behaviour, but certainly better since the returned point will always be a curve over a base containing the point's coordinates, which was not true before (and was the cause of the bug).\n\nBefore setting this to needs review again I'll do more testing since there are minor issues in other places, hopefully noting worse than points being listed in a different order compared with the old code.",
    "created_at": "2017-11-13T10:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457866",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:13'></a>
The latest version removes pushout stuff (in the previous commit) and simplifies the extend parameter to True/False, indicating whether or not to make a quadratic extension to include the y-coordinates.  Unlike the first commit here, the base will always be extended to include x if there is a coercion from x.parent() into self.base_ring() (unless there is a coercion from x.parent()  into the original base ring), with no option needing to be set.  This is closer to the old behaviour, but certainly better since the returned point will always be a curve over a base containing the point's coordinates, which was not true before (and was the cause of the bug).

Before setting this to needs review again I'll do more testing since there are minor issues in other places, hopefully noting worse than points being listed in a different order compared with the old code.



---

archive/issue_comments_457867.json:
```json
{
    "body": "Changing commit from \"bcd750e3b3aaaabe3b0a9a9dfd7c242ff42fa74e\" to \"cb34112e61f481a7e3bc4dc0a8204113524a5250\"",
    "created_at": "2017-11-13T11:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457867",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "bcd750e3b3aaaabe3b0a9a9dfd7c242ff42fa74e" to "cb34112e61f481a7e3bc4dc0a8204113524a5250"



---

archive/issue_comments_457868.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|\n|[cb34112](https://github.com/sagemath/sagetrac-mirror/commit/cb34112e61f481a7e3bc4dc0a8204113524a5250)|`#24091 fix formatting bug and a couple of tests where output now trivially different`|",
    "created_at": "2017-11-13T11:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457868",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|
|[cb34112](https://github.com/sagemath/sagetrac-mirror/commit/cb34112e61f481a7e3bc4dc0a8204113524a5250)|`#24091 fix formatting bug and a couple of tests where output now trivially different`|



---

archive/issue_comments_457869.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-11-13T11:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457869",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_457870.json:
```json
{
    "body": "<a id='comment:16'></a>\nI am working on the 3 broken doctests.",
    "created_at": "2018-01-10T11:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457870",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:16'></a>
I am working on the 3 broken doctests.



---

archive/issue_comments_457871.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-10T11:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457871",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_457872.json:
```json
{
    "body": "Changing commit from \"cb34112e61f481a7e3bc4dc0a8204113524a5250\" to \"d27370265f82a525966ef95b0d71d696b7eb88dc\"",
    "created_at": "2018-01-10T13:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cb34112e61f481a7e3bc4dc0a8204113524a5250" to "d27370265f82a525966ef95b0d71d696b7eb88dc"



---

archive/issue_comments_457873.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[9542496](https://github.com/sagemath/sagetrac-mirror/commit/9542496187d7d8687311c2f9be1475e4ca2d369b)|`Merge branch 'develop' into 24091`|\n|[d273702](https://github.com/sagemath/sagetrac-mirror/commit/d27370265f82a525966ef95b0d71d696b7eb88dc)|`#24091: fixed two doctests`|",
    "created_at": "2018-01-10T13:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[9542496](https://github.com/sagemath/sagetrac-mirror/commit/9542496187d7d8687311c2f9be1475e4ca2d369b)|`Merge branch 'develop' into 24091`|
|[d273702](https://github.com/sagemath/sagetrac-mirror/commit/d27370265f82a525966ef95b0d71d696b7eb88dc)|`#24091: fixed two doctests`|



---

archive/issue_comments_457874.json:
```json
{
    "body": "<a id='comment:18'></a>\n2 of the broken doctests were due to E.lift_x(x0) returning the other point with the same x-coordinate, which have been fixed.\nThe 3rd failure reported by a patchbot were timeouts on lines 277 and 279 of src/sage/doctest/external.py which is a patchbot issue nothing to do with this ticket, so I'll put it back to \"needs review\".",
    "created_at": "2018-01-10T13:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457874",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:18'></a>
2 of the broken doctests were due to E.lift_x(x0) returning the other point with the same x-coordinate, which have been fixed.
The 3rd failure reported by a patchbot were timeouts on lines 277 and 279 of src/sage/doctest/external.py which is a patchbot issue nothing to do with this ticket, so I'll put it back to "needs review".



---

archive/issue_comments_457875.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-10T13:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457875",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_457876.json:
```json
{
    "body": "<a id='comment:19'></a>\nOK, patchbot is happy so all I need is a positive review!",
    "created_at": "2018-01-10T15:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457876",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:19'></a>
OK, patchbot is happy so all I need is a positive review!



---

archive/issue_comments_457877.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe\"",
    "created_at": "2018-01-10T18:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457877",
    "user": "https://github.com/roed314"
}
```

Changing reviewer from "" to "David Roe"



---

archive/issue_comments_457878.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-10T18:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457878",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_457879.json:
```json
{
    "body": "<a id='comment:20'></a>\nLooks good to me!",
    "created_at": "2018-01-10T18:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457879",
    "user": "https://github.com/roed314"
}
```

<a id='comment:20'></a>
Looks good to me!



---

archive/issue_comments_457880.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-01-14T10:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457880",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_457881.json:
```json
{
    "body": "Changing branch from \"u/cremona/24091\" to \"d27370265f82a525966ef95b0d71d696b7eb88dc\"",
    "created_at": "2018-01-14T10:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24091#issuecomment-457881",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/cremona/24091" to "d27370265f82a525966ef95b0d71d696b7eb88dc"



---

archive/issue_events_069575.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:14:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24091",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24091#event-69575"
}
```
