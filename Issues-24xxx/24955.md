# Issue 24955: py3: miscellaneous fixes related to __func__

archive/issues_024718.json:
```json
{
    "body": "I don't think any of these fixes are in any other ticket yet but I need to double-check.\n\nThis fixes issues related to the fact that on Python 2 looking up a method on a class returns an \"unbound method\" object, whereas on Python 3 it just returns the bare function object.\n\nBranch/Commit: 7b1d48005dbfd554ebff02af67963be2ed8791b4\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24955\n\n",
    "closed_at": "2018-09-22T10:22:43Z",
    "created_at": "2018-03-12T11:05:06Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "py3: miscellaneous fixes related to __func__",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24955",
    "user": "https://github.com/embray"
}
```
I don't think any of these fixes are in any other ticket yet but I need to double-check.

This fixes issues related to the fact that on Python 2 looking up a method on a class returns an "unbound method" object, whereas on Python 3 it just returns the bare function object.

Branch/Commit: 7b1d48005dbfd554ebff02af67963be2ed8791b4

Reviewer: Frédéric Chapoton

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24955





---

archive/issue_comments_369376.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-12T11:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369376",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_369377.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-12T19:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369377",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369378.json:
```json
{
    "body": "<a id='comment:2'></a>This has been fixed in #24728:\n\n```\n            # TODO: There is a bug in how the cyfunction type's __get__\n            # works on Python 3--it should not return an instancemethod\n            # on the class\n```",
    "created_at": "2018-03-12T19:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369378",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>This has been fixed in #24728:

```
            # TODO: There is a bug in how the cyfunction type's __get__
            # works on Python 3--it should not return an instancemethod
            # on the class
```



---

archive/issue_comments_369379.json:
```json
{
    "body": "<a id='comment:3'></a>Oh, great.  I take it that fix will be included in Cython 0.28 as well?  In that case I'll just remove that note, and I think maybe the test right before it requires updating as well.",
    "created_at": "2018-03-13T14:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369379",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>Oh, great.  I take it that fix will be included in Cython 0.28 as well?  In that case I'll just remove that note, and I think maybe the test right before it requires updating as well.



---

archive/issue_comments_369380.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 embray]:\n> Oh, great.  I take it that fix will be included in Cython 0.28 as well?\n\n\nYes.",
    "created_at": "2018-03-13T14:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369380",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Replying to [comment:3 embray]:
> Oh, great.  I take it that fix will be included in Cython 0.28 as well?


Yes.



---

archive/issue_comments_369381.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-26T10:55:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_369382.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-26T10:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369382",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369383.json:
```json
{
    "body": "<a id='comment:7'></a>Failures according to the patchbot:\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/algebras/nil_coxeter_algebra.py  # 2 doctests failed\nsage -t --long src/sage/interacts/test_jupyter.rst  # 1 doctest failed\nsage -t --long src/sage/combinat/k_tableau.py  # 2 doctests failed\nsage -t --long src/sage/combinat/sf/sf.py  # 23 doctests failed\nsage -t --long src/sage/combinat/sf/llt.py  # 1 doctest failed\nsage -t --long src/sage/combinat/sf/k_dual.py  # 123 doctests failed\nsage -t --long src/sage/combinat/sf/new_kschur.py  # 121 doctests failed\nsage -t --long src/sage/monoids/automatic_semigroup.py  # 1 doctest failed\nsage -t --long src/sage/tests/book_schilling_zabrocki_kschur_primer.py  # 51 doctests failed\n----------------------------------------------------------------------\n```\nFrom looking at the patch, I expected these failures. Python sees it as a type-mismatch.",
    "created_at": "2018-03-27T00:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369383",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Failures according to the patchbot:

```
----------------------------------------------------------------------
sage -t --long src/sage/algebras/nil_coxeter_algebra.py  # 2 doctests failed
sage -t --long src/sage/interacts/test_jupyter.rst  # 1 doctest failed
sage -t --long src/sage/combinat/k_tableau.py  # 2 doctests failed
sage -t --long src/sage/combinat/sf/sf.py  # 23 doctests failed
sage -t --long src/sage/combinat/sf/llt.py  # 1 doctest failed
sage -t --long src/sage/combinat/sf/k_dual.py  # 123 doctests failed
sage -t --long src/sage/combinat/sf/new_kschur.py  # 121 doctests failed
sage -t --long src/sage/monoids/automatic_semigroup.py  # 1 doctest failed
sage -t --long src/sage/tests/book_schilling_zabrocki_kschur_primer.py  # 51 doctests failed
----------------------------------------------------------------------
```
From looking at the patch, I expected these failures. Python sees it as a type-mismatch.



---

archive/issue_comments_369384.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-27T00:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369384",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369385.json:
```json
{
    "body": "<a id='comment:8'></a>Personally, I think it would be better to rewrite that code to not rely on `__func__` in the first place.",
    "created_at": "2018-03-27T07:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369385",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Personally, I think it would be better to rewrite that code to not rely on `__func__` in the first place.



---

archive/issue_comments_369386.json:
```json
{
    "body": "<a id='comment:9'></a>Oh weird, this ticket is now missing other changes I made that are definitely necessary to work on both Python 2 and 3.  I don't know where they went because I remember making them just a couple weeks ago.  For cross-compatibility it works best to use `six.get_unbound_function`.\n\nI don't know how you would \"rewrite that code to not rely on `__func__` in the first place\".  I did think of refactoring this stuff out to a mix-in class; is that what you mean?",
    "created_at": "2018-03-27T08:59:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369386",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>Oh weird, this ticket is now missing other changes I made that are definitely necessary to work on both Python 2 and 3.  I don't know where they went because I remember making them just a couple weeks ago.  For cross-compatibility it works best to use `six.get_unbound_function`.

I don't know how you would "rewrite that code to not rely on `__func__` in the first place".  I did think of refactoring this stuff out to a mix-in class; is that what you mean?



---

archive/issue_comments_369387.json:
```json
{
    "body": "<a id='comment:10'></a>Weird; I definitely fixed this \"correctly\" a week or two ago, but now I can't find it any of my local or remote branches.",
    "created_at": "2018-03-27T09:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369387",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>Weird; I definitely fixed this "correctly" a week or two ago, but now I can't find it any of my local or remote branches.



---

archive/issue_comments_369388.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-03T08:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369388",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369389.json:
```json
{
    "body": "<a id='comment:12'></a>is this back to \"needs_review\" ?",
    "created_at": "2018-04-15T07:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369389",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>is this back to "needs_review" ?



---

archive/issue_comments_369390.json:
```json
{
    "body": "<a id='comment:13'></a>Sure, thought it seemed like maybe Jeroen had something else in mind, though it wasn't clear what.  But this does fix the problem.",
    "created_at": "2018-04-16T07:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369390",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>Sure, thought it seemed like maybe Jeroen had something else in mind, though it wasn't clear what.  But this does fix the problem.



---

archive/issue_comments_369391.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-16T07:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369391",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369392.json:
```json
{
    "body": "<a id='comment:14'></a>ok",
    "created_at": "2018-04-16T11:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369392",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>ok



---

archive/issue_comments_369393.json:
```json
{
    "body": "<a id='comment:15'></a>I am experimenting with a more proper solution for `ParentMethods` in #25179.",
    "created_at": "2018-04-16T11:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369393",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>I am experimenting with a more proper solution for `ParentMethods` in #25179.



---

archive/issue_comments_369394.json:
```json
{
    "body": "<a id='comment:16'></a>Do you object to a positive review here ?",
    "created_at": "2018-04-16T12:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369394",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>Do you object to a positive review here ?



---

archive/issue_comments_369395.json:
```json
{
    "body": "<a id='comment:17'></a>See also #25181.",
    "created_at": "2018-04-16T12:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369395",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>See also #25181.



---

archive/issue_comments_369396.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:16 chapoton]:\n> Do you object to a positive review here ?\n\n\nYes because #25179 and #25181 might be better. At least the solution here should be compared to the solution in those other tickets.",
    "created_at": "2018-04-16T12:56:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369396",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>Replying to [comment:16 chapoton]:
> Do you object to a positive review here ?


Yes because #25179 and #25181 might be better. At least the solution here should be compared to the solution in those other tickets.



---

archive/issue_events_062629.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-26T12:13:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24955#event-62629"
}
```



---

archive/issue_comments_369397.json:
```json
{
    "body": "<a id='comment:20'></a>The certainly conflicts with #25179.",
    "created_at": "2018-05-17T10:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369397",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>The certainly conflicts with #25179.



---

archive/issue_comments_369398.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-17T10:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369398",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369399.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-05-17T16:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369399",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369400.json:
```json
{
    "body": "<a id='comment:22'></a>Rebased on top of / using #25179.",
    "created_at": "2018-05-17T16:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369400",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'></a>Rebased on top of / using #25179.



---

archive/issue_comments_369401.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-17T16:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369401",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369402.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-01T11:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369402",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369403.json:
```json
{
    "body": "<a id='comment:25'></a>This triggers many failing doctests, see patchbots.",
    "created_at": "2018-06-01T11:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369403",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:25'></a>This triggers many failing doctests, see patchbots.



---

archive/issue_comments_369404.json:
```json
{
    "body": "<a id='comment:26'></a>what is the status of this one ?",
    "created_at": "2018-07-05T06:40:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369404",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'></a>what is the status of this one ?



---

archive/issue_comments_369405.json:
```json
{
    "body": "<a id='comment:27'></a>I would like to deal with src/sage/categories/unital_algebras.py on #25181.",
    "created_at": "2018-07-05T08:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369405",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>I would like to deal with src/sage/categories/unital_algebras.py on #25181.



---

archive/issue_comments_369406.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 jdemeyer]:\n> I would like to deal with src/sage/categories/unital_algebras.py on #25181.\n\n\nWhich I plan to talk with Nicolas about at SageDays`@`ICERM in ~3 weeks.",
    "created_at": "2018-07-05T23:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369406",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>Replying to [comment:27 jdemeyer]:
> I would like to deal with src/sage/categories/unital_algebras.py on #25181.


Which I plan to talk with Nicolas about at SageDays`@`ICERM in ~3 weeks.



---

archive/issue_comments_369407.json:
```json
{
    "body": "<a id='comment:29'></a>I believe this issue can reasonably be addressed for Sage 8.4.",
    "created_at": "2018-07-18T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369407",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'></a>I believe this issue can reasonably be addressed for Sage 8.4.



---

archive/issue_events_062630.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24955#event-62630"
}
```



---

archive/issue_events_062631.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24955#event-62631"
}
```



---

archive/issue_comments_369408.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-09-06T14:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369408",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369409.json:
```json
{
    "body": "<a id='comment:31'></a>Rebased this.  I think the fix in `sage.categories.magmas` is still relevant.  The other change in `unital_algebras` is some leftover whitespace cleanup from when there were some more relevant changes to that module in this ticket that are no longer needed.",
    "created_at": "2018-09-06T14:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369409",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'></a>Rebased this.  I think the fix in `sage.categories.magmas` is still relevant.  The other change in `unital_algebras` is some leftover whitespace cleanup from when there were some more relevant changes to that module in this ticket that are no longer needed.



---

archive/issue_comments_369410.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-06T14:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369410",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369411.json:
```json
{
    "body": "<a id='comment:32'></a>Looks good to me, but I would prefer to wait for Jeroen's approval..",
    "created_at": "2018-09-06T19:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369411",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'></a>Looks good to me, but I would prefer to wait for Jeroen's approval..



---

archive/issue_comments_369412.json:
```json
{
    "body": "<a id='comment:33'></a>Can we avoid using `inspect.isfunction` for purposes unrelated to introspection? Or at least justify that `inspect.isfunction` call?",
    "created_at": "2018-09-06T19:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369412",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>Can we avoid using `inspect.isfunction` for purposes unrelated to introspection? Or at least justify that `inspect.isfunction` call?



---

archive/issue_comments_369413.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-09-06T19:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369413",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_369414.json:
```json
{
    "body": "<a id='comment:34'></a>Hmm, I agree, in retrospect.  I think for this particular case it's good enough just to ensure that it's not `None`.",
    "created_at": "2018-09-07T12:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369414",
    "user": "https://github.com/embray"
}
```

<a id='comment:34'></a>Hmm, I agree, in retrospect.  I think for this particular case it's good enough just to ensure that it's not `None`.



---

archive/issue_comments_369415.json:
```json
{
    "body": "<a id='comment:35'></a>Will this be a fix for #26206 ?",
    "created_at": "2018-09-12T12:15:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369415",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:35'></a>Will this be a fix for #26206 ?



---

archive/issue_comments_369416.json:
```json
{
    "body": "<a id='comment:36'></a>I don't know, but probably.  Have you tried?\n\nMy python3 branch, which has this fix already merged in, gives\n\n```\n$ ./sage -t src/sage/rings/polynomial/cyclotomic.pyx\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2018-09-12-14-25-40-607f4567.\nGit branch: python3\nUsing --optional=dochtml,meataxe,memlimit,mpir,python2,sage\nDoctesting 1 file.\nsage -t src/sage/rings/polynomial/cyclotomic.pyx\n    [34 tests, 1.39 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 1.4 seconds\n    cpu time: 1.4 seconds\n    cumulative wall time: 1.4 seconds\n```",
    "created_at": "2018-09-12T14:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369416",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>I don't know, but probably.  Have you tried?

My python3 branch, which has this fix already merged in, gives

```
$ ./sage -t src/sage/rings/polynomial/cyclotomic.pyx
too many failed tests, not using stored timings
Running doctests with ID 2018-09-12-14-25-40-607f4567.
Git branch: python3
Using --optional=dochtml,meataxe,memlimit,mpir,python2,sage
Doctesting 1 file.
sage -t src/sage/rings/polynomial/cyclotomic.pyx
    [34 tests, 1.39 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 1.4 seconds
    cpu time: 1.4 seconds
    cumulative wall time: 1.4 seconds
```



---

archive/issue_comments_369417.json:
```json
{
    "body": "<a id='comment:37'></a>Yes, I just tried and this does the job. So please try to move on here.",
    "created_at": "2018-09-12T14:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369417",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'></a>Yes, I just tried and this does the job. So please try to move on here.



---

archive/issue_comments_369418.json:
```json
{
    "body": "<a id='comment:38'></a>If it's urgent you're welcome to take it over yourself.  I agree with Jeroen's concern that there's probably no need to use `inspect.isfunction` here (I don't agree necessarily that the `inspect` module should *only* be used for introspection, but I also know he's concerned that this won't work for CyFunctions).",
    "created_at": "2018-09-12T14:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369418",
    "user": "https://github.com/embray"
}
```

<a id='comment:38'></a>If it's urgent you're welcome to take it over yourself.  I agree with Jeroen's concern that there's probably no need to use `inspect.isfunction` here (I don't agree necessarily that the `inspect` module should *only* be used for introspection, but I also know he's concerned that this won't work for CyFunctions).



---

archive/issue_comments_369419.json:
```json
{
    "body": "<a id='comment:39'></a>I already tried and failed..",
    "created_at": "2018-09-12T14:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369419",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'></a>I already tried and failed..



---

archive/issue_comments_369420.json:
```json
{
    "body": "<a id='comment:40'></a>To be more precise, I tried to replace \"inspect.isfunction(...)\" by \"... is not None\" and it did not work. What would be the correct way ?",
    "created_at": "2018-09-15T19:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369420",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:40'></a>To be more precise, I tried to replace "inspect.isfunction(...)" by "... is not None" and it did not work. What would be the correct way ?



---

archive/issue_comments_369421.json:
```json
{
    "body": "<a id='comment:41'></a>Sorry, yeah, `is not None` was bad advice.  I don't know what I was thinking when I wrote that.",
    "created_at": "2018-09-18T17:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369421",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>Sorry, yeah, `is not None` was bad advice.  I don't know what I was thinking when I wrote that.



---

archive/issue_comments_369422.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-09-18T17:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369422",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369423.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-09-18T17:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369423",
    "user": "https://github.com/embray"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_369424.json:
```json
{
    "body": "<a id='comment:43'></a>I think this is the correct intent here.",
    "created_at": "2018-09-18T17:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369424",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>I think this is the correct intent here.



---

archive/issue_comments_369425.json:
```json
{
    "body": "<a id='comment:44'></a>seems to trigger *a lot* of failing doctests:\n\n```\nsage -t --long src/sage/categories/coxeter_groups.py  # 99 doctests failed\nsage -t --long src/sage/categories/complex_reflection_or_generalized_coxeter_groups.py  # 27 doctests failed\nsage -t --long src/sage/categories/examples/finite_weyl_groups.py  # 7 doctests failed\nsage -t --long src/sage/categories/finite_weyl_groups.py  # 1 doctest failed\nsage -t --long src/sage/combinat/sf/new_kschur.py  # Killed due to segmentation fault\n```",
    "created_at": "2018-09-18T19:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369425",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:44'></a>seems to trigger *a lot* of failing doctests:

```
sage -t --long src/sage/categories/coxeter_groups.py  # 99 doctests failed
sage -t --long src/sage/categories/complex_reflection_or_generalized_coxeter_groups.py  # 27 doctests failed
sage -t --long src/sage/categories/examples/finite_weyl_groups.py  # 7 doctests failed
sage -t --long src/sage/categories/finite_weyl_groups.py  # 1 doctest failed
sage -t --long src/sage/combinat/sf/new_kschur.py  # Killed due to segmentation fault
```



---

archive/issue_comments_369426.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-09-19T07:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369426",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_369427.json:
```json
{
    "body": "<a id='comment:46'></a>Indeed, I must still be missing something (I ran a few tests that suggest this worked, but I wasn't entirely sure all the possible situations where this would come up, so just seeing these test failures helps).",
    "created_at": "2018-09-19T10:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369427",
    "user": "https://github.com/embray"
}
```

<a id='comment:46'></a>Indeed, I must still be missing something (I ran a few tests that suggest this worked, but I wasn't entirely sure all the possible situations where this would come up, so just seeing these test failures helps).



---

archive/issue_comments_369428.json:
```json
{
    "body": "<a id='comment:47'></a>oops, I just have a spurious `not` for some reason.  It should be\n\n```python\nif isinstance(C_mul_func, AbstractMethod):\n    return\n```\n\nnot *not isinstance*...",
    "created_at": "2018-09-19T12:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369428",
    "user": "https://github.com/embray"
}
```

<a id='comment:47'></a>oops, I just have a spurious `not` for some reason.  It should be

```python
if isinstance(C_mul_func, AbstractMethod):
    return
```

not *not isinstance*...



---

archive/issue_comments_369429.json:
```json
{
    "body": "<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-09-19T12:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_369430.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-19T12:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369430",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_369431.json:
```json
{
    "body": "<a id='comment:50'></a>Looks good to me.\n\n`@`jdemeyer, do you agree ?\n\nEDIT: This should have high priority, as it may fix a lot of doctests..",
    "created_at": "2018-09-19T15:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369431",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:50'></a>Looks good to me.

`@`jdemeyer, do you agree ?

EDIT: This should have high priority, as it may fix a lot of doctests..



---

archive/issue_comments_369432.json:
```json
{
    "body": "<a id='comment:51'></a>Note: If you believe this patch is useful you can always merge it locally...",
    "created_at": "2018-09-20T11:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369432",
    "user": "https://github.com/embray"
}
```

<a id='comment:51'></a>Note: If you believe this patch is useful you can always merge it locally...



---

archive/issue_comments_369433.json:
```json
{
    "body": "<a id='comment:52'></a>ok, let me set this to positive.",
    "created_at": "2018-09-20T18:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369433",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:52'></a>ok, let me set this to positive.



---

archive/issue_comments_369434.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-20T18:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369434",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_369435.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-22T10:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24955#issuecomment-369435",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_062632.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-22T10:22:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24955",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24955#event-62632"
}
```
