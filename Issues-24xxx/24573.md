# Issue 24573: bug in creating graphic matroid with explicit groundset labels

archive/issues_024336.json:
```json
{
    "body": "with the branch in #24512, which changes the implementation of WheelGraph, one has\n\n```\nsage: M = Matroid(range(8),graphs.WheelGraph(5))\nsage: M.graphic_coextension(0,X=[1,2])\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-38-f3164ab7cc54> in <module>()\n----> 1 M.graphic_coextension(Integer(0),X=[Integer(1),Integer(2)])\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/graphic_matroid.pyc in graphic_coextension(self, u, v, X, element)\n   1593         edgelist = self.groundset_to_edges(X)\n   1594 \n-> 1595         split_vertex(G, u, v, edgelist)\n   1596         G.add_edge(u, v, element)\n   1597 \n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/utilities.pyc in split_vertex(G, u, v, edges)\n    773                 G.delete_edge(e)\n    774             else:\n--> 775                 raise ValueError(\"the edges are not all incident with u\")\n    776 \n    777         elif e[0] == u:\n\nValueError: the edges are not all incident with u\n```\nwhich indicates an inconsistency in creation of M.\nIndeed, the following works:\n\n```\nsage: M = Matroid(graphs.WheelGraph(5))\nsage: M.graphic_coextension(0,X=[(0,2),(0,3)])\nGraphic matroid of rank 5 on 9 elements\n```\n\nCC:  stefan rudi zgershkoff\n\nBranch/Commit: ef524ec55973d68ac1a735cb348d5b4f67dad152\n\nReviewer: Zach Gershkoff\n\nAuthor: Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24573\n\n",
    "closed_at": "2018-02-22T17:40:47Z",
    "created_at": "2018-01-19T18:38:49Z",
    "labels": [
        "component: matroid theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "bug in creating graphic matroid with explicit groundset labels",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24573",
    "user": "https://github.com/dimpase"
}
```
with the branch in #24512, which changes the implementation of WheelGraph, one has

```
sage: M = Matroid(range(8),graphs.WheelGraph(5))
sage: M.graphic_coextension(0,X=[1,2])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-38-f3164ab7cc54> in <module>()
----> 1 M.graphic_coextension(Integer(0),X=[Integer(1),Integer(2)])

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/graphic_matroid.pyc in graphic_coextension(self, u, v, X, element)
   1593         edgelist = self.groundset_to_edges(X)
   1594 
-> 1595         split_vertex(G, u, v, edgelist)
   1596         G.add_edge(u, v, element)
   1597 

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/utilities.pyc in split_vertex(G, u, v, edges)
    773                 G.delete_edge(e)
    774             else:
--> 775                 raise ValueError("the edges are not all incident with u")
    776 
    777         elif e[0] == u:

ValueError: the edges are not all incident with u
```
which indicates an inconsistency in creation of M.
Indeed, the following works:

```
sage: M = Matroid(graphs.WheelGraph(5))
sage: M.graphic_coextension(0,X=[(0,2),(0,3)])
Graphic matroid of rank 5 on 9 elements
```

CC:  stefan rudi zgershkoff

Branch/Commit: ef524ec55973d68ac1a735cb348d5b4f67dad152

Reviewer: Zach Gershkoff

Author: Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24573





---

archive/issue_comments_465431.json:
```json
{
    "body": "<a id='comment:1'></a>\nisn't there a documentation bug:\nCurrently one only sees\n\n```\n   A coextension in a graphic matroid is the opposite of contracting\n   an edge; that is, vertices are merged, and a new edge is added\n   between them. This method will split a vertex, and move the edges\n   indicated by \"X\" to the new vertex.\n```\nThis `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.\n\n---\n\nAnd while I am at it, isn't `edges of \"u\"` in description of `X` too informal? Should it be `edges incident to \"u\"` ?",
    "created_at": "2018-01-20T00:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465431",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
isn't there a documentation bug:
Currently one only sees

```
   A coextension in a graphic matroid is the opposite of contracting
   an edge; that is, vertices are merged, and a new edge is added
   between them. This method will split a vertex, and move the edges
   indicated by "X" to the new vertex.
```
This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.

---

And while I am at it, isn't `edges of "u"` in description of `X` too informal? Should it be `edges incident to "u"` ?



---

archive/issue_comments_465432.json:
```json
{
    "body": "<a id='comment:2'></a>\nGiven the discussion in #24512, I'm not sure what needs to be changed in the code, if anything. The doctest was fixed already so future changes to `WheelGraph()` won't upset it.\n\nReplying to [dimpase](#comment%3A1):\n> isn't there a documentation bug:\n> Currently one only sees\n> \n> ```\n>    A coextension in a graphic matroid is the opposite of contracting\n>    an edge; that is, vertices are merged, and a new edge is added\n>    between them. This method will split a vertex, and move the edges\n>    indicated by \"X\" to the new vertex.\n> ```\n> This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.\n\n\nYes, that's an error. How about this: \n\n {{{\n    A coextension in a graphic matroid is the opposite of contracting\n    an edge; that is, a vertex is split, and a new edge is added\n    between the resulting vertices. This method will create a new vertex\n    adjacent to \"u\", and move the edges indicated by \"X\" from \"u\"\n    to the new vertex.\n }}}\n\n> And while I am at it, isn't `edges of \"u\"` in description of `X` too informal? Should it be `edges incident to \"u\"` ?\n\n\nI suppose it's not standard, but I think the meaning is unambiguous. The phrase \"edges of\" only makes sense followed by a set of edges or an object that implies a set of edges (such as a graph), and I think there's only one set of edges that a vertex implies. But sure, we can change it since we're changing things.",
    "created_at": "2018-01-23T00:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465432",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

<a id='comment:2'></a>
Given the discussion in #24512, I'm not sure what needs to be changed in the code, if anything. The doctest was fixed already so future changes to `WheelGraph()` won't upset it.

Replying to [dimpase](#comment%3A1):
> isn't there a documentation bug:
> Currently one only sees
> 
> ```
>    A coextension in a graphic matroid is the opposite of contracting
>    an edge; that is, vertices are merged, and a new edge is added
>    between them. This method will split a vertex, and move the edges
>    indicated by "X" to the new vertex.
> ```
> This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.


Yes, that's an error. How about this: 

 {{{
    A coextension in a graphic matroid is the opposite of contracting
    an edge; that is, a vertex is split, and a new edge is added
    between the resulting vertices. This method will create a new vertex
    adjacent to "u", and move the edges indicated by "X" from "u"
    to the new vertex.
 }}}

> And while I am at it, isn't `edges of "u"` in description of `X` too informal? Should it be `edges incident to "u"` ?


I suppose it's not standard, but I think the meaning is unambiguous. The phrase "edges of" only makes sense followed by a set of edges or an object that implies a set of edges (such as a graph), and I think there's only one set of edges that a vertex implies. But sure, we can change it since we're changing things.



---

archive/issue_comments_465433.json:
```json
{
    "body": "Changing commit from \"\" to \"7def5ffdc91844fae9f416c376dd6224c5770db2\"",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465433",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "" to "7def5ffdc91844fae9f416c376dd6224c5770db2"



---

archive/issue_comments_465434.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK, so here is the reworded doc. Please review.\n\n---\nNew commits:\n|                                                                                                                                          |                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[7def5ff](https://git.sagemath.org/sage.git/commit?id=7def5ffdc91844fae9f416c376dd6224c5770db2)|`meaningful documentation for coextension, cf. #24573`|",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465434",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
OK, so here is the reworded doc. Please review.

---
New commits:
|                                                                                                                                          |                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[7def5ff](https://git.sagemath.org/sage.git/commit?id=7def5ffdc91844fae9f416c376dd6224c5770db2)|`meaningful documentation for coextension, cf. #24573`|



---

archive/issue_comments_465435.json:
```json
{
    "body": "Changing author from \"\" to \"Dima Pasechnik\"",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465435",
    "user": "https://github.com/dimpase"
}
```

Changing author from "" to "Dima Pasechnik"



---

archive/issue_comments_465436.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465436",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_465437.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dimpase/matpat\"",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465437",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "" to "u/dimpase/matpat"



---

archive/issue_comments_465438.json:
```json
{
    "body": "<a id='comment:4'></a>\nLooks fine. Patchbot doesn't like it but I think that's unrelated.\n\nYou're not going to fix `edges of \"u\"` as well?",
    "created_at": "2018-02-14T23:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465438",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

<a id='comment:4'></a>
Looks fine. Patchbot doesn't like it but I think that's unrelated.

You're not going to fix `edges of "u"` as well?



---

archive/issue_comments_465439.json:
```json
{
    "body": "Changing commit from \"7def5ffdc91844fae9f416c376dd6224c5770db2\" to \"ef524ec55973d68ac1a735cb348d5b4f67dad152\"",
    "created_at": "2018-02-15T10:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465439",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7def5ffdc91844fae9f416c376dd6224c5770db2" to "ef524ec55973d68ac1a735cb348d5b4f67dad152"



---

archive/issue_comments_465440.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[d0ffd5d](https://git.sagemath.org/sage.git/commit/?id=d0ffd5d67016909d55f5d413b4a879af21ab99b2)|`meaningful documentation for coextension, cf. #24573`|\n|[ef524ec](https://git.sagemath.org/sage.git/commit/?id=ef524ec55973d68ac1a735cb348d5b4f67dad152)|`\"of\" -> \"incident to\" rewording`|",
    "created_at": "2018-02-15T10:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[d0ffd5d](https://git.sagemath.org/sage.git/commit/?id=d0ffd5d67016909d55f5d413b4a879af21ab99b2)|`meaningful documentation for coextension, cf. #24573`|
|[ef524ec](https://git.sagemath.org/sage.git/commit/?id=ef524ec55973d68ac1a735cb348d5b4f67dad152)|`"of" -> "incident to" rewording`|



---

archive/issue_comments_465441.json:
```json
{
    "body": "<a id='comment:6'></a>\nOK, right, fixed this too.",
    "created_at": "2018-02-15T10:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465441",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
OK, right, fixed this too.



---

archive/issue_comments_465442.json:
```json
{
    "body": "Changing dependencies from \"#24512\" to \"\"",
    "created_at": "2018-02-15T10:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465442",
    "user": "https://github.com/dimpase"
}
```

Changing dependencies from "#24512" to ""



---

archive/issue_comments_465443.json:
```json
{
    "body": "<a id='comment:7'></a>\nLGTM",
    "created_at": "2018-02-21T02:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465443",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

<a id='comment:7'></a>
LGTM



---

archive/issue_comments_465444.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-21T02:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465444",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_465445.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Zachary Gershkoff\"",
    "created_at": "2018-02-21T02:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465445",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

Changing reviewer from "" to "Zachary Gershkoff"



---

archive/issue_comments_465446.json:
```json
{
    "body": "Changing reviewer from \"Zachary Gershkoff\" to \"Zach Gershkoff\"",
    "created_at": "2018-02-21T02:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465446",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

Changing reviewer from "Zachary Gershkoff" to "Zach Gershkoff"



---

archive/issue_comments_465447.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-02-22T17:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465447",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_465448.json:
```json
{
    "body": "Changing branch from \"u/dimpase/matpat\" to \"ef524ec55973d68ac1a735cb348d5b4f67dad152\"",
    "created_at": "2018-02-22T17:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-465448",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/dimpase/matpat" to "ef524ec55973d68ac1a735cb348d5b4f67dad152"



---

archive/issue_events_061956.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-22T17:40:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24573#event-61956"
}
```
