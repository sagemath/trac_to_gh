# Issue 24573: bug in creating graphic matroid with explicit groundset labels

archive/issues_024336.json:
```json
{
    "body": "with the branch in #24512, which changes the implementation of WheelGraph, one has\n\n```\nsage: M = Matroid(range(8),graphs.WheelGraph(5))\nsage: M.graphic_coextension(0,X=[1,2])\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-38-f3164ab7cc54> in <module>()\n----> 1 M.graphic_coextension(Integer(0),X=[Integer(1),Integer(2)])\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/graphic_matroid.pyc in graphic_coextension(self, u, v, X, element)\n   1593         edgelist = self.groundset_to_edges(X)\n   1594 \n-> 1595         split_vertex(G, u, v, edgelist)\n   1596         G.add_edge(u, v, element)\n   1597 \n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/utilities.pyc in split_vertex(G, u, v, edges)\n    773                 G.delete_edge(e)\n    774             else:\n--> 775                 raise ValueError(\"the edges are not all incident with u\")\n    776 \n    777         elif e[0] == u:\n\nValueError: the edges are not all incident with u\n```\nwhich indicates an inconsistency in creation of M.\nIndeed, the following works:\n\n```\nsage: M = Matroid(graphs.WheelGraph(5))\nsage: M.graphic_coextension(0,X=[(0,2),(0,3)])\nGraphic matroid of rank 5 on 9 elements\n```\n\nCC:  stefan rudi zgershkoff\n\nReviewer: Zach Gershkoff\n\nAuthor: Dima Pasechnik\n\nBranch: ef524ec55973d68ac1a735cb348d5b4f67dad152\n\nCommit: ef524ec55973d68ac1a735cb348d5b4f67dad152\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24573\n\n",
    "closed_at": "2018-02-22T17:40:47Z",
    "created_at": "2018-01-19T18:38:49Z",
    "labels": [
        "component: matroid theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "bug in creating graphic matroid with explicit groundset labels",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24573",
    "user": "https://github.com/dimpase"
}
```
with the branch in #24512, which changes the implementation of WheelGraph, one has

```
sage: M = Matroid(range(8),graphs.WheelGraph(5))
sage: M.graphic_coextension(0,X=[1,2])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-38-f3164ab7cc54> in <module>()
----> 1 M.graphic_coextension(Integer(0),X=[Integer(1),Integer(2)])

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/graphic_matroid.pyc in graphic_coextension(self, u, v, X, element)
   1593         edgelist = self.groundset_to_edges(X)
   1594 
-> 1595         split_vertex(G, u, v, edgelist)
   1596         G.add_edge(u, v, element)
   1597 

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matroids/utilities.pyc in split_vertex(G, u, v, edges)
    773                 G.delete_edge(e)
    774             else:
--> 775                 raise ValueError("the edges are not all incident with u")
    776 
    777         elif e[0] == u:

ValueError: the edges are not all incident with u
```
which indicates an inconsistency in creation of M.
Indeed, the following works:

```
sage: M = Matroid(graphs.WheelGraph(5))
sage: M.graphic_coextension(0,X=[(0,2),(0,3)])
Graphic matroid of rank 5 on 9 elements
```

CC:  stefan rudi zgershkoff

Reviewer: Zach Gershkoff

Author: Dima Pasechnik

Branch: ef524ec55973d68ac1a735cb348d5b4f67dad152

Commit: ef524ec55973d68ac1a735cb348d5b4f67dad152

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24573





---

archive/issue_comments_340406.json:
```json
{
    "body": "<a id='comment:1'></a>isn't there a documentation bug:\nCurrently one only sees\n\n```\n   A coextension in a graphic matroid is the opposite of contracting\n   an edge; that is, vertices are merged, and a new edge is added\n   between them. This method will split a vertex, and move the edges\n   indicated by \"X\" to the new vertex.\n```\nThis `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.\n\n---\n\nAnd while I am at it, isn't `edges of \"u\"` in description of `X` too informal? Should it be `edges incident to \"u\"` ?",
    "created_at": "2018-01-20T00:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340406",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>isn't there a documentation bug:
Currently one only sees

```
   A coextension in a graphic matroid is the opposite of contracting
   an edge; that is, vertices are merged, and a new edge is added
   between them. This method will split a vertex, and move the edges
   indicated by "X" to the new vertex.
```
This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.

---

And while I am at it, isn't `edges of "u"` in description of `X` too informal? Should it be `edges incident to "u"` ?



---

archive/issue_comments_340407.json:
```json
{
    "body": "<a id='comment:2'></a>Given the discussion in #24512, I'm not sure what needs to be changed in the code, if anything. The doctest was fixed already so future changes to `WheelGraph()` won't upset it.\n\nReplying to [comment:1 dimpase]:\n> isn't there a documentation bug:\n> Currently one only sees\n> \n> ```\n>    A coextension in a graphic matroid is the opposite of contracting\n>    an edge; that is, vertices are merged, and a new edge is added\n>    between them. This method will split a vertex, and move the edges\n>    indicated by \"X\" to the new vertex.\n> ```\n> This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.\n\n\nYes, that's an error. How about this: \n\n {{{\n    A coextension in a graphic matroid is the opposite of contracting\n    an edge; that is, a vertex is split, and a new edge is added\n    between the resulting vertices. This method will create a new vertex\n    adjacent to \"u\", and move the edges indicated by \"X\" from \"u\"\n    to the new vertex.\n }}}\n\n> And while I am at it, isn't `edges of \"u\"` in description of `X` too informal? Should it be `edges incident to \"u\"` ?\n\n\nI suppose it's not standard, but I think the meaning is unambiguous. The phrase \"edges of\" only makes sense followed by a set of edges or an object that implies a set of edges (such as a graph), and I think there's only one set of edges that a vertex implies. But sure, we can change it since we're changing things.",
    "created_at": "2018-01-23T00:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340407",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

<a id='comment:2'></a>Given the discussion in #24512, I'm not sure what needs to be changed in the code, if anything. The doctest was fixed already so future changes to `WheelGraph()` won't upset it.

Replying to [comment:1 dimpase]:
> isn't there a documentation bug:
> Currently one only sees
> 
> ```
>    A coextension in a graphic matroid is the opposite of contracting
>    an edge; that is, vertices are merged, and a new edge is added
>    between them. This method will split a vertex, and move the edges
>    indicated by "X" to the new vertex.
> ```
> This `vertices are merged, and a new edge is added` makes no sense to me. It seems that one started talking about what an edge contraction means, as merging happens in edge contraction, stopped half-way, and switched to describing coextension.


Yes, that's an error. How about this: 

 {{{
    A coextension in a graphic matroid is the opposite of contracting
    an edge; that is, a vertex is split, and a new edge is added
    between the resulting vertices. This method will create a new vertex
    adjacent to "u", and move the edges indicated by "X" from "u"
    to the new vertex.
 }}}

> And while I am at it, isn't `edges of "u"` in description of `X` too informal? Should it be `edges incident to "u"` ?


I suppose it's not standard, but I think the meaning is unambiguous. The phrase "edges of" only makes sense followed by a set of edges or an object that implies a set of edges (such as a graph), and I think there's only one set of edges that a vertex implies. But sure, we can change it since we're changing things.



---

archive/issue_comments_340408.json:
```json
{
    "body": "<a id='comment:3'></a>OK, so here is the reworded doc. Please review.\n\n---\nNew commits:",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340408",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>OK, so here is the reworded doc. Please review.

---
New commits:



---

archive/issue_comments_340409.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-03T22:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340409",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_340410.json:
```json
{
    "body": "<a id='comment:4'></a>Looks fine. Patchbot doesn't like it but I think that's unrelated.\n\nYou're not going to fix `edges of \"u\"` as well?",
    "created_at": "2018-02-14T23:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340410",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

<a id='comment:4'></a>Looks fine. Patchbot doesn't like it but I think that's unrelated.

You're not going to fix `edges of "u"` as well?



---

archive/issue_comments_340411.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-02-15T10:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340411",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_340412.json:
```json
{
    "body": "<a id='comment:6'></a>OK, right, fixed this too.",
    "created_at": "2018-02-15T10:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340412",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>OK, right, fixed this too.



---

archive/issue_comments_340413.json:
```json
{
    "body": "<a id='comment:7'></a>LGTM",
    "created_at": "2018-02-21T02:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340413",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

<a id='comment:7'></a>LGTM



---

archive/issue_comments_340414.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-21T02:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340414",
    "user": "https://trac.sagemath.org/admin/accounts/users/zgershkoff"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_340415.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-02-22T17:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24573#issuecomment-340415",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_061956.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-22T17:40:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24573",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24573#event-61956"
}
```
