# Issue 24815: Register FreeModuleElement to the Sequence ABC

archive/issues_024578.json:
```json
{
    "assignees": [],
    "body": "For *most* intents and purposes instances of `FreeModuleElement` can be used equivalently to `list` or `tuple`, in that they all meet the requirements of the [Sequence](https://docs.python.org/3/library/stdtypes.html#sequence-types-list-tuple-range) protocol (which on Python 3 also includes `range`).\n\nThis simplifies some code that treats `Vector` distinctly from `list` and `tuple`.  To be clear, in this case we are explicitly treating the `FreeModuleElement` type, and not the abstract `Vector` type which does not meet these requirements, but that's okay since `FreeModuleElement` implements any concrete vector space elements.\n\nBy convention, this always imports `collections.Sequence` as `SequenceABC` so as to not confuse it with Sage's `Sequence` class.\n\nSee also: #26769 Add an `issequence` utility to check for list, tuple, and other compatible objects\n\nComponent: **refactoring**\n\nAuthor: **Erik Bray**\n\nBranch/Commit: **[u/embray/refactoring/free-module-sequence](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/refactoring/free-module-sequence) @ [`9660547`](https://github.com/sagemath/sagetrac-mirror/commit/9660547f4707ffc85edec2c10d1d0e7e58c0b9dc)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24815_\n\n",
    "created_at": "2018-02-22T11:43:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/refactoring",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Register FreeModuleElement to the Sequence ABC",
    "type": "issue",
    "updated_at": "2023-01-07T21:39:40Z",
    "url": "https://github.com/sagemath/sage/issues/24815",
    "user": "https://github.com/embray"
}
```
For *most* intents and purposes instances of `FreeModuleElement` can be used equivalently to `list` or `tuple`, in that they all meet the requirements of the [Sequence](https://docs.python.org/3/library/stdtypes.html#sequence-types-list-tuple-range) protocol (which on Python 3 also includes `range`).

This simplifies some code that treats `Vector` distinctly from `list` and `tuple`.  To be clear, in this case we are explicitly treating the `FreeModuleElement` type, and not the abstract `Vector` type which does not meet these requirements, but that's okay since `FreeModuleElement` implements any concrete vector space elements.

By convention, this always imports `collections.Sequence` as `SequenceABC` so as to not confuse it with Sage's `Sequence` class.

See also: #26769 Add an `issequence` utility to check for list, tuple, and other compatible objects

Component: **refactoring**

Author: **Erik Bray**

Branch/Commit: **[u/embray/refactoring/free-module-sequence](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/refactoring/free-module-sequence) @ [`9660547`](https://github.com/sagemath/sagetrac-mirror/commit/9660547f4707ffc85edec2c10d1d0e7e58c0b9dc)**

_Issue created by migration from https://trac.sagemath.org/ticket/24815_





---

archive/issue_events_340492.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-22T11:43:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340492"
}
```



---

archive/issue_events_340493.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-22T11:43:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340493"
}
```



---

archive/issue_events_340494.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-22T11:43:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340494"
}
```



---

archive/issue_events_340495.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-22T11:43:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340495"
}
```



---

archive/issue_comments_377152.json:
```json
{
    "body": "Commit: **[`fcda724`](https://github.com/sagemath/sagetrac-mirror/commit/fcda724addfec8d664d0c2b149a2c17f0cc1ca52)**",
    "created_at": "2018-02-22T11:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377152",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`fcda724`](https://github.com/sagemath/sagetrac-mirror/commit/fcda724addfec8d664d0c2b149a2c17f0cc1ca52)**



---

archive/issue_comments_377153.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8d1c0e92516535b59a7dbb7e517866928d6f0ad\"><code>a8d1c0e</code></a></td><td><code>Register FreeModuleElement to the Sequence ABC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a73178ddcd28d7b010e3a06d627c8cdc5937baef\"><code>a73178d</code></a></td><td><code>Some simple examples where isinstance(..., (list, tuple, Vector)) could be replaced with SequenceABC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da6b45a230b7b9a198199e31a2a2174b018dbc82\"><code>da6b45a</code></a></td><td><code>A slightly more involved replacement with SequenceABC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcda724addfec8d664d0c2b149a2c17f0cc1ca52\"><code>fcda724</code></a></td><td><code>More misc PEP-8 cleanup in the affected modules</code></td></tr></table>\n",
    "created_at": "2018-02-22T11:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377153",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:1"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8d1c0e92516535b59a7dbb7e517866928d6f0ad"><code>a8d1c0e</code></a></td><td><code>Register FreeModuleElement to the Sequence ABC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a73178ddcd28d7b010e3a06d627c8cdc5937baef"><code>a73178d</code></a></td><td><code>Some simple examples where isinstance(..., (list, tuple, Vector)) could be replaced with SequenceABC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da6b45a230b7b9a198199e31a2a2174b018dbc82"><code>da6b45a</code></a></td><td><code>A slightly more involved replacement with SequenceABC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcda724addfec8d664d0c2b149a2c17f0cc1ca52"><code>fcda724</code></a></td><td><code>More misc PEP-8 cleanup in the affected modules</code></td></tr></table>




---

archive/issue_comments_377154.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nOne small concern I have with this is that `str`/`bytes` are also considered `Sequence`s by Python.  I think this is okay though, because under this treatment it's really no different than if passed, say, a list of one character strings. Then, if such as list is not valid input, a string is no less invalid.  It just means that if you intend a function to accept string arguments to be processed separately from list/tuple-like arguments, they should always be handled first.  This is what I would probably normally do anyways.",
    "created_at": "2018-02-22T11:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377154",
    "user": "https://github.com/embray"
}
```

<div id="comment:2" align="right">comment:2</div>

One small concern I have with this is that `str`/`bytes` are also considered `Sequence`s by Python.  I think this is okay though, because under this treatment it's really no different than if passed, say, a list of one character strings. Then, if such as list is not valid input, a string is no less invalid.  It just means that if you intend a function to accept string arguments to be processed separately from list/tuple-like arguments, they should always be handled first.  This is what I would probably normally do anyways.



---

archive/issue_comments_377155.json:
```json
{
    "body": "Changed commit from **[`fcda724`](https://github.com/sagemath/sagetrac-mirror/commit/fcda724addfec8d664d0c2b149a2c17f0cc1ca52)** to **[`6644dbd`](https://github.com/sagemath/sagetrac-mirror/commit/6644dbdc443203170f8dc5e35368ce3d8eaf1956)**",
    "created_at": "2018-02-22T11:54:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377155",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fcda724`](https://github.com/sagemath/sagetrac-mirror/commit/fcda724addfec8d664d0c2b149a2c17f0cc1ca52)** to **[`6644dbd`](https://github.com/sagemath/sagetrac-mirror/commit/6644dbdc443203170f8dc5e35368ce3d8eaf1956)**



---

archive/issue_comments_377156.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc25e5fefc518b17c19c1d99a3b456f80a107cee\"><code>dc25e5f</code></a></td><td><code>Some simple examples where isinstance(..., (list, tuple, Vector)) could be replaced with SequenceABC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16c2af99761cb3f4f2a14044bf34ccef7963bec1\"><code>16c2af9</code></a></td><td><code>A slightly more involved replacement with SequenceABC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6644dbdc443203170f8dc5e35368ce3d8eaf1956\"><code>6644dbd</code></a></td><td><code>More misc PEP-8 cleanup in the affected modules</code></td></tr></table>\n",
    "created_at": "2018-02-22T11:54:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377156",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc25e5fefc518b17c19c1d99a3b456f80a107cee"><code>dc25e5f</code></a></td><td><code>Some simple examples where isinstance(..., (list, tuple, Vector)) could be replaced with SequenceABC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16c2af99761cb3f4f2a14044bf34ccef7963bec1"><code>16c2af9</code></a></td><td><code>A slightly more involved replacement with SequenceABC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6644dbdc443203170f8dc5e35368ce3d8eaf1956"><code>6644dbd</code></a></td><td><code>More misc PEP-8 cleanup in the affected modules</code></td></tr></table>




---

archive/issue_comments_377157.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis still has some failing tests--I think mostly due to minor mistakes...",
    "created_at": "2018-02-22T12:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377157",
    "user": "https://github.com/embray"
}
```

<div id="comment:4" align="right">comment:4</div>

This still has some failing tests--I think mostly due to minor mistakes...



---

archive/issue_comments_377158.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6af11674776fe22e21633be8a7da26f5ceeb044d\"><code>6af1167</code></a></td><td><code>A slightly more involved replacement with SequenceABC</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/876b4d49e219b356ab0f5f20d8f30ba67db742ae\"><code>876b4d4</code></a></td><td><code>More misc PEP-8 cleanup in the affected modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0ec61701ecc0515f89ed1f20da05432743d0ea0\"><code>d0ec617</code></a></td><td><code>Added a line here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9660547f4707ffc85edec2c10d1d0e7e58c0b9dc\"><code>9660547</code></a></td><td><code>depending on what the base ring is, the arguments may be strings, which doesn't make sense for the code that follows this condition</code></td></tr></table>\n",
    "created_at": "2018-02-22T12:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377158",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6af11674776fe22e21633be8a7da26f5ceeb044d"><code>6af1167</code></a></td><td><code>A slightly more involved replacement with SequenceABC</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/876b4d49e219b356ab0f5f20d8f30ba67db742ae"><code>876b4d4</code></a></td><td><code>More misc PEP-8 cleanup in the affected modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0ec61701ecc0515f89ed1f20da05432743d0ea0"><code>d0ec617</code></a></td><td><code>Added a line here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9660547f4707ffc85edec2c10d1d0e7e58c0b9dc"><code>9660547</code></a></td><td><code>depending on what the base ring is, the arguments may be strings, which doesn't make sense for the code that follows this condition</code></td></tr></table>




---

archive/issue_comments_377159.json:
```json
{
    "body": "Changed commit from **[`6644dbd`](https://github.com/sagemath/sagetrac-mirror/commit/6644dbdc443203170f8dc5e35368ce3d8eaf1956)** to **[`9660547`](https://github.com/sagemath/sagetrac-mirror/commit/9660547f4707ffc85edec2c10d1d0e7e58c0b9dc)**",
    "created_at": "2018-02-22T12:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377159",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6644dbd`](https://github.com/sagemath/sagetrac-mirror/commit/6644dbdc443203170f8dc5e35368ce3d8eaf1956)** to **[`9660547`](https://github.com/sagemath/sagetrac-mirror/commit/9660547f4707ffc85edec2c10d1d0e7e58c0b9dc)**



---

archive/issue_comments_377160.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIn fact, the main bug I had was due to the aforementioned concern about `str`, where there was one case where it didn't make sense to treat lists of strings equivalently to lists of lists.  This was the only such case, however (a slightly tricky one since it was in the matrix constructor, which has a lot of tricky logic pertaining to flexibility in its arguments).",
    "created_at": "2018-02-22T12:46:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377160",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

In fact, the main bug I had was due to the aforementioned concern about `str`, where there was one case where it didn't make sense to treat lists of strings equivalently to lists of lists.  This was the only such case, however (a slightly tricky one since it was in the matrix constructor, which has a lot of tricky logic pertaining to flexibility in its arguments).



---

archive/issue_events_340496.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-22T12:46:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340496"
}
```



---

archive/issue_comments_377161.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nCan you please not make changes to `src/sage/matrix` because I'm dealing with that in #24742.",
    "created_at": "2018-02-22T12:53:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377161",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Can you please not make changes to `src/sage/matrix` because I'm dealing with that in #24742.



---

archive/issue_comments_377162.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI'm not entirely convinced by using the Python ABC stuff. Of course we should *register* the Sage types in the ABC, but *using* the ABC is a different matter.\n\nFirst of all, why `Sequence`? It excludes stuff that you typically want to include such as generators and the itertools stuff like `zip(...)`.\n\nSecond, the ABC is horribly slow. It's about a factor 200 slower than checking `isinstance(foo, (tuple, list))`, a factor 40 slower than `is_Vector()` and a factor 25 slower than checking for iterability. I tested this in Cython, when given a `FreeModuleElement` as input.\n\nSo, why not check for iterability instead (and maybe exclude dicts)? That's what I plan to do in #24742.",
    "created_at": "2018-02-22T13:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377162",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

I'm not entirely convinced by using the Python ABC stuff. Of course we should *register* the Sage types in the ABC, but *using* the ABC is a different matter.

First of all, why `Sequence`? It excludes stuff that you typically want to include such as generators and the itertools stuff like `zip(...)`.

Second, the ABC is horribly slow. It's about a factor 200 slower than checking `isinstance(foo, (tuple, list))`, a factor 40 slower than `is_Vector()` and a factor 25 slower than checking for iterability. I tested this in Cython, when given a `FreeModuleElement` as input.

So, why not check for iterability instead (and maybe exclude dicts)? That's what I plan to do in #24742.



---

archive/issue_events_340497.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-22T13:22:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340497"
}
```



---

archive/issue_events_340498.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-22T13:22:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340498"
}
```



---

archive/issue_comments_377163.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI could incorporate #24742 if it even makes sense to, or just drop the changes there since it's not that important.\n\nThere are several problems with checking just for iterability.  In most cases (if not all) that I updated here the code also uses indexing, so you really need that aspect of `Sequence` as well.  The other problem is merely checking for iterability is that it can allow through infinite iterables (whereas `Sequence`--and perhaps this a misnomer on its part--must be finite).  I discussed this problem more in #24757.  As I also mentioned there, while on some level it's the user's responsibility not to pass in infinite generators, for example, where they don't belong, it's nice to prevent it where possible.  zip, map, filter, etc. are all problematic here.\n\nThe performance issue is a real concern though.  Just note that in addition to `list`, `tuple`, and `Vector` this is also adding support for `range` on Python 3 (and by extension any other custom type that would work just as well here, including possibly some other types in Sage).\n\nI guess it's a question of context and what the relative overhead is.  200 x (eps < 1ns) is nothing if the overall method is on the order of 10ms, say, and what the likelihood is of using that call in a loop (or even its frequency in the test suite).  For the matrix constructor most of all that's certainly worth looking at closely.",
    "created_at": "2018-02-22T14:58:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377163",
    "user": "https://github.com/embray"
}
```

<div id="comment:10" align="right">comment:10</div>

I could incorporate #24742 if it even makes sense to, or just drop the changes there since it's not that important.

There are several problems with checking just for iterability.  In most cases (if not all) that I updated here the code also uses indexing, so you really need that aspect of `Sequence` as well.  The other problem is merely checking for iterability is that it can allow through infinite iterables (whereas `Sequence`--and perhaps this a misnomer on its part--must be finite).  I discussed this problem more in #24757.  As I also mentioned there, while on some level it's the user's responsibility not to pass in infinite generators, for example, where they don't belong, it's nice to prevent it where possible.  zip, map, filter, etc. are all problematic here.

The performance issue is a real concern though.  Just note that in addition to `list`, `tuple`, and `Vector` this is also adding support for `range` on Python 3 (and by extension any other custom type that would work just as well here, including possibly some other types in Sage).

I guess it's a question of context and what the relative overhead is.  200 x (eps < 1ns) is nothing if the overall method is on the order of 10ms, say, and what the likelihood is of using that call in a loop (or even its frequency in the test suite).  For the matrix constructor most of all that's certainly worth looking at closely.



---

archive/issue_comments_377164.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOn the performance question, again, perhaps for the sake of Cython optimization one could first check `list`/`tuple` explicitly since those are going to be the most common anyways, and then fall back on the more generic check.",
    "created_at": "2018-02-22T15:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377164",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

On the performance question, again, perhaps for the sake of Cython optimization one could first check `list`/`tuple` explicitly since those are going to be the most common anyways, and then fall back on the more generic check.



---

archive/issue_comments_377165.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@embray](#comment%3A11):\n> On the performance question, again, perhaps for the sake of Cython optimization one could first check `list`/`tuple` explicitly since those are going to be the most common anyways, and then fall back on the more generic check.\n\nCome to think of it, this would be an optimization worth building into Cython, if possible.  Common ABC from Python's stdlib --> exact type checks for common built-in types that implement that ABC, followed by generic `isinstance(...)`.",
    "created_at": "2018-02-22T15:55:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377165",
    "user": "https://github.com/embray"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@embray](#comment%3A11):
> On the performance question, again, perhaps for the sake of Cython optimization one could first check `list`/`tuple` explicitly since those are going to be the most common anyways, and then fall back on the more generic check.

Come to think of it, this would be an optimization worth building into Cython, if possible.  Common ABC from Python's stdlib --> exact type checks for common built-in types that implement that ABC, followed by generic `isinstance(...)`.



---

archive/issue_comments_377166.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@embray](#comment%3A10):\n> I could incorporate #24742\n\nBetter make this ticket independent from #24742 and just remove the changes to `src/sage/matrix` from this ticket.",
    "created_at": "2018-02-22T16:08:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377166",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@embray](#comment%3A10):
> I could incorporate #24742

Better make this ticket independent from #24742 and just remove the changes to `src/sage/matrix` from this ticket.



---

archive/issue_comments_377167.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI don't mind, but then #24742 should do something about this, or a follow-up to it.  There are cases where it *should* accept vectors and ranges at the very least, but currently doesn't.",
    "created_at": "2018-02-22T16:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377167",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

I don't mind, but then #24742 should do something about this, or a follow-up to it.  There are cases where it *should* accept vectors and ranges at the very least, but currently doesn't.



---

archive/issue_comments_377168.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@embray](#comment%3A12):\n> Come to think of it, this would be an optimization worth building into Cython, if possible.  Common ABC from Python's stdlib --> exact type checks for common built-in types that implement that ABC, followed by generic `isinstance(...)`.\n\nBut then the case where it's not an instance of the ABC will still be slow.\n\nI have sometimes been thinking about adding a fast Cython function caching calls to `isinstance(..., some_type)`. If implemented well, this could be very fast. It could be used for ABCs as well as for other common type checks in Sage like `isinstance(..., Element)`. We could take inspiration from `src/sage/structure/coerce_dict.pyx`.",
    "created_at": "2018-02-22T16:16:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377168",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@embray](#comment%3A12):
> Come to think of it, this would be an optimization worth building into Cython, if possible.  Common ABC from Python's stdlib --> exact type checks for common built-in types that implement that ABC, followed by generic `isinstance(...)`.

But then the case where it's not an instance of the ABC will still be slow.

I have sometimes been thinking about adding a fast Cython function caching calls to `isinstance(..., some_type)`. If implemented well, this could be very fast. It could be used for ABCs as well as for other common type checks in Sage like `isinstance(..., Element)`. We could take inspiration from `src/sage/structure/coerce_dict.pyx`.



---

archive/issue_comments_377169.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@embray](#comment%3A14):\n> I don't mind, but then #24742 should do something about this\n\nIt will.",
    "created_at": "2018-02-22T16:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377169",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@embray](#comment%3A14):
> I don't mind, but then #24742 should do something about this

It will.



---

archive/issue_comments_377170.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI think though, that the case where it does the `isinstance` check would be relatively rare if the common cases are handled first.  Before worrying extensively about it one would have to prove that there's an important common case that it actually substantially impacts.",
    "created_at": "2018-02-23T16:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377170",
    "user": "https://github.com/embray"
}
```

<div id="comment:17" align="right">comment:17</div>

I think though, that the case where it does the `isinstance` check would be relatively rare if the common cases are handled first.  Before worrying extensively about it one would have to prove that there's an important common case that it actually substantially impacts.



---

archive/issue_events_340499.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-26T12:13:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340499"
}
```



---

archive/issue_events_340500.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-26T12:13:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340500"
}
```



---

archive/issue_events_340501.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340501"
}
```



---

archive/issue_events_340502.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340502"
}
```



---

archive/issue_comments_377171.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI believe this issue can reasonably be addressed for Sage 8.4.",
    "created_at": "2018-07-18T11:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377171",
    "user": "https://github.com/embray"
}
```

<div id="comment:19" align="right">comment:19</div>

I believe this issue can reasonably be addressed for Sage 8.4.



---

archive/issue_comments_377172.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jdemeyer](#comment%3A15):\n> Replying to [@embray](#comment%3A12):\n> > Come to think of it, this would be an optimization worth building into Cython, if possible.  Common ABC from Python's stdlib --> exact type checks for common built-in types that implement that ABC, followed by generic `isinstance(...)`.\n\n> \n> But then the case where it's not an instance of the ABC will still be slow.\n> \n> I have sometimes been thinking about adding a fast Cython function caching calls to `isinstance(..., some_type)`. If implemented well, this could be very fast. It could be used for ABCs as well as for other common type checks in Sage like `isinstance(..., Element)`. We could take inspiration from `src/sage/structure/coerce_dict.pyx`.\n\nI'm thinking about this again, and wondering what exactly you mean.  I think we really need some convenient `isiterable` and perhaps `issequence` functions, perhaps in `sage.cpython`.  It doesn't necessarily *have* to work with the ABC framework.  Perhaps we can just explicitly enumerate some specific types we care about for these cases (list, tuple, vector, (x)range, ...) which are going to be by far the most common.  On the other hand, this is pretty inflexible, and that's where the ABC system is quite nice as it is very flexible, but that comes at a small cost.\n\nThere is also already caching built into ABCs, albeit implemented mostly in pure Python.  Each ABC has a `_abc_cache` attribute, which is a `WeakSet` of all types known to implement that ABC (e.g. `Sequence._abc_cache` on Python 2 contains, by default, `list`, `tuple`, `basestring`, `buffer`, and `xrange`).  There is also a `Sequence._abc_negative_cache` for negative lookups, also  `WeakSet`.  This gets invalidated any time a new ABC is registered.\n\nSome interesting news is that Python 3.7 added a new C implementation of ABCMeta, which makes everything a bit faster.  On Python 2.7:\n\n```\npython2.7 -m timeit -s 'from collections import Sequence; l=[]' 'isinstance(l, Sequence)'\n```\n\nand on 3.7:\n\n\n```\npython3.7 -m timeit -s 'from collections.abc import Sequence; l=[]' 'isinstance(l, Sequence)'\n500000 loops, best of 5: 543 nsec per loop\n```\n\nSo a little more than twice as fast?\n\nNegative lookups are improved even more:\n\n```\npython2.7 -m timeit -s 'from collections import Sequence; l=0' 'isinstance(l, Sequence)'\n100000 loops, best of 3: 2.17 usec per loop\n```\n\n```\npython3.7 -m timeit -s 'from collections.abc import Sequence; l=0' 'isinstance(l, Sequence)'\n500000 loops, best of 5: 534 nsec per loop\n```\n\nOf course, isinstance on a non-ABC is still much faster:\n\n```\npython3.7 -m timeit -s 'from collections.abc import Sequence; l=0' 'isinstance(l, tuple)'\n2000000 loops, best of 5: 168 nsec per loop\n```\n\nbut naturally, it slows down if the argument is a tuple, the more elements you add.  This is probably significantly optimized in Cython too.\n\nGoing back to Python 2, I think nearly half the time is just spent in the lookup into the `WeakSet` cache:\n\n```\npython2.7 -m timeit -s 'from collections import Sequence; l=[]' 't = getattr(l, \"__class__\", None); t is not None and t in Sequence._abc_cache'\n1000000 loops, best of 3: 0.663 usec per loop\n```\n\n(I can't make this test as easily on Python 3.7 since the `_abc_cache` is no longer exposed as  Python attribute).  So the C implementation from Python 3.7 is probably spending the majority of its time in this cache lookup, since it's doing away with some overhead from making a Python method call, the `getattr` call, etc.\n\nI wonder if we couldn't do better.  The use of a `WeakSet` makes sense for the case of classes that are created and later destroyed (more commonly these will be in the negative cache, since you'd be even less likely to register them to an ABC).  That said, it's still pretty uncommon even for classes to be deleted.  For builtin types, and for *most* classes in Sage, classes will never be deleted, and we could just cache them in a fixed-size array (if a new class is registered to the ABC it would have to be realloc'd, but this is rare).  \n\nThough I have doubts whether it's worth micro-optimizing this further.  So I'd lean instead toward just backporting the C implementation of ABCMeta to Python 2, if anything at all.",
    "created_at": "2018-09-06T16:01:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377172",
    "user": "https://github.com/embray"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jdemeyer](#comment%3A15):
> Replying to [@embray](#comment%3A12):
> > Come to think of it, this would be an optimization worth building into Cython, if possible.  Common ABC from Python's stdlib --> exact type checks for common built-in types that implement that ABC, followed by generic `isinstance(...)`.

> 
> But then the case where it's not an instance of the ABC will still be slow.
> 
> I have sometimes been thinking about adding a fast Cython function caching calls to `isinstance(..., some_type)`. If implemented well, this could be very fast. It could be used for ABCs as well as for other common type checks in Sage like `isinstance(..., Element)`. We could take inspiration from `src/sage/structure/coerce_dict.pyx`.

I'm thinking about this again, and wondering what exactly you mean.  I think we really need some convenient `isiterable` and perhaps `issequence` functions, perhaps in `sage.cpython`.  It doesn't necessarily *have* to work with the ABC framework.  Perhaps we can just explicitly enumerate some specific types we care about for these cases (list, tuple, vector, (x)range, ...) which are going to be by far the most common.  On the other hand, this is pretty inflexible, and that's where the ABC system is quite nice as it is very flexible, but that comes at a small cost.

There is also already caching built into ABCs, albeit implemented mostly in pure Python.  Each ABC has a `_abc_cache` attribute, which is a `WeakSet` of all types known to implement that ABC (e.g. `Sequence._abc_cache` on Python 2 contains, by default, `list`, `tuple`, `basestring`, `buffer`, and `xrange`).  There is also a `Sequence._abc_negative_cache` for negative lookups, also  `WeakSet`.  This gets invalidated any time a new ABC is registered.

Some interesting news is that Python 3.7 added a new C implementation of ABCMeta, which makes everything a bit faster.  On Python 2.7:

```
python2.7 -m timeit -s 'from collections import Sequence; l=[]' 'isinstance(l, Sequence)'
```

and on 3.7:


```
python3.7 -m timeit -s 'from collections.abc import Sequence; l=[]' 'isinstance(l, Sequence)'
500000 loops, best of 5: 543 nsec per loop
```

So a little more than twice as fast?

Negative lookups are improved even more:

```
python2.7 -m timeit -s 'from collections import Sequence; l=0' 'isinstance(l, Sequence)'
100000 loops, best of 3: 2.17 usec per loop
```

```
python3.7 -m timeit -s 'from collections.abc import Sequence; l=0' 'isinstance(l, Sequence)'
500000 loops, best of 5: 534 nsec per loop
```

Of course, isinstance on a non-ABC is still much faster:

```
python3.7 -m timeit -s 'from collections.abc import Sequence; l=0' 'isinstance(l, tuple)'
2000000 loops, best of 5: 168 nsec per loop
```

but naturally, it slows down if the argument is a tuple, the more elements you add.  This is probably significantly optimized in Cython too.

Going back to Python 2, I think nearly half the time is just spent in the lookup into the `WeakSet` cache:

```
python2.7 -m timeit -s 'from collections import Sequence; l=[]' 't = getattr(l, "__class__", None); t is not None and t in Sequence._abc_cache'
1000000 loops, best of 3: 0.663 usec per loop
```

(I can't make this test as easily on Python 3.7 since the `_abc_cache` is no longer exposed as  Python attribute).  So the C implementation from Python 3.7 is probably spending the majority of its time in this cache lookup, since it's doing away with some overhead from making a Python method call, the `getattr` call, etc.

I wonder if we couldn't do better.  The use of a `WeakSet` makes sense for the case of classes that are created and later destroyed (more commonly these will be in the negative cache, since you'd be even less likely to register them to an ABC).  That said, it's still pretty uncommon even for classes to be deleted.  For builtin types, and for *most* classes in Sage, classes will never be deleted, and we could just cache them in a fixed-size array (if a new class is registered to the ABC it would have to be realloc'd, but this is rare).  

Though I have doubts whether it's worth micro-optimizing this further.  So I'd lean instead toward just backporting the C implementation of ABCMeta to Python 2, if anything at all.



---

archive/issue_events_340503.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340503"
}
```



---

archive/issue_events_340504.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340504"
}
```



---

archive/issue_comments_377173.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nRetargeting some of my tickets (somewhat optimistically for now).",
    "created_at": "2018-12-28T14:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377173",
    "user": "https://github.com/embray"
}
```

<div id="comment:22" align="right">comment:22</div>

Retargeting some of my tickets (somewhat optimistically for now).



---

archive/issue_events_340505.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:10:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340505"
}
```



---

archive/issue_events_340506.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:10:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340506"
}
```



---

archive/issue_comments_377174.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nMoving all my in-progress tickets to 8.8 milestone.",
    "created_at": "2019-03-25T10:43:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377174",
    "user": "https://github.com/embray"
}
```

<div id="comment:23" align="right">comment:23</div>

Moving all my in-progress tickets to 8.8 milestone.



---

archive/issue_events_340507.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:43:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340507"
}
```



---

archive/issue_events_340508.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:43:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340508"
}
```



---

archive/issue_events_340509.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340509"
}
```



---

archive/issue_events_340510.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340510"
}
```



---

archive/issue_comments_377175.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nTickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377175",
    "user": "https://github.com/embray"
}
```

<div id="comment:24" align="right">comment:24</div>

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_comments_377176.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nTicket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377176",
    "user": "https://github.com/embray"
}
```

<div id="comment:25" align="right">comment:25</div>

Ticket retargeted after milestone closed



---

archive/issue_events_340511.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340511"
}
```



---

archive/issue_events_340512.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340512"
}
```



---

archive/issue_events_340513.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340513"
}
```



---

archive/issue_events_340514.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340514"
}
```



---

archive/issue_comments_377177.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nBatch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377177",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_377178.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n This simplifies some code that treats `Vector` distinctly from `list` and `tuple`.  To be clear, in this case we are explicitly treating the `FreeModuleElement` type, and not the abstract `Vector` type which does not meet these requirements, but that's okay since `FreeModuleElement` implements any concrete vector space elements.\n \n By convention, this always imports `collections.Sequence` as `SequenceABC` so as to not confuse it with Sage's `Sequence` class.\n+\n+See also: #26769 Add an `issequence` utility to check for list, tuple, and other compatible objects\n``````\n",
    "created_at": "2020-09-02T01:46:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377178",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 This simplifies some code that treats `Vector` distinctly from `list` and `tuple`.  To be clear, in this case we are explicitly treating the `FreeModuleElement` type, and not the abstract `Vector` type which does not meet these requirements, but that's okay since `FreeModuleElement` implements any concrete vector space elements.
 
 By convention, this always imports `collections.Sequence` as `SequenceABC` so as to not confuse it with Sage's `Sequence` class.
+
+See also: #26769 Add an `issequence` utility to check for list, tuple, and other compatible objects
``````




---

archive/issue_comments_377179.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThe relation between this and #26769 is slightly orthogonal since the `PySequence_Check` function used in `issequence` does not, I believe, check if an object belongs to the `Sequence` ABC.  Perhaps it should, though I think #26769 was born partly out of Jeroen's complaint here that checking `isinstance(..., Sequence)` is too slow.  But I think that's also improved a lot in Python 3.",
    "created_at": "2020-09-02T09:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377179",
    "user": "https://github.com/embray"
}
```

<div id="comment:28" align="right">comment:28</div>

The relation between this and #26769 is slightly orthogonal since the `PySequence_Check` function used in `issequence` does not, I believe, check if an object belongs to the `Sequence` ABC.  Perhaps it should, though I think #26769 was born partly out of Jeroen's complaint here that checking `isinstance(..., Sequence)` is too slow.  But I think that's also improved a lot in Python 3.



---

archive/issue_events_340515.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340515"
}
```



---

archive/issue_events_340516.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340516"
}
```



---

archive/issue_events_340517.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340517"
}
```



---

archive/issue_events_340518.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340518"
}
```



---

archive/issue_comments_377180.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377180",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_377181.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24815#issuecomment-377181",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_340519.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340519"
}
```



---

archive/issue_events_340520.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340520"
}
```



---

archive/issue_events_340521.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340521"
}
```



---

archive/issue_events_340522.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340522"
}
```



---

archive/issue_events_340523.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340523"
}
```



---

archive/issue_events_340524.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340524"
}
```



---

archive/issue_events_340525.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340525"
}
```



---

archive/issue_events_340526.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340526"
}
```



---

archive/issue_events_340527.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340527"
}
```



---

archive/issue_events_340528.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24815",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24815#event-340528"
}
```
