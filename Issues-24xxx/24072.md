# Issue 24072: Disallow positive characteristic in the symbolic ring

archive/issues_023835.json:
```json
{
    "body": "Elements of positive characteristic in the symbolic ring are complete nonsense\n\n```\nsage: x = SR.var('x')\nsage: f(x) = exp(GF(3).one() * x)\nsage: f\nx |--> e^x\nsage: bool(f(x) == exp(x))\nTrue\nsage: f(3*x)\n1\n```\nor\n\n```\nsage: solve(x^2 == 2, [x])\n[x == -sqrt(2), x == sqrt(2)]\nsage: solve(x^2 == GF(3)(2), [x])\n[x == -sqrt(2), x == sqrt(2)]\n```\n\nMore dramatically, it leads to segmentation faults\n\n```python\nsage: x = polygen(GF(3))\nsage: a = SR.var('a')\nsage: (2*x + 1) * a\nsegmentation fault\n```\nEven going through conversion\n\n```python\nsage: p = SR(2*x + 1)\nsage: p * a\nsegmentation fault\n```\n\nWe simply disallow wrapping of element of positive characteristic in `SR`.\n\nSolve #18787 and #21391\n\nOriginal reports for the segfault:\n- [Ask](https://ask.sagemath.org/question/39204/segmentation-fault-when-multiplying-by-variable/)\n- [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/qSYOt22t58o)\n\nKeywords: polynomial, symbolics\n\nBranch/Commit: da8b056e2d506516c80c19e2ffd002807310b533\n\nReviewer: Ralf Stephan, Travis Scrimshaw\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24072\n\n",
    "closed_at": "2017-10-29T10:32:22Z",
    "created_at": "2017-10-20T07:09:04Z",
    "labels": [
        "component: commutative algebra",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Disallow positive characteristic in the symbolic ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24072",
    "user": "https://github.com/bgrenet"
}
```
Elements of positive characteristic in the symbolic ring are complete nonsense

```
sage: x = SR.var('x')
sage: f(x) = exp(GF(3).one() * x)
sage: f
x |--> e^x
sage: bool(f(x) == exp(x))
True
sage: f(3*x)
1
```
or

```
sage: solve(x^2 == 2, [x])
[x == -sqrt(2), x == sqrt(2)]
sage: solve(x^2 == GF(3)(2), [x])
[x == -sqrt(2), x == sqrt(2)]
```

More dramatically, it leads to segmentation faults

```python
sage: x = polygen(GF(3))
sage: a = SR.var('a')
sage: (2*x + 1) * a
segmentation fault
```
Even going through conversion

```python
sage: p = SR(2*x + 1)
sage: p * a
segmentation fault
```

We simply disallow wrapping of element of positive characteristic in `SR`.

Solve #18787 and #21391

Original reports for the segfault:
- [Ask](https://ask.sagemath.org/question/39204/segmentation-fault-when-multiplying-by-variable/)
- [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/qSYOt22t58o)

Keywords: polynomial, symbolics

Branch/Commit: da8b056e2d506516c80c19e2ffd002807310b533

Reviewer: Ralf Stephan, Travis Scrimshaw

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24072





---

archive/issue_comments_333488.json:
```json
{
    "body": "<a id='comment:1'></a>The real bug is that `SR(sigma)` succeeds (and returns something broken).\nIt should just fail, and then `*` will fail too, as it should.",
    "created_at": "2017-10-20T08:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333488",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>The real bug is that `SR(sigma)` succeeds (and returns something broken).
It should just fail, and then `*` will fail too, as it should.



---

archive/issue_comments_333489.json:
```json
{
    "body": "Changing keywords from \"polynomial\" to \"polynomial, symbolics\".",
    "created_at": "2017-10-20T19:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333489",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "polynomial" to "polynomial, symbolics".



---

archive/issue_comments_333490.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-21T09:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333490",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_333491.json:
```json
{
    "body": "<a id='comment:4'></a>A branch where SR does not accept anymore positive characteristic... let see what the patchbot has to say.\n\n---\nNew commits:",
    "created_at": "2017-10-21T09:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333491",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>A branch where SR does not accept anymore positive characteristic... let see what the patchbot has to say.

---
New commits:



---

archive/issue_comments_333492.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-21T11:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333493.json:
```json
{
    "body": "<a id='comment:7'></a>I think I fixed all doctests!",
    "created_at": "2017-10-21T11:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333493",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>I think I fixed all doctests!



---

archive/issue_comments_333494.json:
```json
{
    "body": "<a id='comment:10'></a>What a relief, thanks for your work.",
    "created_at": "2017-10-21T13:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333494",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>What a relief, thanks for your work.



---

archive/issue_comments_333495.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-21T13:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333495",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333496.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-10-21T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333496",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_333497.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-10-21T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_333498.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-21T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333498",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333499.json:
```json
{
    "body": "<a id='comment:12'></a>A tiny change for py3 syntax (patchbot complaint). Setting back to positive review...",
    "created_at": "2017-10-21T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333499",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>A tiny change for py3 syntax (patchbot complaint). Setting back to positive review...



---

archive/issue_comments_333500.json:
```json
{
    "body": "<a id='comment:13'></a>Does this mean that #21391 can now be closed as duplicate?",
    "created_at": "2017-10-21T17:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333500",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>Does this mean that #21391 can now be closed as duplicate?



---

archive/issue_comments_333501.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-21T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333501",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_333502.json:
```json
{
    "body": "<a id='comment:14'></a>Merge conflict",
    "created_at": "2017-10-21T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333502",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>Merge conflict



---

archive/issue_comments_333503.json:
```json
{
    "body": "<a id='comment:15'></a>Volker, can you provide more information?",
    "created_at": "2017-10-21T20:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333503",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>Volker, can you provide more information?



---

archive/issue_comments_333504.json:
```json
{
    "body": "<a id='comment:17'></a>Hmm, I guess, look at https://github.com/vbraun/sage/tree/develop ?",
    "created_at": "2017-10-21T20:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333504",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>Hmm, I guess, look at https://github.com/vbraun/sage/tree/develop ?



---

archive/issue_comments_333505.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-22T18:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_333506.json:
```json
{
    "body": "<a id='comment:19'></a>rebased on 8.1.beta9",
    "created_at": "2017-10-22T18:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333506",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>rebased on 8.1.beta9



---

archive/issue_comments_333507.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-22T18:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333507",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_333508.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-22T18:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333508",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_333509.json:
```json
{
    "body": "<a id='comment:21'></a>ping?",
    "created_at": "2017-10-23T19:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333509",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>ping?



---

archive/issue_comments_333510.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-23T22:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333510",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333511.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-29T10:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24072#issuecomment-333511",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_061145.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-29T10:32:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24072",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24072#event-61145"
}
```
