# Issue 24467: Refactor IntegerMulAction

archive/issues_024230.json:
```json
{
    "body": "Refactor `IntegerMulAction` in preparation for #24247:\n\n1. Add an abstract base class `IntegerAction` which will also be used to implement `IntegerPowAction` in #24247.\n\n2. Add a new helper function `parent_is_integers` to check if some type/parent represents the integers.\n\n3. Instead of the hacks in `discover_action` and `verify_action` involving an explicit `IntegerMulAction` check, return an `IntegerMulAction` for anything satisfying `parent_is_integers()`.\n\n**Branch/Commit:** [a35986207005594e923ad97e12cb468d0885dfb4](https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/24467\n\n",
    "closed_at": "2018-01-14T10:14:23Z",
    "created_at": "2018-01-03T16:53:52Z",
    "labels": [
        "component: coercion",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Refactor IntegerMulAction",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24467",
    "user": "https://github.com/jdemeyer"
}
```
Refactor `IntegerMulAction` in preparation for #24247:

1. Add an abstract base class `IntegerAction` which will also be used to implement `IntegerPowAction` in #24247.

2. Add a new helper function `parent_is_integers` to check if some type/parent represents the integers.

3. Instead of the hacks in `discover_action` and `verify_action` involving an explicit `IntegerMulAction` check, return an `IntegerMulAction` for anything satisfying `parent_is_integers()`.

**Branch/Commit:** [a35986207005594e923ad97e12cb468d0885dfb4](https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4)

**Reviewer:** Travis Scrimshaw

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/24467





---

archive/issue_comments_374585.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/ticket/24467](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/24467)",
    "created_at": "2018-01-03T16:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374585",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/ticket/24467](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/24467)



---

archive/issue_events_220980.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-03T16:55:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24467#event-220980"
}
```



---

archive/issue_comments_374586.json:
```json
{
    "body": "**Commit:** [85cabe71cb8a3f034b99a71e65c5329b79c2a8b7](https://github.com/sagemath/sagetrac-mirror/commit/85cabe71cb8a3f034b99a71e65c5329b79c2a8b7)",
    "created_at": "2018-01-03T16:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374586",
    "user": "https://github.com/jdemeyer"
}
```

**Commit:** [85cabe71cb8a3f034b99a71e65c5329b79c2a8b7](https://github.com/sagemath/sagetrac-mirror/commit/85cabe71cb8a3f034b99a71e65c5329b79c2a8b7)



---

archive/issue_comments_374587.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85cabe71cb8a3f034b99a71e65c5329b79c2a8b7\">85cabe7</a></td><td><code>Refactor IntegerMulAction</code></td></tr></table>\n",
    "created_at": "2018-01-03T16:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374587",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85cabe71cb8a3f034b99a71e65c5329b79c2a8b7">85cabe7</a></td><td><code>Refactor IntegerMulAction</code></td></tr></table>




---

archive/issue_comments_374588.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2d60efa250eb7806f67f313738d67b3288577d3\">a2d60ef</a></td><td><code>Also verify IntegerAction instances</code></td></tr></table>\n",
    "created_at": "2018-01-04T11:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2d60efa250eb7806f67f313738d67b3288577d3">a2d60ef</a></td><td><code>Also verify IntegerAction instances</code></td></tr></table>




---

archive/issue_comments_374589.json:
```json
{
    "body": "**Changing commit** from \"[85cabe71cb8a3f034b99a71e65c5329b79c2a8b7](https://github.com/sagemath/sagetrac-mirror/commit/85cabe71cb8a3f034b99a71e65c5329b79c2a8b7)\" to \"[a2d60efa250eb7806f67f313738d67b3288577d3](https://github.com/sagemath/sagetrac-mirror/commit/a2d60efa250eb7806f67f313738d67b3288577d3)\".",
    "created_at": "2018-01-04T11:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[85cabe71cb8a3f034b99a71e65c5329b79c2a8b7](https://github.com/sagemath/sagetrac-mirror/commit/85cabe71cb8a3f034b99a71e65c5329b79c2a8b7)" to "[a2d60efa250eb7806f67f313738d67b3288577d3](https://github.com/sagemath/sagetrac-mirror/commit/a2d60efa250eb7806f67f313738d67b3288577d3)".



---

archive/issue_comments_374590.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n 2. Add a new helper function `parent_is_integers` to check if some type/parent represents the integers.\n \n-3. Instead of the hack in `discover_action` involving an explicit `IntegerMulAction` check, return an `IntegerMulAction` for anything satisfying `parent_is_integers()`.\n+3. Instead of the hacks in `discover_action` and `verify_action` involving an explicit `IntegerMulAction` check, return an `IntegerMulAction` for anything satisfying `parent_is_integers()`.\n``````\n",
    "created_at": "2018-01-04T11:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374590",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 2. Add a new helper function `parent_is_integers` to check if some type/parent represents the integers.
 
-3. Instead of the hack in `discover_action` involving an explicit `IntegerMulAction` check, return an `IntegerMulAction` for anything satisfying `parent_is_integers()`.
+3. Instead of the hacks in `discover_action` and `verify_action` involving an explicit `IntegerMulAction` check, return an `IntegerMulAction` for anything satisfying `parent_is_integers()`.
``````




---

archive/issue_comments_374591.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2018-01-08T01:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374591",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_374592.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe `\u00b7` is not ascii nor latex: `n \u00b7 a = a + a + ... + a`. So if you change that to `\\cdot` (personally, I would also change the `...` to `\\cdots`), then you can set a positive review on my behalf.",
    "created_at": "2018-01-08T01:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374592",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
The `·` is not ascii nor latex: `n · a = a + a + ... + a`. So if you change that to `\cdot` (personally, I would also change the `...` to `\cdots`), then you can set a positive review on my behalf.



---

archive/issue_comments_374593.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [tscrim](#comment%3A5):\n> The `\u00b7` is not ascii nor latex\n\n\nIs that a problem really? The documentation builds fine and I think that `\u00b7` is more readable than `\\cdot` in text mode.",
    "created_at": "2018-01-08T08:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374593",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Replying to [tscrim](#comment%3A5):
> The `·` is not ascii nor latex


Is that a problem really? The documentation builds fine and I think that `·` is more readable than `\cdot` in text mode.



---

archive/issue_comments_374594.json:
```json
{
    "body": "**Changing commit** from \"[a2d60efa250eb7806f67f313738d67b3288577d3](https://github.com/sagemath/sagetrac-mirror/commit/a2d60efa250eb7806f67f313738d67b3288577d3)\" to \"[a35986207005594e923ad97e12cb468d0885dfb4](https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4)\".",
    "created_at": "2018-01-08T08:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374594",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a2d60efa250eb7806f67f313738d67b3288577d3](https://github.com/sagemath/sagetrac-mirror/commit/a2d60efa250eb7806f67f313738d67b3288577d3)" to "[a35986207005594e923ad97e12cb468d0885dfb4](https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4)".



---

archive/issue_comments_374595.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4\">a359862</a></td><td><code>Use \\cdot instead of \u00b7</code></td></tr></table>\n",
    "created_at": "2018-01-08T08:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374595",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4">a359862</a></td><td><code>Use \cdot instead of ·</code></td></tr></table>




---

archive/issue_events_220981.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T08:30:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24467#event-220981"
}
```



---

archive/issue_events_220982.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T08:30:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24467#event-220982"
}
```



---

archive/issue_comments_374596.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jdemeyer](#comment%3A6):\n> Replying to [tscrim](#comment%3A5):\n> > The `\u00b7` is not ascii nor latex\n\n> \n> Is that a problem really? The documentation builds fine and I think that `\u00b7` is more readable than `\\cdot` in text mode.\n\n\nWith the non-ascii characters, the pdf docs tend to have difficulty if the encoding is not declared (in particular, the non-ascii hyphen comes to mind). What we probably should do is add a bunch of the unicode versions of certain latex commands to the console doc replacer since we generally assume terminals support unicode.\n\nThanks for the change.",
    "created_at": "2018-01-08T15:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374596",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Replying to [jdemeyer](#comment%3A6):
> Replying to [tscrim](#comment%3A5):
> > The `·` is not ascii nor latex

> 
> Is that a problem really? The documentation builds fine and I think that `·` is more readable than `\cdot` in text mode.


With the non-ascii characters, the pdf docs tend to have difficulty if the encoding is not declared (in particular, the non-ascii hyphen comes to mind). What we probably should do is add a bunch of the unicode versions of certain latex commands to the console doc replacer since we generally assume terminals support unicode.

Thanks for the change.



---

archive/issue_comments_374597.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [tscrim](#comment%3A9):\n> What we probably should do is add a bunch of the unicode versions of certain latex commands to the console doc replacer since we generally assume terminals support unicode.\n\n\nNo, we do the opposite: replace certain Unicode characters by latex when building the PDF docs. In `src/doc/common/conf.py` you will find for example\n\n```\n\\DeclareUnicodeCharacter{00B7}{\\cdot}\n```\nsaying that `\u00b7` should be replaced by `\\cdot`. So `\u00b7` in docstrings should work just fine.",
    "created_at": "2018-01-08T15:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374597",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Replying to [tscrim](#comment%3A9):
> What we probably should do is add a bunch of the unicode versions of certain latex commands to the console doc replacer since we generally assume terminals support unicode.


No, we do the opposite: replace certain Unicode characters by latex when building the PDF docs. In `src/doc/common/conf.py` you will find for example

```
\DeclareUnicodeCharacter{00B7}{\cdot}
```
saying that `·` should be replaced by `\cdot`. So `·` in docstrings should work just fine.



---

archive/issue_comments_374598.json:
```json
{
    "body": "<a id='comment:11'></a>\nI see. I wasn't aware of that. Thank you.",
    "created_at": "2018-01-08T16:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374598",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>
I see. I wasn't aware of that. Thank you.



---

archive/issue_events_220983.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:14:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24467#event-220983"
}
```



---

archive/issue_events_220984.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:14:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24467#event-220984"
}
```



---

archive/issue_comments_374599.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/ticket/24467](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/24467)\" to \"[a35986207005594e923ad97e12cb468d0885dfb4](https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4)\".",
    "created_at": "2018-01-14T10:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24467",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24467#issuecomment-374599",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/ticket/24467](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/24467)" to "[a35986207005594e923ad97e12cb468d0885dfb4](https://github.com/sagemath/sagetrac-mirror/commit/a35986207005594e923ad97e12cb468d0885dfb4)".
