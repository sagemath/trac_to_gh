# Issue 24081: Use system curl if possible

archive/issues_023844.json:
```json
{
    "body": "Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.\n\nTo test this branch: run `autoreconf` and then `make`.\n\n**Branch/Commit:** [52f9f840afeaee2f3eea1a38eb7679211da47a86](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** John Palmieri\n\nIssue created by migration from https://trac.sagemath.org/ticket/24081\n\n",
    "closed_at": "2017-11-02T11:06:10Z",
    "created_at": "2017-10-20T18:00:39Z",
    "labels": [
        "component: build: configure",
        "blocker",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Use system curl if possible",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24081",
    "user": "https://github.com/jhpalmieri"
}
```
Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.

To test this branch: run `autoreconf` and then `make`.

**Branch/Commit:** [52f9f840afeaee2f3eea1a38eb7679211da47a86](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)

**Reviewer:** Jeroen Demeyer

**Author:** John Palmieri

Issue created by migration from https://trac.sagemath.org/ticket/24081





---

archive/issue_comments_434890.json:
```json
{
    "body": "<a id='comment:1'></a>\nAs far as I can tell, curl is only used by R. With the branch here, R finds the system's curl and builds successfully with it.",
    "created_at": "2017-10-20T18:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434890",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
As far as I can tell, curl is only used by R. With the branch here, R finds the system's curl and builds successfully with it.



---

archive/issue_comments_434891.json:
```json
{
    "body": "**Branch:** [u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)",
    "created_at": "2017-10-20T18:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434891",
    "user": "https://github.com/jhpalmieri"
}
```

**Branch:** [u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)



---

archive/issue_comments_434892.json:
```json
{
    "body": "**Commit:** [28a659a39d66c437a6ba1abe4551b3e0e5fb37e3](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)",
    "created_at": "2017-10-20T18:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434892",
    "user": "https://github.com/jhpalmieri"
}
```

**Commit:** [28a659a39d66c437a6ba1abe4551b3e0e5fb37e3](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)



---

archive/issue_comments_434893.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2017-10-20T18:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434893",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_434894.json:
```json
{
    "body": "<a id='comment:3'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3\">28a659a</a></td><td><code>trac 24081: do not build curl on OS X.</code></td></tr></table>\n",
    "created_at": "2017-10-20T18:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434894",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3">28a659a</a></td><td><code>trac 24081: do not build curl on OS X.</code></td></tr></table>




---

archive/issue_comments_434895.json:
```json
{
    "body": "<a id='comment:4'></a>\nWe could instead test for the curl version, and if not 7.22 or greater (because that's what R wants), build curl. I have no idea if there are old OS X systems with curl versions predating 7.22.",
    "created_at": "2017-10-20T18:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434895",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
We could instead test for the curl version, and if not 7.22 or greater (because that's what R wants), build curl. I have no idea if there are old OS X systems with curl versions predating 7.22.



---

archive/issue_comments_434896.json:
```json
{
    "body": "<a id='comment:5'></a>\nIn fact this might be easy: `curl-config --checkfor 7.22` should do it. Is it worth it?",
    "created_at": "2017-10-20T18:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434896",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
In fact this might be easy: `curl-config --checkfor 7.22` should do it. Is it worth it?



---

archive/issue_comments_434897.json:
```json
{
    "body": "<a id='comment:6'></a>\nSomething like this:\n\n```diff\ndiff --git a/build/pkgs/curl/spkg-install b/build/pkgs/curl/spkg-install\nindex 1259cb7d6c..49a49f2644 100644\n--- a/build/pkgs/curl/spkg-install\n+++ b/build/pkgs/curl/spkg-install\n@@ -13,8 +13,14 @@ if [ \"$SAGE_FAT_BINARY\" = yes ]; then\n fi\n \n if [ \"$UNAME\" = \"Darwin\" ]; then\n-   echo \"Skipping build of curl on OS X: using system's version instead.\"\n-   exit 0\n+    curl-config --checkfor 7.22 \\\n+        && echo \"Skipping build of curl on OS X: using system's version instead.\" \\\n+        && exit 0\n+   if [ $MACOSX_VERSION -ge 16 ]; then\n+       echo \"OS X 10.$[$MACOSX_VERSION-4] Building with clang and --with-darwinssl.\"\n+       CC=clang\n+       CURL_CONFIGURE=\"--with-darwinssl $CURL_CONFIGURE\"\n+   fi\n fi\n \n ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" \\\n```",
    "created_at": "2017-10-20T18:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434897",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
Something like this:

```diff
diff --git a/build/pkgs/curl/spkg-install b/build/pkgs/curl/spkg-install
index 1259cb7d6c..49a49f2644 100644
--- a/build/pkgs/curl/spkg-install
+++ b/build/pkgs/curl/spkg-install
@@ -13,8 +13,14 @@ if [ "$SAGE_FAT_BINARY" = yes ]; then
 fi
 
 if [ "$UNAME" = "Darwin" ]; then
-   echo "Skipping build of curl on OS X: using system's version instead."
-   exit 0
+    curl-config --checkfor 7.22 \
+        && echo "Skipping build of curl on OS X: using system's version instead." \
+        && exit 0
+   if [ $MACOSX_VERSION -ge 16 ]; then
+       echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang and --with-darwinssl."
+       CC=clang
+       CURL_CONFIGURE="--with-darwinssl $CURL_CONFIGURE"
+   fi
 fi
 
 ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" \
```



---

archive/issue_comments_434898.json:
```json
{
    "body": "<a id='comment:7'></a>\nThen we would also have to figure out what to do in `spkg-check`.",
    "created_at": "2017-10-20T18:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434898",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
Then we would also have to figure out what to do in `spkg-check`.



---

archive/issue_comments_434899.json:
```json
{
    "body": "<a id='comment:8'></a>\nBy the way, the optional package `cmake` depends on curl, too, and it also builds using the system library.",
    "created_at": "2017-10-20T19:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434899",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
By the way, the optional package `cmake` depends on curl, too, and it also builds using the system library.



---

archive/issue_comments_434900.json:
```json
{
    "body": "<a id='comment:9'></a>\nPreferably, these things are handled in `configure.ac` now. See `git` and `yasm` for examples.",
    "created_at": "2017-10-21T07:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434900",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Preferably, these things are handled in `configure.ac` now. See `git` and `yasm` for examples.



---

archive/issue_comments_434901.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-10-21T07:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434901",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_434902.json:
```json
{
    "body": "<a id='comment:10'></a>\nI don't know autoconf syntax. Is this right?\n\n```diff\ndiff --git a/configure.ac b/configure.ac\nindex 9fa143b319..69446bf568 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -315,6 +315,14 @@ AC_CACHE_CHECK([for yasm], [ac_cv_path_YASM],\n         [need_to_install_yasm=yes; ac_cv_path_YASM=no])],\n         [ac_cv_path_YASM=\"not needed for $host_cpu\"]))\n \n+# Only install curl if we cannot find version 7.22 or later, since\n+# that is what R needs.\n+need_to_install_curl=no\n+AC_CACHE_CHECK([for curl], [ac_cv_path_CURL], [\n+    AC_PATH_PROGS_FEATURE_CHECK(CURL, [curl],\n+    [${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}],\n+    [need_to_install_curl=yes; ac_cv_path_CURL=no])])\n+\n ###############################################################################\n # Check C/C++/Fortran compilers\n ###############################################################################\n```\nIt seems to work, for what that's worth. Also, should we check for a curl installation in general as this does, or just on Darwin?",
    "created_at": "2017-10-21T21:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434902",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>
I don't know autoconf syntax. Is this right?

```diff
diff --git a/configure.ac b/configure.ac
index 9fa143b319..69446bf568 100644
--- a/configure.ac
+++ b/configure.ac
@@ -315,6 +315,14 @@ AC_CACHE_CHECK([for yasm], [ac_cv_path_YASM],
         [need_to_install_yasm=yes; ac_cv_path_YASM=no])],
         [ac_cv_path_YASM="not needed for $host_cpu"]))
 
+# Only install curl if we cannot find version 7.22 or later, since
+# that is what R needs.
+need_to_install_curl=no
+AC_CACHE_CHECK([for curl], [ac_cv_path_CURL], [
+    AC_PATH_PROGS_FEATURE_CHECK(CURL, [curl],
+    [${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}],
+    [need_to_install_curl=yes; ac_cv_path_CURL=no])])
+
 ###############################################################################
 # Check C/C++/Fortran compilers
 ###############################################################################
```
It seems to work, for what that's worth. Also, should we check for a curl installation in general as this does, or just on Darwin?



---

archive/issue_comments_434903.json:
```json
{
    "body": "<a id='comment:11'></a>\nBy the way, right after I posted this snippet, I read the top of the file where it says to check for libraries later, so I moved the check to just before \"Check header files\".",
    "created_at": "2017-10-21T21:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434903",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
By the way, right after I posted this snippet, I read the top of the file where it says to check for libraries later, so I moved the check to just before "Check header files".



---

archive/issue_comments_434904.json:
```json
{
    "body": "<a id='comment:12'></a>\nSince the OS X system curl has `SSL` as a feature, I wonder if this will also solve the problem with SSL support for `R`.",
    "created_at": "2017-10-23T14:53:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434904",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
Since the OS X system curl has `SSL` as a feature, I wonder if this will also solve the problem with SSL support for `R`.



---

archive/issue_comments_434905.json:
```json
{
    "body": "**Changing commit** from \"[28a659a39d66c437a6ba1abe4551b3e0e5fb37e3](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)\" to \"[c06d1ad281de69c6d94074dd462cb69804de0639](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)\".",
    "created_at": "2017-10-24T00:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[28a659a39d66c437a6ba1abe4551b3e0e5fb37e3](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)" to "[c06d1ad281de69c6d94074dd462cb69804de0639](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)".



---

archive/issue_comments_434906.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639\">c06d1ad</a></td><td><code>trac 24081: do not build curl if installed version is 7.22 or later.</code></td></tr></table>\n",
    "created_at": "2017-10-24T00:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639">c06d1ad</a></td><td><code>trac 24081: do not build curl if installed version is 7.22 or later.</code></td></tr></table>




---

archive/issue_comments_434907.json:
```json
{
    "body": "<a id='comment:14'></a>\nThis works for me. It checks regardless of the OS for `curl` version 7.22 or later. Or should it be OS X only?",
    "created_at": "2017-10-24T00:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434907",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
This works for me. It checks regardless of the OS for `curl` version 7.22 or later. Or should it be OS X only?



---

archive/issue_comments_434908.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-10-24T00:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434908",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_434909.json:
```json
{
    "body": "<a id='comment:15'></a>\nWe could also add a check like `curl-config --features | grep SSL` to test for SSL support.",
    "created_at": "2017-10-24T00:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434909",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
We could also add a check like `curl-config --features | grep SSL` to test for SSL support.



---

archive/issue_comments_434910.json:
```json
{
    "body": "<a id='comment:16'></a>\nIf this is true then doesn't this obviate a lot of the sturm und drang concerning OpenSSL support, especially on OSX?",
    "created_at": "2017-10-24T14:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434910",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
If this is true then doesn't this obviate a lot of the sturm und drang concerning OpenSSL support, especially on OSX?



---

archive/issue_comments_434911.json:
```json
{
    "body": "<a id='comment:17'></a>\nSee [comment:12](#comment%3A12). I also posted something along these lines to the sage-devel thread a day or two ago.",
    "created_at": "2017-10-24T14:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434911",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>
See [comment:12](#comment%3A12). I also posted something along these lines to the sage-devel thread a day or two ago.



---

archive/issue_comments_434912.json:
```json
{
    "body": "<a id='comment:18'></a>\nI'm upgrading this to a blocker since something needs to be done with curl to build on the most recent OS X.",
    "created_at": "2017-10-24T14:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434912",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
I'm upgrading this to a blocker since something needs to be done with curl to build on the most recent OS X.



---

archive/issue_comments_434913.json:
```json
{
    "body": "<a id='comment:19'></a>\nThere should be an accompanying `configure-VERSION.tar.gz` file, but I don't know how to produce that. So to test this, run `autoreconf` and then `make`...",
    "created_at": "2017-10-25T05:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434913",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
There should be an accompanying `configure-VERSION.tar.gz` file, but I don't know how to produce that. So to test this, run `autoreconf` and then `make`...



---

archive/issue_comments_434914.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.\n+\n+To test this branch: run `autoreconf` and then `make`.\n``````\n",
    "created_at": "2017-10-25T05:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434914",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.
+
+To test this branch: run `autoreconf` and then `make`.
``````




---

archive/issue_comments_434915.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jhpalmieri](#comment%3A19):\n> There should be an accompanying `configure-VERSION.tar.gz` file\n\n\nOnly if the changes to `configure.ac` are *required* to build Sage with this branch, which is not the case here. In fact, such a tarball is never needed for tickets which change only `configure.ac` and nothing else.",
    "created_at": "2017-10-25T08:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434915",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Replying to [jhpalmieri](#comment%3A19):
> There should be an accompanying `configure-VERSION.tar.gz` file


Only if the changes to `configure.ac` are *required* to build Sage with this branch, which is not the case here. In fact, such a tarball is never needed for tickets which change only `configure.ac` and nothing else.



---

archive/issue_comments_434916.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2017-10-25T08:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434916",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_434917.json:
```json
{
    "body": "<a id='comment:21'></a>\nDoes Sage require the curl library or the curl program? The comment says \"Check libraries\" but the code checks the program...",
    "created_at": "2017-10-25T08:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434917",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Does Sage require the curl library or the curl program? The comment says "Check libraries" but the code checks the program...



---

archive/issue_comments_434918.json:
```json
{
    "body": "<a id='comment:22'></a>\nR checks\n\n```\nchecking for curl-config... /home/jdemeyer/sage/local/bin/curl-config\nchecking libcurl version ... 7.53.1\nchecking curl/curl.h usability... yes\nchecking curl/curl.h presence... yes\nchecking for curl/curl.h... yes\nchecking if libcurl is version 7 and >= 7.22.0... yes\n```\nSo you should at least check the header `curl/curl.h` too.",
    "created_at": "2017-10-25T08:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434918",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
R checks

```
checking for curl-config... /home/jdemeyer/sage/local/bin/curl-config
checking libcurl version ... 7.53.1
checking curl/curl.h usability... yes
checking curl/curl.h presence... yes
checking for curl/curl.h... yes
checking if libcurl is version 7 and >= 7.22.0... yes
```
So you should at least check the header `curl/curl.h` too.



---

archive/issue_comments_434919.json:
```json
{
    "body": "**Changing status** from needs_info to needs_work.",
    "created_at": "2017-10-25T08:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434919",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_info to needs_work.



---

archive/issue_comments_434920.json:
```json
{
    "body": "<a id='comment:23'></a>\nThe page https://curl.haxx.se/libcurl/using/curl-config.html says that `curl-config` (which is what is in the code) gets information about `libcurl`. We can also check for curl/curl.h, though.",
    "created_at": "2017-10-25T14:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434920",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
The page https://curl.haxx.se/libcurl/using/curl-config.html says that `curl-config` (which is what is in the code) gets information about `libcurl`. We can also check for curl/curl.h, though.



---

archive/issue_comments_434921.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jhpalmieri](#comment%3A23):\n> We can also check for curl/curl.h, though.\n\n\nSee https://www.gnu.org/software/autoconf/manual/autoconf-2.69/html_node/Generic-Headers.html",
    "created_at": "2017-10-25T14:45:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434921",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [jhpalmieri](#comment%3A23):
> We can also check for curl/curl.h, though.


See https://www.gnu.org/software/autoconf/manual/autoconf-2.69/html_node/Generic-Headers.html



---

archive/issue_comments_434922.json:
```json
{
    "body": "**Changing commit** from \"[c06d1ad281de69c6d94074dd462cb69804de0639](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)\" to \"[beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)\".",
    "created_at": "2017-10-25T14:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c06d1ad281de69c6d94074dd462cb69804de0639](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)" to "[beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)".



---

archive/issue_comments_434923.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a\">beab3b9</a></td><td><code>trac 24081: also check for curl/curl.h</code></td></tr></table>\n",
    "created_at": "2017-10-25T14:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a">beab3b9</a></td><td><code>trac 24081: also check for curl/curl.h</code></td></tr></table>




---

archive/issue_comments_434924.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-10-25T14:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434924",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_434925.json:
```json
{
    "body": "<a id='comment:27'></a>\nRather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.",
    "created_at": "2017-10-25T22:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434925",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>
Rather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.



---

archive/issue_comments_434926.json:
```json
{
    "body": "<a id='comment:28'></a>\nI don't think that you need to set `ac_cv_path_CURL` in the header check.",
    "created_at": "2017-10-31T10:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434926",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
I don't think that you need to set `ac_cv_path_CURL` in the header check.



---

archive/issue_comments_434927.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)\" to \"[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)\".",
    "created_at": "2017-10-31T10:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434927",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)" to "[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)".



---

archive/issue_comments_434928.json:
```json
{
    "body": "**Changing commit** from \"[beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)\" to \"[52f9f840afeaee2f3eea1a38eb7679211da47a86](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)\".",
    "created_at": "2017-10-31T10:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434928",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)" to "[52f9f840afeaee2f3eea1a38eb7679211da47a86](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)".



---

archive/issue_comments_434929.json:
```json
{
    "body": "<a id='comment:30'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86\">52f9f84</a></td><td><code>Minor fixes</code></td></tr></table>\n",
    "created_at": "2017-10-31T10:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434929",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86">52f9f84</a></td><td><code>Minor fixes</code></td></tr></table>




---

archive/issue_comments_434930.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-10-31T10:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434930",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_069844.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "rename": {
        "from": "Disable building Curl on OS X",
        "to": "Use system curl if possible"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24081#event-69844"
}
```



---

archive/issue_comments_434931.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2017-10-31T10:52:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434931",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_434932.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [jhpalmieri](#comment%3A27):\n> Rather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.\n\n\nLet's try the simple version first. It would be quite unlikely that `curl-config` exists but the library not.",
    "created_at": "2017-10-31T10:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434932",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
Replying to [jhpalmieri](#comment%3A27):
> Rather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.


Let's try the simple version first. It would be quite unlikely that `curl-config` exists but the library not.



---

archive/issue_comments_434933.json:
```json
{
    "body": "<a id='comment:34'></a>\nGreat, thanks very much!",
    "created_at": "2017-10-31T14:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434933",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
Great, thanks very much!



---

archive/issue_comments_434934.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)\" to \"[52f9f840afeaee2f3eea1a38eb7679211da47a86](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)\".",
    "created_at": "2017-11-02T11:06:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24081#issuecomment-434934",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)" to "[52f9f840afeaee2f3eea1a38eb7679211da47a86](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)".



---

archive/issue_events_069845.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-11-02T11:06:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24081",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24081#event-69845"
}
```
