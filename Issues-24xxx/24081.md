# Issue 24081: Use system curl if possible

archive/issues_023844.json:
```json
{
    "assignees": [],
    "body": "Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.\n\nTo test this branch: run `autoreconf` and then `make`.\n\nBranch/Commit: **[52f9f84](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **John Palmieri**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24081_\n\n",
    "closed_at": "2017-11-02T11:06:10Z",
    "created_at": "2017-10-20T18:00:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Use system curl if possible",
    "type": "issue",
    "updated_at": "2017-11-02T11:06:10Z",
    "url": "https://github.com/sagemath/sage/issues/24081",
    "user": "https://github.com/jhpalmieri"
}
```
Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.

To test this branch: run `autoreconf` and then `make`.

Branch/Commit: **[52f9f84](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)**

Reviewer: **Jeroen Demeyer**

Author: **John Palmieri**

_Issue created by migration from https://trac.sagemath.org/ticket/24081_





---

archive/issue_events_316232.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-20T18:00:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316232"
}
```



---

archive/issue_events_316233.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-20T18:00:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316233"
}
```



---

archive/issue_events_316234.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-20T18:00:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316234"
}
```



---

archive/issue_events_316235.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-20T18:00:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316235"
}
```



---

archive/issue_comments_366511.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nAs far as I can tell, curl is only used by R. With the branch here, R finds the system's curl and builds successfully with it.",
    "created_at": "2017-10-20T18:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366511",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'>Comment 1:</a>
As far as I can tell, curl is only used by R. With the branch here, R finds the system's curl and builds successfully with it.



---

archive/issue_comments_366512.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)**",
    "created_at": "2017-10-20T18:14:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366512",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)**



---

archive/issue_comments_366513.json:
```json
{
    "body": "Commit: **[28a659a](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)**",
    "created_at": "2017-10-20T18:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366513",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[28a659a](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)**



---

archive/issue_events_316236.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-20T18:14:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316236"
}
```



---

archive/issue_comments_366514.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3\">28a659a</a></td><td><code>trac 24081: do not build curl on OS X.</code></td></tr></table>\n",
    "created_at": "2017-10-20T18:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366514",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'>Comment 3:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3">28a659a</a></td><td><code>trac 24081: do not build curl on OS X.</code></td></tr></table>




---

archive/issue_comments_366515.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nWe could instead test for the curl version, and if not 7.22 or greater (because that's what R wants), build curl. I have no idea if there are old OS X systems with curl versions predating 7.22.",
    "created_at": "2017-10-20T18:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366515",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'>Comment 4:</a>
We could instead test for the curl version, and if not 7.22 or greater (because that's what R wants), build curl. I have no idea if there are old OS X systems with curl versions predating 7.22.



---

archive/issue_comments_366516.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nIn fact this might be easy: `curl-config --checkfor 7.22` should do it. Is it worth it?",
    "created_at": "2017-10-20T18:21:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366516",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'>Comment 5:</a>
In fact this might be easy: `curl-config --checkfor 7.22` should do it. Is it worth it?



---

archive/issue_comments_366517.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nSomething like this:\n\n```diff\ndiff --git a/build/pkgs/curl/spkg-install b/build/pkgs/curl/spkg-install\nindex 1259cb7d6c..49a49f2644 100644\n--- a/build/pkgs/curl/spkg-install\n+++ b/build/pkgs/curl/spkg-install\n@@ -13,8 +13,14 @@ if [ \"$SAGE_FAT_BINARY\" = yes ]; then\n fi\n \n if [ \"$UNAME\" = \"Darwin\" ]; then\n-   echo \"Skipping build of curl on OS X: using system's version instead.\"\n-   exit 0\n+    curl-config --checkfor 7.22 \\\n+        && echo \"Skipping build of curl on OS X: using system's version instead.\" \\\n+        && exit 0\n+   if [ $MACOSX_VERSION -ge 16 ]; then\n+       echo \"OS X 10.$[$MACOSX_VERSION-4] Building with clang and --with-darwinssl.\"\n+       CC=clang\n+       CURL_CONFIGURE=\"--with-darwinssl $CURL_CONFIGURE\"\n+   fi\n fi\n \n ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" \\\n```",
    "created_at": "2017-10-20T18:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366517",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'>Comment 6:</a>
Something like this:

```diff
diff --git a/build/pkgs/curl/spkg-install b/build/pkgs/curl/spkg-install
index 1259cb7d6c..49a49f2644 100644
--- a/build/pkgs/curl/spkg-install
+++ b/build/pkgs/curl/spkg-install
@@ -13,8 +13,14 @@ if [ "$SAGE_FAT_BINARY" = yes ]; then
 fi
 
 if [ "$UNAME" = "Darwin" ]; then
-   echo "Skipping build of curl on OS X: using system's version instead."
-   exit 0
+    curl-config --checkfor 7.22 \
+        && echo "Skipping build of curl on OS X: using system's version instead." \
+        && exit 0
+   if [ $MACOSX_VERSION -ge 16 ]; then
+       echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang and --with-darwinssl."
+       CC=clang
+       CURL_CONFIGURE="--with-darwinssl $CURL_CONFIGURE"
+   fi
 fi
 
 ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" \
```



---

archive/issue_comments_366518.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThen we would also have to figure out what to do in `spkg-check`.",
    "created_at": "2017-10-20T18:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366518",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'>Comment 7:</a>
Then we would also have to figure out what to do in `spkg-check`.



---

archive/issue_comments_366519.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nBy the way, the optional package `cmake` depends on curl, too, and it also builds using the system library.",
    "created_at": "2017-10-20T19:11:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366519",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'>Comment 8:</a>
By the way, the optional package `cmake` depends on curl, too, and it also builds using the system library.



---

archive/issue_comments_366520.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nPreferably, these things are handled in `configure.ac` now. See `git` and `yasm` for examples.",
    "created_at": "2017-10-21T07:51:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366520",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
Preferably, these things are handled in `configure.ac` now. See `git` and `yasm` for examples.



---

archive/issue_events_316237.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-21T07:51:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316237"
}
```



---

archive/issue_events_316238.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-21T07:51:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316238"
}
```



---

archive/issue_comments_366521.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI don't know autoconf syntax. Is this right?\n\n```diff\ndiff --git a/configure.ac b/configure.ac\nindex 9fa143b319..69446bf568 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -315,6 +315,14 @@ AC_CACHE_CHECK([for yasm], [ac_cv_path_YASM],\n         [need_to_install_yasm=yes; ac_cv_path_YASM=no])],\n         [ac_cv_path_YASM=\"not needed for $host_cpu\"]))\n \n+# Only install curl if we cannot find version 7.22 or later, since\n+# that is what R needs.\n+need_to_install_curl=no\n+AC_CACHE_CHECK([for curl], [ac_cv_path_CURL], [\n+    AC_PATH_PROGS_FEATURE_CHECK(CURL, [curl],\n+    [${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}],\n+    [need_to_install_curl=yes; ac_cv_path_CURL=no])])\n+\n ###############################################################################\n # Check C/C++/Fortran compilers\n ###############################################################################\n```\nIt seems to work, for what that's worth. Also, should we check for a curl installation in general as this does, or just on Darwin?",
    "created_at": "2017-10-21T21:18:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366521",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'>Comment 10:</a>
I don't know autoconf syntax. Is this right?

```diff
diff --git a/configure.ac b/configure.ac
index 9fa143b319..69446bf568 100644
--- a/configure.ac
+++ b/configure.ac
@@ -315,6 +315,14 @@ AC_CACHE_CHECK([for yasm], [ac_cv_path_YASM],
         [need_to_install_yasm=yes; ac_cv_path_YASM=no])],
         [ac_cv_path_YASM="not needed for $host_cpu"]))
 
+# Only install curl if we cannot find version 7.22 or later, since
+# that is what R needs.
+need_to_install_curl=no
+AC_CACHE_CHECK([for curl], [ac_cv_path_CURL], [
+    AC_PATH_PROGS_FEATURE_CHECK(CURL, [curl],
+    [${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}],
+    [need_to_install_curl=yes; ac_cv_path_CURL=no])])
+
 ###############################################################################
 # Check C/C++/Fortran compilers
 ###############################################################################
```
It seems to work, for what that's worth. Also, should we check for a curl installation in general as this does, or just on Darwin?



---

archive/issue_comments_366522.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBy the way, right after I posted this snippet, I read the top of the file where it says to check for libraries later, so I moved the check to just before \"Check header files\".",
    "created_at": "2017-10-21T21:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366522",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'>Comment 11:</a>
By the way, right after I posted this snippet, I read the top of the file where it says to check for libraries later, so I moved the check to just before "Check header files".



---

archive/issue_comments_366523.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nSince the OS X system curl has `SSL` as a feature, I wonder if this will also solve the problem with SSL support for `R`.",
    "created_at": "2017-10-23T14:53:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366523",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'>Comment 12:</a>
Since the OS X system curl has `SSL` as a feature, I wonder if this will also solve the problem with SSL support for `R`.



---

archive/issue_comments_366524.json:
```json
{
    "body": "Changed commit from **[28a659a](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)** to **[c06d1ad](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)**",
    "created_at": "2017-10-24T00:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366524",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[28a659a](https://github.com/sagemath/sagetrac-mirror/commit/28a659a39d66c437a6ba1abe4551b3e0e5fb37e3)** to **[c06d1ad](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)**



---

archive/issue_comments_366525.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639\">c06d1ad</a></td><td><code>trac 24081: do not build curl if installed version is 7.22 or later.</code></td></tr></table>\n",
    "created_at": "2017-10-24T00:02:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366525",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639">c06d1ad</a></td><td><code>trac 24081: do not build curl if installed version is 7.22 or later.</code></td></tr></table>




---

archive/issue_comments_366526.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nThis works for me. It checks regardless of the OS for `curl` version 7.22 or later. Or should it be OS X only?",
    "created_at": "2017-10-24T00:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366526",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'>Comment 14:</a>
This works for me. It checks regardless of the OS for `curl` version 7.22 or later. Or should it be OS X only?



---

archive/issue_events_316239.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-24T00:03:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316239"
}
```



---

archive/issue_events_316240.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-24T00:03:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316240"
}
```



---

archive/issue_comments_366527.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nWe could also add a check like `curl-config --features | grep SSL` to test for SSL support.",
    "created_at": "2017-10-24T00:04:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366527",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'>Comment 15:</a>
We could also add a check like `curl-config --features | grep SSL` to test for SSL support.



---

archive/issue_comments_366528.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nIf this is true then doesn't this obviate a lot of the sturm und drang concerning OpenSSL support, especially on OSX?",
    "created_at": "2017-10-24T14:11:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366528",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'>Comment 16:</a>
If this is true then doesn't this obviate a lot of the sturm und drang concerning OpenSSL support, especially on OSX?



---

archive/issue_comments_366529.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nSee [comment:12](#comment%3A12). I also posted something along these lines to the sage-devel thread a day or two ago.",
    "created_at": "2017-10-24T14:47:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366529",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'>Comment 17:</a>
See [comment:12](#comment%3A12). I also posted something along these lines to the sage-devel thread a day or two ago.



---

archive/issue_comments_366530.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI'm upgrading this to a blocker since something needs to be done with curl to build on the most recent OS X.",
    "created_at": "2017-10-24T14:49:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366530",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'>Comment 18:</a>
I'm upgrading this to a blocker since something needs to be done with curl to build on the most recent OS X.



---

archive/issue_events_316241.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-24T14:49:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316241"
}
```



---

archive/issue_events_316242.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-24T14:49:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316242"
}
```



---

archive/issue_comments_366531.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nThere should be an accompanying `configure-VERSION.tar.gz` file, but I don't know how to produce that. So to test this, run `autoreconf` and then `make`...",
    "created_at": "2017-10-25T05:25:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366531",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'>Comment 19:</a>
There should be an accompanying `configure-VERSION.tar.gz` file, but I don't know how to produce that. So to test this, run `autoreconf` and then `make`...



---

archive/issue_comments_366532.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.\n+\n+To test this branch: run `autoreconf` and then `make`.\n``````\n",
    "created_at": "2017-10-25T05:25:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366532",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Recent versions of curl, libcurl, and its headers are installed by Xcode on OS X, so we do not need to install it as part of Sage.
+
+To test this branch: run `autoreconf` and then `make`.
``````




---

archive/issue_comments_366533.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nReplying to [@jhpalmieri](#comment%3A19):\n> There should be an accompanying `configure-VERSION.tar.gz` file\n\nOnly if the changes to `configure.ac` are *required* to build Sage with this branch, which is not the case here. In fact, such a tarball is never needed for tickets which change only `configure.ac` and nothing else.",
    "created_at": "2017-10-25T08:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366533",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'>Comment 20:</a>
Replying to [@jhpalmieri](#comment%3A19):
> There should be an accompanying `configure-VERSION.tar.gz` file

Only if the changes to `configure.ac` are *required* to build Sage with this branch, which is not the case here. In fact, such a tarball is never needed for tickets which change only `configure.ac` and nothing else.



---

archive/issue_events_316243.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-25T08:27:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316243"
}
```



---

archive/issue_events_316244.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-25T08:27:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316244"
}
```



---

archive/issue_comments_366534.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nDoes Sage require the curl library or the curl program? The comment says \"Check libraries\" but the code checks the program...",
    "created_at": "2017-10-25T08:27:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366534",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'>Comment 21:</a>
Does Sage require the curl library or the curl program? The comment says "Check libraries" but the code checks the program...



---

archive/issue_comments_366535.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nR checks\n\n```\nchecking for curl-config... /home/jdemeyer/sage/local/bin/curl-config\nchecking libcurl version ... 7.53.1\nchecking curl/curl.h usability... yes\nchecking curl/curl.h presence... yes\nchecking for curl/curl.h... yes\nchecking if libcurl is version 7 and >= 7.22.0... yes\n```\nSo you should at least check the header `curl/curl.h` too.",
    "created_at": "2017-10-25T08:57:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366535",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'>Comment 22:</a>
R checks

```
checking for curl-config... /home/jdemeyer/sage/local/bin/curl-config
checking libcurl version ... 7.53.1
checking curl/curl.h usability... yes
checking curl/curl.h presence... yes
checking for curl/curl.h... yes
checking if libcurl is version 7 and >= 7.22.0... yes
```
So you should at least check the header `curl/curl.h` too.



---

archive/issue_events_316245.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-25T08:57:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316245"
}
```



---

archive/issue_events_316246.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-25T08:57:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316246"
}
```



---

archive/issue_comments_366536.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nThe page https://curl.haxx.se/libcurl/using/curl-config.html says that `curl-config` (which is what is in the code) gets information about `libcurl`. We can also check for curl/curl.h, though.",
    "created_at": "2017-10-25T14:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366536",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'>Comment 23:</a>
The page https://curl.haxx.se/libcurl/using/curl-config.html says that `curl-config` (which is what is in the code) gets information about `libcurl`. We can also check for curl/curl.h, though.



---

archive/issue_comments_366537.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [@jhpalmieri](#comment%3A23):\n> We can also check for curl/curl.h, though.\n\nSee https://www.gnu.org/software/autoconf/manual/autoconf-2.69/html_node/Generic-Headers.html",
    "created_at": "2017-10-25T14:45:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366537",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [@jhpalmieri](#comment%3A23):
> We can also check for curl/curl.h, though.

See https://www.gnu.org/software/autoconf/manual/autoconf-2.69/html_node/Generic-Headers.html



---

archive/issue_comments_366538.json:
```json
{
    "body": "Changed commit from **[c06d1ad](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)** to **[beab3b9](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)**",
    "created_at": "2017-10-25T14:50:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366538",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c06d1ad](https://github.com/sagemath/sagetrac-mirror/commit/c06d1ad281de69c6d94074dd462cb69804de0639)** to **[beab3b9](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)**



---

archive/issue_comments_366539.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a\">beab3b9</a></td><td><code>trac 24081: also check for curl/curl.h</code></td></tr></table>\n",
    "created_at": "2017-10-25T14:50:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366539",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a">beab3b9</a></td><td><code>trac 24081: also check for curl/curl.h</code></td></tr></table>




---

archive/issue_events_316247.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-25T14:51:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316247"
}
```



---

archive/issue_events_316248.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-10-25T14:51:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316248"
}
```



---

archive/issue_comments_366540.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nRather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.",
    "created_at": "2017-10-25T22:42:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366540",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'>Comment 27:</a>
Rather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.



---

archive/issue_comments_366541.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nI don't think that you need to set `ac_cv_path_CURL` in the header check.",
    "created_at": "2017-10-31T10:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366541",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'>Comment 28:</a>
I don't think that you need to set `ac_cv_path_CURL` in the header check.



---

archive/issue_comments_366542.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)** to **[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)**",
    "created_at": "2017-10-31T10:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366542",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/jhpalmieri/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/no-curl)** to **[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)**



---

archive/issue_comments_366543.json:
```json
{
    "body": "Changed commit from **[beab3b9](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)** to **[52f9f84](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)**",
    "created_at": "2017-10-31T10:49:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366543",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[beab3b9](https://github.com/sagemath/sagetrac-mirror/commit/beab3b9c518fdc27ebcb3c9151afd286a3bc8c1a)** to **[52f9f84](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)**



---

archive/issue_comments_366544.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86\">52f9f84</a></td><td><code>Minor fixes</code></td></tr></table>\n",
    "created_at": "2017-10-31T10:49:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366544",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'>Comment 30:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86">52f9f84</a></td><td><code>Minor fixes</code></td></tr></table>




---

archive/issue_events_316249.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-31T10:51:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316249"
}
```



---

archive/issue_events_316250.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-31T10:51:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316250"
}
```



---

archive/issue_events_316251.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-31T10:51:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "title_is": "Use system curl if possible",
    "title_was": "Disable building Curl on OS X",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316251"
}
```



---

archive/issue_events_316252.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-31T10:52:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316252"
}
```



---

archive/issue_events_316253.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-31T10:52:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
    "label_color": "000080",
    "label_name": "component: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316253"
}
```



---

archive/issue_comments_366545.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2017-10-31T10:52:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366545",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_366546.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [@jhpalmieri](#comment%3A27):\n> Rather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.\n\nLet's try the simple version first. It would be quite unlikely that `curl-config` exists but the library not.",
    "created_at": "2017-10-31T10:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366546",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [@jhpalmieri](#comment%3A27):
> Rather than using `curl-config`, we could instead use `AC_CHECK_LIB([curl], function, ...)`, although I'm not sure what to use for `function`.

Let's try the simple version first. It would be quite unlikely that `curl-config` exists but the library not.



---

archive/issue_comments_366547.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nGreat, thanks very much!",
    "created_at": "2017-10-31T14:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366547",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'>Comment 34:</a>
Great, thanks very much!



---

archive/issue_comments_366548.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)** to **[52f9f84](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)**",
    "created_at": "2017-11-02T11:06:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24081#issuecomment-366548",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/no-curl](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/no-curl)** to **[52f9f84](https://github.com/sagemath/sagetrac-mirror/commit/52f9f840afeaee2f3eea1a38eb7679211da47a86)**



---

archive/issue_events_316254.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-11-02T11:06:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316254"
}
```



---

archive/issue_events_316255.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a181bc24e8d146b727eedfe86698cef855756af8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-11-02T11:06:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24081",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24081#event-316255"
}
```
