# Issue 24668: Upgrade to pynac-0.7.16

archive/issues_024431.json:
```json
{
    "body": "In pynac-0.7.16:\n* Python interface / Py3 fixes and improvements (thx Erik Bray, #24561)\n* `atan2` fixes (#24604)\n* `beta` fixes\n* fix `atanh/acoth(real)` and `polylog` (#24299)\n* immediate atanh/acoth --> log simplifications (#24658)\n* `legendre_P` (#24553)\n* `chebyshev_T/U` (#16812)\n* speedup in special polynomial creation\n* remove clang-check error \n* remove many clang-tidy warnings\n* remove unused code \n* added CONTRIBUTING.md\n\nhttps://github.com/pynac/pynac/releases/download/pynac-0.7.16/pynac-0.7.16.tar.bz2\n\nCC:  @kiwifb\n\nBranch/Commit: 2568492aea64d516c2216e5d05e2548c23c66215\n\nReviewer: Travis Scrimshaw\n\nAuthor: Ralf Stephan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24668\n\n",
    "closed_at": "2018-02-13T08:10:50Z",
    "created_at": "2018-02-06T08:50:28Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Upgrade to pynac-0.7.16",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24668",
    "user": "https://github.com/rwst"
}
```
In pynac-0.7.16:
* Python interface / Py3 fixes and improvements (thx Erik Bray, #24561)
* `atan2` fixes (#24604)
* `beta` fixes
* fix `atanh/acoth(real)` and `polylog` (#24299)
* immediate atanh/acoth --> log simplifications (#24658)
* `legendre_P` (#24553)
* `chebyshev_T/U` (#16812)
* speedup in special polynomial creation
* remove clang-check error 
* remove many clang-tidy warnings
* remove unused code 
* added CONTRIBUTING.md

https://github.com/pynac/pynac/releases/download/pynac-0.7.16/pynac-0.7.16.tar.bz2

CC:  @kiwifb

Branch/Commit: 2568492aea64d516c2216e5d05e2548c23c66215

Reviewer: Travis Scrimshaw

Author: Ralf Stephan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24668





---

archive/issue_comments_462315.json:
```json
{
    "body": "Changing branch from \"\" to \"u/rws/upgrade_to_pynac_0_7_16\"",
    "created_at": "2018-02-06T09:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462315",
    "user": "https://github.com/rwst"
}
```

Changing branch from "" to "u/rws/upgrade_to_pynac_0_7_16"



---

archive/issue_comments_462316.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[f5b3de4](https://github.com/sagemath/sagetrac-mirror/commit/f5b3de4f629e0c1c66489c63d2fba4b5cb30f94a)|`24668: version/chzksum`|\n|[67f9ddc](https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db)|`24668: doctest fixes`|",
    "created_at": "2018-02-06T09:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462316",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[f5b3de4](https://github.com/sagemath/sagetrac-mirror/commit/f5b3de4f629e0c1c66489c63d2fba4b5cb30f94a)|`24668: version/chzksum`|
|[67f9ddc](https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db)|`24668: doctest fixes`|



---

archive/issue_comments_462317.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-06T09:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462317",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_462318.json:
```json
{
    "body": "Changing author from \"\" to \"Ralf Stephan\"",
    "created_at": "2018-02-06T09:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462318",
    "user": "https://github.com/rwst"
}
```

Changing author from "" to "Ralf Stephan"



---

archive/issue_comments_462319.json:
```json
{
    "body": "Changing commit from \"\" to \"67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db\"",
    "created_at": "2018-02-06T09:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462319",
    "user": "https://github.com/rwst"
}
```

Changing commit from "" to "67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db"



---

archive/issue_comments_462320.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-06T23:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462320",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_462321.json:
```json
{
    "body": "<a id='comment:3'></a>\nLGTM. Next step: to the buildbots.",
    "created_at": "2018-02-06T23:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462321",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
LGTM. Next step: to the buildbots.



---

archive/issue_comments_462322.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2018-02-06T23:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462322",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_462323.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'll rebase #24649 on this because of merge conflict.",
    "created_at": "2018-02-07T06:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462323",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>
I'll rebase #24649 on this because of merge conflict.



---

archive/issue_comments_462324.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-02-10T22:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462324",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_462325.json:
```json
{
    "body": "<a id='comment:6'></a>\nSome numerical noise:\n\n```\nFile \"src/sage/symbolic/expression.pyx\", line 8331, in sage.symbolic.expression.Expression.arctan2\nFailed example:\n    SR(1).arctan2(CDF(0,1))\nExpected:\n    0.7853981633974484 - 19.012501686914433*I\nGot:\n    0.7853981633974483 - 19.012518200244195*I\n**********************************************************************\n1 item had failures:\n   1 of  35 in sage.symbolic.expression.Expression.arctan2\n    [2807 tests, 1 failure, 32.96 s]\n```",
    "created_at": "2018-02-10T22:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462325",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'></a>
Some numerical noise:

```
File "src/sage/symbolic/expression.pyx", line 8331, in sage.symbolic.expression.Expression.arctan2
Failed example:
    SR(1).arctan2(CDF(0,1))
Expected:
    0.7853981633974484 - 19.012501686914433*I
Got:
    0.7853981633974483 - 19.012518200244195*I
**********************************************************************
1 item had failures:
   1 of  35 in sage.symbolic.expression.Expression.arctan2
    [2807 tests, 1 failure, 32.96 s]
```



---

archive/issue_comments_462326.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe imaginary part changed a lot. More than just the usual numerical noise.",
    "created_at": "2018-02-11T08:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462326",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
The imaginary part changed a lot. More than just the usual numerical noise.



---

archive/issue_comments_462327.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe reason for the relative big error is in the formula that is applied in `libs/pynac/pynac.pyx`: `return -I*py_log((x + I*y)/py_sqrt(x**2 + y**2))` with `x=CDF(I), y=1`. The denominator `sqrt(x**2 + y**2)` would be 0, but `CDF(I)^2` is `-1.0 + 1.2246467991473532e-16*I` and so the sqrt denominator becomes `7.82510958117314e-09 + 7.825109581173138e-09*I`.\n\nFor any other complex type of `I` as second argument I get an exception so I'm tempted to mark it as known bug.",
    "created_at": "2018-02-12T16:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462327",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>
The reason for the relative big error is in the formula that is applied in `libs/pynac/pynac.pyx`: `return -I*py_log((x + I*y)/py_sqrt(x**2 + y**2))` with `x=CDF(I), y=1`. The denominator `sqrt(x**2 + y**2)` would be 0, but `CDF(I)^2` is `-1.0 + 1.2246467991473532e-16*I` and so the sqrt denominator becomes `7.82510958117314e-09 + 7.825109581173138e-09*I`.

For any other complex type of `I` as second argument I get an exception so I'm tempted to mark it as known bug.



---

archive/issue_comments_462328.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n|[2568492](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)|`24668: fix doctest`|",
    "created_at": "2018-02-12T16:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462328",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
|[2568492](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)|`24668: fix doctest`|



---

archive/issue_comments_462329.json:
```json
{
    "body": "Changing commit from \"67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db\" to \"2568492aea64d516c2216e5d05e2548c23c66215\"",
    "created_at": "2018-02-12T16:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462329",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db" to "2568492aea64d516c2216e5d05e2548c23c66215"



---

archive/issue_comments_462330.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-02-12T16:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462330",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_462331.json:
```json
{
    "body": "<a id='comment:11'></a>\nActually that numeric result was changed in this ticket. Before, the result was not evaluated. However this pynac version tries to evaluate atan2 even with complex values that have nonzero imag part.",
    "created_at": "2018-02-12T16:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462331",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'></a>
Actually that numeric result was changed in this ticket. Before, the result was not evaluated. However this pynac version tries to evaluate atan2 even with complex values that have nonzero imag part.



---

archive/issue_comments_462332.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-02-13T08:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462332",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_078458.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-13T08:10:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24668#event-78458"
}
```



---

archive/issue_comments_462333.json:
```json
{
    "body": "Changing branch from \"u/rws/upgrade_to_pynac_0_7_16\" to \"2568492aea64d516c2216e5d05e2548c23c66215\"",
    "created_at": "2018-02-13T08:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24668#issuecomment-462333",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/rws/upgrade_to_pynac_0_7_16" to "2568492aea64d516c2216e5d05e2548c23c66215"
