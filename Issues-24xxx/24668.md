# Issue 24668: Upgrade to pynac-0.7.16

archive/issues_024431.json:
```json
{
    "assignees": [],
    "body": "In pynac-0.7.16:\n* Python interface / Py3 fixes and improvements (thx Erik Bray, #24561)\n* `atan2` fixes (#24604)\n* `beta` fixes\n* fix `atanh/acoth(real)` and `polylog` (#24299)\n* immediate atanh/acoth --> log simplifications (#24658)\n* `legendre_P` (#24553)\n* `chebyshev_T/U` (#16812)\n* speedup in special polynomial creation\n* remove clang-check error \n* remove many clang-tidy warnings\n* remove unused code \n* added CONTRIBUTING.md\n\nhttps://github.com/pynac/pynac/releases/download/pynac-0.7.16/pynac-0.7.16.tar.bz2\n\nCC:  @kiwifb\n\nBranch/Commit: **[`2568492`](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Ralf Stephan**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24668_\n\n",
    "closed_at": "2018-02-13T08:10:50Z",
    "created_at": "2018-02-06T08:50:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade to pynac-0.7.16",
    "type": "issue",
    "updated_at": "2018-02-13T08:10:50Z",
    "url": "https://github.com/sagemath/sage/issues/24668",
    "user": "https://github.com/rwst"
}
```
In pynac-0.7.16:
* Python interface / Py3 fixes and improvements (thx Erik Bray, #24561)
* `atan2` fixes (#24604)
* `beta` fixes
* fix `atanh/acoth(real)` and `polylog` (#24299)
* immediate atanh/acoth --> log simplifications (#24658)
* `legendre_P` (#24553)
* `chebyshev_T/U` (#16812)
* speedup in special polynomial creation
* remove clang-check error 
* remove many clang-tidy warnings
* remove unused code 
* added CONTRIBUTING.md

https://github.com/pynac/pynac/releases/download/pynac-0.7.16/pynac-0.7.16.tar.bz2

CC:  @kiwifb

Branch/Commit: **[`2568492`](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)**

Reviewer: **Travis Scrimshaw**

Author: **Ralf Stephan**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/24668_





---

archive/issue_events_343121.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-06T08:50:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343121"
}
```



---

archive/issue_events_343122.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-06T08:50:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343122"
}
```



---

archive/issue_events_343123.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-06T08:50:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343123"
}
```



---

archive/issue_events_343124.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-06T08:50:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343124"
}
```



---

archive/issue_comments_374643.json:
```json
{
    "body": "Branch: **[u/rws/upgrade_to_pynac_0_7_16](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_16)**",
    "created_at": "2018-02-06T09:18:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374643",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/upgrade_to_pynac_0_7_16](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_16)**



---

archive/issue_comments_374644.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5b3de4f629e0c1c66489c63d2fba4b5cb30f94a\"><code>f5b3de4</code></a></td><td><code>24668: version/chzksum</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db\"><code>67f9ddc</code></a></td><td><code>24668: doctest fixes</code></td></tr></table>\n",
    "created_at": "2018-02-06T09:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374644",
    "user": "https://github.com/rwst"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5b3de4f629e0c1c66489c63d2fba4b5cb30f94a"><code>f5b3de4</code></a></td><td><code>24668: version/chzksum</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db"><code>67f9ddc</code></a></td><td><code>24668: doctest fixes</code></td></tr></table>




---

archive/issue_events_343125.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-06T09:19:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343125"
}
```



---

archive/issue_comments_374645.json:
```json
{
    "body": "Author: **Ralf Stephan**",
    "created_at": "2018-02-06T09:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374645",
    "user": "https://github.com/rwst"
}
```

Author: **Ralf Stephan**



---

archive/issue_comments_374646.json:
```json
{
    "body": "Commit: **[`67f9ddc`](https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db)**",
    "created_at": "2018-02-06T09:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374646",
    "user": "https://github.com/rwst"
}
```

Commit: **[`67f9ddc`](https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db)**



---

archive/issue_events_343126.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-02-06T23:45:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343126"
}
```



---

archive/issue_events_343127.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-02-06T23:45:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343127"
}
```



---

archive/issue_comments_374647.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nLGTM. Next step: to the buildbots.",
    "created_at": "2018-02-06T23:45:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374647",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

LGTM. Next step: to the buildbots.



---

archive/issue_comments_374648.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2018-02-06T23:45:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374648",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_374649.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI'll rebase #24649 on this because of merge conflict.",
    "created_at": "2018-02-07T06:50:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374649",
    "user": "https://github.com/rwst"
}
```

<div id="comment:4" align="right">comment:4</div>

I'll rebase #24649 on this because of merge conflict.



---

archive/issue_events_343128.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-10T22:23:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343128"
}
```



---

archive/issue_events_343129.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-10T22:23:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343129"
}
```



---

archive/issue_comments_374650.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSome numerical noise:\n\n```\nFile \"src/sage/symbolic/expression.pyx\", line 8331, in sage.symbolic.expression.Expression.arctan2\nFailed example:\n    SR(1).arctan2(CDF(0,1))\nExpected:\n    0.7853981633974484 - 19.012501686914433*I\nGot:\n    0.7853981633974483 - 19.012518200244195*I\n**********************************************************************\n1 item had failures:\n   1 of  35 in sage.symbolic.expression.Expression.arctan2\n    [2807 tests, 1 failure, 32.96 s]\n```",
    "created_at": "2018-02-10T22:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374650",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

Some numerical noise:

```
File "src/sage/symbolic/expression.pyx", line 8331, in sage.symbolic.expression.Expression.arctan2
Failed example:
    SR(1).arctan2(CDF(0,1))
Expected:
    0.7853981633974484 - 19.012501686914433*I
Got:
    0.7853981633974483 - 19.012518200244195*I
**********************************************************************
1 item had failures:
   1 of  35 in sage.symbolic.expression.Expression.arctan2
    [2807 tests, 1 failure, 32.96 s]
```



---

archive/issue_comments_374651.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe imaginary part changed a lot. More than just the usual numerical noise.",
    "created_at": "2018-02-11T08:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374651",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

The imaginary part changed a lot. More than just the usual numerical noise.



---

archive/issue_comments_374652.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe reason for the relative big error is in the formula that is applied in `libs/pynac/pynac.pyx`: `return -I*py_log((x + I*y)/py_sqrt(x**2 + y**2))` with `x=CDF(I), y=1`. The denominator `sqrt(x**2 + y**2)` would be 0, but `CDF(I)^2` is `-1.0 + 1.2246467991473532e-16*I` and so the sqrt denominator becomes `7.82510958117314e-09 + 7.825109581173138e-09*I`.\n\nFor any other complex type of `I` as second argument I get an exception so I'm tempted to mark it as known bug.",
    "created_at": "2018-02-12T16:21:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374652",
    "user": "https://github.com/rwst"
}
```

<div id="comment:8" align="right">comment:8</div>

The reason for the relative big error is in the formula that is applied in `libs/pynac/pynac.pyx`: `return -I*py_log((x + I*y)/py_sqrt(x**2 + y**2))` with `x=CDF(I), y=1`. The denominator `sqrt(x**2 + y**2)` would be 0, but `CDF(I)^2` is `-1.0 + 1.2246467991473532e-16*I` and so the sqrt denominator becomes `7.82510958117314e-09 + 7.825109581173138e-09*I`.

For any other complex type of `I` as second argument I get an exception so I'm tempted to mark it as known bug.



---

archive/issue_comments_374653.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215\"><code>2568492</code></a></td><td><code>24668: fix doctest</code></td></tr></table>\n",
    "created_at": "2018-02-12T16:24:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374653",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215"><code>2568492</code></a></td><td><code>24668: fix doctest</code></td></tr></table>




---

archive/issue_comments_374654.json:
```json
{
    "body": "Changed commit from **[`67f9ddc`](https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db)** to **[`2568492`](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)**",
    "created_at": "2018-02-12T16:24:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374654",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`67f9ddc`](https://github.com/sagemath/sagetrac-mirror/commit/67f9ddc48ffe5258b610e1af60ef0ca9fcb7c3db)** to **[`2568492`](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)**



---

archive/issue_events_343130.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T16:24:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343130"
}
```



---

archive/issue_events_343131.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T16:24:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343131"
}
```



---

archive/issue_comments_374655.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nActually that numeric result was changed in this ticket. Before, the result was not evaluated. However this pynac version tries to evaluate atan2 even with complex values that have nonzero imag part.",
    "created_at": "2018-02-12T16:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374655",
    "user": "https://github.com/rwst"
}
```

<div id="comment:11" align="right">comment:11</div>

Actually that numeric result was changed in this ticket. Before, the result was not evaluated. However this pynac version tries to evaluate atan2 even with complex values that have nonzero imag part.



---

archive/issue_events_343132.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-13T08:10:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343132"
}
```



---

archive/issue_events_343133.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4080b731ac455381376b8aee214f310441e589c8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-02-13T08:10:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24668#event-343133"
}
```



---

archive/issue_comments_374656.json:
```json
{
    "body": "Changed branch from **[u/rws/upgrade_to_pynac_0_7_16](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_16)** to **[`2568492`](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)**",
    "created_at": "2018-02-13T08:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24668#issuecomment-374656",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/rws/upgrade_to_pynac_0_7_16](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_16)** to **[`2568492`](https://github.com/sagemath/sagetrac-mirror/commit/2568492aea64d516c2216e5d05e2548c23c66215)**
