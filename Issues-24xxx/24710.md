# Issue 24710: scipy build failure with changed LDFLAGS

archive/issues_024473.json:
```json
{
    "assignees": [],
    "body": "Using the environment variables:\n\n```\nexport CC=\"clang\"\nexport CXX=\"clang++ --stdlib=libc++\"\nexport CXXFLAGS=\"$CXXFLAGS --stdlib=libc++\"\nexport LDFLAGS=\"$LDFLAGS -lc++ --stdlib=libc++\"\n```\nscipy fails to build with\n\n```\n    /usr/bin/gfortran -Wall -g -shared -L/home/ralf/sage/local/lib -Wl,-rpath,/h\nome/ralf/sage/local/lib -L/home/ralf/sage/local/lib/python/lib -L/home/ralf/sage\n/local/lib -lc++ --stdlib=libc++ -L/home/ralf/sage/local/lib/python/lib -L/home/\nralf/sage/local/lib build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy\n/fftpack/_fftpackmodule.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfft.o b\nuild/temp.linux-x86_64-2.7/scipy/fftpack/src/drfft.o build/temp.linux-x86_64-2.7\n/scipy/fftpack/src/zrfft.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfftnd.\no build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dct.o\n build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dst.o \nbuild/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/build/src.linux-x86_64-2.\n7/scipy/fftpack/fortranobject.o -L/home/ralf/sage/local/lib -Lbuild/temp.linux-x\n86_64-2.7 -ldfftpack -lfftpack -lpython2.7 -lgfortran -o build/lib.linux-x86_64-\n2.7/scipy/fftpack/_fftpack.so\n    gfortran: error: unrecognized command line option '--stdlib=libc++'\n```\nComplete log is attached.\n\nThe reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.\n\nBranch/Commit: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran) @ [a7e5e0b](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24710_\n\n",
    "closed_at": "2018-02-12T09:24:34Z",
    "created_at": "2018-02-11T14:46:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "scipy build failure with changed LDFLAGS",
    "type": "issue",
    "updated_at": "2018-02-14T08:04:04Z",
    "url": "https://github.com/sagemath/sage/issues/24710",
    "user": "https://github.com/rwst"
}
```
Using the environment variables:

```
export CC="clang"
export CXX="clang++ --stdlib=libc++"
export CXXFLAGS="$CXXFLAGS --stdlib=libc++"
export LDFLAGS="$LDFLAGS -lc++ --stdlib=libc++"
```
scipy fails to build with

```
    /usr/bin/gfortran -Wall -g -shared -L/home/ralf/sage/local/lib -Wl,-rpath,/h
ome/ralf/sage/local/lib -L/home/ralf/sage/local/lib/python/lib -L/home/ralf/sage
/local/lib -lc++ --stdlib=libc++ -L/home/ralf/sage/local/lib/python/lib -L/home/
ralf/sage/local/lib build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy
/fftpack/_fftpackmodule.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfft.o b
uild/temp.linux-x86_64-2.7/scipy/fftpack/src/drfft.o build/temp.linux-x86_64-2.7
/scipy/fftpack/src/zrfft.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfftnd.
o build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dct.o
 build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dst.o 
build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/build/src.linux-x86_64-2.
7/scipy/fftpack/fortranobject.o -L/home/ralf/sage/local/lib -Lbuild/temp.linux-x
86_64-2.7 -ldfftpack -lfftpack -lpython2.7 -lgfortran -o build/lib.linux-x86_64-
2.7/scipy/fftpack/_fftpack.so
    gfortran: error: unrecognized command line option '--stdlib=libc++'
```
Complete log is attached.

The reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.

Branch/Commit: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran) @ [a7e5e0b](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**

_Issue created by migration from https://trac.sagemath.org/ticket/24710_





---

archive/issue_events_324092.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324092"
}
```



---

archive/issue_events_324093.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324093"
}
```



---

archive/issue_events_324094.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324094"
}
```



---

archive/issue_events_324095.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324095"
}
```



---

archive/issue_comments_378299.json:
```json
{
    "body": "Attachment: **[scipy-0.19.1.log](https://github.com/sagemath/sage/files/ticket24710/scipy-0.19.1.log)**",
    "created_at": "2018-02-11T14:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378299",
    "user": "https://github.com/rwst"
}
```

Attachment: **[scipy-0.19.1.log](https://github.com/sagemath/sage/files/ticket24710/scipy-0.19.1.log)**



---

archive/issue_events_324096.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T15:16:52Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "title_is": "Don't send all LDFLAGS to gfortran",
    "title_was": "scipy build fails with gfortran complaining about CXXFLAGS",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324096"
}
```



---

archive/issue_comments_378300.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,3 +25,5 @@\n     gfortran: error: unrecognized command line option '--stdlib=libc++'\n ```\n Complete log is attached.\n+\n+The reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.\n``````\n",
    "created_at": "2018-02-11T15:16:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378300",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,3 +25,5 @@
     gfortran: error: unrecognized command line option '--stdlib=libc++'
 ```
 Complete log is attached.
+
+The reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.
``````




---

archive/issue_comments_378301.json:
```json
{
    "body": "Branch: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran)**",
    "created_at": "2018-02-11T16:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378301",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran)**



---

archive/issue_comments_378302.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nWith this patch scipy installs whenever `--stdlib=libc++` is used in LDFLAGS.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17\">a7e5e0b</a></td><td><code>24710: filter out directive meant for clang++ linker</code></td></tr></table>\n",
    "created_at": "2018-02-11T16:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378302",
    "user": "https://github.com/rwst"
}
```

<a id='comment:3'>Comment 3:</a>
With this patch scipy installs whenever `--stdlib=libc++` is used in LDFLAGS.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17">a7e5e0b</a></td><td><code>24710: filter out directive meant for clang++ linker</code></td></tr></table>




---

archive/issue_events_324097.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T16:03:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324097"
}
```



---

archive/issue_comments_378303.json:
```json
{
    "body": "Commit: **[a7e5e0b](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**",
    "created_at": "2018-02-11T16:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378303",
    "user": "https://github.com/rwst"
}
```

Commit: **[a7e5e0b](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**



---

archive/issue_comments_378304.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nSo this ticket is wontfix. Use these flags:\n\n```\nexport CC=\"clang\"\nexport CXX=\"clang++\"\nexport CLANG_DEFAULT_CXX_STDLIB=\"libc++\"\n```",
    "created_at": "2018-02-12T07:14:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378304",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'>Comment 4:</a>
So this ticket is wontfix. Use these flags:

```
export CC="clang"
export CXX="clang++"
export CLANG_DEFAULT_CXX_STDLIB="libc++"
```



---

archive/issue_events_324098.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324098"
}
```



---

archive/issue_events_324099.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324099"
}
```



---

archive/issue_events_324100.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324100"
}
```



---

archive/issue_events_324101.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324101"
}
```



---

archive/issue_events_324102.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324102"
}
```



---

archive/issue_events_324103.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-12T09:24:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324103"
}
```



---

archive/issue_events_324104.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-12T09:24:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324104"
}
```



---

archive/issue_comments_378305.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nPerhaps closing the ticket was premature. See the comments around comment 25 in #24716: It seems that LDFLAGS is needed after all, which means that the fix from here is needed.",
    "created_at": "2018-02-13T08:57:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378305",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:6'>Comment 6:</a>
Perhaps closing the ticket was premature. See the comments around comment 25 in #24716: It seems that LDFLAGS is needed after all, which means that the fix from here is needed.



---

archive/issue_comments_378306.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@simon-king-jena](#comment%3A6):\n> It seems that LDFLAGS is needed after all\n\nFrom a quick look at #24716, it seems that the bug is in NTL upstream. Globally setting `LDFLAGS` to something involving C++ libraries seems wrong because `LDFLAGS` is not specific to C++.\n\nAnyway, if you want to reopen this ticket, I would like a good explanation why you need to change `LDFLAGS` globally.",
    "created_at": "2018-02-13T13:51:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378306",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@simon-king-jena](#comment%3A6):
> It seems that LDFLAGS is needed after all

From a quick look at #24716, it seems that the bug is in NTL upstream. Globally setting `LDFLAGS` to something involving C++ libraries seems wrong because `LDFLAGS` is not specific to C++.

Anyway, if you want to reopen this ticket, I would like a good explanation why you need to change `LDFLAGS` globally.



---

archive/issue_comments_378307.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nIndeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.",
    "created_at": "2018-02-13T16:12:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378307",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'>Comment 8:</a>
Indeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.



---

archive/issue_comments_378308.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nThis however still begs the question how it would be possible to change the standard C++ library when building Sage, if needed.",
    "created_at": "2018-02-13T16:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378308",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'>Comment 9:</a>
This however still begs the question how it would be possible to change the standard C++ library when building Sage, if needed.



---

archive/issue_comments_378309.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReplying to [@rwst](#comment%3A8):\n> Indeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.\n\nWithout doing something about stdlib, Sage simply doesn't build for me with clang. That has of course been the first thing that I tried.",
    "created_at": "2018-02-13T16:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378309",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:10'>Comment 10:</a>
Replying to [@rwst](#comment%3A8):
> Indeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.

Without doing something about stdlib, Sage simply doesn't build for me with clang. That has of course been the first thing that I tried.



---

archive/issue_comments_378310.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBut you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.",
    "created_at": "2018-02-13T16:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378310",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'>Comment 11:</a>
But you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.



---

archive/issue_comments_378311.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@rwst](#comment%3A11):\n> But you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.\n\nHow to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.",
    "created_at": "2018-02-13T17:01:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378311",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@rwst](#comment%3A11):
> But you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.

How to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.



---

archive/issue_comments_378312.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@simon-king-jena](#comment%3A12):\n> How to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.\n\nI see: `apt-get install clang-4.0`.",
    "created_at": "2018-02-13T17:04:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378312",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@simon-king-jena](#comment%3A12):
> How to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.

I see: `apt-get install clang-4.0`.



---

archive/issue_comments_378313.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI can confirm that on ubuntu with clang-4.0 Sage builds fine and passes all tests. However, I still see that some stuff that I care about is 14% slower with clang than with gcc. So, again, it is good for portability but not for production.",
    "created_at": "2018-02-14T06:28:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378313",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:14'>Comment 14:</a>
I can confirm that on ubuntu with clang-4.0 Sage builds fine and passes all tests. However, I still see that some stuff that I care about is 14% slower with clang than with gcc. So, again, it is good for portability but not for production.



---

archive/issue_events_324105.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-14T07:54:08Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "title_is": "scipy build failure with changed LDFLAGS",
    "title_was": "Don't send all LDFLAGS to gfortran",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-324105"
}
```



---

archive/issue_comments_378314.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nThanks for testing it all on Ubuntu. So I think we can close this and recommend clang-4 with the flags `CC=clang CXX=clang++`.",
    "created_at": "2018-02-14T07:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378314",
    "user": "https://github.com/rwst"
}
```

<a id='comment:15'>Comment 15:</a>
Thanks for testing it all on Ubuntu. So I think we can close this and recommend clang-4 with the flags `CC=clang CXX=clang++`.



---

archive/issue_comments_378315.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@rwst](#comment%3A15):\n> Thanks for testing it all on Ubuntu. So I think we can close this\n\n... or rather \"keep it closed\".\n\n> and recommend clang-4 with the flags `CC=clang CXX=clang++`.\n\nYes and no. Currently on ubuntu, \"clang\" is \"clang version 3.8\".",
    "created_at": "2018-02-14T08:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-378315",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@rwst](#comment%3A15):
> Thanks for testing it all on Ubuntu. So I think we can close this

... or rather "keep it closed".

> and recommend clang-4 with the flags `CC=clang CXX=clang++`.

Yes and no. Currently on ubuntu, "clang" is "clang version 3.8".
