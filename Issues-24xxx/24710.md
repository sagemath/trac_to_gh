# Issue 24710: scipy build failure with changed LDFLAGS

archive/issues_024473.json:
```json
{
    "assignees": [],
    "body": "Using the environment variables:\n\n```\nexport CC=\"clang\"\nexport CXX=\"clang++ --stdlib=libc++\"\nexport CXXFLAGS=\"$CXXFLAGS --stdlib=libc++\"\nexport LDFLAGS=\"$LDFLAGS -lc++ --stdlib=libc++\"\n```\nscipy fails to build with\n\n```\n    /usr/bin/gfortran -Wall -g -shared -L/home/ralf/sage/local/lib -Wl,-rpath,/h\nome/ralf/sage/local/lib -L/home/ralf/sage/local/lib/python/lib -L/home/ralf/sage\n/local/lib -lc++ --stdlib=libc++ -L/home/ralf/sage/local/lib/python/lib -L/home/\nralf/sage/local/lib build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy\n/fftpack/_fftpackmodule.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfft.o b\nuild/temp.linux-x86_64-2.7/scipy/fftpack/src/drfft.o build/temp.linux-x86_64-2.7\n/scipy/fftpack/src/zrfft.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfftnd.\no build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dct.o\n build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dst.o \nbuild/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/build/src.linux-x86_64-2.\n7/scipy/fftpack/fortranobject.o -L/home/ralf/sage/local/lib -Lbuild/temp.linux-x\n86_64-2.7 -ldfftpack -lfftpack -lpython2.7 -lgfortran -o build/lib.linux-x86_64-\n2.7/scipy/fftpack/_fftpack.so\n    gfortran: error: unrecognized command line option '--stdlib=libc++'\n```\nComplete log is attached.\n\nThe reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.\n\nBranch/Commit: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran) @ [`a7e5e0b`](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24710_\n\n",
    "closed_at": "2018-02-12T09:24:34Z",
    "created_at": "2018-02-11T14:46:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "scipy build failure with changed LDFLAGS",
    "type": "issue",
    "updated_at": "2018-02-14T08:04:04Z",
    "url": "https://github.com/sagemath/sage/issues/24710",
    "user": "https://github.com/rwst"
}
```
Using the environment variables:

```
export CC="clang"
export CXX="clang++ --stdlib=libc++"
export CXXFLAGS="$CXXFLAGS --stdlib=libc++"
export LDFLAGS="$LDFLAGS -lc++ --stdlib=libc++"
```
scipy fails to build with

```
    /usr/bin/gfortran -Wall -g -shared -L/home/ralf/sage/local/lib -Wl,-rpath,/h
ome/ralf/sage/local/lib -L/home/ralf/sage/local/lib/python/lib -L/home/ralf/sage
/local/lib -lc++ --stdlib=libc++ -L/home/ralf/sage/local/lib/python/lib -L/home/
ralf/sage/local/lib build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy
/fftpack/_fftpackmodule.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfft.o b
uild/temp.linux-x86_64-2.7/scipy/fftpack/src/drfft.o build/temp.linux-x86_64-2.7
/scipy/fftpack/src/zrfft.o build/temp.linux-x86_64-2.7/scipy/fftpack/src/zfftnd.
o build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dct.o
 build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/scipy/fftpack/src/dst.o 
build/temp.linux-x86_64-2.7/build/src.linux-x86_64-2.7/build/src.linux-x86_64-2.
7/scipy/fftpack/fortranobject.o -L/home/ralf/sage/local/lib -Lbuild/temp.linux-x
86_64-2.7 -ldfftpack -lfftpack -lpython2.7 -lgfortran -o build/lib.linux-x86_64-
2.7/scipy/fftpack/_fftpack.so
    gfortran: error: unrecognized command line option '--stdlib=libc++'
```
Complete log is attached.

The reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.

Branch/Commit: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran) @ [`a7e5e0b`](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/24710_





---

archive/issue_events_342130.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342130"
}
```



---

archive/issue_events_342131.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342131"
}
```



---

archive/issue_events_342132.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342132"
}
```



---

archive/issue_events_342133.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T14:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342133"
}
```



---

archive/issue_comments_375627.json:
```json
{
    "body": "Attachment: **[scipy-0.19.1.log](https://github.com/sagemath/sage/files/ticket24710/scipy-0.19.1.log)**",
    "created_at": "2018-02-11T14:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375627",
    "user": "https://github.com/rwst"
}
```

Attachment: **[scipy-0.19.1.log](https://github.com/sagemath/sage/files/ticket24710/scipy-0.19.1.log)**



---

archive/issue_events_342134.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T15:16:52Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "title_is": "Don't send all LDFLAGS to gfortran",
    "title_was": "scipy build fails with gfortran complaining about CXXFLAGS",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342134"
}
```



---

archive/issue_comments_375628.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,3 +25,5 @@\n     gfortran: error: unrecognized command line option '--stdlib=libc++'\n ```\n Complete log is attached.\n+\n+The reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.\n``````\n",
    "created_at": "2018-02-11T15:16:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375628",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,3 +25,5 @@
     gfortran: error: unrecognized command line option '--stdlib=libc++'
 ```
 Complete log is attached.
+
+The reason is that the libc++ directive is meant for linking commands using clang++. It should be filtered out when using gfortran as linker.
``````




---

archive/issue_comments_375629.json:
```json
{
    "body": "Branch: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran)**",
    "created_at": "2018-02-11T16:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375629",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/don_t_send_all_ldflags_to_gfortran](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/don_t_send_all_ldflags_to_gfortran)**



---

archive/issue_comments_375630.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWith this patch scipy installs whenever `--stdlib=libc++` is used in LDFLAGS.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17\"><code>a7e5e0b</code></a></td><td><code>24710: filter out directive meant for clang++ linker</code></td></tr></table>\n",
    "created_at": "2018-02-11T16:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375630",
    "user": "https://github.com/rwst"
}
```

<div id="comment:3" align="right">comment:3</div>

With this patch scipy installs whenever `--stdlib=libc++` is used in LDFLAGS.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17"><code>a7e5e0b</code></a></td><td><code>24710: filter out directive meant for clang++ linker</code></td></tr></table>




---

archive/issue_events_342135.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-11T16:03:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342135"
}
```



---

archive/issue_comments_375631.json:
```json
{
    "body": "Commit: **[`a7e5e0b`](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**",
    "created_at": "2018-02-11T16:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375631",
    "user": "https://github.com/rwst"
}
```

Commit: **[`a7e5e0b`](https://github.com/sagemath/sagetrac-mirror/commit/a7e5e0bc861432e60c8764307f475485811ddb17)**



---

archive/issue_comments_375632.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSo this ticket is wontfix. Use these flags:\n\n```\nexport CC=\"clang\"\nexport CXX=\"clang++\"\nexport CLANG_DEFAULT_CXX_STDLIB=\"libc++\"\n```",
    "created_at": "2018-02-12T07:14:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375632",
    "user": "https://github.com/rwst"
}
```

<div id="comment:4" align="right">comment:4</div>

So this ticket is wontfix. Use these flags:

```
export CC="clang"
export CXX="clang++"
export CLANG_DEFAULT_CXX_STDLIB="libc++"
```



---

archive/issue_events_342136.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342136"
}
```



---

archive/issue_events_342137.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342137"
}
```



---

archive/issue_events_342138.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342138"
}
```



---

archive/issue_events_342139.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342139"
}
```



---

archive/issue_events_342140.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-12T07:14:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342140"
}
```



---

archive/issue_events_342141.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-12T09:24:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342141"
}
```



---

archive/issue_events_342142.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-12T09:24:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342142"
}
```



---

archive/issue_comments_375633.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nPerhaps closing the ticket was premature. See the comments around comment 25 in #24716: It seems that LDFLAGS is needed after all, which means that the fix from here is needed.",
    "created_at": "2018-02-13T08:57:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375633",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:6" align="right">comment:6</div>

Perhaps closing the ticket was premature. See the comments around comment 25 in #24716: It seems that LDFLAGS is needed after all, which means that the fix from here is needed.



---

archive/issue_comments_375634.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@simon-king-jena](#comment:6):\n> It seems that LDFLAGS is needed after all\n\nFrom a quick look at #24716, it seems that the bug is in NTL upstream. Globally setting `LDFLAGS` to something involving C++ libraries seems wrong because `LDFLAGS` is not specific to C++.\n\nAnyway, if you want to reopen this ticket, I would like a good explanation why you need to change `LDFLAGS` globally.",
    "created_at": "2018-02-13T13:51:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375634",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@simon-king-jena](#comment:6):
> It seems that LDFLAGS is needed after all

From a quick look at #24716, it seems that the bug is in NTL upstream. Globally setting `LDFLAGS` to something involving C++ libraries seems wrong because `LDFLAGS` is not specific to C++.

Anyway, if you want to reopen this ticket, I would like a good explanation why you need to change `LDFLAGS` globally.



---

archive/issue_comments_375635.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nIndeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.",
    "created_at": "2018-02-13T16:12:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375635",
    "user": "https://github.com/rwst"
}
```

<div id="comment:8" align="right">comment:8</div>

Indeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.



---

archive/issue_comments_375636.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThis however still begs the question how it would be possible to change the standard C++ library when building Sage, if needed.",
    "created_at": "2018-02-13T16:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375636",
    "user": "https://github.com/rwst"
}
```

<div id="comment:9" align="right">comment:9</div>

This however still begs the question how it would be possible to change the standard C++ library when building Sage, if needed.



---

archive/issue_comments_375637.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@rwst](#comment:8):\n> Indeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.\n\nWithout doing something about stdlib, Sage simply doesn't build for me with clang. That has of course been the first thing that I tried.",
    "created_at": "2018-02-13T16:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375637",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@rwst](#comment:8):
> Indeed libc++ does not seem necessary after all, #24701 may be a problem of the clang version or of the libstdc++ version. My mistake was after the initial #24701 I changed two things at once (clang version and stdlib) and assumed the wrong of the two produced success.

Without doing something about stdlib, Sage simply doesn't build for me with clang. That has of course been the first thing that I tried.



---

archive/issue_comments_375638.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nBut you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.",
    "created_at": "2018-02-13T16:56:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375638",
    "user": "https://github.com/rwst"
}
```

<div id="comment:11" align="right">comment:11</div>

But you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.



---

archive/issue_comments_375639.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@rwst](#comment:11):\n> But you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.\n\nHow to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.",
    "created_at": "2018-02-13T17:01:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375639",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@rwst](#comment:11):
> But you didn't change your clang version, right? So how do you know your problem was only because of your missing libc++ flag? At that time I suggested so but I was wrong. ptestlong with clang-4/libstdc++ is fine here, as I just saw.

How to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.



---

archive/issue_comments_375640.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@simon-king-jena](#comment:12):\n> How to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.\n\nI see: `apt-get install clang-4.0`.",
    "created_at": "2018-02-13T17:04:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375640",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@simon-king-jena](#comment:12):
> How to install clang-4 on ubuntu? `apt-get install clang` gives version 3.8.

I see: `apt-get install clang-4.0`.



---

archive/issue_comments_375641.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI can confirm that on ubuntu with clang-4.0 Sage builds fine and passes all tests. However, I still see that some stuff that I care about is 14% slower with clang than with gcc. So, again, it is good for portability but not for production.",
    "created_at": "2018-02-14T06:28:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375641",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

I can confirm that on ubuntu with clang-4.0 Sage builds fine and passes all tests. However, I still see that some stuff that I care about is 14% slower with clang than with gcc. So, again, it is good for portability but not for production.



---

archive/issue_events_342143.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-14T07:54:08Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "title_is": "scipy build failure with changed LDFLAGS",
    "title_was": "Don't send all LDFLAGS to gfortran",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24710#event-342143"
}
```



---

archive/issue_comments_375642.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks for testing it all on Ubuntu. So I think we can close this and recommend clang-4 with the flags `CC=clang CXX=clang++`.",
    "created_at": "2018-02-14T07:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375642",
    "user": "https://github.com/rwst"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks for testing it all on Ubuntu. So I think we can close this and recommend clang-4 with the flags `CC=clang CXX=clang++`.



---

archive/issue_comments_375643.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@rwst](#comment:15):\n> Thanks for testing it all on Ubuntu. So I think we can close this\n\n... or rather \"keep it closed\".\n\n> and recommend clang-4 with the flags `CC=clang CXX=clang++`.\n\nYes and no. Currently on ubuntu, \"clang\" is \"clang version 3.8\".",
    "created_at": "2018-02-14T08:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24710#issuecomment-375643",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@rwst](#comment:15):
> Thanks for testing it all on Ubuntu. So I think we can close this

... or rather "keep it closed".

> and recommend clang-4 with the flags `CC=clang CXX=clang++`.

Yes and no. Currently on ubuntu, "clang" is "clang version 3.8".
