# Issue 24748: Memory Leaks in BooleanFunction

archive/issues_024511.json:
```json
{
    "assignees": [],
    "body": "As discussed in #14549 there is a memory leak in `BooleanPolynomialRing`, which was fixed (somewhat hacky) for the `annihilator` method by using `BooleanPolynomialRing_constructor`.\n\nThere are other uses of `BooleanPolyonmialRing` which should be fixed, too. I suggest to do this the same way as for `annihilator`. But maybe also add a comment to the code, to link to this and #14549 discussion, so we have a later reference, why these changes exist.\n\nAssignee: **@pfasante**\n\nKeywords: **memory leak, BooleanFunction**\n\nReviewer: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24748_\n\n",
    "closed_at": "2022-01-24T09:40:46Z",
    "created_at": "2018-02-16T11:05:00Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20memleak",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Memory Leaks in BooleanFunction",
    "type": "issue",
    "updated_at": "2022-01-24T09:40:46Z",
    "url": "https://github.com/sagemath/sage/issues/24748",
    "user": "https://github.com/pfasante"
}
```
As discussed in #14549 there is a memory leak in `BooleanPolynomialRing`, which was fixed (somewhat hacky) for the `annihilator` method by using `BooleanPolynomialRing_constructor`.

There are other uses of `BooleanPolyonmialRing` which should be fixed, too. I suggest to do this the same way as for `annihilator`. But maybe also add a comment to the code, to link to this and #14549 discussion, so we have a later reference, why these changes exist.

Assignee: **@pfasante**

Keywords: **memory leak, BooleanFunction**

Reviewer: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/24748_





---

archive/issue_events_312872.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-16T11:05:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312872"
}
```



---

archive/issue_events_312873.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-16T11:05:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20cryptography",
    "label_color": "0000ff",
    "label_name": "component: cryptography",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312873"
}
```



---

archive/issue_events_312874.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-16T11:05:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312874"
}
```



---

archive/issue_comments_378996.json:
```json
{
    "body": "Branch: **[u/asante/memory_leaks_in_booleanfunction](https://github.com/sagemath/sagetrac-mirror/tree/u/asante/memory_leaks_in_booleanfunction)**",
    "created_at": "2018-02-16T11:08:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-378996",
    "user": "https://github.com/pfasante"
}
```

Branch: **[u/asante/memory_leaks_in_booleanfunction](https://github.com/sagemath/sagetrac-mirror/tree/u/asante/memory_leaks_in_booleanfunction)**



---

archive/issue_comments_378997.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b29c0e5e40f24e16c21eb318bd9fa3eca16efb1c\">b29c0e5</a></td><td><code>add a comment to remember that this is only a hack</code></td></tr></table>\n",
    "created_at": "2018-02-16T11:12:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-378997",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>Comment 2:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b29c0e5e40f24e16c21eb318bd9fa3eca16efb1c">b29c0e5</a></td><td><code>add a comment to remember that this is only a hack</code></td></tr></table>




---

archive/issue_comments_378998.json:
```json
{
    "body": "Commit: **[b29c0e5](https://github.com/sagemath/sagetrac-mirror/commit/b29c0e5e40f24e16c21eb318bd9fa3eca16efb1c)**",
    "created_at": "2018-02-16T11:12:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-378998",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[b29c0e5](https://github.com/sagemath/sagetrac-mirror/commit/b29c0e5e40f24e16c21eb318bd9fa3eca16efb1c)**



---

archive/issue_events_312875.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-16T11:18:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20cryptography",
    "label_color": "0000ff",
    "label_name": "component: cryptography",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312875"
}
```



---

archive/issue_events_312876.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-16T11:18:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20memleak",
    "label_color": "000080",
    "label_name": "component: memleak",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312876"
}
```



---

archive/issue_comments_378999.json:
```json
{
    "body": "Assignee: **@pfasante**",
    "created_at": "2018-02-16T11:18:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-378999",
    "user": "https://github.com/pfasante"
}
```

Assignee: **@pfasante**



---

archive/issue_events_312877.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-17T10:14:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312877"
}
```



---

archive/issue_comments_379000.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\n(sorry forgott that I still have to fix something)",
    "created_at": "2018-02-17T10:17:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379000",
    "user": "https://github.com/pfasante"
}
```

<a id='comment:5'>Comment 5:</a>
(sorry forgott that I still have to fix something)



---

archive/issue_events_312878.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-17T10:17:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312878"
}
```



---

archive/issue_events_312879.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-17T10:17:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312879"
}
```



---

archive/issue_comments_379001.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/90f0a835662c71e829ddfeb123d51dc48f16ea08\">90f0a83</a></td><td><code>import the factory function from the right module</code></td></tr></table>\n",
    "created_at": "2018-02-17T10:23:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379001",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/90f0a835662c71e829ddfeb123d51dc48f16ea08">90f0a83</a></td><td><code>import the factory function from the right module</code></td></tr></table>




---

archive/issue_comments_379002.json:
```json
{
    "body": "Changed commit from **[b29c0e5](https://github.com/sagemath/sagetrac-mirror/commit/b29c0e5e40f24e16c21eb318bd9fa3eca16efb1c)** to **[90f0a83](https://github.com/sagemath/sagetrac-mirror/commit/90f0a835662c71e829ddfeb123d51dc48f16ea08)**",
    "created_at": "2018-02-17T10:23:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379002",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b29c0e5](https://github.com/sagemath/sagetrac-mirror/commit/b29c0e5e40f24e16c21eb318bd9fa3eca16efb1c)** to **[90f0a83](https://github.com/sagemath/sagetrac-mirror/commit/90f0a835662c71e829ddfeb123d51dc48f16ea08)**



---

archive/issue_comments_379003.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nNow ready for review.",
    "created_at": "2018-02-17T10:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379003",
    "user": "https://github.com/pfasante"
}
```

<a id='comment:7'>Comment 7:</a>
Now ready for review.



---

archive/issue_events_312880.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-17T10:24:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312880"
}
```



---

archive/issue_events_312881.json:
```json
{
    "actor": "https://github.com/pfasante",
    "created_at": "2018-02-17T10:24:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312881"
}
```



---

archive/issue_comments_379004.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nIMHO, you should fix the problem (#21892) rather than the symptoms.",
    "created_at": "2018-02-17T13:23:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379004",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'>Comment 8:</a>
IMHO, you should fix the problem (#21892) rather than the symptoms.



---

archive/issue_comments_379005.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nI agree, will work on #21892 next when I have some spare time.\nBut I think that a fix for that can remove this hack accordingly?",
    "created_at": "2018-02-18T10:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379005",
    "user": "https://github.com/pfasante"
}
```

<a id='comment:9'>Comment 9:</a>
I agree, will work on #21892 next when I have some spare time.
But I think that a fix for that can remove this hack accordingly?



---

archive/issue_comments_379006.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI don't see the point of taking on more technical debt when there is a known solution. I know finding spare time is not easy, but it makes it easier (i.e. requires less time) to work with the code base in the long run. Anyways, if someone else wants to set this to a positive review, I will not object, but I am more willing to find time to review the long term fix.",
    "created_at": "2018-02-19T11:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379006",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>Comment 10:</a>
I don't see the point of taking on more technical debt when there is a known solution. I know finding spare time is not easy, but it makes it easier (i.e. requires less time) to work with the code base in the long run. Anyways, if someone else wants to set this to a positive review, I will not object, but I am more willing to find time to review the long term fix.



---

archive/issue_comments_379007.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nOK, I'm fine with that, too.\n\nI took a look at the BooleanPolynomialRing implementation and for me to be able to write the correct patch will take some time, as I have to understand how the implementation work (and differs from other ring implementations).\n\nIs there a possibility to close tickets as wontfix or something?",
    "created_at": "2018-02-19T11:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379007",
    "user": "https://github.com/pfasante"
}
```

<a id='comment:11'>Comment 11:</a>
OK, I'm fine with that, too.

I took a look at the BooleanPolynomialRing implementation and for me to be able to write the correct patch will take some time, as I have to understand how the implementation work (and differs from other ring implementations).

Is there a possibility to close tickets as wontfix or something?



---

archive/issue_events_312882.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-23T19:35:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312882"
}
```



---

archive/issue_comments_379008.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nshall we close this one ?",
    "created_at": "2022-01-23T19:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379008",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'>Comment 12:</a>
shall we close this one ?



---

archive/issue_comments_379009.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-01-23T23:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379009",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_379010.json:
```json
{
    "body": "Changed author from **Friedrich Wiemer** to none",
    "created_at": "2022-01-23T23:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379010",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Friedrich Wiemer** to none



---

archive/issue_comments_379011.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nYes, I think so. We are better off fixing #21892 IMO.",
    "created_at": "2022-01-23T23:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379011",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'>Comment 13:</a>
Yes, I think so. We are better off fixing #21892 IMO.



---

archive/issue_comments_379012.json:
```json
{
    "body": "Changed commit from **[90f0a83](https://github.com/sagemath/sagetrac-mirror/commit/90f0a835662c71e829ddfeb123d51dc48f16ea08)** to none",
    "created_at": "2022-01-23T23:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379012",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[90f0a83](https://github.com/sagemath/sagetrac-mirror/commit/90f0a835662c71e829ddfeb123d51dc48f16ea08)** to none



---

archive/issue_comments_379013.json:
```json
{
    "body": "Changed branch from **[u/asante/memory_leaks_in_booleanfunction](https://github.com/sagemath/sagetrac-mirror/tree/u/asante/memory_leaks_in_booleanfunction)** to none",
    "created_at": "2022-01-23T23:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379013",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/asante/memory_leaks_in_booleanfunction](https://github.com/sagemath/sagetrac-mirror/tree/u/asante/memory_leaks_in_booleanfunction)** to none



---

archive/issue_events_312883.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-01-23T23:48:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312883"
}
```



---

archive/issue_events_312884.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-01-23T23:48:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312884"
}
```



---

archive/issue_comments_379014.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI agree, too. As Travis said, we should fix the other ticket.",
    "created_at": "2022-01-24T09:30:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24748#issuecomment-379014",
    "user": "https://github.com/pfasante"
}
```

<a id='comment:14'>Comment 14:</a>
I agree, too. As Travis said, we should fix the other ticket.



---

archive/issue_events_312885.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-24T09:40:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312885"
}
```



---

archive/issue_events_312886.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-24T09:40:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24748",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24748#event-312886"
}
```
