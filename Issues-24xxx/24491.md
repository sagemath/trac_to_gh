# Issue 24491: sdh_configure should use bash

archive/issues_024254.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nSome `configure` scripts are buggy when they are run with shells other than `bash`. See #23451 for example. Since Sage requires `bash` anyway, we can easily work around this by forcing `bash` to run `configure`.\n\nCC:  @embray @dimpase\n\nComponent: **porting**\n\nAuthor: **Jeroen Demeyer**\n\nBranch: **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)**\n\nReviewer: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24491_\n\n",
    "closed_at": "2018-01-14T10:14:05Z",
    "created_at": "2018-01-08T14:28:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sdh_configure should use bash",
    "type": "issue",
    "updated_at": "2018-01-16T17:25:32Z",
    "url": "https://github.com/sagemath/sage/issues/24491",
    "user": "https://github.com/jdemeyer"
}
```
<div id="comment:0"></div>

Some `configure` scripts are buggy when they are run with shells other than `bash`. See #23451 for example. Since Sage requires `bash` anyway, we can easily work around this by forcing `bash` to run `configure`.

CC:  @embray @dimpase

Component: **porting**

Author: **Jeroen Demeyer**

Branch: **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)**

Reviewer: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/24491_





---

archive/issue_events_336334.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T14:28:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336334"
}
```



---

archive/issue_events_336335.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T14:28:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "0000b0",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336335"
}
```



---

archive/issue_events_336336.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T14:28:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336336"
}
```



---

archive/issue_events_336337.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T14:28:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336337"
}
```



---

archive/issue_comments_370728.json:
```json
{
    "body": "Branch: **[u/jdemeyer/sdh_configure_should_use_bash](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sdh_configure_should_use_bash)**",
    "created_at": "2018-01-08T14:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370728",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/sdh_configure_should_use_bash](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sdh_configure_should_use_bash)**



---

archive/issue_comments_370729.json:
```json
{
    "body": "Commit: **[`36eb05d`](https://github.com/sagemath/sagetrac-mirror/commit/36eb05d4baf611dbb4e574cd461b3aca9936c76f)**",
    "created_at": "2018-01-08T14:30:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370729",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`36eb05d`](https://github.com/sagemath/sagetrac-mirror/commit/36eb05d4baf611dbb4e574cd461b3aca9936c76f)**



---

archive/issue_events_336338.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T14:30:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336338"
}
```



---

archive/issue_comments_370730.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/36eb05d4baf611dbb4e574cd461b3aca9936c76f\"><code>36eb05d</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>\n",
    "created_at": "2018-01-08T14:30:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370730",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/36eb05d4baf611dbb4e574cd461b3aca9936c76f"><code>36eb05d</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>




---

archive/issue_events_336339.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T15:13:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336339"
}
```



---

archive/issue_events_336340.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T15:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336340"
}
```



---

archive/issue_comments_370731.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis doesn't actually work due to way how `configure` works.",
    "created_at": "2018-01-08T15:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370731",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

This doesn't actually work due to way how `configure` works.



---

archive/issue_comments_370732.json:
```json
{
    "body": "Changed commit from **[`36eb05d`](https://github.com/sagemath/sagetrac-mirror/commit/36eb05d4baf611dbb4e574cd461b3aca9936c76f)** to **[`b8d5ca2`](https://github.com/sagemath/sagetrac-mirror/commit/b8d5ca27f8fc4835641ce31708357a95a6afebdf)**",
    "created_at": "2018-01-08T15:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370732",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`36eb05d`](https://github.com/sagemath/sagetrac-mirror/commit/36eb05d4baf611dbb4e574cd461b3aca9936c76f)** to **[`b8d5ca2`](https://github.com/sagemath/sagetrac-mirror/commit/b8d5ca27f8fc4835641ce31708357a95a6afebdf)**



---

archive/issue_comments_370733.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8d5ca27f8fc4835641ce31708357a95a6afebdf\"><code>b8d5ca2</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>\n",
    "created_at": "2018-01-08T15:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370733",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8d5ca27f8fc4835641ce31708357a95a6afebdf"><code>b8d5ca2</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>




---

archive/issue_comments_370734.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nShouldn't\n\n```\nexport CONFIG_SHELL=\"$SHELL\"\n```\nrather be\n\n```\nexport CONFIG_SHELL=`command -v bash`\n```",
    "created_at": "2018-01-08T15:42:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370734",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

Shouldn't

```
export CONFIG_SHELL="$SHELL"
```
rather be

```
export CONFIG_SHELL=`command -v bash`
```



---

archive/issue_events_336341.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T15:58:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336341"
}
```



---

archive/issue_events_336342.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-08T15:58:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336342"
}
```



---

archive/issue_comments_370735.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@dimpase](#comment%3A5):\n> Shouldn't\n> \n> ```\n> export CONFIG_SHELL=\"$SHELL\"\n> ```\n> rather be\n> \n> ```\n> export CONFIG_SHELL=`command -v bash`\n> ```\n\nGiven that `$SHELL` is `bash`, no it should not.",
    "created_at": "2018-01-08T15:58:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370735",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@dimpase](#comment%3A5):
> Shouldn't
> 
> ```
> export CONFIG_SHELL="$SHELL"
> ```
> rather be
> 
> ```
> export CONFIG_SHELL=`command -v bash`
> ```

Given that `$SHELL` is `bash`, no it should not.



---

archive/issue_comments_370736.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment%3A7):\n> Replying to [@dimpase](#comment%3A5):\n> > Shouldn't\n> > \n> > ```\n> > export CONFIG_SHELL=\"$SHELL\"\n> > ```\n> > rather be\n> > \n> > ```\n> > export CONFIG_SHELL=`command -v bash`\n> > ```\n> \n> \n> Given that `$SHELL` is `bash`, no it should not.\n\nWhy would $SHELL always be bash? E.g. in the context of #23451 it can be dash, no?",
    "created_at": "2018-01-08T16:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370736",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment%3A7):
> Replying to [@dimpase](#comment%3A5):
> > Shouldn't
> > 
> > ```
> > export CONFIG_SHELL="$SHELL"
> > ```
> > rather be
> > 
> > ```
> > export CONFIG_SHELL=`command -v bash`
> > ```
> 
> 
> Given that `$SHELL` is `bash`, no it should not.

Why would $SHELL always be bash? E.g. in the context of #23451 it can be dash, no?



---

archive/issue_comments_370737.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@dimpase](#comment%3A8):\n> Why would $SHELL always be bash?\n\nBecause the Sage build scripts are always run with `bash`.",
    "created_at": "2018-01-08T16:18:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370737",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@dimpase](#comment%3A8):
> Why would $SHELL always be bash?

Because the Sage build scripts are always run with `bash`.



---

archive/issue_comments_370738.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAre there any other packages with non-portable configure scripts, other than the two mentioned in #23451? I think I was able to build all of sage using dash 0.5.9 with only those two \"fixed\".\n\nUsing `/bin/sh` when possible is a way to give extra testing to configure scripts, which are meant to ensure portability of software. Sage packages some mathematical software that is not included in distros, so they won't get exposure to diverse environments otherwise.\n\nAlso, a script that works with several different shells is a script that is less likely to break when bash changes, or with older versions of bash, etc.\n\n---\n\nAnyway, maybe it is a good idea to do\n\n```\nif [ -z \"$CONFIG_SHELL\" ]; then\n    export CONFIG_SHELL=\"$SHELL\"\nfi\n```\nto allow overriding of `$CONFIG_SHELL` ?",
    "created_at": "2018-01-08T16:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370738",
    "user": "https://github.com/tornaria"
}
```

<div id="comment:10" align="right">comment:10</div>

Are there any other packages with non-portable configure scripts, other than the two mentioned in #23451? I think I was able to build all of sage using dash 0.5.9 with only those two "fixed".

Using `/bin/sh` when possible is a way to give extra testing to configure scripts, which are meant to ensure portability of software. Sage packages some mathematical software that is not included in distros, so they won't get exposure to diverse environments otherwise.

Also, a script that works with several different shells is a script that is less likely to break when bash changes, or with older versions of bash, etc.

---

Anyway, maybe it is a good idea to do

```
if [ -z "$CONFIG_SHELL" ]; then
    export CONFIG_SHELL="$SHELL"
fi
```
to allow overriding of `$CONFIG_SHELL` ?



---

archive/issue_comments_370739.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@jdemeyer](#comment%3A9):\n> Replying to [@dimpase](#comment%3A8):\n> > Why would $SHELL always be bash?\n> \n> \n> Because the Sage build scripts are always run with `bash`.\n\nI don't know what you exactly mean.\nJust check the 1st line of the top `./configure`. There is no `bash` there.",
    "created_at": "2018-01-08T16:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370739",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@jdemeyer](#comment%3A9):
> Replying to [@dimpase](#comment%3A8):
> > Why would $SHELL always be bash?
> 
> 
> Because the Sage build scripts are always run with `bash`.

I don't know what you exactly mean.
Just check the 1st line of the top `./configure`. There is no `bash` there.



---

archive/issue_comments_370740.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSome autotool scripts will also break if you use `CONFIG_SHELL=bash` I don't know if there are any in sage but I have experienced it. Real autotool script usually expect `sh` but a lot of the time you are lucky and can use bash (gcc is a case in point). \n\nMy experience comes from AIX where `sh` is a real separate program rather than bash or dash called with a special profile. AIX's sh is so slow that it will take several days to compile gcc if you don't use `CONFIG_SHELL=bash`. In that light it is tempting to use bash all the time, until things starts to fail left and right in some libtool scripts later on.",
    "created_at": "2018-01-08T18:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370740",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">comment:12</div>

Some autotool scripts will also break if you use `CONFIG_SHELL=bash` I don't know if there are any in sage but I have experienced it. Real autotool script usually expect `sh` but a lot of the time you are lucky and can use bash (gcc is a case in point). 

My experience comes from AIX where `sh` is a real separate program rather than bash or dash called with a special profile. AIX's sh is so slow that it will take several days to compile gcc if you don't use `CONFIG_SHELL=bash`. In that light it is tempting to use bash all the time, until things starts to fail left and right in some libtool scripts later on.



---

archive/issue_comments_370741.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@dimpase](#comment%3A11):\n> Just check the 1st line of the top `./configure`.\n\nI don't mean `configure`. I mean the scripts in `build/bin`.",
    "created_at": "2018-01-08T18:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370741",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@dimpase](#comment%3A11):
> Just check the 1st line of the top `./configure`.

I don't mean `configure`. I mean the scripts in `build/bin`.



---

archive/issue_comments_370742.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment%3A13):\n> Replying to [@dimpase](#comment%3A11):\n> > Just check the 1st line of the top `./configure`.\n> \n> \n> I don't mean `configure`. I mean the scripts in `build/bin`.\n\nBut this does not guarantee that `sdh_configure` is only launched from there.\nSomeone could source the `sdh_configure` in a non-bash session and shoot themselves in the foot...",
    "created_at": "2018-01-08T19:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370742",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment%3A13):
> Replying to [@dimpase](#comment%3A11):
> > Just check the 1st line of the top `./configure`.
> 
> 
> I don't mean `configure`. I mean the scripts in `build/bin`.

But this does not guarantee that `sdh_configure` is only launched from there.
Someone could source the `sdh_configure` in a non-bash session and shoot themselves in the foot...



---

archive/issue_comments_370743.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@kiwifb](#comment%3A12):\n> Some autotool scripts will also break if you use `CONFIG_SHELL=bash` I don't know if there are any in sage but I have experienced it. Real autotool script usually expect `sh` but a lot of the time you are lucky and can use bash (gcc is a case in point).\n\nOn some systems, `/bin/sh` is `bash`:\n\n```\njdemeyer@sage4:~$ /bin/sh --version\nGNU bash, version 4.3.48(1)-release (x86_64-pc-linux-gnu)\nCopyright (C) 2013 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\n\nThis is free software; you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n```\n\nGiven that `bash` is meant to be POSIX-compliant, it should not be a problem to force the use of `bash`.",
    "created_at": "2018-01-09T11:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370743",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@kiwifb](#comment%3A12):
> Some autotool scripts will also break if you use `CONFIG_SHELL=bash` I don't know if there are any in sage but I have experienced it. Real autotool script usually expect `sh` but a lot of the time you are lucky and can use bash (gcc is a case in point).

On some systems, `/bin/sh` is `bash`:

```
jdemeyer@sage4:~$ /bin/sh --version
GNU bash, version 4.3.48(1)-release (x86_64-pc-linux-gnu)
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>

This is free software; you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
```

Given that `bash` is meant to be POSIX-compliant, it should not be a problem to force the use of `bash`.



---

archive/issue_comments_370744.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@tornaria](#comment%3A10):\n> Using `/bin/sh` when possible is a way to give extra testing to configure scripts, which are meant to ensure portability of software.\n\nI disagree completely with this point. It's not the goal of Sage to use our users for testing the portability of configure scripts.\n\nWe should ensure that Sage can be installed on as many systems as possible. I claim that using `bash` for configure scripts is more portable than using `/bin/sh`. So that is what we should do.",
    "created_at": "2018-01-09T11:10:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370744",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@tornaria](#comment%3A10):
> Using `/bin/sh` when possible is a way to give extra testing to configure scripts, which are meant to ensure portability of software.

I disagree completely with this point. It's not the goal of Sage to use our users for testing the portability of configure scripts.

We should ensure that Sage can be installed on as many systems as possible. I claim that using `bash` for configure scripts is more portable than using `/bin/sh`. So that is what we should do.



---

archive/issue_comments_370745.json:
```json
{
    "body": "Changed commit from **[`b8d5ca2`](https://github.com/sagemath/sagetrac-mirror/commit/b8d5ca27f8fc4835641ce31708357a95a6afebdf)** to **[`d103ebf`](https://github.com/sagemath/sagetrac-mirror/commit/d103ebf336adc366052fc5d9ea36bc083173ac86)**",
    "created_at": "2018-01-09T11:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370745",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b8d5ca2`](https://github.com/sagemath/sagetrac-mirror/commit/b8d5ca27f8fc4835641ce31708357a95a6afebdf)** to **[`d103ebf`](https://github.com/sagemath/sagetrac-mirror/commit/d103ebf336adc366052fc5d9ea36bc083173ac86)**



---

archive/issue_comments_370746.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d103ebf336adc366052fc5d9ea36bc083173ac86\"><code>d103ebf</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>\n",
    "created_at": "2018-01-09T11:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370746",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d103ebf336adc366052fc5d9ea36bc083173ac86"><code>d103ebf</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>




---

archive/issue_comments_370747.json:
```json
{
    "body": "Changed commit from **[`d103ebf`](https://github.com/sagemath/sagetrac-mirror/commit/d103ebf336adc366052fc5d9ea36bc083173ac86)** to **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)**",
    "created_at": "2018-01-09T11:13:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370747",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d103ebf`](https://github.com/sagemath/sagetrac-mirror/commit/d103ebf336adc366052fc5d9ea36bc083173ac86)** to **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)**



---

archive/issue_comments_370748.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661\"><code>f0e2bd8</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>\n",
    "created_at": "2018-01-09T11:13:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370748",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661"><code>f0e2bd8</code></a></td><td><code>sdh_configure should always use bash</code></td></tr></table>




---

archive/issue_comments_370749.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nAnd on some system `sh` is actually `dash`. There are differences between `bash`, `dash` and `sh` (as one would expect). When `sh` is actually `bash` for example it is not just a link. When `bash` is invoked as `sh` a special profile is loaded, some bash functions are defined to match `sh` requirements and so on. Probably similarly for `dash`. If you just `CONFIG_SHELL=bash` everywhere you will get a surprise sooner rather than later because those functions won't be there.",
    "created_at": "2018-01-09T11:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370749",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

And on some system `sh` is actually `dash`. There are differences between `bash`, `dash` and `sh` (as one would expect). When `sh` is actually `bash` for example it is not just a link. When `bash` is invoked as `sh` a special profile is loaded, some bash functions are defined to match `sh` requirements and so on. Probably similarly for `dash`. If you just `CONFIG_SHELL=bash` everywhere you will get a surprise sooner rather than later because those functions won't be there.



---

archive/issue_comments_370750.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kiwifb](#comment%3A19):\n> And on some system `sh` is actually `dash`. There are differences between `bash`, `dash` and `sh` (as one would expect). When `sh` is actually `bash` for example it is not just a link. When `bash` is invoked as `sh` a special profile is loaded, some bash functions are defined to match `sh` requirements and so on. Probably similarly for `dash`. If you just `CONFIG_SHELL=bash` everywhere you will get a surprise sooner rather than later because those functions won't be there.\n\nI always assumed that `bash` is essentially `sh` with extra features (a bit like C++ is C with extra features). Meaning that if something works with `sh`, it almost certainly works with `bash`. Of course there are edge cases where it might not work, but I doubt that it is as much a problem as you think.",
    "created_at": "2018-01-09T11:41:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370750",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kiwifb](#comment%3A19):
> And on some system `sh` is actually `dash`. There are differences between `bash`, `dash` and `sh` (as one would expect). When `sh` is actually `bash` for example it is not just a link. When `bash` is invoked as `sh` a special profile is loaded, some bash functions are defined to match `sh` requirements and so on. Probably similarly for `dash`. If you just `CONFIG_SHELL=bash` everywhere you will get a surprise sooner rather than later because those functions won't be there.

I always assumed that `bash` is essentially `sh` with extra features (a bit like C++ is C with extra features). Meaning that if something works with `sh`, it almost certainly works with `bash`. Of course there are edge cases where it might not work, but I doubt that it is as much a problem as you think.



---

archive/issue_events_336343.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-01-09T12:31:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336343"
}
```



---

archive/issue_events_336344.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-01-09T12:31:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336344"
}
```



---

archive/issue_comments_370751.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2018-01-09T12:31:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370751",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_370752.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nMy experience with FreeBSD (with /bin/sh not being bash at all) tells me that making /bin/sh a link to bash allows Sage to build just fine. It breaks other components of the OS, naturally, but it's beside the point, which is that it's actually safe to use bash everywhere where there is /bin/sh (at least the one on FreeBSD) invocation in Sage.",
    "created_at": "2018-01-09T12:31:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370752",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">comment:21</div>

My experience with FreeBSD (with /bin/sh not being bash at all) tells me that making /bin/sh a link to bash allows Sage to build just fine. It breaks other components of the OS, naturally, but it's beside the point, which is that it's actually safe to use bash everywhere where there is /bin/sh (at least the one on FreeBSD) invocation in Sage.



---

archive/issue_comments_370753.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\n+1\n\nRelated question I've been wondering about for a while (while we're discussing it here): Do we require GNU make for Sage, or should any POSIX-compatible make work?  I would very much like to make use of GNU-specific features (e.g. #21524) and I'm not 100% sure if all of Sage's packages will work with a generic make but it's never been clear to me if that's a requirement or not.",
    "created_at": "2018-01-09T13:20:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370753",
    "user": "https://github.com/embray"
}
```

<div id="comment:22" align="right">comment:22</div>

+1

Related question I've been wondering about for a while (while we're discussing it here): Do we require GNU make for Sage, or should any POSIX-compatible make work?  I would very much like to make use of GNU-specific features (e.g. #21524) and I'm not 100% sure if all of Sage's packages will work with a generic make but it's never been clear to me if that's a requirement or not.



---

archive/issue_comments_370754.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@jdemeyer](#comment%3A20):\n> Replying to [@kiwifb](#comment%3A19):\n> > And on some system `sh` is actually `dash`. There are differences between `bash`, `dash` and `sh` (as one would expect). When `sh` is actually `bash` for example it is not just a link. When `bash` is invoked as `sh` a special profile is loaded, some bash functions are defined to match `sh` requirements and so on. Probably similarly for `dash`. If you just `CONFIG_SHELL=bash` everywhere you will get a surprise sooner rather than later because those functions won't be there.\n> \n> \n> I always assumed that `bash` is essentially `sh` with extra features (a bit like C++ is C with extra features). Meaning that if something works with `sh`, it almost certainly works with `bash`. Of course there are edge cases where it might not work, but I doubt that it is as much a problem as you think.\n\n\nBeen there, done that, got the T-shirt. Proof is in the pudding, someone should do a complete build. My experience is that a libtool component will break sooner rather than later.",
    "created_at": "2018-01-09T18:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370754",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@jdemeyer](#comment%3A20):
> Replying to [@kiwifb](#comment%3A19):
> > And on some system `sh` is actually `dash`. There are differences between `bash`, `dash` and `sh` (as one would expect). When `sh` is actually `bash` for example it is not just a link. When `bash` is invoked as `sh` a special profile is loaded, some bash functions are defined to match `sh` requirements and so on. Probably similarly for `dash`. If you just `CONFIG_SHELL=bash` everywhere you will get a surprise sooner rather than later because those functions won't be there.
> 
> 
> I always assumed that `bash` is essentially `sh` with extra features (a bit like C++ is C with extra features). Meaning that if something works with `sh`, it almost certainly works with `bash`. Of course there are edge cases where it might not work, but I doubt that it is as much a problem as you think.


Been there, done that, got the T-shirt. Proof is in the pudding, someone should do a complete build. My experience is that a libtool component will break sooner rather than later.



---

archive/issue_comments_370755.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@embray](#comment%3A22):\n> +1\n> \n> Related question I've been wondering about for a while (while we're discussing it here): Do we require GNU make for Sage, or should any POSIX-compatible make work?  I would very much like to make use of GNU-specific features (e.g. #21524) and I'm not 100% sure if all of Sage's packages will work with a generic make but it's never been clear to me if that's a requirement or not.\n\nGNU make is needed. Once upon a time (in 2008) me and a debian developper at the time tried to patch packages to be able to use other `make`. We did go exactly nowhere. Fully autotooled packages are probably OK, it is all the custom ones that are troublesome - and it is so easy to use GNUism in make because they are so useful...",
    "created_at": "2018-01-09T18:09:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370755",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@embray](#comment%3A22):
> +1
> 
> Related question I've been wondering about for a while (while we're discussing it here): Do we require GNU make for Sage, or should any POSIX-compatible make work?  I would very much like to make use of GNU-specific features (e.g. #21524) and I'm not 100% sure if all of Sage's packages will work with a generic make but it's never been clear to me if that's a requirement or not.

GNU make is needed. Once upon a time (in 2008) me and a debian developper at the time tried to patch packages to be able to use other `make`. We did go exactly nowhere. Fully autotooled packages are probably OK, it is all the custom ones that are troublesome - and it is so easy to use GNUism in make because they are so useful...



---

archive/issue_comments_370756.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nNot much documentation on what bash does when it is invoked as sh. According to the doc it change mainly two things: the files it reads at start up and it is basically run with the `--posix` option. So adding `--posix` as an option may be enough to get out of all the potential problems. I wish I had an opportunity to test that when I found the various problems I mentioned earlier.",
    "created_at": "2018-01-09T20:50:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370756",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Not much documentation on what bash does when it is invoked as sh. According to the doc it change mainly two things: the files it reads at start up and it is basically run with the `--posix` option. So adding `--posix` as an option may be enough to get out of all the potential problems. I wish I had an opportunity to test that when I found the various problems I mentioned earlier.



---

archive/issue_comments_370757.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/sdh_configure_should_use_bash](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sdh_configure_should_use_bash)** to **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)**",
    "created_at": "2018-01-14T10:14:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370757",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/sdh_configure_should_use_bash](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sdh_configure_should_use_bash)** to **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)**



---

archive/issue_events_336345.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:14:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336345"
}
```



---

archive/issue_events_336346.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f2248bd51fa20e513075ba158c07ced206829af9",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-01-14T10:14:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24491#event-336346"
}
```



---

archive/issue_comments_370758.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@kiwifb](#comment%3A24):\n> Replying to [@embray](#comment%3A22):\n> > +1\n> > \n> > Related question I've been wondering about for a while (while we're discussing it here): Do we require GNU make for Sage, or should any POSIX-compatible make work?  I would very much like to make use of GNU-specific features (e.g. #21524) and I'm not 100% sure if all of Sage's packages will work with a generic make but it's never been clear to me if that's a requirement or not.\n> \n> \n> GNU make is needed. Once upon a time (in 2008) me and a debian developper at the time tried to patch packages to be able to use other `make`. We did go exactly nowhere. Fully autotooled packages are probably OK, it is all the custom ones that are troublesome - and it is so easy to use GNUism in make because they are so useful...\n\nGood, I'm glad.  While this is a problem autotools is supposed to solve that's not a universal solution anyways.",
    "created_at": "2018-01-16T17:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370758",
    "user": "https://github.com/embray"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@kiwifb](#comment%3A24):
> Replying to [@embray](#comment%3A22):
> > +1
> > 
> > Related question I've been wondering about for a while (while we're discussing it here): Do we require GNU make for Sage, or should any POSIX-compatible make work?  I would very much like to make use of GNU-specific features (e.g. #21524) and I'm not 100% sure if all of Sage's packages will work with a generic make but it's never been clear to me if that's a requirement or not.
> 
> 
> GNU make is needed. Once upon a time (in 2008) me and a debian developper at the time tried to patch packages to be able to use other `make`. We did go exactly nowhere. Fully autotooled packages are probably OK, it is all the custom ones that are troublesome - and it is so easy to use GNUism in make because they are so useful...

Good, I'm glad.  While this is a problem autotools is supposed to solve that's not a universal solution anyways.



---

archive/issue_comments_370759.json:
```json
{
    "body": "Changed commit from **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)** to none",
    "created_at": "2018-01-16T17:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24491#issuecomment-370759",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`f0e2bd8`](https://github.com/sagemath/sagetrac-mirror/commit/f0e2bd8e9eb4712490d355e56ae57af3947ff661)** to none
