# Issue 24282: BooleanFunction.truth_table(format="hex") returns wrong values

archive/issues_024045.json:
```json
{
    "body": "Sometimes, especially with functions of 8 variables, the method `BooleanFunction.truth_table(format='hex\")` returns incorrect values that are also too long.\n\nExample:\n\n```\nsage: from sage.rings.integer_ring import ZZ\nsage: from sage.crypto.boolean_function import BooleanFunction\nsage: hex_str = \"0123456789112345678921234567893123456789412345678951234567896123\"\nsage: len(hex_str)\n64\nsage: bf = BooleanFunction(hex_str)\nsage: bf.nvariables()\n8\nsage: bf_tt_hex = bf.truth_table(format=\"hex\")\nsage: bf_tt_hex\n'123456789112345678921234567893123456789412345670123456789112345678921234567893123456789412345678951234567896123'\nsage: len(bf_tt_hex)\n111\nsage: S = ZZ(bf.truth_table(), 2).str(16)\nsage: padding = \"0\" * ((1 << (bf.nvariables() - 2)) - len(S))\nsage: tt_hex = padding + S\nsage: tt_hex\n'0123456789112345678921234567893123456789412345678951234567896123'\nsage: len(tt_hex)\n64\n```\n\nThe example also shows how the code in  https://github.com/sagemath/sage/blob/develop/src/sage/crypto/boolean_function.pyx lines 566 to 576 should be fixed. A suggested patch is attached. \n\nThe example can also be used as the basis for a test case once the patch has been applied.\n\n\n\nBranch/Commit: [eeaebe309317a0df13b561db53384d5b758a61af](https://github.com/sagemath/sagetrac-mirror/commit/eeaebe309317a0df13b561db53384d5b758a61af)\n\nReviewer: Dima Pasechnik\n\nAuthor: Paul Leopardi\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24282\n\n",
    "closed_at": "2017-12-13T17:37:52Z",
    "created_at": "2017-11-26T11:14:36Z",
    "labels": [
        "component: cryptography",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "BooleanFunction.truth_table(format=\"hex\") returns wrong values",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24282",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```
Sometimes, especially with functions of 8 variables, the method `BooleanFunction.truth_table(format='hex")` returns incorrect values that are also too long.

Example:

```
sage: from sage.rings.integer_ring import ZZ
sage: from sage.crypto.boolean_function import BooleanFunction
sage: hex_str = "0123456789112345678921234567893123456789412345678951234567896123"
sage: len(hex_str)
64
sage: bf = BooleanFunction(hex_str)
sage: bf.nvariables()
8
sage: bf_tt_hex = bf.truth_table(format="hex")
sage: bf_tt_hex
'123456789112345678921234567893123456789412345670123456789112345678921234567893123456789412345678951234567896123'
sage: len(bf_tt_hex)
111
sage: S = ZZ(bf.truth_table(), 2).str(16)
sage: padding = "0" * ((1 << (bf.nvariables() - 2)) - len(S))
sage: tt_hex = padding + S
sage: tt_hex
'0123456789112345678921234567893123456789412345678951234567896123'
sage: len(tt_hex)
64
```

The example also shows how the code in  https://github.com/sagemath/sage/blob/develop/src/sage/crypto/boolean_function.pyx lines 566 to 576 should be fixed. A suggested patch is attached. 

The example can also be used as the basis for a test case once the patch has been applied.



Branch/Commit: [eeaebe309317a0df13b561db53384d5b758a61af](https://github.com/sagemath/sagetrac-mirror/commit/eeaebe309317a0df13b561db53384d5b758a61af)

Reviewer: Dima Pasechnik

Author: Paul Leopardi

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24282





---

archive/issue_comments_461941.json:
```json
{
    "body": "Attachment [boolean_function-correct_truth_table_hex.patch](tarball://root/attachments/some-uuid/ticket24282/boolean_function-correct_truth_table_hex.patch) by pleopardi created at 2017-11-26 11:16:16\n\nPatch to boolean_function.pyx to retrun correct value for truth_table(format='hex')",
    "created_at": "2017-11-26T11:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461941",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

Attachment [boolean_function-correct_truth_table_hex.patch](tarball://root/attachments/some-uuid/ticket24282/boolean_function-correct_truth_table_hex.patch) by pleopardi created at 2017-11-26 11:16:16

Patch to boolean_function.pyx to retrun correct value for truth_table(format='hex')



---

archive/issue_events_069907.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-11-26T11:50:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24282#event-69907"
}
```



---

archive/issue_comments_461942.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Sometimes, especially with functions of 8 variables, the method BooleanFunction.truth_table(format='hex\") returns incorrect values that are also too long.\n+Sometimes, especially with functions of 8 variables, the method `BooleanFunction.truth_table(format='hex\")` returns incorrect values that are also too long.\n \n Example:\n \n``````\n",
    "created_at": "2017-11-26T11:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461942",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Sometimes, especially with functions of 8 variables, the method BooleanFunction.truth_table(format='hex") returns incorrect values that are also too long.
+Sometimes, especially with functions of 8 variables, the method `BooleanFunction.truth_table(format='hex")` returns incorrect values that are also too long.
 
 Example:
 
``````




---

archive/issue_comments_461943.json:
```json
{
    "body": "<a id='comment:1'></a>\nThanks. Could you provide a test example and a git branch for the fix, too?",
    "created_at": "2017-11-26T11:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461943",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
Thanks. Could you provide a test example and a git branch for the fix, too?



---

archive/issue_comments_461944.json:
```json
{
    "body": "<a id='comment:2'></a>\nA working test example may take me a little time as I have not yet built Sage from Git. I could mock up a test example for someone else to test, if that is acceptable.",
    "created_at": "2017-11-28T12:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461944",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

<a id='comment:2'></a>
A working test example may take me a little time as I have not yet built Sage from Git. I could mock up a test example for someone else to test, if that is acceptable.



---

archive/issue_comments_461945.json:
```json
{
    "body": "<a id='comment:3'></a>\nAlso, I am new at providing Git branches for Sage. I will carefully read the instructions at http://doc.sagemath.org/html/en/developer/manual_git.html and use them to provide a Git branch. This may have to wait until the weekend.",
    "created_at": "2017-11-28T12:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461945",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

<a id='comment:3'></a>
Also, I am new at providing Git branches for Sage. I will carefully read the instructions at http://doc.sagemath.org/html/en/developer/manual_git.html and use them to provide a Git branch. This may have to wait until the weekend.



---

archive/issue_comments_461946.json:
```json
{
    "body": "Changing commit from \"\" to \"d22ccd3ccd1e79d5f6153e54c0dbefa89bf93139\"",
    "created_at": "2017-12-02T08:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461946",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

Changing commit from "" to "d22ccd3ccd1e79d5f6153e54c0dbefa89bf93139"



---

archive/issue_comments_461947.json:
```json
{
    "body": "<a id='comment:4'></a>\nAs far as I can tell, I have pushed my recommended changes to the branch u/pleopardi/fix_boolean_function_truth_table_hex\n\nThis is the first time I have created a branch in trac, so I may have made a mistake that I'm not aware of.",
    "created_at": "2017-12-02T08:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461947",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

<a id='comment:4'></a>
As far as I can tell, I have pushed my recommended changes to the branch u/pleopardi/fix_boolean_function_truth_table_hex

This is the first time I have created a branch in trac, so I may have made a mistake that I'm not aware of.



---

archive/issue_comments_461948.json:
```json
{
    "body": "Changing branch from \"\" to \"u/pleopardi/fix_boolean_function_truth_table_hex\"",
    "created_at": "2017-12-02T08:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461948",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

Changing branch from "" to "u/pleopardi/fix_boolean_function_truth_table_hex"



---

archive/issue_comments_461949.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-12-02T08:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461949",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_461950.json:
```json
{
    "body": "<a id='comment:5'></a>\nI would have cut most of these \n\n```\nsage: len(T)\n...\n```\nfrom the example in your branch.\nHave you tried building the documentation with this branch applied?",
    "created_at": "2017-12-04T23:33:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461950",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
I would have cut most of these 

```
sage: len(T)
...
```
from the example in your branch.
Have you tried building the documentation with this branch applied?



---

archive/issue_comments_461951.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|\n|[eeaebe3](https://github.com/sagemath/sagetrac-mirror/commit/eeaebe309317a0df13b561db53384d5b758a61af)|`Remove some len expressions from doctest for BooleanFunction.truth_table`|",
    "created_at": "2017-12-06T08:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461951",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
|[eeaebe3](https://github.com/sagemath/sagetrac-mirror/commit/eeaebe309317a0df13b561db53384d5b758a61af)|`Remove some len expressions from doctest for BooleanFunction.truth_table`|



---

archive/issue_comments_461952.json:
```json
{
    "body": "Changing commit from \"d22ccd3ccd1e79d5f6153e54c0dbefa89bf93139\" to \"eeaebe309317a0df13b561db53384d5b758a61af\"",
    "created_at": "2017-12-06T08:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461952",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d22ccd3ccd1e79d5f6153e54c0dbefa89bf93139" to "eeaebe309317a0df13b561db53384d5b758a61af"



---

archive/issue_comments_461953.json:
```json
{
    "body": "<a id='comment:7'></a>\nI have now cut some of the len expressions from the doctest, have retested sage/crypto, and have tried rebuilding the documentation. All seems fine to me.",
    "created_at": "2017-12-06T08:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461953",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

<a id='comment:7'></a>
I have now cut some of the len expressions from the doctest, have retested sage/crypto, and have tried rebuilding the documentation. All seems fine to me.



---

archive/issue_comments_461954.json:
```json
{
    "body": "<a id='comment:8'></a>\nLooks good to me; however, it probably needs testing on a 32-bit machine. Hopefully a patchbot will do.\n\nPS. Please enter the author's name in Authors.",
    "created_at": "2017-12-06T09:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461954",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
Looks good to me; however, it probably needs testing on a 32-bit machine. Hopefully a patchbot will do.

PS. Please enter the author's name in Authors.



---

archive/issue_comments_461955.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2017-12-06T09:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461955",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_461956.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-12-06T09:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461956",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_461957.json:
```json
{
    "body": "<a id='comment:9'></a>\nI have added my name to Authors.",
    "created_at": "2017-12-06T12:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461957",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

<a id='comment:9'></a>
I have added my name to Authors.



---

archive/issue_comments_461958.json:
```json
{
    "body": "Changing author from \"\" to \"Paul Leopardi\"",
    "created_at": "2017-12-06T12:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461958",
    "user": "https://trac.sagemath.org/admin/accounts/users/pleopardi"
}
```

Changing author from "" to "Paul Leopardi"



---

archive/issue_events_069908.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-13T17:37:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24282#event-69908"
}
```



---

archive/issue_comments_461959.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-12-13T17:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461959",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_461960.json:
```json
{
    "body": "Changing branch from \"u/pleopardi/fix_boolean_function_truth_table_hex\" to \"eeaebe309317a0df13b561db53384d5b758a61af\"",
    "created_at": "2017-12-13T17:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24282",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24282#issuecomment-461960",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/pleopardi/fix_boolean_function_truth_table_hex" to "eeaebe309317a0df13b561db53384d5b758a61af"
