# Issue 24015: fix libhomfly on OSX

archive/issues_023778.json:
```json
{
    "assignees": [],
    "body": "as reported on [sage-devel ](https://groups.google.com/d/msg/sage-devel/bOG0Xg2HmvU/m1DsYpFwAQAJ) linking on OSX fails with \"duplicate symbol\" errors.\n\n```\n[libhomfly-1.0r2] libtool: link: cc -dynamiclib -Wl,-undefined -Wl,dynamic_lookup -o .libs/libhomfly.0.dylib  .libs/bound.o .libs/control.o .libs/dllink.o .libs/homfly.o .libs/knot.o .libs/model.o .libs/order.o .libs/poly.o   -lgc -L/Volumes/Sage/sage/local/lib  -g -O2 -Wl,-rpath -Wl,/Volumes/Sage/sage/local/lib   -install_name  /Volumes/Sage/sage/local/lib/libhomfly.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module -Wl,-exported_symbols_list,.libs/libhomfly-symbols.expsym\n[libhomfly-1.0r2] duplicate symbol _first in:\n[libhomfly-1.0r2]     .libs/bound.o\n[libhomfly-1.0r2]     .libs/control.o\n[libhomfly-1.0r2] duplicate symbol _list in:\n[libhomfly-1.0r2]     .libs/bound.o\n[libhomfly-1.0r2]     .libs/control.o\n...\n```\n\nthere is also an error in poly.c, where a non-void function returns nothing.\nThis is trivially fixed by\n\n```\ndiff --git a/lib/poly.c b/lib/poly.c\nindex 48e9a68..307d1de 100644\n--- a/lib/poly.c\n+++ b/lib/poly.c\n@@ -76,7 +76,7 @@ char *p_show(Poly *p)\n   {\n     fprintf(stream, \"0\");\n     fclose(stream);\n-    return;\n+    return NULL;\n   }\n \n   for (first = 1, pt = p->term, pend = pt+p->len; pt != pend; ++pt)\n```\n\n\n---\nAs it was being fixed, more problems were uncovered, and then a pesky GC bug, that went away after adding an explicit `GC_INIT()` call.\n\nIt appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11\n\nthe (official!) tarball is here: \nhttps://github.com/miguelmarco/libhomfly/releases/download/1.02r4/libhomfly-1.02r4.tar.gz\n\nCC:  @embray @miguelmarco\n\nBranch/Commit: **[f3349e0](https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf)**\n\nUpstream: **Completely fixed; Fix reported upstream**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24015_\n\n",
    "closed_at": "2017-12-11T01:02:54Z",
    "created_at": "2017-10-11T22:25:30Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix libhomfly on OSX",
    "type": "issue",
    "updated_at": "2017-12-11T01:02:54Z",
    "url": "https://github.com/sagemath/sage/issues/24015",
    "user": "https://github.com/dimpase"
}
```
as reported on [sage-devel ](https://groups.google.com/d/msg/sage-devel/bOG0Xg2HmvU/m1DsYpFwAQAJ) linking on OSX fails with "duplicate symbol" errors.

```
[libhomfly-1.0r2] libtool: link: cc -dynamiclib -Wl,-undefined -Wl,dynamic_lookup -o .libs/libhomfly.0.dylib  .libs/bound.o .libs/control.o .libs/dllink.o .libs/homfly.o .libs/knot.o .libs/model.o .libs/order.o .libs/poly.o   -lgc -L/Volumes/Sage/sage/local/lib  -g -O2 -Wl,-rpath -Wl,/Volumes/Sage/sage/local/lib   -install_name  /Volumes/Sage/sage/local/lib/libhomfly.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module -Wl,-exported_symbols_list,.libs/libhomfly-symbols.expsym
[libhomfly-1.0r2] duplicate symbol _first in:
[libhomfly-1.0r2]     .libs/bound.o
[libhomfly-1.0r2]     .libs/control.o
[libhomfly-1.0r2] duplicate symbol _list in:
[libhomfly-1.0r2]     .libs/bound.o
[libhomfly-1.0r2]     .libs/control.o
...
```

there is also an error in poly.c, where a non-void function returns nothing.
This is trivially fixed by

```
diff --git a/lib/poly.c b/lib/poly.c
index 48e9a68..307d1de 100644
--- a/lib/poly.c
+++ b/lib/poly.c
@@ -76,7 +76,7 @@ char *p_show(Poly *p)
   {
     fprintf(stream, "0");
     fclose(stream);
-    return;
+    return NULL;
   }
 
   for (first = 1, pt = p->term, pend = pt+p->len; pt != pend; ++pt)
```


---
As it was being fixed, more problems were uncovered, and then a pesky GC bug, that went away after adding an explicit `GC_INIT()` call.

It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11

the (official!) tarball is here: 
https://github.com/miguelmarco/libhomfly/releases/download/1.02r4/libhomfly-1.02r4.tar.gz

CC:  @embray @miguelmarco

Branch/Commit: **[f3349e0](https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf)**

Upstream: **Completely fixed; Fix reported upstream**

Reviewer: **Jeroen Demeyer**

Author: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/24015_





---

archive/issue_events_315417.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-10-11T22:25:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315417"
}
```



---

archive/issue_events_315418.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-10-11T22:25:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315418"
}
```



---

archive/issue_events_315419.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-10-11T22:25:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315419"
}
```



---

archive/issue_events_315420.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-10-11T22:25:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315420"
}
```



---

archive/issue_comments_365436.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,31 @@\n-as reported on [sage-devel https://groups.google.com/d/msg/sage-devel/bOG0Xg2HmvU/m1DsYpFwAQAJ] linking on OSX fails with \"duplicate symbol\" errors.\n+as reported on [sage-devel ](https://groups.google.com/d/msg/sage-devel/bOG0Xg2HmvU/m1DsYpFwAQAJ) linking on OSX fails with \"duplicate symbol\" errors.\n+\n+```\n+[libhomfly-1.0r2] libtool: link: cc -dynamiclib -Wl,-undefined -Wl,dynamic_lookup -o .libs/libhomfly.0.dylib  .libs/bound.o .libs/control.o .libs/dllink.o .libs/homfly.o .libs/knot.o .libs/model.o .libs/order.o .libs/poly.o   -lgc -L/Volumes/Sage/sage/local/lib  -g -O2 -Wl,-rpath -Wl,/Volumes/Sage/sage/local/lib   -install_name  /Volumes/Sage/sage/local/lib/libhomfly.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module -Wl,-exported_symbols_list,.libs/libhomfly-symbols.expsym\n+[libhomfly-1.0r2] duplicate symbol _first in:\n+[libhomfly-1.0r2]     .libs/bound.o\n+[libhomfly-1.0r2]     .libs/control.o\n+[libhomfly-1.0r2] duplicate symbol _list in:\n+[libhomfly-1.0r2]     .libs/bound.o\n+[libhomfly-1.0r2]     .libs/control.o\n+...\n+```\n+\n+there is also an error in poly.c, where a non-void function returns nothing.\n+This is trivially fixed by\n+\n+```\n+diff --git a/lib/poly.c b/lib/poly.c\n+index 48e9a68..307d1de 100644\n+--- a/lib/poly.c\n++++ b/lib/poly.c\n+@@ -76,7 +76,7 @@ char *p_show(Poly *p)\n+   {\n+     fprintf(stream, \"0\");\n+     fclose(stream);\n+-    return;\n++    return NULL;\n+   }\n+ \n+   for (first = 1, pt = p->term, pend = pt+p->len; pt != pend; ++pt)\n+```\n``````\n",
    "created_at": "2017-10-11T22:30:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365436",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,31 @@
-as reported on [sage-devel https://groups.google.com/d/msg/sage-devel/bOG0Xg2HmvU/m1DsYpFwAQAJ] linking on OSX fails with "duplicate symbol" errors.
+as reported on [sage-devel ](https://groups.google.com/d/msg/sage-devel/bOG0Xg2HmvU/m1DsYpFwAQAJ) linking on OSX fails with "duplicate symbol" errors.
+
+```
+[libhomfly-1.0r2] libtool: link: cc -dynamiclib -Wl,-undefined -Wl,dynamic_lookup -o .libs/libhomfly.0.dylib  .libs/bound.o .libs/control.o .libs/dllink.o .libs/homfly.o .libs/knot.o .libs/model.o .libs/order.o .libs/poly.o   -lgc -L/Volumes/Sage/sage/local/lib  -g -O2 -Wl,-rpath -Wl,/Volumes/Sage/sage/local/lib   -install_name  /Volumes/Sage/sage/local/lib/libhomfly.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module -Wl,-exported_symbols_list,.libs/libhomfly-symbols.expsym
+[libhomfly-1.0r2] duplicate symbol _first in:
+[libhomfly-1.0r2]     .libs/bound.o
+[libhomfly-1.0r2]     .libs/control.o
+[libhomfly-1.0r2] duplicate symbol _list in:
+[libhomfly-1.0r2]     .libs/bound.o
+[libhomfly-1.0r2]     .libs/control.o
+...
+```
+
+there is also an error in poly.c, where a non-void function returns nothing.
+This is trivially fixed by
+
+```
+diff --git a/lib/poly.c b/lib/poly.c
+index 48e9a68..307d1de 100644
+--- a/lib/poly.c
++++ b/lib/poly.c
+@@ -76,7 +76,7 @@ char *p_show(Poly *p)
+   {
+     fprintf(stream, "0");
+     fclose(stream);
+-    return;
++    return NULL;
+   }
+ 
+   for (first = 1, pt = p->term, pend = pt+p->len; pt != pend; ++pt)
+```
``````




---

archive/issue_comments_365437.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2017-10-12T09:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365437",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_comments_365438.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI have a fix for the C code madness, now onto some cython trouble, hopefully minor:\n\n```\nsage -t --warn-long 231.9 src/sage/libs/homfly.pyx\n**********************************************************************\nFile \"src/sage/libs/homfly.pyx\", line 65, in sage.libs.homfly.homfly_polynomial_string\nFailed example:\n    from sage.libs.homfly import homfly_polynomial_string # optional - libhomfly\nException raised:\n    Traceback (most recent call last):\n      File \"/Volumes/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 515, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Volumes/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 885, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.libs.homfly.homfly_polynomial_string[0]>\", line 1, in <module>\n        from sage.libs.homfly import homfly_polynomial_string # optional - libhomfly\n    ImportError: dlopen(/Volumes/Sage/sage/local/lib/python2.7/site-packages/sage/libs/homfly.so, 2): Symbol not found: _fmemopen\n      Referenced from: /Volumes/Sage/sage/local/lib/libhomfly.0.dylib\n      Expected in: flat namespace\n     in /Volumes/Sage/sage/local/lib/libhomfly.0.dylib\n**********************************************************************\n```",
    "created_at": "2017-10-12T09:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365438",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">Comment 2</div>

I have a fix for the C code madness, now onto some cython trouble, hopefully minor:

```
sage -t --warn-long 231.9 src/sage/libs/homfly.pyx
**********************************************************************
File "src/sage/libs/homfly.pyx", line 65, in sage.libs.homfly.homfly_polynomial_string
Failed example:
    from sage.libs.homfly import homfly_polynomial_string # optional - libhomfly
Exception raised:
    Traceback (most recent call last):
      File "/Volumes/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Volumes/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.libs.homfly.homfly_polynomial_string[0]>", line 1, in <module>
        from sage.libs.homfly import homfly_polynomial_string # optional - libhomfly
    ImportError: dlopen(/Volumes/Sage/sage/local/lib/python2.7/site-packages/sage/libs/homfly.so, 2): Symbol not found: _fmemopen
      Referenced from: /Volumes/Sage/sage/local/lib/libhomfly.0.dylib
      Expected in: flat namespace
     in /Volumes/Sage/sage/local/lib/libhomfly.0.dylib
**********************************************************************
```



---

archive/issue_comments_365439.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nduh, there is no `fmemopen` on OSX, as simple as this...",
    "created_at": "2017-10-12T09:30:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365439",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">Comment 3</div>

duh, there is no `fmemopen` on OSX, as simple as this...



---

archive/issue_comments_365440.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nC changes proposed to upstream: https://github.com/miguelmarco/libhomfly/pull/8",
    "created_at": "2017-10-12T09:54:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365440",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">Comment 4</div>

C changes proposed to upstream: https://github.com/miguelmarco/libhomfly/pull/8



---

archive/issue_comments_365441.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2017-10-12T09:54:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365441",
    "user": "https://github.com/dimpase"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_365442.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2017-10-20T18:31:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365442",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_365443.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nstill, for OSX we need to update GC to a very recent version, see https://github.com/miguelmarco/libhomfly/pull/8 for details.",
    "created_at": "2017-10-20T18:31:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365443",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">Comment 5</div>

still, for OSX we need to update GC to a very recent version, see https://github.com/miguelmarco/libhomfly/pull/8 for details.



---

archive/issue_comments_365444.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -29,3 +29,10 @@\n  \n    for (first = 1, pt = p->term, pend = pt+p->len; pt != pend; ++pt)\n ```\n+\n+\n+---\n+\n+It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11\n+\n+the POC non-official tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.1.tar.gz\n``````\n",
    "created_at": "2017-12-06T09:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365444",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -29,3 +29,10 @@
  
    for (first = 1, pt = p->term, pend = pt+p->len; pt != pend; ++pt)
 ```
+
+
+---
+
+It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11
+
+the POC non-official tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.1.tar.gz
``````




---

archive/issue_events_315421.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-06T09:50:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315421"
}
```



---

archive/issue_comments_365445.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nthe last remaining problem was the lack of `GC_INIT()` call in the library (something that is apparently not needed on Linux, but the docs\nsay that that some platforms might need it...)\n\nWith https://github.com/miguelmarco/libhomfly/pull/11\nit is all fixed, also on the current Sage's GC version on OSX.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3c3ac74800c71d07316bdc273f6cb8ada30504c\">a3c3ac7</a></td><td><code>new version and checksum</code></td></tr></table>\n",
    "created_at": "2017-12-06T09:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365445",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

the last remaining problem was the lack of `GC_INIT()` call in the library (something that is apparently not needed on Linux, but the docs
say that that some platforms might need it...)

With https://github.com/miguelmarco/libhomfly/pull/11
it is all fixed, also on the current Sage's GC version on OSX.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3c3ac74800c71d07316bdc273f6cb8ada30504c">a3c3ac7</a></td><td><code>new version and checksum</code></td></tr></table>




---

archive/issue_events_315422.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-06T09:50:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315422"
}
```



---

archive/issue_events_315423.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-06T09:50:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315423"
}
```



---

archive/issue_comments_365446.json:
```json
{
    "body": "Commit: **[a3c3ac7](https://github.com/sagemath/sagetrac-mirror/commit/a3c3ac74800c71d07316bdc273f6cb8ada30504c)**",
    "created_at": "2017-12-06T09:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365446",
    "user": "https://github.com/dimpase"
}
```

Commit: **[a3c3ac7](https://github.com/sagemath/sagetrac-mirror/commit/a3c3ac74800c71d07316bdc273f6cb8ada30504c)**



---

archive/issue_comments_365447.json:
```json
{
    "body": "Branch: **[u/dimpase/libhomflyfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/libhomflyfix)**",
    "created_at": "2017-12-06T09:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365447",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/libhomflyfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/libhomflyfix)**



---

archive/issue_comments_365448.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nNB: the tarball is just a proof of concept, corresponding to commit b68b5b2aac2e89b17312208080562f5754d3da2d\non https://github.com/dimpase/libhomfly\n\nOnce the upstream is done with merging, we should get the official tarball...",
    "created_at": "2017-12-06T09:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365448",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">Comment 7</div>

NB: the tarball is just a proof of concept, corresponding to commit b68b5b2aac2e89b17312208080562f5754d3da2d
on https://github.com/dimpase/libhomfly

Once the upstream is done with merging, we should get the official tarball...



---

archive/issue_comments_365449.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI made a new release upstream. It is https://github.com/miguelmarco/libhomfly/releases/tag/1.02r4\n\nThe tarball is at\nhttps://github.com/miguelmarco/libhomfly/archive/1.02r4.tar.gz",
    "created_at": "2017-12-06T11:21:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365449",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:8" align="right">Comment 8</div>

I made a new release upstream. It is https://github.com/miguelmarco/libhomfly/releases/tag/1.02r4

The tarball is at
https://github.com/miguelmarco/libhomfly/archive/1.02r4.tar.gz



---

archive/issue_comments_365450.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c623d6b4355df57d8e53f4fb9ea6299704d19321\">c623d6b</a></td><td><code>new version and checksum</code></td></tr></table>\n",
    "created_at": "2017-12-06T12:02:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365450",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9" align="right">Comment 9</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c623d6b4355df57d8e53f4fb9ea6299704d19321">c623d6b</a></td><td><code>new version and checksum</code></td></tr></table>




---

archive/issue_comments_365451.json:
```json
{
    "body": "Changed commit from **[a3c3ac7](https://github.com/sagemath/sagetrac-mirror/commit/a3c3ac74800c71d07316bdc273f6cb8ada30504c)** to **[c623d6b](https://github.com/sagemath/sagetrac-mirror/commit/c623d6b4355df57d8e53f4fb9ea6299704d19321)**",
    "created_at": "2017-12-06T12:02:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365451",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a3c3ac7](https://github.com/sagemath/sagetrac-mirror/commit/a3c3ac74800c71d07316bdc273f6cb8ada30504c)** to **[c623d6b](https://github.com/sagemath/sagetrac-mirror/commit/c623d6b4355df57d8e53f4fb9ea6299704d19321)**



---

archive/issue_comments_365452.json:
```json
{
    "body": "Changed commit from **[c623d6b](https://github.com/sagemath/sagetrac-mirror/commit/c623d6b4355df57d8e53f4fb9ea6299704d19321)** to **[5b5e57b](https://github.com/sagemath/sagetrac-mirror/commit/5b5e57b59b5e9f7cbf071e704720def4b3bbab94)**",
    "created_at": "2017-12-06T12:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365452",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c623d6b](https://github.com/sagemath/sagetrac-mirror/commit/c623d6b4355df57d8e53f4fb9ea6299704d19321)** to **[5b5e57b](https://github.com/sagemath/sagetrac-mirror/commit/5b5e57b59b5e9f7cbf071e704720def4b3bbab94)**



---

archive/issue_comments_365453.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b5e57b59b5e9f7cbf071e704720def4b3bbab94\">5b5e57b</a></td><td><code>new version and checksum; minor SPKG.txt update</code></td></tr></table>\n",
    "created_at": "2017-12-06T12:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365453",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10" align="right">Comment 10</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b5e57b59b5e9f7cbf071e704720def4b3bbab94">5b5e57b</a></td><td><code>new version and checksum; minor SPKG.txt update</code></td></tr></table>




---

archive/issue_comments_365454.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f277d991bc884663782ff23b5663b103b7d4ed2\">7f277d9</a></td><td><code>tarball needs autoreconf run, thus updated</code></td></tr></table>\n",
    "created_at": "2017-12-06T12:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365454",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11" align="right">Comment 11</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f277d991bc884663782ff23b5663b103b7d4ed2">7f277d9</a></td><td><code>tarball needs autoreconf run, thus updated</code></td></tr></table>




---

archive/issue_comments_365455.json:
```json
{
    "body": "Changed commit from **[5b5e57b](https://github.com/sagemath/sagetrac-mirror/commit/5b5e57b59b5e9f7cbf071e704720def4b3bbab94)** to **[7f277d9](https://github.com/sagemath/sagetrac-mirror/commit/7f277d991bc884663782ff23b5663b103b7d4ed2)**",
    "created_at": "2017-12-06T12:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365455",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5b5e57b](https://github.com/sagemath/sagetrac-mirror/commit/5b5e57b59b5e9f7cbf071e704720def4b3bbab94)** to **[7f277d9](https://github.com/sagemath/sagetrac-mirror/commit/7f277d991bc884663782ff23b5663b103b7d4ed2)**



---

archive/issue_comments_365456.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nI had to update the tarball from github by running `autoreconf -if` and re-tarring then.\n\nShould all be ready now.",
    "created_at": "2017-12-06T12:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365456",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">Comment 12</div>

I had to update the tarball from github by running `autoreconf -if` and re-tarring then.

Should all be ready now.



---

archive/issue_comments_365457.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -35,4 +35,4 @@\n \n It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11\n \n-the POC non-official tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.1.tar.gz\n+the tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.02r4.tar.gz\n``````\n",
    "created_at": "2017-12-06T12:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365457",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -35,4 +35,4 @@
 
 It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11
 
-the POC non-official tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.1.tar.gz
+the tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.02r4.tar.gz
``````




---

archive/issue_events_315424.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-12-06T17:48:43Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "title_is": "fix libhomfly on OSX",
    "title_was": "fix libhomfly building on OSX",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315424"
}
```



---

archive/issue_comments_365458.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nOne little detail about `GC_INIT()`: it is not needed on the current Boehm GC master at https://github.com/ivmai/bdwgc, but is needed on few releases (7.4 and 7.6), as well as on the current Sage's version of GC.\n\nNo it builds with `SAGE_CHECK=yes`, and all the relevant Sage tests pass, too, on OSX 10.12 as well as on Linux.",
    "created_at": "2017-12-06T17:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365458",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">Comment 13</div>

One little detail about `GC_INIT()`: it is not needed on the current Boehm GC master at https://github.com/ivmai/bdwgc, but is needed on few releases (7.4 and 7.6), as well as on the current Sage's version of GC.

No it builds with `SAGE_CHECK=yes`, and all the relevant Sage tests pass, too, on OSX 10.12 as well as on Linux.



---

archive/issue_comments_365459.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -32,6 +32,7 @@\n \n \n ---\n+As it was being fixed, more problems were uncovered, and then a pesky GC bug, that went away after adding an explicit `GC_INIT()` call.\n \n It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11\n \n``````\n",
    "created_at": "2017-12-06T17:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365459",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -32,6 +32,7 @@
 
 
 ---
+As it was being fixed, more problems were uncovered, and then a pesky GC bug, that went away after adding an explicit `GC_INIT()` call.
 
 It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11
 
``````




---

archive/issue_comments_365460.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf\">f3349e0</a></td><td><code>use the official tarball</code></td></tr></table>\n",
    "created_at": "2017-12-07T17:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365460",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14" align="right">Comment 14</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf">f3349e0</a></td><td><code>use the official tarball</code></td></tr></table>




---

archive/issue_comments_365461.json:
```json
{
    "body": "Changed commit from **[7f277d9](https://github.com/sagemath/sagetrac-mirror/commit/7f277d991bc884663782ff23b5663b103b7d4ed2)** to **[f3349e0](https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf)**",
    "created_at": "2017-12-07T17:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365461",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7f277d9](https://github.com/sagemath/sagetrac-mirror/commit/7f277d991bc884663782ff23b5663b103b7d4ed2)** to **[f3349e0](https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf)**



---

archive/issue_comments_365462.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -36,4 +36,5 @@\n \n It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11\n \n-the tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.02r4.tar.gz\n+the (official!) tarball is here: \n+https://github.com/miguelmarco/libhomfly/releases/download/1.02r4/libhomfly-1.02r4.tar.gz\n``````\n",
    "created_at": "2017-12-07T17:06:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365462",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -36,4 +36,5 @@
 
 It appears that all is fixed by https://github.com/miguelmarco/libhomfly/pull/11
 
-the tarball is here: http://users.ox.ac.uk/~coml0531/sage/libhomfly-1.02r4.tar.gz
+the (official!) tarball is here: 
+https://github.com/miguelmarco/libhomfly/releases/download/1.02r4/libhomfly-1.02r4.tar.gz
``````




---

archive/issue_comments_365463.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nOK, so now even the tarball is official!",
    "created_at": "2017-12-07T17:06:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365463",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">Comment 15</div>

OK, so now even the tarball is official!



---

archive/issue_comments_365464.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, in a later stable release.** to **None of the above - read trac for reasoning.**",
    "created_at": "2017-12-07T17:07:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365464",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Fixed upstream, in a later stable release.** to **None of the above - read trac for reasoning.**



---

archive/issue_comments_365465.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nI think we need a menu choice saying \"Fixes fully merged in the current upstream release\". :-)",
    "created_at": "2017-12-07T17:07:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365465",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">Comment 16</div>

I think we need a menu choice saying "Fixes fully merged in the current upstream release". :-)



---

archive/issue_comments_365466.json:
```json
{
    "body": "Changed upstream from **None of the above - read trac for reasoning.** to **Completely fixed; Fix reported upstream**",
    "created_at": "2017-12-08T14:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365466",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **None of the above - read trac for reasoning.** to **Completely fixed; Fix reported upstream**



---

archive/issue_comments_365467.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2017-12-08T16:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365467",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_315425.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-08T16:12:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315425"
}
```



---

archive/issue_events_315426.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-08T16:12:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315426"
}
```



---

archive/issue_comments_365468.json:
```json
{
    "body": "Changed branch from **[u/dimpase/libhomflyfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/libhomflyfix)** to **[f3349e0](https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf)**",
    "created_at": "2017-12-11T01:02:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24015#issuecomment-365468",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dimpase/libhomflyfix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/libhomflyfix)** to **[f3349e0](https://github.com/sagemath/sagetrac-mirror/commit/f3349e0fa9584b4a37918fed0cd370bb1a3f4cbf)**



---

archive/issue_events_315427.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-11T01:02:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315427"
}
```



---

archive/issue_events_315428.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ea8a71ca392b98db09085cff5896759a7fbd2aa1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-12-11T01:02:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24015",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24015#event-315428"
}
```
