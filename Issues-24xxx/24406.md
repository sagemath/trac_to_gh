# Issue 24406: py3: get rid of some long(...) in quotient rings

archive/issues_024169.json:
```json
{
    "assignees": [],
    "body": "\n\nCC:  @embray @jdemeyer @tscrim\n\nBranch/Commit: **[u/chapoton/24406](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/24406) @ [0b9f02e](https://github.com/sagemath/sagetrac-mirror/commit/0b9f02e3e56f886385a634103cf1a51f896f60d3)**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24406_\n\n",
    "closed_at": "2017-12-21T15:39:54Z",
    "created_at": "2017-12-20T09:03:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: get rid of some long(...) in quotient rings",
    "type": "issue",
    "updated_at": "2017-12-21T15:39:54Z",
    "url": "https://github.com/sagemath/sage/issues/24406",
    "user": "https://github.com/fchapoton"
}
```


CC:  @embray @jdemeyer @tscrim

Branch/Commit: **[u/chapoton/24406](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/24406) @ [0b9f02e](https://github.com/sagemath/sagetrac-mirror/commit/0b9f02e3e56f886385a634103cf1a51f896f60d3)**

Author: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/24406_





---

archive/issue_events_320239.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T09:03:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320239"
}
```



---

archive/issue_events_320240.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T09:03:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320240"
}
```



---

archive/issue_events_320241.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T09:03:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320241"
}
```



---

archive/issue_events_320242.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T09:03:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320242"
}
```



---

archive/issue_events_320243.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T09:04:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320243"
}
```



---

archive/issue_comments_372233.json:
```json
{
    "body": "Branch: **[u/chapoton/24406](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/24406)**",
    "created_at": "2017-12-20T09:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372233",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/24406](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/24406)**



---

archive/issue_comments_372234.json:
```json
{
    "body": "Commit: **[0b9f02e](https://github.com/sagemath/sagetrac-mirror/commit/0b9f02e3e56f886385a634103cf1a51f896f60d3)**",
    "created_at": "2017-12-20T09:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372234",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[0b9f02e](https://github.com/sagemath/sagetrac-mirror/commit/0b9f02e3e56f886385a634103cf1a51f896f60d3)**



---

archive/issue_comments_372235.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b9f02e3e56f886385a634103cf1a51f896f60d3\">0b9f02e</a></td><td><code>py3: getting rid of some long(..) in python files</code></td></tr></table>\n",
    "created_at": "2017-12-20T09:04:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372235",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">Comment 1</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b9f02e3e56f886385a634103cf1a51f896f60d3">0b9f02e</a></td><td><code>py3: getting rid of some long(..) in python files</code></td></tr></table>




---

archive/issue_comments_372236.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nIn the same spirit, what to do with\n\n```\nsrc/sage/interfaces/interface.py: return long(randstate().seed()&0x1FFFFFFF)\n```\n?",
    "created_at": "2017-12-20T09:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372236",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:2" align="right">Comment 2</div>

In the same spirit, what to do with

```
src/sage/interfaces/interface.py: return long(randstate().seed()&0x1FFFFFFF)
```
?



---

archive/issue_comments_372237.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\ngreen bot, please review",
    "created_at": "2017-12-20T10:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372237",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">Comment 3</div>

green bot, please review



---

archive/issue_comments_372238.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nYou should keep the doctests, i.e. move them somewhere else inside a `TESTS` block.",
    "created_at": "2017-12-20T10:48:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372238",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">Comment 4</div>

You should keep the doctests, i.e. move them somewhere else inside a `TESTS` block.



---

archive/issue_events_320244.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-20T10:48:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320244"
}
```



---

archive/issue_events_320245.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-20T10:48:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320245"
}
```



---

archive/issue_comments_372239.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nThey no longer work:\n\n```\nsage: R.<x> = PolynomialRing(QQ)\nsage: S.<a> = R.quotient(x^3-2)\nsage: long(S(10))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-fb296fb2f341> in <module>()\n----> 1 long(S(Integer(10)))\n\nTypeError: long() argument must be a string or a number, not 'PolynomialQuotientRing_field_with_category.element_class'\nsage: int(S(10))\n10\nsage: long(int(S(10)))\n10L\n```",
    "created_at": "2017-12-20T10:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372239",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">Comment 5</div>

They no longer work:

```
sage: R.<x> = PolynomialRing(QQ)
sage: S.<a> = R.quotient(x^3-2)
sage: long(S(10))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-fb296fb2f341> in <module>()
----> 1 long(S(Integer(10)))

TypeError: long() argument must be a string or a number, not 'PolynomialQuotientRing_field_with_category.element_class'
sage: int(S(10))
10
sage: long(int(S(10)))
10L
```



---

archive/issue_comments_372240.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nWould it be ok to use the previous comment as a doctest ?",
    "created_at": "2017-12-20T10:53:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372240",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">Comment 6</div>

Would it be ok to use the previous comment as a doctest ?



---

archive/issue_comments_372241.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@fchapoton](#comment%3A6):\n> Would it be ok to use the previous comment as a doctest ?\n\nOf course not. You are breaking a part of Sage that used to work!\n\nReally, why do we need to get rid of this `__long__` anyway? It doesn't hurt to keep it on Python 3. The doctests won't work because there is no `long`, but the tests should work with `int` on Python 3.",
    "created_at": "2017-12-20T10:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372241",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@fchapoton](#comment%3A6):
> Would it be ok to use the previous comment as a doctest ?

Of course not. You are breaking a part of Sage that used to work!

Really, why do we need to get rid of this `__long__` anyway? It doesn't hurt to keep it on Python 3. The doctests won't work because there is no `long`, but the tests should work with `int` on Python 3.



---

archive/issue_comments_372242.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nIt's a general thing that I have said on several other tickets: if you break an existing doctest for Python 3 porting, there should be an exceptional reason for it. Generally, you change the code such that the code works on Python 2 and Python 3 but you keep the doctests.\n\nOf course, if the doctest itself is not compatible with Python 3 (in this cases, it uses `long()`), then it can't work on Python 3. But it should still work on Python 2.",
    "created_at": "2017-12-20T10:57:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372242",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">Comment 8</div>

It's a general thing that I have said on several other tickets: if you break an existing doctest for Python 3 porting, there should be an exceptional reason for it. Generally, you change the code such that the code works on Python 2 and Python 3 but you keep the doctests.

Of course, if the doctest itself is not compatible with Python 3 (in this cases, it uses `long()`), then it can't work on Python 3. But it should still work on Python 2.



---

archive/issue_comments_372243.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nWell, because keeping long(..) is not an option if we want doctests to pass, that's why.\n\nBut I more concerned with the call to long in\n\n```\nsrc/sage/interfaces/interface.py: return long(randstate().seed()&0x1FFFFFFF)\n```\nthat prevents some combinat code to run.\n\nBy the way, did you try to build and use sage with python3 yourself ?",
    "created_at": "2017-12-20T10:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372243",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">Comment 9</div>

Well, because keeping long(..) is not an option if we want doctests to pass, that's why.

But I more concerned with the call to long in

```
src/sage/interfaces/interface.py: return long(randstate().seed()&0x1FFFFFFF)
```
that prevents some combinat code to run.

By the way, did you try to build and use sage with python3 yourself ?



---

archive/issue_events_320246.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T14:23:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320246"
}
```



---

archive/issue_events_320247.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T14:23:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320247"
}
```



---

archive/issue_comments_372244.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nBecause I am not going to fight for this one, let us close it as wontfix.",
    "created_at": "2017-12-20T14:23:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372244",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">Comment 10</div>

Because I am not going to fight for this one, let us close it as wontfix.



---

archive/issue_events_320248.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T14:23:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320248"
}
```



---

archive/issue_events_320249.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T14:23:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320249"
}
```



---

archive/issue_events_320250.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-20T14:23:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320250"
}
```



---

archive/issue_events_320251.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-21T15:39:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320251"
}
```



---

archive/issue_events_320252.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-21T15:39:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320252"
}
```



---

archive/issue_events_320253.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-21T15:39:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "a6a6a6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24406#event-320253"
}
```



---

archive/issue_comments_372245.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI agree `__long__` shouldn't be outright removed.  I've fixed a few of these in my branch already on a case-by-case basis.",
    "created_at": "2017-12-21T15:39:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24406#issuecomment-372245",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">Comment 11</div>

I agree `__long__` shouldn't be outright removed.  I've fixed a few of these in my branch already on a case-by-case basis.
