# Issue 24343: py3: miscellaneous fixes to sage.doctest

archive/issues_024106.json:
```json
{
    "assignees": [],
    "body": "These are most of the fixes I've made so far to the `sage.doctest` package.  It's probably not exhaustive, but these are at least the main bug fixes that were needed to get it working (and for its own self-tests to pass, though that also requires fixes in other modules).\n\nCC:  @fchapoton\n\nBranch: **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Erik Bray**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24343_\n\n",
    "closed_at": "2018-03-21T06:19:01Z",
    "created_at": "2017-12-08T11:41:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: miscellaneous fixes to sage.doctest",
    "type": "issue",
    "updated_at": "2018-04-06T14:39:03Z",
    "url": "https://github.com/sagemath/sage/issues/24343",
    "user": "https://github.com/embray"
}
```
These are most of the fixes I've made so far to the `sage.doctest` package.  It's probably not exhaustive, but these are at least the main bug fixes that were needed to get it working (and for its own self-tests to pass, though that also requires fixes in other modules).

CC:  @fchapoton

Branch: **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)**

Reviewer: **Jeroen Demeyer**

Author: **Erik Bray**

_Issue created by migration from https://trac.sagemath.org/ticket/24343_





---

archive/issue_events_319480.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-08T11:41:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319480"
}
```



---

archive/issue_events_319481.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-08T11:41:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "000080",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319481"
}
```



---

archive/issue_events_319482.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-08T11:41:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319482"
}
```



---

archive/issue_events_319483.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-08T11:41:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319483"
}
```



---

archive/issue_comments_371049.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nThis won't be \"ready for review\" I think until some of its dependencies are dealt with first, but in the meantime if you want to try using these fixes it should prove helpful.",
    "created_at": "2017-12-08T11:42:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371049",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'>Comment 1:</a>
This won't be "ready for review" I think until some of its dependencies are dealt with first, but in the meantime if you want to try using these fixes it should prove helpful.



---

archive/issue_comments_371050.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/589e7a2b6012f99542760fac2ddedb034cfbbd13\">589e7a2</a></td><td><code>Slight reworking of the arguments to atomic_write:</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a4d5481aa418e4c8d273c4f919b64491ac892ad\">9a4d548</a></td><td><code>Slight correction to this docstring.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9398b577e70b8809fdc4680d6c5ea5c6f962d8be\">9398b57</a></td><td><code>Miscellaneous fixes to tests in the doctest module.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5426bdbf0f753573cf94c4bb189d5ce44be3735d\">5426bdb</a></td><td><code>Fix various minor encoding issues, and specify an encoding to use for writing the stats file.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5663cc053c97c83d67981be67862439d85e5807\">a5663cc</a></td><td><code>Convert these classes to 'new-style' classes for consistency with Python 3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18cdffcfb580383779f28ff088e5752d34c1faf5\">18cdffc</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670\">2203ca2</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccd5e960503c867170f9bffd31364da35e962aca\">ccd5e96</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>\n",
    "created_at": "2018-01-17T09:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371050",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>Comment 2:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/589e7a2b6012f99542760fac2ddedb034cfbbd13">589e7a2</a></td><td><code>Slight reworking of the arguments to atomic_write:</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a4d5481aa418e4c8d273c4f919b64491ac892ad">9a4d548</a></td><td><code>Slight correction to this docstring.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9398b577e70b8809fdc4680d6c5ea5c6f962d8be">9398b57</a></td><td><code>Miscellaneous fixes to tests in the doctest module.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5426bdbf0f753573cf94c4bb189d5ce44be3735d">5426bdb</a></td><td><code>Fix various minor encoding issues, and specify an encoding to use for writing the stats file.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5663cc053c97c83d67981be67862439d85e5807">a5663cc</a></td><td><code>Convert these classes to 'new-style' classes for consistency with Python 3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18cdffcfb580383779f28ff088e5752d34c1faf5">18cdffc</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670">2203ca2</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccd5e960503c867170f9bffd31364da35e962aca">ccd5e96</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>




---

archive/issue_comments_371051.json:
```json
{
    "body": "Changed commit from **[fd139c9](https://github.com/sagemath/sagetrac-mirror/commit/fd139c9bca7cde3189262290cb6f904baaf02892)** to **[ccd5e96](https://github.com/sagemath/sagetrac-mirror/commit/ccd5e960503c867170f9bffd31364da35e962aca)**",
    "created_at": "2018-01-17T09:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371051",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fd139c9](https://github.com/sagemath/sagetrac-mirror/commit/fd139c9bca7cde3189262290cb6f904baaf02892)** to **[ccd5e96](https://github.com/sagemath/sagetrac-mirror/commit/ccd5e960503c867170f9bffd31364da35e962aca)**



---

archive/issue_comments_371052.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\ndoes not apply",
    "created_at": "2018-01-23T15:10:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371052",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'>Comment 3:</a>
does not apply



---

archive/issue_events_319484.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-02-12T14:13:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319484"
}
```



---

archive/issue_comments_371053.json:
```json
{
    "body": "Changed dependencies from **#24313, #24234** to none",
    "created_at": "2018-02-12T14:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371053",
    "user": "https://github.com/fchapoton"
}
```

Changed dependencies from **#24313, #24234** to none



---

archive/issue_events_319485.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-02-12T14:13:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319485"
}
```



---

archive/issue_events_319486.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-02-12T14:13:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319486"
}
```



---

archive/issue_comments_371054.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nWorking on rebasing this.  This used to have all tests passing on Python 3, and still appears to there, but breaks some things on Python 2 now (I think it used to work there but now I'm not sure, it's been too long).",
    "created_at": "2018-02-12T16:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371054",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'>Comment 6:</a>
Working on rebasing this.  This used to have all tests passing on Python 3, and still appears to there, but breaks some things on Python 2 now (I think it used to work there but now I'm not sure, it's been too long).



---

archive/issue_comments_371055.json:
```json
{
    "body": "Changed commit from **[ccd5e96](https://github.com/sagemath/sagetrac-mirror/commit/ccd5e960503c867170f9bffd31364da35e962aca)** to **[7dd7f9a](https://github.com/sagemath/sagetrac-mirror/commit/7dd7f9af21846d5d4d98815eff3cc409327dc793)**",
    "created_at": "2018-02-12T17:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371055",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ccd5e96](https://github.com/sagemath/sagetrac-mirror/commit/ccd5e960503c867170f9bffd31364da35e962aca)** to **[7dd7f9a](https://github.com/sagemath/sagetrac-mirror/commit/7dd7f9af21846d5d4d98815eff3cc409327dc793)**



---

archive/issue_comments_371056.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aedc61a7037a5164d046b42845aaa571ceab3f5d\">aedc61a</a></td><td><code>Miscellaneous fixes to tests in the doctest module.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ee3e9b6a9545585e2e02999b6f846df00c2ee23\">1ee3e9b</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96ae33273894fbd3a69036f2c4c518bf75310267\">96ae332</a></td><td><code>Convert these classes to 'new-style' classes for consistency with Python 3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c040c679afacd1fcccffd16a167650dfe5b3ea3a\">c040c67</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/380a902c3c3b5ea18363fa3390c9158215b9282c\">380a902</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92117e5362eb91e09e3c776a6566a26302cd5073\">92117e5</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72fdf00823672ebf7b82d5be6d554a714bf02bb3\">72fdf00</a></td><td><code>Python 2 will accept br as a string prefix but not rb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db544c737f4eb448252bf880dd3074c083cabd41\">db544c7</a></td><td><code>This exception reads 'utf-8' on Python 3 and 'utf8' on Python 2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7dd7f9af21846d5d4d98815eff3cc409327dc793\">7dd7f9a</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr></table>\n",
    "created_at": "2018-02-12T17:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371056",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aedc61a7037a5164d046b42845aaa571ceab3f5d">aedc61a</a></td><td><code>Miscellaneous fixes to tests in the doctest module.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ee3e9b6a9545585e2e02999b6f846df00c2ee23">1ee3e9b</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96ae33273894fbd3a69036f2c4c518bf75310267">96ae332</a></td><td><code>Convert these classes to 'new-style' classes for consistency with Python 3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c040c679afacd1fcccffd16a167650dfe5b3ea3a">c040c67</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/380a902c3c3b5ea18363fa3390c9158215b9282c">380a902</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92117e5362eb91e09e3c776a6566a26302cd5073">92117e5</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72fdf00823672ebf7b82d5be6d554a714bf02bb3">72fdf00</a></td><td><code>Python 2 will accept br as a string prefix but not rb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db544c737f4eb448252bf880dd3074c083cabd41">db544c7</a></td><td><code>This exception reads 'utf-8' on Python 3 and 'utf8' on Python 2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7dd7f9af21846d5d4d98815eff3cc409327dc793">7dd7f9a</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr></table>




---

archive/issue_events_319487.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-12T17:10:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319487"
}
```



---

archive/issue_events_319488.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-12T17:10:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319488"
}
```



---

archive/issue_comments_371057.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nThis has all the tests passing on Python 2, as well as on Python 3 *except* for a test that was added recently to `FileDocTestSource.create_doctests` (the \"bitness\" test).  I'll worry about that later; it's not really a substantive failure.",
    "created_at": "2018-02-12T17:10:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371057",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'>Comment 8:</a>
This has all the tests passing on Python 2, as well as on Python 3 *except* for a test that was added recently to `FileDocTestSource.create_doctests` (the "bitness" test).  I'll worry about that later; it's not really a substantive failure.



---

archive/issue_comments_371058.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nThere is a lot of stuff happening in this branch. I would appreciate if this could be split up in smaller independent pieces, especially where you are making structural changes.",
    "created_at": "2018-02-13T08:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371058",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
There is a lot of stuff happening in this branch. I would appreciate if this could be split up in smaller independent pieces, especially where you are making structural changes.



---

archive/issue_comments_371059.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nWhen trying to use this branch in python3 to doctest a file, I get lots and lots of trivial doctests failures, typically like this one:\n\n```\nFile \"src/sage/combinat/yang_baxter_graph.py\", line 576, in sage.combinat.yang_baxter_graph.YangBaxterGraph_partition.__init__\nFailed example:\n    Y = YangBaxterGraph(partition=[3,2,1]); Y\nExpected:\n    Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)\nGot:\n    b'Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)'\n```",
    "created_at": "2018-02-15T13:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371059",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'>Comment 10:</a>
When trying to use this branch in python3 to doctest a file, I get lots and lots of trivial doctests failures, typically like this one:

```
File "src/sage/combinat/yang_baxter_graph.py", line 576, in sage.combinat.yang_baxter_graph.YangBaxterGraph_partition.__init__
Failed example:
    Y = YangBaxterGraph(partition=[3,2,1]); Y
Expected:
    Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)
Got:
    b'Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)'
```



---

archive/issue_comments_371060.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@fchapoton](#comment%3A10):\n> When trying to use this branch in python3 to doctest a file, I get lots and lots of trivial doctests failures, typically like this one:\n> \n> ```\n> File \"src/sage/combinat/yang_baxter_graph.py\", line 576, in sage.combinat.yang_baxter_graph.YangBaxterGraph_partition.__init__\n> Failed example:\n>     Y = YangBaxterGraph(partition=[3,2,1]); Y\n> Expected:\n>     Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)\n> Got:\n>     b'Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)'\n> ```\n\nThat's likely. This is related to `sage.repl.rich_ouput.backend_test`.  I have fixes to that coming in a separate ticket.",
    "created_at": "2018-02-15T15:58:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371060",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@fchapoton](#comment%3A10):
> When trying to use this branch in python3 to doctest a file, I get lots and lots of trivial doctests failures, typically like this one:
> 
> ```
> File "src/sage/combinat/yang_baxter_graph.py", line 576, in sage.combinat.yang_baxter_graph.YangBaxterGraph_partition.__init__
> Failed example:
>     Y = YangBaxterGraph(partition=[3,2,1]); Y
> Expected:
>     Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)
> Got:
>     b'Yang-Baxter graph of [3, 2, 1], with top vertex (0, 1, 0, 2, 1, 0)'
> ```

That's likely. This is related to `sage.repl.rich_ouput.backend_test`.  I have fixes to that coming in a separate ticket.



---

archive/issue_comments_371061.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@jdemeyer](#comment%3A9):\n> There is a lot of stuff happening in this branch. I would appreciate if this could be split up in smaller independent pieces, especially where you are making structural changes.\n\nYou are welcome to look at the [individual commits](https://github.com/sagemath/sagetrac-mirror/compare/e6cae6d88dc018f6421a91fc4d9e073ab138644e...7dd7f9af21846d5d4d98815eff3cc409327dc793) if that would be easier.",
    "created_at": "2018-02-15T15:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371061",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@jdemeyer](#comment%3A9):
> There is a lot of stuff happening in this branch. I would appreciate if this could be split up in smaller independent pieces, especially where you are making structural changes.

You are welcome to look at the [individual commits](https://github.com/sagemath/sagetrac-mirror/compare/e6cae6d88dc018f6421a91fc4d9e073ab138644e...7dd7f9af21846d5d4d98815eff3cc409327dc793) if that would be easier.



---

archive/issue_comments_371062.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nFWIW I opened this ticket *two months ago* and actually was using these fixes well before I opened the ticket to run the tests on Python 3, with consistent success (in that the test framework completes test runs and correctly reports passes and failures).",
    "created_at": "2018-02-15T16:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371062",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'>Comment 13:</a>
FWIW I opened this ticket *two months ago* and actually was using these fixes well before I opened the ticket to run the tests on Python 3, with consistent success (in that the test framework completes test runs and correctly reports passes and failures).



---

archive/issue_comments_371063.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@embray](#comment%3A12):\n> You are welcome to look at the individual commits if that would be easier.\n\nThe question is: am I supposed to review individual commits or the branch as a whole? I'm fine with doing either of those two extremes but rather not a mixture (I don't want to *look* at individual commits when you want me to *review* the branch as a whole).",
    "created_at": "2018-02-15T16:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371063",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@embray](#comment%3A12):
> You are welcome to look at the individual commits if that would be easier.

The question is: am I supposed to review individual commits or the branch as a whole? I'm fine with doing either of those two extremes but rather not a mixture (I don't want to *look* at individual commits when you want me to *review* the branch as a whole).



---

archive/issue_comments_371064.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\n...and if you really want me to review individual commits, I would prefer to split this over multiple tickets.",
    "created_at": "2018-02-15T16:08:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371064",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'>Comment 15:</a>
...and if you really want me to review individual commits, I would prefer to split this over multiple tickets.



---

archive/issue_comments_371065.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nI'm not sure what the distinction is.  There are literally thousands of things that need to be fixed for Python 3. Grouping up large sets of fixes on a per-module or per-package basis should get things done more quickly and with fewer merge problems, than if they were spread across multiple tickets of \"miscellaneous fixes 1\", \"miscellaneous fixes 2\", etc.\n\nI'm pretty frustrated (and I believe Fr\u00e9d\u00e9ric is too) that I've actually already fixed like 50% of the tests on Python 3 but have all the work squirreled away in my private branch, often resulting in duplicate effort (e.g. #24739).  And the biggest bottleneck now is just the rate at which I can open logical tickets.\n\nIf you want to review some set of changes I don't see what difference it makes for you.",
    "created_at": "2018-02-15T16:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371065",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'>Comment 16:</a>
I'm not sure what the distinction is.  There are literally thousands of things that need to be fixed for Python 3. Grouping up large sets of fixes on a per-module or per-package basis should get things done more quickly and with fewer merge problems, than if they were spread across multiple tickets of "miscellaneous fixes 1", "miscellaneous fixes 2", etc.

I'm pretty frustrated (and I believe Frédéric is too) that I've actually already fixed like 50% of the tests on Python 3 but have all the work squirreled away in my private branch, often resulting in duplicate effort (e.g. #24739).  And the biggest bottleneck now is just the rate at which I can open logical tickets.

If you want to review some set of changes I don't see what difference it makes for you.



---

archive/issue_comments_371066.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [@embray](#comment%3A16):\n> Grouping up large sets of fixes on a per-module or per-package basis should get things done more quickly and with fewer merge problems, than if they were spread across multiple tickets of \"miscellaneous fixes 1\", \"miscellaneous fixes 2\", etc.\n\nMy opinion is the opposite. I find it easier to deal with many small isolated tickets instead of single large tickets. Mainly because it will allow easy things to pass immediately.\n\nSpeaking of frustration... I find your refusal to split up tickets frustrating. I'm not even asking you to split up the tickets. I'm asking for permission to split up your tickets.",
    "created_at": "2018-02-15T16:18:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371066",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [@embray](#comment%3A16):
> Grouping up large sets of fixes on a per-module or per-package basis should get things done more quickly and with fewer merge problems, than if they were spread across multiple tickets of "miscellaneous fixes 1", "miscellaneous fixes 2", etc.

My opinion is the opposite. I find it easier to deal with many small isolated tickets instead of single large tickets. Mainly because it will allow easy things to pass immediately.

Speaking of frustration... I find your refusal to split up tickets frustrating. I'm not even asking you to split up the tickets. I'm asking for permission to split up your tickets.



---

archive/issue_comments_371067.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@embray](#comment%3A16):\n> I'm not sure what the distinction is.\n\nThe distinction is mainly whether the commits are logically/functionally independent or not. If you have a first commit which is broken and then commit 2 and commit 3 to fix issues with the first commit, it makes no sense to review by commit. If on the other hand, every commit fixes a single issue, it does make sense to review by commit.",
    "created_at": "2018-02-15T16:21:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371067",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@embray](#comment%3A16):
> I'm not sure what the distinction is.

The distinction is mainly whether the commits are logically/functionally independent or not. If you have a first commit which is broken and then commit 2 and commit 3 to fix issues with the first commit, it makes no sense to review by commit. If on the other hand, every commit fixes a single issue, it does make sense to review by commit.



---

archive/issue_comments_371068.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@jdemeyer](#comment%3A17):\n> Replying to [@embray](#comment%3A16):\n> > Grouping up large sets of fixes on a per-module or per-package basis should get things done more quickly and with fewer merge problems, than if they were spread across multiple tickets of \"miscellaneous fixes 1\", \"miscellaneous fixes 2\", etc.\n\n> \n> My opinion is the opposite. I find it easier to deal with many small isolated tickets instead of single large tickets. Mainly because it will allow easy things to pass immediately.\n> \n> Speaking of frustration... I find your refusal to split up tickets frustrating. I'm not even asking you to split up the tickets. I'm asking for permission to split up your tickets.\n\nHey, if *you're* willing to do it be my guest.  I don't see what you'd want to spend the time.",
    "created_at": "2018-02-15T16:21:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371068",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@jdemeyer](#comment%3A17):
> Replying to [@embray](#comment%3A16):
> > Grouping up large sets of fixes on a per-module or per-package basis should get things done more quickly and with fewer merge problems, than if they were spread across multiple tickets of "miscellaneous fixes 1", "miscellaneous fixes 2", etc.

> 
> My opinion is the opposite. I find it easier to deal with many small isolated tickets instead of single large tickets. Mainly because it will allow easy things to pass immediately.
> 
> Speaking of frustration... I find your refusal to split up tickets frustrating. I'm not even asking you to split up the tickets. I'm asking for permission to split up your tickets.

Hey, if *you're* willing to do it be my guest.  I don't see what you'd want to spend the time.



---

archive/issue_comments_371069.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nReplying to [@jdemeyer](#comment%3A18):\n> Replying to [@embray](#comment%3A16):\n> > I'm not sure what the distinction is.\n\n> \n> The distinction is mainly whether the commits are logically/functionally independent or not. If you have a first commit which is broken and then commit 2 and commit 3 to fix issues with the first commit, it makes no sense to review by commit. If on the other hand, every commit fixes a single issue, it does make sense to review by commit.\n\nThat isn't really the case here.  I believe there might be 1 or 2 fixup commits added late to this branch because it wasn't passing on Python 2, but those are actually worth keeping as separate commits since I felt they called out specific Python 2/3 differences that were worth making note of.\n\nYou should know by now that I know how to use rebase effectively and usually try to organize my commits in a logical fashion, and also that I frequently write detailed commit messages about what is being changed and why.  I really don't understand why you care.  If it were me I would just look at the changes--make note of any specific ones I want to comment on, and that's that.\n\nOr just even glance over briefly to make sure nothing stands out, and then give you the benefit of the doubt.  You don't have to scrutinize every single change everyone makes.  Nobody has time for that.",
    "created_at": "2018-02-15T16:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371069",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'>Comment 20:</a>
Replying to [@jdemeyer](#comment%3A18):
> Replying to [@embray](#comment%3A16):
> > I'm not sure what the distinction is.

> 
> The distinction is mainly whether the commits are logically/functionally independent or not. If you have a first commit which is broken and then commit 2 and commit 3 to fix issues with the first commit, it makes no sense to review by commit. If on the other hand, every commit fixes a single issue, it does make sense to review by commit.

That isn't really the case here.  I believe there might be 1 or 2 fixup commits added late to this branch because it wasn't passing on Python 2, but those are actually worth keeping as separate commits since I felt they called out specific Python 2/3 differences that were worth making note of.

You should know by now that I know how to use rebase effectively and usually try to organize my commits in a logical fashion, and also that I frequently write detailed commit messages about what is being changed and why.  I really don't understand why you care.  If it were me I would just look at the changes--make note of any specific ones I want to comment on, and that's that.

Or just even glance over briefly to make sure nothing stands out, and then give you the benefit of the doubt.  You don't have to scrutinize every single change everyone makes.  Nobody has time for that.



---

archive/issue_comments_371070.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@embray](#comment%3A20):\n> You don't have to scrutinize every single change everyone makes.\n\nI almost feel bad to say that I am trying to do exactly that.",
    "created_at": "2018-02-15T16:31:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371070",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@embray](#comment%3A20):
> You don't have to scrutinize every single change everyone makes.

I almost feel bad to say that I am trying to do exactly that.



---

archive/issue_comments_371071.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nReplying to [@jdemeyer](#comment%3A21):\n> Replying to [@embray](#comment%3A20):\n> > You don't have to scrutinize every single change everyone makes.\n\n> \n> I almost feel bad to say that I am trying to do exactly that. \n\nAnd I appreciate that, because your scrutiny promotes a high level of quality.  But I don't know how you then find time for much else.  I'm a strong proponent of careful code review, but sometimes you also have to pick your battles, or trust other people to review things.  I used to review every single line change to Astropy when we started the project, but as it grew there was no way I could keep up, especially as large modules grew in which different people had more expertise, and I learned to trust them to do their best in terms of quality assurance.  I still give most changes a glance over in case there are *specific* issues I'm concerned about.\n\nAnyways, you do what you want, and believe it or not I try my best to keep my changes reasonably atomic and logical (though this becomes difficult when making mass sets of minor fixes).  And I'll do what I can to make things easier.  I just wish I understood your process better and why you find it helpful to review a whole branch versus individual commits.\n\nTo me, looking over the full merge commit is obviously the first pass, and if there are individual changes I have more questions about I'll often drill more into the history of that file to find the individual commit where that change was made.\n\nI agree this becomes more difficult if there are lots of commits combined that affect multiple files simultaneously.  I wouldn't often combine changes like that into a single ticket (hence why I broke up #24740 and #24741, and considered actually breaking the latter into two more tickets).  In this case, however, all the changes are fairly small an localized.",
    "created_at": "2018-02-15T16:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371071",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'>Comment 22:</a>
Replying to [@jdemeyer](#comment%3A21):
> Replying to [@embray](#comment%3A20):
> > You don't have to scrutinize every single change everyone makes.

> 
> I almost feel bad to say that I am trying to do exactly that. 

And I appreciate that, because your scrutiny promotes a high level of quality.  But I don't know how you then find time for much else.  I'm a strong proponent of careful code review, but sometimes you also have to pick your battles, or trust other people to review things.  I used to review every single line change to Astropy when we started the project, but as it grew there was no way I could keep up, especially as large modules grew in which different people had more expertise, and I learned to trust them to do their best in terms of quality assurance.  I still give most changes a glance over in case there are *specific* issues I'm concerned about.

Anyways, you do what you want, and believe it or not I try my best to keep my changes reasonably atomic and logical (though this becomes difficult when making mass sets of minor fixes).  And I'll do what I can to make things easier.  I just wish I understood your process better and why you find it helpful to review a whole branch versus individual commits.

To me, looking over the full merge commit is obviously the first pass, and if there are individual changes I have more questions about I'll often drill more into the history of that file to find the individual commit where that change was made.

I agree this becomes more difficult if there are lots of commits combined that affect multiple files simultaneously.  I wouldn't often combine changes like that into a single ticket (hence why I broke up #24740 and #24741, and considered actually breaking the latter into two more tickets).  In this case, however, all the changes are fairly small an localized.



---

archive/issue_comments_371072.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nTo put things more constructively, if you can give me some idea how you prefer to see changes logically split into individual tickets, I can certainly keep that in mind in the future.\n\nIt's just that for the Python 3 fixes there are so many thousands of little changes, I thought it would be simplest (and least likely to produce conflicts) to group together large sets of small fixes by package, or in some cases by individual module.\n\nObviously if I require some more substantive change (such as new features) I can, and have, made separate tickets for that.  Beyond that I'm not really sure.",
    "created_at": "2018-02-15T17:17:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371072",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'>Comment 23:</a>
To put things more constructively, if you can give me some idea how you prefer to see changes logically split into individual tickets, I can certainly keep that in mind in the future.

It's just that for the Python 3 fixes there are so many thousands of little changes, I thought it would be simplest (and least likely to produce conflicts) to group together large sets of small fixes by package, or in some cases by individual module.

Obviously if I require some more substantive change (such as new features) I can, and have, made separate tickets for that.  Beyond that I'm not really sure.



---

archive/issue_comments_371073.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [@embray](#comment%3A23):\n> To put things more constructively, if you can give me some idea how you prefer to see changes logically split into individual tickets, I can certainly keep that in mind in the future.\n\nBroadly speaking, there are 3 level of changes:\n\n1. Small isolated changes and basic clean-up, e.g. adding `str/bytes` conversion, using `with(open())`, fixing imports, style changes.\n\n2. Non-trivial changes which do not change user-visible functionality, i.e. refactoring.\n\n3. Changes to user-visible functionality.\n\nFor me, a ticket should ideally work on precisely one of these levels. Level 1 changes can be mostly approved on sight. If a ticket consists of 80% level 1 changes and 20% level 2 changes, then it can be hard to understand the level 2 changes because the many level 1 changes are just distracting the diff.\n\n> large sets of small fixes\n\nIMHO, this ticket contains several non-small (level 2 in my above classification) changes.",
    "created_at": "2018-02-16T14:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371073",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [@embray](#comment%3A23):
> To put things more constructively, if you can give me some idea how you prefer to see changes logically split into individual tickets, I can certainly keep that in mind in the future.

Broadly speaking, there are 3 level of changes:

1. Small isolated changes and basic clean-up, e.g. adding `str/bytes` conversion, using `with(open())`, fixing imports, style changes.

2. Non-trivial changes which do not change user-visible functionality, i.e. refactoring.

3. Changes to user-visible functionality.

For me, a ticket should ideally work on precisely one of these levels. Level 1 changes can be mostly approved on sight. If a ticket consists of 80% level 1 changes and 20% level 2 changes, then it can be hard to understand the level 2 changes because the many level 1 changes are just distracting the diff.

> large sets of small fixes

IMHO, this ticket contains several non-small (level 2 in my above classification) changes.



---

archive/issue_comments_371074.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\ndoes not apply",
    "created_at": "2018-02-19T07:10:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371074",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:25'>Comment 25:</a>
does not apply



---

archive/issue_events_319489.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-02-19T07:10:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319489"
}
```



---

archive/issue_events_319490.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-02-19T07:10:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319490"
}
```



---

archive/issue_comments_371075.json:
```json
{
    "body": "Changed branch from **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)** to **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)**",
    "created_at": "2018-02-19T10:00:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371075",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)** to **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)**



---

archive/issue_events_319491.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-19T10:00:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319491"
}
```



---

archive/issue_events_319492.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-19T10:00:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319492"
}
```



---

archive/issue_comments_371076.json:
```json
{
    "body": "Dependencies: **#24772**",
    "created_at": "2018-02-19T10:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371076",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#24772**



---

archive/issue_comments_371077.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3eb2db6efc3409265b2b887fe3befb5fa2cc1b29\">3eb2db6</a></td><td><code>Miscellaneous fixes to tests in the doctest module.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51e20d952d2f294662f47f1a6e52c62ea8617d6b\">51e20d9</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/878a62b4a9d266ecccab6e6b0cdd1c6044e2ef1d\">878a62b</a></td><td><code>This exception reads 'utf-8' on Python 3 and 'utf8' on Python 2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ba0e67b8d92a19607541cf6dfee887980f3a145\">1ba0e67</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dcff893007aff8e5bde44025801eb358acdefdad\">dcff893</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f513d1d4e08cb3185a36f68cd4e28120f9797705\">f513d1d</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd5ddad3e17ab9519b3eb48f4ebe8fa71ca7e0b7\">bd5ddad</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b16db63197e19e399656926a28ee58221d617020\">b16db63</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr></table>\n",
    "created_at": "2018-02-19T10:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371077",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'>Comment 27:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3eb2db6efc3409265b2b887fe3befb5fa2cc1b29">3eb2db6</a></td><td><code>Miscellaneous fixes to tests in the doctest module.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51e20d952d2f294662f47f1a6e52c62ea8617d6b">51e20d9</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/878a62b4a9d266ecccab6e6b0cdd1c6044e2ef1d">878a62b</a></td><td><code>This exception reads 'utf-8' on Python 3 and 'utf8' on Python 2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ba0e67b8d92a19607541cf6dfee887980f3a145">1ba0e67</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dcff893007aff8e5bde44025801eb358acdefdad">dcff893</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f513d1d4e08cb3185a36f68cd4e28120f9797705">f513d1d</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd5ddad3e17ab9519b3eb48f4ebe8fa71ca7e0b7">bd5ddad</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b16db63197e19e399656926a28ee58221d617020">b16db63</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr></table>




---

archive/issue_comments_371078.json:
```json
{
    "body": "Changed commit from **[7dd7f9a](https://github.com/sagemath/sagetrac-mirror/commit/7dd7f9af21846d5d4d98815eff3cc409327dc793)** to **[b16db63](https://github.com/sagemath/sagetrac-mirror/commit/b16db63197e19e399656926a28ee58221d617020)**",
    "created_at": "2018-02-19T10:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371078",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[7dd7f9a](https://github.com/sagemath/sagetrac-mirror/commit/7dd7f9af21846d5d4d98815eff3cc409327dc793)** to **[b16db63](https://github.com/sagemath/sagetrac-mirror/commit/b16db63197e19e399656926a28ee58221d617020)**



---

archive/issue_comments_371079.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12ff3be331475a61fa4925b5e89898409c7f732d\">12ff3be</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/34876abb4119f6b5382797d065be23b830fd7762\">34876ab</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6110bc43536d159e8ebd4057e556717c8189f99f\">6110bc4</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c30c078f1cab98c9b8ce3420c1137c81249e2e3b\">c30c078</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f5f429a455a614d6f4296c880af34ffa7dc42a9\">9f5f429</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad6d069a1aed291531d75be70c980f3ccfa5e041\">ad6d069</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr></table>\n",
    "created_at": "2018-02-19T13:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371079",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>Comment 28:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12ff3be331475a61fa4925b5e89898409c7f732d">12ff3be</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/34876abb4119f6b5382797d065be23b830fd7762">34876ab</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6110bc43536d159e8ebd4057e556717c8189f99f">6110bc4</a></td><td><code>Fix various minor encoding issues</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c30c078f1cab98c9b8ce3420c1137c81249e2e3b">c30c078</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f5f429a455a614d6f4296c880af34ffa7dc42a9">9f5f429</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad6d069a1aed291531d75be70c980f3ccfa5e041">ad6d069</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr></table>




---

archive/issue_comments_371080.json:
```json
{
    "body": "Changed commit from **[b16db63](https://github.com/sagemath/sagetrac-mirror/commit/b16db63197e19e399656926a28ee58221d617020)** to **[ad6d069](https://github.com/sagemath/sagetrac-mirror/commit/ad6d069a1aed291531d75be70c980f3ccfa5e041)**",
    "created_at": "2018-02-19T13:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371080",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b16db63](https://github.com/sagemath/sagetrac-mirror/commit/b16db63197e19e399656926a28ee58221d617020)** to **[ad6d069](https://github.com/sagemath/sagetrac-mirror/commit/ad6d069a1aed291531d75be70c980f3ccfa5e041)**



---

archive/issue_comments_371081.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nCan you justify this change:\n\n```diff\n-        from six.moves.queue import Empty\n-        try:\n-            self.result = self.result_queue.get(block=False)\n-        except Empty:\n-            self.result = (0, DictAsObject(dict(err='noresult')))\n-        del self.result_queue\n-\n-        self.outtmpfile.seek(0)\n-        self.output = self.outtmpfile.read()\n-        del self.outtmpfile\n+        if self.result_queue is not None:\n+            from six.moves.queue import Empty\n+            try:\n+                self.result = self.result_queue.get(block=False)\n+            except Empty:\n+                self.result = (0, DictAsObject(dict(err='noresult')))\n+\n+            self.result_queue = None\n+\n+        if self.outtmpfile is not None:\n+            self.outtmpfile.seek(0)\n+            self.output = bytes_to_str(self.outtmpfile.read())\n+            self.outtmpfile.close()\n+            self.outtmpfile = None\n```\nWhat was wrong with the old code?",
    "created_at": "2018-02-19T13:13:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371081",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'>Comment 29:</a>
Can you justify this change:

```diff
-        from six.moves.queue import Empty
-        try:
-            self.result = self.result_queue.get(block=False)
-        except Empty:
-            self.result = (0, DictAsObject(dict(err='noresult')))
-        del self.result_queue
-
-        self.outtmpfile.seek(0)
-        self.output = self.outtmpfile.read()
-        del self.outtmpfile
+        if self.result_queue is not None:
+            from six.moves.queue import Empty
+            try:
+                self.result = self.result_queue.get(block=False)
+            except Empty:
+                self.result = (0, DictAsObject(dict(err='noresult')))
+
+            self.result_queue = None
+
+        if self.outtmpfile is not None:
+            self.outtmpfile.seek(0)
+            self.output = bytes_to_str(self.outtmpfile.read())
+            self.outtmpfile.close()
+            self.outtmpfile = None
```
What was wrong with the old code?



---

archive/issue_comments_371082.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nI don't remember exactly, but I'm sure there was a good reason.  Certainly I know that I didn't like that the old code was *deleting* attributes rather than setting them to `None`.  I believe there were reasons (e.g. related to repeated calls of the same method) that it was saner to set these attributes to `None` when they were finished being used rather than deleting them.",
    "created_at": "2018-02-19T13:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371082",
    "user": "https://github.com/embray"
}
```

<a id='comment:30'>Comment 30:</a>
I don't remember exactly, but I'm sure there was a good reason.  Certainly I know that I didn't like that the old code was *deleting* attributes rather than setting them to `None`.  I believe there were reasons (e.g. related to repeated calls of the same method) that it was saner to set these attributes to `None` when they were finished being used rather than deleting them.



---

archive/issue_comments_371083.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\ngit history was rewritten in #24772, so this should be rebased.",
    "created_at": "2018-02-23T15:13:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371083",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'>Comment 31:</a>
git history was rewritten in #24772, so this should be rebased.



---

archive/issue_events_319493.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-23T15:13:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319493"
}
```



---

archive/issue_events_319494.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-23T15:13:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319494"
}
```



---

archive/issue_comments_371084.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nYeah, I was about to take care of that.",
    "created_at": "2018-02-23T15:19:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371084",
    "user": "https://github.com/embray"
}
```

<a id='comment:32'>Comment 32:</a>
Yeah, I was about to take care of that.



---

archive/issue_events_319495.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-23T15:33:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319495"
}
```



---

archive/issue_events_319496.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-02-23T15:33:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319496"
}
```



---

archive/issue_comments_371085.json:
```json
{
    "body": "Changed commit from **[ad6d069](https://github.com/sagemath/sagetrac-mirror/commit/ad6d069a1aed291531d75be70c980f3ccfa5e041)** to **[47e464d](https://github.com/sagemath/sagetrac-mirror/commit/47e464dda9aee8cb43651568ef721ee054cbab04)**",
    "created_at": "2018-02-23T15:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371085",
    "user": "https://github.com/embray"
}
```

Changed commit from **[ad6d069](https://github.com/sagemath/sagetrac-mirror/commit/ad6d069a1aed291531d75be70c980f3ccfa5e041)** to **[47e464d](https://github.com/sagemath/sagetrac-mirror/commit/47e464dda9aee8cb43651568ef721ee054cbab04)**



---

archive/issue_comments_371086.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)** to **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)**",
    "created_at": "2018-02-23T15:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371086",
    "user": "https://github.com/embray"
}
```

Changed branch from **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)** to **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)**



---

archive/issue_comments_371087.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nJust took Jeroen's branch and rebased on top of #24772.\n\nIs there anything more that still needs to be discussed on this?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf6cf97ada80f3d70a07cd416a53acd2453b6d88\">bf6cf97</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b92b47403df0b0ae371d846dcba13b88a368d98\">4b92b47</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed249101a327c4deb035f50385874cf5b902a050\">ed24910</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47e464dda9aee8cb43651568ef721ee054cbab04\">47e464d</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr></table>\n",
    "created_at": "2018-02-23T15:33:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371087",
    "user": "https://github.com/embray"
}
```

<a id='comment:33'>Comment 33:</a>
Just took Jeroen's branch and rebased on top of #24772.

Is there anything more that still needs to be discussed on this?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf6cf97ada80f3d70a07cd416a53acd2453b6d88">bf6cf97</a></td><td><code>Correct some encoding issues on Python 2.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b92b47403df0b0ae371d846dcba13b88a368d98">4b92b47</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed249101a327c4deb035f50385874cf5b902a050">ed24910</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47e464dda9aee8cb43651568ef721ee054cbab04">47e464d</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr></table>




---

archive/issue_comments_371088.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nReplying to [@embray](#comment%3A33):\n> Is there anything more that still needs to be discussed on this?\n\nProbably yes. I haven't really looked in detail.",
    "created_at": "2018-02-23T16:21:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371088",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'>Comment 34:</a>
Replying to [@embray](#comment%3A33):
> Is there anything more that still needs to be discussed on this?

Probably yes. I haven't really looked in detail.



---

archive/issue_comments_371089.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nProbably?  I'll note again that this has been working for me for months now. Maybe take a leap of faith so that we can get this in and others can finally start testing against Python 3.",
    "created_at": "2018-02-27T16:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371089",
    "user": "https://github.com/embray"
}
```

<a id='comment:35'>Comment 35:</a>
Probably?  I'll note again that this has been working for me for months now. Maybe take a leap of faith so that we can get this in and others can finally start testing against Python 3.



---

archive/issue_comments_371090.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nAs I said, I barely looked at this. And I prefer to do that after the dependencies have been merged.",
    "created_at": "2018-02-27T16:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371090",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'>Comment 36:</a>
As I said, I barely looked at this. And I prefer to do that after the dependencies have been merged.



---

archive/issue_comments_371091.json:
```json
{
    "body": "Changed dependencies from **#24772** to none",
    "created_at": "2018-03-05T10:23:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371091",
    "user": "https://github.com/fchapoton"
}
```

Changed dependencies from **#24772** to none



---

archive/issue_comments_371092.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nReplying to [@embray](#comment%3A33):\n> Just took Jeroen's branch and rebased on top of #24772.\n\nThe change that I mentioned in [comment:29] is gone. Was that intentional? In any case, I would prefer *not* to add it back if there is no reason.\n\nFor ease of reviewing, I'm rebasing your branch on 8.2.beta7 (there are no conflicts, it's a trivial rebase). The 3 commits are independent and I did reorder them.",
    "created_at": "2018-03-07T09:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371092",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'>Comment 38:</a>
Replying to [@embray](#comment%3A33):
> Just took Jeroen's branch and rebased on top of #24772.

The change that I mentioned in [comment:29] is gone. Was that intentional? In any case, I would prefer *not* to add it back if there is no reason.

For ease of reviewing, I'm rebasing your branch on 8.2.beta7 (there are no conflicts, it's a trivial rebase). The 3 commits are independent and I did reorder them.



---

archive/issue_comments_371093.json:
```json
{
    "body": "Changed branch from **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)** to **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)**",
    "created_at": "2018-03-07T09:32:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371093",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)** to **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)**



---

archive/issue_comments_371094.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bec13115e5aac85803353544bec7a4043fbf57d7\">bec1311</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e479f262ad6ca0d3c603ec03051e9732fd1708fb\">e479f26</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4ca9e2144939f844d3a35788629b159278a8487\">b4ca9e2</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>\n",
    "created_at": "2018-03-07T09:34:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371094",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'>Comment 40:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bec13115e5aac85803353544bec7a4043fbf57d7">bec1311</a></td><td><code>Use the restore_atexit context manager for this code to work on Python 3,</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e479f262ad6ca0d3c603ec03051e9732fd1708fb">e479f26</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4ca9e2144939f844d3a35788629b159278a8487">b4ca9e2</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>




---

archive/issue_comments_371095.json:
```json
{
    "body": "Changed commit from **[47e464d](https://github.com/sagemath/sagetrac-mirror/commit/47e464dda9aee8cb43651568ef721ee054cbab04)** to **[b4ca9e2](https://github.com/sagemath/sagetrac-mirror/commit/b4ca9e2144939f844d3a35788629b159278a8487)**",
    "created_at": "2018-03-07T09:34:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371095",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[47e464d](https://github.com/sagemath/sagetrac-mirror/commit/47e464dda9aee8cb43651568ef721ee054cbab04)** to **[b4ca9e2](https://github.com/sagemath/sagetrac-mirror/commit/b4ca9e2144939f844d3a35788629b159278a8487)**



---

archive/issue_comments_371096.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nI'm moving the commit about `atexit` to #24922 because I want to add something.",
    "created_at": "2018-03-07T09:51:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371096",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'>Comment 41:</a>
I'm moving the commit about `atexit` to #24922 because I want to add something.



---

archive/issue_comments_371097.json:
```json
{
    "body": "Changed commit from **[b4ca9e2](https://github.com/sagemath/sagetrac-mirror/commit/b4ca9e2144939f844d3a35788629b159278a8487)** to **[500a8a6](https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb)**",
    "created_at": "2018-03-07T09:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371097",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b4ca9e2](https://github.com/sagemath/sagetrac-mirror/commit/b4ca9e2144939f844d3a35788629b159278a8487)** to **[500a8a6](https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb)**



---

archive/issue_comments_371098.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9c93a7f8ce56096b0e021a8555107eb9f700b29\">d9c93a7</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb\">500a8a6</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>\n",
    "created_at": "2018-03-07T09:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371098",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:42'>Comment 42:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9c93a7f8ce56096b0e021a8555107eb9f700b29">d9c93a7</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb">500a8a6</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>




---

archive/issue_comments_371099.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nI didn't mean to delete it, and there was at least one good reason for it which is that deleting attributes off objects is just ugly when you can set them to None instead.\n\nI'm reworking some of this code elsewhere so I'm not going to worry about it though.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9c93a7f8ce56096b0e021a8555107eb9f700b29\">d9c93a7</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb\">500a8a6</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>\n",
    "created_at": "2018-03-07T09:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371099",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'>Comment 43:</a>
I didn't mean to delete it, and there was at least one good reason for it which is that deleting attributes off objects is just ugly when you can set them to None instead.

I'm reworking some of this code elsewhere so I'm not going to worry about it though.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9c93a7f8ce56096b0e021a8555107eb9f700b29">d9c93a7</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb">500a8a6</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>




---

archive/issue_comments_371100.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nThis added call to `save_result_output` is causing breakage:\n\n```diff\n+        # Save any result output so far before we kill the process off\n+        self.save_result_output()\n```\n\n```\nsage -t --long src/sage/doctest/forker.py\n**********************************************************************\nFile \"src/sage/doctest/forker.py\", line 2104, in sage.doctest.forker.DocTestWorker.save_result_output\nFailed example:\n    W.kill()\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 556, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 966, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.doctest.forker.DocTestWorker.save_result_output[14]>\", line 1, in <module>\n        W.kill()\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2176, in kill\n        self.save_result_output()\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2114, in save_result_output\n        self.result = self.result_queue.get(block=False)\n    AttributeError: 'DocTestWorker' object has no attribute 'result_queue'\n**********************************************************************\n```\nNow I see that you needed [comment:29] to fix that breakage but why did you need to add a call to `save_result_output` in `kill()`? All doctests pass when I remove that.",
    "created_at": "2018-03-07T10:36:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371100",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'>Comment 44:</a>
This added call to `save_result_output` is causing breakage:

```diff
+        # Save any result output so far before we kill the process off
+        self.save_result_output()
```

```
sage -t --long src/sage/doctest/forker.py
**********************************************************************
File "src/sage/doctest/forker.py", line 2104, in sage.doctest.forker.DocTestWorker.save_result_output
Failed example:
    W.kill()
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 556, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 966, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.doctest.forker.DocTestWorker.save_result_output[14]>", line 1, in <module>
        W.kill()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2176, in kill
        self.save_result_output()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2114, in save_result_output
        self.result = self.result_queue.get(block=False)
    AttributeError: 'DocTestWorker' object has no attribute 'result_queue'
**********************************************************************
```
Now I see that you needed [comment:29] to fix that breakage but why did you need to add a call to `save_result_output` in `kill()`? All doctests pass when I remove that.



---

archive/issue_events_319497.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-07T10:36:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319497"
}
```



---

archive/issue_events_319498.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-07T10:36:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319498"
}
```



---

archive/issue_comments_371101.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nhttps://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670",
    "created_at": "2018-03-07T10:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371101",
    "user": "https://github.com/embray"
}
```

<a id='comment:45'>Comment 45:</a>
https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670



---

archive/issue_comments_371102.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nDoes Python 3 no longer support the `\"a\"` mode in `fdopen()`? I consider that a bug. It might not matter for the doctesting framework, but the `\"w\"` and `\"a\"` options are not equivalent, especially when multiple processes write to the same file.",
    "created_at": "2018-03-07T10:49:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371102",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:46'>Comment 46:</a>
Does Python 3 no longer support the `"a"` mode in `fdopen()`? I consider that a bug. It might not matter for the doctesting framework, but the `"w"` and `"a"` options are not equivalent, especially when multiple processes write to the same file.



---

archive/issue_comments_371103.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nWhy are you wrapping all `close()` calls in a `try`/`except` block? If a file fails to close for some reason, that's a genuine error.",
    "created_at": "2018-03-07T10:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371103",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'>Comment 47:</a>
Why are you wrapping all `close()` calls in a `try`/`except` block? If a file fails to close for some reason, that's a genuine error.



---

archive/issue_comments_371104.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nI don't recall why the change from \"w\" to \"a\" mode.  Maybe there was a reason, but in this case it seems I didn't document it. You you can try removing it and see.  Maybe I was thinking about https://bugs.python.org/issue20082",
    "created_at": "2018-03-07T11:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371104",
    "user": "https://github.com/embray"
}
```

<a id='comment:48'>Comment 48:</a>
I don't recall why the change from "w" to "a" mode.  Maybe there was a reason, but in this case it seems I didn't document it. You you can try removing it and see.  Maybe I was thinking about https://bugs.python.org/issue20082



---

archive/issue_comments_371105.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nReplying to [@jdemeyer](#comment%3A47):\n> Why are you wrapping all `close()` calls in a `try`/`except` block? If a file fails to close for some reason, that's a genuine error.\n\nNot \"all\".  Those are in `__del__` methods, where you can't assume the files are still even open.",
    "created_at": "2018-03-07T11:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371105",
    "user": "https://github.com/embray"
}
```

<a id='comment:49'>Comment 49:</a>
Replying to [@jdemeyer](#comment%3A47):
> Why are you wrapping all `close()` calls in a `try`/`except` block? If a file fails to close for some reason, that's a genuine error.

Not "all".  Those are in `__del__` methods, where you can't assume the files are still even open.



---

archive/issue_comments_371106.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nReplying to [@embray](#comment%3A45):\n> https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670\n\nI guess you mean this sentence from the commit message:\n> Note that `DocTestWorker.kill()` now calls `sage_results_output` [sic], which ensures that the `DocTestWorker.outtmpfile` is closed.\n\nWhy not simply call `self.outtmpfile.close()` in `kill`?",
    "created_at": "2018-03-07T11:07:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371106",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'>Comment 50:</a>
Replying to [@embray](#comment%3A45):
> https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670

I guess you mean this sentence from the commit message:
> Note that `DocTestWorker.kill()` now calls `sage_results_output` [sic], which ensures that the `DocTestWorker.outtmpfile` is closed.

Why not simply call `self.outtmpfile.close()` in `kill`?



---

archive/issue_comments_371107.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nReplying to [@embray](#comment%3A49):\n> Not \"all\".  Those are in `__del__` methods, where you can't assume the files are still even open.\n\nEven if the file is already closed, Python allows closing an already-closed file:\n\n```\n>>> f = open(\"/dev/null\")\n>>> f.close()\n>>> f.close()\n```",
    "created_at": "2018-03-07T11:08:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371107",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'>Comment 51:</a>
Replying to [@embray](#comment%3A49):
> Not "all".  Those are in `__del__` methods, where you can't assume the files are still even open.

Even if the file is already closed, Python allows closing an already-closed file:

```
>>> f = open("/dev/null")
>>> f.close()
>>> f.close()
```



---

archive/issue_comments_371108.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nReplying to [@embray](#comment%3A48):\n> I don't recall why the change from \"w\" to \"a\" mode.  Maybe there was a reason, but in this case it seems I didn't document it. You you can try removing it and see.  Maybe I was thinking about https://bugs.python.org/issue20082\n\nNo, it's worse than that:\n\n```\nPython 3.6.1 (default, Feb 19 2018, 09:57:52) \n[GCC 4.9.4] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import os\n>>> os.fdopen(2, \"a\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/src/sage-config/local/lib/python3.6/os.py\", line 1015, in fdopen\n    return io.open(fd, *args, **kwargs)\nOSError: [Errno 29] Illegal seek\n```",
    "created_at": "2018-03-07T11:09:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371108",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:52'>Comment 52:</a>
Replying to [@embray](#comment%3A48):
> I don't recall why the change from "w" to "a" mode.  Maybe there was a reason, but in this case it seems I didn't document it. You you can try removing it and see.  Maybe I was thinking about https://bugs.python.org/issue20082

No, it's worse than that:

```
Python 3.6.1 (default, Feb 19 2018, 09:57:52) 
[GCC 4.9.4] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.fdopen(2, "a")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/src/sage-config/local/lib/python3.6/os.py", line 1015, in fdopen
    return io.open(fd, *args, **kwargs)
OSError: [Errno 29] Illegal seek
```



---

archive/issue_comments_371109.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\n(end of review for now)",
    "created_at": "2018-03-07T11:10:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371109",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'>Comment 53:</a>
(end of review for now)



---

archive/issue_comments_371110.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nWell, you could try removing it and see. I probably had a reason.",
    "created_at": "2018-03-07T11:12:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371110",
    "user": "https://github.com/embray"
}
```

<a id='comment:54'>Comment 54:</a>
Well, you could try removing it and see. I probably had a reason.



---

archive/issue_comments_371111.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nReplying to [@jdemeyer](#comment%3A52):\n> Replying to [@embray](#comment%3A48):\n> > I don't recall why the change from \"w\" to \"a\" mode.  Maybe there was a reason, but in this case it seems I didn't document it. You you can try removing it and see.  Maybe I was thinking about https://bugs.python.org/issue20082\n\n> \n> No, it's worse than that:\n> \n> ```\n> Python 3.6.1 (default, Feb 19 2018, 09:57:52) \n> [GCC 4.9.4] on linux\n> Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n> >>> import os\n> >>> os.fdopen(2, \"a\")\n> Traceback (most recent call last):\n>   File \"<stdin>\", line 1, in <module>\n>   File \"/usr/local/src/sage-config/local/lib/python3.6/os.py\", line 1015, in fdopen\n>     return io.open(fd, *args, **kwargs)\n> OSError: [Errno 29] Illegal seek\n> ```\n\nAh, right, this is https://bugs.python.org/issue27805",
    "created_at": "2018-03-07T11:16:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371111",
    "user": "https://github.com/embray"
}
```

<a id='comment:55'>Comment 55:</a>
Replying to [@jdemeyer](#comment%3A52):
> Replying to [@embray](#comment%3A48):
> > I don't recall why the change from "w" to "a" mode.  Maybe there was a reason, but in this case it seems I didn't document it. You you can try removing it and see.  Maybe I was thinking about https://bugs.python.org/issue20082

> 
> No, it's worse than that:
> 
> ```
> Python 3.6.1 (default, Feb 19 2018, 09:57:52) 
> [GCC 4.9.4] on linux
> Type "help", "copyright", "credits" or "license" for more information.
> >>> import os
> >>> os.fdopen(2, "a")
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
>   File "/usr/local/src/sage-config/local/lib/python3.6/os.py", line 1015, in fdopen
>     return io.open(fd, *args, **kwargs)
> OSError: [Errno 29] Illegal seek
> ```

Ah, right, this is https://bugs.python.org/issue27805



---

archive/issue_comments_371112.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nI still think whether it's needed or not, it's really ugly to just assign attributes to objects, and then delete them later, and have to do `hasattr(obj, attr)` on it when you could just set those attributes to `None` when they're not needed anymore.  Maybe this is some deeply-ingrained Java-ism, but I think deleting attributes is in most cases an anti-pattern.",
    "created_at": "2018-03-07T11:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371112",
    "user": "https://github.com/embray"
}
```

<a id='comment:56'>Comment 56:</a>
I still think whether it's needed or not, it's really ugly to just assign attributes to objects, and then delete them later, and have to do `hasattr(obj, attr)` on it when you could just set those attributes to `None` when they're not needed anymore.  Maybe this is some deeply-ingrained Java-ism, but I think deleting attributes is in most cases an anti-pattern.



---

archive/issue_comments_371113.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nThat said, I think maybe the `kill()` calls from [2203ca27](https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670) can be removed.  I tried taking all that stuff and out I don't get any ResourceWarnings.  So it's possible that while they did something at one time, additional fixes elsewhere rendered it unnecessary.",
    "created_at": "2018-03-07T11:28:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371113",
    "user": "https://github.com/embray"
}
```

<a id='comment:57'>Comment 57:</a>
That said, I think maybe the `kill()` calls from [2203ca27](https://github.com/sagemath/sagetrac-mirror/commit/2203ca27445e7db09cdf97b34896b6d8ea6eb670) can be removed.  I tried taking all that stuff and out I don't get any ResourceWarnings.  So it's possible that while they did something at one time, additional fixes elsewhere rendered it unnecessary.



---

archive/issue_comments_371114.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\nSame with the try/except around the close calls.  I don't seem to have made note of a specific reason for them.",
    "created_at": "2018-03-07T11:28:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371114",
    "user": "https://github.com/embray"
}
```

<a id='comment:58'>Comment 58:</a>
Same with the try/except around the close calls.  I don't seem to have made note of a specific reason for them.



---

archive/issue_comments_371115.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)** to **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)**",
    "created_at": "2018-03-07T11:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371115",
    "user": "https://github.com/embray"
}
```

Changed branch from **[u/jdemeyer/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/sage-doctest)** to **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)**



---

archive/issue_comments_371116.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nOkay, I removed a few of the changes you pointed out that don't appear to be necessary.  Other than that I wouldn't mess with anything else.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87a56de604f0f7a54542c8068c1333ae67ccbc47\">87a56de</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly where</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba9f9e771b56e7a2b19ef24ee481b8413d3843fc\">ba9f9e7</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>\n",
    "created_at": "2018-03-07T11:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371116",
    "user": "https://github.com/embray"
}
```

<a id='comment:59'>Comment 59:</a>
Okay, I removed a few of the changes you pointed out that don't appear to be necessary.  Other than that I wouldn't mess with anything else.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87a56de604f0f7a54542c8068c1333ae67ccbc47">87a56de</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly where</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba9f9e771b56e7a2b19ef24ee481b8413d3843fc">ba9f9e7</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>




---

archive/issue_events_319499.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-07T11:37:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319499"
}
```



---

archive/issue_events_319500.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-07T11:37:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319500"
}
```



---

archive/issue_comments_371117.json:
```json
{
    "body": "Changed commit from **[500a8a6](https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb)** to **[ba9f9e7](https://github.com/sagemath/sagetrac-mirror/commit/ba9f9e771b56e7a2b19ef24ee481b8413d3843fc)**",
    "created_at": "2018-03-07T11:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371117",
    "user": "https://github.com/embray"
}
```

Changed commit from **[500a8a6](https://github.com/sagemath/sagetrac-mirror/commit/500a8a63da95d9709d30b83120f70ddc797c3ceb)** to **[ba9f9e7](https://github.com/sagemath/sagetrac-mirror/commit/ba9f9e771b56e7a2b19ef24ee481b8413d3843fc)**



---

archive/issue_events_319501.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-07T11:38:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319501"
}
```



---

archive/issue_events_319502.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-07T11:38:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319502"
}
```



---

archive/issue_comments_371118.json:
```json
{
    "body": "<a id='comment:60'>Comment 60:</a>\nHold on, I thought I removed all those try/excepts...",
    "created_at": "2018-03-07T11:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371118",
    "user": "https://github.com/embray"
}
```

<a id='comment:60'>Comment 60:</a>
Hold on, I thought I removed all those try/excepts...



---

archive/issue_comments_371119.json:
```json
{
    "body": "<a id='comment:61'>Comment 61:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af86e5c72b3157112648d878a03a5fde2f508319\">af86e5c</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly where</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/436ed266f954ecf03f894b9c6539cca353a68ad6\">436ed26</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>\n",
    "created_at": "2018-03-07T11:41:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371119",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:61'>Comment 61:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af86e5c72b3157112648d878a03a5fde2f508319">af86e5c</a></td><td><code>Various fixes intended to ensure that opened files are closed explictly where</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/436ed266f954ecf03f894b9c6539cca353a68ad6">436ed26</a></td><td><code>A few other miscellaneous fixes to the doctests tests</code></td></tr></table>




---

archive/issue_comments_371120.json:
```json
{
    "body": "Changed commit from **[ba9f9e7](https://github.com/sagemath/sagetrac-mirror/commit/ba9f9e771b56e7a2b19ef24ee481b8413d3843fc)** to **[436ed26](https://github.com/sagemath/sagetrac-mirror/commit/436ed266f954ecf03f894b9c6539cca353a68ad6)**",
    "created_at": "2018-03-07T11:41:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371120",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ba9f9e7](https://github.com/sagemath/sagetrac-mirror/commit/ba9f9e771b56e7a2b19ef24ee481b8413d3843fc)** to **[436ed26](https://github.com/sagemath/sagetrac-mirror/commit/436ed266f954ecf03f894b9c6539cca353a68ad6)**



---

archive/issue_events_319503.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-07T11:42:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319503"
}
```



---

archive/issue_events_319504.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-07T11:42:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319504"
}
```



---

archive/issue_comments_371121.json:
```json
{
    "body": "<a id='comment:62'>Comment 62:</a>\nOkay.",
    "created_at": "2018-03-07T11:42:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371121",
    "user": "https://github.com/embray"
}
```

<a id='comment:62'>Comment 62:</a>
Okay.



---

archive/issue_comments_371122.json:
```json
{
    "body": "<a id='comment:63'>Comment 63:</a>\nOK, that seems good on first sight. The last commit (changing the `sleep()` time) is probably no longer needed. I guess you added it because `kill()` did more stuff and needed more time.\n\nAnd let me just think whether the change of `open()` mode from `\"a\"` to `\"w\"` could cause trouble...",
    "created_at": "2018-03-07T14:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371122",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:63'>Comment 63:</a>
OK, that seems good on first sight. The last commit (changing the `sleep()` time) is probably no longer needed. I guess you added it because `kill()` did more stuff and needed more time.

And let me just think whether the change of `open()` mode from `"a"` to `"w"` could cause trouble...



---

archive/issue_comments_371123.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2018-03-08T08:25:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371123",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_319505.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T08:25:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319505"
}
```



---

archive/issue_events_319506.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T08:25:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319506"
}
```



---

archive/issue_events_319507.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2018-03-13T20:41:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319507"
}
```



---

archive/issue_events_319508.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2018-03-13T20:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319508"
}
```



---

archive/issue_comments_371124.json:
```json
{
    "body": "<a id='comment:65'>Comment 65:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f\">2155133</a></td><td><code>missing string encoding fix</code></td></tr></table>\n",
    "created_at": "2018-03-13T20:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371124",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:65'>Comment 65:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f">2155133</a></td><td><code>missing string encoding fix</code></td></tr></table>




---

archive/issue_comments_371125.json:
```json
{
    "body": "Changed commit from **[436ed26](https://github.com/sagemath/sagetrac-mirror/commit/436ed266f954ecf03f894b9c6539cca353a68ad6)** to **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)**",
    "created_at": "2018-03-13T20:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371125",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[436ed26](https://github.com/sagemath/sagetrac-mirror/commit/436ed266f954ecf03f894b9c6539cca353a68ad6)** to **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)**



---

archive/issue_comments_371126.json:
```json
{
    "body": "<a id='comment:66'>Comment 66:</a>\nSorry, hopefully not too late to append to this ticket.  This little fix should have been here, and I think got lost somewhere along the way.",
    "created_at": "2018-03-13T20:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371126",
    "user": "https://github.com/embray"
}
```

<a id='comment:66'>Comment 66:</a>
Sorry, hopefully not too late to append to this ticket.  This little fix should have been here, and I think got lost somewhere along the way.



---

archive/issue_events_319509.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-13T20:43:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319509"
}
```



---

archive/issue_events_319510.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-03-13T20:43:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319510"
}
```



---

archive/issue_events_319511.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-21T06:19:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319511"
}
```



---

archive/issue_events_319512.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "fe173f2d9b26a95cade4f3a48b634c9624939f6d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-03-21T06:19:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24343#event-319512"
}
```



---

archive/issue_comments_371127.json:
```json
{
    "body": "Changed branch from **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)** to **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)**",
    "created_at": "2018-03-21T06:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371127",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/embray/python3/sage-doctest](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/sage-doctest)** to **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)**



---

archive/issue_comments_371128.json:
```json
{
    "body": "<a id='comment:69'>Comment 69:</a>\nI think some of the stuff I ended up removing from this was needed after all.  It might not have shown up either because:\n\na) I was originally testing with a debug build of Python which always displays `ResourceWarning`s by default (a non-debug build does not)\n\nb) Some of it might have been particular to Cygwin, but I switched mostly to testing on Linux later on.",
    "created_at": "2018-04-06T14:39:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371128",
    "user": "https://github.com/embray"
}
```

<a id='comment:69'>Comment 69:</a>
I think some of the stuff I ended up removing from this was needed after all.  It might not have shown up either because:

a) I was originally testing with a debug build of Python which always displays `ResourceWarning`s by default (a non-debug build does not)

b) Some of it might have been particular to Cygwin, but I switched mostly to testing on Linux later on.



---

archive/issue_comments_371129.json:
```json
{
    "body": "Changed commit from **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)** to none",
    "created_at": "2018-04-06T14:39:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24343",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24343#issuecomment-371129",
    "user": "https://github.com/embray"
}
```

Changed commit from **[2155133](https://github.com/sagemath/sagetrac-mirror/commit/2155133fa6f901ac92ea0ba46ee5ea403ee4f18f)** to none
