# Issue 24176: ConditionSet, ImageSet: Implement formal Set comprehension

archive/issues_023939.json:
```json
{
    "body": "In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's `imageset` / `ConditionSet` is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.\n\nThis set would convert to a `SymPy` [ImageSet](https://docs.sympy.org/latest/modules/sets.html#sympy.sets.fancysets.ImageSet) or [ConditionSet](https://docs.sympy.org/latest/modules/sets.html#conditionset)\n\nRelated: `ImageManifoldSubset` (#31653)\n\n\nCC:  @tscrim @mantepse\n\nReviewer: Travis Scrimshaw\n\nDependencies: #24171, #32013, #32089, #32121\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/24176\n\n",
    "closed_at": "2022-05-11T02:14:43Z",
    "created_at": "2017-11-08T16:54:30Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "ConditionSet, ImageSet: Implement formal Set comprehension",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24176",
    "user": "https://github.com/rwst"
}
```
In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's `imageset` / `ConditionSet` is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.

This set would convert to a `SymPy` [ImageSet](https://docs.sympy.org/latest/modules/sets.html#sympy.sets.fancysets.ImageSet) or [ConditionSet](https://docs.sympy.org/latest/modules/sets.html#conditionset)

Related: `ImageManifoldSubset` (#31653)


CC:  @tscrim @mantepse

Reviewer: Travis Scrimshaw

Dependencies: #24171, #32013, #32089, #32121

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/24176





---

archive/issue_comments_357061.json:
```json
{
    "body": "<a id='comment:2'></a>Accepting lists requires the function being a `GinacFunction`.",
    "created_at": "2017-11-10T08:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357061",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>Accepting lists requires the function being a `GinacFunction`.



---

archive/issue_comments_357062.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2017-11-21T16:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357062",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_events_061294.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-09T03:04:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61294"
}
```



---

archive/issue_comments_357063.json:
```json
{
    "body": "<a id='comment:8'></a>Rebased on top of rebased #24171\n\n---\nNew commits:",
    "created_at": "2021-06-09T03:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357063",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Rebased on top of rebased #24171

---
New commits:



---

archive/issue_comments_357064.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-06-09T03:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357064",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_357065.json:
```json
{
    "body": "<a id='comment:10'></a>Rebased on top of updated #24171, which cherry-picked 1 commit from here.\n\nNot sure about the changes on this ticket marked 24171. They are either from a newer or older version of 24171.",
    "created_at": "2021-06-09T04:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357065",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Rebased on top of updated #24171, which cherry-picked 1 commit from here.

Not sure about the changes on this ticket marked 24171. They are either from a newer or older version of 24171.



---

archive/issue_comments_357066.json:
```json
{
    "body": "<a id='comment:11'></a>The fix to `RealSet.__bool__` in 6995d1e/2a9c49a can go to #31941 (Make empty `RealSet` false).\n\nUnclear to me whether 6995d1e (make `RealSet` inherit from `Set_generic`) should be done",
    "created_at": "2021-06-09T04:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357066",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>The fix to `RealSet.__bool__` in 6995d1e/2a9c49a can go to #31941 (Make empty `RealSet` false).

Unclear to me whether 6995d1e (make `RealSet` inherit from `Set_generic`) should be done



---

archive/issue_comments_357067.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n-In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's imageset is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.\n+In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's `imageset` / `ConditionSet` is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.\n+\n+This set would convert to a `SymPy` [ImageSet](https://docs.sympy.org/latest/modules/sets.html#sympy.sets.fancysets.ImageSet) or [ConditionSet](https://docs.sympy.org/latest/modules/sets.html#conditionset)\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-06-10T02:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357067",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
-In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's imageset is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.
+In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's `imageset` / `ConditionSet` is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.
+
+This set would convert to a `SymPy` [ImageSet](https://docs.sympy.org/latest/modules/sets.html#sympy.sets.fancysets.ImageSet) or [ConditionSet](https://docs.sympy.org/latest/modules/sets.html#conditionset)
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_357068.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,8 @@\n+In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's `imageset` / `ConditionSet` is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.\n+\n+This set would convert to a `SymPy` [ImageSet](https://docs.sympy.org/latest/modules/sets.html#sympy.sets.fancysets.ImageSet) or [ConditionSet](https://docs.sympy.org/latest/modules/sets.html#conditionset)\n+\n+Related: `ImageManifoldSubset` (#31653)\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-06-10T02:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357068",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,8 @@
+In order to be able to express solution sets from SymPy's `solveset` a set comprehension constructor as equivalent to SymPy's `imageset` / `ConditionSet` is needed. As the arguments are symbolic the most natural way to do this would be a formal symbolic function named like `set_of_all` taking a term argument and a list argument containing `element_of(...)` function expressions.
+
+This set would convert to a `SymPy` [ImageSet](https://docs.sympy.org/latest/modules/sets.html#sympy.sets.fancysets.ImageSet) or [ConditionSet](https://docs.sympy.org/latest/modules/sets.html#conditionset)
+
+Related: `ImageManifoldSubset` (#31653)
 
 
 Comment: 1
``````




---

archive/issue_comments_357069.json:
```json
{
    "body": "<a id='comment:14'></a>I think the approach on the current branch may be tied a bit too closely to `SR` functions.\n\nI think it's better to first implement:\n\n- `ImageSubset` (as an abstract subobject of the codomain) for arbitrary `Map`s -- this would be a generalization of `ImageManifoldSubset` (#31653). No relation to `SR` (but by relaxing the code from #24171 that only allows some sets to be coerced to `SR`, one would be able to coerce it to `SR`).\n\n- `ConditionSet` (as an abstract subobject of a parent in the `Sets` category) - defined via the element constructor of the parent and an `SR` expression with truth value.",
    "created_at": "2021-06-10T03:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357069",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>I think the approach on the current branch may be tied a bit too closely to `SR` functions.

I think it's better to first implement:

- `ImageSubset` (as an abstract subobject of the codomain) for arbitrary `Map`s -- this would be a generalization of `ImageManifoldSubset` (#31653). No relation to `SR` (but by relaxing the code from #24171 that only allows some sets to be coerced to `SR`, one would be able to coerce it to `SR`).

- `ConditionSet` (as an abstract subobject of a parent in the `Sets` category) - defined via the element constructor of the parent and an `SR` expression with truth value.



---

archive/issue_comments_357070.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:14 mkoeppe]:\n> - `ConditionSet` (as an abstract subobject of a parent in the `Sets` category) - defined via the element constructor of the parent and an `SR` expression with truth value.\n\n\nmore precisely... an element of `CallableSymbolicExpression` (see #32008 for making this safer)",
    "created_at": "2021-06-19T03:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357070",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [comment:14 mkoeppe]:
> - `ConditionSet` (as an abstract subobject of a parent in the `Sets` category) - defined via the element constructor of the parent and an `SR` expression with truth value.


more precisely... an element of `CallableSymbolicExpression` (see #32008 for making this safer)



---

archive/issue_comments_357071.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:16 mkoeppe]:\n> Replying to [comment:14 mkoeppe]:\n> > - `ConditionSet` (as an abstract subobject of a parent in the `Sets` category) - defined via the element constructor of the parent and an `SR` expression with truth value.\n \n> \n> more precisely... an element of `CallableSymbolicExpression` (see #32008 for making this safer)\n\n\nThis is now implemented in #32089.",
    "created_at": "2021-07-02T02:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357071",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>Replying to [comment:16 mkoeppe]:
> Replying to [comment:14 mkoeppe]:
> > - `ConditionSet` (as an abstract subobject of a parent in the `Sets` category) - defined via the element constructor of the parent and an `SR` expression with truth value.
 
> 
> more precisely... an element of `CallableSymbolicExpression` (see #32008 for making this safer)


This is now implemented in #32089.



---

archive/issue_comments_357072.json:
```json
{
    "body": "<a id='comment:19'></a>`ImageSet` is essentially the same as the (deprecated?) `sage.combinat.combinat.MapCombinatorialClass`, except that we would not insist that the map is injective.",
    "created_at": "2021-07-04T02:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357072",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>`ImageSet` is essentially the same as the (deprecated?) `sage.combinat.combinat.MapCombinatorialClass`, except that we would not insist that the map is injective.



---

archive/issue_comments_357073.json:
```json
{
    "body": "<a id='comment:20'></a>Opened #32121 Replace `MapCombinatorialClass`",
    "created_at": "2021-07-04T03:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357073",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Opened #32121 Replace `MapCombinatorialClass`



---

archive/issue_comments_357074.json:
```json
{
    "body": "<a id='comment:22'></a>`@`mkoeppe: since you put me into the CC list, would this include symbolic roots of polynomials, given by the minimal polynomial?\n\nI am guessing (because I'm not an expert there) that these would really need a special treatment, because one can compute with them quite well.",
    "created_at": "2021-07-06T06:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357074",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:22'></a>`@`mkoeppe: since you put me into the CC list, would this include symbolic roots of polynomials, given by the minimal polynomial?

I am guessing (because I'm not an expert there) that these would really need a special treatment, because one can compute with them quite well.



---

archive/issue_events_061295.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61295"
}
```



---

archive/issue_events_061296.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61296"
}
```



---

archive/issue_events_061297.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61297"
}
```



---

archive/issue_events_061298.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61298"
}
```



---

archive/issue_events_061299.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:14:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61299"
}
```



---

archive/issue_events_061300.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:14:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61300"
}
```



---

archive/issue_comments_357075.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-05T00:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357075",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_357076.json:
```json
{
    "body": "<a id='comment:25'></a>With #32121 merged, this is now finished",
    "created_at": "2022-03-05T00:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357076",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>With #32121 merged, this is now finished



---

archive/issue_comments_357077.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-05T23:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357077",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_357078.json:
```json
{
    "body": "<a id='comment:26'></a>Agreed.",
    "created_at": "2022-03-05T23:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357078",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>Agreed.



---

archive/issue_comments_357079.json:
```json
{
    "body": "<a id='comment:27'></a>Does #32121 provide a possibility to specify the set of roots of a polynomial?",
    "created_at": "2022-03-06T10:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357079",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:27'></a>Does #32121 provide a possibility to specify the set of roots of a polynomial?



---

archive/issue_comments_357080.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-05-11T02:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24176#issuecomment-357080",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid



---

archive/issue_events_061301.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-11T02:14:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24176",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24176#event-61301"
}
```
