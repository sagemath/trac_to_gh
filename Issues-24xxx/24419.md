# Issue 24419: sage -rst2ipynb is broken due to notedown

archive/issues_024182.json:
```json
{
    "assignees": [],
    "body": "\n```\n$ cat a.rst\ntitre\n-----\n\na::\n\n    sage: 2+2\n    4\n```\n\n```\n$ sage -rst2ipynb a.rst\nTraceback (most recent call last):\n  File \"/home/slabbe/GitBox/sage/local/bin/notedown\", line 11, in <module>\n    load_entry_point('notedown==1.5.0', 'console_scripts', 'notedown')()\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 561, in load_entry_point\n    return get_distribution(dist).load_entry_point(group, name)\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 2631, in load_entry_point\n    return ep.load()\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 2291, in load\n    return self.resolve()\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 2297, in resolve\n    module = __import__(self.module_name, fromlist=['__name__'], level=0)\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notedown/__init__.py\", line 8, in <module>\n    from .contentsmanager import NotedownContentsManager\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notedown/contentsmanager.py\", line 8, in <module>\n    from notebook.services.contents.filemanager import FileContentsManager\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notebook/services/contents/filemanager.py\", line 21, in <module>\n    from .manager import ContentsManager\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notebook/services/contents/manager.py\", line 38, in <module>\n    class ContentsManager(LoggingConfigurable):\n  File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notebook/services/contents/manager.py\", line 70, in ContentsManager\n    untitled_notebook = Unicode(_(\"Untitled\"), config=True,\nNameError: name '_' is not defined\nnotedown failed: 1\n```\n\nMoreover:\n\n```\nUsing --optional=ccache,dot2tex,mpir,notedown,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage\nDoctesting 1 file.\n\n...\n\n----------------------------------------------------------------------\nsage -t --warn-long 70.2 src/sage/tests/cmdline.py  # 5 doctests failed\n----------------------------------------------------------------------\n```\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24419_\n\n",
    "closed_at": "2017-12-22T10:45:09Z",
    "created_at": "2017-12-22T07:23:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage -rst2ipynb is broken due to notedown",
    "type": "issue",
    "updated_at": "2017-12-22T10:45:09Z",
    "url": "https://github.com/sagemath/sage/issues/24419",
    "user": "https://github.com/seblabbe"
}
```

```
$ cat a.rst
titre
-----

a::

    sage: 2+2
    4
```

```
$ sage -rst2ipynb a.rst
Traceback (most recent call last):
  File "/home/slabbe/GitBox/sage/local/bin/notedown", line 11, in <module>
    load_entry_point('notedown==1.5.0', 'console_scripts', 'notedown')()
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py", line 561, in load_entry_point
    return get_distribution(dist).load_entry_point(group, name)
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py", line 2631, in load_entry_point
    return ep.load()
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py", line 2291, in load
    return self.resolve()
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/pkg_resources/__init__.py", line 2297, in resolve
    module = __import__(self.module_name, fromlist=['__name__'], level=0)
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notedown/__init__.py", line 8, in <module>
    from .contentsmanager import NotedownContentsManager
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notedown/contentsmanager.py", line 8, in <module>
    from notebook.services.contents.filemanager import FileContentsManager
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notebook/services/contents/filemanager.py", line 21, in <module>
    from .manager import ContentsManager
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notebook/services/contents/manager.py", line 38, in <module>
    class ContentsManager(LoggingConfigurable):
  File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/notebook/services/contents/manager.py", line 70, in ContentsManager
    untitled_notebook = Unicode(_("Untitled"), config=True,
NameError: name '_' is not defined
notedown failed: 1
```

Moreover:

```
Using --optional=ccache,dot2tex,mpir,notedown,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage
Doctesting 1 file.

...

----------------------------------------------------------------------
sage -t --warn-long 70.2 src/sage/tests/cmdline.py  # 5 doctests failed
----------------------------------------------------------------------
```

_Issue created by migration from https://trac.sagemath.org/ticket/24419_





---

archive/issue_events_320399.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2017-12-22T07:23:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320399"
}
```



---

archive/issue_events_320400.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2017-12-22T07:23:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320400"
}
```



---

archive/issue_events_320401.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2017-12-22T07:23:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320401"
}
```



---

archive/issue_events_320402.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2017-12-22T07:23:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320402"
}
```



---

archive/issue_comments_372420.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nDuplicate of #24376",
    "created_at": "2017-12-22T10:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24419#issuecomment-372420",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'>Comment 1:</a>
Duplicate of #24376



---

archive/issue_events_320403.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-22T10:45:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320403"
}
```



---

archive/issue_events_320404.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-22T10:45:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320404"
}
```



---

archive/issue_events_320405.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-22T10:45:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320405"
}
```



---

archive/issue_events_320406.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-22T10:45:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320406"
}
```



---

archive/issue_events_320407.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-22T10:45:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24419",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "a6a6a6",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24419#event-320407"
}
```
