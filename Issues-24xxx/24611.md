# Issue 24611: Singular fails to build on SunOS

archive/issues_024374.json:
```json
{
    "body": "There are several issues:\n\n1. `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.\n**Upstream**: https://github.com/Singular/Sources/pull/848\n\n2.\n\n```\nwalk.cc: In function 'intvec* MWalkRandomNextWeight(ideal, intvec*, intvec*, int, int)':\nwalk.cc:4564:49: error: call of overloaded 'sqrt(int&)' is ambiguous\n         weight_norm = 1 + floor(sqrt(weight_norm));\n```\n**Upstream**: https://github.com/Singular/Sources/pull/852\n\n3.\n\n```\nwalk.cc:4570:103: error: call of overloaded 'floor(int)' is ambiguous\n           (*next_weight2)[i] = 1 + (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);\n```\nand\n\n```\nwalk.cc:4574:99: error: call of overloaded 'floor(int)' is ambiguous\n           (*next_weight2)[i] = (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);\n```\n**Upstream**: https://github.com/Singular/Sources/pull/850\n\n4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). \n**Upstream**: http://www.singular.uni-kl.de:8002/trac/ticket/816\n\n5. Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)\n**Upstream**: https://github.com/Singular/Sources/pull/847\n\nCC:  @jdemeyer @embray\n\nBranch/Commit: 504dbaf654efa16170bfbc8cf4c76568d35c5caa\n\nUpstream: Fixed upstream, but not in a stable release.\n\nReviewer: Dima Pasechnik\n\nAuthor: Jeroen Demeyer, Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24611\n\n",
    "closed_at": "2018-02-09T08:03:54Z",
    "created_at": "2018-01-29T23:28:14Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Singular fails to build on SunOS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24611",
    "user": "https://github.com/dimpase"
}
```
There are several issues:

1. `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.
**Upstream**: https://github.com/Singular/Sources/pull/848

2.

```
walk.cc: In function 'intvec* MWalkRandomNextWeight(ideal, intvec*, intvec*, int, int)':
walk.cc:4564:49: error: call of overloaded 'sqrt(int&)' is ambiguous
         weight_norm = 1 + floor(sqrt(weight_norm));
```
**Upstream**: https://github.com/Singular/Sources/pull/852

3.

```
walk.cc:4570:103: error: call of overloaded 'floor(int)' is ambiguous
           (*next_weight2)[i] = 1 + (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);
```
and

```
walk.cc:4574:99: error: call of overloaded 'floor(int)' is ambiguous
           (*next_weight2)[i] = (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);
```
**Upstream**: https://github.com/Singular/Sources/pull/850

4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). 
**Upstream**: http://www.singular.uni-kl.de:8002/trac/ticket/816

5. Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)
**Upstream**: https://github.com/Singular/Sources/pull/847

CC:  @jdemeyer @embray

Branch/Commit: 504dbaf654efa16170bfbc8cf4c76568d35c5caa

Upstream: Fixed upstream, but not in a stable release.

Reviewer: Dima Pasechnik

Author: Jeroen Demeyer, Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24611





---

archive/issue_comments_466427.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2018-01-30T09:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466427",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_466428.json:
```json
{
    "body": "<a id='comment:1'></a>\nI have a fix for this, not yet tested on other systems\n\n```\ndiff --git a/libpolys/polys/Makefile.am b/libpolys/polys/Makefile.am\nindex 307cb48..556d919 100644\n--- a/libpolys/polys/Makefile.am\n+++ b/libpolys/polys/Makefile.am\n@@ -65,7 +65,7 @@ p_Procs_FieldIndep_la_CPPFLAGS = -Dp_Procs_FieldIndep ${P_PROCS_CPPFLAGS_COMMON}\n p_Procs_FieldQ_la_CPPFLAGS = -Dp_Procs_FieldQ ${P_PROCS_CPPFLAGS_COMMON}\n p_Procs_FieldZp_la_CPPFLAGS = -Dp_Procs_FieldZp ${P_PROCS_CPPFLAGS_COMMON}\n \n-P_PROCS_MODULE_LDFLAGS = -shared -module -dynamic -export-dynamic -avoid-version -weak_reference_mismatches weak -undefined dynamic_lookup -Wl,-undefined -Wl,dynamic_lookup -flat_namespace $(SINGULAR_LDFLAGS)\n+P_PROCS_MODULE_LDFLAGS = -shared -module -dynamic -export-dynamic -avoid-version -weak_reference_mismatches weak -undefined dynamic_lookup -flat_namespace $(SINGULAR_LDFLAGS)\n \n p_Procs_FieldGeneral_la_LDFLAGS = ${P_PROCS_MODULE_LDFLAGS}\n p_Procs_FieldIndep_la_LDFLAGS = ${P_PROCS_MODULE_LDFLAGS}\n```\nnote that `P_PROCS_MODULE_LDFLAGS` still looks very verbose, I wonder why.\n\n(The following still needs to be reported upstream):\nAdding `https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html`\nto `m4/` and calling it\n\n```\ndiff --git a/configure.ac b/configure.ac\nindex 00e1113..6d238a7 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -153,6 +153,7 @@ m4_ifval([$3],\n fi[]dnl\n ])])\n \n+AX_LIB_SOCKET_NSL\n \n AC_DEFINE_UNQUOTED([CC],\"$CC\",[CC])\n AC_DEFINE_UNQUOTED([CXX],\"$CXX\",[CXX])\n```\n\nAfter these changes, I ran Singular's `./autogen.sh`, producing a 90+K diff to their tarball. Applying this patch makes Singular build on Solaris 11.\n(Probably the diff size can be reduced by using a more closely matching, version-wise, autotools).\n\nPackaging a 90+K diff looks a bit silly - what should one do to package it (until the upstream picks it up, which might take I don't know how long).\n\nDo we distribute a patched tarball now?",
    "created_at": "2018-01-30T09:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466428",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
I have a fix for this, not yet tested on other systems

```
diff --git a/libpolys/polys/Makefile.am b/libpolys/polys/Makefile.am
index 307cb48..556d919 100644
--- a/libpolys/polys/Makefile.am
+++ b/libpolys/polys/Makefile.am
@@ -65,7 +65,7 @@ p_Procs_FieldIndep_la_CPPFLAGS = -Dp_Procs_FieldIndep ${P_PROCS_CPPFLAGS_COMMON}
 p_Procs_FieldQ_la_CPPFLAGS = -Dp_Procs_FieldQ ${P_PROCS_CPPFLAGS_COMMON}
 p_Procs_FieldZp_la_CPPFLAGS = -Dp_Procs_FieldZp ${P_PROCS_CPPFLAGS_COMMON}
 
-P_PROCS_MODULE_LDFLAGS = -shared -module -dynamic -export-dynamic -avoid-version -weak_reference_mismatches weak -undefined dynamic_lookup -Wl,-undefined -Wl,dynamic_lookup -flat_namespace $(SINGULAR_LDFLAGS)
+P_PROCS_MODULE_LDFLAGS = -shared -module -dynamic -export-dynamic -avoid-version -weak_reference_mismatches weak -undefined dynamic_lookup -flat_namespace $(SINGULAR_LDFLAGS)
 
 p_Procs_FieldGeneral_la_LDFLAGS = ${P_PROCS_MODULE_LDFLAGS}
 p_Procs_FieldIndep_la_LDFLAGS = ${P_PROCS_MODULE_LDFLAGS}
```
note that `P_PROCS_MODULE_LDFLAGS` still looks very verbose, I wonder why.

(The following still needs to be reported upstream):
Adding `https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html`
to `m4/` and calling it

```
diff --git a/configure.ac b/configure.ac
index 00e1113..6d238a7 100644
--- a/configure.ac
+++ b/configure.ac
@@ -153,6 +153,7 @@ m4_ifval([$3],
 fi[]dnl
 ])])
 
+AX_LIB_SOCKET_NSL
 
 AC_DEFINE_UNQUOTED([CC],"$CC",[CC])
 AC_DEFINE_UNQUOTED([CXX],"$CXX",[CXX])
```

After these changes, I ran Singular's `./autogen.sh`, producing a 90+K diff to their tarball. Applying this patch makes Singular build on Solaris 11.
(Probably the diff size can be reduced by using a more closely matching, version-wise, autotools).

Packaging a 90+K diff looks a bit silly - what should one do to package it (until the upstream picks it up, which might take I don't know how long).

Do we distribute a patched tarball now?



---

archive/issue_comments_466429.json:
```json
{
    "body": "<a id='comment:2'></a>\nThat I don't know. I've been reasonably successful in getting singular to accept patches for platform-specific build issues though.",
    "created_at": "2018-01-30T11:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466429",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'></a>
That I don't know. I've been reasonably successful in getting singular to accept patches for platform-specific build issues though.



---

archive/issue_comments_466430.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [embray](#comment%3A2):\n> That I don't know. I've been reasonably successful in getting singular to accept patches for platform-specific build issues though.\n\n\nDo you need to do something Cygwin specific to get gethostbyname working in Singular?\n(IIRC you need `-lsocket` on Cygwin).\n\nHow do you report bugs for Singular? Do you have a trac account with them, or you submit anonymously, like I did?",
    "created_at": "2018-01-30T11:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466430",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
Replying to [embray](#comment%3A2):
> That I don't know. I've been reasonably successful in getting singular to accept patches for platform-specific build issues though.


Do you need to do something Cygwin specific to get gethostbyname working in Singular?
(IIRC you need `-lsocket` on Cygwin).

How do you report bugs for Singular? Do you have a trac account with them, or you submit anonymously, like I did?



---

archive/issue_comments_466431.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [dimpase](#comment%3A3):\n> Replying to [embray](#comment%3A2):\n> > That I don't know. I've been reasonably successful in getting singular to accept patches for platform-specific build issues though.\n\n> \n> Do you need to do something Cygwin specific to get gethostbyname working in Singular?\n> (IIRC you need `-lsocket` on Cygwin).\n\n\nNope, it's not needed. Sockets are part of the Cygwin DLL.\n\n> How do you report bugs for Singular? Do you have a trac account with them, or you submit anonymously, like I did?\n\n\nThey have a GitHub. I just sent pull requests: https://github.com/Singular/Sources",
    "created_at": "2018-01-30T11:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466431",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
Replying to [dimpase](#comment%3A3):
> Replying to [embray](#comment%3A2):
> > That I don't know. I've been reasonably successful in getting singular to accept patches for platform-specific build issues though.

> 
> Do you need to do something Cygwin specific to get gethostbyname working in Singular?
> (IIRC you need `-lsocket` on Cygwin).


Nope, it's not needed. Sockets are part of the Cygwin DLL.

> How do you report bugs for Singular? Do you have a trac account with them, or you submit anonymously, like I did?


They have a GitHub. I just sent pull requests: https://github.com/Singular/Sources



---

archive/issue_comments_466432.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe first bug is already fixed :-)",
    "created_at": "2018-01-31T10:37:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466432",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
The first bug is already fixed :-)



---

archive/issue_comments_466433.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,7 @@\n-there are two issues:\n+There are several issues:\n \n-* specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). (see http://www.singular.uni-kl.de:8002/trac/ticket/816)\n+* `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.\n \n-* undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)\n+* Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816\n+\n+* Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)\n``````\n",
    "created_at": "2018-01-31T10:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466433",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,7 @@
-there are two issues:
+There are several issues:
 
-* specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). (see http://www.singular.uni-kl.de:8002/trac/ticket/816)
+* `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.
 
-* undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)
+* Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816
+
+* Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)
``````




---

archive/issue_comments_466434.json:
```json
{
    "body": "<a id='comment:7'></a>\nI am going to submit a Singular issue for `gethostbyname` problem.",
    "created_at": "2018-01-31T11:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466434",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
I am going to submit a Singular issue for `gethostbyname` problem.



---

archive/issue_comments_466435.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2018-01-31T12:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466435",
    "user": "https://github.com/dimpase"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Fixed upstream, in a later stable release."



---

archive/issue_comments_466436.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [dimpase](#comment%3A7):\n> I am going to submit a Singular issue for `gethostbyname` problem.\n\n\nThis is now https://github.com/Singular/Sources/pull/847",
    "created_at": "2018-01-31T12:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466436",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
Replying to [dimpase](#comment%3A7):
> I am going to submit a Singular issue for `gethostbyname` problem.


This is now https://github.com/Singular/Sources/pull/847



---

archive/issue_comments_466437.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [dimpase](#comment%3A8):\n> Replying to [dimpase](#comment%3A7):\n> > I am going to submit a Singular issue for `gethostbyname` problem.\n\n> \n> This is now https://github.com/Singular/Sources/pull/847\n\n\nnow merged.",
    "created_at": "2018-01-31T14:22:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466437",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
Replying to [dimpase](#comment%3A8):
> Replying to [dimpase](#comment%3A7):
> > I am going to submit a Singular issue for `gethostbyname` problem.

> 
> This is now https://github.com/Singular/Sources/pull/847


now merged.



---

archive/issue_comments_466438.json:
```json
{
    "body": "<a id='comment:10'></a>\nAre we going to make a patched tarball? (I am able to build with the linking-related patches as well as the one adding `std::` to `int pow(int, int)` calls).\n\n`std::` to `int pow(int, int)` still needs to be reported upstream",
    "created_at": "2018-02-01T01:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466438",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
Are we going to make a patched tarball? (I am able to build with the linking-related patches as well as the one adding `std::` to `int pow(int, int)` calls).

`std::` to `int pow(int, int)` still needs to be reported upstream



---

archive/issue_comments_466439.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [dimpase](#comment%3A10):\n> \n> `std::` to `int pow(int, int)` still needs to be reported upstream\n\n\ndone: I created https://github.com/Singular/Sources/pull/848",
    "created_at": "2018-02-01T15:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466439",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
Replying to [dimpase](#comment%3A10):
> 
> `std::` to `int pow(int, int)` still needs to be reported upstream


done: I created https://github.com/Singular/Sources/pull/848



---

archive/issue_comments_466440.json:
```json
{
    "body": "<a id='comment:12'></a>\nShould I create a new spkg?",
    "created_at": "2018-02-02T11:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466440",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Should I create a new spkg?



---

archive/issue_comments_466441.json:
```json
{
    "body": "<a id='comment:13'></a>\nplease do - I might get busy later today with other things.",
    "created_at": "2018-02-02T11:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466441",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>
please do - I might get busy later today with other things.



---

archive/issue_comments_466442.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/singular_fails_to_build_on_sunos\"",
    "created_at": "2018-02-02T12:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466442",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/singular_fails_to_build_on_sunos"



---

archive/issue_comments_466443.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[ee69467](https://git.sagemath.org/sage.git/commit/?id=ee694673540bb05bab91bea8181d41b81d47d162)|`Fix building Singular on SunOS`|",
    "created_at": "2018-02-02T15:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[ee69467](https://git.sagemath.org/sage.git/commit/?id=ee694673540bb05bab91bea8181d41b81d47d162)|`Fix building Singular on SunOS`|



---

archive/issue_comments_466444.json:
```json
{
    "body": "Changing commit from \"\" to \"ee694673540bb05bab91bea8181d41b81d47d162\"",
    "created_at": "2018-02-02T15:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "ee694673540bb05bab91bea8181d41b81d47d162"



---

archive/issue_comments_466445.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,29 @@\n There are several issues:\n \n-* `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.\n+1. `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.\n \n-* Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816\n+2.\n \n-* Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)\n+```\n+walk.cc: In function 'intvec* MWalkRandomNextWeight(ideal, intvec*, intvec*, int, int)':\n+walk.cc:4564:49: error: call of overloaded 'sqrt(int&)' is ambiguous\n+         weight_norm = 1 + floor(sqrt(weight_norm));\n+```\n+\n+3.\n+\n+```\n+walk.cc:4570:103: error: call of overloaded 'floor(int)' is ambiguous\n+           (*next_weight2)[i] = 1 + (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);\n+```\n+and\n+\n+```\n+walk.cc:4574:99: error: call of overloaded 'floor(int)' is ambiguous\n+           (*next_weight2)[i] = (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);\n+```\n+Why is `floor()` called on integers?\n+\n+4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816\n+\n+5. Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)\n``````\n",
    "created_at": "2018-02-02T17:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466445",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,29 @@
 There are several issues:
 
-* `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.
+1. `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.
 
-* Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816
+2.
 
-* Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)
+```
+walk.cc: In function 'intvec* MWalkRandomNextWeight(ideal, intvec*, intvec*, int, int)':
+walk.cc:4564:49: error: call of overloaded 'sqrt(int&)' is ambiguous
+         weight_norm = 1 + floor(sqrt(weight_norm));
+```
+
+3.
+
+```
+walk.cc:4570:103: error: call of overloaded 'floor(int)' is ambiguous
+           (*next_weight2)[i] = 1 + (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);
+```
+and
+
+```
+walk.cc:4574:99: error: call of overloaded 'floor(int)' is ambiguous
+           (*next_weight2)[i] = (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);
+```
+Why is `floor()` called on integers?
+
+4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816
+
+5. Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)
``````




---

archive/issue_comments_466446.json:
```json
{
    "body": "Changing commit from \"ee694673540bb05bab91bea8181d41b81d47d162\" to \"4ea166485cf47f0456cfebe94cc15d7b8060c150\"",
    "created_at": "2018-02-02T17:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466446",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ee694673540bb05bab91bea8181d41b81d47d162" to "4ea166485cf47f0456cfebe94cc15d7b8060c150"



---

archive/issue_comments_466447.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[4ea1664](https://git.sagemath.org/sage.git/commit/?id=4ea166485cf47f0456cfebe94cc15d7b8060c150)|`Fix building Singular on SunOS`|",
    "created_at": "2018-02-02T17:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466447",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[4ea1664](https://git.sagemath.org/sage.git/commit/?id=4ea166485cf47f0456cfebe94cc15d7b8060c150)|`Fix building Singular on SunOS`|



---

archive/issue_comments_466448.json:
```json
{
    "body": "<a id='comment:18'></a>\nNote that the actual commit Singular for `int pow(int,int)` actually does casting to doubles and then back to ints (yuck!) --- well, they do this all over their code; no wonder one regularly comes up with an example a polynomial computation in Singular that uses large exponents, and returns patently wrong results, uncaught by the implementation...\n\n---\nNew commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[4ea1664](https://git.sagemath.org/sage.git/commit?id=4ea166485cf47f0456cfebe94cc15d7b8060c150)|`Fix building Singular on SunOS`|",
    "created_at": "2018-02-02T18:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466448",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>
Note that the actual commit Singular for `int pow(int,int)` actually does casting to doubles and then back to ints (yuck!) --- well, they do this all over their code; no wonder one regularly comes up with an example a polynomial computation in Singular that uses large exponents, and returns patently wrong results, uncaught by the implementation...

---
New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[4ea1664](https://git.sagemath.org/sage.git/commit?id=4ea166485cf47f0456cfebe94cc15d7b8060c150)|`Fix building Singular on SunOS`|



---

archive/issue_comments_466449.json:
```json
{
    "body": "<a id='comment:19'></a>\nI'd submitted https://github.com/Singular/Sources/pull/850 to deal with the `floor(int)` thing.",
    "created_at": "2018-02-03T04:15:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466449",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>
I'd submitted https://github.com/Singular/Sources/pull/850 to deal with the `floor(int)` thing.



---

archive/issue_comments_466450.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[504dbaf](https://git.sagemath.org/sage.git/commit/?id=504dbaf654efa16170bfbc8cf4c76568d35c5caa)|`Fix building Singular on SunOS`|",
    "created_at": "2018-02-03T08:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[504dbaf](https://git.sagemath.org/sage.git/commit/?id=504dbaf654efa16170bfbc8cf4c76568d35c5caa)|`Fix building Singular on SunOS`|



---

archive/issue_comments_466451.json:
```json
{
    "body": "Changing commit from \"4ea166485cf47f0456cfebe94cc15d7b8060c150\" to \"504dbaf654efa16170bfbc8cf4c76568d35c5caa\"",
    "created_at": "2018-02-03T08:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4ea166485cf47f0456cfebe94cc15d7b8060c150" to "504dbaf654efa16170bfbc8cf4c76568d35c5caa"



---

archive/issue_comments_466452.json:
```json
{
    "body": "Changing upstream from \"Fixed upstream, in a later stable release.\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2018-02-03T08:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466452",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "Fixed upstream, in a later stable release." to "Reported upstream. No feedback yet."



---

archive/issue_comments_466453.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,7 @@\n There are several issues:\n \n 1. `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.\n+**Upstream**: https://github.com/Singular/Sources/pull/848\n \n 2.\n \n@@ -9,6 +10,7 @@\n walk.cc:4564:49: error: call of overloaded 'sqrt(int&)' is ambiguous\n          weight_norm = 1 + floor(sqrt(weight_norm));\n ```\n+**Upstream**: https://github.com/Singular/Sources/pull/852\n \n 3.\n \n@@ -22,8 +24,10 @@\n walk.cc:4574:99: error: call of overloaded 'floor(int)' is ambiguous\n            (*next_weight2)[i] = (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);\n ```\n-Why is `floor()` called on integers?\n+**Upstream**: https://github.com/Singular/Sources/pull/850\n \n-4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816\n+4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). \n+**Upstream**: http://www.singular.uni-kl.de:8002/trac/ticket/816\n \n 5. Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)\n+**Upstream**: https://github.com/Singular/Sources/pull/847\n``````\n",
    "created_at": "2018-02-03T08:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466453",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,7 @@
 There are several issues:
 
 1. `error: call of overloaded 'pow(int&, int&)' is ambiguous`: Solution: use `std::pow()` instead of `pow()`.
+**Upstream**: https://github.com/Singular/Sources/pull/848
 
 2.
 
@@ -9,6 +10,7 @@
 walk.cc:4564:49: error: call of overloaded 'sqrt(int&)' is ambiguous
          weight_norm = 1 + floor(sqrt(weight_norm));
 ```
+**Upstream**: https://github.com/Singular/Sources/pull/852
 
 3.
 
@@ -22,8 +24,10 @@
 walk.cc:4574:99: error: call of overloaded 'floor(int)' is ambiguous
            (*next_weight2)[i] = (*curr_weight)[i] + floor(weight_rad*(*next_weight2)[i]/weight_norm);
 ```
-Why is `floor()` called on integers?
+**Upstream**: https://github.com/Singular/Sources/pull/850
 
-4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). Fixed upstream, see http://www.singular.uni-kl.de:8002/trac/ticket/816
+4. Specific `-Wl` linker syntax in `libpolys/polys/Makefile.am` which nukes linking (as Solaris linker does not accept `dynamic_lookup` parameter). (By right, it's autotools that should generate such platform-specific arguments, it's asking for trouble to give them explicitly). 
+**Upstream**: http://www.singular.uni-kl.de:8002/trac/ticket/816
 
 5. Undefined `gethostbyname` and some other symbols from `-lsocket` and `-lnsl`. This is something that should be set by an autoconf macro, e.g. [ax_lib_socket_nsl](https://www.gnu.org/software/autoconf-archive/ax_lib_socket_nsl.html)
+**Upstream**: https://github.com/Singular/Sources/pull/847
``````




---

archive/issue_comments_466454.json:
```json
{
    "body": "Changing author from \"Dima Pasechnik\" to \"Jeroen Demeyer\"",
    "created_at": "2018-02-03T10:15:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466454",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Dima Pasechnik" to "Jeroen Demeyer"



---

archive/issue_comments_466455.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-02-03T10:15:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466455",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_466456.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\"",
    "created_at": "2018-02-03T20:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466456",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release."



---

archive/issue_comments_466457.json:
```json
{
    "body": "<a id='comment:23'></a>\nAll patches are now applied upstream.",
    "created_at": "2018-02-03T20:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466457",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
All patches are now applied upstream.



---

archive/issue_comments_466458.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-05T21:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466458",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_466459.json:
```json
{
    "body": "<a id='comment:24'></a>\nlooks good to me",
    "created_at": "2018-02-05T21:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466459",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
looks good to me



---

archive/issue_comments_466460.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Dima Pasechnik\"",
    "created_at": "2018-02-05T21:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466460",
    "user": "https://github.com/dimpase"
}
```

Changing author from "Jeroen Demeyer" to "Jeroen Demeyer, Dima Pasechnik"



---

archive/issue_comments_466461.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2018-02-05T21:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466461",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_466462.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-02-09T08:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466462",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_466463.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/singular_fails_to_build_on_sunos\" to \"504dbaf654efa16170bfbc8cf4c76568d35c5caa\"",
    "created_at": "2018-02-09T08:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24611#issuecomment-466463",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/singular_fails_to_build_on_sunos" to "504dbaf654efa16170bfbc8cf4c76568d35c5caa"



---

archive/issue_events_062014.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-09T08:03:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24611",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24611#event-62014"
}
```
