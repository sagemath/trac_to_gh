# Issue 24585: r_jupyter package is broken

archive/issues_024348.json:
```json
{
    "body": "First, when trying to `sage -i r_jupyter`, the install fails since the `spkg-install` script is not executable (apparently nobody tried to install that package for a while):\n\n```\ncd '/opt/sagemath/sage-source' && \\\n    source '/opt/sagemath/sage-source/src/bin/sage-env' && \\\n    sage-logger -p '/opt/sagemath/sage-source/build/pkgs/r_jupyter/spkg-install' /opt/sagemath/sage-source/logs/pkgs/r_jupyter.log\n[r_jupyter] /opt/sagemath/sage-source/build/bin/sage-logger: line 89: /opt/sagemath/sage-source/build/pkgs/r_jupyter/spkg-install: Permission denied\n```\n\nThen, if i make that file executable, the script does not work at all:\n\n```\n[r_jupyter] Warning message:\n[r_jupyter] package 'IRkernel' is not available (for R version 3.4.3) \n[r_jupyter] > IRkernel::installspec()\n[r_jupyter] Error in loadNamespace(name) : there is no package called 'IRkernel'\n[r_jupyter] Calls: :: ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>\n[r_jupyter] Execution halted\n```\n\nDocumentation can be found at https://irkernel.github.io/installation/\n\nWe modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/share/jupyter/kernels/ir/` directory).\n\n\nCC:  @vbraun @EmmanuelCharpentier\n\nKeywords: sdl\n\nBranch/Commit: 13ffffe4b0e7a04fe6600e53f64efc0db6906172\n\nReviewer: Emmanuel Charpentier\n\nAuthor: Thierry Monteil\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24585\n\n",
    "closed_at": "2018-05-08T17:26:34Z",
    "created_at": "2018-01-22T23:10:37Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "r_jupyter package is broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24585",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
First, when trying to `sage -i r_jupyter`, the install fails since the `spkg-install` script is not executable (apparently nobody tried to install that package for a while):

```
cd '/opt/sagemath/sage-source' && \
    source '/opt/sagemath/sage-source/src/bin/sage-env' && \
    sage-logger -p '/opt/sagemath/sage-source/build/pkgs/r_jupyter/spkg-install' /opt/sagemath/sage-source/logs/pkgs/r_jupyter.log
[r_jupyter] /opt/sagemath/sage-source/build/bin/sage-logger: line 89: /opt/sagemath/sage-source/build/pkgs/r_jupyter/spkg-install: Permission denied
```

Then, if i make that file executable, the script does not work at all:

```
[r_jupyter] Warning message:
[r_jupyter] package 'IRkernel' is not available (for R version 3.4.3) 
[r_jupyter] > IRkernel::installspec()
[r_jupyter] Error in loadNamespace(name) : there is no package called 'IRkernel'
[r_jupyter] Calls: :: ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
[r_jupyter] Execution halted
```

Documentation can be found at https://irkernel.github.io/installation/

We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/share/jupyter/kernels/ir/` directory).


CC:  @vbraun @EmmanuelCharpentier

Keywords: sdl

Branch/Commit: 13ffffe4b0e7a04fe6600e53f64efc0db6906172

Reviewer: Emmanuel Charpentier

Author: Thierry Monteil

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24585





---

archive/issue_comments_467988.json:
```json
{
    "body": "Changing branch from \"\" to \"u/tmonteil/r_jupyter_package_is_broken\"",
    "created_at": "2018-01-22T23:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467988",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing branch from "" to "u/tmonteil/r_jupyter_package_is_broken"



---

archive/issue_comments_467989.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,5 +20,5 @@\n \n Documentation can be found at https://irkernel.github.io/installation/\n \n-We modify it so that the kernel is installed at the right place.\n+We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/blah/` directory).\n \n``````\n",
    "created_at": "2018-01-22T23:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467989",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,5 +20,5 @@
 
 Documentation can be found at https://irkernel.github.io/installation/
 
-We modify it so that the kernel is installed at the right place.
+We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/blah/` directory).
 
``````




---

archive/issue_comments_467990.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[a95bfd7](https://github.com/sagemath/sagetrac-mirror/commit/a95bfd7e6d580a65bc7f5ce804efa37515fc3e29)|`#24585 : fix permissions and content of build/pkgs/r_jupyter/spkg_install`|",
    "created_at": "2018-01-22T23:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467990",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[a95bfd7](https://github.com/sagemath/sagetrac-mirror/commit/a95bfd7e6d580a65bc7f5ce804efa37515fc3e29)|`#24585 : fix permissions and content of build/pkgs/r_jupyter/spkg_install`|



---

archive/issue_comments_467991.json:
```json
{
    "body": "Changing commit from \"\" to \"a95bfd7e6d580a65bc7f5ce804efa37515fc3e29\"",
    "created_at": "2018-01-22T23:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467991",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing commit from "" to "a95bfd7e6d580a65bc7f5ce804efa37515fc3e29"



---

archive/issue_comments_467992.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-22T23:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467992",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_467993.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n [r_jupyter] /opt/sagemath/sage-source/build/bin/sage-logger: line 89: /opt/sagemath/sage-source/build/pkgs/r_jupyter/spkg-install: Permission denied\n ```\n \n-Then, if u make that file executable, the script does not work at all:\n+Then, if i make that file executable, the script does not work at all:\n \n ```\n [r_jupyter] Warning message:\n@@ -20,5 +20,5 @@\n \n Documentation can be found at https://irkernel.github.io/installation/\n \n-We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/blah/` directory).\n+We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/share/jupyter/kernels/ir/` directory).\n \n``````\n",
    "created_at": "2018-01-22T23:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467993",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
 [r_jupyter] /opt/sagemath/sage-source/build/bin/sage-logger: line 89: /opt/sagemath/sage-source/build/pkgs/r_jupyter/spkg-install: Permission denied
 ```
 
-Then, if u make that file executable, the script does not work at all:
+Then, if i make that file executable, the script does not work at all:
 
 ```
 [r_jupyter] Warning message:
@@ -20,5 +20,5 @@
 
 Documentation can be found at https://irkernel.github.io/installation/
 
-We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/blah/` directory).
+We modify it so that the kernel is installed at the right place (otherwise it is installed in the user's `~/.local/share/jupyter/kernels/ir/` directory).
 
``````




---

archive/issue_comments_467994.json:
```json
{
    "body": "<a id='comment:4'></a>\n`r_jupyter` has been uninstallable for a long time : its installation procedure refers to outdated locations. I have been installing IRkernel \"by hand\"  for a while.\n\nThe problem is that [IRkernel](https://github.com/IRkernel/IRkernel) is not (yet) on CRAN ; their authors say they intend to subit it  [soon](https://github.com/IRkernel/IRkernel#installation) to CRAN, bu have intended so for a looong time. The [serial](https://github.com/IRkernel/IRkernel/issues/528) does not seem to be close to an end...\n\nMeanwhile, CRAN recently accepted a new [Junyper](https://cran.r-project.org/web/packages/JuniperKernel/index.html) package which seems to be an(other) interface between R an Jupyter. A simple skimming of its [manual](https://cran.r-project.org/web/packages/JuniperKernel/JuniperKernel.pdf) lets me think that this could be an alternative to IRkernel.\n\nI'll have to test this, but that won't be soon (some RealLife(TM) emergencies to fix...).",
    "created_at": "2018-01-23T07:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467994",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:4'></a>
`r_jupyter` has been uninstallable for a long time : its installation procedure refers to outdated locations. I have been installing IRkernel "by hand"  for a while.

The problem is that [IRkernel](https://github.com/IRkernel/IRkernel) is not (yet) on CRAN ; their authors say they intend to subit it  [soon](https://github.com/IRkernel/IRkernel#installation) to CRAN, bu have intended so for a looong time. The [serial](https://github.com/IRkernel/IRkernel/issues/528) does not seem to be close to an end...

Meanwhile, CRAN recently accepted a new [Junyper](https://cran.r-project.org/web/packages/JuniperKernel/index.html) package which seems to be an(other) interface between R an Jupyter. A simple skimming of its [manual](https://cran.r-project.org/web/packages/JuniperKernel/JuniperKernel.pdf) lets me think that this could be an alternative to IRkernel.

I'll have to test this, but that won't be soon (some RealLife(TM) emergencies to fix...).



---

archive/issue_comments_467995.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-21T19:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467995",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_467996.json:
```json
{
    "body": "<a id='comment:5'></a>\n[ Sorry for the delay : this patch fell in the black hole I use as my //To Do// list...]\n\nThe current Github `README.md` installs only `IRkernel` from Github. and indeed, [crayon](https://cran.r-project.org/web/packages/crayon/index.html), [repr](https://cran.r-project.org/web/packages/crayon/index.html) and [IRdisplay](https://cran.r-project.org/web/packages/IRdisplay/index.html) are all installable from [CRAN](https://cran.r-project.org/web/packages/).\n\nI think that we should follow this policy (depend as little as possible on non-CRAN packages).\n\n+1 to install the kernel in the common repository for Sage kernels.\n\n==>`needs_work`. I may do this if you wish (and can review it).\n\nOTOH, the [Juniper](https://cran.r-project.org/web/packages/JuniperKernel/index.html) kernel is also an attractive alternative, which is available via CRAN, but is still a [tad](https://github.com/JuniperKernel/JuniperKernel/issues/29) [immature](https://github.com/JuniperKernel/JuniperKernel/issues/27).\n\nWhen matured, it might be proposed as an alternative or as a substitute to `r_jupyter`.",
    "created_at": "2018-03-21T19:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467996",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:5'></a>
[ Sorry for the delay : this patch fell in the black hole I use as my //To Do// list...]

The current Github `README.md` installs only `IRkernel` from Github. and indeed, [crayon](https://cran.r-project.org/web/packages/crayon/index.html), [repr](https://cran.r-project.org/web/packages/crayon/index.html) and [IRdisplay](https://cran.r-project.org/web/packages/IRdisplay/index.html) are all installable from [CRAN](https://cran.r-project.org/web/packages/).

I think that we should follow this policy (depend as little as possible on non-CRAN packages).

+1 to install the kernel in the common repository for Sage kernels.

==>`needs_work`. I may do this if you wish (and can review it).

OTOH, the [Juniper](https://cran.r-project.org/web/packages/JuniperKernel/index.html) kernel is also an attractive alternative, which is available via CRAN, but is still a [tad](https://github.com/JuniperKernel/JuniperKernel/issues/29) [immature](https://github.com/JuniperKernel/JuniperKernel/issues/27).

When matured, it might be proposed as an alternative or as a substitute to `r_jupyter`.



---

archive/issue_comments_467997.json:
```json
{
    "body": "<a id='comment:6'></a>\nI forgot to add that I tested successfully the [Juniper](https://cran.r-project.org/web/packages/JuniperKernel/index.html) kernel, with zero Sage-specific problem (the kernel itself has some issues, pointed to in the previous post...).",
    "created_at": "2018-03-21T19:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467997",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:6'></a>
I forgot to add that I tested successfully the [Juniper](https://cran.r-project.org/web/packages/JuniperKernel/index.html) kernel, with zero Sage-specific problem (the kernel itself has some issues, pointed to in the previous post...).



---

archive/issue_comments_467998.json:
```json
{
    "body": "Changing commit from \"a95bfd7e6d580a65bc7f5ce804efa37515fc3e29\" to \"13ffffe4b0e7a04fe6600e53f64efc0db6906172\"",
    "created_at": "2018-03-21T23:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467998",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a95bfd7e6d580a65bc7f5ce804efa37515fc3e29" to "13ffffe4b0e7a04fe6600e53f64efc0db6906172"



---

archive/issue_comments_467999.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|\n|[7b2a36c](https://github.com/sagemath/sagetrac-mirror/commit/7b2a36c49997719a72924e10d289cbb36d3bc46d)|`Merge branch 'u/tmonteil/r_jupyter_package_is_broken' of trac.sagemath.org:sage into HEAD`|\n|[13ffffe](https://github.com/sagemath/sagetrac-mirror/commit/13ffffe4b0e7a04fe6600e53f64efc0db6906172)|`#24585 : update package installation.`|",
    "created_at": "2018-03-21T23:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-467999",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|
|[7b2a36c](https://github.com/sagemath/sagetrac-mirror/commit/7b2a36c49997719a72924e10d289cbb36d3bc46d)|`Merge branch 'u/tmonteil/r_jupyter_package_is_broken' of trac.sagemath.org:sage into HEAD`|
|[13ffffe](https://github.com/sagemath/sagetrac-mirror/commit/13ffffe4b0e7a04fe6600e53f64efc0db6906172)|`#24585 : update package installation.`|



---

archive/issue_comments_468000.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-21T23:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468000",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_468001.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-22T12:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468001",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_468002.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Emmanuel Charpentier\"",
    "created_at": "2018-03-22T12:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468002",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing reviewer from "" to "Emmanuel Charpentier"



---

archive/issue_comments_468003.json:
```json
{
    "body": "<a id='comment:9'></a>\nOn top of 8.2.beta8+#24969 (which `needs_review`, BTW), passes ptestlong without ant failure whatsoever.\n\nAFAICT, the snag met by some patchbots is independent : this problem has already been discussed on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel).\n\n==>`positive_review`",
    "created_at": "2018-03-22T12:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468003",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:9'></a>
On top of 8.2.beta8+#24969 (which `needs_review`, BTW), passes ptestlong without ant failure whatsoever.

AFAICT, the snag met by some patchbots is independent : this problem has already been discussed on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel).

==>`positive_review`



---

archive/issue_events_070476.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-08T17:26:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24585#event-70476"
}
```



---

archive/issue_comments_468004.json:
```json
{
    "body": "Changing branch from \"u/tmonteil/r_jupyter_package_is_broken\" to \"13ffffe4b0e7a04fe6600e53f64efc0db6906172\"",
    "created_at": "2018-05-08T17:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468004",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/tmonteil/r_jupyter_package_is_broken" to "13ffffe4b0e7a04fe6600e53f64efc0db6906172"



---

archive/issue_comments_468005.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-08T17:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468005",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_468006.json:
```json
{
    "body": "Changing keywords from \"\" to \"sdl\".",
    "created_at": "2019-08-27T19:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24585",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24585#issuecomment-468006",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing keywords from "" to "sdl".
