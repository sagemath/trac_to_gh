# Issue 24261: py3: add py2 and py3 doctest flags

archive/issues_024024.json:
```json
{
    "assignees": [],
    "body": "This adds two new flags that can be placed next to doctests: `# py2` and `# py3`.  If marked `py2` a test will *only* be run on Python 2 and so on.\n\nGenerally this should be avoided in favor of making a test work on both in some way or another, but there are some cases where it simply doesn't make sense.  For example this test in `sage.doctest.control`\n\n```\n 640             sage: DD = DocTestDefaults(sagenb = True)\n 641             sage: DC = DocTestController(DD, [])\n 642             sage: DC.add_files()  # py2\n 643             Doctesting the Sage notebook.\n 644             sage: DC.files[0][-6:]  # py2\n 645             'sagenb'\n```\n\nThis doesn't work on Python 3 since we don't even install the Sage notebook on Python 3 (at least not currently).\n\nThe relevant code being tested there should also be updated to handle Python 3 better, but even so there's no practical way to make the test make sense on Python 3 until/unless sagenb is supported on Python 3.  I suspect other cases like this may come up on occasion so it's useful to have.\n\n**CC:**  @fchapoton\n\n**Branch:** [12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Erik Bray, Jeroen Demeyer\n\n**Author:** Erik Bray, Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/24261\n\n",
    "closed_at": "2018-01-14T10:14:36Z",
    "created_at": "2017-11-21T14:09:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: add py2 and py3 doctest flags",
    "type": "issue",
    "updated_at": "2018-01-19T15:16:25Z",
    "url": "https://github.com/sagemath/sage/issues/24261",
    "user": "https://github.com/embray"
}
```
This adds two new flags that can be placed next to doctests: `# py2` and `# py3`.  If marked `py2` a test will *only* be run on Python 2 and so on.

Generally this should be avoided in favor of making a test work on both in some way or another, but there are some cases where it simply doesn't make sense.  For example this test in `sage.doctest.control`

```
 640             sage: DD = DocTestDefaults(sagenb = True)
 641             sage: DC = DocTestController(DD, [])
 642             sage: DC.add_files()  # py2
 643             Doctesting the Sage notebook.
 644             sage: DC.files[0][-6:]  # py2
 645             'sagenb'
```

This doesn't work on Python 3 since we don't even install the Sage notebook on Python 3 (at least not currently).

The relevant code being tested there should also be updated to handle Python 3 better, but even so there's no practical way to make the test make sense on Python 3 until/unless sagenb is supported on Python 3.  I suspect other cases like this may come up on occasion so it's useful to have.

**CC:**  @fchapoton

**Branch:** [12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)

**Reviewer:** Frédéric Chapoton, Erik Bray, Jeroen Demeyer

**Author:** Erik Bray, Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/24261





---

archive/issue_events_292823.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-11-21T14:09:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292823"
}
```



---

archive/issue_events_292824.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-11-21T14:09:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "08517b",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292824"
}
```



---

archive/issue_events_292825.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-11-21T14:09:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292825"
}
```



---

archive/issue_events_292826.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-11-21T14:09:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292826"
}
```



---

archive/issue_comments_369753.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nWhy not `# optional - python2` or `# optional - python3`? That's reusing an existing system for optional tests.",
    "created_at": "2017-11-21T15:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369753",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'>**Comment 2:**</a>
Why not `# optional - python2` or `# optional - python3`? That's reusing an existing system for optional tests.



---

archive/issue_comments_369754.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nReplying to [@jdemeyer](#comment%3A2):\n> Why not `# optional - python2` or `# optional - python3`? That's reusing an existing system for optional tests.\n\nand there are already existing instances waiting for that",
    "created_at": "2017-11-21T16:02:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369754",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'>**Comment 3:**</a>
Replying to [@jdemeyer](#comment%3A2):
> Why not `# optional - python2` or `# optional - python3`? That's reusing an existing system for optional tests.

and there are already existing instances waiting for that



---

archive/issue_comments_369755.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nReplying to [@jdemeyer](#comment%3A2):\n> Why not `# optional - python2` or `# optional - python3`? That's reusing an existing system for optional tests.\n\nI considered something like that but it seems to have different semantics.  Currently \"optional - pkgname\" implies that a package is installed/available.  Here we don't care if python2/3 is available.  We care about what Python version is currently running the tests.\n\nRather than making a special case it's simpler and clearer I think to just have specific tags for this (there's also prior precedence such as using `# py3` in coverage to mark lines that should be ignored in the coverage analysis).",
    "created_at": "2017-11-21T17:07:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369755",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'>**Comment 4:**</a>
Replying to [@jdemeyer](#comment%3A2):
> Why not `# optional - python2` or `# optional - python3`? That's reusing an existing system for optional tests.

I considered something like that but it seems to have different semantics.  Currently "optional - pkgname" implies that a package is installed/available.  Here we don't care if python2/3 is available.  We care about what Python version is currently running the tests.

Rather than making a special case it's simpler and clearer I think to just have specific tags for this (there's also prior precedence such as using `# py3` in coverage to mark lines that should be ignored in the coverage analysis).



---

archive/issue_comments_369756.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nI think it would be better to have `# py2` and `# py3` behave like the `# 32-bit` and `# 64-bit` and be specific for the output. I guess there is also the question of how many of our doctest inputs are going to be specific for Python2. Do any of you have an impression? I think it might be marginal at worst, in which case, we can just build into the doctests an explicit check of Python2 vs 3 as part of the doctest itself.",
    "created_at": "2017-11-22T04:44:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369756",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'>**Comment 5:**</a>
I think it would be better to have `# py2` and `# py3` behave like the `# 32-bit` and `# 64-bit` and be specific for the output. I guess there is also the question of how many of our doctest inputs are going to be specific for Python2. Do any of you have an impression? I think it might be marginal at worst, in which case, we can just build into the doctests an explicit check of Python2 vs 3 as part of the doctest itself.



---

archive/issue_comments_369757.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nI wouldn't mind changing it to apply to the output but not skip the test.  That would actually be better since if the behavior on Python 3 changes in these cases (e.g. `sagenb` works, to use my previous example) then we'd want to see that reflected in the test results.\n\nI think a stronger possibility is *Python 3* only inputs, such as doing things with annotations and other Python 3 only syntax.  So maybe having these tags work on both output and input would be good?",
    "created_at": "2017-11-22T13:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369757",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'>**Comment 6:**</a>
I wouldn't mind changing it to apply to the output but not skip the test.  That would actually be better since if the behavior on Python 3 changes in these cases (e.g. `sagenb` works, to use my previous example) then we'd want to see that reflected in the test results.

I think a stronger possibility is *Python 3* only inputs, such as doing things with annotations and other Python 3 only syntax.  So maybe having these tags work on both output and input would be good?



---

archive/issue_comments_369758.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nI would not oppose that, but I don't think we do anything like that elsewhere. So it might require some invasive changes and might cause some slight confusion (but that is debatable). I think we would be better off having a separate marker for Python3 input.",
    "created_at": "2017-11-22T22:01:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369758",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'>**Comment 7:**</a>
I would not oppose that, but I don't think we do anything like that elsewhere. So it might require some invasive changes and might cause some slight confusion (but that is debatable). I think we would be better off having a separate marker for Python3 input.



---

archive/issue_comments_369759.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nAdding tags on output lines would not require invasive changes, but I do think it's slightly more confusing.  Whereas the use of comments on input lines is consistent with Python syntax, sticking comments in output lines is a bit ad-hoc and confusing.  But we also already have precedence for that in the \"32-bit/64-bit\" case as you pointed out.",
    "created_at": "2017-11-23T09:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369759",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'>**Comment 8:**</a>
Adding tags on output lines would not require invasive changes, but I do think it's slightly more confusing.  Whereas the use of comments on input lines is consistent with Python syntax, sticking comments in output lines is a bit ad-hoc and confusing.  But we also already have precedence for that in the "32-bit/64-bit" case as you pointed out.



---

archive/issue_events_292827.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-01T11:12:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292827"
}
```



---

archive/issue_events_292828.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-01T11:12:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292828"
}
```



---

archive/issue_comments_369760.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nI just realized there's a bug in how this is implemented, where tests containing these tags are skipped regardless.",
    "created_at": "2017-12-01T11:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369760",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'>**Comment 9:**</a>
I just realized there's a bug in how this is implemented, where tests containing these tags are skipped regardless.



---

archive/issue_comments_369761.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nImplementation bug aside, I've been working on fixing the sageinspect module, and that's increasingly convinced me that having a concise way to run specific test cases on either Python 2 or Python 3 only is useful, especially in that module.",
    "created_at": "2017-12-01T11:16:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369761",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'>**Comment 10:**</a>
Implementation bug aside, I've been working on fixing the sageinspect module, and that's increasingly convinced me that having a concise way to run specific test cases on either Python 2 or Python 3 only is useful, especially in that module.



---

archive/issue_comments_369762.json:
```json
{
    "body": "**Changing commit** from \"[6f5fd8cfb06c4b7c7f9743e2559eca00c06f3a0f](https://github.com/sagemath/sagetrac-mirror/commit/6f5fd8cfb06c4b7c7f9743e2559eca00c06f3a0f)\" to \"[e01e5531b69e5a65642651efab85cf5bb496c8ee](https://github.com/sagemath/sagetrac-mirror/commit/e01e5531b69e5a65642651efab85cf5bb496c8ee)\".",
    "created_at": "2017-12-01T13:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369762",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[6f5fd8cfb06c4b7c7f9743e2559eca00c06f3a0f](https://github.com/sagemath/sagetrac-mirror/commit/6f5fd8cfb06c4b7c7f9743e2559eca00c06f3a0f)" to "[e01e5531b69e5a65642651efab85cf5bb496c8ee](https://github.com/sagemath/sagetrac-mirror/commit/e01e5531b69e5a65642651efab85cf5bb496c8ee)".



---

archive/issue_comments_369763.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e01e5531b69e5a65642651efab85cf5bb496c8ee\">e01e553</a></td><td><code>Add doctest flags for running tests on Python 2 only or Python 3 only.</code></td></tr></table>\n",
    "created_at": "2017-12-01T13:57:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369763",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>**Comment 11:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e01e5531b69e5a65642651efab85cf5bb496c8ee">e01e553</a></td><td><code>Add doctest flags for running tests on Python 2 only or Python 3 only.</code></td></tr></table>




---

archive/issue_comments_369764.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nOkay, this definitely works now.  My fixes to the sageinspect module (and in particular its tests) rely on this pretty heavily.",
    "created_at": "2017-12-01T13:58:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369764",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'>**Comment 12:**</a>
Okay, this definitely works now.  My fixes to the sageinspect module (and in particular its tests) rely on this pretty heavily.



---

archive/issue_events_292829.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-01T13:58:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292829"
}
```



---

archive/issue_events_292830.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-01T13:58:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292830"
}
```



---

archive/issue_comments_369765.json:
```json
{
    "body": "**Changing commit** from \"[e01e5531b69e5a65642651efab85cf5bb496c8ee](https://github.com/sagemath/sagetrac-mirror/commit/e01e5531b69e5a65642651efab85cf5bb496c8ee)\" to \"[31f2008835ab51a4a1fdbe8b14b7ef175494be01](https://github.com/sagemath/sagetrac-mirror/commit/31f2008835ab51a4a1fdbe8b14b7ef175494be01)\".",
    "created_at": "2017-12-01T14:08:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369765",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e01e5531b69e5a65642651efab85cf5bb496c8ee](https://github.com/sagemath/sagetrac-mirror/commit/e01e5531b69e5a65642651efab85cf5bb496c8ee)" to "[31f2008835ab51a4a1fdbe8b14b7ef175494be01](https://github.com/sagemath/sagetrac-mirror/commit/31f2008835ab51a4a1fdbe8b14b7ef175494be01)".



---

archive/issue_comments_369766.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31f2008835ab51a4a1fdbe8b14b7ef175494be01\">31f2008</a></td><td><code>Add doctest flags for running tests on Python 2 only or Python 3 only.</code></td></tr></table>\n",
    "created_at": "2017-12-01T14:08:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369766",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>**Comment 13:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31f2008835ab51a4a1fdbe8b14b7ef175494be01">31f2008</a></td><td><code>Add doctest flags for running tests on Python 2 only or Python 3 only.</code></td></tr></table>




---

archive/issue_comments_369767.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nReplying to [@embray](#comment%3A4):\n> I considered something like that but it seems to have different semantics.  Currently \"optional - pkgname\" implies that a package is installed/available.  Here we don't care if python2/3 is available.  We care about what Python version is currently running the tests.\n\nRight, I get that. Still, I think that we already have enough (if not too many) special doctest markers. And even if `# optional` is typically used to check whether a package is installed, I think that the meaning of `# optional - python2` is clear enough.\n\nMoreover, there are already doctests using `# optional - python2` and `# optional - python3` referring to the current running version of Python.",
    "created_at": "2017-12-04T13:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369767",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>**Comment 14:**</a>
Replying to [@embray](#comment%3A4):
> I considered something like that but it seems to have different semantics.  Currently "optional - pkgname" implies that a package is installed/available.  Here we don't care if python2/3 is available.  We care about what Python version is currently running the tests.

Right, I get that. Still, I think that we already have enough (if not too many) special doctest markers. And even if `# optional` is typically used to check whether a package is installed, I think that the meaning of `# optional - python2` is clear enough.

Moreover, there are already doctests using `# optional - python2` and `# optional - python3` referring to the current running version of Python.



---

archive/issue_comments_369768.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@jdemeyer](#comment%3A14):\n> Replying to [@embray](#comment%3A4):\n> > I considered something like that but it seems to have different semantics.  Currently \"optional - pkgname\" implies that a package is installed/available.  Here we don't care if python2/3 is available.  We care about what Python version is currently running the tests.\n\n> \n> Right, I get that. Still, I think that we already have enough (if not too many) special \n\nThat's pretty subjective--I think \"enough\" is however many you need to write reasonable tests.\n\n> doctest markers. And even if `# optional` is typically used to check whether a package is installed, I think that the meaning of `# optional - python2` is clear enough.\n\nI don't.  It's overly wordy and not quite clear at all given the double meaning.\n\n> Moreover, there are already doctests using `# optional - python2` and `# optional - python3` referring to the current running version of Python.\n\nExcept those explicitly don't work right now.  I've already replaced a few examples using these markers.  Here's a concrete example that might help motivate:\n\n```\n                sage: import ast, sage.misc.sageinspect as sms  # py3\n                sage: visitor = sms.SageArgSpecVisitor()  # py3\n                sage: vis = lambda x: visitor.visit_NameConstant(ast.parse(x).body[0].value)  # py3\n                sage: [vis(n) for n in ['True', 'False', 'None']]  # py3\n                [True, False, None]\n                sage: [type(vis(n)) for n in ['True', 'False', 'None']]  # py3\n                [<type 'bool'>, <type 'bool'>, <type 'NoneType'>]\n```\n\nThis entire sequence of test commands is Python 3 only and does not even make sense on Python 2 (it might be nice to tag a whole range at once actually rather than every single line but that's a separate issue).  Putting \"# optional - python3\" on every one of those lines is just that much more line noise.",
    "created_at": "2017-12-04T13:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369768",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@jdemeyer](#comment%3A14):
> Replying to [@embray](#comment%3A4):
> > I considered something like that but it seems to have different semantics.  Currently "optional - pkgname" implies that a package is installed/available.  Here we don't care if python2/3 is available.  We care about what Python version is currently running the tests.

> 
> Right, I get that. Still, I think that we already have enough (if not too many) special 

That's pretty subjective--I think "enough" is however many you need to write reasonable tests.

> doctest markers. And even if `# optional` is typically used to check whether a package is installed, I think that the meaning of `# optional - python2` is clear enough.

I don't.  It's overly wordy and not quite clear at all given the double meaning.

> Moreover, there are already doctests using `# optional - python2` and `# optional - python3` referring to the current running version of Python.

Except those explicitly don't work right now.  I've already replaced a few examples using these markers.  Here's a concrete example that might help motivate:

```
                sage: import ast, sage.misc.sageinspect as sms  # py3
                sage: visitor = sms.SageArgSpecVisitor()  # py3
                sage: vis = lambda x: visitor.visit_NameConstant(ast.parse(x).body[0].value)  # py3
                sage: [vis(n) for n in ['True', 'False', 'None']]  # py3
                [True, False, None]
                sage: [type(vis(n)) for n in ['True', 'False', 'None']]  # py3
                [<type 'bool'>, <type 'bool'>, <type 'NoneType'>]
```

This entire sequence of test commands is Python 3 only and does not even make sense on Python 2 (it might be nice to tag a whole range at once actually rather than every single line but that's a separate issue).  Putting "# optional - python3" on every one of those lines is just that much more line noise.



---

archive/issue_events_292831.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-07T17:29:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292831"
}
```



---

archive/issue_events_292832.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-12-07T17:29:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292832"
}
```



---

archive/issue_comments_369769.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nOK, fine. I don't really agree, but we have to move on. If you want to go forward with `# py2` and `# py3`, you should at least fix the existing uses of `# optional - python2` and `# optional - python3`. If you do that, I'm willing to set this ticket to positive review.",
    "created_at": "2017-12-07T17:29:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369769",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'>**Comment 16:**</a>
OK, fine. I don't really agree, but we have to move on. If you want to go forward with `# py2` and `# py3`, you should at least fix the existing uses of `# optional - python2` and `# optional - python3`. If you do that, I'm willing to set this ticket to positive review.



---

archive/issue_comments_369770.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nReplying to [@jdemeyer](#comment%3A16):\n> OK, fine. I don't really agree, but we have to move on. If you want to go forward with `# py2` and `# py3`, you should at least fix the existing uses of `# optional - python2` and `# optional - python3`. If you do that, I'm willing to set this ticket to positive review.\n\nI'm fixing those as I come to them, but fixing all of them at once would probably only hang this up longer.  Better to add the feature first and then switch to using it where it makes sense to on a case by case basis.",
    "created_at": "2017-12-08T09:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369770",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'>**Comment 17:**</a>
Replying to [@jdemeyer](#comment%3A16):
> OK, fine. I don't really agree, but we have to move on. If you want to go forward with `# py2` and `# py3`, you should at least fix the existing uses of `# optional - python2` and `# optional - python3`. If you do that, I'm willing to set this ticket to positive review.

I'm fixing those as I come to them, but fixing all of them at once would probably only hang this up longer.  Better to add the feature first and then switch to using it where it makes sense to on a case by case basis.



---

archive/issue_comments_369771.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nCome on, there are really few instances of `# optional - python[23]` currently in Sage. It doesn't take much effort to fix those. And those can also double as testcase that the `# py2` and `# py3` markers actually work.",
    "created_at": "2017-12-08T09:39:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369771",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'>**Comment 18:**</a>
Come on, there are really few instances of `# optional - python[23]` currently in Sage. It doesn't take much effort to fix those. And those can also double as testcase that the `# py2` and `# py3` markers actually work.



---

archive/issue_comments_369772.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nAlright, I have no problem doing it (I'll have to double-check but I think I've already fixed most of those cases). It just seemed antithetical to your normal philosophy (which I generally agree with...)",
    "created_at": "2017-12-08T10:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369772",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'>**Comment 19:**</a>
Alright, I have no problem doing it (I'll have to double-check but I think I've already fixed most of those cases). It just seemed antithetical to your normal philosophy (which I generally agree with...)



---

archive/issue_comments_369773.json:
```json
{
    "body": "**Changing commit** from \"[31f2008835ab51a4a1fdbe8b14b7ef175494be01](https://github.com/sagemath/sagetrac-mirror/commit/31f2008835ab51a4a1fdbe8b14b7ef175494be01)\" to \"[c09007614f985868bd2a43c0f8e282aeb8de17b7](https://github.com/sagemath/sagetrac-mirror/commit/c09007614f985868bd2a43c0f8e282aeb8de17b7)\".",
    "created_at": "2017-12-08T11:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369773",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[31f2008835ab51a4a1fdbe8b14b7ef175494be01](https://github.com/sagemath/sagetrac-mirror/commit/31f2008835ab51a4a1fdbe8b14b7ef175494be01)" to "[c09007614f985868bd2a43c0f8e282aeb8de17b7](https://github.com/sagemath/sagetrac-mirror/commit/c09007614f985868bd2a43c0f8e282aeb8de17b7)".



---

archive/issue_comments_369774.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c09007614f985868bd2a43c0f8e282aeb8de17b7\">c090076</a></td><td><code>Fix a few more cases where '# optional - python2' wasn't really doing what was intended.</code></td></tr></table>\n",
    "created_at": "2017-12-08T11:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369774",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>**Comment 20:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c09007614f985868bd2a43c0f8e282aeb8de17b7">c090076</a></td><td><code>Fix a few more cases where '# optional - python2' wasn't really doing what was intended.</code></td></tr></table>




---

archive/issue_events_292833.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-08T11:04:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292833"
}
```



---

archive/issue_events_292834.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-08T11:04:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292834"
}
```



---

archive/issue_comments_369775.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nNote: I also fixed one case of `# optional - python2` in #24286.",
    "created_at": "2017-12-08T11:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369775",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'>**Comment 21:**</a>
Note: I also fixed one case of `# optional - python2` in #24286.



---

archive/issue_comments_369776.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\ntypo : \"on optionl features\" in src/doc/en/developer/coding_basics.rst\n\none failing doctest in src/sage/doctest/sources.py",
    "created_at": "2017-12-14T15:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369776",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'>**Comment 22:**</a>
typo : "on optionl features" in src/doc/en/developer/coding_basics.rst

one failing doctest in src/sage/doctest/sources.py



---

archive/issue_events_292835.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-14T15:45:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292835"
}
```



---

archive/issue_events_292836.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-14T15:45:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292836"
}
```



---

archive/issue_comments_369777.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nCan somebody explain the origin of this test?\n\n```\nsage -t --long src/sage/doctest/sources.py\n**********************************************************************\nFile \"src/sage/doctest/sources.py\", line 759, in sage.doctest.sources.FileDocTestSource._test_enough_doctests\nFailed example:\n    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time\n        path = os.path.relpath(path)\n        dirs.sort(); files.sort()\n        for F in files:\n            _, ext = os.path.splitext(F)\n            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):\n                filename = os.path.join(path, F)\n                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))\n                FDS._test_enough_doctests(verbose=False)\nExpected:\n    There are 7 tests in sage/combinat/diagram_algebras.py that are not being run\n    There are 7 tests in sage/combinat/dyck_word.py that are not being run\n    There are 7 tests in sage/combinat/finite_state_machine.py that are not being run\n    There are 6 tests in sage/combinat/interval_posets.py that are not being run\n    There are 18 tests in sage/combinat/partition.py that are not being run\n    There are 15 tests in sage/combinat/permutation.py that are not being run\n    There are 14 tests in sage/combinat/skew_partition.py that are not being run\n    There are 18 tests in sage/combinat/tableau.py that are not being run\n    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run\n    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run\n    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run\n    There are 3 unexpected tests being run in sage/doctest/parsing.py\n    There are 1 unexpected tests being run in sage/doctest/reporting.py\n    There are 15 tests in sage/manifolds/manifold.py that are not being run\n    There are 3 tests in sage/rings/invariant_theory.py that are not being run\nGot:\n    There are 7 tests in sage/combinat/diagram_algebras.py that are not being run\n    There are 7 tests in sage/combinat/dyck_word.py that are not being run\n    There are 7 tests in sage/combinat/finite_state_machine.py that are not being run\n    There are 6 tests in sage/combinat/interval_posets.py that are not being run\n    There are 18 tests in sage/combinat/partition.py that are not being run\n    There are 15 tests in sage/combinat/permutation.py that are not being run\n    There are 14 tests in sage/combinat/skew_partition.py that are not being run\n    There are 18 tests in sage/combinat/tableau.py that are not being run\n    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run\n    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run\n    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run\n    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run\n    There are 3 unexpected tests being run in sage/doctest/parsing.py\n    There are 1 unexpected tests being run in sage/doctest/reporting.py\n    There are 15 tests in sage/manifolds/manifold.py that are not being run\n    There are 1 tests in sage/misc/sage_eval.py that are not being run\n    There are 3 tests in sage/rings/invariant_theory.py that are not being run\n    There are 1 tests in sage/rings/finite_rings/integer_mod.pyx that are not being run\n**********************************************************************\n1 item had failures:\n   1 of   9 in sage.doctest.sources.FileDocTestSource._test_enough_doctests\n    [367 tests, 1 failure, 244.00 s]\n```\n\nIt's pretty awfully annoying to have a test whose output depends on the contents of a variety of specific modules.  If this is meant to be some kind of regression test (?) it's not clear, but surely it could be run without such a strong dependency on external data.",
    "created_at": "2017-12-15T11:23:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369777",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'>**Comment 24:**</a>
Can somebody explain the origin of this test?

```
sage -t --long src/sage/doctest/sources.py
**********************************************************************
File "src/sage/doctest/sources.py", line 759, in sage.doctest.sources.FileDocTestSource._test_enough_doctests
Failed example:
    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time
        path = os.path.relpath(path)
        dirs.sort(); files.sort()
        for F in files:
            _, ext = os.path.splitext(F)
            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):
                filename = os.path.join(path, F)
                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))
                FDS._test_enough_doctests(verbose=False)
Expected:
    There are 7 tests in sage/combinat/diagram_algebras.py that are not being run
    There are 7 tests in sage/combinat/dyck_word.py that are not being run
    There are 7 tests in sage/combinat/finite_state_machine.py that are not being run
    There are 6 tests in sage/combinat/interval_posets.py that are not being run
    There are 18 tests in sage/combinat/partition.py that are not being run
    There are 15 tests in sage/combinat/permutation.py that are not being run
    There are 14 tests in sage/combinat/skew_partition.py that are not being run
    There are 18 tests in sage/combinat/tableau.py that are not being run
    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run
    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run
    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run
    There are 3 unexpected tests being run in sage/doctest/parsing.py
    There are 1 unexpected tests being run in sage/doctest/reporting.py
    There are 15 tests in sage/manifolds/manifold.py that are not being run
    There are 3 tests in sage/rings/invariant_theory.py that are not being run
Got:
    There are 7 tests in sage/combinat/diagram_algebras.py that are not being run
    There are 7 tests in sage/combinat/dyck_word.py that are not being run
    There are 7 tests in sage/combinat/finite_state_machine.py that are not being run
    There are 6 tests in sage/combinat/interval_posets.py that are not being run
    There are 18 tests in sage/combinat/partition.py that are not being run
    There are 15 tests in sage/combinat/permutation.py that are not being run
    There are 14 tests in sage/combinat/skew_partition.py that are not being run
    There are 18 tests in sage/combinat/tableau.py that are not being run
    There are 8 tests in sage/combinat/crystals/tensor_product.py that are not being run
    There are 11 tests in sage/combinat/rigged_configurations/rigged_configurations.py that are not being run
    There are 15 tests in sage/combinat/root_system/cartan_type.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_A.py that are not being run
    There are 8 tests in sage/combinat/root_system/type_G.py that are not being run
    There are 3 unexpected tests being run in sage/doctest/parsing.py
    There are 1 unexpected tests being run in sage/doctest/reporting.py
    There are 15 tests in sage/manifolds/manifold.py that are not being run
    There are 1 tests in sage/misc/sage_eval.py that are not being run
    There are 3 tests in sage/rings/invariant_theory.py that are not being run
    There are 1 tests in sage/rings/finite_rings/integer_mod.pyx that are not being run
**********************************************************************
1 item had failures:
   1 of   9 in sage.doctest.sources.FileDocTestSource._test_enough_doctests
    [367 tests, 1 failure, 244.00 s]
```

It's pretty awfully annoying to have a test whose output depends on the contents of a variety of specific modules.  If this is meant to be some kind of regression test (?) it's not clear, but surely it could be run without such a strong dependency on external data.



---

archive/issue_comments_369778.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nI really don't understand what to do with this test.  It's like it's testing the doctest parser by using a different, simpler doctest parser that doesn't fully work, and comparing the results from that parser to the results from the actual doctest parser.  If we want to check that the actual doctest parser works then there should be (and are) unit tests for the code of the actual doctest parser.  As it is this test is just testing the secondary, flakier doctest parser implemented in the test...",
    "created_at": "2017-12-15T11:46:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369778",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'>**Comment 25:**</a>
I really don't understand what to do with this test.  It's like it's testing the doctest parser by using a different, simpler doctest parser that doesn't fully work, and comparing the results from that parser to the results from the actual doctest parser.  If we want to check that the actual doctest parser works then there should be (and are) unit tests for the code of the actual doctest parser.  As it is this test is just testing the secondary, flakier doctest parser implemented in the test...



---

archive/issue_comments_369779.json:
```json
{
    "body": "**Changing commit** from \"[c09007614f985868bd2a43c0f8e282aeb8de17b7](https://github.com/sagemath/sagetrac-mirror/commit/c09007614f985868bd2a43c0f8e282aeb8de17b7)\" to \"[96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5](https://github.com/sagemath/sagetrac-mirror/commit/96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5)\".",
    "created_at": "2017-12-15T11:48:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369779",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c09007614f985868bd2a43c0f8e282aeb8de17b7](https://github.com/sagemath/sagetrac-mirror/commit/c09007614f985868bd2a43c0f8e282aeb8de17b7)" to "[96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5](https://github.com/sagemath/sagetrac-mirror/commit/96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5)".



---

archive/issue_comments_369780.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5\">96127eb</a></td><td><code>Fix typo</code></td></tr></table>\n",
    "created_at": "2017-12-15T11:48:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369780",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>**Comment 26:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5">96127eb</a></td><td><code>Fix typo</code></td></tr></table>




---

archive/issue_events_292837.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-18T16:36:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292837"
}
```



---

archive/issue_events_292838.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-18T16:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292838"
}
```



---

archive/issue_comments_369781.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nTo solve your problem with `_test_enough_doctests`, you could add some extra attribute to `SageDocTestParser` to never skip any test (not even the `# py2` and `# py3` tests). Then you set that attribute when running `_test_enough_doctests`.",
    "created_at": "2017-12-19T12:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369781",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'>**Comment 28:**</a>
To solve your problem with `_test_enough_doctests`, you could add some extra attribute to `SageDocTestParser` to never skip any test (not even the `# py2` and `# py3` tests). Then you set that attribute when running `_test_enough_doctests`.



---

archive/issue_comments_369782.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nI'd still just as soon remove that test...",
    "created_at": "2018-01-02T15:27:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369782",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'>**Comment 29:**</a>
I'd still just as soon remove that test...



---

archive/issue_comments_369783.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/python3/doctest-py2-only](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/doctest-py2-only)\" to \"[u/jdemeyer/python3/doctest-py2-only](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/doctest-py2-only)\".",
    "created_at": "2018-01-05T10:18:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369783",
    "user": "https://github.com/jdemeyer"
}
```

**Changing branch** from "[u/embray/python3/doctest-py2-only](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/python3/doctest-py2-only)" to "[u/jdemeyer/python3/doctest-py2-only](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/doctest-py2-only)".



---

archive/issue_events_292839.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-05T10:19:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292839"
}
```



---

archive/issue_events_292840.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-05T10:19:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292840"
}
```



---

archive/issue_comments_369784.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nThis variant re-uses the existing optional tags implementation. It passes all tests in `sage/doctest`.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39c71a222dddc426e23ac733c96c0bdb90a8d18b\">39c71a2</a></td><td><code>Add doctest flags for running tests on Python 2 only or Python 3 only.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fcea7e739d5be87349d1fb11581cdfecf980af3\">1fcea7e</a></td><td><code>Better fix for this doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470\">12c300a</a></td><td><code>Automatically add py2/py3 optional tag</code></td></tr></table>\n",
    "created_at": "2018-01-05T10:19:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369784",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'>**Comment 31:**</a>
This variant re-uses the existing optional tags implementation. It passes all tests in `sage/doctest`.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39c71a222dddc426e23ac733c96c0bdb90a8d18b">39c71a2</a></td><td><code>Add doctest flags for running tests on Python 2 only or Python 3 only.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fcea7e739d5be87349d1fb11581cdfecf980af3">1fcea7e</a></td><td><code>Better fix for this doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470">12c300a</a></td><td><code>Automatically add py2/py3 optional tag</code></td></tr></table>




---

archive/issue_comments_369785.json:
```json
{
    "body": "**Changing author** from \"Erik Bray\" to \"Erik Bray, Jeroen Demeyer\".",
    "created_at": "2018-01-05T10:19:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369785",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Erik Bray" to "Erik Bray, Jeroen Demeyer".



---

archive/issue_comments_369786.json:
```json
{
    "body": "**Changing commit** from \"[96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5](https://github.com/sagemath/sagetrac-mirror/commit/96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5)\" to \"[12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)\".",
    "created_at": "2018-01-05T10:19:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369786",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5](https://github.com/sagemath/sagetrac-mirror/commit/96127ebd7f23c774b4c5c6619962f8dcb8bc2ae5)" to "[12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)".



---

archive/issue_comments_369787.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nI don't fully understand what this is doing differently, but I'm not opposed as long as it works.",
    "created_at": "2018-01-05T12:08:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369787",
    "user": "https://github.com/embray"
}
```

<a id='comment:32'>**Comment 32:**</a>
I don't fully understand what this is doing differently, but I'm not opposed as long as it works.



---

archive/issue_comments_369788.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nReplying to [@embray](#comment%3A32):\n> I'm not opposed\n\nIs that a subtle way to say \"positive review\"?",
    "created_at": "2018-01-05T12:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369788",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'>**Comment 33:**</a>
Replying to [@embray](#comment%3A32):
> I'm not opposed

Is that a subtle way to say "positive review"?



---

archive/issue_comments_369789.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nThis seems to be ready to go, no ?",
    "created_at": "2018-01-06T19:21:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369789",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'>**Comment 34:**</a>
This seems to be ready to go, no ?



---

archive/issue_events_292841.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-08T16:42:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292841"
}
```



---

archive/issue_events_292842.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-08T16:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292842"
}
```



---

archive/issue_comments_369790.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nok, let it be. Erik and Jeroen, I added your names as reviewers. Feel free to undo that.",
    "created_at": "2018-01-08T16:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369790",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:35'>**Comment 35:**</a>
ok, let it be. Erik and Jeroen, I added your names as reviewers. Feel free to undo that.



---

archive/issue_comments_369791.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Erik Bray, Jeroen Demeyer",
    "created_at": "2018-01-08T16:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369791",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton, Erik Bray, Jeroen Demeyer



---

archive/issue_comments_369792.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nYes, I understand how this is working now. +1",
    "created_at": "2018-01-09T13:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369792",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'>**Comment 36:**</a>
Yes, I understand how this is working now. +1



---

archive/issue_comments_369793.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/python3/doctest-py2-only](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/doctest-py2-only)\" to \"[12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)\".",
    "created_at": "2018-01-14T10:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369793",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/python3/doctest-py2-only](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/python3/doctest-py2-only)" to "[12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)".



---

archive/issue_events_292843.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T10:14:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292843"
}
```



---

archive/issue_events_292844.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0d1bcf2ab572c863ae32d3ffdeb0d4539f9f0e36",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-01-14T10:14:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24261#event-292844"
}
```



---

archive/issue_comments_369794.json:
```json
{
    "body": "**Changing commit** from \"[12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)\" to \"\".",
    "created_at": "2018-01-19T15:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369794",
    "user": "https://github.com/fchapoton"
}
```

**Changing commit** from "[12c300aad31ee72ea569134b35a94baed7efa470](https://github.com/sagemath/sagetrac-mirror/commit/12c300aad31ee72ea569134b35a94baed7efa470)" to "".



---

archive/issue_comments_369795.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nfollow-up in #24570",
    "created_at": "2018-01-19T15:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24261",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24261#issuecomment-369795",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:38'>**Comment 38:**</a>
follow-up in #24570
