# Issue 24640: Avoid order computation in EllipticCurveIsogeny function

archive/issues_024403.json:
```json
{
    "assignees": [],
    "body": "When computing the points in the kernel set of the isogeny, it is unnecessary and slow to perform the computation of P.order(): slow because computing the order requires factoring the order of E in many cases, and unnecessary because the preceding code block checks that P has finite order, and in the finite order case we can just compute all multiples of P until we get the identity since we need to compute all of these points anyway in order to list the kernel set. For curves of cryptographic size and kernels of small order, we have measured that eliminating the P.order() computation makes the EllipticCurveIsogeny function run 200 times faster.\n\nI (David) discussed this problem with William Stein and Kevin Lui at JMM 2017, and Kevin identified the source of the problem, but seems to have never checked in a fix.\n\n**Keywords:** elliptic curve, isogeny\n\n**Branch/Commit:** [926ff9b5a81a114433221c2ac9e9d4be6e70d0d9](https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9)\n\n**Reviewer:** Kevin Lui\n\n**Author:** Madison Van Dyk; David Jao\n\nIssue created by migration from https://trac.sagemath.org/ticket/24640\n\n",
    "closed_at": "2018-02-09T23:47:26Z",
    "created_at": "2018-02-01T18:07:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Avoid order computation in EllipticCurveIsogeny function",
    "type": "issue",
    "updated_at": "2018-02-09T23:47:26Z",
    "url": "https://github.com/sagemath/sage/issues/24640",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```
When computing the points in the kernel set of the isogeny, it is unnecessary and slow to perform the computation of P.order(): slow because computing the order requires factoring the order of E in many cases, and unnecessary because the preceding code block checks that P has finite order, and in the finite order case we can just compute all multiples of P until we get the identity since we need to compute all of these points anyway in order to list the kernel set. For curves of cryptographic size and kernels of small order, we have measured that eliminating the P.order() computation makes the EllipticCurveIsogeny function run 200 times faster.

I (David) discussed this problem with William Stein and Kevin Lui at JMM 2017, and Kevin identified the source of the problem, but seems to have never checked in a fix.

**Keywords:** elliptic curve, isogeny

**Branch/Commit:** [926ff9b5a81a114433221c2ac9e9d4be6e70d0d9](https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9)

**Reviewer:** Kevin Lui

**Author:** Madison Van Dyk; David Jao

Issue created by migration from https://trac.sagemath.org/ticket/24640





---

archive/issue_events_296952.json:
```json
{
    "actor": "https://github.com/sagetrac-m3vandyk",
    "created_at": "2018-02-01T18:07:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296952"
}
```



---

archive/issue_events_296953.json:
```json
{
    "actor": "https://github.com/sagetrac-m3vandyk",
    "created_at": "2018-02-01T18:07:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20elliptic%20curves",
    "label_color": "08517b",
    "label_name": "component: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296953"
}
```



---

archive/issue_events_296954.json:
```json
{
    "actor": "https://github.com/sagetrac-m3vandyk",
    "created_at": "2018-02-01T18:07:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296954"
}
```



---

archive/issue_comments_376251.json:
```json
{
    "body": "**Branch:** [u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)",
    "created_at": "2018-02-01T18:08:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376251",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```

**Branch:** [u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)



---

archive/issue_comments_376252.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis is related to ticket #22161, although our proposed fix is different from Kevin's. (I wasn't sure how to deal with tickets that already have a branch.)\n\nBasically, I am convinced that you never want to compute the group order or even the point order separately, ever. You should just always list all the multiples of P until you repeat back to where you started. In any other context, this would be a **slow** way to compute the point order, but in this context, it's a **free** computation, since you need the entire list of points anyway in order to apply Velu's formulas.",
    "created_at": "2018-02-02T02:55:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376252",
    "user": "https://github.com/davidjao"
}
```

<a id='comment:2'></a>
This is related to ticket #22161, although our proposed fix is different from Kevin's. (I wasn't sure how to deal with tickets that already have a branch.)

Basically, I am convinced that you never want to compute the group order or even the point order separately, ever. You should just always list all the multiples of P until you repeat back to where you started. In any other context, this would be a **slow** way to compute the point order, but in this context, it's a **free** computation, since you need the entire list of points anyway in order to apply Velu's formulas.



---

archive/issue_comments_376253.json:
```json
{
    "body": "**Commit:** [0a674fd488dcd7cb779101d263c10a874a13cf77](https://github.com/sagemath/sagetrac-mirror/commit/0a674fd488dcd7cb779101d263c10a874a13cf77)",
    "created_at": "2018-02-02T02:55:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376253",
    "user": "https://github.com/davidjao"
}
```

**Commit:** [0a674fd488dcd7cb779101d263c10a874a13cf77](https://github.com/sagemath/sagetrac-mirror/commit/0a674fd488dcd7cb779101d263c10a874a13cf77)



---

archive/issue_comments_376254.json:
```json
{
    "body": "**Changing commit** from \"[0a674fd488dcd7cb779101d263c10a874a13cf77](https://github.com/sagemath/sagetrac-mirror/commit/0a674fd488dcd7cb779101d263c10a874a13cf77)\" to \"[b9ababe78120a3104d2ddb53e481bac66106ca40](https://github.com/sagemath/sagetrac-mirror/commit/b9ababe78120a3104d2ddb53e481bac66106ca40)\".",
    "created_at": "2018-02-04T19:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376254",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[0a674fd488dcd7cb779101d263c10a874a13cf77](https://github.com/sagemath/sagetrac-mirror/commit/0a674fd488dcd7cb779101d263c10a874a13cf77)" to "[b9ababe78120a3104d2ddb53e481bac66106ca40](https://github.com/sagemath/sagetrac-mirror/commit/b9ababe78120a3104d2ddb53e481bac66106ca40)".



---

archive/issue_comments_376255.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9ababe78120a3104d2ddb53e481bac66106ca40\">b9ababe</a></td><td><code>update Isogeny function to address slow order calcuaiton</code></td></tr></table>\n",
    "created_at": "2018-02-04T19:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376255",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9ababe78120a3104d2ddb53e481bac66106ca40">b9ababe</a></td><td><code>update Isogeny function to address slow order calcuaiton</code></td></tr></table>




---

archive/issue_comments_376256.json:
```json
{
    "body": "<a id='comment:4'></a>\nCan you add an example demonstrating the speedup?",
    "created_at": "2018-02-04T23:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376256",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:4'></a>
Can you add an example demonstrating the speedup?



---

archive/issue_comments_376257.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b461d389b5df0c982ac94778f33686673951172d\">b461d38</a></td><td><code>Add doctest for order-free isogeny computation</code></td></tr></table>\n",
    "created_at": "2018-02-05T19:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376257",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b461d389b5df0c982ac94778f33686673951172d">b461d38</a></td><td><code>Add doctest for order-free isogeny computation</code></td></tr></table>




---

archive/issue_comments_376258.json:
```json
{
    "body": "**Changing commit** from \"[b9ababe78120a3104d2ddb53e481bac66106ca40](https://github.com/sagemath/sagetrac-mirror/commit/b9ababe78120a3104d2ddb53e481bac66106ca40)\" to \"[b461d389b5df0c982ac94778f33686673951172d](https://github.com/sagemath/sagetrac-mirror/commit/b461d389b5df0c982ac94778f33686673951172d)\".",
    "created_at": "2018-02-05T19:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376258",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b9ababe78120a3104d2ddb53e481bac66106ca40](https://github.com/sagemath/sagetrac-mirror/commit/b9ababe78120a3104d2ddb53e481bac66106ca40)" to "[b461d389b5df0c982ac94778f33686673951172d](https://github.com/sagemath/sagetrac-mirror/commit/b461d389b5df0c982ac94778f33686673951172d)".



---

archive/issue_comments_376259.json:
```json
{
    "body": "<a id='comment:6'></a>\nWe added a doctest demonstrating the speedup. The test takes around a minute; we can try to think of ways to make it faster. Without our changes, the same test takes practically forever.",
    "created_at": "2018-02-05T19:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376259",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```

<a id='comment:6'></a>
We added a doctest demonstrating the speedup. The test takes around a minute; we can try to think of ways to make it faster. Without our changes, the same test takes practically forever.



---

archive/issue_comments_376260.json:
```json
{
    "body": "**Changing branch** from \"[u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)\" to \"[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)\".",
    "created_at": "2018-02-06T04:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376260",
    "user": "https://github.com/kevinywlui"
}
```

**Changing branch** from "[u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)" to "[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)".



---

archive/issue_comments_376261.json:
```json
{
    "body": "**Changing commit** from \"[b461d389b5df0c982ac94778f33686673951172d](https://github.com/sagemath/sagetrac-mirror/commit/b461d389b5df0c982ac94778f33686673951172d)\" to \"[250f15ab7d9f3c8759afe55f687ecc5e49d8fb32](https://github.com/sagemath/sagetrac-mirror/commit/250f15ab7d9f3c8759afe55f687ecc5e49d8fb32)\".",
    "created_at": "2018-02-06T05:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376261",
    "user": "https://github.com/kevinywlui"
}
```

**Changing commit** from "[b461d389b5df0c982ac94778f33686673951172d](https://github.com/sagemath/sagetrac-mirror/commit/b461d389b5df0c982ac94778f33686673951172d)" to "[250f15ab7d9f3c8759afe55f687ecc5e49d8fb32](https://github.com/sagemath/sagetrac-mirror/commit/250f15ab7d9f3c8759afe55f687ecc5e49d8fb32)".



---

archive/issue_comments_376262.json:
```json
{
    "body": "<a id='comment:8'></a>\nI changed a few small things:\n\n1) Fixed a line in doctest so that it works with sphnix.\n\n2) Removed the multiples import and removed list.\n\nIs there a smaller example? The current one take me about 75s \n\n```\nsage -t --warn-long ell_curve_isogeny.py\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 726, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny\nWarning, slow doctest:\n    phi_v = EllipticCurveIsogeny(EK, P_list); phi_v\nTest ran for 1.72 s\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 838, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny\nWarning, slow doctest:\n    iso2 = EL.isogenies_prime_degree(2); len(iso2)\nTest ran for 7.27 s\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 840, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny\nWarning, slow doctest:\n    iso3 = EL.isogenies_prime_degree(3); len(iso3)\nTest ran for 9.97 s\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 852, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny\nWarning, slow doctest:\n    duals = [phi.dual() for phi in isogs]\nTest ran for 1.46 s\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 1860, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.__init_from_kernel_list\nWarning, slow doctest:\n    p=12*next_prime(2**516)*next_prime(2**543)-1\nTest ran for 1.31 s\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 1861, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.__init_from_kernel_list\nWarning, slow doctest:\n    E=EllipticCurve([GF(p)(1),GF(p)(0)])\nTest ran for 11.81 s\n**********************************************************************\nFile \"ell_curve_isogeny.py\", line 1862, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.__init_from_kernel_list\nWarning, slow doctest:\n    P=E(0).division_points(3)[1]\nTest ran for 15.41 s\n    [986 tests, 60.69 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 60.9 seconds\n    cpu time: 54.9 seconds\n    cumulative wall time: 60.7 seconds\n```\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/250f15ab7d9f3c8759afe55f687ecc5e49d8fb32\">250f15a</a></td><td><code>fixed documentation, removed an import that's not longer needed, removed a list function</code></td></tr></table>\n",
    "created_at": "2018-02-06T05:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376262",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:8'></a>
I changed a few small things:

1) Fixed a line in doctest so that it works with sphnix.

2) Removed the multiples import and removed list.

Is there a smaller example? The current one take me about 75s 

```
sage -t --warn-long ell_curve_isogeny.py
**********************************************************************
File "ell_curve_isogeny.py", line 726, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny
Warning, slow doctest:
    phi_v = EllipticCurveIsogeny(EK, P_list); phi_v
Test ran for 1.72 s
**********************************************************************
File "ell_curve_isogeny.py", line 838, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny
Warning, slow doctest:
    iso2 = EL.isogenies_prime_degree(2); len(iso2)
Test ran for 7.27 s
**********************************************************************
File "ell_curve_isogeny.py", line 840, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny
Warning, slow doctest:
    iso3 = EL.isogenies_prime_degree(3); len(iso3)
Test ran for 9.97 s
**********************************************************************
File "ell_curve_isogeny.py", line 852, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny
Warning, slow doctest:
    duals = [phi.dual() for phi in isogs]
Test ran for 1.46 s
**********************************************************************
File "ell_curve_isogeny.py", line 1860, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.__init_from_kernel_list
Warning, slow doctest:
    p=12*next_prime(2**516)*next_prime(2**543)-1
Test ran for 1.31 s
**********************************************************************
File "ell_curve_isogeny.py", line 1861, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.__init_from_kernel_list
Warning, slow doctest:
    E=EllipticCurve([GF(p)(1),GF(p)(0)])
Test ran for 11.81 s
**********************************************************************
File "ell_curve_isogeny.py", line 1862, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.__init_from_kernel_list
Warning, slow doctest:
    P=E(0).division_points(3)[1]
Test ran for 15.41 s
    [986 tests, 60.69 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 60.9 seconds
    cpu time: 54.9 seconds
    cumulative wall time: 60.7 seconds
```

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/250f15ab7d9f3c8759afe55f687ecc5e49d8fb32">250f15a</a></td><td><code>fixed documentation, removed an import that's not longer needed, removed a list function</code></td></tr></table>




---

archive/issue_comments_376263.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks Kevin! Here's a smaller example that takes under 2 seconds with the patch, and still takes a very long time without the patch. (Hopefully integer factorization algorithms in the future will not improve to the point where the second part of the previous sentence becomes false.) I also added a speed optimization in the field creation step to help things along.\n\n```\np = 12 * next_prime(2^246) * next_prime(2^247) - 1\nF = FiniteField(p, proof=False)\nE = EllipticCurve([F(1), F(0)])\nP = E(0).division_points(3)[1]\nEllipticCurveIsogeny(E, P)\n```",
    "created_at": "2018-02-06T05:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376263",
    "user": "https://github.com/davidjao"
}
```

<a id='comment:9'></a>
Thanks Kevin! Here's a smaller example that takes under 2 seconds with the patch, and still takes a very long time without the patch. (Hopefully integer factorization algorithms in the future will not improve to the point where the second part of the previous sentence becomes false.) I also added a speed optimization in the field creation step to help things along.

```
p = 12 * next_prime(2^246) * next_prime(2^247) - 1
F = FiniteField(p, proof=False)
E = EllipticCurve([F(1), F(0)])
P = E(0).division_points(3)[1]
EllipticCurveIsogeny(E, P)
```



---

archive/issue_comments_376264.json:
```json
{
    "body": "**Changing branch** from \"[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)\" to \"[u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)\".",
    "created_at": "2018-02-06T19:08:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376264",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```

**Changing branch** from "[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)" to "[u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)".



---

archive/issue_comments_376265.json:
```json
{
    "body": "<a id='comment:11'></a>\nWe have updated our branch to include the faster doctest.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6ec1d657fec57c311292fbef96832b8302833c4\">e6ec1d6</a></td><td><code>Smaller and faster doctest for order-free isogenies</code></td></tr></table>\n",
    "created_at": "2018-02-06T19:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376265",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```

<a id='comment:11'></a>
We have updated our branch to include the faster doctest.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6ec1d657fec57c311292fbef96832b8302833c4">e6ec1d6</a></td><td><code>Smaller and faster doctest for order-free isogenies</code></td></tr></table>




---

archive/issue_comments_376266.json:
```json
{
    "body": "**Changing commit** from \"[250f15ab7d9f3c8759afe55f687ecc5e49d8fb32](https://github.com/sagemath/sagetrac-mirror/commit/250f15ab7d9f3c8759afe55f687ecc5e49d8fb32)\" to \"[e6ec1d657fec57c311292fbef96832b8302833c4](https://github.com/sagemath/sagetrac-mirror/commit/e6ec1d657fec57c311292fbef96832b8302833c4)\".",
    "created_at": "2018-02-06T19:18:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376266",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```

**Changing commit** from "[250f15ab7d9f3c8759afe55f687ecc5e49d8fb32](https://github.com/sagemath/sagetrac-mirror/commit/250f15ab7d9f3c8759afe55f687ecc5e49d8fb32)" to "[e6ec1d657fec57c311292fbef96832b8302833c4](https://github.com/sagemath/sagetrac-mirror/commit/e6ec1d657fec57c311292fbef96832b8302833c4)".



---

archive/issue_comments_376267.json:
```json
{
    "body": "<a id='comment:12'></a>\nSorry to bug you again. But is there a even smaller example? I think the doctests are suppose to take under a second. Alternatively, you can flag it as a long test.\n\nhttp://doc.sagemath.org/html/en/developer/doctesting.html#run-long-doctests\n\nAs a side question, how are you able to come up with these primes?\n\nAfter this, it should be go to go. Can you set the ticket as 'need review'? and I can give it a positive review.",
    "created_at": "2018-02-07T00:37:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376267",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:12'></a>
Sorry to bug you again. But is there a even smaller example? I think the doctests are suppose to take under a second. Alternatively, you can flag it as a long test.

http://doc.sagemath.org/html/en/developer/doctesting.html#run-long-doctests

As a side question, how are you able to come up with these primes?

After this, it should be go to go. Can you set the ticket as 'need review'? and I can give it a positive review.



---

archive/issue_comments_376268.json:
```json
{
    "body": "<a id='comment:13'></a>\nYou just pick random exponents until the resulting p is a prime. What you want is:\n\n* p is not too large (so that the test runs fast)\n* factoring p+1 takes a long time (so that the test demonstrates the need for avoiding factoring p+1)\n\nHowever, I'm worried that if p is too small then improvements in future factoring technology will render the second point false while still not invalidating the main conclusion that factoring is too slow and should be avoided in general. I think the lowest we should go is (180, 194). This runs in under 1 second on my machine.\n\nThe full test is then:\n\n```\np = 12 * next_prime(2^180) * next_prime(2^194) - 1\nF = FiniteField(p, proof=False)\nE = EllipticCurve([F(1), F(0)])\nP = E(0).division_points(3)[1]\nEllipticCurveIsogeny(E, P)\n```",
    "created_at": "2018-02-07T01:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376268",
    "user": "https://github.com/davidjao"
}
```

<a id='comment:13'></a>
You just pick random exponents until the resulting p is a prime. What you want is:

* p is not too large (so that the test runs fast)
* factoring p+1 takes a long time (so that the test demonstrates the need for avoiding factoring p+1)

However, I'm worried that if p is too small then improvements in future factoring technology will render the second point false while still not invalidating the main conclusion that factoring is too slow and should be avoided in general. I think the lowest we should go is (180, 194). This runs in under 1 second on my machine.

The full test is then:

```
p = 12 * next_prime(2^180) * next_prime(2^194) - 1
F = FiniteField(p, proof=False)
E = EllipticCurve([F(1), F(0)])
P = E(0).division_points(3)[1]
EllipticCurveIsogeny(E, P)
```



---

archive/issue_comments_376269.json:
```json
{
    "body": "**Changing commit** from \"[e6ec1d657fec57c311292fbef96832b8302833c4](https://github.com/sagemath/sagetrac-mirror/commit/e6ec1d657fec57c311292fbef96832b8302833c4)\" to \"[185d13695b0180cd483c4e67e26b43dccc6e1d66](https://github.com/sagemath/sagetrac-mirror/commit/185d13695b0180cd483c4e67e26b43dccc6e1d66)\".",
    "created_at": "2018-02-07T14:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376269",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[e6ec1d657fec57c311292fbef96832b8302833c4](https://github.com/sagemath/sagetrac-mirror/commit/e6ec1d657fec57c311292fbef96832b8302833c4)" to "[185d13695b0180cd483c4e67e26b43dccc6e1d66](https://github.com/sagemath/sagetrac-mirror/commit/185d13695b0180cd483c4e67e26b43dccc6e1d66)".



---

archive/issue_comments_376270.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/185d13695b0180cd483c4e67e26b43dccc6e1d66\">185d136</a></td><td><code>Faster doctest for order-free isogenies that is under one second</code></td></tr></table>\n",
    "created_at": "2018-02-07T14:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376270",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/185d13695b0180cd483c4e67e26b43dccc6e1d66">185d136</a></td><td><code>Faster doctest for order-free isogenies that is under one second</code></td></tr></table>




---

archive/issue_events_296955.json:
```json
{
    "actor": "https://github.com/sagetrac-m3vandyk",
    "created_at": "2018-02-07T14:08:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296955"
}
```



---

archive/issue_comments_376271.json:
```json
{
    "body": "<a id='comment:15'></a>\nI have changed the status to 'needs review' and the branch has been updated to include the faster doctest. The doctest runs in under 1 second on my machine as well.",
    "created_at": "2018-02-07T14:08:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376271",
    "user": "https://github.com/sagetrac-m3vandyk"
}
```

<a id='comment:15'></a>
I have changed the status to 'needs review' and the branch has been updated to include the faster doctest. The doctest runs in under 1 second on my machine as well.



---

archive/issue_comments_376272.json:
```json
{
    "body": "**Changing branch** from \"[u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)\" to \"[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)\".",
    "created_at": "2018-02-08T01:56:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376272",
    "user": "https://github.com/kevinywlui"
}
```

**Changing branch** from "[u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/m3vandyk/avoid_order_computation_in_ellipticcurveisogeny_function)" to "[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)".



---

archive/issue_comments_376273.json:
```json
{
    "body": "**Changing commit** from \"[185d13695b0180cd483c4e67e26b43dccc6e1d66](https://github.com/sagemath/sagetrac-mirror/commit/185d13695b0180cd483c4e67e26b43dccc6e1d66)\" to \"[926ff9b5a81a114433221c2ac9e9d4be6e70d0d9](https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9)\".",
    "created_at": "2018-02-08T02:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376273",
    "user": "https://github.com/kevinywlui"
}
```

**Changing commit** from "[185d13695b0180cd483c4e67e26b43dccc6e1d66](https://github.com/sagemath/sagetrac-mirror/commit/185d13695b0180cd483c4e67e26b43dccc6e1d66)" to "[926ff9b5a81a114433221c2ac9e9d4be6e70d0d9](https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9)".



---

archive/issue_comments_376274.json:
```json
{
    "body": "<a id='comment:17'></a>\nI made a small aesthetic change which was to fix some trailing spaces.\n\nI only made trivial code changes to this ticket so I hope it's okay that I'm the reviewer and am giving it a positive review.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9\">926ff9b</a></td><td><code>fixed trailing whitespace</code></td></tr></table>\n",
    "created_at": "2018-02-08T02:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376274",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:17'></a>
I made a small aesthetic change which was to fix some trailing spaces.

I only made trivial code changes to this ticket so I hope it's okay that I'm the reviewer and am giving it a positive review.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9">926ff9b</a></td><td><code>fixed trailing whitespace</code></td></tr></table>




---

archive/issue_events_296956.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T02:02:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296956"
}
```



---

archive/issue_events_296957.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T02:02:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296957"
}
```



---

archive/issue_events_296958.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-02-08T03:37:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296958"
}
```



---

archive/issue_events_296959.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-02-08T03:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296959"
}
```



---

archive/issue_comments_376275.json:
```json
{
    "body": "<a id='comment:19'></a>\nReviewer name missing.",
    "created_at": "2018-02-08T03:37:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376275",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>
Reviewer name missing.



---

archive/issue_comments_376276.json:
```json
{
    "body": "<a id='comment:20'></a>\nOpps. Sorry!",
    "created_at": "2018-02-08T04:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376276",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:20'></a>
Opps. Sorry!



---

archive/issue_events_296960.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T04:39:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296960"
}
```



---

archive/issue_events_296961.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T04:39:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296961"
}
```



---

archive/issue_comments_376277.json:
```json
{
    "body": "**Reviewer:** Kevin Lui",
    "created_at": "2018-02-08T04:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376277",
    "user": "https://github.com/kevinywlui"
}
```

**Reviewer:** Kevin Lui



---

archive/issue_events_296962.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-09T23:47:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296962"
}
```



---

archive/issue_events_296963.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "870d1d87cd861715ced80d8001501463ed929962",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-02-09T23:47:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24640#event-296963"
}
```



---

archive/issue_comments_376278.json:
```json
{
    "body": "**Changing branch** from \"[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)\" to \"[926ff9b5a81a114433221c2ac9e9d4be6e70d0d9](https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9)\".",
    "created_at": "2018-02-09T23:47:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24640#issuecomment-376278",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/klui/avoid_order_computation_in_ellipticcurveisogeny_function](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/avoid_order_computation_in_ellipticcurveisogeny_function)" to "[926ff9b5a81a114433221c2ac9e9d4be6e70d0d9](https://github.com/sagemath/sagetrac-mirror/commit/926ff9b5a81a114433221c2ac9e9d4be6e70d0d9)".
