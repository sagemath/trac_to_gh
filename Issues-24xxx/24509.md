# Issue 24509: little cleanup of alphabet

archive/issues_024272.json:
```json
{
    "body": "just a few pep8 details\n\nCC:  @tscrim @embray @jdemeyer\n\nBranch/Commit: 55e966a8f1ce935ac784d5a03c6db987dbf99004\n\nReviewer: Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24509\n\n",
    "closed_at": "2018-01-15T22:29:18Z",
    "created_at": "2018-01-10T15:28:13Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "little cleanup of alphabet",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24509",
    "user": "https://github.com/fchapoton"
}
```
just a few pep8 details

CC:  @tscrim @embray @jdemeyer

Branch/Commit: 55e966a8f1ce935ac784d5a03c6db987dbf99004

Reviewer: Travis Scrimshaw

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24509





---

archive/issue_comments_463932.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-10T15:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463932",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_463933.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2018-01-10T15:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463933",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_463934.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/24509\"",
    "created_at": "2018-01-10T15:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463934",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/24509"



---

archive/issue_comments_463935.json:
```json
{
    "body": "Changing commit from \"\" to \"e62f8d05a2026fc2f30c983edbbceb92b478c646\"",
    "created_at": "2018-01-10T15:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463935",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "e62f8d05a2026fc2f30c983edbbceb92b478c646"



---

archive/issue_comments_463936.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-01-10T15:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463936",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_463937.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-01-10T15:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463937",
    "user": "https://github.com/fchapoton"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_463938.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2018-01-10T15:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463938",
    "user": "https://github.com/fchapoton"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_463939.json:
```json
{
    "body": "<a id='comment:4'></a>While I doubt this is an issue, this change:\n\n```diff\n-    if data == Infinity:\n+    if data is Infinity:\n```\nis a slight behavior change because\n\n```\nsage: UnsignedInfinityRing.gen() == Infinity\nTrue\nsage: UnsignedInfinityRing.gen() is Infinity\nFalse\n```\nSo if this is okay to you or you revert this change, then you can set a positive review on my behalf.",
    "created_at": "2018-01-10T16:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463939",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>While I doubt this is an issue, this change:

```diff
-    if data == Infinity:
+    if data is Infinity:
```
is a slight behavior change because

```
sage: UnsignedInfinityRing.gen() == Infinity
True
sage: UnsignedInfinityRing.gen() is Infinity
False
```
So if this is okay to you or you revert this change, then you can set a positive review on my behalf.



---

archive/issue_comments_463940.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2018-01-10T16:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463940",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_463941.json:
```json
{
    "body": "<a id='comment:5'></a>Well, this change is the main point of the ticket. In python3, the comparison with == fails, whereas the check with \"is\" works.",
    "created_at": "2018-01-10T16:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463941",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>Well, this change is the main point of the ticket. In python3, the comparison with == fails, whereas the check with "is" works.



---

archive/issue_comments_463942.json:
```json
{
    "body": "<a id='comment:6'></a>That smells like a deeper problem as I don't see why the `==` should fail. In fact, most people in code would do checks of infinity objects by `==`. While that is an independent issue, it should not be necessary to change `==` to `is` for Python3.",
    "created_at": "2018-01-10T16:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463942",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>That smells like a deeper problem as I don't see why the `==` should fail. In fact, most people in code would do checks of infinity objects by `==`. While that is an independent issue, it should not be necessary to change `==` to `is` for Python3.



---

archive/issue_comments_463943.json:
```json
{
    "body": "<a id='comment:7'></a>Indeed, I was trying to cure symptoms and not the root of illness:\n\n```\nsage: from sage.combinat.words.alphabet import *\nsage: build_alphabet(['a','b'])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-451f2d6eca53> in <module>()\n----> 1 build_alphabet(['a','b'])\n\n/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/combinat/words/alphabet.py in build_alphabet(data, names, name)\n    231         raise ValueError(\"invalid value for names\")\n    232 \n--> 233     if data == Infinity:\n    234         data = NonNegativeIntegers()\n    235 \n\n/home/chapoton/sage3/src/sage/structure/element.pyx in sage.structure.element.Element.__richcmp__ (build/cythonized/sage/structure/element.c:10052)()\n\n/home/chapoton/sage3/src/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel_cache_maps.richcmp (build/cythonized/sage/structure/coerce.c:20685)()\n\nTypeError: '<' not supported between instances of 'sage.misc.inherit_comparison.InheritComparisonMetaclass' and 'type'\n```",
    "created_at": "2018-01-10T19:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463943",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>Indeed, I was trying to cure symptoms and not the root of illness:

```
sage: from sage.combinat.words.alphabet import *
sage: build_alphabet(['a','b'])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-451f2d6eca53> in <module>()
----> 1 build_alphabet(['a','b'])

/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/combinat/words/alphabet.py in build_alphabet(data, names, name)
    231         raise ValueError("invalid value for names")
    232 
--> 233     if data == Infinity:
    234         data = NonNegativeIntegers()
    235 

/home/chapoton/sage3/src/sage/structure/element.pyx in sage.structure.element.Element.__richcmp__ (build/cythonized/sage/structure/element.c:10052)()

/home/chapoton/sage3/src/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel_cache_maps.richcmp (build/cythonized/sage/structure/coerce.c:20685)()

TypeError: '<' not supported between instances of 'sage.misc.inherit_comparison.InheritComparisonMetaclass' and 'type'
```



---

archive/issue_comments_463944.json:
```json
{
    "body": "<a id='comment:8'></a>Could that be an issue with bytes/unicode vs str?",
    "created_at": "2018-01-10T21:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463944",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>Could that be an issue with bytes/unicode vs str?



---

archive/issue_comments_463945.json:
```json
{
    "body": "<a id='comment:9'></a>Or perhaps related to:\n\n```\nsage: InfinityRing('a')\nA positive finite number\n```\nwhich comes from doing comparisons of the form `'a' < 0`?",
    "created_at": "2018-01-10T21:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463945",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>Or perhaps related to:

```
sage: InfinityRing('a')
A positive finite number
```
which comes from doing comparisons of the form `'a' < 0`?



---

archive/issue_comments_463946.json:
```json
{
    "body": "<a id='comment:10'></a>comment:9 gives another error:\n\n```\nsage: InfinityRing('a')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-1-5b6ff3fa50ce> in <module>()\n----> 1 InfinityRing('a')\n\n/home/chapoton/sage3/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9406)()\n\n/home/chapoton/sage3/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4972)()\n\n/home/chapoton/sage3/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4840)()\n\n/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/rings/infinity.py in _element_constructor_(self, x)\n   1186 \n   1187         # If we got here then x is not infinite\n-> 1188         c = int(bool(x > 0)) - int(bool(x < 0))\n   1189         return FiniteNumber(self, c)\n   1190 \n\nTypeError: '>' not supported between instances of 'str' and 'int'\n```",
    "created_at": "2018-01-11T07:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463946",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>comment:9 gives another error:

```
sage: InfinityRing('a')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-5b6ff3fa50ce> in <module>()
----> 1 InfinityRing('a')

/home/chapoton/sage3/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9406)()

/home/chapoton/sage3/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4972)()

/home/chapoton/sage3/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4840)()

/home/chapoton/sage3/local/lib/python3.6/site-packages/sage/rings/infinity.py in _element_constructor_(self, x)
   1186 
   1187         # If we got here then x is not infinite
-> 1188         c = int(bool(x > 0)) - int(bool(x < 0))
   1189         return FiniteNumber(self, c)
   1190 

TypeError: '>' not supported between instances of 'str' and 'int'
```



---

archive/issue_comments_463947.json:
```json
{
    "body": "<a id='comment:11'></a>I've fixed a ton of issues like these in my branch, though apparently not this specific one.  But yes, if a comparison that should have worked in Python 2 no longer works in Python 3 the thing to fix is the comparison, not remove it / brush the problem under the rug.",
    "created_at": "2018-01-11T11:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463947",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>I've fixed a ton of issues like these in my branch, though apparently not this specific one.  But yes, if a comparison that should have worked in Python 2 no longer works in Python 3 the thing to fix is the comparison, not remove it / brush the problem under the rug.



---

archive/issue_comments_463948.json:
```json
{
    "body": "Changing commit from \"e62f8d05a2026fc2f30c983edbbceb92b478c646\" to \"55e966a8f1ce935ac784d5a03c6db987dbf99004\"",
    "created_at": "2018-01-11T15:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463948",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e62f8d05a2026fc2f30c983edbbceb92b478c646" to "55e966a8f1ce935ac784d5a03c6db987dbf99004"



---

archive/issue_comments_463949.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-01-11T15:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463949",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_463950.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-for py3 compatibility, plsu a few pep8 details\n+just a few pep8 details\n \n Comment: 1\n \n``````\n",
    "created_at": "2018-01-11T15:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463950",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-for py3 compatibility, plsu a few pep8 details
+just a few pep8 details
 
 Comment: 1
 
``````




---

archive/issue_comments_463951.json:
```json
{
    "body": "<a id='comment:13'></a>ok. I have decided to downgrade this ticket to a trivial pep8 ticket.\n\nI have undone the change, back to `data == Infinity`\n\nGiven Travis comment:4, I allow myself to set to positive.",
    "created_at": "2018-01-11T15:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463951",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>ok. I have decided to downgrade this ticket to a trivial pep8 ticket.

I have undone the change, back to `data == Infinity`

Given Travis comment:4, I allow myself to set to positive.



---

archive/issue_comments_463952.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-11T15:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463952",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_463953.json:
```json
{
    "body": "Changing branch from \"u/chapoton/24509\" to \"55e966a8f1ce935ac784d5a03c6db987dbf99004\"",
    "created_at": "2018-01-15T22:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463953",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/24509" to "55e966a8f1ce935ac784d5a03c6db987dbf99004"



---

archive/issue_comments_463954.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-01-15T22:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24509#issuecomment-463954",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_061824.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-15T22:29:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24509",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24509#event-61824"
}
```
