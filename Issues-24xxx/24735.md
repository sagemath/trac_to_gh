# Issue 24735: upgrade Singular to 4.1.1p2

archive/issues_024498.json:
```json
{
    "assignees": [],
    "body": "Singular 4.1.1 is out. \nThe changes for it can be found at:\nhttps://www.singular.uni-kl.de/index.php/news/release-of-singular-4-1-1.html\n\nThe tarball:\nhttp://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p2.tar.gz\n\nFollow-up ticket for the upgrade to Singular 4.1.1p3: #25993.\n\nCC:  @kiwifb @antonio-rojas @timokau @mezzarobba\n\nKeywords: **days94**\n\nBranch/Commit: **[45ff371](https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c)**\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\nReviewer: **Jeroen Demeyer, Volker Braun**\n\nAuthor: **Antonio Rojas, Timo Kaufmann**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24735_\n\n",
    "closed_at": "2018-08-17T21:14:22Z",
    "created_at": "2018-02-15T12:17:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "upgrade Singular to 4.1.1p2",
    "type": "issue",
    "updated_at": "2018-08-17T21:14:22Z",
    "url": "https://github.com/sagemath/sage/issues/24735",
    "user": "https://github.com/dimpase"
}
```
Singular 4.1.1 is out. 
The changes for it can be found at:
https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-1-1.html

The tarball:
http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p2.tar.gz

Follow-up ticket for the upgrade to Singular 4.1.1p3: #25993.

CC:  @kiwifb @antonio-rojas @timokau @mezzarobba

Keywords: **days94**

Branch/Commit: **[45ff371](https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c)**

Upstream: **Fixed upstream, but not in a stable release.**

Reviewer: **Jeroen Demeyer, Volker Braun**

Author: **Antonio Rojas, Timo Kaufmann**

_Issue created by migration from https://trac.sagemath.org/ticket/24735_





---

archive/issue_events_324376.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-02-15T12:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324376"
}
```



---

archive/issue_events_324377.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-02-15T12:17:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324377"
}
```



---

archive/issue_events_324378.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-02-15T12:17:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324378"
}
```



---

archive/issue_events_324379.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-02-15T12:17:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324379"
}
```



---

archive/issue_comments_378648.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nOne immediate issue is https://github.com/Singular/Sources/issues/855",
    "created_at": "2018-02-15T14:11:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378648",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">Comment 1</div>

One immediate issue is https://github.com/Singular/Sources/issues/855



---

archive/issue_comments_378649.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nReplying to [@dimpase](#comment%3A1):\n> One immediate issue is https://github.com/Singular/Sources/issues/855\n\nFixed upstream.",
    "created_at": "2018-02-15T16:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378649",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">Comment 2</div>

Replying to [@dimpase](#comment%3A1):
> One immediate issue is https://github.com/Singular/Sources/issues/855

Fixed upstream.



---

archive/issue_comments_378650.json:
```json
{
    "body": "Upstream: **Fixed upstream, but not in a stable release.**",
    "created_at": "2018-02-15T16:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378650",
    "user": "https://github.com/jdemeyer"
}
```

Upstream: **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_378651.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nA patch that makes Sage build with the API changes in 4.1.1 is available at [1]\n\nHowever, the removal of singclap_pmod and singclap_pdivide for polynomials with integer coefficients [2] causes some regressions:\n\n\n```\nsage: R.<x,y>=ZZ[] \nsage: a=x+y \nsage: b=x-y \nsage: a.gcd(b) \n1 \nsage: a.quo_rem(b) \n( 0, x + y ) \nsage: a.gcd(b) \n0 \nsage: singular(a).gcd(b) \n1 \n```\n\n\n[1] https://git.archlinux.org/svntogit/community.git/tree/trunk/sagemath-singular-4.1.1.patch?h=packages/sagemath\n\n[2] https://github.com/Singular/Sources/commit/4c1e770238d949fb0c7debc00998d507df876751",
    "created_at": "2018-02-28T18:35:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378651",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:4" align="right">Comment 4</div>

A patch that makes Sage build with the API changes in 4.1.1 is available at [1]

However, the removal of singclap_pmod and singclap_pdivide for polynomials with integer coefficients [2] causes some regressions:


```
sage: R.<x,y>=ZZ[] 
sage: a=x+y 
sage: b=x-y 
sage: a.gcd(b) 
1 
sage: a.quo_rem(b) 
( 0, x + y ) 
sage: a.gcd(b) 
0 
sage: singular(a).gcd(b) 
1 
```


[1] https://git.archlinux.org/svntogit/community.git/tree/trunk/sagemath-singular-4.1.1.patch?h=packages/sagemath

[2] https://github.com/Singular/Sources/commit/4c1e770238d949fb0c7debc00998d507df876751



---

archive/issue_comments_378652.json:
```json
{
    "body": "Changed keywords from none to **days94**",
    "created_at": "2018-06-29T13:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378652",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from none to **days94**



---

archive/issue_comments_378653.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nSingular no longer supports singclap_pmod and singclap_pdivide for polynomials with integer coefficients. This change\n\n```\n--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n@@ -4888,7 +4888,7 @@ cdef class MPolynomial_libsingular(MPolynomial):\n         if right.is_zero():\n             raise ZeroDivisionError\n \n-        if not self._parent._base.is_field() and not is_IntegerRing(self._parent._base):\n+        if not self._parent._base.is_field():\n             py_quo = self//right\n             py_rem = self - right*py_quo\n             return py_quo, py_rem\n```\nmakes Sage not call Singular's singclap_pdivide for integer coefficients in quo_rem. With this, most test pass again (modulo some output format changes and generators ordering). There is another singclap_pdivide call in `__floordiv__` in\nhttps://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx?h=develop#n4073\nthat should also be avoided for the integer coefficients case. I'm unsure what Sage should return here, since I'm unsure what the correct definition of floordiv would be. Should it just return NotImplementedError?",
    "created_at": "2018-06-29T15:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378653",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:7" align="right">Comment 7</div>

Singular no longer supports singclap_pmod and singclap_pdivide for polynomials with integer coefficients. This change

```
--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
@@ -4888,7 +4888,7 @@ cdef class MPolynomial_libsingular(MPolynomial):
         if right.is_zero():
             raise ZeroDivisionError
 
-        if not self._parent._base.is_field() and not is_IntegerRing(self._parent._base):
+        if not self._parent._base.is_field():
             py_quo = self//right
             py_rem = self - right*py_quo
             return py_quo, py_rem
```
makes Sage not call Singular's singclap_pdivide for integer coefficients in quo_rem. With this, most test pass again (modulo some output format changes and generators ordering). There is another singclap_pdivide call in `__floordiv__` in
https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx?h=develop#n4073
that should also be avoided for the integer coefficients case. I'm unsure what Sage should return here, since I'm unsure what the correct definition of floordiv would be. Should it just return NotImplementedError?



---

archive/issue_comments_378654.json:
```json
{
    "body": "Branch: **[u/arojas/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_1_1)**",
    "created_at": "2018-07-12T17:03:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378654",
    "user": "https://github.com/antonio-rojas"
}
```

Branch: **[u/arojas/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_1_1)**



---

archive/issue_comments_378655.json:
```json
{
    "body": "Commit: **[89c4f29](https://github.com/sagemath/sagetrac-mirror/commit/89c4f29a8802e0307b916f16ebef8fec06298eab)**",
    "created_at": "2018-07-12T17:07:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378655",
    "user": "https://github.com/antonio-rojas"
}
```

Commit: **[89c4f29](https://github.com/sagemath/sagetrac-mirror/commit/89c4f29a8802e0307b916f16ebef8fec06298eab)**



---

archive/issue_comments_378656.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nPushing WIP patch. Still needs a decision on what to do for `__floordiv__`, gcd and lcm in the integers coefficient case in multi_polynomial_libsingular.pyx.\n\nUnfortunately starting from 8.3.beta7 there are many more test failures caused by the upgrade due to #23909 \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39856158d913143f459fd55609b0372a92dff530\">3985615</a></td><td><code>Update to singular 4.1.1p2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/426644f6d085e053fa0fcf3457702eac685b7cba\">426644f</a></td><td><code>Adapt to singular 4.1.1 API changes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5fc2a4bc640856507d743c2f67ad454874700e7\">d5fc2a4</a></td><td><code>Don't call singclap_pdivide for integer coefficients, it's no longer supported</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89c4f29a8802e0307b916f16ebef8fec06298eab\">89c4f29</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/24735/upgrade_singular_to_4_1_1</code></td></tr></table>\n",
    "created_at": "2018-07-12T17:07:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378656",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:10" align="right">Comment 10</div>

Pushing WIP patch. Still needs a decision on what to do for `__floordiv__`, gcd and lcm in the integers coefficient case in multi_polynomial_libsingular.pyx.

Unfortunately starting from 8.3.beta7 there are many more test failures caused by the upgrade due to #23909 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39856158d913143f459fd55609b0372a92dff530">3985615</a></td><td><code>Update to singular 4.1.1p2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/426644f6d085e053fa0fcf3457702eac685b7cba">426644f</a></td><td><code>Adapt to singular 4.1.1 API changes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5fc2a4bc640856507d743c2f67ad454874700e7">d5fc2a4</a></td><td><code>Don't call singclap_pdivide for integer coefficients, it's no longer supported</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89c4f29a8802e0307b916f16ebef8fec06298eab">89c4f29</a></td><td><code>Merge branch 'develop' of https://github.com/sagemath/sage into t/24735/upgrade_singular_to_4_1_1</code></td></tr></table>




---

archive/issue_comments_378657.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nWith my limited knowledge of the topic and based on `git log`, it seems like we basically have to revert #25313.\n\nMark, do you have more information about that? The issue explained [here](#comment%3A7).",
    "created_at": "2018-07-20T13:09:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378657",
    "user": "https://github.com/timokau"
}
```

<div id="comment:11" align="right">Comment 11</div>

With my limited knowledge of the topic and based on `git log`, it seems like we basically have to revert #25313.

Mark, do you have more information about that? The issue explained [here](#comment%3A7).



---

archive/issue_comments_378658.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,5 @@\n https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-1-1.html\n \n The tarball:\n-http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1.tar.gz\n+http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p2.tar.gz\n \n``````\n",
    "created_at": "2018-07-20T14:34:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378658",
    "user": "https://github.com/timokau"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,5 @@
 https://www.singular.uni-kl.de/index.php/news/release-of-singular-4-1-1.html
 
 The tarball:
-http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1.tar.gz
+http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p2.tar.gz
 
``````




---

archive/issue_events_324380.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-20T14:34:51Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "title_is": "upgrade Singular to 4.1.1p2",
    "title_was": "upgrade Singular to 4.1.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324380"
}
```



---

archive/issue_comments_378659.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nOkay in addition to the revert of #25313 it was also necessary to convert integral polynomials to rationals in `lcm`. I also updated the remaining doctests. I'm not qualified to say that the results are equivalent, but at least they look reasonable enough. If nobody spots an error, I guess we can trust singular here.\n\nI'm still running `ptestlong`, but at least the tests in `src/sgae/rings/polynomial` pass. [Here's my branch](https://github.com/sagemath/sagetrac-mirror/commits/u/gh-timokau/upgrade_singular_to_4_1_1) (`u/gh-timokau/upgrade_singular_to_4_1_1`).\n\n@antonio-rojas I don't want to \"steal\" your work, so feel free to pick those commits in your branch and rebase them if nobody objects.",
    "created_at": "2018-07-20T16:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378659",
    "user": "https://github.com/timokau"
}
```

<div id="comment:13" align="right">Comment 13</div>

Okay in addition to the revert of #25313 it was also necessary to convert integral polynomials to rationals in `lcm`. I also updated the remaining doctests. I'm not qualified to say that the results are equivalent, but at least they look reasonable enough. If nobody spots an error, I guess we can trust singular here.

I'm still running `ptestlong`, but at least the tests in `src/sgae/rings/polynomial` pass. [Here's my branch](https://github.com/sagemath/sagetrac-mirror/commits/u/gh-timokau/upgrade_singular_to_4_1_1) (`u/gh-timokau/upgrade_singular_to_4_1_1`).

@antonio-rojas I don't want to "steal" your work, so feel free to pick those commits in your branch and rebase them if nobody objects.



---

archive/issue_comments_378660.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@timokau](#comment%3A13):\n> Okay in addition to the revert of #25313 it was also necessary to convert integral polynomials to rationals in `lcm`. I also updated the remaining doctests. I'm not qualified to say that the results are equivalent, but at least they look reasonable enough. If nobody spots an error, I guess we can trust singular here.\n\nWhat about gcd? AFAICS this is still calling singular's singclap_gcd for ZZ coefficients. \n\nFeel free to pick up my branch where I left it, I'm glad to see this move along.",
    "created_at": "2018-07-20T16:49:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378660",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@timokau](#comment%3A13):
> Okay in addition to the revert of #25313 it was also necessary to convert integral polynomials to rationals in `lcm`. I also updated the remaining doctests. I'm not qualified to say that the results are equivalent, but at least they look reasonable enough. If nobody spots an error, I guess we can trust singular here.

What about gcd? AFAICS this is still calling singular's singclap_gcd for ZZ coefficients. 

Feel free to pick up my branch where I left it, I'm glad to see this move along.



---

archive/issue_comments_378661.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@antonio-rojas](#comment%3A14):\n> Replying to [@timokau](#comment%3A13):\n> > Okay in addition to the revert of #25313 it was also necessary to convert integral polynomials to rationals in `lcm`. I also updated the remaining doctests. I'm not qualified to say that the results are equivalent, but at least they look reasonable enough. If nobody spots an error, I guess we can trust singular here.\n\n> \n> What about gcd? AFAICS this is still calling singular's singclap_gcd for ZZ coefficients.\n\nThe tests succeed, including the one over `ZZ`:\n\n```\nsage: Pol.<x,y,z> = ZZ[]\nsage: p = x*y - 5*y^2 + x*z - z^2 + z\nsage: q = -3*x^2*y^7*z + 2*x*y^6*z^3 + 2*x^2*y^3*z^4 + x^2*y^5 - 7*x*y^5*z\nsage: (21^3*p^2*q).gcd(35^2*p*q^2) == -49*p*q\nTrue\n```",
    "created_at": "2018-07-20T17:00:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378661",
    "user": "https://github.com/timokau"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@antonio-rojas](#comment%3A14):
> Replying to [@timokau](#comment%3A13):
> > Okay in addition to the revert of #25313 it was also necessary to convert integral polynomials to rationals in `lcm`. I also updated the remaining doctests. I'm not qualified to say that the results are equivalent, but at least they look reasonable enough. If nobody spots an error, I guess we can trust singular here.

> 
> What about gcd? AFAICS this is still calling singular's singclap_gcd for ZZ coefficients.

The tests succeed, including the one over `ZZ`:

```
sage: Pol.<x,y,z> = ZZ[]
sage: p = x*y - 5*y^2 + x*z - z^2 + z
sage: q = -3*x^2*y^7*z + 2*x*y^6*z^3 + 2*x^2*y^3*z^4 + x^2*y^5 - 7*x*y^5*z
sage: (21^3*p^2*q).gcd(35^2*p*q^2) == -49*p*q
True
```



---

archive/issue_comments_378662.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nThis gives a wrong answer\n\n```\nsage: A.<x,y>=ZZ[]\nsage: lcm(2*x,2*x*y)\n4*x*y\n```\nThat is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents.",
    "created_at": "2018-07-20T18:02:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378662",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:16" align="right">Comment 16</div>

This gives a wrong answer

```
sage: A.<x,y>=ZZ[]
sage: lcm(2*x,2*x*y)
4*x*y
```
That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents.



---

archive/issue_comments_378663.json:
```json
{
    "body": "Changed commit from **[89c4f29](https://github.com/sagemath/sagetrac-mirror/commit/89c4f29a8802e0307b916f16ebef8fec06298eab)** to **[2cd8487](https://github.com/sagemath/sagetrac-mirror/commit/2cd8487ff5a7f74c6c75659b44be5f48d27639e6)**",
    "created_at": "2018-07-21T09:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378663",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[89c4f29](https://github.com/sagemath/sagetrac-mirror/commit/89c4f29a8802e0307b916f16ebef8fec06298eab)** to **[2cd8487](https://github.com/sagemath/sagetrac-mirror/commit/2cd8487ff5a7f74c6c75659b44be5f48d27639e6)**



---

archive/issue_comments_378664.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4763da19a9ea0be849ee3640fc39747d725cb5a1\">4763da1</a></td><td><code>Fix lcm of polynomials with integer coefficients and add test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/544f67d45ce00142d99cbca7ca1ef39df95d3551\">544f67d</a></td><td><code>Revert \"Trac #25313: Speed up exact division in \u2124[x,y,...]\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2cd8487ff5a7f74c6c75659b44be5f48d27639e6\">2cd8487</a></td><td><code>singular: update doctests</code></td></tr></table>\n",
    "created_at": "2018-07-21T09:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378664",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17" align="right">Comment 17</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4763da19a9ea0be849ee3640fc39747d725cb5a1">4763da1</a></td><td><code>Fix lcm of polynomials with integer coefficients and add test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/544f67d45ce00142d99cbca7ca1ef39df95d3551">544f67d</a></td><td><code>Revert "Trac #25313: Speed up exact division in ℤ[x,y,...]"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2cd8487ff5a7f74c6c75659b44be5f48d27639e6">2cd8487</a></td><td><code>singular: update doctests</code></td></tr></table>




---

archive/issue_comments_378665.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nThere are still many test failures which are unrelated to the sinclap_pdivide issue. They seem caused by singular now returning an warning when computing groebner bases over CC, so Sage falls back to the toy implementation:\n\n```\nsage: A.<x,y>=CC[]\nsage: I=A.ideal(x-y)\nsage: I._groebner_basis_singular()\n```\nnow returns\n\n```\nTypeError: Singular error:\n// ** groebner base computations with inexact coefficients can not be trusted due to rounding errors\n```\nWith singular 4.1.0 it gives\n\n```\nsage: I._groebner_basis_singular()\n[x - y]\n```\n\nThe problem is that the Singular warning\n\"groebner base computations with inexact coefficients can not be trusted due to rounding errors\" matches\n\n```\n       if s.find(\"error\") != -1 or s.find(\"Segment fault\") != -1:\n```\nfrom singular.py so Sage (incorrectly) throws a SingularError. The test for errors in singular.py should be made more reliable.",
    "created_at": "2018-07-21T18:25:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378665",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:18" align="right">Comment 18</div>

There are still many test failures which are unrelated to the sinclap_pdivide issue. They seem caused by singular now returning an warning when computing groebner bases over CC, so Sage falls back to the toy implementation:

```
sage: A.<x,y>=CC[]
sage: I=A.ideal(x-y)
sage: I._groebner_basis_singular()
```
now returns

```
TypeError: Singular error:
// ** groebner base computations with inexact coefficients can not be trusted due to rounding errors
```
With singular 4.1.0 it gives

```
sage: I._groebner_basis_singular()
[x - y]
```

The problem is that the Singular warning
"groebner base computations with inexact coefficients can not be trusted due to rounding errors" matches

```
       if s.find("error") != -1 or s.find("Segment fault") != -1:
```
from singular.py so Sage (incorrectly) throws a SingularError. The test for errors in singular.py should be made more reliable.



---

archive/issue_comments_378666.json:
```json
{
    "body": "Changed commit from **[2cd8487](https://github.com/sagemath/sagetrac-mirror/commit/2cd8487ff5a7f74c6c75659b44be5f48d27639e6)** to **[ab851b1](https://github.com/sagemath/sagetrac-mirror/commit/ab851b1a2485c98b9f281e5bb5ea294e84f39040)**",
    "created_at": "2018-07-21T23:12:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378666",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2cd8487](https://github.com/sagemath/sagetrac-mirror/commit/2cd8487ff5a7f74c6c75659b44be5f48d27639e6)** to **[ab851b1](https://github.com/sagemath/sagetrac-mirror/commit/ab851b1a2485c98b9f281e5bb5ea294e84f39040)**



---

archive/issue_comments_378667.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9dc104b4ff3d3cc34fa8ec9483f83fce033f627\">d9dc104</a></td><td><code>Make Singular error parser more granular</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab851b1a2485c98b9f281e5bb5ea294e84f39040\">ab851b1</a></td><td><code>Update some tests output</code></td></tr></table>\n",
    "created_at": "2018-07-21T23:12:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378667",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19" align="right">Comment 19</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9dc104b4ff3d3cc34fa8ec9483f83fce033f627">d9dc104</a></td><td><code>Make Singular error parser more granular</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab851b1a2485c98b9f281e5bb5ea294e84f39040">ab851b1</a></td><td><code>Update some tests output</code></td></tr></table>




---

archive/issue_comments_378668.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\n> That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents. \n\nWhy? My understanding of the theory here is very limited, but shouldn't the lcm be `2 * x * y` in both cases?\n\n> There are still many test failures which are unrelated to the sinclap_pdivide issue.\n\nYeah I didn't have time to finish the tests unfortunately. Thanks for continuing to work on this.\n\n\nWhat's the status? Are there still remaining failures?",
    "created_at": "2018-07-23T12:09:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378668",
    "user": "https://github.com/timokau"
}
```

<div id="comment:20" align="right">Comment 20</div>

> That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents. 

Why? My understanding of the theory here is very limited, but shouldn't the lcm be `2 * x * y` in both cases?

> There are still many test failures which are unrelated to the sinclap_pdivide issue.

Yeah I didn't have time to finish the tests unfortunately. Thanks for continuing to work on this.


What's the status? Are there still remaining failures?



---

archive/issue_comments_378669.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@timokau](#comment%3A20):\n> > That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents. \n\n> \n> Why? My understanding of the theory here is very limited, but shouldn't the lcm be `2 * x * y` in both cases?\n\nThe lcm is well defined only up to multiplication by a unit. Both `2*x*y` and `4*x*y` are correct over QQ[x,y], since they differ by 2 which is a unit in QQ[x,y]. But on ZZ[x,y] the only correct answers are `2*x*y` and `-2*x*y`\n\n \n> What's the status? Are there still remaining failures?\n\n```\nsage -t src/sage/libs/ntl/error.pyx  # Bad exit: 2\nsage -t src/sage/libs/ntl/ntl_ZZ_pX.pyx  # Bad exit: 2\nsage -t src/sage/schemes/jacobians/abstract_jacobian.py  # 1 doctest failed\nsage -t src/sage/schemes/projective/projective_morphism.py  # 3 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/graded_ring_element.py  # 7 doctests failed\nsage -t src/sage/matrix/matrix_integer_dense.pyx  # Bad exit: 2\nsage -t src/sage/interfaces/singular.py  # 1 doctests failed\n```\n\nThe ntl ones are going to need some serious debugging.",
    "created_at": "2018-07-23T21:28:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378669",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@timokau](#comment%3A20):
> > That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents. 

> 
> Why? My understanding of the theory here is very limited, but shouldn't the lcm be `2 * x * y` in both cases?

The lcm is well defined only up to multiplication by a unit. Both `2*x*y` and `4*x*y` are correct over QQ[x,y], since they differ by 2 which is a unit in QQ[x,y]. But on ZZ[x,y] the only correct answers are `2*x*y` and `-2*x*y`

 
> What's the status? Are there still remaining failures?

```
sage -t src/sage/libs/ntl/error.pyx  # Bad exit: 2
sage -t src/sage/libs/ntl/ntl_ZZ_pX.pyx  # Bad exit: 2
sage -t src/sage/schemes/jacobians/abstract_jacobian.py  # 1 doctest failed
sage -t src/sage/schemes/projective/projective_morphism.py  # 3 doctests failed
sage -t src/sage/modular/modform_hecketriangle/graded_ring_element.py  # 7 doctests failed
sage -t src/sage/matrix/matrix_integer_dense.pyx  # Bad exit: 2
sage -t src/sage/interfaces/singular.py  # 1 doctests failed
```

The ntl ones are going to need some serious debugging.



---

archive/issue_comments_378670.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@antonio-rojas](#comment%3A21):\n> The lcm is well defined only up to multiplication by a unit. Both `2*x*y` and `4*x*y` are correct over QQ[x,y], since they differ by 2 which is a unit in QQ[x,y]. But on ZZ[x,y] the only correct answers are `2*x*y` and `-2*x*y`\n\nAh I didn't know / forgot that. That makes sense.\n\n> That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents. \n\nBut how does this solve the problem? E.g. let's determine the lcm of 2*x*y and 4*x*y using that technique. The contents would be 2 and 4, respectively. So we'd take `lcm(x*y, x*y)` in `Q[]`, which may be `42 * x * y`. We'd then multiply by `lcm(2, 4) = 4`, resulting in `168 * x * y`. Since `168` is not a unit in `Z`, this would still be wrong.\n\nDid I miss something?\n\nAnd do you know why Singular removed support for integer coefficients? I feel like we shouldn't have to hack around this.",
    "created_at": "2018-07-24T11:31:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378670",
    "user": "https://github.com/timokau"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@antonio-rojas](#comment%3A21):
> The lcm is well defined only up to multiplication by a unit. Both `2*x*y` and `4*x*y` are correct over QQ[x,y], since they differ by 2 which is a unit in QQ[x,y]. But on ZZ[x,y] the only correct answers are `2*x*y` and `-2*x*y`

Ah I didn't know / forgot that. That makes sense.

> That is technically correct on Q[x,y] (although the coefficient is strange), but not on ZZ[x,y]. For the lcm, we should probably factor out the contents, take the lcm of the primitive parts over QQ and multiply by the lcm (on Z) of the contents. 

But how does this solve the problem? E.g. let's determine the lcm of 2*x*y and 4*x*y using that technique. The contents would be 2 and 4, respectively. So we'd take `lcm(x*y, x*y)` in `Q[]`, which may be `42 * x * y`. We'd then multiply by `lcm(2, 4) = 4`, resulting in `168 * x * y`. Since `168` is not a unit in `Z`, this would still be wrong.

Did I miss something?

And do you know why Singular removed support for integer coefficients? I feel like we shouldn't have to hack around this.



---

archive/issue_comments_378671.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@timokau](#comment%3A22):\n> But how does this solve the problem? E.g. let's determine the lcm of 2*x*y and 4*x*y using that technique. The contents would be 2 and 4, respectively. So we'd take `lcm(x*y, x*y)` in `Q[]`, which may be `42 * x * y`. We'd then multiply by `lcm(2, 4) = 4`, resulting in `168 * x * y`. Since `168` is not a unit in `Z`, this would still be wrong.\n\nYes, of course you're right, this is all under the assumption that, when computing the gcd of two polynomials in QQ[] with integer coefficients and primitive, Singular will return a polynomial with the same properties. This sounds reasonable to me, but may very well not be true in all cases.\n\nAn alternative would be to simply return `self * g / self.gcd(g)`. This is an exact division so `__floordiv__` is not involved. Not sure about the computational cost though. \n\n> And do you know why Singular removed support for integer coefficients? I feel like we shouldn't have to hack around this.\n\nNo idea, the commit message doesn't say much. But I wonder if it even makes sense at all to define `__floordiv__` and `__mod__` for polynomials with integer coefficients. And if it does in some non-canonical way, the lcm (which is unambiguously well defined) shouldn't depend on it.",
    "created_at": "2018-07-24T11:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378671",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@timokau](#comment%3A22):
> But how does this solve the problem? E.g. let's determine the lcm of 2*x*y and 4*x*y using that technique. The contents would be 2 and 4, respectively. So we'd take `lcm(x*y, x*y)` in `Q[]`, which may be `42 * x * y`. We'd then multiply by `lcm(2, 4) = 4`, resulting in `168 * x * y`. Since `168` is not a unit in `Z`, this would still be wrong.

Yes, of course you're right, this is all under the assumption that, when computing the gcd of two polynomials in QQ[] with integer coefficients and primitive, Singular will return a polynomial with the same properties. This sounds reasonable to me, but may very well not be true in all cases.

An alternative would be to simply return `self * g / self.gcd(g)`. This is an exact division so `__floordiv__` is not involved. Not sure about the computational cost though. 

> And do you know why Singular removed support for integer coefficients? I feel like we shouldn't have to hack around this.

No idea, the commit message doesn't say much. But I wonder if it even makes sense at all to define `__floordiv__` and `__mod__` for polynomials with integer coefficients. And if it does in some non-canonical way, the lcm (which is unambiguously well defined) shouldn't depend on it.



---

archive/issue_comments_378672.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nOr we can compute the gcd over ZZ and *then* coerce to QQ[] to perform the division with `singclap_pdivide`. This should give the correct answer and be computationally equivalent to the current (no longer working) method.",
    "created_at": "2018-07-24T12:01:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378672",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:24" align="right">Comment 24</div>

Or we can compute the gcd over ZZ and *then* coerce to QQ[] to perform the division with `singclap_pdivide`. This should give the correct answer and be computationally equivalent to the current (no longer working) method.



---

archive/issue_comments_378673.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nI've [involved upstream](https://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=2768). They seem to be pretty responsive in that forum (and you don't actually need to register, which is a bonus).",
    "created_at": "2018-07-24T12:26:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378673",
    "user": "https://github.com/timokau"
}
```

<div id="comment:25" align="right">Comment 25</div>

I've [involved upstream](https://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=2768). They seem to be pretty responsive in that forum (and you don't actually need to register, which is a bonus).



---

archive/issue_comments_378674.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39b3230d4bc2fbd7d2a61926763793434386b057\">39b3230</a></td><td><code>Merge branch 'develop' of git://git.sagemath.org/sage into t/24735/upgrade_singular_to_4_1_1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/921cc310908e1880884af556dc9452c2b4ba8bc8\">921cc31</a></td><td><code>Fix real base ring detection</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0\">0f55b76</a></td><td><code>More real -> Float porting</code></td></tr></table>\n",
    "created_at": "2018-07-24T17:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378674",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26" align="right">Comment 26</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39b3230d4bc2fbd7d2a61926763793434386b057">39b3230</a></td><td><code>Merge branch 'develop' of git://git.sagemath.org/sage into t/24735/upgrade_singular_to_4_1_1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/921cc310908e1880884af556dc9452c2b4ba8bc8">921cc31</a></td><td><code>Fix real base ring detection</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0">0f55b76</a></td><td><code>More real -> Float porting</code></td></tr></table>




---

archive/issue_comments_378675.json:
```json
{
    "body": "Changed commit from **[ab851b1](https://github.com/sagemath/sagetrac-mirror/commit/ab851b1a2485c98b9f281e5bb5ea294e84f39040)** to **[0f55b76](https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0)**",
    "created_at": "2018-07-24T17:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378675",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ab851b1](https://github.com/sagemath/sagetrac-mirror/commit/ab851b1a2485c98b9f281e5bb5ea294e84f39040)** to **[0f55b76](https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0)**



---

archive/issue_comments_378676.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nDown to the three ntl failures\n\n```\nsage -t src/sage/libs/ntl/error.pyx  # Bad exit: 2\nsage -t src/sage/libs/ntl/ntl_ZZ_pX.pyx  # Bad exit: 2\nsage -t src/sage/matrix/matrix_integer_dense.pyx  # Bad exit: 2\n```",
    "created_at": "2018-07-24T17:18:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378676",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:27" align="right">Comment 27</div>

Down to the three ntl failures

```
sage -t src/sage/libs/ntl/error.pyx  # Bad exit: 2
sage -t src/sage/libs/ntl/ntl_ZZ_pX.pyx  # Bad exit: 2
sage -t src/sage/matrix/matrix_integer_dense.pyx  # Bad exit: 2
```



---

archive/issue_comments_378677.json:
```json
{
    "body": "Changed commit from **[0f55b76](https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0)** to **[aea0544](https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f)**",
    "created_at": "2018-07-24T17:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378677",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0f55b76](https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0)** to **[aea0544](https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f)**



---

archive/issue_comments_378678.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f\">aea0544</a></td><td><code>Don't check for exact Singular version</code></td></tr></table>\n",
    "created_at": "2018-07-24T17:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378678",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28" align="right">Comment 28</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f">aea0544</a></td><td><code>Don't check for exact Singular version</code></td></tr></table>




---

archive/issue_comments_378679.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nThe NTL issue is probably related to the NTL upgrade. Especially this line in the singular changelog is interesting:\n\n> port to NTL 10 with threads (needs also C++11: gcc6 or -std=c++11) \n\nSo we probably have to fix the C++11 issue and update NTL.",
    "created_at": "2018-07-24T19:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378679",
    "user": "https://github.com/timokau"
}
```

<div id="comment:29" align="right">Comment 29</div>

The NTL issue is probably related to the NTL upgrade. Especially this line in the singular changelog is interesting:

> port to NTL 10 with threads (needs also C++11: gcc6 or -std=c++11) 

So we probably have to fix the C++11 issue and update NTL.



---

archive/issue_comments_378680.json:
```json
{
    "body": "Dependencies: **#25532**",
    "created_at": "2018-07-24T19:07:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378680",
    "user": "https://github.com/timokau"
}
```

Dependencies: **#25532**



---

archive/issue_comments_378681.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nReplying to [@timokau](#comment%3A29):\n> The NTL issue is probably related to the NTL upgrade. Especially this line in the singular changelog is interesting:\n> \n> > port to NTL 10 with threads (needs also C++11: gcc6 or -std=c++11) \n\n> \n> So we probably have to fix the C++11 issue and update NTL.\n\nNo, this is unrelated to the NTL version (I can reproduce both on the Sage distribution with NTL 10.3 and on Arch with NTL 11.2). It is caused by\nhttps://github.com/Singular/Sources/commit/28d88317\n\nSomeone who understands the error handling code should take a look at it",
    "created_at": "2018-07-24T19:40:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378681",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:30" align="right">Comment 30</div>

Replying to [@timokau](#comment%3A29):
> The NTL issue is probably related to the NTL upgrade. Especially this line in the singular changelog is interesting:
> 
> > port to NTL 10 with threads (needs also C++11: gcc6 or -std=c++11) 

> 
> So we probably have to fix the C++11 issue and update NTL.

No, this is unrelated to the NTL version (I can reproduce both on the Sage distribution with NTL 10.3 and on Arch with NTL 11.2). It is caused by
https://github.com/Singular/Sources/commit/28d88317

Someone who understands the error handling code should take a look at it



---

archive/issue_comments_378682.json:
```json
{
    "body": "Changed dependencies from **#25532** to none",
    "created_at": "2018-07-24T19:40:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378682",
    "user": "https://github.com/antonio-rojas"
}
```

Changed dependencies from **#25532** to none



---

archive/issue_comments_378683.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\n> ErrorCallback=HALT;\n\nIf that does what it sounds like, that would explain the issue. Sounds like a bad idea to me. We should probably also discuss that with upstream.",
    "created_at": "2018-07-24T22:04:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378683",
    "user": "https://github.com/timokau"
}
```

<div id="comment:31" align="right">Comment 31</div>

> ErrorCallback=HALT;

If that does what it sounds like, that would explain the issue. Sounds like a bad idea to me. We should probably also discuss that with upstream.



---

archive/issue_comments_378684.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nUpstream: https://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=2769",
    "created_at": "2018-07-24T22:09:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378684",
    "user": "https://github.com/timokau"
}
```

<div id="comment:32" align="right">Comment 32</div>

Upstream: https://www.singular.uni-kl.de/forum/viewtopic.php?f=10&t=2769



---

archive/issue_comments_378685.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Reported upstream. No feedback yet.**",
    "created_at": "2018-07-24T22:09:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378685",
    "user": "https://github.com/timokau"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_378686.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2018-07-25T13:15:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378686",
    "user": "https://github.com/timokau"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_378687.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nUpstream has replied:\n\n- the callback issue is now fixed by moving it out of libSingular into the executable singular. I've asked the author about a new release.\n\n- the singclap_pdivide issue looks like it wasn't a regression. According to the author, integer coefficients were never properly supported. He suggests using `p_Divide` (which uses `singclap_pdivide` internally) instead. That will return the division result without rest (`0` if it isn't divisible).",
    "created_at": "2018-07-25T13:15:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378687",
    "user": "https://github.com/timokau"
}
```

<div id="comment:34" align="right">Comment 34</div>

Upstream has replied:

- the callback issue is now fixed by moving it out of libSingular into the executable singular. I've asked the author about a new release.

- the singclap_pdivide issue looks like it wasn't a regression. According to the author, integer coefficients were never properly supported. He suggests using `p_Divide` (which uses `singclap_pdivide` internally) instead. That will return the division result without rest (`0` if it isn't divisible).



---

archive/issue_comments_378688.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e52b5e3ca6bbb34666c25decbf9bab3e2b46e82\">4e52b5e</a></td><td><code>Use p_Divide for lcm as suggested by upstream</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a\">50b9ae2</a></td><td><code>Backport patch to move singular's NTL handling out of libsingular</code></td></tr></table>\n",
    "created_at": "2018-07-25T15:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378688",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35" align="right">Comment 35</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e52b5e3ca6bbb34666c25decbf9bab3e2b46e82">4e52b5e</a></td><td><code>Use p_Divide for lcm as suggested by upstream</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a">50b9ae2</a></td><td><code>Backport patch to move singular's NTL handling out of libsingular</code></td></tr></table>




---

archive/issue_comments_378689.json:
```json
{
    "body": "Changed commit from **[aea0544](https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f)** to **[50b9ae2](https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a)**",
    "created_at": "2018-07-25T15:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378689",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[aea0544](https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f)** to **[50b9ae2](https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a)**



---

archive/issue_comments_378690.json:
```json
{
    "body": "Author: **Antonio Rojas, Timo Kaufmann**",
    "created_at": "2018-07-25T16:45:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378690",
    "user": "https://github.com/antonio-rojas"
}
```

Author: **Antonio Rojas, Timo Kaufmann**



---

archive/issue_events_324381.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2018-07-25T16:45:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324381"
}
```



---

archive/issue_comments_378691.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nTests are good now.",
    "created_at": "2018-07-25T16:45:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378691",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:36" align="right">Comment 36</div>

Tests are good now.



---

archive/issue_comments_378692.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nGreat! I'm already testing this on nix. However if want to backport the patch, we need to document it in the SPKG.txt file.",
    "created_at": "2018-07-25T19:53:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378692",
    "user": "https://github.com/timokau"
}
```

<div id="comment:37" align="right">Comment 37</div>

Great! I'm already testing this on nix. However if want to backport the patch, we need to document it in the SPKG.txt file.



---

archive/issue_comments_378693.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nReplying to [@timokau](#comment%3A37):\n> Great! I'm already testing this on nix. However if want to backport the patch, we need to document it in the SPKG.txt file.\n\nIs that mandatory? I see lots of patches which aren't documented in SPKG.txt (including the ones removed in this branch) and many of those who are are outdated.",
    "created_at": "2018-07-25T20:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378693",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:38" align="right">Comment 38</div>

Replying to [@timokau](#comment%3A37):
> Great! I'm already testing this on nix. However if want to backport the patch, we need to document it in the SPKG.txt file.

Is that mandatory? I see lots of patches which aren't documented in SPKG.txt (including the ones removed in this branch) and many of those who are are outdated.



---

archive/issue_comments_378694.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nIt should be. Unfortunately that hasn't always been the case, but at least Jeroen agreed with me on that point (on some trac ticket). It is especially important for us package maintainers, at least those not directly involved with the upgrade. It is also important for future sage contributors who might otherwise just rather not touch the patch because they don't know why it was introduced.\n\nAlthough the second point is pretty much moot in this case, since the patch will no longer apply on the next singular version. Still, the first point holds and I think such guildelines work best if they are adhered to unconditionally.",
    "created_at": "2018-07-25T20:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378694",
    "user": "https://github.com/timokau"
}
```

<div id="comment:39" align="right">Comment 39</div>

It should be. Unfortunately that hasn't always been the case, but at least Jeroen agreed with me on that point (on some trac ticket). It is especially important for us package maintainers, at least those not directly involved with the upgrade. It is also important for future sage contributors who might otherwise just rather not touch the patch because they don't know why it was introduced.

Although the second point is pretty much moot in this case, since the patch will no longer apply on the next singular version. Still, the first point holds and I think such guildelines work best if they are adhered to unconditionally.



---

archive/issue_comments_378695.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nDid you run the long doctests? With the nix package I'm getting the following error:\n\n```\nFile \"/nix/store/qpb654994xa2cv2r4xwxwj7gbv5by5ki-sage-src-8.3.rc2/src/sage/schemes/elliptic_curves/padics.py\", line 876, in sage.schemes.elliptic_curves.padics.padic_height_via_multiply\nFailed example:\n    for prec in range(2, max_prec):                 # long time\n        assert E.padic_height_via_multiply(5, prec)(P) == full   # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/doctest/forker.py\", line 573, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/doctest/forker.py\", line 983, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.elliptic_curves.padics.padic_height_via_multiply[13]>\", line 2, in <module>\n        assert E.padic_height_via_multiply(Integer(5), prec)(P) == full   # long time\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py\", line 906, in padic_height_via_multiply\n        sigma = self.padic_sigma_truncated(p, N=adjusted_prec, E2=E2, lamb=lamb)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py\", line 1282, in padic_sigma_truncated\n        E2 = self.padic_E2(p, N-2, check_hypotheses=False)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py\", line 1503, in padic_E2\n        frob_p = self.matrix_of_frobenius(p, prec, check, check_hypotheses, algorithm).change_ring(Integers(p**prec))\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py\", line 1653, in matrix_of_frobenius\n        Q, p, adjusted_prec, trace)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 1658, in matrix_of_frobenius\n        F1_reduced = reduce_all(Q, p, F1_coeffs, offset)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 1024, in reduce_all\n        exact_form = reduce_negative(Q, p, coeffs, offset, exact_form)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 799, in reduce_negative\n        a[0] = base_ring(lift(a[0]) / (j+1))\n      File \"sage/structure/parent.pyx\", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9728)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4423)\n        return C._element_constructor(x)\n      File \"/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/rings/finite_rings/integer_mod_ring.py\", line 1167, in _element_constructor_\n        return integer_mod.IntegerMod(self, x)\n      File \"sage/rings/finite_rings/integer_mod.pyx\", line 197, in sage.rings.finite_rings.integer_mod.IntegerMod (build/cythonized/sage/rings/finite_rings/integer_mod.c:4554)\n        return t(parent, value)\n      File \"sage/rings/finite_rings/integer_mod.pyx\", line 361, in sage.rings.finite_rings.integer_mod.IntegerMod_abstract.__init__ (build/cythonized/sage/rings/finite_rings/integer_mod.c:5735)\n        z = value % self.__modulus.sageInteger\n      File \"sage/rings/rational.pyx\", line 2869, in sage.rings.rational.Rational.__mod__ (build/cythonized/sage/rings/rational.c:25815)\n        d = d.inverse_mod(other)\n      File \"sage/rings/integer.pyx\", line 6574, in sage.rings.integer.Integer.inverse_mod (build/cythonized/sage/rings/integer.c:41093)\n        raise ZeroDivisionError(\"Inverse does not exist.\")\n    ZeroDivisionError: Inverse does not exist.\n```\n\nThis might of course be due to packaging, I haven't tested it with sage-the-distribution. But the only thing I changed was the singular update.",
    "created_at": "2018-07-25T20:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378695",
    "user": "https://github.com/timokau"
}
```

<div id="comment:40" align="right">Comment 40</div>

Did you run the long doctests? With the nix package I'm getting the following error:

```
File "/nix/store/qpb654994xa2cv2r4xwxwj7gbv5by5ki-sage-src-8.3.rc2/src/sage/schemes/elliptic_curves/padics.py", line 876, in sage.schemes.elliptic_curves.padics.padic_height_via_multiply
Failed example:
    for prec in range(2, max_prec):                 # long time
        assert E.padic_height_via_multiply(5, prec)(P) == full   # long time
Exception raised:
    Traceback (most recent call last):
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/doctest/forker.py", line 573, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/doctest/forker.py", line 983, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.elliptic_curves.padics.padic_height_via_multiply[13]>", line 2, in <module>
        assert E.padic_height_via_multiply(Integer(5), prec)(P) == full   # long time
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py", line 906, in padic_height_via_multiply
        sigma = self.padic_sigma_truncated(p, N=adjusted_prec, E2=E2, lamb=lamb)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py", line 1282, in padic_sigma_truncated
        E2 = self.padic_E2(p, N-2, check_hypotheses=False)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py", line 1503, in padic_E2
        frob_p = self.matrix_of_frobenius(p, prec, check, check_hypotheses, algorithm).change_ring(Integers(p**prec))
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py", line 1653, in matrix_of_frobenius
        Q, p, adjusted_prec, trace)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 1658, in matrix_of_frobenius
        F1_reduced = reduce_all(Q, p, F1_coeffs, offset)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 1024, in reduce_all
        exact_form = reduce_negative(Q, p, coeffs, offset, exact_form)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 799, in reduce_negative
        a[0] = base_ring(lift(a[0]) / (j+1))
      File "sage/structure/parent.pyx", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9728)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)
        raise
      File "sage/structure/coerce_maps.pyx", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4423)
        return C._element_constructor(x)
      File "/nix/store/4r6y3kcvb6l54krs7ajyf9kyns8mlwad-python-2.7.15-env/lib/python2.7/site-packages/sage/rings/finite_rings/integer_mod_ring.py", line 1167, in _element_constructor_
        return integer_mod.IntegerMod(self, x)
      File "sage/rings/finite_rings/integer_mod.pyx", line 197, in sage.rings.finite_rings.integer_mod.IntegerMod (build/cythonized/sage/rings/finite_rings/integer_mod.c:4554)
        return t(parent, value)
      File "sage/rings/finite_rings/integer_mod.pyx", line 361, in sage.rings.finite_rings.integer_mod.IntegerMod_abstract.__init__ (build/cythonized/sage/rings/finite_rings/integer_mod.c:5735)
        z = value % self.__modulus.sageInteger
      File "sage/rings/rational.pyx", line 2869, in sage.rings.rational.Rational.__mod__ (build/cythonized/sage/rings/rational.c:25815)
        d = d.inverse_mod(other)
      File "sage/rings/integer.pyx", line 6574, in sage.rings.integer.Integer.inverse_mod (build/cythonized/sage/rings/integer.c:41093)
        raise ZeroDivisionError("Inverse does not exist.")
    ZeroDivisionError: Inverse does not exist.
```

This might of course be due to packaging, I haven't tested it with sage-the-distribution. But the only thing I changed was the singular update.



---

archive/issue_events_324382.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-25T20:36:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324382"
}
```



---

archive/issue_events_324383.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-25T20:36:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324383"
}
```



---

archive/issue_comments_378696.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@timokau](#comment%3A40):\n> Did you run the long doctests? With the nix package I'm getting the following error:\n> \n\nWorks for me, both on the Sage distribution and on the Arch package.",
    "created_at": "2018-07-25T20:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378696",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@timokau](#comment%3A40):
> Did you run the long doctests? With the nix package I'm getting the following error:
> 

Works for me, both on the Sage distribution and on the Arch package.



---

archive/issue_comments_378697.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nI cannot reproduce the failure when doctesting only that one file. My system was under load at the time. Maybe its an unrelated transient issue (which would arguably be worse).\n\nIf you don't want to do it, I'll add the patch documentation tomorrow.",
    "created_at": "2018-07-25T20:42:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378697",
    "user": "https://github.com/timokau"
}
```

<div id="comment:43" align="right">Comment 43</div>

I cannot reproduce the failure when doctesting only that one file. My system was under load at the time. Maybe its an unrelated transient issue (which would arguably be worse).

If you don't want to do it, I'll add the patch documentation tomorrow.



---

archive/issue_comments_378698.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b56ef2d85a79801916e7a8e831cb4a0f4997c74\">7b56ef2</a></td><td><code>Document patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be\">930ba2e</a></td><td><code>Remove duplicate cimport</code></td></tr></table>\n",
    "created_at": "2018-07-25T20:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378698",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44" align="right">Comment 44</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b56ef2d85a79801916e7a8e831cb4a0f4997c74">7b56ef2</a></td><td><code>Document patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be">930ba2e</a></td><td><code>Remove duplicate cimport</code></td></tr></table>




---

archive/issue_comments_378699.json:
```json
{
    "body": "Changed commit from **[50b9ae2](https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a)** to **[930ba2e](https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be)**",
    "created_at": "2018-07-25T20:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378699",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[50b9ae2](https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a)** to **[930ba2e](https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be)**



---

archive/issue_events_324384.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2018-07-25T20:46:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324384"
}
```



---

archive/issue_events_324385.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2018-07-25T20:46:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324385"
}
```



---

archive/issue_comments_378700.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nPerfect, thank you :)\n\nFor what it's worth: looks good to me.",
    "created_at": "2018-07-25T20:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378700",
    "user": "https://github.com/timokau"
}
```

<div id="comment:46" align="right">Comment 46</div>

Perfect, thank you :)

For what it's worth: looks good to me.



---

archive/issue_events_324386.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-25T22:28:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324386"
}
```



---

archive/issue_events_324387.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-25T22:28:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324387"
}
```



---

archive/issue_comments_378701.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nWhat does\n\n```\n(see forum: \"NTL error handling\", for SAGE)\n```\nmean in the patch? You'll have to be more clear than that.",
    "created_at": "2018-07-25T22:28:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378701",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">Comment 47</div>

What does

```
(see forum: "NTL error handling", for SAGE)
```
mean in the patch? You'll have to be more clear than that.



---

archive/issue_comments_378702.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nReplying to [@jdemeyer](#comment%3A47):\n> What does\n> \n> ```\n> (see forum: \"NTL error handling\", for SAGE)\n> ```\n> mean in the patch? You'll have to be more clear than that.\n\nThis is the literal upstream commit message",
    "created_at": "2018-07-25T22:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378702",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:48" align="right">Comment 48</div>

Replying to [@jdemeyer](#comment%3A47):
> What does
> 
> ```
> (see forum: "NTL error handling", for SAGE)
> ```
> mean in the patch? You'll have to be more clear than that.

This is the literal upstream commit message



---

archive/issue_comments_378703.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nOK maybe but you at least for some link or explanation in the patch (and remove the explanation of the patch in `SPKG.txt`).",
    "created_at": "2018-07-25T22:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378703",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">Comment 49</div>

OK maybe but you at least for some link or explanation in the patch (and remove the explanation of the patch in `SPKG.txt`).



---

archive/issue_comments_378704.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nReplying to [@timokau](#comment%3A39):\n> It should be. Unfortunately that hasn't always been the case, but at least Jeroen agreed with me on that point (on some trac ticket). It is especially important for us package maintainers, at least those not directly involved with the upgrade. It is also important for future sage contributors who might otherwise just rather not touch the patch because they don't know why it was introduced.\n\nReplying to [@jdemeyer](#comment%3A49):\n> OK maybe but you at least for some link or explanation in the patch (and remove the explanation of the patch in `SPKG.txt`).\n\nIm getting contradictory instructions here... should I or shouldn't I document patches in SPKG.txt?",
    "created_at": "2018-07-26T08:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378704",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:50" align="right">Comment 50</div>

Replying to [@timokau](#comment%3A39):
> It should be. Unfortunately that hasn't always been the case, but at least Jeroen agreed with me on that point (on some trac ticket). It is especially important for us package maintainers, at least those not directly involved with the upgrade. It is also important for future sage contributors who might otherwise just rather not touch the patch because they don't know why it was introduced.

Replying to [@jdemeyer](#comment%3A49):
> OK maybe but you at least for some link or explanation in the patch (and remove the explanation of the patch in `SPKG.txt`).

Im getting contradictory instructions here... should I or shouldn't I document patches in SPKG.txt?



---

archive/issue_comments_378705.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\ndocumenting patches in patches themselves is better.\n\nas well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.",
    "created_at": "2018-07-26T09:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378705",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">Comment 51</div>

documenting patches in patches themselves is better.

as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.



---

archive/issue_comments_378706.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nReplying to [@antonio-rojas](#comment%3A50):\n> should I or shouldn't I document patches in SPKG.txt?\n\nDo not document it in `SPKG.txt`, but document it in the `.patch` file itself. And please include links to upstream (if applicable) and to this ticket.",
    "created_at": "2018-07-26T09:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378706",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">Comment 52</div>

Replying to [@antonio-rojas](#comment%3A50):
> should I or shouldn't I document patches in SPKG.txt?

Do not document it in `SPKG.txt`, but document it in the `.patch` file itself. And please include links to upstream (if applicable) and to this ticket.



---

archive/issue_comments_378707.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nRunning `make ptestlong` now...",
    "created_at": "2018-07-26T09:26:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378707",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">Comment 53</div>

Running `make ptestlong` now...



---

archive/issue_comments_378708.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\n`rest` -> `remainder`",
    "created_at": "2018-07-26T09:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378708",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:54" align="right">Comment 54</div>

`rest` -> `remainder`



---

archive/issue_comments_378709.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nReplying to [@jdemeyer](#comment%3A47):\n> What does\n> \n> ```\n> (see forum: \"NTL error handling\", for SAGE)\n> ```\n> mean in the patch? You'll have to be more clear than that.\n\nThat is the upstream commit message, referencing my forum post [here](https://www.singular.uni-kl.de/forum/viewtopic.php?t=2769)..\n\nReplying to [@antonio-rojas](#comment%3A50):\n> Im getting contradictory instructions here... should I or shouldn't I document patches in SPKG.txt?\n\nI'm happy with both versions as long as it's documented. Of course there is value in locality.\n\nReplying to [@dimpase](#comment%3A51):\n> documenting patches in patches themselves is better.\n> \n> as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.\n\nI think the patch is re-based. What git facility are you talking about? I usually just redirect `git show` into a file.",
    "created_at": "2018-07-26T12:20:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378709",
    "user": "https://github.com/timokau"
}
```

<div id="comment:55" align="right">Comment 55</div>

Replying to [@jdemeyer](#comment%3A47):
> What does
> 
> ```
> (see forum: "NTL error handling", for SAGE)
> ```
> mean in the patch? You'll have to be more clear than that.

That is the upstream commit message, referencing my forum post [here](https://www.singular.uni-kl.de/forum/viewtopic.php?t=2769)..

Replying to [@antonio-rojas](#comment%3A50):
> Im getting contradictory instructions here... should I or shouldn't I document patches in SPKG.txt?

I'm happy with both versions as long as it's documented. Of course there is value in locality.

Replying to [@dimpase](#comment%3A51):
> documenting patches in patches themselves is better.
> 
> as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.

I think the patch is re-based. What git facility are you talking about? I usually just redirect `git show` into a file.



---

archive/issue_comments_378710.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f31d9da8861773c554079ee2a66922a40156a9a5\">f31d9da</a></td><td><code>Move patch documentation inside patch itself</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb\">07ef11b</a></td><td><code>rest -> reminder</code></td></tr></table>\n",
    "created_at": "2018-07-26T13:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378710",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:56" align="right">Comment 56</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f31d9da8861773c554079ee2a66922a40156a9a5">f31d9da</a></td><td><code>Move patch documentation inside patch itself</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb">07ef11b</a></td><td><code>rest -> reminder</code></td></tr></table>




---

archive/issue_comments_378711.json:
```json
{
    "body": "Changed commit from **[930ba2e](https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be)** to **[07ef11b](https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb)**",
    "created_at": "2018-07-26T13:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378711",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[930ba2e](https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be)** to **[07ef11b](https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb)**



---

archive/issue_events_324388.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2018-07-26T13:29:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324388"
}
```



---

archive/issue_events_324389.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2018-07-26T13:29:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324389"
}
```



---

archive/issue_comments_378712.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nReplying to [@jdemeyer](#comment%3A54):\n> `rest` -> `remainder`\n\nFixed (this was taken verbatim from Singular's header)\n\nReplying to [@timokau](#comment%3A55):\n> > as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.\n\n> \n> I think the patch is re-based. What git facility are you talking about? I usually just redirect `git show` into a file.\n\nIndeed the patch doesn't apply cleanly on top of 4.1.1.p2 and required rebasing.",
    "created_at": "2018-07-26T13:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378712",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:57" align="right">Comment 57</div>

Replying to [@jdemeyer](#comment%3A54):
> `rest` -> `remainder`

Fixed (this was taken verbatim from Singular's header)

Replying to [@timokau](#comment%3A55):
> > as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.

> 
> I think the patch is re-based. What git facility are you talking about? I usually just redirect `git show` into a file.

Indeed the patch doesn't apply cleanly on top of 4.1.1.p2 and required rebasing.



---

archive/issue_comments_378713.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nReplying to [@antonio-rojas](#comment%3A57):\n> Replying to [@jdemeyer](#comment%3A54):\n> > `rest` -> `remainder`\n\n> \n> Fixed (this was taken verbatim from Singular's header)\n\nThat's German: https://de.wikipedia.org/wiki/Division_mit_Rest",
    "created_at": "2018-07-26T13:50:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378713",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">Comment 58</div>

Replying to [@antonio-rojas](#comment%3A57):
> Replying to [@jdemeyer](#comment%3A54):
> > `rest` -> `remainder`

> 
> Fixed (this was taken verbatim from Singular's header)

That's German: https://de.wikipedia.org/wiki/Division_mit_Rest



---

archive/issue_comments_378714.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nReplying to [@timokau](#comment%3A55):\n \n> Replying to [@dimpase](#comment%3A51):\n> > documenting patches in patches themselves is better.\n> > \n> > as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.\n\n> \n> I think the patch is re-based. What git facility are you talking about? I usually just redirect `git show` into a file.\n\nsee\nhttps://trac.sagemath.org/ticket/21781",
    "created_at": "2018-07-26T14:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378714",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:59" align="right">Comment 59</div>

Replying to [@timokau](#comment%3A55):
 
> Replying to [@dimpase](#comment%3A51):
> > documenting patches in patches themselves is better.
> > 
> > as well, if a patch is lifted off upstream git repo, it is best to use git's facility to wrap the patch accordingly.

> 
> I think the patch is re-based. What git facility are you talking about? I usually just redirect `git show` into a file.

see
https://trac.sagemath.org/ticket/21781



---

archive/issue_comments_378715.json:
```json
{
    "body": "Changed branch from **[u/arojas/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_1_1)** to **[u/jdemeyer/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_singular_to_4_1_1)**",
    "created_at": "2018-07-28T15:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378715",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/arojas/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_1_1)** to **[u/jdemeyer/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_singular_to_4_1_1)**



---

archive/issue_comments_378716.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nI made a few fixes to improve style and optimization. I also put back the `p * q // q == p` doctests which were removed (why?).\n\nSo you can set positive review if you agree with my last commit.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513\">a9e5aed</a></td><td><code>Minor fixes to Singular interface</code></td></tr></table>\n",
    "created_at": "2018-07-28T15:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378716",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:61" align="right">Comment 61</div>

I made a few fixes to improve style and optimization. I also put back the `p * q // q == p` doctests which were removed (why?).

So you can set positive review if you agree with my last commit.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513">a9e5aed</a></td><td><code>Minor fixes to Singular interface</code></td></tr></table>




---

archive/issue_comments_378717.json:
```json
{
    "body": "Changed commit from **[07ef11b](https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb)** to **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)**",
    "created_at": "2018-07-28T15:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378717",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[07ef11b](https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb)** to **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)**



---

archive/issue_comments_378718.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2018-07-28T15:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378718",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_378719.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nUpstream [said on Thursday](https://www.singular.uni-kl.de/forum/viewtopic.php?t=2769)\n\n> Singular 4.1.1p3 will appear within the next week\n\n\nAlso I'm still getting that one test failure I reported above. Only when running the whole testsuite (not when testing that file individually). I'll see if I can find the root cause of that.",
    "created_at": "2018-07-29T16:37:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378719",
    "user": "https://github.com/timokau"
}
```

<div id="comment:62" align="right">Comment 62</div>

Upstream [said on Thursday](https://www.singular.uni-kl.de/forum/viewtopic.php?t=2769)

> Singular 4.1.1p3 will appear within the next week


Also I'm still getting that one test failure I reported above. Only when running the whole testsuite (not when testing that file individually). I'll see if I can find the root cause of that.



---

archive/issue_comments_378720.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\n> > Singular 4.1.1p3 will appear within the next week\n\nI wouldn't wait for that, this ticket is essentially ready to go.\n\n> Also I'm still getting that one test failure I reported above. I'll see if I can find the root cause of that.\n\nDo you mean [comment:40]? That seems unrelated to this ticket, see #25969. That being said, if you can deterministically reproduce that failure, that would be really awesome since I don't know how to reproduce it. Please follow up at #25969.",
    "created_at": "2018-07-29T18:50:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378720",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">Comment 63</div>

> > Singular 4.1.1p3 will appear within the next week

I wouldn't wait for that, this ticket is essentially ready to go.

> Also I'm still getting that one test failure I reported above. I'll see if I can find the root cause of that.

Do you mean [comment:40]? That seems unrelated to this ticket, see #25969. That being said, if you can deterministically reproduce that failure, that would be really awesome since I don't know how to reproduce it. Please follow up at #25969.



---

archive/issue_comments_378721.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nReplying to [@jdemeyer](#comment%3A63):\n> > > Singular 4.1.1p3 will appear within the next week\n\n> \n> I wouldn't wait for that, this ticket is essentially ready to go.\n\nThat would avoid having to patch singular. In this case its a bit of a special case since singular already needs special attention anyways, so I'm not very invested.\n\nBut since we can't merge this before 8.3 anyways, maybe it'll sort itself out.\n\n> > Also I'm still getting that one test failure I reported above. I'll see if I can find the root cause of that.\n\n> \n> Do you mean [comment:40]? That seems unrelated to this ticket, see #25969. That being said, if you can deterministically reproduce that failure, that would be really awesome since I don't know how to reproduce it. Please follow up at #25969.\n\nDid that.",
    "created_at": "2018-07-29T20:02:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378721",
    "user": "https://github.com/timokau"
}
```

<div id="comment:64" align="right">Comment 64</div>

Replying to [@jdemeyer](#comment%3A63):
> > > Singular 4.1.1p3 will appear within the next week

> 
> I wouldn't wait for that, this ticket is essentially ready to go.

That would avoid having to patch singular. In this case its a bit of a special case since singular already needs special attention anyways, so I'm not very invested.

But since we can't merge this before 8.3 anyways, maybe it'll sort itself out.

> > Also I'm still getting that one test failure I reported above. I'll see if I can find the root cause of that.

> 
> Do you mean [comment:40]? That seems unrelated to this ticket, see #25969. That being said, if you can deterministically reproduce that failure, that would be really awesome since I don't know how to reproduce it. Please follow up at #25969.

Did that.



---

archive/issue_comments_378722.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nReplying to [@timokau](#comment%3A64):\n> That would avoid having to patch singular.\n\nWe are already patching Singular, so that argument is meaningless.",
    "created_at": "2018-07-29T22:03:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378722",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:65" align="right">Comment 65</div>

Replying to [@timokau](#comment%3A64):
> That would avoid having to patch singular.

We are already patching Singular, so that argument is meaningless.



---

archive/issue_comments_378723.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nReplying to [@jdemeyer](#comment%3A65):\n> Replying to [@timokau](#comment%3A64):\n> > That would avoid having to patch singular.\n\n> \n> We are already patching Singular, so that argument is meaningless.\n\nNot anymore after the new singular release. And just because its not perfect doesn't mean we have to make it worse.",
    "created_at": "2018-07-30T11:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378723",
    "user": "https://github.com/timokau"
}
```

<div id="comment:66" align="right">Comment 66</div>

Replying to [@jdemeyer](#comment%3A65):
> Replying to [@timokau](#comment%3A64):
> > That would avoid having to patch singular.

> 
> We are already patching Singular, so that argument is meaningless.

Not anymore after the new singular release. And just because its not perfect doesn't mean we have to make it worse.



---

archive/issue_comments_378724.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">Comment 67</div>\n\nReplying to [@timokau](#comment%3A66):\n> Not anymore after the new singular release.\n\nOf course, but how is that relevant to this ticket? In case it wasn't clear: I agree to upgrade to 4.1.1p3 eventually. The question is not whether we should upgrade to 4.1.1p3, but whether we should upgrade to 4.1.1p2 first. Given that the work is already done, I would argue that we should do that.",
    "created_at": "2018-07-30T13:29:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378724",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:67" align="right">Comment 67</div>

Replying to [@timokau](#comment%3A66):
> Not anymore after the new singular release.

Of course, but how is that relevant to this ticket? In case it wasn't clear: I agree to upgrade to 4.1.1p3 eventually. The question is not whether we should upgrade to 4.1.1p3, but whether we should upgrade to 4.1.1p2 first. Given that the work is already done, I would argue that we should do that.



---

archive/issue_comments_378725.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">Comment 68</div>\n\nEspecially given the fact that 4.1.1p3 is not released yet, I see no reason to wait.",
    "created_at": "2018-07-30T13:31:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378725",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:68" align="right">Comment 68</div>

Especially given the fact that 4.1.1p3 is not released yet, I see no reason to wait.



---

archive/issue_comments_378726.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">Comment 69</div>\n\nReplying to [@timokau](#comment%3A66):\n> And just because its not perfect doesn't mean we have to make it worse.\n\nI don't understand you here: how is this ticket (as it is right now) making anything worse?",
    "created_at": "2018-07-30T13:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378726",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:69" align="right">Comment 69</div>

Replying to [@timokau](#comment%3A66):
> And just because its not perfect doesn't mean we have to make it worse.

I don't understand you here: how is this ticket (as it is right now) making anything worse?



---

archive/issue_comments_378727.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">Comment 70</div>\n\nReplying to [@jdemeyer](#comment%3A67):\n> Replying to [@timokau](#comment%3A66):\n> > Not anymore after the new singular release.\n\n> \n> Of course, but how is that relevant to this ticket? In case it wasn't clear: I agree to upgrade to 4.1.1p3 eventually. The question is not whether we should upgrade to 4.1.1p3, but whether we should upgrade to 4.1.1p2 first. Given that the work is already done, I would argue that we should do that.\n\nI'm arguing mostly on principle: I still think the principle should be to only apply patches very conservatively. If we need a feature or a fix, we should\n\n1) report upstream\n\n2) ask upstream for a release containing that fix/feature\n\n3) if the fix/feature isn't essential, default to waiting for that upstream release. Maybe work around the issue feature within sage until then if possible.\n\nOf course this doesn't 100% apply to this case, since this actually removes patches from singular and the update isn't possible without this. Again, I'm not strongly opposed and mostly arguing on principle.\n\n\nReplying to [@jdemeyer](#comment%3A68):\n> Especially given the fact that 4.1.1p3 is not released yet, I see no reason to wait.\n\nI see no reason to hurry either.\n\n\nReplying to [@jdemeyer](#comment%3A69):\n> Replying to [@timokau](#comment%3A66):\n> > And just because its not perfect doesn't mean we have to make it worse.\n\n> \n> I don't understand you here: how is this ticket (as it is right now) making anything worse?\n\nNo it's definitely making things better, I worded that poorly. But first updating to p2 and then to p3 puts additional load on the package maintainers. I'm assuming that package maintainers have until now pinned their singular dependency to an older version (although I think only gentoo and nix do that). Then after updating to p2, the mainteinrs will have to remove the version pin and apply the patch to singular. After p3 they'll have to remove the singular patch again. If we just update to p3 directly, action will only be required once.\n\nThat assumes that p2 and p3 would land in different (pre-) releases of sage. That's unlikely so the entire argument is pretty theoretical. Also since I was involved here I already applied the patch for nix anyways.",
    "created_at": "2018-07-30T18:08:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378727",
    "user": "https://github.com/timokau"
}
```

<div id="comment:70" align="right">Comment 70</div>

Replying to [@jdemeyer](#comment%3A67):
> Replying to [@timokau](#comment%3A66):
> > Not anymore after the new singular release.

> 
> Of course, but how is that relevant to this ticket? In case it wasn't clear: I agree to upgrade to 4.1.1p3 eventually. The question is not whether we should upgrade to 4.1.1p3, but whether we should upgrade to 4.1.1p2 first. Given that the work is already done, I would argue that we should do that.

I'm arguing mostly on principle: I still think the principle should be to only apply patches very conservatively. If we need a feature or a fix, we should

1) report upstream

2) ask upstream for a release containing that fix/feature

3) if the fix/feature isn't essential, default to waiting for that upstream release. Maybe work around the issue feature within sage until then if possible.

Of course this doesn't 100% apply to this case, since this actually removes patches from singular and the update isn't possible without this. Again, I'm not strongly opposed and mostly arguing on principle.


Replying to [@jdemeyer](#comment%3A68):
> Especially given the fact that 4.1.1p3 is not released yet, I see no reason to wait.

I see no reason to hurry either.


Replying to [@jdemeyer](#comment%3A69):
> Replying to [@timokau](#comment%3A66):
> > And just because its not perfect doesn't mean we have to make it worse.

> 
> I don't understand you here: how is this ticket (as it is right now) making anything worse?

No it's definitely making things better, I worded that poorly. But first updating to p2 and then to p3 puts additional load on the package maintainers. I'm assuming that package maintainers have until now pinned their singular dependency to an older version (although I think only gentoo and nix do that). Then after updating to p2, the mainteinrs will have to remove the version pin and apply the patch to singular. After p3 they'll have to remove the singular patch again. If we just update to p3 directly, action will only be required once.

That assumes that p2 and p3 would land in different (pre-) releases of sage. That's unlikely so the entire argument is pretty theoretical. Also since I was involved here I already applied the patch for nix anyways.



---

archive/issue_comments_378728.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">Comment 71</div>\n\np3 has been released: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p3.tar.gz",
    "created_at": "2018-07-31T19:37:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378728",
    "user": "https://github.com/timokau"
}
```

<div id="comment:71" align="right">Comment 71</div>

p3 has been released: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p3.tar.gz



---

archive/issue_comments_378729.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">Comment 72</div>\n\nOK, I'm having a look at the upgrade.",
    "created_at": "2018-08-01T09:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378729",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:72" align="right">Comment 72</div>

OK, I'm having a look at the upgrade.



---

archive/issue_comments_378730.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">Comment 73</div>\n\nThe upgrade is breaking because of https://www.singular.uni-kl.de:8005/trac/ticket/834\n\nSo I would still upgrade to 4.1.1p2 for now and let upstream handle that bug.",
    "created_at": "2018-08-01T11:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378730",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:73" align="right">Comment 73</div>

The upgrade is breaking because of https://www.singular.uni-kl.de:8005/trac/ticket/834

So I would still upgrade to 4.1.1p2 for now and let upstream handle that bug.



---

archive/issue_comments_378731.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">Comment 74</div>\n\nWell upstream fixed that quick, but that still means we would have an upstream patch.",
    "created_at": "2018-08-01T22:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378731",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:74" align="right">Comment 74</div>

Well upstream fixed that quick, but that still means we would have an upstream patch.



---

archive/issue_comments_378732.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">Comment 75</div>\n\nThat's fine by me. Judging by past release dates, its unlikely we'll get a quick new patch release with a fix. And this ticket is a great improvement over the status quo.\n\nThanks for updating and reporting the bug.",
    "created_at": "2018-08-02T18:40:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378732",
    "user": "https://github.com/timokau"
}
```

<div id="comment:75" align="right">Comment 75</div>

That's fine by me. Judging by past release dates, its unlikely we'll get a quick new patch release with a fix. And this ticket is a great improvement over the status quo.

Thanks for updating and reporting the bug.



---

archive/issue_comments_378733.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">Comment 76</div>\n\nLet me just try to apply that patch. If it's the only issue, we might as well upgrade to 4.1.1p3 with that patch.",
    "created_at": "2018-08-03T07:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378733",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:76" align="right">Comment 76</div>

Let me just try to apply that patch. If it's the only issue, we might as well upgrade to 4.1.1p3 with that patch.



---

archive/issue_events_324390.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-08-03T07:30:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324390"
}
```



---

archive/issue_events_324391.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-08-03T07:30:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324391"
}
```



---

archive/issue_comments_378734.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">Comment 78</div>\n\n4.1.1p3 is also breaking `p_group_cohomology` optional tests.\n\nI still suggest to upgrade to 4.1.1p2. I already created a new ticket for later Singular upgrades: #25993",
    "created_at": "2018-08-03T10:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378734",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:78" align="right">Comment 78</div>

4.1.1p3 is also breaking `p_group_cohomology` optional tests.

I still suggest to upgrade to 4.1.1p2. I already created a new ticket for later Singular upgrades: #25993



---

archive/issue_events_324392.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-08-03T10:25:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324392"
}
```



---

archive/issue_events_324393.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-08-03T10:25:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324393"
}
```



---

archive/issue_comments_378735.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">Comment 79</div>\n\nI opened an issue on the Singular Trac about their versioning scheme: https://www.singular.uni-kl.de:8005/trac/ticket/836",
    "created_at": "2018-08-03T12:03:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378735",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:79" align="right">Comment 79</div>

I opened an issue on the Singular Trac about their versioning scheme: https://www.singular.uni-kl.de:8005/trac/ticket/836



---

archive/issue_events_324394.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:59:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324394"
}
```



---

archive/issue_events_324395.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324395"
}
```



---

archive/issue_comments_378736.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Volker Braun**",
    "created_at": "2018-08-05T08:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378736",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Volker Braun**



---

archive/issue_events_324396.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-06T15:13:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324396"
}
```



---

archive/issue_events_324397.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-06T15:13:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324397"
}
```



---

archive/issue_comments_378737.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_singular_to_4_1_1)** to **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)**",
    "created_at": "2018-08-06T15:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378737",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/upgrade_singular_to_4_1_1](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_singular_to_4_1_1)** to **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)**



---

archive/issue_comments_378738.json:
```json
{
    "body": "Changed commit from **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)** to none",
    "created_at": "2018-08-06T20:57:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378738",
    "user": "https://github.com/slel"
}
```

Changed commit from **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)** to none



---

archive/issue_comments_378739.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,4 @@\n The tarball:\n http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p2.tar.gz\n \n+Follow-up ticket for the upgrade to Singular 4.1.1p3: #25993.\n``````\n",
    "created_at": "2018-08-06T20:57:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378739",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,4 @@
 The tarball:
 http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-1/singular-4.1.1p2.tar.gz
 
+Follow-up ticket for the upgrade to Singular 4.1.1p3: #25993.
``````




---

archive/issue_comments_378740.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">Comment 83</div>\n\nI noted a regression at #26023, though I might still unmerge this ticket...",
    "created_at": "2018-08-07T23:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378740",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:83" align="right">Comment 83</div>

I noted a regression at #26023, though I might still unmerge this ticket...



---

archive/issue_comments_378741.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">Comment 84</div>\n\nReplying to [@vbraun](#comment%3A83):\n> though I might still unmerge this ticket...\n\nWhat are you unsure about? Either you consider #26023 serious enough to warrant unmerging this ticket, or you don't.",
    "created_at": "2018-08-08T08:06:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378741",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:84" align="right">Comment 84</div>

Replying to [@vbraun](#comment%3A83):
> though I might still unmerge this ticket...

What are you unsure about? Either you consider #26023 serious enough to warrant unmerging this ticket, or you don't.



---

archive/issue_comments_378742.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">Comment 86</div>\n\nI'm assuming that you reopened this because of #26023.",
    "created_at": "2018-08-11T11:44:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378742",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:86" align="right">Comment 86</div>

I'm assuming that you reopened this because of #26023.



---

archive/issue_comments_378743.json:
```json
{
    "body": "Changed branch from **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)** to **[u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513)**",
    "created_at": "2018-08-11T12:56:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378743",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[a9e5aed](https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513)** to **[u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513)**



---

archive/issue_comments_378744.json:
```json
{
    "body": "Commit: **[45ff371](https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c)**",
    "created_at": "2018-08-11T13:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378744",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[45ff371](https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c)**



---

archive/issue_comments_378745.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">Comment 88</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0\">0f55b76</a></td><td><code>More real -> Float porting</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f\">aea0544</a></td><td><code>Don't check for exact Singular version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e52b5e3ca6bbb34666c25decbf9bab3e2b46e82\">4e52b5e</a></td><td><code>Use p_Divide for lcm as suggested by upstream</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a\">50b9ae2</a></td><td><code>Backport patch to move singular's NTL handling out of libsingular</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b56ef2d85a79801916e7a8e831cb4a0f4997c74\">7b56ef2</a></td><td><code>Document patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be\">930ba2e</a></td><td><code>Remove duplicate cimport</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f31d9da8861773c554079ee2a66922a40156a9a5\">f31d9da</a></td><td><code>Move patch documentation inside patch itself</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb\">07ef11b</a></td><td><code>rest -> reminder</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513\">a9e5aed</a></td><td><code>Minor fixes to Singular interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c\">45ff371</a></td><td><code>Fix debug build of Singular</code></td></tr></table>\n",
    "created_at": "2018-08-11T13:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378745",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:88" align="right">Comment 88</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f55b763c775bb0d652b53d50dc26f11e9f472a0">0f55b76</a></td><td><code>More real -> Float porting</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aea054407a41a517070eb06e8efcd02d6356269f">aea0544</a></td><td><code>Don't check for exact Singular version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e52b5e3ca6bbb34666c25decbf9bab3e2b46e82">4e52b5e</a></td><td><code>Use p_Divide for lcm as suggested by upstream</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50b9ae2fd233c30860e1cbb3e63a26f2cc10560a">50b9ae2</a></td><td><code>Backport patch to move singular's NTL handling out of libsingular</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b56ef2d85a79801916e7a8e831cb4a0f4997c74">7b56ef2</a></td><td><code>Document patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/930ba2eb1cacaf4e1e43733feb560dd105d531be">930ba2e</a></td><td><code>Remove duplicate cimport</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f31d9da8861773c554079ee2a66922a40156a9a5">f31d9da</a></td><td><code>Move patch documentation inside patch itself</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07ef11b3209f498dc771bf5cb02f1b3ce1264cbb">07ef11b</a></td><td><code>rest -> reminder</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9e5aed9215175f8cf49327c790ae153648a2513">a9e5aed</a></td><td><code>Minor fixes to Singular interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c">45ff371</a></td><td><code>Fix debug build of Singular</code></td></tr></table>




---

archive/issue_events_324398.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-08-11T13:54:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324398"
}
```



---

archive/issue_events_324399.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-11T16:55:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324399"
}
```



---

archive/issue_events_324400.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-11T16:55:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324400"
}
```



---

archive/issue_comments_378746.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">Comment 89</div>\n\nThanks!",
    "created_at": "2018-08-11T16:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378746",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:89" align="right">Comment 89</div>

Thanks!



---

archive/issue_comments_378747.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">Comment 90</div>\n\nReplying to [@timokau](#comment%3A11):\n> With my limited knowledge of the topic and based on `git log`, it seems like we basically have to revert #25313.\n> \n> Mark, do you have more information about that? The issue explained [here](#comment%3A7).\n\nThanks for the notice, and sorry for having taken so long to react.\n\nUnfortunately, I know very, very little about Singular. But I saw that, in `lcm()`, Antonio replaced the call to `singclap_pdivide()` to one to `p_Divide()`. This seems to be a new Singular function that does support polynomials over\u00a0\u2124. Wouldn't it be possible to use it in `__floordiv__()` too (on a new ticket, of course)?",
    "created_at": "2018-08-15T10:46:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378747",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:90" align="right">Comment 90</div>

Replying to [@timokau](#comment%3A11):
> With my limited knowledge of the topic and based on `git log`, it seems like we basically have to revert #25313.
> 
> Mark, do you have more information about that? The issue explained [here](#comment%3A7).

Thanks for the notice, and sorry for having taken so long to react.

Unfortunately, I know very, very little about Singular. But I saw that, in `lcm()`, Antonio replaced the call to `singclap_pdivide()` to one to `p_Divide()`. This seems to be a new Singular function that does support polynomials over ℤ. Wouldn't it be possible to use it in `__floordiv__()` too (on a new ticket, of course)?



---

archive/issue_comments_378748.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">Comment 91</div>\n\nIt may be, I don't recall the details of how it is used in that function. I don't think the `p_Divide` function is new, we just didn't use it in sage before.",
    "created_at": "2018-08-15T11:24:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378748",
    "user": "https://github.com/timokau"
}
```

<div id="comment:91" align="right">Comment 91</div>

It may be, I don't recall the details of how it is used in that function. I don't think the `p_Divide` function is new, we just didn't use it in sage before.



---

archive/issue_comments_378749.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">Comment 92</div>\n\nReplying to [@timokau](#comment%3A91):\n> It may be, I don't recall the details of how it is used in that function. I don't think the `p_Divide` function is new, we just didn't use it in sage before.\n\nThanks! It seems to work, though the resulting code is slower than before this ticket. See #26067.",
    "created_at": "2018-08-15T16:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378749",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:92" align="right">Comment 92</div>

Replying to [@timokau](#comment%3A91):
> It may be, I don't recall the details of how it is used in that function. I don't think the `p_Divide` function is new, we just didn't use it in sage before.

Thanks! It seems to work, though the resulting code is slower than before this ticket. See #26067.



---

archive/issue_events_324401.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-17T21:14:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324401"
}
```



---

archive/issue_events_324402.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a677bc5a99217d89a9cd987b573b970de0aca7b9",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-08-17T21:14:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24735#event-324402"
}
```



---

archive/issue_comments_378750.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513)** to **[45ff371](https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c)**",
    "created_at": "2018-08-17T21:14:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24735",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24735#issuecomment-378750",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/a9e5aed9215175f8cf49327c790ae153648a2513)** to **[45ff371](https://github.com/sagemath/sagetrac-mirror/commit/45ff3719d4f9059a0e85d142cd1e31cb87efa11c)**
