# Issue 24562: py3: fixes to sage.misc.decorators

archive/issues_024325.json:
```json
{
    "body": "\n\nCC:  @fchapoton\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Erik Bray\n\nBranch: 44ee2ec1bf1c6cd3e1d4654a2ad3696fe3376b2b\n\nCommit: 44ee2ec1bf1c6cd3e1d4654a2ad3696fe3376b2b\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24562\n\n",
    "closed_at": "2019-01-02T08:17:32Z",
    "created_at": "2018-01-18T13:46:30Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "py3: fixes to sage.misc.decorators",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24562",
    "user": "https://github.com/embray"
}
```


CC:  @fchapoton

Reviewer: Frédéric Chapoton

Author: Erik Bray

Branch: 44ee2ec1bf1c6cd3e1d4654a2ad3696fe3376b2b

Commit: 44ee2ec1bf1c6cd3e1d4654a2ad3696fe3376b2b

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24562





---

archive/issue_comments_340164.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-18T13:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340164",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_340165.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-18T13:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340165",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_340166.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-01-29T14:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340166",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_340167.json:
```json
{
    "body": "<a id='comment:3'></a>> As far as I can tell there's only one place in Sage that uses sage_wraps on a class at all\n\n\nWhere is this \"one place in Sage\"? If you want me to test this, I guess I should know...",
    "created_at": "2018-01-29T14:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340167",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>> As far as I can tell there's only one place in Sage that uses sage_wraps on a class at all


Where is this "one place in Sage"? If you want me to test this, I guess I should know...



---

archive/issue_comments_340168.json:
```json
{
    "body": "<a id='comment:4'></a>There is only one place..\n\n```\ngit grep -A2 -B2 \"@sage_wrap\" | grep -B2 \"class\"\nsrc/sage/misc/decorators.py-\nsrc/sage/misc/decorators.py:        @sage_wraps(func)\nsrc/sage/misc/decorators.py-        class wrapper:\n```",
    "created_at": "2018-01-29T15:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340168",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>There is only one place..

```
git grep -A2 -B2 "@sage_wrap" | grep -B2 "class"
src/sage/misc/decorators.py-
src/sage/misc/decorators.py:        @sage_wraps(func)
src/sage/misc/decorators.py-        class wrapper:
```



---

archive/issue_comments_340169.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2018-01-29T16:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340169",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_340170.json:
```json
{
    "body": "<a id='comment:5'></a>The new version doesn't deal with `__doc__` correctly. Try adding this patch:\n\n```diff\ndiff --git a/src/sage/misc/decorators.py b/src/sage/misc/decorators.py\nindex ab16139..62e8a6a 100644\n--- a/src/sage/misc/decorators.py\n+++ b/src/sage/misc/decorators.py\n@@ -191,7 +191,9 @@ class infix_operator(object):\n \n     An infix dot product operator::\n \n-        sage: def dot(a,b): return a.dot_product(b)\n+        sage: def dot(a,b):\n+        ....:     \"Dot product\"\n+        ....:     return a.dot_product(b)\n         sage: dot=infix_operator('multiply')(dot)\n         sage: u=vector([1,2,3])\n         sage: v=vector([5,4,3])\n```",
    "created_at": "2018-01-29T16:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340170",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>The new version doesn't deal with `__doc__` correctly. Try adding this patch:

```diff
diff --git a/src/sage/misc/decorators.py b/src/sage/misc/decorators.py
index ab16139..62e8a6a 100644
--- a/src/sage/misc/decorators.py
+++ b/src/sage/misc/decorators.py
@@ -191,7 +191,9 @@ class infix_operator(object):
 
     An infix dot product operator::
 
-        sage: def dot(a,b): return a.dot_product(b)
+        sage: def dot(a,b):
+        ....:     "Dot product"
+        ....:     return a.dot_product(b)
         sage: dot=infix_operator('multiply')(dot)
         sage: u=vector([1,2,3])
         sage: v=vector([5,4,3])
```



---

archive/issue_events_061937.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-26T12:13:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61937"
}
```



---

archive/issue_comments_340171.json:
```json
{
    "body": "<a id='comment:7'></a>branch does not apply anymore",
    "created_at": "2018-06-12T19:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340171",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>branch does not apply anymore



---

archive/issue_comments_340172.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-06-26T08:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_340173.json:
```json
{
    "body": "<a id='comment:9'></a>Rebased. I still need to see about addressing Jeroen's comment.",
    "created_at": "2018-06-26T08:20:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340173",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>Rebased. I still need to see about addressing Jeroen's comment.



---

archive/issue_comments_340174.json:
```json
{
    "body": "<a id='comment:10'></a>I'm thinking `sage_wraps` shouldn't actually work on classes (the fact that it happens to work on old-style classes was kind of a lucky accident.  The original `functools.wraps` doesn't work on classes, and was never designed to either, and `sage_wraps` isn't *documented* to work with classes.  It was just used in one case (on an old-style class) and it happened to work.\n\nIt's possible to implement `wraps`-like functionality for classes but also a bit trickier (unfortunately).  I think that would be outside the scope of this ticket.",
    "created_at": "2018-06-26T09:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340174",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>I'm thinking `sage_wraps` shouldn't actually work on classes (the fact that it happens to work on old-style classes was kind of a lucky accident.  The original `functools.wraps` doesn't work on classes, and was never designed to either, and `sage_wraps` isn't *documented* to work with classes.  It was just used in one case (on an old-style class) and it happened to work.

It's possible to implement `wraps`-like functionality for classes but also a bit trickier (unfortunately).  I think that would be outside the scope of this ticket.



---

archive/issue_comments_340175.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-26T09:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_340176.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-26T10:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_340177.json:
```json
{
    "body": "<a id='comment:13'></a>Added a little cleanup on the tests for `infix_operator`.  Perhaps should add *more* tests, but unique tests :)",
    "created_at": "2018-06-26T10:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340177",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>Added a little cleanup on the tests for `infix_operator`.  Perhaps should add *more* tests, but unique tests :)



---

archive/issue_comments_340178.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-26T10:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340178",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_340179.json:
```json
{
    "body": "<a id='comment:15'></a>I believe that by our policy the methods in here should have doctests. Or is there some reason why they shouldn't?",
    "created_at": "2018-07-17T15:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340179",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:15'></a>I believe that by our policy the methods in here should have doctests. Or is there some reason why they shouldn't?



---

archive/issue_comments_340180.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-17T15:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340180",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_340181.json:
```json
{
    "body": "<a id='comment:16'></a>What methods do you think require tests?  These are mostly internal details that are tested implicitly by the existing examples.",
    "created_at": "2018-07-17T17:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340181",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>What methods do you think require tests?  These are mostly internal details that are tested implicitly by the existing examples.



---

archive/issue_comments_340182.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-07-17T17:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340182",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_061938.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61938"
}
```



---

archive/issue_events_061939.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61939"
}
```



---

archive/issue_comments_340183.json:
```json
{
    "body": "<a id='comment:17'></a>I believe this issue can reasonably be addressed for Sage 8.4.",
    "created_at": "2018-07-18T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340183",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>I believe this issue can reasonably be addressed for Sage 8.4.



---

archive/issue_comments_340184.json:
```json
{
    "body": "<a id='comment:18'></a>The failures are in `-optional: magma` tests that I guess are enabled on that particular buildbot.  Nothing to do with this I don't think.",
    "created_at": "2018-08-16T10:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340184",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'></a>The failures are in `-optional: magma` tests that I guess are enabled on that particular buildbot.  Nothing to do with this I don't think.



---

archive/issue_comments_340185.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-22T02:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340185",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_340186.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:16 embray]:\n> What methods do you think require tests?  These are mostly internal details that are tested implicitly by the existing examples.\n\n\nSorry, but I don't understand what \"internal details\" means. I know we had this discussion before but unless something has changed, virtually all methods should be doctested, e.g., the ones in `_infix_wrapper`. Personally, I have no opinion on whether that's a good or a bad policy (I can see valid arguments on both sides, so I am not sure) but I think it's still the way things work; which could be changed of course.\n\nBtw, with the current state of documentation it is not immediately clear to me what `_infix_wrapper` does. A docstring that explains what this class is doing would be helpful.",
    "created_at": "2018-08-22T02:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340186",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:19'></a>Replying to [comment:16 embray]:
> What methods do you think require tests?  These are mostly internal details that are tested implicitly by the existing examples.


Sorry, but I don't understand what "internal details" means. I know we had this discussion before but unless something has changed, virtually all methods should be doctested, e.g., the ones in `_infix_wrapper`. Personally, I have no opinion on whether that's a good or a bad policy (I can see valid arguments on both sides, so I am not sure) but I think it's still the way things work; which could be changed of course.

Btw, with the current state of documentation it is not immediately clear to me what `_infix_wrapper` does. A docstring that explains what this class is doing would be helpful.



---

archive/issue_comments_340187.json:
```json
{
    "body": "<a id='comment:20'></a>It doesn't always make sense to write examples for methods that merely serve some internal purpose and are never used directly--instead the tests use these things indirectly in the process of doing the thing it is they're supposed to do.  What this leads to is tests like you can see in the original code, such as:\n\n```\n-        def left_func(self, right):\n-            \"\"\"\n-            The function for the operation on the left (e.g., __add__).\n-\n-            EXAMPLES::\n-\n-                sage: def dot(a,b): return a.dot_product(b)\n-                sage: dot=infix_operator('multiply')(dot)\n-                sage: u=vector([1,2,3])\n-                sage: v=vector([5,4,3])\n-                sage: u *dot* v\n-                22\n-            \"\"\"\n```\n\nThis exact same test is repeated like 3 or 4 times in that module, because someone said \"it needs an example block\" in every method.  This should be clarified in the developer docs, but that really does not mean \"literally every `def` statement\".  The intention is that every function or method that someone actually uses directly is documented in this way.\n\nSometimes it still makes sense to have as an example of how an internal method is used, if it's unclear, or if it's an internal method that might be useful when adding new methods to a class or subclass.  But not if it means going into contortions to set up a test for a method that is never called directly in the first place.",
    "created_at": "2018-08-22T10:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340187",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>It doesn't always make sense to write examples for methods that merely serve some internal purpose and are never used directly--instead the tests use these things indirectly in the process of doing the thing it is they're supposed to do.  What this leads to is tests like you can see in the original code, such as:

```
-        def left_func(self, right):
-            """
-            The function for the operation on the left (e.g., __add__).
-
-            EXAMPLES::
-
-                sage: def dot(a,b): return a.dot_product(b)
-                sage: dot=infix_operator('multiply')(dot)
-                sage: u=vector([1,2,3])
-                sage: v=vector([5,4,3])
-                sage: u *dot* v
-                22
-            """
```

This exact same test is repeated like 3 or 4 times in that module, because someone said "it needs an example block" in every method.  This should be clarified in the developer docs, but that really does not mean "literally every `def` statement".  The intention is that every function or method that someone actually uses directly is documented in this way.

Sometimes it still makes sense to have as an example of how an internal method is used, if it's unclear, or if it's an internal method that might be useful when adding new methods to a class or subclass.  But not if it means going into contortions to set up a test for a method that is never called directly in the first place.



---

archive/issue_comments_340188.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-22T10:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340188",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_340189.json:
```json
{
    "body": "<a id='comment:21'></a>Anyways, this ticket isn't adding particularly new code; just slightly refactoring existing code that was written in an odd way that made it needlessly non-portable.  Needlessly duplicated doctests are also removed.\n\nIf it's unclear, `_infix_wrapper` is just a base class for wrappers around a function turning that function into an infix operator.  `infix_operator` itself is just the decorator, but `_infix_wrapper` is the base for the actual wrapped functions returned by the decorator.  \n\nThis was already in the original code under just the name \"wrapper\", and it was a class defined inline in `infix_operator.__call__`.  I just moved it out to module level because there was no-need to create new instances of that base class for every `infix_operator` call.",
    "created_at": "2018-08-22T10:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340189",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'></a>Anyways, this ticket isn't adding particularly new code; just slightly refactoring existing code that was written in an odd way that made it needlessly non-portable.  Needlessly duplicated doctests are also removed.

If it's unclear, `_infix_wrapper` is just a base class for wrappers around a function turning that function into an infix operator.  `infix_operator` itself is just the decorator, but `_infix_wrapper` is the base for the actual wrapped functions returned by the decorator.  

This was already in the original code under just the name "wrapper", and it was a class defined inline in `infix_operator.__call__`.  I just moved it out to module level because there was no-need to create new instances of that base class for every `infix_operator` call.



---

archive/issue_comments_340190.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:20 embray]:\n> [...] \n> This exact same test is repeated like 3 or 4 times in that module, because someone said \"it needs an example block\" in every method.  This should be clarified in the developer docs, but that really does not mean \"literally every `def` statement\".  The intention is that every function or method that someone actually uses directly is documented in this way.\n\nI don't agree. Also internal methods should be documented that way wherever possible imo.\n\n> Sometimes it still makes sense to have as an example of how an internal method is used, if it's unclear, or if it's an internal method that might be useful when adding new methods to a class or subclass.  But not if it means going into contortions to set up a test for a method that is never called directly in the first place.\n\nWhen I'm not lazy, I try to do an \"indirect doctest\" when it's too much code to setup the situation where the method could be used or when the method is cleary just a backing for something else, e.g., I'd test `_add_` with `a+b` even though it that calls `__add__`.",
    "created_at": "2018-08-23T16:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340190",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:22'></a>Replying to [comment:20 embray]:
> [...] 
> This exact same test is repeated like 3 or 4 times in that module, because someone said "it needs an example block" in every method.  This should be clarified in the developer docs, but that really does not mean "literally every `def` statement".  The intention is that every function or method that someone actually uses directly is documented in this way.

I don't agree. Also internal methods should be documented that way wherever possible imo.

> Sometimes it still makes sense to have as an example of how an internal method is used, if it's unclear, or if it's an internal method that might be useful when adding new methods to a class or subclass.  But not if it means going into contortions to set up a test for a method that is never called directly in the first place.

When I'm not lazy, I try to do an "indirect doctest" when it's too much code to setup the situation where the method could be used or when the method is cleary just a backing for something else, e.g., I'd test `_add_` with `a+b` even though it that calls `__add__`.



---

archive/issue_comments_340191.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:21 embray]:\n> Anyways, this ticket isn't adding particularly new code; just slightly refactoring existing code that was written in an odd way that made it needlessly non-portable.  Needlessly duplicated doctests are also removed.\n\nSure, the doctests were bad. I think we should have tried to replace them with better doctests instead of no doctests.\n\n> If it's unclear, `_infix_wrapper` is just a base class for wrappers around a function turning that function into an infix operator.  `infix_operator` itself is just the decorator, but `_infix_wrapper` is the base for the actual wrapped functions returned by the decorator.  \nOk. This wasn't clear to me. That would almost be a valid docstring for the class.\n\nSo, I'll stop bugging you here I think as this probably won't lead anywhere. I am afraid I can't set this to positive review as is. If somebody else wants to do that I am not opposed at all.",
    "created_at": "2018-08-23T16:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340191",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:23'></a>Replying to [comment:21 embray]:
> Anyways, this ticket isn't adding particularly new code; just slightly refactoring existing code that was written in an odd way that made it needlessly non-portable.  Needlessly duplicated doctests are also removed.

Sure, the doctests were bad. I think we should have tried to replace them with better doctests instead of no doctests.

> If it's unclear, `_infix_wrapper` is just a base class for wrappers around a function turning that function into an infix operator.  `infix_operator` itself is just the decorator, but `_infix_wrapper` is the base for the actual wrapped functions returned by the decorator.  
Ok. This wasn't clear to me. That would almost be a valid docstring for the class.

So, I'll stop bugging you here I think as this probably won't lead anywhere. I am afraid I can't set this to positive review as is. If somebody else wants to do that I am not opposed at all.



---

archive/issue_comments_340192.json:
```json
{
    "body": "<a id='comment:25'></a>I'm not sure why you can't.  Do you have some concrete suggestion for how this could be documented better, other than adding pointless repetitive doctests?",
    "created_at": "2018-09-03T11:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340192",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>I'm not sure why you can't.  Do you have some concrete suggestion for how this could be documented better, other than adding pointless repetitive doctests?



---

archive/issue_events_061940.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61940"
}
```



---

archive/issue_events_061941.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61941"
}
```



---

archive/issue_events_061942.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:10:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61942"
}
```



---

archive/issue_events_061943.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:10:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61943"
}
```



---

archive/issue_comments_340193.json:
```json
{
    "body": "<a id='comment:27'></a>Retargeting some of my tickets (somewhat optimistically for now).",
    "created_at": "2018-12-28T14:10:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340193",
    "user": "https://github.com/embray"
}
```

<a id='comment:27'></a>Retargeting some of my tickets (somewhat optimistically for now).



---

archive/issue_comments_340194.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-31T20:12:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340194",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_340195.json:
```json
{
    "body": "<a id='comment:28'></a>ok. I would have prefered to see stupid doctests everywhere, but let us move on.",
    "created_at": "2018-12-31T20:12:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340195",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:28'></a>ok. I would have prefered to see stupid doctests everywhere, but let us move on.



---

archive/issue_events_061944.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-02T08:17:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24562#event-61944"
}
```



---

archive/issue_comments_340196.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-02T08:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24562#issuecomment-340196",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
