# Issue 24108: Disallow boolean operations with Unknown

archive/issues_024108.json:
```json
{
    "body": "The `Unknown` from `misc/unknown.py` incorrectly behaves like `False` in the context of boolean operations. It is mostly useless as long as Python has no tristate conditionals and logic operators. This ticket raises an error instead.\n\nAs a consequence of this modification, Sage code is adapted as follows for a given tristate `troolean`\n\n```\nif troolean is True:\n    ...\nelif troolean is False:\n    ...\nelse:\n    ...\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/24345\n\n",
    "closed_at": "2020-02-19T23:26:59Z",
    "created_at": "2017-12-08T15:31:53Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Disallow boolean operations with Unknown",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24108",
    "user": "https://github.com/rwst"
}
```
The `Unknown` from `misc/unknown.py` incorrectly behaves like `False` in the context of boolean operations. It is mostly useless as long as Python has no tristate conditionals and logic operators. This ticket raises an error instead.

As a consequence of this modification, Sage code is adapted as follows for a given tristate `troolean`

```
if troolean is True:
    ...
elif troolean is False:
    ...
else:
    ...
```

Issue created by migration from https://trac.sagemath.org/ticket/24345





---

archive/issue_comments_337366.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-12-08T15:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337366",
    "user": "https://github.com/rwst"
}
```

New commits:



---

archive/issue_comments_337367.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-12-08T15:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337367",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_337368.json:
```json
{
    "body": "I'm not sure that there is actually a bug here...\n\nTo me, requiring people to write `foo() is True` is a bigger problem than treating `Unknown` as false.",
    "created_at": "2017-12-08T16:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337368",
    "user": "https://github.com/jdemeyer"
}
```

I'm not sure that there is actually a bug here...

To me, requiring people to write `foo() is True` is a bigger problem than treating `Unknown` as false.



---

archive/issue_comments_337369.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> To me, requiring people to write `foo() is True` is a bigger problem than treating `Unknown` as false.\n\n\nSo you would not argue against a ticket that uses such an Unknown?",
    "created_at": "2017-12-09T06:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337369",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:3 jdemeyer]:
> To me, requiring people to write `foo() is True` is a bigger problem than treating `Unknown` as false.


So you would not argue against a ticket that uses such an Unknown?



---

archive/issue_comments_337370.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> I'm not sure that there is actually a bug here...\n> \n> To me, requiring people to write `foo() is True` is a bigger problem than treating `Unknown` as false.\n\n\nAnother alternative with this ticket's `Unknown` would be to raise an `UnknownError` instead of `NotImplementedError` and suggest to the user to catch it. This way you can still write `if foo():`. What about it?",
    "created_at": "2017-12-11T15:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337370",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:3 jdemeyer]:
> I'm not sure that there is actually a bug here...
> 
> To me, requiring people to write `foo() is True` is a bigger problem than treating `Unknown` as false.


Another alternative with this ticket's `Unknown` would be to raise an `UnknownError` instead of `NotImplementedError` and suggest to the user to catch it. This way you can still write `if foo():`. What about it?



---

archive/issue_comments_337371.json:
```json
{
    "body": "Sorry, I'm not quite following what you are trying to say...\n\nMaybe you should explain better which bug this ticket is meant to address any why it is a bug.",
    "created_at": "2017-12-11T17:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337371",
    "user": "https://github.com/jdemeyer"
}
```

Sorry, I'm not quite following what you are trying to say...

Maybe you should explain better which bug this ticket is meant to address any why it is a bug.



---

archive/issue_comments_337372.json:
```json
{
    "body": "The bug is that the flag query functions is_integer, is_real etc return False instead of Unknown, ie #22162. I followed your argument there that using Unknown as is would win nothing, although I think it would be less confusing. This ticket tries to implement an Unknown that behaves more like what we want. Can we agree on this? Have I misunderstood something?",
    "created_at": "2017-12-11T19:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337372",
    "user": "https://github.com/rwst"
}
```

The bug is that the flag query functions is_integer, is_real etc return False instead of Unknown, ie #22162. I followed your argument there that using Unknown as is would win nothing, although I think it would be less confusing. This ticket tries to implement an Unknown that behaves more like what we want. Can we agree on this? Have I misunderstood something?



---

archive/issue_comments_337373.json:
```json
{
    "body": "Also after the flag query functions return unknown changes can be made that make them return True/Unknown/False where False really means False.",
    "created_at": "2017-12-11T19:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337373",
    "user": "https://github.com/rwst"
}
```

Also after the flag query functions return unknown changes can be made that make them return True/Unknown/False where False really means False.



---

archive/issue_comments_337374.json:
```json
{
    "body": "Replying to [comment:7 rws]:\n> Can we agree on this?\n\n\nWell, first I have to agree with myself. I read the discussion again on #22162 and I'm less convinced about my own reasoning there. I have not thought much about it now, but my feeling is that I was wrong on #22162.",
    "created_at": "2017-12-12T16:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337374",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:7 rws]:
> Can we agree on this?


Well, first I have to agree with myself. I read the discussion again on #22162 and I'm less convinced about my own reasoning there. I have not thought much about it now, but my feeling is that I was wrong on #22162.



---

archive/issue_comments_337375.json:
```json
{
    "body": "`Unknown` is broken. The only reasonable proposals are in order of decreasing preference (to me):\n- make Python troolean compatible\n- the proposal of this ticket\n- remove completely `Unknown`\n\nI definitely support the changes from this ticket.",
    "created_at": "2017-12-13T18:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337375",
    "user": "https://github.com/videlec"
}
```

`Unknown` is broken. The only reasonable proposals are in order of decreasing preference (to me):
- make Python troolean compatible
- the proposal of this ticket
- remove completely `Unknown`

I definitely support the changes from this ticket.



---

archive/issue_comments_337376.json:
```json
{
    "body": "In an ideal world, we would have the following behavior\n\n```\nif troolean:\n    # here troolean = True\nelif not troolean:\n    # here troolean = False\nelse:\n    # here troolean = Unknown\n```\nIt would be so much better to patch Python!",
    "created_at": "2017-12-16T14:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337376",
    "user": "https://github.com/videlec"
}
```

In an ideal world, we would have the following behavior

```
if troolean:
    # here troolean = True
elif not troolean:
    # here troolean = False
else:
    # here troolean = Unknown
```
It would be so much better to patch Python!



---

archive/issue_comments_337377.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-02T20:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337377",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_337378.json:
```json
{
    "body": "one doctest failure (see patchbot report)\n\n```\nsage -t --long src/sage/graphs/strongly_regular_db.pyx  # 1 doctest failed\n```",
    "created_at": "2018-01-02T20:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337378",
    "user": "https://github.com/videlec"
}
```

one doctest failure (see patchbot report)

```
sage -t --long src/sage/graphs/strongly_regular_db.pyx  # 1 doctest failed
```



---

archive/issue_comments_337379.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-03T07:26:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337379",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337380.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-03T07:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337380",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337381.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-11T11:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337381",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_337382.json:
```json
{
    "body": "From the documentation of `designs.differenf_family`\n\n```\n    - ``existence`` -- if ``True``, then return either ``True`` if Sage knows\n      how to build such design, ``Unknown`` if it does not and ``False`` if it\n      knows that the design does not exist.\n```\nHence, the `isinstance(ret, tuple)` should not be needed in\n\n```\n+        ....:             ret = designs.difference_family(v,k,l,existence=True)\n+        ....:             if ret is True or isinstance(ret, tuple):\n```\nThere is indeed a bug in the design code (see #24513)\n\n```\nsage: designs.difference_family(3,2,1, existence=True)   # should be True\n(Ring of integers modulo 3, [[1, 2]])\n```",
    "created_at": "2018-01-11T11:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337382",
    "user": "https://github.com/videlec"
}
```

From the documentation of `designs.differenf_family`

```
    - ``existence`` -- if ``True``, then return either ``True`` if Sage knows
      how to build such design, ``Unknown`` if it does not and ``False`` if it
      knows that the design does not exist.
```
Hence, the `isinstance(ret, tuple)` should not be needed in

```
+        ....:             ret = designs.difference_family(v,k,l,existence=True)
+        ....:             if ret is True or isinstance(ret, tuple):
```
There is indeed a bug in the design code (see #24513)

```
sage: designs.difference_family(3,2,1, existence=True)   # should be True
(Ring of integers modulo 3, [[1, 2]])
```



---

archive/issue_comments_337383.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-11T15:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337383",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337384.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-01-11T15:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337384",
    "user": "https://github.com/rwst"
}
```

New commits:



---

archive/issue_comments_337385.json:
```json
{
    "body": "Looks good.\n\nCould you document more carefully the behavior of `Unknown` class? Especially in the design and stronly regular graph codes where you need to write\n\n```\nmy_function(params, existence=True) is True\n```\nand not simply\n\n```\nmy_function(params, existence=True)\n```",
    "created_at": "2018-01-11T15:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337385",
    "user": "https://github.com/videlec"
}
```

Looks good.

Could you document more carefully the behavior of `Unknown` class? Especially in the design and stronly regular graph codes where you need to write

```
my_function(params, existence=True) is True
```
and not simply

```
my_function(params, existence=True)
```



---

archive/issue_comments_337386.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-25T23:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337386",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_337387.json:
```json
{
    "body": "I like the idea of Jereon from [comment:5 comment:5]. It would be clearer with `UnknownError` rather than the less specific `NotImplementedError`. And this would allow the alternative troolean evaluation\n\n```\ntry:\n    if troolean:\n        ...\n    else:\n        ....\nexcept UnknownError:\n    ....\n```\n\nAnd as said from [comment:19 comment:19]. Documentation is needed.",
    "created_at": "2018-01-25T23:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337387",
    "user": "https://github.com/videlec"
}
```

I like the idea of Jereon from [comment:5 comment:5]. It would be clearer with `UnknownError` rather than the less specific `NotImplementedError`. And this would allow the alternative troolean evaluation

```
try:
    if troolean:
        ...
    else:
        ....
except UnknownError:
    ....
```

And as said from [comment:19 comment:19]. Documentation is needed.



---

archive/issue_comments_337388.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-26T14:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337388",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337389.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-01-26T14:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337389",
    "user": "https://github.com/rwst"
}
```

New commits:



---

archive/issue_comments_337390.json:
```json
{
    "body": "You break `bool(Unknown)` and this is not mentioned.",
    "created_at": "2018-01-26T16:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337390",
    "user": "https://github.com/videlec"
}
```

You break `bool(Unknown)` and this is not mentioned.



---

archive/issue_comments_337391.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-01-26T16:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337391",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_337392.json:
```json
{
    "body": "Why this change\n\n```diff\n@@ -168,7 +213,7 @@ class UnknownClass(UniqueRepresentation, SageObject):\n         if other is self:\n             return rich_to_bool(op, 0)\n         if not isinstance(other, bool):\n-            return NotImplemented\n+            return Unknown\n         if other:\n             return rich_to_bool(op, -1)\n         else:\n```",
    "created_at": "2018-01-26T16:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337392",
    "user": "https://github.com/videlec"
}
```

Why this change

```diff
@@ -168,7 +213,7 @@ class UnknownClass(UniqueRepresentation, SageObject):
         if other is self:
             return rich_to_bool(op, 0)
         if not isinstance(other, bool):
-            return NotImplemented
+            return Unknown
         if other:
             return rich_to_bool(op, -1)
         else:
```



---

archive/issue_comments_337393.json:
```json
{
    "body": "The following should not be broken\n\n```diff\n@@ -114,14 +153,18 @@ class UnknownClass(UniqueRepresentation, SageObject):\n             sage: Unknown | False\n             Unknown\n             sage: Unknown | Unknown\n-            Unknown\n+            Traceback (most recent call last):\n+            ...\n+            UnknownError: Unknown does not evaluate in boolean context\n             sage: Unknown | True\n             True\n```\n(as well as operation `&`). The implementation of `__xor__` and `__and__` should be modified.",
    "created_at": "2018-01-26T16:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337393",
    "user": "https://github.com/videlec"
}
```

The following should not be broken

```diff
@@ -114,14 +153,18 @@ class UnknownClass(UniqueRepresentation, SageObject):
             sage: Unknown | False
             Unknown
             sage: Unknown | Unknown
-            Unknown
+            Traceback (most recent call last):
+            ...
+            UnknownError: Unknown does not evaluate in boolean context
             sage: Unknown | True
             True
```
(as well as operation `&`). The implementation of `__xor__` and `__and__` should be modified.



---

archive/issue_comments_337394.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2018-01-26T16:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337394",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_337395.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-27T07:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337396.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-27T07:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337396",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337397.json:
```json
{
    "body": "You should also test `True | Unknown` as well as `False | Unknown`.\n\n`__not__` is by no way a special Python method. It would better be removed.",
    "created_at": "2018-01-27T10:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337397",
    "user": "https://github.com/videlec"
}
```

You should also test `True | Unknown` as well as `False | Unknown`.

`__not__` is by no way a special Python method. It would better be removed.



---

archive/issue_comments_337398.json:
```json
{
    "body": "Replying to [comment:29 vdelecroix]:\n> You should also test `True | Unknown` as well as `False | Unknown`.\n\n\nwhich is also broken\n\n```\nsage: False | Unknown\nTraceback (most recent call last):\n...\nTypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'\nsage: True | Unknown\nTraceback (most recent call last):\n...\nTypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'\n```",
    "created_at": "2018-01-27T11:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337398",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:29 vdelecroix]:
> You should also test `True | Unknown` as well as `False | Unknown`.


which is also broken

```
sage: False | Unknown
Traceback (most recent call last):
...
TypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'
sage: True | Unknown
Traceback (most recent call last):
...
TypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'
```



---

archive/issue_comments_337399.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-29T15:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337399",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337400.json:
```json
{
    "body": "Replying to [comment:30 vdelecroix]:\n> which is also broken\n> \n> ```\n> sage: False | Unknown\n> Traceback (most recent call last):\n> ...\n> TypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'\n> ```\n\nI have no idea how to fix this so I just added a test. This is odd:\n\n```\nsage: True | 1\n1\nsage: True.__or__(1)\nNotImplemented\n```",
    "created_at": "2018-01-29T15:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337400",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:30 vdelecroix]:
> which is also broken
> 
> ```
> sage: False | Unknown
> Traceback (most recent call last):
> ...
> TypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'
> ```

I have no idea how to fix this so I just added a test. This is odd:

```
sage: True | 1
1
sage: True.__or__(1)
NotImplemented
```



---

archive/issue_comments_337401.json:
```json
{
    "body": "Replying to [comment:32 rws]:\n> Replying to [comment:30 vdelecroix]:\n> > which is also broken\n> > \n> > ```\n> > sage: False | Unknown\n> > Traceback (most recent call last):\n> > ...\n> > TypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'\n> > ```\n\n> I have no idea how to fix this so I just added a test. This is odd:\n> {{{\n> sage: True | 1\n> 1\n> sage: True.__or__(1)\n> NotImplemented\n> }}}\n\n\nPrecisely: when `x.__or__(y)` returns `NotImplemented` Python automatically calls `y.__or__(x)`.",
    "created_at": "2018-01-29T16:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337401",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:32 rws]:
> Replying to [comment:30 vdelecroix]:
> > which is also broken
> > 
> > ```
> > sage: False | Unknown
> > Traceback (most recent call last):
> > ...
> > TypeError: unsupported operand type(s) for |: 'bool' and 'UnknownClass'
> > ```

> I have no idea how to fix this so I just added a test. This is odd:
> {{{
> sage: True | 1
> 1
> sage: True.__or__(1)
> NotImplemented
> }}}


Precisely: when `x.__or__(y)` returns `NotImplemented` Python automatically calls `y.__or__(x)`.



---

archive/issue_comments_337402.json:
```json
{
    "body": "Replying to [comment:33 vdelecroix]:\n> Precisely: when `x.__or__(y)` returns `NotImplemented` Python automatically calls `y.__or__(x)`.\n\n\nThen why does this mechanism not work with x=True and y=Unknown?",
    "created_at": "2018-01-29T17:00:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337402",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:33 vdelecroix]:
> Precisely: when `x.__or__(y)` returns `NotImplemented` Python automatically calls `y.__or__(x)`.


Then why does this mechanism not work with x=True and y=Unknown?



---

archive/issue_comments_337403.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-29T20:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337403",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_337404.json:
```json
{
    "body": "PEP 335 was rejected, so can we please stop pretending that it will eventually be accepted? In other words: remove all references to PEP 335.",
    "created_at": "2018-01-29T20:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337404",
    "user": "https://github.com/jdemeyer"
}
```

PEP 335 was rejected, so can we please stop pretending that it will eventually be accepted? In other words: remove all references to PEP 335.



---

archive/issue_comments_337405.json:
```json
{
    "body": "For reference, here is the implementation for `__or__` for booleans\n\n```\nstatic PyObject *\nbool_or(PyObject *a, PyObject *b)\n{\n    if (!PyBool_Check(a) || !PyBool_Check(b))\n        return PyLong_Type.tp_as_number->nb_or(a, b);\n    return PyBool_FromLong((a == Py_True) | (b == Py_True));\n}\n```",
    "created_at": "2018-01-29T21:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337405",
    "user": "https://github.com/videlec"
}
```

For reference, here is the implementation for `__or__` for booleans

```
static PyObject *
bool_or(PyObject *a, PyObject *b)
{
    if (!PyBool_Check(a) || !PyBool_Check(b))
        return PyLong_Type.tp_as_number->nb_or(a, b);
    return PyBool_FromLong((a == Py_True) | (b == Py_True));
}
```



---

archive/issue_comments_337406.json:
```json
{
    "body": "OK, now I get it. The members `__and__` and `__or__` have nothing to do with logic operators, they are associated with bitwise, i.e. `&` and `|`. The original author added these methods thinking that `&` and `|` are logical (as seen in the method description) but they are not and as I don't think bit operations have a meaning with `Unknown` I will remove these methods.",
    "created_at": "2018-01-30T07:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337406",
    "user": "https://github.com/rwst"
}
```

OK, now I get it. The members `__and__` and `__or__` have nothing to do with logic operators, they are associated with bitwise, i.e. `&` and `|`. The original author added these methods thinking that `&` and `|` are logical (as seen in the method description) but they are not and as I don't think bit operations have a meaning with `Unknown` I will remove these methods.



---

archive/issue_comments_337407.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-30T07:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337407",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337408.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-30T07:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337408",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337409.json:
```json
{
    "body": "Replying to [comment:37 rws]:\n> OK, now I get it. The members `__and__` and `__or__` have nothing to do with logic operators, they are associated with bitwise, i.e. `&` and `|`. The original author added these methods thinking that `&` and `|` are logical (as seen in the method description) but they are not and as I don't think bit operations have a meaning with `Unknown` I will remove these methods.\n\n\nNote that the operators `and` and `or` are only using `__nonzero__`. Though they are **not** logical operator in the most common sense (like `&&` and `||` in C/C++).",
    "created_at": "2018-01-30T07:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337409",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:37 rws]:
> OK, now I get it. The members `__and__` and `__or__` have nothing to do with logic operators, they are associated with bitwise, i.e. `&` and `|`. The original author added these methods thinking that `&` and `|` are logical (as seen in the method description) but they are not and as I don't think bit operations have a meaning with `Unknown` I will remove these methods.


Note that the operators `and` and `or` are only using `__nonzero__`. Though they are **not** logical operator in the most common sense (like `&&` and `||` in C/C++).



---

archive/issue_comments_337410.json:
```json
{
    "body": "And since we are at refactoring, I don't understand why `Unknown` should inherit from `SageObject`. It does not interact with anything else.",
    "created_at": "2018-01-30T07:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337410",
    "user": "https://github.com/videlec"
}
```

And since we are at refactoring, I don't understand why `Unknown` should inherit from `SageObject`. It does not interact with anything else.



---

archive/issue_comments_337411.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-30T07:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337411",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337412.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-03T16:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337413.json:
```json
{
    "body": "rebased\n\n---\nNew commits:",
    "created_at": "2020-02-16T20:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337413",
    "user": "https://github.com/videlec"
}
```

rebased

---
New commits:



---

archive/issue_events_061562.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2020-02-16T20:48:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24108#event-61562"
}
```



---

archive/issue_comments_337414.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-02-16T20:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_337415.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-17T06:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337415",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337416.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-17T09:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337416",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_061563.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-19T23:26:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24108#event-61563"
}
```



---

archive/issue_comments_337417.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-19T23:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24108#issuecomment-337417",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
