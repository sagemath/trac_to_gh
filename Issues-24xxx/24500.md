# Issue 24500: Implement actions using _act_ instead of _call_

archive/issues_024263.json:
```json
{
    "assignees": [],
    "body": "We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n\nThe current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n\nWork on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n\nCC:  @videlec @tscrim\n\nBranch/Commit: **[3a0958d](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **coercion**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24500_\n\n",
    "closed_at": "2018-11-29T08:13:34Z",
    "created_at": "2018-01-09T14:54:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20coercion",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement actions using _act_ instead of _call_",
    "type": "issue",
    "updated_at": "2018-11-29T08:13:34Z",
    "url": "https://github.com/sagemath/sage/issues/24500",
    "user": "https://github.com/jdemeyer"
}
```
We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.

The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.

Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.

CC:  @videlec @tscrim

Branch/Commit: **[3a0958d](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)**

Reviewer: **Travis Scrimshaw**

Author: **Jeroen Demeyer**

Component: **coercion**

_Issue created by migration from https://trac.sagemath.org/ticket/24500_





---

archive/issue_events_339365.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-09T14:54:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339365"
}
```



---

archive/issue_events_339366.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-09T14:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/performance",
    "label_color": "696969",
    "label_name": "performance",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339366"
}
```



---

archive/issue_events_339367.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-09T14:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339367"
}
```



---

archive/issue_events_339368.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-09T14:54:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339368"
}
```



---

archive/issue_comments_370957.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.\n+\n+We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.\n+\n+Whatever we do, we should document things as currently there is no documentation of `Action`.\n``````\n",
    "created_at": "2018-01-09T15:39:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370957",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.
+
+We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.
+
+Whatever we do, we should document things as currently there is no documentation of `Action`.
``````




---

archive/issue_comments_370958.json:
```json
{
    "body": "Dependencies: **#5574**",
    "created_at": "2018-01-18T10:14:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370958",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#5574**



---

archive/issue_comments_370959.json:
```json
{
    "body": "Branch: **[u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)**",
    "created_at": "2018-01-30T13:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370959",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)**



---

archive/issue_comments_370960.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd3b5b594d1dd98b3ecc7256a62f79f5afc73b0f\">dd3b5b5</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03\">f2b676e</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-01-30T13:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370960",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd3b5b594d1dd98b3ecc7256a62f79f5afc73b0f">dd3b5b5</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03">f2b676e</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_comments_370961.json:
```json
{
    "body": "Commit: **[f2b676e](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)**",
    "created_at": "2018-01-30T13:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370961",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[f2b676e](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)**



---

archive/issue_comments_370962.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2018-01-30T13:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370962",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_370963.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.\n+We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n \n-We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.\n+The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n-Whatever we do, we should document things as currently there is no documentation of `Action`.\n+Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n``````\n",
    "created_at": "2018-01-30T13:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370963",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This should be optimized.
+We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.
 
-We should also consider whether the current `_call_` API is optimal: maybe an `_act_(g, s)` method where `g` always acts on `s` would be better because now every `_call_` method has to figure out whether it's a left or right action.
+The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
-Whatever we do, we should document things as currently there is no documentation of `Action`.
+Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
``````




---

archive/issue_events_339369.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "title_is": "Implement action using _act_ instead of _call_",
    "title_was": "Optimize Action.__call__",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339369"
}
```



---

archive/issue_events_339370.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/performance",
    "label_color": "696969",
    "label_name": "performance",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339370"
}
```



---

archive/issue_events_339371.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20coercion",
    "label_color": "0000ff",
    "label_name": "c: coercion",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339371"
}
```



---

archive/issue_events_339372.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T13:57:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339372"
}
```



---

archive/issue_comments_370964.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n+We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.\n \n The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n``````\n",
    "created_at": "2018-01-30T14:01:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370964",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-We change the internal API of `Action`: instead of a `_call_` method, we implement an `_act_` method which always take `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.
+We change the internal API of `Action`: instead of the existing `_call_` method, we implement an `_act_` method which always takes `(g, x)` as arguments, where `g` is the acting element and `x` is the acted-on element.
 
 The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
``````




---

archive/issue_events_339373.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-30T14:23:54Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "title_is": "Implement actions using _act_ instead of _call_",
    "title_was": "Implement action using _act_ instead of _call_",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339373"
}
```



---

archive/issue_comments_370965.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,69 @@\n The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n+\n+**Timings** (compared to before #24247 and #5574):\n+\n+**GF(2<sup>n</sup>)<sup>ZZ</sup>**\n+\n+Before:\n+\n+```\n+sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 383 ns per loop\n+```\n+\n+After:\n+\n+```\n+sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 635 ns per loop\n+```\n+\n+**RDF<sup>ZZ</sup>**\n+\n+Before:\n+\n+```\n+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 156 ns per loop\n+```\n+\n+After:\n+\n+```\n+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n+100000 loops, best of 20: 185 ns per loop\n+```\n+\n+**ideal<sup>ZZ</sup>**\n+\n+Before:\n+\n+```\n+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 13.3 \u00b5s per loop\n+```\n+\n+After:\n+\n+```\n+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 14.1 \u00b5s per loop\n+```\n+\n+**AA<sup>QQ</sup>**\n+\n+Before:\n+\n+```\n+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 12.8 \u00b5s per loop\n+```\n+\n+After:\n+\n+```\n+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n+10000 loops, best of 20: 16.6 \u00b5s per loop\n+```\n``````\n",
    "created_at": "2018-01-30T14:52:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370965",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,69 @@
 The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
+
+**Timings** (compared to before #24247 and #5574):
+
+**GF(2<sup>n</sup>)<sup>ZZ</sup>**
+
+Before:
+
+```
+sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 383 ns per loop
+```
+
+After:
+
+```
+sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 635 ns per loop
+```
+
+**RDF<sup>ZZ</sup>**
+
+Before:
+
+```
+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 156 ns per loop
+```
+
+After:
+
+```
+sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
+100000 loops, best of 20: 185 ns per loop
+```
+
+**ideal<sup>ZZ</sup>**
+
+Before:
+
+```
+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 13.3 µs per loop
+```
+
+After:
+
+```
+sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 14.1 µs per loop
+```
+
+**AA<sup>QQ</sup>**
+
+Before:
+
+```
+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 12.8 µs per loop
+```
+
+After:
+
+```
+sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
+10000 loops, best of 20: 16.6 µs per loop
+```
``````




---

archive/issue_comments_370966.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nDo you have timings with this ticket (at least, my understanding of the description is the \"after\" does not include this ticket)?",
    "created_at": "2018-01-30T19:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370966",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

Do you have timings with this ticket (at least, my understanding of the description is the "after" does not include this ticket)?



---

archive/issue_comments_370967.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@tscrim](#comment:9):\n> Do you have timings with this ticket (at least, my understanding of the description is the \"after\" does not include this ticket)?\n\nThe \"after\" does include this ticket.",
    "created_at": "2018-01-30T19:04:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370967",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@tscrim](#comment:9):
> Do you have timings with this ticket (at least, my understanding of the description is the "after" does not include this ticket)?

The "after" does include this ticket.



---

archive/issue_comments_370968.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n \n **Timings** (compared to before #24247 and #5574):\n+\n+Note: \"before\" timings are without #24247, #5574 and #24500. \"after\" timings are with #24247, #5574 and #24500.\n \n **GF(2<sup>n</sup>)<sup>ZZ</sup>**\n \n``````\n",
    "created_at": "2018-01-30T19:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370968",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
 
 **Timings** (compared to before #24247 and #5574):
+
+Note: "before" timings are without #24247, #5574 and #24500. "after" timings are with #24247, #5574 and #24500.
 
 **GF(2<sup>n</sup>)<sup>ZZ</sup>**
 
``````




---

archive/issue_comments_370969.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@jdemeyer](#comment:10):\n> The \"after\" does include this ticket.\n\nDid you invert the \u201cbefore\u201d and \u201cafter\u201d parts then?",
    "created_at": "2018-01-31T15:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370969",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@jdemeyer](#comment:10):
> The "after" does include this ticket.

Did you invert the “before” and “after” parts then?



---

archive/issue_comments_370970.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@mezzarobba](#comment:12):\n> Did you invert the \u201cbefore\u201d and \u201cafter\u201d parts then?\n\nNo, I did not...",
    "created_at": "2018-01-31T15:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370970",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@mezzarobba](#comment:12):
> Did you invert the “before” and “after” parts then?

No, I did not...



---

archive/issue_comments_370971.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOn 8.2.beta4:\n\n```\nsage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 343 ns per loop\nsage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 137 ns per loop\nsage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7.62 \u00b5s per loop\nsage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7 \u00b5s per loop\n```\nvs with #5574:\n\n```\nsage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 341 ns per loop\nsage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 139 ns per loop\nsage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7.71 \u00b5s per loop\nsage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 8.75 \u00b5s per loop\n```\nvs with #24500:\n\n```\nsage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 356 ns per loop\nsage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n100000 loops, best of 20: 141 ns per loop\nsage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 7.53 \u00b5s per loop\nsage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n10000 loops, best of 20: 8.91 \u00b5s per loop\n```\n\nSo I can explain why the first test is slower: there is an additional `if action._is_left` that is needed to be performed that previously was not there because powering could assume things in a specific order. The last one slowing down is due to #5574 (and some numerical noise). The middle two are almost identical (at least within the numerical noise I was getting), which is expected considering they perform the same number of checks in Cython.\n\nHowever, I did get an improvement when something was calling `is_left()` in Python:\n\n```\nsage: from brial import BooleanMonomialMonoid\nsage: P.<x,y,z> = BooleanPolynomialRing(3)\nsage: M = BooleanMonomialMonoid(P)\nsage: x = M(x); xy = M(x*y); z=M(z); n=2\nsage: timeit('x * n', number=10000, repeat=20)\n10000 loops, best of 20: 6.52 \u00b5s per loop\nsage: timeit('n * x', number=10000, repeat=20)\n10000 loops, best of 20: 6.43 \u00b5s per loop\n```\nvs with #24500\n\n```\nsage: timeit('n * x', number=10000, repeat=20)\n10000 loops, best of 20: 6.14 \u00b5s per loop\nsage: timeit('x * n', number=10000, repeat=20)\n10000 loops, best of 20: 6.17 \u00b5s per loop\n```\n\nSo my conclusion is this ticket does do a little bit of optimizing in certain cases and a regression in others. My current inclination is to give this ticket a positive review because it makes the action interface more clean by removing some of the implementation burden (i.e., deciding which input is which type). Do you agree with my assessment? Anyone else have any objections?",
    "created_at": "2018-02-08T21:08:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370971",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

On 8.2.beta4:

```
sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 343 ns per loop
sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 137 ns per loop
sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7.62 µs per loop
sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7 µs per loop
```
vs with #5574:

```
sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 341 ns per loop
sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 139 ns per loop
sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7.71 µs per loop
sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 8.75 µs per loop
```
vs with #24500:

```
sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 356 ns per loop
sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
100000 loops, best of 20: 141 ns per loop
sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 7.53 µs per loop
sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
10000 loops, best of 20: 8.91 µs per loop
```

So I can explain why the first test is slower: there is an additional `if action._is_left` that is needed to be performed that previously was not there because powering could assume things in a specific order. The last one slowing down is due to #5574 (and some numerical noise). The middle two are almost identical (at least within the numerical noise I was getting), which is expected considering they perform the same number of checks in Cython.

However, I did get an improvement when something was calling `is_left()` in Python:

```
sage: from brial import BooleanMonomialMonoid
sage: P.<x,y,z> = BooleanPolynomialRing(3)
sage: M = BooleanMonomialMonoid(P)
sage: x = M(x); xy = M(x*y); z=M(z); n=2
sage: timeit('x * n', number=10000, repeat=20)
10000 loops, best of 20: 6.52 µs per loop
sage: timeit('n * x', number=10000, repeat=20)
10000 loops, best of 20: 6.43 µs per loop
```
vs with #24500

```
sage: timeit('n * x', number=10000, repeat=20)
10000 loops, best of 20: 6.14 µs per loop
sage: timeit('x * n', number=10000, repeat=20)
10000 loops, best of 20: 6.17 µs per loop
```

So my conclusion is this ticket does do a little bit of optimizing in certain cases and a regression in others. My current inclination is to give this ticket a positive review because it makes the action interface more clean by removing some of the implementation burden (i.e., deciding which input is which type). Do you agree with my assessment? Anyone else have any objections?



---

archive/issue_comments_370972.json:
```json
{
    "body": "Changed dependencies from **#5574** to none",
    "created_at": "2018-03-08T09:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370972",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#5574** to none



---

archive/issue_events_339374.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:35:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339374"
}
```



---

archive/issue_events_339375.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:35:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339375"
}
```



---

archive/issue_comments_370973.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3dc30bf642d0f8afc9c19e0fe464382c4270cffe\">3dc30bf</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c\">0587d3f</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-03-08T09:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370973",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3dc30bf642d0f8afc9c19e0fe464382c4270cffe">3dc30bf</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c">0587d3f</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_comments_370974.json:
```json
{
    "body": "Changed commit from **[f2b676e](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)** to **[0587d3f](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)**",
    "created_at": "2018-03-08T09:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370974",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f2b676e](https://github.com/sagemath/sagetrac-mirror/commit/f2b676ef4e7b13eb4e14f117d39afb8b06ebdc03)** to **[0587d3f](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)**



---

archive/issue_events_339376.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:39:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339376"
}
```



---

archive/issue_events_339377.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:39:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339377"
}
```



---

archive/issue_comments_370975.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nMany failing tests involving valuations...",
    "created_at": "2018-03-08T09:47:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370975",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Many failing tests involving valuations...



---

archive/issue_events_339378.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:47:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339378"
}
```



---

archive/issue_events_339379.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T09:47:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339379"
}
```



---

archive/issue_comments_370976.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a607ecb6b4e74a7f77aceda7b62bfc3130663943\">a607ecb</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d\">30d8bac</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-03-08T10:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370976",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a607ecb6b4e74a7f77aceda7b62bfc3130663943">a607ecb</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d">30d8bac</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_comments_370977.json:
```json
{
    "body": "Changed commit from **[0587d3f](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)** to **[30d8bac](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)**",
    "created_at": "2018-03-08T10:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370977",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0587d3f](https://github.com/sagemath/sagetrac-mirror/commit/0587d3f4c1f2a75ecf095461810414ee43a35b1c)** to **[30d8bac](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)**



---

archive/issue_events_339380.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T10:02:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339380"
}
```



---

archive/issue_events_339381.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-03-08T10:02:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339381"
}
```



---

archive/issue_events_339382.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T08:04:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339382"
}
```



---

archive/issue_events_339383.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T08:04:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339383"
}
```



---

archive/issue_comments_370978.json:
```json
{
    "body": "Changed commit from **[30d8bac](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)** to **[0406b4a](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)**",
    "created_at": "2018-04-06T09:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370978",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[30d8bac](https://github.com/sagemath/sagetrac-mirror/commit/30d8bac7fa31db13511c867ec2ca95de76d2313d)** to **[0406b4a](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)**



---

archive/issue_comments_370979.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66\">800d30b</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5\">0406b4a</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>\n",
    "created_at": "2018-04-06T09:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370979",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66">800d30b</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5">0406b4a</a></td><td><code>Don't use Set_PythonType in IntegerAction</code></td></tr></table>




---

archive/issue_events_339384.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T09:50:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339384"
}
```



---

archive/issue_events_339385.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T09:50:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339385"
}
```



---

archive/issue_comments_370980.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nPart of the slowdown in this ticket was caused by the second commit removing `Set_PythonType`. I'll drop that commit, then the regressions are gone for me.",
    "created_at": "2018-04-06T12:34:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370980",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Part of the slowdown in this ticket was caused by the second commit removing `Set_PythonType`. I'll drop that commit, then the regressions are gone for me.



---

archive/issue_comments_370981.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-06T12:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370981",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_370982.json:
```json
{
    "body": "Changed commit from **[0406b4a](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)** to **[800d30b](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)**",
    "created_at": "2018-04-06T12:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370982",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0406b4a](https://github.com/sagemath/sagetrac-mirror/commit/0406b4a1a2b91dc7976a5a7271acc770c702eab5)** to **[800d30b](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)**



---

archive/issue_comments_370983.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01\">3a0958d</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr></table>\n",
    "created_at": "2018-11-26T11:41:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370983",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01">3a0958d</a></td><td><code>Implement actions using `_act_` instead of _call_</code></td></tr></table>




---

archive/issue_comments_370984.json:
```json
{
    "body": "Changed commit from **[800d30b](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)** to **[3a0958d](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)**",
    "created_at": "2018-11-26T11:41:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370984",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[800d30b](https://github.com/sagemath/sagetrac-mirror/commit/800d30b2d3ff09d00978b9223cbeff966d468f66)** to **[3a0958d](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)**



---

archive/issue_comments_370985.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,71 +3,3 @@\n The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to \"decode\" its arguments as `g` and `x`.\n \n Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.\n-\n-**Timings** (compared to before #24247 and #5574):\n-\n-Note: \"before\" timings are without #24247, #5574 and #24500. \"after\" timings are with #24247, #5574 and #24500.\n-\n-**GF(2<sup>n</sup>)<sup>ZZ</sup>**\n-\n-Before:\n-\n-```\n-sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 383 ns per loop\n-```\n-\n-After:\n-\n-```\n-sage: k.<a> = GF(4, impl=\"ntl\"); n = 2; timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 635 ns per loop\n-```\n-\n-**RDF<sup>ZZ</sup>**\n-\n-Before:\n-\n-```\n-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 156 ns per loop\n-```\n-\n-After:\n-\n-```\n-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)\n-100000 loops, best of 20: 185 ns per loop\n-```\n-\n-**ideal<sup>ZZ</sup>**\n-\n-Before:\n-\n-```\n-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 13.3 \u00b5s per loop\n-```\n-\n-After:\n-\n-```\n-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 14.1 \u00b5s per loop\n-```\n-\n-**AA<sup>QQ</sup>**\n-\n-Before:\n-\n-```\n-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 12.8 \u00b5s per loop\n-```\n-\n-After:\n-\n-```\n-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)\n-10000 loops, best of 20: 16.6 \u00b5s per loop\n-```\n``````\n",
    "created_at": "2018-11-26T11:41:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370985",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,71 +3,3 @@
 The current implementation using `_call_` takes a left and right argument. This is less efficient because many actions can be left or right actions. This means that every `_call_` method needs to "decode" its arguments as `g` and `x`.
 
 Work on #24247 shows that a significant amount of time is spent in `Action.__call__`. This ticket optimizes that quite a bit. It also adds documentation to `Action`.
-
-**Timings** (compared to before #24247 and #5574):
-
-Note: "before" timings are without #24247, #5574 and #24500. "after" timings are with #24247, #5574 and #24500.
-
-**GF(2<sup>n</sup>)<sup>ZZ</sup>**
-
-Before:
-
-```
-sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 383 ns per loop
-```
-
-After:
-
-```
-sage: k.<a> = GF(4, impl="ntl"); n = 2; timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 635 ns per loop
-```
-
-**RDF<sup>ZZ</sup>**
-
-Before:
-
-```
-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 156 ns per loop
-```
-
-After:
-
-```
-sage: a = RDF(2); n = ZZ(2); timeit('a ^ n', number=100000, repeat=20)
-100000 loops, best of 20: 185 ns per loop
-```
-
-**ideal<sup>ZZ</sup>**
-
-Before:
-
-```
-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 13.3 µs per loop
-```
-
-After:
-
-```
-sage: a = ZZ.ideal(2); n = ZZ(2); timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 14.1 µs per loop
-```
-
-**AA<sup>QQ</sup>**
-
-Before:
-
-```
-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 12.8 µs per loop
-```
-
-After:
-
-```
-sage: a = AA(8); n = 1/3; timeit('a ^ n', number=10000, repeat=20)
-10000 loops, best of 20: 16.6 µs per loop
-```
``````




---

archive/issue_events_339386.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339386"
}
```



---

archive/issue_events_339387.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339387"
}
```



---

archive/issue_comments_370986.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nLGTM. Sorry I let this ticket fall off my radar.",
    "created_at": "2018-11-27T02:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370986",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:28" align="right">comment:28</div>

LGTM. Sorry I let this ticket fall off my radar.



---

archive/issue_events_339388.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339388"
}
```



---

archive/issue_events_339389.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-11-27T02:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339389"
}
```



---

archive/issue_comments_370987.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2018-11-27T02:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370987",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_370988.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)** to **[3a0958d](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)**",
    "created_at": "2018-11-29T08:13:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24500#issuecomment-370988",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/optimize_action___call__](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/optimize_action___call__)** to **[3a0958d](https://github.com/sagemath/sagetrac-mirror/commit/3a0958dcb4da8ee91b28163172061666de38bd01)**



---

archive/issue_events_339390.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-29T08:13:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339390"
}
```



---

archive/issue_events_339391.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "76496dd14a768799bbb5db4407460f275fa36637",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-11-29T08:13:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24500",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24500#event-339391"
}
```
