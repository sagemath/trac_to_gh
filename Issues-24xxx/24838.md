# Issue 24838: Upgrade to pynac-0.7.22

archive/issues_024601.json:
```json
{
    "body": "In the new version:\n* fast and working versons of quo_rem and rational decomposition (#25644, #25645)\n* fix power inconsistency\n* internal fix of another power inconsistency (#25639)\n* `(x<sup>a)</sup>b --> x^(ab)` IF x real, a odd integer, ab integer\n* add `ex::treesize()` as complexity metric (#25643)\n* information for packagers\n\n* implement commutative matching; fix GiNaC's matching deficiencies (#25168)\n* substitute patternless if no wildcards present\n* remove some compiler warnings\n* update AX_CXX_COMPILE_STDCXX.m4 \n\n* fix `exp(c*f(x))` simplification\n* fix `cases(...).subs(...)`\n* `function::info` for `min/max_symbolic`(#21945)\n* performance and readability improvements\n\n* correct `sinh/cosh/tanh` return type (#24299)\n* `atan2` fixes\n* potential memleaks fixed\n* fixes in Giac interface\n* `subs` can now substitute numeric terms (#23964)\n\n* fix memleak in in-place PyObject numerics (#24745)\n* fix endless computation (#24883)\n* Python interface / Py3 fixes and improvements (thx Erik Bray, #24561, #24752, #24522)\n* fix internal `asin`/`acos` of complex balls\n* draw factors out of `add^rational` (#24768, #25251, #25252)\n* `exp(f(x))`, `exp(c*f(x))`, f inv. hyperbolic simplifications (#24841)\n* always extend trig/hyperbolic functions to complex domain (#24428)\n* extensive code readability improvements\n\nhttps://github.com/pynac/pynac/releases/download/pynac-0.7.22/pynac-0.7.22.tar.bz2\n\nCC:  @kiwifb @timokau\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Ralf Stephan\n\nBranch: e324b642c1f7c7cb98eea400abfe7c9a4296fcca\n\nDependencies: #24927\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/24838\n\n",
    "closed_at": "2018-06-29T22:33:33Z",
    "created_at": "2018-02-26T14:06:03Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Upgrade to pynac-0.7.22",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24838",
    "user": "https://github.com/rwst"
}
```
In the new version:
* fast and working versons of quo_rem and rational decomposition (#25644, #25645)
* fix power inconsistency
* internal fix of another power inconsistency (#25639)
* `(x<sup>a)</sup>b --> x^(ab)` IF x real, a odd integer, ab integer
* add `ex::treesize()` as complexity metric (#25643)
* information for packagers

* implement commutative matching; fix GiNaC's matching deficiencies (#25168)
* substitute patternless if no wildcards present
* remove some compiler warnings
* update AX_CXX_COMPILE_STDCXX.m4 

* fix `exp(c*f(x))` simplification
* fix `cases(...).subs(...)`
* `function::info` for `min/max_symbolic`(#21945)
* performance and readability improvements

* correct `sinh/cosh/tanh` return type (#24299)
* `atan2` fixes
* potential memleaks fixed
* fixes in Giac interface
* `subs` can now substitute numeric terms (#23964)

* fix memleak in in-place PyObject numerics (#24745)
* fix endless computation (#24883)
* Python interface / Py3 fixes and improvements (thx Erik Bray, #24561, #24752, #24522)
* fix internal `asin`/`acos` of complex balls
* draw factors out of `add^rational` (#24768, #25251, #25252)
* `exp(f(x))`, `exp(c*f(x))`, f inv. hyperbolic simplifications (#24841)
* always extend trig/hyperbolic functions to complex domain (#24428)
* extensive code readability improvements

https://github.com/pynac/pynac/releases/download/pynac-0.7.22/pynac-0.7.22.tar.bz2

CC:  @kiwifb @timokau

Reviewer: Frédéric Chapoton

Author: Ralf Stephan

Branch: e324b642c1f7c7cb98eea400abfe7c9a4296fcca

Dependencies: #24927

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/24838





---

archive/issue_comments_344677.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2018-02-26T14:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344677",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_344678.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-26T14:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344678",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_344679.json:
```json
{
    "body": "<a id='comment:5'></a>Just a question: is this supposed to fix #24522 too?",
    "created_at": "2018-03-02T13:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344679",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Just a question: is this supposed to fix #24522 too?



---

archive/issue_comments_344680.json:
```json
{
    "body": "<a id='comment:6'></a>Yes, that PR is merged. I'll probably add a hotfix for #24883 here as patch, too.",
    "created_at": "2018-03-02T14:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344680",
    "user": "https://github.com/rwst"
}
```

<a id='comment:6'></a>Yes, that PR is merged. I'll probably add a hotfix for #24883 here as patch, too.



---

archive/issue_comments_344681.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 rws]:\n> I'll probably add a hotfix for #24883 here as patch, too. \n\n\nThen I'm setting this to needs_work. If you change your mind, feel free to set this back to needs_review.",
    "created_at": "2018-03-02T14:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344681",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>Replying to [comment:6 rws]:
> I'll probably add a hotfix for #24883 here as patch, too. 


Then I'm setting this to needs_work. If you change your mind, feel free to set this back to needs_review.



---

archive/issue_comments_344682.json:
```json
{
    "body": "<a id='comment:8'></a>The issue is no longer there. Please review.",
    "created_at": "2018-03-02T14:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344682",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>The issue is no longer there. Please review.



---

archive/issue_comments_344683.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-02T16:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344683",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344684.json:
```json
{
    "body": "<a id='comment:9'></a>This used to return a purely imaginary number, now there is a small real part:\n\n```\nsage: arccosh(x).subs(x=0.9)\n-9.66146955461936e-22 + 0.451026811796262*I\n```",
    "created_at": "2018-03-02T16:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344684",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>This used to return a purely imaginary number, now there is a small real part:

```
sage: arccosh(x).subs(x=0.9)
-9.66146955461936e-22 + 0.451026811796262*I
```



---

archive/issue_comments_344685.json:
```json
{
    "body": "<a id='comment:10'></a>This is an artifact of conversion to CC:\n\n```\nsage: CC(ComplexBallField(68)(0.9).arccosh())\n-9.66146955461936e-22 + 0.451026811796262*I\n```\nWe use arb with precision+15 and convert back to parent, all to make up for missing or limited (in the calculus sense, not the algebraic, note recent discussion) member functions of parent (RR in this case). Before this pynac version we had specific logic to zero the real part but this was error-prone. IMHO CC conversion of complex balls should be fixed.",
    "created_at": "2018-03-03T09:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344685",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>This is an artifact of conversion to CC:

```
sage: CC(ComplexBallField(68)(0.9).arccosh())
-9.66146955461936e-22 + 0.451026811796262*I
```
We use arb with precision+15 and convert back to parent, all to make up for missing or limited (in the calculus sense, not the algebraic, note recent discussion) member functions of parent (RR in this case). Before this pynac version we had specific logic to zero the real part but this was error-prone. IMHO CC conversion of complex balls should be fixed.



---

archive/issue_comments_344686.json:
```json
{
    "body": "<a id='comment:11'></a>See also https://github.com/fredrik-johansson/arb/issues/198",
    "created_at": "2018-03-03T09:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344686",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'></a>See also https://github.com/fredrik-johansson/arb/issues/198



---

archive/issue_comments_344687.json:
```json
{
    "body": "<a id='comment:12'></a>You may also want to know why I'm using arb and not mpfr:\n\n```\nsage: r=srange(-2.5,2.5,.01)\nsage: rr = [CC(i) for i in r]\nsage: %timeit for x in rr: _=x.arccosh()\n100 loops, best of 3: 11.9 ms per loop\nsage: rr = [CBF(i) for i in r]\nsage: %timeit for x in rr: _=x.arccosh()\n1000 loops, best of 3: 649 \u00b5s per loop\n```",
    "created_at": "2018-03-03T14:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344687",
    "user": "https://github.com/rwst"
}
```

<a id='comment:12'></a>You may also want to know why I'm using arb and not mpfr:

```
sage: r=srange(-2.5,2.5,.01)
sage: rr = [CC(i) for i in r]
sage: %timeit for x in rr: _=x.arccosh()
100 loops, best of 3: 11.9 ms per loop
sage: rr = [CBF(i) for i in r]
sage: %timeit for x in rr: _=x.arccosh()
1000 loops, best of 3: 649 µs per loop
```



---

archive/issue_comments_344688.json:
```json
{
    "body": "<a id='comment:13'></a>What do you prefer, patching arb or the arb interface?",
    "created_at": "2018-03-04T07:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344688",
    "user": "https://github.com/rwst"
}
```

<a id='comment:13'></a>What do you prefer, patching arb or the arb interface?



---

archive/issue_comments_344689.json:
```json
{
    "body": "<a id='comment:14'></a>See https://github.com/fredrik-johansson/arb/pull/210",
    "created_at": "2018-03-04T08:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344689",
    "user": "https://github.com/rwst"
}
```

<a id='comment:14'></a>See https://github.com/fredrik-johansson/arb/pull/210



---

archive/issue_comments_344690.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:12 rws]:\n> You may also want to know why I'm using arb and not mpfr:\n\n\nDespite what you think, you are not using mpfr, but PARI:\n\n```python\n    def arccosh(self):\n        \"\"\"\n        Return the hyperbolic arccosine of ``self``.\n\n        EXAMPLES::\n\n            sage: (1+CC(I)).arccosh()\n            1.06127506190504 + 0.904556894302381*I\n        \"\"\"\n        return self._parent(self.__pari__().acosh())\n```\n\nIf you want to compare with something, it should be mpc (in Sage: `CC = MPComplexField(53)`)",
    "created_at": "2018-03-04T08:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344690",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>Replying to [comment:12 rws]:
> You may also want to know why I'm using arb and not mpfr:


Despite what you think, you are not using mpfr, but PARI:

```python
    def arccosh(self):
        """
        Return the hyperbolic arccosine of ``self``.

        EXAMPLES::

            sage: (1+CC(I)).arccosh()
            1.06127506190504 + 0.904556894302381*I
        """
        return self._parent(self.__pari__().acosh())
```

If you want to compare with something, it should be mpc (in Sage: `CC = MPComplexField(53)`)



---

archive/issue_comments_344691.json:
```json
{
    "body": "<a id='comment:16'></a>Interestingly,\n\n```\nsage: arccosh(x).subs(x=MPComplexField(53)(0.9))\n...\nTypeError: no canonical coercion from Complex Field with 53 bits of precision to Symbolic Ring\n```",
    "created_at": "2018-03-04T09:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344691",
    "user": "https://github.com/rwst"
}
```

<a id='comment:16'></a>Interestingly,

```
sage: arccosh(x).subs(x=MPComplexField(53)(0.9))
...
TypeError: no canonical coercion from Complex Field with 53 bits of precision to Symbolic Ring
```



---

archive/issue_comments_344692.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:14 rws]:\n> See https://github.com/fredrik-johansson/arb/pull/210\n\n\nThis is now merged. Do we want that patch in this ticket? If not, anything else?",
    "created_at": "2018-03-05T15:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344692",
    "user": "https://github.com/rwst"
}
```

<a id='comment:17'></a>Replying to [comment:14 rws]:
> See https://github.com/fredrik-johansson/arb/pull/210


This is now merged. Do we want that patch in this ticket? If not, anything else?



---

archive/issue_comments_344693.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-10T08:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344693",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344694.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-22T07:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344695.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-22T07:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344695",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344696.json:
```json
{
    "body": "<a id='comment:20'></a>New release incoming.",
    "created_at": "2018-03-22T07:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344696",
    "user": "https://github.com/rwst"
}
```

<a id='comment:20'></a>New release incoming.



---

archive/issue_comments_344697.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-23T07:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344698.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-23T07:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344698",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344699.json:
```json
{
    "body": "<a id='comment:25'></a>0.7.17 introduced a bug in `exp(ex*log(x))` simplification, and we need a new release, anyway.",
    "created_at": "2018-04-07T16:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344699",
    "user": "https://github.com/rwst"
}
```

<a id='comment:25'></a>0.7.17 introduced a bug in `exp(ex*log(x))` simplification, and we need a new release, anyway.



---

archive/issue_comments_344700.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-04-07T16:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344700",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344701.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-08T12:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344702.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-08T12:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344702",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344703.json:
```json
{
    "body": "<a id='comment:29'></a>This looks fishy:\n\n```diff\n-            sage: SR(CDF(1/2)).arccosh()  # rel tol 1e-15\n+            sage: SR(CDF(1/2)).arccosh() # abs tol 1e-15\n```",
    "created_at": "2018-04-23T13:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344703",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>This looks fishy:

```diff
-            sage: SR(CDF(1/2)).arccosh()  # rel tol 1e-15
+            sage: SR(CDF(1/2)).arccosh() # abs tol 1e-15
```



---

archive/issue_comments_344704.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-04-23T14:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344704",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344705.json:
```json
{
    "body": "<a id='comment:30'></a>The analogous thing as [comment:9] should be fixed for pure imaginary results:\n\n```\nsage: CDF(1/2).arccosh()\n1.0471975511965979*I\nsage: SR(CDF(1/2)).arccosh()\n-6.372599439108525e-21 + 1.0471975511965979*I\n```\nThen you also revert [comment:29]",
    "created_at": "2018-04-23T14:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344705",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>The analogous thing as [comment:9] should be fixed for pure imaginary results:

```
sage: CDF(1/2).arccosh()
1.0471975511965979*I
sage: SR(CDF(1/2)).arccosh()
-6.372599439108525e-21 + 1.0471975511965979*I
```
Then you also revert [comment:29]



---

archive/issue_comments_344706.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:30 jdemeyer]:\n> The analogous thing as [comment:9] should be fixed for pure imaginary results:\n> \n> ```\n> sage: CDF(1/2).arccosh()\n> 1.0471975511965979*I\n> sage: SR(CDF(1/2)).arccosh()\n> -6.372599439108525e-21 + 1.0471975511965979*I\n> ```\n\n\nAs explained in [comment:10] missing FP functionality is gained using arb. But there was that bug in arb which is now fixed. Consequentially we need that fix or a recent arb to get the right result, see [comment:14].\n\n> Then you also revert [comment:29]\n\n\nWill re-revert.",
    "created_at": "2018-04-30T13:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344706",
    "user": "https://github.com/rwst"
}
```

<a id='comment:32'></a>Replying to [comment:30 jdemeyer]:
> The analogous thing as [comment:9] should be fixed for pure imaginary results:
> 
> ```
> sage: CDF(1/2).arccosh()
> 1.0471975511965979*I
> sage: SR(CDF(1/2)).arccosh()
> -6.372599439108525e-21 + 1.0471975511965979*I
> ```


As explained in [comment:10] missing FP functionality is gained using arb. But there was that bug in arb which is now fixed. Consequentially we need that fix or a recent arb to get the right result, see [comment:14].

> Then you also revert [comment:29]


Will re-revert.



---

archive/issue_comments_344707.json:
```json
{
    "body": "<a id='comment:34'></a>I confirm that this works with https://github.com/fredrik-johansson/arb/commit/7afd3bfaf1697739751d96d3665ef83e78c76820 applied, which is in arb-2.13.0 (#24927).",
    "created_at": "2018-04-30T13:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344707",
    "user": "https://github.com/rwst"
}
```

<a id='comment:34'></a>I confirm that this works with https://github.com/fredrik-johansson/arb/commit/7afd3bfaf1697739751d96d3665ef83e78c76820 applied, which is in arb-2.13.0 (#24927).



---

archive/issue_comments_344708.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-30T14:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344709.json:
```json
{
    "body": "<a id='comment:36'></a>Some recent Sage commit makes doctests (involving powers of `I`) fail together with pynac-0.7.17 so we'll need a fix in 0.7.20.",
    "created_at": "2018-05-29T05:46:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344709",
    "user": "https://github.com/rwst"
}
```

<a id='comment:36'></a>Some recent Sage commit makes doctests (involving powers of `I`) fail together with pynac-0.7.17 so we'll need a fix in 0.7.20.



---

archive/issue_comments_344710.json:
```json
{
    "body": "<a id='comment:37'></a>Actually it's not our fault: #25458.",
    "created_at": "2018-05-29T06:03:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344710",
    "user": "https://github.com/rwst"
}
```

<a id='comment:37'></a>Actually it's not our fault: #25458.



---

archive/issue_comments_344711.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-29T07:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_062428.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-06-24T07:32:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24838#event-62428"
}
```



---

archive/issue_comments_344712.json:
```json
{
    "body": "<a id='comment:43'></a>The dependency is now in. Here a fresh branch with the newest Pynac.\n\n---\nNew commits:",
    "created_at": "2018-06-24T07:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344712",
    "user": "https://github.com/rwst"
}
```

<a id='comment:43'></a>The dependency is now in. Here a fresh branch with the newest Pynac.

---
New commits:



---

archive/issue_comments_344713.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-24T07:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344713",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344714.json:
```json
{
    "body": "<a id='comment:45'></a>I got \"invalid checksum\"",
    "created_at": "2018-06-24T12:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344714",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:45'></a>I got "invalid checksum"



---

archive/issue_comments_344715.json:
```json
{
    "body": "<a id='comment:46'></a>Please check again, I just now did not get any error with the file linked in the ticket. Did you reload the branch?",
    "created_at": "2018-06-24T14:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344715",
    "user": "https://github.com/rwst"
}
```

<a id='comment:46'></a>Please check again, I just now did not get any error with the file linked in the ticket. Did you reload the branch?



---

archive/issue_comments_344716.json:
```json
{
    "body": "<a id='comment:47'></a>Indeed. Works now. I must have made some mistake in my previous attempt.",
    "created_at": "2018-06-24T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344716",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:47'></a>Indeed. Works now. I must have made some mistake in my previous attempt.



---

archive/issue_comments_344717.json:
```json
{
    "body": "<a id='comment:48'></a>got\n\n```\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 2 doctests failed\nsage -t --long src/sage/symbolic/expression.pyx  # 1 doctest failed\n```",
    "created_at": "2018-06-24T16:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344717",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:48'></a>got

```
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 2 doctests failed
sage -t --long src/sage/symbolic/expression.pyx  # 1 doctest failed
```



---

archive/issue_comments_344718.json:
```json
{
    "body": "<a id='comment:49'></a>```\nDoctesting 2 files.\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 153, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    F1.asymptotics(p, alpha, 2)\nExpected:\n    (-3*((2*a^2 - 5*a*b + 2*b^2)*r^2 + (a + b)*r + 3)*((1/3)^(-a)*(1/3)^(-b))^r,\n     (1/3)^(-a)*(1/3)^(-b), -3*(2*a^2 - 5*a*b + 2*b^2)*r^2 - 3*(a + b)*r - 9)\nGot:\n    (-3*((2*a^2 - 5*a*b + 2*b^2)*r^2 + (a + b)*r + 3)*(1/((1/3)^a*(1/3)^b))^r,\n     1/((1/3)^a*(1/3)^b),\n     -3*(2*a^2 - 5*a*b + 2*b^2)*r^2 - 3*(a + b)*r - 9)\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 2161, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    F.asymptotics_multiple(p, alpha, 2, var('r')) # long time\nExpected:\n    (3*((1/3)^(-a)*(1/3)^(-b))^r*e^(2/3), (1/3)^(-a)*(1/3)^(-b), 3*e^(2/3))\nGot:\n    (3*(1/((1/3)^a*(1/3)^b))^r*e^(2/3), 1/((1/3)^a*(1/3)^b), 3*e^(2/3))\n**********************************************************************\n2 items had failures:\n   1 of  77 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\n```\nand\n\n```\nFailed example:\n    SR(CDF(1/2)).arccosh() #  rel tol 1e-15\nExpected:\n    1.0471975511965976*I\nGot:\n    -6.372599439108525e-21 + 1.0471975511965979*I\n```",
    "created_at": "2018-06-24T16:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344718",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:49'></a>```
Doctesting 2 files.
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 153, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    F1.asymptotics(p, alpha, 2)
Expected:
    (-3*((2*a^2 - 5*a*b + 2*b^2)*r^2 + (a + b)*r + 3)*((1/3)^(-a)*(1/3)^(-b))^r,
     (1/3)^(-a)*(1/3)^(-b), -3*(2*a^2 - 5*a*b + 2*b^2)*r^2 - 3*(a + b)*r - 9)
Got:
    (-3*((2*a^2 - 5*a*b + 2*b^2)*r^2 + (a + b)*r + 3)*(1/((1/3)^a*(1/3)^b))^r,
     1/((1/3)^a*(1/3)^b),
     -3*(2*a^2 - 5*a*b + 2*b^2)*r^2 - 3*(a + b)*r - 9)
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 2161, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    F.asymptotics_multiple(p, alpha, 2, var('r')) # long time
Expected:
    (3*((1/3)^(-a)*(1/3)^(-b))^r*e^(2/3), (1/3)^(-a)*(1/3)^(-b), 3*e^(2/3))
Got:
    (3*(1/((1/3)^a*(1/3)^b))^r*e^(2/3), 1/((1/3)^a*(1/3)^b), 3*e^(2/3))
**********************************************************************
2 items had failures:
   1 of  77 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
```
and

```
Failed example:
    SR(CDF(1/2)).arccosh() #  rel tol 1e-15
Expected:
    1.0471975511965976*I
Got:
    -6.372599439108525e-21 + 1.0471975511965979*I
```



---

archive/issue_comments_344719.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 chapoton]:\n> {{{\n> Failed example:\n>     SR(CDF(1/2)).arccosh() #  rel tol 1e-15\n> Expected:\n>     1.0471975511965976*I\n> Got:\n>     -6.372599439108525e-21 + 1.0471975511965979*I\n> }}}\n\n\nNot confirmed. You apparently don't have the dependency installed, the newest arb.",
    "created_at": "2018-06-25T05:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344719",
    "user": "https://github.com/rwst"
}
```

<a id='comment:50'></a>Replying to [comment:49 chapoton]:
> {{{
> Failed example:
>     SR(CDF(1/2)).arccosh() #  rel tol 1e-15
> Expected:
>     1.0471975511965976*I
> Got:
>     -6.372599439108525e-21 + 1.0471975511965979*I
> }}}


Not confirmed. You apparently don't have the dependency installed, the newest arb.



---

archive/issue_comments_344720.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-25T05:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344721.json:
```json
{
    "body": "<a id='comment:52'></a>The second doctest is still failing for me.\n\n```\nsage: version()\n'SageMath version 8.3.beta7, Release Date: 2018-06-23'\nsage: package_versions('standard')['arb']\n('2.13.0', '2.13.0')\n```",
    "created_at": "2018-06-25T08:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344721",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:52'></a>The second doctest is still failing for me.

```
sage: version()
'SageMath version 8.3.beta7, Release Date: 2018-06-23'
sage: package_versions('standard')['arb']
('2.13.0', '2.13.0')
```



---

archive/issue_comments_344722.json:
```json
{
    "body": "<a id='comment:53'></a>Replying to [comment:52 chapoton]:\n> The second doctest is still failing for me.\n\n\nCan you please give the output of:\n\n```\nsage: CDF(1/2).arccosh()\n1.0471975511965979*I\nsage: CBF(1/2).arccosh()\n[1.047197551196598 +/- 7.94e-16]*I\n```",
    "created_at": "2018-06-25T12:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344722",
    "user": "https://github.com/rwst"
}
```

<a id='comment:53'></a>Replying to [comment:52 chapoton]:
> The second doctest is still failing for me.


Can you please give the output of:

```
sage: CDF(1/2).arccosh()
1.0471975511965979*I
sage: CBF(1/2).arccosh()
[1.047197551196598 +/- 7.94e-16]*I
```



---

archive/issue_comments_344723.json:
```json
{
    "body": "<a id='comment:54'></a>```\nsage: CDF(1/2).arccosh()\n1.0471975511965979*I\nsage: CBF(1/2).arccosh()\n[+/- 4.90e-16] + [1.047197551196598 +/- 7.94e-16]*I\n```",
    "created_at": "2018-06-25T12:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344723",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:54'></a>```
sage: CDF(1/2).arccosh()
1.0471975511965979*I
sage: CBF(1/2).arccosh()
[+/- 4.90e-16] + [1.047197551196598 +/- 7.94e-16]*I
```



---

archive/issue_comments_344724.json:
```json
{
    "body": "<a id='comment:55'></a>This is peculiar. I was under the impression that this fix: https://github.com/fredrik-johansson/arb/commit/7afd3bfaf1697739751d96d3665ef83e78c76820 would be in arb-2.13.0. I just found out that it was committed Mar 5, while the release was Feb 23. I should have actively propagated that patch into our arb upgrade ticket.\n\nShould I open a separate ticket for the arb patch or just put it into this branch?\n\nI would have noticed earlier but for some reason I don't get the error with 2.13.0.",
    "created_at": "2018-06-25T13:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344724",
    "user": "https://github.com/rwst"
}
```

<a id='comment:55'></a>This is peculiar. I was under the impression that this fix: https://github.com/fredrik-johansson/arb/commit/7afd3bfaf1697739751d96d3665ef83e78c76820 would be in arb-2.13.0. I just found out that it was committed Mar 5, while the release was Feb 23. I should have actively propagated that patch into our arb upgrade ticket.

Should I open a separate ticket for the arb patch or just put it into this branch?

I would have noticed earlier but for some reason I don't get the error with 2.13.0.



---

archive/issue_comments_344725.json:
```json
{
    "body": "<a id='comment:56'></a>Ah, I had the patch still in the patches directory. New files are not deleted when changing branches.",
    "created_at": "2018-06-25T13:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344725",
    "user": "https://github.com/rwst"
}
```

<a id='comment:56'></a>Ah, I had the patch still in the patches directory. New files are not deleted when changing branches.



---

archive/issue_comments_344726.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-25T14:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344727.json:
```json
{
    "body": "<a id='comment:58'></a>This is reviewed by Fredrik in https://github.com/fredrik-johansson/arb/pull/210",
    "created_at": "2018-06-25T14:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344727",
    "user": "https://github.com/rwst"
}
```

<a id='comment:58'></a>This is reviewed by Fredrik in https://github.com/fredrik-johansson/arb/pull/210



---

archive/issue_comments_344728.json:
```json
{
    "body": "<a id='comment:59'></a>This should bump the arb version by `.p0`",
    "created_at": "2018-06-25T15:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344728",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:59'></a>This should bump the arb version by `.p0`



---

archive/issue_comments_344729.json:
```json
{
    "body": "<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-25T15:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344729",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344730.json:
```json
{
    "body": "<a id='comment:61'></a>Thanks. This should be ready to go.\n\nLaunching now \"make ptestlong\" once again, just to be sure.",
    "created_at": "2018-06-25T15:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344730",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:61'></a>Thanks. This should be ready to go.

Launching now "make ptestlong" once again, just to be sure.



---

archive/issue_comments_344731.json:
```json
{
    "body": "<a id='comment:62'></a>ok, all tests pass",
    "created_at": "2018-06-25T16:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344731",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:62'></a>ok, all tests pass



---

archive/issue_comments_344732.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-25T16:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344732",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_344733.json:
```json
{
    "body": "<a id='comment:63'></a>Thanks for the review!",
    "created_at": "2018-06-26T05:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344733",
    "user": "https://github.com/rwst"
}
```

<a id='comment:63'></a>Thanks for the review!



---

archive/issue_comments_344734.json:
```json
{
    "body": "<a id='comment:64'></a>On 32-bit:\n\n```\nFile \"src/sage/functions/hypergeometric.py\", line 148, in sage.functions.hypergeometric\nFailed example:\n    hypergeometric_U(2, 2, x).series(x == 3, 100).subs(x=1).n()\nExpected:\n    0.403652637676806\nGot:\n    0.403651580752398\n```",
    "created_at": "2018-06-27T06:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344734",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:64'></a>On 32-bit:

```
File "src/sage/functions/hypergeometric.py", line 148, in sage.functions.hypergeometric
Failed example:
    hypergeometric_U(2, 2, x).series(x == 3, 100).subs(x=1).n()
Expected:
    0.403652637676806
Got:
    0.403651580752398
```



---

archive/issue_comments_344735.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-06-27T06:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344735",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_344736.json:
```json
{
    "body": "<a id='comment:65'></a>Replying to [comment:64 vbraun]:\n> On 32-bit:\n> \n> ```\n> File \"src/sage/functions/hypergeometric.py\", line 148, in sage.functions.hypergeometric\n> Failed example:\n>     hypergeometric_U(2, 2, x).series(x == 3, 100).subs(x=1).n()\n> Expected:\n>     0.403652637676806\n> Got:\n>     0.403651580752398\n> ```\n\n\nPynac is not involved in the numerics (`hypergeometric_U` is not a `GinacFunction`), so the hypothesis is that the expression before `.n()` is different with 32bit pynac-0.7.22.",
    "created_at": "2018-06-27T15:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344736",
    "user": "https://github.com/rwst"
}
```

<a id='comment:65'></a>Replying to [comment:64 vbraun]:
> On 32-bit:
> 
> ```
> File "src/sage/functions/hypergeometric.py", line 148, in sage.functions.hypergeometric
> Failed example:
>     hypergeometric_U(2, 2, x).series(x == 3, 100).subs(x=1).n()
> Expected:
>     0.403652637676806
> Got:
>     0.403651580752398
> ```


Pynac is not involved in the numerics (`hypergeometric_U` is not a `GinacFunction`), so the hypothesis is that the expression before `.n()` is different with 32bit pynac-0.7.22.



---

archive/issue_comments_344737.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:65 rws]:\n> Replying to [comment:64 vbraun]:\n> > On 32-bit:\n\n> \n> Pynac is not involved in the numerics (`hypergeometric_U` is not a `GinacFunction`), so the hypothesis is that the expression before `.n()` is different with 32bit pynac-0.7.22.\n\n\nWe will never know. I failed to install 32bit versions of CentOS and ArchLinux in a VM, and I will not try again. There will be a ticket for this doctest failure, and the test marked \"known bug (see ...\".",
    "created_at": "2018-06-28T14:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344737",
    "user": "https://github.com/rwst"
}
```

<a id='comment:67'></a>Replying to [comment:65 rws]:
> Replying to [comment:64 vbraun]:
> > On 32-bit:

> 
> Pynac is not involved in the numerics (`hypergeometric_U` is not a `GinacFunction`), so the hypothesis is that the expression before `.n()` is different with 32bit pynac-0.7.22.


We will never know. I failed to install 32bit versions of CentOS and ArchLinux in a VM, and I will not try again. There will be a ticket for this doctest failure, and the test marked "known bug (see ...".



---

archive/issue_comments_344738.json:
```json
{
    "body": "<a id='comment:68'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T14:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344739.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-06-28T14:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344739",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_344740.json:
```json
{
    "body": "<a id='comment:70'></a>This isn't really about this specific ticket (thanks for putting in the work for the upgrade), but is there a reason everybody seems to make seperate \"pkg version / chksum\" and \"doctest fixes\" patches?\n\nShouldn't each commit be one unit of changes for which the doctests still pass?",
    "created_at": "2018-06-28T20:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344740",
    "user": "https://github.com/timokau"
}
```

<a id='comment:70'></a>This isn't really about this specific ticket (thanks for putting in the work for the upgrade), but is there a reason everybody seems to make seperate "pkg version / chksum" and "doctest fixes" patches?

Shouldn't each commit be one unit of changes for which the doctests still pass?



---

archive/issue_comments_344741.json:
```json
{
    "body": "<a id='comment:71'></a>Replying to [comment:70 gh-timokau]:\n> Shouldn't each commit be one unit of changes for which the doctests still pass?\n\n\nThe only reason I see for this is to make statistics based on number of commits meaningful. By splitting commits into parts (if there is such a natural split, maybe here it's less needed) I make the job of reviewing easier.",
    "created_at": "2018-06-29T05:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344741",
    "user": "https://github.com/rwst"
}
```

<a id='comment:71'></a>Replying to [comment:70 gh-timokau]:
> Shouldn't each commit be one unit of changes for which the doctests still pass?


The only reason I see for this is to make statistics based on number of commits meaningful. By splitting commits into parts (if there is such a natural split, maybe here it's less needed) I make the job of reviewing easier.



---

archive/issue_comments_344742.json:
```json
{
    "body": "<a id='comment:72'></a>Replying to [comment:71 rws]:\n> Replying to [comment:70 gh-timokau]:\n> > Shouldn't each commit be one unit of changes for which the doctests still pass?\n\n> \n> The only reason I see for this is to make statistics based on number of commits meaningful. By splitting commits into parts (if there is such a natural split, maybe here it's less needed) I make the job of reviewing easier.\n\n\nA much more practical reason is the use of `git-bisect` or just generally being able to check out some interesting commit and build from it.",
    "created_at": "2018-06-29T13:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344742",
    "user": "https://github.com/timokau"
}
```

<a id='comment:72'></a>Replying to [comment:71 rws]:
> Replying to [comment:70 gh-timokau]:
> > Shouldn't each commit be one unit of changes for which the doctests still pass?

> 
> The only reason I see for this is to make statistics based on number of commits meaningful. By splitting commits into parts (if there is such a natural split, maybe here it's less needed) I make the job of reviewing easier.


A much more practical reason is the use of `git-bisect` or just generally being able to check out some interesting commit and build from it.



---

archive/issue_events_062429.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-29T22:33:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24838#event-62429"
}
```



---

archive/issue_comments_344743.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-29T22:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344743",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_344744.json:
```json
{
    "body": "<a id='comment:74'></a>Replying to [comment:57 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                 |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n> |[6645f79](https://git.sagemath.org/sage.git/commit/?id=6645f7923ee5bdd97219b0a475e3ae98e03de4e8)|`24838: add arb commit 7afd3afbf`|\n\n\nFor the future it would greatly simplify packaging if you would add some documentation when adding a patch. A link to the github issue/pr and maybe a sentence about what it does would be sufficient. (The commit is actually 7afd3bfaf)",
    "created_at": "2018-06-30T11:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344744",
    "user": "https://github.com/timokau"
}
```

<a id='comment:74'></a>Replying to [comment:57 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                 |
> |-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
> |[6645f79](https://git.sagemath.org/sage.git/commit/?id=6645f7923ee5bdd97219b0a475e3ae98e03de4e8)|`24838: add arb commit 7afd3afbf`|


For the future it would greatly simplify packaging if you would add some documentation when adding a patch. A link to the github issue/pr and maybe a sentence about what it does would be sufficient. (The commit is actually 7afd3bfaf)



---

archive/issue_comments_344745.json:
```json
{
    "body": "<a id='comment:75'></a>Replying to [comment:74 gh-timokau]:\n> For the future it would greatly simplify packaging if you would add some documentation when adding a patch. A link to the github issue/pr and maybe a sentence about what it does would be sufficient. (The commit is actually 7afd3bfaf)\n\n\n+1\n\nPatches without any documentation or links should be rejected.",
    "created_at": "2018-06-30T11:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24838#issuecomment-344745",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:75'></a>Replying to [comment:74 gh-timokau]:
> For the future it would greatly simplify packaging if you would add some documentation when adding a patch. A link to the github issue/pr and maybe a sentence about what it does would be sufficient. (The commit is actually 7afd3bfaf)


+1

Patches without any documentation or links should be rejected.
