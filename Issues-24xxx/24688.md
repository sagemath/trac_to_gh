# Issue 24688: implement Faltings height of an elliptic curve

archive/issues_024451.json:
```json
{
    "body": "The goal of this ticket is to be able to determine the Faltings height of an elliptic curve.\n\n**CC:**  @JohnCremona @nbruin\n\n**Keywords:** elliptic curves, faltings height\n\n**Branch/Commit:** [d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51](https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51)\n\n**Reviewer:** Peter Bruin, John Cremona, Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Kevin Lui, John Cremona\n\nIssue created by migration from https://trac.sagemath.org/ticket/24688\n\n",
    "closed_at": "2021-03-20T20:54:51Z",
    "created_at": "2018-02-08T02:03:05Z",
    "labels": [
        "component: elliptic curves",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "title": "implement Faltings height of an elliptic curve",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/24688",
    "user": "https://github.com/kevinywlui"
}
```
The goal of this ticket is to be able to determine the Faltings height of an elliptic curve.

**CC:**  @JohnCremona @nbruin

**Keywords:** elliptic curves, faltings height

**Branch/Commit:** [d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51](https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51)

**Reviewer:** Peter Bruin, John Cremona, Frédéric Chapoton

**Author:** Kevin Lui, John Cremona

Issue created by migration from https://trac.sagemath.org/ticket/24688





---

archive/issue_comments_377690.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-The goal of this ticket is to be able to determine the falting height of an elliptic curve.\n+~~ The goal of this ticket is to be able to determine the falting height of an elliptic curve. ~~ Maybe this has already been done?\n``````\n",
    "created_at": "2018-02-08T21:45:23Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377690",
    "user": "https://github.com/kevinywlui"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-The goal of this ticket is to be able to determine the falting height of an elliptic curve.
+~~ The goal of this ticket is to be able to determine the falting height of an elliptic curve. ~~ Maybe this has already been done?
``````




---

archive/issue_events_218836.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T23:00:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "rename": {
        "from": "implement falting height of an elliptic curve",
        "to": "implement faltings height of an elliptic curve"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218836"
}
```



---

archive/issue_events_218837.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T23:00:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218837"
}
```



---

archive/issue_comments_377691.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-~~ The goal of this ticket is to be able to determine the falting height of an elliptic curve. ~~ Maybe this has already been done?\n+The goal of this ticket is to be able to determine the faltings height of an elliptic curve.\n``````\n",
    "created_at": "2018-02-08T23:00:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377691",
    "user": "https://github.com/kevinywlui"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-~~ The goal of this ticket is to be able to determine the falting height of an elliptic curve. ~~ Maybe this has already been done?
+The goal of this ticket is to be able to determine the faltings height of an elliptic curve.
``````




---

archive/issue_comments_377692.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"elliptic curves, faltings height\".",
    "created_at": "2018-02-08T23:00:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377692",
    "user": "https://github.com/kevinywlui"
}
```

**Changing keywords** from "" to "elliptic curves, faltings height".



---

archive/issue_events_218838.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T23:00:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "minor",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218838"
}
```



---

archive/issue_events_218839.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-02-08T23:00:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "component: elliptic curves",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218839"
}
```



---

archive/issue_comments_377693.json:
```json
{
    "body": "**Branch:** [u/klui/implement_falting_height_of_an_elliptic_curve](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/implement_falting_height_of_an_elliptic_curve)",
    "created_at": "2018-02-09T06:01:07Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377693",
    "user": "https://github.com/kevinywlui"
}
```

**Branch:** [u/klui/implement_falting_height_of_an_elliptic_curve](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/implement_falting_height_of_an_elliptic_curve)



---

archive/issue_comments_377694.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3066ce2220af69343dae716c849e343cbf5778e2\">3066ce2</a></td><td><code>changed 1/2 to 0.5 and have the result depend on the models as is done in Magma</code></td></tr></table>\n",
    "created_at": "2018-04-24T19:18:58Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3066ce2220af69343dae716c849e343cbf5778e2">3066ce2</a></td><td><code>changed 1/2 to 0.5 and have the result depend on the models as is done in Magma</code></td></tr></table>




---

archive/issue_comments_377695.json:
```json
{
    "body": "**Commit:** [3066ce2220af69343dae716c849e343cbf5778e2](https://github.com/sagemath/sagetrac-mirror/commit/3066ce2220af69343dae716c849e343cbf5778e2)",
    "created_at": "2018-04-24T19:18:58Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377695",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [3066ce2220af69343dae716c849e343cbf5778e2](https://github.com/sagemath/sagetrac-mirror/commit/3066ce2220af69343dae716c849e343cbf5778e2)



---

archive/issue_events_218840.json:
```json
{
    "actor": "https://github.com/kevinywlui",
    "created_at": "2018-04-24T19:20:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218840"
}
```



---

archive/issue_events_218841.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-01T12:33:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218841"
}
```



---

archive/issue_events_218842.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-01T12:33:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218842"
}
```



---

archive/issue_comments_377696.json:
```json
{
    "body": "<a id='comment:6'></a>\nYou should fill the `Authors` field with your full name.",
    "created_at": "2018-05-01T12:33:57Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377696",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
You should fill the `Authors` field with your full name.



---

archive/issue_comments_377697.json:
```json
{
    "body": "**Author:** Kevin Lui",
    "created_at": "2018-05-02T17:42:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377697",
    "user": "https://github.com/kevinywlui"
}
```

**Author:** Kevin Lui



---

archive/issue_comments_377698.json:
```json
{
    "body": "<a id='comment:7'></a>\nThanks!",
    "created_at": "2018-05-02T17:42:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377698",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:7'></a>
Thanks!



---

archive/issue_comments_377699.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d\">7b76d3e</a></td><td><code>Merge branch 't/24688/implement_falting_height_of_an_elliptic_curve' into faltings</code></td></tr></table>\n",
    "created_at": "2018-06-20T22:35:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d">7b76d3e</a></td><td><code>Merge branch 't/24688/implement_falting_height_of_an_elliptic_curve' into faltings</code></td></tr></table>




---

archive/issue_comments_377700.json:
```json
{
    "body": "**Changing commit** from \"[3066ce2220af69343dae716c849e343cbf5778e2](https://github.com/sagemath/sagetrac-mirror/commit/3066ce2220af69343dae716c849e343cbf5778e2)\" to \"[7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d](https://github.com/sagemath/sagetrac-mirror/commit/7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d)\".",
    "created_at": "2018-06-20T22:35:01Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377700",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3066ce2220af69343dae716c849e343cbf5778e2](https://github.com/sagemath/sagetrac-mirror/commit/3066ce2220af69343dae716c849e343cbf5778e2)" to "[7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d](https://github.com/sagemath/sagetrac-mirror/commit/7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d)".



---

archive/issue_comments_377701.json:
```json
{
    "body": "**Changing commit** from \"[7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d](https://github.com/sagemath/sagetrac-mirror/commit/7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d)\" to \"[f85ec59b6368fbf16ace238e55581c69d0afc23f](https://github.com/sagemath/sagetrac-mirror/commit/f85ec59b6368fbf16ace238e55581c69d0afc23f)\".",
    "created_at": "2018-06-20T23:26:10Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d](https://github.com/sagemath/sagetrac-mirror/commit/7b76d3eea8a9cf0e7e49e8c6f2f9a9db87db3d4d)" to "[f85ec59b6368fbf16ace238e55581c69d0afc23f](https://github.com/sagemath/sagetrac-mirror/commit/f85ec59b6368fbf16ace238e55581c69d0afc23f)".



---

archive/issue_comments_377702.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f85ec59b6368fbf16ace238e55581c69d0afc23f\">f85ec59</a></td><td><code>removed some trailing whitespaces</code></td></tr></table>\n",
    "created_at": "2018-06-20T23:26:10Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f85ec59b6368fbf16ace238e55581c69d0afc23f">f85ec59</a></td><td><code>removed some trailing whitespaces</code></td></tr></table>




---

archive/issue_events_218843.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-21T06:13:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218843"
}
```



---

archive/issue_events_218844.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-21T06:13:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218844"
}
```



---

archive/issue_events_218845.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-21T06:13:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218845"
}
```



---

archive/issue_events_218846.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-21T06:13:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218846"
}
```



---

archive/issue_comments_377703.json:
```json
{
    "body": "<a id='comment:11'></a>\nMaybe you could do that over any number field, if possible ? using something like\n\n```\nA = self.base_ring()\nemb = A.embeddings(RR)[0]\nreturn -self.period_lattice(emb).complex_area().log() / 2\n```\nbut an expert opinion is required. John ?",
    "created_at": "2018-06-21T19:45:27Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377703",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
Maybe you could do that over any number field, if possible ? using something like

```
A = self.base_ring()
emb = A.embeddings(RR)[0]
return -self.period_lattice(emb).complex_area().log() / 2
```
but an expert opinion is required. John ?



---

archive/issue_comments_377704.json:
```json
{
    "body": "<a id='comment:12'></a>\nIs this really ready for review?\nI'm a little confused as to what this is meant to do, is it meant to match Magma's FaltingsHeight? For example in Magma V2.22-6\n\n```c\n> E := EllipticCurve(\"32a\");\n> E;\nElliptic Curve defined by y^2 = x^3 + 4*x over Rational Field\n> FaltingsHeight(E);\n-1.31053292591150951825227508330\n```\nquite different from the output this ticket gives, and the code in Magma is a lot more involved, picks a minimal model, uses the denominator of the j-invariant, discriminant etc.\n\nThe Magma documentation leaves a lot to be desired here I think.",
    "created_at": "2018-06-22T03:46:05Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377704",
    "user": "https://github.com/alexjbest"
}
```

<a id='comment:12'></a>
Is this really ready for review?
I'm a little confused as to what this is meant to do, is it meant to match Magma's FaltingsHeight? For example in Magma V2.22-6

```c
> E := EllipticCurve("32a");
> E;
Elliptic Curve defined by y^2 = x^3 + 4*x over Rational Field
> FaltingsHeight(E);
-1.31053292591150951825227508330
```
quite different from the output this ticket gives, and the code in Magma is a lot more involved, picks a minimal model, uses the denominator of the j-invariant, discriminant etc.

The Magma documentation leaves a lot to be desired here I think.



---

archive/issue_comments_377705.json:
```json
{
    "body": "<a id='comment:13'></a>\nI forgot the web calculator exists so I only checked it against MagmaV2.18-5. And in that version, the height was dependent on the model which was rather confusing to me. I always worked with the minimal model anyways so that difference didn't matter to me.\n\nI'm happy to see that that has changed:\n\n```\nE := EllipticCurve(\"32a\");\nFaltingsHeight(E);\nFaltingsHeight(WeierstrassModel(E));\n```\nyields\n\n```\n-1.31053292591150951825227508330\n-1.31053292591150951825227508330\n```\nusing http://magma.maths.usyd.edu.au/calc/ .\n\nMy interest in Faltings height is using Steven's conjecture to identify the J_1(N)-optimal curve in a given isogeny class. So the goal of this ticket was the compute whatever height is used in Steven's conjecture. So I took what was defined in Remark 3.3 here: https://arxiv.org/pdf/math/0404333.pdf and re-normalized it so that it matched with Magma. Though now I'm not sure what Magma is computing anymore. It seems to different than what's documented here: https://magma.maths.usyd.edu.au/magma/handbook/text/1455\n\nIn any case, I should change it so that it uses the minimal model.",
    "created_at": "2018-06-22T04:44:14Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377705",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:13'></a>
I forgot the web calculator exists so I only checked it against MagmaV2.18-5. And in that version, the height was dependent on the model which was rather confusing to me. I always worked with the minimal model anyways so that difference didn't matter to me.

I'm happy to see that that has changed:

```
E := EllipticCurve("32a");
FaltingsHeight(E);
FaltingsHeight(WeierstrassModel(E));
```
yields

```
-1.31053292591150951825227508330
-1.31053292591150951825227508330
```
using http://magma.maths.usyd.edu.au/calc/ .

My interest in Faltings height is using Steven's conjecture to identify the J_1(N)-optimal curve in a given isogeny class. So the goal of this ticket was the compute whatever height is used in Steven's conjecture. So I took what was defined in Remark 3.3 here: https://arxiv.org/pdf/math/0404333.pdf and re-normalized it so that it matched with Magma. Though now I'm not sure what Magma is computing anymore. It seems to different than what's documented here: https://magma.maths.usyd.edu.au/magma/handbook/text/1455

In any case, I should change it so that it uses the minimal model.



---

archive/issue_comments_377706.json:
```json
{
    "body": "**Changing commit** from \"[f85ec59b6368fbf16ace238e55581c69d0afc23f](https://github.com/sagemath/sagetrac-mirror/commit/f85ec59b6368fbf16ace238e55581c69d0afc23f)\" to \"[13f116a516e14eefb2bfb77f3034186e7a597d85](https://github.com/sagemath/sagetrac-mirror/commit/13f116a516e14eefb2bfb77f3034186e7a597d85)\".",
    "created_at": "2018-06-22T04:52:59Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f85ec59b6368fbf16ace238e55581c69d0afc23f](https://github.com/sagemath/sagetrac-mirror/commit/f85ec59b6368fbf16ace238e55581c69d0afc23f)" to "[13f116a516e14eefb2bfb77f3034186e7a597d85](https://github.com/sagemath/sagetrac-mirror/commit/13f116a516e14eefb2bfb77f3034186e7a597d85)".



---

archive/issue_comments_377707.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13f116a516e14eefb2bfb77f3034186e7a597d85\">13f116a</a></td><td><code>use the complex area of the minimal model</code></td></tr></table>\n",
    "created_at": "2018-06-22T04:52:59Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13f116a516e14eefb2bfb77f3034186e7a597d85">13f116a</a></td><td><code>use the complex area of the minimal model</code></td></tr></table>




---

archive/issue_comments_377708.json:
```json
{
    "body": "<a id='comment:15'></a>\nNo time for detailed comment now but it should not depend on model being minimal -- over number fields there is not always a global minimal model -- so there is a formula which is independent of model, though it is simpler (and possible over Q) to use a simpler formula valid only for minimal models.\n\nklui, I like your project.  If you want to do this with no computation at all use the files at https://github.com/JohnCremona/ecdata/tree/master/allbsd (see under \"TABLE FOUR\" at http://johncremona.github.io/ecdata/ for description of their content).",
    "created_at": "2018-06-22T08:10:58Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377708",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>
No time for detailed comment now but it should not depend on model being minimal -- over number fields there is not always a global minimal model -- so there is a formula which is independent of model, though it is simpler (and possible over Q) to use a simpler formula valid only for minimal models.

klui, I like your project.  If you want to do this with no computation at all use the files at https://github.com/JohnCremona/ecdata/tree/master/allbsd (see under "TABLE FOUR" at http://johncremona.github.io/ecdata/ for description of their content).



---

archive/issue_comments_377709.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [cremona](#comment%3A15):\n> No time for detailed comment now but it should not depend on model being minimal -- over number fields there is not always a global minimal model -- so there is a formula which is independent of model, though it is simpler (and possible over Q) to use a simpler formula valid only for minimal models.\n> \n\nThe only model-independent formula I know of requires computing the minimal discriminant anyways so it should be okay to just compute the minimal model, from a speed-perspective as well.\n> klui, I like your project.  If you want to do this with no computation at all use the files at https://github.com/JohnCremona/ecdata/tree/master/allbsd (see under \"TABLE FOUR\" at http://johncremona.github.io/ecdata/ for description of their content).\n\nI think I'm being slow but I don't see how knowing the BSD invariants help with computing the Faltings height.",
    "created_at": "2018-06-22T18:00:22Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377709",
    "user": "https://github.com/kevinywlui"
}
```

<a id='comment:16'></a>
Replying to [cremona](#comment%3A15):
> No time for detailed comment now but it should not depend on model being minimal -- over number fields there is not always a global minimal model -- so there is a formula which is independent of model, though it is simpler (and possible over Q) to use a simpler formula valid only for minimal models.
> 

The only model-independent formula I know of requires computing the minimal discriminant anyways so it should be okay to just compute the minimal model, from a speed-perspective as well.
> klui, I like your project.  If you want to do this with no computation at all use the files at https://github.com/JohnCremona/ecdata/tree/master/allbsd (see under "TABLE FOUR" at http://johncremona.github.io/ecdata/ for description of their content).

I think I'm being slow but I don't see how knowing the BSD invariants help with computing the Faltings height.



---

archive/issue_events_218847.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-26T11:56:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "rename": {
        "from": "implement faltings height of an elliptic curve",
        "to": "implement Faltings height of an elliptic curve"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218847"
}
```



---

archive/issue_comments_377710.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-The goal of this ticket is to be able to determine the faltings height of an elliptic curve.\n+The goal of this ticket is to be able to determine the Faltings height of an elliptic curve.\n``````\n",
    "created_at": "2018-06-26T11:56:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377710",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-The goal of this ticket is to be able to determine the faltings height of an elliptic curve.
+The goal of this ticket is to be able to determine the Faltings height of an elliptic curve.
``````




---

archive/issue_comments_377711.json:
```json
{
    "body": "**Reviewer:** Peter Bruin",
    "created_at": "2020-01-14T16:47:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377711",
    "user": "https://github.com/pjbruin"
}
```

**Reviewer:** Peter Bruin



---

archive/issue_events_218848.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2020-01-14T16:47:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218848"
}
```



---

archive/issue_events_218849.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2020-01-14T16:47:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218849"
}
```



---

archive/issue_comments_377712.json:
```json
{
    "body": "<a id='comment:18'></a>\nInstead of saying that this uses the same normalisation as Magma, I suggest putting a definition or formula in the documentation.  For the elliptic curve 32a1, the output agrees with the function `ellheight` in PARI but seems to be half of that returned by Magma.\n\nFor a future generalisation to number fields, the PARI function `ellheight` does the same thing as this function over **Q** and also works over number fields.",
    "created_at": "2020-01-14T16:47:48Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377712",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:18'></a>
Instead of saying that this uses the same normalisation as Magma, I suggest putting a definition or formula in the documentation.  For the elliptic curve 32a1, the output agrees with the function `ellheight` in PARI but seems to be half of that returned by Magma.

For a future generalisation to number fields, the PARI function `ellheight` does the same thing as this function over **Q** and also works over number fields.



---

archive/issue_comments_377713.json:
```json
{
    "body": "<a id='comment:19'></a>\nI am planning to revise and resubmit this patch, with an option to return either the (unstable) Faltings height as the code now does (-log(A)/2) or the stable height which adds log(denom(j)/abs(disc))/12 -- the result being the same for semistable curves (since denom(j)=abs(disc) for a minimal model of a semistable curve, as then gcd(c4,disc)=1), and independent of the model.",
    "created_at": "2021-03-16T15:29:47Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377713",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:19'></a>
I am planning to revise and resubmit this patch, with an option to return either the (unstable) Faltings height as the code now does (-log(A)/2) or the stable height which adds log(denom(j)/abs(disc))/12 -- the result being the same for semistable curves (since denom(j)=abs(disc) for a minimal model of a semistable curve, as then gcd(c4,disc)=1), and independent of the model.



---

archive/issue_events_218850.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-16T17:12:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218850"
}
```



---

archive/issue_events_218851.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-16T17:12:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218851"
}
```



---

archive/issue_comments_377714.json:
```json
{
    "body": "**Changing commit** from \"[13f116a516e14eefb2bfb77f3034186e7a597d85](https://github.com/sagemath/sagetrac-mirror/commit/13f116a516e14eefb2bfb77f3034186e7a597d85)\" to \"[d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51](https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51)\".",
    "created_at": "2021-03-16T17:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377714",
    "user": "https://github.com/JohnCremona"
}
```

**Changing commit** from "[13f116a516e14eefb2bfb77f3034186e7a597d85](https://github.com/sagemath/sagetrac-mirror/commit/13f116a516e14eefb2bfb77f3034186e7a597d85)" to "[d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51](https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51)".



---

archive/issue_comments_377715.json:
```json
{
    "body": "**Changing branch** from \"[u/klui/implement_falting_height_of_an_elliptic_curve](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/implement_falting_height_of_an_elliptic_curve)\" to \"[u/cremona/24688-Faltings_height](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/24688-Faltings_height)\".",
    "created_at": "2021-03-16T17:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377715",
    "user": "https://github.com/JohnCremona"
}
```

**Changing branch** from "[u/klui/implement_falting_height_of_an_elliptic_curve](https://github.com/sagemath/sagetrac-mirror/tree/u/klui/implement_falting_height_of_an_elliptic_curve)" to "[u/cremona/24688-Faltings_height](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/24688-Faltings_height)".



---

archive/issue_comments_377716.json:
```json
{
    "body": "<a id='comment:20'></a>\nI merged the previous branch with 9.3.beta9, and enhanced the method by having `stable` as an optional parameter (default `False`) and adding a precision parameter.  I added extra tests to show how the stable and unstable heights are the same for semistable curves (but not otherwise) and how the stable height is independent of the model while the unstable one is not.\n\nI included definitions (but no citations).\n\nObviously we'll also want a version of this for number fields too, but I think this is enough for now.  Please re-review!\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/beb25b7a75ac774371735ab2f1083b7eda43a6ed\">beb25b7</a></td><td><code>Merge remote-tracking branch 'trac/u/klui/implement_falting_height_of_an_elliptic_curve' into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51\">d3ed53e</a></td><td><code>#24688: Faltings height for elliptic curves over QQ</code></td></tr></table>\n",
    "created_at": "2021-03-16T17:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377716",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:20'></a>
I merged the previous branch with 9.3.beta9, and enhanced the method by having `stable` as an optional parameter (default `False`) and adding a precision parameter.  I added extra tests to show how the stable and unstable heights are the same for semistable curves (but not otherwise) and how the stable height is independent of the model while the unstable one is not.

I included definitions (but no citations).

Obviously we'll also want a version of this for number fields too, but I think this is enough for now.  Please re-review!

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/beb25b7a75ac774371735ab2f1083b7eda43a6ed">beb25b7</a></td><td><code>Merge remote-tracking branch 'trac/u/klui/implement_falting_height_of_an_elliptic_curve' into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51">d3ed53e</a></td><td><code>#24688: Faltings height for elliptic curves over QQ</code></td></tr></table>




---

archive/issue_comments_377717.json:
```json
{
    "body": "**Changing reviewer** from \"Peter Bruin\" to \"Peter Bruin, John Cremona\".",
    "created_at": "2021-03-16T17:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377717",
    "user": "https://github.com/JohnCremona"
}
```

**Changing reviewer** from "Peter Bruin" to "Peter Bruin, John Cremona".



---

archive/issue_comments_377718.json:
```json
{
    "body": "**Changing author** from \"Kevin Lui\" to \"Kevin Lui, John Cremona\".",
    "created_at": "2021-03-16T17:12:16Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377718",
    "user": "https://github.com/JohnCremona"
}
```

**Changing author** from "Kevin Lui" to "Kevin Lui, John Cremona".



---

archive/issue_events_218852.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-19T11:01:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218852"
}
```



---

archive/issue_events_218853.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-19T11:01:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218853"
}
```



---

archive/issue_comments_377719.json:
```json
{
    "body": "<a id='comment:21'></a>\nthe bot is green and this looks good, so let it be (not a mathematical review)",
    "created_at": "2021-03-19T11:01:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377719",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
the bot is green and this looks good, so let it be (not a mathematical review)



---

archive/issue_comments_377720.json:
```json
{
    "body": "**Changing reviewer** from \"Peter Bruin, John Cremona\" to \"Peter Bruin, John Cremona, Fr\u00e9d\u00e9ric Chapoton\".",
    "created_at": "2021-03-19T11:01:21Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377720",
    "user": "https://github.com/fchapoton"
}
```

**Changing reviewer** from "Peter Bruin, John Cremona" to "Peter Bruin, John Cremona, Frédéric Chapoton".



---

archive/issue_events_218854.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-19T11:01:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218854"
}
```



---

archive/issue_events_218855.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-19T11:01:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218855"
}
```



---

archive/issue_comments_377721.json:
```json
{
    "body": "**Changing branch** from \"[u/cremona/24688-Faltings_height](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/24688-Faltings_height)\" to \"[d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51](https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51)\".",
    "created_at": "2021-03-20T20:54:51Z",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24688#issuecomment-377721",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/cremona/24688-Faltings_height](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/24688-Faltings_height)" to "[d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51](https://github.com/sagemath/sagetrac-mirror/commit/d3ed53ee7e48f0a89e03d4026cca4cc59ff95e51)".



---

archive/issue_events_218856.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-20T20:54:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218856"
}
```



---

archive/issue_events_218857.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3071aad95cccb038230d6c56c7b947483f597d56",
    "created_at": "2021-03-20T20:54:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24688",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24688#event-218857"
}
```
