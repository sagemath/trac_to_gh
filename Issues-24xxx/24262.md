# Issue 24262: Upgrade to pynac-0.7.13

archive/issues_024025.json:
```json
{
    "assignees": [],
    "body": "There is:\n* fix `ex.coefficients()` bugs (#23545, #24147)\n* fix interface to Singular GCD (#23845)\n* fix compiler warnings\n* `asin`/`atan` enhancements (#24211)\n* `set_of_all()` function (#24176)\n* upgrade `ax_cxx_compile_stdcxx_11.m4`\n\nhttps://github.com/pynac/pynac/releases/download/pynac-0.7.13/pynac-0.7.13.tar.bz2\n\nCC:  @kiwifb\n\nBranch/Commit: **[u/rws/upgrade_to_pynac_0_7_13](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_13) @ [438816e](https://github.com/sagemath/sagetrac-mirror/commit/438816e7e65214a19a5fed12d10b6ada94041cb5)**\n\nReviewer: **Emmanuel Charpentier**\n\nAuthor: **Ralf Stephan**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24262_\n\n",
    "closed_at": "2017-12-12T08:23:33Z",
    "created_at": "2017-11-21T16:31:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade to pynac-0.7.13",
    "type": "issue",
    "updated_at": "2017-12-12T08:23:33Z",
    "url": "https://github.com/sagemath/sage/issues/24262",
    "user": "https://github.com/rwst"
}
```
There is:
* fix `ex.coefficients()` bugs (#23545, #24147)
* fix interface to Singular GCD (#23845)
* fix compiler warnings
* `asin`/`atan` enhancements (#24211)
* `set_of_all()` function (#24176)
* upgrade `ax_cxx_compile_stdcxx_11.m4`

https://github.com/pynac/pynac/releases/download/pynac-0.7.13/pynac-0.7.13.tar.bz2

CC:  @kiwifb

Branch/Commit: **[u/rws/upgrade_to_pynac_0_7_13](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_13) @ [438816e](https://github.com/sagemath/sagetrac-mirror/commit/438816e7e65214a19a5fed12d10b6ada94041cb5)**

Reviewer: **Emmanuel Charpentier**

Author: **Ralf Stephan**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/24262_





---

archive/issue_events_336562.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-21T16:31:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336562"
}
```



---

archive/issue_events_336563.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-21T16:31:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336563"
}
```



---

archive/issue_events_336564.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-21T16:31:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336564"
}
```



---

archive/issue_events_336565.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-21T16:31:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336565"
}
```



---

archive/issue_comments_367267.json:
```json
{
    "body": "Branch: **[u/rws/upgrade_to_pynac_0_7_13](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_13)**",
    "created_at": "2017-11-21T16:36:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367267",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/upgrade_to_pynac_0_7_13](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_to_pynac_0_7_13)**



---

archive/issue_comments_367268.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca\">46a7ebc</a></td><td><code>24262: pkg version/chksum</code></td></tr></table>\n",
    "created_at": "2017-11-21T17:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367268",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca">46a7ebc</a></td><td><code>24262: pkg version/chksum</code></td></tr></table>




---

archive/issue_comments_367269.json:
```json
{
    "body": "Commit: **[46a7ebc](https://github.com/sagemath/sagetrac-mirror/commit/46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca)**",
    "created_at": "2017-11-21T17:54:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367269",
    "user": "https://github.com/kiwifb"
}
```

Commit: **[46a7ebc](https://github.com/sagemath/sagetrac-mirror/commit/46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca)**



---

archive/issue_events_336566.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-22T06:56:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336566"
}
```



---

archive/issue_comments_367270.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nNo doctests need to be adapted for this release. Please review.",
    "created_at": "2017-11-22T06:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367270",
    "user": "https://github.com/rwst"
}
```

<div id="comment:3" align="right">comment:3</div>

No doctests need to be adapted for this release. Please review.



---

archive/issue_comments_367271.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nOn Debian 8.1.rc2 + #24240, compiles without difficulty.\n\n* fix ex.coefficients() bugs (#23545, #24147) : yes\n* fix interface to Singular GCD (#23845) : yes. The planned doctest don't seem to have been added.\n* fix compiler warnings : I still get :\n\n```\ncharpent@asus16-ec:~$ cat /usr/local/sage-8/logs/pkgs/pynac-0.7.13.log  | grep warn\n/usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]\n/usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]\n/usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]\n```\n\n* asin/atan enhancements (#24211) : partial fix :\n\n```\nsage: [arcsin(t) for t in [0, 1/2, sqrt(2)/2, sqrt(3)/2, 1]] # Fixed\n[0, 1/6*pi, 1/4*pi, 1/3*pi, 1/2*pi]\nsage: [arctan(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Fixed\n[0, 1/6*pi, 1/4*pi, 1/3*pi]\nsage: [arccos(t) for t in [0, 1/2, sqrt(2)/2, sqrt(3)/2, 1]] # Partially fixed\n[1/2*pi, 1/3*pi, arccos(1/2*sqrt(2)), arccos(1/2*sqrt(3)), 0]\nsage: [arccot(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Partially fixed\n[1/2*pi, arccot(1/3*sqrt(3)), 1/4*pi, arccot(sqrt(3))]\n```\n The simplifications are not fixed either (but I'm not sure they could be by pynac's upgrade...) :\n\n```\nsage: assume(-pi/2<x, x<pi/2)\nsage: arctan(sin(x)/cos(x)).simplify() # Not fixed\narctan(sin(x)/cos(x))\nsage: arctan(sin(x)/cos(x)).simplify_full() # Not fixed\narctan(sin(x)/cos(x))\n```\n\n* set_of_all() function (#24176) : can't test directly. Doctest ?\n* upgrade ax_cxx_compile_stdcxx_11.m4 : I dont't know how to test. Doctest ?\n* Your name needs to go in the `Authors` field.\n\n`make ptestlong` gives me one (non-transient) failure :\n\n```\ncharpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2017-11-22-23-04-04-f8ba9318.\nGit branch: tst24240_n_24262\nUsing --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage\nDoctesting 1 file.\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1652, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    asy # long time\nExpected:\n    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)),\n     1, 4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)))\nGot:\n    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)),\n     1,\n     4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)))\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1655, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1]) # long time\nExpected:\n    [((3, 3, 2), 0.9812164307, [1.515572606], [-0.54458543...]),\n     ((6, 6, 4), 1.576181132, [1.992989399], [-0.26444185...]),\n     ((12, 12, 8), 2.485286378, [2.712196351], [-0.091301338...]),\n     ((24, 24, 16), 3.700576827, [3.760447895], [-0.016178847...])]\nGot:\n    [((3, 3, 2), 0.9812164307, [2.167042622], [-1.208526635]),\n     ((6, 6, 4), 1.576181132, [2.453648265], [-0.5567045026]),\n     ((12, 12, 8), 2.485286378, [3.037931359], [-0.2223667203]),\n     ((24, 24, 16), 3.700576827, [3.990777328], [-0.07842034220])]\n**********************************************************************\n1 item had failures:\n   2 of 104 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\n    [805 tests, 2 failures, 27.28 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 27.4 seconds\n    cpu time: 27.3 seconds\n    cumulative wall time: 27.3 seconds\n```\n\n==>`needs_work`.",
    "created_at": "2017-11-22T22:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367271",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:4" align="right">comment:4</div>

On Debian 8.1.rc2 + #24240, compiles without difficulty.

* fix ex.coefficients() bugs (#23545, #24147) : yes
* fix interface to Singular GCD (#23845) : yes. The planned doctest don't seem to have been added.
* fix compiler warnings : I still get :

```
charpent@asus16-ec:~$ cat /usr/local/sage-8/logs/pkgs/pynac-0.7.13.log  | grep warn
/usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]
/usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]
/usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]
```

* asin/atan enhancements (#24211) : partial fix :

```
sage: [arcsin(t) for t in [0, 1/2, sqrt(2)/2, sqrt(3)/2, 1]] # Fixed
[0, 1/6*pi, 1/4*pi, 1/3*pi, 1/2*pi]
sage: [arctan(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Fixed
[0, 1/6*pi, 1/4*pi, 1/3*pi]
sage: [arccos(t) for t in [0, 1/2, sqrt(2)/2, sqrt(3)/2, 1]] # Partially fixed
[1/2*pi, 1/3*pi, arccos(1/2*sqrt(2)), arccos(1/2*sqrt(3)), 0]
sage: [arccot(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Partially fixed
[1/2*pi, arccot(1/3*sqrt(3)), 1/4*pi, arccot(sqrt(3))]
```
 The simplifications are not fixed either (but I'm not sure they could be by pynac's upgrade...) :

```
sage: assume(-pi/2<x, x<pi/2)
sage: arctan(sin(x)/cos(x)).simplify() # Not fixed
arctan(sin(x)/cos(x))
sage: arctan(sin(x)/cos(x)).simplify_full() # Not fixed
arctan(sin(x)/cos(x))
```

* set_of_all() function (#24176) : can't test directly. Doctest ?
* upgrade ax_cxx_compile_stdcxx_11.m4 : I dont't know how to test. Doctest ?
* Your name needs to go in the `Authors` field.

`make ptestlong` gives me one (non-transient) failure :

```
charpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
too many failed tests, not using stored timings
Running doctests with ID 2017-11-22-23-04-04-f8ba9318.
Git branch: tst24240_n_24262
Using --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage
Doctesting 1 file.
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1652, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    asy # long time
Expected:
    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)),
     1, 4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)))
Got:
    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)),
     1,
     4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)))
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1655, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1]) # long time
Expected:
    [((3, 3, 2), 0.9812164307, [1.515572606], [-0.54458543...]),
     ((6, 6, 4), 1.576181132, [1.992989399], [-0.26444185...]),
     ((12, 12, 8), 2.485286378, [2.712196351], [-0.091301338...]),
     ((24, 24, 16), 3.700576827, [3.760447895], [-0.016178847...])]
Got:
    [((3, 3, 2), 0.9812164307, [2.167042622], [-1.208526635]),
     ((6, 6, 4), 1.576181132, [2.453648265], [-0.5567045026]),
     ((12, 12, 8), 2.485286378, [3.037931359], [-0.2223667203]),
     ((24, 24, 16), 3.700576827, [3.990777328], [-0.07842034220])]
**********************************************************************
1 item had failures:
   2 of 104 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
    [805 tests, 2 failures, 27.28 s]
----------------------------------------------------------------------
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 27.4 seconds
    cpu time: 27.3 seconds
    cumulative wall time: 27.3 seconds
```

==>`needs_work`.



---

archive/issue_comments_367272.json:
```json
{
    "body": "Reviewer: **Emmanuel Charpentier**",
    "created_at": "2017-11-22T22:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367272",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Reviewer: **Emmanuel Charpentier**



---

archive/issue_events_336567.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-22T22:11:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336567"
}
```



---

archive/issue_events_336568.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-22T22:11:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336568"
}
```



---

archive/issue_comments_367273.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@EmmanuelCharpentier](#comment:4):\n> * fix interface to Singular GCD (#23845) : yes. The planned doctest don't seem to have been added.\n\nThey are always added in the reporting tickets.\n\n> * fix compiler warnings : I still get :\n> \n> ```\n> charpent@asus16-ec:~$ cat /usr/local/sage-8/logs/pkgs/pynac-0.7.13.log  | grep warn\n> /usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]\n> /usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]\n> /usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]\n> ```\n\nThey need to be fixed by updating Flint, as I have submitted the fix to Flint some time ago.\n\n> * asin/atan enhancements (#24211) : partial fix :\n> \n> ```\n> sage: [arccot(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Partially fixed\n> [1/2*pi, arccot(1/3*sqrt(3)), 1/4*pi, arccot(sqrt(3))]\n> ```\n\nSorry but you didn't report that. Of course I'll add it soon.\n\n>  The simplifications are not fixed either (but I'm not sure they could be by pynac's upgrade...) :\n\nI have pointed out already that `simplify` omissions are basically Maxima's.\n\n> * set_of_all() function (#24176) : can't test directly. Doctest ?\n\nWell, see #24176.\n\n> * upgrade ax_cxx_compile_stdcxx_11.m4 : I dont't know how to test. Doctest ?\n\nThis is a Pynac build enhancement.\n\n> * Your name needs to go in the `Authors` field.\n\nDone.\n\n> `make ptestlong` gives me one (non-transient) failure :\n\nWhat do you mean with \"non-transient\"? \"non-transient using make ptestlong\" or \"non-transient using sage -t manually\"? I cannot reproduce using sage -t on OpenSuSE, so this might be system-specific, or it might be make ptestlong-specific.",
    "created_at": "2017-11-23T07:00:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367273",
    "user": "https://github.com/rwst"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@EmmanuelCharpentier](#comment:4):
> * fix interface to Singular GCD (#23845) : yes. The planned doctest don't seem to have been added.

They are always added in the reporting tickets.

> * fix compiler warnings : I still get :
> 
> ```
> charpent@asus16-ec:~$ cat /usr/local/sage-8/logs/pkgs/pynac-0.7.13.log  | grep warn
> /usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]
> /usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]
> /usr/local/sage-8/local/include/flint/fmpz.h:428:23: warning: declaration of 'mpz_ptr' shadows a global declaration [-Wshadow]
> ```

They need to be fixed by updating Flint, as I have submitted the fix to Flint some time ago.

> * asin/atan enhancements (#24211) : partial fix :
> 
> ```
> sage: [arccot(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Partially fixed
> [1/2*pi, arccot(1/3*sqrt(3)), 1/4*pi, arccot(sqrt(3))]
> ```

Sorry but you didn't report that. Of course I'll add it soon.

>  The simplifications are not fixed either (but I'm not sure they could be by pynac's upgrade...) :

I have pointed out already that `simplify` omissions are basically Maxima's.

> * set_of_all() function (#24176) : can't test directly. Doctest ?

Well, see #24176.

> * upgrade ax_cxx_compile_stdcxx_11.m4 : I dont't know how to test. Doctest ?

This is a Pynac build enhancement.

> * Your name needs to go in the `Authors` field.

Done.

> `make ptestlong` gives me one (non-transient) failure :

What do you mean with "non-transient"? "non-transient using make ptestlong" or "non-transient using sage -t manually"? I cannot reproduce using sage -t on OpenSuSE, so this might be system-specific, or it might be make ptestlong-specific.



---

archive/issue_comments_367274.json:
```json
{
    "body": "Author: **Ralf Stephan**",
    "created_at": "2017-11-23T07:01:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367274",
    "user": "https://github.com/rwst"
}
```

Author: **Ralf Stephan**



---

archive/issue_comments_367275.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@rwst](#comment:5):\n> Replying to [@EmmanuelCharpentier](#comment:4):\n\n[ Snip... ]}\n> > * asin/atan enhancements (#24211) : partial fix :\n> > \n> > ```\n> > sage: [arccot(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Partially fixed\n> > [1/2*pi, arccot(1/3*sqrt(3)), 1/4*pi, arccot(sqrt(3))]\n> > ```\n\n> \n> Sorry but you didn't report that. Of course I'll add it soon.\n\nI just did that.",
    "created_at": "2017-11-23T15:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367275",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@rwst](#comment:5):
> Replying to [@EmmanuelCharpentier](#comment:4):

[ Snip... ]}
> > * asin/atan enhancements (#24211) : partial fix :
> > 
> > ```
> > sage: [arccot(t) for t in [0, 1/sqrt(3), 1, sqrt(3)]] # Partially fixed
> > [1/2*pi, arccot(1/3*sqrt(3)), 1/4*pi, arccot(sqrt(3))]
> > ```

> 
> Sorry but you didn't report that. Of course I'll add it soon.

I just did that.



---

archive/issue_comments_367276.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@rwst](#comment:5):\n> Replying to [@EmmanuelCharpentier](#comment:4):\n\n[ Snip... ]\n> > `make ptestlong` gives me one (non-transient) failure :\n\n> \n> What do you mean with \"non-transient\"? \"non-transient using make ptestlong\" or \"non-transient using sage -t manually\"? I cannot reproduce using sage -t on OpenSuSE, so this might be system-specific, or it might be make ptestlong-specific.\n\nI get the failure during `ptestlong`, and I can reproduce at will by doing :\n\n`sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py`",
    "created_at": "2017-11-23T15:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367276",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@rwst](#comment:5):
> Replying to [@EmmanuelCharpentier](#comment:4):

[ Snip... ]
> > `make ptestlong` gives me one (non-transient) failure :

> 
> What do you mean with "non-transient"? "non-transient using make ptestlong" or "non-transient using sage -t manually"? I cannot reproduce using sage -t on OpenSuSE, so this might be system-specific, or it might be make ptestlong-specific.

I get the failure during `ptestlong`, and I can reproduce at will by doing :

`sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py`



---

archive/issue_comments_367277.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nConfirmed with `--long`.",
    "created_at": "2017-11-23T16:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367277",
    "user": "https://github.com/rwst"
}
```

<div id="comment:9" align="right">comment:9</div>

Confirmed with `--long`.



---

archive/issue_comments_367278.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOkay the reason is a regression in `subs`, minimal case: `sage: (1+1/x).subs({x:1/x}) ... 1/x + 1`. We try to add a patch here with doctest.",
    "created_at": "2017-11-24T08:03:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367278",
    "user": "https://github.com/rwst"
}
```

<div id="comment:10" align="right">comment:10</div>

Okay the reason is a regression in `subs`, minimal case: `sage: (1+1/x).subs({x:1/x}) ... 1/x + 1`. We try to add a patch here with doctest.



---

archive/issue_comments_367279.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@rwst](#comment:10):\n> Okay the reason is a regression in `subs`, minimal case: `sage: (1+1/x).subs({x:1/x}) ... 1/x + 1`. We try to add a patch here with doctest.\n\nHmmm... This a catastrophic one : `subs` is a basic method. IMHO, this deserves its own ticket, marked as `blocker`.",
    "created_at": "2017-11-24T08:15:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367279",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@rwst](#comment:10):
> Okay the reason is a regression in `subs`, minimal case: `sage: (1+1/x).subs({x:1/x}) ... 1/x + 1`. We try to add a patch here with doctest.

Hmmm... This a catastrophic one : `subs` is a basic method. IMHO, this deserves its own ticket, marked as `blocker`.



---

archive/issue_comments_367280.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nA blocker is a ticket that reports/fixes an existing bug in Sage. This is a ticket that potentially introduces a severe bug, but with the right patch, it becomes a normal ticket. The sky does not fall down.",
    "created_at": "2017-11-24T08:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367280",
    "user": "https://github.com/rwst"
}
```

<div id="comment:12" align="right">comment:12</div>

A blocker is a ticket that reports/fixes an existing bug in Sage. This is a ticket that potentially introduces a severe bug, but with the right patch, it becomes a normal ticket. The sky does not fall down.



---

archive/issue_comments_367281.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@rwst](#comment:12):\n> A blocker is a ticket that reports/fixes an existing bug in Sage. This is a ticket that potentially introduces a severe bug, but with the right patch, it becomes a normal ticket. The sky does not fall down.\n\nAh ! You meant that this regression was introduced by the upgrade to pynac ? That was not obvious (at least to me...) ; I thought that you have found a *pre-existing* regression. And *that* was deserving a blocker ticket.",
    "created_at": "2017-11-24T09:33:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367281",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@rwst](#comment:12):
> A blocker is a ticket that reports/fixes an existing bug in Sage. This is a ticket that potentially introduces a severe bug, but with the right patch, it becomes a normal ticket. The sky does not fall down.

Ah ! You meant that this regression was introduced by the upgrade to pynac ? That was not obvious (at least to me...) ; I thought that you have found a *pre-existing* regression. And *that* was deserving a blocker ticket.



---

archive/issue_comments_367282.json:
```json
{
    "body": "Changed commit from **[46a7ebc](https://github.com/sagemath/sagetrac-mirror/commit/46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca)** to **[1782f91](https://github.com/sagemath/sagetrac-mirror/commit/1782f910ded326252088dcd2c8169e0ffc471653)**",
    "created_at": "2017-11-26T13:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367282",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[46a7ebc](https://github.com/sagemath/sagetrac-mirror/commit/46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca)** to **[1782f91](https://github.com/sagemath/sagetrac-mirror/commit/1782f910ded326252088dcd2c8169e0ffc471653)**



---

archive/issue_comments_367283.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10a108dc41f6400dca0215e17cc5b57cb0d81a53\">10a108d</a></td><td><code>24262: last-minute fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1782f910ded326252088dcd2c8169e0ffc471653\">1782f91</a></td><td><code>24262: doctest last-minute-fix</code></td></tr></table>\n",
    "created_at": "2017-11-26T13:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367283",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10a108dc41f6400dca0215e17cc5b57cb0d81a53">10a108d</a></td><td><code>24262: last-minute fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1782f910ded326252088dcd2c8169e0ffc471653">1782f91</a></td><td><code>24262: doctest last-minute-fix</code></td></tr></table>




---

archive/issue_comments_367284.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThis fixes the issue. My ptestlong passes but you might want to test again too.\n\nNote that the behaviour of this added doctest:\n\n```\nsage: (sqrt(x) + 1/sqrt(x)).subs({x: 1/x})\n1/sqrt(x) + 1/1/sqrt(x)\n```\nis unchanged with respect to previous Sage versions but I have opened a Pynac issue: https://github.com/pynac/pynac/issues/287",
    "created_at": "2017-11-26T13:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367284",
    "user": "https://github.com/rwst"
}
```

<div id="comment:15" align="right">comment:15</div>

This fixes the issue. My ptestlong passes but you might want to test again too.

Note that the behaviour of this added doctest:

```
sage: (sqrt(x) + 1/sqrt(x)).subs({x: 1/x})
1/sqrt(x) + 1/1/sqrt(x)
```
is unchanged with respect to previous Sage versions but I have opened a Pynac issue: https://github.com/pynac/pynac/issues/287



---

archive/issue_events_336569.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-26T13:48:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336569"
}
```



---

archive/issue_events_336570.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-26T13:48:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336570"
}
```



---

archive/issue_events_336571.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-26T19:32:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336571"
}
```



---

archive/issue_events_336572.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-26T19:32:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336572"
}
```



---

archive/issue_comments_367285.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nDoesn't smell good.. On top of 8.0.rc3+#24240, I get :\n\n```\ncharpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2017-11-26-20-26-24-fdb78fa1.\nGit branch: tst24240_n_24262\nUsing --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage\nDoctesting 1 file.\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1652, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    asy # long time\nExpected:\n    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)),\n     1, 4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)))\nGot:\n    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)),\n     1,\n     4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)))\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1655, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1]) # long time\nExpected:\n    [((3, 3, 2), 0.9812164307, [1.515572606], [-0.54458543...]),\n     ((6, 6, 4), 1.576181132, [1.992989399], [-0.26444185...]),\n     ((12, 12, 8), 2.485286378, [2.712196351], [-0.091301338...]),\n     ((24, 24, 16), 3.700576827, [3.760447895], [-0.016178847...])]\nGot:\n    [((3, 3, 2), 0.9812164307, [2.167042622], [-1.208526635]),\n     ((6, 6, 4), 1.576181132, [2.453648265], [-0.5567045026]),\n     ((12, 12, 8), 2.485286378, [3.037931359], [-0.2223667203]),\n     ((24, 24, 16), 3.700576827, [3.990777328], [-0.07842034220])]\n**********************************************************************\n1 item had failures:\n   2 of 104 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\n    [805 tests, 2 failures, 27.18 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 27.3 seconds\n    cpu time: 27.2 seconds\n    cumulative wall time: 27.2 seconds\n```\n\nThese errors don't seem to be cosmetic (i. e. space, printing order, etc...).\n\n`ptestlong` underway to find other snags... In the interim, `needs_work`\n\nSorry...",
    "created_at": "2017-11-26T19:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367285",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:16" align="right">comment:16</div>

Doesn't smell good.. On top of 8.0.rc3+#24240, I get :

```
charpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
too many failed tests, not using stored timings
Running doctests with ID 2017-11-26-20-26-24-fdb78fa1.
Git branch: tst24240_n_24262
Using --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage
Doctesting 1 file.
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1652, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    asy # long time
Expected:
    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)),
     1, 4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)))
Got:
    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)),
     1,
     4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 191/216*sqrt(3)/(sqrt(pi)*sqrt(r)))
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1655, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1]) # long time
Expected:
    [((3, 3, 2), 0.9812164307, [1.515572606], [-0.54458543...]),
     ((6, 6, 4), 1.576181132, [1.992989399], [-0.26444185...]),
     ((12, 12, 8), 2.485286378, [2.712196351], [-0.091301338...]),
     ((24, 24, 16), 3.700576827, [3.760447895], [-0.016178847...])]
Got:
    [((3, 3, 2), 0.9812164307, [2.167042622], [-1.208526635]),
     ((6, 6, 4), 1.576181132, [2.453648265], [-0.5567045026]),
     ((12, 12, 8), 2.485286378, [3.037931359], [-0.2223667203]),
     ((24, 24, 16), 3.700576827, [3.990777328], [-0.07842034220])]
**********************************************************************
1 item had failures:
   2 of 104 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
    [805 tests, 2 failures, 27.18 s]
----------------------------------------------------------------------
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 27.3 seconds
    cpu time: 27.2 seconds
    cumulative wall time: 27.2 seconds
```

These errors don't seem to be cosmetic (i. e. space, printing order, etc...).

`ptestlong` underway to find other snags... In the interim, `needs_work`

Sorry...



---

archive/issue_comments_367286.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@EmmanuelCharpentier](#comment:16):\n> Doesn't smell good.. On top of 8.0.rc3+#24240, I get :\n\n[ Snip... ]\n\n`ptestlong` gave another error, which is reproducible standalone :\n\n```\nsage -t --long src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 5153, in sage.symbolic.expression.\nExpression.substitute\nFailed example:\n    (1 + 1/x).subs({x: 1/x})\nExpected:\n    x + 1\nGot:\n    1/x + 1\n**********************************************************************\n1 item had failures:\n   1 of  68 in sage.symbolic.expression.Expression.substitute\n    [2776 tests, 1 failure, 85.34 s]\n```\n\nDefinitely `needs_work`.",
    "created_at": "2017-11-26T21:05:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367286",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@EmmanuelCharpentier](#comment:16):
> Doesn't smell good.. On top of 8.0.rc3+#24240, I get :

[ Snip... ]

`ptestlong` gave another error, which is reproducible standalone :

```
sage -t --long src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 5153, in sage.symbolic.expression.
Expression.substitute
Failed example:
    (1 + 1/x).subs({x: 1/x})
Expected:
    x + 1
Got:
    1/x + 1
**********************************************************************
1 item had failures:
   1 of  68 in sage.symbolic.expression.Expression.substitute
    [2776 tests, 1 failure, 85.34 s]
```

Definitely `needs_work`.



---

archive/issue_comments_367287.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIt doesn't look like you updated your copy of the ticket branch, e.g.. git trac pull.24262.",
    "created_at": "2017-11-26T21:40:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367287",
    "user": "https://github.com/rwst"
}
```

<div id="comment:18" align="right">comment:18</div>

It doesn't look like you updated your copy of the ticket branch, e.g.. git trac pull.24262.



---

archive/issue_comments_367288.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@rwst](#comment:18):\n> It doesn't look like you updated your copy of the ticket branch, e.g.. git trac pull.24262.\n\nFrom the top of my git log :\n\n```\ncommit 7d9462cc8b91bc25f35559a17b2fce8a4efc8d5e\nMerge: e885a67024 1782f910de\nAuthor: Emmanuel Charpentier <emm.charpentier@free.fr>\nDate:   Sun Nov 26 20:18:24 2017 +0100\n\n    Merge branch 'u/rws/upgrade_to_pynac_0_7_13' of trac.sagemath.org:sage into tst24240_n_24262\n\ncommit 1782f910ded326252088dcd2c8169e0ffc471653\nAuthor: Ralf Stephan <ralf@ark.in-berlin.de>\nDate:   Sun Nov 26 08:49:40 2017 +0100\n\n    24262: doctest last-minute-fix\n\ncommit 10a108dc41f6400dca0215e17cc5b57cb0d81a53\nAuthor: Ralf Stephan <ralf@ark.in-berlin.de>\nDate:   Sun Nov 26 08:48:53 2017 +0100\n\n    24262: last-minute fix\n\ncommit e885a6702409e1bc1bdc1f5988057f2856655568\nMerge: 7cde1424f3 46a7ebcbaa\nAuthor: Emmanuel Charpentier <emm.charpentier@free.fr>\nDate:   Wed Nov 22 21:58:13 2017 +0100\n\n    Merge branch 'u/rws/upgrade_to_pynac_0_7_13' of trac.sagemath.org:sage into tst24240_n_24262\n\ncommit 46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca\nAuthor: Ralf Stephan <ralf@ark.in-berlin.de>\nDate:   Tue Nov 21 17:35:03 2017 +0100\n\n    24262: pkg version/chksum\n\ncommit 7cde1424f39327192dfd72e7ca9ca0cb1db21895\nAuthor: Emmanuel Charpentier <emm.charpentier@free.fr>\nDate:   Sun Nov 19 18:46:59 2017 +0100\n\n    24240 : Updated freetype to 2.8.1.\n\ncommit 92f95cef93000042532acbf8d84e4bede8e699ea\nAuthor: Volker Braun <vbraun.name@gmail.com>\nDate:   Fri Nov 17 14:21:52 2017 +0100\n\n    Updated SageMath version to 8.1.rc2\n\ncommit 50a34e5f4378b9b4aba1ea972c57c4dd1e0eb8fb\nMerge: e47ca9ea99 520fdab4f6\nAuthor: Release Manager <release@sagemath.org>\n```\n\nI don't understand it, either...",
    "created_at": "2017-11-26T22:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367288",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@rwst](#comment:18):
> It doesn't look like you updated your copy of the ticket branch, e.g.. git trac pull.24262.

From the top of my git log :

```
commit 7d9462cc8b91bc25f35559a17b2fce8a4efc8d5e
Merge: e885a67024 1782f910de
Author: Emmanuel Charpentier <emm.charpentier@free.fr>
Date:   Sun Nov 26 20:18:24 2017 +0100

    Merge branch 'u/rws/upgrade_to_pynac_0_7_13' of trac.sagemath.org:sage into tst24240_n_24262

commit 1782f910ded326252088dcd2c8169e0ffc471653
Author: Ralf Stephan <ralf@ark.in-berlin.de>
Date:   Sun Nov 26 08:49:40 2017 +0100

    24262: doctest last-minute-fix

commit 10a108dc41f6400dca0215e17cc5b57cb0d81a53
Author: Ralf Stephan <ralf@ark.in-berlin.de>
Date:   Sun Nov 26 08:48:53 2017 +0100

    24262: last-minute fix

commit e885a6702409e1bc1bdc1f5988057f2856655568
Merge: 7cde1424f3 46a7ebcbaa
Author: Emmanuel Charpentier <emm.charpentier@free.fr>
Date:   Wed Nov 22 21:58:13 2017 +0100

    Merge branch 'u/rws/upgrade_to_pynac_0_7_13' of trac.sagemath.org:sage into tst24240_n_24262

commit 46a7ebcbaa98ba7bcb61f1f5c8698489b0c9b9ca
Author: Ralf Stephan <ralf@ark.in-berlin.de>
Date:   Tue Nov 21 17:35:03 2017 +0100

    24262: pkg version/chksum

commit 7cde1424f39327192dfd72e7ca9ca0cb1db21895
Author: Emmanuel Charpentier <emm.charpentier@free.fr>
Date:   Sun Nov 19 18:46:59 2017 +0100

    24240 : Updated freetype to 2.8.1.

commit 92f95cef93000042532acbf8d84e4bede8e699ea
Author: Volker Braun <vbraun.name@gmail.com>
Date:   Fri Nov 17 14:21:52 2017 +0100

    Updated SageMath version to 8.1.rc2

commit 50a34e5f4378b9b4aba1ea972c57c4dd1e0eb8fb
Merge: e47ca9ea99 520fdab4f6
Author: Release Manager <release@sagemath.org>
```

I don't understand it, either...



---

archive/issue_comments_367289.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThe usual gotcha: I forgot to bump the patchlevel, so Pynac was not recompiled when you started `make`.",
    "created_at": "2017-11-27T06:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367289",
    "user": "https://github.com/rwst"
}
```

<div id="comment:20" align="right">comment:20</div>

The usual gotcha: I forgot to bump the patchlevel, so Pynac was not recompiled when you started `make`.



---

archive/issue_comments_367290.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/438816e7e65214a19a5fed12d10b6ada94041cb5\">438816e</a></td><td><code>24262: patchlevel</code></td></tr></table>\n",
    "created_at": "2017-11-27T06:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367290",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/438816e7e65214a19a5fed12d10b6ada94041cb5">438816e</a></td><td><code>24262: patchlevel</code></td></tr></table>




---

archive/issue_comments_367291.json:
```json
{
    "body": "Changed commit from **[1782f91](https://github.com/sagemath/sagetrac-mirror/commit/1782f910ded326252088dcd2c8169e0ffc471653)** to **[438816e](https://github.com/sagemath/sagetrac-mirror/commit/438816e7e65214a19a5fed12d10b6ada94041cb5)**",
    "created_at": "2017-11-27T06:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367291",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1782f91](https://github.com/sagemath/sagetrac-mirror/commit/1782f910ded326252088dcd2c8169e0ffc471653)** to **[438816e](https://github.com/sagemath/sagetrac-mirror/commit/438816e7e65214a19a5fed12d10b6ada94041cb5)**



---

archive/issue_events_336573.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-27T06:30:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336573"
}
```



---

archive/issue_events_336574.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-27T06:30:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336574"
}
```



---

archive/issue_comments_367292.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nSmells better :\n\n```\ncharpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/symbolic/expression.pyx\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2017-11-27-09-25-00-2de1e0c6.\nGit branch: tst24240_n_24262\nUsing --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage\nDoctesting 1 file.\nsage -t --long src/sage/symbolic/expression.pyx\n    [2776 tests, 21.99 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 22.4 seconds\n    cpu time: 21.0 seconds\n    cumulative wall time: 22.0 seconds\ncharpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2017-11-27-09-26-14-fa0e402c.\nGit branch: tst24240_n_24262\nUsing --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage\nDoctesting 1 file.\nsage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\n    [805 tests, 26.29 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 26.4 seconds\n    cpu time: 26.3 seconds\n    cumulative wall time: 26.3 seconds\n```\n\n`ptestlong` underway...",
    "created_at": "2017-11-27T08:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367292",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:23" align="right">comment:23</div>

Smells better :

```
charpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/symbolic/expression.pyx
too many failed tests, not using stored timings
Running doctests with ID 2017-11-27-09-25-00-2de1e0c6.
Git branch: tst24240_n_24262
Using --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage
Doctesting 1 file.
sage -t --long src/sage/symbolic/expression.pyx
    [2776 tests, 21.99 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 22.4 seconds
    cpu time: 21.0 seconds
    cumulative wall time: 22.0 seconds
charpent@asus16-ec:/usr/local/sage-8$ sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
too many failed tests, not using stored timings
Running doctests with ID 2017-11-27-09-26-14-fa0e402c.
Git branch: tst24240_n_24262
Using --optional=database_gap,dot2tex,fricas,giacpy_sage,igraph,mpir,python2,python_igraph,sage
Doctesting 1 file.
sage -t --long src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
    [805 tests, 26.29 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 26.4 seconds
    cpu time: 26.3 seconds
    cumulative wall time: 26.3 seconds
```

`ptestlong` underway...



---

archive/issue_events_336575.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-27T09:48:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336575"
}
```



---

archive/issue_events_336576.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-27T09:48:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336576"
}
```



---

archive/issue_comments_367293.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOn top of 8.0.rc3+#24240, passes `ptestlong` with no error whatsoever.\n\n==>`positive_review`",
    "created_at": "2017-11-27T09:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367293",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:24" align="right">comment:24</div>

On top of 8.0.rc3+#24240, passes `ptestlong` with no error whatsoever.

==>`positive_review`



---

archive/issue_comments_367294.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nMerge conflict",
    "created_at": "2017-12-11T10:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367294",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

Merge conflict



---

archive/issue_events_336577.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-11T10:43:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336577"
}
```



---

archive/issue_events_336578.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-11T10:43:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336578"
}
```



---

archive/issue_comments_367295.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nWe might as well upgrade to 0.7.14 in one go. I'll prepare #24329 as soon as 8.2.beta1 is out.",
    "created_at": "2017-12-11T13:51:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367295",
    "user": "https://github.com/rwst"
}
```

<div id="comment:26" align="right">comment:26</div>

We might as well upgrade to 0.7.14 in one go. I'll prepare #24329 as soon as 8.2.beta1 is out.



---

archive/issue_events_336579.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-11T13:51:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336579"
}
```



---

archive/issue_events_336580.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-11T13:51:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336580"
}
```



---

archive/issue_events_336581.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-11T13:51:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336581"
}
```



---

archive/issue_events_336582.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-11T13:56:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336582"
}
```



---

archive/issue_events_336583.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-11T13:56:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336583"
}
```



---

archive/issue_comments_367296.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nDuplicate of #24329.",
    "created_at": "2017-12-11T13:56:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24262#issuecomment-367296",
    "user": "https://github.com/rwst"
}
```

<div id="comment:27" align="right">comment:27</div>

Duplicate of #24329.



---

archive/issue_events_336584.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336584"
}
```



---

archive/issue_events_336585.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336585"
}
```



---

archive/issue_events_336586.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24262",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "a6a6a6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24262#event-336586"
}
```
