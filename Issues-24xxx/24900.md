# Issue 24900: Tensor product and coefficients

archive/issues_024663.json:
```json
{
    "assignees": [],
    "body": "Tensor products of combinatorial free modules still use an old version of\ncartesian product. As a consequence extracting a coefficient is not possible:\n\n```\nsage: F = CombinatorialFreeModule(ZZ, [1,2]); F.__custom_name = \"F\"\nsage: G = CombinatorialFreeModule(ZZ, [3,4]); G.__custom_name = \"G\"\nsage: T = tensor([F, G]); T\nsage: T.basis()[(1,3)].coefficient((1,3))\n...\nNotImplementedError:\n```\nI fix that. As a side effect, this change the result of `an_element` so that I\nhave to fix a few doctests.\n\nMoreover, building the tensor of two infinite dimensional FM now raises a correct\nwarning:\n\n```\nsage: F = CombinatorialFreeModule(ZZ, NN)\nsage: T = tensor([F, F]); T\nFree module generated by Non negative integer semiring over Integer Ring \u2297 Free module generated by Non negative integer semiring over Integer Ring\nsage: T.an_element()\n/home/data/Sage-Install/sage-dev/local/lib/python2.7/site-packages/sage/categories/sets_cat.py:2159: UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.\n  warn(\"Sage is not able to determine whether the factors of \"\n2*B[0] \u2297 B[1] + B[0] \u2297 B[0] + 3*B[0] \u2297 B[2] + B[42] \u2297 B[42]\n```\nI'm hiding this by asking only finite dim FM.\n\n\nDepends on #19195\n\n**CC:**  @nthiery @tscrim @mkoeppe\n\n**Keywords:** tensor product, free modules\n\n**Branch:** [public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900)\n\n**Commit:** [bfa36e785be6af5bb7031d785c8469acfcd1472b](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)\n\n**Author:** Florent Hivert\n\nIssue created by migration from https://trac.sagemath.org/ticket/24900\n\n",
    "created_at": "2018-03-05T15:16:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Tensor product and coefficients",
    "type": "issue",
    "updated_at": "2022-08-31T02:51:13Z",
    "url": "https://github.com/sagemath/sage/issues/24900",
    "user": "https://github.com/hivert"
}
```
Tensor products of combinatorial free modules still use an old version of
cartesian product. As a consequence extracting a coefficient is not possible:

```
sage: F = CombinatorialFreeModule(ZZ, [1,2]); F.__custom_name = "F"
sage: G = CombinatorialFreeModule(ZZ, [3,4]); G.__custom_name = "G"
sage: T = tensor([F, G]); T
sage: T.basis()[(1,3)].coefficient((1,3))
...
NotImplementedError:
```
I fix that. As a side effect, this change the result of `an_element` so that I
have to fix a few doctests.

Moreover, building the tensor of two infinite dimensional FM now raises a correct
warning:

```
sage: F = CombinatorialFreeModule(ZZ, NN)
sage: T = tensor([F, F]); T
Free module generated by Non negative integer semiring over Integer Ring ⊗ Free module generated by Non negative integer semiring over Integer Ring
sage: T.an_element()
/home/data/Sage-Install/sage-dev/local/lib/python2.7/site-packages/sage/categories/sets_cat.py:2159: UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.
  warn("Sage is not able to determine whether the factors of "
2*B[0] ⊗ B[1] + B[0] ⊗ B[0] + 3*B[0] ⊗ B[2] + B[42] ⊗ B[42]
```
I'm hiding this by asking only finite dim FM.


Depends on #19195

**CC:**  @nthiery @tscrim @mkoeppe

**Keywords:** tensor product, free modules

**Branch:** [public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900)

**Commit:** [bfa36e785be6af5bb7031d785c8469acfcd1472b](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)

**Author:** Florent Hivert

Issue created by migration from https://trac.sagemath.org/ticket/24900





---

archive/issue_events_300007.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300007"
}
```



---

archive/issue_events_300008.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "08517b",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300008"
}
```



---

archive/issue_events_300009.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300009"
}
```



---

archive/issue_comments_381286.json:
```json
{
    "body": "**Branch:** [u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)",
    "created_at": "2018-03-05T15:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381286",
    "user": "https://github.com/hivert"
}
```

**Branch:** [u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)



---

archive/issue_comments_381287.json:
```json
{
    "body": "**Commit:** [009c70a07140b6df68ac61ccd38db52c0b1188b1](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)",
    "created_at": "2018-03-05T15:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381287",
    "user": "https://github.com/hivert"
}
```

**Commit:** [009c70a07140b6df68ac61ccd38db52c0b1188b1](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)



---

archive/issue_comments_381288.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1\">009c70a</a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>\n",
    "created_at": "2018-03-05T15:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381288",
    "user": "https://github.com/hivert"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1">009c70a</a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>




---

archive/issue_events_300010.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300010"
}
```



---

archive/issue_comments_381289.json:
```json
{
    "body": "**Author:** Florent Hivert",
    "created_at": "2018-03-05T15:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381289",
    "user": "https://github.com/hivert"
}
```

**Author:** Florent Hivert



---

archive/issue_comments_381290.json:
```json
{
    "body": "<a id='comment:3'></a>\nmany failing doctests",
    "created_at": "2018-03-14T16:50:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381290",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
many failing doctests



---

archive/issue_events_300011.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-14T16:50:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300011"
}
```



---

archive/issue_events_300012.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-14T16:50:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300012"
}
```



---

archive/issue_comments_381291.json:
```json
{
    "body": "<a id='comment:6'></a>\nrebased, just to see where this stands now\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8\">29190d3</a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>\n",
    "created_at": "2022-08-22T16:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381291",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
rebased, just to see where this stands now

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8">29190d3</a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>




---

archive/issue_comments_381292.json:
```json
{
    "body": "**Changing commit** from \"[009c70a07140b6df68ac61ccd38db52c0b1188b1](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)\" to \"[29190d35dd8266187b91f482064d785b934cb7a8](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)\".",
    "created_at": "2022-08-22T16:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381292",
    "user": "https://github.com/fchapoton"
}
```

**Changing commit** from "[009c70a07140b6df68ac61ccd38db52c0b1188b1](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)" to "[29190d35dd8266187b91f482064d785b934cb7a8](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)".



---

archive/issue_comments_381293.json:
```json
{
    "body": "**Changing branch** from \"[u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)\" to \"[public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900)\".",
    "created_at": "2022-08-22T16:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381293",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)" to "[public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900)".



---

archive/issue_events_300013.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-08-22T16:59:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300013"
}
```



---

archive/issue_events_300014.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-08-22T16:59:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300014"
}
```



---

archive/issue_comments_381294.json:
```json
{
    "body": "**Changing commit** from \"[29190d35dd8266187b91f482064d785b934cb7a8](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)\" to \"[bfa36e785be6af5bb7031d785c8469acfcd1472b](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)\".",
    "created_at": "2022-08-23T08:57:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381294",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[29190d35dd8266187b91f482064d785b934cb7a8](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)" to "[bfa36e785be6af5bb7031d785c8469acfcd1472b](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)".



---

archive/issue_comments_381295.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b\">bfa36e7</a></td><td><code>fix one doctest</code></td></tr></table>\n",
    "created_at": "2022-08-23T08:57:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381295",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b">bfa36e7</a></td><td><code>fix one doctest</code></td></tr></table>




---

archive/issue_comments_381296.json:
```json
{
    "body": "**Dependencies:** #19195",
    "created_at": "2022-08-30T05:04:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-381296",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #19195



---

archive/issue_events_300015.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300015"
}
```



---

archive/issue_events_300016.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-300016"
}
```
