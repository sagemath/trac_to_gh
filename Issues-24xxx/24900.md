# Issue 24900: Tensor product and coefficients

archive/issues_024663.json:
```json
{
    "assignees": [],
    "body": "Tensor products of combinatorial free modules still use an old version of\ncartesian product. As a consequence extracting a coefficient is not possible:\n\n```\nsage: F = CombinatorialFreeModule(ZZ, [1,2]); F.__custom_name = \"F\"\nsage: G = CombinatorialFreeModule(ZZ, [3,4]); G.__custom_name = \"G\"\nsage: T = tensor([F, G]); T\nsage: T.basis()[(1,3)].coefficient((1,3))\n...\nNotImplementedError:\n```\nI fix that. As a side effect, this change the result of `an_element` so that I\nhave to fix a few doctests.\n\nMoreover, building the tensor of two infinite dimensional FM now raises a correct\nwarning:\n\n```\nsage: F = CombinatorialFreeModule(ZZ, NN)\nsage: T = tensor([F, F]); T\nFree module generated by Non negative integer semiring over Integer Ring \u2297 Free module generated by Non negative integer semiring over Integer Ring\nsage: T.an_element()\n/home/data/Sage-Install/sage-dev/local/lib/python2.7/site-packages/sage/categories/sets_cat.py:2159: UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.\n  warn(\"Sage is not able to determine whether the factors of \"\n2*B[0] \u2297 B[1] + B[0] \u2297 B[0] + 3*B[0] \u2297 B[2] + B[42] \u2297 B[42]\n```\nI'm hiding this by asking only finite dim FM.\n\n\nDepends on #19195\n\nCC:  @nthiery @tscrim @mkoeppe\n\nKeywords: **tensor product, free modules**\n\nBranch/Commit: **[public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900) @ [`bfa36e7`](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)**\n\nAuthor: **Florent Hivert**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/24900_\n\n",
    "created_at": "2018-03-05T15:16:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Tensor product and coefficients",
    "type": "issue",
    "updated_at": "2023-01-07T21:39:40Z",
    "url": "https://github.com/sagemath/sage/issues/24900",
    "user": "https://github.com/hivert"
}
```
Tensor products of combinatorial free modules still use an old version of
cartesian product. As a consequence extracting a coefficient is not possible:

```
sage: F = CombinatorialFreeModule(ZZ, [1,2]); F.__custom_name = "F"
sage: G = CombinatorialFreeModule(ZZ, [3,4]); G.__custom_name = "G"
sage: T = tensor([F, G]); T
sage: T.basis()[(1,3)].coefficient((1,3))
...
NotImplementedError:
```
I fix that. As a side effect, this change the result of `an_element` so that I
have to fix a few doctests.

Moreover, building the tensor of two infinite dimensional FM now raises a correct
warning:

```
sage: F = CombinatorialFreeModule(ZZ, NN)
sage: T = tensor([F, F]); T
Free module generated by Non negative integer semiring over Integer Ring ⊗ Free module generated by Non negative integer semiring over Integer Ring
sage: T.an_element()
/home/data/Sage-Install/sage-dev/local/lib/python2.7/site-packages/sage/categories/sets_cat.py:2159: UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.
  warn("Sage is not able to determine whether the factors of "
2*B[0] ⊗ B[1] + B[0] ⊗ B[0] + 3*B[0] ⊗ B[2] + B[42] ⊗ B[42]
```
I'm hiding this by asking only finite dim FM.


Depends on #19195

CC:  @nthiery @tscrim @mkoeppe

Keywords: **tensor product, free modules**

Branch/Commit: **[public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900) @ [`bfa36e7`](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)**

Author: **Florent Hivert**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/24900_





---

archive/issue_events_346071.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346071"
}
```



---

archive/issue_events_346072.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346072"
}
```



---

archive/issue_events_346073.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346073"
}
```



---

archive/issue_events_346074.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:16:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346074"
}
```



---

archive/issue_comments_378651.json:
```json
{
    "body": "Branch: **[u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)**",
    "created_at": "2018-03-05T15:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378651",
    "user": "https://github.com/hivert"
}
```

Branch: **[u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)**



---

archive/issue_comments_378652.json:
```json
{
    "body": "Author: **Florent Hivert**",
    "created_at": "2018-03-05T15:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378652",
    "user": "https://github.com/hivert"
}
```

Author: **Florent Hivert**



---

archive/issue_comments_378653.json:
```json
{
    "body": "Commit: **[`009c70a`](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)**",
    "created_at": "2018-03-05T15:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378653",
    "user": "https://github.com/hivert"
}
```

Commit: **[`009c70a`](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)**



---

archive/issue_comments_378654.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1\"><code>009c70a</code></a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>\n",
    "created_at": "2018-03-05T15:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378654",
    "user": "https://github.com/hivert"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1"><code>009c70a</code></a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>




---

archive/issue_events_346075.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2018-03-05T15:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346075"
}
```



---

archive/issue_comments_378655.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nmany failing doctests",
    "created_at": "2018-03-14T16:50:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378655",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

many failing doctests



---

archive/issue_events_346076.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-14T16:50:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346076"
}
```



---

archive/issue_events_346077.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-14T16:50:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346077"
}
```



---

archive/issue_comments_378656.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nrebased, just to see where this stands now\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8\"><code>29190d3</code></a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>\n",
    "created_at": "2022-08-22T16:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378656",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

rebased, just to see where this stands now

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8"><code>29190d3</code></a></td><td><code>Fix tensor prod. using old cartesian prod.</code></td></tr></table>




---

archive/issue_comments_378657.json:
```json
{
    "body": "Changed commit from **[`009c70a`](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)** to **[`29190d3`](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)**",
    "created_at": "2022-08-22T16:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378657",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`009c70a`](https://github.com/sagemath/sagetrac-mirror/commit/009c70a07140b6df68ac61ccd38db52c0b1188b1)** to **[`29190d3`](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)**



---

archive/issue_comments_378658.json:
```json
{
    "body": "Changed branch from **[u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)** to **[public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900)**",
    "created_at": "2022-08-22T16:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378658",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[u/hivert/tensor_product_and_coefficients](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/tensor_product_and_coefficients)** to **[public/cartesian_24900](https://github.com/sagemath/sagetrac-mirror/tree/public/cartesian_24900)**



---

archive/issue_events_346078.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-08-22T16:59:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346078"
}
```



---

archive/issue_events_346079.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-08-22T16:59:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346079"
}
```



---

archive/issue_comments_378659.json:
```json
{
    "body": "Changed commit from **[`29190d3`](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)** to **[`bfa36e7`](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)**",
    "created_at": "2022-08-23T08:57:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378659",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`29190d3`](https://github.com/sagemath/sagetrac-mirror/commit/29190d35dd8266187b91f482064d785b934cb7a8)** to **[`bfa36e7`](https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b)**



---

archive/issue_comments_378660.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b\"><code>bfa36e7</code></a></td><td><code>fix one doctest</code></td></tr></table>\n",
    "created_at": "2022-08-23T08:57:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378660",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfa36e785be6af5bb7031d785c8469acfcd1472b"><code>bfa36e7</code></a></td><td><code>fix one doctest</code></td></tr></table>




---

archive/issue_comments_378661.json:
```json
{
    "body": "Dependencies: **#19195**",
    "created_at": "2022-08-30T05:04:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/24900#issuecomment-378661",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#19195**



---

archive/issue_events_346080.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346080"
}
```



---

archive/issue_events_346081.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346081"
}
```



---

archive/issue_events_346082.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346082"
}
```



---

archive/issue_events_346083.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/24900",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/24900#event-346083"
}
```
