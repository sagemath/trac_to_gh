# Issue 15156: compute the automorphism group of a morphism of P1

Issue created by migration from https://trac.sagemath.org/ticket/15393

Original creator: bhutz

Original creation time: 2013-11-10 01:01:00

Assignee: bhutz

Keywords: sage-days55

Faber-Manes-Viray published an algorithm to compute the automorphism group of a morphism of P1, "Computing conjugating sets and automorphism groups of rational functions."

Translate their code to work with the existing frame work of dynamics in Sage.


---

Comment by bhutz created at 2013-11-23 16:24:01

Changing status from new to needs_review.


---

Comment by bhutz created at 2013-11-23 16:24:01

We've modified (and documented) the FMV automorphism group algorithms to fit into the implementations in Sage for morphisms of projective space. There are a fair number of changes to the original code, but the algorithms are unchanged.


---

Comment by bhutz created at 2013-12-02 23:02:22

updated the filename to be more distinctive


---

Comment by bhutz created at 2013-12-02 23:02:34

fixed some typos


---

Attachment


---

Comment by mmarco created at 2013-12-10 22:05:06

Just a quick comment: there should be doctests that show the iso_type option.


---

Comment by bhutz created at 2013-12-10 22:59:23

Actually there are. See lines 1856 and 2802. Those are functions that are exposed to the user.


---

Comment by bhutz created at 2014-06-25 16:23:55

moved patch to branch
----
New commits:


---

Comment by gjorgenson created at 2014-10-29 17:46:02

Reviewed code and came up with a list of minor changes and some issues with the functionality:

 - Add comment before use of Subset stating that unordered subset selection works for QQ
 - In the rational fixed points function, add example demonstrating the iso_type parameter
 - Elaborate on the set W referenced from ln 134 onwards in comments
 - ln 126, 259, change ZZ to F
 - ln 237, 253, 269, change K(s) to s when appending
 - ln 287: 'We have proved that to In [FMV] it is proven that'
 - ln 332: remove "an automorphism of P^1"
 - ln 385: B=copy(A)
 - ln 394: remove 'multiplicative'
 - remove 'get_orders'. Change 'PGL_order' to be 'order' and have it call 'PGL_repn'. Fix ln 775 where 'getorders' is called (don't forget to sort by order)
 - import 'CRT' -> 'from sage.rings.arith import CRT'
 - ln 464: Integers in not imported
 - ln 498: describe 'moduli' as integer prime powers
 - in CRT_automorphisms: define M (see CRT_helper ln 430). Output also includes M
 - 'd' is not needed
 - 'CRT_automorphisms' can pass an empty list ot CRT_helper if there are no degree 'd' automorphisms. If it does encounter an empty list it needs to not pass it (or its moduli) to CRT_helper.open (maybe not since the map is injective)
 - ln 521: 'automorphim'
 - ln 534: ending comma not needed. add defaults. add that automorphisms are matrices. Deleted commented out code
 - ln 532: 'M' is an integer (product of prime powers)
 - ln 563: comment explaining 'scalar*a - (scalar*a/M).round()*M' instead of (scalar*a).lift()
 - ln 568: condense 'if' use max(abs(aa),abs(bb),abs(cc),abs(dd)), from previous change don't need absolute value.
 - ln 664: comment about del needs to start at the end not to have issues
 
automorphism_group_QQ_CRT
 - defaults for keywords
 - OUTPUT: remove 'as linear fraction transformations'
 - line 735: h=h/(gcd(h,h.derivative())), Actually do this as done on line 1260
 - line 738: points -> point
 - line 766 Q -> QQ
 - line 772: not needed comment line
 - line 788-789: A or [B and (C1 or C2)], missing []
 - line 797: QQ
 - line 805: extra line
 - line 815: extra line
 - line 827: QQ
 - line 178, 851, 852: k in never incremented
 - CRT does not seem to actually be used very well. It checks all lifts for one prime (which sine the reduction map is injective should find all the maps). This is highly inefficient when the height bound is high.
 
automorphism_group_FF
 - remove authors part to top of file
 - algoritm -> use citation
 - default for return_functions
 - examples, add keywords
 - line 920 938, 941 extra line
 
 - line 948: determines
 - line 949 yy has wrong number quotes
 - 972: no need for y
 - 983: X is not used
 - 1006: use sigma not ssigma, delete 1045
 - 1057: just use poly_ring not R
 - 1052-1053: why scaling to have constant term of numerator be 1
 - 1059-60 could use poly constructor R(ff), R(gg)
 - 1131: use citation
 - 1149: no 'phi' no 'E'
 - line 1205 extra line
 - line 1215 no 'F'
 - line 1268, 1275, 1324 extra line
 - order_p_automorphism, cite algorithm 4 in FMV
 - 1396 means we don't need pre_data
 - extra line 1451, 1462, 1474, 1485, 1489, 1501
 - line 1523 - Boolean type
 - line 1527: automorphisms with order prime to $p$.
 - 1549 get rid of 'T'
 - 1559 - assume 2nd coordinate of point is 1 (i.e. normalized
 - extra line 1565
 - line 1568: sqrt to get cardinality of the field and not the degree 2 extension
 - line 1595 : citation
 - line 1675: remove ???
 - line 1760-1765 delete
 - line 1797 should raise and error


---

Comment by gjorgenson created at 2014-10-29 17:46:02

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-11-02 14:25:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2014-11-03 16:07:08

The following map fails:


```
sage: R.<x,y> = ProjectiveSpace(QQ,1)
sage: H = End(R)
sage: f=H([6*x^2 - 39*y^2, 2*y^2])
sage: f.automorphism_group(algorithm='CRT',return_functions=True, iso_type=True)
AttributeError: 'sage.rings.integer.Integer' object has no attribute
'polynomial'
```



---

Comment by git created at 2015-01-15 18:54:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2015-01-15 18:57:16

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2015-01-15 18:57:16

Working with Xander Faber, remaining issues are resolved.


---

Comment by git created at 2015-01-16 18:07:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-01-16 21:11:07

Changing status from needs_review to positive_review.


---

Comment by gjorgenson created at 2015-01-16 21:11:07

Everything seems good.


---

Comment by vbraun created at 2015-01-23 16:40:43

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-01-23 16:40:43

Doctests fail after #17518


---

Comment by git created at 2015-01-24 01:39:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2015-01-24 01:47:31

Well, that should fix it, but I can't seem to download 17518 to verify. I get


```
The branch field on ticket #17518 is set to the non-existent
"bb4a957ea6838b11b8ec8162dc657e215dfa3dc5". Please set the field on trac to a field value.
```


If someone could tell me how to download this branch for the closed 17518, I can test. Otherwise, I guess I'll need to wait until the beta including 17518 comes out.


---

Comment by bhutz created at 2015-01-24 02:01:52

never mind, I see it is in beta5. building, then I'll check the tests


---

Comment by git created at 2015-01-24 11:49:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-01-24 12:15:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2015-01-24 12:17:36

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-01-24 12:22:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-01-25 18:58:12

Documentation looks good. Doctests and tests on example functions passed.


---

Comment by gjorgenson created at 2015-01-25 18:58:12

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-01-29 13:26:16

Resolution: fixed
