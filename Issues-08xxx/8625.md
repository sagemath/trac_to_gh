# Issue 8625: Make contour_plot choose the contour levels avoiding poles

archive/issues_008625.json:
```json
{
    "assignees": [],
    "body": "At this point contours of a function with poles get too concentrated near the poles. I'm adding a screenshot to exemplify the following code:\n\n```\nvar('x y x0 y0 q')\nR=((x-x0)^2+(y-y0)^2)^(1/2)\nfield=q/R\nq1=field(x0=1,y0=1,q=1)\nq2=field(x0=-1,y0=-1,q=-1)\ncontour_plot(q1+q2,(x,-2,2),(y,-2,2),aspect_ratio=1,fill=False,labels=True,contours=20)\n```\n\nAssignee: **olazo**\n\nCC:  @jasongrout\n\nKeywords: **scalar, plot**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8625_\n\n",
    "created_at": "2010-03-29T18:46:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make contour_plot choose the contour levels avoiding poles",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/8625",
    "user": "https://github.com/sagetrac-olazo"
}
```
At this point contours of a function with poles get too concentrated near the poles. I'm adding a screenshot to exemplify the following code:

```
var('x y x0 y0 q')
R=((x-x0)^2+(y-y0)^2)^(1/2)
field=q/R
q1=field(x0=1,y0=1,q=1)
q2=field(x0=-1,y0=-1,q=-1)
contour_plot(q1+q2,(x,-2,2),(y,-2,2),aspect_ratio=1,fill=False,labels=True,contours=20)
```

Assignee: **olazo**

CC:  @jasongrout

Keywords: **scalar, plot**

_Issue created by migration from https://trac.sagemath.org/ticket/8625_





---

archive/issue_events_095915.json:
```json
{
    "actor": "https://github.com/sagetrac-olazo",
    "created_at": "2010-03-29T18:46:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "component: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95915"
}
```



---

archive/issue_events_095916.json:
```json
{
    "actor": "https://github.com/sagetrac-olazo",
    "created_at": "2010-03-29T18:46:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95916"
}
```



---

archive/issue_events_095917.json:
```json
{
    "actor": "https://github.com/sagetrac-olazo",
    "created_at": "2010-03-29T18:46:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95917"
}
```



---

archive/issue_comments_070933.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nWould this be like a density plot or contour plot?  Even after consulting the internet I'm not quite sure what the difference would be, though perhaps a shortcut would be useful (?).",
    "created_at": "2010-07-27T17:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70933",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'>Comment 1:</a>
Would this be like a density plot or contour plot?  Even after consulting the internet I'm not quite sure what the difference would be, though perhaps a shortcut would be useful (?).



---

archive/issue_comments_070934.json:
```json
{
    "body": "Attachment: **[two_positive_charges2d.png.gz](https://github.com/sagemath/sage/files/ticket8625/two_positive_charges2d.png.gz)**\n\nAttachment: **[electric_dipole3d.png.gz](https://github.com/sagemath/sage/files/ticket8625/electric_dipole3d.png.gz)**",
    "created_at": "2010-08-01T01:06:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70934",
    "user": "https://github.com/sagetrac-olazo"
}
```

Attachment: **[two_positive_charges2d.png.gz](https://github.com/sagemath/sage/files/ticket8625/two_positive_charges2d.png.gz)**

Attachment: **[electric_dipole3d.png.gz](https://github.com/sagemath/sage/files/ticket8625/electric_dipole3d.png.gz)**



---

archive/issue_comments_070935.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nI have just attatched two pictures of the intended results. Both are plots of electric potentials the first one comes with a plot_vector_field of the corresponding electric field.\n\nI also attatched a picture of the 3d version, although I mean to make a new ticket for that once this one is finished.",
    "created_at": "2010-08-01T01:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70935",
    "user": "https://github.com/sagetrac-olazo"
}
```

<a id='comment:2'>Comment 2:</a>
I have just attatched two pictures of the intended results. Both are plots of electric potentials the first one comes with a plot_vector_field of the corresponding electric field.

I also attatched a picture of the 3d version, although I mean to make a new ticket for that once this one is finished.



---

archive/issue_comments_070936.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nIt sounds like you are looking for a contour plot (?).  Can you describe what command you used to create the first plot?  Maybe we could make a shortcut to the specific type of contour plot you need, which would give the functionality you are looking for.",
    "created_at": "2010-08-02T15:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70936",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'>Comment 3:</a>
It sounds like you are looking for a contour plot (?).  Can you describe what command you used to create the first plot?  Maybe we could make a shortcut to the specific type of contour plot you need, which would give the functionality you are looking for.



---

archive/issue_comments_070937.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nYes! I had not seen that command. I used implicit_plot. Now that I've checked contour_plot it is exactly what I wanted.\n\nThe only thing I don't like is the automatic choosing of contour levels. They usually get too high values that concentrate around the poles of the function so that there are almost no curves in parts of the picture away from the poles. I'll make a patch to improve that.\n\nAlso, it seems like there's no contour_plot3d I'll also work on that.",
    "created_at": "2010-08-02T15:56:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70937",
    "user": "https://github.com/sagetrac-olazo"
}
```

<a id='comment:4'>Comment 4:</a>
Yes! I had not seen that command. I used implicit_plot. Now that I've checked contour_plot it is exactly what I wanted.

The only thing I don't like is the automatic choosing of contour levels. They usually get too high values that concentrate around the poles of the function so that there are almost no curves in parts of the picture away from the poles. I'll make a patch to improve that.

Also, it seems like there's no contour_plot3d I'll also work on that.



---

archive/issue_comments_070938.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [olazo](#comment%3A4):\n> Yes! I had not seen that command. I used implicit_plot. Now that I've checked contour_plot it is exactly what I wanted.\n\nGreat!\n\n> The only thing I don't like is the automatic choosing of contour levels. They usually get too high values that concentrate around the poles of the function so that there are almost no curves in parts of the picture away from the poles. I'll make a patch to improve that.\n\nWhat I would do is leave the current functionality alone, but add an option for the sorts of situations you encounter - or something like that.  You can also choose the contours you want - see\n\n```\nsage: contour_plot?\n```\n\n\n> Also, it seems like there's no contour_plot3d I'll also work on that.\n\nHave you tried `implicit_plot3d`? Presumably one would use this to start.",
    "created_at": "2010-08-02T16:03:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70938",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [olazo](#comment%3A4):
> Yes! I had not seen that command. I used implicit_plot. Now that I've checked contour_plot it is exactly what I wanted.

Great!

> The only thing I don't like is the automatic choosing of contour levels. They usually get too high values that concentrate around the poles of the function so that there are almost no curves in parts of the picture away from the poles. I'll make a patch to improve that.

What I would do is leave the current functionality alone, but add an option for the sorts of situations you encounter - or something like that.  You can also choose the contours you want - see

```
sage: contour_plot?
```


> Also, it seems like there's no contour_plot3d I'll also work on that.

Have you tried `implicit_plot3d`? Presumably one would use this to start.



---

archive/issue_events_095918.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T16:03:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95918"
}
```



---

archive/issue_events_095919.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T16:03:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95919"
}
```



---

archive/issue_comments_070939.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@kcrisman](#comment%3A5):\n> What I would do is leave the current functionality alone, but add an option for the sorts of situations you encounter - or something like that.  You can also choose the contours you want - see\n\nYes, that's what I was thinking of, add something like an `,avoid_poles=False` option. Yes, I have seen the option to choose the contours.\n\n> Have you tried `implicit_plot3d`? Presumably one would use this to start.\n\nYes, that is what I used to produce the 3d picture. I have just made #9669",
    "created_at": "2010-08-02T16:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70939",
    "user": "https://github.com/sagetrac-olazo"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@kcrisman](#comment%3A5):
> What I would do is leave the current functionality alone, but add an option for the sorts of situations you encounter - or something like that.  You can also choose the contours you want - see

Yes, that's what I was thinking of, add something like an `,avoid_poles=False` option. Yes, I have seen the option to choose the contours.

> Have you tried `implicit_plot3d`? Presumably one would use this to start.

Yes, that is what I used to produce the 3d picture. I have just made #9669



---

archive/issue_comments_070940.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n-This should be a function that plots a two variable funtion as a group of isolines along a given place of the xy plane.\n+At this point contours of a function with poles get too concentrated near the poles. I'm adding a screenshot to exemplify the following code:\n \n-\n+```\n+var('x y x0 y0 q')\n+R=((x-x0)^2+(y-y0)^2)^(1/2)\n+field=q/R\n+q1=field(x0=1,y0=1,q=1)\n+q2=field(x0=-1,y0=-1,q=-1)\n+contour_plot(q1+q2,(x,-2,2),(y,-2,2),aspect_ratio=1,fill=False,labels=True,contours=20)\n+```\n``````\n",
    "created_at": "2010-10-23T23:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70940",
    "user": "https://github.com/sagetrac-olazo"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
-This should be a function that plots a two variable funtion as a group of isolines along a given place of the xy plane.
+At this point contours of a function with poles get too concentrated near the poles. I'm adding a screenshot to exemplify the following code:
 
-
+```
+var('x y x0 y0 q')
+R=((x-x0)^2+(y-y0)^2)^(1/2)
+field=q/R
+q1=field(x0=1,y0=1,q=1)
+q2=field(x0=-1,y0=-1,q=-1)
+contour_plot(q1+q2,(x,-2,2),(y,-2,2),aspect_ratio=1,fill=False,labels=True,contours=20)
+```
``````




---

archive/issue_events_095920.json:
```json
{
    "actor": "https://github.com/sagetrac-olazo",
    "created_at": "2010-10-23T23:18:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "title_is": "Make contour_plot choose the contour levels avoiding poles",
    "title_was": "plot_scalar_field (a scalar version of plot_vector_field)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95920"
}
```



---

archive/issue_comments_070941.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nAttachment: **[concentrated_contours.png.gz](https://github.com/sagemath/sage/files/ticket8625/concentrated_contours.png.gz)**",
    "created_at": "2013-08-13T15:35:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8625#issuecomment-70941",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'>Comment 8:</a>
Attachment: **[concentrated_contours.png.gz](https://github.com/sagemath/sage/files/ticket8625/concentrated_contours.png.gz)**



---

archive/issue_events_095921.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95921"
}
```



---

archive/issue_events_095922.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95922"
}
```



---

archive/issue_events_095923.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95923"
}
```



---

archive/issue_events_095924.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95924"
}
```



---

archive/issue_events_095925.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95925"
}
```



---

archive/issue_events_095926.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95926"
}
```



---

archive/issue_events_095927.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95927"
}
```



---

archive/issue_events_095928.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95928"
}
```



---

archive/issue_events_095929.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8625",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8625#event-95929"
}
```
