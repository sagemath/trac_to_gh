# Issue 8645: maxima package fails to install ECL library

archive/issues_008645.json:
```json
{
    "assignees": [],
    "body": "With the recent ECL update #8275, maxima package doesn't install the ECL library (which was added in #7287). The library is built, but put in an unexpected location. Here is the end of the log:\n\n```\n;;; Note: Invoking external command:\n;;;   ranlib /home/burcin/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/libmaxima.a\n;;; Note: Invoking external command:\n;;;   gcc \"-I/home/burcin/sage/sage-4.3.2/local/include/\"  -I/home/burcin/sage/sage-4.3.2/local/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64  -O2  -g  -Wall  -fPIC  -Dlinux -O -w -c \"/tmp/ECLINITEsuxJJ.c\" -o \"/tmp/ECLINITEsuxJJ.o\"\n;;; Note: Invoking external command:\n;;;   gcc -o \"/home/burcin/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/maxima.fasb\" -L\"/home/burcin/sage/sage-4.3.2/local/lib/\" \"/tmp/ECLINITEsuxJJ.o\" \"/home/burcin/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/libmaxima.a\"   -shared  -L/home/burcin/sage/sage-4.3.2/local/lib  -L/home/burcin/sage/sage-4.3.2/local/lib  -lecl  -lgmp -lgc -ldl  -lm \ninstalling Maxima library as /home/burcin/sage/sage-4.3.2/local/lib/ecl//maxima.fas\ncp: cannot stat `maxima.fasb': No such file or directory\n\nreal    3m15.250s\nuser    2m34.586s\nsys     0m19.645s\nSuccessfully installed maxima-5.20.1\n```\n\nNote that the return value of the cp command is not checked.\n\nThe files are here:\n\n```\nburcin@karr ~/sage/sage-4.3.2 $ ls ~/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/\nlibmaxima.a  maxima.fasb  \n```\n\nAny ideas why?\n\n**CC:**  @nbruin @williamstein mvngu @qed777 @jdemeyer\n\n**Keywords:** maxima, ecl\n\n**Reviewer:** Karl-Dieter Crisman\n\nIssue created by migration from https://trac.sagemath.org/ticket/8645\n\n",
    "closed_at": "2011-01-19T22:11:35Z",
    "created_at": "2010-04-02T22:58:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "maxima package fails to install ECL library",
    "type": "issue",
    "updated_at": "2011-01-19T22:11:35Z",
    "url": "https://github.com/sagemath/sage/issues/8645",
    "user": "https://github.com/burcin"
}
```
With the recent ECL update #8275, maxima package doesn't install the ECL library (which was added in #7287). The library is built, but put in an unexpected location. Here is the end of the log:

```
;;; Note: Invoking external command:
;;;   ranlib /home/burcin/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/libmaxima.a
;;; Note: Invoking external command:
;;;   gcc "-I/home/burcin/sage/sage-4.3.2/local/include/"  -I/home/burcin/sage/sage-4.3.2/local/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64  -O2  -g  -Wall  -fPIC  -Dlinux -O -w -c "/tmp/ECLINITEsuxJJ.c" -o "/tmp/ECLINITEsuxJJ.o"
;;; Note: Invoking external command:
;;;   gcc -o "/home/burcin/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/maxima.fasb" -L"/home/burcin/sage/sage-4.3.2/local/lib/" "/tmp/ECLINITEsuxJJ.o" "/home/burcin/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/libmaxima.a"   -shared  -L/home/burcin/sage/sage-4.3.2/local/lib  -L/home/burcin/sage/sage-4.3.2/local/lib  -lecl  -lgmp -lgc -ldl  -lm 
installing Maxima library as /home/burcin/sage/sage-4.3.2/local/lib/ecl//maxima.fas
cp: cannot stat `maxima.fasb': No such file or directory

real    3m15.250s
user    2m34.586s
sys     0m19.645s
Successfully installed maxima-5.20.1
```

Note that the return value of the cp command is not checked.

The files are here:

```
burcin@karr ~/sage/sage-4.3.2 $ ls ~/.cache/common-lisp/ecl-10.2.1-linux-x86-64/home/burcin/sage/sage-4.3.2/spkg/build/maxima-5.20.1/src/src/
libmaxima.a  maxima.fasb  
```

Any ideas why?

**CC:**  @nbruin @williamstein mvngu @qed777 @jdemeyer

**Keywords:** maxima, ecl

**Reviewer:** Karl-Dieter Crisman

Issue created by migration from https://trac.sagemath.org/ticket/8645





---

archive/issue_comments_071116.json:
```json
{
    "body": "**Remove assignee** @aghitza.",
    "created_at": "2010-04-10T09:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71116",
    "user": "https://github.com/burcin"
}
```

**Remove assignee** @aghitza.



---

archive/issue_events_061630.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-04-10T09:44:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "08517b",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61630"
}
```



---

archive/issue_events_061631.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-04-10T09:44:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages",
    "label_color": "08517b",
    "label_name": "component: packages",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61631"
}
```



---

archive/issue_comments_071117.json:
```json
{
    "body": "<a id='comment:2'></a>\nI checked and between maxima 5.19 and maxima 5.20 none of the \"lisp\" files have changed in src/src, so it seems very unlikely that the change in location of maxima.fasb is due to the maxima upgrade.\n\nOn the other hand, between ECL 9 and ECL 10, there seems to be a lot of activity in the ASDF module, which is responsible for the building:\n\nhttp://ecls.cvs.sourceforge.net/viewvc/ecls/ecl/src/CHANGELOG?view=markup\n\nso I can easily believe that the cause is here.\n\nIn particular, they are advertising a new option \":move-here\" which allows the destination to be specified. I tried this with the presently packaged ECL 10.2.1 without luck, so perhaps upgrading ECL would be a good idea (and then hope they don't touch ASDF for a while).\n\nOn the plus side: The \"fasb\" file type is always recognised by ECL 10.4.2, so the ugly (and risky?) renaming should not be necessary anymore.\n\nIf after upgrading you still can't manage getting maxima.fasb in a sane location, perhaps drop Juanjo a line.",
    "created_at": "2010-04-13T22:07:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71117",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:2'></a>
I checked and between maxima 5.19 and maxima 5.20 none of the "lisp" files have changed in src/src, so it seems very unlikely that the change in location of maxima.fasb is due to the maxima upgrade.

On the other hand, between ECL 9 and ECL 10, there seems to be a lot of activity in the ASDF module, which is responsible for the building:

http://ecls.cvs.sourceforge.net/viewvc/ecls/ecl/src/CHANGELOG?view=markup

so I can easily believe that the cause is here.

In particular, they are advertising a new option ":move-here" which allows the destination to be specified. I tried this with the presently packaged ECL 10.2.1 without luck, so perhaps upgrading ECL would be a good idea (and then hope they don't touch ASDF for a while).

On the plus side: The "fasb" file type is always recognised by ECL 10.4.2, so the ugly (and risky?) renaming should not be necessary anymore.

If after upgrading you still can't manage getting maxima.fasb in a sane location, perhaps drop Juanjo a line.



---

archive/issue_comments_071118.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis may be of some help. I tried building with ECL 10.4.1. As announced in\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/e094589b2d99be8a/ab26bd29b3a8990a\nwe need a patch (attached there) to Maxima 5.20.1 to let it build.\n\nThe following instruction *should* do the trick\n\n```\n(require 'asdf)\n(load \"maxima-build.lisp\")\n(asdf:make-build :maxima :type :fasl :move-here \".\")\n```\nbut for me they lead to an error\n\n```\nCannot rename the file #P\"/home/nbruin/.cache/common-lisp/ecl-10.4.1-linux-x86-64/usr/local/sage/4.3.4/spkg/build/maxima-5.20.1/src/src/maxima.fasb\" to #P\"/usr/local/sage/4.3.4/spkg/build/maxima-5.20.1/src/src/maxima.fasb\".\nExplanation: Invalid cross-device link.\n```\nThis error message indicates:\n* that ECL is trying to do exactly the right thing\n* that it's trying to do the move with a hard link, which it shouldn't try. That's a straightforward error, which will probably be fixed in ECL 10.4.2.\n\nSo my guess is that this issue should be fixable quite soon by upgrading.\n\nOh, and the line\n\n```\ncp maxima.fasb $ECLLIB/maxima.fas\n```\nshould be changed to\n\n```\ncp maxima.fasb $ECLLIB || echo \"Failed to build maxima.fasb\"; exit 1\n```\nso that errors like this get caught next time and because ECL 10.4 supposedly natively recognizes .fasb files.",
    "created_at": "2010-04-14T06:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71118",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:3'></a>
This may be of some help. I tried building with ECL 10.4.1. As announced in
http://groups.google.com/group/sage-devel/browse_thread/thread/e094589b2d99be8a/ab26bd29b3a8990a
we need a patch (attached there) to Maxima 5.20.1 to let it build.

The following instruction *should* do the trick

```
(require 'asdf)
(load "maxima-build.lisp")
(asdf:make-build :maxima :type :fasl :move-here ".")
```
but for me they lead to an error

```
Cannot rename the file #P"/home/nbruin/.cache/common-lisp/ecl-10.4.1-linux-x86-64/usr/local/sage/4.3.4/spkg/build/maxima-5.20.1/src/src/maxima.fasb" to #P"/usr/local/sage/4.3.4/spkg/build/maxima-5.20.1/src/src/maxima.fasb".
Explanation: Invalid cross-device link.
```
This error message indicates:
* that ECL is trying to do exactly the right thing
* that it's trying to do the move with a hard link, which it shouldn't try. That's a straightforward error, which will probably be fixed in ECL 10.4.2.

So my guess is that this issue should be fixable quite soon by upgrading.

Oh, and the line

```
cp maxima.fasb $ECLLIB/maxima.fas
```
should be changed to

```
cp maxima.fasb $ECLLIB || echo "Failed to build maxima.fasb"; exit 1
```
so that errors like this get caught next time and because ECL 10.4 supposedly natively recognizes .fasb files.



---

archive/issue_comments_071119.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis should solve the problem:\n\n```\nmkdir ./lisp-cache\n```\nthen in lisp:\n\n```\n(require 'asdf)\n(setf asdf::*user-cache* (truename \"./lisp-cache\"))\n(load \"maxima-build.lisp\")\n(asdf:make-build :maxima :type :fasl :move-here \".\")\n```\n\n* this directory is guaranteed to be on the same file system\n* the cache is not accidentally on a slower (/home) file system\n* the cache gets wiped when spkg/build/maxima-5.20.1 does.\n* no interference with a possible cache that the user privately might have in ecl\n\nSo, what needs to be done is:\n\n* upgrade to ecl 10.4.1\n* patch Maxima to build with ecl 10.4.1\n* patch maxima's spkg-install with the above changes so that maxima.fasb gets built in the right place.",
    "created_at": "2010-04-14T15:58:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71119",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:4'></a>
This should solve the problem:

```
mkdir ./lisp-cache
```
then in lisp:

```
(require 'asdf)
(setf asdf::*user-cache* (truename "./lisp-cache"))
(load "maxima-build.lisp")
(asdf:make-build :maxima :type :fasl :move-here ".")
```

* this directory is guaranteed to be on the same file system
* the cache is not accidentally on a slower (/home) file system
* the cache gets wiped when spkg/build/maxima-5.20.1 does.
* no interference with a possible cache that the user privately might have in ecl

So, what needs to be done is:

* upgrade to ecl 10.4.1
* patch Maxima to build with ecl 10.4.1
* patch maxima's spkg-install with the above changes so that maxima.fasb gets built in the right place.



---

archive/issue_comments_071120.json:
```json
{
    "body": "patch for ecl-10.4.1.spkg",
    "created_at": "2010-04-15T05:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71120",
    "user": "https://github.com/nbruin"
}
```

patch for ecl-10.4.1.spkg



---

archive/issue_comments_071121.json:
```json
{
    "body": "**Attachment:** [ecl-10.4.1.patch.gz](https://github.com/sagemath/sage/files/ticket8645/ecl-10.4.1.patch.gz)\n\n**Attachment:** [maxima-5.20.1.p1.patch.gz](https://github.com/sagemath/sage/files/ticket8645/maxima-5.20.1.p1.patch.gz)\n\npatch for maxima-5.20.1.p1.spkg",
    "created_at": "2010-04-15T05:41:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71121",
    "user": "https://github.com/nbruin"
}
```

**Attachment:** [ecl-10.4.1.patch.gz](https://github.com/sagemath/sage/files/ticket8645/ecl-10.4.1.patch.gz)

**Attachment:** [maxima-5.20.1.p1.patch.gz](https://github.com/sagemath/sage/files/ticket8645/maxima-5.20.1.p1.patch.gz)

patch for maxima-5.20.1.p1.spkg



---

archive/issue_comments_071122.json:
```json
{
    "body": "**Author:** Nils Bruin",
    "created_at": "2010-04-15T05:48:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71122",
    "user": "https://github.com/nbruin"
}
```

**Author:** Nils Bruin



---

archive/issue_events_061632.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2010-04-15T05:48:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61632"
}
```



---

archive/issue_comments_071123.json:
```json
{
    "body": "<a id='comment:5'></a>\nUpdated spkgs up at\n\nhttp://sage.math.washington.edu/home/nbruin/ecl-10.4.1.spkg\n\nhttp://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg\n\nI haven't extensively tested them but at least on sage.math they seem to work and changes are small otherwise. Someone probably wants to test maxima on ecl-10.4.1 extensively (although maxima is part of the regular ecl buildfarm testsuite)\n\nFor reference, I have also attached the patches for the spkgs. *These are already applied to the above spkgs*.",
    "created_at": "2010-04-15T05:48:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71123",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:5'></a>
Updated spkgs up at

http://sage.math.washington.edu/home/nbruin/ecl-10.4.1.spkg

http://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg

I haven't extensively tested them but at least on sage.math they seem to work and changes are small otherwise. Someone probably wants to test maxima on ecl-10.4.1 extensively (although maxima is part of the regular ecl buildfarm testsuite)

For reference, I have also attached the patches for the spkgs. *These are already applied to the above spkgs*.



---

archive/issue_comments_071124.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe maxima package at #8731 supersedes the maxima spkg here.",
    "created_at": "2010-04-20T19:32:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71124",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>
The maxima package at #8731 supersedes the maxima spkg here.



---

archive/issue_comments_071125.json:
```json
{
    "body": "<a id='comment:7'></a>\nDoes this ECL package fix #7690?  The ecl update at #8808 claims to fix #7690.",
    "created_at": "2010-05-13T03:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71125",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>
Does this ECL package fix #7690?  The ecl update at #8808 claims to fix #7690.



---

archive/issue_comments_071126.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe src/ directory in the ecl spkg on this ticket is not the same as the ECL official sources (this spkg is missing several directories, like \"src/contrib/encodings\" and \"src/msvc\".  So I think #8808's ecl spkg supersedes the ecl spkg on this ticket.\n\nSo with that, I think this ticket should be closed, as the two spkgs listed on it are superseded elsewhere.",
    "created_at": "2010-05-13T04:16:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71126",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>
The src/ directory in the ecl spkg on this ticket is not the same as the ECL official sources (this spkg is missing several directories, like "src/contrib/encodings" and "src/msvc".  So I think #8808's ecl spkg supersedes the ecl spkg on this ticket.

So with that, I think this ticket should be closed, as the two spkgs listed on it are superseded elsewhere.



---

archive/issue_events_061633.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-05-13T07:28:24Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "milestone_number": null,
    "milestone_title": "sage-4.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61633"
}
```



---

archive/issue_events_061634.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-05-13T07:28:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61634"
}
```



---

archive/issue_events_061635.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-05-13T07:28:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61635"
}
```



---

archive/issue_comments_071127.json:
```json
{
    "body": "<a id='comment:10'></a>\nMy apologies--#8808 was actually in error, and this spkg was correctly made.  I've corrected the mistake on #8951.  So really, this ticket should be closed as fixed, and #8808 should be closed as invalid.",
    "created_at": "2010-05-14T17:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71127",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:10'></a>
My apologies--#8808 was actually in error, and this spkg was correctly made.  I've corrected the mistake on #8951.  So really, this ticket should be closed as fixed, and #8808 should be closed as invalid.



---

archive/issue_events_061636.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-05-14T21:32:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "milestone_number": null,
    "milestone_title": "sage-4.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61636"
}
```



---

archive/issue_comments_071128.json:
```json
{
    "body": "<a id='comment:12'></a>\nThis ticket was not merged in 4.4.2, so I'm reopening. The ecl spkg on #8951 supersedes the one here. However, the maxima spkg on #8731 is listed as \"needs work\" so declaring that the spkg there supersedes the one here is a bit premature. The only change in \n\nhttp://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg\n\nis to the way that maxima.fasb get built, copied and its existence tested, so reviewing that should be quick.",
    "created_at": "2010-06-16T00:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71128",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:12'></a>
This ticket was not merged in 4.4.2, so I'm reopening. The ecl spkg on #8951 supersedes the one here. However, the maxima spkg on #8731 is listed as "needs work" so declaring that the spkg there supersedes the one here is a bit premature. The only change in 

http://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg

is to the way that maxima.fasb get built, copied and its existence tested, so reviewing that should be quick.



---

archive/issue_events_061637.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2010-06-16T00:43:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61637"
}
```



---

archive/issue_events_061638.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2010-06-16T00:48:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "milestone_number": null,
    "milestone_title": "sage-4.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61638"
}
```



---

archive/issue_events_061639.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2010-06-16T00:48:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "milestone_number": null,
    "milestone_title": "sage-4.4.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61639"
}
```



---

archive/issue_comments_071129.json:
```json
{
    "body": "<a id='comment:15'></a>\nI'm just building sage-4.4.4.alpha1 on Solaris 10 SPARC and will test this as soon as that is finished. What other machines has it been tested on? \n\nI can't spend any more time on this just now - my wife wants me to do something which is going to take a few hours. \n\nI think it is sensible to upgrade the maxima in this way, but there are various small changes to ECL which could (should) be merged into the ecl update. \n\nWould you consider making merging these patches \n\n* On #8951, the patch which removes the tmp files and has a minor (really cosmetic) changes to spkg-install. The removal of the tmp files is quite important, as it often stops builds on 't2'\n* On #8089 the patch to disable assembly code on OpenSolaris\n* On #9187 the patch to allow parallel building of .spkgs. \n\nI think if a new .spkg with ECL 10.4.1 is created, and the Maxima changed to work properly with that, then these should be merged. Then hopefully the maxima update can be separated. \n\nOne of the issues I will have reviewing this is the fact I don't know lisp, but I doubt many people will so I will do my best. \n\nBut just now I need to do other things. \n\nDave",
    "created_at": "2010-06-18T17:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71129",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:15'></a>
I'm just building sage-4.4.4.alpha1 on Solaris 10 SPARC and will test this as soon as that is finished. What other machines has it been tested on? 

I can't spend any more time on this just now - my wife wants me to do something which is going to take a few hours. 

I think it is sensible to upgrade the maxima in this way, but there are various small changes to ECL which could (should) be merged into the ecl update. 

Would you consider making merging these patches 

* On #8951, the patch which removes the tmp files and has a minor (really cosmetic) changes to spkg-install. The removal of the tmp files is quite important, as it often stops builds on 't2'
* On #8089 the patch to disable assembly code on OpenSolaris
* On #9187 the patch to allow parallel building of .spkgs. 

I think if a new .spkg with ECL 10.4.1 is created, and the Maxima changed to work properly with that, then these should be merged. Then hopefully the maxima update can be separated. 

One of the issues I will have reviewing this is the fact I don't know lisp, but I doubt many people will so I will do my best. 

But just now I need to do other things. 

Dave



---

archive/issue_comments_071130.json:
```json
{
    "body": "<a id='comment:16'></a>\nIf #9264 gets merged then this ticked can be closed as resolved.",
    "created_at": "2010-06-21T06:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71130",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:16'></a>
If #9264 gets merged then this ticked can be closed as resolved.



---

archive/issue_comments_071131.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [@nbruin](#comment%3A16):\n> If #9264 gets merged then this ticked can be closed as resolved.\n\nAre you sure that is correct? #9264 only makes changes to ECL, not Maxima. So the revised Maxima package at  http://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg must still be merged. What does not need merging is the ECL patch attached here, as that is covered by #9264\n\n\nDave",
    "created_at": "2010-06-21T09:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71131",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:17'></a>
Replying to [@nbruin](#comment%3A16):
> If #9264 gets merged then this ticked can be closed as resolved.

Are you sure that is correct? #9264 only makes changes to ECL, not Maxima. So the revised Maxima package at  http://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg must still be merged. What does not need merging is the ECL patch attached here, as that is covered by #9264


Dave



---

archive/issue_comments_071132.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [drkirkby](#comment%3A17):\n\n> Are you sure that is correct? #9264 only makes changes to ECL, not Maxima.\n\nExcept for the \"Important\" section and the comment in the positive review. Only upgrading ECL will lead to maxima not building, so no doctests will pass. A successful merge has to include a change to maxima.\n\n(incidentally, on #9264 it would have helped a lot if you had also run \"make test\" or \"make ptest\" after the successful build. One of the issues on #8731 was that it people were unsure whether the doctest failures were due to the ECL upgrade or the maxima upgrade. We now know it's just due to maxima 5.21 behaving differently)",
    "created_at": "2010-06-21T18:00:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71132",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:18'></a>
Replying to [drkirkby](#comment%3A17):

> Are you sure that is correct? #9264 only makes changes to ECL, not Maxima.

Except for the "Important" section and the comment in the positive review. Only upgrading ECL will lead to maxima not building, so no doctests will pass. A successful merge has to include a change to maxima.

(incidentally, on #9264 it would have helped a lot if you had also run "make test" or "make ptest" after the successful build. One of the issues on #8731 was that it people were unsure whether the doctest failures were due to the ECL upgrade or the maxima upgrade. We now know it's just due to maxima 5.21 behaving differently)



---

archive/issue_events_061640.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-06-21T20:15:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61640"
}
```



---

archive/issue_events_061641.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-06-21T20:15:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61641"
}
```



---

archive/issue_comments_071133.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [@nbruin](#comment%3A18):\n> Replying to [drkirkby](#comment%3A17):\n> \n> > Are you sure that is correct? #9264 only makes changes to ECL, not Maxima.\n\n> \n> Except for the \"Important\" section and the comment in the positive review. Only upgrading ECL will lead to maxima not building, so no doctests will pass. A successful merge has to include a change to maxima.\n\n\nThat was my point - upgrading just ECL would not have worked. \n \n> (incidentally, on #9264 it would have helped a lot if you had also run \"make test\" or \"make ptest\" after the successful build. One of the issues on #8731 was that it people were unsure whether the doctest failures were due to the ECL upgrade or the maxima upgrade. We now know it's just due to maxima 5.21 behaving differently)\n\nOK, point taken. \n\nIt would be good if there was a list of doc tests associated with each package, so its possible to quickly test if changes break any tests. \n\nAnyway, positive review. \n\n == Note to release manager ==\nThis ticket, and #9264 need to be merged together. Merging  #9264 without this one will cause problems. \nDave \n\nDave",
    "created_at": "2010-06-21T20:15:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71133",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:19'></a>
Replying to [@nbruin](#comment%3A18):
> Replying to [drkirkby](#comment%3A17):
> 
> > Are you sure that is correct? #9264 only makes changes to ECL, not Maxima.

> 
> Except for the "Important" section and the comment in the positive review. Only upgrading ECL will lead to maxima not building, so no doctests will pass. A successful merge has to include a change to maxima.


That was my point - upgrading just ECL would not have worked. 
 
> (incidentally, on #9264 it would have helped a lot if you had also run "make test" or "make ptest" after the successful build. One of the issues on #8731 was that it people were unsure whether the doctest failures were due to the ECL upgrade or the maxima upgrade. We now know it's just due to maxima 5.21 behaving differently)

OK, point taken. 

It would be good if there was a list of doc tests associated with each package, so its possible to quickly test if changes break any tests. 

Anyway, positive review. 

 == Note to release manager ==
This ticket, and #9264 need to be merged together. Merging  #9264 without this one will cause problems. 
Dave 

Dave



---

archive/issue_events_061642.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T15:46:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61642"
}
```



---

archive/issue_events_061643.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T15:46:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61643"
}
```



---

archive/issue_comments_071134.json:
```json
{
    "body": "**Merged:** sage-4.5.alpha0",
    "created_at": "2010-06-25T15:46:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71134",
    "user": "https://github.com/rlmill"
}
```

**Merged:** sage-4.5.alpha0



---

archive/issue_comments_071135.json:
```json
{
    "body": "**Reviewer:** David Kirkby",
    "created_at": "2010-06-25T15:46:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71135",
    "user": "https://github.com/rlmill"
}
```

**Reviewer:** David Kirkby



---

archive/issue_comments_071136.json:
```json
{
    "body": "<a id='comment:20'></a>\nApplied http://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg",
    "created_at": "2010-06-25T15:46:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71136",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:20'></a>
Applied http://sage.math.washington.edu/home/nbruin/maxima-5.20.1.p1.spkg



---

archive/issue_comments_071137.json:
```json
{
    "body": "<a id='comment:21'></a>\nCould any of the changes here be related to the problems at #9460?",
    "created_at": "2010-07-09T06:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71137",
    "user": "https://github.com/qed777"
}
```

<a id='comment:21'></a>
Could any of the changes here be related to the problems at #9460?



---

archive/issue_comments_071138.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [@qed777](#comment%3A21):\n> Could any of the changes here be related to the problems at #9460?\n\nPossibly, though I don't recall seeing reports of this against sage-4.5.alpha0, which was when this ticket was merged. \n\nDave",
    "created_at": "2010-07-09T08:51:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71138",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:22'></a>
Replying to [@qed777](#comment%3A21):
> Could any of the changes here be related to the problems at #9460?

Possibly, though I don't recall seeing reports of this against sage-4.5.alpha0, which was when this ticket was merged. 

Dave



---

archive/issue_comments_071139.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [drkirkby](#comment%3A22):\n> Replying to [@qed777](#comment%3A21):\n> > Could any of the changes here be related to the problems at #9460?\n\n> Possibly, though I don't recall seeing reports of this against sage-4.5.alpha0, which was when this ticket was merged. \n\nWilliam, AFAIK, reported those failures on the first alpha in the 4.5 series that he tested. So it is quite possible.",
    "created_at": "2010-07-09T09:04:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71139",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:23'></a>
Replying to [drkirkby](#comment%3A22):
> Replying to [@qed777](#comment%3A21):
> > Could any of the changes here be related to the problems at #9460?

> Possibly, though I don't recall seeing reports of this against sage-4.5.alpha0, which was when this ticket was merged. 

William, AFAIK, reported those failures on the first alpha in the 4.5 series that he tested. So it is quite possible.



---

archive/issue_comments_071140.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [@rlmill](#comment%3A23):\n> Replying to [drkirkby](#comment%3A22):\n> > Replying to [@qed777](#comment%3A21):\n> > > Could any of the changes here be related to the problems at #9460?\n\n> > Possibly, though I don't recall seeing reports of this against sage-4.5.alpha0, which was when this ticket was merged. \n\n> \n> William, AFAIK, reported those failures on the first alpha in the 4.5 series that he tested. So it is quite possible.\n\nIn which case reverting this would be sensible, though it we be good if we could if we could find the circumstances in which the problem occurs - there is a note that it may occur only if Sage is built from a script. \n\nDave",
    "created_at": "2010-07-09T09:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71140",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:24'></a>
Replying to [@rlmill](#comment%3A23):
> Replying to [drkirkby](#comment%3A22):
> > Replying to [@qed777](#comment%3A21):
> > > Could any of the changes here be related to the problems at #9460?

> > Possibly, though I don't recall seeing reports of this against sage-4.5.alpha0, which was when this ticket was merged. 

> 
> William, AFAIK, reported those failures on the first alpha in the 4.5 series that he tested. So it is quite possible.

In which case reverting this would be sensible, though it we be good if we could if we could find the circumstances in which the problem occurs - there is a note that it may occur only if Sage is built from a script. 

Dave



---

archive/issue_comments_071141.json:
```json
{
    "body": "<a id='comment:25'></a>\nIt seems that there are unchecked in changes in the spkg:\n\n```sh\n$ tar xvf sage-4.5.alpha4/spkg/standard/maxima-5.20.1.p1.spkg\n$ cd maxima-5.20.1.p1\n$ hg stat\n? patches/defsystem.lisp\n? patches/ecl-port.lisp\n```",
    "created_at": "2010-07-09T23:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71141",
    "user": "https://github.com/qed777"
}
```

<a id='comment:25'></a>
It seems that there are unchecked in changes in the spkg:

```sh
$ tar xvf sage-4.5.alpha4/spkg/standard/maxima-5.20.1.p1.spkg
$ cd maxima-5.20.1.p1
$ hg stat
? patches/defsystem.lisp
? patches/ecl-port.lisp
```



---

archive/issue_comments_071142.json:
```json
{
    "body": "**Changing merged** from \"sage-4.5.alpha0\" to \"\".",
    "created_at": "2010-07-11T19:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71142",
    "user": "https://github.com/rlmill"
}
```

**Changing merged** from "sage-4.5.alpha0" to "".



---

archive/issue_comments_071143.json:
```json
{
    "body": "<a id='comment:28'></a>\nThis is marked as minor, but I've found it causes Maxima to fail to install on bsd.math, so it breaks the build. \n\n```\n;;;   gcc -o \"/Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/ECL001STjrNf.fas\" -L\"/Users/kirkby/sage-4.5.alpha1/local/lib/\" \"/Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/ECL001STjrNf.o\"   -bundle  -L/Users/kirkby/sage-4.5.alpha1/local/lib -m64   -L/Users/kirkby/sage-4.5.alpha1/local/lib -m64   -lffi -lecl  -lgmp   -lm \n; loading system definition from\n; /Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/maxima.asd\n; into #<ASDF0 package>\n;;; Loading \"/Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/maxima.asd\"\n; registering #<SYSTEM :MAXIMA 4321128880> as MAXIMA\nAn error occurred during initialization:\nUnknown keyword :MOVE-HERE.\n\ninstalling Maxima library as /Users/kirkby/sage-4.5.alpha1/local/lib/ecl//maxima.fas\ncp: cannot stat `maxima.fasb': No such file or directory\n***********************************************************\nFailed to install maxima.fasb as a library\n***********************************************************\n\nreal\t4m45.305s\nuser\t3m35.767s\nsys\t0m41.909s\nsage: An error occurred while installing maxima-5.20.1.p1\n```\n\nThat's not a minor problem to me, if it stops Sage building.",
    "created_at": "2010-09-17T00:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71143",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:28'></a>
This is marked as minor, but I've found it causes Maxima to fail to install on bsd.math, so it breaks the build. 

```
;;;   gcc -o "/Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/ECL001STjrNf.fas" -L"/Users/kirkby/sage-4.5.alpha1/local/lib/" "/Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/ECL001STjrNf.o"   -bundle  -L/Users/kirkby/sage-4.5.alpha1/local/lib -m64   -L/Users/kirkby/sage-4.5.alpha1/local/lib -m64   -lffi -lecl  -lgmp   -lm 
; loading system definition from
; /Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/maxima.asd
; into #<ASDF0 package>
;;; Loading "/Users/kirkby/sage-4.5.alpha1/spkg/build/maxima-5.20.1.p1/src/src/maxima.asd"
; registering #<SYSTEM :MAXIMA 4321128880> as MAXIMA
An error occurred during initialization:
Unknown keyword :MOVE-HERE.

installing Maxima library as /Users/kirkby/sage-4.5.alpha1/local/lib/ecl//maxima.fas
cp: cannot stat `maxima.fasb': No such file or directory
***********************************************************
Failed to install maxima.fasb as a library
***********************************************************

real	4m45.305s
user	3m35.767s
sys	0m41.909s
sage: An error occurred while installing maxima-5.20.1.p1
```

That's not a minor problem to me, if it stops Sage building.



---

archive/issue_events_061644.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-09-17T00:47:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61644"
}
```



---

archive/issue_comments_071144.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [drkirkby](#comment%3A28):\n\n```\n> Unknown keyword :MOVE-HERE.\n> \n> installing Maxima library as /Users/kirkby/sage-4.5.alpha1/local/lib/ecl//maxima.fas\n> cp: cannot stat `maxima.fasb': No such file or directory\n> ***********************************************************\n> Failed to install maxima.fasb as a library\n> ***********************************************************\n> \n> real\t4m45.305s\n> user\t3m35.767s\n> sys\t0m41.909s\n> sage: An error occurred while installing maxima-5.20.1.p1\n```\nThe package maxima-5.20.1.p1 is designed to be built on ecl 10.4.1 or later. In order to use the :MOVE-HERE keyword, I had to upgrade to ecl 10.4.1.\n\nI think sage is still shipping maxima-5.20.1.p0 with ecl 10.2.1, which silently fails to build maxima.fasb. Hence the original filing as \"minor\": a library that by default isn't used silently fails to build.",
    "created_at": "2010-09-18T03:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71144",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:29'></a>
Replying to [drkirkby](#comment%3A28):

```
> Unknown keyword :MOVE-HERE.
> 
> installing Maxima library as /Users/kirkby/sage-4.5.alpha1/local/lib/ecl//maxima.fas
> cp: cannot stat `maxima.fasb': No such file or directory
> ***********************************************************
> Failed to install maxima.fasb as a library
> ***********************************************************
> 
> real	4m45.305s
> user	3m35.767s
> sys	0m41.909s
> sage: An error occurred while installing maxima-5.20.1.p1
```
The package maxima-5.20.1.p1 is designed to be built on ecl 10.4.1 or later. In order to use the :MOVE-HERE keyword, I had to upgrade to ecl 10.4.1.

I think sage is still shipping maxima-5.20.1.p0 with ecl 10.2.1, which silently fails to build maxima.fasb. Hence the original filing as "minor": a library that by default isn't used silently fails to build.



---

archive/issue_comments_071145.json:
```json
{
    "body": "<a id='comment:30'></a>\nThank you, it seem whenever we need to update we need to \n\n* Update maxima\n* Update ecl\n* Update the doctests\n\nwhich is a bit annoying. It often does not seem possible to update ecl or maxima independently.",
    "created_at": "2010-09-18T12:18:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71145",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:30'></a>
Thank you, it seem whenever we need to update we need to 

* Update maxima
* Update ecl
* Update the doctests

which is a bit annoying. It often does not seem possible to update ecl or maxima independently.



---

archive/issue_comments_071146.json:
```json
{
    "body": "<a id='comment:31'></a>\nI don't think that is true. I think maxima-5.20.1.p0 will build an executable on ecl 10.4.1 and will silently fail to build maxima.fasl, just as it does on ecl 10.2.1. Furthermore, I think maxima-5.20.1 on ecl 10.2.1 produces the same output as on 10.4.1 (given that the only changes between .p0 and .p1 had to do with building a by default unused library)\n\nThe fact that doctests for maxima have to be adjusted is a good thing. A bunch of those detect error conditions that are not errors in newer versions of maxima.\n\nBut in general, you'd expect dependent packages to be - you know - dependent :-).",
    "created_at": "2010-09-20T17:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71146",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:31'></a>
I don't think that is true. I think maxima-5.20.1.p0 will build an executable on ecl 10.4.1 and will silently fail to build maxima.fasl, just as it does on ecl 10.2.1. Furthermore, I think maxima-5.20.1 on ecl 10.2.1 produces the same output as on 10.4.1 (given that the only changes between .p0 and .p1 had to do with building a by default unused library)

The fact that doctests for maxima have to be adjusted is a good thing. A bunch of those detect error conditions that are not errors in newer versions of maxima.

But in general, you'd expect dependent packages to be - you know - dependent :-).



---

archive/issue_comments_071147.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [@nbruin](#comment%3A31):\n> I don't think that is true. I think maxima-5.20.1.p0 will build an executable on ecl 10.4.1\n\nSorry, I take that back. That must have been before coffee. The point of \".p1\" was to fix library building and detect failure of it, but in the process needed an ecl upgrade (because 10.2.1 was a snapshot of the building system in flux), which required further patches to maxima (announced and supplied by Juanjo -- Maxima is part of the ECL test suite, so he knows when Maxima/ECL breaks)",
    "created_at": "2010-09-21T17:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71147",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:32'></a>
Replying to [@nbruin](#comment%3A31):
> I don't think that is true. I think maxima-5.20.1.p0 will build an executable on ecl 10.4.1

Sorry, I take that back. That must have been before coffee. The point of ".p1" was to fix library building and detect failure of it, but in the process needed an ecl upgrade (because 10.2.1 was a snapshot of the building system in flux), which required further patches to maxima (announced and supplied by Juanjo -- Maxima is part of the ECL test suite, so he knows when Maxima/ECL breaks)



---

archive/issue_comments_071148.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [@nbruin](#comment%3A31):\n> But in general, you'd expect dependent packages to be - you know - dependent :-).\n\nYes, but the current Sage build (and upgrade) process doesn't really reflect this... ;-)\n\n(We use `make`, but `sage-spkg` usually just reports a dependent package was already installed; our current scheme lacks version requirements almost completely.)\n\nFor the *rebuild dependent packages on upgrade* issue, there's #9896 (needs review; not limited to MacOS X). :)",
    "created_at": "2010-09-24T12:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71148",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:33'></a>
Replying to [@nbruin](#comment%3A31):
> But in general, you'd expect dependent packages to be - you know - dependent :-).

Yes, but the current Sage build (and upgrade) process doesn't really reflect this... ;-)

(We use `make`, but `sage-spkg` usually just reports a dependent package was already installed; our current scheme lacks version requirements almost completely.)

For the *rebuild dependent packages on upgrade* issue, there's #9896 (needs review; not limited to MacOS X). :)



---

archive/issue_comments_071149.json:
```json
{
    "body": "<a id='comment:34'></a>\n#9538 might depend on that ticket.\n\nPaul",
    "created_at": "2010-09-27T09:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71149",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:34'></a>
#9538 might depend on that ticket.

Paul



---

archive/issue_comments_071150.json:
```json
{
    "body": "<a id='comment:35'></a>\n#10187 should fix this.",
    "created_at": "2010-11-18T16:25:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71150",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:35'></a>
#10187 should fix this.



---

archive/issue_events_061645.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-01-19T21:09:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61645"
}
```



---

archive/issue_comments_071151.json:
```json
{
    "body": "<a id='comment:36'></a>\nTo release manager: #10187 was closed quite a while ago, and there it is confirmed that this should close this.  Thanks!",
    "created_at": "2011-01-19T21:09:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71151",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:36'></a>
To release manager: #10187 was closed quite a while ago, and there it is confirmed that this should close this.  Thanks!



---

archive/issue_comments_071152.json:
```json
{
    "body": "**Changing author** from \"Nils Bruin\" to \"\".",
    "created_at": "2011-01-19T22:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71152",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Nils Bruin" to "".



---

archive/issue_events_061646.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:11:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "008080",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61646"
}
```



---

archive/issue_comments_071153.json:
```json
{
    "body": "**Changing reviewer** from \"David Kirkby\" to \"Karl-Dieter Crisman\".",
    "created_at": "2011-01-19T22:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8645#issuecomment-71153",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "David Kirkby" to "Karl-Dieter Crisman".



---

archive/issue_events_061647.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:11:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61647"
}
```



---

archive/issue_events_061648.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:11:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61648"
}
```



---

archive/issue_events_061649.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:11:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8645",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8645#event-61649"
}
```
