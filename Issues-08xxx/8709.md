# Issue 8709: polyhedra level set doctest failure

archive/issues_008709.json:
```json
{
    "body": "On one platform (an itanium machine running red hat), I see this:\n\n```\nFile \"/home/palmieri/cleo/sage-4.4.alpha0/devel/sage/sage/geometry/polyhedra.py\", line 3147:\n    sage: for lset in polytopes.cross_polytope(2).face_lattice().level_sets(): print lset[0]\nExpected:\n    (None, (0, 1, 2, 3))\n    ((1,), (2, 3))\n    ((1, 2), (3,))\n    ((0, 1, 2, 3), None)\nGot:\n    (None, (0, 1, 2, 3))\n    ((0,), (1, 2))\n    ((1, 2), (3,))\n    ((0, 1, 2, 3), None)\n```\nThis is with Sage 4.4.alpha0, and it comes from the patch in ticket #8650.\n\n\nAssignee: mhampton\n\nCC:  mhampton @novoselt\n\nResolution: fixed\n\nAuthor: Marshall Hampton\n\nReviewer: Andrey Novoseltsev\n\nMerged: sage-4.4.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/8709\n\n",
    "closed_at": "2010-04-19T05:18:31Z",
    "created_at": "2010-04-18T03:07:19Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.4",
    "title": "polyhedra level set doctest failure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8709",
    "user": "https://github.com/jhpalmieri"
}
```
On one platform (an itanium machine running red hat), I see this:

```
File "/home/palmieri/cleo/sage-4.4.alpha0/devel/sage/sage/geometry/polyhedra.py", line 3147:
    sage: for lset in polytopes.cross_polytope(2).face_lattice().level_sets(): print lset[0]
Expected:
    (None, (0, 1, 2, 3))
    ((1,), (2, 3))
    ((1, 2), (3,))
    ((0, 1, 2, 3), None)
Got:
    (None, (0, 1, 2, 3))
    ((0,), (1, 2))
    ((1, 2), (3,))
    ((0, 1, 2, 3), None)
```
This is with Sage 4.4.alpha0, and it comes from the patch in ticket #8650.


Assignee: mhampton

CC:  mhampton @novoselt

Resolution: fixed

Author: Marshall Hampton

Reviewer: Andrey Novoseltsev

Merged: sage-4.4.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/8709





---

archive/issue_comments_079334.json:
```json
{
    "body": "apply instead of 8650 patch",
    "created_at": "2010-04-18T04:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79334",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

apply instead of 8650 patch



---

archive/issue_comments_079335.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [trac_8709.patch](tarball://root/attachments/some-uuid/ticket8709/trac_8709.patch) by @novoselt created at 2010-04-18 04:07:51\n\nIt looks like some sorting issue. I personally think that it would be nice to have some standard sorting of faces (and it is nice to have this sorting documented). \n\nLatticePolytope's sort faces of dimension 0 according to the generating vertices (so that the i-th 0-dimensional face is generated by the i-th vertex) and codimension 1 faces according to the containing facets (so that the i-th codimension-1 face is contained in the i-th facet). I think that these ways of sorting are very natural and it would be nice to have the same for Polyhedra with its V- and H-representations. For other faces there is probably no \"canonical\" choice, but it would be nice to have something fixed. (Middle dimensional faces of LatticePolytope's are sorted using one of the above ways, depending on working with an \"initial polytope\" or its polar - this is done to preserve polar duality of faces for reflexive polytopes.)",
    "created_at": "2010-04-18T04:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79335",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:1'></a>Attachment [trac_8709.patch](tarball://root/attachments/some-uuid/ticket8709/trac_8709.patch) by @novoselt created at 2010-04-18 04:07:51

It looks like some sorting issue. I personally think that it would be nice to have some standard sorting of faces (and it is nice to have this sorting documented). 

LatticePolytope's sort faces of dimension 0 according to the generating vertices (so that the i-th 0-dimensional face is generated by the i-th vertex) and codimension 1 faces according to the containing facets (so that the i-th codimension-1 face is contained in the i-th facet). I think that these ways of sorting are very natural and it would be nice to have the same for Polyhedra with its V- and H-representations. For other faces there is probably no "canonical" choice, but it would be nice to have something fixed. (Middle dimensional faces of LatticePolytope's are sorted using one of the above ways, depending on working with an "initial polytope" or its polar - this is done to preserve polar duality of faces for reflexive polytopes.)



---

archive/issue_comments_079336.json:
```json
{
    "body": "<a id='comment:2'></a>The attached patch avoids this sorting issue by only examining the extremes of the face lattice, which is where the problems from 8650 were.",
    "created_at": "2010-04-18T04:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79336",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:2'></a>The attached patch avoids this sorting issue by only examining the extremes of the face lattice, which is where the problems from 8650 were.



---

archive/issue_comments_079337.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-04-18T04:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79337",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_079338.json:
```json
{
    "body": "<a id='comment:3'></a>The code in the patch is the same as in #8650, therefore it passes all other doctests just as well as before. The sorting issue is not an issue anymore with the modified doctest for these changes. So positive review, but it still would be nice to add some sorting in the future, especially for dim=0 and codim=1 faces.",
    "created_at": "2010-04-18T04:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79338",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'></a>The code in the patch is the same as in #8650, therefore it passes all other doctests just as well as before. The sorting issue is not an issue anymore with the modified doctest for these changes. So positive review, but it still would be nice to add some sorting in the future, especially for dim=0 and codim=1 faces.



---

archive/issue_comments_079339.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-04-18T04:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79339",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_079340.json:
```json
{
    "body": "<a id='comment:4'></a>I'm confused: how is this possibly going to apply over the patch at #8650 (which has been merged into 4.4.alpha0)?",
    "created_at": "2010-04-18T04:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79340",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>I'm confused: how is this possibly going to apply over the patch at #8650 (which has been merged into 4.4.alpha0)?



---

archive/issue_comments_079341.json:
```json
{
    "body": "<a id='comment:5'></a>Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..",
    "created_at": "2010-04-18T04:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79341",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..



---

archive/issue_comments_079342.json:
```json
{
    "body": "Attachment [trac_8709_fix_sorting_issue_from_8650_on_itanium.patch](tarball://root/attachments/some-uuid/ticket8709/trac_8709_fix_sorting_issue_from_8650_on_itanium.patch) by @novoselt created at 2010-04-18 04:51:39\n\nApply only this one.",
    "created_at": "2010-04-18T04:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79342",
    "user": "https://github.com/novoselt"
}
```

Attachment [trac_8709_fix_sorting_issue_from_8650_on_itanium.patch](tarball://root/attachments/some-uuid/ticket8709/trac_8709_fix_sorting_issue_from_8650_on_itanium.patch) by @novoselt created at 2010-04-18 04:51:39

Apply only this one.



---

archive/issue_comments_079343.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 novoselt]:\n> Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..\n\n\nYes.",
    "created_at": "2010-04-18T05:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79343",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>Replying to [comment:5 novoselt]:
> Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..


Yes.



---

archive/issue_events_021143.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-19T05:18:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8709#event-21143"
}
```



---

archive/issue_comments_079344.json:
```json
{
    "body": "<a id='comment:7'></a>Merged \"trac_8709_fix_sorting_issue_from_8650_on_itanium.patch\" into 4.4.alpha1.",
    "created_at": "2010-04-19T05:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79344",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>Merged "trac_8709_fix_sorting_issue_from_8650_on_itanium.patch" into 4.4.alpha1.



---

archive/issue_comments_079345.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-04-19T05:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8709#issuecomment-79345",
    "user": "https://github.com/jhpalmieri"
}
```

Resolution: fixed
