# Issue 8709: polyhedra level set doctest failure

archive/issues_008709.json:
```json
{
    "assignees": [],
    "body": "On one platform (an itanium machine running red hat), I see this:\n\n```\nFile \"/home/palmieri/cleo/sage-4.4.alpha0/devel/sage/sage/geometry/polyhedra.py\", line 3147:\n    sage: for lset in polytopes.cross_polytope(2).face_lattice().level_sets(): print lset[0]\nExpected:\n    (None, (0, 1, 2, 3))\n    ((1,), (2, 3))\n    ((1, 2), (3,))\n    ((0, 1, 2, 3), None)\nGot:\n    (None, (0, 1, 2, 3))\n    ((0,), (1, 2))\n    ((1, 2), (3,))\n    ((0, 1, 2, 3), None)\n```\nThis is with Sage 4.4.alpha0, and it comes from the patch in ticket #8650.\n\n\nAssignee: **mhampton**\n\nCC:  mhampton @novoselt\n\nAuthor: **Marshall Hampton**\n\nReviewer: **Andrey Novoseltsev**\n\nMerged: **sage-4.4.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8709_\n\n",
    "closed_at": "2010-04-19T05:18:31Z",
    "created_at": "2010-04-18T03:07:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "polyhedra level set doctest failure",
    "type": "issue",
    "updated_at": "2010-04-19T05:18:31Z",
    "url": "https://github.com/sagemath/sage/issues/8709",
    "user": "https://github.com/jhpalmieri"
}
```
On one platform (an itanium machine running red hat), I see this:

```
File "/home/palmieri/cleo/sage-4.4.alpha0/devel/sage/sage/geometry/polyhedra.py", line 3147:
    sage: for lset in polytopes.cross_polytope(2).face_lattice().level_sets(): print lset[0]
Expected:
    (None, (0, 1, 2, 3))
    ((1,), (2, 3))
    ((1, 2), (3,))
    ((0, 1, 2, 3), None)
Got:
    (None, (0, 1, 2, 3))
    ((0,), (1, 2))
    ((1, 2), (3,))
    ((0, 1, 2, 3), None)
```
This is with Sage 4.4.alpha0, and it comes from the patch in ticket #8650.


Assignee: **mhampton**

CC:  mhampton @novoselt

Author: **Marshall Hampton**

Reviewer: **Andrey Novoseltsev**

Merged: **sage-4.4.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/8709_





---

archive/issue_events_100190.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-18T03:07:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "milestone_number": null,
    "milestone_title": "sage-4.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100190"
}
```



---

archive/issue_events_100191.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-18T03:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100191"
}
```



---

archive/issue_events_100192.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-18T03:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100192"
}
```



---

archive/issue_events_100193.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-18T03:07:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100193"
}
```



---

archive/issue_comments_072220.json:
```json
{
    "body": "apply instead of 8650 patch",
    "created_at": "2010-04-18T04:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72220",
    "user": "https://github.com/sagetrac-mhampton"
}
```

apply instead of 8650 patch



---

archive/issue_comments_072221.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nAttachment: **[trac_8709.patch.gz](https://github.com/sagemath/sage/files/ticket8709/trac_8709.patch.gz)**\n\nIt looks like some sorting issue. I personally think that it would be nice to have some standard sorting of faces (and it is nice to have this sorting documented). \n\nLatticePolytope's sort faces of dimension 0 according to the generating vertices (so that the i-th 0-dimensional face is generated by the i-th vertex) and codimension 1 faces according to the containing facets (so that the i-th codimension-1 face is contained in the i-th facet). I think that these ways of sorting are very natural and it would be nice to have the same for Polyhedra with its V- and H-representations. For other faces there is probably no \"canonical\" choice, but it would be nice to have something fixed. (Middle dimensional faces of LatticePolytope's are sorted using one of the above ways, depending on working with an \"initial polytope\" or its polar - this is done to preserve polar duality of faces for reflexive polytopes.)",
    "created_at": "2010-04-18T04:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72221",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:1'>Comment 1:</a>
Attachment: **[trac_8709.patch.gz](https://github.com/sagemath/sage/files/ticket8709/trac_8709.patch.gz)**

It looks like some sorting issue. I personally think that it would be nice to have some standard sorting of faces (and it is nice to have this sorting documented). 

LatticePolytope's sort faces of dimension 0 according to the generating vertices (so that the i-th 0-dimensional face is generated by the i-th vertex) and codimension 1 faces according to the containing facets (so that the i-th codimension-1 face is contained in the i-th facet). I think that these ways of sorting are very natural and it would be nice to have the same for Polyhedra with its V- and H-representations. For other faces there is probably no "canonical" choice, but it would be nice to have something fixed. (Middle dimensional faces of LatticePolytope's are sorted using one of the above ways, depending on working with an "initial polytope" or its polar - this is done to preserve polar duality of faces for reflexive polytopes.)



---

archive/issue_comments_072222.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThe attached patch avoids this sorting issue by only examining the extremes of the face lattice, which is where the problems from 8650 were.",
    "created_at": "2010-04-18T04:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72222",
    "user": "https://github.com/sagetrac-mhampton"
}
```

<a id='comment:2'>Comment 2:</a>
The attached patch avoids this sorting issue by only examining the extremes of the face lattice, which is where the problems from 8650 were.



---

archive/issue_events_100194.json:
```json
{
    "actor": "https://github.com/sagetrac-mhampton",
    "created_at": "2010-04-18T04:09:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100194"
}
```



---

archive/issue_comments_072223.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nThe code in the patch is the same as in #8650, therefore it passes all other doctests just as well as before. The sorting issue is not an issue anymore with the modified doctest for these changes. So positive review, but it still would be nice to add some sorting in the future, especially for dim=0 and codim=1 faces.",
    "created_at": "2010-04-18T04:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72223",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'>Comment 3:</a>
The code in the patch is the same as in #8650, therefore it passes all other doctests just as well as before. The sorting issue is not an issue anymore with the modified doctest for these changes. So positive review, but it still would be nice to add some sorting in the future, especially for dim=0 and codim=1 faces.



---

archive/issue_comments_072224.json:
```json
{
    "body": "Reviewer: **Andrey Novoseltsev**",
    "created_at": "2010-04-18T04:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72224",
    "user": "https://github.com/novoselt"
}
```

Reviewer: **Andrey Novoseltsev**



---

archive/issue_comments_072225.json:
```json
{
    "body": "Author: **Marshall Hampton**",
    "created_at": "2010-04-18T04:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72225",
    "user": "https://github.com/novoselt"
}
```

Author: **Marshall Hampton**



---

archive/issue_events_100195.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-04-18T04:19:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100195"
}
```



---

archive/issue_events_100196.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-04-18T04:19:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100196"
}
```



---

archive/issue_comments_072226.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI'm confused: how is this possibly going to apply over the patch at #8650 (which has been merged into 4.4.alpha0)?",
    "created_at": "2010-04-18T04:32:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72226",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'>Comment 4:</a>
I'm confused: how is this possibly going to apply over the patch at #8650 (which has been merged into 4.4.alpha0)?



---

archive/issue_comments_072227.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nOops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..",
    "created_at": "2010-04-18T04:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72227",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'>Comment 5:</a>
Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..



---

archive/issue_comments_072228.json:
```json
{
    "body": "Attachment: **[trac_8709_fix_sorting_issue_from_8650_on_itanium.patch.gz](https://github.com/sagemath/sage/files/ticket8709/trac_8709_fix_sorting_issue_from_8650_on_itanium.patch.gz)**\n\nApply only this one.",
    "created_at": "2010-04-18T04:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72228",
    "user": "https://github.com/novoselt"
}
```

Attachment: **[trac_8709_fix_sorting_issue_from_8650_on_itanium.patch.gz](https://github.com/sagemath/sage/files/ticket8709/trac_8709_fix_sorting_issue_from_8650_on_itanium.patch.gz)**

Apply only this one.



---

archive/issue_comments_072229.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@novoselt](#comment%3A5):\n> Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..\n\nYes.",
    "created_at": "2010-04-18T05:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72229",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@novoselt](#comment%3A5):
> Oops, good point. I am attaching a new patch that just replaces the doctest. Can I still leave it at positive review?..

Yes.



---

archive/issue_events_100197.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-19T05:18:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100197"
}
```



---

archive/issue_events_100198.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-19T05:18:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8709#event-100198"
}
```



---

archive/issue_comments_072230.json:
```json
{
    "body": "Merged: **sage-4.4.alpha1**",
    "created_at": "2010-04-19T05:18:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72230",
    "user": "https://github.com/jhpalmieri"
}
```

Merged: **sage-4.4.alpha1**



---

archive/issue_comments_072231.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nMerged \"trac_8709_fix_sorting_issue_from_8650_on_itanium.patch\" into 4.4.alpha1.",
    "created_at": "2010-04-19T05:18:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8709#issuecomment-72231",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'>Comment 7:</a>
Merged "trac_8709_fix_sorting_issue_from_8650_on_itanium.patch" into 4.4.alpha1.
