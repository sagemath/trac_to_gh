# Issue 8420: new feature : class of perfect matching

archive/issues_008420.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "I am working on implementing the enumerated set of perfect matchings of a ground set (with, in particular, an iterator), a class of matching and simple methods.\n\nI wrote code about this for my own research and thought it could be useful for other people.\n\nKeywords: **perfect matching**\n\nReviewer: **Florent Hivert**\n\nAuthor: **Valentin F\u00e9ray**\n\nMerged: **sage-4.4.alpha0**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8420_\n\n",
    "closed_at": "2010-04-15T23:49:50Z",
    "created_at": "2010-03-02T14:12:00Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "new feature : class of perfect matching",
    "type": "issue",
    "updated_at": "2017-07-19T08:25:40Z",
    "url": "https://github.com/sagemath/sage/issues/8420",
    "user": "https://github.com/sagetrac-vferay"
}
```
I am working on implementing the enumerated set of perfect matchings of a ground set (with, in particular, an iterator), a class of matching and simple methods.

I wrote code about this for my own research and thought it could be useful for other people.

Keywords: **perfect matching**

Reviewer: **Florent Hivert**

Author: **Valentin Féray**

Merged: **sage-4.4.alpha0**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/8420_





---

archive/issue_events_104446.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-02T14:12:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104446"
}
```



---

archive/issue_events_104447.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-02T14:12:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104447"
}
```



---

archive/issue_events_104448.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-02T14:12:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104448"
}
```



---

archive/issue_events_104449.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2010-03-02T14:12:00Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "subject": "https://github.com/sagetrac-vferay",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104449"
}
```



---

archive/issue_comments_066511.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nExceeeeeeeeellent Idea :-)\n\nNathann",
    "created_at": "2010-03-02T15:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66511",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:1" align="right">comment:1</div>

Exceeeeeeeeellent Idea :-)

Nathann



---

archive/issue_comments_066512.json:
```json
{
    "body": "Reviewer: **hivert**",
    "created_at": "2010-03-05T16:40:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66512",
    "user": "https://github.com/sagetrac-vferay"
}
```

Reviewer: **hivert**



---

archive/issue_events_104450.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-05T16:40:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104450"
}
```



---

archive/issue_events_104451.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-05T17:04:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104451"
}
```



---

archive/issue_events_104452.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-05T17:04:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104452"
}
```



---

archive/issue_comments_066513.json:
```json
{
    "body": "Changed reviewer from **hivert** to **Florent Hivert**",
    "created_at": "2010-03-05T17:04:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66513",
    "user": "https://github.com/hivert"
}
```

Changed reviewer from **hivert** to **Florent Hivert**



---

archive/issue_comments_066514.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@sagetrac-vferay](#comment:2):\nHi Valentin,\n\nI started to review your patch. Here is a comment:\n\nWhen you construct a new class of parent or elements, you should add a call to the standard tests suite. Namely, inside each `__init__` method, you should build a representative object say `Obj` of the class and add\n\n```\nsage: TestSuite(Obj).run()\n```\nThe result should be nothing. If you get something then the error message is supposed to explain the problem.\n\nCheers,\n\nFlorent",
    "created_at": "2010-03-05T17:04:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66514",
    "user": "https://github.com/hivert"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@sagetrac-vferay](#comment:2):
Hi Valentin,

I started to review your patch. Here is a comment:

When you construct a new class of parent or elements, you should add a call to the standard tests suite. Namely, inside each `__init__` method, you should build a representative object say `Obj` of the class and add

```
sage: TestSuite(Obj).run()
```
The result should be nothing. If you get something then the error message is supposed to explain the problem.

Cheers,

Florent



---

archive/issue_comments_066515.json:
```json
{
    "body": "Attachment: **[trac_8420_features_perfect_matchings_vf.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_vf.patch.gz)**",
    "created_at": "2010-03-08T09:00:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66515",
    "user": "https://github.com/sagetrac-vferay"
}
```

Attachment: **[trac_8420_features_perfect_matchings_vf.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_vf.patch.gz)**



---

archive/issue_comments_066516.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHi Florent,\n\nI added the test you suggested inside the `__classcall__` method and it passed.\n\nCheers,\nValentin",
    "created_at": "2010-03-08T09:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66516",
    "user": "https://github.com/sagetrac-vferay"
}
```

<div id="comment:4" align="right">comment:4</div>

Hi Florent,

I added the test you suggested inside the `__classcall__` method and it passed.

Cheers,
Valentin



---

archive/issue_events_104453.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-08T09:01:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104453"
}
```



---

archive/issue_events_104454.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-08T09:01:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104454"
}
```



---

archive/issue_events_104455.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-08T09:01:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "title_is": "new feature : class of perfect matching",
    "title_was": "[work in progress] new feature : class of perfect matching",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104455"
}
```



---

archive/issue_comments_066517.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHi Valentin,\n\nI've got a some comments about your code ;-). I've already taken care of most of them. For the other I need you. I've uploaded here the patch with all my modifications and put it also in the Sage-Combinat queue. You should formally review this patch, and then either fold it in yours (using in the queue\n\n```\nsage -hg qgoto your_patch\nsage -hg qfold my_patch\nsage -b\n```\n) add your new modification or add the new modification in a new patch after mine. Please ask me if you have some trouble with that.\n\n## Problems already taken care of\n\nPlease review the patch to see if you agree with all those.\n\n- (done) You should put a title to the file and insert it in the doc `doc/en/reference/combinat/index.rst`\n- (done) You should put the imports at the beginning of the file, unless you have a good reason not to do so (eg:loop in import).\n- (done) You should avoid too lines in comment, code and documentation. Please break them at 80 columns.\n- (done) Every single function must be tested.\n- (done, must be reread) <code>\\`...\\`</code> is for math, <code>\\`\\`...\\`\\`</code> is for code.\n- (done) You can add cross references to other method with <code>:meth:\\`name_of_the_method\\`</code>\n- (done) I don't like the way your wrote three time (or probably copy-paste) the code for computing crossing/number_of_crossing/is_non_crossing. A good way it to write an iterator. An even better way is to write yet a new `EnumeratedSet` for the crossing.\n\n## Work still to be done\n\n- Just after the title, you should define mathematically in one or two lines what is a perfect matching and add some references\n- You should also then add yourself as the author of the file (please see the [coding conventions](http://www.sagemath.org/doc/developer/conventions.html) and in particular the [heading section](http://www.sagemath.org/doc/developer/conventions.html#headings-of-sage-library-code-files) of the developper guide). \n\n- in method `loop_type`, It would probably be useful to expose a method called `loops` since you compute it inside. I can imagine it could be of use for some problems. Then of course you should use it in `loop_type`.\n\n- I don't like the following behavior. Is there any good reason for it:\n\n```\n The class constructor does not check that the perfect matching is correct,\n one has to use the method :meth:`__contains__` for that::\n\n            sage: m=PerfectMatching([(1,2,3),(4,5)])\n            sage: isinstance(m,PerfectMatching)\n            True\n            sage: m in m.parent()\n            False\n```\n\n- Could you add some reference about perfect-matching and Weingarten_matrix\n\n- Could you finally add some more tests and in particular corner cases (empty or odd size sets).\n\n## Final Comments\n\nSorry for this frightening review. Despite of the bunch of remarks, the code is good ! I'd just rather it to match perfectly with sage standard ;-)\n\nFlorent",
    "created_at": "2010-03-08T10:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66517",
    "user": "https://github.com/hivert"
}
```

<div id="comment:6" align="right">comment:6</div>

Hi Valentin,

I've got a some comments about your code ;-). I've already taken care of most of them. For the other I need you. I've uploaded here the patch with all my modifications and put it also in the Sage-Combinat queue. You should formally review this patch, and then either fold it in yours (using in the queue

```
sage -hg qgoto your_patch
sage -hg qfold my_patch
sage -b
```
) add your new modification or add the new modification in a new patch after mine. Please ask me if you have some trouble with that.

## Problems already taken care of

Please review the patch to see if you agree with all those.

- (done) You should put a title to the file and insert it in the doc `doc/en/reference/combinat/index.rst`
- (done) You should put the imports at the beginning of the file, unless you have a good reason not to do so (eg:loop in import).
- (done) You should avoid too lines in comment, code and documentation. Please break them at 80 columns.
- (done) Every single function must be tested.
- (done, must be reread) <code>\`...\`</code> is for math, <code>\`\`...\`\`</code> is for code.
- (done) You can add cross references to other method with <code>:meth:\`name_of_the_method\`</code>
- (done) I don't like the way your wrote three time (or probably copy-paste) the code for computing crossing/number_of_crossing/is_non_crossing. A good way it to write an iterator. An even better way is to write yet a new `EnumeratedSet` for the crossing.

## Work still to be done

- Just after the title, you should define mathematically in one or two lines what is a perfect matching and add some references
- You should also then add yourself as the author of the file (please see the [coding conventions](http://www.sagemath.org/doc/developer/conventions.html) and in particular the [heading section](http://www.sagemath.org/doc/developer/conventions.html#headings-of-sage-library-code-files) of the developper guide). 

- in method `loop_type`, It would probably be useful to expose a method called `loops` since you compute it inside. I can imagine it could be of use for some problems. Then of course you should use it in `loop_type`.

- I don't like the following behavior. Is there any good reason for it:

```
 The class constructor does not check that the perfect matching is correct,
 one has to use the method :meth:`__contains__` for that::

            sage: m=PerfectMatching([(1,2,3),(4,5)])
            sage: isinstance(m,PerfectMatching)
            True
            sage: m in m.parent()
            False
```

- Could you add some reference about perfect-matching and Weingarten_matrix

- Could you finally add some more tests and in particular corner cases (empty or odd size sets).

## Final Comments

Sorry for this frightening review. Despite of the bunch of remarks, the code is good ! I'd just rather it to match perfectly with sage standard ;-)

Florent



---

archive/issue_events_104456.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-08T10:53:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104456"
}
```



---

archive/issue_events_104457.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-08T10:53:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104457"
}
```



---

archive/issue_comments_066518.json:
```json
{
    "body": "Review patch.",
    "created_at": "2010-03-08T10:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66518",
    "user": "https://github.com/hivert"
}
```

Review patch.



---

archive/issue_comments_066519.json:
```json
{
    "body": "Attachment: **[trac_8420-perfect_matchings_review-fh.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420-perfect_matchings_review-fh.patch.gz)**\n\nAttachment: **[trac_8420_features_perfect_matchings_vf.2.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_vf.2.patch.gz)**\n\n2nd version, after Florent's comments",
    "created_at": "2010-03-10T10:32:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66519",
    "user": "https://github.com/sagetrac-vferay"
}
```

Attachment: **[trac_8420-perfect_matchings_review-fh.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420-perfect_matchings_review-fh.patch.gz)**

Attachment: **[trac_8420_features_perfect_matchings_vf.2.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_vf.2.patch.gz)**

2nd version, after Florent's comments



---

archive/issue_comments_066520.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHi Florent,\n\n   thanks a lot for this deep review of my patch and don't apologize for the quantity of remarks, it's a very good thing for me to learn. Moreover, you had done already a big part of the needed corrections, so thanks for that also. I have done the remaining corrections and I think the patch is ready for a new review.\n\nBest,\nValentin\n\nMore specific comments:\n\n- concerning the imports (on the beginning of the file or of the function), Nicolas (Thiery) told me to try to put the high-level imports (so, in my case, I think it would be Partition, Permutation, Matrix) at the beginning of the functions to prevent apparition of loops...\n\n- I did the change you requested:\n* I created a loops_iterator and a function which gives the list of the loops.\n* The correctness of the data given to create a perfect matching is checked when the syntax PerfectMatching(...) is used.\n\n- I also added some new methods:\n* nestings_iterator and related function: the code is very similar to the one of crossings_iterator and I saw in literature that this notion appears often.\n* coset-type for permutations, which was one of the thing I was interested in.",
    "created_at": "2010-03-10T10:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66520",
    "user": "https://github.com/sagetrac-vferay"
}
```

<div id="comment:7" align="right">comment:7</div>

Hi Florent,

   thanks a lot for this deep review of my patch and don't apologize for the quantity of remarks, it's a very good thing for me to learn. Moreover, you had done already a big part of the needed corrections, so thanks for that also. I have done the remaining corrections and I think the patch is ready for a new review.

Best,
Valentin

More specific comments:

- concerning the imports (on the beginning of the file or of the function), Nicolas (Thiery) told me to try to put the high-level imports (so, in my case, I think it would be Partition, Permutation, Matrix) at the beginning of the functions to prevent apparition of loops...

- I did the change you requested:
* I created a loops_iterator and a function which gives the list of the loops.
* The correctness of the data given to create a perfect matching is checked when the syntax PerfectMatching(...) is used.

- I also added some new methods:
* nestings_iterator and related function: the code is very similar to the one of crossings_iterator and I saw in literature that this notion appears often.
* coset-type for permutations, which was one of the thing I was interested in.



---

archive/issue_events_104458.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-10T10:51:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104458"
}
```



---

archive/issue_events_104459.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-10T10:51:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104459"
}
```



---

archive/issue_comments_066521.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@sagetrac-vferay](#comment:7):\n\n> * coset-type for permutations, which was one of the thing I was interested in.\n\nI don't like the name coset-type ! It applies to too many different things (eg: coset by young subgroups...)\n\nWhat about: `hyperoctahedral_double_coset_type` ?",
    "created_at": "2010-03-15T15:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66521",
    "user": "https://github.com/hivert"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@sagetrac-vferay](#comment:7):

> * coset-type for permutations, which was one of the thing I was interested in.

I don't like the name coset-type ! It applies to too many different things (eg: coset by young subgroups...)

What about: `hyperoctahedral_double_coset_type` ?



---

archive/issue_comments_066522.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHi Valentin !\n\nI just uploaded a review patch. It purpose is:\n- fix some doc issues (references, indentation, ...).\n- remove the methods `__init__` in `PerfectMatching` since it was properly inherited;\n- add a few doctests;\n- change the name of `coset_type` to `hyperoctahedral_double_coset_type`. \n \nI need you (or anyone else) to review this patch and tell me if the change of name suits to you. If it does and if my patch is correct, you can set positive review to this ticket. Your patch is fine for me.\n\nSome tip for the doc:\n- inside single back quote <code>\\`...\\`</code> you put things in LaTeX format. so beware of \"{\" and \"}\" vanishing...\n\n- in a bullet list you should indent the lines after the bullet:\n\n   ```\n   - plenty of text; plenty of text; plenty of text; \n     plenty of text; plenty of text;\n     plenty of text;\n   - More text\n  ```\n  and not\n\n   ```\n   - plenty of text; plenty of text; plenty of text;\n   plenty of text; plenty of text;\n   plenty of text;\n   - More text\n  ```",
    "created_at": "2010-03-15T16:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66522",
    "user": "https://github.com/hivert"
}
```

<div id="comment:9" align="right">comment:9</div>

Hi Valentin !

I just uploaded a review patch. It purpose is:
- fix some doc issues (references, indentation, ...).
- remove the methods `__init__` in `PerfectMatching` since it was properly inherited;
- add a few doctests;
- change the name of `coset_type` to `hyperoctahedral_double_coset_type`. 
 
I need you (or anyone else) to review this patch and tell me if the change of name suits to you. If it does and if my patch is correct, you can set positive review to this ticket. Your patch is fine for me.

Some tip for the doc:
- inside single back quote <code>\`...\`</code> you put things in LaTeX format. so beware of "{" and "}" vanishing...

- in a bullet list you should indent the lines after the bullet:

   ```
   - plenty of text; plenty of text; plenty of text; 
     plenty of text; plenty of text;
     plenty of text;
   - More text
  ```
  and not

   ```
   - plenty of text; plenty of text; plenty of text;
   plenty of text; plenty of text;
   plenty of text;
   - More text
  ```



---

archive/issue_comments_066523.json:
```json
{
    "body": "Attachment: **[trac_8420_perfect_matchings_review-fh.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_perfect_matchings_review-fh.patch.gz)**",
    "created_at": "2010-03-15T16:08:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66523",
    "user": "https://github.com/hivert"
}
```

Attachment: **[trac_8420_perfect_matchings_review-fh.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_perfect_matchings_review-fh.patch.gz)**



---

archive/issue_comments_066524.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nHi Florent!\n\nThanks for this new review. The patch seems ready, except for two small things:\n\n- line 144 of the file perfect_matching.py, it is written in the doc\n  `PerfectMatchings(objects)(data)`. \nShould it not be\n ``PerfectMatchings(objects)(data)``.\nas this is sage code?\n\n- second: the function now called\nhyperoctahedral_double_coset_type\n(which name is fine like this by the way)\ndoes not return a PerfectMatching as you suggest in the doc,\nbut a partition.\n\nAs I am learning, I would like to know what is the best way to deal with very small changes like that:\n- to do a new review patch as in the case of big changes?\n- to let you do these changes and switch to positive review?\n- to do the changes myself and switch to positive review? (but I believe this is not a good idea as I am not supposed to write in your patch)\n\nAnother thing that I did not know how to do was the following:\nI remember that you said something about compiling the documentation to check that it is well written. How does it work?\n\nYours,\nValentin",
    "created_at": "2010-03-16T17:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66524",
    "user": "https://github.com/sagetrac-vferay"
}
```

<div id="comment:10" align="right">comment:10</div>

Hi Florent!

Thanks for this new review. The patch seems ready, except for two small things:

- line 144 of the file perfect_matching.py, it is written in the doc
  `PerfectMatchings(objects)(data)`. 
Should it not be
 ``PerfectMatchings(objects)(data)``.
as this is sage code?

- second: the function now called
hyperoctahedral_double_coset_type
(which name is fine like this by the way)
does not return a PerfectMatching as you suggest in the doc,
but a partition.

As I am learning, I would like to know what is the best way to deal with very small changes like that:
- to do a new review patch as in the case of big changes?
- to let you do these changes and switch to positive review?
- to do the changes myself and switch to positive review? (but I believe this is not a good idea as I am not supposed to write in your patch)

Another thing that I did not know how to do was the following:
I remember that you said something about compiling the documentation to check that it is well written. How does it work?

Yours,
Valentin



---

archive/issue_comments_066525.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHi Valentin,\n\nFirst of all, please have a look at http://trac.sagemath.org/sage_trac/wiki/WikiFormatting\nso that your message appear nicely in trac (sorry yet another stupid syntax to learn)...\n\n> Thanks for this new review. The patch seems ready, except for two small things:\n> \n> - line 144 of the file perfect_matching.py, it is written in the doc\n\n<code>\\`PerfectMatchings(objects)(data)\\`.</code> \n> Should it not be\n\n<code>\\`\\`PerfectMatchings(objects)(data)\\`\\`</code>\n> as this is sage code?\n\nYou are perfectly right ! Thanks for spotting this little mistake. \n\n> - second: the function now called\n> hyperoctahedral_double_coset_type\n> (which name is fine like this by the way)\n> does not return a PerfectMatching as you suggest in the doc,\n> but a partition.\n\nAgain right... \n\n> As I am learning, I would like to know what is the best way to deal with very small changes like that:\n> - to do a new review patch as in the case of big changes?\n\nUsually when you spot those kind a little mistakes, it takes as long as explaining them in trac than fixing them directly in the file. So the fastest and time saving way (for the sage community in general, maybe not for you) is to write yet another tiny review patch and put in on trac. If the change is bigger or more involved, you can ask the author to do it. That's when you check the need work button. \n\nIn the present case, since I understood it wrong, can you give a little explanation of this coset stuff and correct it as a being a partition. If it's too complicated explaining it, keeping only the ref to Macdonald (as it is now) can be sufficient. Also, since I spend times explaining this to you, It's your turn to make the change (sorry that I found a reason for being lazy ;-). \n\nThen the usual way is to submit yet another review of review patch and ask for a review of the review of the review patch ;-) Looks like a joke but this is not. \n\n> - to let you do these changes and switch to positive review?\n\nIt's forbidden by rule 2 below. If I change my patch, you have to review it again.  \n\n> - to do the changes myself and switch to positive review? (but I believe this is not a good idea as I am not supposed to write in your patch)\n\nAgain forbidden by both rule 1 and 2 below. \n\nTwo strict rules:\n 1 - in the path queue of sage-combinat, it's forbidden to write on someone's else patch, except if explicitely authorized (unless you're fond of editing second derivative of a file)... In some very rare occasion, we broke this rule with Nicolas but you really have to know what you are doing... A much better way is to write a new patch and either to submit it to trac or to ask the owner to fold it.\n \n 2 - No code (or doc or anything) can go into Sage, unless it has been reviewed by someone different from its author. Even a trivial typo correction. As far as I know since a few year, this rule has never been broken.\n  \nAlso it's easier for the different review to keep the consecutive changes in different patches. An the end, for the release manager, you have to indicate which patch has to be applied in which order. If you want to be kind with him. after deciding to put the positive review, you can fold the whole bunch of patch in a single one (useful when the review has been particularily messy). \n\n\n> Another thing that I did not know how to do was the following:\n> I remember that you said something about compiling the documentation to check that it is well written. How does it work?\n\nI must suggest you to read the [Developer's Guide](http://www.sagemath.org/doc/developer/index.html) in particular the section reviewing a patch (the command about applying the patch don't strictly apply to our case since we are using the queue).\nThe answer of you question is found in point 4:\n\n```\n./sage -docbuild reference html\n```\ncould take some time. \n\nCheers,\n\nFlorent",
    "created_at": "2010-03-18T23:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66525",
    "user": "https://github.com/hivert"
}
```

<div id="comment:11" align="right">comment:11</div>

Hi Valentin,

First of all, please have a look at http://trac.sagemath.org/sage_trac/wiki/WikiFormatting
so that your message appear nicely in trac (sorry yet another stupid syntax to learn)...

> Thanks for this new review. The patch seems ready, except for two small things:
> 
> - line 144 of the file perfect_matching.py, it is written in the doc

<code>\`PerfectMatchings(objects)(data)\`.</code> 
> Should it not be

<code>\`\`PerfectMatchings(objects)(data)\`\`</code>
> as this is sage code?

You are perfectly right ! Thanks for spotting this little mistake. 

> - second: the function now called
> hyperoctahedral_double_coset_type
> (which name is fine like this by the way)
> does not return a PerfectMatching as you suggest in the doc,
> but a partition.

Again right... 

> As I am learning, I would like to know what is the best way to deal with very small changes like that:
> - to do a new review patch as in the case of big changes?

Usually when you spot those kind a little mistakes, it takes as long as explaining them in trac than fixing them directly in the file. So the fastest and time saving way (for the sage community in general, maybe not for you) is to write yet another tiny review patch and put in on trac. If the change is bigger or more involved, you can ask the author to do it. That's when you check the need work button. 

In the present case, since I understood it wrong, can you give a little explanation of this coset stuff and correct it as a being a partition. If it's too complicated explaining it, keeping only the ref to Macdonald (as it is now) can be sufficient. Also, since I spend times explaining this to you, It's your turn to make the change (sorry that I found a reason for being lazy ;-). 

Then the usual way is to submit yet another review of review patch and ask for a review of the review of the review patch ;-) Looks like a joke but this is not. 

> - to let you do these changes and switch to positive review?

It's forbidden by rule 2 below. If I change my patch, you have to review it again.  

> - to do the changes myself and switch to positive review? (but I believe this is not a good idea as I am not supposed to write in your patch)

Again forbidden by both rule 1 and 2 below. 

Two strict rules:
 1 - in the path queue of sage-combinat, it's forbidden to write on someone's else patch, except if explicitely authorized (unless you're fond of editing second derivative of a file)... In some very rare occasion, we broke this rule with Nicolas but you really have to know what you are doing... A much better way is to write a new patch and either to submit it to trac or to ask the owner to fold it.
 
 2 - No code (or doc or anything) can go into Sage, unless it has been reviewed by someone different from its author. Even a trivial typo correction. As far as I know since a few year, this rule has never been broken.
  
Also it's easier for the different review to keep the consecutive changes in different patches. An the end, for the release manager, you have to indicate which patch has to be applied in which order. If you want to be kind with him. after deciding to put the positive review, you can fold the whole bunch of patch in a single one (useful when the review has been particularily messy). 


> Another thing that I did not know how to do was the following:
> I remember that you said something about compiling the documentation to check that it is well written. How does it work?

I must suggest you to read the [Developer's Guide](http://www.sagemath.org/doc/developer/index.html) in particular the section reviewing a patch (the command about applying the patch don't strictly apply to our case since we are using the queue).
The answer of you question is found in point 4:

```
./sage -docbuild reference html
```
could take some time. 

Cheers,

Florent



---

archive/issue_comments_066526.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHi Florent,\n\n\n> Also, since I spend times explaining this to you, It's your turn to make the change\n\nA new review patch is in the queue right after your review patch.\n\n**Thanks** for taking the time to explain me all these staffs. I should have read more the documentation, but I am a little lost in this jungle (and also a little lazy perhaps).\n\nBest,\n\nValentin",
    "created_at": "2010-03-19T17:35:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66526",
    "user": "https://github.com/sagetrac-vferay"
}
```

<div id="comment:12" align="right">comment:12</div>

Hi Florent,


> Also, since I spend times explaining this to you, It's your turn to make the change

A new review patch is in the queue right after your review patch.

**Thanks** for taking the time to explain me all these staffs. I should have read more the documentation, but I am a little lost in this jungle (and also a little lazy perhaps).

Best,

Valentin



---

archive/issue_events_104460.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-21T22:07:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104460"
}
```



---

archive/issue_events_104461.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-21T22:07:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104461"
}
```



---

archive/issue_comments_066527.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHi Valentin,\n\n> **Thanks** for taking the time to explain me all these staffs. I should have read more the documentation, but I am a little lost in this jungle (and also a little lazy perhaps).\n\n:-)\n\nThere is a little mistake which was pointed out by Samuele in #8548. Can you fold his patch in yours, add a test for the error and reupload ?",
    "created_at": "2010-03-21T22:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66527",
    "user": "https://github.com/hivert"
}
```

<div id="comment:13" align="right">comment:13</div>

Hi Valentin,

> **Thanks** for taking the time to explain me all these staffs. I should have read more the documentation, but I am a little lost in this jungle (and also a little lazy perhaps).

:-)

There is a little mistake which was pointed out by Samuele in #8548. Can you fold his patch in yours, add a test for the error and reupload ?



---

archive/issue_events_104462.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-22T09:58:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104462"
}
```



---

archive/issue_events_104463.json:
```json
{
    "actor": "https://github.com/sagetrac-vferay",
    "created_at": "2010-03-22T09:58:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104463"
}
```



---

archive/issue_comments_066528.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAttachment: **[trac_8420_features_perfect_matchings_review_review_vf.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_review_review_vf.patch.gz)**",
    "created_at": "2010-03-22T09:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66528",
    "user": "https://github.com/sagetrac-vferay"
}
```

<div id="comment:14" align="right">comment:14</div>

Attachment: **[trac_8420_features_perfect_matchings_review_review_vf.patch.gz](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_review_review_vf.patch.gz)**



---

archive/issue_comments_066529.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nEverything seems ok. Positive review.\n\nFlorent\n\nPS: for the release manager:\nI applied the following patches in the this order:\n\n- [trac_8420_features_perfect_matchings_vf.2.patch](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_vf.2.patch.gz) \n- [trac_8420_perfect_matchings_review-fh.patch](https://github.com/sagemath/sage/files/ticket8420/trac_8420_perfect_matchings_review-fh.patch.gz)\n- [trac_8420_features_perfect_matchings_review_review_vf.patch](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_review_review_vf.patch.gz)",
    "created_at": "2010-03-22T14:26:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66529",
    "user": "https://github.com/hivert"
}
```

<div id="comment:15" align="right">comment:15</div>

Everything seems ok. Positive review.

Florent

PS: for the release manager:
I applied the following patches in the this order:

- [trac_8420_features_perfect_matchings_vf.2.patch](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_vf.2.patch.gz) 
- [trac_8420_perfect_matchings_review-fh.patch](https://github.com/sagemath/sage/files/ticket8420/trac_8420_perfect_matchings_review-fh.patch.gz)
- [trac_8420_features_perfect_matchings_review_review_vf.patch](https://github.com/sagemath/sage/files/ticket8420/trac_8420_features_perfect_matchings_review_review_vf.patch.gz)



---

archive/issue_events_104464.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-22T14:26:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104464"
}
```



---

archive/issue_events_104465.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-03-22T14:26:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104465"
}
```



---

archive/issue_events_104466.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-15T23:49:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104466"
}
```



---

archive/issue_events_104467.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-15T23:49:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104467"
}
```



---

archive/issue_comments_066530.json:
```json
{
    "body": "Merged: **sage-4.4.alpha0**",
    "created_at": "2010-04-15T23:49:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66530",
    "user": "https://github.com/jhpalmieri"
}
```

Merged: **sage-4.4.alpha0**



---

archive/issue_comments_066531.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nMerged into 4.4.alpha0:\n- trac_8420_features_perfect_matchings_vf.2.patch\n- trac_8420_perfect_matchings_review-fh.patch\n- trac_8420_features_perfect_matchings_review_review_vf.patch",
    "created_at": "2010-04-15T23:49:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66531",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

Merged into 4.4.alpha0:
- trac_8420_features_perfect_matchings_vf.2.patch
- trac_8420_perfect_matchings_review-fh.patch
- trac_8420_features_perfect_matchings_review_review_vf.patch



---

archive/issue_events_104468.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-15T23:49:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "milestone_number": null,
    "milestone_title": "sage-4.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8420#event-104468"
}
```



---

archive/issue_comments_066532.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nname with accent",
    "created_at": "2017-07-19T08:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66532",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:18" align="right">comment:18</div>

name with accent



---

archive/issue_comments_066533.json:
```json
{
    "body": "Changed author from **Valentin Feray** to **Valentin F\u00e9ray**",
    "created_at": "2017-07-19T08:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8420",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8420#issuecomment-66533",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Valentin Feray** to **Valentin Féray**
