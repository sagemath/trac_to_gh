# Issue 8679: conventions for spkg names, rewriting sage-spkg

archive/issues_008679.json:
```json
{
    "body": "Some scripts in SAGE_ROOT/local/bin expect spkg names to have the form \n\n```\nmy_package-2.3.spkg\n```\nbut not \n\n```\nmy-package-2.3.spkg   (first hyphen is bad)\n```\nSee [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8597ce93b420afe4) for some discussion.\n\nThe attached patches do three things:\n\n- Rewrite sage-pkg (in python instead of bash) to test whether the name has the right form.\n- Remove sage-pkg-nocompress, using sage-pkg instead (and thus unifying the two scripts sage-pkg and sage-pkg-nocompress).\n- Add some comments about this to the developer's guide (hence the cc for mvngu).\n\nI used python because in the old version of sage-pkg, we were already calling sed and perl, and we might need to call perl again (or something else?) to test whether the name has the right form.  It seems easier to maintain if it's all plain Python.\n\nHere is the standard suggested by this patch: each Sage spkg should have a name of the following form:\n\n```\nBASENAME-VERSION.spkg\n```\nwhere BASENAME may contain lowercase letters, numbers, and underscores, but **no hyphens**.  VERSION **must be present** and **should start with a number**; it may contain numbers, letters, dots, and hyphens; it may end in a string of the form \"pNUM\", where \"NUM\" is a non-negative integer.  The new version of sage-pkg sets BASENAME to be everything up to the first hyphen, but it does not check to make sure only numbers, lowercase letters, and underscores are used.  It checks that VERSION is present, starts with a number, and contains only numbers, letters, periods, hyphens.  If not, it prints a warning and creates an spkg anyway.\n\nI've tried to implement the change at #2522, but I'm not sure how to test it.  Any suggestions?  What sort of \"OS X junk\" should I try to put in my directory, to make sure it is not put into the resulting spkg file?\n\n\nAssignee: tbd\n\nCC:  @dandrake mvngu\n\nResolution: fixed\n\nAuthor: John Palmieri\n\nReviewer: William Stein, Dan Drake\n\nMerged: sage-4.4.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/8679\n\n",
    "closed_at": "2010-04-16T18:57:09Z",
    "created_at": "2010-04-12T21:21:49Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.4",
    "title": "conventions for spkg names, rewriting sage-spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8679",
    "user": "https://github.com/jhpalmieri"
}
```
Some scripts in SAGE_ROOT/local/bin expect spkg names to have the form 

```
my_package-2.3.spkg
```
but not 

```
my-package-2.3.spkg   (first hyphen is bad)
```
See [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8597ce93b420afe4) for some discussion.

The attached patches do three things:

- Rewrite sage-pkg (in python instead of bash) to test whether the name has the right form.
- Remove sage-pkg-nocompress, using sage-pkg instead (and thus unifying the two scripts sage-pkg and sage-pkg-nocompress).
- Add some comments about this to the developer's guide (hence the cc for mvngu).

I used python because in the old version of sage-pkg, we were already calling sed and perl, and we might need to call perl again (or something else?) to test whether the name has the right form.  It seems easier to maintain if it's all plain Python.

Here is the standard suggested by this patch: each Sage spkg should have a name of the following form:

```
BASENAME-VERSION.spkg
```
where BASENAME may contain lowercase letters, numbers, and underscores, but **no hyphens**.  VERSION **must be present** and **should start with a number**; it may contain numbers, letters, dots, and hyphens; it may end in a string of the form "pNUM", where "NUM" is a non-negative integer.  The new version of sage-pkg sets BASENAME to be everything up to the first hyphen, but it does not check to make sure only numbers, lowercase letters, and underscores are used.  It checks that VERSION is present, starts with a number, and contains only numbers, letters, periods, hyphens.  If not, it prints a warning and creates an spkg anyway.

I've tried to implement the change at #2522, but I'm not sure how to test it.  Any suggestions?  What sort of "OS X junk" should I try to put in my directory, to make sure it is not put into the resulting spkg file?


Assignee: tbd

CC:  @dandrake mvngu

Resolution: fixed

Author: John Palmieri

Reviewer: William Stein, Dan Drake

Merged: sage-4.4.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/8679





---

archive/issue_comments_099833.json:
```json
{
    "body": "sage repo (documentation)",
    "created_at": "2010-04-12T21:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99833",
    "user": "https://github.com/jhpalmieri"
}
```

sage repo (documentation)



---

archive/issue_comments_099834.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,12 +18,12 @@\n \n I used python because in the old version of sage-pkg, we were already calling sed and perl, and we might need to call perl again (or something else?) to test whether the name has the right form.  It seems easier to maintain if it's all plain Python.\n \n-Here is the standard being suggested by this patch: each Sage spkg should have a name of the following form:\n+Here is the standard suggested by this patch: each Sage spkg should have a name of the following form:\n \n ```\n BASENAME-VERSION.spkg\n ```\n-where BASENAME may lowercase letters, numbers, and underscores, but **no hyphens**.  VERSION **must be present** and **should start with a number**; it may contain numbers, letters, dots, and hyphens; it may end in a string of the form \"pNUM\", where \"NUM\" is a non-negative integer.  The new version of sage-pkg sets BASENAME to be everything up to the first hyphen, but it does not check to make sure only numbers, lowercase letters, and underscores are used.  It checks that VERSION is present, starts with a number, and contains only numbers, letters, periods, hyphens.  If not, it prints a warning and creates an spkg anyway.\n+where BASENAME may contain lowercase letters, numbers, and underscores, but **no hyphens**.  VERSION **must be present** and **should start with a number**; it may contain numbers, letters, dots, and hyphens; it may end in a string of the form \"pNUM\", where \"NUM\" is a non-negative integer.  The new version of sage-pkg sets BASENAME to be everything up to the first hyphen, but it does not check to make sure only numbers, lowercase letters, and underscores are used.  It checks that VERSION is present, starts with a number, and contains only numbers, letters, periods, hyphens.  If not, it prints a warning and creates an spkg anyway.\n \n I've tried to implement the change at #2522, but I'm not sure how to test it.  Any suggestions?  What sort of \"OS X junk\" should I try to put in my directory, to make sure it is not put into the resulting spkg file?\n \n``````\n",
    "created_at": "2010-04-12T21:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99834",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,12 +18,12 @@
 
 I used python because in the old version of sage-pkg, we were already calling sed and perl, and we might need to call perl again (or something else?) to test whether the name has the right form.  It seems easier to maintain if it's all plain Python.
 
-Here is the standard being suggested by this patch: each Sage spkg should have a name of the following form:
+Here is the standard suggested by this patch: each Sage spkg should have a name of the following form:
 
 ```
 BASENAME-VERSION.spkg
 ```
-where BASENAME may lowercase letters, numbers, and underscores, but **no hyphens**.  VERSION **must be present** and **should start with a number**; it may contain numbers, letters, dots, and hyphens; it may end in a string of the form "pNUM", where "NUM" is a non-negative integer.  The new version of sage-pkg sets BASENAME to be everything up to the first hyphen, but it does not check to make sure only numbers, lowercase letters, and underscores are used.  It checks that VERSION is present, starts with a number, and contains only numbers, letters, periods, hyphens.  If not, it prints a warning and creates an spkg anyway.
+where BASENAME may contain lowercase letters, numbers, and underscores, but **no hyphens**.  VERSION **must be present** and **should start with a number**; it may contain numbers, letters, dots, and hyphens; it may end in a string of the form "pNUM", where "NUM" is a non-negative integer.  The new version of sage-pkg sets BASENAME to be everything up to the first hyphen, but it does not check to make sure only numbers, lowercase letters, and underscores are used.  It checks that VERSION is present, starts with a number, and contains only numbers, letters, periods, hyphens.  If not, it prints a warning and creates an spkg anyway.
 
 I've tried to implement the change at #2522, but I'm not sure how to test it.  Any suggestions?  What sort of "OS X junk" should I try to put in my directory, to make sure it is not put into the resulting spkg file?
 
``````




---

archive/issue_comments_099835.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [trac_8679-sage.patch](tarball://root/attachments/some-uuid/ticket8679/trac_8679-sage.patch) by @jhpalmieri created at 2010-04-12 21:59:06",
    "created_at": "2010-04-12T21:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99835",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
Attachment [trac_8679-sage.patch](tarball://root/attachments/some-uuid/ticket8679/trac_8679-sage.patch) by @jhpalmieri created at 2010-04-12 21:59:06



---

archive/issue_comments_099836.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-04-12T21:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99836",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_099837.json:
```json
{
    "body": "<a id='comment:3'></a>\n* I read trac_8679-sage.patch and it looks wonderful!!\n\n* trac_8679-scripts.patch will of course probably cause some other patches to need rebases. \n\n-- So to finish a review, trac_8679-sage.patch needs to be tested:\n\n1. make an spkg\n\n2. make a non-compressed spkg\n\n3. Do a full build of all of sage.\n\nAnything else?\n\nIf somebody (e.g., me) reports the above works, then I would give this a positive review.\n\nAnd moving to Python is *great*, since now we can use this script in other scripts, and option parsing is done right.",
    "created_at": "2010-04-13T04:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99837",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'></a>
* I read trac_8679-sage.patch and it looks wonderful!!

* trac_8679-scripts.patch will of course probably cause some other patches to need rebases. 

-- So to finish a review, trac_8679-sage.patch needs to be tested:

1. make an spkg

2. make a non-compressed spkg

3. Do a full build of all of sage.

Anything else?

If somebody (e.g., me) reports the above works, then I would give this a positive review.

And moving to Python is *great*, since now we can use this script in other scripts, and option parsing is done right.



---

archive/issue_comments_099838.json:
```json
{
    "body": "<a id='comment:4'></a>\nI applied the scripts patch, unpacked the fortran spkg, and tried \"sage -pkg_nc fortran-...\". It didn't go so well:\n\n```\nCreating Sage package fortran-20100118 with no compression\nTraceback (most recent call last):\n  File \"/home/drake/s/trac8679/sage-4.3.5/local/bin/sage-pkg\", line 130, in <module>\n    main()\n  File \"/home/drake/s/trac8679/sage-4.3.5/local/bin/sage-pkg\", line 81, in main\n    tar_file(dir, no_compress = options.no_compress)\n  File \"/home/drake/s/trac8679/sage-4.3.5/local/bin/sage-pkg\", line 36, in tar_file\n    tar = tarfile.open(file, mode=mode)\n  File \"/home/drake/s/trac8679/sage-4.3.5/local/lib/python/tarfile.py\", line 1682, in open\n    return cls.taropen(name, mode, fileobj, **kwargs)\n  File \"/home/drake/s/trac8679/sage-4.3.5/local/lib/python/tarfile.py\", line 1692, in taropen\n    return cls(name, mode, fileobj, **kwargs)\n  File \"/home/drake/s/trac8679/sage-4.3.5/local/lib/python/tarfile.py\", line 1519, in __init__\n    fileobj = bltn_open(name, self._mode)\nTypeError: coercing to Unicode: need string or buffer, type found\n```\nI think you never defined what \"file\" is in your \"tarfile.open\" call.",
    "created_at": "2010-04-13T12:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99838",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:4'></a>
I applied the scripts patch, unpacked the fortran spkg, and tried "sage -pkg_nc fortran-...". It didn't go so well:

```
Creating Sage package fortran-20100118 with no compression
Traceback (most recent call last):
  File "/home/drake/s/trac8679/sage-4.3.5/local/bin/sage-pkg", line 130, in <module>
    main()
  File "/home/drake/s/trac8679/sage-4.3.5/local/bin/sage-pkg", line 81, in main
    tar_file(dir, no_compress = options.no_compress)
  File "/home/drake/s/trac8679/sage-4.3.5/local/bin/sage-pkg", line 36, in tar_file
    tar = tarfile.open(file, mode=mode)
  File "/home/drake/s/trac8679/sage-4.3.5/local/lib/python/tarfile.py", line 1682, in open
    return cls.taropen(name, mode, fileobj, **kwargs)
  File "/home/drake/s/trac8679/sage-4.3.5/local/lib/python/tarfile.py", line 1692, in taropen
    return cls(name, mode, fileobj, **kwargs)
  File "/home/drake/s/trac8679/sage-4.3.5/local/lib/python/tarfile.py", line 1519, in __init__
    fileobj = bltn_open(name, self._mode)
TypeError: coercing to Unicode: need string or buffer, type found
```
I think you never defined what "file" is in your "tarfile.open" call.



---

archive/issue_comments_099839.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-04-13T12:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99839",
    "user": "https://github.com/dandrake"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_099840.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [ddrake](#comment%3A4):\n\n> I think you never defined what \"file\" is in your \"tarfile.open\" call.\n\n\nOops, you're right.  (The tar_file function used to be part of \"main\", so \"file\" was defined there.)\n\nHere's a new patch; it just changes `file` to `\"%s.spkg\" % dir`.",
    "created_at": "2010-04-13T18:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99840",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Replying to [ddrake](#comment%3A4):

> I think you never defined what "file" is in your "tarfile.open" call.


Oops, you're right.  (The tar_file function used to be part of "main", so "file" was defined there.)

Here's a new patch; it just changes `file` to `"%s.spkg" % dir`.



---

archive/issue_comments_099841.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-04-13T18:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99841",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_099842.json:
```json
{
    "body": "Attachment [trac_8679-scripts.patch](tarball://root/attachments/some-uuid/ticket8679/trac_8679-scripts.patch) by @jhpalmieri created at 2010-04-13 18:20:20\n\nscripts repo",
    "created_at": "2010-04-13T18:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99842",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_8679-scripts.patch](tarball://root/attachments/some-uuid/ticket8679/trac_8679-scripts.patch) by @jhpalmieri created at 2010-04-13 18:20:20

scripts repo



---

archive/issue_comments_099843.json:
```json
{
    "body": "<a id='comment:6'></a>\nFunny thing. I'd rather change the *code* to reflect the common practice of using dashes in package names, i.e. taking the leftmost substring that *starts with a digit* (and of course is preceded by a hyphen) as the package version part.\n\nIMHO code that's unable to deal with dashes in package names is bad and should be fixed, not the names. We shouldn't introduce or keep restrictions that aren't really necessary, not only but especially if they rule out what's widely used.\n\n-Leif",
    "created_at": "2010-04-13T18:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99843",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>
Funny thing. I'd rather change the *code* to reflect the common practice of using dashes in package names, i.e. taking the leftmost substring that *starts with a digit* (and of course is preceded by a hyphen) as the package version part.

IMHO code that's unable to deal with dashes in package names is bad and should be fixed, not the names. We shouldn't introduce or keep restrictions that aren't really necessary, not only but especially if they rule out what's widely used.

-Leif



---

archive/issue_comments_099844.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [leif](#comment%3A6):\n> Funny thing. I'd rather change the *code* to reflect the common practice of using dashes in package names, i.e. taking the leftmost substring that *starts with a digit* (and of course is preceded by a hyphen) as the package version part.\n> \n> IMHO code that's unable to deal with dashes in package names is bad and should be fixed, not the names. We shouldn't introduce or keep restrictions that aren't really necessary, not only but especially if they rule out what's widely used.\n\n\nFirst of all, what's widely used *in Sage* is the convention here: everything after the first hyphen is the version number.  Look at the names of the standard spkgs to see this.\n\nSecond, you might be right, but this is not the right place to discuss design decisions like this: sage-devel is.\n\nThird, this is an issue which will only arise for developers -- people producing new spkgs -- and they should be able to handle using hyphens or underscores according to the conventions.  So it's not a big deal.",
    "created_at": "2010-04-13T18:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99844",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
Replying to [leif](#comment%3A6):
> Funny thing. I'd rather change the *code* to reflect the common practice of using dashes in package names, i.e. taking the leftmost substring that *starts with a digit* (and of course is preceded by a hyphen) as the package version part.
> 
> IMHO code that's unable to deal with dashes in package names is bad and should be fixed, not the names. We shouldn't introduce or keep restrictions that aren't really necessary, not only but especially if they rule out what's widely used.


First of all, what's widely used *in Sage* is the convention here: everything after the first hyphen is the version number.  Look at the names of the standard spkgs to see this.

Second, you might be right, but this is not the right place to discuss design decisions like this: sage-devel is.

Third, this is an issue which will only arise for developers -- people producing new spkgs -- and they should be able to handle using hyphens or underscores according to the conventions.  So it's not a big deal.



---

archive/issue_comments_099845.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jhpalmieri](#comment%3A7):\n> First of all, what's widely used *in Sage* is the convention here\n\nWell, I didn't talk about common *spkg* names (of course they follow the old rule).\nNote that many spkgs are patched upstream packages, so their (original) names won't necessarily follow *Sage's* naming convention; there are indeed yet packages that had to be renamed.\n\n> Second, you might be right, but this is not the right place to discuss design decisions like this: sage-devel is.\n\nThe thread \"ends\" with a link to this ticket, whose description (re-)states the convention, while the thread's title only mentions the *mode* package;\nbut never mind, I'll repost it there. ;-)\n\n> Third, this is an issue which will only arise for developers -- people producing new spkgs -- and they should be able to handle using hyphens or underscores according to the conventions.\n\nI think there's (with intent) no sharp line between Sage developers/contributors/users; think of optional \"third party\" (s)pkgs.",
    "created_at": "2010-04-13T22:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99845",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'></a>
Replying to [jhpalmieri](#comment%3A7):
> First of all, what's widely used *in Sage* is the convention here

Well, I didn't talk about common *spkg* names (of course they follow the old rule).
Note that many spkgs are patched upstream packages, so their (original) names won't necessarily follow *Sage's* naming convention; there are indeed yet packages that had to be renamed.

> Second, you might be right, but this is not the right place to discuss design decisions like this: sage-devel is.

The thread "ends" with a link to this ticket, whose description (re-)states the convention, while the thread's title only mentions the *mode* package;
but never mind, I'll repost it there. ;-)

> Third, this is an issue which will only arise for developers -- people producing new spkgs -- and they should be able to handle using hyphens or underscores according to the conventions.

I think there's (with intent) no sharp line between Sage developers/contributors/users; think of optional "third party" (s)pkgs.



---

archive/issue_comments_099846.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [was](#comment%3A3):\n> -- So to finish a review, trac_8679-sage.patch needs to be tested:\n> \n> 1. make an spkg\n> \n> 2. make a non-compressed spkg\n> \n> 3. Do a full build of all of sage.\n\n\nI'm doing a full build of Sage right now. I took all the spkgs in spkg/standard, extracted them, and re-made them with \"sage -pkg\" (and \"sage -pkg_nc\") after applying the patch here. I'll report the results of the build, although so far it seems fine.",
    "created_at": "2010-04-14T03:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99846",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:9'></a>
Replying to [was](#comment%3A3):
> -- So to finish a review, trac_8679-sage.patch needs to be tested:
> 
> 1. make an spkg
> 
> 2. make a non-compressed spkg
> 
> 3. Do a full build of all of sage.


I'm doing a full build of Sage right now. I took all the spkgs in spkg/standard, extracted them, and re-made them with "sage -pkg" (and "sage -pkg_nc") after applying the patch here. I'll report the results of the build, although so far it seems fine.



---

archive/issue_comments_099847.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [ddrake](#comment%3A9):\n> I'm doing a full build of Sage right now. I took all the spkgs in spkg/standard, extracted them, and re-made them with \"sage -pkg\" (and \"sage -pkg_nc\") after applying the patch here. I'll report the results of the build, although so far it seems fine.\n\n\nThe build went fine and all tests pass, so the new script produces spkgs that work perfectly well.\n\nJust as an idea, would it make sense to have \"sage -pkg\" add checksums, as in #329?",
    "created_at": "2010-04-14T08:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99847",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:10'></a>
Replying to [ddrake](#comment%3A9):
> I'm doing a full build of Sage right now. I took all the spkgs in spkg/standard, extracted them, and re-made them with "sage -pkg" (and "sage -pkg_nc") after applying the patch here. I'll report the results of the build, although so far it seems fine.


The build went fine and all tests pass, so the new script produces spkgs that work perfectly well.

Just as an idea, would it make sense to have "sage -pkg" add checksums, as in #329?



---

archive/issue_comments_099848.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [ddrake](#comment%3A10):\n> Just as an idea, would it make sense to have \"sage -pkg\" add checksums, as in #329?\n\n\nI think that sounds good, but it belongs on another ticket.\n\nBy the way, I also applied this patch and then ran \"sage -sdist\" and built Sage from the resulting tar file without problems.",
    "created_at": "2010-04-14T17:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99848",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>
Replying to [ddrake](#comment%3A10):
> Just as an idea, would it make sense to have "sage -pkg" add checksums, as in #329?


I think that sounds good, but it belongs on another ticket.

By the way, I also applied this patch and then ran "sage -sdist" and built Sage from the resulting tar file without problems.



---

archive/issue_comments_099849.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jhpalmieri](#comment%3A11):\n> Replying to [ddrake](#comment%3A10):\n> > Just as an idea, would it make sense to have \"sage -pkg\" add checksums, as in #329?\n\n> \n> I think that sounds good, but it belongs on another ticket.\n\n\nOh, of course. I've created #8690 for that.\n\nIt seems we've met William's criteria for a positive review. I've created some spkgs (in Linux and OS X) with this patch applied, and everything works properly. I think we can call this a positive review.",
    "created_at": "2010-04-15T01:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99849",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:12'></a>
Replying to [jhpalmieri](#comment%3A11):
> Replying to [ddrake](#comment%3A10):
> > Just as an idea, would it make sense to have "sage -pkg" add checksums, as in #329?

> 
> I think that sounds good, but it belongs on another ticket.


Oh, of course. I've created #8690 for that.

It seems we've met William's criteria for a positive review. I've created some spkgs (in Linux and OS X) with this patch applied, and everything works properly. I think we can call this a positive review.



---

archive/issue_comments_099850.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-04-15T01:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99850",
    "user": "https://github.com/dandrake"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_099851.json:
```json
{
    "body": "Reviewer: William Stein, Dan Drake",
    "created_at": "2010-04-15T01:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99851",
    "user": "https://github.com/dandrake"
}
```

Reviewer: William Stein, Dan Drake



---

archive/issue_comments_099852.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [leif](#comment%3A8):\n> Replying to [jhpalmieri](#comment%3A7):\n> > First of all, what's widely used *in Sage* is the convention here\n\n> Well, I didn't talk about common *spkg* names (of course they follow the old rule).\n> Note that many spkgs are patched upstream packages, so their (original) names won't necessarily follow *Sage's* naming convention; there are indeed yet packages that had to be renamed.\n> \n> > Second, you might be right, but this is not the right place to discuss design decisions like this: sage-devel is.\n\n> The thread \"ends\" with a link to this ticket, whose description (re-)states the convention, while the thread's title only mentions the *mode* package;\n> but never mind, I'll repost it there. ;-)\n> \n> > Third, this is an issue which will only arise for developers -- people producing new spkgs -- and they should be able to handle using hyphens or underscores according to the conventions.\n\n> I think there's (with intent) no sharp line between Sage developers/contributors/users; think of optional \"third party\" (s)pkgs.\n\njhpalmieri's patch rewrites an existing script with no changes in semantics, except to give an error if the package name breaks other parts of the Sage build system.  I think it should go in as is.  \n\nYour suggestions to change the package naming convention is reasonable consider.  However, I think that should be done independently of this particular ticket.  Keeping focus on one issue at a time is really important in order to make solid progress.",
    "created_at": "2010-04-15T01:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99852",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:13'></a>
Replying to [leif](#comment%3A8):
> Replying to [jhpalmieri](#comment%3A7):
> > First of all, what's widely used *in Sage* is the convention here

> Well, I didn't talk about common *spkg* names (of course they follow the old rule).
> Note that many spkgs are patched upstream packages, so their (original) names won't necessarily follow *Sage's* naming convention; there are indeed yet packages that had to be renamed.
> 
> > Second, you might be right, but this is not the right place to discuss design decisions like this: sage-devel is.

> The thread "ends" with a link to this ticket, whose description (re-)states the convention, while the thread's title only mentions the *mode* package;
> but never mind, I'll repost it there. ;-)
> 
> > Third, this is an issue which will only arise for developers -- people producing new spkgs -- and they should be able to handle using hyphens or underscores according to the conventions.

> I think there's (with intent) no sharp line between Sage developers/contributors/users; think of optional "third party" (s)pkgs.

jhpalmieri's patch rewrites an existing script with no changes in semantics, except to give an error if the package name breaks other parts of the Sage build system.  I think it should go in as is.  

Your suggestions to change the package naming convention is reasonable consider.  However, I think that should be done independently of this particular ticket.  Keeping focus on one issue at a time is really important in order to make solid progress.



---

archive/issue_comments_099853.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [was](#comment%3A13):\n> jhpalmieri's patch rewrites an existing script with no changes in semantics, except to give an error if the package name breaks other parts of the Sage build system.  I think it should go in as is.  \n\n\nI didn't want to blame John's work nor give it a negative review.\n\nRelaxing the naming convention of course requires locating the code parts that (currently can't) deal with such names, so if at all tbd in another ticket.",
    "created_at": "2010-04-15T02:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99853",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [was](#comment%3A13):
> jhpalmieri's patch rewrites an existing script with no changes in semantics, except to give an error if the package name breaks other parts of the Sage build system.  I think it should go in as is.  


I didn't want to blame John's work nor give it a negative review.

Relaxing the naming convention of course requires locating the code parts that (currently can't) deal with such names, so if at all tbd in another ticket.



---

archive/issue_comments_099854.json:
```json
{
    "body": "Merged: sage-4.4.alpha0",
    "created_at": "2010-04-16T18:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99854",
    "user": "https://github.com/jhpalmieri"
}
```

Merged: sage-4.4.alpha0



---

archive/issue_comments_099855.json:
```json
{
    "body": "<a id='comment:15'></a>\nMerged in 4.4.alpha0:\n- trac_8679-sage.patch\n- trac_8679-scripts.patch",
    "created_at": "2010-04-16T18:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99855",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Merged in 4.4.alpha0:
- trac_8679-sage.patch
- trac_8679-scripts.patch



---

archive/issue_comments_099856.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-04-16T18:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8679#issuecomment-99856",
    "user": "https://github.com/jhpalmieri"
}
```

Resolution: fixed



---

archive/issue_events_026050.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-16T18:57:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8679",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8679#event-26050"
}
```
