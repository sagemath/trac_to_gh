# Issue 8670: Provide projections methods for word paths

archive/issues_008670.json:
```json
{
    "body": "Nice mathematical objects can be obtained when projecting appropriately a discrete path (Rauzy fractals for instance).\n\nThis patch introduces 3 projection functions for word path. It also adds 2 functions to `WordMorphism` and 2 matrix rotation functions to `sage/matrix/constructor.py`.\n\nThe first 1000 points of the Rauzy fractal :\n\n```\n    sage: s = WordMorphism('1->12,2->13,3->1')\n    sage: D = s.fixed_point('1')\n    sage: v = s.pisot_vector()\n    sage: P = WordPaths('123',[(1,0,0),(0,1,0),(0,0,1)])\n    sage: w = P(D[:1000])\n    sage: w.projected_plot(v)\n```\nSee more examples in doctests.\n\n\n**Assignee:** @seblabbe\n\n**CC:**  abmasse @videlec @robertwb tjolivet tmonteil\n\n**Author:** S\u00e9bastien Labb\u00e9\n\n**Reviewer:** Franco Saliola, Timo Jolivet\n\n**Merged:** sage-4.7.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/8670\n\n",
    "closed_at": "2011-03-17T19:22:34Z",
    "created_at": "2010-04-11T12:10:06Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "Provide projections methods for word paths",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8670",
    "user": "https://github.com/seblabbe"
}
```
Nice mathematical objects can be obtained when projecting appropriately a discrete path (Rauzy fractals for instance).

This patch introduces 3 projection functions for word path. It also adds 2 functions to `WordMorphism` and 2 matrix rotation functions to `sage/matrix/constructor.py`.

The first 1000 points of the Rauzy fractal :

```
    sage: s = WordMorphism('1->12,2->13,3->1')
    sage: D = s.fixed_point('1')
    sage: v = s.pisot_vector()
    sage: P = WordPaths('123',[(1,0,0),(0,1,0),(0,0,1)])
    sage: w = P(D[:1000])
    sage: w.projected_plot(v)
```
See more examples in doctests.


**Assignee:** @seblabbe

**CC:**  abmasse @videlec @robertwb tjolivet tmonteil

**Author:** Sébastien Labbé

**Reviewer:** Franco Saliola, Timo Jolivet

**Merged:** sage-4.7.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/8670





---

archive/issue_comments_091405.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-04-11T13:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91405",
    "user": "https://github.com/seblabbe"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_091406.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2010-04-13T11:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91406",
    "user": "https://github.com/seblabbe"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_091407.json:
```json
{
    "body": "<a id='comment:2'></a>\nThere are some limit case problems :\n\n```\nsage: from sage.plot.plot3d.transform import *\nsage: rotate_vector_on_axis((1,0,0), 0)\nTraceback (most recent call last):\n...\nZeroDivisionError: Rational division by zero\n```\n\nWill post a new patch soon.",
    "created_at": "2010-04-13T11:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91407",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:2'></a>
There are some limit case problems :

```
sage: from sage.plot.plot3d.transform import *
sage: rotate_vector_on_axis((1,0,0), 0)
Traceback (most recent call last):
...
ZeroDivisionError: Rational division by zero
```

Will post a new patch soon.



---

archive/issue_comments_091408.json:
```json
{
    "body": "<a id='comment:3'></a>\nI fixed the above problem in the updated patch. Needs review!\n\nSince I am adding two functions to the file `sage/plot/plot3d/transform.pyx`, I am also adding Robert Bradshaw in cc of this ticket. He might have some comments to share.",
    "created_at": "2010-04-18T19:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91408",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:3'></a>
I fixed the above problem in the updated patch. Needs review!

Since I am adding two functions to the file `sage/plot/plot3d/transform.pyx`, I am also adding Robert Bradshaw in cc of this ticket. He might have some comments to share.



---

archive/issue_comments_091409.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2010-04-18T19:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91409",
    "user": "https://github.com/seblabbe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_091410.json:
```json
{
    "body": "Does not depend on any known patch. Applies on 4.3.4.",
    "created_at": "2010-04-27T15:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91410",
    "user": "https://github.com/seblabbe"
}
```

Does not depend on any known patch. Applies on 4.3.4.



---

archive/attachments_010838.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8670-word-path-projection-sl.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8670/trac_8670-word-path-projection-sl.patch",
    "created_at": "2010-06-23T16:04:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/saliola"
}
```



---

archive/issue_comments_091411.json:
```json
{
    "body": "<a id='comment:4'></a>\n1. Your definition of Pisot eigenvector is ambiguous.\n\n```\nReturns the left eigenvector of the incidence matrix associated\nto the largest eigenvalue (in absolute value).\n```\nIt is possible that there are multiple eigenvalues with the same absolute value:\n\n```\nsage: mu = WordMorphism('a->c,b->c,c->ab')\nsage: m = matrix(mu); m\n[0 0 1]\n[0 0 1]\n[1 1 0]\nsage: m.eigenvalues()\n[0, -1.414213562373095?, 1.414213562373095?]\n```\nIt is not clear which eigenvector gets returned here.\n\nAlso, there may be more than one eigenvector associated to your \"maximal\" eigenvalue, and your method only returns one eigenvector:\n\n```\nsage: mu = WordMorphism('a->a,b->b,c->abc')\nsage: mu.pisot_eigenvector_left()\n(1, -1, 0)\nsage: m = matrix(mu); m\n[1 0 1]\n[0 1 1]\n[0 0 1]\nsage: m.eigenspaces_left()\n[\n(1, Vector space of degree 3 and dimension 2 over Rational Field\nUser basis matrix:\n[ 1 -1  0]\n[ 0  0  1])\n]\n```\n\n2. The method `directive_vector` should include a definition of what the directive vector is.\n\n3. In your functions `rotate_ith_to_zero` and `rotate_vector_on_axis`, you first construct the matrix and then coerce it into the ring specified by the user. Why is this preferable to doing the computations directly in the ring? What about making this an option `compute_in_ring=False`? I think all you need to do is add the following line at the beginning:\n\n```\nif compute_in_ring is True:\n    v = vector(ring, v)\n```",
    "created_at": "2010-06-23T16:04:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91411",
    "user": "https://github.com/saliola"
}
```

<a id='comment:4'></a>
1. Your definition of Pisot eigenvector is ambiguous.

```
Returns the left eigenvector of the incidence matrix associated
to the largest eigenvalue (in absolute value).
```
It is possible that there are multiple eigenvalues with the same absolute value:

```
sage: mu = WordMorphism('a->c,b->c,c->ab')
sage: m = matrix(mu); m
[0 0 1]
[0 0 1]
[1 1 0]
sage: m.eigenvalues()
[0, -1.414213562373095?, 1.414213562373095?]
```
It is not clear which eigenvector gets returned here.

Also, there may be more than one eigenvector associated to your "maximal" eigenvalue, and your method only returns one eigenvector:

```
sage: mu = WordMorphism('a->a,b->b,c->abc')
sage: mu.pisot_eigenvector_left()
(1, -1, 0)
sage: m = matrix(mu); m
[1 0 1]
[0 1 1]
[0 0 1]
sage: m.eigenspaces_left()
[
(1, Vector space of degree 3 and dimension 2 over Rational Field
User basis matrix:
[ 1 -1  0]
[ 0  0  1])
]
```

2. The method `directive_vector` should include a definition of what the directive vector is.

3. In your functions `rotate_ith_to_zero` and `rotate_vector_on_axis`, you first construct the matrix and then coerce it into the ring specified by the user. Why is this preferable to doing the computations directly in the ring? What about making this an option `compute_in_ring=False`? I think all you need to do is add the following line at the beginning:

```
if compute_in_ring is True:
    v = vector(ring, v)
```



---

archive/issue_comments_091412.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2010-06-23T16:04:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91412",
    "user": "https://github.com/saliola"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_091413.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2010-10-15T21:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91413",
    "user": "https://github.com/seblabbe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_091414.json:
```json
{
    "body": "<a id='comment:5'></a>\nNeeds review again!",
    "created_at": "2010-10-15T21:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91414",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'></a>
Needs review again!



---

archive/attachments_010839.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8670-review-sl.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8670/trac_8670-review-sl.patch",
    "created_at": "2010-10-15T22:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/seblabbe"
}
```



---

archive/issue_comments_091415.json:
```json
{
    "body": "Applies over the precedent patch",
    "created_at": "2010-10-15T22:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91415",
    "user": "https://github.com/seblabbe"
}
```

Applies over the precedent patch



---

archive/issue_comments_091416.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2011-01-28T17:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91416",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjolivet"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_091417.json:
```json
{
    "body": "<a id='comment:8'></a>\nHi,\n\nHere are a few remarks:\n\n(1) There is a doctest failure:\n\n  `File \"/home/timo/sage-4.6.1/devel/sage-trac_8670/sage/plot/plot3d/transform.pyx\", line 325:    sage: rotate_vector_on_axis(v, 0, ring=RealField(10)) * vExpected:    (5.5, 0.0020, 0.0020, 0.00)Got:    (5.5, 0.00098, 0.00098, 0.00)`\n\nThis should be fixed by using \"`...`\", and could be done for the other occurrences of printed floats.\n\n(2) I think that the rotations matrices should be in a file in sage/matrix/. I remember having looked for something like `rotate_arbitrary`, but I didn't find it because it was in plot3d/ and not in matrix/.\n\n(3) The documentation for `rotate_vector_on_axis` could be a little bit clearer (the description).\n\nOtherwise this is a nice and useful patch.",
    "created_at": "2011-01-28T17:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91417",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjolivet"
}
```

<a id='comment:8'></a>
Hi,

Here are a few remarks:

(1) There is a doctest failure:

  `File "/home/timo/sage-4.6.1/devel/sage-trac_8670/sage/plot/plot3d/transform.pyx", line 325:    sage: rotate_vector_on_axis(v, 0, ring=RealField(10)) * vExpected:    (5.5, 0.0020, 0.0020, 0.00)Got:    (5.5, 0.00098, 0.00098, 0.00)`

This should be fixed by using "`...`", and could be done for the other occurrences of printed floats.

(2) I think that the rotations matrices should be in a file in sage/matrix/. I remember having looked for something like `rotate_arbitrary`, but I didn't find it because it was in plot3d/ and not in matrix/.

(3) The documentation for `rotate_vector_on_axis` could be a little bit clearer (the description).

Otherwise this is a nice and useful patch.



---

archive/issue_comments_091418.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,7 +12,5 @@\n     sage: w = P(D[:1000])\n     sage: w.projected_plot(v)\n ```\n-\n See more examples in doctests.\n \n-\n``````\n",
    "created_at": "2011-01-28T17:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91418",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjolivet"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,7 +12,5 @@
     sage: w = P(D[:1000])
     sage: w.projected_plot(v)
 ```
-
 See more examples in doctests.
 
-
``````




---

archive/attachments_010840.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8670_second_corrections-sl.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8670/trac_8670_second_corrections-sl.patch",
    "created_at": "2011-01-29T13:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/seblabbe"
}
```



---

archive/issue_comments_091419.json:
```json
{
    "body": "Applies over the precedent 2 patches",
    "created_at": "2011-01-29T13:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91419",
    "user": "https://github.com/seblabbe"
}
```

Applies over the precedent 2 patches



---

archive/issue_comments_091420.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks for the comments. I moved the two rotation matrix constructor to the file `sage/matrix/constructor.py`. I improved the docstrings and fixed the doctest failure (I was having the same).\n\nNeeds review.",
    "created_at": "2011-01-29T13:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91420",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:9'></a>
Thanks for the comments. I moved the two rotation matrix constructor to the file `sage/matrix/constructor.py`. I improved the docstrings and fixed the doctest failure (I was having the same).

Needs review.



---

archive/issue_comments_091421.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2011-01-29T13:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91421",
    "user": "https://github.com/seblabbe"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_091422.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Nice mathematical objects can be obtained when projecting appropriately a discrete path (Rauzy fractals for instance).\n \n-This patch introduces 3 projection functions for word path. It also adds 1 function to `WordMorphism` and 2 matrix rotation functions to `sage/plot/plot3d/transforms.pyx`.\n+This patch introduces 3 projection functions for word path. It also adds 2 functions to `WordMorphism` and 2 matrix rotation functions to `sage/matrix/constructor.py`.\n \n The first 1000 points of the Rauzy fractal :\n \n``````\n",
    "created_at": "2011-01-29T13:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91422",
    "user": "https://github.com/seblabbe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Nice mathematical objects can be obtained when projecting appropriately a discrete path (Rauzy fractals for instance).
 
-This patch introduces 3 projection functions for word path. It also adds 1 function to `WordMorphism` and 2 matrix rotation functions to `sage/plot/plot3d/transforms.pyx`.
+This patch introduces 3 projection functions for word path. It also adds 2 functions to `WordMorphism` and 2 matrix rotation functions to `sage/matrix/constructor.py`.
 
 The first 1000 points of the Rauzy fractal :
 
``````




---

archive/attachments_010841.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8670_folded-sl.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8670/trac_8670_folded-sl.patch",
    "created_at": "2011-01-30T00:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/seblabbe"
}
```



---

archive/issue_comments_091423.json:
```json
{
    "body": "Apply only this one.",
    "created_at": "2011-01-30T00:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91423",
    "user": "https://github.com/seblabbe"
}
```

Apply only this one.



---

archive/issue_comments_091424.json:
```json
{
    "body": "<a id='comment:11'></a>\nFor the patchbot :\n\nApply trac_8670_folded-sl.patch",
    "created_at": "2011-01-30T00:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91424",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:11'></a>
For the patchbot :

Apply trac_8670_folded-sl.patch



---

archive/issue_comments_091425.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2011-02-07T12:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91425",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjolivet"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_091426.json:
```json
{
    "body": "**Reviewer:** Franco Saliola, Timo Jolivet",
    "created_at": "2011-02-07T12:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91426",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjolivet"
}
```

**Reviewer:** Franco Saliola, Timo Jolivet



---

archive/issue_comments_091427.json:
```json
{
    "body": "**Author:** S\u00e9bastien Labb\u00e9",
    "created_at": "2011-02-07T12:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91427",
    "user": "https://trac.sagemath.org/admin/accounts/users/tjolivet"
}
```

**Author:** Sébastien Labbé



---

archive/issue_events_025527.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-07T20:20:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "milestone": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8670#event-25527"
}
```



---

archive/issue_comments_091428.json:
```json
{
    "body": "**Merged:** sage-4.7.alpha2",
    "created_at": "2011-03-17T19:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8670#issuecomment-91428",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.alpha2



---

archive/issue_events_025528.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-03-17T19:22:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8670",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8670#event-25528"
}
```
