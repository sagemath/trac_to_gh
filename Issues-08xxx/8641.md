# Issue 8641: "sage -t" should exit with nonzero exit code if doctests fail

archive/issues_008641.json:
```json
{
    "assignees": [
        "https://github.com/dandrake"
    ],
    "body": "Right now, if I run doctests with \"sage -t\" and some doctests fail, the exit code is zero -- but it would be very handy to have a nonzero exit code; for example, it would make using Mercurial's bisect command very useful.\n\nIn #7995, it seems like sage-doctest is passing back some useful exit codes, so we just need to pass those on in a reasonable way.\n\nCC:  @wjp\n\nComponent: **doctest coverage**\n\nAuthor: **Dan Drake, John Palmieri, Mitesh Patel**\n\nReviewer: **Willem Jan Palenstijn**\n\nMerged: **sage-4.5.2.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8641_\n\n",
    "closed_at": "2010-07-22T07:39:35Z",
    "created_at": "2010-04-02T02:41:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.5.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "\"sage -t\" should exit with nonzero exit code if doctests fail",
    "type": "issue",
    "updated_at": "2010-07-22T07:39:35Z",
    "url": "https://github.com/sagemath/sage/issues/8641",
    "user": "https://github.com/dandrake"
}
```
Right now, if I run doctests with "sage -t" and some doctests fail, the exit code is zero -- but it would be very handy to have a nonzero exit code; for example, it would make using Mercurial's bisect command very useful.

In #7995, it seems like sage-doctest is passing back some useful exit codes, so we just need to pass those on in a reasonable way.

CC:  @wjp

Component: **doctest coverage**

Author: **Dan Drake, John Palmieri, Mitesh Patel**

Reviewer: **Willem Jan Palenstijn**

Merged: **sage-4.5.2.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/8641_





---

archive/issue_events_108916.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-04-02T02:41:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108916"
}
```



---

archive/issue_events_108917.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-04-02T02:41:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108917"
}
```



---

archive/issue_events_108918.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-04-02T02:41:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108918"
}
```



---

archive/issue_comments_069305.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI'm following up on the discussion at the end of #7995.\n\nFirst, the code `err = err // 256` seems okay: putting a print statement at the end of that python function shows that `err` seems to have an appropriate value.\n\nOther parts of the python code in sage-test confuse me, though. It seems to me that the function `test_file` always returns 0 (if the file exists), regardless of the success or failure of the test.  The function `test` has a return value which depends on whether tests passed, but `test_file` never uses the return value from `test`, does it?\n\nIn practice, if I run `sage -sh` and then do `sage-doctest` on a file with errors, I get a nonzero return value, but if I run `sage-test` on the same file, I get a return value of 0.",
    "created_at": "2010-04-13T20:19:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69305",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2" align="right">comment:2</div>

I'm following up on the discussion at the end of #7995.

First, the code `err = err // 256` seems okay: putting a print statement at the end of that python function shows that `err` seems to have an appropriate value.

Other parts of the python code in sage-test confuse me, though. It seems to me that the function `test_file` always returns 0 (if the file exists), regardless of the success or failure of the test.  The function `test` has a return value which depends on whether tests passed, but `test_file` never uses the return value from `test`, does it?

In practice, if I run `sage -sh` and then do `sage-doctest` on a file with errors, I get a nonzero return value, but if I run `sage-test` on the same file, I get a return value of 0.



---

archive/issue_comments_069306.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHere's a patch; I'll mark this ready for review, but it should perhaps be considered a first draft.",
    "created_at": "2010-04-13T20:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69306",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

Here's a patch; I'll mark this ready for review, but it should perhaps be considered a first draft.



---

archive/issue_events_108919.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-13T20:32:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108919"
}
```



---

archive/issue_comments_069307.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis needs to deal with the non-platform-independent behavior of return codes -- see the discussion at the bottom of #7995.",
    "created_at": "2010-04-13T22:28:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69307",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

This needs to deal with the non-platform-independent behavior of return codes -- see the discussion at the bottom of #7995.



---

archive/issue_events_108920.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-13T22:28:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108920"
}
```



---

archive/issue_events_108921.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-13T22:28:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108921"
}
```



---

archive/issue_comments_069308.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nPerhaps replacing `os.system(s)` with `check_call(s, shell=True)` (after importing `check_call` from subprocess) will work?  Here's draft number two.",
    "created_at": "2010-04-13T22:34:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69308",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

Perhaps replacing `os.system(s)` with `check_call(s, shell=True)` (after importing `check_call` from subprocess) will work?  Here's draft number two.



---

archive/issue_events_108922.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-13T22:34:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108922"
}
```



---

archive/issue_events_108923.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-13T22:34:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108923"
}
```



---

archive/issue_comments_069309.json:
```json
{
    "body": "Attachment: **[trac_8641-sage-test.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-sage-test.patch.gz)**\n\nscripts repo",
    "created_at": "2010-04-13T22:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69309",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_8641-sage-test.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-sage-test.patch.gz)**

scripts repo



---

archive/issue_comments_069310.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThis seems to work for me on both my mac and on sage.math.  It needs to be tested much more extensively, though.",
    "created_at": "2010-04-13T22:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69310",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

This seems to work for me on both my mac and on sage.math.  It needs to be tested much more extensively, though.



---

archive/issue_events_108924.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-04-13T23:46:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108924"
}
```



---

archive/issue_events_108925.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-04-13T23:46:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108925"
}
```



---

archive/issue_comments_069311.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYour patch seems to work as far as hitting Ctrl-C goes, but if doctesting more than one file, if doctests fail, the entire run fails:\n\n```\nTraceback (most recent call last):\n  File \"/scratch/sage-4.3.5/local/bin/sage-test\", line 177, in <module>\n    err = test_file(F)\n  File \"/scratch/sage-4.3.5/local/bin/sage-test\", line 125, in test_file\n    err = test(F, 'doctest ' + opts + extra_opts)\n  File \"/scratch/sage-4.3.5/local/bin/sage-test\", line 84, in test\n    err = check_call(s, shell=True)\n  File \"/scratch/sage-4.3.5/local/lib/python/subprocess.py\", line 488, in check_call\n    raise CalledProcessError(retcode, cmd)\nsubprocess.CalledProcessError: Command '/scratch/sage-4.3.5/local/bin/sage-doctest  \"devel/sage/sage/combinat/tableau.py\"' returned non-zero exit status 100\n```\nI think we want subprocess.call, not check_call; that will allow us to pass the exit code back up if we want to; \"call\" returns the exit code, but check_call either returns or raises CalledProcessError. Of course, if you like, we can catch the exception and just use that information.\n\nAlso, I think we can avoid the shell=True bit, since our command line is so simple: just do\n\n```\nerr = call([os.path.join(SAGE_ROOT, 'local', 'bin', 'sage-%s' % cmd), F])\n```\nand, on line 127, change 'doctest ' (note the space) to 'doctest'.\n\nFinally, if using the subprocess module, I think we get the genuine return code and there's no need for any \"err = err // 256\" business.",
    "created_at": "2010-04-13T23:46:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69311",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:7" align="right">comment:7</div>

Your patch seems to work as far as hitting Ctrl-C goes, but if doctesting more than one file, if doctests fail, the entire run fails:

```
Traceback (most recent call last):
  File "/scratch/sage-4.3.5/local/bin/sage-test", line 177, in <module>
    err = test_file(F)
  File "/scratch/sage-4.3.5/local/bin/sage-test", line 125, in test_file
    err = test(F, 'doctest ' + opts + extra_opts)
  File "/scratch/sage-4.3.5/local/bin/sage-test", line 84, in test
    err = check_call(s, shell=True)
  File "/scratch/sage-4.3.5/local/lib/python/subprocess.py", line 488, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '/scratch/sage-4.3.5/local/bin/sage-doctest  "devel/sage/sage/combinat/tableau.py"' returned non-zero exit status 100
```
I think we want subprocess.call, not check_call; that will allow us to pass the exit code back up if we want to; "call" returns the exit code, but check_call either returns or raises CalledProcessError. Of course, if you like, we can catch the exception and just use that information.

Also, I think we can avoid the shell=True bit, since our command line is so simple: just do

```
err = call([os.path.join(SAGE_ROOT, 'local', 'bin', 'sage-%s' % cmd), F])
```
and, on line 127, change 'doctest ' (note the space) to 'doctest'.

Finally, if using the subprocess module, I think we get the genuine return code and there's no need for any "err = err // 256" business.



---

archive/issue_comments_069312.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAlso, there's a couple loops where we need to use the \"err = err | return code\" bit, otherwise we will lose the information that a doctest failed. I've updated your patch to do this; I'll upload a new patch shortly.",
    "created_at": "2010-04-14T01:49:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69312",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:8" align="right">comment:8</div>

Also, there's a couple loops where we need to use the "err = err | return code" bit, otherwise we will lose the information that a doctest failed. I've updated your patch to do this; I'll upload a new patch shortly.



---

archive/issue_comments_069313.json:
```json
{
    "body": "apply to scripts repo. Replaces previous.",
    "created_at": "2010-04-14T01:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69313",
    "user": "https://github.com/dandrake"
}
```

apply to scripts repo. Replaces previous.



---

archive/issue_comments_069314.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAttachment: **[trac_8641.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641.patch.gz)**\n\nThis isn't quite working for me: I get errors if I do \"sage -t -long FILE\".  I'm attaching a patch on top of yours which fixes it for me on my iMac, on sage.math, and on t2 (Solaris).",
    "created_at": "2010-04-14T03:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69314",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

Attachment: **[trac_8641.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641.patch.gz)**

This isn't quite working for me: I get errors if I do "sage -t -long FILE".  I'm attaching a patch on top of yours which fixes it for me on my iMac, on sage.math, and on t2 (Solaris).



---

archive/issue_events_108926.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-14T03:01:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108926"
}
```



---

archive/issue_events_108927.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-14T03:01:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108927"
}
```



---

archive/issue_comments_069315.json:
```json
{
    "body": "Attachment: **[trac_8641-part2.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-part2.patch.gz)**\n\napply on top of trac_8641.patch",
    "created_at": "2010-04-14T03:02:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69315",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_8641-part2.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-part2.patch.gz)**

apply on top of trac_8641.patch



---

archive/issue_comments_069316.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jhpalmieri](#comment:9):\n> This isn't quite working for me: I get errors if I do \"sage -t -long FILE\".  I'm attaching a patch on top of yours which fixes it for me on my iMac, on sage.math, and on t2 (Solaris).\n\nAh, nice catch. I didn't test with -long. I took your patch and it works properly on my Ubuntu machines and on bsd.math.\n\nwjp, could you take a look at these patches? I think everything is fine, but another opinion would be nice.\n\nAlso, we still should work on sage-ptest; as pointed out at #7995, there's duplicated code there. But at least with this ticket, we can easily use Mercurial's bisect command to track down failing doctests.",
    "created_at": "2010-04-14T03:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69316",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jhpalmieri](#comment:9):
> This isn't quite working for me: I get errors if I do "sage -t -long FILE".  I'm attaching a patch on top of yours which fixes it for me on my iMac, on sage.math, and on t2 (Solaris).

Ah, nice catch. I didn't test with -long. I took your patch and it works properly on my Ubuntu machines and on bsd.math.

wjp, could you take a look at these patches? I think everything is fine, but another opinion would be nice.

Also, we still should work on sage-ptest; as pointed out at #7995, there's duplicated code there. But at least with this ticket, we can easily use Mercurial's bisect command to track down failing doctests.



---

archive/issue_comments_069317.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI wonder if something else could be happening. Possibly by coincidence, 2 is also SIGINT. Could it be that on sage.math the sage-doctest script itself is being killed by the Ctrl-C instead of the doctest it is running?\n\nAfter all, if you trigger one of the other error cases (like regular error failures), they are caught on sage.math properly.\n\nAlso, a transcript from sage.math:\n\n```\nsage: os.system(\"true\")\n0\nsage: os.system(\"false\")\n256\nsage: os.system(\"sleep 100\")\n[press Ctrl-C]\n2\n```\n\nSo the return values of `os.system` seem to match the specs.",
    "created_at": "2010-04-14T12:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69317",
    "user": "https://github.com/wjp"
}
```

<div id="comment:11" align="right">comment:11</div>

I wonder if something else could be happening. Possibly by coincidence, 2 is also SIGINT. Could it be that on sage.math the sage-doctest script itself is being killed by the Ctrl-C instead of the doctest it is running?

After all, if you trigger one of the other error cases (like regular error failures), they are caught on sage.math properly.

Also, a transcript from sage.math:

```
sage: os.system("true")
0
sage: os.system("false")
256
sage: os.system("sleep 100")
[press Ctrl-C]
2
```

So the return values of `os.system` seem to match the specs.



---

archive/issue_comments_069318.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nP.S. It does sound like using subprocess.call might be more portable; its docs have fewer warnings about undefined return values.\n\nIt does throw a KeyboardInterrupt itself when the called program gets a SIGINT, though, so we may have to catch that to execute the line\n\n```\nfailed.append(sage_test_command(F)+\" # KeyboardInterrupt\")\n```\n\nI'll take a closer look at the patch later today.",
    "created_at": "2010-04-14T12:16:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69318",
    "user": "https://github.com/wjp"
}
```

<div id="comment:12" align="right">comment:12</div>

P.S. It does sound like using subprocess.call might be more portable; its docs have fewer warnings about undefined return values.

It does throw a KeyboardInterrupt itself when the called program gets a SIGINT, though, so we may have to catch that to execute the line

```
failed.append(sage_test_command(F)+" # KeyboardInterrupt")
```

I'll take a closer look at the patch later today.



---

archive/issue_comments_069319.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@wjp](#comment:12):\n\n> I'll take a closer look at the patch later today.\n\nDo you recommend any changes to [attachment: trac_8641.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641.patch.gz) or [attachment: trac_8641-part2.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-part2.patch.gz)?\n\nBy the way, we may need to rebase these for #8891.",
    "created_at": "2010-06-12T09:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69319",
    "user": "https://github.com/qed777"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@wjp](#comment:12):

> I'll take a closer look at the patch later today.

Do you recommend any changes to [attachment: trac_8641.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641.patch.gz) or [attachment: trac_8641-part2.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-part2.patch.gz)?

By the way, we may need to rebase these for #8891.



---

archive/issue_events_108928.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-06-12T09:43:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108928"
}
```



---

archive/issue_comments_069320.json:
```json
{
    "body": "Combined patch rebased vs 4.4.4.alpha0 + #8891.  Replaces all previous.",
    "created_at": "2010-06-14T09:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69320",
    "user": "https://github.com/qed777"
}
```

Combined patch rebased vs 4.4.4.alpha0 + #8891.  Replaces all previous.



---

archive/issue_comments_069321.json:
```json
{
    "body": "Author: **Dan Drake, John Palmieri**",
    "created_at": "2010-06-14T09:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69321",
    "user": "https://github.com/qed777"
}
```

Author: **Dan Drake, John Palmieri**



---

archive/issue_comments_069322.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAttachment: **[trac_8641-doctest_exit_codes.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz)**\n\nReplying to [@qed777](#comment:13):\n\n> By the way, we may need to rebase these for #8891.\n\nI've attached a [combined, rebased patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz).",
    "created_at": "2010-06-14T09:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69322",
    "user": "https://github.com/qed777"
}
```

<div id="comment:15" align="right">comment:15</div>

Attachment: **[trac_8641-doctest_exit_codes.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz)**

Replying to [@qed777](#comment:13):

> By the way, we may need to rebase these for #8891.

I've attached a [combined, rebased patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz).



---

archive/issue_comments_069323.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@qed777](#comment:15):\n> Replying to [@qed777](#comment:13):\n> \n> > By the way, we may need to rebase these for #8891.\n\n> \n> I've attached a [combined, rebased patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz).\n\nHmm, on 4.4.4.alpha0, I get a hunk reject: on line 123 or so, my copy of sage-test says\n\n```\n   elif os.path.isdir(F) and not (F[:1] == '.') \\\n            and not '#' in F and not os.sep + 'notes' in F:\n```\nand your patch says\n\n```\n     elif (os.path.isdir(F) and  not '#' in F and\n           not os.sep + 'notes' in F):\n```\n...so somebody changed the backslash line continuation to parentheses. I'll manually fix the hunk and test your patch.",
    "created_at": "2010-06-15T02:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69323",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@qed777](#comment:15):
> Replying to [@qed777](#comment:13):
> 
> > By the way, we may need to rebase these for #8891.

> 
> I've attached a [combined, rebased patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz).

Hmm, on 4.4.4.alpha0, I get a hunk reject: on line 123 or so, my copy of sage-test says

```
   elif os.path.isdir(F) and not (F[:1] == '.') \
            and not '#' in F and not os.sep + 'notes' in F:
```
and your patch says

```
     elif (os.path.isdir(F) and  not '#' in F and
           not os.sep + 'notes' in F):
```
...so somebody changed the backslash line continuation to parentheses. I'll manually fix the hunk and test your patch.



---

archive/issue_comments_069324.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@qed777](#comment:15):\n> I've attached a [combined, rebased patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz).\n\nI fixed the hunk reject and your patch seems to work fine. The exit codes match up with what `sage-doctest` says (although I didn't check exit code 4, since I don't know how to make the doctesting framework raise an exception). I tried with individual files, directories, with and without \"-long\", so it seems to work pretty well on my Ubuntu machine.",
    "created_at": "2010-06-15T03:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69324",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@qed777](#comment:15):
> I've attached a [combined, rebased patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.patch.gz).

I fixed the hunk reject and your patch seems to work fine. The exit codes match up with what `sage-doctest` says (although I didn't check exit code 4, since I don't know how to make the doctesting framework raise an exception). I tried with individual files, directories, with and without "-long", so it seems to work pretty well on my Ubuntu machine.



---

archive/issue_comments_069325.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@dandrake](#comment:17):\n> I fixed the hunk reject and your patch seems to work fine. The exit codes match up with what `sage-doctest` says (although I didn't check exit code 4, since I don't know how to make the doctesting framework raise an exception). I tried with individual files, directories, with and without \"-long\", so it seems to work pretty well on my Ubuntu machine.\n\nI tested on bsd.math and the patch works there, too.",
    "created_at": "2010-06-15T05:03:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69325",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@dandrake](#comment:17):
> I fixed the hunk reject and your patch seems to work fine. The exit codes match up with what `sage-doctest` says (although I didn't check exit code 4, since I don't know how to make the doctesting framework raise an exception). I tried with individual files, directories, with and without "-long", so it seems to work pretty well on my Ubuntu machine.

I tested on bsd.math and the patch works there, too.



---

archive/issue_comments_069326.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@dandrake](#comment:17):\n> (although I didn't check exit code 4, since I don't know how to make the doctesting framework raise an exception).\n\nShould you still want to try, the example in ticket #7993 will trigger one of those.",
    "created_at": "2010-06-15T08:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69326",
    "user": "https://github.com/wjp"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@dandrake](#comment:17):
> (although I didn't check exit code 4, since I don't know how to make the doctesting framework raise an exception).

Should you still want to try, the example in ticket #7993 will trigger one of those.



---

archive/issue_comments_069327.json:
```json
{
    "body": "Attachment: **[trac_8641-doctest_exit_codes.2.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.2.patch.gz)**\n\nModify `sage-ptest`, too.  Apply to 4.4.4.alpha0 + #8891.  Apply only this patch.",
    "created_at": "2010-06-15T09:25:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69327",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_8641-doctest_exit_codes.2.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.2.patch.gz)**

Modify `sage-ptest`, too.  Apply to 4.4.4.alpha0 + #8891.  Apply only this patch.



---

archive/issue_comments_069328.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI've attached an attempt to get the same behavior for `sage -tp`.  The patch should apply to 4.4.4.alpha0 + #8891, unless I've `qfold`ed improperly.\n\nIt seems there's much room for improvement in `sage-ptest`.  For example, are the mutex locks really necessary?   I think both `skip` and `populatefilelist` run only in the main process.  But I suppose we could leave this and other potential oddities for #9224.",
    "created_at": "2010-06-15T09:35:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69328",
    "user": "https://github.com/qed777"
}
```

<div id="comment:20" align="right">comment:20</div>

I've attached an attempt to get the same behavior for `sage -tp`.  The patch should apply to 4.4.4.alpha0 + #8891, unless I've `qfold`ed improperly.

It seems there's much room for improvement in `sage-ptest`.  For example, are the mutex locks really necessary?   I think both `skip` and `populatefilelist` run only in the main process.  But I suppose we could leave this and other potential oddities for #9224.



---

archive/issue_events_108929.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-06-16T04:20:39Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "subject": "https://github.com/dandrake",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108929"
}
```



---

archive/issue_comments_069329.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nmpatel: on line 337 of sage-ptest and line 176 of sage-test, your patch (attachment:trac_8641-doctest_exit_codes.2.patch) always sets err = 2. Can you change that to\n\n```\n   err = 2 | err\n```\n? Then, if doctesting a bunch of files and hit ctrl-c, you can tell the difference between \"all the tests that ran passed\" and \"there was at least one doctest failure\". (And other errors that might have happened before you hit ctrl-c.)",
    "created_at": "2010-06-16T04:20:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69329",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:21" align="right">comment:21</div>

mpatel: on line 337 of sage-ptest and line 176 of sage-test, your patch (attachment:trac_8641-doctest_exit_codes.2.patch) always sets err = 2. Can you change that to

```
   err = 2 | err
```
? Then, if doctesting a bunch of files and hit ctrl-c, you can tell the difference between "all the tests that ran passed" and "there was at least one doctest failure". (And other errors that might have happened before you hit ctrl-c.)



---

archive/issue_comments_069330.json:
```json
{
    "body": "Use `err = err | 2` for `KeyboardInterrupt`.  Apply only this patch, to 4.4.4.alpha0 + #8891.",
    "created_at": "2010-06-16T07:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69330",
    "user": "https://github.com/qed777"
}
```

Use `err = err | 2` for `KeyboardInterrupt`.  Apply only this patch, to 4.4.4.alpha0 + #8891.



---

archive/issue_comments_069331.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAttachment: **[trac_8641-doctest_exit_codes.3.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz)**\n\nDone.  [V3](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz) uses `err = 2 | err` for `KeyboardInterrupt`s to both scripts.",
    "created_at": "2010-06-16T07:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69331",
    "user": "https://github.com/qed777"
}
```

<div id="comment:22" align="right">comment:22</div>

Attachment: **[trac_8641-doctest_exit_codes.3.patch.gz](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz)**

Done.  [V3](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz) uses `err = 2 | err` for `KeyboardInterrupt`s to both scripts.



---

archive/issue_comments_069332.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThis looks good, and I've used it a bunch and it works properly. But I'm listed as one of the authors, so perhaps I shouldn't flip it to positive review...wjp, can you look this over? I did check exit code 4 and that works properly.",
    "created_at": "2010-06-16T15:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69332",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:23" align="right">comment:23</div>

This looks good, and I've used it a bunch and it works properly. But I'm listed as one of the authors, so perhaps I shouldn't flip it to positive review...wjp, can you look this over? I did check exit code 4 and that works properly.



---

archive/issue_comments_069333.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI'll try to find time to take a proper look friday or this weekend, but at first glance it seems like my comment 12 about `SIGINT`/`KeyboardInterrupt` is still valid.",
    "created_at": "2010-06-17T21:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69333",
    "user": "https://github.com/wjp"
}
```

<div id="comment:24" align="right">comment:24</div>

I'll try to find time to take a proper look friday or this weekend, but at first glance it seems like my comment 12 about `SIGINT`/`KeyboardInterrupt` is still valid.



---

archive/issue_comments_069334.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@wjp](#comment:12):\n> [subprocess.call] does throw a KeyboardInterrupt itself when the called program gets a SIGINT, though, so we may have to catch that to execute the line\n> \n> ```\n> failed.append(sage_test_command(F)+\" # KeyboardInterrupt\")\n> ```\n\nHrm, I'm not sure this is true -- at least on my Ubuntu machine. With the most recent version of patch, I changed the bit starting at line 84 of sage-test to this:\n\n```\n  try:\n      err = call(s, shell=True)\n      print '%s returned code %s' % (s, err)\n  except KeyboardInterrupt:\n      print '*****sage-text line 87 caught keyboard interrupt'\n      raise\n```\nI then ran a doctest (combinat/words/finite_word.py) and in another terminal, sent the called process a SIGINT with\n\n```\nkill -2 `ps ax | grep finite_word | grep sage-doctest | grep python | awk '{print $1}'\n```\nThe result is:\n\n```\nsage -t  \"devel/sage/sage/combinat/words/finite_word.py\"\nKeyboardInterrupt -- interrupted after 3.37038588524 seconds!\n/home/drake/s/sage-4.4.4.alpha0-test/local/bin/sage-doctest  \"devel/sage/sage/combinat/words/finite_word.py\" returned code 2\nAborting further tests.\n```\nThe \"interrupted after 3.370...\" is from sage-doctest, line 668, which then exits with return code 2. It seems like subprocess.call in this instance notes that the process finished, and dutifully passes on the return code -- without raising a KeyboardInterrupt. Then, on line 95 the `failed.append(sage_test_command(F)+\" # KeyboardInterrupt\")` bit is executed and a KeyboardInterrupt is raised; that causes the \"Aborting further tests\" to be printed.\n\nIf I hit ctrl-c while running the doctest, it gets caught as you would expect:\n\n```\nsage -t  \"devel/sage/sage/combinat/words/finite_word.py\"\n^CKeyboardInterrupt -- interrupted after 2.75523304939 seconds!\n*****sage-text line 87 caught keyboard interrupt\nAborting further tests.\n```\n\nWhat is interesting is, if instead of sending SIGINT to the Python sage-doctest process, I send a SIGINT to the *shell* process created by subprocess.call, it seems to do nothing -- the doctest runs normally, finishes, but the return code is -2; this agrees with [the Popen returncode documentation](http://docs.python.org/library/subprocess.html#subprocess.Popen.returncode). Then, the entire process exits with return code 254, which is a bit strange, but at least it's indicating that something strange happened.",
    "created_at": "2010-06-18T03:17:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69334",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@wjp](#comment:12):
> [subprocess.call] does throw a KeyboardInterrupt itself when the called program gets a SIGINT, though, so we may have to catch that to execute the line
> 
> ```
> failed.append(sage_test_command(F)+" # KeyboardInterrupt")
> ```

Hrm, I'm not sure this is true -- at least on my Ubuntu machine. With the most recent version of patch, I changed the bit starting at line 84 of sage-test to this:

```
  try:
      err = call(s, shell=True)
      print '%s returned code %s' % (s, err)
  except KeyboardInterrupt:
      print '*****sage-text line 87 caught keyboard interrupt'
      raise
```
I then ran a doctest (combinat/words/finite_word.py) and in another terminal, sent the called process a SIGINT with

```
kill -2 `ps ax | grep finite_word | grep sage-doctest | grep python | awk '{print $1}'
```
The result is:

```
sage -t  "devel/sage/sage/combinat/words/finite_word.py"
KeyboardInterrupt -- interrupted after 3.37038588524 seconds!
/home/drake/s/sage-4.4.4.alpha0-test/local/bin/sage-doctest  "devel/sage/sage/combinat/words/finite_word.py" returned code 2
Aborting further tests.
```
The "interrupted after 3.370..." is from sage-doctest, line 668, which then exits with return code 2. It seems like subprocess.call in this instance notes that the process finished, and dutifully passes on the return code -- without raising a KeyboardInterrupt. Then, on line 95 the `failed.append(sage_test_command(F)+" # KeyboardInterrupt")` bit is executed and a KeyboardInterrupt is raised; that causes the "Aborting further tests" to be printed.

If I hit ctrl-c while running the doctest, it gets caught as you would expect:

```
sage -t  "devel/sage/sage/combinat/words/finite_word.py"
^CKeyboardInterrupt -- interrupted after 2.75523304939 seconds!
*****sage-text line 87 caught keyboard interrupt
Aborting further tests.
```

What is interesting is, if instead of sending SIGINT to the Python sage-doctest process, I send a SIGINT to the *shell* process created by subprocess.call, it seems to do nothing -- the doctest runs normally, finishes, but the return code is -2; this agrees with [the Popen returncode documentation](http://docs.python.org/library/subprocess.html#subprocess.Popen.returncode). Then, the entire process exits with return code 254, which is a bit strange, but at least it's indicating that something strange happened.



---

archive/issue_comments_069335.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nHm, you're right. I may have mixed up process IDs the previous time I tried.\n\nIn any case, it might make sense to explicitly catch this `KeyboardInterrupt`?. But it's not strictly necessary since it'll be caught on a higher level anyway. (It may be something to save for further doctesting cleanup patches.)\n\nI don't like the lines `err = err | test_file(F)`, `err = err | ret` and `err = err | 2`, though. They suggest that `err` is a bitmask or boolean, while it isn't. We could make it a bitmask, of course, so that 0 = all ok, 1 = failed tests, 2 = interrupted, 3 = failed tests and interrupted. Are there any other special cases we would want to consider in that case? Maybe a separate bit for timeouts? (See also #9316)",
    "created_at": "2010-06-27T10:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69335",
    "user": "https://github.com/wjp"
}
```

<div id="comment:26" align="right">comment:26</div>

Hm, you're right. I may have mixed up process IDs the previous time I tried.

In any case, it might make sense to explicitly catch this `KeyboardInterrupt`?. But it's not strictly necessary since it'll be caught on a higher level anyway. (It may be something to save for further doctesting cleanup patches.)

I don't like the lines `err = err | test_file(F)`, `err = err | ret` and `err = err | 2`, though. They suggest that `err` is a bitmask or boolean, while it isn't. We could make it a bitmask, of course, so that 0 = all ok, 1 = failed tests, 2 = interrupted, 3 = failed tests and interrupted. Are there any other special cases we would want to consider in that case? Maybe a separate bit for timeouts? (See also #9316)



---

archive/issue_events_108930.json:
```json
{
    "actor": "https://github.com/wjp",
    "created_at": "2010-07-06T20:45:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108930"
}
```



---

archive/issue_events_108931.json:
```json
{
    "actor": "https://github.com/wjp",
    "created_at": "2010-07-06T20:45:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108931"
}
```



---

archive/issue_comments_069336.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nMpatel pointed out that #9243 already tackles the powers-of-two thing.\n\nI'm giving this a positive review, provided that #9243 is merged too. (I'll review that ticket too.)",
    "created_at": "2010-07-06T20:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69336",
    "user": "https://github.com/wjp"
}
```

<div id="comment:27" align="right">comment:27</div>

Mpatel pointed out that #9243 already tackles the powers-of-two thing.

I'm giving this a positive review, provided that #9243 is merged too. (I'll review that ticket too.)



---

archive/issue_comments_069337.json:
```json
{
    "body": "Reviewer: **Willem Jan Palenstijn**",
    "created_at": "2010-07-07T03:10:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69337",
    "user": "https://github.com/qed777"
}
```

Reviewer: **Willem Jan Palenstijn**



---

archive/issue_comments_069338.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nTo release manager:  Apply just [attachment: trac_8641-doctest_exit_codes.3.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz) to 4.5.alpha4.",
    "created_at": "2010-07-07T03:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69338",
    "user": "https://github.com/qed777"
}
```

<div id="comment:29" align="right">comment:29</div>

To release manager:  Apply just [attachment: trac_8641-doctest_exit_codes.3.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz) to 4.5.alpha4.



---

archive/issue_comments_069339.json:
```json
{
    "body": "Changed author from **Dan Drake, John Palmieri** to **Dan Drake, John Palmieri, Mitesh Patel**",
    "created_at": "2010-07-07T03:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69339",
    "user": "https://github.com/qed777"
}
```

Changed author from **Dan Drake, John Palmieri** to **Dan Drake, John Palmieri, Mitesh Patel**



---

archive/issue_events_108932.json:
```json
{
    "actor": "https://github.com/wjp",
    "created_at": "2010-07-17T10:52:33Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108932"
}
```



---

archive/issue_events_108933.json:
```json
{
    "actor": "https://github.com/wjp",
    "created_at": "2010-07-17T10:52:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "milestone_number": null,
    "milestone_title": "sage-4.5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108933"
}
```



---

archive/issue_comments_069340.json:
```json
{
    "body": "Merged: **sage-4.5.2.alpha1**",
    "created_at": "2010-07-22T07:39:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69340",
    "user": "https://github.com/dandrake"
}
```

Merged: **sage-4.5.2.alpha1**



---

archive/issue_comments_069341.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nMerged [attachment: trac_8641-doctest_exit_codes.3.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz) in 4.5.2.alpha1.",
    "created_at": "2010-07-22T07:39:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8641#issuecomment-69341",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:31" align="right">comment:31</div>

Merged [attachment: trac_8641-doctest_exit_codes.3.patch](https://github.com/sagemath/sage/files/ticket8641/trac_8641-doctest_exit_codes.3.patch.gz) in 4.5.2.alpha1.



---

archive/issue_events_108934.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-07-22T07:39:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108934"
}
```



---

archive/issue_events_108935.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-07-22T07:39:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8641",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8641#event-108935"
}
```
