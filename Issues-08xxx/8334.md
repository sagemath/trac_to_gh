# Issue 8334: Improvements to residue fields

archive/issues_008334.json:
```json
{
    "body": "Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).\n\nDepends on #7883, #9898, #9753, #9764. Prerequisite for #8335.\n\n**Assignee:** @aghitza\n\n**CC:**  @williamstein\n\n**Reviewer:** David Loeffler\n\n**Author:** David Roe\n\n**Merged:** sage-4.6.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/8334\n\n",
    "closed_at": "2010-09-28T10:56:59Z",
    "created_at": "2010-02-23T15:16:53Z",
    "labels": [
        "component: algebra",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6",
    "title": "Improvements to residue fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8334",
    "user": "https://github.com/roed314"
}
```
Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).

Depends on #7883, #9898, #9753, #9764. Prerequisite for #8335.

**Assignee:** @aghitza

**CC:**  @williamstein

**Reviewer:** David Loeffler

**Author:** David Roe

**Merged:** sage-4.6.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/8334





---

archive/attachments_010313.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "7585_9_1_frac_and_coerce_updates.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/7585_9_1_frac_and_coerce_updates.patch",
    "created_at": "2010-02-23T15:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_067052.json:
```json
{
    "body": "Apply after other patch",
    "created_at": "2010-02-23T15:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67052",
    "user": "https://github.com/roed314"
}
```

Apply after other patch



---

archive/attachments_010314.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "8334_residue_fields.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/8334_residue_fields.patch",
    "created_at": "2010-02-23T15:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_067053.json:
```json
{
    "body": "Fixes various bugs and doctest failures introduced in earlier patches.",
    "created_at": "2010-02-23T15:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67053",
    "user": "https://github.com/roed314"
}
```

Fixes various bugs and doctest failures introduced in earlier patches.



---

archive/attachments_010315.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "7585_12_1_fixes.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/7585_12_1_fixes.patch",
    "created_at": "2010-02-23T17:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_067054.json:
```json
{
    "body": "<a id='comment:1'></a>\nPart of a series:\n\n```\n8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> 8335\n```\nI tried to make each of these mostly self contained, with doctests passing after every ticket, but I didn't entirely succeed.  If you're reviewing one of these tickets, applying later tickets will hopefully fix doctest failures that you're seeing.",
    "created_at": "2010-02-23T17:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67054",
    "user": "https://github.com/roed314"
}
```

<a id='comment:1'></a>
Part of a series:

```
8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> 8335
```
I tried to make each of these mostly self contained, with doctests passing after every ticket, but I didn't entirely succeed.  If you're reviewing one of these tickets, applying later tickets will hopefully fix doctest failures that you're seeing.



---

archive/issue_events_058525.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T17:37:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58525"
}
```



---

archive/issue_comments_067055.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).\n+\n+Depends on 8218, 8332, 7880, 7883, 8333\n``````\n",
    "created_at": "2010-02-23T17:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67055",
    "user": "https://github.com/roed314"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).
+
+Depends on 8218, 8332, 7880, 7883, 8333
``````




---

archive/issue_comments_067056.json:
```json
{
    "body": "<a id='comment:3'></a>\nFWIW, testing with this and all the prior patches in the series applied under 4.3.4.rc0 brings up exactly 1 doctest failure, in line 321 of sage/rings/finite_rings/finite_field_givaro.py:\n\n```\nFile \"/home/masiao/sage-4.3.4.rc0/devel/sage-working/sage/rings/finite_rings/finite_field_\ngivaro.py\", line 321:\n    sage: F81(F9.gen())\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: unable to coerce from a finite field other than the prime subfield\nGot:\n    Traceback (most recent call last):\n      File \"/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py\", line 1231, in run_one_te\nst\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/masiao/sage-4.3.4.rc0/local/bin/sagedoctest.py\", line 38, in run_one_exa\nmple\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py\", line 1172, in run_one_ex\nample\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_6[49]>\", line 1, in <module>\n        F81(F9.gen())###line 321:\n    sage: F81(F9.gen())\n      File \"parent.pyx\", line 826, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6232)\n      File \"parent.pyx\", line 1876, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:12773)\n      File \"parent.pyx\", line 1883, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:12925)\n      File \"parent.pyx\", line 1740, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:11546)\n      File \"parent.pyx\", line 1791, in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:11946)\n      File \"parent_old.pyx\", line 503, in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:5943)\n      File \"/home/masiao/sage-4.3.4.rc0/local/lib/python/site-packages/sage/rings/finite_rings/finite_field_givaro.py\", line 350, in _coerce_map_from_\n        raise NotImplementedError\n    NotImplementedError\n```",
    "created_at": "2010-03-18T17:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67056",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:3'></a>
FWIW, testing with this and all the prior patches in the series applied under 4.3.4.rc0 brings up exactly 1 doctest failure, in line 321 of sage/rings/finite_rings/finite_field_givaro.py:

```
File "/home/masiao/sage-4.3.4.rc0/devel/sage-working/sage/rings/finite_rings/finite_field_
givaro.py", line 321:
    sage: F81(F9.gen())
Expected:
    Traceback (most recent call last):
    ...
    TypeError: unable to coerce from a finite field other than the prime subfield
Got:
    Traceback (most recent call last):
      File "/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py", line 1231, in run_one_te
st
        self.run_one_example(test, example, filename, compileflags)
      File "/home/masiao/sage-4.3.4.rc0/local/bin/sagedoctest.py", line 38, in run_one_exa
mple
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py", line 1172, in run_one_ex
ample
        compileflags, 1) in test.globs
      File "<doctest __main__.example_6[49]>", line 1, in <module>
        F81(F9.gen())###line 321:
    sage: F81(F9.gen())
      File "parent.pyx", line 826, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6232)
      File "parent.pyx", line 1876, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:12773)
      File "parent.pyx", line 1883, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:12925)
      File "parent.pyx", line 1740, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:11546)
      File "parent.pyx", line 1791, in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:11946)
      File "parent_old.pyx", line 503, in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:5943)
      File "/home/masiao/sage-4.3.4.rc0/local/lib/python/site-packages/sage/rings/finite_rings/finite_field_givaro.py", line 350, in _coerce_map_from_
        raise NotImplementedError
    NotImplementedError
```



---

archive/issue_events_058526.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-18T17:18:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58526"
}
```



---

archive/issue_events_058527.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-18T17:18:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58527"
}
```



---

archive/attachments_010316.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "8334_residue_fields-rebased_for_8446.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/8334_residue_fields-rebased_for_8446.patch",
    "created_at": "2010-04-20T10:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_067057.json:
```json
{
    "body": "apply instead of 8334_residue_fields.patch -- rebased to apply after #8446",
    "created_at": "2010-04-20T10:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67057",
    "user": "https://github.com/loefflerd"
}
```

apply instead of 8334_residue_fields.patch -- rebased to apply after #8446



---

archive/issue_comments_067058.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe patch conflicts with #8446, so I've uploaded a rebased version.",
    "created_at": "2010-04-20T10:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67058",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:4'></a>
The patch conflicts with #8446, so I've uploaded a rebased version.



---

archive/issue_comments_067059.json:
```json
{
    "body": "<a id='comment:5'></a>\nApply:\n\n```\n7585_9_1_frac_and_coerce_updates.patch\n8334_residue_fields-rebased_for_8446.patch\n7585_12_1_fixes.patch.2\n```",
    "created_at": "2010-09-19T13:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67059",
    "user": "https://github.com/roed314"
}
```

<a id='comment:5'></a>
Apply:

```
7585_9_1_frac_and_coerce_updates.patch
8334_residue_fields-rebased_for_8446.patch
7585_12_1_fixes.patch.2
```



---

archive/issue_events_058528.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-19T13:17:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58528"
}
```



---

archive/issue_events_058529.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-19T13:17:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58529"
}
```



---

archive/issue_comments_067060.json:
```json
{
    "body": "**Work_Issues:** conflicts",
    "created_at": "2010-09-23T14:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67060",
    "user": "https://github.com/loefflerd"
}
```

**Work_Issues:** conflicts



---

archive/issue_comments_067061.json:
```json
{
    "body": "<a id='comment:6'></a>\nIt doesn't work. On vanilla 4.6.alpha1, if I apply \n\n```\n7883_ideals.patch\n7883_fixes.patch\n8333_parent_init.patch\n8333_finite_fields_to_new_coercion.2.patch\n7585_9_1_frac_and_coerce_updates.patch\n8334_residue_fields-rebased_for_8446.patch\n```\nthen the first five apply (with minor fuzz) but the last one is completely knackered, with 23 out of 27 hunks failing. I think the problem is caused by #9343/#9400 which both make extensive changes to residue fields.\n\nJust a general observation: you've managed to virtually guarantee that these patches are impossible to review, because they're all linked together in such a way that they fail doctests unless you apply the whole series. So the effect is a huge patch bomb, which is unappealing to review; hence it sits around for ages, and inevitably bitrots. Please, please, please back-port the doctest fixes etc, so each ticket in the series passes doctests on its own. Otherwise this will really never get merged and all of your hard work writing this excellent code (not to mention the work of those who have attempted to review it) will be for nothing.",
    "created_at": "2010-09-23T14:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67061",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:6'></a>
It doesn't work. On vanilla 4.6.alpha1, if I apply 

```
7883_ideals.patch
7883_fixes.patch
8333_parent_init.patch
8333_finite_fields_to_new_coercion.2.patch
7585_9_1_frac_and_coerce_updates.patch
8334_residue_fields-rebased_for_8446.patch
```
then the first five apply (with minor fuzz) but the last one is completely knackered, with 23 out of 27 hunks failing. I think the problem is caused by #9343/#9400 which both make extensive changes to residue fields.

Just a general observation: you've managed to virtually guarantee that these patches are impossible to review, because they're all linked together in such a way that they fail doctests unless you apply the whole series. So the effect is a huge patch bomb, which is unappealing to review; hence it sits around for ages, and inevitably bitrots. Please, please, please back-port the doctest fixes etc, so each ticket in the series passes doctests on its own. Otherwise this will really never get merged and all of your hard work writing this excellent code (not to mention the work of those who have attempted to review it) will be for nothing.



---

archive/issue_events_058530.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-23T14:24:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58530"
}
```



---

archive/issue_events_058531.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-23T14:24:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58531"
}
```



---

archive/issue_comments_067062.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).\n \n-Depends on 8218, 8332, 7880, 7883, 8333\n+Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.\n``````\n",
    "created_at": "2010-09-23T14:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67062",
    "user": "https://github.com/loefflerd"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).
 
-Depends on 8218, 8332, 7880, 7883, 8333
+Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.
``````




---

archive/attachments_010317.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "8334_residue_fields-rebased_for_9343.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/8334_residue_fields-rebased_for_9343.patch",
    "created_at": "2010-09-23T16:35:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_067063.json:
```json
{
    "body": "Rebased against 4.6.alpha1",
    "created_at": "2010-09-23T16:35:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67063",
    "user": "https://github.com/roed314"
}
```

Rebased against 4.6.alpha1



---

archive/issue_events_058532.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:45:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58532"
}
```



---

archive/issue_events_058533.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:45:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58533"
}
```



---

archive/issue_comments_067064.json:
```json
{
    "body": "<a id='comment:8'></a>\nI'm sorry that this has been so difficult to review.  I've tended to work in chunks: I just start ripping things apart and changing lots of stuff, and then I need to fix it all; by the time I've managed to make all the doctests pass it's turned into a patch-bomb.  I've tried to split things into logically consistent chunks, but it's really frustrating trying to backport fixes.  I also really shouldn't be working on Sage right now: I should be working on my thesis, which has nothing to do with this.\n\nI've tried to get these tickets working against 4.6.alpha1 (in particular, I think they should now).  If they don't get reviewed, I'll try your approach.  In the mean time, the sequence of patches should be \n\n```\n7883_ideals.patch\n7883_fixes.patch\n8333_parent_init.patch\n8333_finite_fields_to_new_coercion.2.patch\n7585_9_1_frac_and_coerce_updates.patch\n8334_residue_fields-rebased_for_9343.patch\n7585_12_1_fixes.2.patch\n```",
    "created_at": "2010-09-23T16:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67064",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>
I'm sorry that this has been so difficult to review.  I've tended to work in chunks: I just start ripping things apart and changing lots of stuff, and then I need to fix it all; by the time I've managed to make all the doctests pass it's turned into a patch-bomb.  I've tried to split things into logically consistent chunks, but it's really frustrating trying to backport fixes.  I also really shouldn't be working on Sage right now: I should be working on my thesis, which has nothing to do with this.

I've tried to get these tickets working against 4.6.alpha1 (in particular, I think they should now).  If they don't get reviewed, I'll try your approach.  In the mean time, the sequence of patches should be 

```
7883_ideals.patch
7883_fixes.patch
8333_parent_init.patch
8333_finite_fields_to_new_coercion.2.patch
7585_9_1_frac_and_coerce_updates.patch
8334_residue_fields-rebased_for_9343.patch
7585_12_1_fixes.2.patch
```



---

archive/issue_events_058534.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:52:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58534"
}
```



---

archive/issue_events_058535.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:52:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58535"
}
```



---

archive/issue_comments_067065.json:
```json
{
    "body": "<a id='comment:9'></a>\ngah.  Manual merge doesn't build.  Working on it...",
    "created_at": "2010-09-23T16:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67065",
    "user": "https://github.com/roed314"
}
```

<a id='comment:9'></a>
gah.  Manual merge doesn't build.  Working on it...



---

archive/issue_comments_067066.json:
```json
{
    "body": "Fixed merge error; apply against 4.6.alpha1",
    "created_at": "2010-09-23T16:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67066",
    "user": "https://github.com/roed314"
}
```

Fixed merge error; apply against 4.6.alpha1



---

archive/attachments_010318.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "7585_12_1_fixes.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/7585_12_1_fixes.2.patch",
    "created_at": "2010-09-23T16:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_067067.json:
```json
{
    "body": "<a id='comment:10'></a>\nForgot to delete 4 lines.  I'm still building, but the build has progressed past `residue_field.pyx`.",
    "created_at": "2010-09-23T16:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67067",
    "user": "https://github.com/roed314"
}
```

<a id='comment:10'></a>
Forgot to delete 4 lines.  I'm still building, but the build has progressed past `residue_field.pyx`.



---

archive/issue_comments_067068.json:
```json
{
    "body": "<a id='comment:11'></a>\nI'm getting weird doctest failures, as if some of the changes in 7883_ideals.patch didn't get applied.  Then I switched to my main branch and now Pari segfaults upon sage starting up.\n\nI'm going to install a fresh copy of sage-4.6.alpha1, which will take a few hours, and try to figure out what's going on.",
    "created_at": "2010-09-23T17:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67068",
    "user": "https://github.com/roed314"
}
```

<a id='comment:11'></a>
I'm getting weird doctest failures, as if some of the changes in 7883_ideals.patch didn't get applied.  Then I switched to my main branch and now Pari segfaults upon sage starting up.

I'm going to install a fresh copy of sage-4.6.alpha1, which will take a few hours, and try to figure out what's going on.



---

archive/issue_comments_067069.json:
```json
{
    "body": "<a id='comment:12'></a>\nWould you mind basing your updated patch series on my folded patch at #7883, the one I gave a positive review to, rather than on your original patches (as you seem to have done judging by your comment 8)? Then we can treat the #7883 stuff as finished and fixed.\n\nDavid",
    "created_at": "2010-09-23T20:52:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67069",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:12'></a>
Would you mind basing your updated patch series on my folded patch at #7883, the one I gave a positive review to, rather than on your original patches (as you seem to have done judging by your comment 8)? Then we can treat the #7883 stuff as finished and fixed.

David



---

archive/issue_comments_067070.json:
```json
{
    "body": "<a id='comment:13'></a>\nsure",
    "created_at": "2010-09-23T22:46:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67070",
    "user": "https://github.com/roed314"
}
```

<a id='comment:13'></a>
sure



---

archive/issue_comments_067071.json:
```json
{
    "body": "Includes all patches in 8333 and 8334; based on 4.6.alpha1 with 7883",
    "created_at": "2010-09-24T14:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67071",
    "user": "https://github.com/roed314"
}
```

Includes all patches in 8333 and 8334; based on 4.6.alpha1 with 7883



---

archive/issue_events_058536.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-24T14:30:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58536"
}
```



---

archive/issue_events_058537.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-24T14:30:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58537"
}
```



---

archive/attachments_010319.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "8333_8334_ALL.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/8333_8334_ALL.patch",
    "created_at": "2010-09-24T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/roed314"
}
```



---

archive/issue_comments_067072.json:
```json
{
    "body": "<a id='comment:14'></a>\nYou now only need to apply one patch.",
    "created_at": "2010-09-24T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67072",
    "user": "https://github.com/roed314"
}
```

<a id='comment:14'></a>
You now only need to apply one patch.



---

archive/issue_comments_067073.json:
```json
{
    "body": "<a id='comment:15'></a>\nAll doctests pass for me, though I didn't run -long (it already takes a couple hours on my laptop)",
    "created_at": "2010-09-24T14:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67073",
    "user": "https://github.com/roed314"
}
```

<a id='comment:15'></a>
All doctests pass for me, though I didn't run -long (it already takes a couple hours on my laptop)



---

archive/issue_comments_067074.json:
```json
{
    "body": "<a id='comment:16'></a>\nSadly this conflicts with the positively-reviewed patch series #9898/#9753/#9764.\n\nI will handle rebasing it past those. You can sit back and relax. Thanks for all your sterling efforts on this particularly frustrating job. I have access to a very fast computer (from Bill Hart's research grant, thanks Bill) which runs long tests in about 10 minutes :-)",
    "created_at": "2010-09-24T14:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67074",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:16'></a>
Sadly this conflicts with the positively-reviewed patch series #9898/#9753/#9764.

I will handle rebasing it past those. You can sit back and relax. Thanks for all your sterling efforts on this particularly frustrating job. I have access to a very fast computer (from Bill Hart's research grant, thanks Bill) which runs long tests in about 10 minutes :-)



---

archive/issue_comments_067075.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks.  That's especially useful since I just broke my mercurial queues trying to switch back to a more finely grained set of patches than `8333_8334_ALL.patch`.  Oh well, I'll just tell Mercurial that there are no patches there and both it and sage will be happy.",
    "created_at": "2010-09-24T14:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67075",
    "user": "https://github.com/roed314"
}
```

<a id='comment:17'></a>
Thanks.  That's especially useful since I just broke my mercurial queues trying to switch back to a more finely grained set of patches than `8333_8334_ALL.patch`.  Oh well, I'll just tell Mercurial that there are no patches there and both it and sage will be happy.



---

archive/attachments_010320.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "8333_8334_ALL-rebased_for_9764.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/8333_8334_ALL-rebased_for_9764.patch",
    "created_at": "2010-09-24T15:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_067076.json:
```json
{
    "body": "Apply only this patch -- see comment below.",
    "created_at": "2010-09-24T15:23:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67076",
    "user": "https://github.com/loefflerd"
}
```

Apply only this patch -- see comment below.



---

archive/issue_comments_067077.json:
```json
{
    "body": "**Reviewer:** David Loeffler",
    "created_at": "2010-09-24T15:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67077",
    "user": "https://github.com/loefflerd"
}
```

**Reviewer:** David Loeffler



---

archive/issue_comments_067078.json:
```json
{
    "body": "<a id='comment:18'></a>\nRight, so I have rebased roed's last patch and uploaded my rebased patch as `8333_8334_ALL-rebased_for_9764.patch`. This patch will apply cleanly to 4.6.alpha1 on top of the folded patch from #7883 and the series #9898/#9753/#9764.\n\nThis patch incorporates everything from #8333 as well, so this is the only patch that needs to be applied to close both #8333 and this ticket.",
    "created_at": "2010-09-24T15:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67078",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:18'></a>
Right, so I have rebased roed's last patch and uploaded my rebased patch as `8333_8334_ALL-rebased_for_9764.patch`. This patch will apply cleanly to 4.6.alpha1 on top of the folded patch from #7883 and the series #9898/#9753/#9764.

This patch incorporates everything from #8333 as well, so this is the only patch that needs to be applied to close both #8333 and this ticket.



---

archive/issue_comments_067079.json:
```json
{
    "body": "**Changing work_issues** from \"conflicts\" to \"\".",
    "created_at": "2010-09-24T15:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67079",
    "user": "https://github.com/loefflerd"
}
```

**Changing work_issues** from "conflicts" to "".



---

archive/issue_events_058538.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-24T15:25:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58538"
}
```



---

archive/issue_events_058539.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-24T15:25:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58539"
}
```



---

archive/issue_comments_067080.json:
```json
{
    "body": "<a id='comment:19'></a>\nYay!  Thank you for your work on these patches.",
    "created_at": "2010-09-24T15:29:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67080",
    "user": "https://github.com/roed314"
}
```

<a id='comment:19'></a>
Yay!  Thank you for your work on these patches.



---

archive/issue_comments_067081.json:
```json
{
    "body": "<a id='comment:20'></a>\nIncidentally, are you running a 32-bit or a 64-bit machine? I don't have access to any 32-bit boxes. If you have access to a 32-bit machine, it would be great if you could do the following:\n\n- Install #9898/#9753/#9764 and test everything in sage/rings.\n- Then install #7883 and the combined patch from this ticket, and do sage/rings again.\n- Then install #9359 and repeat.\n\nI'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)",
    "created_at": "2010-09-24T15:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67081",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:20'></a>
Incidentally, are you running a 32-bit or a 64-bit machine? I don't have access to any 32-bit boxes. If you have access to a 32-bit machine, it would be great if you could do the following:

- Install #9898/#9753/#9764 and test everything in sage/rings.
- Then install #7883 and the combined patch from this ticket, and do sage/rings again.
- Then install #9359 and repeat.

I'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)



---

archive/issue_comments_067082.json:
```json
{
    "body": "<a id='comment:21'></a>\nIn fact, I can think of one hashing doctest which will fail on a 32-bit machine.  Unfortunately I'm running on 64-bit.",
    "created_at": "2010-09-24T15:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67082",
    "user": "https://github.com/roed314"
}
```

<a id='comment:21'></a>
In fact, I can think of one hashing doctest which will fail on a 32-bit machine.  Unfortunately I'm running on 64-bit.



---

archive/issue_comments_067083.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [davidloeffler](#comment%3A20):\n> - Install #9898/#9753/#9764 and test everything in sage/rings.\n> - Then install #7883 and the combined patch from this ticket, and do sage/rings again.\n> - Then install #9359 and repeat.\n> \n> I'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)\n\n\nI will do this (and should have done it for my patches).",
    "created_at": "2010-09-25T09:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67083",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [davidloeffler](#comment%3A20):
> - Install #9898/#9753/#9764 and test everything in sage/rings.
> - Then install #7883 and the combined patch from this ticket, and do sage/rings again.
> - Then install #9359 and repeat.
> 
> I'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)


I will do this (and should have done it for my patches).



---

archive/issue_comments_067084.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).\n+Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).\n \n-Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.\n+Depends on #7883, #9898, #9753, #9764. Prerequisite for #8335.\n``````\n",
    "created_at": "2010-09-25T10:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67084",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).
+Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).
 
-Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.
+Depends on #7883, #9898, #9753, #9764. Prerequisite for #8335.
``````




---

archive/issue_comments_067085.json:
```json
{
    "body": "<a id='comment:24'></a>\nI have testing the following chain of patches on a 32-bit PPC machine:\n\n```\ntrac_7883-ideals-folded.patch\n9898_pari_decl.patch\n9753.patch\n9764_ideal_repr_new.patch\n8333_8334_ALL-rebased_for_9764.patch\n```\n\nThe only failure was in `sage/schemes/generic/toric_divisor.py`, which is a known problem.",
    "created_at": "2010-09-26T10:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67085",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
I have testing the following chain of patches on a 32-bit PPC machine:

```
trac_7883-ideals-folded.patch
9898_pari_decl.patch
9753.patch
9764_ideal_repr_new.patch
8333_8334_ALL-rebased_for_9764.patch
```

The only failure was in `sage/schemes/generic/toric_divisor.py`, which is a known problem.



---

archive/issue_comments_067086.json:
```json
{
    "body": "<a id='comment:25'></a>\nCould someone please update the commit string of [attachment:8333_8334_ALL-rebased_for_9764.patch] so its first line is a < 80 (or so) character summary that includes the ticket number, then restore the positive review?  Additional lines are no problem, of course.",
    "created_at": "2010-09-28T09:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67086",
    "user": "https://github.com/qed777"
}
```

<a id='comment:25'></a>
Could someone please update the commit string of [attachment:8333_8334_ALL-rebased_for_9764.patch] so its first line is a < 80 (or so) character summary that includes the ticket number, then restore the positive review?  Additional lines are no problem, of course.



---

archive/issue_events_058540.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T09:41:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58540"
}
```



---

archive/issue_events_058541.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T09:41:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58541"
}
```



---

archive/attachments_010321.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "8333_8334_ALL-better_commit_string.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket8334/8333_8334_ALL-better_commit_string.patch",
    "created_at": "2010-09-28T10:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_067087.json:
```json
{
    "body": "Version with better commit string.",
    "created_at": "2010-09-28T10:18:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67087",
    "user": "https://github.com/loefflerd"
}
```

Version with better commit string.



---

archive/issue_events_058542.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-28T10:19:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58542"
}
```



---

archive/issue_events_058543.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-28T10:19:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58543"
}
```



---

archive/issue_comments_067088.json:
```json
{
    "body": "<a id='comment:26'></a>\nDone.",
    "created_at": "2010-09-28T10:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67088",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:26'></a>
Done.



---

archive/issue_events_058544.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T10:56:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58544"
}
```



---

archive/issue_events_058545.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T10:56:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8334#event-58545"
}
```



---

archive/issue_comments_067089.json:
```json
{
    "body": "**Merged:** sage-4.6.alpha2",
    "created_at": "2010-09-28T10:56:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67089",
    "user": "https://github.com/qed777"
}
```

**Merged:** sage-4.6.alpha2



---

archive/issue_comments_067090.json:
```json
{
    "body": "<a id='comment:28'></a>\nThis seems to have sorted #9409, which needs a reviewer to verify my check.",
    "created_at": "2010-10-03T16:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67090",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:28'></a>
This seems to have sorted #9409, which needs a reviewer to verify my check.



---

archive/issue_comments_067091.json:
```json
{
    "body": "<a id='comment:29'></a>\nDavid, I'm not very satisfied with the change in `french_book/numbertheory.py` done by this patch, for two reasons:\n\n(1) the previous error message was better. (In the book we wanted to show that the isomorphism\n    between two instances of GF(3<sup>2</sup>) is not automatic in Sage.)\n\n(2) this is more serious. We have put this doctest in Sage so that the examples of our book (which\n    is now published) still work with future versions of Sage. By changing the error message you\n    did break the examples on http://sagebook.gforge.inria.fr/. Moreover you did not even contact\n    us to discuss this change.\n\nFor (1) is it possible to revert to the previous error message?\n\nFor (2) in case you want to change some file in the tests directory, please first inform the\ncorresponding author.\n\nPaul Zimmermann",
    "created_at": "2011-11-23T09:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67091",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:29'></a>
David, I'm not very satisfied with the change in `french_book/numbertheory.py` done by this patch, for two reasons:

(1) the previous error message was better. (In the book we wanted to show that the isomorphism
    between two instances of GF(3<sup>2</sup>) is not automatic in Sage.)

(2) this is more serious. We have put this doctest in Sage so that the examples of our book (which
    is now published) still work with future versions of Sage. By changing the error message you
    did break the examples on http://sagebook.gforge.inria.fr/. Moreover you did not even contact
    us to discuss this change.

For (1) is it possible to revert to the previous error message?

For (2) in case you want to change some file in the tests directory, please first inform the
corresponding author.

Paul Zimmermann



---

archive/issue_comments_067092.json:
```json
{
    "body": "<a id='comment:30'></a>\nPaul: I'm sorry, I didn't mean to break anything -- I didn't know there was an official policy of not making changes to the tests directory. Can you point me to where this policy is explicitly written down?",
    "created_at": "2011-11-23T10:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67092",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:30'></a>
Paul: I'm sorry, I didn't mean to break anything -- I didn't know there was an official policy of not making changes to the tests directory. Can you point me to where this policy is explicitly written down?



---

archive/issue_comments_067093.json:
```json
{
    "body": "<a id='comment:31'></a>\nDavid (Loeffler), I didn't write to you, but to David Roe... You are just the reviewer.\nThis policy is explained in http://groups.google.com/group/sage-support/msg/3ea7ed2eeab0824a :\n\n```\n\nNote that you could also submit a patch to Sage with the code you're doctesting.\nI did that with all the tests from both of the books I published, and\nI encourage you and many others to do the same with the code from your\narticle.  The code would go in a file\n\n    devel/sage/sage/tests/\n\nlike the file devel/sage/sage/tests/book_stein_modform.py\n\nIn fact, I could imagine having dozens of files in that directory, and\nwhen doctests break there, we could notify the authors before\nreleasing the version of Sage that breaks their doctests for feedback\n-- then they could update their papers or Sage.\n```\n\nMy personal opinion is that \"we could notify\" should read \"we should notify\"...\n\nPaul",
    "created_at": "2011-11-23T10:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67093",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:31'></a>
David (Loeffler), I didn't write to you, but to David Roe... You are just the reviewer.
This policy is explained in http://groups.google.com/group/sage-support/msg/3ea7ed2eeab0824a :

```

Note that you could also submit a patch to Sage with the code you're doctesting.
I did that with all the tests from both of the books I published, and
I encourage you and many others to do the same with the code from your
article.  The code would go in a file

    devel/sage/sage/tests/

like the file devel/sage/sage/tests/book_stein_modform.py

In fact, I could imagine having dozens of files in that directory, and
when doctests break there, we could notify the authors before
releasing the version of Sage that breaks their doctests for feedback
-- then they could update their papers or Sage.
```

My personal opinion is that "we could notify" should read "we should notify"...

Paul



---

archive/issue_comments_067094.json:
```json
{
    "body": "<a id='comment:32'></a>\nSorry for the change to the tests folder.  When I split up a patchbomb into #8334 and #8335 (among others), I changed some errors to `NotImplementedError` for coercions that would soon work in #8335.  Unfortunately that ticket has stagnated.\n\nWhile I'm working on fixing #8335, I've made a new ticket (#12084) that restores the original `TypeError`.  It's ready for review.  Sorry for the trouble, and I'll be more careful with the `sage/tests` directory in the future.",
    "created_at": "2011-11-25T21:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67094",
    "user": "https://github.com/roed314"
}
```

<a id='comment:32'></a>
Sorry for the change to the tests folder.  When I split up a patchbomb into #8334 and #8335 (among others), I changed some errors to `NotImplementedError` for coercions that would soon work in #8335.  Unfortunately that ticket has stagnated.

While I'm working on fixing #8335, I've made a new ticket (#12084) that restores the original `TypeError`.  It's ready for review.  Sorry for the trouble, and I'll be more careful with the `sage/tests` directory in the future.



---

archive/issue_comments_067095.json:
```json
{
    "body": "<a id='comment:33'></a>\nWhat's with all the commented-out doctests added here? See #16946.",
    "created_at": "2014-09-08T20:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8334#issuecomment-67095",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
What's with all the commented-out doctests added here? See #16946.
