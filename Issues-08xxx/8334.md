# Issue 8334: Improvements to residue fields

archive/issues_008334.json:
```json
{
    "assignees": [],
    "body": "Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).\n\nDepends on #7883, #9898, #9753, #9764. Prerequisite for #8335.\n\nAssignee: **@aghitza**\n\nCC:  @williamstein\n\nReviewer: **David Loeffler**\n\nAuthor: **David Roe**\n\nMerged: **sage-4.6.alpha2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8334_\n\n",
    "closed_at": "2010-09-28T10:56:59Z",
    "created_at": "2010-02-23T15:16:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improvements to residue fields",
    "type": "issue",
    "updated_at": "2014-09-08T20:41:21Z",
    "url": "https://github.com/sagemath/sage/issues/8334",
    "user": "https://github.com/roed314"
}
```
Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).

Depends on #7883, #9898, #9753, #9764. Prerequisite for #8335.

Assignee: **@aghitza**

CC:  @williamstein

Reviewer: **David Loeffler**

Author: **David Roe**

Merged: **sage-4.6.alpha2**

_Issue created by migration from https://trac.sagemath.org/ticket/8334_





---

archive/issue_events_094761.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T15:16:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94761"
}
```



---

archive/issue_events_094762.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T15:16:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94762"
}
```



---

archive/issue_events_094763.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T15:16:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94763"
}
```



---

archive/issue_events_094764.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T15:16:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94764"
}
```



---

archive/issue_comments_067079.json:
```json
{
    "body": "Attachment: **[7585_9_1_frac_and_coerce_updates.patch.gz](https://github.com/sagemath/sage/files/ticket8334/7585_9_1_frac_and_coerce_updates.patch.gz)**\n\nApply after other patch",
    "created_at": "2010-02-23T15:22:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67079",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7585_9_1_frac_and_coerce_updates.patch.gz](https://github.com/sagemath/sage/files/ticket8334/7585_9_1_frac_and_coerce_updates.patch.gz)**

Apply after other patch



---

archive/issue_comments_067080.json:
```json
{
    "body": "Attachment: **[8334_residue_fields.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8334_residue_fields.patch.gz)**\n\nFixes various bugs and doctest failures introduced in earlier patches.",
    "created_at": "2010-02-23T15:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67080",
    "user": "https://github.com/roed314"
}
```

Attachment: **[8334_residue_fields.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8334_residue_fields.patch.gz)**

Fixes various bugs and doctest failures introduced in earlier patches.



---

archive/issue_comments_067081.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nAttachment: **[7585_12_1_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket8334/7585_12_1_fixes.patch.gz)**\n\nPart of a series:\n\n```\n8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> 8335\n```\nI tried to make each of these mostly self contained, with doctests passing after every ticket, but I didn't entirely succeed.  If you're reviewing one of these tickets, applying later tickets will hopefully fix doctest failures that you're seeing.",
    "created_at": "2010-02-23T17:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67081",
    "user": "https://github.com/roed314"
}
```

<div id="comment:1" align="right">Comment 1</div>

Attachment: **[7585_12_1_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket8334/7585_12_1_fixes.patch.gz)**

Part of a series:

```
8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> 8335
```
I tried to make each of these mostly self contained, with doctests passing after every ticket, but I didn't entirely succeed.  If you're reviewing one of these tickets, applying later tickets will hopefully fix doctest failures that you're seeing.



---

archive/issue_events_094765.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T17:37:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94765"
}
```



---

archive/issue_comments_067082.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).\n+\n+Depends on 8218, 8332, 7880, 7883, 8333\n``````\n",
    "created_at": "2010-02-23T17:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67082",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).
+
+Depends on 8218, 8332, 7880, 7883, 8333
``````




---

archive/issue_comments_067083.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nFWIW, testing with this and all the prior patches in the series applied under 4.3.4.rc0 brings up exactly 1 doctest failure, in line 321 of sage/rings/finite_rings/finite_field_givaro.py:\n\n```\nFile \"/home/masiao/sage-4.3.4.rc0/devel/sage-working/sage/rings/finite_rings/finite_field_\ngivaro.py\", line 321:\n    sage: F81(F9.gen())\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: unable to coerce from a finite field other than the prime subfield\nGot:\n    Traceback (most recent call last):\n      File \"/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py\", line 1231, in run_one_te\nst\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/masiao/sage-4.3.4.rc0/local/bin/sagedoctest.py\", line 38, in run_one_exa\nmple\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py\", line 1172, in run_one_ex\nample\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_6[49]>\", line 1, in <module>\n        F81(F9.gen())###line 321:\n    sage: F81(F9.gen())\n      File \"parent.pyx\", line 826, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6232)\n      File \"parent.pyx\", line 1876, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:12773)\n      File \"parent.pyx\", line 1883, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:12925)\n      File \"parent.pyx\", line 1740, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:11546)\n      File \"parent.pyx\", line 1791, in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:11946)\n      File \"parent_old.pyx\", line 503, in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:5943)\n      File \"/home/masiao/sage-4.3.4.rc0/local/lib/python/site-packages/sage/rings/finite_rings/finite_field_givaro.py\", line 350, in _coerce_map_from_\n        raise NotImplementedError\n    NotImplementedError\n```",
    "created_at": "2010-03-18T17:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67083",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:3" align="right">Comment 3</div>

FWIW, testing with this and all the prior patches in the series applied under 4.3.4.rc0 brings up exactly 1 doctest failure, in line 321 of sage/rings/finite_rings/finite_field_givaro.py:

```
File "/home/masiao/sage-4.3.4.rc0/devel/sage-working/sage/rings/finite_rings/finite_field_
givaro.py", line 321:
    sage: F81(F9.gen())
Expected:
    Traceback (most recent call last):
    ...
    TypeError: unable to coerce from a finite field other than the prime subfield
Got:
    Traceback (most recent call last):
      File "/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py", line 1231, in run_one_te
st
        self.run_one_example(test, example, filename, compileflags)
      File "/home/masiao/sage-4.3.4.rc0/local/bin/sagedoctest.py", line 38, in run_one_exa
mple
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/masiao/sage-4.3.4.rc0/local/bin/ncadoctest.py", line 1172, in run_one_ex
ample
        compileflags, 1) in test.globs
      File "<doctest __main__.example_6[49]>", line 1, in <module>
        F81(F9.gen())###line 321:
    sage: F81(F9.gen())
      File "parent.pyx", line 826, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6232)
      File "parent.pyx", line 1876, in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:12773)
      File "parent.pyx", line 1883, in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:12925)
      File "parent.pyx", line 1740, in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:11546)
      File "parent.pyx", line 1791, in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:11946)
      File "parent_old.pyx", line 503, in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:5943)
      File "/home/masiao/sage-4.3.4.rc0/local/lib/python/site-packages/sage/rings/finite_rings/finite_field_givaro.py", line 350, in _coerce_map_from_
        raise NotImplementedError
    NotImplementedError
```



---

archive/issue_events_094766.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-18T17:18:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94766"
}
```



---

archive/issue_events_094767.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-18T17:18:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94767"
}
```



---

archive/issue_comments_067084.json:
```json
{
    "body": "Attachment: **[8334_residue_fields-rebased_for_8446.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8334_residue_fields-rebased_for_8446.patch.gz)**\n\napply instead of 8334_residue_fields.patch -- rebased to apply after #8446",
    "created_at": "2010-04-20T10:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67084",
    "user": "https://github.com/loefflerd"
}
```

Attachment: **[8334_residue_fields-rebased_for_8446.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8334_residue_fields-rebased_for_8446.patch.gz)**

apply instead of 8334_residue_fields.patch -- rebased to apply after #8446



---

archive/issue_comments_067085.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThe patch conflicts with #8446, so I've uploaded a rebased version.",
    "created_at": "2010-04-20T10:16:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67085",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:4" align="right">Comment 4</div>

The patch conflicts with #8446, so I've uploaded a rebased version.



---

archive/issue_comments_067086.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nApply:\n\n```\n7585_9_1_frac_and_coerce_updates.patch\n8334_residue_fields-rebased_for_8446.patch\n7585_12_1_fixes.patch.2\n```",
    "created_at": "2010-09-19T13:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67086",
    "user": "https://github.com/roed314"
}
```

<div id="comment:5" align="right">Comment 5</div>

Apply:

```
7585_9_1_frac_and_coerce_updates.patch
8334_residue_fields-rebased_for_8446.patch
7585_12_1_fixes.patch.2
```



---

archive/issue_events_094768.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-19T13:17:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94768"
}
```



---

archive/issue_events_094769.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-19T13:17:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94769"
}
```



---

archive/issue_comments_067087.json:
```json
{
    "body": "Work Issues: **conflicts**",
    "created_at": "2010-09-23T14:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67087",
    "user": "https://github.com/loefflerd"
}
```

Work Issues: **conflicts**



---

archive/issue_comments_067088.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nIt doesn't work. On vanilla 4.6.alpha1, if I apply \n\n```\n7883_ideals.patch\n7883_fixes.patch\n8333_parent_init.patch\n8333_finite_fields_to_new_coercion.2.patch\n7585_9_1_frac_and_coerce_updates.patch\n8334_residue_fields-rebased_for_8446.patch\n```\nthen the first five apply (with minor fuzz) but the last one is completely knackered, with 23 out of 27 hunks failing. I think the problem is caused by #9343/#9400 which both make extensive changes to residue fields.\n\nJust a general observation: you've managed to virtually guarantee that these patches are impossible to review, because they're all linked together in such a way that they fail doctests unless you apply the whole series. So the effect is a huge patch bomb, which is unappealing to review; hence it sits around for ages, and inevitably bitrots. Please, please, please back-port the doctest fixes etc, so each ticket in the series passes doctests on its own. Otherwise this will really never get merged and all of your hard work writing this excellent code (not to mention the work of those who have attempted to review it) will be for nothing.",
    "created_at": "2010-09-23T14:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67088",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:6" align="right">Comment 6</div>

It doesn't work. On vanilla 4.6.alpha1, if I apply 

```
7883_ideals.patch
7883_fixes.patch
8333_parent_init.patch
8333_finite_fields_to_new_coercion.2.patch
7585_9_1_frac_and_coerce_updates.patch
8334_residue_fields-rebased_for_8446.patch
```
then the first five apply (with minor fuzz) but the last one is completely knackered, with 23 out of 27 hunks failing. I think the problem is caused by #9343/#9400 which both make extensive changes to residue fields.

Just a general observation: you've managed to virtually guarantee that these patches are impossible to review, because they're all linked together in such a way that they fail doctests unless you apply the whole series. So the effect is a huge patch bomb, which is unappealing to review; hence it sits around for ages, and inevitably bitrots. Please, please, please back-port the doctest fixes etc, so each ticket in the series passes doctests on its own. Otherwise this will really never get merged and all of your hard work writing this excellent code (not to mention the work of those who have attempted to review it) will be for nothing.



---

archive/issue_events_094770.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-23T14:24:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94770"
}
```



---

archive/issue_events_094771.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-23T14:24:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94771"
}
```



---

archive/issue_comments_067089.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).\n \n-Depends on 8218, 8332, 7880, 7883, 8333\n+Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.\n``````\n",
    "created_at": "2010-09-23T14:26:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67089",
    "user": "https://github.com/loefflerd"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).
 
-Depends on 8218, 8332, 7880, 7883, 8333
+Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.
``````




---

archive/issue_comments_067090.json:
```json
{
    "body": "Attachment: **[8334_residue_fields-rebased_for_9343.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8334_residue_fields-rebased_for_9343.patch.gz)**\n\nRebased against 4.6.alpha1",
    "created_at": "2010-09-23T16:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67090",
    "user": "https://github.com/roed314"
}
```

Attachment: **[8334_residue_fields-rebased_for_9343.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8334_residue_fields-rebased_for_9343.patch.gz)**

Rebased against 4.6.alpha1



---

archive/issue_events_094772.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:45:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94772"
}
```



---

archive/issue_events_094773.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:45:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94773"
}
```



---

archive/issue_comments_067091.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI'm sorry that this has been so difficult to review.  I've tended to work in chunks: I just start ripping things apart and changing lots of stuff, and then I need to fix it all; by the time I've managed to make all the doctests pass it's turned into a patch-bomb.  I've tried to split things into logically consistent chunks, but it's really frustrating trying to backport fixes.  I also really shouldn't be working on Sage right now: I should be working on my thesis, which has nothing to do with this.\n\nI've tried to get these tickets working against 4.6.alpha1 (in particular, I think they should now).  If they don't get reviewed, I'll try your approach.  In the mean time, the sequence of patches should be \n\n```\n7883_ideals.patch\n7883_fixes.patch\n8333_parent_init.patch\n8333_finite_fields_to_new_coercion.2.patch\n7585_9_1_frac_and_coerce_updates.patch\n8334_residue_fields-rebased_for_9343.patch\n7585_12_1_fixes.2.patch\n```",
    "created_at": "2010-09-23T16:45:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67091",
    "user": "https://github.com/roed314"
}
```

<div id="comment:8" align="right">Comment 8</div>

I'm sorry that this has been so difficult to review.  I've tended to work in chunks: I just start ripping things apart and changing lots of stuff, and then I need to fix it all; by the time I've managed to make all the doctests pass it's turned into a patch-bomb.  I've tried to split things into logically consistent chunks, but it's really frustrating trying to backport fixes.  I also really shouldn't be working on Sage right now: I should be working on my thesis, which has nothing to do with this.

I've tried to get these tickets working against 4.6.alpha1 (in particular, I think they should now).  If they don't get reviewed, I'll try your approach.  In the mean time, the sequence of patches should be 

```
7883_ideals.patch
7883_fixes.patch
8333_parent_init.patch
8333_finite_fields_to_new_coercion.2.patch
7585_9_1_frac_and_coerce_updates.patch
8334_residue_fields-rebased_for_9343.patch
7585_12_1_fixes.2.patch
```



---

archive/issue_events_094774.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:52:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94774"
}
```



---

archive/issue_events_094775.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-23T16:52:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94775"
}
```



---

archive/issue_comments_067092.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\ngah.  Manual merge doesn't build.  Working on it...",
    "created_at": "2010-09-23T16:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67092",
    "user": "https://github.com/roed314"
}
```

<div id="comment:9" align="right">Comment 9</div>

gah.  Manual merge doesn't build.  Working on it...



---

archive/issue_comments_067093.json:
```json
{
    "body": "Fixed merge error; apply against 4.6.alpha1",
    "created_at": "2010-09-23T16:56:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67093",
    "user": "https://github.com/roed314"
}
```

Fixed merge error; apply against 4.6.alpha1



---

archive/issue_comments_067094.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nAttachment: **[7585_12_1_fixes.2.patch.gz](https://github.com/sagemath/sage/files/ticket8334/7585_12_1_fixes.2.patch.gz)**\n\nForgot to delete 4 lines.  I'm still building, but the build has progressed past `residue_field.pyx`.",
    "created_at": "2010-09-23T16:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67094",
    "user": "https://github.com/roed314"
}
```

<div id="comment:10" align="right">Comment 10</div>

Attachment: **[7585_12_1_fixes.2.patch.gz](https://github.com/sagemath/sage/files/ticket8334/7585_12_1_fixes.2.patch.gz)**

Forgot to delete 4 lines.  I'm still building, but the build has progressed past `residue_field.pyx`.



---

archive/issue_comments_067095.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI'm getting weird doctest failures, as if some of the changes in 7883_ideals.patch didn't get applied.  Then I switched to my main branch and now Pari segfaults upon sage starting up.\n\nI'm going to install a fresh copy of sage-4.6.alpha1, which will take a few hours, and try to figure out what's going on.",
    "created_at": "2010-09-23T17:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67095",
    "user": "https://github.com/roed314"
}
```

<div id="comment:11" align="right">Comment 11</div>

I'm getting weird doctest failures, as if some of the changes in 7883_ideals.patch didn't get applied.  Then I switched to my main branch and now Pari segfaults upon sage starting up.

I'm going to install a fresh copy of sage-4.6.alpha1, which will take a few hours, and try to figure out what's going on.



---

archive/issue_comments_067096.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nWould you mind basing your updated patch series on my folded patch at #7883, the one I gave a positive review to, rather than on your original patches (as you seem to have done judging by your comment 8)? Then we can treat the #7883 stuff as finished and fixed.\n\nDavid",
    "created_at": "2010-09-23T20:52:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67096",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:12" align="right">Comment 12</div>

Would you mind basing your updated patch series on my folded patch at #7883, the one I gave a positive review to, rather than on your original patches (as you seem to have done judging by your comment 8)? Then we can treat the #7883 stuff as finished and fixed.

David



---

archive/issue_comments_067097.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nsure",
    "created_at": "2010-09-23T22:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67097",
    "user": "https://github.com/roed314"
}
```

<div id="comment:13" align="right">Comment 13</div>

sure



---

archive/issue_comments_067098.json:
```json
{
    "body": "Includes all patches in 8333 and 8334; based on 4.6.alpha1 with 7883",
    "created_at": "2010-09-24T14:27:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67098",
    "user": "https://github.com/roed314"
}
```

Includes all patches in 8333 and 8334; based on 4.6.alpha1 with 7883



---

archive/issue_events_094776.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-24T14:30:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94776"
}
```



---

archive/issue_events_094777.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-24T14:30:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94777"
}
```



---

archive/issue_comments_067099.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nAttachment: **[8333_8334_ALL.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL.patch.gz)**\n\nYou now only need to apply one patch.",
    "created_at": "2010-09-24T14:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67099",
    "user": "https://github.com/roed314"
}
```

<div id="comment:14" align="right">Comment 14</div>

Attachment: **[8333_8334_ALL.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL.patch.gz)**

You now only need to apply one patch.



---

archive/issue_comments_067100.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nAll doctests pass for me, though I didn't run -long (it already takes a couple hours on my laptop)",
    "created_at": "2010-09-24T14:31:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67100",
    "user": "https://github.com/roed314"
}
```

<div id="comment:15" align="right">Comment 15</div>

All doctests pass for me, though I didn't run -long (it already takes a couple hours on my laptop)



---

archive/issue_comments_067101.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nSadly this conflicts with the positively-reviewed patch series #9898/#9753/#9764.\n\nI will handle rebasing it past those. You can sit back and relax. Thanks for all your sterling efforts on this particularly frustrating job. I have access to a very fast computer (from Bill Hart's research grant, thanks Bill) which runs long tests in about 10 minutes :-)",
    "created_at": "2010-09-24T14:36:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67101",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:16" align="right">Comment 16</div>

Sadly this conflicts with the positively-reviewed patch series #9898/#9753/#9764.

I will handle rebasing it past those. You can sit back and relax. Thanks for all your sterling efforts on this particularly frustrating job. I have access to a very fast computer (from Bill Hart's research grant, thanks Bill) which runs long tests in about 10 minutes :-)



---

archive/issue_comments_067102.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nThanks.  That's especially useful since I just broke my mercurial queues trying to switch back to a more finely grained set of patches than `8333_8334_ALL.patch`.  Oh well, I'll just tell Mercurial that there are no patches there and both it and sage will be happy.",
    "created_at": "2010-09-24T14:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67102",
    "user": "https://github.com/roed314"
}
```

<div id="comment:17" align="right">Comment 17</div>

Thanks.  That's especially useful since I just broke my mercurial queues trying to switch back to a more finely grained set of patches than `8333_8334_ALL.patch`.  Oh well, I'll just tell Mercurial that there are no patches there and both it and sage will be happy.



---

archive/issue_comments_067103.json:
```json
{
    "body": "Attachment: **[8333_8334_ALL-rebased_for_9764.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL-rebased_for_9764.patch.gz)**\n\nApply only this patch -- see comment below.",
    "created_at": "2010-09-24T15:23:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67103",
    "user": "https://github.com/loefflerd"
}
```

Attachment: **[8333_8334_ALL-rebased_for_9764.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL-rebased_for_9764.patch.gz)**

Apply only this patch -- see comment below.



---

archive/issue_comments_067104.json:
```json
{
    "body": "Reviewer: **David Loeffler**",
    "created_at": "2010-09-24T15:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67104",
    "user": "https://github.com/loefflerd"
}
```

Reviewer: **David Loeffler**



---

archive/issue_comments_067105.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nRight, so I have rebased roed's last patch and uploaded my rebased patch as `8333_8334_ALL-rebased_for_9764.patch`. This patch will apply cleanly to 4.6.alpha1 on top of the folded patch from #7883 and the series #9898/#9753/#9764.\n\nThis patch incorporates everything from #8333 as well, so this is the only patch that needs to be applied to close both #8333 and this ticket.",
    "created_at": "2010-09-24T15:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67105",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:18" align="right">Comment 18</div>

Right, so I have rebased roed's last patch and uploaded my rebased patch as `8333_8334_ALL-rebased_for_9764.patch`. This patch will apply cleanly to 4.6.alpha1 on top of the folded patch from #7883 and the series #9898/#9753/#9764.

This patch incorporates everything from #8333 as well, so this is the only patch that needs to be applied to close both #8333 and this ticket.



---

archive/issue_comments_067106.json:
```json
{
    "body": "Changed work issues from **conflicts** to none",
    "created_at": "2010-09-24T15:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67106",
    "user": "https://github.com/loefflerd"
}
```

Changed work issues from **conflicts** to none



---

archive/issue_events_094778.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-24T15:25:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94778"
}
```



---

archive/issue_events_094779.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-24T15:25:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94779"
}
```



---

archive/issue_comments_067107.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nYay!  Thank you for your work on these patches.",
    "created_at": "2010-09-24T15:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67107",
    "user": "https://github.com/roed314"
}
```

<div id="comment:19" align="right">Comment 19</div>

Yay!  Thank you for your work on these patches.



---

archive/issue_comments_067108.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nIncidentally, are you running a 32-bit or a 64-bit machine? I don't have access to any 32-bit boxes. If you have access to a 32-bit machine, it would be great if you could do the following:\n\n- Install #9898/#9753/#9764 and test everything in sage/rings.\n- Then install #7883 and the combined patch from this ticket, and do sage/rings again.\n- Then install #9359 and repeat.\n\nI'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)",
    "created_at": "2010-09-24T15:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67108",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:20" align="right">Comment 20</div>

Incidentally, are you running a 32-bit or a 64-bit machine? I don't have access to any 32-bit boxes. If you have access to a 32-bit machine, it would be great if you could do the following:

- Install #9898/#9753/#9764 and test everything in sage/rings.
- Then install #7883 and the combined patch from this ticket, and do sage/rings again.
- Then install #9359 and repeat.

I'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)



---

archive/issue_comments_067109.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nIn fact, I can think of one hashing doctest which will fail on a 32-bit machine.  Unfortunately I'm running on 64-bit.",
    "created_at": "2010-09-24T15:51:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67109",
    "user": "https://github.com/roed314"
}
```

<div id="comment:21" align="right">Comment 21</div>

In fact, I can think of one hashing doctest which will fail on a 32-bit machine.  Unfortunately I'm running on 64-bit.



---

archive/issue_comments_067110.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@loefflerd](#comment%3A20):\n> - Install #9898/#9753/#9764 and test everything in sage/rings.\n> - Then install #7883 and the combined patch from this ticket, and do sage/rings again.\n> - Then install #9359 and repeat.\n> \n> I'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)\n\nI will do this (and should have done it for my patches).",
    "created_at": "2010-09-25T09:58:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67110",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@loefflerd](#comment%3A20):
> - Install #9898/#9753/#9764 and test everything in sage/rings.
> - Then install #7883 and the combined patch from this ticket, and do sage/rings again.
> - Then install #9359 and repeat.
> 
> I'm a little nervous about silly doctest failures coming up from Pari's unpredictable choices of generators of ideals, and this would set my mind at rest a bit :-)

I will do this (and should have done it for my patches).



---

archive/issue_comments_067111.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).\n+Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).\n \n-Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.\n+Depends on #7883, #9898, #9753, #9764. Prerequisite for #8335.\n``````\n",
    "created_at": "2010-09-25T10:04:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67111",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for 7885 (Tate's algorithm for function fields).
+Moves residue fields to the coercion model, makes the reduction and lifting maps morphisms, prepares the way for #7885 (Tate's algorithm for function fields).
 
-Depends on #8218, #8332, #7880, #7883, #8333. Prerequisite for #8335.
+Depends on #7883, #9898, #9753, #9764. Prerequisite for #8335.
``````




---

archive/issue_comments_067112.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nI have testing the following chain of patches on a 32-bit PPC machine:\n\n```\ntrac_7883-ideals-folded.patch\n9898_pari_decl.patch\n9753.patch\n9764_ideal_repr_new.patch\n8333_8334_ALL-rebased_for_9764.patch\n```\n\nThe only failure was in `sage/schemes/generic/toric_divisor.py`, which is a known problem.",
    "created_at": "2010-09-26T10:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67112",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">Comment 24</div>

I have testing the following chain of patches on a 32-bit PPC machine:

```
trac_7883-ideals-folded.patch
9898_pari_decl.patch
9753.patch
9764_ideal_repr_new.patch
8333_8334_ALL-rebased_for_9764.patch
```

The only failure was in `sage/schemes/generic/toric_divisor.py`, which is a known problem.



---

archive/issue_comments_067113.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nCould someone please update the commit string of [attachment: 8333_8334_ALL-rebased_for_9764.patch](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL-rebased_for_9764.patch.gz) so its first line is a < 80 (or so) character summary that includes the ticket number, then restore the positive review?  Additional lines are no problem, of course.",
    "created_at": "2010-09-28T09:41:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67113",
    "user": "https://github.com/qed777"
}
```

<div id="comment:25" align="right">Comment 25</div>

Could someone please update the commit string of [attachment: 8333_8334_ALL-rebased_for_9764.patch](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL-rebased_for_9764.patch.gz) so its first line is a < 80 (or so) character summary that includes the ticket number, then restore the positive review?  Additional lines are no problem, of course.



---

archive/issue_events_094780.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T09:41:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94780"
}
```



---

archive/issue_events_094781.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T09:41:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94781"
}
```



---

archive/issue_comments_067114.json:
```json
{
    "body": "Attachment: **[8333_8334_ALL-better_commit_string.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL-better_commit_string.patch.gz)**\n\nVersion with better commit string.",
    "created_at": "2010-09-28T10:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67114",
    "user": "https://github.com/loefflerd"
}
```

Attachment: **[8333_8334_ALL-better_commit_string.patch.gz](https://github.com/sagemath/sage/files/ticket8334/8333_8334_ALL-better_commit_string.patch.gz)**

Version with better commit string.



---

archive/issue_events_094782.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-28T10:19:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94782"
}
```



---

archive/issue_events_094783.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-28T10:19:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94783"
}
```



---

archive/issue_comments_067115.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nDone.",
    "created_at": "2010-09-28T10:19:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67115",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:26" align="right">Comment 26</div>

Done.



---

archive/issue_events_094784.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T10:56:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94784"
}
```



---

archive/issue_events_094785.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-28T10:56:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8334#event-94785"
}
```



---

archive/issue_comments_067116.json:
```json
{
    "body": "Merged: **sage-4.6.alpha2**",
    "created_at": "2010-09-28T10:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67116",
    "user": "https://github.com/qed777"
}
```

Merged: **sage-4.6.alpha2**



---

archive/issue_comments_067117.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nThis seems to have sorted #9409, which needs a reviewer to verify my check.",
    "created_at": "2010-10-03T16:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67117",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:28" align="right">Comment 28</div>

This seems to have sorted #9409, which needs a reviewer to verify my check.



---

archive/issue_comments_067118.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nDavid, I'm not very satisfied with the change in `french_book/numbertheory.py` done by this patch, for two reasons:\n\n(1) the previous error message was better. (In the book we wanted to show that the isomorphism\n    between two instances of GF(3<sup>2</sup>) is not automatic in Sage.)\n\n(2) this is more serious. We have put this doctest in Sage so that the examples of our book (which\n    is now published) still work with future versions of Sage. By changing the error message you\n    did break the examples on http://sagebook.gforge.inria.fr/. Moreover you did not even contact\n    us to discuss this change.\n\nFor (1) is it possible to revert to the previous error message?\n\nFor (2) in case you want to change some file in the tests directory, please first inform the\ncorresponding author.\n\nPaul Zimmermann",
    "created_at": "2011-11-23T09:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67118",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:29" align="right">Comment 29</div>

David, I'm not very satisfied with the change in `french_book/numbertheory.py` done by this patch, for two reasons:

(1) the previous error message was better. (In the book we wanted to show that the isomorphism
    between two instances of GF(3<sup>2</sup>) is not automatic in Sage.)

(2) this is more serious. We have put this doctest in Sage so that the examples of our book (which
    is now published) still work with future versions of Sage. By changing the error message you
    did break the examples on http://sagebook.gforge.inria.fr/. Moreover you did not even contact
    us to discuss this change.

For (1) is it possible to revert to the previous error message?

For (2) in case you want to change some file in the tests directory, please first inform the
corresponding author.

Paul Zimmermann



---

archive/issue_comments_067119.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nPaul: I'm sorry, I didn't mean to break anything -- I didn't know there was an official policy of not making changes to the tests directory. Can you point me to where this policy is explicitly written down?",
    "created_at": "2011-11-23T10:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67119",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:30" align="right">Comment 30</div>

Paul: I'm sorry, I didn't mean to break anything -- I didn't know there was an official policy of not making changes to the tests directory. Can you point me to where this policy is explicitly written down?



---

archive/issue_comments_067120.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nDavid (Loeffler), I didn't write to you, but to David Roe... You are just the reviewer.\nThis policy is explained in http://groups.google.com/group/sage-support/msg/3ea7ed2eeab0824a :\n\n```\n\nNote that you could also submit a patch to Sage with the code you're doctesting.\nI did that with all the tests from both of the books I published, and\nI encourage you and many others to do the same with the code from your\narticle.  The code would go in a file\n\n    devel/sage/sage/tests/\n\nlike the file devel/sage/sage/tests/book_stein_modform.py\n\nIn fact, I could imagine having dozens of files in that directory, and\nwhen doctests break there, we could notify the authors before\nreleasing the version of Sage that breaks their doctests for feedback\n-- then they could update their papers or Sage.\n```\n\nMy personal opinion is that \"we could notify\" should read \"we should notify\"...\n\nPaul",
    "created_at": "2011-11-23T10:24:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67120",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:31" align="right">Comment 31</div>

David (Loeffler), I didn't write to you, but to David Roe... You are just the reviewer.
This policy is explained in http://groups.google.com/group/sage-support/msg/3ea7ed2eeab0824a :

```

Note that you could also submit a patch to Sage with the code you're doctesting.
I did that with all the tests from both of the books I published, and
I encourage you and many others to do the same with the code from your
article.  The code would go in a file

    devel/sage/sage/tests/

like the file devel/sage/sage/tests/book_stein_modform.py

In fact, I could imagine having dozens of files in that directory, and
when doctests break there, we could notify the authors before
releasing the version of Sage that breaks their doctests for feedback
-- then they could update their papers or Sage.
```

My personal opinion is that "we could notify" should read "we should notify"...

Paul



---

archive/issue_comments_067121.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nSorry for the change to the tests folder.  When I split up a patchbomb into #8334 and #8335 (among others), I changed some errors to `NotImplementedError` for coercions that would soon work in #8335.  Unfortunately that ticket has stagnated.\n\nWhile I'm working on fixing #8335, I've made a new ticket (#12084) that restores the original `TypeError`.  It's ready for review.  Sorry for the trouble, and I'll be more careful with the `sage/tests` directory in the future.",
    "created_at": "2011-11-25T21:16:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67121",
    "user": "https://github.com/roed314"
}
```

<div id="comment:32" align="right">Comment 32</div>

Sorry for the change to the tests folder.  When I split up a patchbomb into #8334 and #8335 (among others), I changed some errors to `NotImplementedError` for coercions that would soon work in #8335.  Unfortunately that ticket has stagnated.

While I'm working on fixing #8335, I've made a new ticket (#12084) that restores the original `TypeError`.  It's ready for review.  Sorry for the trouble, and I'll be more careful with the `sage/tests` directory in the future.



---

archive/issue_comments_067122.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nWhat's with all the commented-out doctests added here? See #16946.",
    "created_at": "2014-09-08T20:41:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8334#issuecomment-67122",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">Comment 33</div>

What's with all the commented-out doctests added here? See #16946.
