# Issue 8553: Minor bugs in solve() if dictionary result requested

archive/issues_008553.json:
```json
{
    "body": "`solve()` raises an `IndexError` on empty solutions if a list of solution *dictionaries* is requested.\n\nThe description/examples may mislead w.r.t. the result type.\n\n\n---\n\nApply [attachment:trac_8553_solve_fix_IndexError.3.patch] and [attachment:trac_8553-review.patch].\n\nAssignee: @nexttime\n\nCC:  @haraldschilly @mwhansen @burcin @jasongrout @kcrisman\n\nKeywords: solve, solution_dict, beginner\n\nResolution: fixed\n\nAuthor: Leif Leonhardy\n\nReviewer: Harald Schilly, Mike Hansen, Burcin Erocal, Karl-Dieter Crisman\n\nMerged: sage-4.7.1.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/8553\n\n",
    "closed_at": "2011-06-01T07:16:08Z",
    "created_at": "2010-03-17T15:39:40Z",
    "labels": [
        "component: symbolics",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "Minor bugs in solve() if dictionary result requested",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8553",
    "user": "https://github.com/nexttime"
}
```
`solve()` raises an `IndexError` on empty solutions if a list of solution *dictionaries* is requested.

The description/examples may mislead w.r.t. the result type.


---

Apply [attachment:trac_8553_solve_fix_IndexError.3.patch] and [attachment:trac_8553-review.patch].

Assignee: @nexttime

CC:  @haraldschilly @mwhansen @burcin @jasongrout @kcrisman

Keywords: solve, solution_dict, beginner

Resolution: fixed

Author: Leif Leonhardy

Reviewer: Harald Schilly, Mike Hansen, Burcin Erocal, Karl-Dieter Crisman

Merged: sage-4.7.1.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/8553





---

archive/issue_comments_077228.json:
```json
{
    "body": "<a id='comment:1'></a>```\nsage: x=var('x')\nsage: x\nx\nsage: solve([0==1], x, solution_dict = True)\n[]\nsage: solve([x==0, 0==1], x, solution_dict = True)\n[]\nsage: solve([(x == 0), (x == 1)], x, solution_dict = True)\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n...\nIndexError: list index out of range\n```",
    "created_at": "2010-03-17T15:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77228",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:1'></a>```
sage: x=var('x')
sage: x
x
sage: solve([0==1], x, solution_dict = True)
[]
sage: solve([x==0, 0==1], x, solution_dict = True)
[]
sage: solve([(x == 0), (x == 1)], x, solution_dict = True)
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
...
IndexError: list index out of range
```



---

archive/issue_comments_077229.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-03-17T16:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77229",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_077230.json:
```json
{
    "body": "<a id='comment:2'></a>Attachment [trac_8553_solve_dictionary_result_fix.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_dictionary_result_fix.patch) by @nexttime created at 2010-03-17 16:39:28",
    "created_at": "2010-03-17T16:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77230",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>Attachment [trac_8553_solve_dictionary_result_fix.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_dictionary_result_fix.patch) by @nexttime created at 2010-03-17 16:39:28



---

archive/issue_comments_077231.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-03-17T17:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77231",
    "user": "https://github.com/haraldschilly"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_077232.json:
```json
{
    "body": "<a id='comment:3'></a>patch works for 4.3.4.rc0 and looks fine. i would just like to see a \"TESTS::\" header for the additional doctests and a line referring to this ticket, smth. like \"this fixes the problem reported in ticket #8553\".",
    "created_at": "2010-03-17T17:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77232",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:3'></a>patch works for 4.3.4.rc0 and looks fine. i would just like to see a "TESTS::" header for the additional doctests and a line referring to this ticket, smth. like "this fixes the problem reported in ticket #8553".



---

archive/issue_events_020611.json:
```json
{
    "actor": "https://github.com/haraldschilly",
    "created_at": "2010-03-17T17:41:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "milestone": "sage-4.3.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8553#event-20611"
}
```



---

archive/issue_comments_077233.json:
```json
{
    "body": "<a id='comment:5'></a>Style-wise, this\n\n```\n{} if 'solution_dict' in kwds and kwds['solution_dict']==True else []\n```\n\nshould be\n\n```\n{} if kwds.get('solution_dict', False) is True else []\n```",
    "created_at": "2010-03-17T19:49:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77233",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:5'></a>Style-wise, this

```
{} if 'solution_dict' in kwds and kwds['solution_dict']==True else []
```

should be

```
{} if kwds.get('solution_dict', False) is True else []
```



---

archive/issue_comments_077234.json:
```json
{
    "body": "<a id='comment:6'></a>Or even \n\n```\n{} if kwds.get('solution_dict', False) else []\n```\n\nif you want to be a bit more lax with inputs.",
    "created_at": "2010-03-17T19:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77234",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:6'></a>Or even 

```
{} if kwds.get('solution_dict', False) else []
```

if you want to be a bit more lax with inputs.



---

archive/issue_comments_077235.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 mhansen]:\n> Or even \n> \n> \n> ```\n> {} if kwds.get('solution_dict', False) else []\n> ```\n> \n> if you want to be a bit more lax with inputs.\n\n\nPlease correct me, but I do not see any difference to your former suggestion.\nIn what sense does this relax the inputs?",
    "created_at": "2010-03-17T20:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77235",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>Replying to [comment:6 mhansen]:
> Or even 
> 
> 
> ```
> {} if kwds.get('solution_dict', False) else []
> ```
> 
> if you want to be a bit more lax with inputs.


Please correct me, but I do not see any difference to your former suggestion.
In what sense does this relax the inputs?



---

archive/issue_comments_077236.json:
```json
{
    "body": "<a id='comment:8'></a>In the first cases, passing in solution_dict=1 would be the same as passing in solution_dict=False.  In the second case, solution_dict=1 would be the same as solution_dict=True.",
    "created_at": "2010-03-17T20:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77236",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:8'></a>In the first cases, passing in solution_dict=1 would be the same as passing in solution_dict=False.  In the second case, solution_dict=1 would be the same as solution_dict=True.



---

archive/issue_comments_077237.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 mhansen]:\n> In the first cases, passing in solution_dict=1 would be the same as passing in solution_dict=False.  In the second case, solution_dict=1 would be the same as solution_dict=True.\n\n\n\nThat's perhaps what one would expect.\n\nBut `solution_dict=1` evaluates to `True` in all versions, while `solution_dict=42` surprisingly evaluates to `False`, even in your latter version.",
    "created_at": "2010-03-17T21:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77237",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>Replying to [comment:8 mhansen]:
> In the first cases, passing in solution_dict=1 would be the same as passing in solution_dict=False.  In the second case, solution_dict=1 would be the same as solution_dict=True.



That's perhaps what one would expect.

But `solution_dict=1` evaluates to `True` in all versions, while `solution_dict=42` surprisingly evaluates to `False`, even in your latter version.



---

archive/issue_comments_077238.json:
```json
{
    "body": "<a id='comment:10'></a>```\nsage: kwds = {'solution_dict': 42}\nsage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []\n{}\nsage: {} if kwds.get('solution_dict', False) is True else []\n[]\nsage: {} if kwds.get('solution_dict', False) else []\n{}\nsage: kwds = {'solution_dict': 42r}\nsage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []\n[]\nsage: {} if kwds.get('solution_dict', False) is True else []\n[]\nsage: {} if kwds.get('solution_dict', False) else []\n{}\n```",
    "created_at": "2010-03-17T21:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77238",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:10'></a>```
sage: kwds = {'solution_dict': 42}
sage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []
{}
sage: {} if kwds.get('solution_dict', False) is True else []
[]
sage: {} if kwds.get('solution_dict', False) else []
{}
sage: kwds = {'solution_dict': 42r}
sage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []
[]
sage: {} if kwds.get('solution_dict', False) is True else []
[]
sage: {} if kwds.get('solution_dict', False) else []
{}
```



---

archive/issue_comments_077239.json:
```json
{
    "body": "<a id='comment:11'></a>I have to corrct myself: `1` gives `True` only in the first (because of `==` comparison) and the last implementation.",
    "created_at": "2010-03-17T21:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77239",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>I have to corrct myself: `1` gives `True` only in the first (because of `==` comparison) and the last implementation.



---

archive/issue_comments_077240.json:
```json
{
    "body": "<a id='comment:12'></a>```\nsage: kwds = {'solution_dict': 42}\nsage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []\n[]\nsage: {} if kwds.get('solution_dict', False) is True else []\n[]\nsage: {} if kwds.get('solution_dict', False) else []\n{}\nsage: sage: kwds = {'solution_dict': 42r}\nsage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []\n[]\nsage: {} if kwds.get('solution_dict', False) is True else []\n[]\nsage: {} if kwds.get('solution_dict', False) else []\n{}\n\n```\n4.3.4.alpha1\n\nNotice the difference in the first case; 42 is not true for me ;-)",
    "created_at": "2010-03-17T21:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77240",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'></a>```
sage: kwds = {'solution_dict': 42}
sage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []
[]
sage: {} if kwds.get('solution_dict', False) is True else []
[]
sage: {} if kwds.get('solution_dict', False) else []
{}
sage: sage: kwds = {'solution_dict': 42r}
sage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []
[]
sage: {} if kwds.get('solution_dict', False) is True else []
[]
sage: {} if kwds.get('solution_dict', False) else []
{}

```
4.3.4.alpha1

Notice the difference in the first case; 42 is not true for me ;-)



---

archive/issue_comments_077241.json:
```json
{
    "body": "<a id='comment:13'></a>```\nsage: kwds = {'solution_dict': 42}                                         \nsage: print kwds                  \n{'solution_dict': 42}\nsage: sage: kwds = {'solution_dict': 42r}                                  \nsage: print kwds                         \n{'solution_dict': 42}\n\n```\nPreparser issue?",
    "created_at": "2010-03-17T21:52:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77241",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>```
sage: kwds = {'solution_dict': 42}                                         
sage: print kwds                  
{'solution_dict': 42}
sage: sage: kwds = {'solution_dict': 42r}                                  
sage: print kwds                         
{'solution_dict': 42}

```
Preparser issue?



---

archive/issue_comments_077242.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 leif]:\n> Preparser issue?\n\n\nno, that's a feature and notice there is an \"r\" behind the 42! \n\n```\nsage: preparse('42r + 42')\n'42 + Integer(42)'\n```",
    "created_at": "2010-03-17T22:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77242",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:14'></a>Replying to [comment:13 leif]:
> Preparser issue?


no, that's a feature and notice there is an "r" behind the 42! 

```
sage: preparse('42r + 42')
'42 + Integer(42)'
```



---

archive/issue_comments_077243.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 schilly]:\n\nOk, but I still don't understand the different behavior of Mike's and my machine:\n\n```\nsage: kwds = {'solution_dict': 42}\nsage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []\n```\n\nWhile Mike gets the empty set, I get the empty list, and if the doctests passed on your 4.3.4.rc0, your version behaves like my 4.3.4.alpha1 (on Ubuntu 9.04 x86_64), because I added the `solution_dict=42` case with an expected empty **list**.",
    "created_at": "2010-03-17T23:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77243",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>Replying to [comment:14 schilly]:

Ok, but I still don't understand the different behavior of Mike's and my machine:

```
sage: kwds = {'solution_dict': 42}
sage: {} if 'solution_dict' in kwds and kwds['solution_dict']==True else []
```

While Mike gets the empty set, I get the empty list, and if the doctests passed on your 4.3.4.rc0, your version behaves like my 4.3.4.alpha1 (on Ubuntu 9.04 x86_64), because I added the `solution_dict=42` case with an expected empty **list**.



---

archive/issue_comments_077244.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 leif]:\n\nI still get the empty **list** for the code above with 4.3.4.rc0 (just built on Ubuntu 9.04 x86_64), but I'll update the patch to the latter suggested version (with the 42-testcase changed, i.e. **inverted**!).",
    "created_at": "2010-03-18T00:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77244",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>Replying to [comment:15 leif]:

I still get the empty **list** for the code above with 4.3.4.rc0 (just built on Ubuntu 9.04 x86_64), but I'll update the patch to the latter suggested version (with the 42-testcase changed, i.e. **inverted**!).



---

archive/issue_comments_077245.json:
```json
{
    "body": "<a id='comment:17'></a>Attachment [trac_8553_solve_dictionary_result_fix-variant2.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_dictionary_result_fix-variant2.patch) by @nexttime created at 2010-03-18 00:35:59\n\nApply **either** the first **or** the second patch, **not both**.",
    "created_at": "2010-03-18T00:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77245",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'></a>Attachment [trac_8553_solve_dictionary_result_fix-variant2.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_dictionary_result_fix-variant2.patch) by @nexttime created at 2010-03-18 00:35:59

Apply **either** the first **or** the second patch, **not both**.



---

archive/issue_comments_077246.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2010-03-18T16:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77246",
    "user": "https://github.com/burcin"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_077247.json:
```json
{
    "body": "<a id='comment:18'></a>AFAICT, `solve` returns a list of possible solutions to the given equality. When the `solution_dict` parameter is `True`, this list is populated by dictionaries instead of symbolic relations.\n\nWith this reasoning the current behavior of returning an empty list if we can't find any solutions even if the `solution_dict` parameter is `True` seems correct to me.\n\nIMHO, the only thing that needs to be fixed is the `IndexError` when there is no solution. Comments?",
    "created_at": "2010-03-18T16:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77247",
    "user": "https://github.com/burcin"
}
```

<a id='comment:18'></a>AFAICT, `solve` returns a list of possible solutions to the given equality. When the `solution_dict` parameter is `True`, this list is populated by dictionaries instead of symbolic relations.

With this reasoning the current behavior of returning an empty list if we can't find any solutions even if the `solution_dict` parameter is `True` seems correct to me.

IMHO, the only thing that needs to be fixed is the `IndexError` when there is no solution. Comments?



---

archive/issue_comments_077248.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 burcin]:\n> IMHO, the only thing that needs to be fixed is the `IndexError` when there is no solution. Comments?\n\n\nYes please, I don't get it why this is so complicated! All unrelated issues should be discussed off-ticket.",
    "created_at": "2010-03-18T17:41:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77248",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:19'></a>Replying to [comment:18 burcin]:
> IMHO, the only thing that needs to be fixed is the `IndexError` when there is no solution. Comments?


Yes please, I don't get it why this is so complicated! All unrelated issues should be discussed off-ticket.



---

archive/issue_comments_077249.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:18 burcin]:\n> AFAICT, `solve` returns a list of possible solutions to the given equality. When the `solution_dict` parameter is `True`, this list is populated by dictionaries instead of symbolic relations.\n> \n> With this reasoning the current behavior of returning an empty list if we can't find any solutions even if the `solution_dict` parameter is `True` seems correct to me.\n\n\nThat's really a matter of design; one could equally well specify the function to return a list containing an empty dictionary in that case; i.e., the current specification is not precise (and that's not the only one).\n\nBut you're right, unless we change the *informal* \"prototype\" (its signature), it should in any case return a ***list** of something*.\n\n\nI'd change the patch to reflect whatever behavior you want... ;-)\n\n-Leif",
    "created_at": "2010-03-18T17:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77249",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>Replying to [comment:18 burcin]:
> AFAICT, `solve` returns a list of possible solutions to the given equality. When the `solution_dict` parameter is `True`, this list is populated by dictionaries instead of symbolic relations.
> 
> With this reasoning the current behavior of returning an empty list if we can't find any solutions even if the `solution_dict` parameter is `True` seems correct to me.


That's really a matter of design; one could equally well specify the function to return a list containing an empty dictionary in that case; i.e., the current specification is not precise (and that's not the only one).

But you're right, unless we change the *informal* "prototype" (its signature), it should in any case return a ***list** of something*.


I'd change the patch to reflect whatever behavior you want... ;-)

-Leif



---

archive/issue_comments_077250.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:19 schilly]:\n> Replying to [comment:18 burcin]:\n> > IMHO, the only thing that needs to be fixed is the `IndexError` when there is no solution. Comments?\n\n> \n> Yes please, I don't get it why this is so complicated! All unrelated issues should be discussed off-ticket.\n\n\nSo we'd change the ticket description and the patch to only address and fix the index error?\n\nOk for me.",
    "created_at": "2010-03-18T17:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77250",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>Replying to [comment:19 schilly]:
> Replying to [comment:18 burcin]:
> > IMHO, the only thing that needs to be fixed is the `IndexError` when there is no solution. Comments?

> 
> Yes please, I don't get it why this is so complicated! All unrelated issues should be discussed off-ticket.


So we'd change the ticket description and the patch to only address and fix the index error?

Ok for me.



---

archive/issue_comments_077251.json:
```json
{
    "body": "<a id='comment:22'></a>Hi Leif,\n\nReplying to [comment:21 leif]:\n> So we'd change the ticket description and the patch to only address and fix the index error?\n> \n> Ok for me.\n\n\nCan you provide a patch that fixes the `IndexError` problem? If we get this reviewed in the next few days it might still make it to the next release.",
    "created_at": "2010-04-05T13:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77251",
    "user": "https://github.com/burcin"
}
```

<a id='comment:22'></a>Hi Leif,

Replying to [comment:21 leif]:
> So we'd change the ticket description and the patch to only address and fix the index error?
> 
> Ok for me.


Can you provide a patch that fixes the `IndexError` problem? If we get this reviewed in the next few days it might still make it to the next release.



---

archive/issue_comments_077252.json:
```json
{
    "body": "Attachment [trac_8553_solve_fix_IndexError.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_fix_IndexError.patch) by @nexttime created at 2010-04-06 04:43:46",
    "created_at": "2010-04-06T04:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77252",
    "user": "https://github.com/nexttime"
}
```

Attachment [trac_8553_solve_fix_IndexError.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_fix_IndexError.patch) by @nexttime created at 2010-04-06 04:43:46



---

archive/issue_comments_077253.json:
```json
{
    "body": "<a id='comment:23'></a>Sorry, unable to delete the previous patches; **apply only the last one**.\n\n* `IndexError` issue fixed.\n* Type of parameter `solution_dict` relaxed as suggested by Mike Hansen (now consistent; also in `expression.pyx`/`Expression.solve()`).\n* (More) Doctests added.\n* Description made more clear. Some typos fixed.",
    "created_at": "2010-04-06T05:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77253",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>Sorry, unable to delete the previous patches; **apply only the last one**.

* `IndexError` issue fixed.
* Type of parameter `solution_dict` relaxed as suggested by Mike Hansen (now consistent; also in `expression.pyx`/`Expression.solve()`).
* (More) Doctests added.
* Description made more clear. Some typos fixed.



---

archive/issue_comments_077254.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-04-06T05:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77254",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_077255.json:
```json
{
    "body": "Attachment [trac_8553_solve_fix_IndexError.2.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_fix_IndexError.2.patch) by @TimDumol created at 2010-04-18 07:56:00\n\nRebase on sage-4.4.alpha0.",
    "created_at": "2010-04-18T07:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77255",
    "user": "https://github.com/TimDumol"
}
```

Attachment [trac_8553_solve_fix_IndexError.2.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_fix_IndexError.2.patch) by @TimDumol created at 2010-04-18 07:56:00

Rebase on sage-4.4.alpha0.



---

archive/issue_comments_077256.json:
```json
{
    "body": "<a id='comment:25'></a>Works perfectly after this rebase. Positive review, but someone has to review this rebase first.",
    "created_at": "2010-04-18T07:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77256",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:25'></a>Works perfectly after this rebase. Positive review, but someone has to review this rebase first.



---

archive/issue_comments_077257.json:
```json
{
    "body": "Attachment [trac_8553_solve_fix_IndexError.3.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_fix_IndexError.3.patch) by @burcin created at 2010-05-05 01:23:35\n\nrevised version of Leif's patch",
    "created_at": "2010-05-05T01:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77257",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_8553_solve_fix_IndexError.3.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553_solve_fix_IndexError.3.patch) by @burcin created at 2010-05-05 01:23:35

revised version of Leif's patch



---

archive/issue_comments_077258.json:
```json
{
    "body": "reviewer's patch",
    "created_at": "2010-05-05T01:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77258",
    "user": "https://github.com/burcin"
}
```

reviewer's patch



---

archive/issue_comments_077259.json:
```json
{
    "body": "<a id='comment:26'></a>Attachment [trac_8553-review.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553-review.patch) by @burcin created at 2010-05-05 01:44:30\n\nThe doctests for using values that are taken to be True in Leif's patch added a few extra seconds to the time to test `sage/symbolic/relation.py`. I uploaded a revised version of Leif's patch, attachment:trac_8553_solve_fix_IndexError.3.patch, which cuts down on these examples.\n\nattachment:trac_8553-review.patch adds a new test condition to check if the first argument is a list, after the statement that handles a single symbolic expression.\n\nCan someone review my patch?",
    "created_at": "2010-05-05T01:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77259",
    "user": "https://github.com/burcin"
}
```

<a id='comment:26'></a>Attachment [trac_8553-review.patch](tarball://root/attachments/some-uuid/ticket8553/trac_8553-review.patch) by @burcin created at 2010-05-05 01:44:30

The doctests for using values that are taken to be True in Leif's patch added a few extra seconds to the time to test `sage/symbolic/relation.py`. I uploaded a revised version of Leif's patch, attachment:trac_8553_solve_fix_IndexError.3.patch, which cuts down on these examples.

attachment:trac_8553-review.patch adds a new test condition to check if the first argument is a list, after the statement that handles a single symbolic expression.

Can someone review my patch?



---

archive/issue_comments_077260.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 burcin]:\n> The doctests for using values that are taken to be True in Leif's patch added a few extra seconds to the time to test `sage/symbolic/relation.py`.\n\n\n:-) Adding `# optional` or `# long` would have been possible, too.\n\n(Now the tests of Python `int`s vs. Sage's `Integer`s are omitted.)",
    "created_at": "2010-05-05T12:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77260",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>Replying to [comment:26 burcin]:
> The doctests for using values that are taken to be True in Leif's patch added a few extra seconds to the time to test `sage/symbolic/relation.py`.


:-) Adding `# optional` or `# long` would have been possible, too.

(Now the tests of Python `int`s vs. Sage's `Integer`s are omitted.)



---

archive/issue_comments_077261.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 leif]:\n> Replying to [comment:26 burcin]:\n> > The doctests for using values that are taken to be True in Leif's patch added a few extra seconds to the time to test `sage/symbolic/relation.py`.\n\n> \n> :-) Adding `# optional` or `# long` would have been possible, too.\n> \n> (Now the tests of Python `int`s vs. Sage's `Integer`s are omitted.)\n\n\nSince they weren't testing the functionality of `solve()`, but a convenience in Python, I think it's OK if they are not so extensive. I run doctests on these files very often, so it's rather important that even the long tests take a reasonable time.\n\nCan you review my changes BTW?",
    "created_at": "2010-05-06T16:59:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77261",
    "user": "https://github.com/burcin"
}
```

<a id='comment:28'></a>Replying to [comment:27 leif]:
> Replying to [comment:26 burcin]:
> > The doctests for using values that are taken to be True in Leif's patch added a few extra seconds to the time to test `sage/symbolic/relation.py`.

> 
> :-) Adding `# optional` or `# long` would have been possible, too.
> 
> (Now the tests of Python `int`s vs. Sage's `Integer`s are omitted.)


Since they weren't testing the functionality of `solve()`, but a convenience in Python, I think it's OK if they are not so extensive. I run doctests on these files very often, so it's rather important that even the long tests take a reasonable time.

Can you review my changes BTW?



---

archive/issue_comments_077262.json:
```json
{
    "body": "Changing keywords from \"solve, solution_dict\" to \"solve, solution_dict, beginner\".",
    "created_at": "2010-05-26T16:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77262",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "solve, solution_dict" to "solve, solution_dict, beginner".



---

archive/issue_comments_077263.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-06-07T17:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77263",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_077264.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:28 burcin]:\n> Can you review my changes BTW? \n\n\n`m.to_poly_solve(variables)` might be called twice.\n\nBtw, I think the patch should be finally reviewed by someone else, not me, as I'm one of the authors.",
    "created_at": "2010-06-07T17:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77264",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:30'></a>Replying to [comment:28 burcin]:
> Can you review my changes BTW? 


`m.to_poly_solve(variables)` might be called twice.

Btw, I think the patch should be finally reviewed by someone else, not me, as I'm one of the authors.



---

archive/issue_comments_077265.json:
```json
{
    "body": "<a id='comment:32'></a>Just for reference, see [this sage-support thread](http://groups.google.com/group/sage-support/browse_thread/thread/d54b283435a8ed4b/1eab51e2561da568) for another report of this.",
    "created_at": "2011-05-18T13:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77265",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:32'></a>Just for reference, see [this sage-support thread](http://groups.google.com/group/sage-support/browse_thread/thread/d54b283435a8ed4b/1eab51e2561da568) for another report of this.



---

archive/issue_events_020612.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-05-18T16:04:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "milestone": "sage-4.3.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8553#event-20612"
}
```



---

archive/issue_events_020613.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2011-05-18T16:04:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8553#event-20613"
}
```



---

archive/issue_comments_077266.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-05-18T16:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77266",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_077267.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:30 leif]:\n> Replying to [comment:28 burcin]:\n> > Can you review my changes BTW? \n\n> \n> `m.to_poly_solve(variables)` might be called twice.\n\n\nIt is, but only in the unusual situation that Maxima's solve gave an error and `to_poly_solve` gave the empty list.  More to the point, this was there before, and should be a different ticket.\n\n> Btw, I think the patch should be finally reviewed by someone else, not me, as I'm one of the authors.\n>  \n\nNot at all - usually it is appropriate to review a reviewer patch.  This reviewer patch really is pretty minimally invasive, and in fact provides a much more useful error message.\n\nIt is true that \n\n```\nsage: solve(x==1,x,solution_dict=int(3))\n[{x: 1}]\nsage: solve([0==1],x,solution_dict=int(3))\n[]\nsage: solve(0==1,x,solution_dict=int(3))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/karl-dietercrisman/Downloads/sage-4.7.rc1/<ipython console> in <module>()\n\n/Users/karl-dietercrisman/Downloads/sage-4.7.rc1/local/lib/python2.6/site-packages/sage/symbolic/relation.pyc in solve(f, *args, **kwds)\n    652 \n    653     if not isinstance(f, (list, tuple)):\n--> 654         raise TypeError(\"The first argument must be a symbolic expression or a list of symbolic expressions.\")\n    655 \n    656     if len(f)==1 and is_Expression(f[0]):\n\nTypeError: The first argument must be a symbolic expression or a list of symbolic expressions.\n```\nwhich is not ideal.  However, this is still better behavior than the mysterious message about bools and len before, so that could be another ticket.  \n\nIn any case, this (somewhat surprisingly) still applies fine to 4.7.rc2!  And does what it says.  And passes tests. Positive review.",
    "created_at": "2011-05-18T16:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77267",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:33'></a>Replying to [comment:30 leif]:
> Replying to [comment:28 burcin]:
> > Can you review my changes BTW? 

> 
> `m.to_poly_solve(variables)` might be called twice.


It is, but only in the unusual situation that Maxima's solve gave an error and `to_poly_solve` gave the empty list.  More to the point, this was there before, and should be a different ticket.

> Btw, I think the patch should be finally reviewed by someone else, not me, as I'm one of the authors.
>  

Not at all - usually it is appropriate to review a reviewer patch.  This reviewer patch really is pretty minimally invasive, and in fact provides a much more useful error message.

It is true that 

```
sage: solve(x==1,x,solution_dict=int(3))
[{x: 1}]
sage: solve([0==1],x,solution_dict=int(3))
[]
sage: solve(0==1,x,solution_dict=int(3))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/karl-dietercrisman/Downloads/sage-4.7.rc1/<ipython console> in <module>()

/Users/karl-dietercrisman/Downloads/sage-4.7.rc1/local/lib/python2.6/site-packages/sage/symbolic/relation.pyc in solve(f, *args, **kwds)
    652 
    653     if not isinstance(f, (list, tuple)):
--> 654         raise TypeError("The first argument must be a symbolic expression or a list of symbolic expressions.")
    655 
    656     if len(f)==1 and is_Expression(f[0]):

TypeError: The first argument must be a symbolic expression or a list of symbolic expressions.
```
which is not ideal.  However, this is still better behavior than the mysterious message about bools and len before, so that could be another ticket.  

In any case, this (somewhat surprisingly) still applies fine to 4.7.rc2!  And does what it says.  And passes tests. Positive review.



---

archive/issue_events_020614.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-01T07:16:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8553#event-20614"
}
```



---

archive/issue_comments_077268.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-06-01T07:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77268",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_077269.json:
```json
{
    "body": "<a id='comment:35'></a>For the sagebot:\n\nApply [attachment:trac_8553_solve_fix_IndexError.3.patch] [attachment:trac_8553-review.patch]",
    "created_at": "2011-07-22T19:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8553",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8553#issuecomment-77269",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:35'></a>For the sagebot:

Apply [attachment:trac_8553_solve_fix_IndexError.3.patch] [attachment:trac_8553-review.patch]
