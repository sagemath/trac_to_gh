# Issue 8453: Update PARI to 2.3.5

archive/issues_008453.json:
```json
{
    "body": "There is an spkg at http://sage.math.washington.edu/home/mhansen/pari-2.3.5.spkg\n\nAssignee: tbd\n\nCC:  @JohnCremona\n\nResolution: fixed\n\nAuthor: Mike Hansen\n\nReviewer: John Cremona, David Loeffler\n\nMerged: sage-4.4.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/8453\n\n",
    "closed_at": "2010-04-28T19:32:51Z",
    "created_at": "2010-03-06T06:21:58Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.4.1",
    "title": "Update PARI to 2.3.5",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8453",
    "user": "https://github.com/mwhansen"
}
```
There is an spkg at http://sage.math.washington.edu/home/mhansen/pari-2.3.5.spkg

Assignee: tbd

CC:  @JohnCremona

Resolution: fixed

Author: Mike Hansen

Reviewer: John Cremona, David Loeffler

Merged: sage-4.4.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/8453





---

archive/issue_comments_075931.json:
```json
{
    "body": "Attachment [trac_8453.patch](tarball://root/attachments/some-uuid/ticket8453/trac_8453.patch) by @mwhansen created at 2010-03-06 06:22:54",
    "created_at": "2010-03-06T06:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75931",
    "user": "https://github.com/mwhansen"
}
```

Attachment [trac_8453.patch](tarball://root/attachments/some-uuid/ticket8453/trac_8453.patch) by @mwhansen created at 2010-03-06 06:22:54



---

archive/issue_comments_075932.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-03-06T06:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75932",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_075933.json:
```json
{
    "body": "<a id='comment:2'></a>Mike, I will give this a try.  Unfortunately I have not been able to build 4.3.3 on my 64-bit machine (it builds but thousands of tests fail) so I'll be limited to testing on a 32-bit.\n\nCan we try to collect from other tickets problems which have been attributed to bugs in the pari library, to see if this upgrade fixes them?  If so, there ought tobe appropriate doctests to prove it, and cross-referencing the other tickets, which might therefore be closed.",
    "created_at": "2010-03-06T11:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75933",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:2'></a>Mike, I will give this a try.  Unfortunately I have not been able to build 4.3.3 on my 64-bit machine (it builds but thousands of tests fail) so I'll be limited to testing on a 32-bit.

Can we try to collect from other tickets problems which have been attributed to bugs in the pari library, to see if this upgrade fixes them?  If so, there ought tobe appropriate doctests to prove it, and cross-referencing the other tickets, which might therefore be closed.



---

archive/issue_comments_075934.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-03-06T13:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75934",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_075935.json:
```json
{
    "body": "<a id='comment:3'></a>Successfully installed the new spkg and patch on 4.3.4.alpha0 on a 32-bit ubuntu machine.  Tested all library (-long) and found a few failures which should be easy to fix (especially the last one!):\n\n```\nsage -t -long sage/functions/transcendental.py\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/transcendental.py\", line 78:\n    sage: w = exponential_integral_1(2,4); w\nExpected:\n    [0.048900510708061118, 0.003779352409848905, 0.00036008245216265542, 3.7665622843921715e-05] \nGot:\n    [0.048900510708061118, 0.0037793524098489067, 0.00036008245216265873, 3.7665622843924751e-05]\n```\n\n```\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/special.py\", line 1456:\n    sage: exp_int(6)\nExpected:\n    doctest:...: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.\n    0.000360082452162655\nGot:\n    doctest:1: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.\n    0.000360082452162659\n```\n\n```\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/libs/pari/gen.pyx\", line 7848:\n    sage: E.ellwp(1, flag=2)\nExpected:\n    [14.2992028590818 + 1.140149682 E-18*I, 50.0619300880073 + 1.040834085 E-17*I] \nGot:\n    [14.2992028590818 + 0.E-18*I, 50.0619300880073 - 3.469446952 E-18*I]\n```\n\n```\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/interfaces/gp.py\", line 476:\n    sage: gp.version()\nExpected:\n    ((2, 3, 3), 'GP/PARI CALCULATOR Version 2.3.3 (released)')\nGot:\n    ((2, 3, 5), 'GP/PARI CALCULATOR Version 2.3.5 (released)')\n```",
    "created_at": "2010-03-06T13:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75935",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>Successfully installed the new spkg and patch on 4.3.4.alpha0 on a 32-bit ubuntu machine.  Tested all library (-long) and found a few failures which should be easy to fix (especially the last one!):

```
sage -t -long sage/functions/transcendental.py
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/transcendental.py", line 78:
    sage: w = exponential_integral_1(2,4); w
Expected:
    [0.048900510708061118, 0.003779352409848905, 0.00036008245216265542, 3.7665622843921715e-05] 
Got:
    [0.048900510708061118, 0.0037793524098489067, 0.00036008245216265873, 3.7665622843924751e-05]
```

```
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/special.py", line 1456:
    sage: exp_int(6)
Expected:
    doctest:...: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.
    0.000360082452162655
Got:
    doctest:1: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.
    0.000360082452162659
```

```
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/libs/pari/gen.pyx", line 7848:
    sage: E.ellwp(1, flag=2)
Expected:
    [14.2992028590818 + 1.140149682 E-18*I, 50.0619300880073 + 1.040834085 E-17*I] 
Got:
    [14.2992028590818 + 0.E-18*I, 50.0619300880073 - 3.469446952 E-18*I]
```

```
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/interfaces/gp.py", line 476:
    sage: gp.version()
Expected:
    ((2, 3, 3), 'GP/PARI CALCULATOR Version 2.3.3 (released)')
Got:
    ((2, 3, 5), 'GP/PARI CALCULATOR Version 2.3.5 (released)')
```



---

archive/issue_comments_075936.json:
```json
{
    "body": "Attachment [trac_8453-reviewer.patch](tarball://root/attachments/some-uuid/ticket8453/trac_8453-reviewer.patch) by @loefflerd created at 2010-03-11 19:47:20\n\napply over previous patch",
    "created_at": "2010-03-11T19:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75936",
    "user": "https://github.com/loefflerd"
}
```

Attachment [trac_8453-reviewer.patch](tarball://root/attachments/some-uuid/ticket8453/trac_8453-reviewer.patch) by @loefflerd created at 2010-03-11 19:47:20

apply over previous patch



---

archive/issue_comments_075937.json:
```json
{
    "body": "<a id='comment:4'></a>I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. \n\nJohn, can you double-check that it now works on 32-bit? I've marked it as \"needs review\" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.\n\nDavid",
    "created_at": "2010-03-11T19:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75937",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:4'></a>I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. 

John, can you double-check that it now works on 32-bit? I've marked it as "needs review" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.

David



---

archive/issue_comments_075938.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-03-11T19:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75938",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_075939.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 davidloeffler]:\n> I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. \n\n\nExcellent\n\n> \n> John, can you double-check that it now works on 32-bit? I've marked it as \"needs review\" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.\n\n\nOK, testing now....\n\n> \n> David",
    "created_at": "2010-03-11T20:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75939",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'></a>Replying to [comment:4 davidloeffler]:
> I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. 


Excellent

> 
> John, can you double-check that it now works on 32-bit? I've marked it as "needs review" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.


OK, testing now....

> 
> David



---

archive/issue_comments_075940.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-03-11T21:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75940",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_075941.json:
```json
{
    "body": "<a id='comment:6'></a>All pass on 32-bit.",
    "created_at": "2010-03-11T21:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75941",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'></a>All pass on 32-bit.



---

archive/issue_events_020285.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-18T17:54:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "milestone": "sage-4.3.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8453#event-20285"
}
```



---

archive/issue_comments_075942.json:
```json
{
    "body": "<a id='comment:7'></a>FWIW: I've just checked and it *does* build and run OK on Solaris, by the way. I haven't done a full doctest run because that would take a looong time; but I tested a selection of relevant files including sage/rings/number_field, sage/functions/transcendental and sage/libs/pari/gen and they all seem to pass.",
    "created_at": "2010-03-18T17:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75942",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:7'></a>FWIW: I've just checked and it *does* build and run OK on Solaris, by the way. I haven't done a full doctest run because that would take a looong time; but I tested a selection of relevant files including sage/rings/number_field, sage/functions/transcendental and sage/libs/pari/gen and they all seem to pass.



---

archive/issue_events_020286.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-04-28T19:32:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8453#event-20286"
}
```



---

archive/issue_comments_075943.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-04-28T19:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75943",
    "user": "https://github.com/williamstein"
}
```

Resolution: fixed



---

archive/issue_comments_075944.json:
```json
{
    "body": "<a id='comment:9'></a>Since Pari is now upgraded to 2.3.5, we no longer need ticket #7979 for patching Pari 2.3.3. That ticket concerns the case where Pari 2.3.3 sometimes ignores the build option \"--graphic=none\". However, the file `config/get_fltk` in Pari 2.3.5 has the same logic as in Pari 2.3.3 so it's possible that Pari 2.3.5 also ignores the build option \"--graphic=none\". If that issue comes up, open another ticket to patch Pari 2.3.5 for Sage.",
    "created_at": "2010-04-29T06:13:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8453#issuecomment-75944",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:9'></a>Since Pari is now upgraded to 2.3.5, we no longer need ticket #7979 for patching Pari 2.3.3. That ticket concerns the case where Pari 2.3.3 sometimes ignores the build option "--graphic=none". However, the file `config/get_fltk` in Pari 2.3.5 has the same logic as in Pari 2.3.3 so it's possible that Pari 2.3.5 also ignores the build option "--graphic=none". If that issue comes up, open another ticket to patch Pari 2.3.5 for Sage.
