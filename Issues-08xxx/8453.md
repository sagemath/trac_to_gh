# Issue 8453: Update PARI to 2.3.5

archive/issues_008453.json:
```json
{
    "assignees": [],
    "body": "There is an spkg at http://sage.math.washington.edu/home/mhansen/pari-2.3.5.spkg\n\nCC:  @JohnCremona\n\nAuthor: **Mike Hansen**\n\nReviewer: **John Cremona, David Loeffler**\n\nMerged: **sage-4.4.1.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8453_\n\n",
    "closed_at": "2010-04-28T19:32:51Z",
    "created_at": "2010-03-06T06:21:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.4.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update PARI to 2.3.5",
    "type": "issue",
    "updated_at": "2010-05-03T01:11:27Z",
    "url": "https://github.com/sagemath/sage/issues/8453",
    "user": "https://github.com/mwhansen"
}
```
There is an spkg at http://sage.math.washington.edu/home/mhansen/pari-2.3.5.spkg

CC:  @JohnCremona

Author: **Mike Hansen**

Reviewer: **John Cremona, David Loeffler**

Merged: **sage-4.4.1.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/8453_





---

archive/issue_events_096511.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-03-06T06:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96511"
}
```



---

archive/issue_events_096512.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-03-06T06:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96512"
}
```



---

archive/issue_events_096513.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-03-06T06:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96513"
}
```



---

archive/issue_comments_068887.json:
```json
{
    "body": "Attachment: **[trac_8453.patch.gz](https://github.com/sagemath/sage/files/ticket8453/trac_8453.patch.gz)**",
    "created_at": "2010-03-06T06:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68887",
    "user": "https://github.com/mwhansen"
}
```

Attachment: **[trac_8453.patch.gz](https://github.com/sagemath/sage/files/ticket8453/trac_8453.patch.gz)**



---

archive/issue_events_096514.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-03-06T06:23:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96514"
}
```



---

archive/issue_comments_068888.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nMike, I will give this a try.  Unfortunately I have not been able to build 4.3.3 on my 64-bit machine (it builds but thousands of tests fail) so I'll be limited to testing on a 32-bit.\n\nCan we try to collect from other tickets problems which have been attributed to bugs in the pari library, to see if this upgrade fixes them?  If so, there ought tobe appropriate doctests to prove it, and cross-referencing the other tickets, which might therefore be closed.",
    "created_at": "2010-03-06T11:53:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68888",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:2'>Comment 2:</a>
Mike, I will give this a try.  Unfortunately I have not been able to build 4.3.3 on my 64-bit machine (it builds but thousands of tests fail) so I'll be limited to testing on a 32-bit.

Can we try to collect from other tickets problems which have been attributed to bugs in the pari library, to see if this upgrade fixes them?  If so, there ought tobe appropriate doctests to prove it, and cross-referencing the other tickets, which might therefore be closed.



---

archive/issue_events_096515.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-03-06T13:46:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96515"
}
```



---

archive/issue_events_096516.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-03-06T13:46:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96516"
}
```



---

archive/issue_comments_068889.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nSuccessfully installed the new spkg and patch on 4.3.4.alpha0 on a 32-bit ubuntu machine.  Tested all library (-long) and found a few failures which should be easy to fix (especially the last one!):\n\n```\nsage -t -long sage/functions/transcendental.py\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/transcendental.py\", line 78:\n    sage: w = exponential_integral_1(2,4); w\nExpected:\n    [0.048900510708061118, 0.003779352409848905, 0.00036008245216265542, 3.7665622843921715e-05] \nGot:\n    [0.048900510708061118, 0.0037793524098489067, 0.00036008245216265873, 3.7665622843924751e-05]\n```\n\n```\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/special.py\", line 1456:\n    sage: exp_int(6)\nExpected:\n    doctest:...: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.\n    0.000360082452162655\nGot:\n    doctest:1: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.\n    0.000360082452162659\n```\n\n```\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/libs/pari/gen.pyx\", line 7848:\n    sage: E.ellwp(1, flag=2)\nExpected:\n    [14.2992028590818 + 1.140149682 E-18*I, 50.0619300880073 + 1.040834085 E-17*I] \nGot:\n    [14.2992028590818 + 0.E-18*I, 50.0619300880073 - 3.469446952 E-18*I]\n```\n\n```\n**********************************************************************\nFile \"/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/interfaces/gp.py\", line 476:\n    sage: gp.version()\nExpected:\n    ((2, 3, 3), 'GP/PARI CALCULATOR Version 2.3.3 (released)')\nGot:\n    ((2, 3, 5), 'GP/PARI CALCULATOR Version 2.3.5 (released)')\n```",
    "created_at": "2010-03-06T13:46:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68889",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'>Comment 3:</a>
Successfully installed the new spkg and patch on 4.3.4.alpha0 on a 32-bit ubuntu machine.  Tested all library (-long) and found a few failures which should be easy to fix (especially the last one!):

```
sage -t -long sage/functions/transcendental.py
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/transcendental.py", line 78:
    sage: w = exponential_integral_1(2,4); w
Expected:
    [0.048900510708061118, 0.003779352409848905, 0.00036008245216265542, 3.7665622843921715e-05] 
Got:
    [0.048900510708061118, 0.0037793524098489067, 0.00036008245216265873, 3.7665622843924751e-05]
```

```
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/functions/special.py", line 1456:
    sage: exp_int(6)
Expected:
    doctest:...: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.
    0.000360082452162655
Got:
    doctest:1: DeprecationWarning: The method expint() is deprecated. Use -Ei(-x) or exponential_integral_1(x) as needed instead.
    0.000360082452162659
```

```
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/libs/pari/gen.pyx", line 7848:
    sage: E.ellwp(1, flag=2)
Expected:
    [14.2992028590818 + 1.140149682 E-18*I, 50.0619300880073 + 1.040834085 E-17*I] 
Got:
    [14.2992028590818 + 0.E-18*I, 50.0619300880073 - 3.469446952 E-18*I]
```

```
**********************************************************************
File "/home/john/sage-4.3.4.alpha0/devel/sage-pari/sage/interfaces/gp.py", line 476:
    sage: gp.version()
Expected:
    ((2, 3, 3), 'GP/PARI CALCULATOR Version 2.3.3 (released)')
Got:
    ((2, 3, 5), 'GP/PARI CALCULATOR Version 2.3.5 (released)')
```



---

archive/issue_comments_068890.json:
```json
{
    "body": "Attachment: **[trac_8453-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket8453/trac_8453-reviewer.patch.gz)**\n\napply over previous patch",
    "created_at": "2010-03-11T19:47:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68890",
    "user": "https://github.com/loefflerd"
}
```

Attachment: **[trac_8453-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket8453/trac_8453-reviewer.patch.gz)**

apply over previous patch



---

archive/issue_comments_068891.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. \n\nJohn, can you double-check that it now works on 32-bit? I've marked it as \"needs review\" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.\n\nDavid",
    "created_at": "2010-03-11T19:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68891",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:4'>Comment 4:</a>
I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. 

John, can you double-check that it now works on 32-bit? I've marked it as "needs review" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.

David



---

archive/issue_events_096517.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-11T19:55:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96517"
}
```



---

archive/issue_events_096518.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-11T19:55:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96518"
}
```



---

archive/issue_comments_068892.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [@loefflerd](#comment%3A4):\n> I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. \n\nExcellent\n\n> \n> John, can you double-check that it now works on 32-bit? I've marked it as \"needs review\" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.\n\nOK, testing now....\n\n> \n> David",
    "created_at": "2010-03-11T20:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68892",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [@loefflerd](#comment%3A4):
> I have added a second patch which changes the doctests mentioned above. They should now pass on both 64-bit and 32-bit (the latter using the output John got above). I've also put in a doctest to confirm that #8415 is fixed. 

Excellent

> 
> John, can you double-check that it now works on 32-bit? I've marked it as "needs review" for now, but if that passes, I think we can give it a positive review (and mark #8415 as fixed as well). Sadly, #7736 is still broken.

OK, testing now....

> 
> David



---

archive/issue_events_096519.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-03-11T21:07:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96519"
}
```



---

archive/issue_events_096520.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-03-11T21:07:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96520"
}
```



---

archive/issue_comments_068893.json:
```json
{
    "body": "Reviewer: **John Cremona, David Loeffler**",
    "created_at": "2010-03-11T21:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68893",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona, David Loeffler**



---

archive/issue_comments_068894.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAll pass on 32-bit.",
    "created_at": "2010-03-11T21:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68894",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'>Comment 6:</a>
All pass on 32-bit.



---

archive/issue_events_096521.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-03-18T17:54:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "milestone_number": null,
    "milestone_title": "sage-4.3.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96521"
}
```



---

archive/issue_comments_068895.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nFWIW: I've just checked and it *does* build and run OK on Solaris, by the way. I haven't done a full doctest run because that would take a looong time; but I tested a selection of relevant files including sage/rings/number_field, sage/functions/transcendental and sage/libs/pari/gen and they all seem to pass.",
    "created_at": "2010-03-18T17:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68895",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:7'>Comment 7:</a>
FWIW: I've just checked and it *does* build and run OK on Solaris, by the way. I haven't done a full doctest run because that would take a looong time; but I tested a selection of relevant files including sage/rings/number_field, sage/functions/transcendental and sage/libs/pari/gen and they all seem to pass.



---

archive/issue_events_096522.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-04-28T19:32:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96522"
}
```



---

archive/issue_events_096523.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-04-28T19:32:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8453#event-96523"
}
```



---

archive/issue_comments_068896.json:
```json
{
    "body": "Merged: **4.4.1.alpha0**",
    "created_at": "2010-04-28T19:32:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68896",
    "user": "https://github.com/williamstein"
}
```

Merged: **4.4.1.alpha0**



---

archive/issue_comments_068897.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nSince Pari is now upgraded to 2.3.5, we no longer need ticket #7979 for patching Pari 2.3.3. That ticket concerns the case where Pari 2.3.3 sometimes ignores the build option \"--graphic=none\". However, the file `config/get_fltk` in Pari 2.3.5 has the same logic as in Pari 2.3.3 so it's possible that Pari 2.3.5 also ignores the build option \"--graphic=none\". If that issue comes up, open another ticket to patch Pari 2.3.5 for Sage.",
    "created_at": "2010-04-29T06:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68897",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<a id='comment:9'>Comment 9:</a>
Since Pari is now upgraded to 2.3.5, we no longer need ticket #7979 for patching Pari 2.3.3. That ticket concerns the case where Pari 2.3.3 sometimes ignores the build option "--graphic=none". However, the file `config/get_fltk` in Pari 2.3.5 has the same logic as in Pari 2.3.3 so it's possible that Pari 2.3.5 also ignores the build option "--graphic=none". If that issue comes up, open another ticket to patch Pari 2.3.5 for Sage.



---

archive/issue_comments_068898.json:
```json
{
    "body": "Changed merged from **4.4.1.alpha0** to **sage-4.4.1.alpha0**",
    "created_at": "2010-05-03T01:11:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8453#issuecomment-68898",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Changed merged from **4.4.1.alpha0** to **sage-4.4.1.alpha0**
