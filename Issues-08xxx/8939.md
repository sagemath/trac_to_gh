# Issue 8939: matrix classes for flint polynomials

archive/issues_008939.json:
```json
{
    "body": "Attached patch adds templated matrix classes for FLINT's `fmpz_poly` and `zmod_poly` structs.\n\nAt the moment there is no extra functionality provided by the classes, but fast nullspace (over the fraction field), and hopefully inverse implementations will be coming soon. In any case, this should be a good basis for implementing fast algorithms for these matrices.\n\n**Assignee:** @jasongrout, @williamstein\n\n**CC:**  @malb jpflori\n\n**Reviewer:** Martin Albrecht\n\n**Author:** Burcin Erocal\n\nIssue created by migration from https://trac.sagemath.org/ticket/8939\n\n",
    "created_at": "2010-05-09T22:52:10Z",
    "labels": [
        "component: linear algebra",
        "enhancement",
        "needs work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "matrix classes for flint polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/8939",
    "user": "https://github.com/burcin"
}
```
Attached patch adds templated matrix classes for FLINT's `fmpz_poly` and `zmod_poly` structs.

At the moment there is no extra functionality provided by the classes, but fast nullspace (over the fraction field), and hopefully inverse implementations will be coming soon. In any case, this should be a good basis for implementing fast algorithms for these matrices.

**Assignee:** @jasongrout, @williamstein

**CC:**  @malb jpflori

**Reviewer:** Martin Albrecht

**Author:** Burcin Erocal

Issue created by migration from https://trac.sagemath.org/ticket/8939





---

archive/issue_events_064429.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-05-09T22:54:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64429"
}
```



---

archive/attachments_011596.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8939-matrix_template.patch",
    "asset_url": "tarball://root/attachments/ticket8939/trac_8939-matrix_template.patch",
    "created_at": "2010-05-22T10:41:03Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/attachments_011597.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8939-matrix_template-4.4.2.patch",
    "asset_url": "tarball://root/attachments/ticket8939/trac_8939-matrix_template-4.4.2.patch",
    "created_at": "2010-05-22T10:41:03Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template-4.4.2.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_075103.json:
```json
{
    "body": "**Attachment:** [trac_8939-matrix_template.patch](https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template.patch)\n\n**Attachment:** [trac_8939-matrix_template-4.4.2.patch](https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template-4.4.2.patch)\n\nrebased to 4.4.2",
    "created_at": "2010-05-22T10:41:03Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75103",
    "user": "https://github.com/burcin"
}
```

**Attachment:** [trac_8939-matrix_template.patch](https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template.patch)

**Attachment:** [trac_8939-matrix_template-4.4.2.patch](https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template-4.4.2.patch)

rebased to 4.4.2



---

archive/issue_comments_075104.json:
```json
{
    "body": "<a id='comment:2'></a>\nI uploaded a new patch rebased to 4.4.2.",
    "created_at": "2010-05-22T10:55:22Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75104",
    "user": "https://github.com/burcin"
}
```

<a id='comment:2'></a>
I uploaded a new patch rebased to 4.4.2.



---

archive/issue_comments_075105.json:
```json
{
    "body": "<a id='comment:3'></a>\nI get one doctest failure with this patch applied on top of 4.4.2:\n\n```\n**********************************************************************\nFile \"/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/modules/free_module.py\", line 1125:\n    sage: V.base_extend(QQ)\nExpected:\n    Vector space of dimension 7 over Rational Field\nGot:\n    V\n```",
    "created_at": "2010-06-03T14:51:57Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75105",
    "user": "https://github.com/malb"
}
```

<a id='comment:3'></a>
I get one doctest failure with this patch applied on top of 4.4.2:

```
**********************************************************************
File "/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/modules/free_module.py", line 1125:
    sage: V.base_extend(QQ)
Expected:
    Vector space of dimension 7 over Rational Field
Got:
    V
```



---

archive/issue_events_064430.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-06-03T15:00:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64430"
}
```



---

archive/issue_events_064431.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-06-03T15:00:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64431"
}
```



---

archive/issue_comments_075106.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe patch looks good. However, I'd prefer to have a bit more documentation.\n\n* I think there should be doctests in `fmpz_poly_linkage.pxi`. I know our policy does not require it, but it seems like a good pplace to put some\n* It would be nice to write a bit about how all the files (templates etc.) relate to each other, e.g. some documentation in `matrix_dense_template.pxi` which makes it explains a bit how to use it. (I guess I should do the same for the polynomial template thing.)\n*  I cannot see the \"fast nullspace\"",
    "created_at": "2010-06-03T15:00:20Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75106",
    "user": "https://github.com/malb"
}
```

<a id='comment:4'></a>
The patch looks good. However, I'd prefer to have a bit more documentation.

* I think there should be doctests in `fmpz_poly_linkage.pxi`. I know our policy does not require it, but it seems like a good pplace to put some
* It would be nice to write a bit about how all the files (templates etc.) relate to each other, e.g. some documentation in `matrix_dense_template.pxi` which makes it explains a bit how to use it. (I guess I should do the same for the polynomial template thing.)
*  I cannot see the "fast nullspace"



---

archive/attachments_011598.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_8939-matrix_template-4.4.2-part2.patch",
    "asset_url": "tarball://root/attachments/ticket8939/trac_8939-matrix_template-4.4.2-part2.patch",
    "created_at": "2010-09-25T19:52:58Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template-4.4.2-part2.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_075107.json:
```json
{
    "body": "**Attachment:** [trac_8939-matrix_template-4.4.2-part2.patch](https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template-4.4.2-part2.patch)\n\naddress referee comments",
    "created_at": "2010-09-25T19:52:58Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75107",
    "user": "https://github.com/burcin"
}
```

**Attachment:** [trac_8939-matrix_template-4.4.2-part2.patch](https://github.com/sagemath/sage/files/ticket8939/trac_8939-matrix_template-4.4.2-part2.patch)

address referee comments



---

archive/issue_comments_075108.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [malb](#comment%3A4):\n> The patch looks good. However, I'd prefer to have a bit more documentation.\n\n \n>  * I think there should be doctests in `fmpz_poly_linkage.pxi`. I know our policy does not require it, but it seems like a good pplace to put some\n\n\nDone. I added a new file `sage/libs/flint/fmpz_poly_linkage_tests.pyx` with python functions wrapping the `celement_*()` functions. I don't know how to test the `celement_{construct,destruct}()` functions, so they are omitted.\n\n>  * It would be nice to write a bit about how all the files (templates etc.) relate to each other, e.g. some documentation in `matrix_dense_template.pxi` which makes it explains a bit how to use it. (I guess I should do the same for the polynomial template thing.)\n\n\nDone, with a brief description at the beginning of `matrix_dense_template.pxi`.\n\n>  *  I cannot see the \"fast nullspace\"\n\n\nThis will be on a different ticket, when I get around to cleaning it up...",
    "created_at": "2010-09-25T19:59:07Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75108",
    "user": "https://github.com/burcin"
}
```

<a id='comment:5'></a>
Replying to [malb](#comment%3A4):
> The patch looks good. However, I'd prefer to have a bit more documentation.

 
>  * I think there should be doctests in `fmpz_poly_linkage.pxi`. I know our policy does not require it, but it seems like a good pplace to put some


Done. I added a new file `sage/libs/flint/fmpz_poly_linkage_tests.pyx` with python functions wrapping the `celement_*()` functions. I don't know how to test the `celement_{construct,destruct}()` functions, so they are omitted.

>  * It would be nice to write a bit about how all the files (templates etc.) relate to each other, e.g. some documentation in `matrix_dense_template.pxi` which makes it explains a bit how to use it. (I guess I should do the same for the polynomial template thing.)


Done, with a brief description at the beginning of `matrix_dense_template.pxi`.

>  *  I cannot see the "fast nullspace"


This will be on a different ticket, when I get around to cleaning it up...



---

archive/issue_comments_075109.json:
```json
{
    "body": "**Reviewer:** Martin Albrecht",
    "created_at": "2010-09-25T19:59:07Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75109",
    "user": "https://github.com/burcin"
}
```

**Reviewer:** Martin Albrecht



---

archive/issue_events_064432.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-09-25T19:59:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64432"
}
```



---

archive/issue_events_064433.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-09-25T19:59:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64433"
}
```



---

archive/issue_events_064434.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-11-23T17:50:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64434"
}
```



---

archive/issue_events_064435.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-11-23T17:50:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64435"
}
```



---

archive/issue_comments_075110.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis patch bitrotted a lot (sorry for not not reviewing your changes earlier!):\n\n```\napplying trac_8939-matrix_template-4.4.2-part2.patch\npatching file module_list.py\nHunk #1 succeeded at 501 with fuzz 2 (offset 18 lines).\nunable to find 'sage/libs/flint/fmpz_poly_linkage.pxi' for patching\n2 out of 2 hunks FAILED -- saving rejects to file sage/libs/flint/fmpz_poly_linkage.pxi.rej\nunable to find 'sage/matrix/matrix_dense_template.pxi' for patching\n1 out of 1 hunks FAILED -- saving rejects to file sage/matrix/matrix_dense_template.pxi.rej\npatch failed, unable to continue (try -v)\nsage/libs/flint/fmpz_poly_linkage.pxi: No such file or directory\nsage/matrix/matrix_dense_template.pxi: No such file or directory\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_8939-matrix_template-4.4.2-part2.patch\n```",
    "created_at": "2010-11-23T17:50:59Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75110",
    "user": "https://github.com/malb"
}
```

<a id='comment:6'></a>
This patch bitrotted a lot (sorry for not not reviewing your changes earlier!):

```
applying trac_8939-matrix_template-4.4.2-part2.patch
patching file module_list.py
Hunk #1 succeeded at 501 with fuzz 2 (offset 18 lines).
unable to find 'sage/libs/flint/fmpz_poly_linkage.pxi' for patching
2 out of 2 hunks FAILED -- saving rejects to file sage/libs/flint/fmpz_poly_linkage.pxi.rej
unable to find 'sage/matrix/matrix_dense_template.pxi' for patching
1 out of 1 hunks FAILED -- saving rejects to file sage/matrix/matrix_dense_template.pxi.rej
patch failed, unable to continue (try -v)
sage/libs/flint/fmpz_poly_linkage.pxi: No such file or directory
sage/matrix/matrix_dense_template.pxi: No such file or directory
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_8939-matrix_template-4.4.2-part2.patch
```



---

archive/issue_events_064436.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64436"
}
```



---

archive/issue_events_064437.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64437"
}
```



---

archive/issue_events_064438.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64438"
}
```



---

archive/issue_events_064439.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64439"
}
```



---

archive/issue_comments_075111.json:
```json
{
    "body": "<a id='comment:10'></a>\nWouldn't it be better now to wrap `fmpz_mat`, `fmpz_poly_mat`, `fmpq_mat`, `nmod_poly_mat` instead? Or do we need to do both to preserve existing features?",
    "created_at": "2014-03-15T08:30:56Z",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8939#issuecomment-75111",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:10'></a>
Wouldn't it be better now to wrap `fmpz_mat`, `fmpz_poly_mat`, `fmpq_mat`, `nmod_poly_mat` instead? Or do we need to do both to preserve existing features?



---

archive/issue_events_064440.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64440"
}
```



---

archive/issue_events_064441.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64441"
}
```



---

archive/issue_events_064442.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64442"
}
```



---

archive/issue_events_064443.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8939",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8939#event-64443"
}
```
