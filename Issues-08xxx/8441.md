# Issue 8441: Coleman-Gross local height pairing on hyperelliptic curves

archive/issues_008441.json:
```json
{
    "body": "Currently, a work in progress (lots of doctests need to be written and internal print statements removed; the code itself will be cleaned up over the next few weeks), but the main function, which computes the Coleman-Gross local height pairing at p for hyperelliptic curves, does the following:\n\n(This example is computing h_7(D_1, D_2) and h_7(D_2, D_1), for D_1 = (P) - (Q) and D_2 = (Pprime)-(Qprime), in the notation of R. Coleman and B. Gross, p-adic heights on curves, Algebraic Number Theory, 1989, pp-73-81.)\n\n```\n        sage: R.<x> = QQ[]                                                                                \n        sage: H = HyperellipticCurve(x*(x-1)*(x+9))                                                       \n        sage: K = Qp(7,10)                                                                                \n        sage: HK = H.change_ring(K)                                                                       \n        sage: P = HK(9,36)                                                                                \n        sage: Q = HK.teichmuller(P)                                                                       \n        sage: Pprime = HK(-4,10)                                                                          \n        sage: Qprime = HK.teichmuller(Pprime)                                                             \n        sage: HK.height([(1,P),(-1,Q)],[(1,Pprime),(-1,Qprime)],10)                                       \n        2*7^2 + 5*7^3 + 7^4 + 7^5 + 2*7^6 + 3*7^7 + 7^8 + 3*7^9 + O(7^10)                                 \n        sage: HK.height([(1,Pprime),(-1,Qprime)],[(1,P),(-1,Q)],10)                                       \n        2*7^2 + 5*7^3 + 7^4 + 7^5 + 2*7^6 + 3*7^7 + 7^8 + 3*7^9 + O(7^10)      \n```\n\nAssignee: @williamstein\n\nCC:  @kedlaya\n\nKeywords: heights, Coleman integration, hyperelliptic curves\n\nAuthor: Jennifer Balakrishnan, Fr\u00e9d\u00e9ric Chapoton\n\nBranch: u/jen/8441\n\nCommit: 1bf434986058e7deada27509aa490e7c7f930358\n\nIssue created by migration from https://trac.sagemath.org/ticket/8441\n\n",
    "created_at": "2010-03-05T01:26:33Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Coleman-Gross local height pairing on hyperelliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8441",
    "user": "https://github.com/jbalakrishnan"
}
```
Currently, a work in progress (lots of doctests need to be written and internal print statements removed; the code itself will be cleaned up over the next few weeks), but the main function, which computes the Coleman-Gross local height pairing at p for hyperelliptic curves, does the following:

(This example is computing h_7(D_1, D_2) and h_7(D_2, D_1), for D_1 = (P) - (Q) and D_2 = (Pprime)-(Qprime), in the notation of R. Coleman and B. Gross, p-adic heights on curves, Algebraic Number Theory, 1989, pp-73-81.)

```
        sage: R.<x> = QQ[]                                                                                
        sage: H = HyperellipticCurve(x*(x-1)*(x+9))                                                       
        sage: K = Qp(7,10)                                                                                
        sage: HK = H.change_ring(K)                                                                       
        sage: P = HK(9,36)                                                                                
        sage: Q = HK.teichmuller(P)                                                                       
        sage: Pprime = HK(-4,10)                                                                          
        sage: Qprime = HK.teichmuller(Pprime)                                                             
        sage: HK.height([(1,P),(-1,Q)],[(1,Pprime),(-1,Qprime)],10)                                       
        2*7^2 + 5*7^3 + 7^4 + 7^5 + 2*7^6 + 3*7^7 + 7^8 + 3*7^9 + O(7^10)                                 
        sage: HK.height([(1,Pprime),(-1,Qprime)],[(1,P),(-1,Q)],10)                                       
        2*7^2 + 5*7^3 + 7^4 + 7^5 + 2*7^6 + 3*7^7 + 7^8 + 3*7^9 + O(7^10)      
```

Assignee: @williamstein

CC:  @kedlaya

Keywords: heights, Coleman integration, hyperelliptic curves

Author: Jennifer Balakrishnan, Frédéric Chapoton

Branch: u/jen/8441

Commit: 1bf434986058e7deada27509aa490e7c7f930358

Issue created by migration from https://trac.sagemath.org/ticket/8441





---

archive/issue_comments_075665.json:
```json
{
    "body": "a first attempt at collecting all of the local heights code",
    "created_at": "2010-03-05T01:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75665",
    "user": "https://github.com/jbalakrishnan"
}
```

a first attempt at collecting all of the local heights code



---

archive/issue_comments_075666.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2010-03-05T01:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75666",
    "user": "https://github.com/jbalakrishnan"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_075667.json:
```json
{
    "body": "<a id='comment:1'></a>Attachment [13544.patch](tarball://root/attachments/some-uuid/ticket8441/13544.patch) by @jbalakrishnan created at 2010-03-05 01:34:27",
    "created_at": "2010-03-05T01:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75667",
    "user": "https://github.com/jbalakrishnan"
}
```

<a id='comment:1'></a>Attachment [13544.patch](tarball://root/attachments/some-uuid/ticket8441/13544.patch) by @jbalakrishnan created at 2010-03-05 01:34:27



---

archive/issue_comments_075668.json:
```json
{
    "body": "<a id='comment:2'></a>here is a tentative of rebasing on 5.12.beta3\n\n* the part in ``hyperelliptic_generic`` is rather clean and could even go in a separate ticket\n\n* the part in ``hyperelliptic_padic_field`` needs a lot of work and care",
    "created_at": "2013-08-29T09:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75668",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>here is a tentative of rebasing on 5.12.beta3

* the part in ``hyperelliptic_generic`` is rather clean and could even go in a separate ticket

* the part in ``hyperelliptic_padic_field`` needs a lot of work and care



---

archive/issue_comments_075669.json:
```json
{
    "body": "<a id='comment:3'></a>apply only trac_8441_rebased.patch\u200b",
    "created_at": "2013-08-29T10:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75669",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>apply only trac_8441_rebased.patch​



---

archive/issue_comments_075670.json:
```json
{
    "body": "<a id='comment:4'></a>apply only trac_8441_rebased.patch",
    "created_at": "2013-08-29T16:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75670",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>apply only trac_8441_rebased.patch



---

archive/issue_comments_075671.json:
```json
{
    "body": "Attachment [trac_8441_rebased.patch](tarball://root/attachments/some-uuid/ticket8441/trac_8441_rebased.patch) by @fchapoton created at 2013-10-04 21:14:51",
    "created_at": "2013-10-04T21:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75671",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_8441_rebased.patch](tarball://root/attachments/some-uuid/ticket8441/trac_8441_rebased.patch) by @fchapoton created at 2013-10-04 21:14:51



---

archive/issue_comments_075672.json:
```json
{
    "body": "<a id='comment:5'></a>apply only trac_8441_rebased.patch",
    "created_at": "2013-10-15T18:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75672",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>apply only trac_8441_rebased.patch



---

archive/issue_comments_075673.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2014-01-09T19:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75673",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_comments_075674.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-23T19:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75674",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_075675.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-24T20:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75675",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_075676.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-27T11:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75676",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_075677.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-06T20:18:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75677",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_020240.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-02-26T09:18:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8441#event-20240"
}
```



---

archive/issue_comments_075678.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-26T10:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75678",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_075679.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-27T17:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75679",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_020241.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-27T17:17:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8441#event-20241"
}
```



---

archive/issue_events_020242.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-03-27T17:17:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8441#event-20242"
}
```



---

archive/issue_comments_075680.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-29T11:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75680",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_075681.json:
```json
{
    "body": "<a id='comment:17'></a>So is there any mathematical obstruction to giving this a positive review? (I haven't checked all the doctest formatting, so maybe that is still an issue.)",
    "created_at": "2016-08-11T15:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75681",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:17'></a>So is there any mathematical obstruction to giving this a positive review? (I haven't checked all the doctest formatting, so maybe that is still an issue.)



---

archive/issue_comments_075682.json:
```json
{
    "body": "<a id='comment:18'></a>To answer my own question: it looks like there are still some missing doctests on intermediate functions, and some comments in the code that suggest points that still need to be addressed (but I didn't look more closely at the code to evaluate the suggestions).\n\nWould it make to separate out the part of this code which is actually done into a ticket that can be reviewed and merged right away (and make that a dependency for this ticket)?",
    "created_at": "2016-08-17T15:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75682",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:18'></a>To answer my own question: it looks like there are still some missing doctests on intermediate functions, and some comments in the code that suggest points that still need to be addressed (but I didn't look more closely at the code to evaluate the suggestions).

Would it make to separate out the part of this code which is actually done into a ticket that can be reviewed and merged right away (and make that a dependency for this ticket)?



---

archive/issue_comments_075683.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-17T18:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75683",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_075684.json:
```json
{
    "body": "<a id='comment:20'></a>One could easily split to another ticket the simple (but not so interesting) changes in the file `hyperelliptic_generic`.",
    "created_at": "2016-08-17T19:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75684",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>One could easily split to another ticket the simple (but not so interesting) changes in the file `hyperelliptic_generic`.



---

archive/issue_comments_075685.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-19T00:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8441#issuecomment-75685",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
