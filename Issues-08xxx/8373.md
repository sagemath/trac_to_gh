# Issue 8373: Construct finite fields with primitive defining polynomial

archive/issues_008373.json:
```json
{
    "assignees": [
        "https://github.com/ClementPernet"
    ],
    "body": "Add an argument `modulus=\"primitive\"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.\n\nDepends on #16927\n\nCC:  @pjbruin\n\nBranch/Commit: **[`e6c0c58`](https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2)**\n\nReviewer: **Peter Bruin**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **finite rings**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8373_\n\n",
    "closed_at": "2014-09-08T08:48:58Z",
    "created_at": "2010-02-26T06:47:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20finite%20rings",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Construct finite fields with primitive defining polynomial",
    "type": "issue",
    "updated_at": "2014-09-08T08:48:58Z",
    "url": "https://github.com/sagemath/sage/issues/8373",
    "user": "https://github.com/rkirov"
}
```
Add an argument `modulus="primitive"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.

Depends on #16927

CC:  @pjbruin

Branch/Commit: **[`e6c0c58`](https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2)**

Reviewer: **Peter Bruin**

Author: **Jeroen Demeyer**

Component: **finite rings**

_Issue created by migration from https://trac.sagemath.org/ticket/8373_





---

archive/issue_events_105154.json:
```json
{
    "actor": "https://github.com/rkirov",
    "created_at": "2010-02-26T06:47:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105154"
}
```



---

archive/issue_events_105155.json:
```json
{
    "actor": "https://github.com/rkirov",
    "created_at": "2010-02-26T06:47:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105155"
}
```



---

archive/issue_events_105156.json:
```json
{
    "actor": "https://github.com/rkirov",
    "created_at": "2010-02-26T06:47:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105156"
}
```



---

archive/issue_events_105157.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-02-26T06:47:28Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "subject": "https://github.com/rkirov",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105157"
}
```



---

archive/issue_comments_065919.json:
```json
{
    "body": "Replying to [ticket:8373 rkirov]:\n\nIn your example,\u00a0`a` *is* a generator; it's an *algebra generator*.  In fact `a` generates `K` in exactly the same sense in which `x` generates `R`.  What you're looking for is:\n\n```\nsage: R.<x> = GF(2)[]\nsage: K.<a> = GF(16, modulus=x^4+x^3+x^2+x+1)\nsage: K.multiplicative_generator()\na + 1\n```\nIt would be a mistake to insist on having a primitive generator.  Of your options:\u00a0\n\n(1) could slow Sage down unnecessarily, and what should it do if a user wanted to use a non-primitive generator?\n\n(2) yes, if the documentation is confusing, it should be clarified.\n\n(3) I don't quite understand.  If you mean ignore a given modulus if  it is not primitive, that would be very confusing.\n\nWhat *is* needed, for non-prime fields of large characteristic, is a much better way of finding a multiplicative generator:\n\n```\nsage: p = 65537\nsage: K.<a> = GF(p^2)\nsage: a.multiplicative_order() == p^2 - 1\nFalse\nsage: time K.multiplicative_generator()\nCPU times: user 498.03 s, sys: 56.61 s, total: 554.64 s\nWall time: 555.20 s\na + 3\n```\nWhat's taking the time here is that the current algorithm, after deciding that `a` isn't a multiplicative generator,  pointlessly computes the multiplicative order of all the non-zero elements in the prime field, before trying `a` (again), `a + 1`, `a + 2`, and succeeding with `a + 3`.",
    "created_at": "2010-02-26T09:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65919",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Replying to [ticket:8373 rkirov]:

In your example, `a` *is* a generator; it's an *algebra generator*.  In fact `a` generates `K` in exactly the same sense in which `x` generates `R`.  What you're looking for is:

```
sage: R.<x> = GF(2)[]
sage: K.<a> = GF(16, modulus=x^4+x^3+x^2+x+1)
sage: K.multiplicative_generator()
a + 1
```
It would be a mistake to insist on having a primitive generator.  Of your options: 

(1) could slow Sage down unnecessarily, and what should it do if a user wanted to use a non-primitive generator?

(2) yes, if the documentation is confusing, it should be clarified.

(3) I don't quite understand.  If you mean ignore a given modulus if  it is not primitive, that would be very confusing.

What *is* needed, for non-prime fields of large characteristic, is a much better way of finding a multiplicative generator:

```
sage: p = 65537
sage: K.<a> = GF(p^2)
sage: a.multiplicative_order() == p^2 - 1
False
sage: time K.multiplicative_generator()
CPU times: user 498.03 s, sys: 56.61 s, total: 554.64 s
Wall time: 555.20 s
a + 3
```
What's taking the time here is that the current algorithm, after deciding that `a` isn't a multiplicative generator,  pointlessly computes the multiplicative order of all the non-zero elements in the prime field, before trying `a` (again), `a + 1`, `a + 2`, and succeeding with `a + 3`.



---

archive/issue_comments_065920.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI guess you are right, it is a generator as an algebra. Somehow I assumed F.<a> gives you 'a' as a multiplicative generator. So it is really a renaming of 'x'(poly var)->'a'. I didn't see the convenient function F.multiplicative_generator.\n\nI checked that Magma has similar behavior.\n\n```\n> F2 := GF(2);\n> FP<x> := PolynomialRing(F2);\n> F<z> := ext< F2 | x^4+x^3+x^2+x+1 >;\n```\nIt also seems to have different algorithm for primitive element,\n\n```\n> PrimitiveElement(F);\nz^3 + z + 1\n```\n\nIn any case I am leaving this open so someone can work on the bug you found.",
    "created_at": "2010-02-26T10:50:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65920",
    "user": "https://github.com/rkirov"
}
```

<div id="comment:2" align="right">comment:2</div>

I guess you are right, it is a generator as an algebra. Somehow I assumed F.<a> gives you 'a' as a multiplicative generator. So it is really a renaming of 'x'(poly var)->'a'. I didn't see the convenient function F.multiplicative_generator.

I checked that Magma has similar behavior.

```
> F2 := GF(2);
> FP<x> := PolynomialRing(F2);
> F<z> := ext< F2 | x^4+x^3+x^2+x+1 >;
```
It also seems to have different algorithm for primitive element,

```
> PrimitiveElement(F);
z^3 + z + 1
```

In any case I am leaving this open so someone can work on the bug you found.



---

archive/issue_events_105158.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-26T14:56:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105158"
}
```



---

archive/issue_events_105159.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-26T14:56:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105159"
}
```



---

archive/issue_comments_065921.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis is certainly not a bug, but possibly a feature request.\n\nI would propose adding the option `modulus=\"primitive\"` to solve this ticket.",
    "created_at": "2014-06-26T14:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65921",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

This is certainly not a bug, but possibly a feature request.

I would propose adding the option `modulus="primitive"` to solve this ticket.



---

archive/issue_events_105160.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-26T14:56:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105160"
}
```



---

archive/issue_events_105161.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2014-06-26T14:56:35Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105161"
}
```



---

archive/issue_events_105162.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2014-06-26T14:56:35Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "subject": "https://github.com/jdemeyer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105162"
}
```



---

archive/issue_events_105163.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-26T14:56:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105163"
}
```



---

archive/issue_events_105164.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-26T14:56:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20finite%20rings",
    "label_color": "0000ff",
    "label_name": "c: finite rings",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105164"
}
```



---

archive/issue_comments_065922.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,20 +1 @@\n-Consider the following code:\n-\n-```\n-sage: R.<x> = PolynomialRing(GF(2))\n-sage: K.<a> = GF(16, modulus=x^4+x^3+x^2+x+1)\n-sage: a^5\n-1\n-```\n-\n-This is all fine mathematically, as long as the user is clear what a is and isn't (it isn't a generator for the multiplicative group of the finite field). So the options as I see them (in increasing difficulty for implementation):\n-\n-1)GF already checks modulus for irreducibility, just add check for modulus.is_primitive().\n-\n-2)Rewrite the help for the GF function to indicate that the function does not return a generator necessarily (like in this specific case).\n-\n-3)Find an actual generator (that might not be the polynomial x) and return that.\n-\n-\n-Opinions?\n-\n+Add an argument `modulus=\"primitive\"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.\n``````\n",
    "created_at": "2014-08-04T12:55:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65922",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,20 +1 @@
-Consider the following code:
-
-```
-sage: R.<x> = PolynomialRing(GF(2))
-sage: K.<a> = GF(16, modulus=x^4+x^3+x^2+x+1)
-sage: a^5
-1
-```
-
-This is all fine mathematically, as long as the user is clear what a is and isn't (it isn't a generator for the multiplicative group of the finite field). So the options as I see them (in increasing difficulty for implementation):
-
-1)GF already checks modulus for irreducibility, just add check for modulus.is_primitive().
-
-2)Rewrite the help for the GF function to indicate that the function does not return a generator necessarily (like in this specific case).
-
-3)Find an actual generator (that might not be the polynomial x) and return that.
-
-
-Opinions?
-
+Add an argument `modulus="primitive"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.
``````




---

archive/issue_comments_065923.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@jdemeyer](#comment:5):\n\nThe idea of allowing modulus='primitive' is good.  But a problem with the modified description is that the discussion in comments 1 and 2 is now out of context.",
    "created_at": "2014-08-05T17:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65923",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@jdemeyer](#comment:5):

The idea of allowing modulus='primitive' is good.  But a problem with the modified description is that the discussion in comments 1 and 2 is now out of context.



---

archive/issue_comments_065924.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@sagetrac-fwclarke](#comment:6):\n> Replying to [@jdemeyer](#comment:5):\n> \n> The idea of allowing modulus='primitive' is good.\n\nAnd sufficient for you to consider this issue fixed?\n\n> But a problem with the modified description is that the discussion in comments 1 and 2 is now out of context.\n\nSure, but that's not really a problem, right?",
    "created_at": "2014-08-05T19:35:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65924",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@sagetrac-fwclarke](#comment:6):
> Replying to [@jdemeyer](#comment:5):
> 
> The idea of allowing modulus='primitive' is good.

And sufficient for you to consider this issue fixed?

> But a problem with the modified description is that the discussion in comments 1 and 2 is now out of context.

Sure, but that's not really a problem, right?



---

archive/issue_events_105165.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105165"
}
```



---

archive/issue_events_105166.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105166"
}
```



---

archive/issue_comments_065925.json:
```json
{
    "body": "Dependencies: **#16927**",
    "created_at": "2014-09-03T11:43:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65925",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#16927**



---

archive/issue_comments_065926.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2014-09-03T11:43:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65926",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_065927.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Add an argument `modulus=\"primitive\"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.\n+\n+Also add an argument `modulus=\"pari\"` (and make it the default) to use PARI's `ffinit()`.\n``````\n",
    "created_at": "2014-09-03T11:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65927",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Add an argument `modulus="primitive"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.
+
+Also add an argument `modulus="pari"` (and make it the default) to use PARI's `ffinit()`.
``````




---

archive/issue_events_105167.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-03T11:46:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "title_is": "Construct finite fields with primitive defining polynomial",
    "title_was": "finite fields constructed with non-primitive defining polynomial",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105167"
}
```



---

archive/issue_comments_065928.json:
```json
{
    "body": "Replying to [ticket:8373 rkirov]:\n\n> Also add an argument `modulus=\"pari\"` (and make it the default) to use PARI's `ffinit()`.\n\nThis already exists in `PolynomialRing_dense_mod_p.irreducible_element()` under the name `modulus=\"adleman-lenstra\"`.  It is the default if no Conway polynomial is known and the characteristic is odd.\n\nSome finite field implementations accept a string `modulus`, but this should be obsolete; `FiniteFieldFactory.create_key_and_extra_args()` uses the above method to convert a string `modulus` into an actual polynomial.",
    "created_at": "2014-09-03T12:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65928",
    "user": "https://github.com/pjbruin"
}
```

Replying to [ticket:8373 rkirov]:

> Also add an argument `modulus="pari"` (and make it the default) to use PARI's `ffinit()`.

This already exists in `PolynomialRing_dense_mod_p.irreducible_element()` under the name `modulus="adleman-lenstra"`.  It is the default if no Conway polynomial is known and the characteristic is odd.

Some finite field implementations accept a string `modulus`, but this should be obsolete; `FiniteFieldFactory.create_key_and_extra_args()` uses the above method to convert a string `modulus` into an actual polynomial.



---

archive/issue_comments_065929.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks for the pointer, I was confused by `PolynomialRing_dense_finite_field.irreducible_element`",
    "created_at": "2014-09-03T12:18:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65929",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks for the pointer, I was confused by `PolynomialRing_dense_finite_field.irreducible_element`



---

archive/issue_comments_065930.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@pjbruin](#comment:11):\n> Some finite field implementations accept a string `modulus`, but this should be obsolete\n\nWhy should it be obsolete? I think the syntax\n\n```\nk.<a> = GF(p^n, modulus=\"primitive\")\n```\nis very good to have. Note that the actual modulus polynomial is computed before the implementation is even considered. So it's not that every finite field implementation needs to be aware of this.",
    "created_at": "2014-09-03T12:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65930",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@pjbruin](#comment:11):
> Some finite field implementations accept a string `modulus`, but this should be obsolete

Why should it be obsolete? I think the syntax

```
k.<a> = GF(p^n, modulus="primitive")
```
is very good to have. Note that the actual modulus polynomial is computed before the implementation is even considered. So it's not that every finite field implementation needs to be aware of this.



---

archive/issue_comments_065931.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n Add an argument `modulus=\"primitive\"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.\n-\n-Also add an argument `modulus=\"pari\"` (and make it the default) to use PARI's `ffinit()`.\n``````\n",
    "created_at": "2014-09-03T12:29:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65931",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1 @@
 Add an argument `modulus="primitive"` to the finite field generator `GF()` such that the chosen generator is guaranteed to be a generator of the multiplicative group.
-
-Also add an argument `modulus="pari"` (and make it the default) to use PARI's `ffinit()`.
``````




---

archive/issue_comments_065932.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@jdemeyer](#comment:13):\n> Replying to [@pjbruin](#comment:11):\n> > Some finite field implementations accept a string `modulus`, but this should be obsolete\n\n> Why should it be obsolete? I think the syntax\n> \n> ```\n> k.<a> = GF(p^n, modulus=\"primitive\")\n> ```\n> is very good to have.\n\nYes, it is certainly not this syntax that needs to be made obsolete!\n> Note that the actual modulus polynomial is computed before the implementation is even considered. So it's not that every finite field implementation needs to be aware of this.\n\nThat is what I meant; the individual implementation should never need to consider the case where `modulus` is a string, it should all be handled by the factory.",
    "created_at": "2014-09-03T12:30:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65932",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@jdemeyer](#comment:13):
> Replying to [@pjbruin](#comment:11):
> > Some finite field implementations accept a string `modulus`, but this should be obsolete

> Why should it be obsolete? I think the syntax
> 
> ```
> k.<a> = GF(p^n, modulus="primitive")
> ```
> is very good to have.

Yes, it is certainly not this syntax that needs to be made obsolete!
> Note that the actual modulus polynomial is computed before the implementation is even considered. So it's not that every finite field implementation needs to be aware of this.

That is what I meant; the individual implementation should never need to consider the case where `modulus` is a string, it should all be handled by the factory.



---

archive/issue_comments_065933.json:
```json
{
    "body": "Branch: **[u/jdemeyer/ticket/8373](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/8373)**",
    "created_at": "2014-09-03T13:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65933",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/ticket/8373](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/8373)**



---

archive/issue_comments_065934.json:
```json
{
    "body": "Commit: **[`63ec17a`](https://github.com/sagemath/sagetrac-mirror/commit/63ec17af4cc391fb5bcfef7c9c113488806dac21)**",
    "created_at": "2014-09-03T13:49:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65934",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`63ec17a`](https://github.com/sagemath/sagetrac-mirror/commit/63ec17af4cc391fb5bcfef7c9c113488806dac21)**



---

archive/issue_events_105168.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-03T13:49:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105168"
}
```



---

archive/issue_comments_065935.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8286a4c3e661246576813bbfb470a4b5e05eca77\"><code>8286a4c</code></a></td><td><code>Add ffprimroot, fflog, fforder</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63ec17af4cc391fb5bcfef7c9c113488806dac21\"><code>63ec17a</code></a></td><td><code>Allow modulus=\"primitive\" in finite field constructor</code></td></tr></table>\n",
    "created_at": "2014-09-03T13:49:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65935",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8286a4c3e661246576813bbfb470a4b5e05eca77"><code>8286a4c</code></a></td><td><code>Add ffprimroot, fflog, fforder</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63ec17af4cc391fb5bcfef7c9c113488806dac21"><code>63ec17a</code></a></td><td><code>Allow modulus="primitive" in finite field constructor</code></td></tr></table>




---

archive/issue_comments_065936.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@pjbruin](#comment:15):\n> That is what I meant; the individual implementation should never need to consider the case where `modulus` is a string, it should all be handled by the factory.\n\nGood, this will be #16930.",
    "created_at": "2014-09-04T09:23:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65936",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@pjbruin](#comment:15):
> That is what I meant; the individual implementation should never need to consider the case where `modulus` is a string, it should all be handled by the factory.

Good, this will be #16930.



---

archive/issue_events_105169.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-09-04T12:31:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105169"
}
```



---

archive/issue_events_105170.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-09-04T12:31:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105170"
}
```



---

archive/issue_comments_065937.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nLooks good and passes tests.",
    "created_at": "2014-09-04T12:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65937",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:19" align="right">comment:19</div>

Looks good and passes tests.



---

archive/issue_comments_065938.json:
```json
{
    "body": "Reviewer: **Peter Bruin**",
    "created_at": "2014-09-04T12:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65938",
    "user": "https://github.com/pjbruin"
}
```

Reviewer: **Peter Bruin**



---

archive/issue_comments_065939.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI got this on arando (linux 32-bit):\n\n```\nsage -t --long src/sage/rings/polynomial/polynomial_ring.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/polynomial_ring.py\", line 2331, in sage.rings.polynomial.polynomial_ring.PolynomialRing_dense_mod_n.irreducible_element\nFailed example:\n    GF(5)['x'].irreducible_element(32, algorithm=\"primitive\")\nExpected:\n    x^32 + 4*x^31 + x^30 + 4*x^29 + 4*x^28 + 3*x^27 + 2*x^26 + x^25 + x^24 + x^23 + 4*x^21 + 3*x^20 + x^19 + 4*x^17 + 4*x^16 + 4*x^15 + 4*x^14 + 3*x^13 + x^12 + 3*x^11 + 4*x^10 + x^9 + 4*x^8 + x^7 + 2*x^6 + 4*x^5 + 4*x^4 + x^3 + 3*x^2 + 4*x + 2\nGot:\n    x^32 + 3*x^31 + x^30 + 4*x^28 + 2*x^27 + 2*x^26 + 2*x^24 + 2*x^23 + 2*x^22 + x^21 + 3*x^20 + 3*x^19 + x^18 + 3*x^17 + 4*x^16 + 2*x^15 + 3*x^12 + 4*x^11 + x^10 + 2*x^8 + 3*x^7 + 2*x^6 + 3*x^5 + x^4 + 4*x^3 + x + 3\n**********************************************************************\n```",
    "created_at": "2014-09-05T21:38:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65939",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:20" align="right">comment:20</div>

I got this on arando (linux 32-bit):

```
sage -t --long src/sage/rings/polynomial/polynomial_ring.py
**********************************************************************
File "src/sage/rings/polynomial/polynomial_ring.py", line 2331, in sage.rings.polynomial.polynomial_ring.PolynomialRing_dense_mod_n.irreducible_element
Failed example:
    GF(5)['x'].irreducible_element(32, algorithm="primitive")
Expected:
    x^32 + 4*x^31 + x^30 + 4*x^29 + 4*x^28 + 3*x^27 + 2*x^26 + x^25 + x^24 + x^23 + 4*x^21 + 3*x^20 + x^19 + 4*x^17 + 4*x^16 + 4*x^15 + 4*x^14 + 3*x^13 + x^12 + 3*x^11 + 4*x^10 + x^9 + 4*x^8 + x^7 + 2*x^6 + 4*x^5 + 4*x^4 + x^3 + 3*x^2 + 4*x + 2
Got:
    x^32 + 3*x^31 + x^30 + 4*x^28 + 2*x^27 + 2*x^26 + 2*x^24 + 2*x^23 + 2*x^22 + x^21 + 3*x^20 + 3*x^19 + x^18 + 3*x^17 + 4*x^16 + 2*x^15 + 3*x^12 + 4*x^11 + x^10 + 2*x^8 + 3*x^7 + 2*x^6 + 3*x^5 + x^4 + 4*x^3 + x + 3
**********************************************************************
```



---

archive/issue_events_105171.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-05T21:38:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105171"
}
```



---

archive/issue_events_105172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-05T21:38:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105172"
}
```



---

archive/issue_comments_065940.json:
```json
{
    "body": "Changed commit from **[`63ec17a`](https://github.com/sagemath/sagetrac-mirror/commit/63ec17af4cc391fb5bcfef7c9c113488806dac21)** to **[`e6c0c58`](https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2)**",
    "created_at": "2014-09-06T06:33:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65940",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`63ec17a`](https://github.com/sagemath/sagetrac-mirror/commit/63ec17af4cc391fb5bcfef7c9c113488806dac21)** to **[`e6c0c58`](https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2)**



---

archive/issue_comments_065941.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2\"><code>e6c0c58</code></a></td><td><code>Fix for random doctest</code></td></tr></table>\n",
    "created_at": "2014-09-06T06:33:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65941",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2"><code>e6c0c58</code></a></td><td><code>Fix for random doctest</code></td></tr></table>




---

archive/issue_events_105173.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-06T06:55:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105173"
}
```



---

archive/issue_events_105174.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-06T06:55:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105174"
}
```



---

archive/issue_events_105175.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-08T08:48:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105175"
}
```



---

archive/issue_events_105176.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "dbda3f3a923a461661cd685b27fce83956dc8836",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-09-08T08:48:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8373#event-105176"
}
```



---

archive/issue_comments_065942.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/8373](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/8373)** to **[`e6c0c58`](https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2)**",
    "created_at": "2014-09-08T08:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8373#issuecomment-65942",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/8373](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/8373)** to **[`e6c0c58`](https://github.com/sagemath/sagetrac-mirror/commit/e6c0c580240cf04bb05377d143ac234ee7581bb2)**
